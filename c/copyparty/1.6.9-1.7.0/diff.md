# Comparing `tmp/copyparty-1.6.9.tar.gz` & `tmp/copyparty-1.7.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "copyparty-1.6.9.tar", last modified: Thu Mar 16 22:12:28 2023, max compression
+gzip compressed data, was "copyparty-1.7.0.tar", last modified: Sat Apr 29 22:23:54 2023, max compression
```

## Comparing `copyparty-1.6.9.tar` & `copyparty-1.7.0.tar`

### file list

```diff
@@ -1,126 +1,126 @@
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.984793 copyparty-1.6.9/
--rw-r--r--   0 ed        (1000) ed        (1000)     1059 2021-09-11 12:44:53.000000 copyparty-1.6.9/LICENSE
--rw-r--r--   0 ed        (1000) ed        (1000)      102 2023-03-16 22:12:27.000000 copyparty-1.6.9/MANIFEST.in
--rw-r--r--   0 ed        (1000) ed        (1000)    82692 2023-03-16 22:12:28.983793 copyparty-1.6.9/PKG-INFO
--rw-r--r--   0 ed        (1000) ed        (1000)    80896 2023-03-16 21:13:36.000000 copyparty-1.6.9/README.md
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.968793 copyparty-1.6.9/bin/
--rwxr-xr-x   0 ed        (1000) ed        (1000)    32276 2023-03-16 22:10:54.000000 copyparty-1.6.9/bin/partyfuse.py
--rwxr-xr-x   0 ed        (1000) ed        (1000)    35130 2023-03-16 22:10:54.000000 copyparty-1.6.9/bin/up2k.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.972793 copyparty-1.6.9/copyparty/
--rw-r--r--   0 ed        (1000) ed        (1000)     1063 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/__init__.py
--rwxr-xr-x   0 ed        (1000) ed        (1000)    66891 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/__main__.py
--rw-r--r--   0 ed        (1000) ed        (1000)      247 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/__version__.py
--rw-r--r--   0 ed        (1000) ed        (1000)    62030 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/authsrv.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.973793 copyparty-1.6.9/copyparty/bos/
--rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/bos/__init__.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1560 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/bos/bos.py
--rw-r--r--   0 ed        (1000) ed        (1000)      777 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/bos/path.py
--rw-r--r--   0 ed        (1000) ed        (1000)     3590 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/broker_mp.py
--rw-r--r--   0 ed        (1000) ed        (1000)     3200 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/broker_mpw.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1759 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/broker_thr.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1489 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/broker_util.py
--rw-r--r--   0 ed        (1000) ed        (1000)     6436 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/cfg.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1548 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/dxml.py
--rw-r--r--   0 ed        (1000) ed        (1000)     3932 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/fsutil.py
--rw-r--r--   0 ed        (1000) ed        (1000)    13841 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/ftpd.py
--rw-r--r--   0 ed        (1000) ed        (1000)   119888 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/httpcli.py
--rw-r--r--   0 ed        (1000) ed        (1000)     6674 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/httpconn.py
--rw-r--r--   0 ed        (1000) ed        (1000)    14143 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/httpsrv.py
--rw-r--r--   0 ed        (1000) ed        (1000)     2643 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/ico.py
--rw-r--r--   0 ed        (1000) ed        (1000)    16978 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/mdns.py
--rw-r--r--   0 ed        (1000) ed        (1000)    16844 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/mtag.py
--rw-r--r--   0 ed        (1000) ed        (1000)    11520 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/multicast.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.974793 copyparty-1.6.9/copyparty/res/
--rw-r--r--   0 ed        (1000) ed        (1000)    10570 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/res/COPYING.txt
--rw-r--r--   0 ed        (1000) ed        (1000)     2876 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/res/insecure.pem
--rw-r--r--   0 ed        (1000) ed        (1000)    10616 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/smbd.py
--rw-r--r--   0 ed        (1000) ed        (1000)     6153 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/ssdp.py
--rw-r--r--   0 ed        (1000) ed        (1000)     2699 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/star.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.974793 copyparty-1.6.9/copyparty/stolen/
--rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/__init__.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.975793 copyparty-1.6.9/copyparty/stolen/dnslib/
--rw-r--r--   0 ed        (1000) ed        (1000)      159 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/__init__.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1182 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/bimap.py
--rw-r--r--   0 ed        (1000) ed        (1000)      348 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/bit.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1407 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/buffer.py
--rw-r--r--   0 ed        (1000) ed        (1000)    20956 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/dns.py
--rw-r--r--   0 ed        (1000) ed        (1000)     4893 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/label.py
--rw-r--r--   0 ed        (1000) ed        (1000)     2615 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/lex.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1810 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/dnslib/ranges.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.975793 copyparty-1.6.9/copyparty/stolen/ifaddr/
--rw-r--r--   0 ed        (1000) ed        (1000)      463 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/ifaddr/__init__.py
--rw-r--r--   0 ed        (1000) ed        (1000)     2626 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/ifaddr/_posix.py
--rw-r--r--   0 ed        (1000) ed        (1000)     6111 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/ifaddr/_shared.py
--rw-r--r--   0 ed        (1000) ed        (1000)     4026 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/ifaddr/_win32.py
--rw-r--r--   0 ed        (1000) ed        (1000)    21469 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/qrcodegen.py
--rw-r--r--   0 ed        (1000) ed        (1000)     5573 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/stolen/surrogateescape.py
--rw-r--r--   0 ed        (1000) ed        (1000)      972 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/sutil.py
--rw-r--r--   0 ed        (1000) ed        (1000)    22903 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/svchub.py
--rw-r--r--   0 ed        (1000) ed        (1000)     8166 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/szip.py
--rw-r--r--   0 ed        (1000) ed        (1000)    16633 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/tcpsrv.py
--rw-r--r--   0 ed        (1000) ed        (1000)     3826 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/th_cli.py
--rw-r--r--   0 ed        (1000) ed        (1000)    20969 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/th_srv.py
--rw-r--r--   0 ed        (1000) ed        (1000)    10493 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/u2idx.py
--rw-r--r--   0 ed        (1000) ed        (1000)   121148 2023-03-16 22:10:55.000000 copyparty-1.6.9/copyparty/up2k.py
--rw-r--r--   0 ed        (1000) ed        (1000)    71782 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/util.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.978793 copyparty-1.6.9/copyparty/web/
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.979793 copyparty-1.6.9/copyparty/web/a/
--rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/web/a/__init__.py
--rwxr-xr-x   0 ed        (1000) ed        (1000)    32276 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/web/a/partyfuse.py
--rwxr-xr-x   0 ed        (1000) ed        (1000)    35130 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/web/a/up2k.py
--rw-r--r--   0 ed        (1000) ed        (1000)     1449 2023-02-20 20:21:49.000000 copyparty-1.6.9/copyparty/web/a/webdav-cfg.bat
--rw-r--r--   0 ed        (1000) ed        (1000)     7282 2023-01-08 13:51:21.000000 copyparty-1.6.9/copyparty/web/baguettebox.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)    10925 2023-03-16 20:21:53.000000 copyparty-1.6.9/copyparty/web/browser.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     5286 2023-03-15 22:20:24.000000 copyparty-1.6.9/copyparty/web/browser.html
--rw-r--r--   0 ed        (1000) ed        (1000)    57351 2023-03-16 20:51:53.000000 copyparty-1.6.9/copyparty/web/browser.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     1604 2022-12-10 19:54:48.000000 copyparty-1.6.9/copyparty/web/browser2.html
--rw-r--r--   0 ed        (1000) ed        (1000)      585 2022-07-03 13:28:49.000000 copyparty-1.6.9/copyparty/web/cf.html
--rw-r--r--   0 ed        (1000) ed        (1000)      126 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/copyparty.gif
--rw-r--r--   0 ed        (1000) ed        (1000)      687 2022-07-14 21:26:48.000000 copyparty-1.6.9/copyparty/web/dbg-audio.js.gz
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.980793 copyparty-1.6.9/copyparty/web/dd/
--rw-r--r--   0 ed        (1000) ed        (1000)      258 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/dd/2.png
--rw-r--r--   0 ed        (1000) ed        (1000)      252 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/dd/3.png
--rw-r--r--   0 ed        (1000) ed        (1000)      248 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/dd/4.png
--rw-r--r--   0 ed        (1000) ed        (1000)      250 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/dd/5.png
--rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/web/dd/__init__.py
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.983793 copyparty-1.6.9/copyparty/web/deps/
--rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-03-16 22:10:54.000000 copyparty-1.6.9/copyparty/web/deps/__init__.py
--rw-rw-r--   0 ed        (1000) ed        (1000)     3053 2022-12-20 10:12:25.000000 copyparty-1.6.9/copyparty/web/deps/easymde.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)    76951 2022-12-29 03:38:30.000000 copyparty-1.6.9/copyparty/web/deps/easymde.js.gz
--rw-rw-r--   0 ed        (1000) ed        (1000)    14556 2022-12-29 03:37:35.000000 copyparty-1.6.9/copyparty/web/deps/marked.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)      584 2022-12-29 03:38:53.000000 copyparty-1.6.9/copyparty/web/deps/mini-fa.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     2784 2022-12-29 03:38:54.000000 copyparty-1.6.9/copyparty/web/deps/mini-fa.woff
--rw-r--r--   0 ed        (1000) ed        (1000)     1478 2022-12-29 03:41:18.000000 copyparty-1.6.9/copyparty/web/deps/prism.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)    41428 2022-12-29 03:41:18.000000 copyparty-1.6.9/copyparty/web/deps/prism.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     1647 2022-12-29 03:41:18.000000 copyparty-1.6.9/copyparty/web/deps/prismd.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     8612 2022-12-29 03:38:54.000000 copyparty-1.6.9/copyparty/web/deps/scp.woff2
--rw-r--r--   0 ed        (1000) ed        (1000)     7043 2022-12-29 03:37:01.000000 copyparty-1.6.9/copyparty/web/deps/sha512.ac.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     8119 2021-07-22 23:48:12.000000 copyparty-1.6.9/copyparty/web/deps/sha512.hw.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     2011 2022-10-30 15:38:07.000000 copyparty-1.6.9/copyparty/web/md.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     4063 2022-12-10 20:27:29.000000 copyparty-1.6.9/copyparty/web/md.html
--rw-r--r--   0 ed        (1000) ed        (1000)     4112 2022-12-01 22:41:40.000000 copyparty-1.6.9/copyparty/web/md.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)      680 2022-12-01 22:41:28.000000 copyparty-1.6.9/copyparty/web/md2.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     8209 2023-01-25 20:58:01.000000 copyparty-1.6.9/copyparty/web/md2.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)      929 2022-04-15 15:07:16.000000 copyparty-1.6.9/copyparty/web/mde.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     1640 2022-12-10 20:27:33.000000 copyparty-1.6.9/copyparty/web/mde.html
--rw-r--r--   0 ed        (1000) ed        (1000)     2218 2022-12-01 07:23:41.000000 copyparty-1.6.9/copyparty/web/mde.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)      252 2021-09-11 12:44:53.000000 copyparty-1.6.9/copyparty/web/msg.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)      898 2022-12-10 19:57:40.000000 copyparty-1.6.9/copyparty/web/msg.html
--rw-r--r--   0 ed        (1000) ed        (1000)      927 2023-02-17 22:46:57.000000 copyparty-1.6.9/copyparty/web/splash.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     3741 2023-02-19 19:41:20.000000 copyparty-1.6.9/copyparty/web/splash.html
--rw-r--r--   0 ed        (1000) ed        (1000)     1235 2023-02-17 22:28:18.000000 copyparty-1.6.9/copyparty/web/splash.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     9354 2023-03-06 02:42:55.000000 copyparty-1.6.9/copyparty/web/svcs.html
--rw-r--r--   0 ed        (1000) ed        (1000)      519 2022-12-04 17:10:33.000000 copyparty-1.6.9/copyparty/web/svcs.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     2377 2023-02-02 22:14:39.000000 copyparty-1.6.9/copyparty/web/ui.css.gz
--rw-r--r--   0 ed        (1000) ed        (1000)    21538 2023-03-06 02:35:26.000000 copyparty-1.6.9/copyparty/web/up2k.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)    12616 2023-03-16 19:44:44.000000 copyparty-1.6.9/copyparty/web/util.js.gz
--rw-r--r--   0 ed        (1000) ed        (1000)     1059 2023-03-02 22:42:45.000000 copyparty-1.6.9/copyparty/web/w.hash.js.gz
-drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-03-16 22:12:28.973793 copyparty-1.6.9/copyparty.egg-info/
--rw-r--r--   0 ed        (1000) ed        (1000)    82692 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/PKG-INFO
--rw-r--r--   0 ed        (1000) ed        (1000)     2828 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/SOURCES.txt
--rw-r--r--   0 ed        (1000) ed        (1000)        1 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/dependency_links.txt
--rw-r--r--   0 ed        (1000) ed        (1000)       54 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/entry_points.txt
--rw-r--r--   0 ed        (1000) ed        (1000)      117 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/requires.txt
--rw-r--r--   0 ed        (1000) ed        (1000)       10 2023-03-16 22:12:28.000000 copyparty-1.6.9/copyparty.egg-info/top_level.txt
--rw-r--r--   0 ed        (1000) ed        (1000)       38 2023-03-16 22:12:28.984793 copyparty-1.6.9/setup.cfg
--rwxr-xr-x   0 ed        (1000) ed        (1000)     4479 2023-02-15 18:44:28.000000 copyparty-1.6.9/setup.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.663016 copyparty-1.7.0/
+-rw-r--r--   0 ed        (1000) ed        (1000)     1059 2021-09-11 12:44:53.000000 copyparty-1.7.0/LICENSE
+-rw-r--r--   0 ed        (1000) ed        (1000)      102 2023-04-29 22:23:53.000000 copyparty-1.7.0/MANIFEST.in
+-rw-r--r--   0 ed        (1000) ed        (1000)    94511 2023-04-29 22:23:54.663016 copyparty-1.7.0/PKG-INFO
+-rw-r--r--   0 ed        (1000) ed        (1000)    92715 2023-04-29 21:30:48.000000 copyparty-1.7.0/README.md
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.649016 copyparty-1.7.0/bin/
+-rwxr-xr-x   0 ed        (1000) ed        (1000)    32276 2023-04-29 22:22:13.000000 copyparty-1.7.0/bin/partyfuse.py
+-rwxr-xr-x   0 ed        (1000) ed        (1000)    36249 2023-04-29 22:22:13.000000 copyparty-1.7.0/bin/up2k.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.653016 copyparty-1.7.0/copyparty/
+-rw-r--r--   0 ed        (1000) ed        (1000)     1063 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/__init__.py
+-rwxr-xr-x   0 ed        (1000) ed        (1000)    68599 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/__main__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)      249 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/__version__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    65210 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/authsrv.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.653016 copyparty-1.7.0/copyparty/bos/
+-rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/bos/__init__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1560 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/bos/bos.py
+-rw-r--r--   0 ed        (1000) ed        (1000)      777 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/bos/path.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     3590 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/broker_mp.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     3200 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/broker_mpw.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1759 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/broker_thr.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1489 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/broker_util.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     6617 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/cfg.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1548 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/dxml.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     3932 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/fsutil.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    15239 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/ftpd.py
+-rw-r--r--   0 ed        (1000) ed        (1000)   122389 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/httpcli.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     6891 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/httpconn.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    15141 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/httpsrv.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     2643 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/ico.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    16978 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/mdns.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    16844 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/mtag.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    11520 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/multicast.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.654016 copyparty-1.7.0/copyparty/res/
+-rw-r--r--   0 ed        (1000) ed        (1000)    10570 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/res/COPYING.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)     2876 2023-04-23 21:16:05.000000 copyparty-1.7.0/copyparty/res/insecure.pem
+-rw-r--r--   0 ed        (1000) ed        (1000)    10623 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/smbd.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     6153 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/ssdp.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     2699 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/star.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.654016 copyparty-1.7.0/copyparty/stolen/
+-rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/__init__.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.655016 copyparty-1.7.0/copyparty/stolen/dnslib/
+-rw-r--r--   0 ed        (1000) ed        (1000)      159 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/__init__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1182 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/bimap.py
+-rw-r--r--   0 ed        (1000) ed        (1000)      348 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/bit.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1407 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/buffer.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    20956 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/dns.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     4893 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/label.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     2615 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/lex.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1810 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/dnslib/ranges.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.655016 copyparty-1.7.0/copyparty/stolen/ifaddr/
+-rw-r--r--   0 ed        (1000) ed        (1000)      463 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/ifaddr/__init__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     2626 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/ifaddr/_posix.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     6111 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/ifaddr/_shared.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     4026 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/ifaddr/_win32.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    21469 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/qrcodegen.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     5573 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/stolen/surrogateescape.py
+-rw-r--r--   0 ed        (1000) ed        (1000)      972 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/sutil.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    23625 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/svchub.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     8166 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/szip.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    16643 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/tcpsrv.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     3826 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/th_cli.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    22379 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/th_srv.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    10585 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/u2idx.py
+-rw-r--r--   0 ed        (1000) ed        (1000)   121985 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/up2k.py
+-rw-r--r--   0 ed        (1000) ed        (1000)    71964 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/util.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.658016 copyparty-1.7.0/copyparty/web/
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.659016 copyparty-1.7.0/copyparty/web/a/
+-rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/web/a/__init__.py
+-rwxr-xr-x   0 ed        (1000) ed        (1000)    32276 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/web/a/partyfuse.py
+-rwxr-xr-x   0 ed        (1000) ed        (1000)    36249 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/web/a/up2k.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     1449 2023-02-20 20:21:49.000000 copyparty-1.7.0/copyparty/web/a/webdav-cfg.bat
+-rw-r--r--   0 ed        (1000) ed        (1000)     7295 2023-03-30 21:17:33.000000 copyparty-1.7.0/copyparty/web/baguettebox.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    10956 2023-04-27 21:10:24.000000 copyparty-1.7.0/copyparty/web/browser.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     5286 2023-03-15 22:20:24.000000 copyparty-1.7.0/copyparty/web/browser.html
+-rw-r--r--   0 ed        (1000) ed        (1000)    59012 2023-04-29 09:29:49.000000 copyparty-1.7.0/copyparty/web/browser.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     1604 2022-12-10 19:54:48.000000 copyparty-1.7.0/copyparty/web/browser2.html
+-rw-r--r--   0 ed        (1000) ed        (1000)      585 2022-07-03 13:28:49.000000 copyparty-1.7.0/copyparty/web/cf.html
+-rw-r--r--   0 ed        (1000) ed        (1000)      126 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/copyparty.gif
+-rw-r--r--   0 ed        (1000) ed        (1000)      687 2022-07-14 21:26:48.000000 copyparty-1.7.0/copyparty/web/dbg-audio.js.gz
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.660016 copyparty-1.7.0/copyparty/web/dd/
+-rw-r--r--   0 ed        (1000) ed        (1000)      258 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/dd/2.png
+-rw-r--r--   0 ed        (1000) ed        (1000)      252 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/dd/3.png
+-rw-r--r--   0 ed        (1000) ed        (1000)      248 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/dd/4.png
+-rw-r--r--   0 ed        (1000) ed        (1000)      250 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/dd/5.png
+-rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/web/dd/__init__.py
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.662016 copyparty-1.7.0/copyparty/web/deps/
+-rw-r--r--   0 ed        (1000) ed        (1000)        0 2023-04-29 22:22:13.000000 copyparty-1.7.0/copyparty/web/deps/__init__.py
+-rw-r--r--   0 ed        (1000) ed        (1000)     3053 2023-02-20 10:55:39.000000 copyparty-1.7.0/copyparty/web/deps/easymde.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    76953 2023-04-01 14:48:07.000000 copyparty-1.7.0/copyparty/web/deps/easymde.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    14819 2023-04-01 14:47:51.000000 copyparty-1.7.0/copyparty/web/deps/marked.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)      584 2023-04-01 14:48:09.000000 copyparty-1.7.0/copyparty/web/deps/mini-fa.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     2784 2023-04-01 14:48:09.000000 copyparty-1.7.0/copyparty/web/deps/mini-fa.woff
+-rw-r--r--   0 ed        (1000) ed        (1000)     1478 2022-12-29 03:41:18.000000 copyparty-1.7.0/copyparty/web/deps/prism.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    41428 2022-12-29 03:41:18.000000 copyparty-1.7.0/copyparty/web/deps/prism.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     1647 2022-12-29 03:41:18.000000 copyparty-1.7.0/copyparty/web/deps/prismd.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     8612 2023-04-01 14:48:10.000000 copyparty-1.7.0/copyparty/web/deps/scp.woff2
+-rw-r--r--   0 ed        (1000) ed        (1000)     7043 2023-04-01 14:23:12.000000 copyparty-1.7.0/copyparty/web/deps/sha512.ac.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     8119 2021-07-22 23:48:12.000000 copyparty-1.7.0/copyparty/web/deps/sha512.hw.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     2011 2022-10-30 15:38:07.000000 copyparty-1.7.0/copyparty/web/md.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     4063 2022-12-10 20:27:29.000000 copyparty-1.7.0/copyparty/web/md.html
+-rw-r--r--   0 ed        (1000) ed        (1000)     4121 2023-03-26 01:52:00.000000 copyparty-1.7.0/copyparty/web/md.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)      680 2022-12-01 22:41:28.000000 copyparty-1.7.0/copyparty/web/md2.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     8209 2023-01-25 20:58:01.000000 copyparty-1.7.0/copyparty/web/md2.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)      929 2022-04-15 15:07:16.000000 copyparty-1.7.0/copyparty/web/mde.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     1640 2022-12-10 20:27:33.000000 copyparty-1.7.0/copyparty/web/mde.html
+-rw-r--r--   0 ed        (1000) ed        (1000)     2218 2022-12-01 07:23:41.000000 copyparty-1.7.0/copyparty/web/mde.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)      252 2021-09-11 12:44:53.000000 copyparty-1.7.0/copyparty/web/msg.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)      898 2022-12-10 19:57:40.000000 copyparty-1.7.0/copyparty/web/msg.html
+-rw-r--r--   0 ed        (1000) ed        (1000)      927 2023-02-17 22:46:57.000000 copyparty-1.7.0/copyparty/web/splash.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     3741 2023-02-19 19:41:20.000000 copyparty-1.7.0/copyparty/web/splash.html
+-rw-r--r--   0 ed        (1000) ed        (1000)     1235 2023-02-17 22:28:18.000000 copyparty-1.7.0/copyparty/web/splash.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    10612 2023-04-24 00:08:26.000000 copyparty-1.7.0/copyparty/web/svcs.html
+-rw-r--r--   0 ed        (1000) ed        (1000)      519 2022-12-04 17:10:33.000000 copyparty-1.7.0/copyparty/web/svcs.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     2418 2023-03-26 02:06:03.000000 copyparty-1.7.0/copyparty/web/ui.css.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    21538 2023-03-06 02:35:26.000000 copyparty-1.7.0/copyparty/web/up2k.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)    13078 2023-03-30 20:54:19.000000 copyparty-1.7.0/copyparty/web/util.js.gz
+-rw-r--r--   0 ed        (1000) ed        (1000)     1059 2023-03-02 22:42:45.000000 copyparty-1.7.0/copyparty/web/w.hash.js.gz
+drwxr-xr-x   0 ed        (1000) ed        (1000)        0 2023-04-29 22:23:54.653016 copyparty-1.7.0/copyparty.egg-info/
+-rw-r--r--   0 ed        (1000) ed        (1000)    94511 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/PKG-INFO
+-rw-r--r--   0 ed        (1000) ed        (1000)     2828 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/SOURCES.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)        1 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/dependency_links.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)       54 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/entry_points.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)      117 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/requires.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)       10 2023-04-29 22:23:54.000000 copyparty-1.7.0/copyparty.egg-info/top_level.txt
+-rw-r--r--   0 ed        (1000) ed        (1000)       38 2023-04-29 22:23:54.663016 copyparty-1.7.0/setup.cfg
+-rwxr-xr-x   0 ed        (1000) ed        (1000)     4479 2023-02-15 18:44:28.000000 copyparty-1.7.0/setup.py
```

### Comparing `copyparty-1.6.9/LICENSE` & `copyparty-1.7.0/LICENSE`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/PKG-INFO` & `copyparty-1.7.0/PKG-INFO`

 * *Files 7% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000010: 3a20 322e 310a 4e61 6d65 3a20 636f 7079  : 2.1.Name: copy
 00000020: 7061 7274 790a 5665 7273 696f 6e3a 2031  party.Version: 1
-00000030: 2e36 2e39 0a53 756d 6d61 7279 3a20 506f  .6.9.Summary: Po
+00000030: 2e37 2e30 0a53 756d 6d61 7279 3a20 506f  .7.0.Summary: Po
 00000040: 7274 6162 6c65 2066 696c 6520 7365 7276  rtable file serv
 00000050: 6572 2077 6974 6820 6163 6365 6c65 7261  er with accelera
 00000060: 7465 6420 7265 7375 6d61 626c 6520 7570  ted resumable up
 00000070: 6c6f 6164 732c 2064 6564 7570 6c69 6361  loads, deduplica
 00000080: 7469 6f6e 2c20 5765 6244 4156 2c20 4654  tion, WebDAV, FT
 00000090: 502c 207a 6572 6f63 6f6e 662c 206d 6564  P, zeroconf, med
 000000a0: 6961 2069 6e64 6578 6572 2c20 7669 6465  ia indexer, vide
@@ -107,5063 +107,5801 @@
 000006a0: 6d62 6e61 696c 7332 0a50 726f 7669 6465  mbnails2.Provide
 000006b0: 732d 4578 7472 613a 2061 7564 696f 7461  s-Extra: audiota
 000006c0: 6773 0a50 726f 7669 6465 732d 4578 7472  gs.Provides-Extr
 000006d0: 613a 2066 7470 640a 5072 6f76 6964 6573  a: ftpd.Provides
 000006e0: 2d45 7874 7261 3a20 6674 7073 0a4c 6963  -Extra: ftps.Lic
 000006f0: 656e 7365 2d46 696c 653a 204c 4943 454e  ense-File: LICEN
 00000700: 5345 0a0a 2320 f09f 92be f09f 8e89 2063  SE..# ........ c
-00000710: 6f70 7970 6172 7479 0a0a 2a20 706f 7274  opyparty..* port
-00000720: 6162 6c65 2066 696c 6520 7368 6172 696e  able file sharin
-00000730: 6720 6875 6220 2870 7932 2f70 7933 2920  g hub (py2/py3) 
-00000740: 5b28 6f6e 2050 7950 4929 5d28 6874 7470  [(on PyPI)](http
-00000750: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
-00000760: 6a65 6374 2f63 6f70 7970 6172 7479 2f29  ject/copyparty/)
-00000770: 0a2a 204d 4954 2d4c 6963 656e 7365 642c  .* MIT-Licensed,
-00000780: 2032 3031 392d 3035 2d32 362c 2065 6420   2019-05-26, ed 
-00000790: 4020 6972 632e 7269 7a6f 6e2e 6e65 740a  @ irc.rizon.net.
-000007a0: 0a0a 2323 2073 756d 6d61 7279 0a0a 7475  ..## summary..tu
-000007b0: 726e 2079 6f75 7220 7068 6f6e 6520 6f72  rn your phone or
-000007c0: 2072 6173 7069 2069 6e74 6f20 6120 706f   raspi into a po
-000007d0: 7274 6162 6c65 2066 696c 6520 7365 7276  rtable file serv
-000007e0: 6572 2077 6974 6820 7265 7375 6d61 626c  er with resumabl
-000007f0: 6520 7570 6c6f 6164 732f 646f 776e 6c6f  e uploads/downlo
-00000800: 6164 7320 7573 696e 6720 2a61 6e79 2a20  ads using *any* 
-00000810: 7765 6220 6272 6f77 7365 720a 0a2a 2073  web browser..* s
-00000820: 6572 7665 7220 6f6e 6c79 206e 6565 6473  erver only needs
-00000830: 2050 7974 686f 6e20 2860 322e 3760 206f   Python (`2.7` o
-00000840: 7220 6033 2e33 2b60 292c 2061 6c6c 2064  r `3.3+`), all d
-00000850: 6570 656e 6465 6e63 6965 7320 6f70 7469  ependencies opti
-00000860: 6f6e 616c 0a2a 2062 726f 7773 652f 7570  onal.* browse/up
-00000870: 6c6f 6164 2077 6974 6820 5b49 4534 5d28  load with [IE4](
-00000880: 2362 726f 7773 6572 2d73 7570 706f 7274  #browser-support
-00000890: 2920 2f20 6e65 7473 6361 7065 342e 3020  ) / netscape4.0 
-000008a0: 6f6e 2077 696e 332e 3131 2028 6865 6829  on win3.11 (heh)
-000008b0: 0a2a 2070 726f 746f 636f 6c73 3a20 5b68  .* protocols: [h
-000008c0: 7474 705d 2823 7468 652d 6272 6f77 7365  ttp](#the-browse
-000008d0: 7229 202f 2f20 5b66 7470 5d28 2366 7470  r) // [ftp](#ftp
-000008e0: 2d73 6572 7665 7229 202f 2f20 5b77 6562  -server) // [web
-000008f0: 6461 765d 2823 7765 6264 6176 2d73 6572  dav](#webdav-ser
-00000900: 7665 7229 202f 2f20 5b73 6d62 2f63 6966  ver) // [smb/cif
-00000910: 735d 2823 736d 622d 7365 7276 6572 290a  s](#smb-server).
-00000920: 0a2a 2a5b 4765 7420 7374 6172 7465 645d  .**[Get started]
-00000930: 2823 7175 6963 6b73 7461 7274 2921 2a2a  (#quickstart)!**
-00000940: 206f 7220 7669 7369 7420 7468 6520 2a2a   or visit the **
-00000950: 5b72 6561 642d 6f6e 6c79 2064 656d 6f20  [read-only demo 
-00000960: 7365 7276 6572 5d28 6874 7470 733a 2f2f  server](https://
-00000970: 612e 6f63 762e 6d65 2f70 7562 2f64 656d  a.ocv.me/pub/dem
-00000980: 6f2f 292a 2a20 f09f 9180 2072 756e 6e69  o/)** .... runni
-00000990: 6e67 2066 726f 6d20 6120 6261 7365 6d65  ng from a baseme
-000009a0: 6e74 2069 6e20 6669 6e6c 616e 640a 0af0  nt in finland...
-000009b0: 9f93 b720 2a2a 7363 7265 656e 7368 6f74  ... **screenshot
-000009c0: 733a 2a2a 205b 6272 6f77 7365 725d 2823  s:** [browser](#
-000009d0: 7468 652d 6272 6f77 7365 7229 202f 2f20  the-browser) // 
-000009e0: 5b75 706c 6f61 645d 2823 7570 6c6f 6164  [upload](#upload
-000009f0: 696e 6729 202f 2f20 5b75 6e70 6f73 745d  ing) // [unpost]
-00000a00: 2823 756e 706f 7374 2920 2f2f 205b 7468  (#unpost) // [th
-00000a10: 756d 626e 6169 6c73 5d28 2374 6875 6d62  umbnails](#thumb
-00000a20: 6e61 696c 7329 202f 2f20 5b73 6561 7263  nails) // [searc
-00000a30: 685d 2823 7365 6172 6368 696e 6729 202f  h](#searching) /
-00000a40: 2f20 5b66 7365 6172 6368 5d28 2366 696c  / [fsearch](#fil
-00000a50: 652d 7365 6172 6368 2920 2f2f 205b 7a69  e-search) // [zi
-00000a60: 702d 444c 5d28 237a 6970 2d64 6f77 6e6c  p-DL](#zip-downl
-00000a70: 6f61 6473 2920 2f2f 205b 6d64 2d76 6965  oads) // [md-vie
-00000a80: 7765 725d 2823 6d61 726b 646f 776e 2d76  wer](#markdown-v
-00000a90: 6965 7765 7229 0a0a 0a23 2320 6765 7420  iewer)...## get 
-00000aa0: 7468 6520 6170 700a 0a3c 6120 6872 6566  the app..<a href
-00000ab0: 3d22 6874 7470 733a 2f2f 662d 6472 6f69  ="https://f-droi
-00000ac0: 642e 6f72 672f 7061 636b 6167 6573 2f6d  d.org/packages/m
-00000ad0: 652e 6f63 762e 7061 7274 7975 702f 223e  e.ocv.partyup/">
-00000ae0: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
-00000af0: 2f2f 6f63 762e 6d65 2f66 6472 6f69 642e  //ocv.me/fdroid.
-00000b00: 706e 6722 2061 6c74 3d22 4765 7420 6974  png" alt="Get it
-00000b10: 206f 6e20 462d 4472 6f69 6422 2068 6569   on F-Droid" hei
-00000b20: 6768 743d 2235 3022 202f 3e20 2727 203c  ght="50" /> '' <
-00000b30: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
-00000b40: 2f69 6d67 2e73 6869 656c 6473 2e69 6f2f  /img.shields.io/
-00000b50: 662d 6472 6f69 642f 762f 6d65 2e6f 6376  f-droid/v/me.ocv
-00000b60: 2e70 6172 7479 7570 2e73 7667 2220 616c  .partyup.svg" al
-00000b70: 743d 2266 2d64 726f 6964 2076 6572 7369  t="f-droid versi
-00000b80: 6f6e 2069 6e66 6f22 202f 3e3c 2f61 3e20  on info" /></a> 
-00000b90: 2727 203c 6120 6872 6566 3d22 6874 7470  '' <a href="http
-00000ba0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
-00000bb0: 3030 312f 7061 7274 792d 7570 223e 3c69  001/party-up"><i
-00000bc0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-00000bd0: 696d 672e 7368 6965 6c64 732e 696f 2f67  img.shields.io/g
-00000be0: 6974 6875 622f 7265 6c65 6173 652f 3930  ithub/release/90
-00000bf0: 3031 2f70 6172 7479 2d75 702e 7376 673f  01/party-up.svg?
-00000c00: 6c6f 676f 3d67 6974 6875 6222 2061 6c74  logo=github" alt
-00000c10: 3d22 6769 7468 7562 2076 6572 7369 6f6e  ="github version
-00000c20: 2069 6e66 6f22 202f 3e3c 2f61 3e0a 0a28   info" /></a>..(
-00000c30: 7468 6520 6170 7020 6973 202a 2a4e 4f54  the app is **NOT
-00000c40: 2a2a 2074 6865 2066 756c 6c20 636f 7079  ** the full copy
-00000c50: 7061 7274 7920 7365 7276 6572 2120 6a75  party server! ju
-00000c60: 7374 2061 2062 6173 6963 2075 706c 6f61  st a basic uploa
-00000c70: 6420 636c 6965 6e74 2c20 6e6f 7468 696e  d client, nothin
-00000c80: 6720 6661 6e63 7920 7965 7429 0a0a 0a23  g fancy yet)...#
-00000c90: 2320 7265 6164 6d65 2074 6f63 0a0a 2a20  # readme toc..* 
-00000ca0: 746f 700a 2020 2020 2a20 5b71 7569 636b  top.    * [quick
-00000cb0: 7374 6172 745d 2823 7175 6963 6b73 7461  start](#quicksta
-00000cc0: 7274 2920 2d20 6a75 7374 2072 756e 202a  rt) - just run *
-00000cd0: 2a5b 636f 7079 7061 7274 792d 7366 782e  *[copyparty-sfx.
-00000ce0: 7079 5d28 6874 7470 733a 2f2f 6769 7468  py](https://gith
-00000cf0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00000d00: 7061 7274 792f 7265 6c65 6173 6573 2f6c  party/releases/l
-00000d10: 6174 6573 742f 646f 776e 6c6f 6164 2f63  atest/download/c
-00000d20: 6f70 7970 6172 7479 2d73 6678 2e70 7929  opyparty-sfx.py)
-00000d30: 2a2a 202d 2d20 7468 6174 2773 2069 7421  ** -- that's it!
-00000d40: 20f0 9f8e 890a 2020 2020 2020 2020 2a20   .....        * 
-00000d50: 5b6f 6e20 7365 7276 6572 735d 2823 6f6e  [on servers](#on
-00000d60: 2d73 6572 7665 7273 2920 2d20 796f 7520  -servers) - you 
-00000d70: 6d61 7920 616c 736f 2077 616e 7420 7468  may also want th
-00000d80: 6573 652c 2065 7370 6563 6961 6c6c 7920  ese, especially 
-00000d90: 6f6e 2073 6572 7665 7273 0a20 2020 202a  on servers.    *
-00000da0: 205b 6665 6174 7572 6573 5d28 2366 6561   [features](#fea
-00000db0: 7475 7265 7329 0a20 2020 202a 205b 7465  tures).    * [te
-00000dc0: 7374 696d 6f6e 6961 6c73 5d28 2374 6573  stimonials](#tes
-00000dd0: 7469 6d6f 6e69 616c 7329 202d 2073 6d61  timonials) - sma
-00000de0: 6c6c 2063 6f6c 6c65 6374 696f 6e20 6f66  ll collection of
-00000df0: 2075 7365 7220 6665 6564 6261 636b 0a2a   user feedback.*
-00000e00: 205b 6d6f 7469 7661 7469 6f6e 735d 2823   [motivations](#
-00000e10: 6d6f 7469 7661 7469 6f6e 7329 202d 2070  motivations) - p
-00000e20: 726f 6a65 6374 2067 6f61 6c73 202f 2070  roject goals / p
-00000e30: 6869 6c6f 736f 7068 790a 2020 2020 2a20  hilosophy.    * 
-00000e40: 5b6e 6f74 6573 5d28 236e 6f74 6573 2920  [notes](#notes) 
-00000e50: 2d20 6765 6e65 7261 6c20 6e6f 7465 730a  - general notes.
-00000e60: 2a20 5b62 7567 735d 2823 6275 6773 290a  * [bugs](#bugs).
-00000e70: 2020 2020 2a20 5b67 656e 6572 616c 2062      * [general b
-00000e80: 7567 735d 2823 6765 6e65 7261 6c2d 6275  ugs](#general-bu
-00000e90: 6773 290a 2020 2020 2a20 5b6e 6f74 206d  gs).    * [not m
-00000ea0: 7920 6275 6773 5d28 236e 6f74 2d6d 792d  y bugs](#not-my-
-00000eb0: 6275 6773 290a 2a20 5b62 7265 616b 696e  bugs).* [breakin
-00000ec0: 6720 6368 616e 6765 735d 2823 6272 6561  g changes](#brea
-00000ed0: 6b69 6e67 2d63 6861 6e67 6573 2920 2d20  king-changes) - 
-00000ee0: 7570 6772 6164 6520 6e6f 7465 730a 2a20  upgrade notes.* 
-00000ef0: 5b46 4151 5d28 2346 4151 2920 2d20 2266  [FAQ](#FAQ) - "f
-00000f00: 7265 7175 656e 746c 7922 2061 736b 6564  requently" asked
-00000f10: 2071 7565 7374 696f 6e73 0a2a 205b 6163   questions.* [ac
-00000f20: 636f 756e 7473 2061 6e64 2076 6f6c 756d  counts and volum
-00000f30: 6573 5d28 2361 6363 6f75 6e74 732d 616e  es](#accounts-an
-00000f40: 642d 766f 6c75 6d65 7329 202d 2070 6572  d-volumes) - per
-00000f50: 2d66 6f6c 6465 722c 2070 6572 2d75 7365  -folder, per-use
-00000f60: 7220 7065 726d 6973 7369 6f6e 730a 2020  r permissions.  
-00000f70: 2020 2a20 5b73 6861 646f 7769 6e67 5d28    * [shadowing](
-00000f80: 2373 6861 646f 7769 6e67 2920 2d20 6869  #shadowing) - hi
-00000f90: 6469 6e67 2073 7065 6369 6669 6320 7375  ding specific su
-00000fa0: 6266 6f6c 6465 7273 0a2a 205b 7468 6520  bfolders.* [the 
-00000fb0: 6272 6f77 7365 725d 2823 7468 652d 6272  browser](#the-br
-00000fc0: 6f77 7365 7229 202d 2061 6363 6573 7369  owser) - accessi
-00000fd0: 6e67 2061 2063 6f70 7970 6172 7479 2073  ng a copyparty s
-00000fe0: 6572 7665 7220 7573 696e 6720 6120 7765  erver using a we
-00000ff0: 622d 6272 6f77 7365 720a 2020 2020 2a20  b-browser.    * 
-00001000: 5b74 6162 735d 2823 7461 6273 2920 2d20  [tabs](#tabs) - 
-00001010: 7468 6520 6d61 696e 2074 6162 7320 696e  the main tabs in
-00001020: 2074 6865 2075 690a 2020 2020 2a20 5b68   the ui.    * [h
-00001030: 6f74 6b65 7973 5d28 2368 6f74 6b65 7973  otkeys](#hotkeys
-00001040: 2920 2d20 7468 6520 6272 6f77 7365 7220  ) - the browser 
-00001050: 6861 7320 7468 6520 666f 6c6c 6f77 696e  has the followin
-00001060: 6720 686f 746b 6579 730a 2020 2020 2a20  g hotkeys.    * 
-00001070: 5b6e 6176 7061 6e65 5d28 236e 6176 7061  [navpane](#navpa
-00001080: 6e65 2920 2d20 7377 6974 6368 696e 6720  ne) - switching 
-00001090: 6265 7477 6565 6e20 6272 6561 6463 7275  between breadcru
-000010a0: 6d62 7320 6f72 206e 6176 7061 6e65 0a20  mbs or navpane. 
-000010b0: 2020 202a 205b 7468 756d 626e 6169 6c73     * [thumbnails
-000010c0: 5d28 2374 6875 6d62 6e61 696c 7329 202d  ](#thumbnails) -
-000010d0: 2070 7265 7373 2060 6760 206f 7220 60e7   press `g` or `.
-000010e0: 94b0 6020 746f 2074 6f67 676c 6520 6772  ..` to toggle gr
-000010f0: 6964 2d76 6965 7720 696e 7374 6561 6420  id-view instead 
-00001100: 6f66 2074 6865 2066 696c 6520 6c69 7374  of the file list
-00001110: 696e 670a 2020 2020 2a20 5b7a 6970 2064  ing.    * [zip d
-00001120: 6f77 6e6c 6f61 6473 5d28 237a 6970 2d64  ownloads](#zip-d
-00001130: 6f77 6e6c 6f61 6473 2920 2d20 646f 776e  ownloads) - down
-00001140: 6c6f 6164 2066 6f6c 6465 7273 2028 6f72  load folders (or
-00001150: 2066 696c 6520 7365 6c65 6374 696f 6e73   file selections
-00001160: 2920 6173 2060 7a69 7060 206f 7220 6074  ) as `zip` or `t
-00001170: 6172 6020 6669 6c65 730a 2020 2020 2a20  ar` files.    * 
-00001180: 5b75 706c 6f61 6469 6e67 5d28 2375 706c  [uploading](#upl
-00001190: 6f61 6469 6e67 2920 2d20 6472 6167 2066  oading) - drag f
-000011a0: 696c 6573 2f66 6f6c 6465 7273 2069 6e74  iles/folders int
-000011b0: 6f20 7468 6520 7765 622d 6272 6f77 7365  o the web-browse
-000011c0: 7220 746f 2075 706c 6f61 640a 2020 2020  r to upload.    
-000011d0: 2020 2020 2a20 5b66 696c 652d 7365 6172      * [file-sear
-000011e0: 6368 5d28 2366 696c 652d 7365 6172 6368  ch](#file-search
-000011f0: 2920 2d20 6472 6f70 7069 6e67 2066 696c  ) - dropping fil
-00001200: 6573 2069 6e74 6f20 7468 6520 6272 6f77  es into the brow
-00001210: 7365 7220 616c 736f 206c 6574 7320 796f  ser also lets yo
-00001220: 7520 7365 6520 6966 2074 6865 7920 6578  u see if they ex
-00001230: 6973 7420 6f6e 2074 6865 2073 6572 7665  ist on the serve
-00001240: 720a 2020 2020 2020 2020 2a20 5b75 6e70  r.        * [unp
-00001250: 6f73 745d 2823 756e 706f 7374 2920 2d20  ost](#unpost) - 
-00001260: 756e 646f 2f64 656c 6574 6520 6163 6369  undo/delete acci
-00001270: 6465 6e74 616c 2075 706c 6f61 6473 0a20  dental uploads. 
-00001280: 2020 2020 2020 202a 205b 7365 6c66 2d64         * [self-d
-00001290: 6573 7472 7563 745d 2823 7365 6c66 2d64  estruct](#self-d
-000012a0: 6573 7472 7563 7429 202d 2075 706c 6f61  estruct) - uploa
-000012b0: 6473 2063 616e 2062 6520 6769 7665 6e20  ds can be given 
-000012c0: 6120 6c69 6665 7469 6d65 0a20 2020 202a  a lifetime.    *
-000012d0: 205b 6669 6c65 206d 616e 6167 6572 5d28   [file manager](
-000012e0: 2366 696c 652d 6d61 6e61 6765 7229 202d  #file-manager) -
-000012f0: 2063 7574 2f70 6173 7465 2c20 7265 6e61   cut/paste, rena
-00001300: 6d65 2c20 616e 6420 6465 6c65 7465 2066  me, and delete f
-00001310: 696c 6573 2f66 6f6c 6465 7273 2028 6966  iles/folders (if
-00001320: 2079 6f75 2068 6176 6520 7065 726d 6973   you have permis
-00001330: 7369 6f6e 290a 2020 2020 2a20 5b62 6174  sion).    * [bat
-00001340: 6368 2072 656e 616d 655d 2823 6261 7463  ch rename](#batc
-00001350: 682d 7265 6e61 6d65 2920 2d20 7365 6c65  h-rename) - sele
-00001360: 6374 2073 6f6d 6520 6669 6c65 7320 616e  ct some files an
-00001370: 6420 7072 6573 7320 6046 3260 2074 6f20  d press `F2` to 
-00001380: 6272 696e 6720 7570 2074 6865 2072 656e  bring up the ren
-00001390: 616d 6520 5549 0a20 2020 202a 205b 6d61  ame UI.    * [ma
-000013a0: 726b 646f 776e 2076 6965 7765 725d 2823  rkdown viewer](#
-000013b0: 6d61 726b 646f 776e 2d76 6965 7765 7229  markdown-viewer)
-000013c0: 202d 2061 6e64 2074 6865 7265 2061 7265   - and there are
-000013d0: 202a 7477 6f2a 2065 6469 746f 7273 0a20   *two* editors. 
-000013e0: 2020 202a 205b 6f74 6865 7220 7472 6963     * [other tric
-000013f0: 6b73 5d28 236f 7468 6572 2d74 7269 636b  ks](#other-trick
-00001400: 7329 0a20 2020 202a 205b 7365 6172 6368  s).    * [search
-00001410: 696e 675d 2823 7365 6172 6368 696e 6729  ing](#searching)
-00001420: 202d 2073 6561 7263 6820 6279 2073 697a   - search by siz
-00001430: 652c 2064 6174 652c 2070 6174 682f 6e61  e, date, path/na
-00001440: 6d65 2c20 6d70 332d 7461 6773 2c20 2e2e  me, mp3-tags, ..
-00001450: 2e0a 2a20 5b73 6572 7665 7220 636f 6e66  ..* [server conf
-00001460: 6967 5d28 2373 6572 7665 722d 636f 6e66  ig](#server-conf
-00001470: 6967 2920 2d20 7573 696e 6720 6172 6775  ig) - using argu
-00001480: 6d65 6e74 7320 6f72 2063 6f6e 6669 6720  ments or config 
-00001490: 6669 6c65 732c 206f 7220 6120 6d69 7820  files, or a mix 
-000014a0: 6f66 2062 6f74 680a 2020 2020 2a20 5b7a  of both.    * [z
-000014b0: 6572 6f63 6f6e 665d 2823 7a65 726f 636f  eroconf](#zeroco
-000014c0: 6e66 2920 2d20 616e 6e6f 756e 6365 2065  nf) - announce e
-000014d0: 6e61 626c 6564 2073 6572 7669 6365 7320  nabled services 
-000014e0: 6f6e 2074 6865 204c 414e 2028 5b70 6963  on the LAN ([pic
-000014f0: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
-00001500: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-00001510: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-00001520: 3332 2f32 3135 3334 3437 3337 2d30 6561  32/215344737-0ea
-00001530: 6538 6439 382d 3934 3936 2d34 3235 362d  e8d98-9496-4256-
-00001540: 3961 6138 2d63 6432 6636 3937 3138 3130  9aa8-cd2f6971810
-00001550: 642e 706e 6729 290a 2020 2020 2020 2020  d.png)).        
-00001560: 2a20 5b6d 646e 735d 2823 6d64 6e73 2920  * [mdns](#mdns) 
-00001570: 2d20 4c41 4e20 646f 6d61 696e 2d6e 616d  - LAN domain-nam
-00001580: 6520 616e 6420 6665 6174 7572 6520 616e  e and feature an
-00001590: 6e6f 756e 6365 720a 2020 2020 2020 2020  nouncer.        
-000015a0: 2a20 5b73 7364 705d 2823 7373 6470 2920  * [ssdp](#ssdp) 
-000015b0: 2d20 7769 6e64 6f77 732d 6578 706c 6f72  - windows-explor
-000015c0: 6572 2061 6e6e 6f75 6e63 6572 0a20 2020  er announcer.   
-000015d0: 202a 205b 7172 2d63 6f64 655d 2823 7172   * [qr-code](#qr
-000015e0: 2d63 6f64 6529 202d 2070 7269 6e74 2061  -code) - print a
-000015f0: 2071 722d 636f 6465 205b 2873 6372 6565   qr-code [(scree
-00001600: 6e73 686f 7429 5d28 6874 7470 733a 2f2f  nshot)](https://
-00001610: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
-00001620: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
-00001630: 6d2f 3234 3130 3332 2f31 3934 3732 3835  m/241032/1947285
-00001640: 3333 2d36 6630 3038 3439 622d 6336 6163  33-6f00849b-c6ac
-00001650: 2d34 3363 362d 3933 3539 2d38 3365 3435  -43c6-9359-83e45
-00001660: 3464 3131 6530 302e 706e 6729 2066 6f72  4d11e00.png) for
-00001670: 2071 7569 636b 2061 6363 6573 730a 2020   quick access.  
-00001680: 2020 2a20 5b66 7470 2073 6572 7665 725d    * [ftp server]
-00001690: 2823 6674 702d 7365 7276 6572 2920 2d20  (#ftp-server) - 
-000016a0: 616e 2046 5450 2073 6572 7665 7220 6361  an FTP server ca
-000016b0: 6e20 6265 2073 7461 7274 6564 2075 7369  n be started usi
-000016c0: 6e67 2060 2d2d 6674 7020 3339 3231 600a  ng `--ftp 3921`.
-000016d0: 2020 2020 2a20 5b77 6562 6461 7620 7365      * [webdav se
-000016e0: 7276 6572 5d28 2377 6562 6461 762d 7365  rver](#webdav-se
-000016f0: 7276 6572 2920 2d20 7769 7468 2072 6561  rver) - with rea
-00001700: 642d 7772 6974 6520 7375 7070 6f72 740a  d-write support.
-00001710: 2020 2020 2020 2020 2a20 5b63 6f6e 6e65          * [conne
-00001720: 6374 696e 6720 746f 2077 6562 6461 7620  cting to webdav 
-00001730: 6672 6f6d 2077 696e 646f 7773 5d28 2363  from windows](#c
-00001740: 6f6e 6e65 6374 696e 672d 746f 2d77 6562  onnecting-to-web
-00001750: 6461 762d 6672 6f6d 2d77 696e 646f 7773  dav-from-windows
-00001760: 2920 2d20 7573 696e 6720 7468 6520 4755  ) - using the GU
-00001770: 490a 2020 2020 2a20 5b73 6d62 2073 6572  I.    * [smb ser
-00001780: 7665 725d 2823 736d 622d 7365 7276 6572  ver](#smb-server
-00001790: 2920 2d20 756e 7361 6665 2c20 736c 6f77  ) - unsafe, slow
-000017a0: 2c20 6e6f 7420 7265 636f 6d6d 656e 6465  , not recommende
-000017b0: 6420 666f 7220 7761 6e0a 2020 2020 2a20  d for wan.    * 
-000017c0: 5b66 696c 6520 696e 6465 7869 6e67 5d28  [file indexing](
-000017d0: 2366 696c 652d 696e 6465 7869 6e67 2920  #file-indexing) 
-000017e0: 2d20 656e 6162 6c65 7320 6465 6475 7020  - enables dedup 
-000017f0: 616e 6420 6d75 7369 6320 7365 6172 6368  and music search
-00001800: 202b 2b0a 2020 2020 2020 2020 2a20 5b65   ++.        * [e
-00001810: 7863 6c75 6465 2d70 6174 7465 726e 735d  xclude-patterns]
-00001820: 2823 6578 636c 7564 652d 7061 7474 6572  (#exclude-patter
-00001830: 6e73 2920 2d20 746f 2073 6176 6520 736f  ns) - to save so
-00001840: 6d65 2074 696d 650a 2020 2020 2020 2020  me time.        
-00001850: 2a20 5b66 696c 6573 7973 7465 6d20 6775  * [filesystem gu
-00001860: 6172 6473 5d28 2366 696c 6573 7973 7465  ards](#filesyste
-00001870: 6d2d 6775 6172 6473 2920 2d20 6176 6f69  m-guards) - avoi
-00001880: 6420 7472 6176 6572 7369 6e67 2069 6e74  d traversing int
-00001890: 6f20 6f74 6865 7220 6669 6c65 7379 7374  o other filesyst
-000018a0: 656d 730a 2020 2020 2020 2020 2a20 5b70  ems.        * [p
-000018b0: 6572 696f 6469 6320 7265 7363 616e 5d28  eriodic rescan](
-000018c0: 2370 6572 696f 6469 632d 7265 7363 616e  #periodic-rescan
-000018d0: 2920 2d20 6669 6c65 7379 7374 656d 206d  ) - filesystem m
-000018e0: 6f6e 6974 6f72 696e 670a 2020 2020 2a20  onitoring.    * 
-000018f0: 5b75 706c 6f61 6420 7275 6c65 735d 2823  [upload rules](#
-00001900: 7570 6c6f 6164 2d72 756c 6573 2920 2d20  upload-rules) - 
-00001910: 7365 7420 7570 6c6f 6164 2072 756c 6573  set upload rules
-00001920: 2075 7369 6e67 2076 6f6c 666c 6167 730a   using volflags.
-00001930: 2020 2020 2a20 5b63 6f6d 7072 6573 7320      * [compress 
-00001940: 7570 6c6f 6164 735d 2823 636f 6d70 7265  uploads](#compre
-00001950: 7373 2d75 706c 6f61 6473 2920 2d20 6669  ss-uploads) - fi
-00001960: 6c65 7320 6361 6e20 6265 2061 7574 6f63  les can be autoc
-00001970: 6f6d 7072 6573 7365 6420 6f6e 2075 706c  ompressed on upl
-00001980: 6f61 640a 2020 2020 2a20 5b6f 7468 6572  oad.    * [other
-00001990: 2066 6c61 6773 5d28 236f 7468 6572 2d66   flags](#other-f
-000019a0: 6c61 6773 290a 2020 2020 2a20 5b64 6174  lags).    * [dat
-000019b0: 6162 6173 6520 6c6f 6361 7469 6f6e 5d28  abase location](
-000019c0: 2364 6174 6162 6173 652d 6c6f 6361 7469  #database-locati
-000019d0: 6f6e 2920 2d20 696e 2d76 6f6c 756d 6520  on) - in-volume 
-000019e0: 2860 2e68 6973 742f 7570 326b 2e64 6260  (`.hist/up2k.db`
-000019f0: 2c20 6465 6661 756c 7429 206f 7220 736f  , default) or so
-00001a00: 6d65 7768 6572 6520 656c 7365 0a20 2020  mewhere else.   
-00001a10: 202a 205b 6d65 7461 6461 7461 2066 726f   * [metadata fro
-00001a20: 6d20 6175 6469 6f20 6669 6c65 735d 2823  m audio files](#
-00001a30: 6d65 7461 6461 7461 2d66 726f 6d2d 6175  metadata-from-au
-00001a40: 6469 6f2d 6669 6c65 7329 202d 2073 6574  dio-files) - set
-00001a50: 2060 2d65 3274 6020 746f 2069 6e64 6578   `-e2t` to index
-00001a60: 2074 6167 7320 6f6e 2075 706c 6f61 640a   tags on upload.
-00001a70: 2020 2020 2a20 5b66 696c 6520 7061 7273      * [file pars
-00001a80: 6572 2070 6c75 6769 6e73 5d28 2366 696c  er plugins](#fil
-00001a90: 652d 7061 7273 6572 2d70 6c75 6769 6e73  e-parser-plugins
-00001aa0: 2920 2d20 7072 6f76 6964 6520 6375 7374  ) - provide cust
-00001ab0: 6f6d 2070 6172 7365 7273 2074 6f20 696e  om parsers to in
-00001ac0: 6465 7820 6164 6469 7469 6f6e 616c 2074  dex additional t
-00001ad0: 6167 730a 2020 2020 2a20 5b65 7665 6e74  ags.    * [event
-00001ae0: 2068 6f6f 6b73 5d28 2365 7665 6e74 2d68   hooks](#event-h
-00001af0: 6f6f 6b73 2920 2d20 7472 6967 6765 7220  ooks) - trigger 
-00001b00: 6120 7072 6f67 7261 6d20 6f6e 2075 706c  a program on upl
-00001b10: 6f61 6473 2c20 7265 6e61 6d65 7320 6574  oads, renames et
-00001b20: 6320 285b 6578 616d 706c 6573 5d28 2e2f  c ([examples](./
-00001b30: 6269 6e2f 686f 6f6b 732f 2929 0a20 2020  bin/hooks/)).   
-00001b40: 2020 2020 202a 205b 7570 6c6f 6164 2065       * [upload e
-00001b50: 7665 6e74 735d 2823 7570 6c6f 6164 2d65  vents](#upload-e
-00001b60: 7665 6e74 7329 202d 2074 6865 206f 6c64  vents) - the old
-00001b70: 6572 2c20 6d6f 7265 2070 6f77 6572 6675  er, more powerfu
-00001b80: 6c20 6170 7072 6f61 6368 2028 5b65 7861  l approach ([exa
-00001b90: 6d70 6c65 735d 282e 2f62 696e 2f6d 7461  mples](./bin/mta
-00001ba0: 672f 2929 0a20 2020 202a 205b 6869 6469  g/)).    * [hidi
-00001bb0: 6e67 2066 726f 6d20 676f 6f67 6c65 5d28  ng from google](
-00001bc0: 2368 6964 696e 672d 6672 6f6d 2d67 6f6f  #hiding-from-goo
-00001bd0: 676c 6529 202d 2074 656c 6c20 7365 6172  gle) - tell sear
-00001be0: 6368 2065 6e67 696e 6573 2079 6f75 2064  ch engines you d
-00001bf0: 6f6e 7420 7761 6e6e 6120 6265 2069 6e64  ont wanna be ind
-00001c00: 6578 6564 0a20 2020 202a 205b 7468 656d  exed.    * [them
-00001c10: 6573 5d28 2374 6865 6d65 7329 0a20 2020  es](#themes).   
-00001c20: 202a 205b 636f 6d70 6c65 7465 2065 7861   * [complete exa
-00001c30: 6d70 6c65 735d 2823 636f 6d70 6c65 7465  mples](#complete
-00001c40: 2d65 7861 6d70 6c65 7329 0a20 2020 202a  -examples).    *
-00001c50: 205b 7265 7665 7273 652d 7072 6f78 795d   [reverse-proxy]
-00001c60: 2823 7265 7665 7273 652d 7072 6f78 7929  (#reverse-proxy)
-00001c70: 202d 2072 756e 6e69 6e67 2063 6f70 7970   - running copyp
-00001c80: 6172 7479 206e 6578 7420 746f 206f 7468  arty next to oth
-00001c90: 6572 2077 6562 7369 7465 730a 2a20 5b62  er websites.* [b
-00001ca0: 726f 7773 6572 2073 7570 706f 7274 5d28  rowser support](
-00001cb0: 2362 726f 7773 6572 2d73 7570 706f 7274  #browser-support
-00001cc0: 2920 2d20 544c 4452 3a20 7965 730a 2a20  ) - TLDR: yes.* 
-00001cd0: 5b63 6c69 656e 7420 6578 616d 706c 6573  [client examples
-00001ce0: 5d28 2363 6c69 656e 742d 6578 616d 706c  ](#client-exampl
-00001cf0: 6573 2920 2d20 696e 7465 7261 6374 2077  es) - interact w
-00001d00: 6974 6820 636f 7079 7061 7274 7920 7573  ith copyparty us
-00001d10: 696e 6720 6e6f 6e2d 6272 6f77 7365 7220  ing non-browser 
-00001d20: 636c 6965 6e74 730a 2020 2020 2a20 5b6d  clients.    * [m
-00001d30: 6f75 6e74 2061 7320 6472 6976 655d 2823  ount as drive](#
-00001d40: 6d6f 756e 742d 6173 2d64 7269 7665 2920  mount-as-drive) 
-00001d50: 2d20 6120 7265 6d6f 7465 2063 6f70 7970  - a remote copyp
-00001d60: 6172 7479 2073 6572 7665 7220 6173 2061  arty server as a
-00001d70: 206c 6f63 616c 2066 696c 6573 7973 7465   local filesyste
-00001d80: 6d0a 2a20 5b70 6572 666f 726d 616e 6365  m.* [performance
-00001d90: 5d28 2370 6572 666f 726d 616e 6365 2920  ](#performance) 
-00001da0: 2d20 6465 6661 756c 7473 2061 7265 2075  - defaults are u
-00001db0: 7375 616c 6c79 2066 696e 6520 2d20 6578  sually fine - ex
-00001dc0: 7065 6374 2060 3820 4769 422f 7360 2064  pect `8 GiB/s` d
-00001dd0: 6f77 6e6c 6f61 642c 2060 3120 4769 422f  ownload, `1 GiB/
-00001de0: 7360 2075 706c 6f61 640a 2020 2020 2a20  s` upload.    * 
-00001df0: 5b63 6c69 656e 742d 7369 6465 5d28 2363  [client-side](#c
-00001e00: 6c69 656e 742d 7369 6465 2920 2d20 7768  lient-side) - wh
-00001e10: 656e 2075 706c 6f61 6469 6e67 2066 696c  en uploading fil
-00001e20: 6573 0a2a 205b 7365 6375 7269 7479 5d28  es.* [security](
-00001e30: 2373 6563 7572 6974 7929 202d 2073 6f6d  #security) - som
-00001e40: 6520 6e6f 7465 7320 6f6e 2068 6172 6465  e notes on harde
-00001e50: 6e69 6e67 0a20 2020 202a 205b 676f 7463  ning.    * [gotc
-00001e60: 6861 735d 2823 676f 7463 6861 7329 202d  has](#gotchas) -
-00001e70: 2062 6568 6176 696f 7220 7468 6174 206d   behavior that m
-00001e80: 6967 6874 2062 6520 756e 6578 7065 6374  ight be unexpect
-00001e90: 6564 0a20 2020 202a 205b 636f 7273 5d28  ed.    * [cors](
-00001ea0: 2363 6f72 7329 202d 2063 726f 7373 2d73  #cors) - cross-s
-00001eb0: 6974 6520 7265 7175 6573 7420 636f 6e66  ite request conf
-00001ec0: 6967 0a2a 205b 7265 636f 7665 7269 6e67  ig.* [recovering
-00001ed0: 2066 726f 6d20 6372 6173 6865 735d 2823   from crashes](#
-00001ee0: 7265 636f 7665 7269 6e67 2d66 726f 6d2d  recovering-from-
-00001ef0: 6372 6173 6865 7329 0a20 2020 202a 205b  crashes).    * [
-00001f00: 636c 6965 6e74 2063 7261 7368 6573 5d28  client crashes](
-00001f10: 2363 6c69 656e 742d 6372 6173 6865 7329  #client-crashes)
-00001f20: 0a20 2020 2020 2020 202a 205b 6672 6566  .        * [fref
-00001f30: 6f78 2077 736f 645d 2823 6672 6566 6f78  ox wsod](#frefox
-00001f40: 2d77 736f 6429 202d 2066 6972 6566 6f78  -wsod) - firefox
-00001f50: 2038 3720 6361 6e20 6372 6173 6820 6475   87 can crash du
-00001f60: 7269 6e67 2075 706c 6f61 6473 0a2a 205b  ring uploads.* [
-00001f70: 4854 5450 2041 5049 5d28 2348 5454 502d  HTTP API](#HTTP-
-00001f80: 4150 4929 202d 2073 6565 205b 6465 766e  API) - see [devn
-00001f90: 6f74 6573 5d28 232e 2f64 6f63 732f 6465  otes](#./docs/de
-00001fa0: 766e 6f74 6573 2e6d 6423 6874 7470 2d61  vnotes.md#http-a
-00001fb0: 7069 290a 2a20 5b64 6570 656e 6465 6e63  pi).* [dependenc
-00001fc0: 6965 735d 2823 6465 7065 6e64 656e 6369  ies](#dependenci
-00001fd0: 6573 2920 2d20 6d61 6e64 6174 6f72 7920  es) - mandatory 
-00001fe0: 6465 7073 0a20 2020 202a 205b 6f70 7469  deps.    * [opti
-00001ff0: 6f6e 616c 2064 6570 656e 6465 6e63 6965  onal dependencie
-00002000: 735d 2823 6f70 7469 6f6e 616c 2d64 6570  s](#optional-dep
-00002010: 656e 6465 6e63 6965 7329 202d 2069 6e73  endencies) - ins
-00002020: 7461 6c6c 2074 6865 7365 2074 6f20 656e  tall these to en
-00002030: 6162 6c65 2062 6f6e 7573 2066 6561 7475  able bonus featu
-00002040: 7265 730a 2020 2020 2a20 5b6f 7074 696f  res.    * [optio
-00002050: 6e61 6c20 6770 6c20 7374 7566 665d 2823  nal gpl stuff](#
-00002060: 6f70 7469 6f6e 616c 2d67 706c 2d73 7475  optional-gpl-stu
-00002070: 6666 290a 2a20 5b73 6678 5d28 2373 6678  ff).* [sfx](#sfx
-00002080: 2920 2d20 7468 6520 7365 6c66 2d63 6f6e  ) - the self-con
-00002090: 7461 696e 6564 2022 6269 6e61 7279 220a  tained "binary".
-000020a0: 2020 2020 2a20 5b63 6f70 7970 6172 7479      * [copyparty
-000020b0: 2e65 7865 5d28 2363 6f70 7970 6172 7479  .exe](#copyparty
-000020c0: 6578 6529 202d 2064 6f77 6e6c 6f61 6420  exe) - download 
-000020d0: 5b63 6f70 7970 6172 7479 2e65 7865 5d28  [copyparty.exe](
-000020e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000020f0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-00002100: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
-00002110: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
-00002120: 6172 7479 2e65 7865 2920 2877 696e 382b  arty.exe) (win8+
-00002130: 2920 6f72 205b 636f 7079 7061 7274 7933  ) or [copyparty3
-00002140: 322e 6578 655d 2868 7474 7073 3a2f 2f67  2.exe](https://g
-00002150: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
-00002160: 6f70 7970 6172 7479 2f72 656c 6561 7365  opyparty/release
-00002170: 732f 6c61 7465 7374 2f64 6f77 6e6c 6f61  s/latest/downloa
-00002180: 642f 636f 7079 7061 7274 7933 322e 6578  d/copyparty32.ex
-00002190: 6529 2028 7769 6e37 2b29 0a2a 205b 696e  e) (win7+).* [in
-000021a0: 7374 616c 6c20 6f6e 2061 6e64 726f 6964  stall on android
-000021b0: 5d28 2369 6e73 7461 6c6c 2d6f 6e2d 616e  ](#install-on-an
-000021c0: 6472 6f69 6429 0a2a 205b 7265 706f 7274  droid).* [report
-000021d0: 696e 6720 6275 6773 5d28 2372 6570 6f72  ing bugs](#repor
-000021e0: 7469 6e67 2d62 7567 7329 202d 2069 6465  ting-bugs) - ide
-000021f0: 6173 2066 6f72 2063 6f6e 7465 7874 2074  as for context t
-00002200: 6f20 696e 636c 7564 6520 696e 2062 7567  o include in bug
-00002210: 2072 6570 6f72 7473 0a2a 205b 6465 766e   reports.* [devn
-00002220: 6f74 6573 5d28 2364 6576 6e6f 7465 7329  otes](#devnotes)
-00002230: 202d 2066 6f72 2062 7569 6c64 2069 6e73   - for build ins
-00002240: 7472 7563 7469 6f6e 7320 6574 632c 2073  tructions etc, s
-00002250: 6565 205b 2e2f 646f 6373 2f64 6576 6e6f  ee [./docs/devno
-00002260: 7465 732e 6d64 5d28 2e2f 646f 6373 2f64  tes.md](./docs/d
-00002270: 6576 6e6f 7465 732e 6d64 290a 0a0a 2323  evnotes.md)...##
-00002280: 2071 7569 636b 7374 6172 740a 0a6a 7573   quickstart..jus
-00002290: 7420 7275 6e20 2a2a 5b63 6f70 7970 6172  t run **[copypar
-000022a0: 7479 2d73 6678 2e70 795d 2868 7474 7073  ty-sfx.py](https
-000022b0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
-000022c0: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
-000022d0: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
-000022e0: 6e6c 6f61 642f 636f 7079 7061 7274 792d  nload/copyparty-
-000022f0: 7366 782e 7079 292a 2a20 2d2d 2074 6861  sfx.py)** -- tha
-00002300: 7427 7320 6974 2120 f09f 8e89 0a0a 2a20  t's it! ......* 
-00002310: 6f72 2069 6e73 7461 6c6c 2074 6872 6f75  or install throu
-00002320: 6768 2070 7970 6920 2870 7974 686f 6e33  gh pypi (python3
-00002330: 206f 6e6c 7929 3a20 6070 7974 686f 6e33   only): `python3
-00002340: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
-00002350: 2d2d 7573 6572 202d 5520 636f 7079 7061  --user -U copypa
-00002360: 7274 7960 0a2a 206f 7220 6966 2079 6f75  rty`.* or if you
-00002370: 2063 616e 6e6f 7420 696e 7374 616c 6c20   cannot install 
-00002380: 7079 7468 6f6e 2c20 796f 7520 6361 6e20  python, you can 
-00002390: 7573 6520 5b63 6f70 7970 6172 7479 2e65  use [copyparty.e
-000023a0: 7865 5d28 2363 6f70 7970 6172 7479 6578  xe](#copypartyex
-000023b0: 6529 2069 6e73 7465 6164 0a2a 206f 7220  e) instead.* or 
-000023c0: 6966 2079 6f75 2061 7265 206f 6e20 616e  if you are on an
-000023d0: 6472 6f69 642c 205b 696e 7374 616c 6c20  droid, [install 
-000023e0: 636f 7079 7061 7274 7920 696e 2074 6572  copyparty in ter
-000023f0: 6d75 785d 2823 696e 7374 616c 6c2d 6f6e  mux](#install-on
-00002400: 2d61 6e64 726f 6964 290a 2a20 6f72 2069  -android).* or i
-00002410: 6620 796f 7520 7072 6566 6572 2074 6f20  f you prefer to 
-00002420: 5b75 7365 2064 6f63 6b65 725d 282e 2f73  [use docker](./s
-00002430: 6372 6970 7473 2f64 6f63 6b65 722f 2920  cripts/docker/) 
-00002440: f09f 908b 2079 6f75 2063 616e 2064 6f20  .... you can do 
-00002450: 7468 6174 2074 6f6f 0a20 202a 2064 6f63  that too.  * doc
-00002460: 6b65 7220 6861 7320 616c 6c20 6465 7073  ker has all deps
-00002470: 2062 7569 6c74 2d69 6e2c 2073 6f20 736b   built-in, so sk
-00002480: 6970 2074 6869 7320 7374 6570 3a0a 0a65  ip this step:..e
-00002490: 6e61 626c 6520 7468 756d 626e 6169 6c73  nable thumbnails
-000024a0: 2028 696d 6167 6573 2f61 7564 696f 2f76   (images/audio/v
-000024b0: 6964 656f 292c 206d 6564 6961 2069 6e64  ideo), media ind
-000024c0: 6578 696e 672c 2061 6e64 2061 7564 696f  exing, and audio
-000024d0: 2074 7261 6e73 636f 6469 6e67 2062 7920   transcoding by 
-000024e0: 696e 7374 616c 6c69 6e67 2073 6f6d 6520  installing some 
-000024f0: 7265 636f 6d6d 656e 6465 6420 6465 7073  recommended deps
-00002500: 3a0a 0a2a 202a 2a41 6c70 696e 653a 2a2a  :..* **Alpine:**
-00002510: 2060 6170 6b20 6164 6420 7079 332d 7069   `apk add py3-pi
-00002520: 6c6c 6f77 2066 666d 7065 6760 0a2a 202a  llow ffmpeg`.* *
-00002530: 2a44 6562 6961 6e3a 2a2a 2060 6170 7420  *Debian:** `apt 
-00002540: 696e 7374 616c 6c20 7079 7468 6f6e 332d  install python3-
-00002550: 7069 6c20 6666 6d70 6567 600a 2a20 2a2a  pil ffmpeg`.* **
-00002560: 4665 646f 7261 3a2a 2a20 6064 6e66 2069  Fedora:** `dnf i
-00002570: 6e73 7461 6c6c 2070 7974 686f 6e33 2d70  nstall python3-p
-00002580: 696c 6c6f 7720 6666 6d70 6567 600a 2a20  illow ffmpeg`.* 
-00002590: 2a2a 4672 6565 4253 443a 2a2a 2060 706b  **FreeBSD:** `pk
-000025a0: 6720 696e 7374 616c 6c20 7079 3339 2d73  g install py39-s
-000025b0: 716c 6974 6533 2070 7933 392d 7069 6c6c  qlite3 py39-pill
-000025c0: 6f77 2066 666d 7065 6760 0a2a 202a 2a4d  ow ffmpeg`.* **M
-000025d0: 6163 4f53 3a2a 2a20 6070 6f72 7420 696e  acOS:** `port in
-000025e0: 7374 616c 6c20 7079 2d50 696c 6c6f 7720  stall py-Pillow 
-000025f0: 6666 6d70 6567 600a 2a20 2a2a 4d61 634f  ffmpeg`.* **MacO
-00002600: 532a 2a20 2861 6c74 6572 6e61 7469 7665  S** (alternative
-00002610: 293a 2060 6272 6577 2069 6e73 7461 6c6c  ): `brew install
-00002620: 2070 696c 6c6f 7720 6666 6d70 6567 600a   pillow ffmpeg`.
-00002630: 2a20 2a2a 5769 6e64 6f77 733a 2a2a 2060  * **Windows:** `
-00002640: 7079 7468 6f6e 202d 6d20 7069 7020 696e  python -m pip in
-00002650: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
-00002660: 5069 6c6c 6f77 600a 2020 2a20 696e 7374  Pillow`.  * inst
-00002670: 616c 6c20 7079 7468 6f6e 2061 6e64 2066  all python and f
-00002680: 666d 7065 6720 6d61 6e75 616c 6c79 3b20  fmpeg manually; 
-00002690: 646f 206e 6f74 2075 7365 2060 7769 6e67  do not use `wing
-000026a0: 6574 6020 6f72 2060 4d69 6372 6f73 6f66  et` or `Microsof
-000026b0: 7420 5374 6f72 6560 2028 6974 2062 7265  t Store` (it bre
-000026c0: 616b 7320 2450 4154 4829 0a20 202a 2063  aks $PATH).  * c
-000026d0: 6f70 7970 6172 7479 2e65 7865 2063 6f6d  opyparty.exe com
-000026e0: 6573 2077 6974 6820 6050 696c 6c6f 7760  es with `Pillow`
-000026f0: 2061 6e64 206f 6e6c 7920 6e65 6564 7320   and only needs 
-00002700: 6066 666d 7065 6760 0a2a 2073 6565 205b  `ffmpeg`.* see [
-00002710: 6f70 7469 6f6e 616c 2064 6570 656e 6465  optional depende
-00002720: 6e63 6965 735d 2823 6f70 7469 6f6e 616c  ncies](#optional
-00002730: 2d64 6570 656e 6465 6e63 6965 7329 2074  -dependencies) t
-00002740: 6f20 656e 6162 6c65 2065 7665 6e20 6d6f  o enable even mo
-00002750: 7265 2066 6561 7475 7265 730a 0a72 756e  re features..run
-00002760: 6e69 6e67 2063 6f70 7970 6172 7479 2077  ning copyparty w
-00002770: 6974 686f 7574 2061 7267 756d 656e 7473  ithout arguments
-00002780: 2028 666f 7220 6578 616d 706c 6520 646f   (for example do
-00002790: 7562 6c65 636c 6963 6b69 6e67 2069 7420  ubleclicking it 
-000027a0: 6f6e 2057 696e 646f 7773 2920 7769 6c6c  on Windows) will
-000027b0: 2067 6976 6520 6576 6572 796f 6e65 2072   give everyone r
-000027c0: 6561 642f 7772 6974 6520 6163 6365 7373  ead/write access
-000027d0: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
-000027e0: 666f 6c64 6572 3b20 796f 7520 6d61 7920  folder; you may 
-000027f0: 7761 6e74 205b 6163 636f 756e 7473 2061  want [accounts a
-00002800: 6e64 2076 6f6c 756d 6573 5d28 2361 6363  nd volumes](#acc
-00002810: 6f75 6e74 732d 616e 642d 766f 6c75 6d65  ounts-and-volume
-00002820: 7329 0a0a 736f 6d65 2072 6563 6f6d 6d65  s)..some recomme
-00002830: 6e64 6564 206f 7074 696f 6e73 3a0a 2a20  nded options:.* 
-00002840: 602d 6532 6473 6160 2065 6e61 626c 6573  `-e2dsa` enables
-00002850: 2067 656e 6572 616c 205b 6669 6c65 2069   general [file i
-00002860: 6e64 6578 696e 675d 2823 6669 6c65 2d69  ndexing](#file-i
-00002870: 6e64 6578 696e 6729 0a2a 2060 2d65 3274  ndexing).* `-e2t
-00002880: 7360 2065 6e61 626c 6573 2061 7564 696f  s` enables audio
-00002890: 206d 6574 6164 6174 6120 696e 6465 7869   metadata indexi
-000028a0: 6e67 2028 6e65 6564 7320 6569 7468 6572  ng (needs either
-000028b0: 2046 4670 726f 6265 206f 7220 4d75 7461   FFprobe or Muta
-000028c0: 6765 6e29 0a2a 2060 2d76 202f 6d6e 742f  gen).* `-v /mnt/
-000028d0: 6d75 7369 633a 2f6d 7573 6963 3a72 3a72  music:/music:r:r
-000028e0: 772c 666f 6f20 2d61 2066 6f6f 3a62 6172  w,foo -a foo:bar
-000028f0: 6020 7368 6172 6573 2060 2f6d 6e74 2f6d  ` shares `/mnt/m
-00002900: 7573 6963 6020 6173 2060 2f6d 7573 6963  usic` as `/music
-00002910: 602c 2060 7260 6561 6461 626c 6520 6279  `, `r`eadable by
-00002920: 2061 6e79 6f6e 652c 2061 6e64 2072 6561   anyone, and rea
-00002930: 642d 7772 6974 6520 666f 7220 7573 6572  d-write for user
-00002940: 2060 666f 6f60 2c20 7061 7373 776f 7264   `foo`, password
-00002950: 2060 6261 7260 0a20 202a 2072 6570 6c61   `bar`.  * repla
-00002960: 6365 2060 3a72 3a72 772c 666f 6f60 2077  ce `:r:rw,foo` w
-00002970: 6974 6820 603a 722c 666f 6f60 2074 6f20  ith `:r,foo` to 
-00002980: 6f6e 6c79 206d 616b 6520 7468 6520 666f  only make the fo
-00002990: 6c64 6572 2072 6561 6461 626c 6520 6279  lder readable by
-000029a0: 2060 666f 6f60 2061 6e64 206e 6f62 6f64   `foo` and nobod
-000029b0: 7920 656c 7365 0a20 202a 2073 6565 205b  y else.  * see [
-000029c0: 6163 636f 756e 7473 2061 6e64 2076 6f6c  accounts and vol
-000029d0: 756d 6573 5d28 2361 6363 6f75 6e74 732d  umes](#accounts-
-000029e0: 616e 642d 766f 6c75 6d65 7329 2028 6f72  and-volumes) (or
-000029f0: 2060 2d2d 6865 6c70 2d61 6363 6f75 6e74   `--help-account
-00002a00: 7360 2920 666f 7220 7468 6520 7379 6e74  s`) for the synt
-00002a10: 6178 2061 6e64 206f 7468 6572 2070 6572  ax and other per
-00002a20: 6d69 7373 696f 6e73 0a0a 0a23 2323 206f  missions...### o
-00002a30: 6e20 7365 7276 6572 730a 0a79 6f75 206d  n servers..you m
-00002a40: 6179 2061 6c73 6f20 7761 6e74 2074 6865  ay also want the
-00002a50: 7365 2c20 6573 7065 6369 616c 6c79 206f  se, especially o
-00002a60: 6e20 7365 7276 6572 733a 0a0a 2a20 5b63  n servers:..* [c
-00002a70: 6f6e 7472 6962 2f73 7973 7465 6d64 2f63  ontrib/systemd/c
-00002a80: 6f70 7970 6172 7479 2e73 6572 7669 6365  opyparty.service
-00002a90: 5d28 636f 6e74 7269 622f 7379 7374 656d  ](contrib/system
-00002aa0: 642f 636f 7079 7061 7274 792e 7365 7276  d/copyparty.serv
-00002ab0: 6963 6529 2074 6f20 7275 6e20 636f 7079  ice) to run copy
-00002ac0: 7061 7274 7920 6173 2061 2073 7973 7465  party as a syste
-00002ad0: 6d64 2073 6572 7669 6365 0a2a 205b 636f  md service.* [co
-00002ae0: 6e74 7269 622f 7379 7374 656d 642f 7072  ntrib/systemd/pr
-00002af0: 6973 6f6e 7061 7274 792e 7365 7276 6963  isonparty.servic
-00002b00: 655d 2863 6f6e 7472 6962 2f73 7973 7465  e](contrib/syste
-00002b10: 6d64 2f70 7269 736f 6e70 6172 7479 2e73  md/prisonparty.s
-00002b20: 6572 7669 6365 2920 746f 2072 756e 2069  ervice) to run i
-00002b30: 7420 696e 2061 2063 6872 6f6f 7420 2866  t in a chroot (f
-00002b40: 6f72 2065 7874 7261 2073 6563 7572 6974  or extra securit
-00002b50: 7929 0a2a 205b 636f 6e74 7269 622f 7263  y).* [contrib/rc
-00002b60: 2f63 6f70 7970 6172 7479 5d28 636f 6e74  /copyparty](cont
-00002b70: 7269 622f 7263 2f63 6f70 7970 6172 7479  rib/rc/copyparty
-00002b80: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
-00002b90: 7479 206f 6e20 4672 6565 4253 440a 2a20  ty on FreeBSD.* 
-00002ba0: 5b63 6f6e 7472 6962 2f6e 6769 6e78 2f63  [contrib/nginx/c
-00002bb0: 6f70 7970 6172 7479 2e63 6f6e 665d 2863  opyparty.conf](c
-00002bc0: 6f6e 7472 6962 2f6e 6769 6e78 2f63 6f70  ontrib/nginx/cop
-00002bd0: 7970 6172 7479 2e63 6f6e 6629 2074 6f20  yparty.conf) to 
-00002be0: 5b72 6576 6572 7365 2d70 726f 7879 5d28  [reverse-proxy](
-00002bf0: 2372 6576 6572 7365 2d70 726f 7879 2920  #reverse-proxy) 
-00002c00: 6265 6869 6e64 206e 6769 6e78 2028 666f  behind nginx (fo
-00002c10: 7220 6265 7474 6572 2068 7474 7073 290a  r better https).
-00002c20: 0a61 6e64 2072 656d 656d 6265 7220 746f  .and remember to
-00002c30: 206f 7065 6e20 7468 6520 706f 7274 7320   open the ports 
-00002c40: 796f 7520 7761 6e74 3b20 6865 7265 2773  you want; here's
-00002c50: 2061 2063 6f6d 706c 6574 6520 6578 616d   a complete exam
-00002c60: 706c 6520 696e 636c 7564 696e 6720 6576  ple including ev
-00002c70: 6572 7920 6665 6174 7572 6520 636f 7079  ery feature copy
-00002c80: 7061 7274 7920 6861 7320 746f 206f 6666  party has to off
-00002c90: 6572 3a0a 6060 600a 6669 7265 7761 6c6c  er:.```.firewall
-00002ca0: 2d63 6d64 202d 2d70 6572 6d61 6e65 6e74  -cmd --permanent
-00002cb0: 202d 2d61 6464 2d70 6f72 743d 7b38 302c   --add-port={80,
-00002cc0: 3434 332c 3339 3231 2c33 3932 332c 3339  443,3921,3923,39
-00002cd0: 3435 2c33 3939 307d 2f74 6370 2020 2320  45,3990}/tcp  # 
-00002ce0: 2d2d 7a6f 6e65 3d6c 6962 7669 7274 0a66  --zone=libvirt.f
-00002cf0: 6972 6577 616c 6c2d 636d 6420 2d2d 7065  irewall-cmd --pe
-00002d00: 726d 616e 656e 7420 2d2d 6164 642d 706f  rmanent --add-po
-00002d10: 7274 3d31 3230 3030 2d31 3230 3939 2f74  rt=12000-12099/t
-00002d20: 6370 202d 2d70 6572 6d61 6e65 6e74 2020  cp --permanent  
-00002d30: 2320 2d2d 7a6f 6e65 3d6c 6962 7669 7274  # --zone=libvirt
-00002d40: 0a66 6972 6577 616c 6c2d 636d 6420 2d2d  .firewall-cmd --
-00002d50: 7065 726d 616e 656e 7420 2d2d 6164 642d  permanent --add-
-00002d60: 706f 7274 3d7b 3139 3030 2c35 3335 337d  port={1900,5353}
-00002d70: 2f75 6470 2020 2320 2d2d 7a6f 6e65 3d6c  /udp  # --zone=l
-00002d80: 6962 7669 7274 0a66 6972 6577 616c 6c2d  ibvirt.firewall-
-00002d90: 636d 6420 2d2d 7265 6c6f 6164 0a60 6060  cmd --reload.```
-00002da0: 0a28 3139 3030 3a73 7364 702c 2033 3932  .(1900:ssdp, 392
-00002db0: 313a 6674 702c 2033 3932 333a 6874 7470  1:ftp, 3923:http
-00002dc0: 2f68 7474 7073 2c20 3339 3435 3a73 6d62  /https, 3945:smb
-00002dd0: 2c20 3339 3930 3a66 7470 732c 2035 3335  , 3990:ftps, 535
-00002de0: 333a 6d64 6e73 2c20 3132 3030 303a 7061  3:mdns, 12000:pa
-00002df0: 7373 6976 652d 6674 7029 0a0a 0a23 2320  ssive-ftp)...## 
-00002e00: 6665 6174 7572 6573 0a0a 2a20 6261 636b  features..* back
-00002e10: 656e 6420 7374 7566 660a 2020 2a20 e298  end stuff.  * ..
-00002e20: 9120 4950 7636 0a20 202a 20e2 9891 205b  . IPv6.  * ... [
-00002e30: 6d75 6c74 6970 726f 6365 7373 696e 675d  multiprocessing]
-00002e40: 2823 7065 7266 6f72 6d61 6e63 6529 2028  (#performance) (
-00002e50: 6163 7475 616c 206d 756c 7469 7468 7265  actual multithre
-00002e60: 6164 696e 6729 0a20 202a 20e2 9891 2076  ading).  * ... v
-00002e70: 6f6c 756d 6573 2028 6d6f 756e 7470 6f69  olumes (mountpoi
-00002e80: 6e74 7329 0a20 202a 20e2 9891 205b 6163  nts).  * ... [ac
-00002e90: 636f 756e 7473 5d28 2361 6363 6f75 6e74  counts](#account
-00002ea0: 732d 616e 642d 766f 6c75 6d65 7329 0a20  s-and-volumes). 
-00002eb0: 202a 20e2 9891 205b 6674 7020 7365 7276   * ... [ftp serv
-00002ec0: 6572 5d28 2366 7470 2d73 6572 7665 7229  er](#ftp-server)
-00002ed0: 0a20 202a 20e2 9891 205b 7765 6264 6176  .  * ... [webdav
-00002ee0: 2073 6572 7665 725d 2823 7765 6264 6176   server](#webdav
-00002ef0: 2d73 6572 7665 7229 0a20 202a 20e2 9891  -server).  * ...
-00002f00: 205b 736d 622f 6369 6673 2073 6572 7665   [smb/cifs serve
-00002f10: 725d 2823 736d 622d 7365 7276 6572 290a  r](#smb-server).
-00002f20: 2020 2a20 e298 9120 5b71 722d 636f 6465    * ... [qr-code
-00002f30: 5d28 2371 722d 636f 6465 2920 666f 7220  ](#qr-code) for 
-00002f40: 7175 6963 6b20 6163 6365 7373 0a20 202a  quick access.  *
-00002f50: 20e2 9891 205b 7570 6e70 202f 207a 6572   ... [upnp / zer
-00002f60: 6f63 6f6e 6620 2f20 6d64 6e73 202f 2073  oconf / mdns / s
-00002f70: 7364 705d 2823 7a65 726f 636f 6e66 290a  sdp](#zeroconf).
-00002f80: 2020 2a20 e298 9120 5b65 7665 6e74 2068    * ... [event h
-00002f90: 6f6f 6b73 5d28 2365 7665 6e74 2d68 6f6f  ooks](#event-hoo
-00002fa0: 6b73 2920 2f20 7363 7269 7074 2072 756e  ks) / script run
-00002fb0: 6e65 720a 2020 2a20 e298 9120 5b72 6576  ner.  * ... [rev
-00002fc0: 6572 7365 2d70 726f 7879 2073 7570 706f  erse-proxy suppo
-00002fd0: 7274 5d28 6874 7470 733a 2f2f 6769 7468  rt](https://gith
-00002fe0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00002ff0: 7061 7274 7923 7265 7665 7273 652d 7072  party#reverse-pr
-00003000: 6f78 7929 0a2a 2075 706c 6f61 640a 2020  oxy).* upload.  
-00003010: 2a20 e298 9120 6261 7369 633a 2070 6c61  * ... basic: pla
-00003020: 696e 206d 756c 7469 7061 7274 2c20 6965  in multipart, ie
-00003030: 3620 7375 7070 6f72 740a 2020 2a20 e298  6 support.  * ..
-00003040: 9120 5b75 7032 6b5d 2823 7570 6c6f 6164  . [up2k](#upload
-00003050: 696e 6729 3a20 6a73 2c20 7265 7375 6d61  ing): js, resuma
-00003060: 626c 652c 206d 756c 7469 7468 7265 6164  ble, multithread
-00003070: 6564 0a20 2020 202a 2075 6e61 6666 6563  ed.    * unaffec
-00003080: 7465 6420 6279 2063 6c6f 7564 666c 6172  ted by cloudflar
-00003090: 6527 7320 6d61 782d 7570 6c6f 6164 2d73  e's max-upload-s
-000030a0: 697a 6520 2831 3030 204d 6942 290a 2020  ize (100 MiB).  
-000030b0: 2a20 e298 9120 7374 6173 683a 2073 696d  * ... stash: sim
-000030c0: 706c 6520 5055 5420 6669 6c65 6472 6f70  ple PUT filedrop
-000030d0: 7065 720a 2020 2a20 e298 9120 6669 6c65  per.  * ... file
-000030e0: 6e61 6d65 2072 616e 646f 6d69 7a65 720a  name randomizer.
-000030f0: 2020 2a20 e298 9120 7772 6974 652d 6f6e    * ... write-on
-00003100: 6c79 2066 6f6c 6465 7273 0a20 202a 20e2  ly folders.  * .
-00003110: 9891 205b 756e 706f 7374 5d28 2375 6e70  .. [unpost](#unp
-00003120: 6f73 7429 3a20 756e 646f 2f64 656c 6574  ost): undo/delet
-00003130: 6520 6163 6369 6465 6e74 616c 2075 706c  e accidental upl
-00003140: 6f61 6473 0a20 202a 20e2 9891 205b 7365  oads.  * ... [se
-00003150: 6c66 2d64 6573 7472 7563 745d 2823 7365  lf-destruct](#se
-00003160: 6c66 2d64 6573 7472 7563 7429 2028 7370  lf-destruct) (sp
-00003170: 6563 6966 6965 6420 7365 7276 6572 2d73  ecified server-s
-00003180: 6964 6520 6f72 2063 6c69 656e 742d 7369  ide or client-si
-00003190: 6465 290a 2020 2a20 e298 9120 7379 6d6c  de).  * ... syml
-000031a0: 696e 6b2f 6469 7363 6172 6420 6578 6973  ink/discard exis
-000031b0: 7469 6e67 2066 696c 6573 2028 636f 6e74  ting files (cont
-000031c0: 656e 742d 6d61 7463 6869 6e67 290a 2a20  ent-matching).* 
-000031d0: 646f 776e 6c6f 6164 0a20 202a 20e2 9891  download.  * ...
-000031e0: 2073 696e 676c 6520 6669 6c65 7320 696e   single files in
-000031f0: 2062 726f 7773 6572 0a20 202a 20e2 9891   browser.  * ...
-00003200: 205b 666f 6c64 6572 7320 6173 207a 6970   [folders as zip
-00003210: 202f 2074 6172 2066 696c 6573 5d28 237a   / tar files](#z
-00003220: 6970 2d64 6f77 6e6c 6f61 6473 290a 2020  ip-downloads).  
-00003230: 2a20 e298 9120 5b46 5553 4520 636c 6965  * ... [FUSE clie
-00003240: 6e74 5d28 6874 7470 733a 2f2f 6769 7468  nt](https://gith
-00003250: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00003260: 7061 7274 792f 7472 6565 2f68 6f76 7564  party/tree/hovud
-00003270: 7374 7261 756d 2f62 696e 2370 6172 7479  straum/bin#party
-00003280: 6675 7365 7079 2920 2872 6561 642d 6f6e  fusepy) (read-on
-00003290: 6c79 290a 2a20 6272 6f77 7365 720a 2020  ly).* browser.  
-000032a0: 2a20 e298 9120 5b6e 6176 7061 6e65 5d28  * ... [navpane](
-000032b0: 236e 6176 7061 6e65 2920 2864 6972 6563  #navpane) (direc
-000032c0: 746f 7279 2074 7265 6520 7369 6465 6261  tory tree sideba
-000032d0: 7229 0a20 202a 20e2 9891 2066 696c 6520  r).  * ... file 
-000032e0: 6d61 6e61 6765 7220 2863 7574 2f70 6173  manager (cut/pas
-000032f0: 7465 2c20 6465 6c65 7465 2c20 5b62 6174  te, delete, [bat
-00003300: 6368 2d72 656e 616d 655d 2823 6261 7463  ch-rename](#batc
-00003310: 682d 7265 6e61 6d65 2929 0a20 202a 20e2  h-rename)).  * .
-00003320: 9891 2061 7564 696f 2070 6c61 7965 7220  .. audio player 
-00003330: 2877 6974 6820 5b4f 5320 6d65 6469 6120  (with [OS media 
-00003340: 636f 6e74 726f 6c73 5d28 6874 7470 733a  controls](https:
-00003350: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-00003360: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-00003370: 636f 6d2f 3234 3130 3332 2f32 3135 3334  com/241032/21534
-00003380: 3734 3932 2d62 3432 3530 3739 372d 3663  7492-b4250797-6c
-00003390: 3930 2d34 6530 392d 3961 3463 2d37 3231  90-4e09-9a4c-721
-000033a0: 6564 6632 6662 3135 632e 706e 6729 2061  edf2fb15c.png) a
-000033b0: 6e64 206f 7075 7320 7472 616e 7363 6f64  nd opus transcod
-000033c0: 696e 6729 0a20 202a 20e2 9891 2069 6d61  ing).  * ... ima
-000033d0: 6765 2067 616c 6c65 7279 2077 6974 6820  ge gallery with 
-000033e0: 7765 626d 2070 6c61 7965 720a 2020 2a20  webm player.  * 
-000033f0: e298 9120 7465 7874 6669 6c65 2062 726f  ... textfile bro
-00003400: 7773 6572 2077 6974 6820 7379 6e74 6178  wser with syntax
-00003410: 2068 696c 6967 6874 696e 670a 2020 2a20   hilighting.  * 
-00003420: e298 9120 5b74 6875 6d62 6e61 696c 735d  ... [thumbnails]
-00003430: 2823 7468 756d 626e 6169 6c73 290a 2020  (#thumbnails).  
-00003440: 2020 2a20 e298 9120 2e2e 2e6f 6620 696d    * ... ...of im
-00003450: 6167 6573 2075 7369 6e67 2050 696c 6c6f  ages using Pillo
-00003460: 772c 2070 7976 6970 732c 206f 7220 4646  w, pyvips, or FF
-00003470: 6d70 6567 0a20 2020 202a 20e2 9891 202e  mpeg.    * ... .
-00003480: 2e2e 6f66 2076 6964 656f 7320 7573 696e  ..of videos usin
-00003490: 6720 4646 6d70 6567 0a20 2020 202a 20e2  g FFmpeg.    * .
-000034a0: 9891 202e 2e2e 6f66 2061 7564 696f 2028  .. ...of audio (
-000034b0: 7370 6563 7472 6f67 7261 6d73 2920 7573  spectrograms) us
-000034c0: 696e 6720 4646 6d70 6567 0a20 2020 202a  ing FFmpeg.    *
-000034d0: 20e2 9891 2063 6163 6865 2065 7669 6374   ... cache evict
-000034e0: 696f 6e20 286d 6178 2d61 6765 3b20 6d61  ion (max-age; ma
-000034f0: 7962 6520 6d61 782d 7369 7a65 2065 7665  ybe max-size eve
-00003500: 6e74 7561 6c6c 7929 0a20 202a 20e2 9891  ntually).  * ...
-00003510: 2053 5041 2028 6272 6f77 7365 2077 6869   SPA (browse whi
-00003520: 6c65 2075 706c 6f61 6469 6e67 290a 2a20  le uploading).* 
-00003530: 7365 7276 6572 2069 6e64 6578 696e 670a  server indexing.
-00003540: 2020 2a20 e298 9120 5b6c 6f63 6174 6520    * ... [locate 
-00003550: 6669 6c65 7320 6279 2063 6f6e 7465 6e74  files by content
-00003560: 735d 2823 6669 6c65 2d73 6561 7263 6829  s](#file-search)
-00003570: 0a20 202a 20e2 9891 2073 6561 7263 6820  .  * ... search 
-00003580: 6279 206e 616d 652f 7061 7468 2f64 6174  by name/path/dat
-00003590: 652f 7369 7a65 0a20 202a 20e2 9891 205b  e/size.  * ... [
-000035a0: 7365 6172 6368 2062 7920 4944 332d 7461  search by ID3-ta
-000035b0: 6773 2065 7463 2e5d 2823 7365 6172 6368  gs etc.](#search
-000035c0: 696e 6729 0a2a 2063 6c69 656e 7420 7375  ing).* client su
-000035d0: 7070 6f72 740a 2020 2a20 e298 9120 5b73  pport.  * ... [s
-000035e0: 796e 6320 666f 6c64 6572 2074 6f20 7365  ync folder to se
-000035f0: 7276 6572 5d28 6874 7470 733a 2f2f 6769  rver](https://gi
-00003600: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
-00003610: 7079 7061 7274 792f 7472 6565 2f68 6f76  pyparty/tree/hov
-00003620: 7564 7374 7261 756d 2f62 696e 2375 7032  udstraum/bin#up2
-00003630: 6b70 7929 0a20 202a 20e2 9891 205b 6375  kpy).  * ... [cu
-00003640: 726c 2d66 7269 656e 646c 795d 2868 7474  rl-friendly](htt
-00003650: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-00003660: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-00003670: 6e74 2e63 6f6d 2f32 3431 3033 322f 3231  nt.com/241032/21
-00003680: 3533 3232 3631 392d 6561 3566 6436 3036  5322619-ea5fd606
-00003690: 2d33 3635 342d 3430 6164 2d39 3465 652d  -3654-40ad-94ee-
-000036a0: 3262 6330 3538 3634 3762 6232 2e70 6e67  2bc058647bb2.png
-000036b0: 290a 2a20 6d61 726b 646f 776e 0a20 202a  ).* markdown.  *
-000036c0: 20e2 9891 205b 7669 6577 6572 5d28 236d   ... [viewer](#m
-000036d0: 6172 6b64 6f77 6e2d 7669 6577 6572 290a  arkdown-viewer).
-000036e0: 2020 2a20 e298 9120 6564 6974 6f72 2028    * ... editor (
-000036f0: 7375 7265 2077 6879 206e 6f74 290a 0a50  sure why not)..P
-00003700: 533a 2073 6f6d 6574 6869 6e67 206d 6973  S: something mis
-00003710: 7369 6e67 3f20 706f 7374 2061 6e79 2063  sing? post any c
-00003720: 7261 7a79 2069 6465 6173 2079 6f75 2776  razy ideas you'v
-00003730: 6520 676f 7420 6173 2061 205b 6665 6174  e got as a [feat
-00003740: 7572 6520 7265 7175 6573 745d 2868 7474  ure request](htt
-00003750: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-00003760: 3930 3031 2f63 6f70 7970 6172 7479 2f69  9001/copyparty/i
-00003770: 7373 7565 732f 6e65 773f 6173 7369 676e  ssues/new?assign
-00003780: 6565 733d 3930 3031 266c 6162 656c 733d  ees=9001&labels=
-00003790: 656e 6861 6e63 656d 656e 7426 7465 6d70  enhancement&temp
-000037a0: 6c61 7465 3d66 6561 7475 7265 5f72 6571  late=feature_req
-000037b0: 7565 7374 2e6d 6429 206f 7220 5b64 6973  uest.md) or [dis
-000037c0: 6375 7373 696f 6e5d 2868 7474 7073 3a2f  cussion](https:/
-000037d0: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
-000037e0: 2f63 6f70 7970 6172 7479 2f64 6973 6375  /copyparty/discu
-000037f0: 7373 696f 6e73 2f6e 6577 3f63 6174 6567  ssions/new?categ
-00003800: 6f72 793d 6964 6561 7329 20f0 9fa4 990a  ory=ideas) .....
-00003810: 0a0a 2323 2074 6573 7469 6d6f 6e69 616c  ..## testimonial
-00003820: 730a 0a73 6d61 6c6c 2063 6f6c 6c65 6374  s..small collect
-00003830: 696f 6e20 6f66 2075 7365 7220 6665 6564  ion of user feed
-00003840: 6261 636b 0a0a 6067 6f6f 6420 656e 6f75  back..`good enou
-00003850: 6768 602c 2060 7375 7270 7269 7369 6e67  gh`, `surprising
-00003860: 6c79 2063 6f72 7265 6374 602c 2060 6365  ly correct`, `ce
-00003870: 7274 6966 6965 6420 676f 6f64 2073 6f66  rtified good sof
-00003880: 7477 6172 6560 2c20 606a 7573 7420 776f  tware`, `just wo
-00003890: 726b 7360 2c20 6077 6879 602c 2060 776f  rks`, `why`, `wo
-000038a0: 7720 7468 6973 2069 7320 6265 7474 6572  w this is better
-000038b0: 2074 6861 6e20 6e65 7874 636c 6f75 6460   than nextcloud`
-000038c0: 0a0a 0a23 206d 6f74 6976 6174 696f 6e73  ...# motivations
-000038d0: 0a0a 7072 6f6a 6563 7420 676f 616c 7320  ..project goals 
-000038e0: 2f20 7068 696c 6f73 6f70 6879 0a0a 2a20  / philosophy..* 
-000038f0: 696e 7665 7273 6520 6c69 6e75 7820 7068  inverse linux ph
-00003900: 696c 6f73 6f70 6879 202d 2d20 646f 2061  ilosophy -- do a
-00003910: 6c6c 2074 6865 2074 6869 6e67 732c 2061  ll the things, a
-00003920: 6e64 2064 6f20 616e 202a 6f6b 6179 2a20  nd do an *okay* 
-00003930: 6a6f 620a 2020 2a20 7175 6963 6b20 6472  job.  * quick dr
-00003940: 6f70 2d69 6e20 7365 7276 6963 6520 746f  op-in service to
-00003950: 2067 6574 2061 206c 6f74 206f 6620 6665   get a lot of fe
-00003960: 6174 7572 6573 2069 6e20 6120 7069 6e63  atures in a pinc
-00003970: 680a 2020 2a20 736f 6d65 206f 6620 5b74  h.  * some of [t
-00003980: 6865 2061 6c74 6572 6e61 7469 7665 735d  he alternatives]
-00003990: 282e 2f64 6f63 732f 7665 7273 7573 2e6d  (./docs/versus.m
-000039a0: 6429 206d 6967 6874 2062 6520 6120 6265  d) might be a be
-000039b0: 7474 6572 2066 6974 2066 6f72 2079 6f75  tter fit for you
-000039c0: 0a2a 2072 756e 2061 6e79 7768 6572 652c  .* run anywhere,
-000039d0: 2073 7570 706f 7274 2065 7665 7279 7468   support everyth
-000039e0: 696e 670a 2020 2a20 6173 206d 616e 7920  ing.  * as many 
-000039f0: 7765 622d 6272 6f77 7365 7273 2061 6e64  web-browsers and
-00003a00: 2070 7974 686f 6e20 7665 7273 696f 6e73   python versions
-00003a10: 2061 7320 706f 7373 6962 6c65 0a20 2020   as possible.   
-00003a20: 202a 2065 7665 7279 2062 726f 7773 6572   * every browser
-00003a30: 2073 686f 756c 6420 6174 206c 6561 7374   should at least
-00003a40: 2062 6520 6162 6c65 2074 6f20 6272 6f77   be able to brow
-00003a50: 7365 2c20 646f 776e 6c6f 6164 2c20 7570  se, download, up
-00003a60: 6c6f 6164 2066 696c 6573 0a20 2020 202a  load files.    *
-00003a70: 2062 6520 6120 676f 6f64 2065 6d65 7267   be a good emerg
-00003a80: 656e 6379 2073 6f6c 7574 696f 6e20 666f  ency solution fo
-00003a90: 7220 7472 616e 7366 6572 7269 6e67 2073  r transferring s
-00003aa0: 7475 6666 2062 6574 7765 656e 2061 6e63  tuff between anc
-00003ab0: 6965 6e74 2062 6f78 6573 0a20 202a 206d  ient boxes.  * m
-00003ac0: 696e 696d 616c 2064 6570 656e 6465 6e63  inimal dependenc
-00003ad0: 6965 730a 2020 2020 2a20 6275 7420 6f70  ies.    * but op
-00003ae0: 7469 6f6e 616c 2064 6570 656e 6465 6e63  tional dependenc
-00003af0: 6965 7320 6164 6469 6e67 2062 6f6e 7573  ies adding bonus
-00003b00: 2d66 6561 7475 7265 7320 6172 6520 6f6b  -features are ok
-00003b10: 0a20 2020 202a 2065 7665 7279 7468 696e  .    * everythin
-00003b20: 6720 6265 696e 6720 706c 6169 6e74 6578  g being plaintex
-00003b30: 7420 6d61 6b65 7320 6974 2070 6f73 7369  t makes it possi
-00003b40: 626c 6520 746f 2070 726f 6f66 7265 6164  ble to proofread
-00003b50: 2066 6f72 206d 616c 6963 696f 7573 2063   for malicious c
-00003b60: 6f64 650a 2020 2a20 6e6f 2070 7265 7061  ode.  * no prepa
-00003b70: 7261 7469 6f6e 7320 2f20 7365 7475 7020  rations / setup 
-00003b80: 6e65 6365 7373 6172 792c 206a 7573 7420  necessary, just 
-00003b90: 7275 6e20 7468 6520 7366 7820 2877 6869  run the sfx (whi
-00003ba0: 6368 2069 7320 616c 736f 2070 6c61 696e  ch is also plain
-00003bb0: 7465 7874 290a 2a20 6164 6170 7461 626c  text).* adaptabl
-00003bc0: 652c 206d 616c 6c65 6162 6c65 2c20 6861  e, malleable, ha
-00003bd0: 636b 6162 6c65 0a20 202a 206e 6f20 6275  ckable.  * no bu
-00003be0: 696c 6420 7374 6570 733b 206d 6f64 6966  ild steps; modif
-00003bf0: 7920 7468 6520 6a73 2f70 7974 686f 6e20  y the js/python 
-00003c00: 7769 7468 6f75 7420 6e65 6564 696e 6720  without needing 
-00003c10: 6e6f 6465 2e6a 7320 6f72 2061 6e79 7468  node.js or anyth
-00003c20: 696e 6720 6c69 6b65 2074 6861 740a 0a0a  ing like that...
-00003c30: 2323 206e 6f74 6573 0a0a 6765 6e65 7261  ## notes..genera
-00003c40: 6c20 6e6f 7465 733a 0a2a 2070 6170 6572  l notes:.* paper
-00003c50: 2d70 7269 6e74 696e 6720 6973 2061 6666  -printing is aff
-00003c60: 6563 7465 6420 6279 2064 6172 6b2f 6c69  ected by dark/li
-00003c70: 6768 742d 6d6f 6465 2120 7573 6520 6c69  ght-mode! use li
-00003c80: 6768 746d 6f64 6520 666f 7220 636f 6c6f  ghtmode for colo
-00003c90: 722c 2064 6172 6b6d 6f64 6520 666f 7220  r, darkmode for 
-00003ca0: 6772 6179 7363 616c 650a 2020 2a20 6265  grayscale.  * be
-00003cb0: 6361 7573 6520 6e6f 2062 726f 7773 6572  cause no browser
-00003cc0: 7320 6375 7272 656e 746c 7920 696d 706c  s currently impl
-00003cd0: 656d 656e 7420 7468 6520 6d65 6469 612d  ement the media-
-00003ce0: 7175 6572 7920 746f 2064 6f20 7468 6973  query to do this
-00003cf0: 2070 726f 7065 726c 7920 6f72 7a0a 0a62   properly orz..b
-00003d00: 726f 7773 6572 2d73 7065 6369 6669 633a  rowser-specific:
-00003d10: 0a2a 2069 5068 6f6e 652f 6950 6164 3a20  .* iPhone/iPad: 
-00003d20: 7573 6520 4669 7265 666f 7820 746f 2064  use Firefox to d
-00003d30: 6f77 6e6c 6f61 6420 6669 6c65 730a 2a20  ownload files.* 
-00003d40: 416e 6472 6f69 642d 4368 726f 6d65 3a20  Android-Chrome: 
-00003d50: 696e 6372 6561 7365 2022 7061 7261 6c6c  increase "parall
-00003d60: 656c 2075 706c 6f61 6473 2220 666f 7220  el uploads" for 
-00003d70: 6869 6768 6572 2073 7065 6564 2028 616e  higher speed (an
-00003d80: 6472 6f69 6420 6275 6729 0a2a 2041 6e64  droid bug).* And
-00003d90: 726f 6964 2d46 6972 6566 6f78 3a20 7461  roid-Firefox: ta
-00003da0: 6b65 7320 6120 7768 696c 6520 746f 2073  kes a while to s
-00003db0: 656c 6563 7420 6669 6c65 7320 2874 6865  elect files (the
-00003dc0: 6972 2066 6978 2066 6f72 20e2 989d efb8  ir fix for .....
-00003dd0: 8f29 0a2a 2044 6573 6b74 6f70 2d46 6972  .).* Desktop-Fir
-00003de0: 6566 6f78 3a20 7e7e 6d61 7920 7573 6520  efox: ~~may use 
-00003df0: 6769 6761 6279 7465 7320 6f66 2052 414d  gigabytes of RAM
-00003e00: 2069 6620 796f 7572 2066 696c 6573 2061   if your files a
-00003e10: 7265 206d 6173 7369 7665 7e7e 202a 7365  re massive~~ *se
-00003e20: 656d 7320 746f 2062 6520 4f4b 206e 6f77  ems to be OK now
-00003e30: 2a0a 2a20 4465 736b 746f 702d 4669 7265  *.* Desktop-Fire
-00003e40: 666f 783a 205b 6d61 7920 7374 6f70 2079  fox: [may stop y
-00003e50: 6f75 2066 726f 6d20 756e 706c 7567 6769  ou from unpluggi
-00003e60: 6e67 2055 5342 2066 6c61 7368 6472 6976  ng USB flashdriv
-00003e70: 6573 5d28 6874 7470 733a 2f2f 6275 677a  es](https://bugz
-00003e80: 696c 6c61 2e6d 6f7a 696c 6c61 2e6f 7267  illa.mozilla.org
-00003e90: 2f73 686f 775f 6275 672e 6367 693f 6964  /show_bug.cgi?id
-00003ea0: 3d31 3739 3235 3938 2920 756e 7469 6c20  =1792598) until 
-00003eb0: 796f 7520 7669 7369 7420 6061 626f 7574  you visit `about
-00003ec0: 3a6d 656d 6f72 7960 2061 6e64 2063 6c69  :memory` and cli
-00003ed0: 636b 2060 4d69 6e69 6d69 7a65 206d 656d  ck `Minimize mem
-00003ee0: 6f72 7920 7573 6167 6560 0a0a 7365 7276  ory usage`..serv
-00003ef0: 6572 2d6f 732d 7370 6563 6966 6963 3a0a  er-os-specific:.
-00003f00: 2a20 5248 454c 3820 2f20 526f 636b 7938  * RHEL8 / Rocky8
-00003f10: 3a20 796f 7520 6361 6e20 7275 6e20 636f  : you can run co
-00003f20: 7079 7061 7274 7920 7573 696e 6720 602f  pyparty using `/
-00003f30: 7573 722f 6c69 6265 7865 632f 706c 6174  usr/libexec/plat
-00003f40: 666f 726d 2d70 7974 686f 6e60 0a0a 7365  form-python`..se
-00003f50: 7276 6572 206e 6f74 6573 3a0a 2a20 7079  rver notes:.* py
-00003f60: 7079 2069 7320 7375 7070 6f72 7465 6420  py is supported 
-00003f70: 6275 7420 7265 6775 6c61 7220 6370 7974  but regular cpyt
-00003f80: 686f 6e20 6973 2066 6173 7465 7220 6966  hon is faster if
-00003f90: 2079 6f75 2065 6e61 626c 6520 7468 6520   you enable the 
-00003fa0: 6461 7461 6261 7365 0a0a 0a23 2062 7567  database...# bug
-00003fb0: 730a 0a2a 2057 696e 646f 7773 3a20 7079  s..* Windows: py
-00003fc0: 7468 6f6e 2032 2e37 2063 616e 6e6f 7420  thon 2.7 cannot 
-00003fd0: 696e 6465 7820 6e6f 6e2d 6173 6369 6920  index non-ascii 
-00003fe0: 6669 6c65 6e61 6d65 7320 7769 7468 2060  filenames with `
-00003ff0: 2d65 3264 600a 2a20 5769 6e64 6f77 733a  -e2d`.* Windows:
-00004000: 2070 7974 686f 6e20 322e 3720 6361 6e6e   python 2.7 cann
-00004010: 6f74 2068 616e 646c 6520 6669 6c65 6e61  ot handle filena
-00004020: 6d65 7320 7769 7468 206d 6f6a 6962 616b  mes with mojibak
-00004030: 650a 2a20 602d 2d74 682d 6666 2d6a 7067  e.* `--th-ff-jpg
-00004040: 6020 6d61 7920 6669 7820 7669 6465 6f20  ` may fix video 
-00004050: 7468 756d 626e 6169 6c73 206f 6e20 736f  thumbnails on so
-00004060: 6d65 2046 466d 7065 6720 7665 7273 696f  me FFmpeg versio
-00004070: 6e73 2028 6d61 636f 732c 2073 6f6d 6520  ns (macos, some 
-00004080: 6c69 6e75 7829 0a2a 2060 2d2d 7468 2d66  linux).* `--th-f
-00004090: 662d 7377 7260 206d 6179 2066 6978 2061  f-swr` may fix a
-000040a0: 7564 696f 2074 6875 6d62 6e61 696c 7320  udio thumbnails 
-000040b0: 6f6e 2073 6f6d 6520 4646 6d70 6567 2076  on some FFmpeg v
-000040c0: 6572 7369 6f6e 730a 0a23 2320 6765 6e65  ersions..## gene
-000040d0: 7261 6c20 6275 6773 0a0a 2a20 5769 6e64  ral bugs..* Wind
-000040e0: 6f77 733a 2069 6620 7468 6520 6075 7032  ows: if the `up2
-000040f0: 6b2e 6462 6020 2866 696c 6573 7973 7465  k.db` (filesyste
-00004100: 6d20 696e 6465 7829 2069 7320 6f6e 2061  m index) is on a
-00004110: 2073 616d 6261 2d73 6861 7265 206f 7220   samba-share or 
-00004120: 6e65 7477 6f72 6b20 6469 736b 2c20 796f  network disk, yo
-00004130: 7527 6c6c 2067 6574 2075 6e70 7265 6469  u'll get unpredi
-00004140: 6374 6162 6c65 2062 6568 6176 696f 7220  ctable behavior 
-00004150: 6966 2074 6865 2073 6861 7265 2069 7320  if the share is 
-00004160: 6469 7363 6f6e 6e65 6374 6564 2066 6f72  disconnected for
-00004170: 2061 2062 6974 0a20 202a 2075 7365 2060   a bit.  * use `
-00004180: 2d2d 6869 7374 6020 6f72 2074 6865 2060  --hist` or the `
-00004190: 6869 7374 6020 766f 6c66 6c61 6720 2860  hist` volflag (`
-000041a0: 2d76 205b 2e2e 2e5d 3a63 2c68 6973 743d  -v [...]:c,hist=
-000041b0: 2f74 6d70 2f66 6f6f 6029 2074 6f20 706c  /tmp/foo`) to pl
-000041c0: 6163 6520 7468 6520 6462 206f 6e20 6120  ace the db on a 
-000041d0: 6c6f 6361 6c20 6469 736b 2069 6e73 7465  local disk inste
-000041e0: 6164 0a2a 2061 6c6c 2076 6f6c 756d 6573  ad.* all volumes
-000041f0: 206d 7573 7420 6578 6973 7420 2f20 6265   must exist / be
-00004200: 2061 7661 696c 6162 6c65 206f 6e20 7374   available on st
-00004210: 6172 7475 703b 2075 7032 6b20 286d 7470  artup; up2k (mtp
-00004220: 2065 7370 6563 6961 6c6c 7929 2067 6574   especially) get
-00004230: 7320 6675 6e6b 7920 6f74 6865 7277 6973  s funky otherwis
-00004240: 650a 2a20 7072 6f62 6162 6c79 206d 6f72  e.* probably mor
-00004250: 652c 2070 6c73 206c 6574 206d 6520 6b6e  e, pls let me kn
-00004260: 6f77 0a0a 2323 206e 6f74 206d 7920 6275  ow..## not my bu
-00004270: 6773 0a0a 2a20 5b43 6872 6f6d 6520 6973  gs..* [Chrome is
-00004280: 7375 6520 3133 3137 3036 395d 2868 7474  sue 1317069](htt
-00004290: 7073 3a2f 2f62 7567 732e 6368 726f 6d69  ps://bugs.chromi
-000042a0: 756d 2e6f 7267 2f70 2f63 6872 6f6d 6975  um.org/p/chromiu
-000042b0: 6d2f 6973 7375 6573 2f64 6574 6169 6c3f  m/issues/detail?
-000042c0: 6964 3d31 3331 3730 3639 2920 2d2d 2069  id=1317069) -- i
-000042d0: 6620 796f 7520 7472 7920 746f 2075 706c  f you try to upl
-000042e0: 6f61 6420 6120 666f 6c64 6572 2077 6869  oad a folder whi
-000042f0: 6368 2063 6f6e 7461 696e 7320 7379 6d6c  ch contains syml
-00004300: 696e 6b73 2062 7920 6472 6167 6769 6e67  inks by dragging
-00004310: 2069 7420 696e 746f 2074 6865 2062 726f   it into the bro
-00004320: 7773 6572 2c20 7468 6520 7379 6d6c 696e  wser, the symlin
-00004330: 6b65 6420 6669 6c65 7320 7769 6c6c 206e  ked files will n
-00004340: 6f74 2067 6574 2075 706c 6f61 6465 640a  ot get uploaded.
-00004350: 0a2a 205b 4368 726f 6d65 2069 7373 7565  .* [Chrome issue
-00004360: 2031 3335 3232 3130 5d28 6874 7470 733a   1352210](https:
-00004370: 2f2f 6275 6773 2e63 6872 6f6d 6975 6d2e  //bugs.chromium.
-00004380: 6f72 672f 702f 6368 726f 6d69 756d 2f69  org/p/chromium/i
-00004390: 7373 7565 732f 6465 7461 696c 3f69 643d  ssues/detail?id=
-000043a0: 3133 3532 3231 3029 202d 2d20 706c 6169  1352210) -- plai
-000043b0: 6e74 6578 7420 6874 7470 206d 6179 2062  ntext http may b
-000043c0: 6520 6661 7374 6572 2061 7420 6669 6c65  e faster at file
-000043d0: 6861 7368 696e 6720 7468 616e 2068 7474  hashing than htt
-000043e0: 7073 2028 6275 7420 616c 736f 2065 7874  ps (but also ext
-000043f0: 7265 6d65 6c79 2043 5055 2d69 6e74 656e  remely CPU-inten
-00004400: 7369 7665 290a 0a2a 205b 4669 7265 666f  sive)..* [Firefo
-00004410: 7820 6973 7375 6520 3137 3930 3530 305d  x issue 1790500]
-00004420: 2868 7474 7073 3a2f 2f62 7567 7a69 6c6c  (https://bugzill
-00004430: 612e 6d6f 7a69 6c6c 612e 6f72 672f 7368  a.mozilla.org/sh
-00004440: 6f77 5f62 7567 2e63 6769 3f69 643d 3137  ow_bug.cgi?id=17
-00004450: 3930 3530 3029 202d 2d20 656e 7469 7265  90500) -- entire
-00004460: 2062 726f 7773 6572 2063 616e 2063 7261   browser can cra
-00004470: 7368 2061 6674 6572 2075 706c 6f61 6469  sh after uploadi
-00004480: 6e67 207e 3430 3030 2073 6d61 6c6c 2066  ng ~4000 small f
-00004490: 696c 6573 0a0a 2a20 6950 686f 6e65 733a  iles..* iPhones:
-000044a0: 2074 6865 2076 6f6c 756d 6520 636f 6e74   the volume cont
-000044b0: 726f 6c20 646f 6573 6e27 7420 776f 726b  rol doesn't work
-000044c0: 2062 6563 6175 7365 205b 6170 706c 6520   because [apple 
-000044d0: 646f 6573 6e27 7420 7761 6e74 2069 7420  doesn't want it 
-000044e0: 746f 5d28 6874 7470 733a 2f2f 6465 7665  to](https://deve
-000044f0: 6c6f 7065 722e 6170 706c 652e 636f 6d2f  loper.apple.com/
-00004500: 6c69 6272 6172 792f 6172 6368 6976 652f  library/archive/
-00004510: 646f 6375 6d65 6e74 6174 696f 6e2f 4175  documentation/Au
-00004520: 6469 6f56 6964 656f 2f43 6f6e 6365 7074  dioVideo/Concept
-00004530: 7561 6c2f 5573 696e 675f 4854 4d4c 355f  ual/Using_HTML5_
-00004540: 4175 6469 6f5f 5669 6465 6f2f 4465 7669  Audio_Video/Devi
-00004550: 6365 2d53 7065 6369 6669 6343 6f6e 7369  ce-SpecificConsi
-00004560: 6465 7261 7469 6f6e 732f 4465 7669 6365  derations/Device
-00004570: 2d53 7065 6369 6669 6343 6f6e 7369 6465  -SpecificConside
-00004580: 7261 7469 6f6e 732e 6874 6d6c 232f 2f61  rations.html#//a
-00004590: 7070 6c65 5f72 6566 2f64 6f63 2f75 6964  pple_ref/doc/uid
-000045a0: 2f54 5034 3030 3039 3532 332d 4348 352d  /TP40009523-CH5-
-000045b0: 5357 3131 290a 2020 2a20 2a66 7574 7572  SW11).  * *futur
-000045c0: 6520 776f 726b 6172 6f75 6e64 3a2a 2065  e workaround:* e
-000045d0: 6e61 626c 6520 7468 6520 6571 7561 6c69  nable the equali
-000045e0: 7a65 722c 206d 616b 6520 6974 2061 6c6c  zer, make it all
-000045f0: 2d7a 6572 6f2c 2061 6e64 2073 6574 2061  -zero, and set a
-00004600: 206e 6567 6174 6976 6520 626f 6f73 7420   negative boost 
-00004610: 746f 2072 6564 7563 6520 7468 6520 766f  to reduce the vo
-00004620: 6c75 6d65 0a20 2020 202a 2022 6675 7475  lume.    * "futu
-00004630: 7265 2220 6265 6361 7573 6520 6041 7564  re" because `Aud
-00004640: 696f 436f 6e74 6578 7460 2069 7320 6272  ioContext` is br
-00004650: 6f6b 656e 2069 6e20 7468 6520 6375 7272  oken in the curr
-00004660: 656e 7420 694f 5320 7665 7273 696f 6e20  ent iOS version 
-00004670: 2831 352e 3129 2c20 6d61 7962 6520 6f6e  (15.1), maybe on
-00004680: 6520 6461 792e 2e2e 0a0a 2a20 5769 6e64  e day.....* Wind
-00004690: 6f77 733a 2066 6f6c 6465 7273 2063 616e  ows: folders can
-000046a0: 6e6f 7420 6265 2061 6363 6573 7365 6420  not be accessed 
-000046b0: 6966 2074 6865 206e 616d 6520 656e 6473  if the name ends
-000046c0: 2077 6974 6820 602e 600a 2020 2a20 7079   with `.`.  * py
-000046d0: 7468 6f6e 206f 7220 7769 6e64 6f77 7320  thon or windows 
-000046e0: 6275 670a 0a2a 2057 696e 646f 7773 3a20  bug..* Windows: 
-000046f0: 6d73 7973 322d 7079 7468 6f6e 2033 2e38  msys2-python 3.8
-00004700: 2e36 206f 6363 6173 696f 6e61 6c6c 7920  .6 occasionally 
-00004710: 7468 726f 7773 2060 5275 6e74 696d 6545  throws `RuntimeE
-00004720: 7272 6f72 3a20 7265 6c65 6173 6520 756e  rror: release un
-00004730: 6c6f 636b 6564 206c 6f63 6b60 2077 6865  locked lock` whe
-00004740: 6e20 6c65 6176 696e 6720 6120 7363 6f70  n leaving a scop
-00004750: 6564 206d 7574 6578 2069 6e20 7570 326b  ed mutex in up2k
-00004760: 0a20 202a 2074 6869 7320 6973 2061 6e20  .  * this is an 
-00004770: 6d73 7973 3220 6275 672c 2074 6865 2072  msys2 bug, the r
-00004780: 6567 756c 6172 2077 696e 646f 7773 2065  egular windows e
-00004790: 6469 7469 6f6e 206f 6620 7079 7468 6f6e  dition of python
-000047a0: 2069 7320 6669 6e65 0a0a 2a20 5669 7274   is fine..* Virt
-000047b0: 7561 6c42 6f78 3a20 7371 6c69 7465 2074  ualBox: sqlite t
-000047c0: 6872 6f77 7320 6044 6973 6b20 492f 4f20  hrows `Disk I/O 
-000047d0: 4572 726f 7260 2077 6865 6e20 7275 6e6e  Error` when runn
-000047e0: 696e 6720 696e 2061 2056 4d20 616e 6420  ing in a VM and 
-000047f0: 7468 6520 7570 326b 2064 6174 6162 6173  the up2k databas
-00004800: 6520 6973 2069 6e20 6120 7662 6f78 7366  e is in a vboxsf
-00004810: 0a20 202a 2075 7365 2060 2d2d 6869 7374  .  * use `--hist
-00004820: 6020 6f72 2074 6865 2060 6869 7374 6020  ` or the `hist` 
-00004830: 766f 6c66 6c61 6720 2860 2d76 205b 2e2e  volflag (`-v [..
-00004840: 2e5d 3a63 2c68 6973 743d 2f74 6d70 2f66  .]:c,hist=/tmp/f
-00004850: 6f6f 6029 2074 6f20 706c 6163 6520 7468  oo`) to place th
-00004860: 6520 6462 2069 6e73 6964 6520 7468 6520  e db inside the 
-00004870: 766d 2069 6e73 7465 6164 0a0a 2a20 5562  vm instead..* Ub
-00004880: 756e 7475 3a20 6472 6167 6769 6e67 2066  untu: dragging f
-00004890: 696c 6573 2066 726f 6d20 6365 7274 6169  iles from certai
-000048a0: 6e20 666f 6c64 6572 7320 696e 746f 2066  n folders into f
-000048b0: 6972 6566 6f78 206f 7220 6368 726f 6d65  irefox or chrome
-000048c0: 2069 7320 696d 706f 7373 6962 6c65 0a20   is impossible. 
-000048d0: 202a 2064 7565 2074 6f20 736e 6170 2073   * due to snap s
-000048e0: 6563 7572 6974 7920 706f 6c69 6369 6573  ecurity policies
-000048f0: 202d 2d20 7365 6520 6073 6e61 7020 636f   -- see `snap co
-00004900: 6e6e 6563 7469 6f6e 7320 6669 7265 666f  nnections firefo
-00004910: 7860 2066 6f72 2074 6865 2061 6c6c 6f77  x` for the allow
-00004920: 6c69 7374 2c20 6072 656d 6f76 6162 6c65  list, `removable
-00004930: 2d6d 6564 6961 6020 7065 726d 6974 7320  -media` permits 
-00004940: 616c 6c20 6f66 2060 2f6d 6e74 6020 616e  all of `/mnt` an
-00004950: 6420 602f 6d65 6469 6160 2061 7070 6172  d `/media` appar
-00004960: 656e 746c 790a 0a0a 2320 6272 6561 6b69  ently...# breaki
-00004970: 6e67 2063 6861 6e67 6573 0a0a 7570 6772  ng changes..upgr
-00004980: 6164 6520 6e6f 7465 730a 0a2a 2060 312e  ade notes..* `1.
-00004990: 362e 3060 2028 3230 3233 2d30 312d 3239  6.0` (2023-01-29
-000049a0: 293a 0a20 202a 2068 7474 702d 6170 693a  ):.  * http-api:
-000049b0: 2064 656c 6574 652f 6d6f 7665 2069 7320   delete/move is 
-000049c0: 6e6f 7720 6050 4f53 5460 2069 6e73 7465  now `POST` inste
-000049d0: 6164 206f 6620 6047 4554 600a 2020 2a20  ad of `GET`.  * 
-000049e0: 6576 6572 7974 6869 6e67 206f 7468 6572  everything other
-000049f0: 2074 6861 6e20 6047 4554 6020 616e 6420   than `GET` and 
-00004a00: 6048 4541 4460 206d 7573 7420 7061 7373  `HEAD` must pass
-00004a10: 205b 636f 7273 2076 616c 6964 6174 696f   [cors validatio
-00004a20: 6e5d 2823 636f 7273 290a 2a20 6031 2e35  n](#cors).* `1.5
-00004a30: 2e30 6020 2832 3032 322d 3132 2d30 3329  .0` (2022-12-03)
-00004a40: 3a20 5b6e 6577 2063 6875 6e6b 7369 7a65  : [new chunksize
-00004a50: 2066 6f72 6d75 6c61 5d28 6874 7470 733a   formula](https:
-00004a60: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
-00004a70: 312f 636f 7079 7061 7274 792f 636f 6d6d  1/copyparty/comm
-00004a80: 6974 2f35 3465 3163 3864 3236 3164 6629  it/54e1c8d261df)
-00004a90: 2066 6f72 2066 696c 6573 206c 6172 6765   for files large
-00004aa0: 7220 7468 616e 2031 3238 2047 6942 0a20  r than 128 GiB. 
-00004ab0: 202a 202a 2a75 7365 7273 3a2a 2a20 7570   * **users:** up
-00004ac0: 6772 6164 6520 746f 2074 6865 206c 6174  grade to the lat
-00004ad0: 6573 7420 5b63 6c69 2075 706c 6f61 6465  est [cli uploade
-00004ae0: 725d 2868 7474 7073 3a2f 2f67 6974 6875  r](https://githu
-00004af0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00004b00: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-00004b10: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00004b20: 7929 2069 6620 796f 7520 7573 6520 7468  y) if you use th
-00004b30: 6174 0a20 202a 202a 2a64 6576 733a 2a2a  at.  * **devs:**
-00004b40: 2075 7064 6174 6520 7468 6972 642d 7061   update third-pa
-00004b50: 7274 7920 7570 326b 2063 6c69 656e 7473  rty up2k clients
-00004b60: 2028 6966 2074 686f 7365 2065 7665 6e20   (if those even 
-00004b70: 6578 6973 7429 0a0a 0a23 2046 4151 0a0a  exist)...# FAQ..
-00004b80: 2266 7265 7175 656e 746c 7922 2061 736b  "frequently" ask
-00004b90: 6564 2071 7565 7374 696f 6e73 0a0a 2a20  ed questions..* 
-00004ba0: 6973 2069 7420 706f 7373 6962 6c65 2074  is it possible t
-00004bb0: 6f20 626c 6f63 6b20 7265 6164 2d61 6363  o block read-acc
-00004bc0: 6573 7320 746f 2066 6f6c 6465 7273 2075  ess to folders u
-00004bd0: 6e6c 6573 7320 796f 7520 6b6e 6f77 2074  nless you know t
-00004be0: 6865 2065 7861 6374 2055 524c 2066 6f72  he exact URL for
-00004bf0: 2061 2070 6172 7469 6375 6c61 7220 6669   a particular fi
-00004c00: 6c65 2069 6e73 6964 653f 0a20 202a 2079  le inside?.  * y
-00004c10: 6573 2c20 7573 696e 6720 7468 6520 5b60  es, using the [`
-00004c20: 6760 2070 6572 6d69 7373 696f 6e5d 2823  g` permission](#
-00004c30: 6163 636f 756e 7473 2d61 6e64 2d76 6f6c  accounts-and-vol
-00004c40: 756d 6573 292c 2073 6565 2074 6865 2065  umes), see the e
-00004c50: 7861 6d70 6c65 7320 7468 6572 650a 2020  xamples there.  
-00004c60: 2a20 796f 7520 6361 6e20 616c 736f 2064  * you can also d
-00004c70: 6f20 7468 6973 2077 6974 6820 6c69 6e75  o this with linu
-00004c80: 7820 6669 6c65 7379 7374 656d 2070 6572  x filesystem per
-00004c90: 6d69 7373 696f 6e73 3b20 6063 686d 6f64  missions; `chmod
-00004ca0: 2031 3131 206d 7573 6963 6020 7769 6c6c   111 music` will
-00004cb0: 206d 616b 6520 6974 2070 6f73 7369 626c   make it possibl
-00004cc0: 6520 746f 2061 6363 6573 7320 6669 6c65  e to access file
-00004cd0: 7320 616e 6420 666f 6c64 6572 7320 696e  s and folders in
-00004ce0: 7369 6465 2074 6865 2060 6d75 7369 6360  side the `music`
-00004cf0: 2066 6f6c 6465 7220 6275 7420 6e6f 7420   folder but not 
-00004d00: 6c69 7374 2074 6865 2069 6d6d 6564 6961  list the immedia
-00004d10: 7465 2063 6f6e 7465 6e74 7320 2d2d 2061  te contents -- a
-00004d20: 6c73 6f20 776f 726b 7320 7769 7468 206f  lso works with o
-00004d30: 7468 6572 2073 6f66 7477 6172 652c 206e  ther software, n
-00004d40: 6f74 206a 7573 7420 636f 7079 7061 7274  ot just copypart
-00004d50: 790a 0a2a 2063 616e 2049 206d 616b 6520  y..* can I make 
-00004d60: 636f 7079 7061 7274 7920 646f 776e 6c6f  copyparty downlo
-00004d70: 6164 2061 2066 696c 6520 746f 206d 7920  ad a file to my 
-00004d80: 7365 7276 6572 2069 6620 4920 6769 7665  server if I give
-00004d90: 2069 7420 6120 5552 4c3f 0a20 202a 2079   it a URL?.  * y
-00004da0: 6573 2c20 7573 696e 6720 5b68 6f6f 6b73  es, using [hooks
-00004db0: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-00004dc0: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
-00004dd0: 7274 792f 626c 6f62 2f68 6f76 7564 7374  rty/blob/hovudst
-00004de0: 7261 756d 2f62 696e 2f68 6f6f 6b73 2f77  raum/bin/hooks/w
-00004df0: 6765 742e 7079 290a 0a0a 2320 6163 636f  get.py)...# acco
-00004e00: 756e 7473 2061 6e64 2076 6f6c 756d 6573  unts and volumes
-00004e10: 0a0a 7065 722d 666f 6c64 6572 2c20 7065  ..per-folder, pe
-00004e20: 722d 7573 6572 2070 6572 6d69 7373 696f  r-user permissio
-00004e30: 6e73 2020 2d20 6966 2079 6f75 7220 7365  ns  - if your se
-00004e40: 7475 7020 6973 2067 6574 7469 6e67 2063  tup is getting c
-00004e50: 6f6d 706c 6578 2c20 636f 6e73 6964 6572  omplex, consider
-00004e60: 206d 616b 696e 6720 6120 5b63 6f6e 6669   making a [confi
-00004e70: 6720 6669 6c65 5d28 2e2f 646f 6373 2f65  g file](./docs/e
-00004e80: 7861 6d70 6c65 2e63 6f6e 6629 2069 6e73  xample.conf) ins
-00004e90: 7465 6164 206f 6620 7573 696e 6720 6172  tead of using ar
-00004ea0: 6775 6d65 6e74 730a 2a20 6d75 6368 2065  guments.* much e
-00004eb0: 6173 6965 7220 746f 206d 616e 6167 652c  asier to manage,
-00004ec0: 2061 6e64 2079 6f75 2063 616e 206d 6f64   and you can mod
-00004ed0: 6966 7920 7468 6520 636f 6e66 6967 2061  ify the config a
-00004ee0: 7420 7275 6e74 696d 6520 7769 7468 2060  t runtime with `
-00004ef0: 7379 7374 656d 6374 6c20 7265 6c6f 6164  systemctl reload
-00004f00: 2063 6f70 7970 6172 7479 6020 6f72 206d   copyparty` or m
-00004f10: 6f72 6520 636f 6e76 656e 6965 6e74 6c79  ore conveniently
-00004f20: 2075 7369 6e67 2074 6865 2060 5b72 656c   using the `[rel
-00004f30: 6f61 6420 6366 675d 6020 6275 7474 6f6e  oad cfg]` button
-00004f40: 2069 6e20 7468 6520 636f 6e74 726f 6c2d   in the control-
-00004f50: 7061 6e65 6c20 2869 6620 6c6f 6767 6564  panel (if logged
-00004f60: 2069 6e20 6173 2061 646d 696e 290a 2020   in as admin).  
-00004f70: 2a20 6368 616e 6765 7320 746f 2074 6865  * changes to the
-00004f80: 2060 5b67 6c6f 6261 6c5d 6020 636f 6e66   `[global]` conf
-00004f90: 6967 2073 6563 7469 6f6e 2072 6571 7569  ig section requi
-00004fa0: 7265 7320 6120 7265 7374 6172 7420 746f  res a restart to
-00004fb0: 2074 616b 6520 6566 6665 6374 0a0a 6120   take effect..a 
-00004fc0: 7175 6963 6b20 7375 6d6d 6172 7920 6361  quick summary ca
-00004fd0: 6e20 6265 2073 6565 6e20 7573 696e 6720  n be seen using 
-00004fe0: 602d 2d68 656c 702d 6163 636f 756e 7473  `--help-accounts
-00004ff0: 600a 0a63 6f6e 6669 6775 7269 6e67 2061  `..configuring a
-00005000: 6363 6f75 6e74 732f 766f 6c75 6d65 7320  ccounts/volumes 
-00005010: 7769 7468 2061 7267 756d 656e 7473 3a0a  with arguments:.
-00005020: 2a20 602d 6120 7573 723a 7077 6460 2061  * `-a usr:pwd` a
-00005030: 6464 7320 6163 636f 756e 7420 6075 7372  dds account `usr
-00005040: 6020 7769 7468 2070 6173 7377 6f72 6420  ` with password 
-00005050: 6070 7764 600a 2a20 602d 7620 2e3a 3a72  `pwd`.* `-v .::r
-00005060: 6020 6164 6473 2063 7572 7265 6e74 2d66  ` adds current-f
-00005070: 6f6c 6465 7220 602e 6020 6173 2074 6865  older `.` as the
-00005080: 2077 6562 726f 6f74 2c20 6072 6065 6164   webroot, `r`ead
-00005090: 6162 6c65 2062 7920 616e 796f 6e65 0a20  able by anyone. 
-000050a0: 202a 2074 6865 2073 796e 7461 7820 6973   * the syntax is
-000050b0: 2060 2d76 2073 7263 3a64 7374 3a70 6572   `-v src:dst:per
-000050c0: 6d3a 7065 726d 3a2e 2e2e 6020 736f 206c  m:perm:...` so l
-000050d0: 6f63 616c 2d70 6174 682c 2075 726c 2d70  ocal-path, url-p
-000050e0: 6174 682c 2061 6e64 206f 6e65 206f 7220  ath, and one or 
-000050f0: 6d6f 7265 2070 6572 6d69 7373 696f 6e73  more permissions
-00005100: 2074 6f20 7365 740a 2020 2a20 6772 616e   to set.  * gran
-00005110: 7469 6e67 2074 6865 2073 616d 6520 7065  ting the same pe
-00005120: 726d 6973 7369 6f6e 7320 746f 206d 756c  rmissions to mul
-00005130: 7469 706c 6520 6163 636f 756e 7473 3a20  tiple accounts: 
-00005140: 200a 2020 2020 602d 7620 2e3a 3a72 2c75   .    `-v .::r,u
-00005150: 7372 312c 7573 7232 3a72 772c 7573 7233  sr1,usr2:rw,usr3
-00005160: 2c75 7372 3460 203d 2075 7372 312f 3220  ,usr4` = usr1/2 
-00005170: 7265 6164 2d6f 6e6c 792c 2033 2f34 2072  read-only, 3/4 r
-00005180: 6561 642d 7772 6974 650a 0a70 6572 6d69  ead-write..permi
-00005190: 7373 696f 6e73 3a0a 2a20 6072 6020 2872  ssions:.* `r` (r
-000051a0: 6561 6429 3a20 6272 6f77 7365 2066 6f6c  ead): browse fol
-000051b0: 6465 7220 636f 6e74 656e 7473 2c20 646f  der contents, do
-000051c0: 776e 6c6f 6164 2066 696c 6573 2c20 646f  wnload files, do
-000051d0: 776e 6c6f 6164 2061 7320 7a69 702f 7461  wnload as zip/ta
-000051e0: 720a 2a20 6077 6020 2877 7269 7465 293a  r.* `w` (write):
-000051f0: 2075 706c 6f61 6420 6669 6c65 732c 206d   upload files, m
-00005200: 6f76 6520 6669 6c65 7320 2a69 6e74 6f2a  ove files *into*
-00005210: 2074 6869 7320 666f 6c64 6572 0a2a 2060   this folder.* `
-00005220: 6d60 2028 6d6f 7665 293a 206d 6f76 6520  m` (move): move 
-00005230: 6669 6c65 732f 666f 6c64 6572 7320 2a66  files/folders *f
-00005240: 726f 6d2a 2074 6869 7320 666f 6c64 6572  rom* this folder
-00005250: 0a2a 2060 6460 2028 6465 6c65 7465 293a  .* `d` (delete):
-00005260: 2064 656c 6574 6520 6669 6c65 732f 666f   delete files/fo
-00005270: 6c64 6572 730a 2a20 6067 6020 2867 6574  lders.* `g` (get
-00005280: 293a 206f 6e6c 7920 646f 776e 6c6f 6164  ): only download
-00005290: 2066 696c 6573 2c20 6361 6e6e 6f74 2073   files, cannot s
-000052a0: 6565 2066 6f6c 6465 7220 636f 6e74 656e  ee folder conten
-000052b0: 7473 206f 7220 7a69 702f 7461 720a 2a20  ts or zip/tar.* 
-000052c0: 6047 6020 2875 7067 6574 293a 2073 616d  `G` (upget): sam
-000052d0: 6520 6173 2060 6760 2065 7863 6570 7420  e as `g` except 
-000052e0: 7570 6c6f 6164 6572 7320 6765 7420 746f  uploaders get to
-000052f0: 2073 6565 2074 6865 6972 206f 776e 2066   see their own f
-00005300: 696c 656b 6579 7320 2873 6565 2060 666b  ilekeys (see `fk
-00005310: 6020 696e 2065 7861 6d70 6c65 7320 6265  ` in examples be
-00005320: 6c6f 7729 0a0a 6578 616d 706c 6573 3a0a  low)..examples:.
-00005330: 2a20 6164 6420 6163 636f 756e 7473 206e  * add accounts n
-00005340: 616d 6564 2075 312c 2075 322c 2075 3320  amed u1, u2, u3 
-00005350: 7769 7468 2070 6173 7377 6f72 6473 2070  with passwords p
-00005360: 312c 2070 322c 2070 333a 2060 2d61 2075  1, p2, p3: `-a u
-00005370: 313a 7031 202d 6120 7532 3a70 3220 2d61  1:p1 -a u2:p2 -a
-00005380: 2075 333a 7033 600a 2a20 6d61 6b65 2066   u3:p3`.* make f
-00005390: 6f6c 6465 7220 602f 7372 7660 2074 6865  older `/srv` the
-000053a0: 2072 6f6f 7420 6f66 2074 6865 2066 696c   root of the fil
-000053b0: 6573 7973 7465 6d2c 2072 6561 642d 6f6e  esystem, read-on
-000053c0: 6c79 2062 7920 616e 796f 6e65 3a20 602d  ly by anyone: `-
-000053d0: 7620 2f73 7276 3a3a 7260 0a2a 206d 616b  v /srv::r`.* mak
-000053e0: 6520 666f 6c64 6572 2060 2f6d 6e74 2f6d  e folder `/mnt/m
-000053f0: 7573 6963 6020 6176 6169 6c61 626c 6520  usic` available 
-00005400: 6174 2060 2f6d 7573 6963 602c 2072 6561  at `/music`, rea
-00005410: 642d 6f6e 6c79 2066 6f72 2075 3120 616e  d-only for u1 an
-00005420: 6420 7532 2c20 7265 6164 2d77 7269 7465  d u2, read-write
-00005430: 2066 6f72 2075 333a 2060 2d76 202f 6d6e   for u3: `-v /mn
-00005440: 742f 6d75 7369 633a 6d75 7369 633a 722c  t/music:music:r,
-00005450: 7531 2c75 323a 7277 2c75 3360 0a20 202a  u1,u2:rw,u3`.  *
-00005460: 2075 6e61 7574 686f 7269 7a65 6420 7573   unauthorized us
-00005470: 6572 7320 6163 6365 7373 696e 6720 7468  ers accessing th
-00005480: 6520 7765 6272 6f6f 7420 6361 6e20 7365  e webroot can se
-00005490: 6520 7468 6174 2074 6865 2060 6d75 7369  e that the `musi
-000054a0: 6360 2066 6f6c 6465 7220 6578 6973 7473  c` folder exists
-000054b0: 2c20 6275 7420 6361 6e6e 6f74 206f 7065  , but cannot ope
-000054c0: 6e20 6974 0a2a 206d 616b 6520 666f 6c64  n it.* make fold
-000054d0: 6572 2060 2f6d 6e74 2f69 6e63 6f6d 696e  er `/mnt/incomin
-000054e0: 6760 2061 7661 696c 6162 6c65 2061 7420  g` available at 
-000054f0: 602f 696e 6360 2c20 7772 6974 652d 6f6e  `/inc`, write-on
-00005500: 6c79 2066 6f72 2075 312c 2072 6561 642d  ly for u1, read-
-00005510: 6d6f 7665 2066 6f72 2075 323a 2060 2d76  move for u2: `-v
-00005520: 202f 6d6e 742f 696e 636f 6d69 6e67 3a69   /mnt/incoming:i
-00005530: 6e63 3a77 2c75 313a 726d 2c75 3260 0a20  nc:w,u1:rm,u2`. 
-00005540: 202a 2075 6e61 7574 686f 7269 7a65 6420   * unauthorized 
-00005550: 7573 6572 7320 6163 6365 7373 696e 6720  users accessing 
-00005560: 7468 6520 7765 6272 6f6f 7420 6361 6e20  the webroot can 
-00005570: 7365 6520 7468 6174 2074 6865 2060 696e  see that the `in
-00005580: 6360 2066 6f6c 6465 7220 6578 6973 7473  c` folder exists
-00005590: 2c20 6275 7420 6361 6e6e 6f74 206f 7065  , but cannot ope
-000055a0: 6e20 6974 0a20 202a 2060 7531 6020 6361  n it.  * `u1` ca
-000055b0: 6e20 6f70 656e 2074 6865 2060 696e 6360  n open the `inc`
-000055c0: 2066 6f6c 6465 722c 2062 7574 2063 616e   folder, but can
-000055d0: 6e6f 7420 7365 6520 7468 6520 636f 6e74  not see the cont
-000055e0: 656e 7473 2c20 6f6e 6c79 2075 706c 6f61  ents, only uploa
-000055f0: 6420 6e65 7720 6669 6c65 7320 746f 2069  d new files to i
-00005600: 740a 2020 2a20 6075 3260 2063 616e 2062  t.  * `u2` can b
-00005610: 726f 7773 6520 6974 2061 6e64 206d 6f76  rowse it and mov
-00005620: 6520 6669 6c65 7320 2a66 726f 6d2a 2060  e files *from* `
-00005630: 2f69 6e63 6020 696e 746f 2061 6e79 2066  /inc` into any f
-00005640: 6f6c 6465 7220 7768 6572 6520 6075 3260  older where `u2`
-00005650: 2068 6173 2077 7269 7465 2d61 6363 6573   has write-acces
-00005660: 730a 2a20 6d61 6b65 2066 6f6c 6465 7220  s.* make folder 
-00005670: 602f 6d6e 742f 7373 6020 6176 6169 6c61  `/mnt/ss` availa
-00005680: 626c 6520 6174 2060 2f69 602c 2072 6561  ble at `/i`, rea
-00005690: 642d 7772 6974 6520 666f 7220 7531 2c20  d-write for u1, 
-000056a0: 6765 742d 6f6e 6c79 2066 6f72 2065 7665  get-only for eve
-000056b0: 7279 6f6e 6520 656c 7365 2c20 616e 6420  ryone else, and 
-000056c0: 656e 6162 6c65 2066 696c 656b 6579 733a  enable filekeys:
-000056d0: 2060 2d76 202f 6d6e 742f 7373 3a69 3a72   `-v /mnt/ss:i:r
-000056e0: 772c 7531 3a67 3a63 2c66 6b3d 3460 0a20  w,u1:g:c,fk=4`. 
-000056f0: 202a 2060 632c 666b 3d34 6020 7365 7473   * `c,fk=4` sets
-00005700: 2074 6865 2060 666b 6020 2866 696c 656b   the `fk` (filek
-00005710: 6579 2920 766f 6c66 6c61 6720 746f 2034  ey) volflag to 4
-00005720: 2c20 6d65 616e 696e 6720 6561 6368 2066  , meaning each f
-00005730: 696c 6520 6765 7473 2061 2034 2d63 6861  ile gets a 4-cha
-00005740: 7261 6374 6572 2061 6363 6573 736b 6579  racter accesskey
-00005750: 0a20 202a 2060 7531 6020 6361 6e20 7570  .  * `u1` can up
-00005760: 6c6f 6164 2066 696c 6573 2c20 6272 6f77  load files, brow
-00005770: 7365 2074 6865 2066 6f6c 6465 722c 2061  se the folder, a
-00005780: 6e64 2073 6565 2074 6865 2067 656e 6572  nd see the gener
-00005790: 6174 6564 2066 696c 656b 6579 730a 2020  ated filekeys.  
-000057a0: 2a20 6f74 6865 7220 7573 6572 7320 6361  * other users ca
-000057b0: 6e6e 6f74 2062 726f 7773 6520 7468 6520  nnot browse the 
-000057c0: 666f 6c64 6572 2c20 6275 7420 6361 6e20  folder, but can 
-000057d0: 6163 6365 7373 2074 6865 2066 696c 6573  access the files
-000057e0: 2069 6620 7468 6579 2068 6176 6520 7468   if they have th
-000057f0: 6520 6675 6c6c 2066 696c 6520 5552 4c20  e full file URL 
-00005800: 7769 7468 2074 6865 2066 696c 656b 6579  with the filekey
-00005810: 0a20 202a 2072 6570 6c61 6369 6e67 2074  .  * replacing t
-00005820: 6865 2060 6760 2070 6572 6d69 7373 696f  he `g` permissio
-00005830: 6e20 7769 7468 2060 7767 6020 776f 756c  n with `wg` woul
-00005840: 6420 6c65 7420 616e 6f6e 796d 6f75 7320  d let anonymous 
-00005850: 7573 6572 7320 7570 6c6f 6164 2066 696c  users upload fil
-00005860: 6573 2c20 6275 7420 6e6f 7420 7365 6520  es, but not see 
-00005870: 7468 6520 7265 7175 6972 6564 2066 696c  the required fil
-00005880: 656b 6579 2074 6f20 6163 6365 7373 2069  ekey to access i
-00005890: 740a 2020 2a20 7265 706c 6163 696e 6720  t.  * replacing 
-000058a0: 7468 6520 6067 6020 7065 726d 6973 7369  the `g` permissi
-000058b0: 6f6e 2077 6974 6820 6077 4760 2077 6f75  on with `wG` wou
-000058c0: 6c64 206c 6574 2061 6e6f 6e79 6d6f 7573  ld let anonymous
-000058d0: 2075 7365 7273 2075 706c 6f61 6420 6669   users upload fi
-000058e0: 6c65 732c 2072 6563 6569 7669 6e67 2061  les, receiving a
-000058f0: 2077 6f72 6b69 6e67 2064 6972 6563 7420   working direct 
-00005900: 6c69 6e6b 2069 6e20 7265 7475 726e 0a0a  link in return..
-00005910: 616e 796f 6e65 2074 7279 696e 6720 746f  anyone trying to
-00005920: 2062 7275 7465 666f 7263 6520 6120 7061   bruteforce a pa
-00005930: 7373 776f 7264 2067 6574 7320 6261 6e6e  ssword gets bann
-00005940: 6564 2061 6363 6f72 6469 6e67 2074 6f20  ed according to 
-00005950: 602d 2d62 616e 2d70 7760 3b20 6465 6661  `--ban-pw`; defa
-00005960: 756c 7420 6973 2032 3468 2062 616e 2066  ult is 24h ban f
-00005970: 6f72 2039 2066 6169 6c65 6420 6174 7465  or 9 failed atte
-00005980: 6d70 7473 2069 6e20 3120 686f 7572 0a0a  mpts in 1 hour..
-00005990: 0a23 2320 7368 6164 6f77 696e 670a 0a68  .## shadowing..h
-000059a0: 6964 696e 6720 7370 6563 6966 6963 2073  iding specific s
-000059b0: 7562 666f 6c64 6572 7320 2062 7920 6d6f  ubfolders  by mo
-000059c0: 756e 7469 6e67 2061 6e6f 7468 6572 2076  unting another v
-000059d0: 6f6c 756d 6520 6f6e 2074 6f70 206f 6620  olume on top of 
-000059e0: 7468 656d 0a0a 666f 7220 6578 616d 706c  them..for exampl
-000059f0: 6520 602d 7620 2f6d 6e74 3a3a 7220 2d76  e `-v /mnt::r -v
-00005a00: 202f 7661 722f 656d 7074 793a 7765 622f   /var/empty:web/
-00005a10: 6365 7274 733a 7260 206d 6f75 6e74 7320  certs:r` mounts 
-00005a20: 7468 6520 7365 7276 6572 2066 6f6c 6465  the server folde
-00005a30: 7220 602f 6d6e 7460 2061 7320 7468 6520  r `/mnt` as the 
-00005a40: 7765 6272 6f6f 742c 2062 7574 2061 6e6f  webroot, but ano
-00005a50: 7468 6572 2076 6f6c 756d 6520 6973 206d  ther volume is m
-00005a60: 6f75 6e74 6564 2061 7420 602f 7765 622f  ounted at `/web/
-00005a70: 6365 7274 7360 202d 2d20 736f 2076 6973  certs` -- so vis
-00005a80: 6974 6f72 7320 6361 6e20 6f6e 6c79 2073  itors can only s
-00005a90: 6565 2074 6865 2063 6f6e 7465 6e74 7320  ee the contents 
-00005aa0: 6f66 2060 2f6d 6e74 6020 616e 6420 602f  of `/mnt` and `/
-00005ab0: 6d6e 742f 7765 6260 2028 6174 2055 524c  mnt/web` (at URL
-00005ac0: 7320 602f 6020 616e 6420 602f 7765 6260  s `/` and `/web`
-00005ad0: 292c 2062 7574 206e 6f74 2060 2f6d 6e74  ), but not `/mnt
-00005ae0: 2f77 6562 2f63 6572 7473 6020 6265 6361  /web/certs` beca
-00005af0: 7573 6520 5552 4c20 602f 7765 622f 6365  use URL `/web/ce
-00005b00: 7274 7360 2069 7320 6d61 7070 6564 2074  rts` is mapped t
-00005b10: 6f20 602f 7661 722f 656d 7074 7960 0a0a  o `/var/empty`..
-00005b20: 0a23 2074 6865 2062 726f 7773 6572 0a0a  .# the browser..
-00005b30: 6163 6365 7373 696e 6720 6120 636f 7079  accessing a copy
-00005b40: 7061 7274 7920 7365 7276 6572 2075 7369  party server usi
-00005b50: 6e67 2061 2077 6562 2d62 726f 7773 6572  ng a web-browser
-00005b60: 0a0a 215b 636f 7079 7061 7274 792d 6272  ..![copyparty-br
-00005b70: 6f77 7365 722d 6673 385d 2868 7474 7073  owser-fs8](https
-00005b80: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-00005b90: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-00005ba0: 2e63 6f6d 2f32 3431 3033 322f 3139 3230  .com/241032/1920
-00005bb0: 3432 3639 352d 3532 3262 3365 6337 2d36  42695-522b3ec7-6
-00005bc0: 3834 352d 3439 3461 2d61 6264 622d 6431  845-494a-abdb-d1
-00005bd0: 6330 6430 6532 3338 3031 2e70 6e67 290a  c0d0e23801.png).
-00005be0: 0a0a 2323 2074 6162 730a 0a74 6865 206d  ..## tabs..the m
-00005bf0: 6169 6e20 7461 6273 2069 6e20 7468 6520  ain tabs in the 
-00005c00: 7569 0a2a 2060 5bf0 9f94 8e5d 6020 5b73  ui.* `[....]` [s
-00005c10: 6561 7263 685d 2823 7365 6172 6368 696e  earch](#searchin
-00005c20: 6729 2062 7920 7369 7a65 2c20 6461 7465  g) by size, date
-00005c30: 2c20 7061 7468 2f6e 616d 652c 206d 7033  , path/name, mp3
-00005c40: 2d74 6167 7320 2e2e 2e0a 2a20 605b f09f  -tags ....* `[..
-00005c50: a7af 5d60 205b 756e 706f 7374 5d28 2375  ..]` [unpost](#u
-00005c60: 6e70 6f73 7429 3a20 756e 646f 2f64 656c  npost): undo/del
-00005c70: 6574 6520 6163 6369 6465 6e74 616c 2075  ete accidental u
-00005c80: 706c 6f61 6473 0a2a 2060 5bf0 9f9a 805d  ploads.* `[....]
-00005c90: 6020 616e 6420 605b f09f 8e88 5d60 2061  ` and `[....]` a
-00005ca0: 7265 2074 6865 205b 7570 6c6f 6164 6572  re the [uploader
-00005cb0: 735d 2823 7570 6c6f 6164 696e 6729 0a2a  s](#uploading).*
-00005cc0: 2060 5bf0 9f93 825d 6020 6d6b 6469 723a   `[....]` mkdir:
-00005cd0: 2063 7265 6174 6520 6469 7265 6374 6f72   create director
-00005ce0: 6965 730a 2a20 605b f09f 939d 5d60 206e  ies.* `[....]` n
-00005cf0: 6577 2d6d 643a 2063 7265 6174 6520 6120  ew-md: create a 
-00005d00: 6e65 7720 6d61 726b 646f 776e 2064 6f63  new markdown doc
-00005d10: 756d 656e 740a 2a20 605b f09f 939f 5d60  ument.* `[....]`
-00005d20: 2073 656e 642d 6d73 673a 2065 6974 6865   send-msg: eithe
-00005d30: 7220 746f 2073 6572 7665 722d 6c6f 6720  r to server-log 
-00005d40: 6f72 2069 6e74 6f20 7465 7874 6669 6c65  or into textfile
-00005d50: 7320 6966 2060 2d2d 7572 6c66 6f72 6d20  s if `--urlform 
-00005d60: 7361 7665 600a 2a20 605b f09f 8eba 5d60  save`.* `[....]`
-00005d70: 2061 7564 696f 2d70 6c61 7965 7220 636f   audio-player co
-00005d80: 6e66 6967 206f 7074 696f 6e73 0a2a 2060  nfig options.* `
-00005d90: 5be2 9a99 efb8 8f5d 6020 6765 6e65 7261  [......]` genera
-00005da0: 6c20 636c 6965 6e74 2063 6f6e 6669 6720  l client config 
-00005db0: 6f70 7469 6f6e 730a 0a0a 2323 2068 6f74  options...## hot
-00005dc0: 6b65 7973 0a0a 7468 6520 6272 6f77 7365  keys..the browse
-00005dd0: 7220 6861 7320 7468 6520 666f 6c6c 6f77  r has the follow
-00005de0: 696e 6720 686f 746b 6579 7320 2028 616c  ing hotkeys  (al
-00005df0: 7761 7973 2071 7765 7274 7929 0a2a 2060  ways qwerty).* `
-00005e00: 3f60 2073 686f 7720 686f 746b 6579 7320  ?` show hotkeys 
-00005e10: 6865 6c70 0a2a 2060 4260 2074 6f67 676c  help.* `B` toggl
-00005e20: 6520 6272 6561 6463 7275 6d62 7320 2f20  e breadcrumbs / 
-00005e30: 5b6e 6176 7061 6e65 5d28 236e 6176 7061  [navpane](#navpa
-00005e40: 6e65 290a 2a20 6049 2f4b 6020 7072 6576  ne).* `I/K` prev
-00005e50: 2f6e 6578 7420 666f 6c64 6572 0a2a 2060  /next folder.* `
-00005e60: 4d60 2070 6172 656e 7420 666f 6c64 6572  M` parent folder
-00005e70: 2028 6f72 2075 6e65 7870 616e 6420 6375   (or unexpand cu
-00005e80: 7272 656e 7429 0a2a 2060 5660 2074 6f67  rrent).* `V` tog
-00005e90: 676c 6520 666f 6c64 6572 7320 2f20 7465  gle folders / te
-00005ea0: 7874 6669 6c65 7320 696e 2074 6865 206e  xtfiles in the n
-00005eb0: 6176 7061 6e65 0a2a 2060 4760 2074 6f67  avpane.* `G` tog
-00005ec0: 676c 6520 6c69 7374 202f 205b 6772 6964  gle list / [grid
-00005ed0: 2076 6965 775d 2823 7468 756d 626e 6169   view](#thumbnai
-00005ee0: 6c73 2920 2d2d 2073 616d 6520 6173 2060  ls) -- same as `
-00005ef0: e794 b060 2062 6f74 746f 6d2d 7269 6768  ...` bottom-righ
-00005f00: 740a 2a20 6054 6020 746f 6767 6c65 2074  t.* `T` toggle t
-00005f10: 6875 6d62 6e61 696c 7320 2f20 6963 6f6e  humbnails / icon
-00005f20: 730a 2a20 6045 5343 6020 636c 6f73 6520  s.* `ESC` close 
-00005f30: 7661 7269 6f75 7320 7468 696e 6773 0a2a  various things.*
-00005f40: 2060 6374 726c 2d4b 6020 6465 6c65 7465   `ctrl-K` delete
-00005f50: 2073 656c 6563 7465 6420 6669 6c65 732f   selected files/
-00005f60: 666f 6c64 6572 730a 2a20 6063 7472 6c2d  folders.* `ctrl-
-00005f70: 5860 2063 7574 2073 656c 6563 7465 6420  X` cut selected 
-00005f80: 6669 6c65 732f 666f 6c64 6572 730a 2a20  files/folders.* 
-00005f90: 6063 7472 6c2d 5660 2070 6173 7465 0a2a  `ctrl-V` paste.*
-00005fa0: 2060 5960 2064 6f77 6e6c 6f61 6420 7365   `Y` download se
-00005fb0: 6c65 6374 6564 2066 696c 6573 0a2a 2060  lected files.* `
-00005fc0: 4632 6020 5b72 656e 616d 655d 2823 6261  F2` [rename](#ba
-00005fd0: 7463 682d 7265 6e61 6d65 2920 7365 6c65  tch-rename) sele
-00005fe0: 6374 6564 2066 696c 652f 666f 6c64 6572  cted file/folder
-00005ff0: 0a2a 2077 6865 6e20 6120 6669 6c65 2f66  .* when a file/f
-00006000: 6f6c 6465 7220 6973 2073 656c 6563 7465  older is selecte
-00006010: 6420 2869 6e20 6e6f 742d 6772 6964 2d76  d (in not-grid-v
-00006020: 6965 7729 3a0a 2020 2a20 6055 702f 446f  iew):.  * `Up/Do
-00006030: 776e 6020 6d6f 7665 2063 7572 736f 720a  wn` move cursor.
-00006040: 2020 2a20 7368 6966 742b 6055 702f 446f    * shift+`Up/Do
-00006050: 776e 6020 7365 6c65 6374 2061 6e64 206d  wn` select and m
-00006060: 6f76 6520 6375 7273 6f72 0a20 202a 2063  ove cursor.  * c
-00006070: 7472 6c2b 6055 702f 446f 776e 6020 6d6f  trl+`Up/Down` mo
-00006080: 7665 2063 7572 736f 7220 616e 6420 7363  ve cursor and sc
-00006090: 726f 6c6c 2076 6965 7770 6f72 740a 2020  roll viewport.  
-000060a0: 2a20 6053 7061 6365 6020 746f 6767 6c65  * `Space` toggle
-000060b0: 2066 696c 6520 7365 6c65 6374 696f 6e0a   file selection.
-000060c0: 2020 2a20 6043 7472 6c2d 4160 2074 6f67    * `Ctrl-A` tog
-000060d0: 676c 6520 7365 6c65 6374 2061 6c6c 0a2a  gle select all.*
-000060e0: 2077 6865 6e20 6120 7465 7874 6669 6c65   when a textfile
-000060f0: 2069 7320 6f70 656e 3a0a 2020 2a20 6049   is open:.  * `I
-00006100: 2f4b 6020 7072 6576 2f6e 6578 7420 7465  /K` prev/next te
-00006110: 7874 6669 6c65 0a20 202a 2060 5360 2074  xtfile.  * `S` t
-00006120: 6f67 676c 6520 7365 6c65 6374 696f 6e20  oggle selection 
-00006130: 6f66 206f 7065 6e20 6669 6c65 0a20 202a  of open file.  *
-00006140: 2060 4d60 2063 6c6f 7365 2074 6578 7466   `M` close textf
-00006150: 696c 650a 2a20 7768 656e 2070 6c61 7969  ile.* when playi
-00006160: 6e67 2061 7564 696f 3a0a 2020 2a20 604a  ng audio:.  * `J
-00006170: 2f4c 6020 7072 6576 2f6e 6578 7420 736f  /L` prev/next so
-00006180: 6e67 0a20 202a 2060 552f 4f60 2073 6b69  ng.  * `U/O` ski
-00006190: 7020 3130 7365 6320 6261 636b 2f66 6f72  p 10sec back/for
-000061a0: 7761 7264 0a20 202a 2060 302e 2e39 6020  ward.  * `0..9` 
-000061b0: 6a75 6d70 2074 6f20 3025 2e2e 3930 250a  jump to 0%..90%.
-000061c0: 2020 2a20 6050 6020 706c 6179 2f70 6175    * `P` play/pau
-000061d0: 7365 2028 616c 736f 2073 7461 7274 7320  se (also starts 
-000061e0: 706c 6179 696e 6720 7468 6520 666f 6c64  playing the fold
-000061f0: 6572 290a 2020 2a20 6059 6020 646f 776e  er).  * `Y` down
-00006200: 6c6f 6164 2066 696c 650a 2a20 7768 656e  load file.* when
-00006210: 2076 6965 7769 6e67 2069 6d61 6765 7320   viewing images 
-00006220: 2f20 706c 6179 696e 6720 7669 6465 6f73  / playing videos
-00006230: 3a0a 2020 2a20 604a 2f4c 2c20 4c65 6674  :.  * `J/L, Left
-00006240: 2f52 6967 6874 6020 7072 6576 2f6e 6578  /Right` prev/nex
-00006250: 7420 6669 6c65 0a20 202a 2060 486f 6d65  t file.  * `Home
-00006260: 2f45 6e64 6020 6669 7273 742f 6c61 7374  /End` first/last
-00006270: 2066 696c 650a 2020 2a20 6046 6020 746f   file.  * `F` to
-00006280: 6767 6c65 2066 756c 6c73 6372 6565 6e0a  ggle fullscreen.
-00006290: 2020 2a20 6053 6020 746f 6767 6c65 2073    * `S` toggle s
-000062a0: 656c 6563 7469 6f6e 0a20 202a 2060 5260  election.  * `R`
-000062b0: 2072 6f74 6174 6520 636c 6f63 6b77 6973   rotate clockwis
-000062c0: 6520 2873 6869 6674 3d63 6377 290a 2020  e (shift=ccw).  
-000062d0: 2a20 6059 6020 646f 776e 6c6f 6164 2066  * `Y` download f
-000062e0: 696c 650a 2020 2a20 6045 7363 6020 636c  ile.  * `Esc` cl
-000062f0: 6f73 6520 7669 6577 6572 0a20 202a 2076  ose viewer.  * v
-00006300: 6964 656f 733a 0a20 2020 202a 2060 552f  ideos:.    * `U/
-00006310: 4f60 2073 6b69 7020 3130 7365 6320 6261  O` skip 10sec ba
-00006320: 636b 2f66 6f72 7761 7264 0a20 2020 202a  ck/forward.    *
-00006330: 2060 302e 2e39 6020 6a75 6d70 2074 6f20   `0..9` jump to 
-00006340: 3025 2e2e 3930 250a 2020 2020 2a20 6050  0%..90%.    * `P
-00006350: 2f4b 2f53 7061 6365 6020 706c 6179 2f70  /K/Space` play/p
-00006360: 6175 7365 0a20 2020 202a 2060 4d60 206d  ause.    * `M` m
-00006370: 7574 650a 2020 2020 2a20 6043 6020 636f  ute.    * `C` co
-00006380: 6e74 696e 7565 2070 6c61 7969 6e67 206e  ntinue playing n
-00006390: 6578 7420 7669 6465 6f0a 2020 2020 2a20  ext video.    * 
-000063a0: 6056 6020 6c6f 6f70 2065 6e74 6972 6520  `V` loop entire 
-000063b0: 6669 6c65 0a20 2020 202a 2060 5b60 206c  file.    * `[` l
-000063c0: 6f6f 7020 7261 6e67 6520 2873 7461 7274  oop range (start
-000063d0: 290a 2020 2020 2a20 605d 6020 6c6f 6f70  ).    * `]` loop
-000063e0: 2072 616e 6765 2028 656e 6429 0a2a 2077   range (end).* w
-000063f0: 6865 6e20 7468 6520 6e61 7670 616e 6520  hen the navpane 
-00006400: 6973 206f 7065 6e3a 0a20 202a 2060 412f  is open:.  * `A/
-00006410: 4460 2061 646a 7573 7420 7472 6565 2077  D` adjust tree w
-00006420: 6964 7468 0a2a 2069 6e20 7468 6520 5b67  idth.* in the [g
-00006430: 7269 6420 7669 6577 5d28 2374 6875 6d62  rid view](#thumb
-00006440: 6e61 696c 7329 3a0a 2020 2a20 6053 6020  nails):.  * `S` 
-00006450: 746f 6767 6c65 206d 756c 7469 7365 6c65  toggle multisele
-00006460: 6374 0a20 202a 2073 6869 6674 2b60 412f  ct.  * shift+`A/
-00006470: 4460 207a 6f6f 6d0a 2a20 696e 2074 6865  D` zoom.* in the
-00006480: 206d 6172 6b64 6f77 6e20 6564 6974 6f72   markdown editor
-00006490: 3a0a 2020 2a20 605e 7360 2073 6176 650a  :.  * `^s` save.
-000064a0: 2020 2a20 605e 6860 2068 6561 6465 720a    * `^h` header.
-000064b0: 2020 2a20 605e 6b60 2061 7574 6f66 6f72    * `^k` autofor
-000064c0: 6d61 7420 7461 626c 650a 2020 2a20 605e  mat table.  * `^
-000064d0: 7560 206a 756d 7020 746f 206e 6578 7420  u` jump to next 
-000064e0: 756e 6963 6f64 6520 6368 6172 6163 7465  unicode characte
-000064f0: 720a 2020 2a20 605e 6560 2074 6f67 676c  r.  * `^e` toggl
-00006500: 6520 6564 6974 6f72 202f 2070 7265 7669  e editor / previ
-00006510: 6577 0a20 202a 2060 5e75 702c 205e 646f  ew.  * `^up, ^do
-00006520: 776e 6020 6a75 6d70 2070 6172 6167 7261  wn` jump paragra
-00006530: 7068 730a 0a0a 2323 206e 6176 7061 6e65  phs...## navpane
-00006540: 0a0a 7377 6974 6368 696e 6720 6265 7477  ..switching betw
-00006550: 6565 6e20 6272 6561 6463 7275 6d62 7320  een breadcrumbs 
-00006560: 6f72 206e 6176 7061 6e65 0a0a 636c 6963  or navpane..clic
-00006570: 6b20 7468 6520 60f0 9f8c b260 206f 7220  k the `....` or 
-00006580: 7072 6573 7369 6e67 2074 6865 2060 4260  pressing the `B`
-00006590: 2068 6f74 6b65 7920 746f 2074 6f67 676c   hotkey to toggl
-000065a0: 6520 6265 7477 6565 6e20 6272 6561 6463  e between breadc
-000065b0: 7275 6d62 7320 7061 7468 2028 6465 6661  rumbs path (defa
-000065c0: 756c 7429 2c20 6f72 2061 206e 6176 7061  ult), or a navpa
-000065d0: 6e65 2028 7472 6565 2d62 726f 7773 6572  ne (tree-browser
-000065e0: 2073 6964 6562 6172 2074 6869 6e67 290a   sidebar thing).
-000065f0: 0a2a 2060 5b2b 5d60 2061 6e64 2060 5b2d  .* `[+]` and `[-
-00006600: 5d60 2028 6f72 2068 6f74 6b65 7973 2060  ]` (or hotkeys `
-00006610: 4160 2f60 4460 2920 6164 6a75 7374 2074  A`/`D`) adjust t
-00006620: 6865 2073 697a 650a 2a20 605b f09f 8eaf  he size.* `[....
-00006630: 5d60 206a 756d 7073 2074 6f20 7468 6520  ]` jumps to the 
-00006640: 6375 7272 656e 746c 7920 6f70 656e 2066  currently open f
-00006650: 6f6c 6465 720a 2a20 605b f09f 9383 5d60  older.* `[....]`
-00006660: 2074 6f67 676c 6573 2062 6574 7765 656e   toggles between
-00006670: 2073 686f 7769 6e67 2066 6f6c 6465 7273   showing folders
-00006680: 2061 6e64 2074 6578 7466 696c 6573 0a2a   and textfiles.*
-00006690: 2060 5bf0 9f93 8c5d 6020 7368 6f77 7320   `[....]` shows 
-000066a0: 7468 6520 6e61 6d65 206f 6620 616c 6c20  the name of all 
-000066b0: 7061 7265 6e74 2066 6f6c 6465 7273 2069  parent folders i
-000066c0: 6e20 6120 646f 636b 6564 2070 616e 656c  n a docked panel
-000066d0: 0a2a 2060 5b61 5d60 2074 6f67 676c 6573  .* `[a]` toggles
-000066e0: 2061 7574 6f6d 6174 6963 2077 6964 656e   automatic widen
-000066f0: 696e 6720 6173 2079 6f75 2067 6f20 6465  ing as you go de
-00006700: 6570 6572 0a2a 2060 5be2 86b5 5d60 2074  eper.* `[...]` t
-00006710: 6f67 676c 6573 2077 6f72 6477 7261 700a  oggles wordwrap.
-00006720: 2a20 605b f09f 9180 5d60 2073 686f 7720  * `[....]` show 
-00006730: 6675 6c6c 206e 616d 6520 6f6e 2068 6f76  full name on hov
-00006740: 6572 2028 6966 2077 6f72 6477 7261 7020  er (if wordwrap 
-00006750: 6973 206f 6666 290a 0a0a 2323 2074 6875  is off)...## thu
-00006760: 6d62 6e61 696c 730a 0a70 7265 7373 2060  mbnails..press `
-00006770: 6760 206f 7220 60e7 94b0 6020 746f 2074  g` or `...` to t
-00006780: 6f67 676c 6520 6772 6964 2d76 6965 7720  oggle grid-view 
-00006790: 696e 7374 6561 6420 6f66 2074 6865 2066  instead of the f
-000067a0: 696c 6520 6c69 7374 696e 6720 2061 6e64  ile listing  and
-000067b0: 2060 7460 2074 6f67 676c 6573 2069 636f   `t` toggles ico
-000067c0: 6e73 202f 2074 6875 6d62 6e61 696c 730a  ns / thumbnails.
-000067d0: 0a21 5b63 6f70 7970 6172 7479 2d74 6875  .![copyparty-thu
-000067e0: 6d62 732d 6673 385d 2868 7474 7073 3a2f  mbs-fs8](https:/
-000067f0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-00006800: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-00006810: 6f6d 2f32 3431 3033 322f 3132 3936 3336  om/241032/129636
-00006820: 3231 312d 6162 6432 3066 6132 2d61 3935  211-abd20fa2-a95
-00006830: 332d 3433 3636 2d39 3432 332d 3163 3838  3-4366-9423-1c88
-00006840: 6562 6239 3662 6139 2e70 6e67 290a 0a69  ebb96ba9.png)..i
-00006850: 7420 646f 6573 2073 7461 7469 6320 696d  t does static im
-00006860: 6167 6573 2077 6974 6820 5069 6c6c 6f77  ages with Pillow
-00006870: 202f 2070 7976 6970 7320 2f20 4646 6d70   / pyvips / FFmp
-00006880: 6567 2c20 616e 6420 7573 6573 2046 466d  eg, and uses FFm
-00006890: 7065 6720 666f 7220 7669 6465 6f20 6669  peg for video fi
-000068a0: 6c65 732c 2073 6f20 796f 7520 6d61 7920  les, so you may 
-000068b0: 7761 6e74 2074 6f20 602d 2d6e 6f2d 7468  want to `--no-th
-000068c0: 756d 6260 206f 7220 6d61 7962 6520 6a75  umb` or maybe ju
-000068d0: 7374 2060 2d2d 6e6f 2d76 7468 756d 6260  st `--no-vthumb`
-000068e0: 2064 6570 656e 6469 6e67 206f 6e20 686f   depending on ho
-000068f0: 7720 6461 6e67 6572 6f75 7320 796f 7572  w dangerous your
-00006900: 2075 7365 7273 2061 7265 0a2a 2070 7976   users are.* pyv
-00006910: 6970 7320 6973 2033 7820 6661 7374 6572  ips is 3x faster
-00006920: 2074 6861 6e20 5069 6c6c 6f77 2c20 5069   than Pillow, Pi
-00006930: 6c6c 6f77 2069 7320 3378 2066 6173 7465  llow is 3x faste
-00006940: 7220 7468 616e 2046 466d 7065 670a 2a20  r than FFmpeg.* 
-00006950: 6469 7361 626c 6520 7468 756d 626e 6169  disable thumbnai
-00006960: 6c73 2066 6f72 2073 7065 6369 6669 6320  ls for specific 
-00006970: 766f 6c75 6d65 7320 7769 7468 2076 6f6c  volumes with vol
-00006980: 666c 6167 2060 6474 6875 6d62 6020 666f  flag `dthumb` fo
-00006990: 7220 616c 6c2c 206f 7220 6064 7674 6875  r all, or `dvthu
-000069a0: 6d62 6020 2f20 6064 6174 6875 6d62 6020  mb` / `dathumb` 
-000069b0: 2f20 6064 6974 6875 6d62 6020 666f 7220  / `dithumb` for 
-000069c0: 7669 6465 6f2f 6175 6469 6f2f 696d 6167  video/audio/imag
-000069d0: 6573 206f 6e6c 790a 0a61 7564 696f 2066  es only..audio f
-000069e0: 696c 6573 2061 7265 2063 6f76 6e65 7274  iles are covnert
-000069f0: 6564 2069 6e74 6f20 7370 6563 7472 6f67  ed into spectrog
-00006a00: 7261 6d73 2075 7369 6e67 2046 466d 7065  rams using FFmpe
-00006a10: 6720 756e 6c65 7373 2079 6f75 2060 2d2d  g unless you `--
-00006a20: 6e6f 2d61 7468 756d 6260 2028 616e 6420  no-athumb` (and 
-00006a30: 736f 6d65 2046 466d 7065 6720 6275 696c  some FFmpeg buil
-00006a40: 6473 206d 6179 206e 6565 6420 602d 2d74  ds may need `--t
-00006a50: 682d 6666 2d73 7772 6029 0a0a 696d 6167  h-ff-swr`)..imag
-00006a60: 6573 2077 6974 6820 7468 6520 666f 6c6c  es with the foll
-00006a70: 6f77 696e 6720 6e61 6d65 7320 2873 6565  owing names (see
-00006a80: 2060 2d2d 7468 2d63 6f76 6572 7360 2920   `--th-covers`) 
-00006a90: 6265 636f 6d65 2074 6865 2074 6875 6d62  become the thumb
-00006aa0: 6e61 696c 206f 6620 7468 6520 666f 6c64  nail of the fold
-00006ab0: 6572 2074 6865 7927 7265 2069 6e3a 2060  er they're in: `
-00006ac0: 666f 6c64 6572 2e70 6e67 602c 2060 666f  folder.png`, `fo
-00006ad0: 6c64 6572 2e6a 7067 602c 2060 636f 7665  lder.jpg`, `cove
-00006ae0: 722e 706e 6760 2c20 6063 6f76 6572 2e6a  r.png`, `cover.j
-00006af0: 7067 600a 0a69 6e20 7468 6520 6772 6964  pg`..in the grid
-00006b00: 2f74 6875 6d62 6e61 696c 2076 6965 772c  /thumbnail view,
-00006b10: 2069 6620 7468 6520 6175 6469 6f20 706c   if the audio pl
-00006b20: 6179 6572 2070 616e 656c 2069 7320 6f70  ayer panel is op
-00006b30: 656e 2c20 736f 6e67 7320 7769 6c6c 2073  en, songs will s
-00006b40: 7461 7274 2070 6c61 7969 6e67 2077 6865  tart playing whe
-00006b50: 6e20 636c 6963 6b65 640a 2a20 696e 6469  n clicked.* indi
-00006b60: 6361 7465 6420 6279 2074 6865 2061 7564  cated by the aud
-00006b70: 696f 2066 696c 6573 2068 6176 696e 6720  io files having 
-00006b80: 7468 6520 e296 b620 6963 6f6e 2069 6e73  the ... icon ins
-00006b90: 7465 6164 206f 6620 f09f 92be 0a0a 0a23  tead of .......#
-00006ba0: 2320 7a69 7020 646f 776e 6c6f 6164 730a  # zip downloads.
-00006bb0: 0a64 6f77 6e6c 6f61 6420 666f 6c64 6572  .download folder
-00006bc0: 7320 286f 7220 6669 6c65 2073 656c 6563  s (or file selec
-00006bd0: 7469 6f6e 7329 2061 7320 607a 6970 6020  tions) as `zip` 
-00006be0: 6f72 2060 7461 7260 2066 696c 6573 0a0a  or `tar` files..
-00006bf0: 7365 6c65 6374 2077 6869 6368 2074 7970  select which typ
-00006c00: 6520 6f66 2061 7263 6869 7665 2079 6f75  e of archive you
-00006c10: 2077 616e 7420 696e 2074 6865 2060 5be2   want in the `[.
-00006c20: 9a99 efb8 8f5d 2063 6f6e 6669 6760 2074  .....] config` t
-00006c30: 6162 3a0a 0a7c 206e 616d 6520 7c20 7572  ab:..| name | ur
-00006c40: 6c2d 7375 6666 6978 207c 2064 6573 6372  l-suffix | descr
-00006c50: 6970 7469 6f6e 207c 0a7c 2d2d 7c2d 2d7c  iption |.|--|--|
-00006c60: 2d2d 7c0a 7c20 6074 6172 6020 7c20 603f  --|.| `tar` | `?
-00006c70: 7461 7260 207c 2070 6c61 696e 2067 6e75  tar` | plain gnu
-00006c80: 7461 722c 2077 6f72 6b73 2067 7265 6174  tar, works great
-00006c90: 2077 6974 6820 6063 7572 6c20 5c7c 2074   with `curl \| t
-00006ca0: 6172 202d 7876 6020 7c0a 7c20 607a 6970  ar -xv` |.| `zip
-00006cb0: 6020 7c20 603f 7a69 703d 7574 6638 6020  ` | `?zip=utf8` 
-00006cc0: 7c20 776f 726b 7320 6576 6572 7977 6865  | works everywhe
-00006cd0: 7265 2c20 676c 6974 6368 7920 6669 6c65  re, glitchy file
-00006ce0: 6e61 6d65 7320 6f6e 2077 696e 3720 616e  names on win7 an
-00006cf0: 6420 6f6c 6465 7220 7c0a 7c20 607a 6970  d older |.| `zip
-00006d00: 5f64 6f73 6020 7c20 603f 7a69 7060 207c  _dos` | `?zip` |
-00006d10: 2074 7261 6469 7469 6f6e 616c 2063 7034   traditional cp4
-00006d20: 3337 2028 6e6f 2075 6e69 636f 6465 2920  37 (no unicode) 
-00006d30: 746f 2066 6978 2067 6c69 7463 6879 2066  to fix glitchy f
-00006d40: 696c 656e 616d 6573 207c 0a7c 2060 7a69  ilenames |.| `zi
-00006d50: 705f 6372 6360 207c 2060 3f7a 6970 3d63  p_crc` | `?zip=c
-00006d60: 7263 6020 7c20 6370 3433 3720 7769 7468  rc` | cp437 with
-00006d70: 2063 7263 3332 2063 6f6d 7075 7465 6420   crc32 computed 
-00006d80: 6561 726c 7920 666f 7220 7472 756c 7920  early for truly 
-00006d90: 616e 6369 656e 7420 736f 6674 7761 7265  ancient software
-00006da0: 207c 0a0a 2a20 6869 6464 656e 2066 696c   |..* hidden fil
-00006db0: 6573 2028 646f 7466 696c 6573 2920 6172  es (dotfiles) ar
-00006dc0: 6520 6578 636c 7564 6564 2075 6e6c 6573  e excluded unles
-00006dd0: 7320 602d 6564 600a 2020 2a20 6075 7032  s `-ed`.  * `up2
-00006de0: 6b2e 6462 6020 616e 6420 6064 6972 2e74  k.db` and `dir.t
-00006df0: 7874 6020 6973 2061 6c77 6179 7320 6578  xt` is always ex
-00006e00: 636c 7564 6564 0a2a 2060 7a69 705f 6372  cluded.* `zip_cr
-00006e10: 6360 2077 696c 6c20 7461 6b65 206c 6f6e  c` will take lon
-00006e20: 6765 7220 746f 2064 6f77 6e6c 6f61 6420  ger to download 
-00006e30: 7369 6e63 6520 7468 6520 7365 7276 6572  since the server
-00006e40: 2068 6173 2074 6f20 7265 6164 2065 6163   has to read eac
-00006e50: 6820 6669 6c65 2074 7769 6365 0a20 202a  h file twice.  *
-00006e60: 2074 6869 7320 6973 206f 6e6c 7920 746f   this is only to
-00006e70: 2073 7570 706f 7274 204d 532d 444f 5320   support MS-DOS 
-00006e80: 504b 5a49 5020 7632 2e30 3467 2028 6f63  PKZIP v2.04g (oc
-00006e90: 746f 6265 7220 3139 3933 2920 616e 6420  tober 1993) and 
-00006ea0: 6f6c 6465 720a 2020 2020 2a20 686f 7720  older.    * how 
-00006eb0: 6172 6520 796f 7520 6163 6365 7373 696e  are you accessin
-00006ec0: 6720 636f 7079 7061 7274 7920 6163 7475  g copyparty actu
-00006ed0: 616c 6c79 0a0a 796f 7520 6361 6e20 616c  ally..you can al
-00006ee0: 736f 207a 6970 2061 2073 656c 6563 7469  so zip a selecti
-00006ef0: 6f6e 206f 6620 6669 6c65 7320 6f72 2066  on of files or f
-00006f00: 6f6c 6465 7273 2062 7920 636c 6963 6b69  olders by clicki
-00006f10: 6e67 2074 6865 6d20 696e 2074 6865 2062  ng them in the b
-00006f20: 726f 7773 6572 2c20 7468 6174 2062 7269  rowser, that bri
-00006f30: 6e67 7320 7570 2061 2073 656c 6563 7469  ngs up a selecti
-00006f40: 6f6e 2065 6469 746f 7220 616e 6420 7a69  on editor and zi
-00006f50: 7020 6275 7474 6f6e 2069 6e20 7468 6520  p button in the 
-00006f60: 626f 7474 6f6d 2072 6967 6874 0a0a 215b  bottom right..![
-00006f70: 636f 7079 7061 7274 792d 7a69 7073 656c  copyparty-zipsel
-00006f80: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
-00006f90: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-00006fa0: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-00006fb0: 3234 3130 3332 2f31 3239 3633 3533 3734  241032/129635374
-00006fc0: 2d65 3531 3336 6530 312d 3437 3061 2d34  -e5136e01-470a-4
-00006fd0: 3962 312d 6137 3632 2d38 3438 6538 6134  9b1-a762-848e8a4
-00006fe0: 6339 6364 632e 706e 6729 0a0a 0a23 2320  c9cdc.png)...## 
-00006ff0: 7570 6c6f 6164 696e 670a 0a64 7261 6720  uploading..drag 
-00007000: 6669 6c65 732f 666f 6c64 6572 7320 696e  files/folders in
-00007010: 746f 2074 6865 2077 6562 2d62 726f 7773  to the web-brows
-00007020: 6572 2074 6f20 7570 6c6f 6164 2020 286f  er to upload  (o
-00007030: 7220 7573 6520 7468 6520 5b63 6f6d 6d61  r use the [comma
-00007040: 6e64 2d6c 696e 6520 7570 6c6f 6164 6572  nd-line uploader
-00007050: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-00007060: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
-00007070: 7274 792f 7472 6565 2f68 6f76 7564 7374  rty/tree/hovudst
-00007080: 7261 756d 2f62 696e 2375 7032 6b70 7929  raum/bin#up2kpy)
-00007090: 290a 0a74 6869 7320 696e 6974 6961 7465  )..this initiate
-000070a0: 7320 616e 2075 706c 6f61 6420 7573 696e  s an upload usin
-000070b0: 6720 6075 7032 6b60 3b20 7468 6572 6520  g `up2k`; there 
-000070c0: 6172 6520 7477 6f20 7570 6c6f 6164 6572  are two uploader
-000070d0: 7320 6176 6169 6c61 626c 653a 0a2a 2060  s available:.* `
-000070e0: 5bf0 9f8e 885d 2062 7570 602c 2074 6865  [....] bup`, the
-000070f0: 2062 6173 6963 2075 706c 6f61 6465 722c   basic uploader,
-00007100: 2073 7570 706f 7274 7320 616c 6d6f 7374   supports almost
-00007110: 2065 7665 7279 2062 726f 7773 6572 2073   every browser s
-00007120: 696e 6365 206e 6574 7363 6170 6520 342e  ince netscape 4.
-00007130: 300a 2a20 605b f09f 9a80 5d20 7570 326b  0.* `[....] up2k
-00007140: 602c 2074 6865 2067 6f6f 6420 2f20 6661  `, the good / fa
-00007150: 6e63 7920 6f6e 650a 0a4e 423a 2079 6f75  ncy one..NB: you
-00007160: 2063 616e 2075 6e64 6f2f 6465 6c65 7465   can undo/delete
-00007170: 2079 6f75 7220 6f77 6e20 7570 6c6f 6164   your own upload
-00007180: 7320 7769 7468 2060 5bf0 9fa7 af5d 6020  s with `[....]` 
-00007190: 5b75 6e70 6f73 745d 2823 756e 706f 7374  [unpost](#unpost
-000071a0: 290a 0a75 7032 6b20 6861 7320 7365 7665  )..up2k has seve
-000071b0: 7261 6c20 6164 7661 6e74 6167 6573 3a0a  ral advantages:.
-000071c0: 2a20 796f 7520 6361 6e20 6472 6f70 2066  * you can drop f
-000071d0: 6f6c 6465 7273 2069 6e74 6f20 7468 6520  olders into the 
-000071e0: 6272 6f77 7365 7220 2866 696c 6573 2061  browser (files a
-000071f0: 7265 2061 6464 6564 2072 6563 7572 7369  re added recursi
-00007200: 7665 6c79 290a 2a20 6669 6c65 7320 6172  vely).* files ar
-00007210: 6520 7072 6f63 6573 7365 6420 696e 2063  e processed in c
-00007220: 6875 6e6b 732c 2061 6e64 2065 6163 6820  hunks, and each 
-00007230: 6368 756e 6b20 6973 2063 6865 636b 7375  chunk is checksu
-00007240: 6d6d 6564 0a20 202a 2075 706c 6f61 6473  mmed.  * uploads
-00007250: 2061 7574 6f72 6573 756d 6520 6966 2074   autoresume if t
-00007260: 6865 7920 6172 6520 696e 7465 7272 7570  hey are interrup
-00007270: 7465 6420 6279 206e 6574 776f 726b 2069  ted by network i
-00007280: 7373 7565 730a 2020 2a20 7570 6c6f 6164  ssues.  * upload
-00007290: 7320 7265 7375 6d65 2069 6620 796f 7520  s resume if you 
-000072a0: 7265 626f 6f74 2079 6f75 7220 6272 6f77  reboot your brow
-000072b0: 7365 7220 6f72 2070 632c 206a 7573 7420  ser or pc, just 
-000072c0: 7570 6c6f 6164 2074 6865 2073 616d 6520  upload the same 
-000072d0: 6669 6c65 7320 6167 6169 6e0a 2020 2a20  files again.  * 
-000072e0: 7365 7276 6572 2064 6574 6563 7473 2061  server detects a
-000072f0: 6e79 2063 6f72 7275 7074 696f 6e3b 2074  ny corruption; t
-00007300: 6865 2063 6c69 656e 7420 7265 7570 6c6f  he client reuplo
-00007310: 6164 7320 6166 6665 6374 6564 2063 6875  ads affected chu
-00007320: 6e6b 730a 2020 2a20 7468 6520 636c 6965  nks.  * the clie
-00007330: 6e74 2064 6f65 736e 2774 2075 706c 6f61  nt doesn't uploa
-00007340: 6420 616e 7974 6869 6e67 2074 6861 7420  d anything that 
-00007350: 616c 7265 6164 7920 6578 6973 7473 206f  already exists o
-00007360: 6e20 7468 6520 7365 7276 6572 0a2a 206d  n the server.* m
-00007370: 7563 6820 6869 6768 6572 2073 7065 6564  uch higher speed
-00007380: 7320 7468 616e 2066 7470 2f73 6370 2f74  s than ftp/scp/t
-00007390: 6172 7069 7065 206f 6e20 736f 6d65 2069  arpipe on some i
-000073a0: 6e74 6572 6e65 7420 636f 6e6e 6563 7469  nternet connecti
-000073b0: 6f6e 7320 286d 6169 6e6c 7920 616d 6572  ons (mainly amer
-000073c0: 6963 616e 206f 6e65 7329 2074 6861 6e6b  ican ones) thank
-000073d0: 7320 746f 2070 6172 616c 6c65 6c20 636f  s to parallel co
-000073e0: 6e6e 6563 7469 6f6e 730a 2a20 7468 6520  nnections.* the 
-000073f0: 6c61 7374 2d6d 6f64 6966 6965 6420 7469  last-modified ti
-00007400: 6d65 7374 616d 7020 6f66 2074 6865 2066  mestamp of the f
-00007410: 696c 6520 6973 2070 7265 7365 7276 6564  ile is preserved
-00007420: 0a0a 3e20 6974 2069 7320 7065 7266 6563  ..> it is perfec
-00007430: 746c 7920 7361 6665 2074 6f20 7265 7374  tly safe to rest
-00007440: 6172 7420 2f20 7570 6772 6164 6520 636f  art / upgrade co
-00007450: 7079 7061 7274 7920 7768 696c 6520 736f  pyparty while so
-00007460: 6d65 6f6e 6520 6973 2075 706c 6f61 6469  meone is uploadi
-00007470: 6e67 2074 6f20 6974 2120 200a 3e20 616c  ng to it!  .> al
-00007480: 6c20 6b6e 6f77 6e20 7570 326b 2063 6c69  l known up2k cli
-00007490: 656e 7473 2077 696c 6c20 7265 7375 6d65  ents will resume
-000074a0: 206a 7573 7420 6669 6e65 20f0 9f92 aa0a   just fine .....
-000074b0: 0a73 6565 205b 7570 326b 5d28 2375 7032  .see [up2k](#up2
-000074c0: 6b29 2066 6f72 2064 6574 6169 6c73 206f  k) for details o
-000074d0: 6e20 686f 7720 6974 2077 6f72 6b73 2c20  n how it works, 
-000074e0: 6f72 2077 6174 6368 2061 205b 6465 6d6f  or watch a [demo
-000074f0: 2076 6964 656f 5d28 6874 7470 733a 2f2f   video](https://
-00007500: 612e 6f63 762e 6d65 2f70 7562 2f64 656d  a.ocv.me/pub/dem
-00007510: 6f2f 7069 6373 2d76 6964 732f 2367 662d  o/pics-vids/#gf-
-00007520: 3066 3666 3563 3064 290a 0a21 5b63 6f70  0f6f5c0d)..![cop
-00007530: 7970 6172 7479 2d75 706c 6f61 642d 6673  yparty-upload-fs
-00007540: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
-00007550: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00007560: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-00007570: 3033 322f 3132 3936 3335 3337 312d 3438  032/129635371-48
-00007580: 6663 3534 6361 2d66 6139 312d 3438 6533  fc54ca-fa91-48e3
-00007590: 2d39 6231 642d 6261 3431 3365 3462 3638  -9b1d-ba413e4b68
-000075a0: 6362 2e70 6e67 290a 0a2a 2a70 726f 7469  cb.png)..**proti
-000075b0: 703a 2a2a 2079 6f75 2063 616e 2061 766f  p:** you can avo
-000075c0: 6964 2073 6361 7269 6e67 2061 7761 7920  id scaring away 
-000075d0: 7573 6572 7320 7769 7468 205b 636f 6e74  users with [cont
-000075e0: 7269 622f 706c 7567 696e 732f 6d69 6e69  rib/plugins/mini
-000075f0: 6d61 6c2d 7570 326b 2e6a 735d 2863 6f6e  mal-up2k.js](con
-00007600: 7472 6962 2f70 6c75 6769 6e73 2f6d 696e  trib/plugins/min
-00007610: 696d 616c 2d75 7032 6b2e 6a73 2920 7768  imal-up2k.js) wh
-00007620: 6963 6820 6d61 6b65 7320 6974 206c 6f6f  ich makes it loo
-00007630: 6b20 5b6d 7563 6820 7369 6d70 6c65 725d  k [much simpler]
-00007640: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
-00007650: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-00007660: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-00007670: 322f 3131 3833 3131 3139 352d 6464 3663  2/118311195-dd6c
-00007680: 6133 3830 2d62 3465 662d 3131 6562 2d38  a380-b4ef-11eb-8
-00007690: 3666 332d 3735 6133 6666 3265 3133 3332  6f3-75a3ff2e1332
-000076a0: 2e70 6e67 290a 0a2a 2a70 726f 7469 703a  .png)..**protip:
-000076b0: 2a2a 2069 6620 796f 7520 656e 6162 6c65  ** if you enable
-000076c0: 2060 6661 7669 636f 6e60 2069 6e20 7468   `favicon` in th
-000076d0: 6520 605b e29a 99ef b88f 5d20 7365 7474  e `[......] sett
-000076e0: 696e 6773 6020 7461 6220 2862 7920 7479  ings` tab (by ty
-000076f0: 7069 6e67 2073 6f6d 6574 6869 6e67 2069  ping something i
-00007700: 6e74 6f20 7468 6520 7465 7874 626f 7829  nto the textbox)
-00007710: 2c20 7468 6520 6963 6f6e 2069 6e20 7468  , the icon in th
-00007720: 6520 6272 6f77 7365 7220 7461 6220 7769  e browser tab wi
-00007730: 6c6c 2069 6e64 6963 6174 6520 7570 6c6f  ll indicate uplo
-00007740: 6164 2070 726f 6772 6573 7320 2d2d 2061  ad progress -- a
-00007750: 6c73 6f2c 2074 6865 2060 5bf0 9f94 945d  lso, the `[....]
-00007760: 6020 616e 642f 6f72 2060 5bf0 9f94 8a5d  ` and/or `[....]
-00007770: 6020 7377 6974 6368 6573 2065 6e61 626c  ` switches enabl
-00007780: 6520 7669 7369 626c 6520 616e 642f 6f72  e visible and/or
-00007790: 2061 7564 6962 6c65 206e 6f74 6966 6963   audible notific
-000077a0: 6174 696f 6e73 206f 6e20 7570 6c6f 6164  ations on upload
-000077b0: 2063 6f6d 706c 6574 696f 6e0a 0a74 6865   completion..the
-000077c0: 2075 7032 6b20 5549 2069 7320 7468 6520   up2k UI is the 
-000077d0: 6570 6974 6f6d 6520 6f66 2070 6f6c 6973  epitome of polis
-000077e0: 6865 6420 696e 7574 6974 6976 6520 6578  hed inutitive ex
-000077f0: 7065 7269 656e 6365 733a 0a2a 2022 7061  periences:.* "pa
-00007800: 7261 6c6c 656c 2075 706c 6f61 6473 2220  rallel uploads" 
-00007810: 7370 6563 6966 6965 7320 686f 7720 6d61  specifies how ma
-00007820: 6e79 2063 6875 6e6b 7320 746f 2075 706c  ny chunks to upl
-00007830: 6f61 6420 6174 2074 6865 2073 616d 6520  oad at the same 
-00007840: 7469 6d65 0a2a 2060 5bf0 9f8f 835d 6020  time.* `[....]` 
-00007850: 616e 616c 7973 6973 206f 6620 6f74 6865  analysis of othe
-00007860: 7220 6669 6c65 7320 7368 6f75 6c64 2063  r files should c
-00007870: 6f6e 7469 6e75 6520 7768 696c 6520 6f6e  ontinue while on
-00007880: 6520 6973 2075 706c 6f61 6469 6e67 0a2a  e is uploading.*
-00007890: 2060 5bf0 9fa5 945d 6020 7368 6f77 7320   `[....]` shows 
-000078a0: 6120 7369 6d70 6c65 7220 5549 2066 6f72  a simpler UI for
-000078b0: 2066 6173 7465 7220 7570 6c6f 6164 7320   faster uploads 
-000078c0: 6672 6f6d 2073 6c6f 7720 6465 7669 6365  from slow device
-000078d0: 730a 2a20 605b f09f 92ad 5d60 2061 736b  s.* `[....]` ask
-000078e0: 2066 6f72 2063 6f6e 6669 726d 6174 696f   for confirmatio
-000078f0: 6e20 6265 666f 7265 2066 696c 6573 2061  n before files a
-00007900: 7265 2061 6464 6564 2074 6f20 7468 6520  re added to the 
-00007910: 7175 6575 650a 2a20 605b f09f 948e 5d60  queue.* `[....]`
-00007920: 2073 7769 7463 6820 6265 7477 6565 6e20   switch between 
-00007930: 7570 6c6f 6164 2061 6e64 205b 6669 6c65  upload and [file
-00007940: 2d73 6561 7263 685d 2823 6669 6c65 2d73  -search](#file-s
-00007950: 6561 7263 6829 206d 6f64 650a 2020 2a20  earch) mode.  * 
-00007960: 6967 6e6f 7265 2060 5bf0 9f94 8e5d 6020  ignore `[....]` 
-00007970: 6966 2079 6f75 2061 6464 2066 696c 6573  if you add files
-00007980: 2062 7920 6472 6167 6769 6e67 2074 6865   by dragging the
-00007990: 6d20 696e 746f 2074 6865 2062 726f 7773  m into the brows
-000079a0: 6572 0a0a 616e 6420 7468 656e 2074 6865  er..and then the
-000079b0: 7265 7320 7468 6520 7461 6273 2062 656c  res the tabs bel
-000079c0: 6f77 2069 742c 0a2a 2060 5b6f 6b5d 6020  ow it,.* `[ok]` 
-000079d0: 6973 2074 6865 2066 696c 6573 2077 6869  is the files whi
-000079e0: 6368 2063 6f6d 706c 6574 6564 2073 7563  ch completed suc
-000079f0: 6365 7373 6675 6c6c 790a 2a20 605b 6e67  cessfully.* `[ng
-00007a00: 5d60 2069 7320 7468 6520 6f6e 6573 2074  ]` is the ones t
-00007a10: 6861 7420 6661 696c 6564 202f 2067 6f74  hat failed / got
-00007a20: 2072 656a 6563 7465 6420 2861 6c72 6561   rejected (alrea
-00007a30: 6479 2065 7869 7374 732c 202e 2e2e 290a  dy exists, ...).
-00007a40: 2a20 605b 646f 6e65 5d60 2073 686f 7773  * `[done]` shows
-00007a50: 2061 2063 6f6d 6269 6e65 6420 6c69 7374   a combined list
-00007a60: 206f 6620 605b 6f6b 5d60 2061 6e64 2060   of `[ok]` and `
-00007a70: 5b6e 675d 602c 2063 6872 6f6e 6f6c 6f67  [ng]`, chronolog
-00007a80: 6963 616c 206f 7264 6572 0a2a 2060 5b62  ical order.* `[b
-00007a90: 7573 795d 6020 6669 6c65 7320 7768 6963  usy]` files whic
-00007aa0: 6820 6172 6520 6375 7272 656e 746c 7920  h are currently 
-00007ab0: 6861 7368 696e 672c 2070 656e 6469 6e67  hashing, pending
-00007ac0: 2d75 706c 6f61 642c 206f 7220 7570 6c6f  -upload, or uplo
-00007ad0: 6164 696e 670a 2020 2a20 706c 7573 2075  ading.  * plus u
-00007ae0: 7020 746f 2033 2065 6e74 7269 6573 2065  p to 3 entries e
-00007af0: 6163 6820 6672 6f6d 2060 5b64 6f6e 655d  ach from `[done]
-00007b00: 6020 616e 6420 605b 7175 655d 6020 666f  ` and `[que]` fo
-00007b10: 7220 636f 6e74 6578 740a 2a20 605b 7175  r context.* `[qu
-00007b20: 655d 6020 6973 2061 6c6c 2074 6865 2066  e]` is all the f
-00007b30: 696c 6573 2074 6861 7420 6172 6520 7374  iles that are st
-00007b40: 696c 6c20 7175 6575 6564 0a0a 6e6f 7465  ill queued..note
-00007b50: 2074 6861 7420 7369 6e63 6520 7570 326b   that since up2k
-00007b60: 2068 6173 2074 6f20 7265 6164 2065 6163   has to read eac
-00007b70: 6820 6669 6c65 2074 7769 6365 2c20 605b  h file twice, `[
-00007b80: f09f 8e88 5d20 6275 7060 2063 616e 202a  ....] bup` can *
-00007b90: 7468 656f 7265 7469 6361 6c6c 792a 2062  theoretically* b
-00007ba0: 6520 7570 2074 6f20 3278 2066 6173 7465  e up to 2x faste
-00007bb0: 7220 696e 2073 6f6d 6520 6578 7472 656d  r in some extrem
-00007bc0: 6520 6361 7365 7320 2866 696c 6573 2062  e cases (files b
-00007bd0: 6967 6765 7220 7468 616e 2079 6f75 7220  igger than your 
-00007be0: 7261 6d2c 2063 6f6d 6269 6e65 6420 7769  ram, combined wi
-00007bf0: 7468 2061 6e20 696e 7465 726e 6574 2063  th an internet c
-00007c00: 6f6e 6e65 6374 696f 6e20 6661 7374 6572  onnection faster
-00007c10: 2074 6861 6e20 7468 6520 7265 6164 2d73   than the read-s
-00007c20: 7065 6564 206f 6620 796f 7572 2048 4444  peed of your HDD
-00007c30: 2c20 6f72 2069 6620 796f 7527 7265 2075  , or if you're u
-00007c40: 706c 6f61 6469 6e67 2066 726f 6d20 6120  ploading from a 
-00007c50: 6375 6f32 6475 6f29 0a0a 6966 2079 6f75  cuo2duo)..if you
-00007c60: 2061 7265 2072 6573 756d 696e 6720 6120   are resuming a 
-00007c70: 6d61 7373 6976 6520 7570 6c6f 6164 2061  massive upload a
-00007c80: 6e64 2077 616e 7420 746f 2073 6b69 7020  nd want to skip 
-00007c90: 6861 7368 696e 6720 7468 6520 6669 6c65  hashing the file
-00007ca0: 7320 7768 6963 6820 616c 7265 6164 7920  s which already 
-00007cb0: 6669 6e69 7368 6564 2c20 796f 7520 6361  finished, you ca
-00007cc0: 6e20 656e 6162 6c65 2060 7475 7262 6f60  n enable `turbo`
-00007cd0: 2069 6e20 7468 6520 605b e29a 99ef b88f   in the `[......
-00007ce0: 5d20 636f 6e66 6967 6020 7461 622c 2062  ] config` tab, b
-00007cf0: 7574 2070 6c65 6173 6520 7265 6164 2074  ut please read t
-00007d00: 6865 2074 6f6f 6c74 6970 206f 6e20 7468  he tooltip on th
-00007d10: 6174 2062 7574 746f 6e0a 0a0a 2323 2320  at button...### 
-00007d20: 6669 6c65 2d73 6561 7263 680a 0a64 726f  file-search..dro
-00007d30: 7070 696e 6720 6669 6c65 7320 696e 746f  pping files into
-00007d40: 2074 6865 2062 726f 7773 6572 2061 6c73   the browser als
-00007d50: 6f20 6c65 7473 2079 6f75 2073 6565 2069  o lets you see i
-00007d60: 6620 7468 6579 2065 7869 7374 206f 6e20  f they exist on 
-00007d70: 7468 6520 7365 7276 6572 0a0a 215b 636f  the server..![co
-00007d80: 7079 7061 7274 792d 6673 6561 7263 682d  pyparty-fsearch-
-00007d90: 6673 385d 2868 7474 7073 3a2f 2f75 7365  fs8](https://use
-00007da0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00007db0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-00007dc0: 3431 3033 322f 3132 3936 3335 3336 312d  41032/129635361-
-00007dd0: 6337 3932 3836 6630 2d62 3866 312d 3434  c79286f0-b8f1-44
-00007de0: 3065 2d61 6166 342d 3665 3932 3934 3238  0e-aaf4-6e929428
-00007df0: 6661 6339 2e70 6e67 290a 0a77 6865 6e20  fac9.png)..when 
-00007e00: 796f 7520 6472 6167 2f64 726f 7020 6669  you drag/drop fi
-00007e10: 6c65 7320 696e 746f 2074 6865 2062 726f  les into the bro
-00007e20: 7773 6572 2c20 796f 7520 7769 6c6c 2073  wser, you will s
-00007e30: 6565 2074 776f 2064 726f 707a 6f6e 6573  ee two dropzones
-00007e40: 3a20 6055 706c 6f61 6460 2061 6e64 2060  : `Upload` and `
-00007e50: 5365 6172 6368 600a 0a3e 206f 6e20 6120  Search`..> on a 
-00007e60: 7068 6f6e 653f 2074 6f67 676c 6520 7468  phone? toggle th
-00007e70: 6520 605b f09f 948e 5d60 2073 7769 7463  e `[....]` switc
-00007e80: 6820 6772 6565 6e20 6265 666f 7265 2074  h green before t
-00007e90: 6170 7069 6e67 2074 6865 2062 6967 2079  apping the big y
-00007ea0: 656c 6c6f 7720 5365 6172 6368 2062 7574  ellow Search but
-00007eb0: 746f 6e20 746f 2073 656c 6563 7420 796f  ton to select yo
-00007ec0: 7572 2066 696c 6573 0a0a 7468 6520 6669  ur files..the fi
-00007ed0: 6c65 7320 7769 6c6c 2062 6520 6861 7368  les will be hash
-00007ee0: 6564 206f 6e20 7468 6520 636c 6965 6e74  ed on the client
-00007ef0: 2d73 6964 652c 2061 6e64 2065 6163 6820  -side, and each 
-00007f00: 6861 7368 2069 7320 7365 6e74 2074 6f20  hash is sent to 
-00007f10: 7468 6520 7365 7276 6572 2c20 7768 6963  the server, whic
-00007f20: 6820 6368 6563 6b73 2069 6620 7468 6174  h checks if that
-00007f30: 2066 696c 6520 6578 6973 7473 2073 6f6d   file exists som
-00007f40: 6577 6865 7265 0a0a 6669 6c65 7320 676f  ewhere..files go
-00007f50: 2069 6e74 6f20 605b 6f6b 5d60 2069 6620   into `[ok]` if 
-00007f60: 7468 6579 2065 7869 7374 2028 616e 6420  they exist (and 
-00007f70: 796f 7520 6765 7420 6120 6c69 6e6b 2074  you get a link t
-00007f80: 6f20 7768 6572 6520 6974 2069 7329 2c20  o where it is), 
-00007f90: 6f74 6865 7277 6973 6520 7468 6579 206c  otherwise they l
-00007fa0: 616e 6420 696e 2060 5b6e 675d 600a 2a20  and in `[ng]`.* 
-00007fb0: 7468 6520 6d61 696e 2072 6561 736f 6e20  the main reason 
-00007fc0: 6669 6c65 7365 6172 6368 2069 7320 636f  filesearch is co
-00007fd0: 6d62 696e 6564 2077 6974 6820 7468 6520  mbined with the 
-00007fe0: 7570 6c6f 6164 6572 2069 7320 6361 7573  uploader is caus
-00007ff0: 6520 7468 6520 636f 6465 2077 6173 2074  e the code was t
-00008000: 6f6f 2073 7061 6768 6574 7469 2074 6f20  oo spaghetti to 
-00008010: 7365 7061 7261 7465 2069 7420 6f75 7420  separate it out 
-00008020: 736f 6d65 7768 6572 6520 656c 7365 2c20  somewhere else, 
-00008030: 7468 6973 2069 7320 6e6f 206c 6f6e 6765  this is no longe
-00008040: 7220 7468 6520 6361 7365 2062 7574 206e  r the case but n
-00008050: 6f77 2069 2776 6520 7761 726d 6564 2075  ow i've warmed u
-00008060: 7020 746f 2074 6865 2069 6465 6120 746f  p to the idea to
-00008070: 6f20 6d75 6368 0a0a 0a23 2323 2075 6e70  o much...### unp
-00008080: 6f73 740a 0a75 6e64 6f2f 6465 6c65 7465  ost..undo/delete
-00008090: 2061 6363 6964 656e 7461 6c20 7570 6c6f   accidental uplo
-000080a0: 6164 730a 0a21 5b63 6f70 7970 6172 7479  ads..![copyparty
-000080b0: 2d75 6e70 6f73 742d 6673 385d 2868 7474  -unpost-fs8](htt
-000080c0: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-000080d0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-000080e0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3132  nt.com/241032/12
-000080f0: 3936 3335 3336 382d 3361 6661 3636 3334  9635368-3afa6634
-00008100: 2d63 3230 662d 3431 3863 2d39 3064 632d  -c20f-418c-90dc-
-00008110: 6563 3431 3166 3362 3338 3937 2e70 6e67  ec411f3b3897.png
-00008120: 290a 0a79 6f75 2063 616e 2075 6e70 6f73  )..you can unpos
-00008130: 7420 6576 656e 2069 6620 796f 7520 646f  t even if you do
-00008140: 6e27 7420 6861 7665 2072 6567 756c 6172  n't have regular
-00008150: 206d 6f76 652f 6465 6c65 7465 2061 6363   move/delete acc
-00008160: 6573 732c 2068 6f77 6576 6572 206f 6e6c  ess, however onl
-00008170: 7920 666f 7220 6669 6c65 7320 7570 6c6f  y for files uplo
-00008180: 6164 6564 2077 6974 6869 6e20 7468 6520  aded within the 
-00008190: 7061 7374 2060 2d2d 756e 706f 7374 6020  past `--unpost` 
-000081a0: 7365 636f 6e64 7320 2864 6566 6175 6c74  seconds (default
-000081b0: 2031 3220 686f 7572 7329 2061 6e64 2074   12 hours) and t
-000081c0: 6865 2073 6572 7665 7220 6d75 7374 2062  he server must b
-000081d0: 6520 7275 6e6e 696e 6720 7769 7468 2060  e running with `
-000081e0: 2d65 3264 600a 0a0a 2323 2320 7365 6c66  -e2d`...### self
-000081f0: 2d64 6573 7472 7563 740a 0a75 706c 6f61  -destruct..uploa
-00008200: 6473 2063 616e 2062 6520 6769 7665 6e20  ds can be given 
-00008210: 6120 6c69 6665 7469 6d65 2c20 2061 6665  a lifetime,  afe
-00008220: 7220 7768 6963 6820 7468 6579 2065 7870  r which they exp
-00008230: 6972 6520 2f20 7365 6c66 2d64 6573 7472  ire / self-destr
-00008240: 7563 740a 0a74 6865 2066 6561 7475 7265  uct..the feature
-00008250: 206d 7573 7420 6265 2065 6e61 626c 6564   must be enabled
-00008260: 2070 6572 2d76 6f6c 756d 6520 7769 7468   per-volume with
-00008270: 2074 6865 2060 6c69 6665 7469 6d65 6020   the `lifetime` 
-00008280: 5b75 706c 6f61 6420 7275 6c65 5d28 2375  [upload rule](#u
-00008290: 706c 6f61 642d 7275 6c65 7329 2077 6869  pload-rules) whi
-000082a0: 6368 2073 6574 7320 7468 6520 7570 7065  ch sets the uppe
-000082b0: 7220 6c69 6d69 7420 666f 7220 686f 7720  r limit for how 
-000082c0: 6c6f 6e67 2061 2066 696c 6520 6765 7473  long a file gets
-000082d0: 2074 6f20 7374 6179 206f 6e20 7468 6520   to stay on the 
-000082e0: 7365 7276 6572 0a0a 636c 6965 6e74 7320  server..clients 
-000082f0: 6361 6e20 7370 6563 6966 7920 6120 7368  can specify a sh
-00008300: 6f72 7465 7220 6578 7069 7261 7469 6f6e  orter expiration
-00008310: 2074 696d 6520 7573 696e 6720 7468 6520   time using the 
-00008320: 5b75 7032 6b20 7569 5d28 2375 706c 6f61  [up2k ui](#uploa
-00008330: 6469 6e67 2920 2d2d 2074 6865 2072 656c  ding) -- the rel
-00008340: 6576 616e 7420 6f70 7469 6f6e 7320 6265  evant options be
-00008350: 636f 6d65 2076 6973 6962 6c65 2075 706f  come visible upo
-00008360: 6e20 6e61 7669 6761 7469 6e67 2069 6e74  n navigating int
-00008370: 6f20 6120 666f 6c64 6572 2077 6974 6820  o a folder with 
-00008380: 606c 6966 6574 696d 6573 6020 656e 6162  `lifetimes` enab
-00008390: 6c65 6420 2d2d 206f 7220 6279 2075 7369  led -- or by usi
-000083a0: 6e67 2074 6865 2060 6c69 6665 6020 5b75  ng the `life` [u
-000083b0: 706c 6f61 6420 6d6f 6469 6669 6572 5d28  pload modifier](
-000083c0: 2377 7269 7465 290a 0a73 7065 6369 6679  #write)..specify
-000083d0: 696e 6720 6120 6375 7374 6f6d 2065 7870  ing a custom exp
-000083e0: 6972 6174 696f 6e20 7469 6d65 2063 6c69  iration time cli
-000083f0: 656e 742d 7369 6465 2077 696c 6c20 6166  ent-side will af
-00008400: 6665 6374 2074 6865 2074 696d 6573 7061  fect the timespa
-00008410: 6e20 696e 2077 6869 6368 2075 6e70 6f73  n in which unpos
-00008420: 7473 2061 7265 2070 6572 6d69 7474 6564  ts are permitted
-00008430: 2c20 736f 206b 6565 7020 616e 2065 7965  , so keep an eye
-00008440: 206f 6e20 7468 6520 6573 7469 6d61 7465   on the estimate
-00008450: 7320 696e 2074 6865 2075 7032 6b20 7569  s in the up2k ui
-00008460: 0a0a 0a23 2320 6669 6c65 206d 616e 6167  ...## file manag
-00008470: 6572 0a0a 6375 742f 7061 7374 652c 2072  er..cut/paste, r
-00008480: 656e 616d 652c 2061 6e64 2064 656c 6574  ename, and delet
-00008490: 6520 6669 6c65 732f 666f 6c64 6572 7320  e files/folders 
-000084a0: 2869 6620 796f 7520 6861 7665 2070 6572  (if you have per
-000084b0: 6d69 7373 696f 6e29 0a0a 6669 6c65 2073  mission)..file s
-000084c0: 656c 6563 7469 6f6e 3a20 636c 6963 6b20  election: click 
-000084d0: 736f 6d65 7768 6572 6520 6f6e 2074 6865  somewhere on the
-000084e0: 206c 696e 6520 286e 6f74 2074 6865 206c   line (not the l
-000084f0: 696e 6b20 6974 7365 6629 2c20 7468 656e  ink itsef), then
-00008500: 3a0a 2a20 6073 7061 6365 6020 746f 2074  :.* `space` to t
-00008510: 6f67 676c 650a 2a20 6075 702f 646f 776e  oggle.* `up/down
-00008520: 6020 746f 206d 6f76 650a 2a20 6073 6869  ` to move.* `shi
-00008530: 6674 2d75 702f 646f 776e 6020 746f 206d  ft-up/down` to m
-00008540: 6f76 652d 616e 642d 7365 6c65 6374 0a2a  ove-and-select.*
-00008550: 2060 6374 726c 2d73 6869 6674 2d75 702f   `ctrl-shift-up/
-00008560: 646f 776e 6020 746f 2061 6c73 6f20 7363  down` to also sc
-00008570: 726f 6c6c 0a0a 2a20 6375 743a 2073 656c  roll..* cut: sel
-00008580: 6563 7420 736f 6d65 2066 696c 6573 2061  ect some files a
-00008590: 6e64 2060 6374 726c 2d78 600a 2a20 7061  nd `ctrl-x`.* pa
-000085a0: 7374 653a 2060 6374 726c 2d76 6020 696e  ste: `ctrl-v` in
-000085b0: 2061 6e6f 7468 6572 2066 6f6c 6465 720a   another folder.
-000085c0: 2a20 7265 6e61 6d65 3a20 6046 3260 0a0a  * rename: `F2`..
-000085d0: 796f 7520 6361 6e20 6d6f 7665 2066 696c  you can move fil
-000085e0: 6573 2061 6372 6f73 7320 6272 6f77 7365  es across browse
-000085f0: 7220 7461 6273 2028 6375 7420 696e 206f  r tabs (cut in o
-00008600: 6e65 2074 6162 2c20 7061 7374 6520 696e  ne tab, paste in
-00008610: 2061 6e6f 7468 6572 290a 0a0a 2323 2062   another)...## b
-00008620: 6174 6368 2072 656e 616d 650a 0a73 656c  atch rename..sel
-00008630: 6563 7420 736f 6d65 2066 696c 6573 2061  ect some files a
-00008640: 6e64 2070 7265 7373 2060 4632 6020 746f  nd press `F2` to
-00008650: 2062 7269 6e67 2075 7020 7468 6520 7265   bring up the re
-00008660: 6e61 6d65 2055 490a 0a21 5b62 6174 6368  name UI..![batch
-00008670: 2d72 656e 616d 652d 6673 385d 2868 7474  -rename-fs8](htt
-00008680: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-00008690: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-000086a0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3132  nt.com/241032/12
-000086b0: 3834 3334 3230 342d 6562 3133 3636 3830  8434204-eb136680
-000086c0: 2d33 6330 372d 3465 6337 2d39 3265 302d  -3c07-4ec7-92e0-
-000086d0: 6165 3836 6166 3230 6332 3431 2e70 6e67  ae86af20c241.png
-000086e0: 290a 0a71 7569 636b 2065 7870 6c61 6e61  )..quick explana
-000086f0: 7469 6f6e 206f 6620 7468 6520 6275 7474  tion of the butt
-00008700: 6f6e 732c 2020 0a2a 2060 5be2 9c85 2061  ons,  .* `[... a
-00008710: 7070 6c79 2072 656e 616d 655d 6020 636f  pply rename]` co
-00008720: 6e66 6972 6d73 2061 6e64 2062 6567 696e  nfirms and begin
-00008730: 7320 7265 6e61 6d69 6e67 0a2a 2060 5be2  s renaming.* `[.
-00008740: 9d8c 2063 616e 6365 6c5d 6020 6162 6f72  .. cancel]` abor
-00008750: 7473 2061 6e64 2063 6c6f 7365 7320 7468  ts and closes th
-00008760: 6520 7265 6e61 6d65 2077 696e 646f 770a  e rename window.
-00008770: 2a20 605b e286 ba20 7265 7365 745d 6020  * `[... reset]` 
-00008780: 7265 7665 7274 7320 616e 7920 6669 6c65  reverts any file
-00008790: 6e61 6d65 2063 6861 6e67 6573 2062 6163  name changes bac
-000087a0: 6b20 746f 2074 6865 206f 7269 6769 6e61  k to the origina
-000087b0: 6c20 6e61 6d65 0a2a 2060 5b64 6563 6f64  l name.* `[decod
-000087c0: 655d 6020 646f 6573 2061 2055 524c 2d64  e]` does a URL-d
-000087d0: 6563 6f64 6520 6f6e 2074 6865 2066 696c  ecode on the fil
-000087e0: 656e 616d 652c 2066 6978 696e 6720 7374  ename, fixing st
-000087f0: 7566 6620 6c69 6b65 2060 2661 6d70 3b60  uff like `&amp;`
-00008800: 2061 6e64 2060 2532 3060 0a2a 2060 5b61   and `%20`.* `[a
-00008810: 6476 616e 6365 645d 6020 746f 6767 6c65  dvanced]` toggle
-00008820: 7320 6164 7661 6e63 6564 206d 6f64 650a  s advanced mode.
-00008830: 0a61 6476 616e 6365 6420 6d6f 6465 3a20  .advanced mode: 
-00008840: 7265 6e61 6d65 2066 696c 6573 2062 6173  rename files bas
-00008850: 6564 206f 6e20 7275 6c65 7320 746f 2064  ed on rules to d
-00008860: 6563 6964 6520 7468 6520 6e65 7720 6e61  ecide the new na
-00008870: 6d65 732c 2062 6173 6564 206f 6e20 7468  mes, based on th
-00008880: 6520 6f72 6967 696e 616c 206e 616d 6520  e original name 
-00008890: 2872 6567 6578 292c 206f 7220 6261 7365  (regex), or base
-000088a0: 6420 6f6e 2074 6865 2074 6167 7320 636f  d on the tags co
-000088b0: 6c6c 6563 7465 6420 6672 6f6d 2074 6865  llected from the
-000088c0: 2066 696c 6520 2861 7274 6973 742f 7469   file (artist/ti
-000088d0: 746c 652f 2e2e 2e29 2c20 6f72 2061 206d  tle/...), or a m
-000088e0: 6978 206f 6620 626f 7468 0a0a 696e 2061  ix of both..in a
-000088f0: 6476 616e 6365 6420 6d6f 6465 2c20 200a  dvanced mode,  .
-00008900: 2a20 605b 6361 7365 5d60 2074 6f67 676c  * `[case]` toggl
-00008910: 6573 2063 6173 652d 7365 6e73 6974 6976  es case-sensitiv
-00008920: 6520 7265 6765 780a 2a20 6072 6567 6578  e regex.* `regex
-00008930: 6020 6973 2074 6865 2072 6567 6578 2070  ` is the regex p
-00008940: 6174 7465 726e 2074 6f20 6170 706c 7920  attern to apply 
-00008950: 746f 2074 6865 206f 7269 6769 6e61 6c20  to the original 
-00008960: 6669 6c65 6e61 6d65 3b20 616e 7920 6669  filename; any fi
-00008970: 6c65 7320 7768 6963 6820 646f 6e27 7420  les which don't 
-00008980: 6d61 7463 6820 7769 6c6c 2062 6520 736b  match will be sk
-00008990: 6970 7065 640a 2a20 6066 6f72 6d61 7460  ipped.* `format`
-000089a0: 2069 7320 7468 6520 6e65 7720 6669 6c65   is the new file
-000089b0: 6e61 6d65 2c20 7461 6b69 6e67 2076 616c  name, taking val
-000089c0: 7565 7320 6672 6f6d 2072 6567 6578 2063  ues from regex c
-000089d0: 6170 7475 7269 6e67 2067 726f 7570 7320  apturing groups 
-000089e0: 616e 642f 6f72 2066 726f 6d20 6669 6c65  and/or from file
-000089f0: 2074 6167 730a 2020 2a20 7665 7279 206c   tags.  * very l
-00008a00: 6f6f 7365 6c79 2062 6173 6564 206f 6e20  oosely based on 
-00008a10: 666f 6f62 6172 3230 3030 2073 796e 7461  foobar2000 synta
-00008a20: 780a 2a20 6070 7265 7365 7473 6020 6c65  x.* `presets` le
-00008a30: 7473 2079 6f75 2073 6176 6520 7265 6e61  ts you save rena
-00008a40: 6d65 2072 756c 6573 2066 6f72 206c 6174  me rules for lat
-00008a50: 6572 0a0a 6176 6169 6c61 626c 6520 6675  er..available fu
-00008a60: 6e63 7469 6f6e 733a 0a2a 2060 246c 7061  nctions:.* `$lpa
-00008a70: 6428 7465 7874 2c20 6c65 6e67 7468 2c20  d(text, length, 
-00008a80: 7061 645f 6368 6172 2960 0a2a 2060 2472  pad_char)`.* `$r
-00008a90: 7061 6428 7465 7874 2c20 6c65 6e67 7468  pad(text, length
-00008aa0: 2c20 7061 645f 6368 6172 2960 0a0a 736f  , pad_char)`..so
-00008ab0: 2c0a 0a73 6179 2079 6f75 2068 6176 6520  ,..say you have 
-00008ac0: 6120 6669 6c65 206e 616d 6564 205b 606d  a file named [`m
-00008ad0: 6567 616e 656b 6f20 2d20 4563 6c69 7073  eganeko - Eclips
-00008ae0: 6520 2d20 3037 2053 6972 6975 7320 412e  e - 07 Sirius A.
-00008af0: 6d70 3360 5d28 6874 7470 733a 2f2f 7777  mp3`](https://ww
-00008b00: 772e 796f 7574 7562 652e 636f 6d2f 7761  w.youtube.com/wa
-00008b10: 7463 683f 763d 2d64 7462 3076 4450 7275  tch?v=-dtb0vDPru
-00008b20: 4929 2028 6162 736f 6c75 7465 6c79 2066  I) (absolutely f
-00008b30: 616e 7461 7374 6963 2061 6c62 756d 2062  antastic album b
-00008b40: 7477 2920 616e 6420 7468 6520 7461 6773  tw) and the tags
-00008b50: 2061 7265 3a20 6041 6c62 756d 3a45 636c   are: `Album:Ecl
-00008b60: 6970 7365 602c 2060 4172 7469 7374 3a6d  ipse`, `Artist:m
-00008b70: 6567 616e 656b 6f60 2c20 6054 6974 6c65  eganeko`, `Title
-00008b80: 3a53 6972 6975 7320 4160 2c20 6074 6e3a  :Sirius A`, `tn:
-00008b90: 3760 0a0a 796f 7520 636f 756c 6420 7573  7`..you could us
-00008ba0: 6520 6a75 7374 2072 6567 6578 2074 6f20  e just regex to 
-00008bb0: 7265 6e61 6d65 2069 743a 0a2a 2060 7265  rename it:.* `re
-00008bc0: 6765 7860 203d 2060 282e 2a29 202d 2028  gex` = `(.*) - (
-00008bd0: 2e2a 2920 2d20 285b 302d 395d 7b32 7d29  .*) - ([0-9]{2})
-00008be0: 2028 2e2a 2960 0a2a 2060 666f 726d 6174   (.*)`.* `format
-00008bf0: 6020 3d20 6028 3329 2e20 2831 2920 2d20  ` = `(3). (1) - 
-00008c00: 2834 2960 0a2a 2060 6f75 7470 7574 6020  (4)`.* `output` 
-00008c10: 3d20 6030 372e 206d 6567 616e 656b 6f20  = `07. meganeko 
-00008c20: 2d20 5369 7269 7573 2041 2e6d 7033 600a  - Sirius A.mp3`.
-00008c30: 0a6f 7220 796f 7520 636f 756c 6420 7573  .or you could us
-00008c40: 6520 6a75 7374 2074 6167 733a 0a2a 2060  e just tags:.* `
-00008c50: 666f 726d 6174 6020 3d20 6024 6c70 6164  format` = `$lpad
-00008c60: 2828 746e 292c 322c 3029 2e20 2861 7274  ((tn),2,0). (art
-00008c70: 6973 7429 202d 2028 7469 746c 6529 2e28  ist) - (title).(
-00008c80: 6578 7429 600a 2a20 606f 7574 7075 7460  ext)`.* `output`
-00008c90: 203d 2060 372e 206d 6567 616e 656b 6f20   = `7. meganeko 
-00008ca0: 2d20 5369 7269 7573 2041 2e6d 7033 600a  - Sirius A.mp3`.
-00008cb0: 0a6f 7220 6120 6d69 7820 6f66 2062 6f74  .or a mix of bot
-00008cc0: 683a 0a2a 2060 7265 6765 7860 203d 2060  h:.* `regex` = `
-00008cd0: 202d 2028 5b30 2d39 5d7b 327d 2920 600a   - ([0-9]{2}) `.
-00008ce0: 2a20 6066 6f72 6d61 7460 203d 2060 2831  * `format` = `(1
-00008cf0: 292e 2028 6172 7469 7374 2920 2d20 2874  ). (artist) - (t
-00008d00: 6974 6c65 292e 2865 7874 2960 0a2a 2060  itle).(ext)`.* `
-00008d10: 6f75 7470 7574 6020 3d20 6030 372e 206d  output` = `07. m
-00008d20: 6567 616e 656b 6f20 2d20 5369 7269 7573  eganeko - Sirius
-00008d30: 2041 2e6d 7033 600a 0a74 6865 206d 6574   A.mp3`..the met
-00008d40: 6164 6174 6120 6b65 7973 2079 6f75 2063  adata keys you c
-00008d50: 616e 2075 7365 2069 6e20 7468 6520 666f  an use in the fo
-00008d60: 726d 6174 2066 6965 6c64 2061 7265 2074  rmat field are t
-00008d70: 6865 206f 6e65 7320 696e 2074 6865 2066  he ones in the f
-00008d80: 696c 652d 6272 6f77 7365 7220 7461 626c  ile-browser tabl
-00008d90: 6520 6865 6164 6572 2028 7768 6174 6576  e header (whatev
-00008da0: 6572 2069 7320 636f 6c6c 6563 7465 6420  er is collected 
-00008db0: 7769 7468 2060 2d6d 7465 6020 616e 6420  with `-mte` and 
-00008dc0: 602d 6d74 7060 290a 0a0a 2323 206d 6172  `-mtp`)...## mar
-00008dd0: 6b64 6f77 6e20 7669 6577 6572 0a0a 616e  kdown viewer..an
-00008de0: 6420 7468 6572 6520 6172 6520 2a74 776f  d there are *two
-00008df0: 2a20 6564 6974 6f72 730a 0a21 5b63 6f70  * editors..![cop
-00008e00: 7970 6172 7479 2d6d 642d 7265 6164 2d66  yparty-md-read-f
-00008e10: 7338 5d28 6874 7470 733a 2f2f 7573 6572  s8](https://user
-00008e20: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00008e30: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-00008e40: 3130 3332 2f31 3135 3937 3830 3537 2d36  1032/115978057-6
-00008e50: 3634 3139 3038 302d 6135 3764 2d31 3165  6419080-a57d-11e
-00008e60: 622d 3835 3339 2d64 3262 6538 3433 3939  b-8539-d2be84399
-00008e70: 3161 612e 706e 6729 0a0a 2a20 7468 6520  1aa.png)..* the 
-00008e80: 646f 6375 6d65 6e74 2070 7265 7669 6577  document preview
-00008e90: 2068 6173 2061 206d 6178 2d77 6964 7468   has a max-width
-00008ea0: 2077 6869 6368 2069 7320 7468 6520 7361   which is the sa
-00008eb0: 6d65 2061 7320 616e 2041 3420 7061 7065  me as an A4 pape
-00008ec0: 7220 7768 656e 2070 7269 6e74 6564 0a0a  r when printed..
-00008ed0: 0a23 2320 6f74 6865 7220 7472 6963 6b73  .## other tricks
-00008ee0: 0a0a 2a20 796f 7520 6361 6e20 6c69 6e6b  ..* you can link
-00008ef0: 2061 2070 6172 7469 6375 6c61 7220 7469   a particular ti
-00008f00: 6d65 7374 616d 7020 696e 2061 6e20 6175  mestamp in an au
-00008f10: 6469 6f20 6669 6c65 2062 7920 6164 6469  dio file by addi
-00008f20: 6e67 2069 7420 746f 2074 6865 2055 524c  ng it to the URL
-00008f30: 2c20 7375 6368 2061 7320 6026 3230 6020  , such as `&20` 
-00008f40: 2f20 6026 3230 7360 202f 2060 2631 6d32  / `&20s` / `&1m2
-00008f50: 3060 202f 2060 2674 3d31 3a32 3060 2061  0` / `&t=1:20` a
-00008f60: 6674 6572 2074 6865 2060 2e2e 2e2f 2361  fter the `.../#a
-00008f70: 662d 6338 3936 3064 6162 600a 0a2a 2065  f-c8960dab`..* e
-00008f80: 6e61 626c 696e 6720 7468 6520 6175 6469  nabling the audi
-00008f90: 6f20 6571 7561 6c69 7a65 7220 6361 6e20  o equalizer can 
-00008fa0: 6865 6c70 206d 616b 6520 6761 706c 6573  help make gaples
-00008fb0: 7320 616c 6275 6d73 2066 756c 6c79 2067  s albums fully g
-00008fc0: 6170 6c65 7373 2069 6e20 736f 6d65 2062  apless in some b
-00008fd0: 726f 7773 6572 7320 2863 6872 6f6d 6529  rowsers (chrome)
-00008fe0: 2c20 736f 2063 6f6e 7369 6465 7220 6c65  , so consider le
-00008ff0: 6176 696e 6720 6974 206f 6e20 7769 7468  aving it on with
-00009000: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
-00009010: 6174 207a 6572 6f0a 0a2a 2067 6574 2061  at zero..* get a
-00009020: 2070 6c61 696e 7465 7874 2066 696c 6520   plaintext file 
-00009030: 6c69 7374 696e 6720 6279 2061 6464 696e  listing by addin
-00009040: 6720 603f 6c73 3d74 6020 746f 2061 2055  g `?ls=t` to a U
-00009050: 524c 2c20 6f72 2061 2063 6f6d 7061 6374  RL, or a compact
-00009060: 2063 6f6c 6f72 6564 206f 6e65 2077 6974   colored one wit
-00009070: 6820 603f 6c73 3d76 6020 2866 6f72 2075  h `?ls=v` (for u
-00009080: 6e69 7820 7465 726d 696e 616c 7329 0a0a  nix terminals)..
-00009090: 2a20 6966 2079 6f75 2061 7265 2075 7369  * if you are usi
-000090a0: 6e67 206d 6564 6961 2068 6f74 6b65 7973  ng media hotkeys
-000090b0: 2074 6f20 7377 6974 6368 2073 6f6e 6773   to switch songs
-000090c0: 2061 6e64 2061 7265 2067 6574 7469 6e67   and are getting
-000090d0: 2074 6972 6564 206f 6620 7365 6569 6e67   tired of seeing
-000090e0: 2074 6865 204f 5344 2070 6f70 7570 2077   the OSD popup w
-000090f0: 6869 6368 2057 696e 646f 7773 2064 6f65  hich Windows doe
-00009100: 736e 2774 206c 6574 2079 6f75 2064 6973  sn't let you dis
-00009110: 6162 6c65 2c20 636f 6e73 6964 6572 205b  able, consider [
-00009120: 2e2f 636f 6e74 7269 622f 6d65 6469 612d  ./contrib/media-
-00009130: 6f73 642d 6267 6f6e 652e 7073 315d 2863  osd-bgone.ps1](c
-00009140: 6f6e 7472 6962 2f23 6d65 6469 612d 6f73  ontrib/#media-os
-00009150: 642d 6267 6f6e 6570 7331 290a 0a2a 2063  d-bgoneps1)..* c
-00009160: 6c69 636b 2074 6865 2062 6f74 746f 6d2d  lick the bottom-
-00009170: 6c65 6674 2060 cf80 6020 746f 206f 7065  left `..` to ope
-00009180: 6e20 6120 6a61 7661 7363 7269 7074 2070  n a javascript p
-00009190: 726f 6d70 7420 666f 7220 6465 6275 6767  rompt for debugg
-000091a0: 696e 670a 0a2a 2066 696c 6573 206e 616d  ing..* files nam
-000091b0: 6564 2060 2e70 726f 6c6f 6775 652e 6874  ed `.prologue.ht
-000091c0: 6d6c 6020 2f20 602e 6570 696c 6f67 7565  ml` / `.epilogue
-000091d0: 2e68 746d 6c60 2077 696c 6c20 6265 2072  .html` will be r
-000091e0: 656e 6465 7265 6420 6265 666f 7265 2f61  endered before/a
-000091f0: 6674 6572 2064 6972 6563 746f 7279 206c  fter directory l
-00009200: 6973 7469 6e67 7320 756e 6c65 7373 2060  istings unless `
-00009210: 2d2d 6e6f 2d6c 6f67 7565 7360 0a0a 2a20  --no-logues`..* 
-00009220: 6669 6c65 7320 6e61 6d65 6420 6052 4541  files named `REA
-00009230: 444d 452e 6d64 6020 2f20 6072 6561 646d  DME.md` / `readm
-00009240: 652e 6d64 6020 7769 6c6c 2062 6520 7265  e.md` will be re
-00009250: 6e64 6572 6564 2061 6674 6572 2064 6972  ndered after dir
-00009260: 6563 746f 7279 206c 6973 7469 6e67 7320  ectory listings 
-00009270: 756e 6c65 7373 2060 2d2d 6e6f 2d72 6561  unless `--no-rea
-00009280: 646d 6560 2028 6275 7420 602e 6570 696c  dme` (but `.epil
-00009290: 6f67 7565 2e68 746d 6c60 2074 616b 6573  ogue.html` takes
-000092a0: 2070 7265 6365 6465 6e63 6529 0a0a 0a23   precedence)...#
-000092b0: 2320 7365 6172 6368 696e 670a 0a73 6561  # searching..sea
-000092c0: 7263 6820 6279 2073 697a 652c 2064 6174  rch by size, dat
-000092d0: 652c 2070 6174 682f 6e61 6d65 2c20 6d70  e, path/name, mp
-000092e0: 332d 7461 6773 2c20 2e2e 2e0a 0a21 5b63  3-tags, .....![c
-000092f0: 6f70 7970 6172 7479 2d73 6561 7263 682d  opyparty-search-
-00009300: 6673 385d 2868 7474 7073 3a2f 2f75 7365  fs8](https://use
-00009310: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00009320: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-00009330: 3431 3033 322f 3132 3936 3335 3336 352d  41032/129635365-
-00009340: 6330 6666 3261 3966 2d30 6565 352d 3466  c0ff2a9f-0ee5-4f
-00009350: 6333 2d38 6262 362d 3030 3630 3333 6366  c3-8bb6-006033cf
-00009360: 3637 6238 2e70 6e67 290a 0a77 6865 6e20  67b8.png)..when 
-00009370: 7374 6172 7465 6420 7769 7468 2060 2d65  started with `-e
-00009380: 3264 7361 6020 636f 7079 7061 7274 7920  2dsa` copyparty 
-00009390: 7769 6c6c 2073 6361 6e2f 696e 6465 7820  will scan/index 
-000093a0: 616c 6c20 796f 7572 2066 696c 6573 2e20  all your files. 
-000093b0: 5468 6973 2061 766f 6964 7320 6475 706c  This avoids dupl
-000093c0: 6963 6174 6573 206f 6e20 7570 6c6f 6164  icates on upload
-000093d0: 2c20 616e 6420 616c 736f 206d 616b 6573  , and also makes
-000093e0: 2074 6865 2076 6f6c 756d 6573 2073 6561   the volumes sea
-000093f0: 7263 6861 626c 6520 7468 726f 7567 6820  rchable through 
-00009400: 7468 6520 7765 622d 7569 3a0a 2a20 6d61  the web-ui:.* ma
-00009410: 6b65 2073 6561 7263 6820 7175 6572 6965  ke search querie
-00009420: 7320 6279 2060 7369 7a65 602f 6064 6174  s by `size`/`dat
-00009430: 6560 2f60 6469 7265 6374 6f72 792d 7061  e`/`directory-pa
-00009440: 7468 602f 6066 696c 656e 616d 6560 2c20  th`/`filename`, 
-00009450: 6f72 2e2e 2e0a 2a20 6472 6167 2f64 726f  or....* drag/dro
-00009460: 7020 6120 6c6f 6361 6c20 6669 6c65 2074  p a local file t
-00009470: 6f20 7365 6520 6966 2074 6865 2073 616d  o see if the sam
-00009480: 6520 636f 6e74 656e 7473 2065 7869 7374  e contents exist
-00009490: 2073 6f6d 6577 6865 7265 206f 6e20 7468   somewhere on th
-000094a0: 6520 7365 7276 6572 2c20 7365 6520 5b66  e server, see [f
-000094b0: 696c 652d 7365 6172 6368 5d28 2366 696c  ile-search](#fil
-000094c0: 652d 7365 6172 6368 290a 0a70 6174 682f  e-search)..path/
-000094d0: 6e61 6d65 2071 7565 7269 6573 2061 7265  name queries are
-000094e0: 2073 7061 6365 2d73 6570 6172 6174 6564   space-separated
-000094f0: 2c20 414e 4427 6564 2074 6f67 6574 6865  , AND'ed togethe
-00009500: 722c 2061 6e64 2077 6f72 6473 2061 7265  r, and words are
-00009510: 206e 6567 6174 6564 2077 6974 6820 6120   negated with a 
-00009520: 602d 6020 7072 6566 6978 2c20 736f 2066  `-` prefix, so f
-00009530: 6f72 2065 7861 6d70 6c65 3a0a 2a20 7061  or example:.* pa
-00009540: 7468 3a20 6073 6869 6261 7961 6e20 2d62  th: `shibayan -b
-00009550: 6f73 7361 6020 6669 6e64 7320 616c 6c20  ossa` finds all 
-00009560: 6669 6c65 7320 7768 6572 6520 6f6e 6520  files where one 
-00009570: 6f66 2074 6865 2066 6f6c 6465 7273 2063  of the folders c
-00009580: 6f6e 7461 696e 2060 7368 6962 6179 616e  ontain `shibayan
-00009590: 6020 6275 7420 6669 6c74 6572 7320 6f75  ` but filters ou
-000095a0: 7420 616e 7920 7265 7375 6c74 7320 7768  t any results wh
-000095b0: 6572 6520 6062 6f73 7361 6020 6578 6973  ere `bossa` exis
-000095c0: 7473 2073 6f6d 6577 6865 7265 2069 6e20  ts somewhere in 
-000095d0: 7468 6520 7061 7468 0a2a 206e 616d 653a  the path.* name:
-000095e0: 2060 6465 6d65 746f 7269 2073 7479 7860   `demetori styx`
-000095f0: 2067 6976 6573 2079 6f75 205b 676f 6f64   gives you [good
-00009600: 2073 7475 6666 5d28 6874 7470 733a 2f2f   stuff](https://
-00009610: 7777 772e 796f 7574 7562 652e 636f 6d2f  www.youtube.com/
-00009620: 7761 7463 683f 763d 7a47 6830 6731 345a  watch?v=zGh0g14Z
-00009630: 4a38 4926 6c69 7374 3d50 4c33 4131 3437  J8I&list=PL3A147
-00009640: 4244 3135 3145 4535 3231 3826 696e 6465  BD151EE5218&inde
-00009650: 783d 3929 0a0a 7468 6520 6072 6177 6020  x=9)..the `raw` 
-00009660: 6669 656c 6420 616c 6c6f 7773 2066 6f72  field allows for
-00009670: 206d 6f72 6520 636f 6d70 6c65 7820 7374   more complex st
-00009680: 7566 6620 7375 6368 2061 7320 6028 2074  uff such as `( t
-00009690: 6167 7320 6c69 6b65 202a 6e68 6174 6f2a  ags like *nhato*
-000096a0: 206f 7220 7461 6773 206c 696b 6520 2a74   or tags like *t
-000096b0: 6169 7368 692a 2029 2061 6e64 2028 206e  aishi* ) and ( n
-000096c0: 6f74 2074 6167 7320 6c69 6b65 202a 6e68  ot tags like *nh
-000096d0: 6174 6f2a 206f 7220 6e6f 7420 7461 6773  ato* or not tags
-000096e0: 206c 696b 6520 2a74 6169 7368 692a 2029   like *taishi* )
-000096f0: 6020 7768 6963 6820 6669 6e64 7320 616c  ` which finds al
-00009700: 6c20 736f 6e67 7320 6279 2065 6974 6865  l songs by eithe
-00009710: 7220 6e68 6174 6f20 6f72 2074 6169 7368  r nhato or taish
-00009720: 692c 2065 7863 6c75 6469 6e67 2063 6f6c  i, excluding col
-00009730: 6c61 6273 2028 7465 7272 6962 6c65 2065  labs (terrible e
-00009740: 7861 6d70 6c65 2c20 7768 7920 776f 756c  xample, why woul
-00009750: 6420 796f 7520 646f 2074 6861 7429 0a0a  d you do that)..
-00009760: 666f 7220 7468 6520 6162 6f76 6520 6578  for the above ex
-00009770: 616d 706c 6520 746f 2077 6f72 6b2c 2061  ample to work, a
-00009780: 6464 2074 6865 2063 6f6d 6d61 6e64 6c69  dd the commandli
-00009790: 6e65 2061 7267 756d 656e 7420 602d 6532  ne argument `-e2
-000097a0: 7473 6020 746f 2061 6c73 6f20 7363 616e  ts` to also scan
-000097b0: 2f69 6e64 6578 2074 6167 7320 6672 6f6d  /index tags from
-000097c0: 206d 7573 6963 2066 696c 6573 2c20 7768   music files, wh
-000097d0: 6963 6820 6272 696e 6773 2075 7320 6f76  ich brings us ov
-000097e0: 6572 2074 6f3a 0a0a 0a23 2073 6572 7665  er to:...# serve
-000097f0: 7220 636f 6e66 6967 0a0a 7573 696e 6720  r config..using 
-00009800: 6172 6775 6d65 6e74 7320 6f72 2063 6f6e  arguments or con
-00009810: 6669 6720 6669 6c65 732c 206f 7220 6120  fig files, or a 
-00009820: 6d69 7820 6f66 2062 6f74 683a 0a2a 2063  mix of both:.* c
-00009830: 6f6e 6669 6720 6669 6c65 7320 2860 2d63  onfig files (`-c
-00009840: 2073 6f6d 652e 636f 6e66 6029 2063 616e   some.conf`) can
-00009850: 2073 6574 2061 6464 6974 696f 6e61 6c20   set additional 
-00009860: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
-00009870: 6d65 6e74 733b 2073 6565 205b 2e2f 646f  ments; see [./do
-00009880: 6373 2f65 7861 6d70 6c65 2e63 6f6e 665d  cs/example.conf]
-00009890: 2864 6f63 732f 6578 616d 706c 652e 636f  (docs/example.co
-000098a0: 6e66 2920 616e 6420 5b2e 2f64 6f63 732f  nf) and [./docs/
-000098b0: 6578 616d 706c 6532 2e63 6f6e 665d 2864  example2.conf](d
-000098c0: 6f63 732f 6578 616d 706c 6532 2e63 6f6e  ocs/example2.con
-000098d0: 6629 0a2a 2060 6b69 6c6c 202d 7320 5553  f).* `kill -s US
-000098e0: 5231 6020 2873 616d 6520 6173 2060 7379  R1` (same as `sy
-000098f0: 7374 656d 6374 6c20 7265 6c6f 6164 2063  stemctl reload c
-00009900: 6f70 7970 6172 7479 6029 2074 6f20 7265  opyparty`) to re
-00009910: 6c6f 6164 2061 6363 6f75 6e74 7320 616e  load accounts an
-00009920: 6420 766f 6c75 6d65 7320 6672 6f6d 2063  d volumes from c
-00009930: 6f6e 6669 6720 6669 6c65 7320 7769 7468  onfig files with
-00009940: 6f75 7420 7265 7374 6172 7469 6e67 0a20  out restarting. 
-00009950: 202a 206f 7220 636c 6963 6b20 7468 6520   * or click the 
-00009960: 605b 7265 6c6f 6164 2063 6667 5d60 2062  `[reload cfg]` b
-00009970: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
-00009980: 7472 6f6c 2d70 616e 656c 2077 6865 6e20  trol-panel when 
-00009990: 6c6f 6767 6564 2069 6e20 6173 2061 646d  logged in as adm
-000099a0: 696e 200a 2020 2a20 6368 616e 6765 7320  in .  * changes 
-000099b0: 746f 2074 6865 2060 5b67 6c6f 6261 6c5d  to the `[global]
-000099c0: 6020 636f 6e66 6967 2073 6563 7469 6f6e  ` config section
-000099d0: 2072 6571 7569 7265 7320 6120 7265 7374   requires a rest
-000099e0: 6172 7420 746f 2074 616b 6520 6566 6665  art to take effe
-000099f0: 6374 0a0a 0a23 2320 7a65 726f 636f 6e66  ct...## zeroconf
-00009a00: 0a0a 616e 6e6f 756e 6365 2065 6e61 626c  ..announce enabl
-00009a10: 6564 2073 6572 7669 6365 7320 6f6e 2074  ed services on t
-00009a20: 6865 204c 414e 2028 5b70 6963 5d28 6874  he LAN ([pic](ht
-00009a30: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-00009a40: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-00009a50: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
-00009a60: 3135 3334 3437 3337 2d30 6561 6538 6439  15344737-0eae8d9
-00009a70: 382d 3934 3936 2d34 3235 362d 3961 6138  8-9496-4256-9aa8
-00009a80: 2d63 6432 6636 3937 3138 3130 642e 706e  -cd2f6971810d.pn
-00009a90: 6729 2920 202d 2d20 602d 7a60 2065 6e61  g))  -- `-z` ena
-00009aa0: 626c 6573 2062 6f74 6820 5b6d 646e 735d  bles both [mdns]
-00009ab0: 2823 6d64 6e73 2920 616e 6420 5b73 7364  (#mdns) and [ssd
-00009ac0: 705d 2823 7373 6470 290a 0a2a 2060 2d2d  p](#ssdp)..* `--
-00009ad0: 7a2d 6f6e 6020 2f20 602d 2d7a 2d6f 6666  z-on` / `--z-off
-00009ae0: 6027 206c 696d 6974 7320 7468 6520 6665  `' limits the fe
-00009af0: 6174 7572 6520 746f 2063 6572 7461 696e  ature to certain
-00009b00: 206e 6574 776f 726b 730a 0a0a 2323 2320   networks...### 
-00009b10: 6d64 6e73 0a0a 4c41 4e20 646f 6d61 696e  mdns..LAN domain
-00009b20: 2d6e 616d 6520 616e 6420 6665 6174 7572  -name and featur
-00009b30: 6520 616e 6e6f 756e 6365 720a 0a75 7365  e announcer..use
-00009b40: 7320 5b6d 756c 7469 6361 7374 2064 6e73  s [multicast dns
-00009b50: 5d28 6874 7470 733a 2f2f 656e 2e77 696b  ](https://en.wik
-00009b60: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00009b70: 4d75 6c74 6963 6173 745f 444e 5329 2074  Multicast_DNS) t
-00009b80: 6f20 6769 7665 2063 6f70 7970 6172 7479  o give copyparty
-00009b90: 2061 2064 6f6d 6169 6e20 7768 6963 6820   a domain which 
-00009ba0: 616e 7920 6d61 6368 696e 6520 6f6e 2074  any machine on t
-00009bb0: 6865 204c 414e 2063 616e 2075 7365 2074  he LAN can use t
-00009bc0: 6f20 6163 6365 7373 2069 740a 0a61 6c6c  o access it..all
-00009bd0: 2065 6e61 626c 6564 2073 6572 7669 6365   enabled service
-00009be0: 7320 285b 7765 6264 6176 5d28 2377 6562  s ([webdav](#web
-00009bf0: 6461 762d 7365 7276 6572 292c 205b 6674  dav-server), [ft
-00009c00: 705d 2823 6674 702d 7365 7276 6572 292c  p](#ftp-server),
-00009c10: 205b 736d 625d 2823 736d 622d 7365 7276   [smb](#smb-serv
-00009c20: 6572 2929 2077 696c 6c20 6170 7065 6172  er)) will appear
-00009c30: 2069 6e20 6d44 4e53 2d61 7761 7265 2066   in mDNS-aware f
-00009c40: 696c 6520 6d61 6e61 6765 7273 2028 4b44  ile managers (KD
-00009c50: 452c 2067 6e6f 6d65 2c20 6d61 634f 532c  E, gnome, macOS,
-00009c60: 202e 2e2e 290a 0a74 6865 2064 6f6d 6169   ...)..the domai
-00009c70: 6e20 7769 6c6c 2062 6520 6874 7470 3a2f  n will be http:/
-00009c80: 2f70 6172 7479 626f 782e 6c6f 6361 6c20  /partybox.local 
-00009c90: 6966 2074 6865 206d 6163 6869 6e65 2773  if the machine's
-00009ca0: 2068 6f73 746e 616d 6520 6973 2060 7061   hostname is `pa
-00009cb0: 7274 7962 6f78 6020 756e 6c65 7373 2060  rtybox` unless `
-00009cc0: 2d2d 6e61 6d65 6020 7370 6563 6966 6965  --name` specifie
-00009cd0: 7320 736f 656d 7468 696e 6720 656c 7365  s soemthing else
-00009ce0: 0a0a 0a23 2323 2073 7364 700a 0a77 696e  ...### ssdp..win
-00009cf0: 646f 7773 2d65 7870 6c6f 7265 7220 616e  dows-explorer an
-00009d00: 6e6f 756e 6365 720a 0a75 7365 7320 5b73  nouncer..uses [s
-00009d10: 7364 705d 2868 7474 7073 3a2f 2f65 6e2e  sdp](https://en.
-00009d20: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00009d30: 6b69 2f53 696d 706c 655f 5365 7276 6963  ki/Simple_Servic
-00009d40: 655f 4469 7363 6f76 6572 795f 5072 6f74  e_Discovery_Prot
-00009d50: 6f63 6f6c 2920 746f 206d 616b 6520 636f  ocol) to make co
-00009d60: 7079 7061 7274 7920 6170 7065 6172 2069  pyparty appear i
-00009d70: 6e20 7468 6520 7769 6e64 6f77 7320 6669  n the windows fi
-00009d80: 6c65 2065 7870 6c6f 7265 7220 6f6e 2061  le explorer on a
-00009d90: 6c6c 206d 6163 6869 6e65 7320 6f6e 2074  ll machines on t
-00009da0: 6865 204c 414e 0a0a 646f 7562 6c65 636c  he LAN..doublecl
-00009db0: 6963 6b69 6e67 2074 6865 2069 636f 6e20  icking the icon 
-00009dc0: 6f70 656e 7320 7468 6520 2263 6f6e 6e65  opens the "conne
-00009dd0: 6374 2220 7061 6765 2077 6869 6368 2065  ct" page which e
-00009de0: 7870 6c61 696e 7320 686f 7720 746f 206d  xplains how to m
-00009df0: 6f75 6e74 2063 6f70 7970 6172 7479 2061  ount copyparty a
-00009e00: 7320 6120 6c6f 6361 6c20 6669 6c65 7379  s a local filesy
-00009e10: 7374 656d 0a0a 6966 2063 6f70 7970 6172  stem..if copypar
-00009e20: 7479 2064 6f65 7320 6e6f 7420 6170 7065  ty does not appe
-00009e30: 6172 2069 6e20 7769 6e64 6f77 7320 6578  ar in windows ex
-00009e40: 706c 6f72 6572 2c20 7573 6520 602d 2d7a  plorer, use `--z
-00009e50: 7376 6020 746f 2073 6565 2077 6879 3a0a  sv` to see why:.
-00009e60: 0a2a 206d 6179 6265 2074 6865 2064 6973  .* maybe the dis
-00009e70: 636f 7665 7279 206d 756c 7469 6361 7374  covery multicast
-00009e80: 2077 6173 2073 656e 7420 6672 6f6d 2061   was sent from a
-00009e90: 6e20 4950 2077 6869 6368 2064 6f65 7320  n IP which does 
-00009ea0: 6e6f 7420 696e 7465 7273 6563 7420 7769  not intersect wi
-00009eb0: 7468 2074 6865 2073 6572 7665 7220 7375  th the server su
-00009ec0: 626e 6574 730a 0a0a 2323 2071 722d 636f  bnets...## qr-co
-00009ed0: 6465 0a0a 7072 696e 7420 6120 7172 2d63  de..print a qr-c
-00009ee0: 6f64 6520 5b28 7363 7265 656e 7368 6f74  ode [(screenshot
-00009ef0: 295d 2868 7474 7073 3a2f 2f75 7365 722d  )](https://user-
-00009f00: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00009f10: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-00009f20: 3033 322f 3139 3437 3238 3533 332d 3666  032/194728533-6f
-00009f30: 3030 3834 3962 2d63 3661 632d 3433 6336  00849b-c6ac-43c6
-00009f40: 2d39 3335 392d 3833 6534 3534 6431 3165  -9359-83e454d11e
-00009f50: 3030 2e70 6e67 2920 666f 7220 7175 6963  00.png) for quic
-00009f60: 6b20 6163 6365 7373 2c20 2067 7265 6174  k access,  great
-00009f70: 2062 6574 7765 656e 2070 686f 6e65 7320   between phones 
-00009f80: 6f6e 2061 6e64 726f 6964 2068 6f74 7370  on android hotsp
-00009f90: 6f74 7320 7768 6963 6820 6b65 6570 2063  ots which keep c
-00009fa0: 6861 6e67 696e 6720 7468 6520 7375 626e  hanging the subn
-00009fb0: 6574 0a0a 2a20 602d 2d71 7260 2065 6e61  et..* `--qr` ena
-00009fc0: 626c 6573 2069 740a 2a20 602d 2d71 7273  bles it.* `--qrs
-00009fd0: 6020 646f 6573 2068 7474 7073 2069 6e73  ` does https ins
-00009fe0: 7465 6164 206f 6620 6874 7470 0a2a 2060  tead of http.* `
-00009ff0: 2d2d 7172 6c20 6c6f 6f74 626f 782f 3f70  --qrl lootbox/?p
-0000a000: 773d 6875 6e74 6572 3260 2061 7070 656e  w=hunter2` appen
-0000a010: 6473 2074 6f20 7468 6520 7572 6c2c 206c  ds to the url, l
-0000a020: 696e 6b69 6e67 2074 6f20 7468 6520 606c  inking to the `l
-0000a030: 6f6f 7462 6f78 6020 666f 6c64 6572 2077  ootbox` folder w
-0000a040: 6974 6820 7061 7373 776f 7264 2060 6875  ith password `hu
-0000a050: 6e74 6572 3260 0a2a 2060 2d2d 7172 7a20  nter2`.* `--qrz 
-0000a060: 3160 2066 6f72 6365 7320 3178 207a 6f6f  1` forces 1x zoo
-0000a070: 6d20 696e 7374 6561 6420 6f66 2061 7574  m instead of aut
-0000a080: 6f73 6361 6c69 6e67 2074 6f20 6669 7420  oscaling to fit 
-0000a090: 7468 6520 7465 726d 696e 616c 2073 697a  the terminal siz
-0000a0a0: 650a 2020 2a20 3178 206d 6179 2072 656e  e.  * 1x may ren
-0000a0b0: 6465 7220 696e 636f 7272 6563 746c 7920  der incorrectly 
-0000a0c0: 6f6e 2073 6f6d 6520 7465 726d 696e 616c  on some terminal
-0000a0d0: 732f 666f 6e74 732c 2062 7574 2032 7820  s/fonts, but 2x 
-0000a0e0: 7368 6f75 6c64 2061 6c77 6179 7320 776f  should always wo
-0000a0f0: 726b 0a0a 6974 2075 7365 7320 7468 6520  rk..it uses the 
-0000a100: 7365 7276 6572 2068 6f73 746e 616d 6520  server hostname 
-0000a110: 6966 205b 6d64 6e73 5d28 236d 646e 7329  if [mdns](#mdns)
-0000a120: 2069 7320 656e 626c 6564 2c20 6f74 6865   is enbled, othe
-0000a130: 7277 6973 6520 6974 276c 6c20 7573 6520  rwise it'll use 
-0000a140: 796f 7572 2065 7874 6572 6e61 6c20 6970  your external ip
-0000a150: 2028 6465 6661 756c 7420 726f 7574 6529   (default route)
-0000a160: 2075 6e6c 6573 7320 602d 2d71 7269 6020   unless `--qri` 
-0000a170: 7370 6563 6966 6965 7320 6120 7370 6563  specifies a spec
-0000a180: 6966 6963 2069 702d 7072 6566 6978 206f  ific ip-prefix o
-0000a190: 7220 646f 6d61 696e 0a0a 0a23 2320 6674  r domain...## ft
-0000a1a0: 7020 7365 7276 6572 0a0a 616e 2046 5450  p server..an FTP
-0000a1b0: 2073 6572 7665 7220 6361 6e20 6265 2073   server can be s
-0000a1c0: 7461 7274 6564 2075 7369 6e67 2060 2d2d  tarted using `--
-0000a1d0: 6674 7020 3339 3231 602c 2020 616e 642f  ftp 3921`,  and/
-0000a1e0: 6f72 2060 2d2d 6674 7073 6020 666f 7220  or `--ftps` for 
-0000a1f0: 6578 706c 6963 6974 2054 4c53 2028 6674  explicit TLS (ft
-0000a200: 7065 7329 0a0a 2a20 6261 7365 6420 6f6e  pes)..* based on
-0000a210: 205b 7079 6674 7064 6c69 625d 2868 7474   [pyftpdlib](htt
-0000a220: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0000a230: 6769 616d 7061 6f6c 6f2f 7079 6674 7064  giampaolo/pyftpd
-0000a240: 6c69 6229 0a2a 206e 6565 6473 2061 2064  lib).* needs a d
-0000a250: 6564 6963 6174 6564 2070 6f72 7420 2863  edicated port (c
-0000a260: 616e 6e6f 7420 7368 6172 6520 7769 7468  annot share with
-0000a270: 2074 6865 2048 5454 502f 4854 5450 5320   the HTTP/HTTPS 
-0000a280: 4150 4929 0a2a 2075 706c 6f61 6473 2061  API).* uploads a
-0000a290: 7265 206e 6f74 2072 6573 756d 6162 6c65  re not resumable
-0000a2a0: 202d 2d20 6465 6c65 7465 2061 6e64 2072   -- delete and r
-0000a2b0: 6573 7461 7274 2069 6620 6e65 6365 7373  estart if necess
-0000a2c0: 6172 790a 2a20 7275 6e73 2069 6e20 6163  ary.* runs in ac
-0000a2d0: 7469 7665 206d 6f64 6520 6279 2064 6566  tive mode by def
-0000a2e0: 6175 6c74 2c20 796f 7520 7072 6f62 6162  ault, you probab
-0000a2f0: 6c79 2077 616e 7420 602d 2d66 7470 2d70  ly want `--ftp-p
-0000a300: 7220 3132 3030 302d 3133 3030 3060 0a20  r 12000-13000`. 
-0000a310: 202a 2069 6620 796f 7520 656e 6162 6c65   * if you enable
-0000a320: 2062 6f74 6820 6066 7470 6020 616e 6420   both `ftp` and 
-0000a330: 6066 7470 7360 2c20 7468 6520 706f 7274  `ftps`, the port
-0000a340: 2d72 616e 6765 2077 696c 6c20 6265 2064  -range will be d
-0000a350: 6976 6964 6564 2069 6e20 6861 6c66 0a20  ivided in half. 
-0000a360: 202a 2073 6f6d 6520 6f6c 6465 7220 736f   * some older so
-0000a370: 6674 7761 7265 2028 6669 6c65 7a69 6c6c  ftware (filezill
-0000a380: 6120 6f6e 2064 6562 6961 6e2d 7374 6162  a on debian-stab
-0000a390: 6c65 2920 6361 6e6e 6f74 2070 6173 7369  le) cannot passi
-0000a3a0: 7665 2d6d 6f64 6520 7769 7468 2054 4c53  ve-mode with TLS
-0000a3b0: 0a2a 206c 6f67 696e 2077 6974 6820 616e  .* login with an
-0000a3c0: 7920 7573 6572 6e61 6d65 202b 2079 6f75  y username + you
-0000a3d0: 7220 7061 7373 776f 7264 2c20 6f72 2070  r password, or p
-0000a3e0: 7574 2079 6f75 7220 7061 7373 776f 7264  ut your password
-0000a3f0: 2069 6e20 7468 6520 7573 6572 6e61 6d65   in the username
-0000a400: 2066 6965 6c64 0a0a 0a23 2320 7765 6264   field...## webd
-0000a410: 6176 2073 6572 7665 720a 0a77 6974 6820  av server..with 
-0000a420: 7265 6164 2d77 7269 7465 2073 7570 706f  read-write suppo
-0000a430: 7274 2c20 2073 7570 706f 7274 7320 7769  rt,  supports wi
-0000a440: 6e58 5020 616e 6420 6c61 7465 722c 206d  nXP and later, m
-0000a450: 6163 6f73 2c20 6e61 7574 696c 7573 2f67  acos, nautilus/g
-0000a460: 7666 730a 0a63 6c69 636b 2074 6865 205b  vfs..click the [
-0000a470: 636f 6e6e 6563 745d 2868 7474 703a 2f2f  connect](http://
-0000a480: 3132 372e 302e 302e 313a 3339 3233 2f3f  127.0.0.1:3923/?
-0000a490: 6863 2920 6275 7474 6f6e 2069 6e20 7468  hc) button in th
-0000a4a0: 6520 636f 6e74 726f 6c2d 7061 6e65 6c20  e control-panel 
-0000a4b0: 746f 2073 6565 2063 6f6e 6e65 6374 696f  to see connectio
-0000a4c0: 6e20 696e 7374 7275 6374 696f 6e73 2066  n instructions f
-0000a4d0: 6f72 2077 696e 646f 7773 2c20 6c69 6e75  or windows, linu
-0000a4e0: 782c 206d 6163 6f73 0a0a 6765 6e65 7261  x, macos..genera
-0000a4f0: 6c20 7573 6167 653a 0a2a 206c 6f67 696e  l usage:.* login
-0000a500: 2077 6974 6820 616e 7920 7573 6572 6e61   with any userna
-0000a510: 6d65 202b 2079 6f75 7220 7061 7373 776f  me + your passwo
-0000a520: 7264 2c20 6f72 2070 7574 2079 6f75 7220  rd, or put your 
-0000a530: 7061 7373 776f 7264 2069 6e20 7468 6520  password in the 
-0000a540: 7573 6572 6e61 6d65 2066 6965 6c64 2028  username field (
-0000a550: 7061 7373 776f 7264 2066 6965 6c64 2063  password field c
-0000a560: 616e 2062 6520 656d 7074 792f 7768 6174  an be empty/what
-0000a570: 6576 6572 290a 0a6f 6e20 6d61 636f 732c  ever)..on macos,
-0000a580: 2063 6f6e 6e65 6374 2066 726f 6d20 6669   connect from fi
-0000a590: 6e64 6572 3a0a 2a20 5b47 6f5d 202d 3e20  nder:.* [Go] -> 
-0000a5a0: 5b43 6f6e 6e65 6374 2074 6f20 5365 7276  [Connect to Serv
-0000a5b0: 6572 2e2e 2e5d 202d 3e20 6874 7470 3a2f  er...] -> http:/
-0000a5c0: 2f31 3932 2e31 3638 2e31 3233 2e31 3a33  /192.168.123.1:3
-0000a5d0: 3932 332f 0a0a 696e 206f 7264 6572 2074  923/..in order t
-0000a5e0: 6f20 6772 616e 7420 6675 6c6c 2077 7269  o grant full wri
-0000a5f0: 7465 2d61 6363 6573 7320 746f 2077 6562  te-access to web
-0000a600: 6461 7620 636c 6965 6e74 732c 2074 6865  dav clients, the
-0000a610: 2076 6f6c 666c 6167 2060 6461 7760 206d   volflag `daw` m
-0000a620: 7573 7420 6265 2073 6574 2061 6e64 2074  ust be set and t
-0000a630: 6865 2061 6363 6f75 6e74 206d 7573 7420  he account must 
-0000a640: 616c 736f 2068 6176 6520 6465 6c65 7465  also have delete
-0000a650: 2d61 6363 6573 7320 286f 7468 6572 7769  -access (otherwi
-0000a660: 7365 2074 6865 2063 6c69 656e 7420 776f  se the client wo
-0000a670: 6e27 7420 6265 2061 6c6c 6f77 6564 2074  n't be allowed t
-0000a680: 6f20 7265 706c 6163 6520 7468 6520 636f  o replace the co
-0000a690: 6e74 656e 7473 206f 6620 6578 6973 7469  ntents of existi
-0000a6a0: 6e67 2066 696c 6573 2c20 7768 6963 6820  ng files, which 
-0000a6b0: 6973 2068 6f77 2077 6562 6461 7620 776f  is how webdav wo
-0000a6c0: 726b 7329 0a0a 0a23 2323 2063 6f6e 6e65  rks)...### conne
-0000a6d0: 6374 696e 6720 746f 2077 6562 6461 7620  cting to webdav 
-0000a6e0: 6672 6f6d 2077 696e 646f 7773 0a0a 7573  from windows..us
-0000a6f0: 696e 6720 7468 6520 4755 4920 2028 7769  ing the GUI  (wi
-0000a700: 6e58 5020 6f72 206c 6174 6572 293a 0a2a  nXP or later):.*
-0000a710: 2072 6967 6874 636c 6963 6b20 5b6d 7920   rightclick [my 
-0000a720: 636f 6d70 7574 6572 5d20 2d3e 205b 6d61  computer] -> [ma
-0000a730: 7020 6e65 7477 6f72 6b20 6472 6976 655d  p network drive]
-0000a740: 202d 3e20 466f 6c64 6572 3a20 6068 7474   -> Folder: `htt
-0000a750: 703a 2f2f 3139 322e 3136 382e 3132 332e  p://192.168.123.
-0000a760: 313a 3339 3233 2f60 0a20 202a 206f 6e20  1:3923/`.  * on 
-0000a770: 7769 6e58 5020 6f6e 6c79 2c20 636c 6963  winXP only, clic
-0000a780: 6b20 7468 6520 6053 6967 6e20 7570 2066  k the `Sign up f
-0000a790: 6f72 206f 6e6c 696e 6520 7374 6f72 6167  or online storag
-0000a7a0: 6560 2068 7970 6572 6c69 6e6b 2069 6e73  e` hyperlink ins
-0000a7b0: 7465 6164 2061 6e64 2070 7574 2074 6865  tead and put the
-0000a7c0: 2055 524c 2074 6865 7265 0a20 202a 2070   URL there.  * p
-0000a7d0: 726f 7669 6469 6e67 2079 6f75 7220 7061  roviding your pa
-0000a7e0: 7373 776f 7264 2061 7320 7468 6520 7573  ssword as the us
-0000a7f0: 6572 6e61 6d65 2069 7320 7265 636f 6d6d  ername is recomm
-0000a800: 656e 6465 643b 2074 6865 2070 6173 7377  ended; the passw
-0000a810: 6f72 6420 6669 656c 6420 6361 6e20 6265  ord field can be
-0000a820: 2061 6e79 7468 696e 6720 6f72 2065 6d70   anything or emp
-0000a830: 7479 0a0a 6b6e 6f77 6e20 636c 6965 6e74  ty..known client
-0000a840: 2062 7567 733a 0a2a 2077 696e 372b 2064   bugs:.* win7+ d
-0000a850: 6f65 736e 2774 2061 6374 7561 6c6c 7920  oesn't actually 
-0000a860: 7365 6e64 2074 6865 2070 6173 7377 6f72  send the passwor
-0000a870: 6420 746f 2074 6865 2073 6572 7665 7220  d to the server 
-0000a880: 7768 656e 2072 6561 7574 6865 6e74 6963  when reauthentic
-0000a890: 6174 696e 6720 6166 7465 7220 6120 7265  ating after a re
-0000a8a0: 626f 6f74 2075 6e6c 6573 7320 796f 7520  boot unless you 
-0000a8b0: 6669 7273 7420 7472 7920 746f 206c 6f67  first try to log
-0000a8c0: 696e 2077 6974 6820 616e 2069 6e63 6f72  in with an incor
-0000a8d0: 7265 6374 2070 6173 7377 6f72 6420 616e  rect password an
-0000a8e0: 6420 7468 656e 2073 7769 7463 6820 746f  d then switch to
-0000a8f0: 2074 6865 2063 6f72 7265 6374 2070 6173   the correct pas
-0000a900: 7377 6f72 640a 2020 2a20 6f72 206a 7573  sword.  * or jus
-0000a910: 7420 7479 7065 2079 6f75 7220 7061 7373  t type your pass
-0000a920: 776f 7264 2069 6e74 6f20 7468 6520 7573  word into the us
-0000a930: 6572 6e61 6d65 2066 6965 6c64 2069 6e73  ername field ins
-0000a940: 7465 6164 2074 6f20 6765 7420 6172 6f75  tead to get arou
-0000a950: 6e64 2069 7420 656e 7469 7265 6c79 0a2a  nd it entirely.*
-0000a960: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
-0000a970: 2066 6f6c 6465 7220 7768 6963 6820 616c   folder which al
-0000a980: 6c6f 7773 2061 6e6f 6e79 6d6f 7573 2072  lows anonymous r
-0000a990: 6561 6420 7769 6c6c 206d 616b 6520 7772  ead will make wr
-0000a9a0: 6974 696e 6720 696d 706f 7373 6962 6c65  iting impossible
-0000a9b0: 2c20 6173 2077 696e 646f 7773 2068 6173  , as windows has
-0000a9c0: 2064 6563 6964 6564 2069 7420 646f 6573   decided it does
-0000a9d0: 6e27 7420 6e65 6564 2074 6f20 6c6f 6769  n't need to logi
-0000a9e0: 6e0a 2020 2a20 776f 726b 6172 6f75 6e64  n.  * workaround
-0000a9f0: 3a20 636f 6e6e 6563 7420 7477 6963 653b  : connect twice;
-0000aa00: 2066 6972 7374 2074 6f20 6120 666f 6c64   first to a fold
-0000aa10: 6572 2077 6869 6368 2072 6571 7569 7265  er which require
-0000aa20: 7320 6175 7468 2c20 7468 656e 2074 6f20  s auth, then to 
-0000aa30: 7468 6520 666f 6c64 6572 2079 6f75 2061  the folder you a
-0000aa40: 6374 7561 6c6c 7920 7761 6e74 2c20 616e  ctually want, an
-0000aa50: 6420 6c65 6176 6520 626f 7468 206f 6620  d leave both of 
-0000aa60: 7468 6f73 6520 6d6f 756e 7465 640a 2a20  those mounted.* 
-0000aa70: 7769 6e37 2b20 6d61 7920 6f70 656e 2061  win7+ may open a
-0000aa80: 206e 6577 2074 6370 2063 6f6e 6e65 6374   new tcp connect
-0000aa90: 696f 6e20 666f 7220 6576 6572 7920 6669  ion for every fi
-0000aaa0: 6c65 2061 6e64 2073 6f6d 6574 696d 6573  le and sometimes
-0000aab0: 2066 6f72 6765 7473 2074 6f20 636c 6f73   forgets to clos
-0000aac0: 6520 7468 656d 2c20 6576 656e 7475 616c  e them, eventual
-0000aad0: 6c79 206e 6565 6469 6e67 2061 2072 6562  ly needing a reb
-0000aae0: 6f6f 740a 2020 2a20 6d61 7962 6520 4e49  oot.  * maybe NI
-0000aaf0: 432d 7265 6c61 7465 6420 283f 3f29 2c20  C-related (??), 
-0000ab00: 6861 7070 656e 7320 7769 7468 2077 696e  happens with win
-0000ab10: 3130 2d6c 7473 6320 6f6e 2065 3130 3030  10-ltsc on e1000
-0000ab20: 6520 6275 7420 6e6f 7420 7669 7274 696f  e but not virtio
-0000ab30: 0a2a 2077 696e 646f 7773 2063 616e 6e6f  .* windows canno
-0000ab40: 7420 6163 6365 7373 2066 6f6c 6465 7273  t access folders
-0000ab50: 2077 6869 6368 2063 6f6e 7461 696e 2066   which contain f
-0000ab60: 696c 656e 616d 6573 2077 6974 6820 696e  ilenames with in
-0000ab70: 7661 6c69 6420 756e 6963 6f64 6520 6f72  valid unicode or
-0000ab80: 2066 6f72 6269 6464 656e 2063 6861 7261   forbidden chara
-0000ab90: 6374 6572 7320 2860 3c3e 3a22 2f5c 7c3f  cters (`<>:"/\|?
-0000aba0: 2a60 292c 206f 7220 6e61 6d65 7320 656e  *`), or names en
-0000abb0: 6469 6e67 2077 6974 6820 602e 600a 2a20  ding with `.`.* 
-0000abc0: 7769 6e78 7020 6361 6e6e 6f74 2073 686f  winxp cannot sho
-0000abd0: 7720 756e 6963 6f64 6520 6368 6172 6163  w unicode charac
-0000abe0: 7465 7273 206f 7574 7369 6465 206f 6620  ters outside of 
-0000abf0: 2a73 6f6d 6520 7261 6e67 652a 0a20 202a  *some range*.  *
-0000ac00: 206c 6174 696e 2d31 2069 7320 6669 6e65   latin-1 is fine
-0000ac10: 2c20 6869 7261 6761 6e61 2069 7320 6e6f  , hiragana is no
-0000ac20: 7420 286e 6f74 2065 7665 6e20 6173 2073  t (not even as s
-0000ac30: 6869 6674 2d6a 6973 206f 6e20 6a61 7061  hift-jis on japa
-0000ac40: 6e65 7365 2078 7029 0a0a 0a23 2320 736d  nese xp)...## sm
-0000ac50: 6220 7365 7276 6572 0a0a 756e 7361 6665  b server..unsafe
-0000ac60: 2c20 736c 6f77 2c20 6e6f 7420 7265 636f  , slow, not reco
-0000ac70: 6d6d 656e 6465 6420 666f 7220 7761 6e2c  mmended for wan,
-0000ac80: 2020 656e 6162 6c65 2077 6974 6820 602d    enable with `-
-0000ac90: 2d73 6d62 6020 666f 7220 7265 6164 2d6f  -smb` for read-o
-0000aca0: 6e6c 7920 6f72 2060 2d2d 736d 6277 6020  nly or `--smbw` 
-0000acb0: 666f 7220 7265 6164 2d77 7269 7465 0a0a  for read-write..
-0000acc0: 636c 6963 6b20 7468 6520 5b63 6f6e 6e65  click the [conne
-0000acd0: 6374 5d28 6874 7470 3a2f 2f31 3237 2e30  ct](http://127.0
-0000ace0: 2e30 2e31 3a33 3932 332f 3f68 6329 2062  .0.1:3923/?hc) b
-0000acf0: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
-0000ad00: 7472 6f6c 2d70 616e 656c 2074 6f20 7365  trol-panel to se
-0000ad10: 6520 636f 6e6e 6563 7469 6f6e 2069 6e73  e connection ins
-0000ad20: 7472 7563 7469 6f6e 7320 666f 7220 7769  tructions for wi
-0000ad30: 6e64 6f77 732c 206c 696e 7578 2c20 6d61  ndows, linux, ma
-0000ad40: 636f 730a 0a64 6570 656e 6465 6e63 6965  cos..dependencie
-0000ad50: 733a 2060 7079 7468 6f6e 3320 2d6d 2070  s: `python3 -m p
-0000ad60: 6970 2069 6e73 7461 6c6c 202d 2d75 7365  ip install --use
-0000ad70: 7220 2d55 2069 6d70 6163 6b65 743d 3d30  r -U impacket==0
-0000ad80: 2e31 302e 3060 0a2a 206e 6577 6572 2076  .10.0`.* newer v
-0000ad90: 6572 7369 6f6e 7320 6f66 2069 6d70 6163  ersions of impac
-0000ada0: 6b65 7420 7769 6c6c 2068 6f70 6566 756c  ket will hopeful
-0000adb0: 6c79 2077 6f72 6b20 6a75 7374 2066 696e  ly work just fin
-0000adc0: 6520 6275 7420 7468 6572 6520 6973 206d  e but there is m
-0000add0: 6f6e 6b65 7970 6174 6368 696e 6720 736f  onkeypatching so
-0000ade0: 206d 6179 6265 206e 6f74 0a0a 736f 6d65   maybe not..some
-0000adf0: 202a 2a42 4947 2057 4152 4e49 4e47 532a   **BIG WARNINGS*
-0000ae00: 2a20 7370 6563 6966 6963 2074 6f20 534d  * specific to SM
-0000ae10: 422f 4349 4653 2c20 696e 2064 6563 7265  B/CIFS, in decre
-0000ae20: 6173 696e 6720 696d 706f 7274 616e 6365  asing importance
-0000ae30: 3a0a 2a20 6e6f 7420 656e 7469 7265 6c79  :.* not entirely
-0000ae40: 2063 6f6e 6669 6465 6e74 2074 6861 7420   confident that 
-0000ae50: 7265 6164 2d6f 6e6c 7920 6973 2072 6561  read-only is rea
-0000ae60: 642d 6f6e 6c79 0a2a 2074 6865 2073 6d62  d-only.* the smb
-0000ae70: 2062 6163 6b65 6e64 2069 7320 6e6f 7420   backend is not 
-0000ae80: 6675 6c6c 7920 696e 7465 6772 6174 6564  fully integrated
-0000ae90: 2077 6974 6820 7666 732c 206d 6561 6e69   with vfs, meani
-0000aea0: 6e67 2074 6865 7265 2063 6f75 6c64 2062  ng there could b
-0000aeb0: 6520 7365 6375 7269 7479 2069 7373 7565  e security issue
-0000aec0: 7320 2870 6174 6820 7472 6176 6572 7361  s (path traversa
-0000aed0: 6c29 2e20 506c 6561 7365 2075 7365 2060  l). Please use `
-0000aee0: 2d2d 736d 622d 706f 7274 6020 2873 6565  --smb-port` (see
-0000aef0: 2062 656c 6f77 2920 616e 6420 5b70 7269   below) and [pri
-0000af00: 736f 6e70 6172 7479 5d28 2e2f 6269 6e2f  sonparty](./bin/
-0000af10: 7072 6973 6f6e 7061 7274 792e 7368 290a  prisonparty.sh).
-0000af20: 2020 2a20 6163 636f 756e 7420 7061 7373    * account pass
-0000af30: 776f 7264 7320 776f 726b 2070 6572 2d76  words work per-v
-0000af40: 6f6c 756d 6520 6173 2065 7870 6563 7465  olume as expecte
-0000af50: 642c 2062 7574 2061 6363 6f75 6e74 2070  d, but account p
-0000af60: 6572 6d69 7373 696f 6e73 2061 7265 2063  ermissions are c
-0000af70: 6f61 6c65 7363 6564 3b20 616c 6c20 6163  oalesced; all ac
-0000af80: 636f 756e 7473 2068 6176 6520 7265 6164  counts have read
-0000af90: 2d61 6363 6573 7320 746f 2061 6c6c 2076  -access to all v
-0000afa0: 6f6c 756d 6573 2c20 616e 6420 6966 2061  olumes, and if a
-0000afb0: 2073 696e 676c 6520 6163 636f 756e 7420   single account 
-0000afc0: 6861 7320 7772 6974 652d 6163 6365 7373  has write-access
-0000afd0: 2074 6f20 736f 6d65 2076 6f6c 756d 6520   to some volume 
-0000afe0: 7468 656e 2061 6c6c 206f 7468 6572 2061  then all other a
-0000aff0: 6363 6f75 6e74 7320 616c 736f 2064 6f0a  ccounts also do.
-0000b000: 2020 2020 2a20 6966 206e 6f20 6163 636f      * if no acco
-0000b010: 756e 7473 2068 6176 6520 7772 6974 652d  unts have write-
-0000b020: 6163 6365 7373 2074 6f20 6120 7370 6563  access to a spec
-0000b030: 6966 6963 2076 6f6c 756d 652c 206f 7220  ific volume, or 
-0000b040: 6966 2060 2d2d 736d 6277 6020 6973 206e  if `--smbw` is n
-0000b050: 6f74 2073 6574 2c20 7468 656e 2077 7269  ot set, then wri
-0000b060: 7469 6e67 2074 6f20 7468 6174 2076 6f6c  ting to that vol
-0000b070: 756d 6520 6672 6f6d 2073 6d62 202a 7368  ume from smb *sh
-0000b080: 6f75 6c64 2a20 6265 2069 6d70 6f73 7369  ould* be impossi
-0000b090: 626c 650a 2020 2020 2a20 7769 6c6c 2062  ble.    * will b
-0000b0a0: 6520 6669 7865 6420 6f6e 6365 205b 696d  e fixed once [im
-0000b0b0: 7061 636b 6574 2076 302e 3131 2e30 5d28  packet v0.11.0](
-0000b0c0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0000b0d0: 6f6d 2f53 6563 7572 6541 7574 6843 6f72  om/SecureAuthCor
-0000b0e0: 702f 696d 7061 636b 6574 2f63 6f6d 6d69  p/impacket/commi
-0000b0f0: 742f 6439 3233 6330 3066 3735 6435 3462  t/d923c00f75d54b
-0000b100: 3937 3262 6361 3537 3361 3231 3161 3832  972bca573a211a82
-0000b110: 6630 3962 3535 3236 3161 2920 6973 2072  f09b55261a) is r
-0000b120: 656c 6561 7365 640a 2020 2a20 5b73 6861  eleased.  * [sha
-0000b130: 646f 7769 6e67 5d28 2373 6861 646f 7769  dowing](#shadowi
-0000b140: 6e67 2920 7072 6f62 6162 6c79 2077 6f72  ng) probably wor
-0000b150: 6b73 2061 7320 6578 7065 6374 6564 2062  ks as expected b
-0000b160: 7574 206e 6f20 6775 6172 616e 7465 6573  ut no guarantees
-0000b170: 0a0a 616e 6420 736f 6d65 206d 696e 6f72  ..and some minor
-0000b180: 2069 7373 7565 732c 0a2a 2063 6c69 656e   issues,.* clien
-0000b190: 7473 206f 6e6c 7920 7365 6520 7468 6520  ts only see the 
-0000b1a0: 6669 7273 7420 7e34 3030 2066 696c 6573  first ~400 files
-0000b1b0: 2069 6e20 6269 6720 666f 6c64 6572 733b   in big folders;
-0000b1c0: 205b 696d 7061 636b 6574 2331 3433 335d   [impacket#1433]
-0000b1d0: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-0000b1e0: 636f 6d2f 5365 6375 7265 4175 7468 436f  com/SecureAuthCo
-0000b1f0: 7270 2f69 6d70 6163 6b65 742f 6973 7375  rp/impacket/issu
-0000b200: 6573 2f31 3433 3329 0a2a 2068 6f74 2d72  es/1433).* hot-r
-0000b210: 656c 6f61 6420 6f66 2073 6572 7665 7220  eload of server 
-0000b220: 636f 6e66 6967 2028 602f 3f72 656c 6f61  config (`/?reloa
-0000b230: 643d 6366 6760 2920 646f 6573 206e 6f74  d=cfg`) does not
-0000b240: 2069 6e63 6c75 6465 2074 6865 2060 5b67   include the `[g
-0000b250: 6c6f 6261 6c5d 6020 7365 6374 696f 6e20  lobal]` section 
-0000b260: 2863 6f6d 6d61 6e64 6c69 6e65 2061 7267  (commandline arg
-0000b270: 7329 0a2a 206c 6973 7465 6e73 206f 6e20  s).* listens on 
-0000b280: 7468 6520 6669 7273 7420 4950 7634 2060  the first IPv4 `
-0000b290: 2d69 6020 696e 7465 7266 6163 6520 6f6e  -i` interface on
-0000b2a0: 6c79 2028 6465 6661 756c 7420 3d20 3a3a  ly (default = ::
-0000b2b0: 203d 2030 2e30 2e30 2e30 203d 2061 6c6c   = 0.0.0.0 = all
-0000b2c0: 290a 2a20 6c6f 6769 6e20 646f 6573 6e27  ).* login doesn'
-0000b2d0: 7420 776f 726b 206f 6e20 7769 6e78 702c  t work on winxp,
-0000b2e0: 2062 7574 2061 6e6f 6e79 6d6f 7573 2061   but anonymous a
-0000b2f0: 6363 6573 7320 6973 206f 6b20 2d2d 2072  ccess is ok -- r
-0000b300: 656d 6f76 6520 616c 6c20 6163 636f 756e  emove all accoun
-0000b310: 7473 2066 726f 6d20 636f 7079 7061 7274  ts from copypart
-0000b320: 7920 636f 6e66 6967 2066 6f72 2074 6861  y config for tha
-0000b330: 7420 746f 2077 6f72 6b0a 2020 2a20 7769  t to work.  * wi
-0000b340: 6e31 3020 6f6e 7761 7264 7320 646f 6573  n10 onwards does
-0000b350: 206e 6f74 2061 6c6c 6f77 2063 6f6e 6e65   not allow conne
-0000b360: 6374 696e 6720 616e 6f6e 796d 6f75 736c  cting anonymousl
-0000b370: 7920 2f20 7769 7468 6f75 7420 6163 636f  y / without acco
-0000b380: 756e 7473 0a2a 206f 6e20 7769 6e64 6f77  unts.* on window
-0000b390: 732c 2063 7265 6174 696e 6720 6120 6e65  s, creating a ne
-0000b3a0: 7720 6669 6c65 2074 6872 6f75 6768 2072  w file through r
-0000b3b0: 6967 6874 636c 6963 6b20 2d2d 3e20 6e65  ightclick --> ne
-0000b3c0: 7720 2d2d 3e20 7465 7874 6669 6c65 2074  w --> textfile t
-0000b3d0: 6872 6f77 7320 616e 2065 7272 6f72 2064  hrows an error d
-0000b3e0: 7565 2074 6f20 696d 7061 636b 6574 206c  ue to impacket l
-0000b3f0: 696d 6974 6174 696f 6e73 202d 2d20 6869  imitations -- hi
-0000b400: 7420 4f4b 2061 6e64 2046 3520 746f 2067  t OK and F5 to g
-0000b410: 6574 2079 6f75 7220 6669 6c65 0a2a 2070  et your file.* p
-0000b420: 7974 686f 6e33 206f 6e6c 790a 2a20 736c  ython3 only.* sl
-0000b430: 6f77 0a0a 6b6e 6f77 6e20 636c 6965 6e74  ow..known client
-0000b440: 2062 7567 733a 0a2a 206f 6e20 7769 6e37   bugs:.* on win7
-0000b450: 206f 6e6c 792c 2060 2d2d 736d 6231 6020   only, `--smb1` 
-0000b460: 6973 206d 7563 6820 6661 7374 6572 2074  is much faster t
-0000b470: 6861 6e20 736d 6232 2028 6465 6661 756c  han smb2 (defaul
-0000b480: 7429 2062 6563 6175 7365 2069 7420 6b65  t) because it ke
-0000b490: 6570 7320 7265 7363 616e 6e69 6e67 2066  eps rescanning f
-0000b4a0: 6f6c 6465 7273 206f 6e20 736d 6232 0a20  olders on smb2. 
-0000b4b0: 202a 2068 6f77 6576 6572 2073 6d62 3120   * however smb1 
-0000b4c0: 6973 2062 7567 6779 2061 6e64 2069 7320  is buggy and is 
-0000b4d0: 6e6f 7420 656e 6162 6c65 6420 6279 2064  not enabled by d
-0000b4e0: 6566 6175 6c74 206f 6e20 7769 6e31 3020  efault on win10 
-0000b4f0: 6f6e 7761 7264 730a 2a20 7769 6e64 6f77  onwards.* window
-0000b500: 7320 6361 6e6e 6f74 2061 6363 6573 7320  s cannot access 
-0000b510: 666f 6c64 6572 7320 7768 6963 6820 636f  folders which co
-0000b520: 6e74 6169 6e20 6669 6c65 6e61 6d65 7320  ntain filenames 
-0000b530: 7769 7468 2069 6e76 616c 6964 2075 6e69  with invalid uni
-0000b540: 636f 6465 206f 7220 666f 7262 6964 6465  code or forbidde
-0000b550: 6e20 6368 6172 6163 7465 7273 2028 603c  n characters (`<
-0000b560: 3e3a 222f 5c7c 3f2a 6029 2c20 6f72 206e  >:"/\|?*`), or n
-0000b570: 616d 6573 2065 6e64 696e 6720 7769 7468  ames ending with
-0000b580: 2060 2e60 0a0a 7468 6520 736d 6220 7072   `.`..the smb pr
-0000b590: 6f74 6f63 6f6c 206c 6973 7465 6e73 206f  otocol listens o
-0000b5a0: 6e20 5443 5020 706f 7274 2034 3435 2c20  n TCP port 445, 
-0000b5b0: 7768 6963 6820 6973 2061 2070 7269 7669  which is a privi
-0000b5c0: 6c65 6765 6420 706f 7274 206f 6e20 6c69  leged port on li
-0000b5d0: 6e75 7820 616e 6420 6d61 636f 732c 2077  nux and macos, w
-0000b5e0: 6869 6368 2077 6f75 6c64 2072 6571 7569  hich would requi
-0000b5f0: 7265 2072 756e 6e69 6e67 2063 6f70 7970  re running copyp
-0000b600: 6172 7479 2061 7320 726f 6f74 2e20 486f  arty as root. Ho
-0000b610: 7765 7665 722c 2074 6869 7320 6361 6e20  wever, this can 
-0000b620: 6265 2061 766f 6964 6564 2062 7920 6c69  be avoided by li
-0000b630: 7374 656e 696e 6720 6f6e 2061 6e6f 7468  stening on anoth
-0000b640: 6572 2070 6f72 7420 7573 696e 6720 602d  er port using `-
-0000b650: 2d73 6d62 2d70 6f72 7420 3339 3435 6020  -smb-port 3945` 
-0000b660: 616e 6420 7468 656e 2075 7369 6e67 204e  and then using N
-0000b670: 4154 2074 6f20 666f 7277 6172 6420 7468  AT to forward th
-0000b680: 6520 7472 6166 6669 6320 6672 6f6d 2034  e traffic from 4
-0000b690: 3435 2074 6f20 7468 6572 653b 0a2a 206f  45 to there;.* o
-0000b6a0: 6e20 6c69 6e75 783a 2060 6970 7461 626c  n linux: `iptabl
-0000b6b0: 6573 202d 7420 6e61 7420 2d41 2050 5245  es -t nat -A PRE
-0000b6c0: 524f 5554 494e 4720 2d69 2065 7468 3020  ROUTING -i eth0 
-0000b6d0: 2d70 2074 6370 202d 2d64 706f 7274 2034  -p tcp --dport 4
-0000b6e0: 3435 202d 6a20 5245 4449 5245 4354 202d  45 -j REDIRECT -
-0000b6f0: 2d74 6f2d 706f 7274 2033 3934 3560 0a0a  -to-port 3945`..
-0000b700: 6175 7468 656e 7469 6361 7465 2077 6974  authenticate wit
-0000b710: 6820 6f6e 6520 6f66 2074 6865 2066 6f6c  h one of the fol
-0000b720: 6c6f 7769 6e67 3a0a 2a20 7573 6572 6e61  lowing:.* userna
-0000b730: 6d65 2060 2475 7365 726e 616d 6560 2c20  me `$username`, 
-0000b740: 7061 7373 776f 7264 2060 2470 6173 7377  password `$passw
-0000b750: 6f72 6460 0a2a 2075 7365 726e 616d 6520  ord`.* username 
-0000b760: 6024 7061 7373 776f 7264 602c 2070 6173  `$password`, pas
-0000b770: 7377 6f72 6420 606b 600a 0a0a 2323 2066  sword `k`...## f
-0000b780: 696c 6520 696e 6465 7869 6e67 0a0a 656e  ile indexing..en
-0000b790: 6162 6c65 7320 6465 6475 7020 616e 6420  ables dedup and 
-0000b7a0: 6d75 7369 6320 7365 6172 6368 202b 2b0a  music search ++.
-0000b7b0: 0a66 696c 6520 696e 6465 7869 6e67 2072  .file indexing r
-0000b7c0: 656c 6965 7320 6f6e 2074 776f 2064 6174  elies on two dat
-0000b7d0: 6162 6173 6520 7461 626c 6573 2c20 7468  abase tables, th
-0000b7e0: 6520 7570 326b 2066 696c 6574 7265 6520  e up2k filetree 
-0000b7f0: 2860 2d65 3264 6029 2061 6e64 2074 6865  (`-e2d`) and the
-0000b800: 206d 6574 6164 6174 6120 7461 6773 2028   metadata tags (
-0000b810: 602d 6532 7460 292c 2073 746f 7265 6420  `-e2t`), stored 
-0000b820: 696e 2060 2e68 6973 742f 7570 326b 2e64  in `.hist/up2k.d
-0000b830: 6260 2e20 436f 6e66 6967 7572 6174 696f  b`. Configuratio
-0000b840: 6e20 6361 6e20 6265 2064 6f6e 6520 7468  n can be done th
-0000b850: 726f 7567 6820 6172 6775 6d65 6e74 732c  rough arguments,
-0000b860: 2076 6f6c 666c 6167 732c 206f 7220 6120   volflags, or a 
-0000b870: 6d69 7820 6f66 2062 6f74 682e 0a0a 7468  mix of both...th
-0000b880: 726f 7567 6820 6172 6775 6d65 6e74 733a  rough arguments:
-0000b890: 0a2a 2060 2d65 3264 6020 656e 6162 6c65  .* `-e2d` enable
-0000b8a0: 7320 6669 6c65 2069 6e64 6578 696e 6720  s file indexing 
-0000b8b0: 6f6e 2075 706c 6f61 640a 2a20 602d 6532  on upload.* `-e2
-0000b8c0: 6473 6020 616c 736f 2073 6361 6e73 2077  ds` also scans w
-0000b8d0: 7269 7461 626c 6520 666f 6c64 6572 7320  ritable folders 
-0000b8e0: 666f 7220 6e65 7720 6669 6c65 7320 6f6e  for new files on
-0000b8f0: 2073 7461 7274 7570 0a2a 2060 2d65 3264   startup.* `-e2d
-0000b900: 7361 6020 616c 736f 2073 6361 6e73 2061  sa` also scans a
-0000b910: 6c6c 206d 6f75 6e74 6564 2076 6f6c 756d  ll mounted volum
-0000b920: 6573 2028 696e 636c 7564 696e 6720 7265  es (including re
-0000b930: 6164 6f6e 6c79 206f 6e65 7329 0a2a 2060  adonly ones).* `
-0000b940: 2d65 3274 6020 656e 6162 6c65 7320 6d65  -e2t` enables me
-0000b950: 7461 6461 7461 2069 6e64 6578 696e 6720  tadata indexing 
-0000b960: 6f6e 2075 706c 6f61 640a 2a20 602d 6532  on upload.* `-e2
-0000b970: 7473 6020 616c 736f 2073 6361 6e73 2066  ts` also scans f
-0000b980: 6f72 2074 6167 7320 696e 2061 6c6c 2066  or tags in all f
-0000b990: 696c 6573 2074 6861 7420 646f 6e27 7420  iles that don't 
-0000b9a0: 6861 7665 2074 6167 7320 7965 740a 2a20  have tags yet.* 
-0000b9b0: 602d 6532 7473 7260 2061 6c73 6f20 6465  `-e2tsr` also de
-0000b9c0: 6c65 7465 7320 616c 6c20 6578 6973 7469  letes all existi
-0000b9d0: 6e67 2074 6167 732c 2064 6f69 6e67 2061  ng tags, doing a
-0000b9e0: 2066 756c 6c20 7265 696e 6465 780a 2a20   full reindex.* 
-0000b9f0: 602d 6532 7660 2076 6572 6669 6573 2066  `-e2v` verfies f
-0000ba00: 696c 6520 696e 7465 6772 6974 7920 6174  ile integrity at
-0000ba10: 2073 7461 7274 7570 2c20 636f 6d70 6172   startup, compar
-0000ba20: 696e 6720 6861 7368 6573 2066 726f 6d20  ing hashes from 
-0000ba30: 7468 6520 6462 0a2a 2060 2d65 3276 7560  the db.* `-e2vu`
-0000ba40: 2070 6174 6368 6573 2074 6865 2064 6174   patches the dat
-0000ba50: 6162 6173 6520 7769 7468 2074 6865 206e  abase with the n
-0000ba60: 6577 2068 6173 6865 7320 6672 6f6d 2074  ew hashes from t
-0000ba70: 6865 2066 696c 6573 7973 7465 6d0a 2a20  he filesystem.* 
-0000ba80: 602d 6532 7670 6020 7061 6e69 6373 2061  `-e2vp` panics a
-0000ba90: 6e64 206b 696c 6c73 2063 6f70 7970 6172  nd kills copypar
-0000baa0: 7479 2069 6e73 7465 6164 0a2a 2060 2d2d  ty instead.* `--
-0000bab0: 786c 696e 6b60 2065 6e61 626c 6573 2064  xlink` enables d
-0000bac0: 6564 7570 6c69 6361 7469 6f6e 2061 6372  eduplication acr
-0000bad0: 6f73 7320 766f 6c75 6d65 730a 0a74 6865  oss volumes..the
-0000bae0: 2073 616d 6520 6172 6775 6d65 6e74 7320   same arguments 
-0000baf0: 6361 6e20 6265 2073 6574 2061 7320 766f  can be set as vo
-0000bb00: 6c66 6c61 6773 2c20 696e 2061 6464 6974  lflags, in addit
-0000bb10: 696f 6e20 746f 2060 6432 6460 2c20 6064  ion to `d2d`, `d
-0000bb20: 3264 7360 2c20 6064 3274 602c 2060 6432  2ds`, `d2t`, `d2
-0000bb30: 7473 602c 2060 6432 7660 2066 6f72 2064  ts`, `d2v` for d
-0000bb40: 6973 6162 6c69 6e67 3a0a 2a20 602d 7620  isabling:.* `-v 
-0000bb50: 7e2f 6d75 7369 633a 3a72 3a63 2c65 3264  ~/music::r:c,e2d
-0000bb60: 7361 2c65 3274 7372 6020 646f 6573 2061  sa,e2tsr` does a
-0000bb70: 2066 756c 6c20 7265 696e 6465 7820 6f66   full reindex of
-0000bb80: 2065 7665 7279 7468 696e 6720 6f6e 2073   everything on s
-0000bb90: 7461 7274 7570 0a2a 2060 2d76 207e 2f6d  tartup.* `-v ~/m
-0000bba0: 7573 6963 3a3a 723a 632c 6432 6460 2064  usic::r:c,d2d` d
-0000bbb0: 6973 6162 6c65 7320 2a2a 616c 6c2a 2a20  isables **all** 
-0000bbc0: 696e 6465 7869 6e67 2c20 6576 656e 2069  indexing, even i
-0000bbd0: 6620 616e 7920 602d 6532 2a60 2061 7265  f any `-e2*` are
-0000bbe0: 206f 6e0a 2a20 602d 7620 7e2f 6d75 7369   on.* `-v ~/musi
-0000bbf0: 633a 3a72 3a63 2c64 3274 6020 6469 7361  c::r:c,d2t` disa
-0000bc00: 626c 6573 2061 6c6c 2060 2d65 3274 2a60  bles all `-e2t*`
-0000bc10: 2028 7461 6773 292c 2064 6f65 7320 6e6f   (tags), does no
-0000bc20: 7420 6166 6665 6374 2060 2d65 3264 2a60  t affect `-e2d*`
-0000bc30: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
-0000bc40: 723a 632c 6432 6473 6020 6469 7361 626c  r:c,d2ds` disabl
-0000bc50: 6573 206f 6e2d 626f 6f74 2073 6361 6e73  es on-boot scans
-0000bc60: 3b20 6f6e 6c79 2069 6e64 6578 206e 6577  ; only index new
-0000bc70: 2075 706c 6f61 6473 0a2a 2060 2d76 207e   uploads.* `-v ~
-0000bc80: 2f6d 7573 6963 3a3a 723a 632c 6432 7473  /music::r:c,d2ts
-0000bc90: 6020 7361 6d65 2065 7863 6570 7420 6f6e  ` same except on
-0000bca0: 6c79 2061 6666 6563 7469 6e67 2074 6167  ly affecting tag
-0000bcb0: 730a 0a6e 6f74 653a 0a2a 2074 6865 2070  s..note:.* the p
-0000bcc0: 6172 7365 7220 6361 6e20 6669 6e61 6c6c  arser can finall
-0000bcd0: 7920 6861 6e64 6c65 2060 632c 6532 6473  y handle `c,e2ds
-0000bce0: 612c 6532 7473 7260 2073 6f20 796f 7520  a,e2tsr` so you 
-0000bcf0: 6e6f 206c 6f6e 6765 7220 6861 7665 2074  no longer have t
-0000bd00: 6f20 6063 2c65 3264 7361 3a63 2c65 3274  o `c,e2dsa:c,e2t
-0000bd10: 7372 600a 2a20 6065 3274 7372 6020 6973  sr`.* `e2tsr` is
-0000bd20: 2070 726f 6261 626c 7920 616c 7761 7973   probably always
-0000bd30: 206f 7665 726b 696c 6c2c 2073 696e 6365   overkill, since
-0000bd40: 2060 6532 6473 602f 6065 3264 7361 6020   `e2ds`/`e2dsa` 
-0000bd50: 776f 756c 6420 7069 636b 2075 7020 616e  would pick up an
-0000bd60: 7920 6669 6c65 206d 6f64 6966 6963 6174  y file modificat
-0000bd70: 696f 6e73 2061 6e64 2060 6532 7473 6020  ions and `e2ts` 
-0000bd80: 776f 756c 6420 7468 656e 2072 6569 6e64  would then reind
-0000bd90: 6578 2074 686f 7365 2c20 756e 6c65 7373  ex those, unless
-0000bda0: 2074 6865 7265 2069 7320 6120 6e65 7720   there is a new 
-0000bdb0: 636f 7079 7061 7274 7920 7665 7273 696f  copyparty versio
-0000bdc0: 6e20 7769 7468 206e 6577 2070 6172 7365  n with new parse
-0000bdd0: 7273 2061 6e64 2074 6865 2072 656c 6561  rs and the relea
-0000bde0: 7365 206e 6f74 6520 7361 7973 206f 7468  se note says oth
-0000bdf0: 6572 7769 7365 0a2a 2074 6865 2072 6573  erwise.* the res
-0000be00: 6361 6e20 6275 7474 6f6e 2069 6e20 7468  can button in th
-0000be10: 6520 6164 6d69 6e20 7061 6e65 6c20 6861  e admin panel ha
-0000be20: 7320 6e6f 2065 6666 6563 7420 756e 6c65  s no effect unle
-0000be30: 7373 2074 6865 2076 6f6c 756d 6520 6861  ss the volume ha
-0000be40: 7320 602d 6532 6473 6020 6f72 2068 6967  s `-e2ds` or hig
-0000be50: 6865 720a 2a20 6465 6475 706c 6963 6174  her.* deduplicat
-0000be60: 696f 6e20 6973 2070 6f73 7369 626c 6520  ion is possible 
-0000be70: 6f6e 2077 696e 646f 7773 2069 6620 796f  on windows if yo
-0000be80: 7520 7275 6e20 636f 7079 7061 7274 7920  u run copyparty 
-0000be90: 6173 2061 646d 696e 6973 7472 6174 6f72  as administrator
-0000bea0: 2028 6e6f 7420 7361 7969 6e67 2079 6f75   (not saying you
-0000beb0: 2073 686f 756c 6421 290a 0a23 2323 2065   should!)..### e
-0000bec0: 7863 6c75 6465 2d70 6174 7465 726e 730a  xclude-patterns.
-0000bed0: 0a74 6f20 7361 7665 2073 6f6d 6520 7469  .to save some ti
-0000bee0: 6d65 2c20 2079 6f75 2063 616e 2070 726f  me,  you can pro
-0000bef0: 7669 6465 2061 2072 6567 6578 2070 6174  vide a regex pat
-0000bf00: 7465 726e 2066 6f72 2066 696c 6570 6174  tern for filepat
-0000bf10: 6873 2074 6f20 6f6e 6c79 2069 6e64 6578  hs to only index
-0000bf20: 2062 7920 6669 6c65 6e61 6d65 2f70 6174   by filename/pat
-0000bf30: 682f 7369 7a65 2f6c 6173 742d 6d6f 6469  h/size/last-modi
-0000bf40: 6669 6564 2028 616e 6420 6e6f 7420 7468  fied (and not th
-0000bf50: 6520 6861 7368 206f 6620 7468 6520 6669  e hash of the fi
-0000bf60: 6c65 2063 6f6e 7465 6e74 7329 2062 7920  le contents) by 
-0000bf70: 7365 7474 696e 6720 602d 2d6e 6f2d 6861  setting `--no-ha
-0000bf80: 7368 205c 2e69 736f 2460 206f 7220 7468  sh \.iso$` or th
-0000bf90: 6520 766f 6c66 6c61 6720 603a 632c 6e6f  e volflag `:c,no
-0000bfa0: 6861 7368 3d5c 2e69 736f 2460 2c20 7468  hash=\.iso$`, th
-0000bfb0: 6973 2068 6173 2074 6865 2066 6f6c 6c6f  is has the follo
-0000bfc0: 7769 6e67 2063 6f6e 7365 7175 656e 6365  wing consequence
-0000bfd0: 733a 0a2a 2069 6e69 7469 616c 2069 6e64  s:.* initial ind
-0000bfe0: 6578 696e 6720 6973 2077 6179 2066 6173  exing is way fas
-0000bff0: 7465 722c 2065 7370 6563 6961 6c6c 7920  ter, especially 
-0000c000: 7768 656e 2074 6865 2076 6f6c 756d 6520  when the volume 
-0000c010: 6973 206f 6e20 6120 6e65 7477 6f72 6b20  is on a network 
-0000c020: 6469 736b 0a2a 206d 616b 6573 2069 7420  disk.* makes it 
-0000c030: 696d 706f 7373 6962 6c65 2074 6f20 5b66  impossible to [f
-0000c040: 696c 652d 7365 6172 6368 5d28 2366 696c  ile-search](#fil
-0000c050: 652d 7365 6172 6368 290a 2a20 6966 2073  e-search).* if s
-0000c060: 6f6d 656f 6e65 2075 706c 6f61 6473 2074  omeone uploads t
-0000c070: 6865 2073 616d 6520 6669 6c65 2063 6f6e  he same file con
-0000c080: 7465 6e74 732c 2074 6865 2075 706c 6f61  tents, the uploa
-0000c090: 6420 7769 6c6c 206e 6f74 2062 6520 6465  d will not be de
-0000c0a0: 7465 6374 6564 2061 7320 6120 6475 7065  tected as a dupe
-0000c0b0: 2c20 736f 2069 7420 7769 6c6c 206e 6f74  , so it will not
-0000c0c0: 2067 6574 2073 796d 6c69 6e6b 6564 206f   get symlinked o
-0000c0d0: 7220 7265 6a65 6374 6564 0a0a 7369 6d69  r rejected..simi
-0000c0e0: 6c61 726c 792c 2079 6f75 2063 616e 2066  larly, you can f
-0000c0f0: 756c 6c79 2069 676e 6f72 6520 6669 6c65  ully ignore file
-0000c100: 732f 666f 6c64 6572 7320 7573 696e 6720  s/folders using 
-0000c110: 602d 2d6e 6f2d 6964 7820 5b2e 2e2e 5d60  `--no-idx [...]`
-0000c120: 2061 6e64 2060 3a63 2c6e 6f69 6478 3d5c   and `:c,noidx=\
-0000c130: 2e69 736f 2460 0a0a 6966 2079 6f75 2073  .iso$`..if you s
-0000c140: 6574 2060 2d2d 6e6f 2d68 6173 6820 5b2e  et `--no-hash [.
-0000c150: 2e2e 5d60 2067 6c6f 6261 6c6c 792c 2079  ..]` globally, y
-0000c160: 6f75 2063 616e 2065 6e61 626c 6520 6861  ou can enable ha
-0000c170: 7368 696e 6720 666f 7220 7370 6563 6966  shing for specif
-0000c180: 6963 2076 6f6c 756d 6573 2075 7369 6e67  ic volumes using
-0000c190: 2066 6c61 6720 603a 632c 6e6f 6861 7368   flag `:c,nohash
-0000c1a0: 3d60 0a0a 2323 2320 6669 6c65 7379 7374  =`..### filesyst
-0000c1b0: 656d 2067 7561 7264 730a 0a61 766f 6964  em guards..avoid
-0000c1c0: 2074 7261 7665 7273 696e 6720 696e 746f   traversing into
-0000c1d0: 206f 7468 6572 2066 696c 6573 7973 7465   other filesyste
-0000c1e0: 6d73 2020 7573 696e 6720 602d 2d78 6465  ms  using `--xde
-0000c1f0: 7660 202f 2076 6f6c 666c 6167 2060 3a63  v` / volflag `:c
-0000c200: 2c78 6465 7660 2c20 736b 6970 7069 6e67  ,xdev`, skipping
-0000c210: 2061 6e79 2073 796d 6c69 6e6b 7320 6f72   any symlinks or
-0000c220: 2062 696e 642d 6d6f 756e 7473 2074 6f20   bind-mounts to 
-0000c230: 616e 6f74 6865 7220 4844 4420 666f 7220  another HDD for 
-0000c240: 6578 616d 706c 650a 0a61 6e64 2f6f 7220  example..and/or 
-0000c250: 796f 7520 6361 6e20 602d 2d78 766f 6c60  you can `--xvol`
-0000c260: 202f 2060 3a63 2c78 766f 6c60 2074 6f20   / `:c,xvol` to 
-0000c270: 6967 6e6f 7265 2061 6c6c 2073 796d 6c69  ignore all symli
-0000c280: 6e6b 7320 6c65 6176 696e 6720 7468 6520  nks leaving the 
-0000c290: 766f 6c75 6d65 2773 2074 6f70 2064 6972  volume's top dir
-0000c2a0: 6563 746f 7279 2c20 6275 7420 7374 696c  ectory, but stil
-0000c2b0: 6c20 616c 6c6f 7720 6269 6e64 2d6d 6f75  l allow bind-mou
-0000c2c0: 6e74 7320 706f 696e 7469 6e67 2065 6c73  nts pointing els
-0000c2d0: 6577 6865 7265 0a0a 2a2a 4e42 3a20 6f6e  ewhere..**NB: on
-0000c2e0: 6c79 2061 6666 6563 7473 2074 6865 2069  ly affects the i
-0000c2f0: 6e64 6578 6572 2a2a 202d 2d20 7573 6572  ndexer** -- user
-0000c300: 7320 6361 6e20 7374 696c 6c20 6163 6365  s can still acce
-0000c310: 7373 2061 6e79 7468 696e 6720 696e 7369  ss anything insi
-0000c320: 6465 2061 2076 6f6c 756d 652c 2075 6e6c  de a volume, unl
-0000c330: 6573 7320 7368 6164 6f77 6564 2062 7920  ess shadowed by 
-0000c340: 616e 6f74 6865 7220 766f 6c75 6d65 0a0a  another volume..
-0000c350: 2323 2320 7065 7269 6f64 6963 2072 6573  ### periodic res
-0000c360: 6361 6e0a 0a66 696c 6573 7973 7465 6d20  can..filesystem 
-0000c370: 6d6f 6e69 746f 7269 6e67 3b20 2069 6620  monitoring;  if 
-0000c380: 636f 7079 7061 7274 7920 6973 206e 6f74  copyparty is not
-0000c390: 2074 6865 206f 6e6c 7920 736f 6674 7761   the only softwa
-0000c3a0: 7265 2064 6f69 6e67 2073 7475 6666 206f  re doing stuff o
-0000c3b0: 6e20 796f 7572 2066 696c 6573 7973 7465  n your filesyste
-0000c3c0: 6d2c 2079 6f75 206d 6179 2077 616e 7420  m, you may want 
-0000c3d0: 746f 2065 6e61 626c 6520 7065 7269 6f64  to enable period
-0000c3e0: 6963 2072 6573 6361 6e73 2074 6f20 6b65  ic rescans to ke
-0000c3f0: 6570 2074 6865 2069 6e64 6578 2075 7020  ep the index up 
-0000c400: 746f 2064 6174 650a 0a61 7267 756d 656e  to date..argumen
-0000c410: 7420 602d 2d72 652d 6d61 7861 6765 2036  t `--re-maxage 6
-0000c420: 3060 2077 696c 6c20 7265 7363 616e 2061  0` will rescan a
-0000c430: 6c6c 2076 6f6c 756d 6573 2065 7665 7279  ll volumes every
-0000c440: 2036 3020 7365 632c 2073 616d 6520 6173   60 sec, same as
-0000c450: 2076 6f6c 666c 6167 2060 3a63 2c73 6361   volflag `:c,sca
-0000c460: 6e3d 3630 6020 746f 2073 7065 6369 6679  n=60` to specify
-0000c470: 2069 7420 7065 722d 766f 6c75 6d65 0a0a   it per-volume..
-0000c480: 7570 6c6f 6164 7320 6172 6520 6469 7361  uploads are disa
-0000c490: 626c 6564 2077 6869 6c65 2061 2072 6573  bled while a res
-0000c4a0: 6361 6e20 6973 2068 6170 7065 6e69 6e67  can is happening
-0000c4b0: 2c20 736f 2072 6573 6361 6e73 2077 696c  , so rescans wil
-0000c4c0: 6c20 6265 2064 656c 6179 6564 2062 7920  l be delayed by 
-0000c4d0: 602d 2d64 622d 6163 7460 2028 6465 6661  `--db-act` (defa
-0000c4e0: 756c 7420 3130 2073 6563 2920 7768 656e  ult 10 sec) when
-0000c4f0: 2074 6865 7265 2069 7320 7772 6974 652d   there is write-
-0000c500: 6163 7469 7669 7479 2067 6f69 6e67 206f  activity going o
-0000c510: 6e20 2875 706c 6f61 6473 2c20 7265 6e61  n (uploads, rena
-0000c520: 6d65 732c 202e 2e2e 290a 0a0a 2323 2075  mes, ...)...## u
-0000c530: 706c 6f61 6420 7275 6c65 730a 0a73 6574  pload rules..set
-0000c540: 2075 706c 6f61 6420 7275 6c65 7320 7573   upload rules us
-0000c550: 696e 6720 766f 6c66 6c61 6773 2c20 2073  ing volflags,  s
-0000c560: 6f6d 6520 6578 616d 706c 6573 3a0a 0a2a  ome examples:..*
-0000c570: 2060 3a63 2c73 7a3d 316b 2d33 6d60 2073   `:c,sz=1k-3m` s
-0000c580: 6574 7320 616c 6c6f 7765 6420 6669 6c65  ets allowed file
-0000c590: 7369 7a65 2062 6574 7765 656e 2031 204b  size between 1 K
-0000c5a0: 6942 2061 6e64 2033 204d 6942 2069 6e63  iB and 3 MiB inc
-0000c5b0: 6c75 7369 7665 2028 7375 6666 6978 6573  lusive (suffixes
-0000c5c0: 3a20 6062 602c 2060 6b60 2c20 606d 602c  : `b`, `k`, `m`,
-0000c5d0: 2060 6760 290a 2a20 603a 632c 6466 3d34   `g`).* `:c,df=4
-0000c5e0: 6760 2062 6c6f 636b 2075 706c 6f61 6473  g` block uploads
-0000c5f0: 2069 6620 7468 6572 6520 776f 756c 6420   if there would 
-0000c600: 6265 206c 6573 7320 7468 616e 2034 2047  be less than 4 G
-0000c610: 6942 2066 7265 6520 6469 736b 2073 7061  iB free disk spa
-0000c620: 6365 2061 6674 6572 7761 7264 730a 2a20  ce afterwards.* 
-0000c630: 603a 632c 6e6f 7375 6260 2064 6973 616c  `:c,nosub` disal
-0000c640: 6c6f 7720 7570 6c6f 6164 696e 6720 696e  low uploading in
-0000c650: 746f 2073 7562 6469 7265 6374 6f72 6965  to subdirectorie
-0000c660: 733b 2067 6f65 7320 7765 6c6c 2077 6974  s; goes well wit
-0000c670: 6820 6072 6f74 6e60 2061 6e64 2060 726f  h `rotn` and `ro
-0000c680: 7466 603a 0a2a 2060 3a63 2c72 6f74 6e3d  tf`:.* `:c,rotn=
-0000c690: 3130 3030 2c32 6020 6d6f 7665 7320 7570  1000,2` moves up
-0000c6a0: 6c6f 6164 7320 696e 746f 2073 7562 666f  loads into subfo
-0000c6b0: 6c64 6572 732c 2075 7020 746f 2031 3030  lders, up to 100
-0000c6c0: 3020 6669 6c65 7320 696e 2065 6163 6820  0 files in each 
-0000c6d0: 666f 6c64 6572 2062 6566 6f72 6520 6d61  folder before ma
-0000c6e0: 6b69 6e67 2061 206e 6577 206f 6e65 2c20  king a new one, 
-0000c6f0: 7477 6f20 6c65 7665 6c73 2064 6565 7020  two levels deep 
-0000c700: 286d 7573 7420 6265 2061 7420 6c65 6173  (must be at leas
-0000c710: 7420 3129 0a2a 2060 3a63 2c72 6f74 663d  t 1).* `:c,rotf=
-0000c720: 2559 2f25 6d2f 2564 2f25 4860 2065 6e66  %Y/%m/%d/%H` enf
-0000c730: 6f72 6365 7320 6669 6c65 7320 746f 2062  orces files to b
-0000c740: 6520 7570 6c6f 6164 6564 2069 6e74 6f20  e uploaded into 
-0000c750: 6120 7374 7275 6374 7572 6520 6f66 2073  a structure of s
-0000c760: 7562 666f 6c64 6572 7320 6163 636f 7264  ubfolders accord
-0000c770: 696e 6720 746f 2074 6861 7420 6461 7465  ing to that date
-0000c780: 2066 6f72 6d61 740a 2020 2a20 6966 2073   format.  * if s
-0000c790: 6f6d 656f 6e65 2075 706c 6f61 6473 2074  omeone uploads t
-0000c7a0: 6f20 602f 666f 6f2f 6261 7260 2074 6865  o `/foo/bar` the
-0000c7b0: 2070 6174 6820 776f 756c 6420 6265 2072   path would be r
-0000c7c0: 6577 7269 7474 656e 2074 6f20 602f 666f  ewritten to `/fo
-0000c7d0: 6f2f 6261 722f 3230 3231 2f30 382f 3036  o/bar/2021/08/06
-0000c7e0: 2f32 3360 2066 6f72 2065 7861 6d70 6c65  /23` for example
-0000c7f0: 0a20 202a 2062 7574 2074 6865 2061 6374  .  * but the act
-0000c800: 7561 6c20 7661 6c75 6520 6973 206e 6f74  ual value is not
-0000c810: 2076 6572 6966 6965 642c 206a 7573 7420   verified, just 
-0000c820: 7468 6520 7374 7275 6374 7572 652c 2073  the structure, s
-0000c830: 6f20 7468 6520 7570 6c6f 6164 6572 2063  o the uploader c
-0000c840: 616e 2063 686f 6f73 6520 616e 7920 7661  an choose any va
-0000c850: 6c75 6573 2077 6869 6368 2063 6f6e 666f  lues which confo
-0000c860: 726d 2074 6f20 7468 6520 666f 726d 6174  rm to the format
-0000c870: 2073 7472 696e 670a 2020 2020 2a20 6a75   string.    * ju
-0000c880: 7374 2074 6f20 6176 6f69 6420 6164 6469  st to avoid addi
-0000c890: 7469 6f6e 616c 2063 6f6d 706c 6578 6974  tional complexit
-0000c8a0: 7920 696e 2075 7032 6b20 7768 6963 6820  y in up2k which 
-0000c8b0: 6973 2065 6e6f 7567 6820 6f66 2061 206d  is enough of a m
-0000c8c0: 6573 7320 616c 7265 6164 790a 2a20 603a  ess already.* `:
-0000c8d0: 632c 6c69 6665 7469 6d65 3d33 3030 6020  c,lifetime=300` 
-0000c8e0: 6465 6c65 7465 2075 706c 6f61 6465 6420  delete uploaded 
-0000c8f0: 6669 6c65 7320 7768 656e 2074 6865 7920  files when they 
-0000c900: 6265 636f 6d65 2035 206d 696e 7574 6573  become 5 minutes
-0000c910: 206f 6c64 0a0a 796f 7520 6361 6e20 616c   old..you can al
-0000c920: 736f 2073 6574 2074 7261 6e73 6163 7469  so set transacti
-0000c930: 6f6e 206c 696d 6974 7320 7768 6963 6820  on limits which 
-0000c940: 6170 706c 7920 7065 722d 4950 2061 6e64  apply per-IP and
-0000c950: 2070 6572 2d76 6f6c 756d 652c 2062 7574   per-volume, but
-0000c960: 2074 6865 7365 2061 7373 756d 6520 602d   these assume `-
-0000c970: 6a20 3160 2028 6465 6661 756c 7429 206f  j 1` (default) o
-0000c980: 7468 6572 7769 7365 2074 6865 206c 696d  therwise the lim
-0000c990: 6974 7320 7769 6c6c 2062 6520 6f66 662c  its will be off,
-0000c9a0: 2066 6f72 2065 7861 6d70 6c65 2060 2d6a   for example `-j
-0000c9b0: 2034 6020 776f 756c 6420 616c 6c6f 7720   4` would allow 
-0000c9c0: 616e 7977 6865 7265 2062 6574 7765 656e  anywhere between
-0000c9d0: 2031 7820 616e 6420 3478 2074 6865 206c   1x and 4x the l
-0000c9e0: 696d 6974 7320 796f 7520 7365 7420 6465  imits you set de
-0000c9f0: 7065 6e64 696e 6720 6f6e 2077 6869 6368  pending on which
-0000ca00: 2070 726f 6365 7373 696e 6720 6e6f 6465   processing node
-0000ca10: 2074 6865 2063 6c69 656e 7420 6765 7473   the client gets
-0000ca20: 2072 6f75 7465 6420 746f 0a0a 2a20 603a   routed to..* `:
-0000ca30: 632c 6d61 786e 3d32 3530 2c33 3630 3060  c,maxn=250,3600`
-0000ca40: 2061 6c6c 6f77 7320 3235 3020 6669 6c65   allows 250 file
-0000ca50: 7320 6f76 6572 2031 2068 6f75 7220 6672  s over 1 hour fr
-0000ca60: 6f6d 2065 6163 6820 4950 2028 7472 6163  om each IP (trac
-0000ca70: 6b65 6420 7065 722d 766f 6c75 6d65 290a  ked per-volume).
-0000ca80: 2a20 603a 632c 6d61 7862 3d31 672c 3330  * `:c,maxb=1g,30
-0000ca90: 3060 2061 6c6c 6f77 7320 3120 4769 4220  0` allows 1 GiB 
-0000caa0: 746f 7461 6c20 6f76 6572 2035 206d 696e  total over 5 min
-0000cab0: 7574 6573 2066 726f 6d20 6561 6368 2049  utes from each I
-0000cac0: 5020 2874 7261 636b 6564 2070 6572 2d76  P (tracked per-v
-0000cad0: 6f6c 756d 6529 0a0a 0a23 2320 636f 6d70  olume)...## comp
-0000cae0: 7265 7373 2075 706c 6f61 6473 0a0a 6669  ress uploads..fi
-0000caf0: 6c65 7320 6361 6e20 6265 2061 7574 6f63  les can be autoc
-0000cb00: 6f6d 7072 6573 7365 6420 6f6e 2075 706c  ompressed on upl
-0000cb10: 6f61 642c 2020 6569 7468 6572 206f 6e20  oad,  either on 
-0000cb20: 7573 6572 2d72 6571 7565 7374 2028 6966  user-request (if
-0000cb30: 2063 6f6e 6669 6720 616c 6c6f 7773 2920   config allows) 
-0000cb40: 6f72 2066 6f72 6365 6420 6279 2073 6572  or forced by ser
-0000cb50: 7665 722d 636f 6e66 6967 0a0a 2a20 766f  ver-config..* vo
-0000cb60: 6c66 6c61 6720 6067 7a60 2061 6c6c 6f77  lflag `gz` allow
-0000cb70: 7320 677a 2063 6f6d 7072 6573 7369 6f6e  s gz compression
-0000cb80: 0a2a 2076 6f6c 666c 6167 2060 787a 6020  .* volflag `xz` 
-0000cb90: 616c 6c6f 7773 206c 7a6d 6120 636f 6d70  allows lzma comp
-0000cba0: 7265 7373 696f 6e0a 2a20 766f 6c66 6c61  ression.* volfla
-0000cbb0: 6720 6070 6b60 202a 2a66 6f72 6365 732a  g `pk` **forces*
-0000cbc0: 2a20 636f 6d70 7265 7373 696f 6e20 6f6e  * compression on
-0000cbd0: 2061 6c6c 2066 696c 6573 0a2a 2075 726c   all files.* url
-0000cbe0: 2070 6172 616d 6574 6572 2060 706b 6020   parameter `pk` 
-0000cbf0: 7265 7175 6573 7473 2063 6f6d 7072 6573  requests compres
-0000cc00: 7369 6f6e 2077 6974 6820 7365 7276 6572  sion with server
-0000cc10: 2d64 6566 6175 6c74 2061 6c67 6f72 6974  -default algorit
-0000cc20: 686d 0a2a 2075 726c 2070 6172 616d 6574  hm.* url paramet
-0000cc30: 6572 2060 677a 6020 6f72 2060 787a 6020  er `gz` or `xz` 
-0000cc40: 7265 7175 6573 7473 2063 6f6d 7072 6573  requests compres
-0000cc50: 7369 6f6e 2077 6974 6820 6120 7370 6563  sion with a spec
-0000cc60: 6966 6963 2061 6c67 6f72 6974 686d 0a2a  ific algorithm.*
-0000cc70: 2075 726c 2070 6172 616d 6574 6572 2060   url parameter `
-0000cc80: 787a 6020 7265 7175 6573 7473 2078 7a20  xz` requests xz 
-0000cc90: 636f 6d70 7265 7373 696f 6e0a 0a74 6869  compression..thi
-0000cca0: 6e67 7320 746f 206e 6f74 652c 0a2a 2074  ngs to note,.* t
-0000ccb0: 6865 2060 677a 6020 616e 6420 6078 7a60  he `gz` and `xz`
-0000ccc0: 2061 7267 756d 656e 7473 2074 616b 6520   arguments take 
-0000ccd0: 6120 7369 6e67 6c65 206f 7074 696f 6e61  a single optiona
-0000cce0: 6c20 6172 6775 6d65 6e74 2c20 7468 6520  l argument, the 
-0000ccf0: 636f 6d70 7265 7373 696f 6e20 6c65 7665  compression leve
-0000cd00: 6c20 2872 616e 6765 2030 2074 6f20 3929  l (range 0 to 9)
-0000cd10: 0a2a 2074 6865 2060 706b 6020 766f 6c66  .* the `pk` volf
-0000cd20: 6c61 6720 7461 6b65 7320 7468 6520 6f70  lag takes the op
-0000cd30: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
-0000cd40: 6041 4c47 4f52 4954 484d 2c4c 4556 454c  `ALGORITHM,LEVEL
-0000cd50: 6020 7768 6963 6820 7769 6c6c 2074 6865  ` which will the
-0000cd60: 6e20 6265 2066 6f72 6365 6420 666f 7220  n be forced for 
-0000cd70: 616c 6c20 7570 6c6f 6164 732c 2066 6f72  all uploads, for
-0000cd80: 2065 7861 6d70 6c65 2060 677a 2c39 6020   example `gz,9` 
-0000cd90: 6f72 2060 787a 2c30 600a 2a20 6465 6661  or `xz,0`.* defa
-0000cda0: 756c 7420 636f 6d70 7265 7373 696f 6e20  ult compression 
-0000cdb0: 6973 2067 7a69 7020 6c65 7665 6c20 390a  is gzip level 9.
-0000cdc0: 2a20 616c 6c20 7570 6c6f 6164 206d 6574  * all upload met
-0000cdd0: 686f 6473 2065 7863 6570 7420 7570 326b  hods except up2k
-0000cde0: 2061 7265 2073 7570 706f 7274 6564 0a2a   are supported.*
-0000cdf0: 2074 6865 2066 696c 6573 2077 696c 6c20   the files will 
-0000ce00: 6265 2069 6e64 6578 6564 2061 6674 6572  be indexed after
-0000ce10: 2063 6f6d 7072 6573 7369 6f6e 2c20 736f   compression, so
-0000ce20: 2064 7570 652d 6465 7465 6374 696f 6e20   dupe-detection 
-0000ce30: 616e 6420 6669 6c65 2d73 6561 7263 6820  and file-search 
-0000ce40: 7769 6c6c 206e 6f74 2077 6f72 6b20 6173  will not work as
-0000ce50: 2065 7870 6563 7465 640a 0a73 6f6d 6520   expected..some 
-0000ce60: 6578 616d 706c 6573 2c0a 2a20 602d 7620  examples,.* `-v 
-0000ce70: 696e 633a 696e 633a 773a 632c 706b 3d78  inc:inc:w:c,pk=x
-0000ce80: 7a2c 3060 2020 0a20 2066 6f6c 6465 7220  z,0`  .  folder 
-0000ce90: 6e61 6d65 6420 696e 632c 2073 6861 7265  named inc, share
-0000cea0: 6420 6174 2069 6e63 2c20 7772 6974 652d  d at inc, write-
-0000ceb0: 6f6e 6c79 2066 6f72 2065 7665 7279 6f6e  only for everyon
-0000cec0: 652c 2066 6f72 6365 7320 787a 2063 6f6d  e, forces xz com
-0000ced0: 7072 6573 7369 6f6e 2061 7420 6c65 7665  pression at leve
-0000cee0: 6c20 300a 2a20 602d 7620 696e 633a 696e  l 0.* `-v inc:in
-0000cef0: 633a 773a 632c 706b 6020 200a 2020 7361  c:w:c,pk`  .  sa
-0000cf00: 6d65 2077 7269 7465 2d6f 6e6c 7920 696e  me write-only in
-0000cf10: 632c 2062 7574 2066 6f72 6365 7320 677a  c, but forces gz
-0000cf20: 2063 6f6d 7072 6573 7369 6f6e 2028 6465   compression (de
-0000cf30: 6661 756c 7429 2069 6e73 7465 6164 206f  fault) instead o
-0000cf40: 6620 787a 0a2a 2060 2d76 2069 6e63 3a69  f xz.* `-v inc:i
-0000cf50: 6e63 3a77 3a63 2c67 7a60 2020 0a20 2061  nc:w:c,gz`  .  a
-0000cf60: 6c6c 6f77 7320 2862 7574 2064 6f65 7320  llows (but does 
-0000cf70: 6e6f 7420 666f 7263 6529 2067 7a20 636f  not force) gz co
-0000cf80: 6d70 7265 7373 696f 6e20 6966 2063 6c69  mpression if cli
-0000cf90: 656e 7420 7570 6c6f 6164 7320 746f 2060  ent uploads to `
-0000cfa0: 2f69 6e63 3f70 6b60 206f 7220 602f 696e  /inc?pk` or `/in
-0000cfb0: 633f 677a 6020 6f72 2060 2f69 6e63 3f67  c?gz` or `/inc?g
-0000cfc0: 7a3d 3460 0a0a 0a23 2320 6f74 6865 7220  z=4`...## other 
-0000cfd0: 666c 6167 730a 0a2a 2060 3a63 2c6d 6167  flags..* `:c,mag
-0000cfe0: 6963 6020 656e 6162 6c65 7320 6669 6c65  ic` enables file
-0000cff0: 7479 7065 2064 6574 6563 7469 6f6e 2066  type detection f
-0000d000: 6f72 206e 616d 656c 6573 7320 7570 6c6f  or nameless uplo
-0000d010: 6164 732c 2073 616d 6520 6173 2060 2d2d  ads, same as `--
-0000d020: 6d61 6769 6360 0a20 202a 206e 6565 6473  magic`.  * needs
-0000d030: 2068 7474 7073 3a2f 2f70 7970 692e 6f72   https://pypi.or
-0000d040: 672f 7072 6f6a 6563 742f 7079 7468 6f6e  g/project/python
-0000d050: 2d6d 6167 6963 2f20 6070 7974 686f 6e33  -magic/ `python3
-0000d060: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
-0000d070: 2d2d 7573 6572 202d 5520 7079 7468 6f6e  --user -U python
-0000d080: 2d6d 6167 6963 600a 2020 2a20 6f6e 2077  -magic`.  * on w
-0000d090: 696e 646f 7773 2067 7261 6220 7468 6973  indows grab this
-0000d0a0: 2069 6e73 7465 6164 2060 7079 7468 6f6e   instead `python
-0000d0b0: 3320 2d6d 2070 6970 2069 6e73 7461 6c6c  3 -m pip install
-0000d0c0: 202d 2d75 7365 7220 2d55 2070 7974 686f   --user -U pytho
-0000d0d0: 6e2d 6d61 6769 632d 6269 6e60 0a0a 0a23  n-magic-bin`...#
-0000d0e0: 2320 6461 7461 6261 7365 206c 6f63 6174  # database locat
-0000d0f0: 696f 6e0a 0a69 6e2d 766f 6c75 6d65 2028  ion..in-volume (
-0000d100: 602e 6869 7374 2f75 7032 6b2e 6462 602c  `.hist/up2k.db`,
-0000d110: 2064 6566 6175 6c74 2920 6f72 2073 6f6d   default) or som
-0000d120: 6577 6865 7265 2065 6c73 650a 0a63 6f70  ewhere else..cop
-0000d130: 7970 6172 7479 2063 7265 6174 6573 2061  yparty creates a
-0000d140: 2073 7562 666f 6c64 6572 206e 616d 6564   subfolder named
-0000d150: 2060 2e68 6973 7460 2069 6e73 6964 6520   `.hist` inside 
-0000d160: 6561 6368 2076 6f6c 756d 6520 7768 6572  each volume wher
-0000d170: 6520 6974 2073 746f 7265 7320 7468 6520  e it stores the 
-0000d180: 6461 7461 6261 7365 2c20 7468 756d 626e  database, thumbn
-0000d190: 6169 6c73 2c20 616e 6420 736f 6d65 206f  ails, and some o
-0000d1a0: 7468 6572 2073 7475 6666 0a0a 7468 6973  ther stuff..this
-0000d1b0: 2063 616e 2069 6e73 7465 6164 2062 6520   can instead be 
-0000d1c0: 6b65 7074 2069 6e20 6120 7369 6e67 6c65  kept in a single
-0000d1d0: 2070 6c61 6365 2075 7369 6e67 2074 6865   place using the
-0000d1e0: 2060 2d2d 6869 7374 6020 6172 6775 6d65   `--hist` argume
-0000d1f0: 6e74 2c20 6f72 2074 6865 2060 6869 7374  nt, or the `hist
-0000d200: 3d60 2076 6f6c 666c 6167 2c20 6f72 2061  =` volflag, or a
-0000d210: 206d 6978 206f 6620 626f 7468 3a0a 2a20   mix of both:.* 
-0000d220: 602d 2d68 6973 7420 7e2f 2e63 6163 6865  `--hist ~/.cache
-0000d230: 2f63 6f70 7970 6172 7479 202d 7620 7e2f  /copyparty -v ~/
-0000d240: 6d75 7369 633a 3a72 3a63 2c68 6973 743d  music::r:c,hist=
-0000d250: 2d60 2073 6574 7320 607e 2f2e 6361 6368  -` sets `~/.cach
-0000d260: 652f 636f 7079 7061 7274 7960 2061 7320  e/copyparty` as 
-0000d270: 7468 6520 6465 6661 756c 7420 706c 6163  the default plac
-0000d280: 6520 746f 2070 7574 2076 6f6c 756d 6520  e to put volume 
-0000d290: 696e 666f 2c20 6275 7420 607e 2f6d 7573  info, but `~/mus
-0000d2a0: 6963 6020 6765 7473 2074 6865 2072 6567  ic` gets the reg
-0000d2b0: 756c 6172 2060 2e68 6973 7460 2073 7562  ular `.hist` sub
-0000d2c0: 666f 6c64 6572 2028 602d 6020 7265 7374  folder (`-` rest
-0000d2d0: 6f72 6573 2064 6566 6175 6c74 2062 6568  ores default beh
-0000d2e0: 6176 696f 7229 0a0a 6e6f 7465 3a0a 2a20  avior)..note:.* 
-0000d2f0: 6d61 726b 646f 776e 2065 6469 7473 2061  markdown edits a
-0000d300: 7265 2061 6c77 6179 7320 7374 6f72 6564  re always stored
-0000d310: 2069 6e20 6120 6c6f 6361 6c20 602e 6869   in a local `.hi
-0000d320: 7374 6020 7375 6264 6972 6563 746f 7279  st` subdirectory
-0000d330: 0a2a 206f 6e20 7769 6e64 6f77 7320 7468  .* on windows th
-0000d340: 6520 766f 6c66 6c61 6720 7061 7468 2069  e volflag path i
-0000d350: 7320 6379 676c 696b 652c 2073 6f20 602f  s cyglike, so `/
-0000d360: 632f 7465 6d70 6020 6d65 616e 7320 6043  c/temp` means `C
-0000d370: 3a5c 7465 6d70 6020 6275 7420 7573 6520  :\temp` but use 
-0000d380: 7265 6775 6c61 7220 7061 7468 7320 666f  regular paths fo
-0000d390: 7220 602d 2d68 6973 7460 0a20 202a 2079  r `--hist`.  * y
-0000d3a0: 6f75 2063 616e 2075 7365 2063 7967 7061  ou can use cygpa
-0000d3b0: 7468 7320 666f 7220 766f 6c75 6d65 7320  ths for volumes 
-0000d3c0: 746f 6f2c 2060 2d76 2043 3a5c 5573 6572  too, `-v C:\User
-0000d3d0: 733a 3a72 6020 616e 6420 602d 7620 2f63  s::r` and `-v /c
-0000d3e0: 2f75 7365 7273 3a3a 7260 2062 6f74 6820  /users::r` both 
-0000d3f0: 776f 726b 0a0a 0a23 2320 6d65 7461 6461  work...## metada
-0000d400: 7461 2066 726f 6d20 6175 6469 6f20 6669  ta from audio fi
-0000d410: 6c65 730a 0a73 6574 2060 2d65 3274 6020  les..set `-e2t` 
-0000d420: 746f 2069 6e64 6578 2074 6167 7320 6f6e  to index tags on
-0000d430: 2075 706c 6f61 640a 0a60 2d6d 7465 6020   upload..`-mte` 
-0000d440: 6465 6369 6465 7320 7768 6963 6820 7461  decides which ta
-0000d450: 6773 2074 6f20 696e 6465 7820 616e 6420  gs to index and 
-0000d460: 6469 7370 6c61 7920 696e 2074 6865 2062  display in the b
-0000d470: 726f 7773 6572 2028 616e 6420 616c 736f  rowser (and also
-0000d480: 2074 6865 2064 6973 706c 6179 206f 7264   the display ord
-0000d490: 6572 292c 2074 6869 7320 6361 6e20 6265  er), this can be
-0000d4a0: 2063 6861 6e67 6564 2070 6572 2d76 6f6c   changed per-vol
-0000d4b0: 756d 653a 0a2a 2060 2d76 207e 2f6d 7573  ume:.* `-v ~/mus
-0000d4c0: 6963 3a3a 723a 632c 6d74 653d 7469 746c  ic::r:c,mte=titl
-0000d4d0: 652c 6172 7469 7374 6020 696e 6465 7865  e,artist` indexe
-0000d4e0: 7320 616e 6420 6469 7370 6c61 7973 202a  s and displays *
-0000d4f0: 7469 746c 652a 2066 6f6c 6c6f 7765 6420  title* followed 
-0000d500: 6279 202a 6172 7469 7374 2a0a 0a69 6620  by *artist*..if 
-0000d510: 796f 7520 6164 642f 7265 6d6f 7665 2061  you add/remove a
-0000d520: 2074 6167 2066 726f 6d20 606d 7465 6020   tag from `mte` 
-0000d530: 796f 7520 7769 6c6c 206e 6565 6420 746f  you will need to
-0000d540: 2072 756e 2077 6974 6820 602d 6532 7473   run with `-e2ts
-0000d550: 7260 206f 6e63 6520 746f 2072 6562 7569  r` once to rebui
-0000d560: 6c64 2074 6865 2064 6174 6162 6173 652c  ld the database,
-0000d570: 206f 7468 6572 7769 7365 206f 6e6c 7920   otherwise only 
-0000d580: 6e65 7720 6669 6c65 7320 7769 6c6c 2062  new files will b
-0000d590: 6520 6166 6665 6374 6564 0a0a 6275 7420  e affected..but 
-0000d5a0: 696e 7374 6561 6420 6f66 2075 7369 6e67  instead of using
-0000d5b0: 2060 2d6d 7465 602c 2060 2d6d 7468 6020   `-mte`, `-mth` 
-0000d5c0: 6973 2061 2062 6574 7465 7220 7761 7920  is a better way 
-0000d5d0: 746f 2068 6964 6520 7461 6773 2069 6e20  to hide tags in 
-0000d5e0: 7468 6520 6272 6f77 7365 723a 2074 6865  the browser: the
-0000d5f0: 7365 2074 6167 7320 7769 6c6c 206e 6f74  se tags will not
-0000d600: 2062 6520 6469 7370 6c61 7965 6420 6279   be displayed by
-0000d610: 2064 6566 6175 6c74 2c20 6275 7420 7468   default, but th
-0000d620: 6579 2073 7469 6c6c 2067 6574 2069 6e64  ey still get ind
-0000d630: 6578 6564 2061 6e64 2062 6563 6f6d 6520  exed and become 
-0000d640: 7365 6172 6368 6162 6c65 2c20 616e 6420  searchable, and 
-0000d650: 7573 6572 7320 6361 6e20 6368 6f6f 7365  users can choose
-0000d660: 2074 6f20 756e 6869 6465 2074 6865 6d20   to unhide them 
-0000d670: 696e 2074 6865 2060 5be2 9a99 efb8 8f5d  in the `[......]
-0000d680: 2063 6f6e 6669 6760 2070 616e 650a 0a60   config` pane..`
-0000d690: 2d6d 746d 6020 6361 6e20 6265 2075 7365  -mtm` can be use
-0000d6a0: 6420 746f 2061 6464 206f 7220 7265 6465  d to add or rede
-0000d6b0: 6669 6e65 2061 206d 6574 6164 6174 6120  fine a metadata 
-0000d6c0: 6d61 7070 696e 672c 2073 6179 2079 6f75  mapping, say you
-0000d6d0: 2068 6176 6520 6d65 6469 6120 6669 6c65   have media file
-0000d6e0: 7320 7769 7468 2060 666f 6f60 2061 6e64  s with `foo` and
-0000d6f0: 2060 6261 7260 2074 6167 7320 616e 6420   `bar` tags and 
-0000d700: 796f 7520 7761 6e74 2074 6865 6d20 746f  you want them to
-0000d710: 2064 6973 706c 6179 2061 7320 6071 7578   display as `qux
-0000d720: 6020 696e 2074 6865 2062 726f 7773 6572  ` in the browser
-0000d730: 2028 7072 6566 6572 7269 6e67 2060 666f   (preferring `fo
-0000d740: 6f60 2069 6620 626f 7468 2061 7265 2070  o` if both are p
-0000d750: 7265 7365 6e74 292c 2074 6865 6e20 646f  resent), then do
-0000d760: 2060 2d6d 746d 2071 7578 3d66 6f6f 2c62   `-mtm qux=foo,b
-0000d770: 6172 6020 616e 6420 6e6f 7720 796f 7520  ar` and now you 
-0000d780: 6361 6e20 602d 6d74 6520 6172 7469 7374  can `-mte artist
-0000d790: 2c74 6974 6c65 2c71 7578 600a 0a74 6167  ,title,qux`..tag
-0000d7a0: 7320 7468 6174 2073 7461 7274 2077 6974  s that start wit
-0000d7b0: 6820 6120 602e 6020 7375 6368 2061 7320  h a `.` such as 
-0000d7c0: 602e 6270 6d60 2061 6e64 2060 2e64 7572  `.bpm` and `.dur
-0000d7d0: 6028 6174 696f 6e29 2069 6e64 6963 6174  `(ation) indicat
-0000d7e0: 6520 6e75 6d65 7269 6320 7661 6c75 650a  e numeric value.
-0000d7f0: 0a73 6565 2074 6865 2062 6561 7574 6966  .see the beautif
-0000d800: 756c 206d 6573 7320 6f66 2061 2064 6963  ul mess of a dic
-0000d810: 7469 6f6e 6172 7920 696e 205b 6d74 6167  tionary in [mtag
-0000d820: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
-0000d830: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-0000d840: 7970 6172 7479 2f62 6c6f 622f 686f 7675  yparty/blob/hovu
-0000d850: 6473 7472 6175 6d2f 636f 7079 7061 7274  dstraum/copypart
-0000d860: 792f 6d74 6167 2e70 7929 2066 6f72 2074  y/mtag.py) for t
-0000d870: 6865 2064 6566 6175 6c74 206d 6170 7069  he default mappi
-0000d880: 6e67 7320 2873 686f 756c 6420 636f 7665  ngs (should cove
-0000d890: 7220 6d70 332c 6f70 7573 2c66 6c61 632c  r mp3,opus,flac,
-0000d8a0: 6d34 612c 7761 762c 6169 662c 290a 0a60  m4a,wav,aif,)..`
-0000d8b0: 2d2d 6e6f 2d6d 7574 6167 656e 6020 6469  --no-mutagen` di
-0000d8c0: 7361 626c 6573 204d 7574 6167 656e 2061  sables Mutagen a
-0000d8d0: 6e64 2075 7365 7320 4646 7072 6f62 6520  nd uses FFprobe 
-0000d8e0: 696e 7374 6561 642c 2077 6869 6368 2e2e  instead, which..
-0000d8f0: 2e0a 2a20 6973 2061 626f 7574 2032 3078  ..* is about 20x
-0000d900: 2073 6c6f 7765 7220 7468 616e 204d 7574   slower than Mut
-0000d910: 6167 656e 0a2a 2063 6174 6368 6573 2061  agen.* catches a
-0000d920: 2066 6577 2074 6167 7320 7468 6174 204d   few tags that M
-0000d930: 7574 6167 656e 2064 6f65 736e 2774 0a20  utagen doesn't. 
-0000d940: 202a 206d 656c 6f64 6963 206b 6579 2c20   * melodic key, 
-0000d950: 7669 6465 6f20 7265 736f 6c75 7469 6f6e  video resolution
-0000d960: 2c20 6672 616d 6572 6174 652c 2070 6978  , framerate, pix
-0000d970: 666d 740a 2a20 6176 6f69 6473 2070 756c  fmt.* avoids pul
-0000d980: 6c69 6e67 2061 6e79 2047 504c 2063 6f64  ling any GPL cod
-0000d990: 6520 696e 746f 2063 6f70 7970 6172 7479  e into copyparty
-0000d9a0: 0a2a 206d 6f72 6520 696d 706f 7274 616e  .* more importan
-0000d9b0: 746c 7920 7275 6e73 2046 4670 726f 6265  tly runs FFprobe
-0000d9c0: 206f 6e20 696e 636f 6d69 6e67 2066 696c   on incoming fil
-0000d9d0: 6573 2077 6869 6368 2069 7320 6261 6420  es which is bad 
-0000d9e0: 6966 2079 6f75 7220 4646 6d70 6567 2068  if your FFmpeg h
-0000d9f0: 6173 2061 2063 7665 0a0a 602d 2d6d 7461  as a cve..`--mta
-0000da00: 672d 746f 6020 7365 7473 2074 6865 2074  g-to` sets the t
-0000da10: 6167 2d73 6361 6e20 7469 6d65 6f75 743b  ag-scan timeout;
-0000da20: 2076 6572 7920 6869 6768 2064 6566 6175   very high defau
-0000da30: 6c74 2028 3630 2073 6563 2920 746f 2063  lt (60 sec) to c
-0000da40: 6174 6572 2066 6f72 207a 6673 2061 6e64  ater for zfs and
-0000da50: 206f 7468 6572 2072 616e 646f 6d6c 792d   other randomly-
-0000da60: 6672 6565 7a69 6e67 2066 696c 6573 7973  freezing filesys
-0000da70: 7465 6d73 2e20 4c6f 7765 7220 7661 6c75  tems. Lower valu
-0000da80: 6573 206c 696b 6520 3130 2061 7265 2075  es like 10 are u
-0000da90: 7375 616c 6c79 2073 6166 652c 2061 6c6c  sually safe, all
-0000daa0: 6f77 696e 6720 666f 7220 6661 7374 6572  owing for faster
-0000dab0: 2070 726f 6365 7373 696e 6720 6f66 2074   processing of t
-0000dac0: 7269 636b 7920 6669 6c65 730a 0a0a 2323  ricky files...##
-0000dad0: 2066 696c 6520 7061 7273 6572 2070 6c75   file parser plu
-0000dae0: 6769 6e73 0a0a 7072 6f76 6964 6520 6375  gins..provide cu
-0000daf0: 7374 6f6d 2070 6172 7365 7273 2074 6f20  stom parsers to 
-0000db00: 696e 6465 7820 6164 6469 7469 6f6e 616c  index additional
-0000db10: 2074 6167 732c 2020 616c 736f 2073 6565   tags,  also see
-0000db20: 205b 2e2f 6269 6e2f 6d74 6167 2f52 4541   [./bin/mtag/REA
-0000db30: 444d 452e 6d64 5d28 2e2f 6269 6e2f 6d74  DME.md](./bin/mt
-0000db40: 6167 2f52 4541 444d 452e 6d64 290a 0a63  ag/README.md)..c
-0000db50: 6f70 7970 6172 7479 2063 616e 2069 6e76  opyparty can inv
-0000db60: 6f6b 6520 6578 7465 726e 616c 2070 726f  oke external pro
-0000db70: 6772 616d 7320 746f 2063 6f6c 6c65 6374  grams to collect
-0000db80: 2061 6464 6974 696f 6e61 6c20 6d65 7461   additional meta
-0000db90: 6461 7461 2066 6f72 2066 696c 6573 2075  data for files u
-0000dba0: 7369 6e67 2060 6d74 7060 2028 6569 7468  sing `mtp` (eith
-0000dbb0: 6572 2061 7320 6172 6775 6d65 6e74 206f  er as argument o
-0000dbc0: 7220 766f 6c66 6c61 6729 2c20 7468 6572  r volflag), ther
-0000dbd0: 6520 6973 2061 2064 6566 6175 6c74 2074  e is a default t
-0000dbe0: 696d 656f 7574 206f 6620 3630 7365 632c  imeout of 60sec,
-0000dbf0: 2061 6e64 206f 6e6c 7920 6669 6c65 7320   and only files 
-0000dc00: 7768 6963 6820 636f 6e74 6169 6e20 6175  which contain au
-0000dc10: 6469 6f20 6765 7420 616e 616c 797a 6564  dio get analyzed
-0000dc20: 2062 7920 6465 6661 756c 7420 2873 6565   by default (see
-0000dc30: 2061 792f 616e 2f61 6420 6265 6c6f 7729   ay/an/ad below)
-0000dc40: 0a0a 2a20 602d 6d74 7020 2e62 706d 3d7e  ..* `-mtp .bpm=~
-0000dc50: 2f62 696e 2f61 7564 696f 2d62 706d 2e70  /bin/audio-bpm.p
-0000dc60: 7960 2077 696c 6c20 6578 6563 7574 6520  y` will execute 
-0000dc70: 607e 2f62 696e 2f61 7564 696f 2d62 706d  `~/bin/audio-bpm
-0000dc80: 2e70 7960 2077 6974 6820 7468 6520 6175  .py` with the au
-0000dc90: 6469 6f20 6669 6c65 2061 7320 6172 6775  dio file as argu
-0000dca0: 6d65 6e74 2031 2074 6f20 7072 6f76 6964  ment 1 to provid
-0000dcb0: 6520 7468 6520 602e 6270 6d60 2074 6167  e the `.bpm` tag
-0000dcc0: 2c20 6966 2074 6861 7420 646f 6573 206e  , if that does n
-0000dcd0: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
-0000dce0: 6175 6469 6f20 6d65 7461 6461 7461 0a2a  audio metadata.*
-0000dcf0: 2060 2d6d 7470 206b 6579 3d66 2c74 352c   `-mtp key=f,t5,
-0000dd00: 7e2f 6269 6e2f 6175 6469 6f2d 6b65 792e  ~/bin/audio-key.
-0000dd10: 7079 6020 7573 6573 2060 7e2f 6269 6e2f  py` uses `~/bin/
-0000dd20: 6175 6469 6f2d 6b65 792e 7079 6020 746f  audio-key.py` to
-0000dd30: 2067 6574 2074 6865 2060 6b65 7960 2074   get the `key` t
-0000dd40: 6167 2c20 7265 706c 6163 696e 6720 616e  ag, replacing an
-0000dd50: 7920 6578 6973 7469 6e67 206d 6574 6164  y existing metad
-0000dd60: 6174 6120 7461 6720 2860 662c 6029 2c20  ata tag (`f,`), 
-0000dd70: 6162 6f72 7469 6e67 2069 6620 6974 2074  aborting if it t
-0000dd80: 616b 6573 206c 6f6e 6765 7220 7468 616e  akes longer than
-0000dd90: 2035 7365 6320 2860 7435 2c60 290a 2a20   5sec (`t5,`).* 
-0000dda0: 602d 7620 7e2f 6d75 7369 633a 3a72 3a63  `-v ~/music::r:c
-0000ddb0: 2c6d 7470 3d2e 6270 6d3d 7e2f 6269 6e2f  ,mtp=.bpm=~/bin/
-0000ddc0: 6175 6469 6f2d 6270 6d2e 7079 3a63 2c6d  audio-bpm.py:c,m
-0000ddd0: 7470 3d6b 6579 3d66 2c74 352c 7e2f 6269  tp=key=f,t5,~/bi
-0000dde0: 6e2f 6175 6469 6f2d 6b65 792e 7079 6020  n/audio-key.py` 
-0000ddf0: 626f 7468 2061 7320 6120 7065 722d 766f  both as a per-vo
-0000de00: 6c75 6d65 2063 6f6e 6669 6720 776f 7720  lume config wow 
-0000de10: 7468 6973 2069 7320 6765 7474 696e 6720  this is getting 
-0000de20: 7567 6c79 0a0a 2a62 7574 2077 6169 742c  ugly..*but wait,
-0000de30: 2074 6865 7265 2773 206d 6f72 6521 2a20   there's more!* 
-0000de40: 602d 6d74 7060 2063 616e 2062 6520 7573  `-mtp` can be us
-0000de50: 6564 2066 6f72 206e 6f6e 2d61 7564 696f  ed for non-audio
-0000de60: 2066 696c 6573 2061 7320 7765 6c6c 2075   files as well u
-0000de70: 7369 6e67 2074 6865 2060 6160 2066 6c61  sing the `a` fla
-0000de80: 673a 2060 6179 6020 6f6e 6c79 2064 6f20  g: `ay` only do 
-0000de90: 6175 6469 6f20 6669 6c65 7320 2864 6566  audio files (def
-0000dea0: 6175 6c74 292c 2060 616e 6020 6f6e 6c79  ault), `an` only
-0000deb0: 2064 6f20 6e6f 6e2d 6175 6469 6f20 6669   do non-audio fi
-0000dec0: 6c65 732c 206f 7220 6061 6460 2064 6f20  les, or `ad` do 
-0000ded0: 616c 6c20 6669 6c65 7320 2864 2061 7320  all files (d as 
-0000dee0: 696e 2064 6f6e 7463 6172 6529 0a0a 2a20  in dontcare)..* 
-0000def0: 2261 7564 696f 2066 696c 6522 2061 6c73  "audio file" als
-0000df00: 6f20 6d65 616e 7320 7669 6465 6f73 2062  o means videos b
-0000df10: 7477 2c20 6173 206c 6f6e 6720 6173 2074  tw, as long as t
-0000df20: 6865 7265 2069 7320 616e 2061 7564 696f  here is an audio
-0000df30: 2073 7472 6561 6d0a 2a20 602d 6d74 7020   stream.* `-mtp 
-0000df40: 6578 743d 616e 2c7e 2f62 696e 2f66 696c  ext=an,~/bin/fil
-0000df50: 652d 6578 742e 7079 6020 7275 6e73 2060  e-ext.py` runs `
-0000df60: 7e2f 6269 6e2f 6669 6c65 2d65 7874 2e70  ~/bin/file-ext.p
-0000df70: 7960 2074 6f20 6765 7420 7468 6520 6065  y` to get the `e
-0000df80: 7874 6020 7461 6720 6f6e 6c79 2069 6620  xt` tag only if 
-0000df90: 6669 6c65 2069 7320 6e6f 7420 6175 6469  file is not audi
-0000dfa0: 6f20 2860 616e 6029 0a2a 2060 2d6d 7470  o (`an`).* `-mtp
-0000dfb0: 2061 7263 682c 6275 696c 742c 7665 722c   arch,built,ver,
-0000dfc0: 6f72 6967 3d61 6e2c 6565 7865 2c65 646c  orig=an,eexe,edl
-0000dfd0: 6c2c 7e2f 6269 6e2f 6578 652e 7079 6020  l,~/bin/exe.py` 
-0000dfe0: 7275 6e73 2060 7e2f 6269 6e2f 6578 652e  runs `~/bin/exe.
-0000dff0: 7079 6020 746f 2067 6574 2070 726f 7065  py` to get prope
-0000e000: 7274 6965 7320 6162 6f75 7420 7769 6e64  rties about wind
-0000e010: 6f77 732d 6269 6e61 7269 6573 206f 6e6c  ows-binaries onl
-0000e020: 7920 6966 2066 696c 6520 6973 206e 6f74  y if file is not
-0000e030: 2061 7564 696f 2028 6061 6e60 2920 616e   audio (`an`) an
-0000e040: 6420 6669 6c65 2065 7874 656e 7369 6f6e  d file extension
-0000e050: 2069 7320 6578 6520 6f72 2064 6c6c 0a2a   is exe or dll.*
-0000e060: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-0000e070: 6461 6973 7963 6861 696e 2070 6172 7365  daisychain parse
-0000e080: 7273 2c20 7573 6520 7468 6520 6070 6020  rs, use the `p` 
-0000e090: 666c 6167 2074 6f20 7365 7420 7072 6f63  flag to set proc
-0000e0a0: 6573 7369 6e67 206f 7264 6572 0a20 202a  essing order.  *
-0000e0b0: 2060 2d6d 7470 2066 6f6f 3d70 312c 7e2f   `-mtp foo=p1,~/
-0000e0c0: 612e 7079 6020 7275 6e73 2062 6566 6f72  a.py` runs befor
-0000e0d0: 6520 602d 6d74 7020 666f 6f3d 7032 2c7e  e `-mtp foo=p2,~
-0000e0e0: 2f62 2e70 7960 2061 6e64 2077 696c 6c20  /b.py` and will 
-0000e0f0: 666f 7277 6172 6420 616c 6c20 7468 6520  forward all the 
-0000e100: 7461 6773 2064 6574 6563 7465 6420 736f  tags detected so
-0000e110: 2066 6172 2061 7320 6a73 6f6e 2074 6f20   far as json to 
-0000e120: 7468 6520 7374 6469 6e20 6f66 2062 2e70  the stdin of b.p
-0000e130: 790a 2a20 6f70 7469 6f6e 2060 6330 6020  y.* option `c0` 
-0000e140: 6469 7361 626c 6573 2063 6170 7475 7269  disables capturi
-0000e150: 6e67 206f 6620 7374 646f 7574 2f73 7464  ng of stdout/std
-0000e160: 6572 722c 2073 6f20 636f 7079 7061 7274  err, so copypart
-0000e170: 7920 7769 6c6c 206e 6f74 2072 6563 6569  y will not recei
-0000e180: 7665 2061 6e79 2074 6167 7320 6672 6f6d  ve any tags from
-0000e190: 2074 6865 2070 726f 6365 7373 2061 7420   the process at 
-0000e1a0: 616c 6c20 2d2d 2069 6e73 7465 6164 2074  all -- instead t
-0000e1b0: 6865 2069 6e76 6f6b 6564 2070 726f 6772  he invoked progr
-0000e1c0: 616d 2069 7320 6672 6565 2074 6f20 7072  am is free to pr
-0000e1d0: 696e 7420 7768 6174 6576 6572 2074 6f20  int whatever to 
-0000e1e0: 7468 6520 636f 6e73 6f6c 652c 206a 7573  the console, jus
-0000e1f0: 7420 7573 696e 6720 636f 7079 7061 7274  t using copypart
-0000e200: 7920 6173 2061 206c 6175 6e63 6865 720a  y as a launcher.
-0000e210: 2020 2a20 6063 3160 2063 6170 7475 7265    * `c1` capture
-0000e220: 7320 7374 646f 7574 206f 6e6c 792c 2060  s stdout only, `
-0000e230: 6332 6020 6f6e 6c79 2073 7464 6572 722c  c2` only stderr,
-0000e240: 2061 6e64 2060 6333 6020 2864 6566 6175   and `c3` (defau
-0000e250: 6c74 2920 6361 7074 7572 6573 2062 6f74  lt) captures bot
-0000e260: 680a 2a20 796f 7520 6361 6e20 636f 6e74  h.* you can cont
-0000e270: 726f 6c20 686f 7720 7468 6520 7061 7273  rol how the pars
-0000e280: 6572 2069 7320 6b69 6c6c 6564 2069 6620  er is killed if 
-0000e290: 6974 2074 696d 6573 206f 7574 2077 6974  it times out wit
-0000e2a0: 6820 6f70 7469 6f6e 2060 6b74 6020 6b69  h option `kt` ki
-0000e2b0: 6c6c 696e 6720 7468 6520 656e 7469 7265  lling the entire
-0000e2c0: 2070 726f 6365 7373 2074 7265 6520 2864   process tree (d
-0000e2d0: 6566 6175 6c74 292c 2060 6b6d 6020 6a75  efault), `km` ju
-0000e2e0: 7374 2074 6865 206d 6169 6e20 7072 6f63  st the main proc
-0000e2f0: 6573 732c 206f 7220 606b 6e60 206c 6574  ess, or `kn` let
-0000e300: 2069 7420 636f 6e74 696e 7565 2072 756e   it continue run
-0000e310: 6e69 6e67 2075 6e74 696c 2063 6f70 7970  ning until copyp
-0000e320: 6172 7479 2069 7320 7465 726d 696e 6174  arty is terminat
-0000e330: 6564 0a0a 6966 2073 6f6d 6574 6869 6e67  ed..if something
-0000e340: 2064 6f65 736e 2774 2077 6f72 6b2c 2074   doesn't work, t
-0000e350: 7279 2060 2d2d 6d74 6167 2d76 6020 666f  ry `--mtag-v` fo
-0000e360: 7220 7665 7262 6f73 6520 6572 726f 7220  r verbose error 
-0000e370: 6d65 7373 6167 6573 0a0a 0a23 2320 6576  messages...## ev
-0000e380: 656e 7420 686f 6f6b 730a 0a74 7269 6767  ent hooks..trigg
-0000e390: 6572 2061 2070 726f 6772 616d 206f 6e20  er a program on 
-0000e3a0: 7570 6c6f 6164 732c 2072 656e 616d 6573  uploads, renames
-0000e3b0: 2065 7463 2028 5b65 7861 6d70 6c65 735d   etc ([examples]
-0000e3c0: 282e 2f62 696e 2f68 6f6f 6b73 2f29 290a  (./bin/hooks/)).
-0000e3d0: 0a79 6f75 2063 616e 2073 6574 2068 6f6f  .you can set hoo
-0000e3e0: 6b73 2062 6566 6f72 6520 616e 642f 6f72  ks before and/or
-0000e3f0: 2061 6674 6572 2061 6e20 6576 656e 7420   after an event 
-0000e400: 6861 7070 656e 732c 2061 6e64 2063 7572  happens, and cur
-0000e410: 7265 6e74 6c79 2079 6f75 2063 616e 2068  rently you can h
-0000e420: 6f6f 6b20 7570 6c6f 6164 732c 206d 6f76  ook uploads, mov
-0000e430: 6573 2f72 656e 616d 6573 2c20 616e 6420  es/renames, and 
-0000e440: 6465 6c65 7465 730a 0a74 6865 7265 2773  deletes..there's
-0000e450: 2061 2062 756e 6368 206f 6620 666c 6167   a bunch of flag
-0000e460: 7320 616e 6420 7374 7566 662c 2073 6565  s and stuff, see
-0000e470: 2060 2d2d 6865 6c70 2d68 6f6f 6b73 600a   `--help-hooks`.
-0000e480: 0a0a 2323 2320 7570 6c6f 6164 2065 7665  ..### upload eve
-0000e490: 6e74 730a 0a74 6865 206f 6c64 6572 2c20  nts..the older, 
-0000e4a0: 6d6f 7265 2070 6f77 6572 6675 6c20 6170  more powerful ap
-0000e4b0: 7072 6f61 6368 2028 5b65 7861 6d70 6c65  proach ([example
-0000e4c0: 735d 282e 2f62 696e 2f6d 7461 672f 2929  s](./bin/mtag/))
-0000e4d0: 3a0a 0a60 6060 0a2d 7620 2f6d 6e74 2f69  :..```.-v /mnt/i
-0000e4e0: 6e63 3a69 6e63 3a77 3a63 2c6d 7465 3d2b  nc:inc:w:c,mte=+
-0000e4f0: 7831 3a63 2c6d 7470 3d78 313d 6164 2c6b  x1:c,mtp=x1=ad,k
-0000e500: 6e2c 2f75 7372 2f62 696e 2f6e 6f74 6966  n,/usr/bin/notif
-0000e510: 792d 7365 6e64 0a60 6060 0a0a 736f 2066  y-send.```..so f
-0000e520: 696c 6573 7973 7465 6d20 6c6f 6361 7469  ilesystem locati
-0000e530: 6f6e 2060 2f6d 6e74 2f69 6e63 6020 7368  on `/mnt/inc` sh
-0000e540: 6172 6564 2061 7420 602f 696e 6360 2c20  ared at `/inc`, 
-0000e550: 7772 6974 652d 6f6e 6c79 2066 6f72 2065  write-only for e
-0000e560: 7665 7279 6f6e 652c 2061 7070 656e 6469  veryone, appendi
-0000e570: 6e67 2060 7831 6020 746f 2074 6865 206c  ng `x1` to the l
-0000e580: 6973 7420 6f66 2074 6167 7320 746f 2069  ist of tags to i
-0000e590: 6e64 6578 2028 606d 7465 6029 2c20 616e  ndex (`mte`), an
-0000e5a0: 6420 7573 696e 6720 602f 7573 722f 6269  d using `/usr/bi
-0000e5b0: 6e2f 6e6f 7469 6679 2d73 656e 6460 2074  n/notify-send` t
-0000e5c0: 6f20 2270 726f 7669 6465 2220 7461 6720  o "provide" tag 
-0000e5d0: 6078 3160 2066 6f72 2061 6e79 2066 696c  `x1` for any fil
-0000e5e0: 6574 7970 6520 2860 6164 6029 2077 6974  etype (`ad`) wit
-0000e5f0: 6820 6b69 6c6c 2d6f 6e2d 7469 6d65 6f75  h kill-on-timeou
-0000e600: 7420 6469 7361 626c 6564 2028 606b 6e60  t disabled (`kn`
-0000e610: 290a 0a74 6861 7427 6c6c 2072 756e 2074  )..that'll run t
-0000e620: 6865 2063 6f6d 6d61 6e64 2060 6e6f 7469  he command `noti
-0000e630: 6679 2d73 656e 6460 2077 6974 6820 7468  fy-send` with th
-0000e640: 6520 7061 7468 2074 6f20 7468 6520 7570  e path to the up
-0000e650: 6c6f 6164 6564 2066 696c 6520 6173 2074  loaded file as t
-0000e660: 6865 2066 6972 7374 2061 6e64 206f 6e6c  he first and onl
-0000e670: 7920 6172 6775 6d65 6e74 2028 736f 206f  y argument (so o
-0000e680: 6e20 6c69 6e75 7820 6974 276c 6c20 7368  n linux it'll sh
-0000e690: 6f77 2061 206e 6f74 6966 6963 6174 696f  ow a notificatio
-0000e6a0: 6e20 6f6e 2d73 6372 6565 6e29 0a0a 6e6f  n on-screen)..no
-0000e6b0: 7465 2074 6861 7420 7468 6973 2069 7320  te that this is 
-0000e6c0: 7761 7920 6d6f 7265 2063 6f6d 706c 6963  way more complic
-0000e6d0: 6174 6564 2074 6861 6e20 7468 6520 6e65  ated than the ne
-0000e6e0: 7720 5b65 7665 6e74 2068 6f6f 6b73 5d28  w [event hooks](
-0000e6f0: 2365 7665 6e74 2d68 6f6f 6b73 2920 6275  #event-hooks) bu
-0000e700: 7420 7468 6973 2061 7070 726f 6163 6820  t this approach 
-0000e710: 6861 7320 7468 6520 666f 6c6c 6f77 696e  has the followin
-0000e720: 6720 6164 7661 6e74 6167 6573 3a0a 2a20  g advantages:.* 
-0000e730: 6e6f 6e2d 626c 6f63 6b69 6e67 2061 6e64  non-blocking and
-0000e740: 206d 756c 7469 7468 7265 6164 6564 3b20   multithreaded; 
-0000e750: 646f 6573 6e27 7420 686f 6c64 206f 7468  doesn't hold oth
-0000e760: 6572 2075 706c 6f61 6473 2062 6163 6b0a  er uploads back.
-0000e770: 2a20 796f 7520 6765 7420 6163 6365 7373  * you get access
-0000e780: 2074 6f20 7461 6773 2066 726f 6d20 4646   to tags from FF
-0000e790: 6d70 6567 2061 6e64 206f 7468 6572 206d  mpeg and other m
-0000e7a0: 7470 2070 6172 7365 7273 0a2a 206f 6e6c  tp parsers.* onl
-0000e7b0: 7920 7472 6967 6765 7220 6f6e 206e 6577  y trigger on new
-0000e7c0: 2075 6e69 7175 6520 6669 6c65 732c 206e   unique files, n
-0000e7d0: 6f74 2064 7570 6573 0a0a 6e6f 7465 2074  ot dupes..note t
-0000e7e0: 6861 7420 6974 2077 696c 6c20 6f63 6375  hat it will occu
-0000e7f0: 7079 2074 6865 2070 6172 7369 6e67 2074  py the parsing t
-0000e800: 6872 6561 6473 2c20 736f 2066 6f72 6b20  hreads, so fork 
-0000e810: 616e 7974 6869 6e67 2065 7870 656e 7369  anything expensi
-0000e820: 7665 2028 6f72 2073 6574 2060 6b6e 6020  ve (or set `kn` 
-0000e830: 746f 2068 6176 6520 636f 7079 7061 7274  to have copypart
-0000e840: 7920 666f 726b 2069 7420 666f 7220 796f  y fork it for yo
-0000e850: 7529 202d 2d20 6f74 6f68 2069 6620 796f  u) -- otoh if yo
-0000e860: 7520 7761 6e74 2074 6f20 696e 7465 6e74  u want to intent
-0000e870: 696f 6e61 6c6c 7920 7175 6575 652f 7369  ionally queue/si
-0000e880: 6e67 6c65 7468 7265 6164 2079 6f75 2063  nglethread you c
-0000e890: 616e 2063 6f6d 6269 6e65 2069 7420 7769  an combine it wi
-0000e8a0: 7468 2060 2d2d 6d74 6167 2d6d 7420 3160  th `--mtag-mt 1`
-0000e8b0: 0a0a 0a23 2320 6869 6469 6e67 2066 726f  ...## hiding fro
-0000e8c0: 6d20 676f 6f67 6c65 0a0a 7465 6c6c 2073  m google..tell s
-0000e8d0: 6561 7263 6820 656e 6769 6e65 7320 796f  earch engines yo
-0000e8e0: 7520 646f 6e74 2077 616e 6e61 2062 6520  u dont wanna be 
-0000e8f0: 696e 6465 7865 642c 2020 6569 7468 6572  indexed,  either
-0000e900: 2075 7369 6e67 2074 6865 2067 6f6f 6420   using the good 
-0000e910: 6f6c 6420 5b72 6f62 6f74 732e 7478 745d  old [robots.txt]
-0000e920: 2868 7474 7073 3a2f 2f77 7777 2e72 6f62  (https://www.rob
-0000e930: 6f74 7374 7874 2e6f 7267 2f72 6f62 6f74  otstxt.org/robot
-0000e940: 7374 7874 2e68 746d 6c29 206f 7220 7468  stxt.html) or th
-0000e950: 726f 7567 6820 636f 7079 7061 7274 7920  rough copyparty 
-0000e960: 7365 7474 696e 6773 3a0a 0a2a 2060 2d2d  settings:..* `--
-0000e970: 6e6f 2d72 6f62 6f74 7360 2061 6464 7320  no-robots` adds 
-0000e980: 4854 5450 2028 6058 2d52 6f62 6f74 732d  HTTP (`X-Robots-
-0000e990: 5461 6760 2920 616e 6420 4854 4d4c 2028  Tag`) and HTML (
-0000e9a0: 603c 6d65 7461 3e60 2920 6865 6164 6572  `<meta>`) header
-0000e9b0: 7320 7769 7468 2060 6e6f 696e 6465 782c  s with `noindex,
-0000e9c0: 206e 6f66 6f6c 6c6f 7760 2067 6c6f 6261   nofollow` globa
-0000e9d0: 6c6c 790a 2a20 766f 6c66 6c61 6720 605b  lly.* volflag `[
-0000e9e0: 2e2e 2e5d 3a63 2c6e 6f72 6f62 6f74 7360  ...]:c,norobots`
-0000e9f0: 2064 6f65 7320 7468 6520 7361 6d65 2074   does the same t
-0000ea00: 6869 6e67 2066 6f72 2074 6861 7420 7369  hing for that si
-0000ea10: 6e67 6c65 2076 6f6c 756d 650a 2a20 766f  ngle volume.* vo
-0000ea20: 6c66 6c61 6720 605b 2e2e 2e5d 3a63 2c72  lflag `[...]:c,r
-0000ea30: 6f62 6f74 7360 2041 4c4c 4f57 5320 7365  obots` ALLOWS se
-0000ea40: 6172 6368 2d65 6e67 696e 6520 6372 6177  arch-engine craw
-0000ea50: 6c69 6e67 2066 6f72 2074 6861 7420 766f  ling for that vo
-0000ea60: 6c75 6d65 2c20 6576 656e 2069 6620 602d  lume, even if `-
-0000ea70: 2d6e 6f2d 726f 626f 7473 6020 6973 2073  -no-robots` is s
-0000ea80: 6574 2067 6c6f 6261 6c6c 790a 0a61 6c73  et globally..als
-0000ea90: 6f2c 2060 2d2d 666f 7263 652d 6a73 6020  o, `--force-js` 
-0000eaa0: 6469 7361 626c 6573 2074 6865 2070 6c61  disables the pla
-0000eab0: 696e 2048 544d 4c20 666f 6c64 6572 206c  in HTML folder l
-0000eac0: 6973 7469 6e67 2c20 6d61 6b69 6e67 2074  isting, making t
-0000ead0: 6869 6e67 7320 6861 7264 6572 2074 6f20  hings harder to 
-0000eae0: 7061 7273 6520 666f 7220 7365 6172 6368  parse for search
-0000eaf0: 2065 6e67 696e 6573 0a0a 0a23 2320 7468   engines...## th
-0000eb00: 656d 6573 0a0a 796f 7520 6361 6e20 6368  emes..you can ch
-0000eb10: 616e 6765 2074 6865 2064 6566 6175 6c74  ange the default
-0000eb20: 2074 6865 6d65 2077 6974 6820 602d 2d74   theme with `--t
-0000eb30: 6865 6d65 2032 602c 2061 6e64 2061 6464  heme 2`, and add
-0000eb40: 2079 6f75 7220 6f77 6e20 7468 656d 6573   your own themes
-0000eb50: 2062 7920 6d6f 6469 6679 696e 6720 6062   by modifying `b
-0000eb60: 726f 7773 6572 2e63 7373 6020 6f72 2070  rowser.css` or p
-0000eb70: 726f 7669 6469 6e67 2079 6f75 7220 6f77  roviding your ow
-0000eb80: 6e20 6373 7320 746f 2060 2d2d 6373 732d  n css to `--css-
-0000eb90: 6272 6f77 7365 7260 2c20 7468 656e 2074  browser`, then t
-0000eba0: 656c 6c69 6e67 2063 6f70 7970 6172 7479  elling copyparty
-0000ebb0: 2074 6865 7920 6578 6973 7420 6279 2069   they exist by i
-0000ebc0: 6e63 7265 6173 696e 6720 602d 2d74 6865  ncreasing `--the
-0000ebd0: 6d65 7360 0a0a 3c74 6162 6c65 3e3c 7472  mes`..<table><tr
-0000ebe0: 3e3c 7464 2077 6964 7468 3d22 3333 2522  ><td width="33%"
-0000ebf0: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
-0000ec00: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
-0000ec10: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-0000ec20: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-0000ec30: 6f6d 2f32 3431 3033 322f 3136 3538 3634  om/241032/165864
-0000ec40: 3930 372d 3137 6532 6163 3764 2d33 3139  907-17e2ac7d-319
-0000ec50: 642d 3466 3235 2d38 3731 382d 3266 3337  d-4f25-8718-2f37
-0000ec60: 3666 3631 3462 3531 2e70 6e67 223e 3c69  6f614b51.png"><i
-0000ec70: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-0000ec80: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
-0000ec90: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
-0000eca0: 6d2f 3234 3130 3332 2f31 3635 3836 3735  m/241032/1658675
-0000ecb0: 3531 2d66 6365 6233 3564 642d 3338 6630  51-fceb35dd-38f0
-0000ecc0: 2d34 3262 622d 6265 6633 2d32 3562 6136  -42bb-bef3-25ba6
-0000ecd0: 3531 6361 3639 622e 706e 6722 3e3c 2f61  51ca69b.png"></a
-0000ece0: 3e0a 302e 2063 6c61 7373 6963 2064 6172  >.0. classic dar
-0000ecf0: 6b3c 2f74 643e 3c74 6420 7769 6474 683d  k</td><td width=
-0000ed00: 2233 3325 2220 616c 6967 6e3d 2263 656e  "33%" align="cen
-0000ed10: 7465 7222 3e3c 6120 6872 6566 3d22 6874  ter"><a href="ht
-0000ed20: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-0000ed30: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-0000ed40: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
-0000ed50: 3638 3634 3433 3939 2d36 3839 3338 6465  68644399-68938de
-0000ed60: 352d 6461 3962 2d34 3435 662d 3864 3932  5-da9b-445f-8d92
-0000ed70: 2d62 3531 6337 3462 3566 3334 352e 706e  -b51c74b5f345.pn
-0000ed80: 6722 3e3c 696d 6720 7372 633d 2268 7474  g"><img src="htt
-0000ed90: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-0000eda0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-0000edb0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
-0000edc0: 3836 3434 3430 342d 3865 3161 3266 6463  8644404-8e1a2fdc
-0000edd0: 2d36 6535 392d 3463 3431 2d39 3035 652d  -6e59-4c41-905e-
-0000ede0: 6261 3533 3939 6564 3638 3666 2e70 6e67  ba5399ed686f.png
-0000edf0: 223e 3c2f 613e 0a32 2e20 666c 6174 2070  "></a>.2. flat p
-0000ee00: 6d2d 6d6f 6e6f 6b61 693c 2f74 643e 3c74  m-monokai</td><t
-0000ee10: 6420 7769 6474 683d 2233 3325 2220 616c  d width="33%" al
-0000ee20: 6967 6e3d 2263 656e 7465 7222 3e3c 6120  ign="center"><a 
-0000ee30: 6872 6566 3d22 6874 7470 733a 2f2f 7573  href="https://us
-0000ee40: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-0000ee50: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-0000ee60: 3234 3130 3332 2f31 3635 3836 3439 3031  241032/165864901
-0000ee70: 2d64 6231 3361 3432 392d 6135 6461 2d34  -db13a429-a5da-4
-0000ee80: 3936 642d 3862 6336 2d63 6538 3338 3534  96d-8bc6-ce83854
-0000ee90: 3766 3639 642e 706e 6722 3e3c 696d 6720  7f69d.png"><img 
-0000eea0: 7372 633d 2268 7474 7073 3a2f 2f75 7365  src="https://use
-0000eeb0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-0000eec0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-0000eed0: 3431 3033 322f 3136 3538 3637 3536 302d  41032/165867560-
-0000eee0: 6161 3833 3461 6566 2d35 3864 632d 3461  aa834aef-58dc-4a
-0000eef0: 6265 2d62 6165 662d 3765 3536 3262 3634  be-baef-7e562b64
-0000ef00: 3739 3435 2e70 6e67 223e 3c2f 613e 0a34  7945.png"></a>.4
-0000ef10: 2e20 7669 6365 3c2f 7464 3e3c 2f74 723e  . vice</td></tr>
-0000ef20: 3c74 723e 3c74 6420 616c 6967 6e3d 2263  <tr><td align="c
-0000ef30: 656e 7465 7222 3e3c 6120 6872 6566 3d22  enter"><a href="
-0000ef40: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
-0000ef50: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
-0000ef60: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
-0000ef70: 2f31 3635 3836 3439 3035 2d36 3932 3638  /165864905-69268
-0000ef80: 3265 622d 3666 6234 2d34 6434 302d 6236  2eb-6fb4-4d40-b6
-0000ef90: 6665 2d32 3764 3263 3764 3365 3261 372e  fe-27d2c7d3e2a7.
-0000efa0: 706e 6722 3e3c 696d 6720 7372 633d 2268  png"><img src="h
-0000efb0: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-0000efc0: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-0000efd0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-0000efe0: 3136 3538 3637 3535 352d 3038 3062 3733  165867555-080b73
-0000eff0: 6236 2d36 6438 352d 3431 6262 2d61 3763  b6-6d85-41bb-a7c
-0000f000: 362d 6164 3237 3763 3630 3833 3635 2e70  6-ad277c608365.p
-0000f010: 6e67 223e 3c2f 613e 0a31 2e20 636c 6173  ng"></a>.1. clas
-0000f020: 7369 6320 6c69 6768 743c 2f74 643e 3c74  sic light</td><t
-0000f030: 6420 616c 6967 6e3d 2263 656e 7465 7222  d align="center"
-0000f040: 3e3c 6120 6872 6566 3d22 6874 7470 733a  ><a href="https:
-0000f050: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-0000f060: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-0000f070: 636f 6d2f 3234 3130 3332 2f31 3638 3634  com/241032/16864
-0000f080: 3532 3736 2d66 6230 3266 6431 392d 3139  5276-fb02fd19-19
-0000f090: 3061 2d34 3037 612d 6238 6433 2d64 3538  0a-407a-b8d3-d58
-0000f0a0: 6665 6532 3737 6530 322e 706e 6722 3e3c  fee277e02.png"><
-0000f0b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
-0000f0c0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-0000f0d0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-0000f0e0: 6f6d 2f32 3431 3033 322f 3136 3836 3435  om/241032/168645
-0000f0f0: 3238 302d 6630 3636 3262 3363 2d39 3736  280-f0662b3c-976
-0000f100: 342d 3438 3735 2d61 3265 322d 6439 3163  4-4875-a2e2-d91c
-0000f110: 6338 3139 3962 3233 2e70 6e67 223e 3c2f  c8199b23.png"></
-0000f120: 613e 0a33 2e20 666c 6174 206c 6967 6874  a>.3. flat light
-0000f130: 0a3c 2f74 643e 3c74 6420 616c 6967 6e3d  .</td><td align=
-0000f140: 2263 656e 7465 7222 3e3c 6120 6872 6566  "center"><a href
-0000f150: 3d22 6874 7470 733a 2f2f 7573 6572 2d69  ="https://user-i
-0000f160: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-0000f170: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-0000f180: 3332 2f31 3635 3836 3438 3938 2d31 3063  32/165864898-10c
-0000f190: 6537 3035 322d 6131 3137 2d34 6663 662d  e7052-a117-4fcf-
-0000f1a0: 3834 3562 2d62 3536 6339 3136 3837 3930  845b-b56c9168790
-0000f1b0: 382e 706e 6722 3e3c 696d 6720 7372 633d  8.png"><img src=
-0000f1c0: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
-0000f1d0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-0000f1e0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-0000f1f0: 322f 3136 3538 3637 3536 322d 6633 3030  2/165867562-f300
-0000f200: 3364 3435 2d64 6432 612d 3435 3634 2d38  3d45-dd2a-4564-8
-0000f210: 6161 652d 6665 6434 3463 3161 6530 3634  aae-fed44c1ae064
-0000f220: 2e70 6e67 223e 3c2f 613e 0a35 2e20 3c61  .png"></a>.5. <a
-0000f230: 2068 7265 663d 2268 7474 7073 3a2f 2f62   href="https://b
-0000f240: 6c6f 672e 636f 6469 6e67 686f 7272 6f72  log.codinghorror
-0000f250: 2e63 6f6d 2f61 2d74 7269 6275 7465 2d74  .com/a-tribute-t
-0000f260: 6f2d 7468 652d 7769 6e64 6f77 732d 3331  o-the-windows-31
-0000f270: 2d68 6f74 2d64 6f67 2d73 7461 6e64 2d63  -hot-dog-stand-c
-0000f280: 6f6c 6f72 2d73 6368 656d 652f 223e 686f  olor-scheme/">ho
-0000f290: 7464 6f67 2073 7461 6e64 3c2f 613e 3c2f  tdog stand</a></
-0000f2a0: 7464 3e3c 2f74 723e 3c2f 7461 626c 653e  td></tr></table>
-0000f2b0: 0a0a 7468 6520 636c 6173 736e 616d 6520  ..the classname 
-0000f2c0: 6f66 2074 6865 2048 544d 4c20 7461 6720  of the HTML tag 
-0000f2d0: 6973 2073 6574 2061 6363 6f72 6469 6e67  is set according
-0000f2e0: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
-0000f2f0: 2074 6865 6d65 2c20 7768 6963 6820 6973   theme, which is
-0000f300: 2075 7365 6420 746f 2073 6574 2063 6f6c   used to set col
-0000f310: 6f72 7320 6173 2063 7373 2076 6172 6961  ors as css varia
-0000f320: 626c 6573 202b 2b0a 0a2a 2065 6163 6820  bles ++..* each 
-0000f330: 7468 656d 6520 2a67 656e 6572 616c 6c79  theme *generally
-0000f340: 2a20 6861 7320 6120 6461 726b 2074 6865  * has a dark the
-0000f350: 6d65 2028 6576 656e 206e 756d 6265 7273  me (even numbers
-0000f360: 2920 616e 6420 6120 6c69 6768 7420 7468  ) and a light th
-0000f370: 656d 6520 286f 6464 206e 756d 6265 7273  eme (odd numbers
-0000f380: 292c 2073 686f 7769 6e67 2069 6e20 7061  ), showing in pa
-0000f390: 6972 730a 2a20 7468 6520 6669 7273 7420  irs.* the first 
-0000f3a0: 7468 656d 6520 2874 6865 6d65 2030 2061  theme (theme 0 a
-0000f3b0: 6e64 2031 2920 6973 2060 6874 6d6c 2e61  nd 1) is `html.a
-0000f3c0: 602c 2073 6563 6f6e 6420 7468 656d 6520  `, second theme 
-0000f3d0: 2832 2061 6e64 2033 2920 6973 2060 6874  (2 and 3) is `ht
-0000f3e0: 6d6c 2e62 600a 2a20 6966 2061 206c 6967  ml.b`.* if a lig
-0000f3f0: 6874 2074 6865 6d65 2069 7320 7365 6c65  ht theme is sele
-0000f400: 6374 6564 2c20 6068 746d 6c2e 7960 2069  cted, `html.y` i
-0000f410: 7320 7365 742c 206f 7468 6572 7769 7365  s set, otherwise
-0000f420: 2060 6874 6d6c 2e7a 6020 6973 0a2a 2073   `html.z` is.* s
-0000f430: 6f20 6966 2074 6865 2064 6172 6b20 6564  o if the dark ed
-0000f440: 6974 696f 6e20 6f66 2074 6865 2032 6e64  ition of the 2nd
-0000f450: 2074 6865 6d65 2069 7320 7365 6c65 6374   theme is select
-0000f460: 6564 2c20 796f 7520 7573 6520 616e 7920  ed, you use any 
-0000f470: 6f66 2060 6874 6d6c 2e62 602c 2060 6874  of `html.b`, `ht
-0000f480: 6d6c 2e7a 602c 2060 6874 6d6c 2e62 7a60  ml.z`, `html.bz`
-0000f490: 2074 6f20 7370 6563 6966 7920 7275 6c65   to specify rule
-0000f4a0: 730a 0a73 6565 2074 6865 2074 6f70 206f  s..see the top o
-0000f4b0: 6620 5b2e 2f63 6f70 7970 6172 7479 2f77  f [./copyparty/w
-0000f4c0: 6562 2f62 726f 7773 6572 2e63 7373 5d28  eb/browser.css](
-0000f4d0: 2e2f 636f 7079 7061 7274 792f 7765 622f  ./copyparty/web/
-0000f4e0: 6272 6f77 7365 722e 6373 7329 2077 6865  browser.css) whe
-0000f4f0: 7265 2074 6865 2063 6f6c 6f72 2076 6172  re the color var
-0000f500: 6961 626c 6573 2061 7265 2073 6574 2c20  iables are set, 
-0000f510: 616e 6420 7468 6572 6527 7320 6c61 796f  and there's layo
-0000f520: 7574 2d73 7065 6369 6669 6320 7374 7566  ut-specific stuf
-0000f530: 6620 6e65 6172 2074 6865 2062 6f74 746f  f near the botto
-0000f540: 6d0a 0a0a 2323 2063 6f6d 706c 6574 6520  m...## complete 
-0000f550: 6578 616d 706c 6573 0a0a 2a20 7265 6164  examples..* read
-0000f560: 2d6f 6e6c 7920 6d75 7369 6320 7365 7276  -only music serv
-0000f570: 6572 2020 0a20 2060 7079 7468 6f6e 2063  er  .  `python c
-0000f580: 6f70 7970 6172 7479 2d73 6678 2e70 7920  opyparty-sfx.py 
-0000f590: 2d76 202f 6d6e 742f 6e61 732f 6d75 7369  -v /mnt/nas/musi
-0000f5a0: 633a 2f6d 7573 6963 3a72 202d 6532 6473  c:/music:r -e2ds
-0000f5b0: 6120 2d65 3274 7320 2d2d 6e6f 2d72 6f62  a -e2ts --no-rob
-0000f5c0: 6f74 7320 2d2d 666f 7263 652d 6a73 202d  ots --force-js -
-0000f5d0: 2d74 6865 6d65 2032 600a 2020 0a20 202a  -theme 2`.  .  *
-0000f5e0: 202e 2e2e 7769 7468 2062 706d 2061 6e64   ...with bpm and
-0000f5f0: 206b 6579 2073 6361 6e6e 696e 6720 200a   key scanning  .
-0000f600: 2020 2020 602d 6d74 7020 2e62 706d 3d66      `-mtp .bpm=f
-0000f610: 2c61 7564 696f 2d62 706d 2e70 7920 2d6d  ,audio-bpm.py -m
-0000f620: 7470 206b 6579 3d66 2c61 7564 696f 2d6b  tp key=f,audio-k
-0000f630: 6579 2e70 7960 0a20 200a 2020 2a20 2e2e  ey.py`.  .  * ..
-0000f640: 2e77 6974 6820 6120 7265 6164 2d77 7269  .with a read-wri
-0000f650: 7465 2066 6f6c 6465 7220 666f 7220 606b  te folder for `k
-0000f660: 6576 696e 6020 7768 6f73 6520 7061 7373  evin` whose pass
-0000f670: 776f 7264 2069 7320 606f 6b67 6f60 2020  word is `okgo`  
-0000f680: 0a20 2020 2060 2d61 206b 6576 696e 3a6f  .    `-a kevin:o
-0000f690: 6b67 6f20 2d76 202f 6d6e 742f 6e61 732f  kgo -v /mnt/nas/
-0000f6a0: 696e 633a 2f69 6e63 3a72 772c 6b65 7669  inc:/inc:rw,kevi
-0000f6b0: 6e60 0a20 200a 2020 2a20 2e2e 2e77 6974  n`.  .  * ...wit
-0000f6c0: 6820 6c6f 6767 696e 6720 746f 2064 6973  h logging to dis
-0000f6d0: 6b20 200a 2020 2020 602d 6c6f 206c 6f67  k  .    `-lo log
-0000f6e0: 2f63 7070 2d25 592d 256d 2564 2d25 4825  /cpp-%Y-%m%d-%H%
-0000f6f0: 4d25 532e 7478 742e 787a 600a 0a0a 2323  M%S.txt.xz`...##
-0000f700: 2072 6576 6572 7365 2d70 726f 7879 0a0a   reverse-proxy..
-0000f710: 7275 6e6e 696e 6720 636f 7079 7061 7274  running copypart
-0000f720: 7920 6e65 7874 2074 6f20 6f74 6865 7220  y next to other 
-0000f730: 7765 6273 6974 6573 2020 686f 7374 6564  websites  hosted
-0000f740: 206f 6e20 616e 2065 7869 7374 696e 6720   on an existing 
-0000f750: 7765 6273 6572 7665 7220 7375 6368 2061  webserver such a
-0000f760: 7320 6e67 696e 7820 6f72 2061 7061 6368  s nginx or apach
-0000f770: 650a 0a79 6f75 2063 616e 2065 6974 6865  e..you can eithe
-0000f780: 723a 0a2a 2067 6976 6520 636f 7079 7061  r:.* give copypa
-0000f790: 7274 7920 6974 7320 6f77 6e20 646f 6d61  rty its own doma
-0000f7a0: 696e 206f 7220 7375 6264 6f6d 6169 6e20  in or subdomain 
-0000f7b0: 2872 6563 6f6d 6d65 6e64 6564 290a 2a20  (recommended).* 
-0000f7c0: 6f72 2064 6f20 6c6f 6361 7469 6f6e 2d62  or do location-b
-0000f7d0: 6173 6564 2070 726f 7879 696e 672c 2075  ased proxying, u
-0000f7e0: 7369 6e67 2060 2d2d 7270 2d6c 6f63 3d2f  sing `--rp-loc=/
-0000f7f0: 7374 7566 6660 2074 6f20 7465 6c6c 2063  stuff` to tell c
-0000f800: 6f70 7970 6172 7479 2077 6865 7265 2069  opyparty where i
-0000f810: 7420 6973 206d 6f75 6e74 6564 202d 2d20  t is mounted -- 
-0000f820: 6861 7320 6120 736c 6967 6874 2070 6572  has a slight per
-0000f830: 666f 726d 616e 6365 2063 6f73 7420 616e  formance cost an
-0000f840: 6420 6869 6768 6572 2063 6861 6e63 6520  d higher chance 
-0000f850: 6f66 2062 7567 730a 2020 2a20 6966 2063  of bugs.  * if c
-0000f860: 6f70 7970 6172 7479 2073 6179 7320 6069  opyparty says `i
-0000f870: 6e63 6f72 7265 6374 202d 2d72 702d 6c6f  ncorrect --rp-lo
-0000f880: 6320 6f72 2077 6562 7365 7276 6572 2063  c or webserver c
-0000f890: 6f6e 6669 673b 2065 7870 6563 7465 6420  onfig; expected 
-0000f8a0: 7670 6174 6820 7374 6172 7469 6e67 2077  vpath starting w
-0000f8b0: 6974 6820 5b2e 2e2e 5d60 2069 7427 7320  ith [...]` it's 
-0000f8c0: 6c69 6b65 6c79 2062 6563 6175 7365 2074  likely because t
-0000f8d0: 6865 2077 6562 7365 7276 6572 2069 7320  he webserver is 
-0000f8e0: 7374 7269 7070 696e 6720 6177 6179 2074  stripping away t
-0000f8f0: 6865 2070 726f 7879 206c 6f63 6174 696f  he proxy locatio
-0000f900: 6e20 6672 6f6d 2074 6865 2072 6571 7565  n from the reque
-0000f910: 7374 2055 524c 7320 2d2d 2073 6565 2074  st URLs -- see t
-0000f920: 6865 2060 5072 6f78 7950 6173 7360 2069  he `ProxyPass` i
-0000f930: 6e20 7468 6520 6170 6163 6865 2065 7861  n the apache exa
-0000f940: 6d70 6c65 2062 656c 6f77 0a0a 6578 616d  mple below..exam
-0000f950: 706c 6520 7765 6273 6572 7665 7220 636f  ple webserver co
-0000f960: 6e66 6967 733a 0a0a 2a20 5b6e 6769 6e78  nfigs:..* [nginx
-0000f970: 2063 6f6e 6669 675d 2863 6f6e 7472 6962   config](contrib
-0000f980: 2f6e 6769 6e78 2f63 6f70 7970 6172 7479  /nginx/copyparty
-0000f990: 2e63 6f6e 6629 202d 2d20 656e 7469 7265  .conf) -- entire
-0000f9a0: 2064 6f6d 6169 6e2f 7375 6264 6f6d 6169   domain/subdomai
-0000f9b0: 6e0a 2a20 5b61 7061 6368 6532 2063 6f6e  n.* [apache2 con
-0000f9c0: 6669 675d 2863 6f6e 7472 6962 2f61 7061  fig](contrib/apa
-0000f9d0: 6368 652f 636f 7079 7061 7274 792e 636f  che/copyparty.co
-0000f9e0: 6e66 2920 2d2d 206c 6f63 6174 696f 6e2d  nf) -- location-
-0000f9f0: 6261 7365 640a 0a0a 2320 6272 6f77 7365  based...# browse
-0000fa00: 7220 7375 7070 6f72 740a 0a54 4c44 523a  r support..TLDR:
-0000fa10: 2079 6573 0a0a 215b 636f 7079 7061 7274   yes..![copypart
-0000fa20: 792d 6965 342d 6673 385d 2868 7474 7073  y-ie4-fs8](https
-0000fa30: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-0000fa40: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-0000fa50: 2e63 6f6d 2f32 3431 3033 322f 3131 3831  .com/241032/1181
-0000fa60: 3932 3739 312d 6662 3331 6665 3030 2d62  92791-fb31fe00-b
-0000fa70: 3434 362d 3131 6562 2d39 3634 372d 3839  446-11eb-9647-89
-0000fa80: 3865 6138 6566 6331 6637 2e70 6e67 290a  8ea8efc1f7.png).
-0000fa90: 0a60 6965 6020 3d20 696e 7465 726e 6574  .`ie` = internet
-0000faa0: 2d65 7870 6c6f 7265 722c 2060 6666 6020  -explorer, `ff` 
-0000fab0: 3d20 6669 7265 666f 782c 2060 6360 203d  = firefox, `c` =
-0000fac0: 2063 6872 6f6d 652c 2060 694f 5360 203d   chrome, `iOS` =
-0000fad0: 2069 5068 6f6e 652f 6950 6164 2c20 6041   iPhone/iPad, `A
-0000fae0: 6e64 7260 203d 2041 6e64 726f 6964 0a0a  ndr` = Android..
-0000faf0: 7c20 6665 6174 7572 6520 2020 2020 2020  | feature       
-0000fb00: 2020 7c20 6965 3620 7c20 6965 3920 207c    | ie6 | ie9  |
-0000fb10: 2069 6531 3020 7c20 6965 3131 207c 2066   ie10 | ie11 | f
-0000fb20: 6620 3532 207c 2063 2034 3920 7c20 694f  f 52 | c 49 | iO
-0000fb30: 5320 7c20 416e 6472 207c 0a7c 202d 2d2d  S | Andr |.| ---
-0000fb40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 207c 202d  ------------ | -
-0000fb50: 2d2d 207c 202d 2d2d 2d20 7c20 2d2d 2d2d  -- | ---- | ----
-0000fb60: 207c 202d 2d2d 2d20 7c20 2d2d 2d2d 2d20   | ---- | ----- 
-0000fb70: 7c20 2d2d 2d2d 207c 202d 2d2d 207c 202d  | ---- | --- | -
-0000fb80: 2d2d 2d20 7c0a 7c20 6272 6f77 7365 2066  --- |.| browse f
-0000fb90: 696c 6573 2020 2020 7c20 7965 7020 7c20  iles    | yep | 
-0000fba0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000fbb0: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
-0000fbc0: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
-0000fbd0: 0a7c 2074 6875 6d62 6e61 696c 2076 6965  .| thumbnail vie
-0000fbe0: 7720 207c 2020 2d20 207c 2079 6570 2020  w  |  -  | yep  
-0000fbf0: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000fc00: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
-0000fc10: 6570 207c 2079 6570 2020 7c0a 7c20 6261  ep | yep  |.| ba
-0000fc20: 7369 6320 7570 6c6f 6164 6572 2020 7c20  sic uploader  | 
-0000fc30: 7965 7020 7c20 7965 7020 207c 2079 6570  yep | yep  | yep
-0000fc40: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
-0000fc50: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
-0000fc60: 7965 7020 207c 0a7c 2075 7032 6b20 2020  yep  |.| up2k   
-0000fc70: 2020 2020 2020 2020 207c 2020 2d20 207c           |  -  |
-0000fc80: 2020 2d20 2020 7c20 602a 3160 207c 2060    -   | `*1` | `
-0000fc90: 2a31 6020 7c20 2079 6570 2020 7c20 7965  *1` |  yep  | ye
-0000fca0: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
-0000fcb0: 7c0a 7c20 6d61 6b65 2064 6972 6563 746f  |.| make directo
-0000fcc0: 7279 2020 7c20 7965 7020 7c20 7965 7020  ry  | yep | yep 
-0000fcd0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000fce0: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
-0000fcf0: 7965 7020 7c20 7965 7020 207c 0a7c 2073  yep | yep  |.| s
-0000fd00: 656e 6420 6d65 7373 6167 6520 2020 207c  end message    |
-0000fd10: 2079 6570 207c 2079 6570 2020 7c20 7965   yep | yep  | ye
-0000fd20: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
-0000fd30: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
-0000fd40: 2079 6570 2020 7c0a 7c20 7365 7420 736f   yep  |.| set so
-0000fd50: 7274 206f 7264 6572 2020 7c20 202d 2020  rt order  |  -  
-0000fd60: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000fd70: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
-0000fd80: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
-0000fd90: 207c 0a7c 207a 6970 2073 656c 6563 7469   |.| zip selecti
-0000fda0: 6f6e 2020 207c 2020 2d20 207c 2079 6570  on   |  -  | yep
-0000fdb0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
-0000fdc0: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
-0000fdd0: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
-0000fde0: 6669 6c65 2072 656e 616d 6520 2020 2020  file rename     
-0000fdf0: 7c20 202d 2020 7c20 7965 7020 207c 2079  |  -  | yep  | y
-0000fe00: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
-0000fe10: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000fe20: 7c20 7965 7020 207c 0a7c 2066 696c 6520  | yep  |.| file 
-0000fe30: 6375 742f 7061 7374 6520 207c 2020 2d20  cut/paste  |  - 
-0000fe40: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000fe50: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
-0000fe60: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
-0000fe70: 2020 7c0a 7c20 6e61 7670 616e 6520 2020    |.| navpane   
-0000fe80: 2020 2020 2020 7c20 202d 2020 7c20 7965        |  -  | ye
-0000fe90: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000fea0: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
-0000feb0: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
-0000fec0: 2069 6d61 6765 2076 6965 7765 7220 2020   image viewer   
-0000fed0: 207c 2020 2d20 207c 2079 6570 2020 7c20   |  -  | yep  | 
-0000fee0: 7965 7020 207c 2079 6570 2020 7c20 2079  yep  | yep  |  y
-0000fef0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
-0000ff00: 207c 2079 6570 2020 7c0a 7c20 7669 6465   | yep  |.| vide
-0000ff10: 6f20 706c 6179 6572 2020 2020 7c20 202d  o player    |  -
-0000ff20: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
-0000ff30: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
-0000ff40: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
-0000ff50: 7020 207c 0a7c 206d 6172 6b64 6f77 6e20  p  |.| markdown 
-0000ff60: 6564 6974 6f72 207c 2020 2d20 207c 2020  editor |  -  |  
-0000ff70: 2d20 2020 7c20 7965 7020 207c 2079 6570  -   | yep  | yep
-0000ff80: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
-0000ff90: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
-0000ffa0: 7c20 6d61 726b 646f 776e 2076 6965 7765  | markdown viewe
-0000ffb0: 7220 7c20 202d 2020 7c20 7965 7020 207c  r |  -  | yep  |
-0000ffc0: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
-0000ffd0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000ffe0: 7020 7c20 7965 7020 207c 0a7c 2070 6c61  p | yep  |.| pla
-0000fff0: 7920 6d70 332f 6d34 6120 2020 207c 2020  y mp3/m4a    |  
-00010000: 2d20 207c 2079 6570 2020 7c20 7965 7020  -  | yep  | yep 
-00010010: 207c 2079 6570 2020 7c20 2079 6570 2020   | yep  |  yep  
-00010020: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
-00010030: 6570 2020 7c0a 7c20 706c 6179 206f 6767  ep  |.| play ogg
-00010040: 2f6f 7075 7320 2020 7c20 202d 2020 7c20  /opus   |  -  | 
-00010050: 202d 2020 207c 2020 2d20 2020 7c20 202d   -   |  -   |  -
-00010060: 2020 207c 2020 7965 7020 207c 2079 6570     |  yep  | yep
-00010070: 2020 7c20 602a 3360 207c 2079 6570 207c    | `*3` | yep |
-00010080: 0a7c 202a 2a3d 2066 6561 7475 7265 203d  .| **= feature =
-00010090: 2a2a 207c 2069 6536 207c 2069 6539 2020  ** | ie6 | ie9  
-000100a0: 7c20 6965 3130 207c 2069 6531 3120 7c20  | ie10 | ie11 | 
-000100b0: 6666 2035 3220 7c20 6320 3439 207c 2069  ff 52 | c 49 | i
-000100c0: 4f53 207c 2041 6e64 7220 7c0a 0a2a 2069  OS | Andr |..* i
-000100d0: 6e74 6572 6e65 7420 6578 706c 6f72 6572  nternet explorer
-000100e0: 2036 2074 6f20 3820 6265 6861 7665 2074   6 to 8 behave t
-000100f0: 6865 2073 616d 650a 2a20 6669 7265 666f  he same.* firefo
-00010100: 7820 3532 2061 6e64 2063 6872 6f6d 6520  x 52 and chrome 
-00010110: 3439 2061 7265 2074 6865 2066 696e 616c  49 are the final
-00010120: 2077 696e 7870 2076 6572 7369 6f6e 730a   winxp versions.
-00010130: 2a20 602a 3160 2079 6573 2c20 6275 7420  * `*1` yes, but 
-00010140: 6578 7472 656d 656c 7920 736c 6f77 2028  extremely slow (
-00010150: 6965 3130 3a20 6031 204d 6942 2f73 602c  ie10: `1 MiB/s`,
-00010160: 2069 6531 313a 2060 3237 3020 4b69 422f   ie11: `270 KiB/
-00010170: 7360 290a 2a20 602a 3360 2069 4f53 2031  s`).* `*3` iOS 1
-00010180: 3120 616e 6420 6e65 7765 722c 206f 7075  1 and newer, opu
-00010190: 7320 6f6e 6c79 2c20 616e 6420 7265 7175  s only, and requ
-000101a0: 6972 6573 2046 466d 7065 6720 6f6e 2074  ires FFmpeg on t
-000101b0: 6865 2073 6572 7665 720a 0a71 7569 636b  he server..quick
-000101c0: 2073 756d 6d61 7279 206f 6620 6d6f 7265   summary of more
-000101d0: 2065 6363 656e 7472 6963 2077 6562 2d62   eccentric web-b
-000101e0: 726f 7773 6572 7320 7472 7969 6e67 2074  rowsers trying t
-000101f0: 6f20 7669 6577 2061 2064 6972 6563 746f  o view a directo
-00010200: 7279 2069 6e64 6578 3a0a 0a7c 2062 726f  ry index:..| bro
-00010210: 7773 6572 207c 2077 696c 6c20 6974 2062  wser | will it b
-00010220: 6c65 6e64 207c 0a7c 202d 2d2d 2d2d 2d2d  lend |.| -------
-00010230: 207c 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   | -------------
-00010240: 207c 0a7c 202a 2a6c 696e 6b73 2a2a 2028   |.| **links** (
-00010250: 322e 3231 2f6d 6163 706f 7274 7329 207c  2.21/macports) |
-00010260: 2063 616e 2062 726f 7773 652c 206c 6f67   can browse, log
-00010270: 696e 2c20 7570 6c6f 6164 2f6d 6b64 6972  in, upload/mkdir
-00010280: 2f6d 7367 207c 0a7c 202a 2a6c 796e 782a  /msg |.| **lynx*
-00010290: 2a20 2832 2e38 2e39 2f6d 6163 706f 7274  * (2.8.9/macport
-000102a0: 7329 207c 2063 616e 2062 726f 7773 652c  s) | can browse,
-000102b0: 206c 6f67 696e 2c20 7570 6c6f 6164 2f6d   login, upload/m
-000102c0: 6b64 6972 2f6d 7367 207c 0a7c 202a 2a77  kdir/msg |.| **w
-000102d0: 336d 2a2a 2028 302e 352e 332f 6d61 6370  3m** (0.5.3/macp
-000102e0: 6f72 7473 2920 207c 2063 616e 2062 726f  orts)  | can bro
-000102f0: 7773 652c 206c 6f67 696e 2c20 7570 6c6f  wse, login, uplo
-00010300: 6164 2061 7420 3130 306b 422f 732c 206d  ad at 100kB/s, m
-00010310: 6b64 6972 2f6d 7367 207c 0a7c 202a 2a6e  kdir/msg |.| **n
-00010320: 6574 7375 7266 2a2a 2028 332e 3130 2f61  etsurf** (3.10/a
-00010330: 7263 6829 2020 207c 2069 7320 6261 7369  rch)   | is basi
-00010340: 6361 6c6c 7920 6965 3620 7769 7468 206d  cally ie6 with m
-00010350: 7563 6820 6265 7474 6572 2063 7373 2028  uch better css (
-00010360: 6a61 7661 7363 7269 7074 2068 6173 2061  javascript has a
-00010370: 6c6d 6f73 7420 6e6f 2065 6666 6563 7429  lmost no effect)
-00010380: 207c 200a 7c20 2a2a 6f70 6572 612a 2a20   | .| **opera** 
-00010390: 2831 312e 3630 2f77 696e 7870 2920 2020  (11.60/winxp)   
-000103a0: 7c20 4f4b 3a20 7468 756d 626e 6169 6c73  | OK: thumbnails
-000103b0: 2c20 696d 6167 652d 7669 6577 6572 2c20  , image-viewer, 
-000103c0: 7a69 702d 7365 6c65 6374 696f 6e2c 2072  zip-selection, r
-000103d0: 656e 616d 652f 6375 742f 7061 7374 652e  ename/cut/paste.
-000103e0: 204e 473a 2075 7032 6b2c 206e 6176 7061   NG: up2k, navpa
-000103f0: 6e65 2c20 6d61 726b 646f 776e 2c20 6175  ne, markdown, au
-00010400: 6469 6f20 7c0a 7c20 2a2a 6965 342a 2a20  dio |.| **ie4** 
-00010410: 616e 6420 2a2a 6e65 7473 6361 7065 2a2a  and **netscape**
-00010420: 2034 2e30 2020 7c20 6361 6e20 6272 6f77   4.0  | can brow
-00010430: 7365 2c20 7570 6c6f 6164 2077 6974 6820  se, upload with 
-00010440: 603f 623d 7560 2c20 6175 7468 2077 6974  `?b=u`, auth wit
-00010450: 6820 6026 7077 3d77 6172 6b60 207c 0a7c  h `&pw=wark` |.|
-00010460: 202a 2a6e 6373 6120 6d6f 7361 6963 2a2a   **ncsa mosaic**
-00010470: 2032 2e37 2020 2020 2020 207c 2064 6f65   2.7       | doe
-00010480: 7320 6e6f 7420 6765 7420 6120 7061 7373  s not get a pass
-00010490: 2c20 5b70 6963 315d 2868 7474 7073 3a2f  , [pic1](https:/
-000104a0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-000104b0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-000104c0: 6f6d 2f32 3431 3033 322f 3137 3431 3839  om/241032/174189
-000104d0: 3232 372d 6165 3831 3630 3236 2d63 6636  227-ae816026-cf6
-000104e0: 662d 3462 6535 2d61 3236 652d 3162 3362  f-4be5-a26e-1b3b
-000104f0: 3037 3263 3162 3266 2e70 6e67 2920 2d20  072c1b2f.png) - 
-00010500: 5b70 6963 325d 2868 7474 7073 3a2f 2f75  [pic2](https://u
-00010510: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00010520: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-00010530: 2f32 3431 3033 322f 3137 3431 3839 3232  /241032/17418922
-00010540: 352d 3536 3531 6330 3539 2d35 3135 322d  5-5651c059-5152-
-00010550: 3436 6539 2d61 6332 362d 3765 3938 6534  46e9-ac26-7e98e4
-00010560: 3937 3930 3162 2e70 6e67 2920 7c0a 7c20  97901b.png) |.| 
-00010570: 2a2a 5365 7265 6e69 7479 4f53 2a2a 2028  **SerenityOS** (
-00010580: 3765 3938 3435 3729 2020 7c20 6869 7473  7e98457)  | hits
-00010590: 2061 2070 6167 6520 6661 756c 742c 2077   a page fault, w
-000105a0: 6f72 6b73 2077 6974 6820 603f 623d 7560  orks with `?b=u`
-000105b0: 2c20 6669 6c65 2075 706c 6f61 6420 6e6f  , file upload no
-000105c0: 742d 696d 706c 207c 0a0a 0a23 2063 6c69  t-impl |...# cli
-000105d0: 656e 7420 6578 616d 706c 6573 0a0a 696e  ent examples..in
-000105e0: 7465 7261 6374 2077 6974 6820 636f 7079  teract with copy
-000105f0: 7061 7274 7920 7573 696e 6720 6e6f 6e2d  party using non-
-00010600: 6272 6f77 7365 7220 636c 6965 6e74 730a  browser clients.
-00010610: 0a2a 206a 6176 6173 6372 6970 743a 2064  .* javascript: d
-00010620: 756d 7020 736f 6d65 2073 7461 7465 2069  ump some state i
-00010630: 6e74 6f20 6120 6669 6c65 2028 7477 6f20  nto a file (two 
-00010640: 7365 7061 7261 7465 2065 7861 6d70 6c65  separate example
-00010650: 7329 0a20 202a 2060 6177 6169 7420 6665  s).  * `await fe
-00010660: 7463 6828 272f 2f31 3237 2e30 2e30 2e31  tch('//127.0.0.1
-00010670: 3a33 3932 332f 272c 207b 6d65 7468 6f64  :3923/', {method
-00010680: 3a22 5055 5422 2c20 626f 6479 3a20 4a53  :"PUT", body: JS
-00010690: 4f4e 2e73 7472 696e 6769 6679 2866 6f6f  ON.stringify(foo
-000106a0: 297d 293b 600a 2020 2a20 6076 6172 2078  )});`.  * `var x
-000106b0: 6872 203d 206e 6577 2058 4d4c 4874 7470  hr = new XMLHttp
-000106c0: 5265 7175 6573 7428 293b 2078 6872 2e6f  Request(); xhr.o
-000106d0: 7065 6e28 2750 4f53 5427 2c20 272f 2f31  pen('POST', '//1
-000106e0: 3237 2e30 2e30 2e31 3a33 3932 332f 6d73  27.0.0.1:3923/ms
-000106f0: 6773 3f72 6177 2729 3b20 7868 722e 7365  gs?raw'); xhr.se
-00010700: 6e64 2827 666f 6f27 293b 600a 0a2a 2063  nd('foo');`..* c
-00010710: 7572 6c2f 7767 6574 3a20 7570 6c6f 6164  url/wget: upload
-00010720: 2073 6f6d 6520 6669 6c65 7320 2870 6f73   some files (pos
-00010730: 743d 6669 6c65 2c20 6368 756e 6b3d 7374  t=file, chunk=st
-00010740: 6469 6e29 0a20 202a 2060 706f 7374 2829  din).  * `post()
-00010750: 7b20 6375 726c 202d 4620 6163 743d 6270  { curl -F act=bp
-00010760: 7574 202d 4620 663d 4022 2431 2220 6874  ut -F f=@"$1" ht
-00010770: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a33  tp://127.0.0.1:3
-00010780: 3932 332f 3f70 773d 7761 726b 3b7d 6020  923/?pw=wark;}` 
-00010790: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-000107a0: 652e 6d6b 7660 0a20 202a 2060 706f 7374  e.mkv`.  * `post
-000107b0: 2829 7b20 6375 726c 202d 4820 7077 3a77  (){ curl -H pw:w
-000107c0: 6172 6b20 2d48 2072 616e 643a 3820 2d54  ark -H rand:8 -T
-000107d0: 2022 2431 2220 6874 7470 3a2f 2f31 3237   "$1" http://127
-000107e0: 2e30 2e30 2e31 3a33 3932 332f 3b7d 6020  .0.0.1:3923/;}` 
-000107f0: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-00010800: 652e 6d6b 7660 0a20 202a 2060 706f 7374  e.mkv`.  * `post
-00010810: 2829 7b20 7767 6574 202d 2d68 6561 6465  (){ wget --heade
-00010820: 723d 2770 773a 2077 6172 6b27 202d 2d70  r='pw: wark' --p
-00010830: 6f73 742d 6669 6c65 3d22 2431 2220 2d4f  ost-file="$1" -O
-00010840: 2d20 6874 7470 3a2f 2f31 3237 2e30 2e30  - http://127.0.0
-00010850: 2e31 3a33 3932 332f 3f72 6177 3b7d 6020  .1:3923/?raw;}` 
-00010860: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-00010870: 652e 6d6b 7660 0a20 202a 2060 6368 756e  e.mkv`.  * `chun
-00010880: 6b28 297b 2063 7572 6c20 2d48 2070 773a  k(){ curl -H pw:
-00010890: 7761 726b 202d 542d 2068 7474 703a 2f2f  wark -T- http://
-000108a0: 3132 372e 302e 302e 313a 3339 3233 2f3b  127.0.0.1:3923/;
-000108b0: 7d60 2020 0a20 2020 2060 6368 756e 6b20  }`  .    `chunk 
-000108c0: 3c6d 6f76 6965 2e6d 6b76 600a 0a2a 2062  <movie.mkv`..* b
-000108d0: 6173 683a 2077 6865 6e20 6375 726c 2061  ash: when curl a
-000108e0: 6e64 2077 6765 7420 6973 206e 6f74 2061  nd wget is not a
-000108f0: 7661 696c 6162 6c65 206f 7220 746f 6f20  vailable or too 
-00010900: 626f 7269 6e67 0a20 202a 2060 2870 7269  boring.  * `(pri
-00010910: 6e74 6620 2750 5554 202f 6a75 6e6b 3f70  ntf 'PUT /junk?p
-00010920: 773d 7761 726b 2048 5454 502f 312e 315c  w=wark HTTP/1.1\
-00010930: 725c 6e5c 725c 6e27 3b20 6361 7420 6d6f  r\n\r\n'; cat mo
-00010940: 7669 652e 6d6b 7629 207c 206e 6320 3132  vie.mkv) | nc 12
-00010950: 372e 302e 302e 3120 3339 3233 600a 2020  7.0.0.1 3923`.  
-00010960: 2a20 6028 7072 696e 7466 2027 5055 5420  * `(printf 'PUT 
-00010970: 2f20 4854 5450 2f31 2e31 5c72 5c6e 5c72  / HTTP/1.1\r\n\r
-00010980: 5c6e 273b 2063 6174 206d 6f76 6965 2e6d  \n'; cat movie.m
-00010990: 6b76 2920 3e2f 6465 762f 7463 702f 3132  kv) >/dev/tcp/12
-000109a0: 372e 302e 302e 312f 3339 3233 600a 0a2a  7.0.0.1/3923`..*
-000109b0: 2070 7974 686f 6e3a 205b 7570 326b 2e70   python: [up2k.p
-000109c0: 795d 2868 7474 7073 3a2f 2f67 6974 6875  y](https://githu
-000109d0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-000109e0: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-000109f0: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00010a00: 7929 2069 7320 6120 636f 6d6d 616e 642d  y) is a command-
-00010a10: 6c69 6e65 2075 7032 6b20 636c 6965 6e74  line up2k client
-00010a20: 205b 2877 6562 6d29 5d28 6874 7470 733a   [(webm)](https:
-00010a30: 2f2f 6f63 762e 6d65 2f73 7475 6666 2f75  //ocv.me/stuff/u
-00010a40: 3263 6c69 2e77 6562 6d29 0a20 202a 2066  2cli.webm).  * f
-00010a50: 696c 6520 7570 6c6f 6164 732c 2066 696c  ile uploads, fil
-00010a60: 652d 7365 6172 6368 2c20 666f 6c64 6572  e-search, folder
-00010a70: 2073 796e 632c 2061 7574 6f72 6573 756d   sync, autoresum
-00010a80: 6520 6f66 2061 626f 7274 6564 2f62 726f  e of aborted/bro
-00010a90: 6b65 6e20 7570 6c6f 6164 730a 2020 2a20  ken uploads.  * 
-00010aa0: 6361 6e20 6265 2064 6f77 6e6c 6f61 6465  can be downloade
-00010ab0: 6420 6672 6f6d 2063 6f70 7970 6172 7479  d from copyparty
-00010ac0: 3a20 636f 6e74 726f 6c70 616e 656c 202d  : controlpanel -
-00010ad0: 3e20 636f 6e6e 6563 7420 2d3e 205b 7570  > connect -> [up
-00010ae0: 326b 2e70 795d 2868 7474 703a 2f2f 3132  2k.py](http://12
-00010af0: 372e 302e 302e 313a 3339 3233 2f2e 6370  7.0.0.1:3923/.cp
-00010b00: 722f 612f 7570 326b 2e70 7929 0a20 202a  r/a/up2k.py).  *
-00010b10: 2073 6565 205b 2e2f 6269 6e2f 5245 4144   see [./bin/READ
-00010b20: 4d45 2e6d 6423 7570 326b 7079 5d28 6269  ME.md#up2kpy](bi
-00010b30: 6e2f 5245 4144 4d45 2e6d 6423 7570 326b  n/README.md#up2k
-00010b40: 7079 290a 0a2a 2046 5553 453a 206d 6f75  py)..* FUSE: mou
-00010b50: 6e74 2061 2063 6f70 7970 6172 7479 2073  nt a copyparty s
-00010b60: 6572 7665 7220 6173 2061 206c 6f63 616c  erver as a local
-00010b70: 2066 696c 6573 7973 7465 6d0a 2020 2a20   filesystem.  * 
-00010b80: 6372 6f73 732d 706c 6174 666f 726d 2070  cross-platform p
-00010b90: 7974 686f 6e20 636c 6965 6e74 2061 7661  ython client ava
-00010ba0: 696c 6162 6c65 2069 6e20 5b2e 2f62 696e  ilable in [./bin
-00010bb0: 2f5d 2862 696e 2f29 0a20 202a 2063 616e  /](bin/).  * can
-00010bc0: 2062 6520 646f 776e 6c6f 6164 6564 2066   be downloaded f
-00010bd0: 726f 6d20 636f 7079 7061 7274 793a 2063  rom copyparty: c
-00010be0: 6f6e 7472 6f6c 7061 6e65 6c20 2d3e 2063  ontrolpanel -> c
-00010bf0: 6f6e 6e65 6374 202d 3e20 5b70 6172 7479  onnect -> [party
-00010c00: 6675 7365 2e70 795d 2868 7474 703a 2f2f  fuse.py](http://
-00010c10: 3132 372e 302e 302e 313a 3339 3233 2f2e  127.0.0.1:3923/.
-00010c20: 6370 722f 612f 7061 7274 7966 7573 652e  cpr/a/partyfuse.
-00010c30: 7079 290a 2020 2a20 5b72 636c 6f6e 655d  py).  * [rclone]
-00010c40: 2868 7474 7073 3a2f 2f72 636c 6f6e 652e  (https://rclone.
-00010c50: 6f72 672f 2920 6173 2063 6c69 656e 7420  org/) as client 
-00010c60: 6361 6e20 6769 7665 207e 3578 2070 6572  can give ~5x per
-00010c70: 666f 726d 616e 6365 2c20 7365 6520 5b2e  formance, see [.
-00010c80: 2f64 6f63 732f 7263 6c6f 6e65 2e6d 645d  /docs/rclone.md]
-00010c90: 2864 6f63 732f 7263 6c6f 6e65 2e6d 6429  (docs/rclone.md)
-00010ca0: 0a0a 2a20 7368 6172 6578 2028 7363 7265  ..* sharex (scre
-00010cb0: 656e 7368 6f74 2075 7469 6c69 7479 293a  enshot utility):
-00010cc0: 2073 6565 205b 2e2f 636f 6e74 7269 622f   see [./contrib/
-00010cd0: 7368 6172 6578 2e73 7863 755d 2863 6f6e  sharex.sxcu](con
-00010ce0: 7472 6962 2f23 7368 6172 6578 7378 6375  trib/#sharexsxcu
-00010cf0: 290a 0a63 6f70 7970 6172 7479 2072 6574  )..copyparty ret
-00010d00: 7572 6e73 2061 2074 7275 6e63 6174 6564  urns a truncated
-00010d10: 2073 6861 3531 3273 756d 206f 6620 796f   sha512sum of yo
-00010d20: 7572 2050 5554 2f50 4f53 5420 6173 2062  ur PUT/POST as b
-00010d30: 6173 6536 343b 2079 6f75 2063 616e 2067  ase64; you can g
-00010d40: 656e 6572 6174 6520 7468 6520 7361 6d65  enerate the same
-00010d50: 2063 6865 636b 7375 6d20 6c6f 6361 6c6c   checksum locall
-00010d60: 7920 746f 2076 6572 6966 7920 7570 6c61  y to verify upla
-00010d70: 6f64 733a 0a0a 2020 2020 6235 3132 2829  ods:..    b512()
-00010d80: 7b20 7072 696e 7466 2022 2428 2873 6861  { printf "$((sha
-00010d90: 3531 3273 756d 7c7c 7368 6173 756d 202d  512sum||shasum -
-00010da0: 6135 3132 297c 7365 6420 2d45 2027 732f  a512)|sed -E 's/
-00010db0: 202e 2a2f 2f3b 732f 282e 2e29 2f5c 5c78   .*//;s/(..)/\\x
-00010dc0: 5c31 2f67 2729 227c 6261 7365 3634 7c74  \1/g')"|base64|t
-00010dd0: 7220 272b 2f27 2027 2d5f 277c 6865 6164  r '+/' '-_'|head
-00010de0: 202d 6334 343b 7d0a 2020 2020 6235 3132   -c44;}.    b512
-00010df0: 203c 6d6f 7669 652e 6d6b 760a 0a79 6f75   <movie.mkv..you
-00010e00: 2063 616e 2070 726f 7669 6465 2070 6173   can provide pas
-00010e10: 7377 6f72 6473 2075 7369 6e67 2068 6561  swords using hea
-00010e20: 6465 7220 6050 573a 2068 756e 7465 7232  der `PW: hunter2
-00010e30: 602c 2063 6f6f 6b69 6520 6063 7070 7764  `, cookie `cppwd
-00010e40: 3d68 756e 7465 7232 602c 2075 726c 2d70  =hunter2`, url-p
-00010e50: 6172 616d 2060 3f70 773d 6875 6e74 6572  aram `?pw=hunter
-00010e60: 3260 2c20 6f72 2077 6974 6820 6261 7369  2`, or with basi
-00010e70: 632d 6175 7468 656e 7469 6361 7469 6f6e  c-authentication
-00010e80: 2028 6569 7468 6572 2061 7320 7468 6520   (either as the 
-00010e90: 7573 6572 6e61 6d65 206f 7220 7061 7373  username or pass
-00010ea0: 776f 7264 290a 0a4e 4f54 453a 2063 7572  word)..NOTE: cur
-00010eb0: 6c20 7769 6c6c 206e 6f74 2073 656e 6420  l will not send 
-00010ec0: 7468 6520 6f72 6967 696e 616c 2066 696c  the original fil
-00010ed0: 656e 616d 6520 6966 2079 6f75 2075 7365  ename if you use
-00010ee0: 2060 2d54 6020 636f 6d62 696e 6564 2077   `-T` combined w
-00010ef0: 6974 6820 7572 6c2d 7061 7261 6d73 2120  ith url-params! 
-00010f00: 416c 736f 2c20 6d61 6b65 2073 7572 6520  Also, make sure 
-00010f10: 746f 2061 6c77 6179 7320 6c65 6176 6520  to always leave 
-00010f20: 6120 7472 6169 6c69 6e67 2073 6c61 7368  a trailing slash
-00010f30: 2069 6e20 5552 4c73 2075 6e6c 6573 7320   in URLs unless 
-00010f40: 796f 7520 7761 6e74 2074 6f20 6f76 6572  you want to over
-00010f50: 7269 6465 2074 6865 2066 696c 656e 616d  ride the filenam
-00010f60: 650a 0a0a 2323 206d 6f75 6e74 2061 7320  e...## mount as 
-00010f70: 6472 6976 650a 0a61 2072 656d 6f74 6520  drive..a remote 
-00010f80: 636f 7079 7061 7274 7920 7365 7276 6572  copyparty server
-00010f90: 2061 7320 6120 6c6f 6361 6c20 6669 6c65   as a local file
-00010fa0: 7379 7374 656d 3b20 2067 6f20 746f 2074  system;  go to t
-00010fb0: 6865 2063 6f6e 7472 6f6c 2d70 616e 656c  he control-panel
-00010fc0: 2061 6e64 2063 6c69 636b 2060 636f 6e6e   and click `conn
-00010fd0: 6563 7460 2074 6f20 7365 6520 6120 6c69  ect` to see a li
-00010fe0: 7374 206f 6620 636f 6d6d 616e 6473 2074  st of commands t
-00010ff0: 6f20 646f 2074 6861 740a 0a61 6c74 6572  o do that..alter
-00011000: 6e61 7469 7665 6c79 2c20 736f 6d65 2061  natively, some a
-00011010: 6c74 6572 6e61 7469 7665 7320 726f 7567  lternatives roug
-00011020: 686c 7920 736f 7274 6564 2062 7920 7370  hly sorted by sp
-00011030: 6565 6420 2875 6e72 6570 726f 6475 6369  eed (unreproduci
-00011040: 626c 6520 6265 6e63 686d 6172 6b29 2c20  ble benchmark), 
-00011050: 6265 7374 2066 6972 7374 3a0a 0a2a 205b  best first:..* [
-00011060: 7263 6c6f 6e65 2d68 7474 705d 282e 2f64  rclone-http](./d
-00011070: 6f63 732f 7263 6c6f 6e65 2e6d 6429 2028  ocs/rclone.md) (
-00011080: 3235 7329 2c20 7265 6164 2d6f 6e6c 790a  25s), read-only.
-00011090: 2a20 5b72 636c 6f6e 652d 6674 705d 282e  * [rclone-ftp](.
-000110a0: 2f64 6f63 732f 7263 6c6f 6e65 2e6d 6429  /docs/rclone.md)
-000110b0: 2028 3437 7329 2c20 7265 6164 2f57 5249   (47s), read/WRI
-000110c0: 5445 0a2a 205b 7263 6c6f 6e65 2d77 6562  TE.* [rclone-web
-000110d0: 6461 765d 282e 2f64 6f63 732f 7263 6c6f  dav](./docs/rclo
-000110e0: 6e65 2e6d 6429 2028 3531 7329 2c20 7265  ne.md) (51s), re
-000110f0: 6164 2f57 5249 5445 0a20 202a 2063 6f70  ad/WRITE.  * cop
-00011100: 7970 6172 7479 2d31 2e35 2e30 2773 2077  yparty-1.5.0's w
-00011110: 6562 6461 7620 7365 7276 6572 2069 7320  ebdav server is 
-00011120: 6661 7374 6572 2074 6861 6e20 7263 6c6f  faster than rclo
-00011130: 6e65 2d31 2e36 302e 3020 2836 3973 290a  ne-1.60.0 (69s).
-00011140: 2a20 5b70 6172 7479 6675 7365 2e70 795d  * [partyfuse.py]
-00011150: 282e 2f62 696e 2f23 7061 7274 7966 7573  (./bin/#partyfus
-00011160: 6570 7929 2028 3731 7329 2c20 7265 6164  epy) (71s), read
-00011170: 2d6f 6e6c 790a 2a20 6461 7666 7332 2028  -only.* davfs2 (
-00011180: 3130 3373 292c 2072 6561 642f 5752 4954  103s), read/WRIT
-00011190: 452c 202a 7665 7279 2066 6173 742a 206f  E, *very fast* o
-000111a0: 6e20 736d 616c 6c20 6669 6c65 730a 2a20  n small files.* 
-000111b0: 5b77 696e 3130 2d77 6562 6461 765d 2823  [win10-webdav](#
-000111c0: 7765 6264 6176 2d73 6572 7665 7229 2028  webdav-server) (
-000111d0: 3133 3873 292c 2072 6561 642f 5752 4954  138s), read/WRIT
-000111e0: 450a 2a20 5b77 696e 3130 2d73 6d62 325d  E.* [win10-smb2]
-000111f0: 2823 736d 622d 7365 7276 6572 2920 2833  (#smb-server) (3
-00011200: 3837 7329 2c20 7265 6164 2f57 5249 5445  87s), read/WRITE
-00011210: 0a0a 6d6f 7374 2063 6c69 656e 7473 2077  ..most clients w
-00011220: 696c 6c20 6661 696c 2074 6f20 6d6f 756e  ill fail to moun
-00011230: 7420 7468 6520 726f 6f74 206f 6620 6120  t the root of a 
-00011240: 636f 7079 7061 7274 7920 7365 7276 6572  copyparty server
-00011250: 2075 6e6c 6573 7320 7468 6572 6520 6973   unless there is
-00011260: 2061 2072 6f6f 7420 766f 6c75 6d65 2028   a root volume (
-00011270: 736f 2079 6f75 2067 6574 2074 6865 2061  so you get the a
-00011280: 646d 696e 2d70 616e 656c 2069 6e73 7465  dmin-panel inste
-00011290: 6164 206f 6620 6120 6272 6f77 7365 7220  ad of a browser 
-000112a0: 7768 656e 2061 6363 6573 7369 6e67 2069  when accessing i
-000112b0: 7429 202d 2d20 696e 2074 6861 7420 6361  t) -- in that ca
-000112c0: 7365 2c20 6d6f 756e 7420 6120 7370 6563  se, mount a spec
-000112d0: 6966 6963 2076 6f6c 756d 6520 696e 7374  ific volume inst
-000112e0: 6561 640a 0a0a 2320 7065 7266 6f72 6d61  ead...# performa
-000112f0: 6e63 650a 0a64 6566 6175 6c74 7320 6172  nce..defaults ar
-00011300: 6520 7573 7561 6c6c 7920 6669 6e65 202d  e usually fine -
-00011310: 2065 7870 6563 7420 6038 2047 6942 2f73   expect `8 GiB/s
-00011320: 6020 646f 776e 6c6f 6164 2c20 6031 2047  ` download, `1 G
-00011330: 6942 2f73 6020 7570 6c6f 6164 0a0a 6265  iB/s` upload..be
-00011340: 6c6f 7720 6172 6520 736f 6d65 2074 7765  low are some twe
-00011350: 616b 7320 726f 7567 686c 7920 6f72 6465  aks roughly orde
-00011360: 7265 6420 6279 2075 7365 6675 6c6e 6573  red by usefulnes
-00011370: 733a 0a0a 2a20 602d 7160 2064 6973 6162  s:..* `-q` disab
-00011380: 6c65 7320 6c6f 6767 696e 6720 616e 6420  les logging and 
-00011390: 6361 6e20 6865 6c70 2061 2062 756e 6368  can help a bunch
-000113a0: 2c20 6576 656e 2077 6865 6e20 636f 6d62  , even when comb
-000113b0: 696e 6564 2077 6974 6820 602d 6c6f 6020  ined with `-lo` 
-000113c0: 746f 2072 6564 6972 6563 7420 6c6f 6773  to redirect logs
-000113d0: 2074 6f20 6669 6c65 0a2a 2060 2d2d 6874   to file.* `--ht
-000113e0: 7470 2d6f 6e6c 7960 206f 7220 602d 2d68  tp-only` or `--h
-000113f0: 7474 7073 2d6f 6e6c 7960 2028 756e 6c65  ttps-only` (unle
-00011400: 7373 2079 6f75 2077 616e 7420 746f 2073  ss you want to s
-00011410: 7570 706f 7274 2062 6f74 6820 7072 6f74  upport both prot
-00011420: 6f63 6f6c 7329 2077 696c 6c20 7265 6475  ocols) will redu
-00011430: 6365 2074 6865 2064 656c 6179 2062 6566  ce the delay bef
-00011440: 6f72 6520 6120 6e65 7720 636f 6e6e 6563  ore a new connec
-00011450: 7469 6f6e 2069 7320 6573 7461 626c 6973  tion is establis
-00011460: 6865 640a 2a20 602d 2d68 6973 7460 2070  hed.* `--hist` p
-00011470: 6f69 6e74 696e 6720 746f 2061 2066 6173  ointing to a fas
-00011480: 7420 6c6f 6361 7469 6f6e 2028 7373 6429  t location (ssd)
-00011490: 2077 696c 6c20 6d61 6b65 2064 6972 6563   will make direc
-000114a0: 746f 7279 206c 6973 7469 6e67 7320 616e  tory listings an
-000114b0: 6420 7365 6172 6368 6573 2066 6173 7465  d searches faste
-000114c0: 7220 7768 656e 2060 2d65 3264 6020 6f72  r when `-e2d` or
-000114d0: 2060 2d65 3274 6020 6973 2073 6574 0a2a   `-e2t` is set.*
-000114e0: 2060 2d2d 6e6f 2d68 6173 6820 2e60 2077   `--no-hash .` w
-000114f0: 6865 6e20 696e 6465 7869 6e67 2061 206e  hen indexing a n
-00011500: 6574 776f 726b 2d64 6973 6b20 6966 2079  etwork-disk if y
-00011510: 6f75 2064 6f6e 2774 2063 6172 6520 6162  ou don't care ab
-00011520: 6f75 7420 7468 6520 6163 7475 616c 2066  out the actual f
-00011530: 696c 6568 6173 6865 7320 616e 6420 6f6e  ilehashes and on
-00011540: 6c79 2077 616e 7420 7468 6520 6e61 6d65  ly want the name
-00011550: 732f 7461 6773 2073 6561 7263 6861 626c  s/tags searchabl
-00011560: 650a 2a20 602d 2d6e 6f2d 6874 7020 2d2d  e.* `--no-htp --
-00011570: 6861 7368 2d6d 743d 3020 2d2d 6d74 6167  hash-mt=0 --mtag
-00011580: 2d6d 743d 3120 2d2d 7468 2d6d 743d 3160  -mt=1 --th-mt=1`
-00011590: 206d 696e 696d 697a 6573 2074 6865 206e   minimizes the n
-000115a0: 756d 6265 7220 6f66 2074 6872 6561 6473  umber of threads
-000115b0: 3b20 6361 6e20 6865 6c70 2069 6e20 736f  ; can help in so
-000115c0: 6d65 2065 6363 656e 7472 6963 2065 6e76  me eccentric env
-000115d0: 6972 6f6e 6d65 6e74 7320 286c 696b 6520  ironments (like 
-000115e0: 7468 6520 7673 636f 6465 2064 6562 7567  the vscode debug
-000115f0: 6765 7229 0a2a 2060 2d6a 6020 656e 6162  ger).* `-j` enab
-00011600: 6c65 7320 6d75 6c74 6970 726f 6365 7373  les multiprocess
-00011610: 696e 6720 2861 6374 7561 6c20 6d75 6c74  ing (actual mult
-00011620: 6974 6872 6561 6469 6e67 2920 616e 6420  ithreading) and 
-00011630: 6361 6e20 6d61 6b65 2063 6f70 7970 6172  can make copypar
-00011640: 7479 2070 6572 666f 726d 2062 6574 7465  ty perform bette
-00011650: 7220 696e 2063 7075 2d69 6e74 656e 7369  r in cpu-intensi
-00011660: 7665 2077 6f72 6b6c 6f61 6473 2c20 666f  ve workloads, fo
-00011670: 7220 6578 616d 706c 653a 0a20 202a 2068  r example:.  * h
-00011680: 7567 6520 616d 6f75 6e74 206f 6620 7368  uge amount of sh
-00011690: 6f72 742d 6c69 7665 6420 636f 6e6e 6563  ort-lived connec
-000116a0: 7469 6f6e 730a 2020 2a20 7369 6d75 6c74  tions.  * simult
-000116b0: 616e 656f 7573 2064 6f77 6e6c 6f61 6473  aneous downloads
-000116c0: 2061 6e64 2075 706c 6f61 6473 2073 6174   and uploads sat
-000116d0: 7572 6174 696e 6720 6120 3230 6762 7073  urating a 20gbps
-000116e0: 2063 6f6e 6e65 6374 696f 6e0a 2020 0a20   connection.  . 
-000116f0: 202e 2e2e 686f 7765 7665 7220 6974 2061   ...however it a
-00011700: 6464 7320 616e 206f 7665 7268 6561 6420  dds an overhead 
-00011710: 746f 2069 6e74 6572 6e61 6c20 636f 6d6d  to internal comm
-00011720: 756e 6963 6174 696f 6e20 736f 2069 7420  unication so it 
-00011730: 6d69 6768 7420 6265 2061 206e 6574 206c  might be a net l
-00011740: 6f73 732c 2073 6565 2069 6620 6974 2077  oss, see if it w
-00011750: 6f72 6b73 2034 2075 0a0a 0a23 2320 636c  orks 4 u...## cl
-00011760: 6965 6e74 2d73 6964 650a 0a77 6865 6e20  ient-side..when 
-00011770: 7570 6c6f 6164 696e 6720 6669 6c65 732c  uploading files,
-00011780: 0a0a 2a20 6368 726f 6d65 2069 7320 7265  ..* chrome is re
-00011790: 636f 6d6d 656e 6465 642c 2061 7420 6c65  commended, at le
-000117a0: 6173 7420 636f 6d70 6172 6564 2074 6f20  ast compared to 
-000117b0: 6669 7265 666f 783a 0a20 202a 2075 7020  firefox:.  * up 
-000117c0: 746f 2039 3025 2066 6173 7465 7220 7768  to 90% faster wh
-000117d0: 656e 2068 6173 6869 6e67 2c20 6573 7065  en hashing, espe
-000117e0: 6369 616c 6c79 206f 6e20 5353 4473 0a20  cially on SSDs. 
-000117f0: 202a 2075 7020 746f 2034 3025 2066 6173   * up to 40% fas
-00011800: 7465 7220 7768 656e 2075 706c 6f61 6469  ter when uploadi
-00011810: 6e67 206f 7665 7220 6578 7472 656d 656c  ng over extremel
-00011820: 7920 6661 7374 2069 6e74 6572 6e65 7473  y fast internets
-00011830: 0a20 202a 2062 7574 205b 7570 326b 2e70  .  * but [up2k.p
-00011840: 795d 2868 7474 7073 3a2f 2f67 6974 6875  y](https://githu
-00011850: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00011860: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-00011870: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00011880: 7929 2063 616e 2062 6520 3430 2520 6661  y) can be 40% fa
-00011890: 7374 6572 2074 6861 6e20 6368 726f 6d65  ster than chrome
-000118a0: 2061 6761 696e 0a0a 2a20 6966 2079 6f75   again..* if you
-000118b0: 2772 6520 6370 752d 626f 7474 6c65 6e65  're cpu-bottlene
-000118c0: 636b 6564 2c20 6f72 2074 6865 2062 726f  cked, or the bro
-000118d0: 7773 6572 2069 7320 6d61 7869 6e67 2061  wser is maxing a
-000118e0: 2063 7075 2063 6f72 653a 0a20 202a 2075   cpu core:.  * u
-000118f0: 7020 746f 2033 3025 2066 6173 7465 7220  p to 30% faster 
-00011900: 7570 6c6f 6164 7320 6966 2079 6f75 2068  uploads if you h
-00011910: 6964 6520 7468 6520 7570 6c6f 6164 2073  ide the upload s
-00011920: 7461 7475 7320 6c69 7374 2062 7920 7377  tatus list by sw
-00011930: 6974 6368 696e 6720 6177 6179 2066 726f  itching away fro
-00011940: 6d20 7468 6520 605b f09f 9a80 5d60 2075  m the `[....]` u
-00011950: 7032 6b20 7569 2d74 6162 2028 6f72 2063  p2k ui-tab (or c
-00011960: 6c6f 7369 6e67 2069 7429 0a20 2020 202a  losing it).    *
-00011970: 206f 7074 696f 6e61 6c6c 7920 796f 7520   optionally you 
-00011980: 6361 6e20 7377 6974 6368 2074 6f20 7468  can switch to th
-00011990: 6520 6c69 6768 7477 6569 6768 7420 706f  e lightweight po
-000119a0: 7461 746f 2075 6920 6279 2063 6c69 636b  tato ui by click
-000119b0: 696e 6720 7468 6520 605b f09f a594 5d60  ing the `[....]`
-000119c0: 0a20 2020 202a 2073 7769 7463 6869 6e67  .    * switching
-000119d0: 2074 6f20 616e 6f74 6865 7220 6272 6f77   to another brow
-000119e0: 7365 722d 7461 6220 616c 736f 2077 6f72  ser-tab also wor
-000119f0: 6b73 2c20 7468 6520 6661 7669 636f 6e20  ks, the favicon 
-00011a00: 7769 6c6c 2075 7064 6174 6520 6576 6572  will update ever
-00011a10: 7920 3130 2073 6563 6f6e 6473 2069 6e20  y 10 seconds in 
-00011a20: 7468 6174 2063 6173 650a 2020 2a20 756e  that case.  * un
-00011a30: 6c69 6b65 6c79 2074 6f20 6265 2061 2070  likely to be a p
-00011a40: 726f 626c 656d 2c20 6275 7420 6361 6e20  roblem, but can 
-00011a50: 6861 7070 656e 2077 6865 6e20 7570 6c6f  happen when uplo
-00011a60: 6469 6e67 206d 616e 7920 736d 616c 6c20  ding many small 
-00011a70: 6669 6c65 732c 206f 7220 796f 7572 2069  files, or your i
-00011a80: 6e74 6572 6e65 7420 6973 2074 6f6f 2066  nternet is too f
-00011a90: 6173 742c 206f 7220 5043 2074 6f6f 2073  ast, or PC too s
-00011aa0: 6c6f 770a 0a0a 2320 7365 6375 7269 7479  low...# security
-00011ab0: 0a0a 736f 6d65 206e 6f74 6573 206f 6e20  ..some notes on 
-00011ac0: 6861 7264 656e 696e 670a 0a2a 2073 6574  hardening..* set
-00011ad0: 2060 2d2d 7270 726f 7879 2030 6020 6966   `--rproxy 0` if
-00011ae0: 2079 6f75 7220 636f 7079 7061 7274 7920   your copyparty 
-00011af0: 6973 2064 6972 6563 746c 7920 6661 6369  is directly faci
-00011b00: 6e67 2074 6865 2069 6e74 6572 6e65 7420  ng the internet 
-00011b10: 286e 6f74 2074 6872 6f75 6768 2061 2072  (not through a r
-00011b20: 6576 6572 7365 2d70 726f 7879 290a 2020  everse-proxy).  
-00011b30: 2a20 636f 7273 2064 6f65 736e 2774 2077  * cors doesn't w
-00011b40: 6f72 6b20 7269 6768 7420 6f74 6865 7277  ork right otherw
-00011b50: 6973 650a 0a73 6166 6574 7920 7072 6f66  ise..safety prof
-00011b60: 696c 6573 3a0a 0a2a 206f 7074 696f 6e20  iles:..* option 
-00011b70: 602d 7360 2069 7320 6120 7368 6f72 7463  `-s` is a shortc
-00011b80: 7574 2074 6f20 7365 7420 7468 6520 666f  ut to set the fo
-00011b90: 6c6c 6f77 696e 6720 6f70 7469 6f6e 733a  llowing options:
-00011ba0: 0a20 202a 2060 2d2d 6e6f 2d74 6875 6d62  .  * `--no-thumb
-00011bb0: 6020 6469 7361 626c 6573 2074 6875 6d62  ` disables thumb
-00011bc0: 6e61 696c 7320 616e 6420 6175 6469 6f20  nails and audio 
-00011bd0: 7472 616e 7363 6f64 696e 6720 746f 2073  transcoding to s
-00011be0: 746f 7020 636f 7079 7061 7274 7920 6672  top copyparty fr
-00011bf0: 6f6d 2072 756e 6e69 6e67 2060 4646 6d70  om running `FFmp
-00011c00: 6567 602f 6050 696c 6c6f 7760 2f60 5649  eg`/`Pillow`/`VI
-00011c10: 5053 6020 6f6e 2075 706c 6f61 6465 6420  PS` on uploaded 
-00011c20: 6669 6c65 732c 2077 6869 6368 2069 7320  files, which is 
-00011c30: 6120 5b67 6f6f 6420 6964 6561 5d28 6874  a [good idea](ht
-00011c40: 7470 733a 2f2f 7777 772e 6376 6564 6574  tps://www.cvedet
-00011c50: 6169 6c73 2e63 6f6d 2f76 756c 6e65 7261  ails.com/vulnera
-00011c60: 6269 6c69 7479 2d6c 6973 742e 7068 703f  bility-list.php?
-00011c70: 7665 6e64 6f72 5f69 643d 3336 3131 2920  vendor_id=3611) 
-00011c80: 6966 2061 6e6f 6e79 6d6f 7573 2075 706c  if anonymous upl
-00011c90: 6f61 6420 6973 2065 6e61 626c 6564 0a20  oad is enabled. 
-00011ca0: 202a 2060 2d2d 6e6f 2d6d 7461 672d 6666   * `--no-mtag-ff
-00011cb0: 6020 7573 6573 2060 6d75 7461 6765 6e60  ` uses `mutagen`
-00011cc0: 2074 6f20 6772 6162 206d 7573 6963 2074   to grab music t
-00011cd0: 6167 7320 696e 7374 6561 6420 6f66 2060  ags instead of `
-00011ce0: 4646 6d70 6567 602c 2077 6869 6368 2069  FFmpeg`, which i
-00011cf0: 7320 7361 6665 7220 616e 6420 6661 7374  s safer and fast
-00011d00: 6572 2062 7574 206c 6573 7320 6163 6375  er but less accu
-00011d10: 7261 7465 0a20 202a 2060 2d2d 646f 7470  rate.  * `--dotp
-00011d20: 6172 7460 2068 6964 6573 2075 706c 6f61  art` hides uploa
-00011d30: 6473 2066 726f 6d20 6469 7265 6374 6f72  ds from director
-00011d40: 7920 6c69 7374 696e 6773 2077 6869 6c65  y listings while
-00011d50: 2074 6865 7927 7265 2073 7469 6c6c 2069   they're still i
-00011d60: 6e63 6f6d 696e 670a 2020 2a20 602d 2d6e  ncoming.  * `--n
-00011d70: 6f2d 726f 626f 7473 6020 616e 6420 602d  o-robots` and `-
-00011d80: 2d66 6f72 6365 2d6a 7360 206d 616b 6573  -force-js` makes
-00011d90: 206c 6966 6520 6861 7264 6572 2066 6f72   life harder for
-00011da0: 2063 7261 776c 6572 732c 2073 6565 205b   crawlers, see [
-00011db0: 6869 6469 6e67 2066 726f 6d20 676f 6f67  hiding from goog
-00011dc0: 6c65 5d28 2368 6964 696e 672d 6672 6f6d  le](#hiding-from
-00011dd0: 2d67 6f6f 676c 6529 0a0a 2a20 6f70 7469  -google)..* opti
-00011de0: 6f6e 2060 2d73 7360 2069 7320 6120 7368  on `-ss` is a sh
-00011df0: 6f72 7463 7574 2066 6f72 2074 6865 2061  ortcut for the a
-00011e00: 626f 7665 2070 6c75 733a 0a20 202a 2060  bove plus:.  * `
-00011e10: 2d2d 756e 706f 7374 2030 602c 2060 2d2d  --unpost 0`, `--
-00011e20: 6e6f 2d64 656c 602c 2060 2d2d 6e6f 2d6d  no-del`, `--no-m
-00011e30: 7660 2064 6973 6162 6c65 7320 616c 6c20  v` disables all 
-00011e40: 6d6f 7665 2f64 656c 6574 6520 7375 7070  move/delete supp
-00011e50: 6f72 740a 2020 2a20 602d 2d68 6172 646c  ort.  * `--hardl
-00011e60: 696e 6b60 2063 7265 6174 6573 2068 6172  ink` creates har
-00011e70: 646c 696e 6b73 2069 6e73 7465 6164 206f  dlinks instead o
-00011e80: 6620 7379 6d6c 696e 6b73 2077 6865 6e20  f symlinks when 
-00011e90: 6465 6475 706c 6963 6174 696e 6720 7570  deduplicating up
-00011ea0: 6c6f 6164 732c 2077 6869 6368 2069 7320  loads, which is 
-00011eb0: 6c65 7373 206d 6169 6e74 656e 616e 6365  less maintenance
-00011ec0: 0a20 2020 202a 2068 6f77 6576 6572 206e  .    * however n
-00011ed0: 6f74 6520 6966 2079 6f75 2065 6469 7420  ote if you edit 
-00011ee0: 6f6e 6520 6669 6c65 2069 7420 7769 6c6c  one file it will
-00011ef0: 2061 6c73 6f20 6166 6665 6374 2074 6865   also affect the
-00011f00: 206f 7468 6572 2063 6f70 6965 730a 2020   other copies.  
-00011f10: 2a20 602d 2d76 6167 7565 2d34 3031 6020  * `--vague-401` 
-00011f20: 7265 7475 726e 7320 6120 2234 3034 206e  returns a "404 n
-00011f30: 6f74 2066 6f75 6e64 2220 696e 7374 6561  ot found" instea
-00011f40: 6420 6f66 2022 3430 3120 756e 6175 7468  d of "401 unauth
-00011f50: 6f72 697a 6564 2220 7768 6963 6820 6973  orized" which is
-00011f60: 2061 2063 6f6d 6d6f 6e20 656e 7465 7270   a common enterp
-00011f70: 7269 7365 206d 656d 650a 2020 2a20 602d  rise meme.  * `-
-00011f80: 2d62 616e 2d34 3034 3d35 302c 3630 2c31  -ban-404=50,60,1
-00011f90: 3434 3060 2062 616e 2063 6c69 656e 7420  440` ban client 
-00011fa0: 666f 7220 3134 3430 6d69 6e20 2832 3468  for 1440min (24h
-00011fb0: 2920 6966 2074 6865 7920 6869 7420 3530  ) if they hit 50
-00011fc0: 2034 3034 2773 2069 6e20 3630 6d69 6e0a   404's in 60min.
-00011fd0: 2020 2020 2a20 2a2a 4e42 3a2a 2a20 7769      * **NB:** wi
-00011fe0: 6c6c 2062 616e 2061 6e79 6f6e 6520 7768  ll ban anyone wh
-00011ff0: 6f20 656e 6162 6c65 7320 7570 326b 2074  o enables up2k t
-00012000: 7572 626f 0a20 202a 2060 2d2d 6e69 6860  urbo.  * `--nih`
-00012010: 2072 656d 6f76 6573 2074 6865 2073 6572   removes the ser
-00012020: 7665 7220 686f 7374 6e61 6d65 2066 726f  ver hostname fro
-00012030: 6d20 6469 7265 6374 6f72 7920 6c69 7374  m directory list
-00012040: 696e 6773 0a0a 2a20 6f70 7469 6f6e 2060  ings..* option `
-00012050: 2d73 7373 6020 6973 2061 2073 686f 7274  -sss` is a short
-00012060: 6375 7420 666f 7220 7468 6520 6162 6f76  cut for the abov
-00012070: 6520 706c 7573 3a0a 2020 2a20 602d 2d6e  e plus:.  * `--n
-00012080: 6f2d 6461 7660 2064 6973 6162 6c65 7320  o-dav` disables 
-00012090: 7765 6264 6176 2073 7570 706f 7274 0a20  webdav support. 
-000120a0: 202a 2060 2d2d 6e6f 2d6c 6f67 7565 7360   * `--no-logues`
-000120b0: 2061 6e64 2060 2d2d 6e6f 2d72 6561 646d   and `--no-readm
-000120c0: 6560 2064 6973 6162 6c65 7320 7375 7070  e` disables supp
-000120d0: 6f72 7420 666f 7220 7265 6164 6d65 2773  ort for readme's
-000120e0: 2061 6e64 2070 726f 6c6f 6775 6573 202f   and prologues /
-000120f0: 2065 7069 6c6f 6775 6573 2069 6e20 6469   epilogues in di
-00012100: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
-00012110: 2c20 7768 6963 6820 6f74 6865 7277 6973  , which otherwis
-00012120: 6520 6c65 7473 2070 656f 706c 6520 7570  e lets people up
-00012130: 6c6f 6164 2061 7262 6974 7261 7279 2028  load arbitrary (
-00012140: 6275 7420 7361 6e64 626f 7865 6429 2060  but sandboxed) `
-00012150: 3c73 6372 6970 743e 6020 7461 6773 0a20  <script>` tags. 
-00012160: 202a 2060 2d6c 6f20 6370 702d 2559 2d25   * `-lo cpp-%Y-%
-00012170: 6d25 642d 2548 254d 2553 2e74 7874 2e78  m%d-%H%M%S.txt.x
-00012180: 7a60 2065 6e61 626c 6573 206c 6f67 6769  z` enables loggi
-00012190: 6e67 2074 6f20 6469 736b 0a20 202a 2060  ng to disk.  * `
-000121a0: 2d6c 7320 2a2a 2c2a 2c6c 6e2c 702c 7260  -ls **,*,ln,p,r`
-000121b0: 2064 6f65 7320 6120 7363 616e 206f 6e20   does a scan on 
-000121c0: 7374 6172 7475 7020 666f 7220 616e 7920  startup for any 
-000121d0: 6461 6e67 6572 6f75 7320 7379 6d6c 696e  dangerous symlin
-000121e0: 6b73 0a0a 6f74 6865 7220 6d69 7363 206e  ks..other misc n
-000121f0: 6f74 6573 3a0a 0a2a 2079 6f75 2063 616e  otes:..* you can
-00012200: 2064 6973 6162 6c65 2064 6972 6563 746f   disable directo
-00012210: 7279 206c 6973 7469 6e67 7320 6279 2067  ry listings by g
-00012220: 6976 696e 6720 7065 726d 6973 7369 6f6e  iving permission
-00012230: 2060 6760 2069 6e73 7465 6164 206f 6620   `g` instead of 
-00012240: 6072 602c 206f 6e6c 7920 6163 6365 7074  `r`, only accept
-00012250: 696e 6720 6469 7265 6374 2055 524c 7320  ing direct URLs 
-00012260: 746f 2066 696c 6573 0a20 202a 2063 6f6d  to files.  * com
-00012270: 6269 6e65 2074 6869 7320 7769 7468 2076  bine this with v
-00012280: 6f6c 666c 6167 2060 632c 666b 6020 746f  olflag `c,fk` to
-00012290: 2067 656e 6572 6174 6520 6669 6c65 6b65   generate fileke
-000122a0: 7973 2028 7065 722d 6669 6c65 2061 6363  ys (per-file acc
-000122b0: 6573 736b 6579 7329 3b20 7573 6572 7320  esskeys); users 
-000122c0: 7768 6963 6820 6861 7665 2066 756c 6c20  which have full 
-000122d0: 7265 6164 2d61 6363 6573 7320 7769 6c6c  read-access will
-000122e0: 2074 6865 6e20 7365 6520 5552 4c73 2077   then see URLs w
-000122f0: 6974 6820 603f 6b3d 2e2e 2e60 2061 7070  ith `?k=...` app
-00012300: 656e 6465 6420 746f 2074 6865 2065 6e64  ended to the end
-00012310: 2c20 616e 6420 6067 6020 7573 6572 7320  , and `g` users 
-00012320: 6d75 7374 2070 726f 7669 6465 2074 6861  must provide tha
-00012330: 7420 5552 4c20 696e 636c 7564 696e 6720  t URL including 
-00012340: 7468 6520 636f 7272 6563 7420 6b65 7920  the correct key 
-00012350: 746f 2061 766f 6964 2061 2034 3034 0a20  to avoid a 404. 
-00012360: 2020 202a 2074 6865 2064 6566 6175 6c74     * the default
-00012370: 2066 696c 656b 6579 2065 6e74 726f 7079   filekey entropy
-00012380: 2069 7320 6661 6972 6c79 2073 6d61 6c6c   is fairly small
-00012390: 2073 6f20 6769 7665 2060 2d2d 666b 2d73   so give `--fk-s
-000123a0: 616c 7460 2061 726f 756e 6420 3330 2063  alt` around 30 c
-000123b0: 6861 7261 6374 6572 7320 6966 2079 6f75  haracters if you
-000123c0: 2077 616e 7420 6669 6c65 6b65 7973 206c   want filekeys l
-000123d0: 6f6e 6765 7220 7468 616e 2031 3620 6368  onger than 16 ch
-000123e0: 6172 730a 2020 2a20 7065 726d 6973 7369  ars.  * permissi
-000123f0: 6f6e 7320 6077 4760 206c 6574 7320 7573  ons `wG` lets us
-00012400: 6572 7320 7570 6c6f 6164 2066 696c 6573  ers upload files
-00012410: 2061 6e64 2072 6563 6569 7665 2074 6865   and receive the
-00012420: 6972 206f 776e 2066 696c 656b 6579 732c  ir own filekeys,
-00012430: 2073 7469 6c6c 2077 6974 686f 7574 2062   still without b
-00012440: 6569 6e67 2061 626c 6520 746f 2073 6565  eing able to see
-00012450: 206f 7468 6572 2075 706c 6f61 6473 0a0a   other uploads..
-00012460: 0a23 2320 676f 7463 6861 730a 0a62 6568  .## gotchas..beh
-00012470: 6176 696f 7220 7468 6174 206d 6967 6874  avior that might
-00012480: 2062 6520 756e 6578 7065 6374 6564 0a0a   be unexpected..
-00012490: 2a20 7573 6572 7320 7769 7468 6f75 7420  * users without 
-000124a0: 7265 6164 2d61 6363 6573 7320 746f 2061  read-access to a
-000124b0: 2066 6f6c 6465 7220 6361 6e20 7374 696c   folder can stil
-000124c0: 6c20 7365 6520 7468 6520 602e 7072 6f6c  l see the `.prol
-000124d0: 6f67 7565 2e68 746d 6c60 202f 2060 2e65  ogue.html` / `.e
-000124e0: 7069 6c6f 6775 652e 6874 6d6c 6020 2f20  pilogue.html` / 
-000124f0: 6052 4541 444d 452e 6d64 6020 636f 6e74  `README.md` cont
-00012500: 656e 7473 2c20 666f 7220 7468 6520 7075  ents, for the pu
-00012510: 7270 6f73 6520 6f66 2073 686f 7769 6e67  rpose of showing
-00012520: 2061 2064 6573 6372 6970 7469 6f6e 206f   a description o
-00012530: 6e20 686f 7720 746f 2075 7365 2074 6865  n how to use the
-00012540: 2075 706c 6f61 6465 7220 666f 7220 6578   uploader for ex
-00012550: 616d 706c 650a 2a20 7573 6572 7320 6361  ample.* users ca
-00012560: 6e20 7375 626d 6974 2060 3c73 6372 6970  n submit `<scrip
-00012570: 743e 6073 2077 6869 6368 2061 7574 6f72  t>`s which autor
-00012580: 756e 2066 6f72 206f 7468 6572 2076 6973  un for other vis
-00012590: 6974 6f72 7320 696e 2061 2066 6577 2077  itors in a few w
-000125a0: 6179 733b 0a20 202a 2075 706c 6f61 6469  ays;.  * uploadi
-000125b0: 6e67 2061 2060 5245 4144 4d45 2e6d 6460  ng a `README.md`
-000125c0: 202d 2d20 6176 6f69 6420 7769 7468 2060   -- avoid with `
-000125d0: 2d2d 6e6f 2d72 6561 646d 6560 0a20 202a  --no-readme`.  *
-000125e0: 2072 656e 616d 696e 6720 6073 6f6d 652e   renaming `some.
-000125f0: 6874 6d6c 6020 746f 2060 2e65 7069 6c6f  html` to `.epilo
-00012600: 6775 652e 6874 6d6c 6020 2d2d 2061 766f  gue.html` -- avo
-00012610: 6964 2077 6974 6820 6569 7468 6572 2060  id with either `
-00012620: 2d2d 6e6f 2d6c 6f67 7565 7360 206f 7220  --no-logues` or 
-00012630: 602d 2d6e 6f2d 646f 742d 7265 6e60 0a20  `--no-dot-ren`. 
-00012640: 202a 2074 6865 2064 6972 6563 746f 7279   * the directory
-00012650: 2d6c 6973 7469 6e67 2065 6d62 6564 2069  -listing embed i
-00012660: 7320 7361 6e64 626f 7865 6420 2873 6f20  s sandboxed (so 
-00012670: 616e 7920 6d61 6c69 6369 6f75 7320 7363  any malicious sc
-00012680: 7269 7074 7320 6361 6e27 7420 646f 2061  ripts can't do a
-00012690: 6e79 2064 616d 6167 6529 2062 7574 2074  ny damage) but t
-000126a0: 6865 206d 6172 6b64 6f77 6e20 6564 6974  he markdown edit
-000126b0: 6f72 2069 7320 6e6f 740a 0a0a 2323 2063  or is not...## c
-000126c0: 6f72 730a 0a63 726f 7373 2d73 6974 6520  ors..cross-site 
-000126d0: 7265 7175 6573 7420 636f 6e66 6967 0a0a  request config..
-000126e0: 6279 2064 6566 6175 6c74 2c20 6578 6365  by default, exce
-000126f0: 7074 2066 6f72 2060 4745 5460 2061 6e64  pt for `GET` and
-00012700: 2060 4845 4144 6020 6f70 6572 6174 696f   `HEAD` operatio
-00012710: 6e73 2c20 616c 6c20 7265 7175 6573 7473  ns, all requests
-00012720: 206d 7573 7420 6569 7468 6572 3a0a 2a20   must either:.* 
-00012730: 6e6f 7420 636f 6e74 6169 6e20 616e 2060  not contain an `
-00012740: 4f72 6967 696e 6020 6865 6164 6572 2061  Origin` header a
-00012750: 7420 616c 6c0a 2a20 6f72 2068 6176 6520  t all.* or have 
-00012760: 616e 2060 4f72 6967 696e 6020 6d61 7463  an `Origin` matc
-00012770: 6869 6e67 2074 6865 2073 6572 7665 7220  hing the server 
-00012780: 646f 6d61 696e 0a2a 206f 7220 7468 6520  domain.* or the 
-00012790: 6865 6164 6572 2060 5057 6020 7769 7468  header `PW` with
-000127a0: 2079 6f75 7220 7061 7373 776f 7264 2061   your password a
-000127b0: 7320 7661 6c75 650a 0a63 6f72 7320 6361  s value..cors ca
-000127c0: 6e20 6265 2063 6f6e 6669 6775 7265 6420  n be configured 
-000127d0: 7769 7468 2060 2d2d 6163 616f 6020 616e  with `--acao` an
-000127e0: 6420 602d 2d61 6361 6d60 2c20 6f72 2074  d `--acam`, or t
-000127f0: 6865 2070 726f 7465 6374 696f 6e73 2065  he protections e
-00012800: 6e74 6972 656c 7920 6469 7361 626c 6564  ntirely disabled
-00012810: 2077 6974 6820 602d 2d61 6c6c 6f77 2d63   with `--allow-c
-00012820: 7372 6660 0a0a 0a23 2072 6563 6f76 6572  srf`...# recover
-00012830: 696e 6720 6672 6f6d 2063 7261 7368 6573  ing from crashes
-00012840: 0a0a 2323 2063 6c69 656e 7420 6372 6173  ..## client cras
-00012850: 6865 730a 0a23 2323 2066 7265 666f 7820  hes..### frefox 
-00012860: 7773 6f64 0a0a 6669 7265 666f 7820 3837  wsod..firefox 87
-00012870: 2063 616e 2063 7261 7368 2064 7572 696e   can crash durin
-00012880: 6720 7570 6c6f 6164 7320 202d 2d20 7468  g uploads  -- th
-00012890: 6520 656e 7469 7265 2062 726f 7773 6572  e entire browser
-000128a0: 2067 6f65 732c 2069 6e63 6c75 6469 6e67   goes, including
-000128b0: 2061 6c6c 206f 7468 6572 2062 726f 7773   all other brows
-000128c0: 6572 2074 6162 732c 2065 7665 7279 7468  er tabs, everyth
-000128d0: 696e 6720 7475 726e 7320 7768 6974 650a  ing turns white.
-000128e0: 0a68 6f77 6576 6572 2079 6f75 2063 616e  .however you can
-000128f0: 2068 6974 2060 4631 3260 2069 6e20 7468   hit `F12` in th
-00012900: 6520 7570 326b 2074 6162 2061 6e64 2075  e up2k tab and u
-00012910: 7365 2074 6865 2064 6576 746f 6f6c 7320  se the devtools 
-00012920: 746f 2073 6565 2068 6f77 2066 6172 2079  to see how far y
-00012930: 6f75 2067 6f74 2069 6e20 7468 6520 7570  ou got in the up
-00012940: 6c6f 6164 733a 0a0a 2a20 6765 7420 6120  loads:..* get a 
-00012950: 636f 6d70 6c65 7465 206c 6973 7420 6f66  complete list of
-00012960: 2061 6c6c 2075 706c 6f61 6473 2c20 6f72   all uploads, or
-00012970: 6761 6e69 7a65 6420 6279 2073 7461 7475  ganized by statu
-00012980: 7473 2028 6f6b 202f 206e 6f2d 676f 6f64  ts (ok / no-good
-00012990: 202f 2062 7573 7920 2f20 7175 6575 6564   / busy / queued
-000129a0: 293a 2020 0a20 2060 7661 7220 7461 6273  ):  .  `var tabs
-000129b0: 203d 207b 206f 6b3a 5b5d 2c20 6e67 3a5b   = { ok:[], ng:[
-000129c0: 5d2c 2062 7a3a 5b5d 2c20 713a 5b5d 207d  ], bz:[], q:[] }
-000129d0: 3b20 666f 7220 2876 6172 2061 206f 6620  ; for (var a of 
-000129e0: 7570 326b 2e75 692e 7461 6229 2074 6162  up2k.ui.tab) tab
-000129f0: 735b 612e 696e 5d2e 7075 7368 2861 293b  s[a.in].push(a);
-00012a00: 2074 6162 7360 0a0a 2a20 6c69 7374 206f   tabs`..* list o
-00012a10: 6620 6669 6c65 6e61 6d65 7320 7768 6963  f filenames whic
-00012a20: 6820 6661 696c 6564 3a20 200a 2020 60e2  h failed:  .  `.
-00012a30: 808b 7661 7220 6e67 203d 205b 5d3b 2066  ..var ng = []; f
-00012a40: 6f72 2028 7661 7220 6120 6f66 2075 7032  or (var a of up2
-00012a50: 6b2e 7569 2e74 6162 2920 6966 2028 612e  k.ui.tab) if (a.
-00012a60: 696e 2021 3d20 276f 6b27 2920 6e67 2e70  in != 'ok') ng.p
-00012a70: 7573 6828 612e 686e 2e73 706c 6974 2827  ush(a.hn.split('
-00012a80: 3c61 2068 7265 663d 5c22 2729 2e73 6c69  <a href=\"').sli
-00012a90: 6365 282d 3129 5b30 5d2e 7370 6c69 7428  ce(-1)[0].split(
-00012aa0: 275c 223e 2729 5b30 5d29 3b20 6e67 600a  '\">')[0]); ng`.
-00012ab0: 0a2a 2073 656e 6420 7468 6520 6c69 7374  .* send the list
-00012ac0: 206f 6620 6669 6c65 6e61 6d65 7320 746f   of filenames to
-00012ad0: 2063 6f70 7970 6172 7479 2066 6f72 2073   copyparty for s
-00012ae0: 6166 656b 6565 7069 6e67 3a20 200a 2020  afekeeping:  .  
-00012af0: 6061 7761 6974 2066 6574 6368 2827 2f69  `await fetch('/i
-00012b00: 6e63 272c 207b 6d65 7468 6f64 3a27 5055  nc', {method:'PU
-00012b10: 5427 2c20 626f 6479 3a4a 534f 4e2e 7374  T', body:JSON.st
-00012b20: 7269 6e67 6966 7928 6e67 2c6e 756c 6c2c  ringify(ng,null,
-00012b30: 3129 7d29 600a 0a0a 2320 4854 5450 2041  1)})`...# HTTP A
-00012b40: 5049 0a0a 7365 6520 5b64 6576 6e6f 7465  PI..see [devnote
-00012b50: 735d 2823 2e2f 646f 6373 2f64 6576 6e6f  s](#./docs/devno
-00012b60: 7465 732e 6d64 2368 7474 702d 6170 6929  tes.md#http-api)
-00012b70: 0a0a 0a23 2064 6570 656e 6465 6e63 6965  ...# dependencie
-00012b80: 730a 0a6d 616e 6461 746f 7279 2064 6570  s..mandatory dep
-00012b90: 733a 0a2a 2060 6a69 6e6a 6132 6020 2869  s:.* `jinja2` (i
-00012ba0: 7320 6275 696c 7420 696e 746f 2074 6865  s built into the
-00012bb0: 2053 4658 290a 0a0a 2323 206f 7074 696f   SFX)...## optio
-00012bc0: 6e61 6c20 6465 7065 6e64 656e 6369 6573  nal dependencies
-00012bd0: 0a0a 696e 7374 616c 6c20 7468 6573 6520  ..install these 
-00012be0: 746f 2065 6e61 626c 6520 626f 6e75 7320  to enable bonus 
-00012bf0: 6665 6174 7572 6573 0a0a 656e 6162 6c65  features..enable
-00012c00: 2066 7470 2d73 6572 7665 723a 0a2a 2066   ftp-server:.* f
-00012c10: 6f72 206a 7573 7420 706c 6169 6e74 6578  or just plaintex
-00012c20: 7420 4654 502c 2060 7079 6674 7064 6c69  t FTP, `pyftpdli
-00012c30: 6260 2028 6973 2062 7569 6c74 2069 6e74  b` (is built int
-00012c40: 6f20 7468 6520 5346 5829 0a2a 2077 6974  o the SFX).* wit
-00012c50: 6820 544c 5320 656e 6372 7970 7469 6f6e  h TLS encryption
-00012c60: 2c20 6070 7966 7470 646c 6962 2070 796f  , `pyftpdlib pyo
-00012c70: 7065 6e73 736c 600a 0a65 6e61 626c 6520  penssl`..enable 
-00012c80: 6d75 7369 6320 7461 6773 3a0a 2a20 6569  music tags:.* ei
-00012c90: 7468 6572 2060 6d75 7461 6765 6e60 2028  ther `mutagen` (
-00012ca0: 6661 7374 2c20 7075 7265 2d70 7974 686f  fast, pure-pytho
-00012cb0: 6e2c 2073 6b69 7073 2061 2066 6577 2074  n, skips a few t
-00012cc0: 6167 732c 206d 616b 6573 2063 6f70 7970  ags, makes copyp
-00012cd0: 6172 7479 2047 504c 3f20 6964 6b29 0a2a  arty GPL? idk).*
-00012ce0: 206f 7220 6066 6670 726f 6265 6020 2832   or `ffprobe` (2
-00012cf0: 3078 2073 6c6f 7765 722c 206d 6f72 6520  0x slower, more 
-00012d00: 6163 6375 7261 7465 2c20 706f 7373 6962  accurate, possib
-00012d10: 6c79 2064 616e 6765 726f 7573 2064 6570  ly dangerous dep
-00012d20: 656e 6469 6e67 206f 6e20 796f 7572 2064  ending on your d
-00012d30: 6973 7472 6f20 616e 6420 7573 6572 7329  istro and users)
-00012d40: 0a0a 656e 6162 6c65 205b 7468 756d 626e  ..enable [thumbn
-00012d50: 6169 6c73 5d28 2374 6875 6d62 6e61 696c  ails](#thumbnail
-00012d60: 7329 206f 662e 2e2e 0a2a 202a 2a69 6d61  s) of....* **ima
-00012d70: 6765 733a 2a2a 2060 5069 6c6c 6f77 6020  ges:** `Pillow` 
-00012d80: 616e 642f 6f72 2060 7079 7669 7073 6020  and/or `pyvips` 
-00012d90: 616e 642f 6f72 2060 6666 6d70 6567 6020  and/or `ffmpeg` 
-00012da0: 2872 6571 7569 7265 7320 7079 322e 3720  (requires py2.7 
-00012db0: 6f72 2070 7933 2e35 2b29 0a2a 202a 2a76  or py3.5+).* **v
-00012dc0: 6964 656f 732f 6175 6469 6f3a 2a2a 2060  ideos/audio:** `
-00012dd0: 6666 6d70 6567 6020 616e 6420 6066 6670  ffmpeg` and `ffp
-00012de0: 726f 6265 6020 736f 6d65 7768 6572 6520  robe` somewhere 
-00012df0: 696e 2060 2450 4154 4860 0a2a 202a 2a48  in `$PATH`.* **H
-00012e00: 4549 4620 7069 6374 7572 6573 3a2a 2a20  EIF pictures:** 
-00012e10: 6070 7976 6970 7360 206f 7220 6066 666d  `pyvips` or `ffm
-00012e20: 7065 6760 206f 7220 6070 7968 6569 662d  peg` or `pyheif-
-00012e30: 7069 6c6c 6f77 2d6f 7065 6e65 7260 2028  pillow-opener` (
-00012e40: 7265 7175 6972 6573 204c 696e 7578 206f  requires Linux o
-00012e50: 7220 6120 4320 636f 6d70 696c 6572 290a  r a C compiler).
-00012e60: 2a20 2a2a 4156 4946 2070 6963 7475 7265  * **AVIF picture
-00012e70: 733a 2a2a 2060 7079 7669 7073 6020 6f72  s:** `pyvips` or
-00012e80: 2060 6666 6d70 6567 6020 6f72 2060 7069   `ffmpeg` or `pi
-00012e90: 6c6c 6f77 2d61 7669 662d 706c 7567 696e  llow-avif-plugin
-00012ea0: 600a 2a20 2a2a 4a50 4547 2058 4c20 7069  `.* **JPEG XL pi
-00012eb0: 6374 7572 6573 3a2a 2a20 6070 7976 6970  ctures:** `pyvip
-00012ec0: 7360 206f 7220 6066 666d 7065 6760 0a0a  s` or `ffmpeg`..
-00012ed0: 656e 6162 6c65 205b 736d 625d 2823 736d  enable [smb](#sm
-00012ee0: 622d 7365 7276 6572 2920 7375 7070 6f72  b-server) suppor
-00012ef0: 7420 282a 2a6e 6f74 2a2a 2072 6563 6f6d  t (**not** recom
-00012f00: 6d65 6e64 6564 293a 0a2a 2060 696d 7061  mended):.* `impa
-00012f10: 636b 6574 3d3d 302e 3130 2e30 600a 0a60  cket==0.10.0`..`
-00012f20: 7079 7669 7073 6020 6769 7665 7320 6869  pyvips` gives hi
-00012f30: 6768 6572 2071 7561 6c69 7479 2074 6875  gher quality thu
-00012f40: 6d62 6e61 696c 7320 7468 616e 2060 5069  mbnails than `Pi
-00012f50: 6c6c 6f77 6020 616e 6420 6973 2033 3230  llow` and is 320
-00012f60: 2520 6661 7374 6572 2c20 7573 696e 6720  % faster, using 
-00012f70: 3237 3025 206d 6f72 6520 7261 6d3a 2060  270% more ram: `
-00012f80: 7375 646f 2061 7074 2069 6e73 7461 6c6c  sudo apt install
-00012f90: 206c 6962 7669 7073 3432 2026 2620 7079   libvips42 && py
-00012fa0: 7468 6f6e 3320 2d6d 2070 6970 2069 6e73  thon3 -m pip ins
-00012fb0: 7461 6c6c 202d 2d75 7365 7220 2d55 2070  tall --user -U p
-00012fc0: 7976 6970 7360 0a0a 0a23 2320 6f70 7469  yvips`...## opti
-00012fd0: 6f6e 616c 2067 706c 2073 7475 6666 0a0a  onal gpl stuff..
-00012fe0: 736f 6d65 2062 756e 646c 6564 2074 6f6f  some bundled too
-00012ff0: 6c73 2068 6176 6520 636f 7079 6c65 6674  ls have copyleft
-00013000: 2064 6570 656e 6465 6e63 6965 732c 2073   dependencies, s
-00013010: 6565 205b 2e2f 6269 6e2f 236d 7461 675d  ee [./bin/#mtag]
-00013020: 2862 696e 2f23 6d74 6167 290a 0a74 6865  (bin/#mtag)..the
-00013030: 7365 2061 7265 2073 7461 6e64 616c 6f6e  se are standalon
-00013040: 6520 7072 6f67 7261 6d73 2061 6e64 2077  e programs and w
-00013050: 696c 6c20 6e65 7665 7220 6265 2069 6d70  ill never be imp
-00013060: 6f72 7465 6420 2f20 6576 616c 7561 7465  orted / evaluate
-00013070: 6420 6279 2063 6f70 7970 6172 7479 2c20  d by copyparty, 
-00013080: 616e 6420 6d75 7374 2062 6520 656e 6162  and must be enab
-00013090: 6c65 6420 7468 726f 7567 6820 602d 6d74  led through `-mt
-000130a0: 7060 2063 6f6e 6669 6773 0a0a 0a23 2073  p` configs...# s
-000130b0: 6678 0a0a 7468 6520 7365 6c66 2d63 6f6e  fx..the self-con
-000130c0: 7461 696e 6564 2022 6269 6e61 7279 2220  tained "binary" 
-000130d0: 205b 636f 7079 7061 7274 792d 7366 782e   [copyparty-sfx.
-000130e0: 7079 5d28 6874 7470 733a 2f2f 6769 7468  py](https://gith
-000130f0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00013100: 7061 7274 792f 7265 6c65 6173 6573 2f6c  party/releases/l
-00013110: 6174 6573 742f 646f 776e 6c6f 6164 2f63  atest/download/c
-00013120: 6f70 7970 6172 7479 2d73 6678 2e70 7929  opyparty-sfx.py)
-00013130: 2077 696c 6c20 756e 7061 636b 2069 7473   will unpack its
-00013140: 656c 6620 616e 6420 7275 6e20 636f 7079  elf and run copy
-00013150: 7061 7274 792c 2061 7373 756d 696e 6720  party, assuming 
-00013160: 796f 7520 6861 7665 2070 7974 686f 6e20  you have python 
-00013170: 696e 7374 616c 6c65 6420 6f66 2063 6f75  installed of cou
-00013180: 7273 650a 0a79 6f75 2063 616e 2072 6564  rse..you can red
-00013190: 7563 6520 7468 6520 7366 7820 7369 7a65  uce the sfx size
-000131a0: 2062 7920 7265 7061 636b 696e 6720 6974   by repacking it
-000131b0: 3b20 7365 6520 5b2e 2f64 6f63 732f 6465  ; see [./docs/de
-000131c0: 766e 6f74 6573 2e6d 6423 7366 782d 7265  vnotes.md#sfx-re
-000131d0: 7061 636b 5d28 232e 2f64 6f63 732f 6465  pack](#./docs/de
-000131e0: 766e 6f74 6573 2e6d 6423 7366 782d 7265  vnotes.md#sfx-re
-000131f0: 7061 636b 290a 0a0a 2323 2063 6f70 7970  pack)...## copyp
-00013200: 6172 7479 2e65 7865 0a0a 646f 776e 6c6f  arty.exe..downlo
-00013210: 6164 205b 636f 7079 7061 7274 792e 6578  ad [copyparty.ex
-00013220: 655d 2868 7474 7073 3a2f 2f67 6974 6875  e](https://githu
-00013230: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00013240: 6172 7479 2f72 656c 6561 7365 732f 6c61  arty/releases/la
-00013250: 7465 7374 2f64 6f77 6e6c 6f61 642f 636f  test/download/co
-00013260: 7079 7061 7274 792e 6578 6529 2028 7769  pyparty.exe) (wi
-00013270: 6e38 2b29 206f 7220 5b63 6f70 7970 6172  n8+) or [copypar
-00013280: 7479 3332 2e65 7865 5d28 6874 7470 733a  ty32.exe](https:
-00013290: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
-000132a0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
-000132b0: 6173 6573 2f6c 6174 6573 742f 646f 776e  ases/latest/down
-000132c0: 6c6f 6164 2f63 6f70 7970 6172 7479 3332  load/copyparty32
-000132d0: 2e65 7865 2920 2877 696e 372b 290a 0a21  .exe) (win7+)..!
-000132e0: 5b63 6f70 7970 6172 7479 2d65 7865 2d66  [copyparty-exe-f
-000132f0: 7338 5d28 6874 7470 733a 2f2f 7573 6572  s8](https://user
-00013300: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00013310: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-00013320: 3130 3332 2f32 3231 3434 3539 3436 2d31  1032/221445946-1
-00013330: 6533 3238 6535 362d 3863 3562 2d34 3461  e328e56-8c5b-44a
-00013340: 392d 3862 3966 2d64 6565 3834 6439 3432  9-8b9f-dee84d942
-00013350: 3533 352e 706e 6729 0a0a 6361 6e20 6265  535.png)..can be
-00013360: 2063 6f6e 7665 6e69 656e 7420 6f6e 206d   convenient on m
-00013370: 6163 6869 6e65 7320 7768 6572 6520 696e  achines where in
-00013380: 7374 616c 6c69 6e67 2070 7974 686f 6e20  stalling python 
-00013390: 6973 2070 726f 626c 656d 6174 6963 2c20  is problematic, 
-000133a0: 686f 7765 7665 7220 6973 202a 2a6e 6f74  however is **not
-000133b0: 2072 6563 6f6d 6d65 6e64 6564 2a2a 202d   recommended** -
-000133c0: 2d20 6966 2070 6f73 7369 626c 652c 2070  - if possible, p
-000133d0: 6c65 6173 6520 7573 6520 2a2a 5b63 6f70  lease use **[cop
-000133e0: 7970 6172 7479 2d73 6678 2e70 795d 2868  yparty-sfx.py](h
-000133f0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00013400: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-00013410: 2f72 656c 6561 7365 732f 6c61 7465 7374  /releases/latest
-00013420: 2f64 6f77 6e6c 6f61 642f 636f 7079 7061  /download/copypa
-00013430: 7274 792d 7366 782e 7079 292a 2a20 696e  rty-sfx.py)** in
-00013440: 7374 6561 640a 0a2a 205b 636f 7079 7061  stead..* [copypa
-00013450: 7274 792e 6578 655d 2868 7474 7073 3a2f  rty.exe](https:/
-00013460: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
-00013470: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
-00013480: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
-00013490: 6f61 642f 636f 7079 7061 7274 792e 6578  oad/copyparty.ex
-000134a0: 6529 2072 756e 7320 6f6e 2077 696e 3820  e) runs on win8 
-000134b0: 6f72 206e 6577 6572 2c20 7761 7320 636f  or newer, was co
-000134c0: 6d70 696c 6564 206f 6e20 7769 6e31 302c  mpiled on win10,
-000134d0: 2064 6f65 7320 7468 756d 626e 6169 6c73   does thumbnails
-000134e0: 202b 206d 6564 6961 2074 6167 732c 2061   + media tags, a
-000134f0: 6e64 2069 7320 2a63 7572 7265 6e74 6c79  nd is *currently
-00013500: 2a20 7361 6665 2074 6f20 7573 652c 2062  * safe to use, b
-00013510: 7574 2061 6e79 2066 7574 7572 6520 7079  ut any future py
-00013520: 7468 6f6e 2f65 7870 6174 2f70 696c 6c6f  thon/expat/pillo
-00013530: 7720 4356 4573 2063 616e 206f 6e6c 7920  w CVEs can only 
-00013540: 6265 2072 656d 6564 6965 6420 6279 2064  be remedied by d
-00013550: 6f77 6e6c 6f61 6469 6e67 2061 206e 6577  ownloading a new
-00013560: 6572 2076 6572 7369 6f6e 206f 6620 7468  er version of th
-00013570: 6520 6578 650a 0a20 202a 206f 6e20 7769  e exe..  * on wi
-00013580: 6e38 2069 7420 6e65 6564 7320 5b76 6320  n8 it needs [vc 
-00013590: 7265 6469 7374 2032 3031 355d 2868 7474  redist 2015](htt
-000135a0: 7073 3a2f 2f77 7777 2e6d 6963 726f 736f  ps://www.microso
-000135b0: 6674 2e63 6f6d 2f65 6e2d 7573 2f64 6f77  ft.com/en-us/dow
-000135c0: 6e6c 6f61 642f 6465 7461 696c 732e 6173  nload/details.as
-000135d0: 7078 3f69 643d 3438 3134 3529 2c20 6f6e  px?id=48145), on
-000135e0: 2077 696e 3130 2069 7420 6a75 7374 2077   win10 it just w
-000135f0: 6f72 6b73 0a0a 2a20 6461 6e67 6572 6f75  orks..* dangerou
-00013600: 733a 205b 636f 7079 7061 7274 7933 322e  s: [copyparty32.
-00013610: 6578 655d 2868 7474 7073 3a2f 2f67 6974  exe](https://git
-00013620: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-00013630: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
-00013640: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
-00013650: 636f 7079 7061 7274 7933 322e 6578 6529  copyparty32.exe)
-00013660: 2069 7320 636f 6d70 6174 6962 6c65 2077   is compatible w
-00013670: 6974 6820 5b77 696e 646f 7773 375d 2868  ith [windows7](h
-00013680: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-00013690: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-000136a0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-000136b0: 3232 3134 3435 3934 342d 6165 3835 6431  221445944-ae85d1
-000136c0: 6634 2d64 3335 312d 3438 3337 2d62 3133  f4-d351-4837-b13
-000136d0: 302d 3832 6361 6235 3764 3663 6361 2e70  0-82cab57d6cca.p
-000136e0: 6e67 292c 2077 6869 6368 206d 6561 6e73  ng), which means
-000136f0: 2069 7420 7573 6573 2061 6e20 616e 6369   it uses an anci
-00013700: 656e 7420 636f 7079 206f 6620 7079 7468  ent copy of pyth
-00013710: 6f6e 2028 332e 372e 3929 2077 6869 6368  on (3.7.9) which
-00013720: 2063 616e 6e6f 7420 6265 2075 7067 7261   cannot be upgra
-00013730: 6465 6420 616e 6420 7368 6f75 6c64 206e  ded and should n
-00013740: 6576 6572 2062 6520 6578 706f 7365 6420  ever be exposed 
-00013750: 746f 2074 6865 2069 6e74 6572 6e65 7420  to the internet 
-00013760: 284c 414e 2069 7320 6669 6e65 290a 0a2a  (LAN is fine)..*
-00013770: 2064 616e 6765 726f 7573 2061 6e64 2064   dangerous and d
-00013780: 6570 7265 6361 7465 643a 205b 636f 7079  eprecated: [copy
-00013790: 7061 7274 792d 7769 6e70 6536 342e 6578  party-winpe64.ex
-000137a0: 655d 2868 7474 7073 3a2f 2f67 6974 6875  e](https://githu
-000137b0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-000137c0: 6172 7479 2f72 656c 6561 7365 732f 646f  arty/releases/do
-000137d0: 776e 6c6f 6164 2f76 312e 362e 382f 636f  wnload/v1.6.8/co
-000137e0: 7079 7061 7274 792d 7769 6e70 6536 342e  pyparty-winpe64.
-000137f0: 6578 6529 206c 6574 7320 796f 7520 5b72  exe) lets you [r
-00013800: 756e 2063 6f70 7970 6172 7479 2069 6e20  un copyparty in 
-00013810: 5769 6e50 455d 2868 7474 7073 3a2f 2f75  WinPE](https://u
-00013820: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00013830: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-00013840: 2f32 3431 3033 322f 3230 3534 3534 3938  /241032/20545498
-00013850: 342d 6536 6235 3530 6466 2d33 6334 392d  4-e6b550df-3c49-
-00013860: 3438 3664 2d39 3236 372d 3136 3134 3037  486d-9267-161407
-00013870: 3864 6430 6464 2e70 6e67 2920 616e 6420  8dd0dd.png) and 
-00013880: 6973 206f 7468 6572 7769 7365 2063 6f6d  is otherwise com
-00013890: 706c 6574 656c 7920 7573 656c 6573 730a  pletely useless.
-000138a0: 0a6d 6561 6e77 6869 6c65 205b 636f 7079  .meanwhile [copy
-000138b0: 7061 7274 792d 7366 782e 7079 5d28 6874  party-sfx.py](ht
-000138c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000138d0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
-000138e0: 7265 6c65 6173 6573 2f6c 6174 6573 742f  releases/latest/
-000138f0: 646f 776e 6c6f 6164 2f63 6f70 7970 6172  download/copypar
-00013900: 7479 2d73 6678 2e70 7929 2069 6e73 7465  ty-sfx.py) inste
-00013910: 6164 2072 656c 6965 7320 6f6e 2079 6f75  ad relies on you
-00013920: 7220 7379 7374 656d 2070 7974 686f 6e20  r system python 
-00013930: 7768 6963 6820 6769 7665 7320 6265 7474  which gives bett
-00013940: 6572 2070 6572 666f 726d 616e 6365 2061  er performance a
-00013950: 6e64 2077 696c 6c20 7374 6179 2073 6166  nd will stay saf
-00013960: 6520 6173 206c 6f6e 6720 6173 2079 6f75  e as long as you
-00013970: 206b 6565 7020 796f 7572 2070 7974 686f   keep your pytho
-00013980: 6e20 696e 7374 616c 6c20 7570 2d74 6f2d  n install up-to-
-00013990: 6461 7465 0a0a 7468 656e 2061 6761 696e  date..then again
-000139a0: 2c20 6966 2079 6f75 2061 7265 2061 6c72  , if you are alr
-000139b0: 6561 6479 2069 6e74 6f20 646f 776e 6c6f  eady into downlo
-000139c0: 6164 696e 6720 7368 6164 7920 6269 6e61  ading shady bina
-000139d0: 7269 6573 2066 726f 6d20 7468 6520 696e  ries from the in
-000139e0: 7465 726e 6574 2c20 796f 7520 6d61 7920  ternet, you may 
-000139f0: 616c 736f 2077 616e 7420 6d79 205b 6d69  also want my [mi
-00013a00: 6e69 6d61 6c20 6275 696c 6473 5d28 2e2f  nimal builds](./
-00013a10: 7363 7269 7074 732f 7079 696e 7374 616c  scripts/pyinstal
-00013a20: 6c65 7223 6666 6d70 6567 2920 6f66 205b  ler#ffmpeg) of [
-00013a30: 6666 6d70 6567 5d28 6874 7470 733a 2f2f  ffmpeg](https://
-00013a40: 6f63 762e 6d65 2f73 7475 6666 2f62 696e  ocv.me/stuff/bin
-00013a50: 2f66 666d 7065 672e 6578 6529 2061 6e64  /ffmpeg.exe) and
-00013a60: 205b 6666 7072 6f62 655d 2868 7474 7073   [ffprobe](https
-00013a70: 3a2f 2f6f 6376 2e6d 652f 7374 7566 662f  ://ocv.me/stuff/
-00013a80: 6269 6e2f 6666 7072 6f62 652e 6578 6529  bin/ffprobe.exe)
-00013a90: 2077 6869 6368 2065 6e61 626c 6573 2063   which enables c
-00013aa0: 6f70 7970 6172 7479 2074 6f20 6578 7472  opyparty to extr
-00013ab0: 6163 7420 6d75 6c74 696d 6564 6961 2d69  act multimedia-i
-00013ac0: 6e66 6f2c 2064 6f20 6175 6469 6f2d 7472  nfo, do audio-tr
-00013ad0: 616e 7363 6f64 696e 672c 2061 6e64 2074  anscoding, and t
-00013ae0: 6875 6d62 6e61 696c 732f 7370 6563 7472  humbnails/spectr
-00013af0: 6f67 7261 6d73 2f77 6176 6566 6f72 6d73  ograms/waveforms
-00013b00: 2c20 686f 7765 7665 7220 6974 2773 206d  , however it's m
-00013b10: 7563 6820 6265 7474 6572 2074 6f20 696e  uch better to in
-00013b20: 7374 6561 6420 6772 6162 2061 205b 7265  stead grab a [re
-00013b30: 6365 6e74 206f 6666 6963 6961 6c20 6275  cent official bu
-00013b40: 696c 645d 2868 7474 7073 3a2f 2f67 6974  ild](https://git
-00013b50: 6875 622e 636f 6d2f 4274 624e 2f46 466d  hub.com/BtbN/FFm
-00013b60: 7065 672d 4275 696c 6473 2f72 656c 6561  peg-Builds/relea
-00013b70: 7365 732f 646f 776e 6c6f 6164 2f6c 6174  ses/download/lat
-00013b80: 6573 742f 6666 6d70 6567 2d6d 6173 7465  est/ffmpeg-maste
-00013b90: 722d 6c61 7465 7374 2d77 696e 3634 2d67  r-latest-win64-g
-00013ba0: 706c 2e7a 6970 2920 6576 6572 7920 6f6e  pl.zip) every on
-00013bb0: 6365 2069 6e61 2077 6869 6c65 2069 6620  ce ina while if 
-00013bc0: 796f 7520 6361 6e20 6166 666f 7264 2074  you can afford t
-00013bd0: 6865 2073 697a 650a 0a0a 2320 696e 7374  he size...# inst
-00013be0: 616c 6c20 6f6e 2061 6e64 726f 6964 0a0a  all on android..
-00013bf0: 696e 7374 616c 6c20 5b54 6572 6d75 785d  install [Termux]
-00013c00: 2868 7474 7073 3a2f 2f74 6572 6d75 782e  (https://termux.
-00013c10: 636f 6d2f 2920 2b20 6974 7320 636f 6d70  com/) + its comp
-00013c20: 616e 696f 6e20 6170 7020 6054 6572 6d75  anion app `Termu
-00013c30: 783a 4150 4960 2028 7365 6520 5b6f 6376  x:API` (see [ocv
-00013c40: 2e6d 652f 7465 726d 7578 5d28 6874 7470  .me/termux](http
-00013c50: 733a 2f2f 6f63 762e 6d65 2f74 6572 6d75  s://ocv.me/termu
-00013c60: 782f 2929 2061 6e64 2074 6865 6e20 636f  x/)) and then co
-00013c70: 7079 2d70 6173 7465 2074 6869 7320 696e  py-paste this in
-00013c80: 746f 2054 6572 6d75 7820 286c 6f6e 672d  to Termux (long-
-00013c90: 7461 7029 2061 6c6c 2061 7420 6f6e 6365  tap) all at once
-00013ca0: 3a0a 6060 6073 680a 7965 7320 7c20 706b  :.```sh.yes | pk
-00013cb0: 6720 7570 6772 6164 6520 2626 2074 6572  g upgrade && ter
-00013cc0: 6d75 782d 7365 7475 702d 7374 6f72 6167  mux-setup-storag
-00013cd0: 6520 2626 2079 6573 207c 2070 6b67 2069  e && yes | pkg i
-00013ce0: 6e73 7461 6c6c 2070 7974 686f 6e20 7465  nstall python te
-00013cf0: 726d 7578 2d61 7069 2026 2620 7079 7468  rmux-api && pyth
-00013d00: 6f6e 202d 6d20 656e 7375 7265 7069 7020  on -m ensurepip 
-00013d10: 2626 2070 7974 686f 6e20 2d6d 2070 6970  && python -m pip
-00013d20: 2069 6e73 7461 6c6c 202d 2d75 7365 7220   install --user 
-00013d30: 2d55 2063 6f70 7970 6172 7479 2026 2620  -U copyparty && 
-00013d40: 7b20 6772 6570 202d 7145 2027 5041 5448  { grep -qE 'PATH
-00013d50: 3d2e 2a5c 2e6c 6f63 616c 2f62 696e 2720  =.*\.local/bin' 
-00013d60: 7e2f 2e62 6173 6872 6320 323e 2f64 6576  ~/.bashrc 2>/dev
-00013d70: 2f6e 756c 6c20 7c7c 207b 2065 6368 6f20  /null || { echo 
-00013d80: 2750 4154 483d 2224 484f 4d45 2f2e 6c6f  'PATH="$HOME/.lo
-00013d90: 6361 6c2f 6269 6e3a 2450 4154 4822 2720  cal/bin:$PATH"' 
-00013da0: 3e3e 207e 2f2e 6261 7368 7263 2026 2620  >> ~/.bashrc && 
-00013db0: 2e20 7e2f 2e62 6173 6872 633b 207d 3b20  . ~/.bashrc; }; 
-00013dc0: 7d0a 6563 686f 2024 3f0a 6060 600a 0a61  }.echo $?.```..a
-00013dd0: 6674 6572 2074 6865 2069 6e69 7469 616c  fter the initial
-00013de0: 2073 6574 7570 2c20 796f 7520 6361 6e20   setup, you can 
-00013df0: 6c61 756e 6368 2063 6f70 7970 6172 7479  launch copyparty
-00013e00: 2061 7420 616e 7920 7469 6d65 2062 7920   at any time by 
-00013e10: 7275 6e6e 696e 6720 6063 6f70 7970 6172  running `copypar
-00013e20: 7479 6020 616e 7977 6865 7265 2069 6e20  ty` anywhere in 
-00013e30: 5465 726d 7578 202d 2d20 616e 6420 6966  Termux -- and if
-00013e40: 2079 6f75 2072 756e 2069 7420 7769 7468   you run it with
-00013e50: 2060 2d2d 7172 6020 796f 7527 6c6c 2067   `--qr` you'll g
-00013e60: 6574 2061 205b 6e65 6174 2071 722d 636f  et a [neat qr-co
-00013e70: 6465 5d28 2371 722d 636f 6465 2920 706f  de](#qr-code) po
-00013e80: 696e 7469 6e67 2074 6f20 796f 7572 2065  inting to your e
-00013e90: 7874 6572 6e61 6c20 6970 0a0a 6966 2079  xternal ip..if y
-00013ea0: 6f75 2077 616e 7420 7468 756d 626e 6169  ou want thumbnai
-00013eb0: 6c73 2028 7068 6f74 6f73 2b76 6964 656f  ls (photos+video
-00013ec0: 7329 2061 6e64 2079 6f75 2772 6520 6f6b  s) and you're ok
-00013ed0: 6179 2077 6974 6820 7370 656e 6469 6e67  ay with spending
-00013ee0: 2061 6e6f 7468 6572 2031 3332 204d 6942   another 132 MiB
-00013ef0: 206f 6620 7374 6f72 6167 652c 2060 706b   of storage, `pk
-00013f00: 6720 696e 7374 616c 6c20 6666 6d70 6567  g install ffmpeg
-00013f10: 2026 2620 7079 7468 6f6e 3320 2d6d 2070   && python3 -m p
-00013f20: 6970 2069 6e73 7461 6c6c 202d 2d75 7365  ip install --use
-00013f30: 7220 2d55 2070 696c 6c6f 7760 0a0a 2a20  r -U pillow`..* 
-00013f40: 6f72 2069 6620 796f 7520 7761 6e74 2074  or if you want t
-00013f50: 6f20 7573 6520 6076 6970 7360 2066 6f72  o use `vips` for
-00013f60: 2070 686f 746f 2d74 6875 6d62 7320 696e   photo-thumbs in
-00013f70: 7374 6561 642c 2060 706b 6720 696e 7374  stead, `pkg inst
-00013f80: 616c 6c20 6c69 6276 6970 7320 2626 2070  all libvips && p
-00013f90: 7974 686f 6e20 2d6d 2070 6970 2069 6e73  ython -m pip ins
-00013fa0: 7461 6c6c 202d 2d75 7365 7220 2d55 2077  tall --user -U w
-00013fb0: 6865 656c 2026 2620 7079 7468 6f6e 202d  heel && python -
-00013fc0: 6d20 7069 7020 696e 7374 616c 6c20 2d2d  m pip install --
-00013fd0: 7573 6572 202d 5520 7079 7669 7073 2026  user -U pyvips &
-00013fe0: 2620 2863 6420 2f64 6174 612f 6461 7461  & (cd /data/data
-00013ff0: 2f63 6f6d 2e74 6572 6d75 782f 6669 6c65  /com.termux/file
-00014000: 732f 7573 722f 6c69 622f 3b20 6c6e 202d  s/usr/lib/; ln -
-00014010: 7320 6c69 6267 6f62 6a65 6374 2d32 2e30  s libgobject-2.0
-00014020: 2e73 6f7b 2c2e 307d 3b20 6c6e 202d 7320  .so{,.0}; ln -s 
-00014030: 6c69 6276 6970 732e 736f 7b2c 2e34 327d  libvips.so{,.42}
-00014040: 2960 0a0a 0a23 2072 6570 6f72 7469 6e67  )`...# reporting
-00014050: 2062 7567 730a 0a69 6465 6173 2066 6f72   bugs..ideas for
-00014060: 2063 6f6e 7465 7874 2074 6f20 696e 636c   context to incl
-00014070: 7564 6520 696e 2062 7567 2072 6570 6f72  ude in bug repor
-00014080: 7473 0a0a 696e 2067 656e 6572 616c 2c20  ts..in general, 
-00014090: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
-000140a0: 6d65 6e74 7320 2861 6e64 2063 6f6e 6669  ments (and confi
-000140b0: 6720 6669 6c65 2069 6620 616e 7929 0a0a  g file if any)..
-000140c0: 6966 2073 6f6d 6574 6869 6e67 2062 726f  if something bro
-000140d0: 6b65 2064 7572 696e 6720 616e 2075 706c  ke during an upl
-000140e0: 6f61 6420 2872 6570 6c61 6369 6e67 2046  oad (replacing F
-000140f0: 494c 454e 414d 4520 7769 7468 2061 2070  ILENAME with a p
-00014100: 6172 7420 6f66 2074 6865 2066 696c 656e  art of the filen
-00014110: 616d 6520 7468 6174 2062 726f 6b65 293a  ame that broke):
-00014120: 0a60 6060 0a6a 6f75 726e 616c 6374 6c20  .```.journalctl 
-00014130: 2d61 5320 2734 3820 686f 7572 2061 676f  -aS '48 hour ago
-00014140: 2720 2d75 2063 6f70 7970 6172 7479 207c  ' -u copyparty |
-00014150: 2067 7265 7020 2d43 3130 2046 494c 454e   grep -C10 FILEN
-00014160: 414d 4520 7c20 7465 6520 6275 672e 6c6f  AME | tee bug.lo
-00014170: 670a 6060 600a 0a69 6620 7468 6572 6527  g.```..if there'
-00014180: 7320 6120 7761 6c6c 206f 6620 6261 7365  s a wall of base
-00014190: 3634 2069 6e20 7468 6520 6c6f 6720 2874  64 in the log (t
-000141a0: 6872 6561 6420 7374 6163 6b73 2920 7468  hread stacks) th
-000141b0: 656e 2070 6c65 6173 6520 696e 636c 7564  en please includ
-000141c0: 6520 7468 6174 2c20 6573 7065 6369 616c  e that, especial
-000141d0: 6c79 2069 6620 796f 7520 7275 6e20 696e  ly if you run in
-000141e0: 746f 2073 6f6d 6574 6869 6e67 2066 7265  to something fre
-000141f0: 657a 696e 6720 7570 206f 7220 6765 7474  ezing up or gett
-00014200: 696e 6720 7374 7563 6b2c 2066 6f72 2065  ing stuck, for e
-00014210: 7861 6d70 6c65 2060 4f70 6572 6174 696f  xample `Operatio
-00014220: 6e61 6c45 7272 6f72 2827 6461 7461 6261  nalError('databa
-00014230: 7365 2069 7320 6c6f 636b 6564 2729 6020  se is locked')` 
-00014240: 2d2d 2061 6c74 6572 6e61 7469 7665 6c79  -- alternatively
-00014250: 2079 6f75 2063 616e 2076 6973 6974 2060   you can visit `
-00014260: 2f3f 7374 6163 6b60 2074 6f20 7365 6520  /?stack` to see 
-00014270: 7468 6520 7374 6163 6b73 206c 6976 652c  the stacks live,
-00014280: 2073 6f20 6874 7470 3a2f 2f31 3237 2e30   so http://127.0
-00014290: 2e30 2e31 3a33 3932 332f 3f73 7461 636b  .0.1:3923/?stack
-000142a0: 2066 6f72 2065 7861 6d70 6c65 0a0a 0a23   for example...#
-000142b0: 2064 6576 6e6f 7465 730a 0a66 6f72 2062   devnotes..for b
-000142c0: 7569 6c64 2069 6e73 7472 7563 7469 6f6e  uild instruction
-000142d0: 7320 6574 632c 2073 6565 205b 2e2f 646f  s etc, see [./do
-000142e0: 6373 2f64 6576 6e6f 7465 732e 6d64 5d28  cs/devnotes.md](
-000142f0: 2e2f 646f 6373 2f64 6576 6e6f 7465 732e  ./docs/devnotes.
-00014300: 6d64 290a                                md).
+00000710: 6f70 7970 6172 7479 0a0a 7475 726e 2061  opyparty..turn a
+00000720: 6c6d 6f73 7420 616e 7920 6465 7669 6365  lmost any device
+00000730: 2069 6e74 6f20 6120 6669 6c65 2073 6572   into a file ser
+00000740: 7665 7220 7769 7468 2072 6573 756d 6162  ver with resumab
+00000750: 6c65 2075 706c 6f61 6473 2f64 6f77 6e6c  le uploads/downl
+00000760: 6f61 6473 2075 7369 6e67 205b 2a61 6e79  oads using [*any
+00000770: 2a5d 2823 6272 6f77 7365 722d 7375 7070  *](#browser-supp
+00000780: 6f72 7429 2077 6562 2062 726f 7773 6572  ort) web browser
+00000790: 0a0a 2a20 7365 7276 6572 206f 6e6c 7920  ..* server only 
+000007a0: 6e65 6564 7320 5079 7468 6f6e 2028 3220  needs Python (2 
+000007b0: 6f72 2033 292c 2061 6c6c 2064 6570 656e  or 3), all depen
+000007c0: 6465 6e63 6965 7320 6f70 7469 6f6e 616c  dencies optional
+000007d0: 0a2a 20f0 9f94 8c20 7072 6f74 6f63 6f6c  .* .... protocol
+000007e0: 733a 205b 6874 7470 5d28 2374 6865 2d62  s: [http](#the-b
+000007f0: 726f 7773 6572 2920 2f2f 205b 6674 705d  rowser) // [ftp]
+00000800: 2823 6674 702d 7365 7276 6572 2920 2f2f  (#ftp-server) //
+00000810: 205b 7765 6264 6176 5d28 2377 6562 6461   [webdav](#webda
+00000820: 762d 7365 7276 6572 2920 2f2f 205b 736d  v-server) // [sm
+00000830: 622f 6369 6673 5d28 2373 6d62 2d73 6572  b/cifs](#smb-ser
+00000840: 7665 7229 0a2a 20f0 9f93 b120 5b61 6e64  ver).* .... [and
+00000850: 726f 6964 2061 7070 5d28 2361 6e64 726f  roid app](#andro
+00000860: 6964 2d61 7070 2920 2f2f 205b 6950 686f  id-app) // [iPho
+00000870: 6e65 2073 686f 7274 6375 7473 5d28 2369  ne shortcuts](#i
+00000880: 6f73 2d73 686f 7274 6375 7473 290a 0af0  os-shortcuts)...
+00000890: 9f91 8920 2a2a 5b47 6574 2073 7461 7274  ... **[Get start
+000008a0: 6564 5d28 2371 7569 636b 7374 6172 7429  ed](#quickstart)
+000008b0: 212a 2a20 6f72 2076 6973 6974 2074 6865  !** or visit the
+000008c0: 202a 2a5b 7265 6164 2d6f 6e6c 7920 6465   **[read-only de
+000008d0: 6d6f 2073 6572 7665 725d 2868 7474 7073  mo server](https
+000008e0: 3a2f 2f61 2e6f 6376 2e6d 652f 7075 622f  ://a.ocv.me/pub/
+000008f0: 6465 6d6f 2f29 2a2a 20f0 9f91 8020 7275  demo/)** .... ru
+00000900: 6e6e 696e 6720 6672 6f6d 2061 2062 6173  nning from a bas
+00000910: 656d 656e 7420 696e 2066 696e 6c61 6e64  ement in finland
+00000920: 0a0a f09f 93b7 202a 2a73 6372 6565 6e73  ...... **screens
+00000930: 686f 7473 3a2a 2a20 5b62 726f 7773 6572  hots:** [browser
+00000940: 5d28 2374 6865 2d62 726f 7773 6572 2920  ](#the-browser) 
+00000950: 2f2f 205b 7570 6c6f 6164 5d28 2375 706c  // [upload](#upl
+00000960: 6f61 6469 6e67 2920 2f2f 205b 756e 706f  oading) // [unpo
+00000970: 7374 5d28 2375 6e70 6f73 7429 202f 2f20  st](#unpost) // 
+00000980: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+00000990: 756d 626e 6169 6c73 2920 2f2f 205b 7365  umbnails) // [se
+000009a0: 6172 6368 5d28 2373 6561 7263 6869 6e67  arch](#searching
+000009b0: 2920 2f2f 205b 6673 6561 7263 685d 2823  ) // [fsearch](#
+000009c0: 6669 6c65 2d73 6561 7263 6829 202f 2f20  file-search) // 
+000009d0: 5b7a 6970 2d44 4c5d 2823 7a69 702d 646f  [zip-DL](#zip-do
+000009e0: 776e 6c6f 6164 7329 202f 2f20 5b6d 642d  wnloads) // [md-
+000009f0: 7669 6577 6572 5d28 236d 6172 6b64 6f77  viewer](#markdow
+00000a00: 6e2d 7669 6577 6572 290a 0a0a 2323 2072  n-viewer)...## r
+00000a10: 6561 646d 6520 746f 630a 0a2a 2074 6f70  eadme toc..* top
+00000a20: 0a20 2020 202a 205b 7175 6963 6b73 7461  .    * [quicksta
+00000a30: 7274 5d28 2371 7569 636b 7374 6172 7429  rt](#quickstart)
+00000a40: 202d 206a 7573 7420 7275 6e20 2a2a 5b63   - just run **[c
+00000a50: 6f70 7970 6172 7479 2d73 6678 2e70 795d  opyparty-sfx.py]
+00000a60: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00000a70: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00000a80: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00000a90: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00000aa0: 7061 7274 792d 7366 782e 7079 292a 2a20  party-sfx.py)** 
+00000ab0: 2d2d 2074 6861 7427 7320 6974 2120 f09f  -- that's it! ..
+00000ac0: 8e89 0a20 2020 2020 2020 202a 205b 6f6e  ...        * [on
+00000ad0: 2073 6572 7665 7273 5d28 236f 6e2d 7365   servers](#on-se
+00000ae0: 7276 6572 7329 202d 2079 6f75 206d 6179  rvers) - you may
+00000af0: 2061 6c73 6f20 7761 6e74 2074 6865 7365   also want these
+00000b00: 2c20 6573 7065 6369 616c 6c79 206f 6e20  , especially on 
+00000b10: 7365 7276 6572 730a 2020 2020 2a20 5b66  servers.    * [f
+00000b20: 6561 7475 7265 735d 2823 6665 6174 7572  eatures](#featur
+00000b30: 6573 290a 2020 2020 2a20 5b74 6573 7469  es).    * [testi
+00000b40: 6d6f 6e69 616c 735d 2823 7465 7374 696d  monials](#testim
+00000b50: 6f6e 6961 6c73 2920 2d20 736d 616c 6c20  onials) - small 
+00000b60: 636f 6c6c 6563 7469 6f6e 206f 6620 7573  collection of us
+00000b70: 6572 2066 6565 6462 6163 6b0a 2a20 5b6d  er feedback.* [m
+00000b80: 6f74 6976 6174 696f 6e73 5d28 236d 6f74  otivations](#mot
+00000b90: 6976 6174 696f 6e73 2920 2d20 7072 6f6a  ivations) - proj
+00000ba0: 6563 7420 676f 616c 7320 2f20 7068 696c  ect goals / phil
+00000bb0: 6f73 6f70 6879 0a20 2020 202a 205b 6e6f  osophy.    * [no
+00000bc0: 7465 735d 2823 6e6f 7465 7329 202d 2067  tes](#notes) - g
+00000bd0: 656e 6572 616c 206e 6f74 6573 0a2a 205b  eneral notes.* [
+00000be0: 6275 6773 5d28 2362 7567 7329 0a20 2020  bugs](#bugs).   
+00000bf0: 202a 205b 6765 6e65 7261 6c20 6275 6773   * [general bugs
+00000c00: 5d28 2367 656e 6572 616c 2d62 7567 7329  ](#general-bugs)
+00000c10: 0a20 2020 202a 205b 6e6f 7420 6d79 2062  .    * [not my b
+00000c20: 7567 735d 2823 6e6f 742d 6d79 2d62 7567  ugs](#not-my-bug
+00000c30: 7329 0a2a 205b 6272 6561 6b69 6e67 2063  s).* [breaking c
+00000c40: 6861 6e67 6573 5d28 2362 7265 616b 696e  hanges](#breakin
+00000c50: 672d 6368 616e 6765 7329 202d 2075 7067  g-changes) - upg
+00000c60: 7261 6465 206e 6f74 6573 0a2a 205b 4641  rade notes.* [FA
+00000c70: 515d 2823 4641 5129 202d 2022 6672 6571  Q](#FAQ) - "freq
+00000c80: 7565 6e74 6c79 2220 6173 6b65 6420 7175  uently" asked qu
+00000c90: 6573 7469 6f6e 730a 2a20 5b61 6363 6f75  estions.* [accou
+00000ca0: 6e74 7320 616e 6420 766f 6c75 6d65 735d  nts and volumes]
+00000cb0: 2823 6163 636f 756e 7473 2d61 6e64 2d76  (#accounts-and-v
+00000cc0: 6f6c 756d 6573 2920 2d20 7065 722d 666f  olumes) - per-fo
+00000cd0: 6c64 6572 2c20 7065 722d 7573 6572 2070  lder, per-user p
+00000ce0: 6572 6d69 7373 696f 6e73 0a20 2020 202a  ermissions.    *
+00000cf0: 205b 7368 6164 6f77 696e 675d 2823 7368   [shadowing](#sh
+00000d00: 6164 6f77 696e 6729 202d 2068 6964 696e  adowing) - hidin
+00000d10: 6720 7370 6563 6966 6963 2073 7562 666f  g specific subfo
+00000d20: 6c64 6572 730a 2a20 5b74 6865 2062 726f  lders.* [the bro
+00000d30: 7773 6572 5d28 2374 6865 2d62 726f 7773  wser](#the-brows
+00000d40: 6572 2920 2d20 6163 6365 7373 696e 6720  er) - accessing 
+00000d50: 6120 636f 7079 7061 7274 7920 7365 7276  a copyparty serv
+00000d60: 6572 2075 7369 6e67 2061 2077 6562 2d62  er using a web-b
+00000d70: 726f 7773 6572 0a20 2020 202a 205b 7461  rowser.    * [ta
+00000d80: 6273 5d28 2374 6162 7329 202d 2074 6865  bs](#tabs) - the
+00000d90: 206d 6169 6e20 7461 6273 2069 6e20 7468   main tabs in th
+00000da0: 6520 7569 0a20 2020 202a 205b 686f 746b  e ui.    * [hotk
+00000db0: 6579 735d 2823 686f 746b 6579 7329 202d  eys](#hotkeys) -
+00000dc0: 2074 6865 2062 726f 7773 6572 2068 6173   the browser has
+00000dd0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2068   the following h
+00000de0: 6f74 6b65 7973 0a20 2020 202a 205b 6e61  otkeys.    * [na
+00000df0: 7670 616e 655d 2823 6e61 7670 616e 6529  vpane](#navpane)
+00000e00: 202d 2073 7769 7463 6869 6e67 2062 6574   - switching bet
+00000e10: 7765 656e 2062 7265 6164 6372 756d 6273  ween breadcrumbs
+00000e20: 206f 7220 6e61 7670 616e 650a 2020 2020   or navpane.    
+00000e30: 2a20 5b74 6875 6d62 6e61 696c 735d 2823  * [thumbnails](#
+00000e40: 7468 756d 626e 6169 6c73 2920 2d20 7072  thumbnails) - pr
+00000e50: 6573 7320 6067 6020 6f72 2060 e794 b060  ess `g` or `...`
+00000e60: 2074 6f20 746f 6767 6c65 2067 7269 642d   to toggle grid-
+00000e70: 7669 6577 2069 6e73 7465 6164 206f 6620  view instead of 
+00000e80: 7468 6520 6669 6c65 206c 6973 7469 6e67  the file listing
+00000e90: 0a20 2020 202a 205b 7a69 7020 646f 776e  .    * [zip down
+00000ea0: 6c6f 6164 735d 2823 7a69 702d 646f 776e  loads](#zip-down
+00000eb0: 6c6f 6164 7329 202d 2064 6f77 6e6c 6f61  loads) - downloa
+00000ec0: 6420 666f 6c64 6572 7320 286f 7220 6669  d folders (or fi
+00000ed0: 6c65 2073 656c 6563 7469 6f6e 7329 2061  le selections) a
+00000ee0: 7320 607a 6970 6020 6f72 2060 7461 7260  s `zip` or `tar`
+00000ef0: 2066 696c 6573 0a20 2020 202a 205b 7570   files.    * [up
+00000f00: 6c6f 6164 696e 675d 2823 7570 6c6f 6164  loading](#upload
+00000f10: 696e 6729 202d 2064 7261 6720 6669 6c65  ing) - drag file
+00000f20: 732f 666f 6c64 6572 7320 696e 746f 2074  s/folders into t
+00000f30: 6865 2077 6562 2d62 726f 7773 6572 2074  he web-browser t
+00000f40: 6f20 7570 6c6f 6164 0a20 2020 2020 2020  o upload.       
+00000f50: 202a 205b 6669 6c65 2d73 6561 7263 685d   * [file-search]
+00000f60: 2823 6669 6c65 2d73 6561 7263 6829 202d  (#file-search) -
+00000f70: 2064 726f 7070 696e 6720 6669 6c65 7320   dropping files 
+00000f80: 696e 746f 2074 6865 2062 726f 7773 6572  into the browser
+00000f90: 2061 6c73 6f20 6c65 7473 2079 6f75 2073   also lets you s
+00000fa0: 6565 2069 6620 7468 6579 2065 7869 7374  ee if they exist
+00000fb0: 206f 6e20 7468 6520 7365 7276 6572 0a20   on the server. 
+00000fc0: 2020 2020 2020 202a 205b 756e 706f 7374         * [unpost
+00000fd0: 5d28 2375 6e70 6f73 7429 202d 2075 6e64  ](#unpost) - und
+00000fe0: 6f2f 6465 6c65 7465 2061 6363 6964 656e  o/delete acciden
+00000ff0: 7461 6c20 7570 6c6f 6164 730a 2020 2020  tal uploads.    
+00001000: 2020 2020 2a20 5b73 656c 662d 6465 7374      * [self-dest
+00001010: 7275 6374 5d28 2373 656c 662d 6465 7374  ruct](#self-dest
+00001020: 7275 6374 2920 2d20 7570 6c6f 6164 7320  ruct) - uploads 
+00001030: 6361 6e20 6265 2067 6976 656e 2061 206c  can be given a l
+00001040: 6966 6574 696d 650a 2020 2020 2a20 5b66  ifetime.    * [f
+00001050: 696c 6520 6d61 6e61 6765 725d 2823 6669  ile manager](#fi
+00001060: 6c65 2d6d 616e 6167 6572 2920 2d20 6375  le-manager) - cu
+00001070: 742f 7061 7374 652c 2072 656e 616d 652c  t/paste, rename,
+00001080: 2061 6e64 2064 656c 6574 6520 6669 6c65   and delete file
+00001090: 732f 666f 6c64 6572 7320 2869 6620 796f  s/folders (if yo
+000010a0: 7520 6861 7665 2070 6572 6d69 7373 696f  u have permissio
+000010b0: 6e29 0a20 2020 202a 205b 6261 7463 6820  n).    * [batch 
+000010c0: 7265 6e61 6d65 5d28 2362 6174 6368 2d72  rename](#batch-r
+000010d0: 656e 616d 6529 202d 2073 656c 6563 7420  ename) - select 
+000010e0: 736f 6d65 2066 696c 6573 2061 6e64 2070  some files and p
+000010f0: 7265 7373 2060 4632 6020 746f 2062 7269  ress `F2` to bri
+00001100: 6e67 2075 7020 7468 6520 7265 6e61 6d65  ng up the rename
+00001110: 2055 490a 2020 2020 2a20 5b6d 6564 6961   UI.    * [media
+00001120: 2070 6c61 7965 725d 2823 6d65 6469 612d   player](#media-
+00001130: 706c 6179 6572 2920 2d20 706c 6179 7320  player) - plays 
+00001140: 616c 6d6f 7374 2065 7665 7279 2061 7564  almost every aud
+00001150: 696f 2066 6f72 6d61 7420 7468 6572 6520  io format there 
+00001160: 6973 0a20 2020 2020 2020 202a 205b 6175  is.        * [au
+00001170: 6469 6f20 6571 7561 6c69 7a65 725d 2823  dio equalizer](#
+00001180: 6175 6469 6f2d 6571 7561 6c69 7a65 7229  audio-equalizer)
+00001190: 202d 2062 6173 7320 626f 6f73 7465 640a   - bass boosted.
+000011a0: 2020 2020 2020 2020 2a20 5b66 6978 2075          * [fix u
+000011b0: 6e72 656c 6961 626c 6520 706c 6179 6261  nreliable playba
+000011c0: 636b 206f 6e20 616e 6472 6f69 645d 2823  ck on android](#
+000011d0: 6669 782d 756e 7265 6c69 6162 6c65 2d70  fix-unreliable-p
+000011e0: 6c61 7962 6163 6b2d 6f6e 2d61 6e64 726f  layback-on-andro
+000011f0: 6964 2920 2d20 6475 6520 746f 2070 686f  id) - due to pho
+00001200: 6e65 202f 2061 7070 2073 6574 7469 6e67  ne / app setting
+00001210: 730a 2020 2020 2a20 5b6d 6172 6b64 6f77  s.    * [markdow
+00001220: 6e20 7669 6577 6572 5d28 236d 6172 6b64  n viewer](#markd
+00001230: 6f77 6e2d 7669 6577 6572 2920 2d20 616e  own-viewer) - an
+00001240: 6420 7468 6572 6520 6172 6520 2a74 776f  d there are *two
+00001250: 2a20 6564 6974 6f72 730a 2020 2020 2a20  * editors.    * 
+00001260: 5b6f 7468 6572 2074 7269 636b 735d 2823  [other tricks](#
+00001270: 6f74 6865 722d 7472 6963 6b73 290a 2020  other-tricks).  
+00001280: 2020 2a20 5b73 6561 7263 6869 6e67 5d28    * [searching](
+00001290: 2373 6561 7263 6869 6e67 2920 2d20 7365  #searching) - se
+000012a0: 6172 6368 2062 7920 7369 7a65 2c20 6461  arch by size, da
+000012b0: 7465 2c20 7061 7468 2f6e 616d 652c 206d  te, path/name, m
+000012c0: 7033 2d74 6167 732c 202e 2e2e 0a2a 205b  p3-tags, ....* [
+000012d0: 7365 7276 6572 2063 6f6e 6669 675d 2823  server config](#
+000012e0: 7365 7276 6572 2d63 6f6e 6669 6729 202d  server-config) -
+000012f0: 2075 7369 6e67 2061 7267 756d 656e 7473   using arguments
+00001300: 206f 7220 636f 6e66 6967 2066 696c 6573   or config files
+00001310: 2c20 6f72 2061 206d 6978 206f 6620 626f  , or a mix of bo
+00001320: 7468 0a20 2020 202a 205b 7a65 726f 636f  th.    * [zeroco
+00001330: 6e66 5d28 237a 6572 6f63 6f6e 6629 202d  nf](#zeroconf) -
+00001340: 2061 6e6e 6f75 6e63 6520 656e 6162 6c65   announce enable
+00001350: 6420 7365 7276 6963 6573 206f 6e20 7468  d services on th
+00001360: 6520 4c41 4e20 285b 7069 635d 2868 7474  e LAN ([pic](htt
+00001370: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00001380: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00001390: 6e74 2e63 6f6d 2f32 3431 3033 322f 3231  nt.com/241032/21
+000013a0: 3533 3434 3733 372d 3065 6165 3864 3938  5344737-0eae8d98
+000013b0: 2d39 3439 362d 3432 3536 2d39 6161 382d  -9496-4256-9aa8-
+000013c0: 6364 3266 3639 3731 3831 3064 2e70 6e67  cd2f6971810d.png
+000013d0: 2929 0a20 2020 2020 2020 202a 205b 6d64  )).        * [md
+000013e0: 6e73 5d28 236d 646e 7329 202d 204c 414e  ns](#mdns) - LAN
+000013f0: 2064 6f6d 6169 6e2d 6e61 6d65 2061 6e64   domain-name and
+00001400: 2066 6561 7475 7265 2061 6e6e 6f75 6e63   feature announc
+00001410: 6572 0a20 2020 2020 2020 202a 205b 7373  er.        * [ss
+00001420: 6470 5d28 2373 7364 7029 202d 2077 696e  dp](#ssdp) - win
+00001430: 646f 7773 2d65 7870 6c6f 7265 7220 616e  dows-explorer an
+00001440: 6e6f 756e 6365 720a 2020 2020 2a20 5b71  nouncer.    * [q
+00001450: 722d 636f 6465 5d28 2371 722d 636f 6465  r-code](#qr-code
+00001460: 2920 2d20 7072 696e 7420 6120 7172 2d63  ) - print a qr-c
+00001470: 6f64 6520 5b28 7363 7265 656e 7368 6f74  ode [(screenshot
+00001480: 295d 2868 7474 7073 3a2f 2f75 7365 722d  )](https://user-
+00001490: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+000014a0: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+000014b0: 3033 322f 3139 3437 3238 3533 332d 3666  032/194728533-6f
+000014c0: 3030 3834 3962 2d63 3661 632d 3433 6336  00849b-c6ac-43c6
+000014d0: 2d39 3335 392d 3833 6534 3534 6431 3165  -9359-83e454d11e
+000014e0: 3030 2e70 6e67 2920 666f 7220 7175 6963  00.png) for quic
+000014f0: 6b20 6163 6365 7373 0a20 2020 202a 205b  k access.    * [
+00001500: 6674 7020 7365 7276 6572 5d28 2366 7470  ftp server](#ftp
+00001510: 2d73 6572 7665 7229 202d 2061 6e20 4654  -server) - an FT
+00001520: 5020 7365 7276 6572 2063 616e 2062 6520  P server can be 
+00001530: 7374 6172 7465 6420 7573 696e 6720 602d  started using `-
+00001540: 2d66 7470 2033 3932 3160 0a20 2020 202a  -ftp 3921`.    *
+00001550: 205b 7765 6264 6176 2073 6572 7665 725d   [webdav server]
+00001560: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
+00001570: 202d 2077 6974 6820 7265 6164 2d77 7269   - with read-wri
+00001580: 7465 2073 7570 706f 7274 0a20 2020 2020  te support.     
+00001590: 2020 202a 205b 636f 6e6e 6563 7469 6e67     * [connecting
+000015a0: 2074 6f20 7765 6264 6176 2066 726f 6d20   to webdav from 
+000015b0: 7769 6e64 6f77 735d 2823 636f 6e6e 6563  windows](#connec
+000015c0: 7469 6e67 2d74 6f2d 7765 6264 6176 2d66  ting-to-webdav-f
+000015d0: 726f 6d2d 7769 6e64 6f77 7329 202d 2075  rom-windows) - u
+000015e0: 7369 6e67 2074 6865 2047 5549 0a20 2020  sing the GUI.   
+000015f0: 202a 205b 736d 6220 7365 7276 6572 5d28   * [smb server](
+00001600: 2373 6d62 2d73 6572 7665 7229 202d 2075  #smb-server) - u
+00001610: 6e73 6166 652c 2073 6c6f 772c 206e 6f74  nsafe, slow, not
+00001620: 2072 6563 6f6d 6d65 6e64 6564 2066 6f72   recommended for
+00001630: 2077 616e 0a20 2020 202a 205b 6669 6c65   wan.    * [file
+00001640: 2069 6e64 6578 696e 675d 2823 6669 6c65   indexing](#file
+00001650: 2d69 6e64 6578 696e 6729 202d 2065 6e61  -indexing) - ena
+00001660: 626c 6573 2064 6564 7570 2061 6e64 206d  bles dedup and m
+00001670: 7573 6963 2073 6561 7263 6820 2b2b 0a20  usic search ++. 
+00001680: 2020 2020 2020 202a 205b 6578 636c 7564         * [exclud
+00001690: 652d 7061 7474 6572 6e73 5d28 2365 7863  e-patterns](#exc
+000016a0: 6c75 6465 2d70 6174 7465 726e 7329 202d  lude-patterns) -
+000016b0: 2074 6f20 7361 7665 2073 6f6d 6520 7469   to save some ti
+000016c0: 6d65 0a20 2020 2020 2020 202a 205b 6669  me.        * [fi
+000016d0: 6c65 7379 7374 656d 2067 7561 7264 735d  lesystem guards]
+000016e0: 2823 6669 6c65 7379 7374 656d 2d67 7561  (#filesystem-gua
+000016f0: 7264 7329 202d 2061 766f 6964 2074 7261  rds) - avoid tra
+00001700: 7665 7273 696e 6720 696e 746f 206f 7468  versing into oth
+00001710: 6572 2066 696c 6573 7973 7465 6d73 0a20  er filesystems. 
+00001720: 2020 2020 2020 202a 205b 7065 7269 6f64         * [period
+00001730: 6963 2072 6573 6361 6e5d 2823 7065 7269  ic rescan](#peri
+00001740: 6f64 6963 2d72 6573 6361 6e29 202d 2066  odic-rescan) - f
+00001750: 696c 6573 7973 7465 6d20 6d6f 6e69 746f  ilesystem monito
+00001760: 7269 6e67 0a20 2020 202a 205b 7570 6c6f  ring.    * [uplo
+00001770: 6164 2072 756c 6573 5d28 2375 706c 6f61  ad rules](#uploa
+00001780: 642d 7275 6c65 7329 202d 2073 6574 2075  d-rules) - set u
+00001790: 706c 6f61 6420 7275 6c65 7320 7573 696e  pload rules usin
+000017a0: 6720 766f 6c66 6c61 6773 0a20 2020 202a  g volflags.    *
+000017b0: 205b 636f 6d70 7265 7373 2075 706c 6f61   [compress uploa
+000017c0: 6473 5d28 2363 6f6d 7072 6573 732d 7570  ds](#compress-up
+000017d0: 6c6f 6164 7329 202d 2066 696c 6573 2063  loads) - files c
+000017e0: 616e 2062 6520 6175 746f 636f 6d70 7265  an be autocompre
+000017f0: 7373 6564 206f 6e20 7570 6c6f 6164 0a20  ssed on upload. 
+00001800: 2020 202a 205b 6f74 6865 7220 666c 6167     * [other flag
+00001810: 735d 2823 6f74 6865 722d 666c 6167 7329  s](#other-flags)
+00001820: 0a20 2020 202a 205b 6461 7461 6261 7365  .    * [database
+00001830: 206c 6f63 6174 696f 6e5d 2823 6461 7461   location](#data
+00001840: 6261 7365 2d6c 6f63 6174 696f 6e29 202d  base-location) -
+00001850: 2069 6e2d 766f 6c75 6d65 2028 602e 6869   in-volume (`.hi
+00001860: 7374 2f75 7032 6b2e 6462 602c 2064 6566  st/up2k.db`, def
+00001870: 6175 6c74 2920 6f72 2073 6f6d 6577 6865  ault) or somewhe
+00001880: 7265 2065 6c73 650a 2020 2020 2a20 5b6d  re else.    * [m
+00001890: 6574 6164 6174 6120 6672 6f6d 2061 7564  etadata from aud
+000018a0: 696f 2066 696c 6573 5d28 236d 6574 6164  io files](#metad
+000018b0: 6174 612d 6672 6f6d 2d61 7564 696f 2d66  ata-from-audio-f
+000018c0: 696c 6573 2920 2d20 7365 7420 602d 6532  iles) - set `-e2
+000018d0: 7460 2074 6f20 696e 6465 7820 7461 6773  t` to index tags
+000018e0: 206f 6e20 7570 6c6f 6164 0a20 2020 202a   on upload.    *
+000018f0: 205b 6669 6c65 2070 6172 7365 7220 706c   [file parser pl
+00001900: 7567 696e 735d 2823 6669 6c65 2d70 6172  ugins](#file-par
+00001910: 7365 722d 706c 7567 696e 7329 202d 2070  ser-plugins) - p
+00001920: 726f 7669 6465 2063 7573 746f 6d20 7061  rovide custom pa
+00001930: 7273 6572 7320 746f 2069 6e64 6578 2061  rsers to index a
+00001940: 6464 6974 696f 6e61 6c20 7461 6773 0a20  dditional tags. 
+00001950: 2020 202a 205b 6576 656e 7420 686f 6f6b     * [event hook
+00001960: 735d 2823 6576 656e 742d 686f 6f6b 7329  s](#event-hooks)
+00001970: 202d 2074 7269 6767 6572 2061 2070 726f   - trigger a pro
+00001980: 6772 616d 206f 6e20 7570 6c6f 6164 732c  gram on uploads,
+00001990: 2072 656e 616d 6573 2065 7463 2028 5b65   renames etc ([e
+000019a0: 7861 6d70 6c65 735d 282e 2f62 696e 2f68  xamples](./bin/h
+000019b0: 6f6f 6b73 2f29 290a 2020 2020 2020 2020  ooks/)).        
+000019c0: 2a20 5b75 706c 6f61 6420 6576 656e 7473  * [upload events
+000019d0: 5d28 2375 706c 6f61 642d 6576 656e 7473  ](#upload-events
+000019e0: 2920 2d20 7468 6520 6f6c 6465 722c 206d  ) - the older, m
+000019f0: 6f72 6520 706f 7765 7266 756c 2061 7070  ore powerful app
+00001a00: 726f 6163 6820 285b 6578 616d 706c 6573  roach ([examples
+00001a10: 5d28 2e2f 6269 6e2f 6d74 6167 2f29 290a  ](./bin/mtag/)).
+00001a20: 2020 2020 2a20 5b68 6964 696e 6720 6672      * [hiding fr
+00001a30: 6f6d 2067 6f6f 676c 655d 2823 6869 6469  om google](#hidi
+00001a40: 6e67 2d66 726f 6d2d 676f 6f67 6c65 2920  ng-from-google) 
+00001a50: 2d20 7465 6c6c 2073 6561 7263 6820 656e  - tell search en
+00001a60: 6769 6e65 7320 796f 7520 646f 6e74 2077  gines you dont w
+00001a70: 616e 6e61 2062 6520 696e 6465 7865 640a  anna be indexed.
+00001a80: 2020 2020 2a20 5b74 6865 6d65 735d 2823      * [themes](#
+00001a90: 7468 656d 6573 290a 2020 2020 2a20 5b63  themes).    * [c
+00001aa0: 6f6d 706c 6574 6520 6578 616d 706c 6573  omplete examples
+00001ab0: 5d28 2363 6f6d 706c 6574 652d 6578 616d  ](#complete-exam
+00001ac0: 706c 6573 290a 2020 2020 2a20 5b72 6576  ples).    * [rev
+00001ad0: 6572 7365 2d70 726f 7879 5d28 2372 6576  erse-proxy](#rev
+00001ae0: 6572 7365 2d70 726f 7879 2920 2d20 7275  erse-proxy) - ru
+00001af0: 6e6e 696e 6720 636f 7079 7061 7274 7920  nning copyparty 
+00001b00: 6e65 7874 2074 6f20 6f74 6865 7220 7765  next to other we
+00001b10: 6273 6974 6573 0a2a 205b 7061 636b 6167  bsites.* [packag
+00001b20: 6573 5d28 2370 6163 6b61 6765 7329 202d  es](#packages) -
+00001b30: 2074 6865 2070 6172 7479 206d 6967 6874   the party might
+00001b40: 2062 6520 636c 6f73 6572 2074 6861 6e20   be closer than 
+00001b50: 796f 7520 7468 696e 6b0a 2020 2020 2a20  you think.    * 
+00001b60: 5b61 7263 6820 7061 636b 6167 655d 2823  [arch package](#
+00001b70: 6172 6368 2d70 6163 6b61 6765 2920 2d20  arch-package) - 
+00001b80: 6e6f 7720 5b61 7661 696c 6162 6c65 206f  now [available o
+00001b90: 6e20 6175 725d 2868 7474 7073 3a2f 2f61  n aur](https://a
+00001ba0: 7572 2e61 7263 686c 696e 7578 2e6f 7267  ur.archlinux.org
+00001bb0: 2f70 6163 6b61 6765 732f 636f 7079 7061  /packages/copypa
+00001bc0: 7274 7929 206d 6169 6e74 6169 6e65 6420  rty) maintained 
+00001bd0: 6279 205b 4069 6378 6573 5d28 6874 7470  by [@icxes](http
+00001be0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f69  s://github.com/i
+00001bf0: 6378 6573 290a 2020 2020 2a20 5b6e 6978  cxes).    * [nix
+00001c00: 2070 6163 6b61 6765 5d28 236e 6978 2d70   package](#nix-p
+00001c10: 6163 6b61 6765 2920 2d20 606e 6978 2070  ackage) - `nix p
+00001c20: 726f 6669 6c65 2069 6e73 7461 6c6c 2067  rofile install g
+00001c30: 6974 6875 623a 3930 3031 2f63 6f70 7970  ithub:9001/copyp
+00001c40: 6172 7479 600a 2020 2020 2a20 5b6e 6978  arty`.    * [nix
+00001c50: 6f73 206d 6f64 756c 655d 2823 6e69 786f  os module](#nixo
+00001c60: 732d 6d6f 6475 6c65 290a 2a20 5b62 726f  s-module).* [bro
+00001c70: 7773 6572 2073 7570 706f 7274 5d28 2362  wser support](#b
+00001c80: 726f 7773 6572 2d73 7570 706f 7274 2920  rowser-support) 
+00001c90: 2d20 544c 4452 3a20 7965 730a 2a20 5b63  - TLDR: yes.* [c
+00001ca0: 6c69 656e 7420 6578 616d 706c 6573 5d28  lient examples](
+00001cb0: 2363 6c69 656e 742d 6578 616d 706c 6573  #client-examples
+00001cc0: 2920 2d20 696e 7465 7261 6374 2077 6974  ) - interact wit
+00001cd0: 6820 636f 7079 7061 7274 7920 7573 696e  h copyparty usin
+00001ce0: 6720 6e6f 6e2d 6272 6f77 7365 7220 636c  g non-browser cl
+00001cf0: 6965 6e74 730a 2020 2020 2a20 5b66 6f6c  ients.    * [fol
+00001d00: 6465 7220 7379 6e63 5d28 2366 6f6c 6465  der sync](#folde
+00001d10: 722d 7379 6e63 2920 2d20 7379 6e63 2066  r-sync) - sync f
+00001d20: 6f6c 6465 7273 2074 6f2f 6672 6f6d 2063  olders to/from c
+00001d30: 6f70 7970 6172 7479 0a20 2020 202a 205b  opyparty.    * [
+00001d40: 6d6f 756e 7420 6173 2064 7269 7665 5d28  mount as drive](
+00001d50: 236d 6f75 6e74 2d61 732d 6472 6976 6529  #mount-as-drive)
+00001d60: 202d 2061 2072 656d 6f74 6520 636f 7079   - a remote copy
+00001d70: 7061 7274 7920 7365 7276 6572 2061 7320  party server as 
+00001d80: 6120 6c6f 6361 6c20 6669 6c65 7379 7374  a local filesyst
+00001d90: 656d 0a2a 205b 616e 6472 6f69 6420 6170  em.* [android ap
+00001da0: 705d 2823 616e 6472 6f69 642d 6170 7029  p](#android-app)
+00001db0: 202d 2075 706c 6f61 6420 746f 2063 6f70   - upload to cop
+00001dc0: 7970 6172 7479 2077 6974 6820 6f6e 6520  yparty with one 
+00001dd0: 7461 700a 2a20 5b69 4f53 2073 686f 7274  tap.* [iOS short
+00001de0: 6375 7473 5d28 2369 4f53 2d73 686f 7274  cuts](#iOS-short
+00001df0: 6375 7473 2920 2d20 7468 6572 6520 6973  cuts) - there is
+00001e00: 206e 6f20 6950 686f 6e65 2061 7070 2c20   no iPhone app, 
+00001e10: 6275 740a 2a20 5b70 6572 666f 726d 616e  but.* [performan
+00001e20: 6365 5d28 2370 6572 666f 726d 616e 6365  ce](#performance
+00001e30: 2920 2d20 6465 6661 756c 7473 2061 7265  ) - defaults are
+00001e40: 2075 7375 616c 6c79 2066 696e 6520 2d20   usually fine - 
+00001e50: 6578 7065 6374 2060 3820 4769 422f 7360  expect `8 GiB/s`
+00001e60: 2064 6f77 6e6c 6f61 642c 2060 3120 4769   download, `1 Gi
+00001e70: 422f 7360 2075 706c 6f61 640a 2020 2020  B/s` upload.    
+00001e80: 2a20 5b63 6c69 656e 742d 7369 6465 5d28  * [client-side](
+00001e90: 2363 6c69 656e 742d 7369 6465 2920 2d20  #client-side) - 
+00001ea0: 7768 656e 2075 706c 6f61 6469 6e67 2066  when uploading f
+00001eb0: 696c 6573 0a2a 205b 7365 6375 7269 7479  iles.* [security
+00001ec0: 5d28 2373 6563 7572 6974 7929 202d 2073  ](#security) - s
+00001ed0: 6f6d 6520 6e6f 7465 7320 6f6e 2068 6172  ome notes on har
+00001ee0: 6465 6e69 6e67 0a20 2020 202a 205b 676f  dening.    * [go
+00001ef0: 7463 6861 735d 2823 676f 7463 6861 7329  tchas](#gotchas)
+00001f00: 202d 2062 6568 6176 696f 7220 7468 6174   - behavior that
+00001f10: 206d 6967 6874 2062 6520 756e 6578 7065   might be unexpe
+00001f20: 6374 6564 0a20 2020 202a 205b 636f 7273  cted.    * [cors
+00001f30: 5d28 2363 6f72 7329 202d 2063 726f 7373  ](#cors) - cross
+00001f40: 2d73 6974 6520 7265 7175 6573 7420 636f  -site request co
+00001f50: 6e66 6967 0a20 2020 202a 205b 6874 7470  nfig.    * [http
+00001f60: 735d 2823 6874 7470 7329 202d 2062 6f74  s](#https) - bot
+00001f70: 6820 4854 5450 2061 6e64 2048 5454 5053  h HTTP and HTTPS
+00001f80: 2061 7265 2061 6363 6570 7465 640a 2a20   are accepted.* 
+00001f90: 5b72 6563 6f76 6572 696e 6720 6672 6f6d  [recovering from
+00001fa0: 2063 7261 7368 6573 5d28 2372 6563 6f76   crashes](#recov
+00001fb0: 6572 696e 672d 6672 6f6d 2d63 7261 7368  ering-from-crash
+00001fc0: 6573 290a 2020 2020 2a20 5b63 6c69 656e  es).    * [clien
+00001fd0: 7420 6372 6173 6865 735d 2823 636c 6965  t crashes](#clie
+00001fe0: 6e74 2d63 7261 7368 6573 290a 2020 2020  nt-crashes).    
+00001ff0: 2020 2020 2a20 5b66 7265 666f 7820 7773      * [frefox ws
+00002000: 6f64 5d28 2366 7265 666f 782d 7773 6f64  od](#frefox-wsod
+00002010: 2920 2d20 6669 7265 666f 7820 3837 2063  ) - firefox 87 c
+00002020: 616e 2063 7261 7368 2064 7572 696e 6720  an crash during 
+00002030: 7570 6c6f 6164 730a 2a20 5b48 5454 5020  uploads.* [HTTP 
+00002040: 4150 495d 2823 4854 5450 2d41 5049 2920  API](#HTTP-API) 
+00002050: 2d20 7365 6520 5b64 6576 6e6f 7465 735d  - see [devnotes]
+00002060: 282e 2f64 6f63 732f 6465 766e 6f74 6573  (./docs/devnotes
+00002070: 2e6d 6423 6874 7470 2d61 7069 290a 2a20  .md#http-api).* 
+00002080: 5b64 6570 656e 6465 6e63 6965 735d 2823  [dependencies](#
+00002090: 6465 7065 6e64 656e 6369 6573 2920 2d20  dependencies) - 
+000020a0: 6d61 6e64 6174 6f72 7920 6465 7073 0a20  mandatory deps. 
+000020b0: 2020 202a 205b 6f70 7469 6f6e 616c 2064     * [optional d
+000020c0: 6570 656e 6465 6e63 6965 735d 2823 6f70  ependencies](#op
+000020d0: 7469 6f6e 616c 2d64 6570 656e 6465 6e63  tional-dependenc
+000020e0: 6965 7329 202d 2069 6e73 7461 6c6c 2074  ies) - install t
+000020f0: 6865 7365 2074 6f20 656e 6162 6c65 2062  hese to enable b
+00002100: 6f6e 7573 2066 6561 7475 7265 730a 2020  onus features.  
+00002110: 2020 2a20 5b6f 7074 696f 6e61 6c20 6770    * [optional gp
+00002120: 6c20 7374 7566 665d 2823 6f70 7469 6f6e  l stuff](#option
+00002130: 616c 2d67 706c 2d73 7475 6666 290a 2a20  al-gpl-stuff).* 
+00002140: 5b73 6678 5d28 2373 6678 2920 2d20 7468  [sfx](#sfx) - th
+00002150: 6520 7365 6c66 2d63 6f6e 7461 696e 6564  e self-contained
+00002160: 2022 6269 6e61 7279 220a 2020 2020 2a20   "binary".    * 
+00002170: 5b63 6f70 7970 6172 7479 2e65 7865 5d28  [copyparty.exe](
+00002180: 2363 6f70 7970 6172 7479 6578 6529 202d  #copypartyexe) -
+00002190: 2064 6f77 6e6c 6f61 6420 5b63 6f70 7970   download [copyp
+000021a0: 6172 7479 2e65 7865 5d28 6874 7470 733a  arty.exe](https:
+000021b0: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+000021c0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
+000021d0: 6173 6573 2f6c 6174 6573 742f 646f 776e  ases/latest/down
+000021e0: 6c6f 6164 2f63 6f70 7970 6172 7479 2e65  load/copyparty.e
+000021f0: 7865 2920 2877 696e 382b 2920 6f72 205b  xe) (win8+) or [
+00002200: 636f 7079 7061 7274 7933 322e 6578 655d  copyparty32.exe]
+00002210: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00002220: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00002230: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00002240: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00002250: 7061 7274 7933 322e 6578 6529 2028 7769  party32.exe) (wi
+00002260: 6e37 2b29 0a2a 205b 696e 7374 616c 6c20  n7+).* [install 
+00002270: 6f6e 2061 6e64 726f 6964 5d28 2369 6e73  on android](#ins
+00002280: 7461 6c6c 2d6f 6e2d 616e 6472 6f69 6429  tall-on-android)
+00002290: 0a2a 205b 7265 706f 7274 696e 6720 6275  .* [reporting bu
+000022a0: 6773 5d28 2372 6570 6f72 7469 6e67 2d62  gs](#reporting-b
+000022b0: 7567 7329 202d 2069 6465 6173 2066 6f72  ugs) - ideas for
+000022c0: 2063 6f6e 7465 7874 2074 6f20 696e 636c   context to incl
+000022d0: 7564 6520 696e 2062 7567 2072 6570 6f72  ude in bug repor
+000022e0: 7473 0a2a 205b 6465 766e 6f74 6573 5d28  ts.* [devnotes](
+000022f0: 2364 6576 6e6f 7465 7329 202d 2066 6f72  #devnotes) - for
+00002300: 2062 7569 6c64 2069 6e73 7472 7563 7469   build instructi
+00002310: 6f6e 7320 6574 632c 2073 6565 205b 2e2f  ons etc, see [./
+00002320: 646f 6373 2f64 6576 6e6f 7465 732e 6d64  docs/devnotes.md
+00002330: 5d28 2e2f 646f 6373 2f64 6576 6e6f 7465  ](./docs/devnote
+00002340: 732e 6d64 290a 0a0a 2323 2071 7569 636b  s.md)...## quick
+00002350: 7374 6172 740a 0a6a 7573 7420 7275 6e20  start..just run 
+00002360: 2a2a 5b63 6f70 7970 6172 7479 2d73 6678  **[copyparty-sfx
+00002370: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
+00002380: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+00002390: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+000023a0: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+000023b0: 636f 7079 7061 7274 792d 7366 782e 7079  copyparty-sfx.py
+000023c0: 292a 2a20 2d2d 2074 6861 7427 7320 6974  )** -- that's it
+000023d0: 2120 f09f 8e89 0a0a 2a20 6f72 2069 6e73  ! ......* or ins
+000023e0: 7461 6c6c 2074 6872 6f75 6768 2070 7970  tall through pyp
+000023f0: 6920 2870 7974 686f 6e33 206f 6e6c 7929  i (python3 only)
+00002400: 3a20 6070 7974 686f 6e33 202d 6d20 7069  : `python3 -m pi
+00002410: 7020 696e 7374 616c 6c20 2d2d 7573 6572  p install --user
+00002420: 202d 5520 636f 7079 7061 7274 7960 0a2a   -U copyparty`.*
+00002430: 206f 7220 6966 2079 6f75 2063 616e 6e6f   or if you canno
+00002440: 7420 696e 7374 616c 6c20 7079 7468 6f6e  t install python
+00002450: 2c20 796f 7520 6361 6e20 7573 6520 5b63  , you can use [c
+00002460: 6f70 7970 6172 7479 2e65 7865 5d28 2363  opyparty.exe](#c
+00002470: 6f70 7970 6172 7479 6578 6529 2069 6e73  opypartyexe) ins
+00002480: 7465 6164 0a2a 206f 7220 5b69 6e73 7461  tead.* or [insta
+00002490: 6c6c 2074 6872 6f75 6768 206e 6978 5d28  ll through nix](
+000024a0: 236e 6978 2d70 6163 6b61 6765 292c 206f  #nix-package), o
+000024b0: 7220 5b6f 6e20 4e69 784f 535d 2823 6e69  r [on NixOS](#ni
+000024c0: 786f 732d 6d6f 6475 6c65 292c 206f 7220  xos-module), or 
+000024d0: 5b6f 6e20 6172 6368 5d28 2361 7263 682d  [on arch](#arch-
+000024e0: 7061 636b 6167 6529 0a2a 206f 7220 6966  package).* or if
+000024f0: 2079 6f75 2061 7265 206f 6e20 616e 6472   you are on andr
+00002500: 6f69 642c 205b 696e 7374 616c 6c20 636f  oid, [install co
+00002510: 7079 7061 7274 7920 696e 2074 6572 6d75  pyparty in termu
+00002520: 785d 2823 696e 7374 616c 6c2d 6f6e 2d61  x](#install-on-a
+00002530: 6e64 726f 6964 290a 2a20 6f72 2069 6620  ndroid).* or if 
+00002540: 796f 7520 7072 6566 6572 2074 6f20 5b75  you prefer to [u
+00002550: 7365 2064 6f63 6b65 725d 282e 2f73 6372  se docker](./scr
+00002560: 6970 7473 2f64 6f63 6b65 722f 2920 f09f  ipts/docker/) ..
+00002570: 908b 2079 6f75 2063 616e 2064 6f20 7468  .. you can do th
+00002580: 6174 2074 6f6f 0a20 202a 2064 6f63 6b65  at too.  * docke
+00002590: 7220 6861 7320 616c 6c20 6465 7073 2062  r has all deps b
+000025a0: 7569 6c74 2d69 6e2c 2073 6f20 736b 6970  uilt-in, so skip
+000025b0: 2074 6869 7320 7374 6570 3a0a 0a65 6e61   this step:..ena
+000025c0: 626c 6520 7468 756d 626e 6169 6c73 2028  ble thumbnails (
+000025d0: 696d 6167 6573 2f61 7564 696f 2f76 6964  images/audio/vid
+000025e0: 656f 292c 206d 6564 6961 2069 6e64 6578  eo), media index
+000025f0: 696e 672c 2061 6e64 2061 7564 696f 2074  ing, and audio t
+00002600: 7261 6e73 636f 6469 6e67 2062 7920 696e  ranscoding by in
+00002610: 7374 616c 6c69 6e67 2073 6f6d 6520 7265  stalling some re
+00002620: 636f 6d6d 656e 6465 6420 6465 7073 3a0a  commended deps:.
+00002630: 0a2a 202a 2a41 6c70 696e 653a 2a2a 2060  .* **Alpine:** `
+00002640: 6170 6b20 6164 6420 7079 332d 7069 6c6c  apk add py3-pill
+00002650: 6f77 2066 666d 7065 6760 0a2a 202a 2a44  ow ffmpeg`.* **D
+00002660: 6562 6961 6e3a 2a2a 2060 6170 7420 696e  ebian:** `apt in
+00002670: 7374 616c 6c20 7079 7468 6f6e 332d 7069  stall python3-pi
+00002680: 6c20 6666 6d70 6567 600a 2a20 2a2a 4665  l ffmpeg`.* **Fe
+00002690: 646f 7261 3a2a 2a20 6064 6e66 2069 6e73  dora:** `dnf ins
+000026a0: 7461 6c6c 2070 7974 686f 6e33 2d70 696c  tall python3-pil
+000026b0: 6c6f 7720 6666 6d70 6567 600a 2a20 2a2a  low ffmpeg`.* **
+000026c0: 4672 6565 4253 443a 2a2a 2060 706b 6720  FreeBSD:** `pkg 
+000026d0: 696e 7374 616c 6c20 7079 3339 2d73 716c  install py39-sql
+000026e0: 6974 6533 2070 7933 392d 7069 6c6c 6f77  ite3 py39-pillow
+000026f0: 2066 666d 7065 6760 0a2a 202a 2a4d 6163   ffmpeg`.* **Mac
+00002700: 4f53 3a2a 2a20 6070 6f72 7420 696e 7374  OS:** `port inst
+00002710: 616c 6c20 7079 2d50 696c 6c6f 7720 6666  all py-Pillow ff
+00002720: 6d70 6567 600a 2a20 2a2a 4d61 634f 532a  mpeg`.* **MacOS*
+00002730: 2a20 2861 6c74 6572 6e61 7469 7665 293a  * (alternative):
+00002740: 2060 6272 6577 2069 6e73 7461 6c6c 2070   `brew install p
+00002750: 696c 6c6f 7720 6666 6d70 6567 600a 2a20  illow ffmpeg`.* 
+00002760: 2a2a 5769 6e64 6f77 733a 2a2a 2060 7079  **Windows:** `py
+00002770: 7468 6f6e 202d 6d20 7069 7020 696e 7374  thon -m pip inst
+00002780: 616c 6c20 2d2d 7573 6572 202d 5520 5069  all --user -U Pi
+00002790: 6c6c 6f77 600a 2020 2a20 696e 7374 616c  llow`.  * instal
+000027a0: 6c20 7079 7468 6f6e 2061 6e64 2066 666d  l python and ffm
+000027b0: 7065 6720 6d61 6e75 616c 6c79 3b20 646f  peg manually; do
+000027c0: 206e 6f74 2075 7365 2060 7769 6e67 6574   not use `winget
+000027d0: 6020 6f72 2060 4d69 6372 6f73 6f66 7420  ` or `Microsoft 
+000027e0: 5374 6f72 6560 2028 6974 2062 7265 616b  Store` (it break
+000027f0: 7320 2450 4154 4829 0a20 202a 2063 6f70  s $PATH).  * cop
+00002800: 7970 6172 7479 2e65 7865 2063 6f6d 6573  yparty.exe comes
+00002810: 2077 6974 6820 6050 696c 6c6f 7760 2061   with `Pillow` a
+00002820: 6e64 206f 6e6c 7920 6e65 6564 7320 6066  nd only needs `f
+00002830: 666d 7065 6760 0a2a 2073 6565 205b 6f70  fmpeg`.* see [op
+00002840: 7469 6f6e 616c 2064 6570 656e 6465 6e63  tional dependenc
+00002850: 6965 735d 2823 6f70 7469 6f6e 616c 2d64  ies](#optional-d
+00002860: 6570 656e 6465 6e63 6965 7329 2074 6f20  ependencies) to 
+00002870: 656e 6162 6c65 2065 7665 6e20 6d6f 7265  enable even more
+00002880: 2066 6561 7475 7265 730a 0a72 756e 6e69   features..runni
+00002890: 6e67 2063 6f70 7970 6172 7479 2077 6974  ng copyparty wit
+000028a0: 686f 7574 2061 7267 756d 656e 7473 2028  hout arguments (
+000028b0: 666f 7220 6578 616d 706c 6520 646f 7562  for example doub
+000028c0: 6c65 636c 6963 6b69 6e67 2069 7420 6f6e  leclicking it on
+000028d0: 2057 696e 646f 7773 2920 7769 6c6c 2067   Windows) will g
+000028e0: 6976 6520 6576 6572 796f 6e65 2072 6561  ive everyone rea
+000028f0: 642f 7772 6974 6520 6163 6365 7373 2074  d/write access t
+00002900: 6f20 7468 6520 6375 7272 656e 7420 666f  o the current fo
+00002910: 6c64 6572 3b20 796f 7520 6d61 7920 7761  lder; you may wa
+00002920: 6e74 205b 6163 636f 756e 7473 2061 6e64  nt [accounts and
+00002930: 2076 6f6c 756d 6573 5d28 2361 6363 6f75   volumes](#accou
+00002940: 6e74 732d 616e 642d 766f 6c75 6d65 7329  nts-and-volumes)
+00002950: 0a0a 6f72 2073 6565 205b 636f 6d70 6c65  ..or see [comple
+00002960: 7465 2077 696e 646f 7773 2065 7861 6d70  te windows examp
+00002970: 6c65 5d28 2e2f 646f 6373 2f65 7861 6d70  le](./docs/examp
+00002980: 6c65 732f 7769 6e64 6f77 732e 6d64 290a  les/windows.md).
+00002990: 0a73 6f6d 6520 7265 636f 6d6d 656e 6465  .some recommende
+000029a0: 6420 6f70 7469 6f6e 733a 0a2a 2060 2d65  d options:.* `-e
+000029b0: 3264 7361 6020 656e 6162 6c65 7320 6765  2dsa` enables ge
+000029c0: 6e65 7261 6c20 5b66 696c 6520 696e 6465  neral [file inde
+000029d0: 7869 6e67 5d28 2366 696c 652d 696e 6465  xing](#file-inde
+000029e0: 7869 6e67 290a 2a20 602d 6532 7473 6020  xing).* `-e2ts` 
+000029f0: 656e 6162 6c65 7320 6175 6469 6f20 6d65  enables audio me
+00002a00: 7461 6461 7461 2069 6e64 6578 696e 6720  tadata indexing 
+00002a10: 286e 6565 6473 2065 6974 6865 7220 4646  (needs either FF
+00002a20: 7072 6f62 6520 6f72 204d 7574 6167 656e  probe or Mutagen
+00002a30: 290a 2a20 602d 7620 2f6d 6e74 2f6d 7573  ).* `-v /mnt/mus
+00002a40: 6963 3a2f 6d75 7369 633a 723a 7277 2c66  ic:/music:r:rw,f
+00002a50: 6f6f 202d 6120 666f 6f3a 6261 7260 2073  oo -a foo:bar` s
+00002a60: 6861 7265 7320 602f 6d6e 742f 6d75 7369  hares `/mnt/musi
+00002a70: 6360 2061 7320 602f 6d75 7369 6360 2c20  c` as `/music`, 
+00002a80: 6072 6065 6164 6162 6c65 2062 7920 616e  `r`eadable by an
+00002a90: 796f 6e65 2c20 616e 6420 7265 6164 2d77  yone, and read-w
+00002aa0: 7269 7465 2066 6f72 2075 7365 7220 6066  rite for user `f
+00002ab0: 6f6f 602c 2070 6173 7377 6f72 6420 6062  oo`, password `b
+00002ac0: 6172 600a 2020 2a20 7265 706c 6163 6520  ar`.  * replace 
+00002ad0: 603a 723a 7277 2c66 6f6f 6020 7769 7468  `:r:rw,foo` with
+00002ae0: 2060 3a72 2c66 6f6f 6020 746f 206f 6e6c   `:r,foo` to onl
+00002af0: 7920 6d61 6b65 2074 6865 2066 6f6c 6465  y make the folde
+00002b00: 7220 7265 6164 6162 6c65 2062 7920 6066  r readable by `f
+00002b10: 6f6f 6020 616e 6420 6e6f 626f 6479 2065  oo` and nobody e
+00002b20: 6c73 650a 2020 2a20 7365 6520 5b61 6363  lse.  * see [acc
+00002b30: 6f75 6e74 7320 616e 6420 766f 6c75 6d65  ounts and volume
+00002b40: 735d 2823 6163 636f 756e 7473 2d61 6e64  s](#accounts-and
+00002b50: 2d76 6f6c 756d 6573 2920 286f 7220 602d  -volumes) (or `-
+00002b60: 2d68 656c 702d 6163 636f 756e 7473 6029  -help-accounts`)
+00002b70: 2066 6f72 2074 6865 2073 796e 7461 7820   for the syntax 
+00002b80: 616e 6420 6f74 6865 7220 7065 726d 6973  and other permis
+00002b90: 7369 6f6e 730a 0a0a 2323 2320 6f6e 2073  sions...### on s
+00002ba0: 6572 7665 7273 0a0a 796f 7520 6d61 7920  ervers..you may 
+00002bb0: 616c 736f 2077 616e 7420 7468 6573 652c  also want these,
+00002bc0: 2065 7370 6563 6961 6c6c 7920 6f6e 2073   especially on s
+00002bd0: 6572 7665 7273 3a0a 0a2a 205b 636f 6e74  ervers:..* [cont
+00002be0: 7269 622f 7379 7374 656d 642f 636f 7079  rib/systemd/copy
+00002bf0: 7061 7274 792e 7365 7276 6963 655d 2863  party.service](c
+00002c00: 6f6e 7472 6962 2f73 7973 7465 6d64 2f63  ontrib/systemd/c
+00002c10: 6f70 7970 6172 7479 2e73 6572 7669 6365  opyparty.service
+00002c20: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
+00002c30: 7479 2061 7320 6120 7379 7374 656d 6420  ty as a systemd 
+00002c40: 7365 7276 6963 6520 2873 6565 2067 7569  service (see gui
+00002c50: 6465 2069 6e73 6964 6529 0a2a 205b 636f  de inside).* [co
+00002c60: 6e74 7269 622f 7379 7374 656d 642f 7072  ntrib/systemd/pr
+00002c70: 6973 6f6e 7061 7274 792e 7365 7276 6963  isonparty.servic
+00002c80: 655d 2863 6f6e 7472 6962 2f73 7973 7465  e](contrib/syste
+00002c90: 6d64 2f70 7269 736f 6e70 6172 7479 2e73  md/prisonparty.s
+00002ca0: 6572 7669 6365 2920 746f 2072 756e 2069  ervice) to run i
+00002cb0: 7420 696e 2061 2063 6872 6f6f 7420 2866  t in a chroot (f
+00002cc0: 6f72 2065 7874 7261 2073 6563 7572 6974  or extra securit
+00002cd0: 7929 0a2a 205b 636f 6e74 7269 622f 7263  y).* [contrib/rc
+00002ce0: 2f63 6f70 7970 6172 7479 5d28 636f 6e74  /copyparty](cont
+00002cf0: 7269 622f 7263 2f63 6f70 7970 6172 7479  rib/rc/copyparty
+00002d00: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
+00002d10: 7479 206f 6e20 4672 6565 4253 440a 2a20  ty on FreeBSD.* 
+00002d20: 5b63 6f6e 7472 6962 2f6e 6769 6e78 2f63  [contrib/nginx/c
+00002d30: 6f70 7970 6172 7479 2e63 6f6e 665d 2863  opyparty.conf](c
+00002d40: 6f6e 7472 6962 2f6e 6769 6e78 2f63 6f70  ontrib/nginx/cop
+00002d50: 7970 6172 7479 2e63 6f6e 6629 2074 6f20  yparty.conf) to 
+00002d60: 5b72 6576 6572 7365 2d70 726f 7879 5d28  [reverse-proxy](
+00002d70: 2372 6576 6572 7365 2d70 726f 7879 2920  #reverse-proxy) 
+00002d80: 6265 6869 6e64 206e 6769 6e78 2028 666f  behind nginx (fo
+00002d90: 7220 6265 7474 6572 2068 7474 7073 290a  r better https).
+00002da0: 2a20 5b6e 6978 6f73 206d 6f64 756c 655d  * [nixos module]
+00002db0: 2823 6e69 786f 732d 6d6f 6475 6c65 2920  (#nixos-module) 
+00002dc0: 746f 2072 756e 2063 6f70 7970 6172 7479  to run copyparty
+00002dd0: 206f 6e20 4e69 784f 5320 686f 7374 730a   on NixOS hosts.
+00002de0: 0a61 6e64 2072 656d 656d 6265 7220 746f  .and remember to
+00002df0: 206f 7065 6e20 7468 6520 706f 7274 7320   open the ports 
+00002e00: 796f 7520 7761 6e74 3b20 6865 7265 2773  you want; here's
+00002e10: 2061 2063 6f6d 706c 6574 6520 6578 616d   a complete exam
+00002e20: 706c 6520 696e 636c 7564 696e 6720 6576  ple including ev
+00002e30: 6572 7920 6665 6174 7572 6520 636f 7079  ery feature copy
+00002e40: 7061 7274 7920 6861 7320 746f 206f 6666  party has to off
+00002e50: 6572 3a0a 6060 600a 6669 7265 7761 6c6c  er:.```.firewall
+00002e60: 2d63 6d64 202d 2d70 6572 6d61 6e65 6e74  -cmd --permanent
+00002e70: 202d 2d61 6464 2d70 6f72 743d 7b38 302c   --add-port={80,
+00002e80: 3434 332c 3339 3231 2c33 3932 332c 3339  443,3921,3923,39
+00002e90: 3435 2c33 3939 307d 2f74 6370 2020 2320  45,3990}/tcp  # 
+00002ea0: 2d2d 7a6f 6e65 3d6c 6962 7669 7274 0a66  --zone=libvirt.f
+00002eb0: 6972 6577 616c 6c2d 636d 6420 2d2d 7065  irewall-cmd --pe
+00002ec0: 726d 616e 656e 7420 2d2d 6164 642d 706f  rmanent --add-po
+00002ed0: 7274 3d31 3230 3030 2d31 3230 3939 2f74  rt=12000-12099/t
+00002ee0: 6370 202d 2d70 6572 6d61 6e65 6e74 2020  cp --permanent  
+00002ef0: 2320 2d2d 7a6f 6e65 3d6c 6962 7669 7274  # --zone=libvirt
+00002f00: 0a66 6972 6577 616c 6c2d 636d 6420 2d2d  .firewall-cmd --
+00002f10: 7065 726d 616e 656e 7420 2d2d 6164 642d  permanent --add-
+00002f20: 706f 7274 3d7b 3139 3030 2c35 3335 337d  port={1900,5353}
+00002f30: 2f75 6470 2020 2320 2d2d 7a6f 6e65 3d6c  /udp  # --zone=l
+00002f40: 6962 7669 7274 0a66 6972 6577 616c 6c2d  ibvirt.firewall-
+00002f50: 636d 6420 2d2d 7265 6c6f 6164 0a60 6060  cmd --reload.```
+00002f60: 0a28 3139 3030 3a73 7364 702c 2033 3932  .(1900:ssdp, 392
+00002f70: 313a 6674 702c 2033 3932 333a 6874 7470  1:ftp, 3923:http
+00002f80: 2f68 7474 7073 2c20 3339 3435 3a73 6d62  /https, 3945:smb
+00002f90: 2c20 3339 3930 3a66 7470 732c 2035 3335  , 3990:ftps, 535
+00002fa0: 333a 6d64 6e73 2c20 3132 3030 303a 7061  3:mdns, 12000:pa
+00002fb0: 7373 6976 652d 6674 7029 0a0a 0a23 2320  ssive-ftp)...## 
+00002fc0: 6665 6174 7572 6573 0a0a 2a20 6261 636b  features..* back
+00002fd0: 656e 6420 7374 7566 660a 2020 2a20 e298  end stuff.  * ..
+00002fe0: 9120 4950 7636 0a20 202a 20e2 9891 205b  . IPv6.  * ... [
+00002ff0: 6d75 6c74 6970 726f 6365 7373 696e 675d  multiprocessing]
+00003000: 2823 7065 7266 6f72 6d61 6e63 6529 2028  (#performance) (
+00003010: 6163 7475 616c 206d 756c 7469 7468 7265  actual multithre
+00003020: 6164 696e 6729 0a20 202a 20e2 9891 2076  ading).  * ... v
+00003030: 6f6c 756d 6573 2028 6d6f 756e 7470 6f69  olumes (mountpoi
+00003040: 6e74 7329 0a20 202a 20e2 9891 205b 6163  nts).  * ... [ac
+00003050: 636f 756e 7473 5d28 2361 6363 6f75 6e74  counts](#account
+00003060: 732d 616e 642d 766f 6c75 6d65 7329 0a20  s-and-volumes). 
+00003070: 202a 20e2 9891 205b 6674 7020 7365 7276   * ... [ftp serv
+00003080: 6572 5d28 2366 7470 2d73 6572 7665 7229  er](#ftp-server)
+00003090: 0a20 202a 20e2 9891 205b 7765 6264 6176  .  * ... [webdav
+000030a0: 2073 6572 7665 725d 2823 7765 6264 6176   server](#webdav
+000030b0: 2d73 6572 7665 7229 0a20 202a 20e2 9891  -server).  * ...
+000030c0: 205b 736d 622f 6369 6673 2073 6572 7665   [smb/cifs serve
+000030d0: 725d 2823 736d 622d 7365 7276 6572 290a  r](#smb-server).
+000030e0: 2020 2a20 e298 9120 5b71 722d 636f 6465    * ... [qr-code
+000030f0: 5d28 2371 722d 636f 6465 2920 666f 7220  ](#qr-code) for 
+00003100: 7175 6963 6b20 6163 6365 7373 0a20 202a  quick access.  *
+00003110: 20e2 9891 205b 7570 6e70 202f 207a 6572   ... [upnp / zer
+00003120: 6f63 6f6e 6620 2f20 6d64 6e73 202f 2073  oconf / mdns / s
+00003130: 7364 705d 2823 7a65 726f 636f 6e66 290a  sdp](#zeroconf).
+00003140: 2020 2a20 e298 9120 5b65 7665 6e74 2068    * ... [event h
+00003150: 6f6f 6b73 5d28 2365 7665 6e74 2d68 6f6f  ooks](#event-hoo
+00003160: 6b73 2920 2f20 7363 7269 7074 2072 756e  ks) / script run
+00003170: 6e65 720a 2020 2a20 e298 9120 5b72 6576  ner.  * ... [rev
+00003180: 6572 7365 2d70 726f 7879 2073 7570 706f  erse-proxy suppo
+00003190: 7274 5d28 6874 7470 733a 2f2f 6769 7468  rt](https://gith
+000031a0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
+000031b0: 7061 7274 7923 7265 7665 7273 652d 7072  party#reverse-pr
+000031c0: 6f78 7929 0a2a 2075 706c 6f61 640a 2020  oxy).* upload.  
+000031d0: 2a20 e298 9120 6261 7369 633a 2070 6c61  * ... basic: pla
+000031e0: 696e 206d 756c 7469 7061 7274 2c20 6965  in multipart, ie
+000031f0: 3620 7375 7070 6f72 740a 2020 2a20 e298  6 support.  * ..
+00003200: 9120 5b75 7032 6b5d 2823 7570 6c6f 6164  . [up2k](#upload
+00003210: 696e 6729 3a20 6a73 2c20 7265 7375 6d61  ing): js, resuma
+00003220: 626c 652c 206d 756c 7469 7468 7265 6164  ble, multithread
+00003230: 6564 0a20 2020 202a 2075 6e61 6666 6563  ed.    * unaffec
+00003240: 7465 6420 6279 2063 6c6f 7564 666c 6172  ted by cloudflar
+00003250: 6527 7320 6d61 782d 7570 6c6f 6164 2d73  e's max-upload-s
+00003260: 697a 6520 2831 3030 204d 6942 290a 2020  ize (100 MiB).  
+00003270: 2a20 e298 9120 7374 6173 683a 2073 696d  * ... stash: sim
+00003280: 706c 6520 5055 5420 6669 6c65 6472 6f70  ple PUT filedrop
+00003290: 7065 720a 2020 2a20 e298 9120 6669 6c65  per.  * ... file
+000032a0: 6e61 6d65 2072 616e 646f 6d69 7a65 720a  name randomizer.
+000032b0: 2020 2a20 e298 9120 7772 6974 652d 6f6e    * ... write-on
+000032c0: 6c79 2066 6f6c 6465 7273 0a20 202a 20e2  ly folders.  * .
+000032d0: 9891 205b 756e 706f 7374 5d28 2375 6e70  .. [unpost](#unp
+000032e0: 6f73 7429 3a20 756e 646f 2f64 656c 6574  ost): undo/delet
+000032f0: 6520 6163 6369 6465 6e74 616c 2075 706c  e accidental upl
+00003300: 6f61 6473 0a20 202a 20e2 9891 205b 7365  oads.  * ... [se
+00003310: 6c66 2d64 6573 7472 7563 745d 2823 7365  lf-destruct](#se
+00003320: 6c66 2d64 6573 7472 7563 7429 2028 7370  lf-destruct) (sp
+00003330: 6563 6966 6965 6420 7365 7276 6572 2d73  ecified server-s
+00003340: 6964 6520 6f72 2063 6c69 656e 742d 7369  ide or client-si
+00003350: 6465 290a 2020 2a20 e298 9120 7379 6d6c  de).  * ... syml
+00003360: 696e 6b2f 6469 7363 6172 6420 6475 706c  ink/discard dupl
+00003370: 6963 6174 6573 2028 636f 6e74 656e 742d  icates (content-
+00003380: 6d61 7463 6869 6e67 290a 2a20 646f 776e  matching).* down
+00003390: 6c6f 6164 0a20 202a 20e2 9891 2073 696e  load.  * ... sin
+000033a0: 676c 6520 6669 6c65 7320 696e 2062 726f  gle files in bro
+000033b0: 7773 6572 0a20 202a 20e2 9891 205b 666f  wser.  * ... [fo
+000033c0: 6c64 6572 7320 6173 207a 6970 202f 2074  lders as zip / t
+000033d0: 6172 2066 696c 6573 5d28 237a 6970 2d64  ar files](#zip-d
+000033e0: 6f77 6e6c 6f61 6473 290a 2020 2a20 e298  ownloads).  * ..
+000033f0: 9120 5b46 5553 4520 636c 6965 6e74 5d28  . [FUSE client](
+00003400: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00003410: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00003420: 792f 7472 6565 2f68 6f76 7564 7374 7261  y/tree/hovudstra
+00003430: 756d 2f62 696e 2370 6172 7479 6675 7365  um/bin#partyfuse
+00003440: 7079 2920 2872 6561 642d 6f6e 6c79 290a  py) (read-only).
+00003450: 2a20 6272 6f77 7365 720a 2020 2a20 e298  * browser.  * ..
+00003460: 9120 5b6e 6176 7061 6e65 5d28 236e 6176  . [navpane](#nav
+00003470: 7061 6e65 2920 2864 6972 6563 746f 7279  pane) (directory
+00003480: 2074 7265 6520 7369 6465 6261 7229 0a20   tree sidebar). 
+00003490: 202a 20e2 9891 2066 696c 6520 6d61 6e61   * ... file mana
+000034a0: 6765 7220 2863 7574 2f70 6173 7465 2c20  ger (cut/paste, 
+000034b0: 6465 6c65 7465 2c20 5b62 6174 6368 2d72  delete, [batch-r
+000034c0: 656e 616d 655d 2823 6261 7463 682d 7265  ename](#batch-re
+000034d0: 6e61 6d65 2929 0a20 202a 20e2 9891 2061  name)).  * ... a
+000034e0: 7564 696f 2070 6c61 7965 7220 2877 6974  udio player (wit
+000034f0: 6820 5b4f 5320 6d65 6469 6120 636f 6e74  h [OS media cont
+00003500: 726f 6c73 5d28 6874 7470 733a 2f2f 7573  rols](https://us
+00003510: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00003520: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00003530: 3234 3130 3332 2f32 3135 3334 3734 3932  241032/215347492
+00003540: 2d62 3432 3530 3739 372d 3663 3930 2d34  -b4250797-6c90-4
+00003550: 6530 392d 3961 3463 2d37 3231 6564 6632  e09-9a4c-721edf2
+00003560: 6662 3135 632e 706e 6729 2061 6e64 206f  fb15c.png) and o
+00003570: 7075 7320 7472 616e 7363 6f64 696e 6729  pus transcoding)
+00003580: 0a20 202a 20e2 9891 2069 6d61 6765 2067  .  * ... image g
+00003590: 616c 6c65 7279 2077 6974 6820 7765 626d  allery with webm
+000035a0: 2070 6c61 7965 720a 2020 2a20 e298 9120   player.  * ... 
+000035b0: 7465 7874 6669 6c65 2062 726f 7773 6572  textfile browser
+000035c0: 2077 6974 6820 7379 6e74 6178 2068 696c   with syntax hil
+000035d0: 6967 6874 696e 670a 2020 2a20 e298 9120  ighting.  * ... 
+000035e0: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+000035f0: 756d 626e 6169 6c73 290a 2020 2020 2a20  umbnails).    * 
+00003600: e298 9120 2e2e 2e6f 6620 696d 6167 6573  ... ...of images
+00003610: 2075 7369 6e67 2050 696c 6c6f 772c 2070   using Pillow, p
+00003620: 7976 6970 732c 206f 7220 4646 6d70 6567  yvips, or FFmpeg
+00003630: 0a20 2020 202a 20e2 9891 202e 2e2e 6f66  .    * ... ...of
+00003640: 2076 6964 656f 7320 7573 696e 6720 4646   videos using FF
+00003650: 6d70 6567 0a20 2020 202a 20e2 9891 202e  mpeg.    * ... .
+00003660: 2e2e 6f66 2061 7564 696f 2028 7370 6563  ..of audio (spec
+00003670: 7472 6f67 7261 6d73 2920 7573 696e 6720  trograms) using 
+00003680: 4646 6d70 6567 0a20 2020 202a 20e2 9891  FFmpeg.    * ...
+00003690: 2063 6163 6865 2065 7669 6374 696f 6e20   cache eviction 
+000036a0: 286d 6178 2d61 6765 3b20 6d61 7962 6520  (max-age; maybe 
+000036b0: 6d61 782d 7369 7a65 2065 7665 6e74 7561  max-size eventua
+000036c0: 6c6c 7929 0a20 202a 20e2 9891 2053 5041  lly).  * ... SPA
+000036d0: 2028 6272 6f77 7365 2077 6869 6c65 2075   (browse while u
+000036e0: 706c 6f61 6469 6e67 290a 2a20 7365 7276  ploading).* serv
+000036f0: 6572 2069 6e64 6578 696e 670a 2020 2a20  er indexing.  * 
+00003700: e298 9120 5b6c 6f63 6174 6520 6669 6c65  ... [locate file
+00003710: 7320 6279 2063 6f6e 7465 6e74 735d 2823  s by contents](#
+00003720: 6669 6c65 2d73 6561 7263 6829 0a20 202a  file-search).  *
+00003730: 20e2 9891 2073 6561 7263 6820 6279 206e   ... search by n
+00003740: 616d 652f 7061 7468 2f64 6174 652f 7369  ame/path/date/si
+00003750: 7a65 0a20 202a 20e2 9891 205b 7365 6172  ze.  * ... [sear
+00003760: 6368 2062 7920 4944 332d 7461 6773 2065  ch by ID3-tags e
+00003770: 7463 2e5d 2823 7365 6172 6368 696e 6729  tc.](#searching)
+00003780: 0a2a 2063 6c69 656e 7420 7375 7070 6f72  .* client suppor
+00003790: 740a 2020 2a20 e298 9120 5b66 6f6c 6465  t.  * ... [folde
+000037a0: 7220 7379 6e63 5d28 2366 6f6c 6465 722d  r sync](#folder-
+000037b0: 7379 6e63 290a 2020 2a20 e298 9120 5b63  sync).  * ... [c
+000037c0: 7572 6c2d 6672 6965 6e64 6c79 5d28 6874  url-friendly](ht
+000037d0: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+000037e0: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+000037f0: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
+00003800: 3135 3332 3236 3139 2d65 6135 6664 3630  15322619-ea5fd60
+00003810: 362d 3336 3534 2d34 3061 642d 3934 6565  6-3654-40ad-94ee
+00003820: 2d32 6263 3035 3836 3437 6262 322e 706e  -2bc058647bb2.pn
+00003830: 6729 0a2a 206d 6172 6b64 6f77 6e0a 2020  g).* markdown.  
+00003840: 2a20 e298 9120 5b76 6965 7765 725d 2823  * ... [viewer](#
+00003850: 6d61 726b 646f 776e 2d76 6965 7765 7229  markdown-viewer)
+00003860: 0a20 202a 20e2 9891 2065 6469 746f 7220  .  * ... editor 
+00003870: 2873 7572 6520 7768 7920 6e6f 7429 0a0a  (sure why not)..
+00003880: 5053 3a20 736f 6d65 7468 696e 6720 6d69  PS: something mi
+00003890: 7373 696e 673f 2070 6f73 7420 616e 7920  ssing? post any 
+000038a0: 6372 617a 7920 6964 6561 7320 796f 7527  crazy ideas you'
+000038b0: 7665 2067 6f74 2061 7320 6120 5b66 6561  ve got as a [fea
+000038c0: 7475 7265 2072 6571 7565 7374 5d28 6874  ture request](ht
+000038d0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+000038e0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
+000038f0: 6973 7375 6573 2f6e 6577 3f61 7373 6967  issues/new?assig
+00003900: 6e65 6573 3d39 3030 3126 6c61 6265 6c73  nees=9001&labels
+00003910: 3d65 6e68 616e 6365 6d65 6e74 2674 656d  =enhancement&tem
+00003920: 706c 6174 653d 6665 6174 7572 655f 7265  plate=feature_re
+00003930: 7175 6573 742e 6d64 2920 6f72 205b 6469  quest.md) or [di
+00003940: 7363 7573 7369 6f6e 5d28 6874 7470 733a  scussion](https:
+00003950: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+00003960: 312f 636f 7079 7061 7274 792f 6469 7363  1/copyparty/disc
+00003970: 7573 7369 6f6e 732f 6e65 773f 6361 7465  ussions/new?cate
+00003980: 676f 7279 3d69 6465 6173 2920 f09f a499  gory=ideas) ....
+00003990: 0a0a 0a23 2320 7465 7374 696d 6f6e 6961  ...## testimonia
+000039a0: 6c73 0a0a 736d 616c 6c20 636f 6c6c 6563  ls..small collec
+000039b0: 7469 6f6e 206f 6620 7573 6572 2066 6565  tion of user fee
+000039c0: 6462 6163 6b0a 0a60 676f 6f64 2065 6e6f  dback..`good eno
+000039d0: 7567 6860 2c20 6073 7572 7072 6973 696e  ugh`, `surprisin
+000039e0: 676c 7920 636f 7272 6563 7460 2c20 6063  gly correct`, `c
+000039f0: 6572 7469 6669 6564 2067 6f6f 6420 736f  ertified good so
+00003a00: 6674 7761 7265 602c 2060 6a75 7374 2077  ftware`, `just w
+00003a10: 6f72 6b73 602c 2060 7768 7960 2c20 6077  orks`, `why`, `w
+00003a20: 6f77 2074 6869 7320 6973 2062 6574 7465  ow this is bette
+00003a30: 7220 7468 616e 206e 6578 7463 6c6f 7564  r than nextcloud
+00003a40: 600a 0a0a 2320 6d6f 7469 7661 7469 6f6e  `...# motivation
+00003a50: 730a 0a70 726f 6a65 6374 2067 6f61 6c73  s..project goals
+00003a60: 202f 2070 6869 6c6f 736f 7068 790a 0a2a   / philosophy..*
+00003a70: 2069 6e76 6572 7365 206c 696e 7578 2070   inverse linux p
+00003a80: 6869 6c6f 736f 7068 7920 2d2d 2064 6f20  hilosophy -- do 
+00003a90: 616c 6c20 7468 6520 7468 696e 6773 2c20  all the things, 
+00003aa0: 616e 6420 646f 2061 6e20 2a6f 6b61 792a  and do an *okay*
+00003ab0: 206a 6f62 0a20 202a 2071 7569 636b 2064   job.  * quick d
+00003ac0: 726f 702d 696e 2073 6572 7669 6365 2074  rop-in service t
+00003ad0: 6f20 6765 7420 6120 6c6f 7420 6f66 2066  o get a lot of f
+00003ae0: 6561 7475 7265 7320 696e 2061 2070 696e  eatures in a pin
+00003af0: 6368 0a20 202a 2073 6f6d 6520 6f66 205b  ch.  * some of [
+00003b00: 7468 6520 616c 7465 726e 6174 6976 6573  the alternatives
+00003b10: 5d28 2e2f 646f 6373 2f76 6572 7375 732e  ](./docs/versus.
+00003b20: 6d64 2920 6d69 6768 7420 6265 2061 2062  md) might be a b
+00003b30: 6574 7465 7220 6669 7420 666f 7220 796f  etter fit for yo
+00003b40: 750a 2a20 7275 6e20 616e 7977 6865 7265  u.* run anywhere
+00003b50: 2c20 7375 7070 6f72 7420 6576 6572 7974  , support everyt
+00003b60: 6869 6e67 0a20 202a 2061 7320 6d61 6e79  hing.  * as many
+00003b70: 2077 6562 2d62 726f 7773 6572 7320 616e   web-browsers an
+00003b80: 6420 7079 7468 6f6e 2076 6572 7369 6f6e  d python version
+00003b90: 7320 6173 2070 6f73 7369 626c 650a 2020  s as possible.  
+00003ba0: 2020 2a20 6576 6572 7920 6272 6f77 7365    * every browse
+00003bb0: 7220 7368 6f75 6c64 2061 7420 6c65 6173  r should at leas
+00003bc0: 7420 6265 2061 626c 6520 746f 2062 726f  t be able to bro
+00003bd0: 7773 652c 2064 6f77 6e6c 6f61 642c 2075  wse, download, u
+00003be0: 706c 6f61 6420 6669 6c65 730a 2020 2020  pload files.    
+00003bf0: 2a20 6265 2061 2067 6f6f 6420 656d 6572  * be a good emer
+00003c00: 6765 6e63 7920 736f 6c75 7469 6f6e 2066  gency solution f
+00003c10: 6f72 2074 7261 6e73 6665 7272 696e 6720  or transferring 
+00003c20: 7374 7566 6620 6265 7477 6565 6e20 616e  stuff between an
+00003c30: 6369 656e 7420 626f 7865 730a 2020 2a20  cient boxes.  * 
+00003c40: 6d69 6e69 6d61 6c20 6465 7065 6e64 656e  minimal dependen
+00003c50: 6369 6573 0a20 2020 202a 2062 7574 206f  cies.    * but o
+00003c60: 7074 696f 6e61 6c20 6465 7065 6e64 656e  ptional dependen
+00003c70: 6369 6573 2061 6464 696e 6720 626f 6e75  cies adding bonu
+00003c80: 732d 6665 6174 7572 6573 2061 7265 206f  s-features are o
+00003c90: 6b0a 2020 2020 2a20 6576 6572 7974 6869  k.    * everythi
+00003ca0: 6e67 2062 6569 6e67 2070 6c61 696e 7465  ng being plainte
+00003cb0: 7874 206d 616b 6573 2069 7420 706f 7373  xt makes it poss
+00003cc0: 6962 6c65 2074 6f20 7072 6f6f 6672 6561  ible to proofrea
+00003cd0: 6420 666f 7220 6d61 6c69 6369 6f75 7320  d for malicious 
+00003ce0: 636f 6465 0a20 202a 206e 6f20 7072 6570  code.  * no prep
+00003cf0: 6172 6174 696f 6e73 202f 2073 6574 7570  arations / setup
+00003d00: 206e 6563 6573 7361 7279 2c20 6a75 7374   necessary, just
+00003d10: 2072 756e 2074 6865 2073 6678 2028 7768   run the sfx (wh
+00003d20: 6963 6820 6973 2061 6c73 6f20 706c 6169  ich is also plai
+00003d30: 6e74 6578 7429 0a2a 2061 6461 7074 6162  ntext).* adaptab
+00003d40: 6c65 2c20 6d61 6c6c 6561 626c 652c 2068  le, malleable, h
+00003d50: 6163 6b61 626c 650a 2020 2a20 6e6f 2062  ackable.  * no b
+00003d60: 7569 6c64 2073 7465 7073 3b20 6d6f 6469  uild steps; modi
+00003d70: 6679 2074 6865 206a 732f 7079 7468 6f6e  fy the js/python
+00003d80: 2077 6974 686f 7574 206e 6565 6469 6e67   without needing
+00003d90: 206e 6f64 652e 6a73 206f 7220 616e 7974   node.js or anyt
+00003da0: 6869 6e67 206c 696b 6520 7468 6174 0a0a  hing like that..
+00003db0: 0a23 2320 6e6f 7465 730a 0a67 656e 6572  .## notes..gener
+00003dc0: 616c 206e 6f74 6573 3a0a 2a20 7061 7065  al notes:.* pape
+00003dd0: 722d 7072 696e 7469 6e67 2069 7320 6166  r-printing is af
+00003de0: 6665 6374 6564 2062 7920 6461 726b 2f6c  fected by dark/l
+00003df0: 6967 6874 2d6d 6f64 6521 2075 7365 206c  ight-mode! use l
+00003e00: 6967 6874 6d6f 6465 2066 6f72 2063 6f6c  ightmode for col
+00003e10: 6f72 2c20 6461 726b 6d6f 6465 2066 6f72  or, darkmode for
+00003e20: 2067 7261 7973 6361 6c65 0a20 202a 2062   grayscale.  * b
+00003e30: 6563 6175 7365 206e 6f20 6272 6f77 7365  ecause no browse
+00003e40: 7273 2063 7572 7265 6e74 6c79 2069 6d70  rs currently imp
+00003e50: 6c65 6d65 6e74 2074 6865 206d 6564 6961  lement the media
+00003e60: 2d71 7565 7279 2074 6f20 646f 2074 6869  -query to do thi
+00003e70: 7320 7072 6f70 6572 6c79 206f 727a 0a0a  s properly orz..
+00003e80: 6272 6f77 7365 722d 7370 6563 6966 6963  browser-specific
+00003e90: 3a0a 2a20 6950 686f 6e65 2f69 5061 643a  :.* iPhone/iPad:
+00003ea0: 2075 7365 2046 6972 6566 6f78 2074 6f20   use Firefox to 
+00003eb0: 646f 776e 6c6f 6164 2066 696c 6573 0a2a  download files.*
+00003ec0: 2041 6e64 726f 6964 2d43 6872 6f6d 653a   Android-Chrome:
+00003ed0: 2069 6e63 7265 6173 6520 2270 6172 616c   increase "paral
+00003ee0: 6c65 6c20 7570 6c6f 6164 7322 2066 6f72  lel uploads" for
+00003ef0: 2068 6967 6865 7220 7370 6565 6420 2861   higher speed (a
+00003f00: 6e64 726f 6964 2062 7567 290a 2a20 416e  ndroid bug).* An
+00003f10: 6472 6f69 642d 4669 7265 666f 783a 2074  droid-Firefox: t
+00003f20: 616b 6573 2061 2077 6869 6c65 2074 6f20  akes a while to 
+00003f30: 7365 6c65 6374 2066 696c 6573 2028 7468  select files (th
+00003f40: 6569 7220 6669 7820 666f 7220 e298 9def  eir fix for ....
+00003f50: b88f 290a 2a20 4465 736b 746f 702d 4669  ..).* Desktop-Fi
+00003f60: 7265 666f 783a 207e 7e6d 6179 2075 7365  refox: ~~may use
+00003f70: 2067 6967 6162 7974 6573 206f 6620 5241   gigabytes of RA
+00003f80: 4d20 6966 2079 6f75 7220 6669 6c65 7320  M if your files 
+00003f90: 6172 6520 6d61 7373 6976 657e 7e20 2a73  are massive~~ *s
+00003fa0: 6565 6d73 2074 6f20 6265 204f 4b20 6e6f  eems to be OK no
+00003fb0: 772a 0a2a 2044 6573 6b74 6f70 2d46 6972  w*.* Desktop-Fir
+00003fc0: 6566 6f78 3a20 5b6d 6179 2073 746f 7020  efox: [may stop 
+00003fd0: 796f 7520 6672 6f6d 2075 6e70 6c75 6767  you from unplugg
+00003fe0: 696e 6720 5553 4220 666c 6173 6864 7269  ing USB flashdri
+00003ff0: 7665 735d 2868 7474 7073 3a2f 2f62 7567  ves](https://bug
+00004000: 7a69 6c6c 612e 6d6f 7a69 6c6c 612e 6f72  zilla.mozilla.or
+00004010: 672f 7368 6f77 5f62 7567 2e63 6769 3f69  g/show_bug.cgi?i
+00004020: 643d 3137 3932 3539 3829 2075 6e74 696c  d=1792598) until
+00004030: 2079 6f75 2076 6973 6974 2060 6162 6f75   you visit `abou
+00004040: 743a 6d65 6d6f 7279 6020 616e 6420 636c  t:memory` and cl
+00004050: 6963 6b20 604d 696e 696d 697a 6520 6d65  ick `Minimize me
+00004060: 6d6f 7279 2075 7361 6765 600a 0a73 6572  mory usage`..ser
+00004070: 7665 722d 6f73 2d73 7065 6369 6669 633a  ver-os-specific:
+00004080: 0a2a 2052 4845 4c38 202f 2052 6f63 6b79  .* RHEL8 / Rocky
+00004090: 383a 2079 6f75 2063 616e 2072 756e 2063  8: you can run c
+000040a0: 6f70 7970 6172 7479 2075 7369 6e67 2060  opyparty using `
+000040b0: 2f75 7372 2f6c 6962 6578 6563 2f70 6c61  /usr/libexec/pla
+000040c0: 7466 6f72 6d2d 7079 7468 6f6e 600a 0a73  tform-python`..s
+000040d0: 6572 7665 7220 6e6f 7465 733a 0a2a 2070  erver notes:.* p
+000040e0: 7970 7920 6973 2073 7570 706f 7274 6564  ypy is supported
+000040f0: 2062 7574 2072 6567 756c 6172 2063 7079   but regular cpy
+00004100: 7468 6f6e 2069 7320 6661 7374 6572 2069  thon is faster i
+00004110: 6620 796f 7520 656e 6162 6c65 2074 6865  f you enable the
+00004120: 2064 6174 6162 6173 650a 0a0a 2320 6275   database...# bu
+00004130: 6773 0a0a 2a20 5769 6e64 6f77 733a 2070  gs..* Windows: p
+00004140: 7974 686f 6e20 322e 3720 6361 6e6e 6f74  ython 2.7 cannot
+00004150: 2069 6e64 6578 206e 6f6e 2d61 7363 6969   index non-ascii
+00004160: 2066 696c 656e 616d 6573 2077 6974 6820   filenames with 
+00004170: 602d 6532 6460 0a2a 2057 696e 646f 7773  `-e2d`.* Windows
+00004180: 3a20 7079 7468 6f6e 2032 2e37 2063 616e  : python 2.7 can
+00004190: 6e6f 7420 6861 6e64 6c65 2066 696c 656e  not handle filen
+000041a0: 616d 6573 2077 6974 6820 6d6f 6a69 6261  ames with mojiba
+000041b0: 6b65 0a2a 2060 2d2d 7468 2d66 662d 6a70  ke.* `--th-ff-jp
+000041c0: 6760 206d 6179 2066 6978 2076 6964 656f  g` may fix video
+000041d0: 2074 6875 6d62 6e61 696c 7320 6f6e 2073   thumbnails on s
+000041e0: 6f6d 6520 4646 6d70 6567 2076 6572 7369  ome FFmpeg versi
+000041f0: 6f6e 7320 286d 6163 6f73 2c20 736f 6d65  ons (macos, some
+00004200: 206c 696e 7578 290a 2a20 602d 2d74 682d   linux).* `--th-
+00004210: 6666 2d73 7772 6020 6d61 7920 6669 7820  ff-swr` may fix 
+00004220: 6175 6469 6f20 7468 756d 626e 6169 6c73  audio thumbnails
+00004230: 206f 6e20 736f 6d65 2046 466d 7065 6720   on some FFmpeg 
+00004240: 7665 7273 696f 6e73 0a0a 2323 2067 656e  versions..## gen
+00004250: 6572 616c 2062 7567 730a 0a2a 2057 696e  eral bugs..* Win
+00004260: 646f 7773 3a20 6966 2074 6865 2060 7570  dows: if the `up
+00004270: 326b 2e64 6260 2028 6669 6c65 7379 7374  2k.db` (filesyst
+00004280: 656d 2069 6e64 6578 2920 6973 206f 6e20  em index) is on 
+00004290: 6120 7361 6d62 612d 7368 6172 6520 6f72  a samba-share or
+000042a0: 206e 6574 776f 726b 2064 6973 6b2c 2079   network disk, y
+000042b0: 6f75 276c 6c20 6765 7420 756e 7072 6564  ou'll get unpred
+000042c0: 6963 7461 626c 6520 6265 6861 7669 6f72  ictable behavior
+000042d0: 2069 6620 7468 6520 7368 6172 6520 6973   if the share is
+000042e0: 2064 6973 636f 6e6e 6563 7465 6420 666f   disconnected fo
+000042f0: 7220 6120 6269 740a 2020 2a20 7573 6520  r a bit.  * use 
+00004300: 602d 2d68 6973 7460 206f 7220 7468 6520  `--hist` or the 
+00004310: 6068 6973 7460 2076 6f6c 666c 6167 2028  `hist` volflag (
+00004320: 602d 7620 5b2e 2e2e 5d3a 632c 6869 7374  `-v [...]:c,hist
+00004330: 3d2f 746d 702f 666f 6f60 2920 746f 2070  =/tmp/foo`) to p
+00004340: 6c61 6365 2074 6865 2064 6220 6f6e 2061  lace the db on a
+00004350: 206c 6f63 616c 2064 6973 6b20 696e 7374   local disk inst
+00004360: 6561 640a 2a20 616c 6c20 766f 6c75 6d65  ead.* all volume
+00004370: 7320 6d75 7374 2065 7869 7374 202f 2062  s must exist / b
+00004380: 6520 6176 6169 6c61 626c 6520 6f6e 2073  e available on s
+00004390: 7461 7274 7570 3b20 7570 326b 2028 6d74  tartup; up2k (mt
+000043a0: 7020 6573 7065 6369 616c 6c79 2920 6765  p especially) ge
+000043b0: 7473 2066 756e 6b79 206f 7468 6572 7769  ts funky otherwi
+000043c0: 7365 0a2a 2070 726f 6261 626c 7920 6d6f  se.* probably mo
+000043d0: 7265 2c20 706c 7320 6c65 7420 6d65 206b  re, pls let me k
+000043e0: 6e6f 770a 0a23 2320 6e6f 7420 6d79 2062  now..## not my b
+000043f0: 7567 730a 0a2a 205b 4368 726f 6d65 2069  ugs..* [Chrome i
+00004400: 7373 7565 2031 3331 3730 3639 5d28 6874  ssue 1317069](ht
+00004410: 7470 733a 2f2f 6275 6773 2e63 6872 6f6d  tps://bugs.chrom
+00004420: 6975 6d2e 6f72 672f 702f 6368 726f 6d69  ium.org/p/chromi
+00004430: 756d 2f69 7373 7565 732f 6465 7461 696c  um/issues/detail
+00004440: 3f69 643d 3133 3137 3036 3929 202d 2d20  ?id=1317069) -- 
+00004450: 6966 2079 6f75 2074 7279 2074 6f20 7570  if you try to up
+00004460: 6c6f 6164 2061 2066 6f6c 6465 7220 7768  load a folder wh
+00004470: 6963 6820 636f 6e74 6169 6e73 2073 796d  ich contains sym
+00004480: 6c69 6e6b 7320 6279 2064 7261 6767 696e  links by draggin
+00004490: 6720 6974 2069 6e74 6f20 7468 6520 6272  g it into the br
+000044a0: 6f77 7365 722c 2074 6865 2073 796d 6c69  owser, the symli
+000044b0: 6e6b 6564 2066 696c 6573 2077 696c 6c20  nked files will 
+000044c0: 6e6f 7420 6765 7420 7570 6c6f 6164 6564  not get uploaded
+000044d0: 0a0a 2a20 5b43 6872 6f6d 6520 6973 7375  ..* [Chrome issu
+000044e0: 6520 3133 3532 3231 305d 2868 7474 7073  e 1352210](https
+000044f0: 3a2f 2f62 7567 732e 6368 726f 6d69 756d  ://bugs.chromium
+00004500: 2e6f 7267 2f70 2f63 6872 6f6d 6975 6d2f  .org/p/chromium/
+00004510: 6973 7375 6573 2f64 6574 6169 6c3f 6964  issues/detail?id
+00004520: 3d31 3335 3232 3130 2920 2d2d 2070 6c61  =1352210) -- pla
+00004530: 696e 7465 7874 2068 7474 7020 6d61 7920  intext http may 
+00004540: 6265 2066 6173 7465 7220 6174 2066 696c  be faster at fil
+00004550: 6568 6173 6869 6e67 2074 6861 6e20 6874  ehashing than ht
+00004560: 7470 7320 2862 7574 2061 6c73 6f20 6578  tps (but also ex
+00004570: 7472 656d 656c 7920 4350 552d 696e 7465  tremely CPU-inte
+00004580: 6e73 6976 6529 0a0a 2a20 5b46 6972 6566  nsive)..* [Firef
+00004590: 6f78 2069 7373 7565 2031 3739 3035 3030  ox issue 1790500
+000045a0: 5d28 6874 7470 733a 2f2f 6275 677a 696c  ](https://bugzil
+000045b0: 6c61 2e6d 6f7a 696c 6c61 2e6f 7267 2f73  la.mozilla.org/s
+000045c0: 686f 775f 6275 672e 6367 693f 6964 3d31  how_bug.cgi?id=1
+000045d0: 3739 3035 3030 2920 2d2d 2065 6e74 6972  790500) -- entir
+000045e0: 6520 6272 6f77 7365 7220 6361 6e20 6372  e browser can cr
+000045f0: 6173 6820 6166 7465 7220 7570 6c6f 6164  ash after upload
+00004600: 696e 6720 7e34 3030 3020 736d 616c 6c20  ing ~4000 small 
+00004610: 6669 6c65 730a 0a2a 2041 6e64 726f 6964  files..* Android
+00004620: 3a20 6d75 7369 6320 706c 6179 6261 636b  : music playback
+00004630: 2072 616e 646f 6d6c 7920 7374 6f70 7320   randomly stops 
+00004640: 6475 6520 746f 205b 6261 7474 6572 7920  due to [battery 
+00004650: 7573 6167 6520 7365 7474 696e 6773 5d28  usage settings](
+00004660: 2366 6978 2d75 6e72 656c 6961 626c 652d  #fix-unreliable-
+00004670: 706c 6179 6261 636b 2d6f 6e2d 616e 6472  playback-on-andr
+00004680: 6f69 6429 0a0a 2a20 6950 686f 6e65 733a  oid)..* iPhones:
+00004690: 2074 6865 2076 6f6c 756d 6520 636f 6e74   the volume cont
+000046a0: 726f 6c20 646f 6573 6e27 7420 776f 726b  rol doesn't work
+000046b0: 2062 6563 6175 7365 205b 6170 706c 6520   because [apple 
+000046c0: 646f 6573 6e27 7420 7761 6e74 2069 7420  doesn't want it 
+000046d0: 746f 5d28 6874 7470 733a 2f2f 6465 7665  to](https://deve
+000046e0: 6c6f 7065 722e 6170 706c 652e 636f 6d2f  loper.apple.com/
+000046f0: 6c69 6272 6172 792f 6172 6368 6976 652f  library/archive/
+00004700: 646f 6375 6d65 6e74 6174 696f 6e2f 4175  documentation/Au
+00004710: 6469 6f56 6964 656f 2f43 6f6e 6365 7074  dioVideo/Concept
+00004720: 7561 6c2f 5573 696e 675f 4854 4d4c 355f  ual/Using_HTML5_
+00004730: 4175 6469 6f5f 5669 6465 6f2f 4465 7669  Audio_Video/Devi
+00004740: 6365 2d53 7065 6369 6669 6343 6f6e 7369  ce-SpecificConsi
+00004750: 6465 7261 7469 6f6e 732f 4465 7669 6365  derations/Device
+00004760: 2d53 7065 6369 6669 6343 6f6e 7369 6465  -SpecificConside
+00004770: 7261 7469 6f6e 732e 6874 6d6c 232f 2f61  rations.html#//a
+00004780: 7070 6c65 5f72 6566 2f64 6f63 2f75 6964  pple_ref/doc/uid
+00004790: 2f54 5034 3030 3039 3532 332d 4348 352d  /TP40009523-CH5-
+000047a0: 5357 3131 290a 2020 2a20 2a66 7574 7572  SW11).  * *futur
+000047b0: 6520 776f 726b 6172 6f75 6e64 3a2a 2065  e workaround:* e
+000047c0: 6e61 626c 6520 7468 6520 6571 7561 6c69  nable the equali
+000047d0: 7a65 722c 206d 616b 6520 6974 2061 6c6c  zer, make it all
+000047e0: 2d7a 6572 6f2c 2061 6e64 2073 6574 2061  -zero, and set a
+000047f0: 206e 6567 6174 6976 6520 626f 6f73 7420   negative boost 
+00004800: 746f 2072 6564 7563 6520 7468 6520 766f  to reduce the vo
+00004810: 6c75 6d65 0a20 2020 202a 2022 6675 7475  lume.    * "futu
+00004820: 7265 2220 6265 6361 7573 6520 6041 7564  re" because `Aud
+00004830: 696f 436f 6e74 6578 7460 2063 616e 2774  ioContext` can't
+00004840: 206d 6169 6e74 6169 6e20 6120 7374 6162   maintain a stab
+00004850: 6c65 2070 6c61 7962 6163 6b20 7370 6565  le playback spee
+00004860: 6420 696e 2074 6865 2063 7572 7265 6e74  d in the current
+00004870: 2069 4f53 2076 6572 7369 6f6e 2028 3135   iOS version (15
+00004880: 2e37 292c 206d 6179 6265 206f 6e65 2064  .7), maybe one d
+00004890: 6179 2e2e 2e0a 0a2a 2057 696e 646f 7773  ay.....* Windows
+000048a0: 3a20 666f 6c64 6572 7320 6361 6e6e 6f74  : folders cannot
+000048b0: 2062 6520 6163 6365 7373 6564 2069 6620   be accessed if 
+000048c0: 7468 6520 6e61 6d65 2065 6e64 7320 7769  the name ends wi
+000048d0: 7468 2060 2e60 0a20 202a 2070 7974 686f  th `.`.  * pytho
+000048e0: 6e20 6f72 2077 696e 646f 7773 2062 7567  n or windows bug
+000048f0: 0a0a 2a20 5769 6e64 6f77 733a 206d 7379  ..* Windows: msy
+00004900: 7332 2d70 7974 686f 6e20 332e 382e 3620  s2-python 3.8.6 
+00004910: 6f63 6361 7369 6f6e 616c 6c79 2074 6872  occasionally thr
+00004920: 6f77 7320 6052 756e 7469 6d65 4572 726f  ows `RuntimeErro
+00004930: 723a 2072 656c 6561 7365 2075 6e6c 6f63  r: release unloc
+00004940: 6b65 6420 6c6f 636b 6020 7768 656e 206c  ked lock` when l
+00004950: 6561 7669 6e67 2061 2073 636f 7065 6420  eaving a scoped 
+00004960: 6d75 7465 7820 696e 2075 7032 6b0a 2020  mutex in up2k.  
+00004970: 2a20 7468 6973 2069 7320 616e 206d 7379  * this is an msy
+00004980: 7332 2062 7567 2c20 7468 6520 7265 6775  s2 bug, the regu
+00004990: 6c61 7220 7769 6e64 6f77 7320 6564 6974  lar windows edit
+000049a0: 696f 6e20 6f66 2070 7974 686f 6e20 6973  ion of python is
+000049b0: 2066 696e 650a 0a2a 2056 6972 7475 616c   fine..* Virtual
+000049c0: 426f 783a 2073 716c 6974 6520 7468 726f  Box: sqlite thro
+000049d0: 7773 2060 4469 736b 2049 2f4f 2045 7272  ws `Disk I/O Err
+000049e0: 6f72 6020 7768 656e 2072 756e 6e69 6e67  or` when running
+000049f0: 2069 6e20 6120 564d 2061 6e64 2074 6865   in a VM and the
+00004a00: 2075 7032 6b20 6461 7461 6261 7365 2069   up2k database i
+00004a10: 7320 696e 2061 2076 626f 7873 660a 2020  s in a vboxsf.  
+00004a20: 2a20 7573 6520 602d 2d68 6973 7460 206f  * use `--hist` o
+00004a30: 7220 7468 6520 6068 6973 7460 2076 6f6c  r the `hist` vol
+00004a40: 666c 6167 2028 602d 7620 5b2e 2e2e 5d3a  flag (`-v [...]:
+00004a50: 632c 6869 7374 3d2f 746d 702f 666f 6f60  c,hist=/tmp/foo`
+00004a60: 2920 746f 2070 6c61 6365 2074 6865 2064  ) to place the d
+00004a70: 6220 696e 7369 6465 2074 6865 2076 6d20  b inside the vm 
+00004a80: 696e 7374 6561 640a 0a2a 2055 6275 6e74  instead..* Ubunt
+00004a90: 753a 2064 7261 6767 696e 6720 6669 6c65  u: dragging file
+00004aa0: 7320 6672 6f6d 2063 6572 7461 696e 2066  s from certain f
+00004ab0: 6f6c 6465 7273 2069 6e74 6f20 6669 7265  olders into fire
+00004ac0: 666f 7820 6f72 2063 6872 6f6d 6520 6973  fox or chrome is
+00004ad0: 2069 6d70 6f73 7369 626c 650a 2020 2a20   impossible.  * 
+00004ae0: 6475 6520 746f 2073 6e61 7020 7365 6375  due to snap secu
+00004af0: 7269 7479 2070 6f6c 6963 6965 7320 2d2d  rity policies --
+00004b00: 2073 6565 2060 736e 6170 2063 6f6e 6e65   see `snap conne
+00004b10: 6374 696f 6e73 2066 6972 6566 6f78 6020  ctions firefox` 
+00004b20: 666f 7220 7468 6520 616c 6c6f 776c 6973  for the allowlis
+00004b30: 742c 2060 7265 6d6f 7661 626c 652d 6d65  t, `removable-me
+00004b40: 6469 6160 2070 6572 6d69 7473 2061 6c6c  dia` permits all
+00004b50: 206f 6620 602f 6d6e 7460 2061 6e64 2060   of `/mnt` and `
+00004b60: 2f6d 6564 6961 6020 6170 7061 7265 6e74  /media` apparent
+00004b70: 6c79 0a0a 0a23 2062 7265 616b 696e 6720  ly...# breaking 
+00004b80: 6368 616e 6765 730a 0a75 7067 7261 6465  changes..upgrade
+00004b90: 206e 6f74 6573 0a0a 2a20 6031 2e36 2e30   notes..* `1.6.0
+00004ba0: 6020 2832 3032 332d 3031 2d32 3929 3a0a  ` (2023-01-29):.
+00004bb0: 2020 2a20 6874 7470 2d61 7069 3a20 6465    * http-api: de
+00004bc0: 6c65 7465 2f6d 6f76 6520 6973 206e 6f77  lete/move is now
+00004bd0: 2060 504f 5354 6020 696e 7374 6561 6420   `POST` instead 
+00004be0: 6f66 2060 4745 5460 0a20 202a 2065 7665  of `GET`.  * eve
+00004bf0: 7279 7468 696e 6720 6f74 6865 7220 7468  rything other th
+00004c00: 616e 2060 4745 5460 2061 6e64 2060 4845  an `GET` and `HE
+00004c10: 4144 6020 6d75 7374 2070 6173 7320 5b63  AD` must pass [c
+00004c20: 6f72 7320 7661 6c69 6461 7469 6f6e 5d28  ors validation](
+00004c30: 2363 6f72 7329 0a2a 2060 312e 352e 3060  #cors).* `1.5.0`
+00004c40: 2028 3230 3232 2d31 322d 3033 293a 205b   (2022-12-03): [
+00004c50: 6e65 7720 6368 756e 6b73 697a 6520 666f  new chunksize fo
+00004c60: 726d 756c 615d 2868 7474 7073 3a2f 2f67  rmula](https://g
+00004c70: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
+00004c80: 6f70 7970 6172 7479 2f63 6f6d 6d69 742f  opyparty/commit/
+00004c90: 3534 6531 6338 6432 3631 6466 2920 666f  54e1c8d261df) fo
+00004ca0: 7220 6669 6c65 7320 6c61 7267 6572 2074  r files larger t
+00004cb0: 6861 6e20 3132 3820 4769 420a 2020 2a20  han 128 GiB.  * 
+00004cc0: 2a2a 7573 6572 733a 2a2a 2075 7067 7261  **users:** upgra
+00004cd0: 6465 2074 6f20 7468 6520 6c61 7465 7374  de to the latest
+00004ce0: 205b 636c 6920 7570 6c6f 6164 6572 5d28   [cli uploader](
+00004cf0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00004d00: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00004d10: 792f 626c 6f62 2f68 6f76 7564 7374 7261  y/blob/hovudstra
+00004d20: 756d 2f62 696e 2f75 7032 6b2e 7079 2920  um/bin/up2k.py) 
+00004d30: 6966 2079 6f75 2075 7365 2074 6861 740a  if you use that.
+00004d40: 2020 2a20 2a2a 6465 7673 3a2a 2a20 7570    * **devs:** up
+00004d50: 6461 7465 2074 6869 7264 2d70 6172 7479  date third-party
+00004d60: 2075 7032 6b20 636c 6965 6e74 7320 2869   up2k clients (i
+00004d70: 6620 7468 6f73 6520 6576 656e 2065 7869  f those even exi
+00004d80: 7374 290a 0a0a 2320 4641 510a 0a22 6672  st)...# FAQ.."fr
+00004d90: 6571 7565 6e74 6c79 2220 6173 6b65 6420  equently" asked 
+00004da0: 7175 6573 7469 6f6e 730a 0a2a 2069 7320  questions..* is 
+00004db0: 6974 2070 6f73 7369 626c 6520 746f 2062  it possible to b
+00004dc0: 6c6f 636b 2072 6561 642d 6163 6365 7373  lock read-access
+00004dd0: 2074 6f20 666f 6c64 6572 7320 756e 6c65   to folders unle
+00004de0: 7373 2079 6f75 206b 6e6f 7720 7468 6520  ss you know the 
+00004df0: 6578 6163 7420 5552 4c20 666f 7220 6120  exact URL for a 
+00004e00: 7061 7274 6963 756c 6172 2066 696c 6520  particular file 
+00004e10: 696e 7369 6465 3f0a 2020 2a20 7965 732c  inside?.  * yes,
+00004e20: 2075 7369 6e67 2074 6865 205b 6067 6020   using the [`g` 
+00004e30: 7065 726d 6973 7369 6f6e 5d28 2361 6363  permission](#acc
+00004e40: 6f75 6e74 732d 616e 642d 766f 6c75 6d65  ounts-and-volume
+00004e50: 7329 2c20 7365 6520 7468 6520 6578 616d  s), see the exam
+00004e60: 706c 6573 2074 6865 7265 0a20 202a 2079  ples there.  * y
+00004e70: 6f75 2063 616e 2061 6c73 6f20 646f 2074  ou can also do t
+00004e80: 6869 7320 7769 7468 206c 696e 7578 2066  his with linux f
+00004e90: 696c 6573 7973 7465 6d20 7065 726d 6973  ilesystem permis
+00004ea0: 7369 6f6e 733b 2060 6368 6d6f 6420 3131  sions; `chmod 11
+00004eb0: 3120 6d75 7369 6360 2077 696c 6c20 6d61  1 music` will ma
+00004ec0: 6b65 2069 7420 706f 7373 6962 6c65 2074  ke it possible t
+00004ed0: 6f20 6163 6365 7373 2066 696c 6573 2061  o access files a
+00004ee0: 6e64 2066 6f6c 6465 7273 2069 6e73 6964  nd folders insid
+00004ef0: 6520 7468 6520 606d 7573 6963 6020 666f  e the `music` fo
+00004f00: 6c64 6572 2062 7574 206e 6f74 206c 6973  lder but not lis
+00004f10: 7420 7468 6520 696d 6d65 6469 6174 6520  t the immediate 
+00004f20: 636f 6e74 656e 7473 202d 2d20 616c 736f  contents -- also
+00004f30: 2077 6f72 6b73 2077 6974 6820 6f74 6865   works with othe
+00004f40: 7220 736f 6674 7761 7265 2c20 6e6f 7420  r software, not 
+00004f50: 6a75 7374 2063 6f70 7970 6172 7479 0a0a  just copyparty..
+00004f60: 2a20 6361 6e20 4920 6d61 6b65 2063 6f70  * can I make cop
+00004f70: 7970 6172 7479 2064 6f77 6e6c 6f61 6420  yparty download 
+00004f80: 6120 6669 6c65 2074 6f20 6d79 2073 6572  a file to my ser
+00004f90: 7665 7220 6966 2049 2067 6976 6520 6974  ver if I give it
+00004fa0: 2061 2055 524c 3f0a 2020 2a20 7965 732c   a URL?.  * yes,
+00004fb0: 2075 7369 6e67 205b 686f 6f6b 735d 2868   using [hooks](h
+00004fc0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00004fd0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+00004fe0: 2f62 6c6f 622f 686f 7675 6473 7472 6175  /blob/hovudstrau
+00004ff0: 6d2f 6269 6e2f 686f 6f6b 732f 7767 6574  m/bin/hooks/wget
+00005000: 2e70 7929 0a0a 0a23 2061 6363 6f75 6e74  .py)...# account
+00005010: 7320 616e 6420 766f 6c75 6d65 730a 0a70  s and volumes..p
+00005020: 6572 2d66 6f6c 6465 722c 2070 6572 2d75  er-folder, per-u
+00005030: 7365 7220 7065 726d 6973 7369 6f6e 7320  ser permissions 
+00005040: 202d 2069 6620 796f 7572 2073 6574 7570   - if your setup
+00005050: 2069 7320 6765 7474 696e 6720 636f 6d70   is getting comp
+00005060: 6c65 782c 2063 6f6e 7369 6465 7220 6d61  lex, consider ma
+00005070: 6b69 6e67 2061 205b 636f 6e66 6967 2066  king a [config f
+00005080: 696c 655d 282e 2f64 6f63 732f 6578 616d  ile](./docs/exam
+00005090: 706c 652e 636f 6e66 2920 696e 7374 6561  ple.conf) instea
+000050a0: 6420 6f66 2075 7369 6e67 2061 7267 756d  d of using argum
+000050b0: 656e 7473 0a2a 206d 7563 6820 6561 7369  ents.* much easi
+000050c0: 6572 2074 6f20 6d61 6e61 6765 2c20 616e  er to manage, an
+000050d0: 6420 796f 7520 6361 6e20 6d6f 6469 6679  d you can modify
+000050e0: 2074 6865 2063 6f6e 6669 6720 6174 2072   the config at r
+000050f0: 756e 7469 6d65 2077 6974 6820 6073 7973  untime with `sys
+00005100: 7465 6d63 746c 2072 656c 6f61 6420 636f  temctl reload co
+00005110: 7079 7061 7274 7960 206f 7220 6d6f 7265  pyparty` or more
+00005120: 2063 6f6e 7665 6e69 656e 746c 7920 7573   conveniently us
+00005130: 696e 6720 7468 6520 605b 7265 6c6f 6164  ing the `[reload
+00005140: 2063 6667 5d60 2062 7574 746f 6e20 696e   cfg]` button in
+00005150: 2074 6865 2063 6f6e 7472 6f6c 2d70 616e   the control-pan
+00005160: 656c 2028 6966 206c 6f67 6765 6420 696e  el (if logged in
+00005170: 2061 7320 6164 6d69 6e29 0a20 202a 2063   as admin).  * c
+00005180: 6861 6e67 6573 2074 6f20 7468 6520 605b  hanges to the `[
+00005190: 676c 6f62 616c 5d60 2063 6f6e 6669 6720  global]` config 
+000051a0: 7365 6374 696f 6e20 7265 7175 6972 6573  section requires
+000051b0: 2061 2072 6573 7461 7274 2074 6f20 7461   a restart to ta
+000051c0: 6b65 2065 6666 6563 740a 0a61 2071 7569  ke effect..a qui
+000051d0: 636b 2073 756d 6d61 7279 2063 616e 2062  ck summary can b
+000051e0: 6520 7365 656e 2075 7369 6e67 2060 2d2d  e seen using `--
+000051f0: 6865 6c70 2d61 6363 6f75 6e74 7360 0a0a  help-accounts`..
+00005200: 636f 6e66 6967 7572 696e 6720 6163 636f  configuring acco
+00005210: 756e 7473 2f76 6f6c 756d 6573 2077 6974  unts/volumes wit
+00005220: 6820 6172 6775 6d65 6e74 733a 0a2a 2060  h arguments:.* `
+00005230: 2d61 2075 7372 3a70 7764 6020 6164 6473  -a usr:pwd` adds
+00005240: 2061 6363 6f75 6e74 2060 7573 7260 2077   account `usr` w
+00005250: 6974 6820 7061 7373 776f 7264 2060 7077  ith password `pw
+00005260: 6460 0a2a 2060 2d76 202e 3a3a 7260 2061  d`.* `-v .::r` a
+00005270: 6464 7320 6375 7272 656e 742d 666f 6c64  dds current-fold
+00005280: 6572 2060 2e60 2061 7320 7468 6520 7765  er `.` as the we
+00005290: 6272 6f6f 742c 2060 7260 6561 6461 626c  broot, `r`eadabl
+000052a0: 6520 6279 2061 6e79 6f6e 650a 2020 2a20  e by anyone.  * 
+000052b0: 7468 6520 7379 6e74 6178 2069 7320 602d  the syntax is `-
+000052c0: 7620 7372 633a 6473 743a 7065 726d 3a70  v src:dst:perm:p
+000052d0: 6572 6d3a 2e2e 2e60 2073 6f20 6c6f 6361  erm:...` so loca
+000052e0: 6c2d 7061 7468 2c20 7572 6c2d 7061 7468  l-path, url-path
+000052f0: 2c20 616e 6420 6f6e 6520 6f72 206d 6f72  , and one or mor
+00005300: 6520 7065 726d 6973 7369 6f6e 7320 746f  e permissions to
+00005310: 2073 6574 0a20 202a 2067 7261 6e74 696e   set.  * grantin
+00005320: 6720 7468 6520 7361 6d65 2070 6572 6d69  g the same permi
+00005330: 7373 696f 6e73 2074 6f20 6d75 6c74 6970  ssions to multip
+00005340: 6c65 2061 6363 6f75 6e74 733a 2020 0a20  le accounts:  . 
+00005350: 2020 2060 2d76 202e 3a3a 722c 7573 7231     `-v .::r,usr1
+00005360: 2c75 7372 323a 7277 2c75 7372 332c 7573  ,usr2:rw,usr3,us
+00005370: 7234 6020 3d20 7573 7231 2f32 2072 6561  r4` = usr1/2 rea
+00005380: 642d 6f6e 6c79 2c20 332f 3420 7265 6164  d-only, 3/4 read
+00005390: 2d77 7269 7465 0a0a 7065 726d 6973 7369  -write..permissi
+000053a0: 6f6e 733a 0a2a 2060 7260 2028 7265 6164  ons:.* `r` (read
+000053b0: 293a 2062 726f 7773 6520 666f 6c64 6572  ): browse folder
+000053c0: 2063 6f6e 7465 6e74 732c 2064 6f77 6e6c   contents, downl
+000053d0: 6f61 6420 6669 6c65 732c 2064 6f77 6e6c  oad files, downl
+000053e0: 6f61 6420 6173 207a 6970 2f74 6172 0a2a  oad as zip/tar.*
+000053f0: 2060 7760 2028 7772 6974 6529 3a20 7570   `w` (write): up
+00005400: 6c6f 6164 2066 696c 6573 2c20 6d6f 7665  load files, move
+00005410: 2066 696c 6573 202a 696e 746f 2a20 7468   files *into* th
+00005420: 6973 2066 6f6c 6465 720a 2a20 606d 6020  is folder.* `m` 
+00005430: 286d 6f76 6529 3a20 6d6f 7665 2066 696c  (move): move fil
+00005440: 6573 2f66 6f6c 6465 7273 202a 6672 6f6d  es/folders *from
+00005450: 2a20 7468 6973 2066 6f6c 6465 720a 2a20  * this folder.* 
+00005460: 6064 6020 2864 656c 6574 6529 3a20 6465  `d` (delete): de
+00005470: 6c65 7465 2066 696c 6573 2f66 6f6c 6465  lete files/folde
+00005480: 7273 0a2a 2060 6760 2028 6765 7429 3a20  rs.* `g` (get): 
+00005490: 6f6e 6c79 2064 6f77 6e6c 6f61 6420 6669  only download fi
+000054a0: 6c65 732c 2063 616e 6e6f 7420 7365 6520  les, cannot see 
+000054b0: 666f 6c64 6572 2063 6f6e 7465 6e74 7320  folder contents 
+000054c0: 6f72 207a 6970 2f74 6172 0a2a 2060 4760  or zip/tar.* `G`
+000054d0: 2028 7570 6765 7429 3a20 7361 6d65 2061   (upget): same a
+000054e0: 7320 6067 6020 6578 6365 7074 2075 706c  s `g` except upl
+000054f0: 6f61 6465 7273 2067 6574 2074 6f20 7365  oaders get to se
+00005500: 6520 7468 6569 7220 6f77 6e20 6669 6c65  e their own file
+00005510: 6b65 7973 2028 7365 6520 6066 6b60 2069  keys (see `fk` i
+00005520: 6e20 6578 616d 706c 6573 2062 656c 6f77  n examples below
+00005530: 290a 0a65 7861 6d70 6c65 733a 0a2a 2061  )..examples:.* a
+00005540: 6464 2061 6363 6f75 6e74 7320 6e61 6d65  dd accounts name
+00005550: 6420 7531 2c20 7532 2c20 7533 2077 6974  d u1, u2, u3 wit
+00005560: 6820 7061 7373 776f 7264 7320 7031 2c20  h passwords p1, 
+00005570: 7032 2c20 7033 3a20 602d 6120 7531 3a70  p2, p3: `-a u1:p
+00005580: 3120 2d61 2075 323a 7032 202d 6120 7533  1 -a u2:p2 -a u3
+00005590: 3a70 3360 0a2a 206d 616b 6520 666f 6c64  :p3`.* make fold
+000055a0: 6572 2060 2f73 7276 6020 7468 6520 726f  er `/srv` the ro
+000055b0: 6f74 206f 6620 7468 6520 6669 6c65 7379  ot of the filesy
+000055c0: 7374 656d 2c20 7265 6164 2d6f 6e6c 7920  stem, read-only 
+000055d0: 6279 2061 6e79 6f6e 653a 2060 2d76 202f  by anyone: `-v /
+000055e0: 7372 763a 3a72 600a 2a20 6d61 6b65 2066  srv::r`.* make f
+000055f0: 6f6c 6465 7220 602f 6d6e 742f 6d75 7369  older `/mnt/musi
+00005600: 6360 2061 7661 696c 6162 6c65 2061 7420  c` available at 
+00005610: 602f 6d75 7369 6360 2c20 7265 6164 2d6f  `/music`, read-o
+00005620: 6e6c 7920 666f 7220 7531 2061 6e64 2075  nly for u1 and u
+00005630: 322c 2072 6561 642d 7772 6974 6520 666f  2, read-write fo
+00005640: 7220 7533 3a20 602d 7620 2f6d 6e74 2f6d  r u3: `-v /mnt/m
+00005650: 7573 6963 3a6d 7573 6963 3a72 2c75 312c  usic:music:r,u1,
+00005660: 7532 3a72 772c 7533 600a 2020 2a20 756e  u2:rw,u3`.  * un
+00005670: 6175 7468 6f72 697a 6564 2075 7365 7273  authorized users
+00005680: 2061 6363 6573 7369 6e67 2074 6865 2077   accessing the w
+00005690: 6562 726f 6f74 2063 616e 2073 6565 2074  ebroot can see t
+000056a0: 6861 7420 7468 6520 606d 7573 6963 6020  hat the `music` 
+000056b0: 666f 6c64 6572 2065 7869 7374 732c 2062  folder exists, b
+000056c0: 7574 2063 616e 6e6f 7420 6f70 656e 2069  ut cannot open i
+000056d0: 740a 2a20 6d61 6b65 2066 6f6c 6465 7220  t.* make folder 
+000056e0: 602f 6d6e 742f 696e 636f 6d69 6e67 6020  `/mnt/incoming` 
+000056f0: 6176 6169 6c61 626c 6520 6174 2060 2f69  available at `/i
+00005700: 6e63 602c 2077 7269 7465 2d6f 6e6c 7920  nc`, write-only 
+00005710: 666f 7220 7531 2c20 7265 6164 2d6d 6f76  for u1, read-mov
+00005720: 6520 666f 7220 7532 3a20 602d 7620 2f6d  e for u2: `-v /m
+00005730: 6e74 2f69 6e63 6f6d 696e 673a 696e 633a  nt/incoming:inc:
+00005740: 772c 7531 3a72 6d2c 7532 600a 2020 2a20  w,u1:rm,u2`.  * 
+00005750: 756e 6175 7468 6f72 697a 6564 2075 7365  unauthorized use
+00005760: 7273 2061 6363 6573 7369 6e67 2074 6865  rs accessing the
+00005770: 2077 6562 726f 6f74 2063 616e 2073 6565   webroot can see
+00005780: 2074 6861 7420 7468 6520 6069 6e63 6020   that the `inc` 
+00005790: 666f 6c64 6572 2065 7869 7374 732c 2062  folder exists, b
+000057a0: 7574 2063 616e 6e6f 7420 6f70 656e 2069  ut cannot open i
+000057b0: 740a 2020 2a20 6075 3160 2063 616e 206f  t.  * `u1` can o
+000057c0: 7065 6e20 7468 6520 6069 6e63 6020 666f  pen the `inc` fo
+000057d0: 6c64 6572 2c20 6275 7420 6361 6e6e 6f74  lder, but cannot
+000057e0: 2073 6565 2074 6865 2063 6f6e 7465 6e74   see the content
+000057f0: 732c 206f 6e6c 7920 7570 6c6f 6164 206e  s, only upload n
+00005800: 6577 2066 696c 6573 2074 6f20 6974 0a20  ew files to it. 
+00005810: 202a 2060 7532 6020 6361 6e20 6272 6f77   * `u2` can brow
+00005820: 7365 2069 7420 616e 6420 6d6f 7665 2066  se it and move f
+00005830: 696c 6573 202a 6672 6f6d 2a20 602f 696e  iles *from* `/in
+00005840: 6360 2069 6e74 6f20 616e 7920 666f 6c64  c` into any fold
+00005850: 6572 2077 6865 7265 2060 7532 6020 6861  er where `u2` ha
+00005860: 7320 7772 6974 652d 6163 6365 7373 0a2a  s write-access.*
+00005870: 206d 616b 6520 666f 6c64 6572 2060 2f6d   make folder `/m
+00005880: 6e74 2f73 7360 2061 7661 696c 6162 6c65  nt/ss` available
+00005890: 2061 7420 602f 6960 2c20 7265 6164 2d77   at `/i`, read-w
+000058a0: 7269 7465 2066 6f72 2075 312c 2067 6574  rite for u1, get
+000058b0: 2d6f 6e6c 7920 666f 7220 6576 6572 796f  -only for everyo
+000058c0: 6e65 2065 6c73 652c 2061 6e64 2065 6e61  ne else, and ena
+000058d0: 626c 6520 6669 6c65 6b65 7973 3a20 602d  ble filekeys: `-
+000058e0: 7620 2f6d 6e74 2f73 733a 693a 7277 2c75  v /mnt/ss:i:rw,u
+000058f0: 313a 673a 632c 666b 3d34 600a 2020 2a20  1:g:c,fk=4`.  * 
+00005900: 6063 2c66 6b3d 3460 2073 6574 7320 7468  `c,fk=4` sets th
+00005910: 6520 6066 6b60 2028 6669 6c65 6b65 7929  e `fk` (filekey)
+00005920: 2076 6f6c 666c 6167 2074 6f20 342c 206d   volflag to 4, m
+00005930: 6561 6e69 6e67 2065 6163 6820 6669 6c65  eaning each file
+00005940: 2067 6574 7320 6120 342d 6368 6172 6163   gets a 4-charac
+00005950: 7465 7220 6163 6365 7373 6b65 790a 2020  ter accesskey.  
+00005960: 2a20 6075 3160 2063 616e 2075 706c 6f61  * `u1` can uploa
+00005970: 6420 6669 6c65 732c 2062 726f 7773 6520  d files, browse 
+00005980: 7468 6520 666f 6c64 6572 2c20 616e 6420  the folder, and 
+00005990: 7365 6520 7468 6520 6765 6e65 7261 7465  see the generate
+000059a0: 6420 6669 6c65 6b65 7973 0a20 202a 206f  d filekeys.  * o
+000059b0: 7468 6572 2075 7365 7273 2063 616e 6e6f  ther users canno
+000059c0: 7420 6272 6f77 7365 2074 6865 2066 6f6c  t browse the fol
+000059d0: 6465 722c 2062 7574 2063 616e 2061 6363  der, but can acc
+000059e0: 6573 7320 7468 6520 6669 6c65 7320 6966  ess the files if
+000059f0: 2074 6865 7920 6861 7665 2074 6865 2066   they have the f
+00005a00: 756c 6c20 6669 6c65 2055 524c 2077 6974  ull file URL wit
+00005a10: 6820 7468 6520 6669 6c65 6b65 790a 2020  h the filekey.  
+00005a20: 2a20 7265 706c 6163 696e 6720 7468 6520  * replacing the 
+00005a30: 6067 6020 7065 726d 6973 7369 6f6e 2077  `g` permission w
+00005a40: 6974 6820 6077 6760 2077 6f75 6c64 206c  ith `wg` would l
+00005a50: 6574 2061 6e6f 6e79 6d6f 7573 2075 7365  et anonymous use
+00005a60: 7273 2075 706c 6f61 6420 6669 6c65 732c  rs upload files,
+00005a70: 2062 7574 206e 6f74 2073 6565 2074 6865   but not see the
+00005a80: 2072 6571 7569 7265 6420 6669 6c65 6b65   required fileke
+00005a90: 7920 746f 2061 6363 6573 7320 6974 0a20  y to access it. 
+00005aa0: 202a 2072 6570 6c61 6369 6e67 2074 6865   * replacing the
+00005ab0: 2060 6760 2070 6572 6d69 7373 696f 6e20   `g` permission 
+00005ac0: 7769 7468 2060 7747 6020 776f 756c 6420  with `wG` would 
+00005ad0: 6c65 7420 616e 6f6e 796d 6f75 7320 7573  let anonymous us
+00005ae0: 6572 7320 7570 6c6f 6164 2066 696c 6573  ers upload files
+00005af0: 2c20 7265 6365 6976 696e 6720 6120 776f  , receiving a wo
+00005b00: 726b 696e 6720 6469 7265 6374 206c 696e  rking direct lin
+00005b10: 6b20 696e 2072 6574 7572 6e0a 0a61 6e79  k in return..any
+00005b20: 6f6e 6520 7472 7969 6e67 2074 6f20 6272  one trying to br
+00005b30: 7574 6566 6f72 6365 2061 2070 6173 7377  uteforce a passw
+00005b40: 6f72 6420 6765 7473 2062 616e 6e65 6420  ord gets banned 
+00005b50: 6163 636f 7264 696e 6720 746f 2060 2d2d  according to `--
+00005b60: 6261 6e2d 7077 603b 2064 6566 6175 6c74  ban-pw`; default
+00005b70: 2069 7320 3234 6820 6261 6e20 666f 7220   is 24h ban for 
+00005b80: 3920 6661 696c 6564 2061 7474 656d 7074  9 failed attempt
+00005b90: 7320 696e 2031 2068 6f75 720a 0a0a 2323  s in 1 hour...##
+00005ba0: 2073 6861 646f 7769 6e67 0a0a 6869 6469   shadowing..hidi
+00005bb0: 6e67 2073 7065 6369 6669 6320 7375 6266  ng specific subf
+00005bc0: 6f6c 6465 7273 2020 6279 206d 6f75 6e74  olders  by mount
+00005bd0: 696e 6720 616e 6f74 6865 7220 766f 6c75  ing another volu
+00005be0: 6d65 206f 6e20 746f 7020 6f66 2074 6865  me on top of the
+00005bf0: 6d0a 0a66 6f72 2065 7861 6d70 6c65 2060  m..for example `
+00005c00: 2d76 202f 6d6e 743a 3a72 202d 7620 2f76  -v /mnt::r -v /v
+00005c10: 6172 2f65 6d70 7479 3a77 6562 2f63 6572  ar/empty:web/cer
+00005c20: 7473 3a72 6020 6d6f 756e 7473 2074 6865  ts:r` mounts the
+00005c30: 2073 6572 7665 7220 666f 6c64 6572 2060   server folder `
+00005c40: 2f6d 6e74 6020 6173 2074 6865 2077 6562  /mnt` as the web
+00005c50: 726f 6f74 2c20 6275 7420 616e 6f74 6865  root, but anothe
+00005c60: 7220 766f 6c75 6d65 2069 7320 6d6f 756e  r volume is moun
+00005c70: 7465 6420 6174 2060 2f77 6562 2f63 6572  ted at `/web/cer
+00005c80: 7473 6020 2d2d 2073 6f20 7669 7369 746f  ts` -- so visito
+00005c90: 7273 2063 616e 206f 6e6c 7920 7365 6520  rs can only see 
+00005ca0: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
+00005cb0: 602f 6d6e 7460 2061 6e64 2060 2f6d 6e74  `/mnt` and `/mnt
+00005cc0: 2f77 6562 6020 2861 7420 5552 4c73 2060  /web` (at URLs `
+00005cd0: 2f60 2061 6e64 2060 2f77 6562 6029 2c20  /` and `/web`), 
+00005ce0: 6275 7420 6e6f 7420 602f 6d6e 742f 7765  but not `/mnt/we
+00005cf0: 622f 6365 7274 7360 2062 6563 6175 7365  b/certs` because
+00005d00: 2055 524c 2060 2f77 6562 2f63 6572 7473   URL `/web/certs
+00005d10: 6020 6973 206d 6170 7065 6420 746f 2060  ` is mapped to `
+00005d20: 2f76 6172 2f65 6d70 7479 600a 0a0a 2320  /var/empty`...# 
+00005d30: 7468 6520 6272 6f77 7365 720a 0a61 6363  the browser..acc
+00005d40: 6573 7369 6e67 2061 2063 6f70 7970 6172  essing a copypar
+00005d50: 7479 2073 6572 7665 7220 7573 696e 6720  ty server using 
+00005d60: 6120 7765 622d 6272 6f77 7365 720a 0a21  a web-browser..!
+00005d70: 5b63 6f70 7970 6172 7479 2d62 726f 7773  [copyparty-brows
+00005d80: 6572 2d66 7338 5d28 6874 7470 733a 2f2f  er-fs8](https://
+00005d90: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00005da0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00005db0: 6d2f 3234 3130 3332 2f31 3932 3034 3236  m/241032/1920426
+00005dc0: 3935 2d35 3232 6233 6563 372d 3638 3435  95-522b3ec7-6845
+00005dd0: 2d34 3934 612d 6162 6462 2d64 3163 3064  -494a-abdb-d1c0d
+00005de0: 3065 3233 3830 312e 706e 6729 0a0a 0a23  0e23801.png)...#
+00005df0: 2320 7461 6273 0a0a 7468 6520 6d61 696e  # tabs..the main
+00005e00: 2074 6162 7320 696e 2074 6865 2075 690a   tabs in the ui.
+00005e10: 2a20 605b f09f 948e 5d60 205b 7365 6172  * `[....]` [sear
+00005e20: 6368 5d28 2373 6561 7263 6869 6e67 2920  ch](#searching) 
+00005e30: 6279 2073 697a 652c 2064 6174 652c 2070  by size, date, p
+00005e40: 6174 682f 6e61 6d65 2c20 6d70 332d 7461  ath/name, mp3-ta
+00005e50: 6773 202e 2e2e 0a2a 2060 5bf0 9fa7 af5d  gs ....* `[....]
+00005e60: 6020 5b75 6e70 6f73 745d 2823 756e 706f  ` [unpost](#unpo
+00005e70: 7374 293a 2075 6e64 6f2f 6465 6c65 7465  st): undo/delete
+00005e80: 2061 6363 6964 656e 7461 6c20 7570 6c6f   accidental uplo
+00005e90: 6164 730a 2a20 605b f09f 9a80 5d60 2061  ads.* `[....]` a
+00005ea0: 6e64 2060 5bf0 9f8e 885d 6020 6172 6520  nd `[....]` are 
+00005eb0: 7468 6520 5b75 706c 6f61 6465 7273 5d28  the [uploaders](
+00005ec0: 2375 706c 6f61 6469 6e67 290a 2a20 605b  #uploading).* `[
+00005ed0: f09f 9382 5d60 206d 6b64 6972 3a20 6372  ....]` mkdir: cr
+00005ee0: 6561 7465 2064 6972 6563 746f 7269 6573  eate directories
+00005ef0: 0a2a 2060 5bf0 9f93 9d5d 6020 6e65 772d  .* `[....]` new-
+00005f00: 6d64 3a20 6372 6561 7465 2061 206e 6577  md: create a new
+00005f10: 206d 6172 6b64 6f77 6e20 646f 6375 6d65   markdown docume
+00005f20: 6e74 0a2a 2060 5bf0 9f93 9f5d 6020 7365  nt.* `[....]` se
+00005f30: 6e64 2d6d 7367 3a20 6569 7468 6572 2074  nd-msg: either t
+00005f40: 6f20 7365 7276 6572 2d6c 6f67 206f 7220  o server-log or 
+00005f50: 696e 746f 2074 6578 7466 696c 6573 2069  into textfiles i
+00005f60: 6620 602d 2d75 726c 666f 726d 2073 6176  f `--urlform sav
+00005f70: 6560 0a2a 2060 5bf0 9f8e ba5d 6020 6175  e`.* `[....]` au
+00005f80: 6469 6f2d 706c 6179 6572 2063 6f6e 6669  dio-player confi
+00005f90: 6720 6f70 7469 6f6e 730a 2a20 605b e29a  g options.* `[..
+00005fa0: 99ef b88f 5d60 2067 656e 6572 616c 2063  ....]` general c
+00005fb0: 6c69 656e 7420 636f 6e66 6967 206f 7074  lient config opt
+00005fc0: 696f 6e73 0a0a 0a23 2320 686f 746b 6579  ions...## hotkey
+00005fd0: 730a 0a74 6865 2062 726f 7773 6572 2068  s..the browser h
+00005fe0: 6173 2074 6865 2066 6f6c 6c6f 7769 6e67  as the following
+00005ff0: 2068 6f74 6b65 7973 2020 2861 6c77 6179   hotkeys  (alway
+00006000: 7320 7177 6572 7479 290a 2a20 603f 6020  s qwerty).* `?` 
+00006010: 7368 6f77 2068 6f74 6b65 7973 2068 656c  show hotkeys hel
+00006020: 700a 2a20 6042 6020 746f 6767 6c65 2062  p.* `B` toggle b
+00006030: 7265 6164 6372 756d 6273 202f 205b 6e61  readcrumbs / [na
+00006040: 7670 616e 655d 2823 6e61 7670 616e 6529  vpane](#navpane)
+00006050: 0a2a 2060 492f 4b60 2070 7265 762f 6e65  .* `I/K` prev/ne
+00006060: 7874 2066 6f6c 6465 720a 2a20 604d 6020  xt folder.* `M` 
+00006070: 7061 7265 6e74 2066 6f6c 6465 7220 286f  parent folder (o
+00006080: 7220 756e 6578 7061 6e64 2063 7572 7265  r unexpand curre
+00006090: 6e74 290a 2a20 6056 6020 746f 6767 6c65  nt).* `V` toggle
+000060a0: 2066 6f6c 6465 7273 202f 2074 6578 7466   folders / textf
+000060b0: 696c 6573 2069 6e20 7468 6520 6e61 7670  iles in the navp
+000060c0: 616e 650a 2a20 6047 6020 746f 6767 6c65  ane.* `G` toggle
+000060d0: 206c 6973 7420 2f20 5b67 7269 6420 7669   list / [grid vi
+000060e0: 6577 5d28 2374 6875 6d62 6e61 696c 7329  ew](#thumbnails)
+000060f0: 202d 2d20 7361 6d65 2061 7320 60e7 94b0   -- same as `...
+00006100: 6020 626f 7474 6f6d 2d72 6967 6874 0a2a  ` bottom-right.*
+00006110: 2060 5460 2074 6f67 676c 6520 7468 756d   `T` toggle thum
+00006120: 626e 6169 6c73 202f 2069 636f 6e73 0a2a  bnails / icons.*
+00006130: 2060 4553 4360 2063 6c6f 7365 2076 6172   `ESC` close var
+00006140: 696f 7573 2074 6869 6e67 730a 2a20 6063  ious things.* `c
+00006150: 7472 6c2d 4b60 2064 656c 6574 6520 7365  trl-K` delete se
+00006160: 6c65 6374 6564 2066 696c 6573 2f66 6f6c  lected files/fol
+00006170: 6465 7273 0a2a 2060 6374 726c 2d58 6020  ders.* `ctrl-X` 
+00006180: 6375 7420 7365 6c65 6374 6564 2066 696c  cut selected fil
+00006190: 6573 2f66 6f6c 6465 7273 0a2a 2060 6374  es/folders.* `ct
+000061a0: 726c 2d56 6020 7061 7374 650a 2a20 6059  rl-V` paste.* `Y
+000061b0: 6020 646f 776e 6c6f 6164 2073 656c 6563  ` download selec
+000061c0: 7465 6420 6669 6c65 730a 2a20 6046 3260  ted files.* `F2`
+000061d0: 205b 7265 6e61 6d65 5d28 2362 6174 6368   [rename](#batch
+000061e0: 2d72 656e 616d 6529 2073 656c 6563 7465  -rename) selecte
+000061f0: 6420 6669 6c65 2f66 6f6c 6465 720a 2a20  d file/folder.* 
+00006200: 7768 656e 2061 2066 696c 652f 666f 6c64  when a file/fold
+00006210: 6572 2069 7320 7365 6c65 6374 6564 2028  er is selected (
+00006220: 696e 206e 6f74 2d67 7269 642d 7669 6577  in not-grid-view
+00006230: 293a 0a20 202a 2060 5570 2f44 6f77 6e60  ):.  * `Up/Down`
+00006240: 206d 6f76 6520 6375 7273 6f72 0a20 202a   move cursor.  *
+00006250: 2073 6869 6674 2b60 5570 2f44 6f77 6e60   shift+`Up/Down`
+00006260: 2073 656c 6563 7420 616e 6420 6d6f 7665   select and move
+00006270: 2063 7572 736f 720a 2020 2a20 6374 726c   cursor.  * ctrl
+00006280: 2b60 5570 2f44 6f77 6e60 206d 6f76 6520  +`Up/Down` move 
+00006290: 6375 7273 6f72 2061 6e64 2073 6372 6f6c  cursor and scrol
+000062a0: 6c20 7669 6577 706f 7274 0a20 202a 2060  l viewport.  * `
+000062b0: 5370 6163 6560 2074 6f67 676c 6520 6669  Space` toggle fi
+000062c0: 6c65 2073 656c 6563 7469 6f6e 0a20 202a  le selection.  *
+000062d0: 2060 4374 726c 2d41 6020 746f 6767 6c65   `Ctrl-A` toggle
+000062e0: 2073 656c 6563 7420 616c 6c0a 2a20 7768   select all.* wh
+000062f0: 656e 2061 2074 6578 7466 696c 6520 6973  en a textfile is
+00006300: 206f 7065 6e3a 0a20 202a 2060 492f 4b60   open:.  * `I/K`
+00006310: 2070 7265 762f 6e65 7874 2074 6578 7466   prev/next textf
+00006320: 696c 650a 2020 2a20 6053 6020 746f 6767  ile.  * `S` togg
+00006330: 6c65 2073 656c 6563 7469 6f6e 206f 6620  le selection of 
+00006340: 6f70 656e 2066 696c 650a 2020 2a20 604d  open file.  * `M
+00006350: 6020 636c 6f73 6520 7465 7874 6669 6c65  ` close textfile
+00006360: 0a2a 2077 6865 6e20 706c 6179 696e 6720  .* when playing 
+00006370: 6175 6469 6f3a 0a20 202a 2060 4a2f 4c60  audio:.  * `J/L`
+00006380: 2070 7265 762f 6e65 7874 2073 6f6e 670a   prev/next song.
+00006390: 2020 2a20 6055 2f4f 6020 736b 6970 2031    * `U/O` skip 1
+000063a0: 3073 6563 2062 6163 6b2f 666f 7277 6172  0sec back/forwar
+000063b0: 640a 2020 2a20 6030 2e2e 3960 206a 756d  d.  * `0..9` jum
+000063c0: 7020 746f 2030 252e 2e39 3025 0a20 202a  p to 0%..90%.  *
+000063d0: 2060 5060 2070 6c61 792f 7061 7573 6520   `P` play/pause 
+000063e0: 2861 6c73 6f20 7374 6172 7473 2070 6c61  (also starts pla
+000063f0: 7969 6e67 2074 6865 2066 6f6c 6465 7229  ying the folder)
+00006400: 0a20 202a 2060 5960 2064 6f77 6e6c 6f61  .  * `Y` downloa
+00006410: 6420 6669 6c65 0a2a 2077 6865 6e20 7669  d file.* when vi
+00006420: 6577 696e 6720 696d 6167 6573 202f 2070  ewing images / p
+00006430: 6c61 7969 6e67 2076 6964 656f 733a 0a20  laying videos:. 
+00006440: 202a 2060 4a2f 4c2c 204c 6566 742f 5269   * `J/L, Left/Ri
+00006450: 6768 7460 2070 7265 762f 6e65 7874 2066  ght` prev/next f
+00006460: 696c 650a 2020 2a20 6048 6f6d 652f 456e  ile.  * `Home/En
+00006470: 6460 2066 6972 7374 2f6c 6173 7420 6669  d` first/last fi
+00006480: 6c65 0a20 202a 2060 4660 2074 6f67 676c  le.  * `F` toggl
+00006490: 6520 6675 6c6c 7363 7265 656e 0a20 202a  e fullscreen.  *
+000064a0: 2060 5360 2074 6f67 676c 6520 7365 6c65   `S` toggle sele
+000064b0: 6374 696f 6e0a 2020 2a20 6052 6020 726f  ction.  * `R` ro
+000064c0: 7461 7465 2063 6c6f 636b 7769 7365 2028  tate clockwise (
+000064d0: 7368 6966 743d 6363 7729 0a20 202a 2060  shift=ccw).  * `
+000064e0: 5960 2064 6f77 6e6c 6f61 6420 6669 6c65  Y` download file
+000064f0: 0a20 202a 2060 4573 6360 2063 6c6f 7365  .  * `Esc` close
+00006500: 2076 6965 7765 720a 2020 2a20 7669 6465   viewer.  * vide
+00006510: 6f73 3a0a 2020 2020 2a20 6055 2f4f 6020  os:.    * `U/O` 
+00006520: 736b 6970 2031 3073 6563 2062 6163 6b2f  skip 10sec back/
+00006530: 666f 7277 6172 640a 2020 2020 2a20 6030  forward.    * `0
+00006540: 2e2e 3960 206a 756d 7020 746f 2030 252e  ..9` jump to 0%.
+00006550: 2e39 3025 0a20 2020 202a 2060 502f 4b2f  .90%.    * `P/K/
+00006560: 5370 6163 6560 2070 6c61 792f 7061 7573  Space` play/paus
+00006570: 650a 2020 2020 2a20 604d 6020 6d75 7465  e.    * `M` mute
+00006580: 0a20 2020 202a 2060 4360 2063 6f6e 7469  .    * `C` conti
+00006590: 6e75 6520 706c 6179 696e 6720 6e65 7874  nue playing next
+000065a0: 2076 6964 656f 0a20 2020 202a 2060 5660   video.    * `V`
+000065b0: 206c 6f6f 7020 656e 7469 7265 2066 696c   loop entire fil
+000065c0: 650a 2020 2020 2a20 605b 6020 6c6f 6f70  e.    * `[` loop
+000065d0: 2072 616e 6765 2028 7374 6172 7429 0a20   range (start). 
+000065e0: 2020 202a 2060 5d60 206c 6f6f 7020 7261     * `]` loop ra
+000065f0: 6e67 6520 2865 6e64 290a 2a20 7768 656e  nge (end).* when
+00006600: 2074 6865 206e 6176 7061 6e65 2069 7320   the navpane is 
+00006610: 6f70 656e 3a0a 2020 2a20 6041 2f44 6020  open:.  * `A/D` 
+00006620: 6164 6a75 7374 2074 7265 6520 7769 6474  adjust tree widt
+00006630: 680a 2a20 696e 2074 6865 205b 6772 6964  h.* in the [grid
+00006640: 2076 6965 775d 2823 7468 756d 626e 6169   view](#thumbnai
+00006650: 6c73 293a 0a20 202a 2060 5360 2074 6f67  ls):.  * `S` tog
+00006660: 676c 6520 6d75 6c74 6973 656c 6563 740a  gle multiselect.
+00006670: 2020 2a20 7368 6966 742b 6041 2f44 6020    * shift+`A/D` 
+00006680: 7a6f 6f6d 0a2a 2069 6e20 7468 6520 6d61  zoom.* in the ma
+00006690: 726b 646f 776e 2065 6469 746f 723a 0a20  rkdown editor:. 
+000066a0: 202a 2060 5e73 6020 7361 7665 0a20 202a   * `^s` save.  *
+000066b0: 2060 5e68 6020 6865 6164 6572 0a20 202a   `^h` header.  *
+000066c0: 2060 5e6b 6020 6175 746f 666f 726d 6174   `^k` autoformat
+000066d0: 2074 6162 6c65 0a20 202a 2060 5e75 6020   table.  * `^u` 
+000066e0: 6a75 6d70 2074 6f20 6e65 7874 2075 6e69  jump to next uni
+000066f0: 636f 6465 2063 6861 7261 6374 6572 0a20  code character. 
+00006700: 202a 2060 5e65 6020 746f 6767 6c65 2065   * `^e` toggle e
+00006710: 6469 746f 7220 2f20 7072 6576 6965 770a  ditor / preview.
+00006720: 2020 2a20 605e 7570 2c20 5e64 6f77 6e60    * `^up, ^down`
+00006730: 206a 756d 7020 7061 7261 6772 6170 6873   jump paragraphs
+00006740: 0a0a 0a23 2320 6e61 7670 616e 650a 0a73  ...## navpane..s
+00006750: 7769 7463 6869 6e67 2062 6574 7765 656e  witching between
+00006760: 2062 7265 6164 6372 756d 6273 206f 7220   breadcrumbs or 
+00006770: 6e61 7670 616e 650a 0a63 6c69 636b 2074  navpane..click t
+00006780: 6865 2060 f09f 8cb2 6020 6f72 2070 7265  he `....` or pre
+00006790: 7373 696e 6720 7468 6520 6042 6020 686f  ssing the `B` ho
+000067a0: 746b 6579 2074 6f20 746f 6767 6c65 2062  tkey to toggle b
+000067b0: 6574 7765 656e 2062 7265 6164 6372 756d  etween breadcrum
+000067c0: 6273 2070 6174 6820 2864 6566 6175 6c74  bs path (default
+000067d0: 292c 206f 7220 6120 6e61 7670 616e 6520  ), or a navpane 
+000067e0: 2874 7265 652d 6272 6f77 7365 7220 7369  (tree-browser si
+000067f0: 6465 6261 7220 7468 696e 6729 0a0a 2a20  debar thing)..* 
+00006800: 605b 2b5d 6020 616e 6420 605b 2d5d 6020  `[+]` and `[-]` 
+00006810: 286f 7220 686f 746b 6579 7320 6041 602f  (or hotkeys `A`/
+00006820: 6044 6029 2061 646a 7573 7420 7468 6520  `D`) adjust the 
+00006830: 7369 7a65 0a2a 2060 5bf0 9f8e af5d 6020  size.* `[....]` 
+00006840: 6a75 6d70 7320 746f 2074 6865 2063 7572  jumps to the cur
+00006850: 7265 6e74 6c79 206f 7065 6e20 666f 6c64  rently open fold
+00006860: 6572 0a2a 2060 5bf0 9f93 835d 6020 746f  er.* `[....]` to
+00006870: 6767 6c65 7320 6265 7477 6565 6e20 7368  ggles between sh
+00006880: 6f77 696e 6720 666f 6c64 6572 7320 616e  owing folders an
+00006890: 6420 7465 7874 6669 6c65 730a 2a20 605b  d textfiles.* `[
+000068a0: f09f 938c 5d60 2073 686f 7773 2074 6865  ....]` shows the
+000068b0: 206e 616d 6520 6f66 2061 6c6c 2070 6172   name of all par
+000068c0: 656e 7420 666f 6c64 6572 7320 696e 2061  ent folders in a
+000068d0: 2064 6f63 6b65 6420 7061 6e65 6c0a 2a20   docked panel.* 
+000068e0: 605b 615d 6020 746f 6767 6c65 7320 6175  `[a]` toggles au
+000068f0: 746f 6d61 7469 6320 7769 6465 6e69 6e67  tomatic widening
+00006900: 2061 7320 796f 7520 676f 2064 6565 7065   as you go deepe
+00006910: 720a 2a20 605b e286 b55d 6020 746f 6767  r.* `[...]` togg
+00006920: 6c65 7320 776f 7264 7772 6170 0a2a 2060  les wordwrap.* `
+00006930: 5bf0 9f91 805d 6020 7368 6f77 2066 756c  [....]` show ful
+00006940: 6c20 6e61 6d65 206f 6e20 686f 7665 7220  l name on hover 
+00006950: 2869 6620 776f 7264 7772 6170 2069 7320  (if wordwrap is 
+00006960: 6f66 6629 0a0a 0a23 2320 7468 756d 626e  off)...## thumbn
+00006970: 6169 6c73 0a0a 7072 6573 7320 6067 6020  ails..press `g` 
+00006980: 6f72 2060 e794 b060 2074 6f20 746f 6767  or `...` to togg
+00006990: 6c65 2067 7269 642d 7669 6577 2069 6e73  le grid-view ins
+000069a0: 7465 6164 206f 6620 7468 6520 6669 6c65  tead of the file
+000069b0: 206c 6973 7469 6e67 2020 616e 6420 6074   listing  and `t
+000069c0: 6020 746f 6767 6c65 7320 6963 6f6e 7320  ` toggles icons 
+000069d0: 2f20 7468 756d 626e 6169 6c73 0a0a 215b  / thumbnails..![
+000069e0: 636f 7079 7061 7274 792d 7468 756d 6273  copyparty-thumbs
+000069f0: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
+00006a00: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00006a10: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00006a20: 3234 3130 3332 2f31 3239 3633 3632 3131  241032/129636211
+00006a30: 2d61 6264 3230 6661 322d 6139 3533 2d34  -abd20fa2-a953-4
+00006a40: 3336 362d 3934 3233 2d31 6338 3865 6262  366-9423-1c88ebb
+00006a50: 3936 6261 392e 706e 6729 0a0a 6974 2064  96ba9.png)..it d
+00006a60: 6f65 7320 7374 6174 6963 2069 6d61 6765  oes static image
+00006a70: 7320 7769 7468 2050 696c 6c6f 7720 2f20  s with Pillow / 
+00006a80: 7079 7669 7073 202f 2046 466d 7065 672c  pyvips / FFmpeg,
+00006a90: 2061 6e64 2075 7365 7320 4646 6d70 6567   and uses FFmpeg
+00006aa0: 2066 6f72 2076 6964 656f 2066 696c 6573   for video files
+00006ab0: 2c20 736f 2079 6f75 206d 6179 2077 616e  , so you may wan
+00006ac0: 7420 746f 2060 2d2d 6e6f 2d74 6875 6d62  t to `--no-thumb
+00006ad0: 6020 6f72 206d 6179 6265 206a 7573 7420  ` or maybe just 
+00006ae0: 602d 2d6e 6f2d 7674 6875 6d62 6020 6465  `--no-vthumb` de
+00006af0: 7065 6e64 696e 6720 6f6e 2068 6f77 2064  pending on how d
+00006b00: 616e 6765 726f 7573 2079 6f75 7220 7573  angerous your us
+00006b10: 6572 7320 6172 650a 2a20 7079 7669 7073  ers are.* pyvips
+00006b20: 2069 7320 3378 2066 6173 7465 7220 7468   is 3x faster th
+00006b30: 616e 2050 696c 6c6f 772c 2050 696c 6c6f  an Pillow, Pillo
+00006b40: 7720 6973 2033 7820 6661 7374 6572 2074  w is 3x faster t
+00006b50: 6861 6e20 4646 6d70 6567 0a2a 2064 6973  han FFmpeg.* dis
+00006b60: 6162 6c65 2074 6875 6d62 6e61 696c 7320  able thumbnails 
+00006b70: 666f 7220 7370 6563 6966 6963 2076 6f6c  for specific vol
+00006b80: 756d 6573 2077 6974 6820 766f 6c66 6c61  umes with volfla
+00006b90: 6720 6064 7468 756d 6260 2066 6f72 2061  g `dthumb` for a
+00006ba0: 6c6c 2c20 6f72 2060 6476 7468 756d 6260  ll, or `dvthumb`
+00006bb0: 202f 2060 6461 7468 756d 6260 202f 2060   / `dathumb` / `
+00006bc0: 6469 7468 756d 6260 2066 6f72 2076 6964  dithumb` for vid
+00006bd0: 656f 2f61 7564 696f 2f69 6d61 6765 7320  eo/audio/images 
+00006be0: 6f6e 6c79 0a0a 6175 6469 6f20 6669 6c65  only..audio file
+00006bf0: 7320 6172 6520 636f 766e 6572 7465 6420  s are covnerted 
+00006c00: 696e 746f 2073 7065 6374 726f 6772 616d  into spectrogram
+00006c10: 7320 7573 696e 6720 4646 6d70 6567 2075  s using FFmpeg u
+00006c20: 6e6c 6573 7320 796f 7520 602d 2d6e 6f2d  nless you `--no-
+00006c30: 6174 6875 6d62 6020 2861 6e64 2073 6f6d  athumb` (and som
+00006c40: 6520 4646 6d70 6567 2062 7569 6c64 7320  e FFmpeg builds 
+00006c50: 6d61 7920 6e65 6564 2060 2d2d 7468 2d66  may need `--th-f
+00006c60: 662d 7377 7260 290a 0a69 6d61 6765 7320  f-swr`)..images 
+00006c70: 7769 7468 2074 6865 2066 6f6c 6c6f 7769  with the followi
+00006c80: 6e67 206e 616d 6573 2028 7365 6520 602d  ng names (see `-
+00006c90: 2d74 682d 636f 7665 7273 6029 2062 6563  -th-covers`) bec
+00006ca0: 6f6d 6520 7468 6520 7468 756d 626e 6169  ome the thumbnai
+00006cb0: 6c20 6f66 2074 6865 2066 6f6c 6465 7220  l of the folder 
+00006cc0: 7468 6579 2772 6520 696e 3a20 6066 6f6c  they're in: `fol
+00006cd0: 6465 722e 706e 6760 2c20 6066 6f6c 6465  der.png`, `folde
+00006ce0: 722e 6a70 6760 2c20 6063 6f76 6572 2e70  r.jpg`, `cover.p
+00006cf0: 6e67 602c 2060 636f 7665 722e 6a70 6760  ng`, `cover.jpg`
+00006d00: 0a0a 696e 2074 6865 2067 7269 642f 7468  ..in the grid/th
+00006d10: 756d 626e 6169 6c20 7669 6577 2c20 6966  umbnail view, if
+00006d20: 2074 6865 2061 7564 696f 2070 6c61 7965   the audio playe
+00006d30: 7220 7061 6e65 6c20 6973 206f 7065 6e2c  r panel is open,
+00006d40: 2073 6f6e 6773 2077 696c 6c20 7374 6172   songs will star
+00006d50: 7420 706c 6179 696e 6720 7768 656e 2063  t playing when c
+00006d60: 6c69 636b 6564 0a2a 2069 6e64 6963 6174  licked.* indicat
+00006d70: 6564 2062 7920 7468 6520 6175 6469 6f20  ed by the audio 
+00006d80: 6669 6c65 7320 6861 7669 6e67 2074 6865  files having the
+00006d90: 20e2 96b6 2069 636f 6e20 696e 7374 6561   ... icon instea
+00006da0: 6420 6f66 20f0 9f92 be0a 0a0a 2323 207a  d of .......## z
+00006db0: 6970 2064 6f77 6e6c 6f61 6473 0a0a 646f  ip downloads..do
+00006dc0: 776e 6c6f 6164 2066 6f6c 6465 7273 2028  wnload folders (
+00006dd0: 6f72 2066 696c 6520 7365 6c65 6374 696f  or file selectio
+00006de0: 6e73 2920 6173 2060 7a69 7060 206f 7220  ns) as `zip` or 
+00006df0: 6074 6172 6020 6669 6c65 730a 0a73 656c  `tar` files..sel
+00006e00: 6563 7420 7768 6963 6820 7479 7065 206f  ect which type o
+00006e10: 6620 6172 6368 6976 6520 796f 7520 7761  f archive you wa
+00006e20: 6e74 2069 6e20 7468 6520 605b e29a 99ef  nt in the `[....
+00006e30: b88f 5d20 636f 6e66 6967 6020 7461 623a  ..] config` tab:
+00006e40: 0a0a 7c20 6e61 6d65 207c 2075 726c 2d73  ..| name | url-s
+00006e50: 7566 6669 7820 7c20 6465 7363 7269 7074  uffix | descript
+00006e60: 696f 6e20 7c0a 7c2d 2d7c 2d2d 7c2d 2d7c  ion |.|--|--|--|
+00006e70: 0a7c 2060 7461 7260 207c 2060 3f74 6172  .| `tar` | `?tar
+00006e80: 6020 7c20 706c 6169 6e20 676e 7574 6172  ` | plain gnutar
+00006e90: 2c20 776f 726b 7320 6772 6561 7420 7769  , works great wi
+00006ea0: 7468 2060 6375 726c 205c 7c20 7461 7220  th `curl \| tar 
+00006eb0: 2d78 7660 207c 0a7c 2060 7a69 7060 207c  -xv` |.| `zip` |
+00006ec0: 2060 3f7a 6970 3d75 7466 3860 207c 2077   `?zip=utf8` | w
+00006ed0: 6f72 6b73 2065 7665 7279 7768 6572 652c  orks everywhere,
+00006ee0: 2067 6c69 7463 6879 2066 696c 656e 616d   glitchy filenam
+00006ef0: 6573 206f 6e20 7769 6e37 2061 6e64 206f  es on win7 and o
+00006f00: 6c64 6572 207c 0a7c 2060 7a69 705f 646f  lder |.| `zip_do
+00006f10: 7360 207c 2060 3f7a 6970 6020 7c20 7472  s` | `?zip` | tr
+00006f20: 6164 6974 696f 6e61 6c20 6370 3433 3720  aditional cp437 
+00006f30: 286e 6f20 756e 6963 6f64 6529 2074 6f20  (no unicode) to 
+00006f40: 6669 7820 676c 6974 6368 7920 6669 6c65  fix glitchy file
+00006f50: 6e61 6d65 7320 7c0a 7c20 607a 6970 5f63  names |.| `zip_c
+00006f60: 7263 6020 7c20 603f 7a69 703d 6372 6360  rc` | `?zip=crc`
+00006f70: 207c 2063 7034 3337 2077 6974 6820 6372   | cp437 with cr
+00006f80: 6333 3220 636f 6d70 7574 6564 2065 6172  c32 computed ear
+00006f90: 6c79 2066 6f72 2074 7275 6c79 2061 6e63  ly for truly anc
+00006fa0: 6965 6e74 2073 6f66 7477 6172 6520 7c0a  ient software |.
+00006fb0: 0a2a 2068 6964 6465 6e20 6669 6c65 7320  .* hidden files 
+00006fc0: 2864 6f74 6669 6c65 7329 2061 7265 2065  (dotfiles) are e
+00006fd0: 7863 6c75 6465 6420 756e 6c65 7373 2060  xcluded unless `
+00006fe0: 2d65 6460 0a20 202a 2060 7570 326b 2e64  -ed`.  * `up2k.d
+00006ff0: 6260 2061 6e64 2060 6469 722e 7478 7460  b` and `dir.txt`
+00007000: 2069 7320 616c 7761 7973 2065 7863 6c75   is always exclu
+00007010: 6465 640a 2a20 607a 6970 5f63 7263 6020  ded.* `zip_crc` 
+00007020: 7769 6c6c 2074 616b 6520 6c6f 6e67 6572  will take longer
+00007030: 2074 6f20 646f 776e 6c6f 6164 2073 696e   to download sin
+00007040: 6365 2074 6865 2073 6572 7665 7220 6861  ce the server ha
+00007050: 7320 746f 2072 6561 6420 6561 6368 2066  s to read each f
+00007060: 696c 6520 7477 6963 650a 2020 2a20 7468  ile twice.  * th
+00007070: 6973 2069 7320 6f6e 6c79 2074 6f20 7375  is is only to su
+00007080: 7070 6f72 7420 4d53 2d44 4f53 2050 4b5a  pport MS-DOS PKZ
+00007090: 4950 2076 322e 3034 6720 286f 6374 6f62  IP v2.04g (octob
+000070a0: 6572 2031 3939 3329 2061 6e64 206f 6c64  er 1993) and old
+000070b0: 6572 0a20 2020 202a 2068 6f77 2061 7265  er.    * how are
+000070c0: 2079 6f75 2061 6363 6573 7369 6e67 2063   you accessing c
+000070d0: 6f70 7970 6172 7479 2061 6374 7561 6c6c  opyparty actuall
+000070e0: 790a 0a79 6f75 2063 616e 2061 6c73 6f20  y..you can also 
+000070f0: 7a69 7020 6120 7365 6c65 6374 696f 6e20  zip a selection 
+00007100: 6f66 2066 696c 6573 206f 7220 666f 6c64  of files or fold
+00007110: 6572 7320 6279 2063 6c69 636b 696e 6720  ers by clicking 
+00007120: 7468 656d 2069 6e20 7468 6520 6272 6f77  them in the brow
+00007130: 7365 722c 2074 6861 7420 6272 696e 6773  ser, that brings
+00007140: 2075 7020 6120 7365 6c65 6374 696f 6e20   up a selection 
+00007150: 6564 6974 6f72 2061 6e64 207a 6970 2062  editor and zip b
+00007160: 7574 746f 6e20 696e 2074 6865 2062 6f74  utton in the bot
+00007170: 746f 6d20 7269 6768 740a 0a21 5b63 6f70  tom right..![cop
+00007180: 7970 6172 7479 2d7a 6970 7365 6c2d 6673  yparty-zipsel-fs
+00007190: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
+000071a0: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+000071b0: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+000071c0: 3033 322f 3132 3936 3335 3337 342d 6535  032/129635374-e5
+000071d0: 3133 3665 3031 2d34 3730 612d 3439 6231  136e01-470a-49b1
+000071e0: 2d61 3736 322d 3834 3865 3861 3463 3963  -a762-848e8a4c9c
+000071f0: 6463 2e70 6e67 290a 0a0a 2323 2075 706c  dc.png)...## upl
+00007200: 6f61 6469 6e67 0a0a 6472 6167 2066 696c  oading..drag fil
+00007210: 6573 2f66 6f6c 6465 7273 2069 6e74 6f20  es/folders into 
+00007220: 7468 6520 7765 622d 6272 6f77 7365 7220  the web-browser 
+00007230: 746f 2075 706c 6f61 6420 2028 6f72 2075  to upload  (or u
+00007240: 7365 2074 6865 205b 636f 6d6d 616e 642d  se the [command-
+00007250: 6c69 6e65 2075 706c 6f61 6465 725d 2868  line uploader](h
+00007260: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00007270: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+00007280: 2f74 7265 652f 686f 7675 6473 7472 6175  /tree/hovudstrau
+00007290: 6d2f 6269 6e23 7570 326b 7079 2929 0a0a  m/bin#up2kpy))..
+000072a0: 7468 6973 2069 6e69 7469 6174 6573 2061  this initiates a
+000072b0: 6e20 7570 6c6f 6164 2075 7369 6e67 2060  n upload using `
+000072c0: 7570 326b 603b 2074 6865 7265 2061 7265  up2k`; there are
+000072d0: 2074 776f 2075 706c 6f61 6465 7273 2061   two uploaders a
+000072e0: 7661 696c 6162 6c65 3a0a 2a20 605b f09f  vailable:.* `[..
+000072f0: 8e88 5d20 6275 7060 2c20 7468 6520 6261  ..] bup`, the ba
+00007300: 7369 6320 7570 6c6f 6164 6572 2c20 7375  sic uploader, su
+00007310: 7070 6f72 7473 2061 6c6d 6f73 7420 6576  pports almost ev
+00007320: 6572 7920 6272 6f77 7365 7220 7369 6e63  ery browser sinc
+00007330: 6520 6e65 7473 6361 7065 2034 2e30 0a2a  e netscape 4.0.*
+00007340: 2060 5bf0 9f9a 805d 2075 7032 6b60 2c20   `[....] up2k`, 
+00007350: 7468 6520 676f 6f64 202f 2066 616e 6379  the good / fancy
+00007360: 206f 6e65 0a0a 4e42 3a20 796f 7520 6361   one..NB: you ca
+00007370: 6e20 756e 646f 2f64 656c 6574 6520 796f  n undo/delete yo
+00007380: 7572 206f 776e 2075 706c 6f61 6473 2077  ur own uploads w
+00007390: 6974 6820 605b f09f a7af 5d60 205b 756e  ith `[....]` [un
+000073a0: 706f 7374 5d28 2375 6e70 6f73 7429 0a0a  post](#unpost)..
+000073b0: 7570 326b 2068 6173 2073 6576 6572 616c  up2k has several
+000073c0: 2061 6476 616e 7461 6765 733a 0a2a 2079   advantages:.* y
+000073d0: 6f75 2063 616e 2064 726f 7020 666f 6c64  ou can drop fold
+000073e0: 6572 7320 696e 746f 2074 6865 2062 726f  ers into the bro
+000073f0: 7773 6572 2028 6669 6c65 7320 6172 6520  wser (files are 
+00007400: 6164 6465 6420 7265 6375 7273 6976 656c  added recursivel
+00007410: 7929 0a2a 2066 696c 6573 2061 7265 2070  y).* files are p
+00007420: 726f 6365 7373 6564 2069 6e20 6368 756e  rocessed in chun
+00007430: 6b73 2c20 616e 6420 6561 6368 2063 6875  ks, and each chu
+00007440: 6e6b 2069 7320 6368 6563 6b73 756d 6d65  nk is checksumme
+00007450: 640a 2020 2a20 7570 6c6f 6164 7320 6175  d.  * uploads au
+00007460: 746f 7265 7375 6d65 2069 6620 7468 6579  toresume if they
+00007470: 2061 7265 2069 6e74 6572 7275 7074 6564   are interrupted
+00007480: 2062 7920 6e65 7477 6f72 6b20 6973 7375   by network issu
+00007490: 6573 0a20 202a 2075 706c 6f61 6473 2072  es.  * uploads r
+000074a0: 6573 756d 6520 6966 2079 6f75 2072 6562  esume if you reb
+000074b0: 6f6f 7420 796f 7572 2062 726f 7773 6572  oot your browser
+000074c0: 206f 7220 7063 2c20 6a75 7374 2075 706c   or pc, just upl
+000074d0: 6f61 6420 7468 6520 7361 6d65 2066 696c  oad the same fil
+000074e0: 6573 2061 6761 696e 0a20 202a 2073 6572  es again.  * ser
+000074f0: 7665 7220 6465 7465 6374 7320 616e 7920  ver detects any 
+00007500: 636f 7272 7570 7469 6f6e 3b20 7468 6520  corruption; the 
+00007510: 636c 6965 6e74 2072 6575 706c 6f61 6473  client reuploads
+00007520: 2061 6666 6563 7465 6420 6368 756e 6b73   affected chunks
+00007530: 0a20 202a 2074 6865 2063 6c69 656e 7420  .  * the client 
+00007540: 646f 6573 6e27 7420 7570 6c6f 6164 2061  doesn't upload a
+00007550: 6e79 7468 696e 6720 7468 6174 2061 6c72  nything that alr
+00007560: 6561 6479 2065 7869 7374 7320 6f6e 2074  eady exists on t
+00007570: 6865 2073 6572 7665 720a 2a20 6d75 6368  he server.* much
+00007580: 2068 6967 6865 7220 7370 6565 6473 2074   higher speeds t
+00007590: 6861 6e20 6674 702f 7363 702f 7461 7270  han ftp/scp/tarp
+000075a0: 6970 6520 6f6e 2073 6f6d 6520 696e 7465  ipe on some inte
+000075b0: 726e 6574 2063 6f6e 6e65 6374 696f 6e73  rnet connections
+000075c0: 2028 6d61 696e 6c79 2061 6d65 7269 6361   (mainly america
+000075d0: 6e20 6f6e 6573 2920 7468 616e 6b73 2074  n ones) thanks t
+000075e0: 6f20 7061 7261 6c6c 656c 2063 6f6e 6e65  o parallel conne
+000075f0: 6374 696f 6e73 0a2a 2074 6865 206c 6173  ctions.* the las
+00007600: 742d 6d6f 6469 6669 6564 2074 696d 6573  t-modified times
+00007610: 7461 6d70 206f 6620 7468 6520 6669 6c65  tamp of the file
+00007620: 2069 7320 7072 6573 6572 7665 640a 0a3e   is preserved..>
+00007630: 2069 7420 6973 2070 6572 6665 6374 6c79   it is perfectly
+00007640: 2073 6166 6520 746f 2072 6573 7461 7274   safe to restart
+00007650: 202f 2075 7067 7261 6465 2063 6f70 7970   / upgrade copyp
+00007660: 6172 7479 2077 6869 6c65 2073 6f6d 656f  arty while someo
+00007670: 6e65 2069 7320 7570 6c6f 6164 696e 6720  ne is uploading 
+00007680: 746f 2069 7421 2020 0a3e 2061 6c6c 206b  to it!  .> all k
+00007690: 6e6f 776e 2075 7032 6b20 636c 6965 6e74  nown up2k client
+000076a0: 7320 7769 6c6c 2072 6573 756d 6520 6a75  s will resume ju
+000076b0: 7374 2066 696e 6520 f09f 92aa 0a0a 7365  st fine ......se
+000076c0: 6520 5b75 7032 6b5d 2823 7570 326b 2920  e [up2k](#up2k) 
+000076d0: 666f 7220 6465 7461 696c 7320 6f6e 2068  for details on h
+000076e0: 6f77 2069 7420 776f 726b 732c 206f 7220  ow it works, or 
+000076f0: 7761 7463 6820 6120 5b64 656d 6f20 7669  watch a [demo vi
+00007700: 6465 6f5d 2868 7474 7073 3a2f 2f61 2e6f  deo](https://a.o
+00007710: 6376 2e6d 652f 7075 622f 6465 6d6f 2f70  cv.me/pub/demo/p
+00007720: 6963 732d 7669 6473 2f23 6766 2d30 6636  ics-vids/#gf-0f6
+00007730: 6635 6330 6429 0a0a 215b 636f 7079 7061  f5c0d)..![copypa
+00007740: 7274 792d 7570 6c6f 6164 2d66 7338 5d28  rty-upload-fs8](
+00007750: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
+00007760: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
+00007770: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
+00007780: 2f31 3239 3633 3533 3731 2d34 3866 6335  /129635371-48fc5
+00007790: 3463 612d 6661 3931 2d34 3865 332d 3962  4ca-fa91-48e3-9b
+000077a0: 3164 2d62 6134 3133 6534 6236 3863 622e  1d-ba413e4b68cb.
+000077b0: 706e 6729 0a0a 2a2a 7072 6f74 6970 3a2a  png)..**protip:*
+000077c0: 2a20 796f 7520 6361 6e20 6176 6f69 6420  * you can avoid 
+000077d0: 7363 6172 696e 6720 6177 6179 2075 7365  scaring away use
+000077e0: 7273 2077 6974 6820 5b63 6f6e 7472 6962  rs with [contrib
+000077f0: 2f70 6c75 6769 6e73 2f6d 696e 696d 616c  /plugins/minimal
+00007800: 2d75 7032 6b2e 6a73 5d28 636f 6e74 7269  -up2k.js](contri
+00007810: 622f 706c 7567 696e 732f 6d69 6e69 6d61  b/plugins/minima
+00007820: 6c2d 7570 326b 2e6a 7329 2077 6869 6368  l-up2k.js) which
+00007830: 206d 616b 6573 2069 7420 6c6f 6f6b 205b   makes it look [
+00007840: 6d75 6368 2073 696d 706c 6572 5d28 6874  much simpler](ht
+00007850: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+00007860: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+00007870: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+00007880: 3138 3331 3131 3935 2d64 6436 6361 3338  18311195-dd6ca38
+00007890: 302d 6234 6566 2d31 3165 622d 3836 6633  0-b4ef-11eb-86f3
+000078a0: 2d37 3561 3366 6632 6531 3333 322e 706e  -75a3ff2e1332.pn
+000078b0: 6729 0a0a 2a2a 7072 6f74 6970 3a2a 2a20  g)..**protip:** 
+000078c0: 6966 2079 6f75 2065 6e61 626c 6520 6066  if you enable `f
+000078d0: 6176 6963 6f6e 6020 696e 2074 6865 2060  avicon` in the `
+000078e0: 5be2 9a99 efb8 8f5d 2073 6574 7469 6e67  [......] setting
+000078f0: 7360 2074 6162 2028 6279 2074 7970 696e  s` tab (by typin
+00007900: 6720 736f 6d65 7468 696e 6720 696e 746f  g something into
+00007910: 2074 6865 2074 6578 7462 6f78 292c 2074   the textbox), t
+00007920: 6865 2069 636f 6e20 696e 2074 6865 2062  he icon in the b
+00007930: 726f 7773 6572 2074 6162 2077 696c 6c20  rowser tab will 
+00007940: 696e 6469 6361 7465 2075 706c 6f61 6420  indicate upload 
+00007950: 7072 6f67 7265 7373 202d 2d20 616c 736f  progress -- also
+00007960: 2c20 7468 6520 605b f09f 9494 5d60 2061  , the `[....]` a
+00007970: 6e64 2f6f 7220 605b f09f 948a 5d60 2073  nd/or `[....]` s
+00007980: 7769 7463 6865 7320 656e 6162 6c65 2076  witches enable v
+00007990: 6973 6962 6c65 2061 6e64 2f6f 7220 6175  isible and/or au
+000079a0: 6469 626c 6520 6e6f 7469 6669 6361 7469  dible notificati
+000079b0: 6f6e 7320 6f6e 2075 706c 6f61 6420 636f  ons on upload co
+000079c0: 6d70 6c65 7469 6f6e 0a0a 7468 6520 7570  mpletion..the up
+000079d0: 326b 2055 4920 6973 2074 6865 2065 7069  2k UI is the epi
+000079e0: 746f 6d65 206f 6620 706f 6c69 7368 6564  tome of polished
+000079f0: 2069 6e75 7469 7469 7665 2065 7870 6572   inutitive exper
+00007a00: 6965 6e63 6573 3a0a 2a20 2270 6172 616c  iences:.* "paral
+00007a10: 6c65 6c20 7570 6c6f 6164 7322 2073 7065  lel uploads" spe
+00007a20: 6369 6669 6573 2068 6f77 206d 616e 7920  cifies how many 
+00007a30: 6368 756e 6b73 2074 6f20 7570 6c6f 6164  chunks to upload
+00007a40: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00007a50: 650a 2a20 605b f09f 8f83 5d60 2061 6e61  e.* `[....]` ana
+00007a60: 6c79 7369 7320 6f66 206f 7468 6572 2066  lysis of other f
+00007a70: 696c 6573 2073 686f 756c 6420 636f 6e74  iles should cont
+00007a80: 696e 7565 2077 6869 6c65 206f 6e65 2069  inue while one i
+00007a90: 7320 7570 6c6f 6164 696e 670a 2a20 605b  s uploading.* `[
+00007aa0: f09f a594 5d60 2073 686f 7773 2061 2073  ....]` shows a s
+00007ab0: 696d 706c 6572 2055 4920 666f 7220 6661  impler UI for fa
+00007ac0: 7374 6572 2075 706c 6f61 6473 2066 726f  ster uploads fro
+00007ad0: 6d20 736c 6f77 2064 6576 6963 6573 0a2a  m slow devices.*
+00007ae0: 2060 5bf0 9f92 ad5d 6020 6173 6b20 666f   `[....]` ask fo
+00007af0: 7220 636f 6e66 6972 6d61 7469 6f6e 2062  r confirmation b
+00007b00: 6566 6f72 6520 6669 6c65 7320 6172 6520  efore files are 
+00007b10: 6164 6465 6420 746f 2074 6865 2071 7565  added to the que
+00007b20: 7565 0a2a 2060 5bf0 9f94 8e5d 6020 7377  ue.* `[....]` sw
+00007b30: 6974 6368 2062 6574 7765 656e 2075 706c  itch between upl
+00007b40: 6f61 6420 616e 6420 5b66 696c 652d 7365  oad and [file-se
+00007b50: 6172 6368 5d28 2366 696c 652d 7365 6172  arch](#file-sear
+00007b60: 6368 2920 6d6f 6465 0a20 202a 2069 676e  ch) mode.  * ign
+00007b70: 6f72 6520 605b f09f 948e 5d60 2069 6620  ore `[....]` if 
+00007b80: 796f 7520 6164 6420 6669 6c65 7320 6279  you add files by
+00007b90: 2064 7261 6767 696e 6720 7468 656d 2069   dragging them i
+00007ba0: 6e74 6f20 7468 6520 6272 6f77 7365 720a  nto the browser.
+00007bb0: 0a61 6e64 2074 6865 6e20 7468 6572 6573  .and then theres
+00007bc0: 2074 6865 2074 6162 7320 6265 6c6f 7720   the tabs below 
+00007bd0: 6974 2c0a 2a20 605b 6f6b 5d60 2069 7320  it,.* `[ok]` is 
+00007be0: 7468 6520 6669 6c65 7320 7768 6963 6820  the files which 
+00007bf0: 636f 6d70 6c65 7465 6420 7375 6363 6573  completed succes
+00007c00: 7366 756c 6c79 0a2a 2060 5b6e 675d 6020  sfully.* `[ng]` 
+00007c10: 6973 2074 6865 206f 6e65 7320 7468 6174  is the ones that
+00007c20: 2066 6169 6c65 6420 2f20 676f 7420 7265   failed / got re
+00007c30: 6a65 6374 6564 2028 616c 7265 6164 7920  jected (already 
+00007c40: 6578 6973 7473 2c20 2e2e 2e29 0a2a 2060  exists, ...).* `
+00007c50: 5b64 6f6e 655d 6020 7368 6f77 7320 6120  [done]` shows a 
+00007c60: 636f 6d62 696e 6564 206c 6973 7420 6f66  combined list of
+00007c70: 2060 5b6f 6b5d 6020 616e 6420 605b 6e67   `[ok]` and `[ng
+00007c80: 5d60 2c20 6368 726f 6e6f 6c6f 6769 6361  ]`, chronologica
+00007c90: 6c20 6f72 6465 720a 2a20 605b 6275 7379  l order.* `[busy
+00007ca0: 5d60 2066 696c 6573 2077 6869 6368 2061  ]` files which a
+00007cb0: 7265 2063 7572 7265 6e74 6c79 2068 6173  re currently has
+00007cc0: 6869 6e67 2c20 7065 6e64 696e 672d 7570  hing, pending-up
+00007cd0: 6c6f 6164 2c20 6f72 2075 706c 6f61 6469  load, or uploadi
+00007ce0: 6e67 0a20 202a 2070 6c75 7320 7570 2074  ng.  * plus up t
+00007cf0: 6f20 3320 656e 7472 6965 7320 6561 6368  o 3 entries each
+00007d00: 2066 726f 6d20 605b 646f 6e65 5d60 2061   from `[done]` a
+00007d10: 6e64 2060 5b71 7565 5d60 2066 6f72 2063  nd `[que]` for c
+00007d20: 6f6e 7465 7874 0a2a 2060 5b71 7565 5d60  ontext.* `[que]`
+00007d30: 2069 7320 616c 6c20 7468 6520 6669 6c65   is all the file
+00007d40: 7320 7468 6174 2061 7265 2073 7469 6c6c  s that are still
+00007d50: 2071 7565 7565 640a 0a6e 6f74 6520 7468   queued..note th
+00007d60: 6174 2073 696e 6365 2075 7032 6b20 6861  at since up2k ha
+00007d70: 7320 746f 2072 6561 6420 6561 6368 2066  s to read each f
+00007d80: 696c 6520 7477 6963 652c 2060 5bf0 9f8e  ile twice, `[...
+00007d90: 885d 2062 7570 6020 6361 6e20 2a74 6865  .] bup` can *the
+00007da0: 6f72 6574 6963 616c 6c79 2a20 6265 2075  oretically* be u
+00007db0: 7020 746f 2032 7820 6661 7374 6572 2069  p to 2x faster i
+00007dc0: 6e20 736f 6d65 2065 7874 7265 6d65 2063  n some extreme c
+00007dd0: 6173 6573 2028 6669 6c65 7320 6269 6767  ases (files bigg
+00007de0: 6572 2074 6861 6e20 796f 7572 2072 616d  er than your ram
+00007df0: 2c20 636f 6d62 696e 6564 2077 6974 6820  , combined with 
+00007e00: 616e 2069 6e74 6572 6e65 7420 636f 6e6e  an internet conn
+00007e10: 6563 7469 6f6e 2066 6173 7465 7220 7468  ection faster th
+00007e20: 616e 2074 6865 2072 6561 642d 7370 6565  an the read-spee
+00007e30: 6420 6f66 2079 6f75 7220 4844 442c 206f  d of your HDD, o
+00007e40: 7220 6966 2079 6f75 2772 6520 7570 6c6f  r if you're uplo
+00007e50: 6164 696e 6720 6672 6f6d 2061 2063 756f  ading from a cuo
+00007e60: 3264 756f 290a 0a69 6620 796f 7520 6172  2duo)..if you ar
+00007e70: 6520 7265 7375 6d69 6e67 2061 206d 6173  e resuming a mas
+00007e80: 7369 7665 2075 706c 6f61 6420 616e 6420  sive upload and 
+00007e90: 7761 6e74 2074 6f20 736b 6970 2068 6173  want to skip has
+00007ea0: 6869 6e67 2074 6865 2066 696c 6573 2077  hing the files w
+00007eb0: 6869 6368 2061 6c72 6561 6479 2066 696e  hich already fin
+00007ec0: 6973 6865 642c 2079 6f75 2063 616e 2065  ished, you can e
+00007ed0: 6e61 626c 6520 6074 7572 626f 6020 696e  nable `turbo` in
+00007ee0: 2074 6865 2060 5be2 9a99 efb8 8f5d 2063   the `[......] c
+00007ef0: 6f6e 6669 6760 2074 6162 2c20 6275 7420  onfig` tab, but 
+00007f00: 706c 6561 7365 2072 6561 6420 7468 6520  please read the 
+00007f10: 746f 6f6c 7469 7020 6f6e 2074 6861 7420  tooltip on that 
+00007f20: 6275 7474 6f6e 0a0a 0a23 2323 2066 696c  button...### fil
+00007f30: 652d 7365 6172 6368 0a0a 6472 6f70 7069  e-search..droppi
+00007f40: 6e67 2066 696c 6573 2069 6e74 6f20 7468  ng files into th
+00007f50: 6520 6272 6f77 7365 7220 616c 736f 206c  e browser also l
+00007f60: 6574 7320 796f 7520 7365 6520 6966 2074  ets you see if t
+00007f70: 6865 7920 6578 6973 7420 6f6e 2074 6865  hey exist on the
+00007f80: 2073 6572 7665 720a 0a21 5b63 6f70 7970   server..![copyp
+00007f90: 6172 7479 2d66 7365 6172 6368 2d66 7338  arty-fsearch-fs8
+00007fa0: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00007fb0: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00007fc0: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00007fd0: 3332 2f31 3239 3633 3533 3631 2d63 3739  32/129635361-c79
+00007fe0: 3238 3666 302d 6238 6631 2d34 3430 652d  286f0-b8f1-440e-
+00007ff0: 6161 6634 2d36 6539 3239 3432 3866 6163  aaf4-6e929428fac
+00008000: 392e 706e 6729 0a0a 7768 656e 2079 6f75  9.png)..when you
+00008010: 2064 7261 672f 6472 6f70 2066 696c 6573   drag/drop files
+00008020: 2069 6e74 6f20 7468 6520 6272 6f77 7365   into the browse
+00008030: 722c 2079 6f75 2077 696c 6c20 7365 6520  r, you will see 
+00008040: 7477 6f20 6472 6f70 7a6f 6e65 733a 2060  two dropzones: `
+00008050: 5570 6c6f 6164 6020 616e 6420 6053 6561  Upload` and `Sea
+00008060: 7263 6860 0a0a 3e20 6f6e 2061 2070 686f  rch`..> on a pho
+00008070: 6e65 3f20 746f 6767 6c65 2074 6865 2060  ne? toggle the `
+00008080: 5bf0 9f94 8e5d 6020 7377 6974 6368 2067  [....]` switch g
+00008090: 7265 656e 2062 6566 6f72 6520 7461 7070  reen before tapp
+000080a0: 696e 6720 7468 6520 6269 6720 7965 6c6c  ing the big yell
+000080b0: 6f77 2053 6561 7263 6820 6275 7474 6f6e  ow Search button
+000080c0: 2074 6f20 7365 6c65 6374 2079 6f75 7220   to select your 
+000080d0: 6669 6c65 730a 0a74 6865 2066 696c 6573  files..the files
+000080e0: 2077 696c 6c20 6265 2068 6173 6865 6420   will be hashed 
+000080f0: 6f6e 2074 6865 2063 6c69 656e 742d 7369  on the client-si
+00008100: 6465 2c20 616e 6420 6561 6368 2068 6173  de, and each has
+00008110: 6820 6973 2073 656e 7420 746f 2074 6865  h is sent to the
+00008120: 2073 6572 7665 722c 2077 6869 6368 2063   server, which c
+00008130: 6865 636b 7320 6966 2074 6861 7420 6669  hecks if that fi
+00008140: 6c65 2065 7869 7374 7320 736f 6d65 7768  le exists somewh
+00008150: 6572 650a 0a66 696c 6573 2067 6f20 696e  ere..files go in
+00008160: 746f 2060 5b6f 6b5d 6020 6966 2074 6865  to `[ok]` if the
+00008170: 7920 6578 6973 7420 2861 6e64 2079 6f75  y exist (and you
+00008180: 2067 6574 2061 206c 696e 6b20 746f 2077   get a link to w
+00008190: 6865 7265 2069 7420 6973 292c 206f 7468  here it is), oth
+000081a0: 6572 7769 7365 2074 6865 7920 6c61 6e64  erwise they land
+000081b0: 2069 6e20 605b 6e67 5d60 0a2a 2074 6865   in `[ng]`.* the
+000081c0: 206d 6169 6e20 7265 6173 6f6e 2066 696c   main reason fil
+000081d0: 6573 6561 7263 6820 6973 2063 6f6d 6269  esearch is combi
+000081e0: 6e65 6420 7769 7468 2074 6865 2075 706c  ned with the upl
+000081f0: 6f61 6465 7220 6973 2063 6175 7365 2074  oader is cause t
+00008200: 6865 2063 6f64 6520 7761 7320 746f 6f20  he code was too 
+00008210: 7370 6167 6865 7474 6920 746f 2073 6570  spaghetti to sep
+00008220: 6172 6174 6520 6974 206f 7574 2073 6f6d  arate it out som
+00008230: 6577 6865 7265 2065 6c73 652c 2074 6869  ewhere else, thi
+00008240: 7320 6973 206e 6f20 6c6f 6e67 6572 2074  s is no longer t
+00008250: 6865 2063 6173 6520 6275 7420 6e6f 7720  he case but now 
+00008260: 6927 7665 2077 6172 6d65 6420 7570 2074  i've warmed up t
+00008270: 6f20 7468 6520 6964 6561 2074 6f6f 206d  o the idea too m
+00008280: 7563 680a 0a0a 2323 2320 756e 706f 7374  uch...### unpost
+00008290: 0a0a 756e 646f 2f64 656c 6574 6520 6163  ..undo/delete ac
+000082a0: 6369 6465 6e74 616c 2075 706c 6f61 6473  cidental uploads
+000082b0: 0a0a 215b 636f 7079 7061 7274 792d 756e  ..![copyparty-un
+000082c0: 706f 7374 2d66 7338 5d28 6874 7470 733a  post-fs8](https:
+000082d0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000082e0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000082f0: 636f 6d2f 3234 3130 3332 2f31 3239 3633  com/241032/12963
+00008300: 3533 3638 2d33 6166 6136 3633 342d 6332  5368-3afa6634-c2
+00008310: 3066 2d34 3138 632d 3930 6463 2d65 6334  0f-418c-90dc-ec4
+00008320: 3131 6633 6233 3839 372e 706e 6729 0a0a  11f3b3897.png)..
+00008330: 796f 7520 6361 6e20 756e 706f 7374 2065  you can unpost e
+00008340: 7665 6e20 6966 2079 6f75 2064 6f6e 2774  ven if you don't
+00008350: 2068 6176 6520 7265 6775 6c61 7220 6d6f   have regular mo
+00008360: 7665 2f64 656c 6574 6520 6163 6365 7373  ve/delete access
+00008370: 2c20 686f 7765 7665 7220 6f6e 6c79 2066  , however only f
+00008380: 6f72 2066 696c 6573 2075 706c 6f61 6465  or files uploade
+00008390: 6420 7769 7468 696e 2074 6865 2070 6173  d within the pas
+000083a0: 7420 602d 2d75 6e70 6f73 7460 2073 6563  t `--unpost` sec
+000083b0: 6f6e 6473 2028 6465 6661 756c 7420 3132  onds (default 12
+000083c0: 2068 6f75 7273 2920 616e 6420 7468 6520   hours) and the 
+000083d0: 7365 7276 6572 206d 7573 7420 6265 2072  server must be r
+000083e0: 756e 6e69 6e67 2077 6974 6820 602d 6532  unning with `-e2
+000083f0: 6460 0a0a 0a23 2323 2073 656c 662d 6465  d`...### self-de
+00008400: 7374 7275 6374 0a0a 7570 6c6f 6164 7320  struct..uploads 
+00008410: 6361 6e20 6265 2067 6976 656e 2061 206c  can be given a l
+00008420: 6966 6574 696d 652c 2020 6166 6572 2077  ifetime,  afer w
+00008430: 6869 6368 2074 6865 7920 6578 7069 7265  hich they expire
+00008440: 202f 2073 656c 662d 6465 7374 7275 6374   / self-destruct
+00008450: 0a0a 7468 6520 6665 6174 7572 6520 6d75  ..the feature mu
+00008460: 7374 2062 6520 656e 6162 6c65 6420 7065  st be enabled pe
+00008470: 722d 766f 6c75 6d65 2077 6974 6820 7468  r-volume with th
+00008480: 6520 606c 6966 6574 696d 6560 205b 7570  e `lifetime` [up
+00008490: 6c6f 6164 2072 756c 655d 2823 7570 6c6f  load rule](#uplo
+000084a0: 6164 2d72 756c 6573 2920 7768 6963 6820  ad-rules) which 
+000084b0: 7365 7473 2074 6865 2075 7070 6572 206c  sets the upper l
+000084c0: 696d 6974 2066 6f72 2068 6f77 206c 6f6e  imit for how lon
+000084d0: 6720 6120 6669 6c65 2067 6574 7320 746f  g a file gets to
+000084e0: 2073 7461 7920 6f6e 2074 6865 2073 6572   stay on the ser
+000084f0: 7665 720a 0a63 6c69 656e 7473 2063 616e  ver..clients can
+00008500: 2073 7065 6369 6679 2061 2073 686f 7274   specify a short
+00008510: 6572 2065 7870 6972 6174 696f 6e20 7469  er expiration ti
+00008520: 6d65 2075 7369 6e67 2074 6865 205b 7570  me using the [up
+00008530: 326b 2075 695d 2823 7570 6c6f 6164 696e  2k ui](#uploadin
+00008540: 6729 202d 2d20 7468 6520 7265 6c65 7661  g) -- the releva
+00008550: 6e74 206f 7074 696f 6e73 2062 6563 6f6d  nt options becom
+00008560: 6520 7669 7369 626c 6520 7570 6f6e 206e  e visible upon n
+00008570: 6176 6967 6174 696e 6720 696e 746f 2061  avigating into a
+00008580: 2066 6f6c 6465 7220 7769 7468 2060 6c69   folder with `li
+00008590: 6665 7469 6d65 7360 2065 6e61 626c 6564  fetimes` enabled
+000085a0: 202d 2d20 6f72 2062 7920 7573 696e 6720   -- or by using 
+000085b0: 7468 6520 606c 6966 6560 205b 7570 6c6f  the `life` [uplo
+000085c0: 6164 206d 6f64 6966 6965 725d 2823 7772  ad modifier](#wr
+000085d0: 6974 6529 0a0a 7370 6563 6966 7969 6e67  ite)..specifying
+000085e0: 2061 2063 7573 746f 6d20 6578 7069 7261   a custom expira
+000085f0: 7469 6f6e 2074 696d 6520 636c 6965 6e74  tion time client
+00008600: 2d73 6964 6520 7769 6c6c 2061 6666 6563  -side will affec
+00008610: 7420 7468 6520 7469 6d65 7370 616e 2069  t the timespan i
+00008620: 6e20 7768 6963 6820 756e 706f 7374 7320  n which unposts 
+00008630: 6172 6520 7065 726d 6974 7465 642c 2073  are permitted, s
+00008640: 6f20 6b65 6570 2061 6e20 6579 6520 6f6e  o keep an eye on
+00008650: 2074 6865 2065 7374 696d 6174 6573 2069   the estimates i
+00008660: 6e20 7468 6520 7570 326b 2075 690a 0a0a  n the up2k ui...
+00008670: 2323 2066 696c 6520 6d61 6e61 6765 720a  ## file manager.
+00008680: 0a63 7574 2f70 6173 7465 2c20 7265 6e61  .cut/paste, rena
+00008690: 6d65 2c20 616e 6420 6465 6c65 7465 2066  me, and delete f
+000086a0: 696c 6573 2f66 6f6c 6465 7273 2028 6966  iles/folders (if
+000086b0: 2079 6f75 2068 6176 6520 7065 726d 6973   you have permis
+000086c0: 7369 6f6e 290a 0a66 696c 6520 7365 6c65  sion)..file sele
+000086d0: 6374 696f 6e3a 2063 6c69 636b 2073 6f6d  ction: click som
+000086e0: 6577 6865 7265 206f 6e20 7468 6520 6c69  ewhere on the li
+000086f0: 6e65 2028 6e6f 7420 7468 6520 6c69 6e6b  ne (not the link
+00008700: 2069 7473 6566 292c 2074 6865 6e3a 0a2a   itsef), then:.*
+00008710: 2060 7370 6163 6560 2074 6f20 746f 6767   `space` to togg
+00008720: 6c65 0a2a 2060 7570 2f64 6f77 6e60 2074  le.* `up/down` t
+00008730: 6f20 6d6f 7665 0a2a 2060 7368 6966 742d  o move.* `shift-
+00008740: 7570 2f64 6f77 6e60 2074 6f20 6d6f 7665  up/down` to move
+00008750: 2d61 6e64 2d73 656c 6563 740a 2a20 6063  -and-select.* `c
+00008760: 7472 6c2d 7368 6966 742d 7570 2f64 6f77  trl-shift-up/dow
+00008770: 6e60 2074 6f20 616c 736f 2073 6372 6f6c  n` to also scrol
+00008780: 6c0a 0a2a 2063 7574 3a20 7365 6c65 6374  l..* cut: select
+00008790: 2073 6f6d 6520 6669 6c65 7320 616e 6420   some files and 
+000087a0: 6063 7472 6c2d 7860 0a2a 2070 6173 7465  `ctrl-x`.* paste
+000087b0: 3a20 6063 7472 6c2d 7660 2069 6e20 616e  : `ctrl-v` in an
+000087c0: 6f74 6865 7220 666f 6c64 6572 0a2a 2072  other folder.* r
+000087d0: 656e 616d 653a 2060 4632 600a 0a79 6f75  ename: `F2`..you
+000087e0: 2063 616e 206d 6f76 6520 6669 6c65 7320   can move files 
+000087f0: 6163 726f 7373 2062 726f 7773 6572 2074  across browser t
+00008800: 6162 7320 2863 7574 2069 6e20 6f6e 6520  abs (cut in one 
+00008810: 7461 622c 2070 6173 7465 2069 6e20 616e  tab, paste in an
+00008820: 6f74 6865 7229 0a0a 0a23 2320 6261 7463  other)...## batc
+00008830: 6820 7265 6e61 6d65 0a0a 7365 6c65 6374  h rename..select
+00008840: 2073 6f6d 6520 6669 6c65 7320 616e 6420   some files and 
+00008850: 7072 6573 7320 6046 3260 2074 6f20 6272  press `F2` to br
+00008860: 696e 6720 7570 2074 6865 2072 656e 616d  ing up the renam
+00008870: 6520 5549 0a0a 215b 6261 7463 682d 7265  e UI..![batch-re
+00008880: 6e61 6d65 2d66 7338 5d28 6874 7470 733a  name-fs8](https:
+00008890: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000088a0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000088b0: 636f 6d2f 3234 3130 3332 2f31 3238 3433  com/241032/12843
+000088c0: 3432 3034 2d65 6231 3336 3638 302d 3363  4204-eb136680-3c
+000088d0: 3037 2d34 6563 372d 3932 6530 2d61 6538  07-4ec7-92e0-ae8
+000088e0: 3661 6632 3063 3234 312e 706e 6729 0a0a  6af20c241.png)..
+000088f0: 7175 6963 6b20 6578 706c 616e 6174 696f  quick explanatio
+00008900: 6e20 6f66 2074 6865 2062 7574 746f 6e73  n of the buttons
+00008910: 2c20 200a 2a20 605b e29c 8520 6170 706c  ,  .* `[... appl
+00008920: 7920 7265 6e61 6d65 5d60 2063 6f6e 6669  y rename]` confi
+00008930: 726d 7320 616e 6420 6265 6769 6e73 2072  rms and begins r
+00008940: 656e 616d 696e 670a 2a20 605b e29d 8c20  enaming.* `[... 
+00008950: 6361 6e63 656c 5d60 2061 626f 7274 7320  cancel]` aborts 
+00008960: 616e 6420 636c 6f73 6573 2074 6865 2072  and closes the r
+00008970: 656e 616d 6520 7769 6e64 6f77 0a2a 2060  ename window.* `
+00008980: 5be2 86ba 2072 6573 6574 5d60 2072 6576  [... reset]` rev
+00008990: 6572 7473 2061 6e79 2066 696c 656e 616d  erts any filenam
+000089a0: 6520 6368 616e 6765 7320 6261 636b 2074  e changes back t
+000089b0: 6f20 7468 6520 6f72 6967 696e 616c 206e  o the original n
+000089c0: 616d 650a 2a20 605b 6465 636f 6465 5d60  ame.* `[decode]`
+000089d0: 2064 6f65 7320 6120 5552 4c2d 6465 636f   does a URL-deco
+000089e0: 6465 206f 6e20 7468 6520 6669 6c65 6e61  de on the filena
+000089f0: 6d65 2c20 6669 7869 6e67 2073 7475 6666  me, fixing stuff
+00008a00: 206c 696b 6520 6026 616d 703b 6020 616e   like `&amp;` an
+00008a10: 6420 6025 3230 600a 2a20 605b 6164 7661  d `%20`.* `[adva
+00008a20: 6e63 6564 5d60 2074 6f67 676c 6573 2061  nced]` toggles a
+00008a30: 6476 616e 6365 6420 6d6f 6465 0a0a 6164  dvanced mode..ad
+00008a40: 7661 6e63 6564 206d 6f64 653a 2072 656e  vanced mode: ren
+00008a50: 616d 6520 6669 6c65 7320 6261 7365 6420  ame files based 
+00008a60: 6f6e 2072 756c 6573 2074 6f20 6465 6369  on rules to deci
+00008a70: 6465 2074 6865 206e 6577 206e 616d 6573  de the new names
+00008a80: 2c20 6261 7365 6420 6f6e 2074 6865 206f  , based on the o
+00008a90: 7269 6769 6e61 6c20 6e61 6d65 2028 7265  riginal name (re
+00008aa0: 6765 7829 2c20 6f72 2062 6173 6564 206f  gex), or based o
+00008ab0: 6e20 7468 6520 7461 6773 2063 6f6c 6c65  n the tags colle
+00008ac0: 6374 6564 2066 726f 6d20 7468 6520 6669  cted from the fi
+00008ad0: 6c65 2028 6172 7469 7374 2f74 6974 6c65  le (artist/title
+00008ae0: 2f2e 2e2e 292c 206f 7220 6120 6d69 7820  /...), or a mix 
+00008af0: 6f66 2062 6f74 680a 0a69 6e20 6164 7661  of both..in adva
+00008b00: 6e63 6564 206d 6f64 652c 2020 0a2a 2060  nced mode,  .* `
+00008b10: 5b63 6173 655d 6020 746f 6767 6c65 7320  [case]` toggles 
+00008b20: 6361 7365 2d73 656e 7369 7469 7665 2072  case-sensitive r
+00008b30: 6567 6578 0a2a 2060 7265 6765 7860 2069  egex.* `regex` i
+00008b40: 7320 7468 6520 7265 6765 7820 7061 7474  s the regex patt
+00008b50: 6572 6e20 746f 2061 7070 6c79 2074 6f20  ern to apply to 
+00008b60: 7468 6520 6f72 6967 696e 616c 2066 696c  the original fil
+00008b70: 656e 616d 653b 2061 6e79 2066 696c 6573  ename; any files
+00008b80: 2077 6869 6368 2064 6f6e 2774 206d 6174   which don't mat
+00008b90: 6368 2077 696c 6c20 6265 2073 6b69 7070  ch will be skipp
+00008ba0: 6564 0a2a 2060 666f 726d 6174 6020 6973  ed.* `format` is
+00008bb0: 2074 6865 206e 6577 2066 696c 656e 616d   the new filenam
+00008bc0: 652c 2074 616b 696e 6720 7661 6c75 6573  e, taking values
+00008bd0: 2066 726f 6d20 7265 6765 7820 6361 7074   from regex capt
+00008be0: 7572 696e 6720 6772 6f75 7073 2061 6e64  uring groups and
+00008bf0: 2f6f 7220 6672 6f6d 2066 696c 6520 7461  /or from file ta
+00008c00: 6773 0a20 202a 2076 6572 7920 6c6f 6f73  gs.  * very loos
+00008c10: 656c 7920 6261 7365 6420 6f6e 2066 6f6f  ely based on foo
+00008c20: 6261 7232 3030 3020 7379 6e74 6178 0a2a  bar2000 syntax.*
+00008c30: 2060 7072 6573 6574 7360 206c 6574 7320   `presets` lets 
+00008c40: 796f 7520 7361 7665 2072 656e 616d 6520  you save rename 
+00008c50: 7275 6c65 7320 666f 7220 6c61 7465 720a  rules for later.
+00008c60: 0a61 7661 696c 6162 6c65 2066 756e 6374  .available funct
+00008c70: 696f 6e73 3a0a 2a20 6024 6c70 6164 2874  ions:.* `$lpad(t
+00008c80: 6578 742c 206c 656e 6774 682c 2070 6164  ext, length, pad
+00008c90: 5f63 6861 7229 600a 2a20 6024 7270 6164  _char)`.* `$rpad
+00008ca0: 2874 6578 742c 206c 656e 6774 682c 2070  (text, length, p
+00008cb0: 6164 5f63 6861 7229 600a 0a73 6f2c 0a0a  ad_char)`..so,..
+00008cc0: 7361 7920 796f 7520 6861 7665 2061 2066  say you have a f
+00008cd0: 696c 6520 6e61 6d65 6420 5b60 6d65 6761  ile named [`mega
+00008ce0: 6e65 6b6f 202d 2045 636c 6970 7365 202d  neko - Eclipse -
+00008cf0: 2030 3720 5369 7269 7573 2041 2e6d 7033   07 Sirius A.mp3
+00008d00: 605d 2868 7474 7073 3a2f 2f77 7777 2e79  `](https://www.y
+00008d10: 6f75 7475 6265 2e63 6f6d 2f77 6174 6368  outube.com/watch
+00008d20: 3f76 3d2d 6474 6230 7644 5072 7549 2920  ?v=-dtb0vDPruI) 
+00008d30: 2861 6273 6f6c 7574 656c 7920 6661 6e74  (absolutely fant
+00008d40: 6173 7469 6320 616c 6275 6d20 6274 7729  astic album btw)
+00008d50: 2061 6e64 2074 6865 2074 6167 7320 6172   and the tags ar
+00008d60: 653a 2060 416c 6275 6d3a 4563 6c69 7073  e: `Album:Eclips
+00008d70: 6560 2c20 6041 7274 6973 743a 6d65 6761  e`, `Artist:mega
+00008d80: 6e65 6b6f 602c 2060 5469 746c 653a 5369  neko`, `Title:Si
+00008d90: 7269 7573 2041 602c 2060 746e 3a37 600a  rius A`, `tn:7`.
+00008da0: 0a79 6f75 2063 6f75 6c64 2075 7365 206a  .you could use j
+00008db0: 7573 7420 7265 6765 7820 746f 2072 656e  ust regex to ren
+00008dc0: 616d 6520 6974 3a0a 2a20 6072 6567 6578  ame it:.* `regex
+00008dd0: 6020 3d20 6028 2e2a 2920 2d20 282e 2a29  ` = `(.*) - (.*)
+00008de0: 202d 2028 5b30 2d39 5d7b 327d 2920 282e   - ([0-9]{2}) (.
+00008df0: 2a29 600a 2a20 6066 6f72 6d61 7460 203d  *)`.* `format` =
+00008e00: 2060 2833 292e 2028 3129 202d 2028 3429   `(3). (1) - (4)
+00008e10: 600a 2a20 606f 7574 7075 7460 203d 2060  `.* `output` = `
+00008e20: 3037 2e20 6d65 6761 6e65 6b6f 202d 2053  07. meganeko - S
+00008e30: 6972 6975 7320 412e 6d70 3360 0a0a 6f72  irius A.mp3`..or
+00008e40: 2079 6f75 2063 6f75 6c64 2075 7365 206a   you could use j
+00008e50: 7573 7420 7461 6773 3a0a 2a20 6066 6f72  ust tags:.* `for
+00008e60: 6d61 7460 203d 2060 246c 7061 6428 2874  mat` = `$lpad((t
+00008e70: 6e29 2c32 2c30 292e 2028 6172 7469 7374  n),2,0). (artist
+00008e80: 2920 2d20 2874 6974 6c65 292e 2865 7874  ) - (title).(ext
+00008e90: 2960 0a2a 2060 6f75 7470 7574 6020 3d20  )`.* `output` = 
+00008ea0: 6037 2e20 6d65 6761 6e65 6b6f 202d 2053  `7. meganeko - S
+00008eb0: 6972 6975 7320 412e 6d70 3360 0a0a 6f72  irius A.mp3`..or
+00008ec0: 2061 206d 6978 206f 6620 626f 7468 3a0a   a mix of both:.
+00008ed0: 2a20 6072 6567 6578 6020 3d20 6020 2d20  * `regex` = ` - 
+00008ee0: 285b 302d 395d 7b32 7d29 2060 0a2a 2060  ([0-9]{2}) `.* `
+00008ef0: 666f 726d 6174 6020 3d20 6028 3129 2e20  format` = `(1). 
+00008f00: 2861 7274 6973 7429 202d 2028 7469 746c  (artist) - (titl
+00008f10: 6529 2e28 6578 7429 600a 2a20 606f 7574  e).(ext)`.* `out
+00008f20: 7075 7460 203d 2060 3037 2e20 6d65 6761  put` = `07. mega
+00008f30: 6e65 6b6f 202d 2053 6972 6975 7320 412e  neko - Sirius A.
+00008f40: 6d70 3360 0a0a 7468 6520 6d65 7461 6461  mp3`..the metada
+00008f50: 7461 206b 6579 7320 796f 7520 6361 6e20  ta keys you can 
+00008f60: 7573 6520 696e 2074 6865 2066 6f72 6d61  use in the forma
+00008f70: 7420 6669 656c 6420 6172 6520 7468 6520  t field are the 
+00008f80: 6f6e 6573 2069 6e20 7468 6520 6669 6c65  ones in the file
+00008f90: 2d62 726f 7773 6572 2074 6162 6c65 2068  -browser table h
+00008fa0: 6561 6465 7220 2877 6861 7465 7665 7220  eader (whatever 
+00008fb0: 6973 2063 6f6c 6c65 6374 6564 2077 6974  is collected wit
+00008fc0: 6820 602d 6d74 6560 2061 6e64 2060 2d6d  h `-mte` and `-m
+00008fd0: 7470 6029 0a0a 0a23 2320 6d65 6469 6120  tp`)...## media 
+00008fe0: 706c 6179 6572 0a0a 706c 6179 7320 616c  player..plays al
+00008ff0: 6d6f 7374 2065 7665 7279 2061 7564 696f  most every audio
+00009000: 2066 6f72 6d61 7420 7468 6572 6520 6973   format there is
+00009010: 2020 2869 6620 7468 6520 7365 7276 6572    (if the server
+00009020: 2068 6173 2046 466d 7065 6720 696e 7374   has FFmpeg inst
+00009030: 616c 6c65 6420 666f 7220 6f6e 2d64 656d  alled for on-dem
+00009040: 616e 6420 7472 616e 7363 6f64 696e 6729  and transcoding)
+00009050: 0a0a 7468 6520 666f 6c6c 6f77 696e 6720  ..the following 
+00009060: 6175 6469 6f20 666f 726d 6174 7320 6172  audio formats ar
+00009070: 6520 7573 7561 6c6c 7920 616c 7761 7973  e usually always
+00009080: 2070 6c61 7961 626c 652c 2065 7665 6e20   playable, even 
+00009090: 7769 7468 6f75 7420 4646 6d70 6567 3a20  without FFmpeg: 
+000090a0: 6061 6163 7c66 6c61 637c 6d34 617c 6d70  `aac|flac|m4a|mp
+000090b0: 337c 6f67 677c 6f70 7573 7c77 6176 600a  3|ogg|opus|wav`.
+000090c0: 0a73 6f6d 6520 6869 6c69 6768 7473 3a0a  .some hilights:.
+000090d0: 2a20 4f53 2069 6e74 6567 7261 7469 6f6e  * OS integration
+000090e0: 3b20 636f 6e74 726f 6c20 706c 6179 6261  ; control playba
+000090f0: 636b 2066 726f 6d20 796f 7572 2070 686f  ck from your pho
+00009100: 6e65 2773 206c 6f63 6b73 6372 6565 6e20  ne's lockscreen 
+00009110: 285b 7769 6e64 6f77 735d 2868 7474 7073  ([windows](https
+00009120: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+00009130: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+00009140: 2e63 6f6d 2f32 3431 3033 322f 3233 3332  .com/241032/2332
+00009150: 3133 3032 322d 3239 3861 3938 6261 2d37  13022-298a98ba-7
+00009160: 3231 612d 3463 6631 2d61 3364 342d 6636  21a-4cf1-a3d4-f6
+00009170: 3236 3334 6263 3533 6435 2e70 6e67 2920  2634bc53d5.png) 
+00009180: 2f2f 205b 694f 535d 2868 7474 7073 3a2f  // [iOS](https:/
+00009190: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+000091a0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+000091b0: 6f6d 2f32 3431 3033 322f 3134 3237 3131  om/241032/142711
+000091c0: 3932 362d 3037 3030 6265 3663 2d33 6533  926-0700be6c-3e3
+000091d0: 312d 3437 6233 2d39 3932 382d 3533 3732  1-47b3-9928-5372
+000091e0: 3232 3231 6637 3232 2e70 6e67 2920 2f2f  2221f722.png) //
+000091f0: 205b 616e 6472 6f69 645d 2868 7474 7073   [android](https
+00009200: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+00009210: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+00009220: 2e63 6f6d 2f32 3431 3033 322f 3233 3332  .com/241032/2332
+00009230: 3132 3331 312d 6137 3336 3835 3930 2d30  12311-a7368590-0
+00009240: 3863 372d 3466 3966 2d61 3161 662d 3438  8c7-4f9f-a1af-48
+00009250: 6363 6633 6633 3666 6164 2e70 6e67 2929  ccf3f36fad.png))
+00009260: 0a2a 2073 686f 7773 2074 6865 2061 7564  .* shows the aud
+00009270: 696f 2077 6176 6566 6f72 6d20 696e 2074  io waveform in t
+00009280: 6865 2073 6565 6b62 6172 0a2a 206e 6f74  he seekbar.* not
+00009290: 2070 6572 6665 6374 6c79 2067 6170 6c65   perfectly gaple
+000092a0: 7373 2062 7574 2063 616e 2067 6574 2072  ss but can get r
+000092b0: 6561 6c6c 7920 636c 6f73 6520 2873 6565  eally close (see
+000092c0: 2073 6574 7469 6e67 7320 2b20 6571 2062   settings + eq b
+000092d0: 656c 6f77 293b 2067 6f6f 6420 656e 6f75  elow); good enou
+000092e0: 6768 2074 6f20 656e 6a6f 7920 6761 706c  gh to enjoy gapl
+000092f0: 6573 7320 616c 6275 6d73 2061 7320 696e  ess albums as in
+00009300: 7465 6e64 6564 0a0a 636c 6963 6b20 7468  tended..click th
+00009310: 6520 6070 6c61 7960 206c 696e 6b20 6e65  e `play` link ne
+00009320: 7874 2074 6f20 616e 2061 7564 696f 2066  xt to an audio f
+00009330: 696c 652c 206f 7220 636f 7079 2074 6865  ile, or copy the
+00009340: 206c 696e 6b20 7461 7267 6574 2074 6f20   link target to 
+00009350: 5b73 6861 7265 2069 745d 2868 7474 7073  [share it](https
+00009360: 3a2f 2f61 2e6f 6376 2e6d 652f 7075 622f  ://a.ocv.me/pub/
+00009370: 6465 6d6f 2f6d 7573 6963 2f55 6269 6b74  demo/music/Ubikt
+00009380: 756e 6525 3230 2d25 3230 534f 554e 4453  une%20-%20SOUNDS
+00009390: 484f 434b 2532 3032 2532 302d 2532 3046  HOCK%202%20-%20F
+000093a0: 4d25 3230 4655 4e4b 2532 3054 4552 5252  M%20FUNK%20TERRR
+000093b0: 4f52 2121 2f23 6166 2d31 6662 6662 6136  OR!!/#af-1fbfba6
+000093c0: 3126 743d 3138 2920 286f 7074 696f 6e61  1&t=18) (optiona
+000093d0: 6c6c 7920 7769 7468 2061 2074 696d 6573  lly with a times
+000093e0: 7461 6d70 2074 6f20 7374 6172 7420 706c  tamp to start pl
+000093f0: 6179 696e 6720 6672 6f6d 2c20 6c69 6b65  aying from, like
+00009400: 2074 6861 7420 6578 616d 706c 6520 646f   that example do
+00009410: 6573 290a 0a6f 7065 6e20 7468 6520 605b  es)..open the `[
+00009420: f09f 8eba 5d60 206d 6564 6961 2d70 6c61  ....]` media-pla
+00009430: 7965 722d 7365 7474 696e 6773 2074 6162  yer-settings tab
+00009440: 2074 6f20 636f 6e66 6967 7572 6520 6974   to configure it
+00009450: 2c0a 2a20 7377 6974 6368 6573 3a0a 2020  ,.* switches:.  
+00009460: 2a20 605b 7072 656c 6f61 645d 6020 7374  * `[preload]` st
+00009470: 6172 7473 206c 6f61 6469 6e67 2074 6865  arts loading the
+00009480: 206e 6578 7420 7472 6163 6b20 7768 656e   next track when
+00009490: 2069 7427 7320 6162 6f75 7420 746f 2065   it's about to e
+000094a0: 6e64 2c20 7265 6475 6365 7320 7468 6520  nd, reduces the 
+000094b0: 7369 6c65 6e63 6520 6265 7477 6565 6e20  silence between 
+000094c0: 736f 6e67 730a 2020 2a20 605b 6675 6c6c  songs.  * `[full
+000094d0: 5d60 2064 6f65 7320 6120 6675 6c6c 2070  ]` does a full p
+000094e0: 7265 6c6f 6164 2062 7920 646f 776e 6c6f  reload by downlo
+000094f0: 6164 696e 6720 7468 6520 656e 7469 7265  ading the entire
+00009500: 206e 6578 7420 6669 6c65 3b20 676f 6f64   next file; good
+00009510: 2066 6f72 2075 6e72 656c 6961 626c 6520   for unreliable 
+00009520: 636f 6e6e 6563 7469 6f6e 732c 2062 6164  connections, bad
+00009530: 2066 6f72 2073 6c6f 7720 636f 6e6e 6563   for slow connec
+00009540: 7469 6f6e 730a 2020 2a20 605b 7e73 5d60  tions.  * `[~s]`
+00009550: 2074 6f67 676c 6573 2074 6865 2073 6565   toggles the see
+00009560: 6b62 6172 2077 6176 6566 6f72 6d20 6469  kbar waveform di
+00009570: 7370 6c61 790a 2020 2a20 605b 2f6e 705d  splay.  * `[/np]
+00009580: 6020 656e 6162 6c65 7320 6275 7474 6f6e  ` enables button
+00009590: 7320 746f 2063 6f70 7920 7468 6520 6e6f  s to copy the no
+000095a0: 772d 706c 6179 696e 6720 696e 666f 2061  w-playing info a
+000095b0: 7320 616e 2069 7263 206d 6573 7361 6765  s an irc message
+000095c0: 0a20 202a 2060 5b6f 732d 6374 6c5d 6020  .  * `[os-ctl]` 
+000095d0: 6d61 6b65 7320 6974 2070 6f73 7369 626c  makes it possibl
+000095e0: 6520 746f 2063 6f6e 7472 6f6c 2061 7564  e to control aud
+000095f0: 696f 2070 6c61 7962 6163 6b20 6672 6f6d  io playback from
+00009600: 2074 6865 206c 6f63 6b73 6372 6565 6e20   the lockscreen 
+00009610: 6f66 2079 6f75 7220 6465 7669 6365 2028  of your device (
+00009620: 656e 6162 6c65 7320 5b6d 6564 6961 7365  enables [mediase
+00009630: 7373 696f 6e5d 2868 7474 7073 3a2f 2f64  ssion](https://d
+00009640: 6576 656c 6f70 6572 2e6d 6f7a 696c 6c61  eveloper.mozilla
+00009650: 2e6f 7267 2f65 6e2d 5553 2f64 6f63 732f  .org/en-US/docs/
+00009660: 5765 622f 4150 492f 4d65 6469 6153 6573  Web/API/MediaSes
+00009670: 7369 6f6e 2929 0a20 202a 2060 5b73 6565  sion)).  * `[see
+00009680: 6b5d 6020 616c 6c6f 7773 2073 6565 6b69  k]` allows seeki
+00009690: 6e67 2077 6974 6820 6c6f 636b 7363 7265  ng with lockscre
+000096a0: 656e 2063 6f6e 7472 6f6c 7320 2862 7567  en controls (bug
+000096b0: 6779 206f 6e20 736f 6d65 2064 6576 6963  gy on some devic
+000096c0: 6573 290a 2020 2a20 605b 6172 745d 6020  es).  * `[art]` 
+000096d0: 7368 6f77 7320 616c 6275 6d20 6172 7420  shows album art 
+000096e0: 6f6e 2074 6865 206c 6f63 6b73 6372 6565  on the lockscree
+000096f0: 6e0a 2020 2a20 605b f09f 8eaf 5d60 206b  n.  * `[....]` k
+00009700: 6565 7073 2074 6865 2070 6c61 7969 6e67  eeps the playing
+00009710: 2073 6f6e 6720 7363 726f 6c6c 6564 2069   song scrolled i
+00009720: 6e74 6f20 7669 6577 2028 676f 6f64 2077  nto view (good w
+00009730: 6865 6e20 7573 696e 6720 7468 6520 706c  hen using the pl
+00009740: 6179 6572 2061 7320 6120 7461 736b 6261  ayer as a taskba
+00009750: 7220 646f 636b 290a 2020 2a20 605b e29f  r dock).  * `[..
+00009760: 8e5d 6020 7368 7269 6e6b 7320 7468 6520  .]` shrinks the 
+00009770: 706c 6179 6261 636b 2063 6f6e 7472 6f6c  playback control
+00009780: 730a 2a20 706c 6179 6261 636b 206d 6f64  s.* playback mod
+00009790: 653a 0a20 202a 2060 5b6c 6f6f 705d 6020  e:.  * `[loop]` 
+000097a0: 6b65 6570 7320 6c6f 6f70 696e 6720 7468  keeps looping th
+000097b0: 6520 666f 6c64 6572 0a20 202a 2060 5b6e  e folder.  * `[n
+000097c0: 6578 745d 6020 706c 6179 7320 696e 746f  ext]` plays into
+000097d0: 2074 6865 206e 6578 7420 666f 6c64 6572   the next folder
+000097e0: 0a2a 2074 7261 6e73 636f 6465 3a0a 2020  .* transcode:.  
+000097f0: 2a20 605b 666c 6163 5d60 2063 6f6e 7665  * `[flac]` conve
+00009800: 7273 2060 666c 6163 6020 616e 6420 6077  rs `flac` and `w
+00009810: 6176 6020 6669 6c65 7320 696e 746f 206f  av` files into o
+00009820: 7075 730a 2020 2a20 605b 6161 635d 6020  pus.  * `[aac]` 
+00009830: 636f 6e76 6572 7473 2060 6161 6360 2061  converts `aac` a
+00009840: 6e64 2060 6d34 6160 2066 696c 6573 2069  nd `m4a` files i
+00009850: 6e74 6f20 6f70 7573 0a20 202a 2060 5b6f  nto opus.  * `[o
+00009860: 7468 5d60 2063 6f6e 7665 7274 7320 616c  th]` converts al
+00009870: 6c20 6f74 6865 7220 6b6e 6f77 6e20 666f  l other known fo
+00009880: 726d 6174 7320 696e 746f 206f 7075 730a  rmats into opus.
+00009890: 2020 2020 2a20 6061 6163 7c61 6333 7c61      * `aac|ac3|a
+000098a0: 6966 7c61 6966 667c 616c 6163 7c61 6c61  if|aiff|alac|ala
+000098b0: 777c 616d 727c 6170 657c 6175 7c64 6670  w|amr|ape|au|dfp
+000098c0: 776d 7c64 7473 7c66 6c61 637c 6773 6d7c  wm|dts|flac|gsm|
+000098d0: 6974 7c6d 3461 7c6d 6f33 7c6d 6f64 7c6d  it|m4a|mo3|mod|m
+000098e0: 7032 7c6d 7033 7c6d 7063 7c6d 7074 6d7c  p2|mp3|mpc|mptm|
+000098f0: 6d74 327c 6d75 6c61 777c 6f67 677c 6f6b  mt2|mulaw|ogg|ok
+00009900: 747c 6f70 7573 7c72 617c 7333 6d7c 7461  t|opus|ra|s3m|ta
+00009910: 6b7c 7474 617c 756c 6177 7c77 6176 7c77  k|tta|ulaw|wav|w
+00009920: 6d61 7c77 767c 786d 7c78 706b 600a 2a20  ma|wv|xm|xpk`.* 
+00009930: 2274 696e 7422 2072 6564 7563 6573 2074  "tint" reduces t
+00009940: 6865 2063 6f6e 7472 6173 7420 6f66 2074  he contrast of t
+00009950: 6865 2070 6c61 7962 6163 6b20 6261 720a  he playback bar.
+00009960: 0a0a 2323 2320 6175 6469 6f20 6571 7561  ..### audio equa
+00009970: 6c69 7a65 720a 0a62 6173 7320 626f 6f73  lizer..bass boos
+00009980: 7465 640a 0a63 616e 2061 6c73 6f20 626f  ted..can also bo
+00009990: 6f73 7420 7468 6520 766f 6c75 6d65 2069  ost the volume i
+000099a0: 6e20 6765 6e65 7261 6c2c 206f 7220 696e  n general, or in
+000099b0: 6372 6561 7365 2f64 6563 7265 6173 6520  crease/decrease 
+000099c0: 7374 6572 656f 2077 6964 7468 2028 6c69  stereo width (li
+000099d0: 6b65 205b 6372 6f73 7366 6565 645d 2868  ke [crossfeed](h
+000099e0: 7474 7073 3a2f 2f77 7777 2e66 6f6f 6261  ttps://www.fooba
+000099f0: 7232 3030 302e 6f72 672f 636f 6d70 6f6e  r2000.org/compon
+00009a00: 656e 7473 2f76 6965 772f 666f 6f5f 6473  ents/view/foo_ds
+00009a10: 705f 6d65 6965 7263 6629 206a 7573 7420  p_meiercf) just 
+00009a20: 776f 7273 6529 0a0a 6861 7320 7468 6520  worse)..has the 
+00009a30: 636f 6e76 656e 6965 6e74 2073 6964 652d  convenient side-
+00009a40: 6566 6665 6374 206f 6620 7265 6475 6369  effect of reduci
+00009a50: 6e67 2074 6865 2070 6175 7365 2062 6574  ng the pause bet
+00009a60: 7765 656e 2073 6f6e 6773 2c20 736f 2067  ween songs, so g
+00009a70: 6170 6c65 7373 2061 6c62 756d 7320 706c  apless albums pl
+00009a80: 6179 2062 6574 7465 7220 7769 7468 2074  ay better with t
+00009a90: 6865 2065 7120 656e 6162 6c65 6420 286a  he eq enabled (j
+00009aa0: 7573 7420 6d61 6b65 2069 7420 666c 6174  ust make it flat
+00009ab0: 290a 0a0a 2323 2320 6669 7820 756e 7265  )...### fix unre
+00009ac0: 6c69 6162 6c65 2070 6c61 7962 6163 6b20  liable playback 
+00009ad0: 6f6e 2061 6e64 726f 6964 0a0a 6475 6520  on android..due 
+00009ae0: 746f 2070 686f 6e65 202f 2061 7070 2073  to phone / app s
+00009af0: 6574 7469 6e67 732c 2020 616e 6472 6f69  ettings,  androi
+00009b00: 6420 7068 6f6e 6573 206d 6179 2072 616e  d phones may ran
+00009b10: 646f 6d6c 7920 7374 6f70 2070 6c61 7969  domly stop playi
+00009b20: 6e67 206d 7573 6963 2077 6865 6e20 7468  ng music when th
+00009b30: 6520 706f 7765 7220 7361 7665 7220 6b69  e power saver ki
+00009b40: 636b 7320 696e 2c20 6573 7065 6369 616c  cks in, especial
+00009b50: 6c79 2061 7420 7468 6520 656e 6420 6f66  ly at the end of
+00009b60: 2061 6e20 616c 6275 6d20 2d2d 2079 6f75   an album -- you
+00009b70: 2063 616e 2066 6978 2069 7420 6279 205b   can fix it by [
+00009b80: 6469 7361 626c 696e 6720 706f 7765 7220  disabling power 
+00009b90: 7361 7669 6e67 5d28 6874 7470 733a 2f2f  saving](https://
+00009ba0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00009bb0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00009bc0: 6d2f 3234 3130 3332 2f32 3335 3236 3231  m/241032/2352621
+00009bd0: 3233 2d63 3332 3863 6361 392d 3339 3330  23-c328cca9-3930
+00009be0: 2d34 3934 382d 6264 3138 2d33 3934 3962  -4948-bd18-3949b
+00009bf0: 3966 6433 6663 662e 706e 6729 2069 6e20  9fd3fcf.png) in 
+00009c00: 7468 6520 5b61 7070 2073 6574 7469 6e67  the [app setting
+00009c10: 735d 2868 7474 7073 3a2f 2f75 7365 722d  s](https://user-
+00009c20: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00009c30: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00009c40: 3033 322f 3233 3532 3632 3132 312d 3266  032/235262121-2f
+00009c50: 6663 3531 6165 2d37 3832 312d 3433 3130  fc51ae-7821-4310
+00009c60: 2d61 3332 322d 6333 6237 6135 3037 3839  -a322-c3b7a50789
+00009c70: 3063 2e70 6e67 2920 6f66 2074 6865 2062  0c.png) of the b
+00009c80: 726f 7773 6572 2079 6f75 2075 7365 2066  rowser you use f
+00009c90: 6f72 206d 7573 6963 2073 7472 6561 6d69  or music streami
+00009ca0: 6e67 2028 7072 6566 6572 6162 6c79 2061  ng (preferably a
+00009cb0: 2064 6564 6963 6174 6564 206f 6e65 290a   dedicated one).
+00009cc0: 0a0a 2323 206d 6172 6b64 6f77 6e20 7669  ..## markdown vi
+00009cd0: 6577 6572 0a0a 616e 6420 7468 6572 6520  ewer..and there 
+00009ce0: 6172 6520 2a74 776f 2a20 6564 6974 6f72  are *two* editor
+00009cf0: 730a 0a21 5b63 6f70 7970 6172 7479 2d6d  s..![copyparty-m
+00009d00: 642d 7265 6164 2d66 7338 5d28 6874 7470  d-read-fs8](http
+00009d10: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+00009d20: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+00009d30: 742e 636f 6d2f 3234 3130 3332 2f31 3135  t.com/241032/115
+00009d40: 3937 3830 3537 2d36 3634 3139 3038 302d  978057-66419080-
+00009d50: 6135 3764 2d31 3165 622d 3835 3339 2d64  a57d-11eb-8539-d
+00009d60: 3262 6538 3433 3939 3161 612e 706e 6729  2be843991aa.png)
+00009d70: 0a0a 7468 6572 6520 6973 2061 2062 7569  ..there is a bui
+00009d80: 6c74 2d69 6e20 6578 7465 6e73 696f 6e20  lt-in extension 
+00009d90: 666f 7220 696e 6c69 6e65 2063 6c69 636b  for inline click
+00009da0: 6162 6c65 2074 6875 6d62 6e61 696c 733b  able thumbnails;
+00009db0: 0a2a 2065 6e61 626c 6520 6974 2062 7920  .* enable it by 
+00009dc0: 6164 6469 6e67 2060 3c21 2d2d 2074 6820  adding `<!-- th 
+00009dd0: 2d2d 3e60 2073 6f6d 6577 6865 7265 2069  -->` somewhere i
+00009de0: 6e20 7468 6520 646f 630a 2a20 6164 6420  n the doc.* add 
+00009df0: 7468 756d 626e 6169 6c73 2077 6974 6820  thumbnails with 
+00009e00: 6021 7468 5b6c 5d28 796f 7572 2e6a 7067  `!th[l](your.jpg
+00009e10: 2960 2077 6865 7265 2060 6c60 206d 6561  )` where `l` mea
+00009e20: 6e73 206c 6566 742d 616c 6967 6e20 2860  ns left-align (`
+00009e30: 7260 203d 2072 6967 6874 2d61 6c69 676e  r` = right-align
+00009e40: 290a 2a20 6120 7369 6e67 6c65 206c 696e  ).* a single lin
+00009e50: 6520 7769 7468 2060 2d2d 2d60 2063 6c65  e with `---` cle
+00009e60: 6172 7320 7468 6520 666c 6f61 7420 2f20  ars the float / 
+00009e70: 696e 6c69 6e69 6e67 0a2a 2069 6e20 7468  inlining.* in th
+00009e80: 6520 6361 7365 206f 6620 5245 4144 4d45  e case of README
+00009e90: 2e6d 6420 6265 696e 6720 6469 7370 6c61  .md being displa
+00009ea0: 7965 6420 6265 6c6f 7720 6120 6669 6c65  yed below a file
+00009eb0: 206c 6973 7469 6e67 2c20 7468 756d 626e   listing, thumbn
+00009ec0: 6169 6c73 2077 696c 6c20 6f70 656e 2069  ails will open i
+00009ed0: 6e20 7468 6520 6761 6c6c 6572 7920 7669  n the gallery vi
+00009ee0: 6577 6572 0a0a 6f74 6865 7220 6e6f 7465  ewer..other note
+00009ef0: 732c 0a2a 2074 6865 2064 6f63 756d 656e  s,.* the documen
+00009f00: 7420 7072 6576 6965 7720 6861 7320 6120  t preview has a 
+00009f10: 6d61 782d 7769 6474 6820 7768 6963 6820  max-width which 
+00009f20: 6973 2074 6865 2073 616d 6520 6173 2061  is the same as a
+00009f30: 6e20 4134 2070 6170 6572 2077 6865 6e20  n A4 paper when 
+00009f40: 7072 696e 7465 640a 0a0a 2323 206f 7468  printed...## oth
+00009f50: 6572 2074 7269 636b 730a 0a2a 2079 6f75  er tricks..* you
+00009f60: 2063 616e 206c 696e 6b20 6120 7061 7274   can link a part
+00009f70: 6963 756c 6172 2074 696d 6573 7461 6d70  icular timestamp
+00009f80: 2069 6e20 616e 2061 7564 696f 2066 696c   in an audio fil
+00009f90: 6520 6279 2061 6464 696e 6720 6974 2074  e by adding it t
+00009fa0: 6f20 7468 6520 5552 4c2c 2073 7563 6820  o the URL, such 
+00009fb0: 6173 2060 2632 3060 202f 2060 2632 3073  as `&20` / `&20s
+00009fc0: 6020 2f20 6026 316d 3230 6020 2f20 6026  ` / `&1m20` / `&
+00009fd0: 743d 313a 3230 6020 6166 7465 7220 7468  t=1:20` after th
+00009fe0: 6520 602e 2e2e 2f23 6166 2d63 3839 3630  e `.../#af-c8960
+00009ff0: 6461 6260 0a0a 2a20 656e 6162 6c69 6e67  dab`..* enabling
+0000a000: 2074 6865 2061 7564 696f 2065 7175 616c   the audio equal
+0000a010: 697a 6572 2063 616e 2068 656c 7020 6d61  izer can help ma
+0000a020: 6b65 2067 6170 6c65 7373 2061 6c62 756d  ke gapless album
+0000a030: 7320 6675 6c6c 7920 6761 706c 6573 7320  s fully gapless 
+0000a040: 696e 2073 6f6d 6520 6272 6f77 7365 7273  in some browsers
+0000a050: 2028 6368 726f 6d65 292c 2073 6f20 636f   (chrome), so co
+0000a060: 6e73 6964 6572 206c 6561 7669 6e67 2069  nsider leaving i
+0000a070: 7420 6f6e 2077 6974 6820 616c 6c20 7468  t on with all th
+0000a080: 6520 7661 6c75 6573 2061 7420 7a65 726f  e values at zero
+0000a090: 0a0a 2a20 6765 7420 6120 706c 6169 6e74  ..* get a plaint
+0000a0a0: 6578 7420 6669 6c65 206c 6973 7469 6e67  ext file listing
+0000a0b0: 2062 7920 6164 6469 6e67 2060 3f6c 733d   by adding `?ls=
+0000a0c0: 7460 2074 6f20 6120 5552 4c2c 206f 7220  t` to a URL, or 
+0000a0d0: 6120 636f 6d70 6163 7420 636f 6c6f 7265  a compact colore
+0000a0e0: 6420 6f6e 6520 7769 7468 2060 3f6c 733d  d one with `?ls=
+0000a0f0: 7660 2028 666f 7220 756e 6978 2074 6572  v` (for unix ter
+0000a100: 6d69 6e61 6c73 290a 0a2a 2069 6620 796f  minals)..* if yo
+0000a110: 7520 6172 6520 7573 696e 6720 6d65 6469  u are using medi
+0000a120: 6120 686f 746b 6579 7320 746f 2073 7769  a hotkeys to swi
+0000a130: 7463 6820 736f 6e67 7320 616e 6420 6172  tch songs and ar
+0000a140: 6520 6765 7474 696e 6720 7469 7265 6420  e getting tired 
+0000a150: 6f66 2073 6565 696e 6720 7468 6520 4f53  of seeing the OS
+0000a160: 4420 706f 7075 7020 7768 6963 6820 5769  D popup which Wi
+0000a170: 6e64 6f77 7320 646f 6573 6e27 7420 6c65  ndows doesn't le
+0000a180: 7420 796f 7520 6469 7361 626c 652c 2063  t you disable, c
+0000a190: 6f6e 7369 6465 7220 5b2e 2f63 6f6e 7472  onsider [./contr
+0000a1a0: 6962 2f6d 6564 6961 2d6f 7364 2d62 676f  ib/media-osd-bgo
+0000a1b0: 6e65 2e70 7331 5d28 636f 6e74 7269 622f  ne.ps1](contrib/
+0000a1c0: 236d 6564 6961 2d6f 7364 2d62 676f 6e65  #media-osd-bgone
+0000a1d0: 7073 3129 0a0a 2a20 636c 6963 6b20 7468  ps1)..* click th
+0000a1e0: 6520 626f 7474 6f6d 2d6c 6566 7420 60cf  e bottom-left `.
+0000a1f0: 8060 2074 6f20 6f70 656e 2061 206a 6176  .` to open a jav
+0000a200: 6173 6372 6970 7420 7072 6f6d 7074 2066  ascript prompt f
+0000a210: 6f72 2064 6562 7567 6769 6e67 0a0a 2a20  or debugging..* 
+0000a220: 6669 6c65 7320 6e61 6d65 6420 602e 7072  files named `.pr
+0000a230: 6f6c 6f67 7565 2e68 746d 6c60 202f 2060  ologue.html` / `
+0000a240: 2e65 7069 6c6f 6775 652e 6874 6d6c 6020  .epilogue.html` 
+0000a250: 7769 6c6c 2062 6520 7265 6e64 6572 6564  will be rendered
+0000a260: 2062 6566 6f72 652f 6166 7465 7220 6469   before/after di
+0000a270: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
+0000a280: 2075 6e6c 6573 7320 602d 2d6e 6f2d 6c6f   unless `--no-lo
+0000a290: 6775 6573 600a 0a2a 2066 696c 6573 206e  gues`..* files n
+0000a2a0: 616d 6564 2060 5245 4144 4d45 2e6d 6460  amed `README.md`
+0000a2b0: 202f 2060 7265 6164 6d65 2e6d 6460 2077   / `readme.md` w
+0000a2c0: 696c 6c20 6265 2072 656e 6465 7265 6420  ill be rendered 
+0000a2d0: 6166 7465 7220 6469 7265 6374 6f72 7920  after directory 
+0000a2e0: 6c69 7374 696e 6773 2075 6e6c 6573 7320  listings unless 
+0000a2f0: 602d 2d6e 6f2d 7265 6164 6d65 6020 2862  `--no-readme` (b
+0000a300: 7574 2060 2e65 7069 6c6f 6775 652e 6874  ut `.epilogue.ht
+0000a310: 6d6c 6020 7461 6b65 7320 7072 6563 6564  ml` takes preced
+0000a320: 656e 6365 290a 0a0a 2323 2073 6561 7263  ence)...## searc
+0000a330: 6869 6e67 0a0a 7365 6172 6368 2062 7920  hing..search by 
+0000a340: 7369 7a65 2c20 6461 7465 2c20 7061 7468  size, date, path
+0000a350: 2f6e 616d 652c 206d 7033 2d74 6167 732c  /name, mp3-tags,
+0000a360: 202e 2e2e 0a0a 215b 636f 7079 7061 7274   .....![copypart
+0000a370: 792d 7365 6172 6368 2d66 7338 5d28 6874  y-search-fs8](ht
+0000a380: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+0000a390: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+0000a3a0: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+0000a3b0: 3239 3633 3533 3635 2d63 3066 6632 6139  29635365-c0ff2a9
+0000a3c0: 662d 3065 6535 2d34 6663 332d 3862 6236  f-0ee5-4fc3-8bb6
+0000a3d0: 2d30 3036 3033 3363 6636 3762 382e 706e  -006033cf67b8.pn
+0000a3e0: 6729 0a0a 7768 656e 2073 7461 7274 6564  g)..when started
+0000a3f0: 2077 6974 6820 602d 6532 6473 6160 2063   with `-e2dsa` c
+0000a400: 6f70 7970 6172 7479 2077 696c 6c20 7363  opyparty will sc
+0000a410: 616e 2f69 6e64 6578 2061 6c6c 2079 6f75  an/index all you
+0000a420: 7220 6669 6c65 732e 2054 6869 7320 6176  r files. This av
+0000a430: 6f69 6473 2064 7570 6c69 6361 7465 7320  oids duplicates 
+0000a440: 6f6e 2075 706c 6f61 642c 2061 6e64 2061  on upload, and a
+0000a450: 6c73 6f20 6d61 6b65 7320 7468 6520 766f  lso makes the vo
+0000a460: 6c75 6d65 7320 7365 6172 6368 6162 6c65  lumes searchable
+0000a470: 2074 6872 6f75 6768 2074 6865 2077 6562   through the web
+0000a480: 2d75 693a 0a2a 206d 616b 6520 7365 6172  -ui:.* make sear
+0000a490: 6368 2071 7565 7269 6573 2062 7920 6073  ch queries by `s
+0000a4a0: 697a 6560 2f60 6461 7465 602f 6064 6972  ize`/`date`/`dir
+0000a4b0: 6563 746f 7279 2d70 6174 6860 2f60 6669  ectory-path`/`fi
+0000a4c0: 6c65 6e61 6d65 602c 206f 722e 2e2e 0a2a  lename`, or....*
+0000a4d0: 2064 7261 672f 6472 6f70 2061 206c 6f63   drag/drop a loc
+0000a4e0: 616c 2066 696c 6520 746f 2073 6565 2069  al file to see i
+0000a4f0: 6620 7468 6520 7361 6d65 2063 6f6e 7465  f the same conte
+0000a500: 6e74 7320 6578 6973 7420 736f 6d65 7768  nts exist somewh
+0000a510: 6572 6520 6f6e 2074 6865 2073 6572 7665  ere on the serve
+0000a520: 722c 2073 6565 205b 6669 6c65 2d73 6561  r, see [file-sea
+0000a530: 7263 685d 2823 6669 6c65 2d73 6561 7263  rch](#file-searc
+0000a540: 6829 0a0a 7061 7468 2f6e 616d 6520 7175  h)..path/name qu
+0000a550: 6572 6965 7320 6172 6520 7370 6163 652d  eries are space-
+0000a560: 7365 7061 7261 7465 642c 2041 4e44 2765  separated, AND'e
+0000a570: 6420 746f 6765 7468 6572 2c20 616e 6420  d together, and 
+0000a580: 776f 7264 7320 6172 6520 6e65 6761 7465  words are negate
+0000a590: 6420 7769 7468 2061 2060 2d60 2070 7265  d with a `-` pre
+0000a5a0: 6669 782c 2073 6f20 666f 7220 6578 616d  fix, so for exam
+0000a5b0: 706c 653a 0a2a 2070 6174 683a 2060 7368  ple:.* path: `sh
+0000a5c0: 6962 6179 616e 202d 626f 7373 6160 2066  ibayan -bossa` f
+0000a5d0: 696e 6473 2061 6c6c 2066 696c 6573 2077  inds all files w
+0000a5e0: 6865 7265 206f 6e65 206f 6620 7468 6520  here one of the 
+0000a5f0: 666f 6c64 6572 7320 636f 6e74 6169 6e20  folders contain 
+0000a600: 6073 6869 6261 7961 6e60 2062 7574 2066  `shibayan` but f
+0000a610: 696c 7465 7273 206f 7574 2061 6e79 2072  ilters out any r
+0000a620: 6573 756c 7473 2077 6865 7265 2060 626f  esults where `bo
+0000a630: 7373 6160 2065 7869 7374 7320 736f 6d65  ssa` exists some
+0000a640: 7768 6572 6520 696e 2074 6865 2070 6174  where in the pat
+0000a650: 680a 2a20 6e61 6d65 3a20 6064 656d 6574  h.* name: `demet
+0000a660: 6f72 6920 7374 7978 6020 6769 7665 7320  ori styx` gives 
+0000a670: 796f 7520 5b67 6f6f 6420 7374 7566 665d  you [good stuff]
+0000a680: 2868 7474 7073 3a2f 2f77 7777 2e79 6f75  (https://www.you
+0000a690: 7475 6265 2e63 6f6d 2f77 6174 6368 3f76  tube.com/watch?v
+0000a6a0: 3d7a 4768 3067 3134 5a4a 3849 266c 6973  =zGh0g14ZJ8I&lis
+0000a6b0: 743d 504c 3341 3134 3742 4431 3531 4545  t=PL3A147BD151EE
+0000a6c0: 3532 3138 2669 6e64 6578 3d39 290a 0a74  5218&index=9)..t
+0000a6d0: 6865 2060 7261 7760 2066 6965 6c64 2061  he `raw` field a
+0000a6e0: 6c6c 6f77 7320 666f 7220 6d6f 7265 2063  llows for more c
+0000a6f0: 6f6d 706c 6578 2073 7475 6666 2073 7563  omplex stuff suc
+0000a700: 6820 6173 2060 2820 7461 6773 206c 696b  h as `( tags lik
+0000a710: 6520 2a6e 6861 746f 2a20 6f72 2074 6167  e *nhato* or tag
+0000a720: 7320 6c69 6b65 202a 7461 6973 6869 2a20  s like *taishi* 
+0000a730: 2920 616e 6420 2820 6e6f 7420 7461 6773  ) and ( not tags
+0000a740: 206c 696b 6520 2a6e 6861 746f 2a20 6f72   like *nhato* or
+0000a750: 206e 6f74 2074 6167 7320 6c69 6b65 202a   not tags like *
+0000a760: 7461 6973 6869 2a20 2960 2077 6869 6368  taishi* )` which
+0000a770: 2066 696e 6473 2061 6c6c 2073 6f6e 6773   finds all songs
+0000a780: 2062 7920 6569 7468 6572 206e 6861 746f   by either nhato
+0000a790: 206f 7220 7461 6973 6869 2c20 6578 636c   or taishi, excl
+0000a7a0: 7564 696e 6720 636f 6c6c 6162 7320 2874  uding collabs (t
+0000a7b0: 6572 7269 626c 6520 6578 616d 706c 652c  errible example,
+0000a7c0: 2077 6879 2077 6f75 6c64 2079 6f75 2064   why would you d
+0000a7d0: 6f20 7468 6174 290a 0a66 6f72 2074 6865  o that)..for the
+0000a7e0: 2061 626f 7665 2065 7861 6d70 6c65 2074   above example t
+0000a7f0: 6f20 776f 726b 2c20 6164 6420 7468 6520  o work, add the 
+0000a800: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
+0000a810: 6d65 6e74 2060 2d65 3274 7360 2074 6f20  ment `-e2ts` to 
+0000a820: 616c 736f 2073 6361 6e2f 696e 6465 7820  also scan/index 
+0000a830: 7461 6773 2066 726f 6d20 6d75 7369 6320  tags from music 
+0000a840: 6669 6c65 732c 2077 6869 6368 2062 7269  files, which bri
+0000a850: 6e67 7320 7573 206f 7665 7220 746f 3a0a  ngs us over to:.
+0000a860: 0a0a 2320 7365 7276 6572 2063 6f6e 6669  ..# server confi
+0000a870: 670a 0a75 7369 6e67 2061 7267 756d 656e  g..using argumen
+0000a880: 7473 206f 7220 636f 6e66 6967 2066 696c  ts or config fil
+0000a890: 6573 2c20 6f72 2061 206d 6978 206f 6620  es, or a mix of 
+0000a8a0: 626f 7468 3a0a 2a20 636f 6e66 6967 2066  both:.* config f
+0000a8b0: 696c 6573 2028 602d 6320 736f 6d65 2e63  iles (`-c some.c
+0000a8c0: 6f6e 6660 2920 6361 6e20 7365 7420 6164  onf`) can set ad
+0000a8d0: 6469 7469 6f6e 616c 2063 6f6d 6d61 6e64  ditional command
+0000a8e0: 6c69 6e65 2061 7267 756d 656e 7473 3b20  line arguments; 
+0000a8f0: 7365 6520 5b2e 2f64 6f63 732f 6578 616d  see [./docs/exam
+0000a900: 706c 652e 636f 6e66 5d28 646f 6373 2f65  ple.conf](docs/e
+0000a910: 7861 6d70 6c65 2e63 6f6e 6629 2061 6e64  xample.conf) and
+0000a920: 205b 2e2f 646f 6373 2f65 7861 6d70 6c65   [./docs/example
+0000a930: 322e 636f 6e66 5d28 646f 6373 2f65 7861  2.conf](docs/exa
+0000a940: 6d70 6c65 322e 636f 6e66 290a 2a20 606b  mple2.conf).* `k
+0000a950: 696c 6c20 2d73 2055 5352 3160 2028 7361  ill -s USR1` (sa
+0000a960: 6d65 2061 7320 6073 7973 7465 6d63 746c  me as `systemctl
+0000a970: 2072 656c 6f61 6420 636f 7079 7061 7274   reload copypart
+0000a980: 7960 2920 746f 2072 656c 6f61 6420 6163  y`) to reload ac
+0000a990: 636f 756e 7473 2061 6e64 2076 6f6c 756d  counts and volum
+0000a9a0: 6573 2066 726f 6d20 636f 6e66 6967 2066  es from config f
+0000a9b0: 696c 6573 2077 6974 686f 7574 2072 6573  iles without res
+0000a9c0: 7461 7274 696e 670a 2020 2a20 6f72 2063  tarting.  * or c
+0000a9d0: 6c69 636b 2074 6865 2060 5b72 656c 6f61  lick the `[reloa
+0000a9e0: 6420 6366 675d 6020 6275 7474 6f6e 2069  d cfg]` button i
+0000a9f0: 6e20 7468 6520 636f 6e74 726f 6c2d 7061  n the control-pa
+0000aa00: 6e65 6c20 7768 656e 206c 6f67 6765 6420  nel when logged 
+0000aa10: 696e 2061 7320 6164 6d69 6e20 0a20 202a  in as admin .  *
+0000aa20: 2063 6861 6e67 6573 2074 6f20 7468 6520   changes to the 
+0000aa30: 605b 676c 6f62 616c 5d60 2063 6f6e 6669  `[global]` confi
+0000aa40: 6720 7365 6374 696f 6e20 7265 7175 6972  g section requir
+0000aa50: 6573 2061 2072 6573 7461 7274 2074 6f20  es a restart to 
+0000aa60: 7461 6b65 2065 6666 6563 740a 0a0a 2323  take effect...##
+0000aa70: 207a 6572 6f63 6f6e 660a 0a61 6e6e 6f75   zeroconf..annou
+0000aa80: 6e63 6520 656e 6162 6c65 6420 7365 7276  nce enabled serv
+0000aa90: 6963 6573 206f 6e20 7468 6520 4c41 4e20  ices on the LAN 
+0000aaa0: 285b 7069 635d 2868 7474 7073 3a2f 2f75  ([pic](https://u
+0000aab0: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
+0000aac0: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
+0000aad0: 2f32 3431 3033 322f 3231 3533 3434 3733  /241032/21534473
+0000aae0: 372d 3065 6165 3864 3938 2d39 3439 362d  7-0eae8d98-9496-
+0000aaf0: 3432 3536 2d39 6161 382d 6364 3266 3639  4256-9aa8-cd2f69
+0000ab00: 3731 3831 3064 2e70 6e67 2929 2020 2d2d  71810d.png))  --
+0000ab10: 2060 2d7a 6020 656e 6162 6c65 7320 626f   `-z` enables bo
+0000ab20: 7468 205b 6d64 6e73 5d28 236d 646e 7329  th [mdns](#mdns)
+0000ab30: 2061 6e64 205b 7373 6470 5d28 2373 7364   and [ssdp](#ssd
+0000ab40: 7029 0a0a 2a20 602d 2d7a 2d6f 6e60 202f  p)..* `--z-on` /
+0000ab50: 2060 2d2d 7a2d 6f66 6660 2720 6c69 6d69   `--z-off`' limi
+0000ab60: 7473 2074 6865 2066 6561 7475 7265 2074  ts the feature t
+0000ab70: 6f20 6365 7274 6169 6e20 6e65 7477 6f72  o certain networ
+0000ab80: 6b73 0a0a 0a23 2323 206d 646e 730a 0a4c  ks...### mdns..L
+0000ab90: 414e 2064 6f6d 6169 6e2d 6e61 6d65 2061  AN domain-name a
+0000aba0: 6e64 2066 6561 7475 7265 2061 6e6e 6f75  nd feature annou
+0000abb0: 6e63 6572 0a0a 7573 6573 205b 6d75 6c74  ncer..uses [mult
+0000abc0: 6963 6173 7420 646e 735d 2868 7474 7073  icast dns](https
+0000abd0: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+0000abe0: 6f72 672f 7769 6b69 2f4d 756c 7469 6361  org/wiki/Multica
+0000abf0: 7374 5f44 4e53 2920 746f 2067 6976 6520  st_DNS) to give 
+0000ac00: 636f 7079 7061 7274 7920 6120 646f 6d61  copyparty a doma
+0000ac10: 696e 2077 6869 6368 2061 6e79 206d 6163  in which any mac
+0000ac20: 6869 6e65 206f 6e20 7468 6520 4c41 4e20  hine on the LAN 
+0000ac30: 6361 6e20 7573 6520 746f 2061 6363 6573  can use to acces
+0000ac40: 7320 6974 0a0a 616c 6c20 656e 6162 6c65  s it..all enable
+0000ac50: 6420 7365 7276 6963 6573 2028 5b77 6562  d services ([web
+0000ac60: 6461 765d 2823 7765 6264 6176 2d73 6572  dav](#webdav-ser
+0000ac70: 7665 7229 2c20 5b66 7470 5d28 2366 7470  ver), [ftp](#ftp
+0000ac80: 2d73 6572 7665 7229 2c20 5b73 6d62 5d28  -server), [smb](
+0000ac90: 2373 6d62 2d73 6572 7665 7229 2920 7769  #smb-server)) wi
+0000aca0: 6c6c 2061 7070 6561 7220 696e 206d 444e  ll appear in mDN
+0000acb0: 532d 6177 6172 6520 6669 6c65 206d 616e  S-aware file man
+0000acc0: 6167 6572 7320 284b 4445 2c20 676e 6f6d  agers (KDE, gnom
+0000acd0: 652c 206d 6163 4f53 2c20 2e2e 2e29 0a0a  e, macOS, ...)..
+0000ace0: 7468 6520 646f 6d61 696e 2077 696c 6c20  the domain will 
+0000acf0: 6265 2068 7474 703a 2f2f 7061 7274 7962  be http://partyb
+0000ad00: 6f78 2e6c 6f63 616c 2069 6620 7468 6520  ox.local if the 
+0000ad10: 6d61 6368 696e 6527 7320 686f 7374 6e61  machine's hostna
+0000ad20: 6d65 2069 7320 6070 6172 7479 626f 7860  me is `partybox`
+0000ad30: 2075 6e6c 6573 7320 602d 2d6e 616d 6560   unless `--name`
+0000ad40: 2073 7065 6369 6669 6573 2073 6f65 6d74   specifies soemt
+0000ad50: 6869 6e67 2065 6c73 650a 0a0a 2323 2320  hing else...### 
+0000ad60: 7373 6470 0a0a 7769 6e64 6f77 732d 6578  ssdp..windows-ex
+0000ad70: 706c 6f72 6572 2061 6e6e 6f75 6e63 6572  plorer announcer
+0000ad80: 0a0a 7573 6573 205b 7373 6470 5d28 6874  ..uses [ssdp](ht
+0000ad90: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+0000ada0: 6961 2e6f 7267 2f77 696b 692f 5369 6d70  ia.org/wiki/Simp
+0000adb0: 6c65 5f53 6572 7669 6365 5f44 6973 636f  le_Service_Disco
+0000adc0: 7665 7279 5f50 726f 746f 636f 6c29 2074  very_Protocol) t
+0000add0: 6f20 6d61 6b65 2063 6f70 7970 6172 7479  o make copyparty
+0000ade0: 2061 7070 6561 7220 696e 2074 6865 2077   appear in the w
+0000adf0: 696e 646f 7773 2066 696c 6520 6578 706c  indows file expl
+0000ae00: 6f72 6572 206f 6e20 616c 6c20 6d61 6368  orer on all mach
+0000ae10: 696e 6573 206f 6e20 7468 6520 4c41 4e0a  ines on the LAN.
+0000ae20: 0a64 6f75 626c 6563 6c69 636b 696e 6720  .doubleclicking 
+0000ae30: 7468 6520 6963 6f6e 206f 7065 6e73 2074  the icon opens t
+0000ae40: 6865 2022 636f 6e6e 6563 7422 2070 6167  he "connect" pag
+0000ae50: 6520 7768 6963 6820 6578 706c 6169 6e73  e which explains
+0000ae60: 2068 6f77 2074 6f20 6d6f 756e 7420 636f   how to mount co
+0000ae70: 7079 7061 7274 7920 6173 2061 206c 6f63  pyparty as a loc
+0000ae80: 616c 2066 696c 6573 7973 7465 6d0a 0a69  al filesystem..i
+0000ae90: 6620 636f 7079 7061 7274 7920 646f 6573  f copyparty does
+0000aea0: 206e 6f74 2061 7070 6561 7220 696e 2077   not appear in w
+0000aeb0: 696e 646f 7773 2065 7870 6c6f 7265 722c  indows explorer,
+0000aec0: 2075 7365 2060 2d2d 7a73 7660 2074 6f20   use `--zsv` to 
+0000aed0: 7365 6520 7768 793a 0a0a 2a20 6d61 7962  see why:..* mayb
+0000aee0: 6520 7468 6520 6469 7363 6f76 6572 7920  e the discovery 
+0000aef0: 6d75 6c74 6963 6173 7420 7761 7320 7365  multicast was se
+0000af00: 6e74 2066 726f 6d20 616e 2049 5020 7768  nt from an IP wh
+0000af10: 6963 6820 646f 6573 206e 6f74 2069 6e74  ich does not int
+0000af20: 6572 7365 6374 2077 6974 6820 7468 6520  ersect with the 
+0000af30: 7365 7276 6572 2073 7562 6e65 7473 0a0a  server subnets..
+0000af40: 0a23 2320 7172 2d63 6f64 650a 0a70 7269  .## qr-code..pri
+0000af50: 6e74 2061 2071 722d 636f 6465 205b 2873  nt a qr-code [(s
+0000af60: 6372 6565 6e73 686f 7429 5d28 6874 7470  creenshot)](http
+0000af70: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+0000af80: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+0000af90: 742e 636f 6d2f 3234 3130 3332 2f31 3934  t.com/241032/194
+0000afa0: 3732 3835 3333 2d36 6630 3038 3439 622d  728533-6f00849b-
+0000afb0: 6336 6163 2d34 3363 362d 3933 3539 2d38  c6ac-43c6-9359-8
+0000afc0: 3365 3435 3464 3131 6530 302e 706e 6729  3e454d11e00.png)
+0000afd0: 2066 6f72 2071 7569 636b 2061 6363 6573   for quick acces
+0000afe0: 732c 2020 6772 6561 7420 6265 7477 6565  s,  great betwee
+0000aff0: 6e20 7068 6f6e 6573 206f 6e20 616e 6472  n phones on andr
+0000b000: 6f69 6420 686f 7473 706f 7473 2077 6869  oid hotspots whi
+0000b010: 6368 206b 6565 7020 6368 616e 6769 6e67  ch keep changing
+0000b020: 2074 6865 2073 7562 6e65 740a 0a2a 2060   the subnet..* `
+0000b030: 2d2d 7172 6020 656e 6162 6c65 7320 6974  --qr` enables it
+0000b040: 0a2a 2060 2d2d 7172 7360 2064 6f65 7320  .* `--qrs` does 
+0000b050: 6874 7470 7320 696e 7374 6561 6420 6f66  https instead of
+0000b060: 2068 7474 700a 2a20 602d 2d71 726c 206c   http.* `--qrl l
+0000b070: 6f6f 7462 6f78 2f3f 7077 3d68 756e 7465  ootbox/?pw=hunte
+0000b080: 7232 6020 6170 7065 6e64 7320 746f 2074  r2` appends to t
+0000b090: 6865 2075 726c 2c20 6c69 6e6b 696e 6720  he url, linking 
+0000b0a0: 746f 2074 6865 2060 6c6f 6f74 626f 7860  to the `lootbox`
+0000b0b0: 2066 6f6c 6465 7220 7769 7468 2070 6173   folder with pas
+0000b0c0: 7377 6f72 6420 6068 756e 7465 7232 600a  sword `hunter2`.
+0000b0d0: 2a20 602d 2d71 727a 2031 6020 666f 7263  * `--qrz 1` forc
+0000b0e0: 6573 2031 7820 7a6f 6f6d 2069 6e73 7465  es 1x zoom inste
+0000b0f0: 6164 206f 6620 6175 746f 7363 616c 696e  ad of autoscalin
+0000b100: 6720 746f 2066 6974 2074 6865 2074 6572  g to fit the ter
+0000b110: 6d69 6e61 6c20 7369 7a65 0a20 202a 2031  minal size.  * 1
+0000b120: 7820 6d61 7920 7265 6e64 6572 2069 6e63  x may render inc
+0000b130: 6f72 7265 6374 6c79 206f 6e20 736f 6d65  orrectly on some
+0000b140: 2074 6572 6d69 6e61 6c73 2f66 6f6e 7473   terminals/fonts
+0000b150: 2c20 6275 7420 3278 2073 686f 756c 6420  , but 2x should 
+0000b160: 616c 7761 7973 2077 6f72 6b0a 0a69 7420  always work..it 
+0000b170: 7573 6573 2074 6865 2073 6572 7665 7220  uses the server 
+0000b180: 686f 7374 6e61 6d65 2069 6620 5b6d 646e  hostname if [mdn
+0000b190: 735d 2823 6d64 6e73 2920 6973 2065 6e62  s](#mdns) is enb
+0000b1a0: 6c65 642c 206f 7468 6572 7769 7365 2069  led, otherwise i
+0000b1b0: 7427 6c6c 2075 7365 2079 6f75 7220 6578  t'll use your ex
+0000b1c0: 7465 726e 616c 2069 7020 2864 6566 6175  ternal ip (defau
+0000b1d0: 6c74 2072 6f75 7465 2920 756e 6c65 7373  lt route) unless
+0000b1e0: 2060 2d2d 7172 6960 2073 7065 6369 6669   `--qri` specifi
+0000b1f0: 6573 2061 2073 7065 6369 6669 6320 6970  es a specific ip
+0000b200: 2d70 7265 6669 7820 6f72 2064 6f6d 6169  -prefix or domai
+0000b210: 6e0a 0a0a 2323 2066 7470 2073 6572 7665  n...## ftp serve
+0000b220: 720a 0a61 6e20 4654 5020 7365 7276 6572  r..an FTP server
+0000b230: 2063 616e 2062 6520 7374 6172 7465 6420   can be started 
+0000b240: 7573 696e 6720 602d 2d66 7470 2033 3932  using `--ftp 392
+0000b250: 3160 2c20 2061 6e64 2f6f 7220 602d 2d66  1`,  and/or `--f
+0000b260: 7470 7360 2066 6f72 2065 7870 6c69 6369  tps` for explici
+0000b270: 7420 544c 5320 2866 7470 6573 290a 0a2a  t TLS (ftpes)..*
+0000b280: 2062 6173 6564 206f 6e20 5b70 7966 7470   based on [pyftp
+0000b290: 646c 6962 5d28 6874 7470 733a 2f2f 6769  dlib](https://gi
+0000b2a0: 7468 7562 2e63 6f6d 2f67 6961 6d70 616f  thub.com/giampao
+0000b2b0: 6c6f 2f70 7966 7470 646c 6962 290a 2a20  lo/pyftpdlib).* 
+0000b2c0: 6e65 6564 7320 6120 6465 6469 6361 7465  needs a dedicate
+0000b2d0: 6420 706f 7274 2028 6361 6e6e 6f74 2073  d port (cannot s
+0000b2e0: 6861 7265 2077 6974 6820 7468 6520 4854  hare with the HT
+0000b2f0: 5450 2f48 5454 5053 2041 5049 290a 2a20  TP/HTTPS API).* 
+0000b300: 7570 6c6f 6164 7320 6172 6520 6e6f 7420  uploads are not 
+0000b310: 7265 7375 6d61 626c 6520 2d2d 2064 656c  resumable -- del
+0000b320: 6574 6520 616e 6420 7265 7374 6172 7420  ete and restart 
+0000b330: 6966 206e 6563 6573 7361 7279 0a2a 2072  if necessary.* r
+0000b340: 756e 7320 696e 2061 6374 6976 6520 6d6f  uns in active mo
+0000b350: 6465 2062 7920 6465 6661 756c 742c 2079  de by default, y
+0000b360: 6f75 2070 726f 6261 626c 7920 7761 6e74  ou probably want
+0000b370: 2060 2d2d 6674 702d 7072 2031 3230 3030   `--ftp-pr 12000
+0000b380: 2d31 3330 3030 600a 2020 2a20 6966 2079  -13000`.  * if y
+0000b390: 6f75 2065 6e61 626c 6520 626f 7468 2060  ou enable both `
+0000b3a0: 6674 7060 2061 6e64 2060 6674 7073 602c  ftp` and `ftps`,
+0000b3b0: 2074 6865 2070 6f72 742d 7261 6e67 6520   the port-range 
+0000b3c0: 7769 6c6c 2062 6520 6469 7669 6465 6420  will be divided 
+0000b3d0: 696e 2068 616c 660a 2020 2a20 736f 6d65  in half.  * some
+0000b3e0: 206f 6c64 6572 2073 6f66 7477 6172 6520   older software 
+0000b3f0: 2866 696c 657a 696c 6c61 206f 6e20 6465  (filezilla on de
+0000b400: 6269 616e 2d73 7461 626c 6529 2063 616e  bian-stable) can
+0000b410: 6e6f 7420 7061 7373 6976 652d 6d6f 6465  not passive-mode
+0000b420: 2077 6974 6820 544c 530a 2a20 6c6f 6769   with TLS.* logi
+0000b430: 6e20 7769 7468 2061 6e79 2075 7365 726e  n with any usern
+0000b440: 616d 6520 2b20 796f 7572 2070 6173 7377  ame + your passw
+0000b450: 6f72 642c 206f 7220 7075 7420 796f 7572  ord, or put your
+0000b460: 2070 6173 7377 6f72 6420 696e 2074 6865   password in the
+0000b470: 2075 7365 726e 616d 6520 6669 656c 640a   username field.
+0000b480: 0a73 6f6d 6520 7265 636f 6d6d 656e 6465  .some recommende
+0000b490: 6420 4654 5020 2f20 4654 5053 2063 6c69  d FTP / FTPS cli
+0000b4a0: 656e 7473 3b20 6077 6172 6b60 203d 2065  ents; `wark` = e
+0000b4b0: 7861 6d70 6c65 2070 6173 7377 6f72 643a  xample password:
+0000b4c0: 0a2a 2068 7474 7073 3a2f 2f77 696e 7363  .* https://winsc
+0000b4d0: 702e 6e65 742f 656e 672f 646f 776e 6c6f  p.net/eng/downlo
+0000b4e0: 6164 2e70 6870 0a2a 2068 7474 7073 3a2f  ad.php.* https:/
+0000b4f0: 2f66 696c 657a 696c 6c61 2d70 726f 6a65  /filezilla-proje
+0000b500: 6374 2e6f 7267 2f20 7374 7275 6767 6c65  ct.org/ struggle
+0000b510: 7320 6120 6269 7420 7769 7468 2066 7470  s a bit with ftp
+0000b520: 7320 696e 2061 6374 6976 652d 6d6f 6465  s in active-mode
+0000b530: 2c20 6275 7420 6973 2066 696e 6520 6f74  , but is fine ot
+0000b540: 6865 7277 6973 650a 2a20 6874 7470 733a  herwise.* https:
+0000b550: 2f2f 7263 6c6f 6e65 2e6f 7267 2f20 646f  //rclone.org/ do
+0000b560: 6573 2046 5450 5320 7769 7468 2060 746c  es FTPS with `tl
+0000b570: 733d 6661 6c73 6520 6578 706c 6963 6974  s=false explicit
+0000b580: 5f74 6c73 3d74 7275 6560 0a2a 2060 6c66  _tls=true`.* `lf
+0000b590: 7470 202d 7520 6b2c 7761 726b 202d 7020  tp -u k,wark -p 
+0000b5a0: 3339 3231 2031 3237 2e30 2e30 2e31 202d  3921 127.0.0.1 -
+0000b5b0: 6520 6c73 600a 2a20 606c 6674 7020 2d75  e ls`.* `lftp -u
+0000b5c0: 206b 2c77 6172 6b20 2d70 2033 3939 3020   k,wark -p 3990 
+0000b5d0: 3132 372e 302e 302e 3120 2d65 2027 7365  127.0.0.1 -e 'se
+0000b5e0: 7420 7373 6c3a 7665 7269 6679 2d63 6572  t ssl:verify-cer
+0000b5f0: 7469 6669 6361 7465 206e 6f3b 206c 7327  tificate no; ls'
+0000b600: 600a 0a0a 2323 2077 6562 6461 7620 7365  `...## webdav se
+0000b610: 7276 6572 0a0a 7769 7468 2072 6561 642d  rver..with read-
+0000b620: 7772 6974 6520 7375 7070 6f72 742c 2020  write support,  
+0000b630: 7375 7070 6f72 7473 2077 696e 5850 2061  supports winXP a
+0000b640: 6e64 206c 6174 6572 2c20 6d61 636f 732c  nd later, macos,
+0000b650: 206e 6175 7469 6c75 732f 6776 6673 0a0a   nautilus/gvfs..
+0000b660: 636c 6963 6b20 7468 6520 5b63 6f6e 6e65  click the [conne
+0000b670: 6374 5d28 6874 7470 3a2f 2f31 3237 2e30  ct](http://127.0
+0000b680: 2e30 2e31 3a33 3932 332f 3f68 6329 2062  .0.1:3923/?hc) b
+0000b690: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
+0000b6a0: 7472 6f6c 2d70 616e 656c 2074 6f20 7365  trol-panel to se
+0000b6b0: 6520 636f 6e6e 6563 7469 6f6e 2069 6e73  e connection ins
+0000b6c0: 7472 7563 7469 6f6e 7320 666f 7220 7769  tructions for wi
+0000b6d0: 6e64 6f77 732c 206c 696e 7578 2c20 6d61  ndows, linux, ma
+0000b6e0: 636f 730a 0a67 656e 6572 616c 2075 7361  cos..general usa
+0000b6f0: 6765 3a0a 2a20 6c6f 6769 6e20 7769 7468  ge:.* login with
+0000b700: 2061 6e79 2075 7365 726e 616d 6520 2b20   any username + 
+0000b710: 796f 7572 2070 6173 7377 6f72 642c 206f  your password, o
+0000b720: 7220 7075 7420 796f 7572 2070 6173 7377  r put your passw
+0000b730: 6f72 6420 696e 2074 6865 2075 7365 726e  ord in the usern
+0000b740: 616d 6520 6669 656c 6420 2870 6173 7377  ame field (passw
+0000b750: 6f72 6420 6669 656c 6420 6361 6e20 6265  ord field can be
+0000b760: 2065 6d70 7479 2f77 6861 7465 7665 7229   empty/whatever)
+0000b770: 0a0a 6f6e 206d 6163 6f73 2c20 636f 6e6e  ..on macos, conn
+0000b780: 6563 7420 6672 6f6d 2066 696e 6465 723a  ect from finder:
+0000b790: 0a2a 205b 476f 5d20 2d3e 205b 436f 6e6e  .* [Go] -> [Conn
+0000b7a0: 6563 7420 746f 2053 6572 7665 722e 2e2e  ect to Server...
+0000b7b0: 5d20 2d3e 2068 7474 703a 2f2f 3139 322e  ] -> http://192.
+0000b7c0: 3136 382e 3132 332e 313a 3339 3233 2f0a  168.123.1:3923/.
+0000b7d0: 0a69 6e20 6f72 6465 7220 746f 2067 7261  .in order to gra
+0000b7e0: 6e74 2066 756c 6c20 7772 6974 652d 6163  nt full write-ac
+0000b7f0: 6365 7373 2074 6f20 7765 6264 6176 2063  cess to webdav c
+0000b800: 6c69 656e 7473 2c20 7468 6520 766f 6c66  lients, the volf
+0000b810: 6c61 6720 6064 6177 6020 6d75 7374 2062  lag `daw` must b
+0000b820: 6520 7365 7420 616e 6420 7468 6520 6163  e set and the ac
+0000b830: 636f 756e 7420 6d75 7374 2061 6c73 6f20  count must also 
+0000b840: 6861 7665 2064 656c 6574 652d 6163 6365  have delete-acce
+0000b850: 7373 2028 6f74 6865 7277 6973 6520 7468  ss (otherwise th
+0000b860: 6520 636c 6965 6e74 2077 6f6e 2774 2062  e client won't b
+0000b870: 6520 616c 6c6f 7765 6420 746f 2072 6570  e allowed to rep
+0000b880: 6c61 6365 2074 6865 2063 6f6e 7465 6e74  lace the content
+0000b890: 7320 6f66 2065 7869 7374 696e 6720 6669  s of existing fi
+0000b8a0: 6c65 732c 2077 6869 6368 2069 7320 686f  les, which is ho
+0000b8b0: 7720 7765 6264 6176 2077 6f72 6b73 290a  w webdav works).
+0000b8c0: 0a0a 2323 2320 636f 6e6e 6563 7469 6e67  ..### connecting
+0000b8d0: 2074 6f20 7765 6264 6176 2066 726f 6d20   to webdav from 
+0000b8e0: 7769 6e64 6f77 730a 0a75 7369 6e67 2074  windows..using t
+0000b8f0: 6865 2047 5549 2020 2877 696e 5850 206f  he GUI  (winXP o
+0000b900: 7220 6c61 7465 7229 3a0a 2a20 7269 6768  r later):.* righ
+0000b910: 7463 6c69 636b 205b 6d79 2063 6f6d 7075  tclick [my compu
+0000b920: 7465 725d 202d 3e20 5b6d 6170 206e 6574  ter] -> [map net
+0000b930: 776f 726b 2064 7269 7665 5d20 2d3e 2046  work drive] -> F
+0000b940: 6f6c 6465 723a 2060 6874 7470 3a2f 2f31  older: `http://1
+0000b950: 3932 2e31 3638 2e31 3233 2e31 3a33 3932  92.168.123.1:392
+0000b960: 332f 600a 2020 2a20 6f6e 2077 696e 5850  3/`.  * on winXP
+0000b970: 206f 6e6c 792c 2063 6c69 636b 2074 6865   only, click the
+0000b980: 2060 5369 676e 2075 7020 666f 7220 6f6e   `Sign up for on
+0000b990: 6c69 6e65 2073 746f 7261 6765 6020 6879  line storage` hy
+0000b9a0: 7065 726c 696e 6b20 696e 7374 6561 6420  perlink instead 
+0000b9b0: 616e 6420 7075 7420 7468 6520 5552 4c20  and put the URL 
+0000b9c0: 7468 6572 650a 2020 2a20 7072 6f76 6964  there.  * provid
+0000b9d0: 696e 6720 796f 7572 2070 6173 7377 6f72  ing your passwor
+0000b9e0: 6420 6173 2074 6865 2075 7365 726e 616d  d as the usernam
+0000b9f0: 6520 6973 2072 6563 6f6d 6d65 6e64 6564  e is recommended
+0000ba00: 3b20 7468 6520 7061 7373 776f 7264 2066  ; the password f
+0000ba10: 6965 6c64 2063 616e 2062 6520 616e 7974  ield can be anyt
+0000ba20: 6869 6e67 206f 7220 656d 7074 790a 0a6b  hing or empty..k
+0000ba30: 6e6f 776e 2063 6c69 656e 7420 6275 6773  nown client bugs
+0000ba40: 3a0a 2a20 7769 6e37 2b20 646f 6573 6e27  :.* win7+ doesn'
+0000ba50: 7420 6163 7475 616c 6c79 2073 656e 6420  t actually send 
+0000ba60: 7468 6520 7061 7373 776f 7264 2074 6f20  the password to 
+0000ba70: 7468 6520 7365 7276 6572 2077 6865 6e20  the server when 
+0000ba80: 7265 6175 7468 656e 7469 6361 7469 6e67  reauthenticating
+0000ba90: 2061 6674 6572 2061 2072 6562 6f6f 7420   after a reboot 
+0000baa0: 756e 6c65 7373 2079 6f75 2066 6972 7374  unless you first
+0000bab0: 2074 7279 2074 6f20 6c6f 6769 6e20 7769   try to login wi
+0000bac0: 7468 2061 6e20 696e 636f 7272 6563 7420  th an incorrect 
+0000bad0: 7061 7373 776f 7264 2061 6e64 2074 6865  password and the
+0000bae0: 6e20 7377 6974 6368 2074 6f20 7468 6520  n switch to the 
+0000baf0: 636f 7272 6563 7420 7061 7373 776f 7264  correct password
+0000bb00: 0a20 202a 206f 7220 6a75 7374 2074 7970  .  * or just typ
+0000bb10: 6520 796f 7572 2070 6173 7377 6f72 6420  e your password 
+0000bb20: 696e 746f 2074 6865 2075 7365 726e 616d  into the usernam
+0000bb30: 6520 6669 656c 6420 696e 7374 6561 6420  e field instead 
+0000bb40: 746f 2067 6574 2061 726f 756e 6420 6974  to get around it
+0000bb50: 2065 6e74 6972 656c 790a 2a20 636f 6e6e   entirely.* conn
+0000bb60: 6563 7469 6e67 2074 6f20 6120 666f 6c64  ecting to a fold
+0000bb70: 6572 2077 6869 6368 2061 6c6c 6f77 7320  er which allows 
+0000bb80: 616e 6f6e 796d 6f75 7320 7265 6164 2077  anonymous read w
+0000bb90: 696c 6c20 6d61 6b65 2077 7269 7469 6e67  ill make writing
+0000bba0: 2069 6d70 6f73 7369 626c 652c 2061 7320   impossible, as 
+0000bbb0: 7769 6e64 6f77 7320 6861 7320 6465 6369  windows has deci
+0000bbc0: 6465 6420 6974 2064 6f65 736e 2774 206e  ded it doesn't n
+0000bbd0: 6565 6420 746f 206c 6f67 696e 0a20 202a  eed to login.  *
+0000bbe0: 2077 6f72 6b61 726f 756e 643a 2063 6f6e   workaround: con
+0000bbf0: 6e65 6374 2074 7769 6365 3b20 6669 7273  nect twice; firs
+0000bc00: 7420 746f 2061 2066 6f6c 6465 7220 7768  t to a folder wh
+0000bc10: 6963 6820 7265 7175 6972 6573 2061 7574  ich requires aut
+0000bc20: 682c 2074 6865 6e20 746f 2074 6865 2066  h, then to the f
+0000bc30: 6f6c 6465 7220 796f 7520 6163 7475 616c  older you actual
+0000bc40: 6c79 2077 616e 742c 2061 6e64 206c 6561  ly want, and lea
+0000bc50: 7665 2062 6f74 6820 6f66 2074 686f 7365  ve both of those
+0000bc60: 206d 6f75 6e74 6564 0a2a 2077 696e 372b   mounted.* win7+
+0000bc70: 206d 6179 206f 7065 6e20 6120 6e65 7720   may open a new 
+0000bc80: 7463 7020 636f 6e6e 6563 7469 6f6e 2066  tcp connection f
+0000bc90: 6f72 2065 7665 7279 2066 696c 6520 616e  or every file an
+0000bca0: 6420 736f 6d65 7469 6d65 7320 666f 7267  d sometimes forg
+0000bcb0: 6574 7320 746f 2063 6c6f 7365 2074 6865  ets to close the
+0000bcc0: 6d2c 2065 7665 6e74 7561 6c6c 7920 6e65  m, eventually ne
+0000bcd0: 6564 696e 6720 6120 7265 626f 6f74 0a20  eding a reboot. 
+0000bce0: 202a 206d 6179 6265 204e 4943 2d72 656c   * maybe NIC-rel
+0000bcf0: 6174 6564 2028 3f3f 292c 2068 6170 7065  ated (??), happe
+0000bd00: 6e73 2077 6974 6820 7769 6e31 302d 6c74  ns with win10-lt
+0000bd10: 7363 206f 6e20 6531 3030 3065 2062 7574  sc on e1000e but
+0000bd20: 206e 6f74 2076 6972 7469 6f0a 2a20 7769   not virtio.* wi
+0000bd30: 6e64 6f77 7320 6361 6e6e 6f74 2061 6363  ndows cannot acc
+0000bd40: 6573 7320 666f 6c64 6572 7320 7768 6963  ess folders whic
+0000bd50: 6820 636f 6e74 6169 6e20 6669 6c65 6e61  h contain filena
+0000bd60: 6d65 7320 7769 7468 2069 6e76 616c 6964  mes with invalid
+0000bd70: 2075 6e69 636f 6465 206f 7220 666f 7262   unicode or forb
+0000bd80: 6964 6465 6e20 6368 6172 6163 7465 7273  idden characters
+0000bd90: 2028 603c 3e3a 222f 5c7c 3f2a 6029 2c20   (`<>:"/\|?*`), 
+0000bda0: 6f72 206e 616d 6573 2065 6e64 696e 6720  or names ending 
+0000bdb0: 7769 7468 2060 2e60 0a2a 2077 696e 7870  with `.`.* winxp
+0000bdc0: 2063 616e 6e6f 7420 7368 6f77 2075 6e69   cannot show uni
+0000bdd0: 636f 6465 2063 6861 7261 6374 6572 7320  code characters 
+0000bde0: 6f75 7473 6964 6520 6f66 202a 736f 6d65  outside of *some
+0000bdf0: 2072 616e 6765 2a0a 2020 2a20 6c61 7469   range*.  * lati
+0000be00: 6e2d 3120 6973 2066 696e 652c 2068 6972  n-1 is fine, hir
+0000be10: 6167 616e 6120 6973 206e 6f74 2028 6e6f  agana is not (no
+0000be20: 7420 6576 656e 2061 7320 7368 6966 742d  t even as shift-
+0000be30: 6a69 7320 6f6e 206a 6170 616e 6573 6520  jis on japanese 
+0000be40: 7870 290a 0a0a 2323 2073 6d62 2073 6572  xp)...## smb ser
+0000be50: 7665 720a 0a75 6e73 6166 652c 2073 6c6f  ver..unsafe, slo
+0000be60: 772c 206e 6f74 2072 6563 6f6d 6d65 6e64  w, not recommend
+0000be70: 6564 2066 6f72 2077 616e 2c20 2065 6e61  ed for wan,  ena
+0000be80: 626c 6520 7769 7468 2060 2d2d 736d 6260  ble with `--smb`
+0000be90: 2066 6f72 2072 6561 642d 6f6e 6c79 206f   for read-only o
+0000bea0: 7220 602d 2d73 6d62 7760 2066 6f72 2072  r `--smbw` for r
+0000beb0: 6561 642d 7772 6974 650a 0a63 6c69 636b  ead-write..click
+0000bec0: 2074 6865 205b 636f 6e6e 6563 745d 2868   the [connect](h
+0000bed0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+0000bee0: 3339 3233 2f3f 6863 2920 6275 7474 6f6e  3923/?hc) button
+0000bef0: 2069 6e20 7468 6520 636f 6e74 726f 6c2d   in the control-
+0000bf00: 7061 6e65 6c20 746f 2073 6565 2063 6f6e  panel to see con
+0000bf10: 6e65 6374 696f 6e20 696e 7374 7275 6374  nection instruct
+0000bf20: 696f 6e73 2066 6f72 2077 696e 646f 7773  ions for windows
+0000bf30: 2c20 6c69 6e75 782c 206d 6163 6f73 0a0a  , linux, macos..
+0000bf40: 6465 7065 6e64 656e 6369 6573 3a20 6070  dependencies: `p
+0000bf50: 7974 686f 6e33 202d 6d20 7069 7020 696e  ython3 -m pip in
+0000bf60: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
+0000bf70: 696d 7061 636b 6574 3d3d 302e 3130 2e30  impacket==0.10.0
+0000bf80: 600a 2a20 6e65 7765 7220 7665 7273 696f  `.* newer versio
+0000bf90: 6e73 206f 6620 696d 7061 636b 6574 2077  ns of impacket w
+0000bfa0: 696c 6c20 686f 7065 6675 6c6c 7920 776f  ill hopefully wo
+0000bfb0: 726b 206a 7573 7420 6669 6e65 2062 7574  rk just fine but
+0000bfc0: 2074 6865 7265 2069 7320 6d6f 6e6b 6579   there is monkey
+0000bfd0: 7061 7463 6869 6e67 2073 6f20 6d61 7962  patching so mayb
+0000bfe0: 6520 6e6f 740a 0a73 6f6d 6520 2a2a 4249  e not..some **BI
+0000bff0: 4720 5741 524e 494e 4753 2a2a 2073 7065  G WARNINGS** spe
+0000c000: 6369 6669 6320 746f 2053 4d42 2f43 4946  cific to SMB/CIF
+0000c010: 532c 2069 6e20 6465 6372 6561 7369 6e67  S, in decreasing
+0000c020: 2069 6d70 6f72 7461 6e63 653a 0a2a 206e   importance:.* n
+0000c030: 6f74 2065 6e74 6972 656c 7920 636f 6e66  ot entirely conf
+0000c040: 6964 656e 7420 7468 6174 2072 6561 642d  ident that read-
+0000c050: 6f6e 6c79 2069 7320 7265 6164 2d6f 6e6c  only is read-onl
+0000c060: 790a 2a20 7468 6520 736d 6220 6261 636b  y.* the smb back
+0000c070: 656e 6420 6973 206e 6f74 2066 756c 6c79  end is not fully
+0000c080: 2069 6e74 6567 7261 7465 6420 7769 7468   integrated with
+0000c090: 2076 6673 2c20 6d65 616e 696e 6720 7468   vfs, meaning th
+0000c0a0: 6572 6520 636f 756c 6420 6265 2073 6563  ere could be sec
+0000c0b0: 7572 6974 7920 6973 7375 6573 2028 7061  urity issues (pa
+0000c0c0: 7468 2074 7261 7665 7273 616c 292e 2050  th traversal). P
+0000c0d0: 6c65 6173 6520 7573 6520 602d 2d73 6d62  lease use `--smb
+0000c0e0: 2d70 6f72 7460 2028 7365 6520 6265 6c6f  -port` (see belo
+0000c0f0: 7729 2061 6e64 205b 7072 6973 6f6e 7061  w) and [prisonpa
+0000c100: 7274 795d 282e 2f62 696e 2f70 7269 736f  rty](./bin/priso
+0000c110: 6e70 6172 7479 2e73 6829 0a20 202a 2061  nparty.sh).  * a
+0000c120: 6363 6f75 6e74 2070 6173 7377 6f72 6473  ccount passwords
+0000c130: 2077 6f72 6b20 7065 722d 766f 6c75 6d65   work per-volume
+0000c140: 2061 7320 6578 7065 6374 6564 2c20 6275   as expected, bu
+0000c150: 7420 6163 636f 756e 7420 7065 726d 6973  t account permis
+0000c160: 7369 6f6e 7320 6172 6520 636f 616c 6573  sions are coales
+0000c170: 6365 643b 2061 6c6c 2061 6363 6f75 6e74  ced; all account
+0000c180: 7320 6861 7665 2072 6561 642d 6163 6365  s have read-acce
+0000c190: 7373 2074 6f20 616c 6c20 766f 6c75 6d65  ss to all volume
+0000c1a0: 732c 2061 6e64 2069 6620 6120 7369 6e67  s, and if a sing
+0000c1b0: 6c65 2061 6363 6f75 6e74 2068 6173 2077  le account has w
+0000c1c0: 7269 7465 2d61 6363 6573 7320 746f 2073  rite-access to s
+0000c1d0: 6f6d 6520 766f 6c75 6d65 2074 6865 6e20  ome volume then 
+0000c1e0: 616c 6c20 6f74 6865 7220 6163 636f 756e  all other accoun
+0000c1f0: 7473 2061 6c73 6f20 646f 0a20 2020 202a  ts also do.    *
+0000c200: 2069 6620 6e6f 2061 6363 6f75 6e74 7320   if no accounts 
+0000c210: 6861 7665 2077 7269 7465 2d61 6363 6573  have write-acces
+0000c220: 7320 746f 2061 2073 7065 6369 6669 6320  s to a specific 
+0000c230: 766f 6c75 6d65 2c20 6f72 2069 6620 602d  volume, or if `-
+0000c240: 2d73 6d62 7760 2069 7320 6e6f 7420 7365  -smbw` is not se
+0000c250: 742c 2074 6865 6e20 7772 6974 696e 6720  t, then writing 
+0000c260: 746f 2074 6861 7420 766f 6c75 6d65 2066  to that volume f
+0000c270: 726f 6d20 736d 6220 2a73 686f 756c 642a  rom smb *should*
+0000c280: 2062 6520 696d 706f 7373 6962 6c65 0a20   be impossible. 
+0000c290: 2020 202a 2077 696c 6c20 6265 2066 6978     * will be fix
+0000c2a0: 6564 206f 6e63 6520 5b69 6d70 6163 6b65  ed once [impacke
+0000c2b0: 7420 7630 2e31 312e 305d 2868 7474 7073  t v0.11.0](https
+0000c2c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 5365  ://github.com/Se
+0000c2d0: 6375 7265 4175 7468 436f 7270 2f69 6d70  cureAuthCorp/imp
+0000c2e0: 6163 6b65 742f 636f 6d6d 6974 2f64 3932  acket/commit/d92
+0000c2f0: 3363 3030 6637 3564 3534 6239 3732 6263  3c00f75d54b972bc
+0000c300: 6135 3733 6132 3131 6138 3266 3039 6235  a573a211a82f09b5
+0000c310: 3532 3631 6129 2069 7320 7265 6c65 6173  5261a) is releas
+0000c320: 6564 0a20 202a 205b 7368 6164 6f77 696e  ed.  * [shadowin
+0000c330: 675d 2823 7368 6164 6f77 696e 6729 2070  g](#shadowing) p
+0000c340: 726f 6261 626c 7920 776f 726b 7320 6173  robably works as
+0000c350: 2065 7870 6563 7465 6420 6275 7420 6e6f   expected but no
+0000c360: 2067 7561 7261 6e74 6565 730a 0a61 6e64   guarantees..and
+0000c370: 2073 6f6d 6520 6d69 6e6f 7220 6973 7375   some minor issu
+0000c380: 6573 2c0a 2a20 636c 6965 6e74 7320 6f6e  es,.* clients on
+0000c390: 6c79 2073 6565 2074 6865 2066 6972 7374  ly see the first
+0000c3a0: 207e 3430 3020 6669 6c65 7320 696e 2062   ~400 files in b
+0000c3b0: 6967 2066 6f6c 6465 7273 3b20 5b69 6d70  ig folders; [imp
+0000c3c0: 6163 6b65 7423 3134 3333 5d28 6874 7470  acket#1433](http
+0000c3d0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f53  s://github.com/S
+0000c3e0: 6563 7572 6541 7574 6843 6f72 702f 696d  ecureAuthCorp/im
+0000c3f0: 7061 636b 6574 2f69 7373 7565 732f 3134  packet/issues/14
+0000c400: 3333 290a 2a20 686f 742d 7265 6c6f 6164  33).* hot-reload
+0000c410: 206f 6620 7365 7276 6572 2063 6f6e 6669   of server confi
+0000c420: 6720 2860 2f3f 7265 6c6f 6164 3d63 6667  g (`/?reload=cfg
+0000c430: 6029 2064 6f65 7320 6e6f 7420 696e 636c  `) does not incl
+0000c440: 7564 6520 7468 6520 605b 676c 6f62 616c  ude the `[global
+0000c450: 5d60 2073 6563 7469 6f6e 2028 636f 6d6d  ]` section (comm
+0000c460: 616e 646c 696e 6520 6172 6773 290a 2a20  andline args).* 
+0000c470: 6c69 7374 656e 7320 6f6e 2074 6865 2066  listens on the f
+0000c480: 6972 7374 2049 5076 3420 602d 6960 2069  irst IPv4 `-i` i
+0000c490: 6e74 6572 6661 6365 206f 6e6c 7920 2864  nterface only (d
+0000c4a0: 6566 6175 6c74 203d 203a 3a20 3d20 302e  efault = :: = 0.
+0000c4b0: 302e 302e 3020 3d20 616c 6c29 0a2a 206c  0.0.0 = all).* l
+0000c4c0: 6f67 696e 2064 6f65 736e 2774 2077 6f72  ogin doesn't wor
+0000c4d0: 6b20 6f6e 2077 696e 7870 2c20 6275 7420  k on winxp, but 
+0000c4e0: 616e 6f6e 796d 6f75 7320 6163 6365 7373  anonymous access
+0000c4f0: 2069 7320 6f6b 202d 2d20 7265 6d6f 7665   is ok -- remove
+0000c500: 2061 6c6c 2061 6363 6f75 6e74 7320 6672   all accounts fr
+0000c510: 6f6d 2063 6f70 7970 6172 7479 2063 6f6e  om copyparty con
+0000c520: 6669 6720 666f 7220 7468 6174 2074 6f20  fig for that to 
+0000c530: 776f 726b 0a20 202a 2077 696e 3130 206f  work.  * win10 o
+0000c540: 6e77 6172 6473 2064 6f65 7320 6e6f 7420  nwards does not 
+0000c550: 616c 6c6f 7720 636f 6e6e 6563 7469 6e67  allow connecting
+0000c560: 2061 6e6f 6e79 6d6f 7573 6c79 202f 2077   anonymously / w
+0000c570: 6974 686f 7574 2061 6363 6f75 6e74 730a  ithout accounts.
+0000c580: 2a20 6f6e 2077 696e 646f 7773 2c20 6372  * on windows, cr
+0000c590: 6561 7469 6e67 2061 206e 6577 2066 696c  eating a new fil
+0000c5a0: 6520 7468 726f 7567 6820 7269 6768 7463  e through rightc
+0000c5b0: 6c69 636b 202d 2d3e 206e 6577 202d 2d3e  lick --> new -->
+0000c5c0: 2074 6578 7466 696c 6520 7468 726f 7773   textfile throws
+0000c5d0: 2061 6e20 6572 726f 7220 6475 6520 746f   an error due to
+0000c5e0: 2069 6d70 6163 6b65 7420 6c69 6d69 7461   impacket limita
+0000c5f0: 7469 6f6e 7320 2d2d 2068 6974 204f 4b20  tions -- hit OK 
+0000c600: 616e 6420 4635 2074 6f20 6765 7420 796f  and F5 to get yo
+0000c610: 7572 2066 696c 650a 2a20 7079 7468 6f6e  ur file.* python
+0000c620: 3320 6f6e 6c79 0a2a 2073 6c6f 770a 0a6b  3 only.* slow..k
+0000c630: 6e6f 776e 2063 6c69 656e 7420 6275 6773  nown client bugs
+0000c640: 3a0a 2a20 6f6e 2077 696e 3720 6f6e 6c79  :.* on win7 only
+0000c650: 2c20 602d 2d73 6d62 3160 2069 7320 6d75  , `--smb1` is mu
+0000c660: 6368 2066 6173 7465 7220 7468 616e 2073  ch faster than s
+0000c670: 6d62 3220 2864 6566 6175 6c74 2920 6265  mb2 (default) be
+0000c680: 6361 7573 6520 6974 206b 6565 7073 2072  cause it keeps r
+0000c690: 6573 6361 6e6e 696e 6720 666f 6c64 6572  escanning folder
+0000c6a0: 7320 6f6e 2073 6d62 320a 2020 2a20 686f  s on smb2.  * ho
+0000c6b0: 7765 7665 7220 736d 6231 2069 7320 6275  wever smb1 is bu
+0000c6c0: 6767 7920 616e 6420 6973 206e 6f74 2065  ggy and is not e
+0000c6d0: 6e61 626c 6564 2062 7920 6465 6661 756c  nabled by defaul
+0000c6e0: 7420 6f6e 2077 696e 3130 206f 6e77 6172  t on win10 onwar
+0000c6f0: 6473 0a2a 2077 696e 646f 7773 2063 616e  ds.* windows can
+0000c700: 6e6f 7420 6163 6365 7373 2066 6f6c 6465  not access folde
+0000c710: 7273 2077 6869 6368 2063 6f6e 7461 696e  rs which contain
+0000c720: 2066 696c 656e 616d 6573 2077 6974 6820   filenames with 
+0000c730: 696e 7661 6c69 6420 756e 6963 6f64 6520  invalid unicode 
+0000c740: 6f72 2066 6f72 6269 6464 656e 2063 6861  or forbidden cha
+0000c750: 7261 6374 6572 7320 2860 3c3e 3a22 2f5c  racters (`<>:"/\
+0000c760: 7c3f 2a60 292c 206f 7220 6e61 6d65 7320  |?*`), or names 
+0000c770: 656e 6469 6e67 2077 6974 6820 602e 600a  ending with `.`.
+0000c780: 0a74 6865 2073 6d62 2070 726f 746f 636f  .the smb protoco
+0000c790: 6c20 6c69 7374 656e 7320 6f6e 2054 4350  l listens on TCP
+0000c7a0: 2070 6f72 7420 3434 352c 2077 6869 6368   port 445, which
+0000c7b0: 2069 7320 6120 7072 6976 696c 6567 6564   is a privileged
+0000c7c0: 2070 6f72 7420 6f6e 206c 696e 7578 2061   port on linux a
+0000c7d0: 6e64 206d 6163 6f73 2c20 7768 6963 6820  nd macos, which 
+0000c7e0: 776f 756c 6420 7265 7175 6972 6520 7275  would require ru
+0000c7f0: 6e6e 696e 6720 636f 7079 7061 7274 7920  nning copyparty 
+0000c800: 6173 2072 6f6f 742e 2048 6f77 6576 6572  as root. However
+0000c810: 2c20 7468 6973 2063 616e 2062 6520 6176  , this can be av
+0000c820: 6f69 6465 6420 6279 206c 6973 7465 6e69  oided by listeni
+0000c830: 6e67 206f 6e20 616e 6f74 6865 7220 706f  ng on another po
+0000c840: 7274 2075 7369 6e67 2060 2d2d 736d 622d  rt using `--smb-
+0000c850: 706f 7274 2033 3934 3560 2061 6e64 2074  port 3945` and t
+0000c860: 6865 6e20 7573 696e 6720 4e41 5420 746f  hen using NAT to
+0000c870: 2066 6f72 7761 7264 2074 6865 2074 7261   forward the tra
+0000c880: 6666 6963 2066 726f 6d20 3434 3520 746f  ffic from 445 to
+0000c890: 2074 6865 7265 3b0a 2a20 6f6e 206c 696e   there;.* on lin
+0000c8a0: 7578 3a20 6069 7074 6162 6c65 7320 2d74  ux: `iptables -t
+0000c8b0: 206e 6174 202d 4120 5052 4552 4f55 5449   nat -A PREROUTI
+0000c8c0: 4e47 202d 6920 6574 6830 202d 7020 7463  NG -i eth0 -p tc
+0000c8d0: 7020 2d2d 6470 6f72 7420 3434 3520 2d6a  p --dport 445 -j
+0000c8e0: 2052 4544 4952 4543 5420 2d2d 746f 2d70   REDIRECT --to-p
+0000c8f0: 6f72 7420 3339 3435 600a 0a61 7574 6865  ort 3945`..authe
+0000c900: 6e74 6963 6174 6520 7769 7468 206f 6e65  nticate with one
+0000c910: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+0000c920: 673a 0a2a 2075 7365 726e 616d 6520 6024  g:.* username `$
+0000c930: 7573 6572 6e61 6d65 602c 2070 6173 7377  username`, passw
+0000c940: 6f72 6420 6024 7061 7373 776f 7264 600a  ord `$password`.
+0000c950: 2a20 7573 6572 6e61 6d65 2060 2470 6173  * username `$pas
+0000c960: 7377 6f72 6460 2c20 7061 7373 776f 7264  sword`, password
+0000c970: 2060 6b60 0a0a 0a23 2320 6669 6c65 2069   `k`...## file i
+0000c980: 6e64 6578 696e 670a 0a65 6e61 626c 6573  ndexing..enables
+0000c990: 2064 6564 7570 2061 6e64 206d 7573 6963   dedup and music
+0000c9a0: 2073 6561 7263 6820 2b2b 0a0a 6669 6c65   search ++..file
+0000c9b0: 2069 6e64 6578 696e 6720 7265 6c69 6573   indexing relies
+0000c9c0: 206f 6e20 7477 6f20 6461 7461 6261 7365   on two database
+0000c9d0: 2074 6162 6c65 732c 2074 6865 2075 7032   tables, the up2
+0000c9e0: 6b20 6669 6c65 7472 6565 2028 602d 6532  k filetree (`-e2
+0000c9f0: 6460 2920 616e 6420 7468 6520 6d65 7461  d`) and the meta
+0000ca00: 6461 7461 2074 6167 7320 2860 2d65 3274  data tags (`-e2t
+0000ca10: 6029 2c20 7374 6f72 6564 2069 6e20 602e  `), stored in `.
+0000ca20: 6869 7374 2f75 7032 6b2e 6462 602e 2043  hist/up2k.db`. C
+0000ca30: 6f6e 6669 6775 7261 7469 6f6e 2063 616e  onfiguration can
+0000ca40: 2062 6520 646f 6e65 2074 6872 6f75 6768   be done through
+0000ca50: 2061 7267 756d 656e 7473 2c20 766f 6c66   arguments, volf
+0000ca60: 6c61 6773 2c20 6f72 2061 206d 6978 206f  lags, or a mix o
+0000ca70: 6620 626f 7468 2e0a 0a74 6872 6f75 6768  f both...through
+0000ca80: 2061 7267 756d 656e 7473 3a0a 2a20 602d   arguments:.* `-
+0000ca90: 6532 6460 2065 6e61 626c 6573 2066 696c  e2d` enables fil
+0000caa0: 6520 696e 6465 7869 6e67 206f 6e20 7570  e indexing on up
+0000cab0: 6c6f 6164 0a2a 2060 2d65 3264 7360 2061  load.* `-e2ds` a
+0000cac0: 6c73 6f20 7363 616e 7320 7772 6974 6162  lso scans writab
+0000cad0: 6c65 2066 6f6c 6465 7273 2066 6f72 206e  le folders for n
+0000cae0: 6577 2066 696c 6573 206f 6e20 7374 6172  ew files on star
+0000caf0: 7475 700a 2a20 602d 6532 6473 6160 2061  tup.* `-e2dsa` a
+0000cb00: 6c73 6f20 7363 616e 7320 616c 6c20 6d6f  lso scans all mo
+0000cb10: 756e 7465 6420 766f 6c75 6d65 7320 2869  unted volumes (i
+0000cb20: 6e63 6c75 6469 6e67 2072 6561 646f 6e6c  ncluding readonl
+0000cb30: 7920 6f6e 6573 290a 2a20 602d 6532 7460  y ones).* `-e2t`
+0000cb40: 2065 6e61 626c 6573 206d 6574 6164 6174   enables metadat
+0000cb50: 6120 696e 6465 7869 6e67 206f 6e20 7570  a indexing on up
+0000cb60: 6c6f 6164 0a2a 2060 2d65 3274 7360 2061  load.* `-e2ts` a
+0000cb70: 6c73 6f20 7363 616e 7320 666f 7220 7461  lso scans for ta
+0000cb80: 6773 2069 6e20 616c 6c20 6669 6c65 7320  gs in all files 
+0000cb90: 7468 6174 2064 6f6e 2774 2068 6176 6520  that don't have 
+0000cba0: 7461 6773 2079 6574 0a2a 2060 2d65 3274  tags yet.* `-e2t
+0000cbb0: 7372 6020 616c 736f 2064 656c 6574 6573  sr` also deletes
+0000cbc0: 2061 6c6c 2065 7869 7374 696e 6720 7461   all existing ta
+0000cbd0: 6773 2c20 646f 696e 6720 6120 6675 6c6c  gs, doing a full
+0000cbe0: 2072 6569 6e64 6578 0a2a 2060 2d65 3276   reindex.* `-e2v
+0000cbf0: 6020 7665 7266 6965 7320 6669 6c65 2069  ` verfies file i
+0000cc00: 6e74 6567 7269 7479 2061 7420 7374 6172  ntegrity at star
+0000cc10: 7475 702c 2063 6f6d 7061 7269 6e67 2068  tup, comparing h
+0000cc20: 6173 6865 7320 6672 6f6d 2074 6865 2064  ashes from the d
+0000cc30: 620a 2a20 602d 6532 7675 6020 7061 7463  b.* `-e2vu` patc
+0000cc40: 6865 7320 7468 6520 6461 7461 6261 7365  hes the database
+0000cc50: 2077 6974 6820 7468 6520 6e65 7720 6861   with the new ha
+0000cc60: 7368 6573 2066 726f 6d20 7468 6520 6669  shes from the fi
+0000cc70: 6c65 7379 7374 656d 0a2a 2060 2d65 3276  lesystem.* `-e2v
+0000cc80: 7060 2070 616e 6963 7320 616e 6420 6b69  p` panics and ki
+0000cc90: 6c6c 7320 636f 7079 7061 7274 7920 696e  lls copyparty in
+0000cca0: 7374 6561 640a 2a20 602d 2d78 6c69 6e6b  stead.* `--xlink
+0000ccb0: 6020 656e 6162 6c65 7320 6465 6475 706c  ` enables dedupl
+0000ccc0: 6963 6174 696f 6e20 6163 726f 7373 2076  ication across v
+0000ccd0: 6f6c 756d 6573 0a0a 7468 6520 7361 6d65  olumes..the same
+0000cce0: 2061 7267 756d 656e 7473 2063 616e 2062   arguments can b
+0000ccf0: 6520 7365 7420 6173 2076 6f6c 666c 6167  e set as volflag
+0000cd00: 732c 2069 6e20 6164 6469 7469 6f6e 2074  s, in addition t
+0000cd10: 6f20 6064 3264 602c 2060 6432 6473 602c  o `d2d`, `d2ds`,
+0000cd20: 2060 6432 7460 2c20 6064 3274 7360 2c20   `d2t`, `d2ts`, 
+0000cd30: 6064 3276 6020 666f 7220 6469 7361 626c  `d2v` for disabl
+0000cd40: 696e 673a 0a2a 2060 2d76 207e 2f6d 7573  ing:.* `-v ~/mus
+0000cd50: 6963 3a3a 723a 632c 6532 6473 612c 6532  ic::r:c,e2dsa,e2
+0000cd60: 7473 7260 2064 6f65 7320 6120 6675 6c6c  tsr` does a full
+0000cd70: 2072 6569 6e64 6578 206f 6620 6576 6572   reindex of ever
+0000cd80: 7974 6869 6e67 206f 6e20 7374 6172 7475  ything on startu
+0000cd90: 700a 2a20 602d 7620 7e2f 6d75 7369 633a  p.* `-v ~/music:
+0000cda0: 3a72 3a63 2c64 3264 6020 6469 7361 626c  :r:c,d2d` disabl
+0000cdb0: 6573 202a 2a61 6c6c 2a2a 2069 6e64 6578  es **all** index
+0000cdc0: 696e 672c 2065 7665 6e20 6966 2061 6e79  ing, even if any
+0000cdd0: 2060 2d65 322a 6020 6172 6520 6f6e 0a2a   `-e2*` are on.*
+0000cde0: 2060 2d76 207e 2f6d 7573 6963 3a3a 723a   `-v ~/music::r:
+0000cdf0: 632c 6432 7460 2064 6973 6162 6c65 7320  c,d2t` disables 
+0000ce00: 616c 6c20 602d 6532 742a 6020 2874 6167  all `-e2t*` (tag
+0000ce10: 7329 2c20 646f 6573 206e 6f74 2061 6666  s), does not aff
+0000ce20: 6563 7420 602d 6532 642a 600a 2a20 602d  ect `-e2d*`.* `-
+0000ce30: 7620 7e2f 6d75 7369 633a 3a72 3a63 2c64  v ~/music::r:c,d
+0000ce40: 3264 7360 2064 6973 6162 6c65 7320 6f6e  2ds` disables on
+0000ce50: 2d62 6f6f 7420 7363 616e 733b 206f 6e6c  -boot scans; onl
+0000ce60: 7920 696e 6465 7820 6e65 7720 7570 6c6f  y index new uplo
+0000ce70: 6164 730a 2a20 602d 7620 7e2f 6d75 7369  ads.* `-v ~/musi
+0000ce80: 633a 3a72 3a63 2c64 3274 7360 2073 616d  c::r:c,d2ts` sam
+0000ce90: 6520 6578 6365 7074 206f 6e6c 7920 6166  e except only af
+0000cea0: 6665 6374 696e 6720 7461 6773 0a0a 6e6f  fecting tags..no
+0000ceb0: 7465 3a0a 2a20 7468 6520 7061 7273 6572  te:.* the parser
+0000cec0: 2063 616e 2066 696e 616c 6c79 2068 616e   can finally han
+0000ced0: 646c 6520 6063 2c65 3264 7361 2c65 3274  dle `c,e2dsa,e2t
+0000cee0: 7372 6020 736f 2079 6f75 206e 6f20 6c6f  sr` so you no lo
+0000cef0: 6e67 6572 2068 6176 6520 746f 2060 632c  nger have to `c,
+0000cf00: 6532 6473 613a 632c 6532 7473 7260 0a2a  e2dsa:c,e2tsr`.*
+0000cf10: 2060 6532 7473 7260 2069 7320 7072 6f62   `e2tsr` is prob
+0000cf20: 6162 6c79 2061 6c77 6179 7320 6f76 6572  ably always over
+0000cf30: 6b69 6c6c 2c20 7369 6e63 6520 6065 3264  kill, since `e2d
+0000cf40: 7360 2f60 6532 6473 6160 2077 6f75 6c64  s`/`e2dsa` would
+0000cf50: 2070 6963 6b20 7570 2061 6e79 2066 696c   pick up any fil
+0000cf60: 6520 6d6f 6469 6669 6361 7469 6f6e 7320  e modifications 
+0000cf70: 616e 6420 6065 3274 7360 2077 6f75 6c64  and `e2ts` would
+0000cf80: 2074 6865 6e20 7265 696e 6465 7820 7468   then reindex th
+0000cf90: 6f73 652c 2075 6e6c 6573 7320 7468 6572  ose, unless ther
+0000cfa0: 6520 6973 2061 206e 6577 2063 6f70 7970  e is a new copyp
+0000cfb0: 6172 7479 2076 6572 7369 6f6e 2077 6974  arty version wit
+0000cfc0: 6820 6e65 7720 7061 7273 6572 7320 616e  h new parsers an
+0000cfd0: 6420 7468 6520 7265 6c65 6173 6520 6e6f  d the release no
+0000cfe0: 7465 2073 6179 7320 6f74 6865 7277 6973  te says otherwis
+0000cff0: 650a 2a20 7468 6520 7265 7363 616e 2062  e.* the rescan b
+0000d000: 7574 746f 6e20 696e 2074 6865 2061 646d  utton in the adm
+0000d010: 696e 2070 616e 656c 2068 6173 206e 6f20  in panel has no 
+0000d020: 6566 6665 6374 2075 6e6c 6573 7320 7468  effect unless th
+0000d030: 6520 766f 6c75 6d65 2068 6173 2060 2d65  e volume has `-e
+0000d040: 3264 7360 206f 7220 6869 6768 6572 0a2a  2ds` or higher.*
+0000d050: 2064 6564 7570 6c69 6361 7469 6f6e 2069   deduplication i
+0000d060: 7320 706f 7373 6962 6c65 206f 6e20 7769  s possible on wi
+0000d070: 6e64 6f77 7320 6966 2079 6f75 2072 756e  ndows if you run
+0000d080: 2063 6f70 7970 6172 7479 2061 7320 6164   copyparty as ad
+0000d090: 6d69 6e69 7374 7261 746f 7220 286e 6f74  ministrator (not
+0000d0a0: 2073 6179 696e 6720 796f 7520 7368 6f75   saying you shou
+0000d0b0: 6c64 2129 0a0a 2323 2320 6578 636c 7564  ld!)..### exclud
+0000d0c0: 652d 7061 7474 6572 6e73 0a0a 746f 2073  e-patterns..to s
+0000d0d0: 6176 6520 736f 6d65 2074 696d 652c 2020  ave some time,  
+0000d0e0: 796f 7520 6361 6e20 7072 6f76 6964 6520  you can provide 
+0000d0f0: 6120 7265 6765 7820 7061 7474 6572 6e20  a regex pattern 
+0000d100: 666f 7220 6669 6c65 7061 7468 7320 746f  for filepaths to
+0000d110: 206f 6e6c 7920 696e 6465 7820 6279 2066   only index by f
+0000d120: 696c 656e 616d 652f 7061 7468 2f73 697a  ilename/path/siz
+0000d130: 652f 6c61 7374 2d6d 6f64 6966 6965 6420  e/last-modified 
+0000d140: 2861 6e64 206e 6f74 2074 6865 2068 6173  (and not the has
+0000d150: 6820 6f66 2074 6865 2066 696c 6520 636f  h of the file co
+0000d160: 6e74 656e 7473 2920 6279 2073 6574 7469  ntents) by setti
+0000d170: 6e67 2060 2d2d 6e6f 2d68 6173 6820 5c2e  ng `--no-hash \.
+0000d180: 6973 6f24 6020 6f72 2074 6865 2076 6f6c  iso$` or the vol
+0000d190: 666c 6167 2060 3a63 2c6e 6f68 6173 683d  flag `:c,nohash=
+0000d1a0: 5c2e 6973 6f24 602c 2074 6869 7320 6861  \.iso$`, this ha
+0000d1b0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
+0000d1c0: 636f 6e73 6571 7565 6e63 6573 3a0a 2a20  consequences:.* 
+0000d1d0: 696e 6974 6961 6c20 696e 6465 7869 6e67  initial indexing
+0000d1e0: 2069 7320 7761 7920 6661 7374 6572 2c20   is way faster, 
+0000d1f0: 6573 7065 6369 616c 6c79 2077 6865 6e20  especially when 
+0000d200: 7468 6520 766f 6c75 6d65 2069 7320 6f6e  the volume is on
+0000d210: 2061 206e 6574 776f 726b 2064 6973 6b0a   a network disk.
+0000d220: 2a20 6d61 6b65 7320 6974 2069 6d70 6f73  * makes it impos
+0000d230: 7369 626c 6520 746f 205b 6669 6c65 2d73  sible to [file-s
+0000d240: 6561 7263 685d 2823 6669 6c65 2d73 6561  earch](#file-sea
+0000d250: 7263 6829 0a2a 2069 6620 736f 6d65 6f6e  rch).* if someon
+0000d260: 6520 7570 6c6f 6164 7320 7468 6520 7361  e uploads the sa
+0000d270: 6d65 2066 696c 6520 636f 6e74 656e 7473  me file contents
+0000d280: 2c20 7468 6520 7570 6c6f 6164 2077 696c  , the upload wil
+0000d290: 6c20 6e6f 7420 6265 2064 6574 6563 7465  l not be detecte
+0000d2a0: 6420 6173 2061 2064 7570 652c 2073 6f20  d as a dupe, so 
+0000d2b0: 6974 2077 696c 6c20 6e6f 7420 6765 7420  it will not get 
+0000d2c0: 7379 6d6c 696e 6b65 6420 6f72 2072 656a  symlinked or rej
+0000d2d0: 6563 7465 640a 0a73 696d 696c 6172 6c79  ected..similarly
+0000d2e0: 2c20 796f 7520 6361 6e20 6675 6c6c 7920  , you can fully 
+0000d2f0: 6967 6e6f 7265 2066 696c 6573 2f66 6f6c  ignore files/fol
+0000d300: 6465 7273 2075 7369 6e67 2060 2d2d 6e6f  ders using `--no
+0000d310: 2d69 6478 205b 2e2e 2e5d 6020 616e 6420  -idx [...]` and 
+0000d320: 603a 632c 6e6f 6964 783d 5c2e 6973 6f24  `:c,noidx=\.iso$
+0000d330: 600a 0a69 6620 796f 7520 7365 7420 602d  `..if you set `-
+0000d340: 2d6e 6f2d 6861 7368 205b 2e2e 2e5d 6020  -no-hash [...]` 
+0000d350: 676c 6f62 616c 6c79 2c20 796f 7520 6361  globally, you ca
+0000d360: 6e20 656e 6162 6c65 2068 6173 6869 6e67  n enable hashing
+0000d370: 2066 6f72 2073 7065 6369 6669 6320 766f   for specific vo
+0000d380: 6c75 6d65 7320 7573 696e 6720 666c 6167  lumes using flag
+0000d390: 2060 3a63 2c6e 6f68 6173 683d 600a 0a23   `:c,nohash=`..#
+0000d3a0: 2323 2066 696c 6573 7973 7465 6d20 6775  ## filesystem gu
+0000d3b0: 6172 6473 0a0a 6176 6f69 6420 7472 6176  ards..avoid trav
+0000d3c0: 6572 7369 6e67 2069 6e74 6f20 6f74 6865  ersing into othe
+0000d3d0: 7220 6669 6c65 7379 7374 656d 7320 2075  r filesystems  u
+0000d3e0: 7369 6e67 2060 2d2d 7864 6576 6020 2f20  sing `--xdev` / 
+0000d3f0: 766f 6c66 6c61 6720 603a 632c 7864 6576  volflag `:c,xdev
+0000d400: 602c 2073 6b69 7070 696e 6720 616e 7920  `, skipping any 
+0000d410: 7379 6d6c 696e 6b73 206f 7220 6269 6e64  symlinks or bind
+0000d420: 2d6d 6f75 6e74 7320 746f 2061 6e6f 7468  -mounts to anoth
+0000d430: 6572 2048 4444 2066 6f72 2065 7861 6d70  er HDD for examp
+0000d440: 6c65 0a0a 616e 642f 6f72 2079 6f75 2063  le..and/or you c
+0000d450: 616e 2060 2d2d 7876 6f6c 6020 2f20 603a  an `--xvol` / `:
+0000d460: 632c 7876 6f6c 6020 746f 2069 676e 6f72  c,xvol` to ignor
+0000d470: 6520 616c 6c20 7379 6d6c 696e 6b73 206c  e all symlinks l
+0000d480: 6561 7669 6e67 2074 6865 2076 6f6c 756d  eaving the volum
+0000d490: 6527 7320 746f 7020 6469 7265 6374 6f72  e's top director
+0000d4a0: 792c 2062 7574 2073 7469 6c6c 2061 6c6c  y, but still all
+0000d4b0: 6f77 2062 696e 642d 6d6f 756e 7473 2070  ow bind-mounts p
+0000d4c0: 6f69 6e74 696e 6720 656c 7365 7768 6572  ointing elsewher
+0000d4d0: 650a 0a2a 2073 796d 6c69 6e6b 7320 6172  e..* symlinks ar
+0000d4e0: 6520 7065 726d 6974 7465 6420 7769 7468  e permitted with
+0000d4f0: 2060 7876 6f6c 6020 6966 2074 6865 7920   `xvol` if they 
+0000d500: 706f 696e 7420 696e 746f 2061 6e6f 7468  point into anoth
+0000d510: 6572 2076 6f6c 756d 6520 7768 6572 6520  er volume where 
+0000d520: 7468 6520 7573 6572 2068 6173 2074 6865  the user has the
+0000d530: 2073 616d 6520 6c65 7665 6c20 6f66 2061   same level of a
+0000d540: 6363 6573 730a 0a74 6865 7365 206f 7074  ccess..these opt
+0000d550: 696f 6e73 2077 696c 6c20 7265 6475 6365  ions will reduce
+0000d560: 2070 6572 666f 726d 616e 6365 3b20 756e   performance; un
+0000d570: 6c69 6b65 6c79 2077 6f72 7374 2d63 6173  likely worst-cas
+0000d580: 6520 6573 7469 6d61 7465 7320 6172 6520  e estimates are 
+0000d590: 3134 2520 7265 6475 6374 696f 6e20 666f  14% reduction fo
+0000d5a0: 7220 6469 7265 6374 6f72 7920 6c69 7374  r directory list
+0000d5b0: 696e 6773 2c20 3335 2520 666f 7220 646f  ings, 35% for do
+0000d5c0: 776e 6c6f 6164 2d61 732d 7461 720a 0a61  wnload-as-tar..a
+0000d5d0: 7320 6f66 2063 6f70 7970 6172 7479 2076  s of copyparty v
+0000d5e0: 312e 372e 3020 7468 6573 6520 6f70 7469  1.7.0 these opti
+0000d5f0: 6f6e 7320 616c 736f 2070 7265 7665 6e74  ons also prevent
+0000d600: 2066 696c 6520 6163 6365 7373 2061 7420   file access at 
+0000d610: 7275 6e74 696d 6520 2d2d 2069 6e20 7072  runtime -- in pr
+0000d620: 6576 696f 7573 2076 6572 7369 6f6e 7320  evious versions 
+0000d630: 6974 2077 6173 206a 7573 7420 6869 6e74  it was just hint
+0000d640: 7320 666f 7220 7468 6520 696e 6465 7865  s for the indexe
+0000d650: 720a 0a23 2323 2070 6572 696f 6469 6320  r..### periodic 
+0000d660: 7265 7363 616e 0a0a 6669 6c65 7379 7374  rescan..filesyst
+0000d670: 656d 206d 6f6e 6974 6f72 696e 673b 2020  em monitoring;  
+0000d680: 6966 2063 6f70 7970 6172 7479 2069 7320  if copyparty is 
+0000d690: 6e6f 7420 7468 6520 6f6e 6c79 2073 6f66  not the only sof
+0000d6a0: 7477 6172 6520 646f 696e 6720 7374 7566  tware doing stuf
+0000d6b0: 6620 6f6e 2079 6f75 7220 6669 6c65 7379  f on your filesy
+0000d6c0: 7374 656d 2c20 796f 7520 6d61 7920 7761  stem, you may wa
+0000d6d0: 6e74 2074 6f20 656e 6162 6c65 2070 6572  nt to enable per
+0000d6e0: 696f 6469 6320 7265 7363 616e 7320 746f  iodic rescans to
+0000d6f0: 206b 6565 7020 7468 6520 696e 6465 7820   keep the index 
+0000d700: 7570 2074 6f20 6461 7465 0a0a 6172 6775  up to date..argu
+0000d710: 6d65 6e74 2060 2d2d 7265 2d6d 6178 6167  ment `--re-maxag
+0000d720: 6520 3630 6020 7769 6c6c 2072 6573 6361  e 60` will resca
+0000d730: 6e20 616c 6c20 766f 6c75 6d65 7320 6576  n all volumes ev
+0000d740: 6572 7920 3630 2073 6563 2c20 7361 6d65  ery 60 sec, same
+0000d750: 2061 7320 766f 6c66 6c61 6720 603a 632c   as volflag `:c,
+0000d760: 7363 616e 3d36 3060 2074 6f20 7370 6563  scan=60` to spec
+0000d770: 6966 7920 6974 2070 6572 2d76 6f6c 756d  ify it per-volum
+0000d780: 650a 0a75 706c 6f61 6473 2061 7265 2064  e..uploads are d
+0000d790: 6973 6162 6c65 6420 7768 696c 6520 6120  isabled while a 
+0000d7a0: 7265 7363 616e 2069 7320 6861 7070 656e  rescan is happen
+0000d7b0: 696e 672c 2073 6f20 7265 7363 616e 7320  ing, so rescans 
+0000d7c0: 7769 6c6c 2062 6520 6465 6c61 7965 6420  will be delayed 
+0000d7d0: 6279 2060 2d2d 6462 2d61 6374 6020 2864  by `--db-act` (d
+0000d7e0: 6566 6175 6c74 2031 3020 7365 6329 2077  efault 10 sec) w
+0000d7f0: 6865 6e20 7468 6572 6520 6973 2077 7269  hen there is wri
+0000d800: 7465 2d61 6374 6976 6974 7920 676f 696e  te-activity goin
+0000d810: 6720 6f6e 2028 7570 6c6f 6164 732c 2072  g on (uploads, r
+0000d820: 656e 616d 6573 2c20 2e2e 2e29 0a0a 0a23  enames, ...)...#
+0000d830: 2320 7570 6c6f 6164 2072 756c 6573 0a0a  # upload rules..
+0000d840: 7365 7420 7570 6c6f 6164 2072 756c 6573  set upload rules
+0000d850: 2075 7369 6e67 2076 6f6c 666c 6167 732c   using volflags,
+0000d860: 2020 736f 6d65 2065 7861 6d70 6c65 733a    some examples:
+0000d870: 0a0a 2a20 603a 632c 737a 3d31 6b2d 336d  ..* `:c,sz=1k-3m
+0000d880: 6020 7365 7473 2061 6c6c 6f77 6564 2066  ` sets allowed f
+0000d890: 696c 6573 697a 6520 6265 7477 6565 6e20  ilesize between 
+0000d8a0: 3120 4b69 4220 616e 6420 3320 4d69 4220  1 KiB and 3 MiB 
+0000d8b0: 696e 636c 7573 6976 6520 2873 7566 6669  inclusive (suffi
+0000d8c0: 7865 733a 2060 6260 2c20 606b 602c 2060  xes: `b`, `k`, `
+0000d8d0: 6d60 2c20 6067 6029 0a2a 2060 3a63 2c64  m`, `g`).* `:c,d
+0000d8e0: 663d 3467 6020 626c 6f63 6b20 7570 6c6f  f=4g` block uplo
+0000d8f0: 6164 7320 6966 2074 6865 7265 2077 6f75  ads if there wou
+0000d900: 6c64 2062 6520 6c65 7373 2074 6861 6e20  ld be less than 
+0000d910: 3420 4769 4220 6672 6565 2064 6973 6b20  4 GiB free disk 
+0000d920: 7370 6163 6520 6166 7465 7277 6172 6473  space afterwards
+0000d930: 0a2a 2060 3a63 2c6e 6f73 7562 6020 6469  .* `:c,nosub` di
+0000d940: 7361 6c6c 6f77 2075 706c 6f61 6469 6e67  sallow uploading
+0000d950: 2069 6e74 6f20 7375 6264 6972 6563 746f   into subdirecto
+0000d960: 7269 6573 3b20 676f 6573 2077 656c 6c20  ries; goes well 
+0000d970: 7769 7468 2060 726f 746e 6020 616e 6420  with `rotn` and 
+0000d980: 6072 6f74 6660 3a0a 2a20 603a 632c 726f  `rotf`:.* `:c,ro
+0000d990: 746e 3d31 3030 302c 3260 206d 6f76 6573  tn=1000,2` moves
+0000d9a0: 2075 706c 6f61 6473 2069 6e74 6f20 7375   uploads into su
+0000d9b0: 6266 6f6c 6465 7273 2c20 7570 2074 6f20  bfolders, up to 
+0000d9c0: 3130 3030 2066 696c 6573 2069 6e20 6561  1000 files in ea
+0000d9d0: 6368 2066 6f6c 6465 7220 6265 666f 7265  ch folder before
+0000d9e0: 206d 616b 696e 6720 6120 6e65 7720 6f6e   making a new on
+0000d9f0: 652c 2074 776f 206c 6576 656c 7320 6465  e, two levels de
+0000da00: 6570 2028 6d75 7374 2062 6520 6174 206c  ep (must be at l
+0000da10: 6561 7374 2031 290a 2a20 603a 632c 726f  east 1).* `:c,ro
+0000da20: 7466 3d25 592f 256d 2f25 642f 2548 6020  tf=%Y/%m/%d/%H` 
+0000da30: 656e 666f 7263 6573 2066 696c 6573 2074  enforces files t
+0000da40: 6f20 6265 2075 706c 6f61 6465 6420 696e  o be uploaded in
+0000da50: 746f 2061 2073 7472 7563 7475 7265 206f  to a structure o
+0000da60: 6620 7375 6266 6f6c 6465 7273 2061 6363  f subfolders acc
+0000da70: 6f72 6469 6e67 2074 6f20 7468 6174 2064  ording to that d
+0000da80: 6174 6520 666f 726d 6174 0a20 202a 2069  ate format.  * i
+0000da90: 6620 736f 6d65 6f6e 6520 7570 6c6f 6164  f someone upload
+0000daa0: 7320 746f 2060 2f66 6f6f 2f62 6172 6020  s to `/foo/bar` 
+0000dab0: 7468 6520 7061 7468 2077 6f75 6c64 2062  the path would b
+0000dac0: 6520 7265 7772 6974 7465 6e20 746f 2060  e rewritten to `
+0000dad0: 2f66 6f6f 2f62 6172 2f32 3032 312f 3038  /foo/bar/2021/08
+0000dae0: 2f30 362f 3233 6020 666f 7220 6578 616d  /06/23` for exam
+0000daf0: 706c 650a 2020 2a20 6275 7420 7468 6520  ple.  * but the 
+0000db00: 6163 7475 616c 2076 616c 7565 2069 7320  actual value is 
+0000db10: 6e6f 7420 7665 7269 6669 6564 2c20 6a75  not verified, ju
+0000db20: 7374 2074 6865 2073 7472 7563 7475 7265  st the structure
+0000db30: 2c20 736f 2074 6865 2075 706c 6f61 6465  , so the uploade
+0000db40: 7220 6361 6e20 6368 6f6f 7365 2061 6e79  r can choose any
+0000db50: 2076 616c 7565 7320 7768 6963 6820 636f   values which co
+0000db60: 6e66 6f72 6d20 746f 2074 6865 2066 6f72  nform to the for
+0000db70: 6d61 7420 7374 7269 6e67 0a20 2020 202a  mat string.    *
+0000db80: 206a 7573 7420 746f 2061 766f 6964 2061   just to avoid a
+0000db90: 6464 6974 696f 6e61 6c20 636f 6d70 6c65  dditional comple
+0000dba0: 7869 7479 2069 6e20 7570 326b 2077 6869  xity in up2k whi
+0000dbb0: 6368 2069 7320 656e 6f75 6768 206f 6620  ch is enough of 
+0000dbc0: 6120 6d65 7373 2061 6c72 6561 6479 0a2a  a mess already.*
+0000dbd0: 2060 3a63 2c6c 6966 6574 696d 653d 3330   `:c,lifetime=30
+0000dbe0: 3060 2064 656c 6574 6520 7570 6c6f 6164  0` delete upload
+0000dbf0: 6564 2066 696c 6573 2077 6865 6e20 7468  ed files when th
+0000dc00: 6579 2062 6563 6f6d 6520 3520 6d69 6e75  ey become 5 minu
+0000dc10: 7465 7320 6f6c 640a 0a79 6f75 2063 616e  tes old..you can
+0000dc20: 2061 6c73 6f20 7365 7420 7472 616e 7361   also set transa
+0000dc30: 6374 696f 6e20 6c69 6d69 7473 2077 6869  ction limits whi
+0000dc40: 6368 2061 7070 6c79 2070 6572 2d49 5020  ch apply per-IP 
+0000dc50: 616e 6420 7065 722d 766f 6c75 6d65 2c20  and per-volume, 
+0000dc60: 6275 7420 7468 6573 6520 6173 7375 6d65  but these assume
+0000dc70: 2060 2d6a 2031 6020 2864 6566 6175 6c74   `-j 1` (default
+0000dc80: 2920 6f74 6865 7277 6973 6520 7468 6520  ) otherwise the 
+0000dc90: 6c69 6d69 7473 2077 696c 6c20 6265 206f  limits will be o
+0000dca0: 6666 2c20 666f 7220 6578 616d 706c 6520  ff, for example 
+0000dcb0: 602d 6a20 3460 2077 6f75 6c64 2061 6c6c  `-j 4` would all
+0000dcc0: 6f77 2061 6e79 7768 6572 6520 6265 7477  ow anywhere betw
+0000dcd0: 6565 6e20 3178 2061 6e64 2034 7820 7468  een 1x and 4x th
+0000dce0: 6520 6c69 6d69 7473 2079 6f75 2073 6574  e limits you set
+0000dcf0: 2064 6570 656e 6469 6e67 206f 6e20 7768   depending on wh
+0000dd00: 6963 6820 7072 6f63 6573 7369 6e67 206e  ich processing n
+0000dd10: 6f64 6520 7468 6520 636c 6965 6e74 2067  ode the client g
+0000dd20: 6574 7320 726f 7574 6564 2074 6f0a 0a2a  ets routed to..*
+0000dd30: 2060 3a63 2c6d 6178 6e3d 3235 302c 3336   `:c,maxn=250,36
+0000dd40: 3030 6020 616c 6c6f 7773 2032 3530 2066  00` allows 250 f
+0000dd50: 696c 6573 206f 7665 7220 3120 686f 7572  iles over 1 hour
+0000dd60: 2066 726f 6d20 6561 6368 2049 5020 2874   from each IP (t
+0000dd70: 7261 636b 6564 2070 6572 2d76 6f6c 756d  racked per-volum
+0000dd80: 6529 0a2a 2060 3a63 2c6d 6178 623d 3167  e).* `:c,maxb=1g
+0000dd90: 2c33 3030 6020 616c 6c6f 7773 2031 2047  ,300` allows 1 G
+0000dda0: 6942 2074 6f74 616c 206f 7665 7220 3520  iB total over 5 
+0000ddb0: 6d69 6e75 7465 7320 6672 6f6d 2065 6163  minutes from eac
+0000ddc0: 6820 4950 2028 7472 6163 6b65 6420 7065  h IP (tracked pe
+0000ddd0: 722d 766f 6c75 6d65 290a 0a0a 2323 2063  r-volume)...## c
+0000dde0: 6f6d 7072 6573 7320 7570 6c6f 6164 730a  ompress uploads.
+0000ddf0: 0a66 696c 6573 2063 616e 2062 6520 6175  .files can be au
+0000de00: 746f 636f 6d70 7265 7373 6564 206f 6e20  tocompressed on 
+0000de10: 7570 6c6f 6164 2c20 2065 6974 6865 7220  upload,  either 
+0000de20: 6f6e 2075 7365 722d 7265 7175 6573 7420  on user-request 
+0000de30: 2869 6620 636f 6e66 6967 2061 6c6c 6f77  (if config allow
+0000de40: 7329 206f 7220 666f 7263 6564 2062 7920  s) or forced by 
+0000de50: 7365 7276 6572 2d63 6f6e 6669 670a 0a2a  server-config..*
+0000de60: 2076 6f6c 666c 6167 2060 677a 6020 616c   volflag `gz` al
+0000de70: 6c6f 7773 2067 7a20 636f 6d70 7265 7373  lows gz compress
+0000de80: 696f 6e0a 2a20 766f 6c66 6c61 6720 6078  ion.* volflag `x
+0000de90: 7a60 2061 6c6c 6f77 7320 6c7a 6d61 2063  z` allows lzma c
+0000dea0: 6f6d 7072 6573 7369 6f6e 0a2a 2076 6f6c  ompression.* vol
+0000deb0: 666c 6167 2060 706b 6020 2a2a 666f 7263  flag `pk` **forc
+0000dec0: 6573 2a2a 2063 6f6d 7072 6573 7369 6f6e  es** compression
+0000ded0: 206f 6e20 616c 6c20 6669 6c65 730a 2a20   on all files.* 
+0000dee0: 7572 6c20 7061 7261 6d65 7465 7220 6070  url parameter `p
+0000def0: 6b60 2072 6571 7565 7374 7320 636f 6d70  k` requests comp
+0000df00: 7265 7373 696f 6e20 7769 7468 2073 6572  ression with ser
+0000df10: 7665 722d 6465 6661 756c 7420 616c 676f  ver-default algo
+0000df20: 7269 7468 6d0a 2a20 7572 6c20 7061 7261  rithm.* url para
+0000df30: 6d65 7465 7220 6067 7a60 206f 7220 6078  meter `gz` or `x
+0000df40: 7a60 2072 6571 7565 7374 7320 636f 6d70  z` requests comp
+0000df50: 7265 7373 696f 6e20 7769 7468 2061 2073  ression with a s
+0000df60: 7065 6369 6669 6320 616c 676f 7269 7468  pecific algorith
+0000df70: 6d0a 2a20 7572 6c20 7061 7261 6d65 7465  m.* url paramete
+0000df80: 7220 6078 7a60 2072 6571 7565 7374 7320  r `xz` requests 
+0000df90: 787a 2063 6f6d 7072 6573 7369 6f6e 0a0a  xz compression..
+0000dfa0: 7468 696e 6773 2074 6f20 6e6f 7465 2c0a  things to note,.
+0000dfb0: 2a20 7468 6520 6067 7a60 2061 6e64 2060  * the `gz` and `
+0000dfc0: 787a 6020 6172 6775 6d65 6e74 7320 7461  xz` arguments ta
+0000dfd0: 6b65 2061 2073 696e 676c 6520 6f70 7469  ke a single opti
+0000dfe0: 6f6e 616c 2061 7267 756d 656e 742c 2074  onal argument, t
+0000dff0: 6865 2063 6f6d 7072 6573 7369 6f6e 206c  he compression l
+0000e000: 6576 656c 2028 7261 6e67 6520 3020 746f  evel (range 0 to
+0000e010: 2039 290a 2a20 7468 6520 6070 6b60 2076   9).* the `pk` v
+0000e020: 6f6c 666c 6167 2074 616b 6573 2074 6865  olflag takes the
+0000e030: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000e040: 6e74 2060 414c 474f 5249 5448 4d2c 4c45  nt `ALGORITHM,LE
+0000e050: 5645 4c60 2077 6869 6368 2077 696c 6c20  VEL` which will 
+0000e060: 7468 656e 2062 6520 666f 7263 6564 2066  then be forced f
+0000e070: 6f72 2061 6c6c 2075 706c 6f61 6473 2c20  or all uploads, 
+0000e080: 666f 7220 6578 616d 706c 6520 6067 7a2c  for example `gz,
+0000e090: 3960 206f 7220 6078 7a2c 3060 0a2a 2064  9` or `xz,0`.* d
+0000e0a0: 6566 6175 6c74 2063 6f6d 7072 6573 7369  efault compressi
+0000e0b0: 6f6e 2069 7320 677a 6970 206c 6576 656c  on is gzip level
+0000e0c0: 2039 0a2a 2061 6c6c 2075 706c 6f61 6420   9.* all upload 
+0000e0d0: 6d65 7468 6f64 7320 6578 6365 7074 2075  methods except u
+0000e0e0: 7032 6b20 6172 6520 7375 7070 6f72 7465  p2k are supporte
+0000e0f0: 640a 2a20 7468 6520 6669 6c65 7320 7769  d.* the files wi
+0000e100: 6c6c 2062 6520 696e 6465 7865 6420 6166  ll be indexed af
+0000e110: 7465 7220 636f 6d70 7265 7373 696f 6e2c  ter compression,
+0000e120: 2073 6f20 6475 7065 2d64 6574 6563 7469   so dupe-detecti
+0000e130: 6f6e 2061 6e64 2066 696c 652d 7365 6172  on and file-sear
+0000e140: 6368 2077 696c 6c20 6e6f 7420 776f 726b  ch will not work
+0000e150: 2061 7320 6578 7065 6374 6564 0a0a 736f   as expected..so
+0000e160: 6d65 2065 7861 6d70 6c65 732c 0a2a 2060  me examples,.* `
+0000e170: 2d76 2069 6e63 3a69 6e63 3a77 3a63 2c70  -v inc:inc:w:c,p
+0000e180: 6b3d 787a 2c30 6020 200a 2020 666f 6c64  k=xz,0`  .  fold
+0000e190: 6572 206e 616d 6564 2069 6e63 2c20 7368  er named inc, sh
+0000e1a0: 6172 6564 2061 7420 696e 632c 2077 7269  ared at inc, wri
+0000e1b0: 7465 2d6f 6e6c 7920 666f 7220 6576 6572  te-only for ever
+0000e1c0: 796f 6e65 2c20 666f 7263 6573 2078 7a20  yone, forces xz 
+0000e1d0: 636f 6d70 7265 7373 696f 6e20 6174 206c  compression at l
+0000e1e0: 6576 656c 2030 0a2a 2060 2d76 2069 6e63  evel 0.* `-v inc
+0000e1f0: 3a69 6e63 3a77 3a63 2c70 6b60 2020 0a20  :inc:w:c,pk`  . 
+0000e200: 2073 616d 6520 7772 6974 652d 6f6e 6c79   same write-only
+0000e210: 2069 6e63 2c20 6275 7420 666f 7263 6573   inc, but forces
+0000e220: 2067 7a20 636f 6d70 7265 7373 696f 6e20   gz compression 
+0000e230: 2864 6566 6175 6c74 2920 696e 7374 6561  (default) instea
+0000e240: 6420 6f66 2078 7a0a 2a20 602d 7620 696e  d of xz.* `-v in
+0000e250: 633a 696e 633a 773a 632c 677a 6020 200a  c:inc:w:c,gz`  .
+0000e260: 2020 616c 6c6f 7773 2028 6275 7420 646f    allows (but do
+0000e270: 6573 206e 6f74 2066 6f72 6365 2920 677a  es not force) gz
+0000e280: 2063 6f6d 7072 6573 7369 6f6e 2069 6620   compression if 
+0000e290: 636c 6965 6e74 2075 706c 6f61 6473 2074  client uploads t
+0000e2a0: 6f20 602f 696e 633f 706b 6020 6f72 2060  o `/inc?pk` or `
+0000e2b0: 2f69 6e63 3f67 7a60 206f 7220 602f 696e  /inc?gz` or `/in
+0000e2c0: 633f 677a 3d34 600a 0a0a 2323 206f 7468  c?gz=4`...## oth
+0000e2d0: 6572 2066 6c61 6773 0a0a 2a20 603a 632c  er flags..* `:c,
+0000e2e0: 6d61 6769 6360 2065 6e61 626c 6573 2066  magic` enables f
+0000e2f0: 696c 6574 7970 6520 6465 7465 6374 696f  iletype detectio
+0000e300: 6e20 666f 7220 6e61 6d65 6c65 7373 2075  n for nameless u
+0000e310: 706c 6f61 6473 2c20 7361 6d65 2061 7320  ploads, same as 
+0000e320: 602d 2d6d 6167 6963 600a 2020 2a20 6e65  `--magic`.  * ne
+0000e330: 6564 7320 6874 7470 733a 2f2f 7079 7069  eds https://pypi
+0000e340: 2e6f 7267 2f70 726f 6a65 6374 2f70 7974  .org/project/pyt
+0000e350: 686f 6e2d 6d61 6769 632f 2060 7079 7468  hon-magic/ `pyth
+0000e360: 6f6e 3320 2d6d 2070 6970 2069 6e73 7461  on3 -m pip insta
+0000e370: 6c6c 202d 2d75 7365 7220 2d55 2070 7974  ll --user -U pyt
+0000e380: 686f 6e2d 6d61 6769 6360 0a20 202a 206f  hon-magic`.  * o
+0000e390: 6e20 7769 6e64 6f77 7320 6772 6162 2074  n windows grab t
+0000e3a0: 6869 7320 696e 7374 6561 6420 6070 7974  his instead `pyt
+0000e3b0: 686f 6e33 202d 6d20 7069 7020 696e 7374  hon3 -m pip inst
+0000e3c0: 616c 6c20 2d2d 7573 6572 202d 5520 7079  all --user -U py
+0000e3d0: 7468 6f6e 2d6d 6167 6963 2d62 696e 600a  thon-magic-bin`.
+0000e3e0: 0a0a 2323 2064 6174 6162 6173 6520 6c6f  ..## database lo
+0000e3f0: 6361 7469 6f6e 0a0a 696e 2d76 6f6c 756d  cation..in-volum
+0000e400: 6520 2860 2e68 6973 742f 7570 326b 2e64  e (`.hist/up2k.d
+0000e410: 6260 2c20 6465 6661 756c 7429 206f 7220  b`, default) or 
+0000e420: 736f 6d65 7768 6572 6520 656c 7365 0a0a  somewhere else..
+0000e430: 636f 7079 7061 7274 7920 6372 6561 7465  copyparty create
+0000e440: 7320 6120 7375 6266 6f6c 6465 7220 6e61  s a subfolder na
+0000e450: 6d65 6420 602e 6869 7374 6020 696e 7369  med `.hist` insi
+0000e460: 6465 2065 6163 6820 766f 6c75 6d65 2077  de each volume w
+0000e470: 6865 7265 2069 7420 7374 6f72 6573 2074  here it stores t
+0000e480: 6865 2064 6174 6162 6173 652c 2074 6875  he database, thu
+0000e490: 6d62 6e61 696c 732c 2061 6e64 2073 6f6d  mbnails, and som
+0000e4a0: 6520 6f74 6865 7220 7374 7566 660a 0a74  e other stuff..t
+0000e4b0: 6869 7320 6361 6e20 696e 7374 6561 6420  his can instead 
+0000e4c0: 6265 206b 6570 7420 696e 2061 2073 696e  be kept in a sin
+0000e4d0: 676c 6520 706c 6163 6520 7573 696e 6720  gle place using 
+0000e4e0: 7468 6520 602d 2d68 6973 7460 2061 7267  the `--hist` arg
+0000e4f0: 756d 656e 742c 206f 7220 7468 6520 6068  ument, or the `h
+0000e500: 6973 743d 6020 766f 6c66 6c61 672c 206f  ist=` volflag, o
+0000e510: 7220 6120 6d69 7820 6f66 2062 6f74 683a  r a mix of both:
+0000e520: 0a2a 2060 2d2d 6869 7374 207e 2f2e 6361  .* `--hist ~/.ca
+0000e530: 6368 652f 636f 7079 7061 7274 7920 2d76  che/copyparty -v
+0000e540: 207e 2f6d 7573 6963 3a3a 723a 632c 6869   ~/music::r:c,hi
+0000e550: 7374 3d2d 6020 7365 7473 2060 7e2f 2e63  st=-` sets `~/.c
+0000e560: 6163 6865 2f63 6f70 7970 6172 7479 6020  ache/copyparty` 
+0000e570: 6173 2074 6865 2064 6566 6175 6c74 2070  as the default p
+0000e580: 6c61 6365 2074 6f20 7075 7420 766f 6c75  lace to put volu
+0000e590: 6d65 2069 6e66 6f2c 2062 7574 2060 7e2f  me info, but `~/
+0000e5a0: 6d75 7369 6360 2067 6574 7320 7468 6520  music` gets the 
+0000e5b0: 7265 6775 6c61 7220 602e 6869 7374 6020  regular `.hist` 
+0000e5c0: 7375 6266 6f6c 6465 7220 2860 2d60 2072  subfolder (`-` r
+0000e5d0: 6573 746f 7265 7320 6465 6661 756c 7420  estores default 
+0000e5e0: 6265 6861 7669 6f72 290a 0a6e 6f74 653a  behavior)..note:
+0000e5f0: 0a2a 206d 6172 6b64 6f77 6e20 6564 6974  .* markdown edit
+0000e600: 7320 6172 6520 616c 7761 7973 2073 746f  s are always sto
+0000e610: 7265 6420 696e 2061 206c 6f63 616c 2060  red in a local `
+0000e620: 2e68 6973 7460 2073 7562 6469 7265 6374  .hist` subdirect
+0000e630: 6f72 790a 2a20 6f6e 2077 696e 646f 7773  ory.* on windows
+0000e640: 2074 6865 2076 6f6c 666c 6167 2070 6174   the volflag pat
+0000e650: 6820 6973 2063 7967 6c69 6b65 2c20 736f  h is cyglike, so
+0000e660: 2060 2f63 2f74 656d 7060 206d 6561 6e73   `/c/temp` means
+0000e670: 2060 433a 5c74 656d 7060 2062 7574 2075   `C:\temp` but u
+0000e680: 7365 2072 6567 756c 6172 2070 6174 6873  se regular paths
+0000e690: 2066 6f72 2060 2d2d 6869 7374 600a 2020   for `--hist`.  
+0000e6a0: 2a20 796f 7520 6361 6e20 7573 6520 6379  * you can use cy
+0000e6b0: 6770 6174 6873 2066 6f72 2076 6f6c 756d  gpaths for volum
+0000e6c0: 6573 2074 6f6f 2c20 602d 7620 433a 5c55  es too, `-v C:\U
+0000e6d0: 7365 7273 3a3a 7260 2061 6e64 2060 2d76  sers::r` and `-v
+0000e6e0: 202f 632f 7573 6572 733a 3a72 6020 626f   /c/users::r` bo
+0000e6f0: 7468 2077 6f72 6b0a 0a0a 2323 206d 6574  th work...## met
+0000e700: 6164 6174 6120 6672 6f6d 2061 7564 696f  adata from audio
+0000e710: 2066 696c 6573 0a0a 7365 7420 602d 6532   files..set `-e2
+0000e720: 7460 2074 6f20 696e 6465 7820 7461 6773  t` to index tags
+0000e730: 206f 6e20 7570 6c6f 6164 0a0a 602d 6d74   on upload..`-mt
+0000e740: 6560 2064 6563 6964 6573 2077 6869 6368  e` decides which
+0000e750: 2074 6167 7320 746f 2069 6e64 6578 2061   tags to index a
+0000e760: 6e64 2064 6973 706c 6179 2069 6e20 7468  nd display in th
+0000e770: 6520 6272 6f77 7365 7220 2861 6e64 2061  e browser (and a
+0000e780: 6c73 6f20 7468 6520 6469 7370 6c61 7920  lso the display 
+0000e790: 6f72 6465 7229 2c20 7468 6973 2063 616e  order), this can
+0000e7a0: 2062 6520 6368 616e 6765 6420 7065 722d   be changed per-
+0000e7b0: 766f 6c75 6d65 3a0a 2a20 602d 7620 7e2f  volume:.* `-v ~/
+0000e7c0: 6d75 7369 633a 3a72 3a63 2c6d 7465 3d74  music::r:c,mte=t
+0000e7d0: 6974 6c65 2c61 7274 6973 7460 2069 6e64  itle,artist` ind
+0000e7e0: 6578 6573 2061 6e64 2064 6973 706c 6179  exes and display
+0000e7f0: 7320 2a74 6974 6c65 2a20 666f 6c6c 6f77  s *title* follow
+0000e800: 6564 2062 7920 2a61 7274 6973 742a 0a0a  ed by *artist*..
+0000e810: 6966 2079 6f75 2061 6464 2f72 656d 6f76  if you add/remov
+0000e820: 6520 6120 7461 6720 6672 6f6d 2060 6d74  e a tag from `mt
+0000e830: 6560 2079 6f75 2077 696c 6c20 6e65 6564  e` you will need
+0000e840: 2074 6f20 7275 6e20 7769 7468 2060 2d65   to run with `-e
+0000e850: 3274 7372 6020 6f6e 6365 2074 6f20 7265  2tsr` once to re
+0000e860: 6275 696c 6420 7468 6520 6461 7461 6261  build the databa
+0000e870: 7365 2c20 6f74 6865 7277 6973 6520 6f6e  se, otherwise on
+0000e880: 6c79 206e 6577 2066 696c 6573 2077 696c  ly new files wil
+0000e890: 6c20 6265 2061 6666 6563 7465 640a 0a62  l be affected..b
+0000e8a0: 7574 2069 6e73 7465 6164 206f 6620 7573  ut instead of us
+0000e8b0: 696e 6720 602d 6d74 6560 2c20 602d 6d74  ing `-mte`, `-mt
+0000e8c0: 6860 2069 7320 6120 6265 7474 6572 2077  h` is a better w
+0000e8d0: 6179 2074 6f20 6869 6465 2074 6167 7320  ay to hide tags 
+0000e8e0: 696e 2074 6865 2062 726f 7773 6572 3a20  in the browser: 
+0000e8f0: 7468 6573 6520 7461 6773 2077 696c 6c20  these tags will 
+0000e900: 6e6f 7420 6265 2064 6973 706c 6179 6564  not be displayed
+0000e910: 2062 7920 6465 6661 756c 742c 2062 7574   by default, but
+0000e920: 2074 6865 7920 7374 696c 6c20 6765 7420   they still get 
+0000e930: 696e 6465 7865 6420 616e 6420 6265 636f  indexed and beco
+0000e940: 6d65 2073 6561 7263 6861 626c 652c 2061  me searchable, a
+0000e950: 6e64 2075 7365 7273 2063 616e 2063 686f  nd users can cho
+0000e960: 6f73 6520 746f 2075 6e68 6964 6520 7468  ose to unhide th
+0000e970: 656d 2069 6e20 7468 6520 605b e29a 99ef  em in the `[....
+0000e980: b88f 5d20 636f 6e66 6967 6020 7061 6e65  ..] config` pane
+0000e990: 0a0a 602d 6d74 6d60 2063 616e 2062 6520  ..`-mtm` can be 
+0000e9a0: 7573 6564 2074 6f20 6164 6420 6f72 2072  used to add or r
+0000e9b0: 6564 6566 696e 6520 6120 6d65 7461 6461  edefine a metada
+0000e9c0: 7461 206d 6170 7069 6e67 2c20 7361 7920  ta mapping, say 
+0000e9d0: 796f 7520 6861 7665 206d 6564 6961 2066  you have media f
+0000e9e0: 696c 6573 2077 6974 6820 6066 6f6f 6020  iles with `foo` 
+0000e9f0: 616e 6420 6062 6172 6020 7461 6773 2061  and `bar` tags a
+0000ea00: 6e64 2079 6f75 2077 616e 7420 7468 656d  nd you want them
+0000ea10: 2074 6f20 6469 7370 6c61 7920 6173 2060   to display as `
+0000ea20: 7175 7860 2069 6e20 7468 6520 6272 6f77  qux` in the brow
+0000ea30: 7365 7220 2870 7265 6665 7272 696e 6720  ser (preferring 
+0000ea40: 6066 6f6f 6020 6966 2062 6f74 6820 6172  `foo` if both ar
+0000ea50: 6520 7072 6573 656e 7429 2c20 7468 656e  e present), then
+0000ea60: 2064 6f20 602d 6d74 6d20 7175 783d 666f   do `-mtm qux=fo
+0000ea70: 6f2c 6261 7260 2061 6e64 206e 6f77 2079  o,bar` and now y
+0000ea80: 6f75 2063 616e 2060 2d6d 7465 2061 7274  ou can `-mte art
+0000ea90: 6973 742c 7469 746c 652c 7175 7860 0a0a  ist,title,qux`..
+0000eaa0: 7461 6773 2074 6861 7420 7374 6172 7420  tags that start 
+0000eab0: 7769 7468 2061 2060 2e60 2073 7563 6820  with a `.` such 
+0000eac0: 6173 2060 2e62 706d 6020 616e 6420 602e  as `.bpm` and `.
+0000ead0: 6475 7260 2861 7469 6f6e 2920 696e 6469  dur`(ation) indi
+0000eae0: 6361 7465 206e 756d 6572 6963 2076 616c  cate numeric val
+0000eaf0: 7565 0a0a 7365 6520 7468 6520 6265 6175  ue..see the beau
+0000eb00: 7469 6675 6c20 6d65 7373 206f 6620 6120  tiful mess of a 
+0000eb10: 6469 6374 696f 6e61 7279 2069 6e20 5b6d  dictionary in [m
+0000eb20: 7461 672e 7079 5d28 6874 7470 733a 2f2f  tag.py](https://
+0000eb30: 6769 7468 7562 2e63 6f6d 2f39 3030 312f  github.com/9001/
+0000eb40: 636f 7079 7061 7274 792f 626c 6f62 2f68  copyparty/blob/h
+0000eb50: 6f76 7564 7374 7261 756d 2f63 6f70 7970  ovudstraum/copyp
+0000eb60: 6172 7479 2f6d 7461 672e 7079 2920 666f  arty/mtag.py) fo
+0000eb70: 7220 7468 6520 6465 6661 756c 7420 6d61  r the default ma
+0000eb80: 7070 696e 6773 2028 7368 6f75 6c64 2063  ppings (should c
+0000eb90: 6f76 6572 206d 7033 2c6f 7075 732c 666c  over mp3,opus,fl
+0000eba0: 6163 2c6d 3461 2c77 6176 2c61 6966 2c29  ac,m4a,wav,aif,)
+0000ebb0: 0a0a 602d 2d6e 6f2d 6d75 7461 6765 6e60  ..`--no-mutagen`
+0000ebc0: 2064 6973 6162 6c65 7320 4d75 7461 6765   disables Mutage
+0000ebd0: 6e20 616e 6420 7573 6573 2046 4670 726f  n and uses FFpro
+0000ebe0: 6265 2069 6e73 7465 6164 2c20 7768 6963  be instead, whic
+0000ebf0: 682e 2e2e 0a2a 2069 7320 6162 6f75 7420  h....* is about 
+0000ec00: 3230 7820 736c 6f77 6572 2074 6861 6e20  20x slower than 
+0000ec10: 4d75 7461 6765 6e0a 2a20 6361 7463 6865  Mutagen.* catche
+0000ec20: 7320 6120 6665 7720 7461 6773 2074 6861  s a few tags tha
+0000ec30: 7420 4d75 7461 6765 6e20 646f 6573 6e27  t Mutagen doesn'
+0000ec40: 740a 2020 2a20 6d65 6c6f 6469 6320 6b65  t.  * melodic ke
+0000ec50: 792c 2076 6964 656f 2072 6573 6f6c 7574  y, video resolut
+0000ec60: 696f 6e2c 2066 7261 6d65 7261 7465 2c20  ion, framerate, 
+0000ec70: 7069 7866 6d74 0a2a 2061 766f 6964 7320  pixfmt.* avoids 
+0000ec80: 7075 6c6c 696e 6720 616e 7920 4750 4c20  pulling any GPL 
+0000ec90: 636f 6465 2069 6e74 6f20 636f 7079 7061  code into copypa
+0000eca0: 7274 790a 2a20 6d6f 7265 2069 6d70 6f72  rty.* more impor
+0000ecb0: 7461 6e74 6c79 2072 756e 7320 4646 7072  tantly runs FFpr
+0000ecc0: 6f62 6520 6f6e 2069 6e63 6f6d 696e 6720  obe on incoming 
+0000ecd0: 6669 6c65 7320 7768 6963 6820 6973 2062  files which is b
+0000ece0: 6164 2069 6620 796f 7572 2046 466d 7065  ad if your FFmpe
+0000ecf0: 6720 6861 7320 6120 6376 650a 0a60 2d2d  g has a cve..`--
+0000ed00: 6d74 6167 2d74 6f60 2073 6574 7320 7468  mtag-to` sets th
+0000ed10: 6520 7461 672d 7363 616e 2074 696d 656f  e tag-scan timeo
+0000ed20: 7574 3b20 7665 7279 2068 6967 6820 6465  ut; very high de
+0000ed30: 6661 756c 7420 2836 3020 7365 6329 2074  fault (60 sec) t
+0000ed40: 6f20 6361 7465 7220 666f 7220 7a66 7320  o cater for zfs 
+0000ed50: 616e 6420 6f74 6865 7220 7261 6e64 6f6d  and other random
+0000ed60: 6c79 2d66 7265 657a 696e 6720 6669 6c65  ly-freezing file
+0000ed70: 7379 7374 656d 732e 204c 6f77 6572 2076  systems. Lower v
+0000ed80: 616c 7565 7320 6c69 6b65 2031 3020 6172  alues like 10 ar
+0000ed90: 6520 7573 7561 6c6c 7920 7361 6665 2c20  e usually safe, 
+0000eda0: 616c 6c6f 7769 6e67 2066 6f72 2066 6173  allowing for fas
+0000edb0: 7465 7220 7072 6f63 6573 7369 6e67 206f  ter processing o
+0000edc0: 6620 7472 6963 6b79 2066 696c 6573 0a0a  f tricky files..
+0000edd0: 0a23 2320 6669 6c65 2070 6172 7365 7220  .## file parser 
+0000ede0: 706c 7567 696e 730a 0a70 726f 7669 6465  plugins..provide
+0000edf0: 2063 7573 746f 6d20 7061 7273 6572 7320   custom parsers 
+0000ee00: 746f 2069 6e64 6578 2061 6464 6974 696f  to index additio
+0000ee10: 6e61 6c20 7461 6773 2c20 2061 6c73 6f20  nal tags,  also 
+0000ee20: 7365 6520 5b2e 2f62 696e 2f6d 7461 672f  see [./bin/mtag/
+0000ee30: 5245 4144 4d45 2e6d 645d 282e 2f62 696e  README.md](./bin
+0000ee40: 2f6d 7461 672f 5245 4144 4d45 2e6d 6429  /mtag/README.md)
+0000ee50: 0a0a 636f 7079 7061 7274 7920 6361 6e20  ..copyparty can 
+0000ee60: 696e 766f 6b65 2065 7874 6572 6e61 6c20  invoke external 
+0000ee70: 7072 6f67 7261 6d73 2074 6f20 636f 6c6c  programs to coll
+0000ee80: 6563 7420 6164 6469 7469 6f6e 616c 206d  ect additional m
+0000ee90: 6574 6164 6174 6120 666f 7220 6669 6c65  etadata for file
+0000eea0: 7320 7573 696e 6720 606d 7470 6020 2865  s using `mtp` (e
+0000eeb0: 6974 6865 7220 6173 2061 7267 756d 656e  ither as argumen
+0000eec0: 7420 6f72 2076 6f6c 666c 6167 292c 2074  t or volflag), t
+0000eed0: 6865 7265 2069 7320 6120 6465 6661 756c  here is a defaul
+0000eee0: 7420 7469 6d65 6f75 7420 6f66 2036 3073  t timeout of 60s
+0000eef0: 6563 2c20 616e 6420 6f6e 6c79 2066 696c  ec, and only fil
+0000ef00: 6573 2077 6869 6368 2063 6f6e 7461 696e  es which contain
+0000ef10: 2061 7564 696f 2067 6574 2061 6e61 6c79   audio get analy
+0000ef20: 7a65 6420 6279 2064 6566 6175 6c74 2028  zed by default (
+0000ef30: 7365 6520 6179 2f61 6e2f 6164 2062 656c  see ay/an/ad bel
+0000ef40: 6f77 290a 0a2a 2060 2d6d 7470 202e 6270  ow)..* `-mtp .bp
+0000ef50: 6d3d 7e2f 6269 6e2f 6175 6469 6f2d 6270  m=~/bin/audio-bp
+0000ef60: 6d2e 7079 6020 7769 6c6c 2065 7865 6375  m.py` will execu
+0000ef70: 7465 2060 7e2f 6269 6e2f 6175 6469 6f2d  te `~/bin/audio-
+0000ef80: 6270 6d2e 7079 6020 7769 7468 2074 6865  bpm.py` with the
+0000ef90: 2061 7564 696f 2066 696c 6520 6173 2061   audio file as a
+0000efa0: 7267 756d 656e 7420 3120 746f 2070 726f  rgument 1 to pro
+0000efb0: 7669 6465 2074 6865 2060 2e62 706d 6020  vide the `.bpm` 
+0000efc0: 7461 672c 2069 6620 7468 6174 2064 6f65  tag, if that doe
+0000efd0: 7320 6e6f 7420 6578 6973 7420 696e 2074  s not exist in t
+0000efe0: 6865 2061 7564 696f 206d 6574 6164 6174  he audio metadat
+0000eff0: 610a 2a20 602d 6d74 7020 6b65 793d 662c  a.* `-mtp key=f,
+0000f000: 7435 2c7e 2f62 696e 2f61 7564 696f 2d6b  t5,~/bin/audio-k
+0000f010: 6579 2e70 7960 2075 7365 7320 607e 2f62  ey.py` uses `~/b
+0000f020: 696e 2f61 7564 696f 2d6b 6579 2e70 7960  in/audio-key.py`
+0000f030: 2074 6f20 6765 7420 7468 6520 606b 6579   to get the `key
+0000f040: 6020 7461 672c 2072 6570 6c61 6369 6e67  ` tag, replacing
+0000f050: 2061 6e79 2065 7869 7374 696e 6720 6d65   any existing me
+0000f060: 7461 6461 7461 2074 6167 2028 6066 2c60  tadata tag (`f,`
+0000f070: 292c 2061 626f 7274 696e 6720 6966 2069  ), aborting if i
+0000f080: 7420 7461 6b65 7320 6c6f 6e67 6572 2074  t takes longer t
+0000f090: 6861 6e20 3573 6563 2028 6074 352c 6029  han 5sec (`t5,`)
+0000f0a0: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
+0000f0b0: 723a 632c 6d74 703d 2e62 706d 3d7e 2f62  r:c,mtp=.bpm=~/b
+0000f0c0: 696e 2f61 7564 696f 2d62 706d 2e70 793a  in/audio-bpm.py:
+0000f0d0: 632c 6d74 703d 6b65 793d 662c 7435 2c7e  c,mtp=key=f,t5,~
+0000f0e0: 2f62 696e 2f61 7564 696f 2d6b 6579 2e70  /bin/audio-key.p
+0000f0f0: 7960 2062 6f74 6820 6173 2061 2070 6572  y` both as a per
+0000f100: 2d76 6f6c 756d 6520 636f 6e66 6967 2077  -volume config w
+0000f110: 6f77 2074 6869 7320 6973 2067 6574 7469  ow this is getti
+0000f120: 6e67 2075 676c 790a 0a2a 6275 7420 7761  ng ugly..*but wa
+0000f130: 6974 2c20 7468 6572 6527 7320 6d6f 7265  it, there's more
+0000f140: 212a 2060 2d6d 7470 6020 6361 6e20 6265  !* `-mtp` can be
+0000f150: 2075 7365 6420 666f 7220 6e6f 6e2d 6175   used for non-au
+0000f160: 6469 6f20 6669 6c65 7320 6173 2077 656c  dio files as wel
+0000f170: 6c20 7573 696e 6720 7468 6520 6061 6020  l using the `a` 
+0000f180: 666c 6167 3a20 6061 7960 206f 6e6c 7920  flag: `ay` only 
+0000f190: 646f 2061 7564 696f 2066 696c 6573 2028  do audio files (
+0000f1a0: 6465 6661 756c 7429 2c20 6061 6e60 206f  default), `an` o
+0000f1b0: 6e6c 7920 646f 206e 6f6e 2d61 7564 696f  nly do non-audio
+0000f1c0: 2066 696c 6573 2c20 6f72 2060 6164 6020   files, or `ad` 
+0000f1d0: 646f 2061 6c6c 2066 696c 6573 2028 6420  do all files (d 
+0000f1e0: 6173 2069 6e20 646f 6e74 6361 7265 290a  as in dontcare).
+0000f1f0: 0a2a 2022 6175 6469 6f20 6669 6c65 2220  .* "audio file" 
+0000f200: 616c 736f 206d 6561 6e73 2076 6964 656f  also means video
+0000f210: 7320 6274 772c 2061 7320 6c6f 6e67 2061  s btw, as long a
+0000f220: 7320 7468 6572 6520 6973 2061 6e20 6175  s there is an au
+0000f230: 6469 6f20 7374 7265 616d 0a2a 2060 2d6d  dio stream.* `-m
+0000f240: 7470 2065 7874 3d61 6e2c 7e2f 6269 6e2f  tp ext=an,~/bin/
+0000f250: 6669 6c65 2d65 7874 2e70 7960 2072 756e  file-ext.py` run
+0000f260: 7320 607e 2f62 696e 2f66 696c 652d 6578  s `~/bin/file-ex
+0000f270: 742e 7079 6020 746f 2067 6574 2074 6865  t.py` to get the
+0000f280: 2060 6578 7460 2074 6167 206f 6e6c 7920   `ext` tag only 
+0000f290: 6966 2066 696c 6520 6973 206e 6f74 2061  if file is not a
+0000f2a0: 7564 696f 2028 6061 6e60 290a 2a20 602d  udio (`an`).* `-
+0000f2b0: 6d74 7020 6172 6368 2c62 7569 6c74 2c76  mtp arch,built,v
+0000f2c0: 6572 2c6f 7269 673d 616e 2c65 6578 652c  er,orig=an,eexe,
+0000f2d0: 6564 6c6c 2c7e 2f62 696e 2f65 7865 2e70  edll,~/bin/exe.p
+0000f2e0: 7960 2072 756e 7320 607e 2f62 696e 2f65  y` runs `~/bin/e
+0000f2f0: 7865 2e70 7960 2074 6f20 6765 7420 7072  xe.py` to get pr
+0000f300: 6f70 6572 7469 6573 2061 626f 7574 2077  operties about w
+0000f310: 696e 646f 7773 2d62 696e 6172 6965 7320  indows-binaries 
+0000f320: 6f6e 6c79 2069 6620 6669 6c65 2069 7320  only if file is 
+0000f330: 6e6f 7420 6175 6469 6f20 2860 616e 6029  not audio (`an`)
+0000f340: 2061 6e64 2066 696c 6520 6578 7465 6e73   and file extens
+0000f350: 696f 6e20 6973 2065 7865 206f 7220 646c  ion is exe or dl
+0000f360: 6c0a 2a20 6966 2079 6f75 2077 616e 7420  l.* if you want 
+0000f370: 746f 2064 6169 7379 6368 6169 6e20 7061  to daisychain pa
+0000f380: 7273 6572 732c 2075 7365 2074 6865 2060  rsers, use the `
+0000f390: 7060 2066 6c61 6720 746f 2073 6574 2070  p` flag to set p
+0000f3a0: 726f 6365 7373 696e 6720 6f72 6465 720a  rocessing order.
+0000f3b0: 2020 2a20 602d 6d74 7020 666f 6f3d 7031    * `-mtp foo=p1
+0000f3c0: 2c7e 2f61 2e70 7960 2072 756e 7320 6265  ,~/a.py` runs be
+0000f3d0: 666f 7265 2060 2d6d 7470 2066 6f6f 3d70  fore `-mtp foo=p
+0000f3e0: 322c 7e2f 622e 7079 6020 616e 6420 7769  2,~/b.py` and wi
+0000f3f0: 6c6c 2066 6f72 7761 7264 2061 6c6c 2074  ll forward all t
+0000f400: 6865 2074 6167 7320 6465 7465 6374 6564  he tags detected
+0000f410: 2073 6f20 6661 7220 6173 206a 736f 6e20   so far as json 
+0000f420: 746f 2074 6865 2073 7464 696e 206f 6620  to the stdin of 
+0000f430: 622e 7079 0a2a 206f 7074 696f 6e20 6063  b.py.* option `c
+0000f440: 3060 2064 6973 6162 6c65 7320 6361 7074  0` disables capt
+0000f450: 7572 696e 6720 6f66 2073 7464 6f75 742f  uring of stdout/
+0000f460: 7374 6465 7272 2c20 736f 2063 6f70 7970  stderr, so copyp
+0000f470: 6172 7479 2077 696c 6c20 6e6f 7420 7265  arty will not re
+0000f480: 6365 6976 6520 616e 7920 7461 6773 2066  ceive any tags f
+0000f490: 726f 6d20 7468 6520 7072 6f63 6573 7320  rom the process 
+0000f4a0: 6174 2061 6c6c 202d 2d20 696e 7374 6561  at all -- instea
+0000f4b0: 6420 7468 6520 696e 766f 6b65 6420 7072  d the invoked pr
+0000f4c0: 6f67 7261 6d20 6973 2066 7265 6520 746f  ogram is free to
+0000f4d0: 2070 7269 6e74 2077 6861 7465 7665 7220   print whatever 
+0000f4e0: 746f 2074 6865 2063 6f6e 736f 6c65 2c20  to the console, 
+0000f4f0: 6a75 7374 2075 7369 6e67 2063 6f70 7970  just using copyp
+0000f500: 6172 7479 2061 7320 6120 6c61 756e 6368  arty as a launch
+0000f510: 6572 0a20 202a 2060 6331 6020 6361 7074  er.  * `c1` capt
+0000f520: 7572 6573 2073 7464 6f75 7420 6f6e 6c79  ures stdout only
+0000f530: 2c20 6063 3260 206f 6e6c 7920 7374 6465  , `c2` only stde
+0000f540: 7272 2c20 616e 6420 6063 3360 2028 6465  rr, and `c3` (de
+0000f550: 6661 756c 7429 2063 6170 7475 7265 7320  fault) captures 
+0000f560: 626f 7468 0a2a 2079 6f75 2063 616e 2063  both.* you can c
+0000f570: 6f6e 7472 6f6c 2068 6f77 2074 6865 2070  ontrol how the p
+0000f580: 6172 7365 7220 6973 206b 696c 6c65 6420  arser is killed 
+0000f590: 6966 2069 7420 7469 6d65 7320 6f75 7420  if it times out 
+0000f5a0: 7769 7468 206f 7074 696f 6e20 606b 7460  with option `kt`
+0000f5b0: 206b 696c 6c69 6e67 2074 6865 2065 6e74   killing the ent
+0000f5c0: 6972 6520 7072 6f63 6573 7320 7472 6565  ire process tree
+0000f5d0: 2028 6465 6661 756c 7429 2c20 606b 6d60   (default), `km`
+0000f5e0: 206a 7573 7420 7468 6520 6d61 696e 2070   just the main p
+0000f5f0: 726f 6365 7373 2c20 6f72 2060 6b6e 6020  rocess, or `kn` 
+0000f600: 6c65 7420 6974 2063 6f6e 7469 6e75 6520  let it continue 
+0000f610: 7275 6e6e 696e 6720 756e 7469 6c20 636f  running until co
+0000f620: 7079 7061 7274 7920 6973 2074 6572 6d69  pyparty is termi
+0000f630: 6e61 7465 640a 0a69 6620 736f 6d65 7468  nated..if someth
+0000f640: 696e 6720 646f 6573 6e27 7420 776f 726b  ing doesn't work
+0000f650: 2c20 7472 7920 602d 2d6d 7461 672d 7660  , try `--mtag-v`
+0000f660: 2066 6f72 2076 6572 626f 7365 2065 7272   for verbose err
+0000f670: 6f72 206d 6573 7361 6765 730a 0a0a 2323  or messages...##
+0000f680: 2065 7665 6e74 2068 6f6f 6b73 0a0a 7472   event hooks..tr
+0000f690: 6967 6765 7220 6120 7072 6f67 7261 6d20  igger a program 
+0000f6a0: 6f6e 2075 706c 6f61 6473 2c20 7265 6e61  on uploads, rena
+0000f6b0: 6d65 7320 6574 6320 285b 6578 616d 706c  mes etc ([exampl
+0000f6c0: 6573 5d28 2e2f 6269 6e2f 686f 6f6b 732f  es](./bin/hooks/
+0000f6d0: 2929 0a0a 796f 7520 6361 6e20 7365 7420  ))..you can set 
+0000f6e0: 686f 6f6b 7320 6265 666f 7265 2061 6e64  hooks before and
+0000f6f0: 2f6f 7220 6166 7465 7220 616e 2065 7665  /or after an eve
+0000f700: 6e74 2068 6170 7065 6e73 2c20 616e 6420  nt happens, and 
+0000f710: 6375 7272 656e 746c 7920 796f 7520 6361  currently you ca
+0000f720: 6e20 686f 6f6b 2075 706c 6f61 6473 2c20  n hook uploads, 
+0000f730: 6d6f 7665 732f 7265 6e61 6d65 732c 2061  moves/renames, a
+0000f740: 6e64 2064 656c 6574 6573 0a0a 7468 6572  nd deletes..ther
+0000f750: 6527 7320 6120 6275 6e63 6820 6f66 2066  e's a bunch of f
+0000f760: 6c61 6773 2061 6e64 2073 7475 6666 2c20  lags and stuff, 
+0000f770: 7365 6520 602d 2d68 656c 702d 686f 6f6b  see `--help-hook
+0000f780: 7360 0a0a 0a23 2323 2075 706c 6f61 6420  s`...### upload 
+0000f790: 6576 656e 7473 0a0a 7468 6520 6f6c 6465  events..the olde
+0000f7a0: 722c 206d 6f72 6520 706f 7765 7266 756c  r, more powerful
+0000f7b0: 2061 7070 726f 6163 6820 285b 6578 616d   approach ([exam
+0000f7c0: 706c 6573 5d28 2e2f 6269 6e2f 6d74 6167  ples](./bin/mtag
+0000f7d0: 2f29 293a 0a0a 6060 600a 2d76 202f 6d6e  /)):..```.-v /mn
+0000f7e0: 742f 696e 633a 696e 633a 773a 632c 6d74  t/inc:inc:w:c,mt
+0000f7f0: 653d 2b78 313a 632c 6d74 703d 7831 3d61  e=+x1:c,mtp=x1=a
+0000f800: 642c 6b6e 2c2f 7573 722f 6269 6e2f 6e6f  d,kn,/usr/bin/no
+0000f810: 7469 6679 2d73 656e 640a 6060 600a 0a73  tify-send.```..s
+0000f820: 6f20 6669 6c65 7379 7374 656d 206c 6f63  o filesystem loc
+0000f830: 6174 696f 6e20 602f 6d6e 742f 696e 6360  ation `/mnt/inc`
+0000f840: 2073 6861 7265 6420 6174 2060 2f69 6e63   shared at `/inc
+0000f850: 602c 2077 7269 7465 2d6f 6e6c 7920 666f  `, write-only fo
+0000f860: 7220 6576 6572 796f 6e65 2c20 6170 7065  r everyone, appe
+0000f870: 6e64 696e 6720 6078 3160 2074 6f20 7468  nding `x1` to th
+0000f880: 6520 6c69 7374 206f 6620 7461 6773 2074  e list of tags t
+0000f890: 6f20 696e 6465 7820 2860 6d74 6560 292c  o index (`mte`),
+0000f8a0: 2061 6e64 2075 7369 6e67 2060 2f75 7372   and using `/usr
+0000f8b0: 2f62 696e 2f6e 6f74 6966 792d 7365 6e64  /bin/notify-send
+0000f8c0: 6020 746f 2022 7072 6f76 6964 6522 2074  ` to "provide" t
+0000f8d0: 6167 2060 7831 6020 666f 7220 616e 7920  ag `x1` for any 
+0000f8e0: 6669 6c65 7479 7065 2028 6061 6460 2920  filetype (`ad`) 
+0000f8f0: 7769 7468 206b 696c 6c2d 6f6e 2d74 696d  with kill-on-tim
+0000f900: 656f 7574 2064 6973 6162 6c65 6420 2860  eout disabled (`
+0000f910: 6b6e 6029 0a0a 7468 6174 276c 6c20 7275  kn`)..that'll ru
+0000f920: 6e20 7468 6520 636f 6d6d 616e 6420 606e  n the command `n
+0000f930: 6f74 6966 792d 7365 6e64 6020 7769 7468  otify-send` with
+0000f940: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
+0000f950: 2075 706c 6f61 6465 6420 6669 6c65 2061   uploaded file a
+0000f960: 7320 7468 6520 6669 7273 7420 616e 6420  s the first and 
+0000f970: 6f6e 6c79 2061 7267 756d 656e 7420 2873  only argument (s
+0000f980: 6f20 6f6e 206c 696e 7578 2069 7427 6c6c  o on linux it'll
+0000f990: 2073 686f 7720 6120 6e6f 7469 6669 6361   show a notifica
+0000f9a0: 7469 6f6e 206f 6e2d 7363 7265 656e 290a  tion on-screen).
+0000f9b0: 0a6e 6f74 6520 7468 6174 2074 6869 7320  .note that this 
+0000f9c0: 6973 2077 6179 206d 6f72 6520 636f 6d70  is way more comp
+0000f9d0: 6c69 6361 7465 6420 7468 616e 2074 6865  licated than the
+0000f9e0: 206e 6577 205b 6576 656e 7420 686f 6f6b   new [event hook
+0000f9f0: 735d 2823 6576 656e 742d 686f 6f6b 7329  s](#event-hooks)
+0000fa00: 2062 7574 2074 6869 7320 6170 7072 6f61   but this approa
+0000fa10: 6368 2068 6173 2074 6865 2066 6f6c 6c6f  ch has the follo
+0000fa20: 7769 6e67 2061 6476 616e 7461 6765 733a  wing advantages:
+0000fa30: 0a2a 206e 6f6e 2d62 6c6f 636b 696e 6720  .* non-blocking 
+0000fa40: 616e 6420 6d75 6c74 6974 6872 6561 6465  and multithreade
+0000fa50: 643b 2064 6f65 736e 2774 2068 6f6c 6420  d; doesn't hold 
+0000fa60: 6f74 6865 7220 7570 6c6f 6164 7320 6261  other uploads ba
+0000fa70: 636b 0a2a 2079 6f75 2067 6574 2061 6363  ck.* you get acc
+0000fa80: 6573 7320 746f 2074 6167 7320 6672 6f6d  ess to tags from
+0000fa90: 2046 466d 7065 6720 616e 6420 6f74 6865   FFmpeg and othe
+0000faa0: 7220 6d74 7020 7061 7273 6572 730a 2a20  r mtp parsers.* 
+0000fab0: 6f6e 6c79 2074 7269 6767 6572 206f 6e20  only trigger on 
+0000fac0: 6e65 7720 756e 6971 7565 2066 696c 6573  new unique files
+0000fad0: 2c20 6e6f 7420 6475 7065 730a 0a6e 6f74  , not dupes..not
+0000fae0: 6520 7468 6174 2069 7420 7769 6c6c 206f  e that it will o
+0000faf0: 6363 7570 7920 7468 6520 7061 7273 696e  ccupy the parsin
+0000fb00: 6720 7468 7265 6164 732c 2073 6f20 666f  g threads, so fo
+0000fb10: 726b 2061 6e79 7468 696e 6720 6578 7065  rk anything expe
+0000fb20: 6e73 6976 6520 286f 7220 7365 7420 606b  nsive (or set `k
+0000fb30: 6e60 2074 6f20 6861 7665 2063 6f70 7970  n` to have copyp
+0000fb40: 6172 7479 2066 6f72 6b20 6974 2066 6f72  arty fork it for
+0000fb50: 2079 6f75 2920 2d2d 206f 746f 6820 6966   you) -- otoh if
+0000fb60: 2079 6f75 2077 616e 7420 746f 2069 6e74   you want to int
+0000fb70: 656e 7469 6f6e 616c 6c79 2071 7565 7565  entionally queue
+0000fb80: 2f73 696e 676c 6574 6872 6561 6420 796f  /singlethread yo
+0000fb90: 7520 6361 6e20 636f 6d62 696e 6520 6974  u can combine it
+0000fba0: 2077 6974 6820 602d 2d6d 7461 672d 6d74   with `--mtag-mt
+0000fbb0: 2031 600a 0a0a 2323 2068 6964 696e 6720   1`...## hiding 
+0000fbc0: 6672 6f6d 2067 6f6f 676c 650a 0a74 656c  from google..tel
+0000fbd0: 6c20 7365 6172 6368 2065 6e67 696e 6573  l search engines
+0000fbe0: 2079 6f75 2064 6f6e 7420 7761 6e6e 6120   you dont wanna 
+0000fbf0: 6265 2069 6e64 6578 6564 2c20 2065 6974  be indexed,  eit
+0000fc00: 6865 7220 7573 696e 6720 7468 6520 676f  her using the go
+0000fc10: 6f64 206f 6c64 205b 726f 626f 7473 2e74  od old [robots.t
+0000fc20: 7874 5d28 6874 7470 733a 2f2f 7777 772e  xt](https://www.
+0000fc30: 726f 626f 7473 7478 742e 6f72 672f 726f  robotstxt.org/ro
+0000fc40: 626f 7473 7478 742e 6874 6d6c 2920 6f72  botstxt.html) or
+0000fc50: 2074 6872 6f75 6768 2063 6f70 7970 6172   through copypar
+0000fc60: 7479 2073 6574 7469 6e67 733a 0a0a 2a20  ty settings:..* 
+0000fc70: 602d 2d6e 6f2d 726f 626f 7473 6020 6164  `--no-robots` ad
+0000fc80: 6473 2048 5454 5020 2860 582d 526f 626f  ds HTTP (`X-Robo
+0000fc90: 7473 2d54 6167 6029 2061 6e64 2048 544d  ts-Tag`) and HTM
+0000fca0: 4c20 2860 3c6d 6574 613e 6029 2068 6561  L (`<meta>`) hea
+0000fcb0: 6465 7273 2077 6974 6820 606e 6f69 6e64  ders with `noind
+0000fcc0: 6578 2c20 6e6f 666f 6c6c 6f77 6020 676c  ex, nofollow` gl
+0000fcd0: 6f62 616c 6c79 0a2a 2076 6f6c 666c 6167  obally.* volflag
+0000fce0: 2060 5b2e 2e2e 5d3a 632c 6e6f 726f 626f   `[...]:c,norobo
+0000fcf0: 7473 6020 646f 6573 2074 6865 2073 616d  ts` does the sam
+0000fd00: 6520 7468 696e 6720 666f 7220 7468 6174  e thing for that
+0000fd10: 2073 696e 676c 6520 766f 6c75 6d65 0a2a   single volume.*
+0000fd20: 2076 6f6c 666c 6167 2060 5b2e 2e2e 5d3a   volflag `[...]:
+0000fd30: 632c 726f 626f 7473 6020 414c 4c4f 5753  c,robots` ALLOWS
+0000fd40: 2073 6561 7263 682d 656e 6769 6e65 2063   search-engine c
+0000fd50: 7261 776c 696e 6720 666f 7220 7468 6174  rawling for that
+0000fd60: 2076 6f6c 756d 652c 2065 7665 6e20 6966   volume, even if
+0000fd70: 2060 2d2d 6e6f 2d72 6f62 6f74 7360 2069   `--no-robots` i
+0000fd80: 7320 7365 7420 676c 6f62 616c 6c79 0a0a  s set globally..
+0000fd90: 616c 736f 2c20 602d 2d66 6f72 6365 2d6a  also, `--force-j
+0000fda0: 7360 2064 6973 6162 6c65 7320 7468 6520  s` disables the 
+0000fdb0: 706c 6169 6e20 4854 4d4c 2066 6f6c 6465  plain HTML folde
+0000fdc0: 7220 6c69 7374 696e 672c 206d 616b 696e  r listing, makin
+0000fdd0: 6720 7468 696e 6773 2068 6172 6465 7220  g things harder 
+0000fde0: 746f 2070 6172 7365 2066 6f72 2073 6561  to parse for sea
+0000fdf0: 7263 6820 656e 6769 6e65 730a 0a0a 2323  rch engines...##
+0000fe00: 2074 6865 6d65 730a 0a79 6f75 2063 616e   themes..you can
+0000fe10: 2063 6861 6e67 6520 7468 6520 6465 6661   change the defa
+0000fe20: 756c 7420 7468 656d 6520 7769 7468 2060  ult theme with `
+0000fe30: 2d2d 7468 656d 6520 3260 2c20 616e 6420  --theme 2`, and 
+0000fe40: 6164 6420 796f 7572 206f 776e 2074 6865  add your own the
+0000fe50: 6d65 7320 6279 206d 6f64 6966 7969 6e67  mes by modifying
+0000fe60: 2060 6272 6f77 7365 722e 6373 7360 206f   `browser.css` o
+0000fe70: 7220 7072 6f76 6964 696e 6720 796f 7572  r providing your
+0000fe80: 206f 776e 2063 7373 2074 6f20 602d 2d63   own css to `--c
+0000fe90: 7373 2d62 726f 7773 6572 602c 2074 6865  ss-browser`, the
+0000fea0: 6e20 7465 6c6c 696e 6720 636f 7079 7061  n telling copypa
+0000feb0: 7274 7920 7468 6579 2065 7869 7374 2062  rty they exist b
+0000fec0: 7920 696e 6372 6561 7369 6e67 2060 2d2d  y increasing `--
+0000fed0: 7468 656d 6573 600a 0a3c 7461 626c 653e  themes`..<table>
+0000fee0: 3c74 723e 3c74 6420 7769 6474 683d 2233  <tr><td width="3
+0000fef0: 3325 2220 616c 6967 6e3d 2263 656e 7465  3%" align="cente
+0000ff00: 7222 3e3c 6120 6872 6566 3d22 6874 7470  r"><a href="http
+0000ff10: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+0000ff20: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+0000ff30: 742e 636f 6d2f 3234 3130 3332 2f31 3635  t.com/241032/165
+0000ff40: 3836 3439 3037 2d31 3765 3261 6337 642d  864907-17e2ac7d-
+0000ff50: 3331 3964 2d34 6632 352d 3837 3138 2d32  319d-4f25-8718-2
+0000ff60: 6633 3736 6636 3134 6235 312e 706e 6722  f376f614b51.png"
+0000ff70: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+0000ff80: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+0000ff90: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+0000ffa0: 2e63 6f6d 2f32 3431 3033 322f 3136 3538  .com/241032/1658
+0000ffb0: 3637 3535 312d 6663 6562 3335 6464 2d33  67551-fceb35dd-3
+0000ffc0: 3866 302d 3432 6262 2d62 6566 332d 3235  8f0-42bb-bef3-25
+0000ffd0: 6261 3635 3163 6136 3962 2e70 6e67 223e  ba651ca69b.png">
+0000ffe0: 3c2f 613e 0a30 2e20 636c 6173 7369 6320  </a>.0. classic 
+0000fff0: 6461 726b 3c2f 7464 3e3c 7464 2077 6964  dark</td><td wid
+00010000: 7468 3d22 3333 2522 2061 6c69 676e 3d22  th="33%" align="
+00010010: 6365 6e74 6572 223e 3c61 2068 7265 663d  center"><a href=
+00010020: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
+00010030: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00010040: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+00010050: 322f 3136 3836 3434 3339 392d 3638 3933  2/168644399-6893
+00010060: 3864 6535 2d64 6139 622d 3434 3566 2d38  8de5-da9b-445f-8
+00010070: 6439 322d 6235 3163 3734 6235 6633 3435  d92-b51c74b5f345
+00010080: 2e70 6e67 223e 3c69 6d67 2073 7263 3d22  .png"><img src="
+00010090: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
+000100a0: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
+000100b0: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
+000100c0: 2f31 3638 3634 3434 3034 2d38 6531 6132  /168644404-8e1a2
+000100d0: 6664 632d 3665 3539 2d34 6334 312d 3930  fdc-6e59-4c41-90
+000100e0: 3565 2d62 6135 3339 3965 6436 3836 662e  5e-ba5399ed686f.
+000100f0: 706e 6722 3e3c 2f61 3e0a 322e 2066 6c61  png"></a>.2. fla
+00010100: 7420 706d 2d6d 6f6e 6f6b 6169 3c2f 7464  t pm-monokai</td
+00010110: 3e3c 7464 2077 6964 7468 3d22 3333 2522  ><td width="33%"
+00010120: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
+00010130: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
+00010140: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+00010150: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+00010160: 6f6d 2f32 3431 3033 322f 3136 3538 3634  om/241032/165864
+00010170: 3930 312d 6462 3133 6134 3239 2d61 3564  901-db13a429-a5d
+00010180: 612d 3439 3664 2d38 6263 362d 6365 3833  a-496d-8bc6-ce83
+00010190: 3835 3437 6636 3964 2e70 6e67 223e 3c69  8547f69d.png"><i
+000101a0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+000101b0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+000101c0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+000101d0: 6d2f 3234 3130 3332 2f31 3635 3836 3735  m/241032/1658675
+000101e0: 3630 2d61 6138 3334 6165 662d 3538 6463  60-aa834aef-58dc
+000101f0: 2d34 6162 652d 6261 6566 2d37 6535 3632  -4abe-baef-7e562
+00010200: 6236 3437 3934 352e 706e 6722 3e3c 2f61  b647945.png"></a
+00010210: 3e0a 342e 2076 6963 653c 2f74 643e 3c2f  >.4. vice</td></
+00010220: 7472 3e3c 7472 3e3c 7464 2061 6c69 676e  tr><tr><td align
+00010230: 3d22 6365 6e74 6572 223e 3c61 2068 7265  ="center"><a hre
+00010240: 663d 2268 7474 7073 3a2f 2f75 7365 722d  f="https://user-
+00010250: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00010260: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00010270: 3033 322f 3136 3538 3634 3930 352d 3639  032/165864905-69
+00010280: 3236 3832 6562 2d36 6662 342d 3464 3430  2682eb-6fb4-4d40
+00010290: 2d62 3666 652d 3237 6432 6337 6433 6532  -b6fe-27d2c7d3e2
+000102a0: 6137 2e70 6e67 223e 3c69 6d67 2073 7263  a7.png"><img src
+000102b0: 3d22 6874 7470 733a 2f2f 7573 6572 2d69  ="https://user-i
+000102c0: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+000102d0: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+000102e0: 3332 2f31 3635 3836 3735 3535 2d30 3830  32/165867555-080
+000102f0: 6237 3362 362d 3664 3835 2d34 3162 622d  b73b6-6d85-41bb-
+00010300: 6137 6336 2d61 6432 3737 6336 3038 3336  a7c6-ad277c60836
+00010310: 352e 706e 6722 3e3c 2f61 3e0a 312e 2063  5.png"></a>.1. c
+00010320: 6c61 7373 6963 206c 6967 6874 3c2f 7464  lassic light</td
+00010330: 3e3c 7464 2061 6c69 676e 3d22 6365 6e74  ><td align="cent
+00010340: 6572 223e 3c61 2068 7265 663d 2268 7474  er"><a href="htt
+00010350: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00010360: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00010370: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
+00010380: 3836 3435 3237 362d 6662 3032 6664 3139  8645276-fb02fd19
+00010390: 2d31 3930 612d 3430 3761 2d62 3864 332d  -190a-407a-b8d3-
+000103a0: 6435 3866 6565 3237 3765 3032 2e70 6e67  d58fee277e02.png
+000103b0: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
+000103c0: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+000103d0: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+000103e0: 742e 636f 6d2f 3234 3130 3332 2f31 3638  t.com/241032/168
+000103f0: 3634 3532 3830 2d66 3036 3632 6233 632d  645280-f0662b3c-
+00010400: 3937 3634 2d34 3837 352d 6132 6532 2d64  9764-4875-a2e2-d
+00010410: 3931 6363 3831 3939 6232 332e 706e 6722  91cc8199b23.png"
+00010420: 3e3c 2f61 3e0a 332e 2066 6c61 7420 6c69  ></a>.3. flat li
+00010430: 6768 740a 3c2f 7464 3e3c 7464 2061 6c69  ght.</td><td ali
+00010440: 676e 3d22 6365 6e74 6572 223e 3c61 2068  gn="center"><a h
+00010450: 7265 663d 2268 7474 7073 3a2f 2f75 7365  ref="https://use
+00010460: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
+00010470: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
+00010480: 3431 3033 322f 3136 3538 3634 3839 382d  41032/165864898-
+00010490: 3130 6365 3730 3532 2d61 3131 372d 3466  10ce7052-a117-4f
+000104a0: 6366 2d38 3435 622d 6235 3663 3931 3638  cf-845b-b56c9168
+000104b0: 3739 3038 2e70 6e67 223e 3c69 6d67 2073  7908.png"><img s
+000104c0: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
+000104d0: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
+000104e0: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
+000104f0: 3130 3332 2f31 3635 3836 3735 3632 2d66  1032/165867562-f
+00010500: 3330 3033 6434 352d 6464 3261 2d34 3536  3003d45-dd2a-456
+00010510: 342d 3861 6165 2d66 6564 3434 6331 6165  4-8aae-fed44c1ae
+00010520: 3036 342e 706e 6722 3e3c 2f61 3e0a 352e  064.png"></a>.5.
+00010530: 203c 6120 6872 6566 3d22 6874 7470 733a   <a href="https:
+00010540: 2f2f 626c 6f67 2e63 6f64 696e 6768 6f72  //blog.codinghor
+00010550: 726f 722e 636f 6d2f 612d 7472 6962 7574  ror.com/a-tribut
+00010560: 652d 746f 2d74 6865 2d77 696e 646f 7773  e-to-the-windows
+00010570: 2d33 312d 686f 742d 646f 672d 7374 616e  -31-hot-dog-stan
+00010580: 642d 636f 6c6f 722d 7363 6865 6d65 2f22  d-color-scheme/"
+00010590: 3e68 6f74 646f 6720 7374 616e 643c 2f61  >hotdog stand</a
+000105a0: 3e3c 2f74 643e 3c2f 7472 3e3c 2f74 6162  ></td></tr></tab
+000105b0: 6c65 3e0a 0a74 6865 2063 6c61 7373 6e61  le>..the classna
+000105c0: 6d65 206f 6620 7468 6520 4854 4d4c 2074  me of the HTML t
+000105d0: 6167 2069 7320 7365 7420 6163 636f 7264  ag is set accord
+000105e0: 696e 6720 746f 2074 6865 2073 656c 6563  ing to the selec
+000105f0: 7465 6420 7468 656d 652c 2077 6869 6368  ted theme, which
+00010600: 2069 7320 7573 6564 2074 6f20 7365 7420   is used to set 
+00010610: 636f 6c6f 7273 2061 7320 6373 7320 7661  colors as css va
+00010620: 7269 6162 6c65 7320 2b2b 0a0a 2a20 6561  riables ++..* ea
+00010630: 6368 2074 6865 6d65 202a 6765 6e65 7261  ch theme *genera
+00010640: 6c6c 792a 2068 6173 2061 2064 6172 6b20  lly* has a dark 
+00010650: 7468 656d 6520 2865 7665 6e20 6e75 6d62  theme (even numb
+00010660: 6572 7329 2061 6e64 2061 206c 6967 6874  ers) and a light
+00010670: 2074 6865 6d65 2028 6f64 6420 6e75 6d62   theme (odd numb
+00010680: 6572 7329 2c20 7368 6f77 696e 6720 696e  ers), showing in
+00010690: 2070 6169 7273 0a2a 2074 6865 2066 6972   pairs.* the fir
+000106a0: 7374 2074 6865 6d65 2028 7468 656d 6520  st theme (theme 
+000106b0: 3020 616e 6420 3129 2069 7320 6068 746d  0 and 1) is `htm
+000106c0: 6c2e 6160 2c20 7365 636f 6e64 2074 6865  l.a`, second the
+000106d0: 6d65 2028 3220 616e 6420 3329 2069 7320  me (2 and 3) is 
+000106e0: 6068 746d 6c2e 6260 0a2a 2069 6620 6120  `html.b`.* if a 
+000106f0: 6c69 6768 7420 7468 656d 6520 6973 2073  light theme is s
+00010700: 656c 6563 7465 642c 2060 6874 6d6c 2e79  elected, `html.y
+00010710: 6020 6973 2073 6574 2c20 6f74 6865 7277  ` is set, otherw
+00010720: 6973 6520 6068 746d 6c2e 7a60 2069 730a  ise `html.z` is.
+00010730: 2a20 736f 2069 6620 7468 6520 6461 726b  * so if the dark
+00010740: 2065 6469 7469 6f6e 206f 6620 7468 6520   edition of the 
+00010750: 326e 6420 7468 656d 6520 6973 2073 656c  2nd theme is sel
+00010760: 6563 7465 642c 2079 6f75 2075 7365 2061  ected, you use a
+00010770: 6e79 206f 6620 6068 746d 6c2e 6260 2c20  ny of `html.b`, 
+00010780: 6068 746d 6c2e 7a60 2c20 6068 746d 6c2e  `html.z`, `html.
+00010790: 627a 6020 746f 2073 7065 6369 6679 2072  bz` to specify r
+000107a0: 756c 6573 0a0a 7365 6520 7468 6520 746f  ules..see the to
+000107b0: 7020 6f66 205b 2e2f 636f 7079 7061 7274  p of [./copypart
+000107c0: 792f 7765 622f 6272 6f77 7365 722e 6373  y/web/browser.cs
+000107d0: 735d 282e 2f63 6f70 7970 6172 7479 2f77  s](./copyparty/w
+000107e0: 6562 2f62 726f 7773 6572 2e63 7373 2920  eb/browser.css) 
+000107f0: 7768 6572 6520 7468 6520 636f 6c6f 7220  where the color 
+00010800: 7661 7269 6162 6c65 7320 6172 6520 7365  variables are se
+00010810: 742c 2061 6e64 2074 6865 7265 2773 206c  t, and there's l
+00010820: 6179 6f75 742d 7370 6563 6966 6963 2073  ayout-specific s
+00010830: 7475 6666 206e 6561 7220 7468 6520 626f  tuff near the bo
+00010840: 7474 6f6d 0a0a 0a23 2320 636f 6d70 6c65  ttom...## comple
+00010850: 7465 2065 7861 6d70 6c65 730a 0a2a 205b  te examples..* [
+00010860: 7275 6e6e 696e 6720 6f6e 2077 696e 646f  running on windo
+00010870: 7773 5d28 2e2f 646f 6373 2f65 7861 6d70  ws](./docs/examp
+00010880: 6c65 732f 7769 6e64 6f77 732e 6d64 290a  les/windows.md).
+00010890: 0a2a 2072 6561 642d 6f6e 6c79 206d 7573  .* read-only mus
+000108a0: 6963 2073 6572 7665 7220 200a 2020 6070  ic server  .  `p
+000108b0: 7974 686f 6e20 636f 7079 7061 7274 792d  ython copyparty-
+000108c0: 7366 782e 7079 202d 7620 2f6d 6e74 2f6e  sfx.py -v /mnt/n
+000108d0: 6173 2f6d 7573 6963 3a2f 6d75 7369 633a  as/music:/music:
+000108e0: 7220 2d65 3264 7361 202d 6532 7473 202d  r -e2dsa -e2ts -
+000108f0: 2d6e 6f2d 726f 626f 7473 202d 2d66 6f72  -no-robots --for
+00010900: 6365 2d6a 7320 2d2d 7468 656d 6520 3260  ce-js --theme 2`
+00010910: 0a20 200a 2020 2a20 2e2e 2e77 6974 6820  .  .  * ...with 
+00010920: 6270 6d20 616e 6420 6b65 7920 7363 616e  bpm and key scan
+00010930: 6e69 6e67 2020 0a20 2020 2060 2d6d 7470  ning  .    `-mtp
+00010940: 202e 6270 6d3d 662c 6175 6469 6f2d 6270   .bpm=f,audio-bp
+00010950: 6d2e 7079 202d 6d74 7020 6b65 793d 662c  m.py -mtp key=f,
+00010960: 6175 6469 6f2d 6b65 792e 7079 600a 2020  audio-key.py`.  
+00010970: 0a20 202a 202e 2e2e 7769 7468 2061 2072  .  * ...with a r
+00010980: 6561 642d 7772 6974 6520 666f 6c64 6572  ead-write folder
+00010990: 2066 6f72 2060 6b65 7669 6e60 2077 686f   for `kevin` who
+000109a0: 7365 2070 6173 7377 6f72 6420 6973 2060  se password is `
+000109b0: 6f6b 676f 6020 200a 2020 2020 602d 6120  okgo`  .    `-a 
+000109c0: 6b65 7669 6e3a 6f6b 676f 202d 7620 2f6d  kevin:okgo -v /m
+000109d0: 6e74 2f6e 6173 2f69 6e63 3a2f 696e 633a  nt/nas/inc:/inc:
+000109e0: 7277 2c6b 6576 696e 600a 2020 0a20 202a  rw,kevin`.  .  *
+000109f0: 202e 2e2e 7769 7468 206c 6f67 6769 6e67   ...with logging
+00010a00: 2074 6f20 6469 736b 2020 0a20 2020 2060   to disk  .    `
+00010a10: 2d6c 6f20 6c6f 672f 6370 702d 2559 2d25  -lo log/cpp-%Y-%
+00010a20: 6d25 642d 2548 254d 2553 2e74 7874 2e78  m%d-%H%M%S.txt.x
+00010a30: 7a60 0a0a 0a23 2320 7265 7665 7273 652d  z`...## reverse-
+00010a40: 7072 6f78 790a 0a72 756e 6e69 6e67 2063  proxy..running c
+00010a50: 6f70 7970 6172 7479 206e 6578 7420 746f  opyparty next to
+00010a60: 206f 7468 6572 2077 6562 7369 7465 7320   other websites 
+00010a70: 2068 6f73 7465 6420 6f6e 2061 6e20 6578   hosted on an ex
+00010a80: 6973 7469 6e67 2077 6562 7365 7276 6572  isting webserver
+00010a90: 2073 7563 6820 6173 206e 6769 6e78 2c20   such as nginx, 
+00010aa0: 6361 6464 792c 206f 7220 6170 6163 6865  caddy, or apache
+00010ab0: 0a0a 796f 7520 6361 6e20 6569 7468 6572  ..you can either
+00010ac0: 3a0a 2a20 6769 7665 2063 6f70 7970 6172  :.* give copypar
+00010ad0: 7479 2069 7473 206f 776e 2064 6f6d 6169  ty its own domai
+00010ae0: 6e20 6f72 2073 7562 646f 6d61 696e 2028  n or subdomain (
+00010af0: 7265 636f 6d6d 656e 6465 6429 0a2a 206f  recommended).* o
+00010b00: 7220 646f 206c 6f63 6174 696f 6e2d 6261  r do location-ba
+00010b10: 7365 6420 7072 6f78 7969 6e67 2c20 7573  sed proxying, us
+00010b20: 696e 6720 602d 2d72 702d 6c6f 633d 2f73  ing `--rp-loc=/s
+00010b30: 7475 6666 6020 746f 2074 656c 6c20 636f  tuff` to tell co
+00010b40: 7079 7061 7274 7920 7768 6572 6520 6974  pyparty where it
+00010b50: 2069 7320 6d6f 756e 7465 6420 2d2d 2068   is mounted -- h
+00010b60: 6173 2061 2073 6c69 6768 7420 7065 7266  as a slight perf
+00010b70: 6f72 6d61 6e63 6520 636f 7374 2061 6e64  ormance cost and
+00010b80: 2068 6967 6865 7220 6368 616e 6365 206f   higher chance o
+00010b90: 6620 6275 6773 0a20 202a 2069 6620 636f  f bugs.  * if co
+00010ba0: 7079 7061 7274 7920 7361 7973 2060 696e  pyparty says `in
+00010bb0: 636f 7272 6563 7420 2d2d 7270 2d6c 6f63  correct --rp-loc
+00010bc0: 206f 7220 7765 6273 6572 7665 7220 636f   or webserver co
+00010bd0: 6e66 6967 3b20 6578 7065 6374 6564 2076  nfig; expected v
+00010be0: 7061 7468 2073 7461 7274 696e 6720 7769  path starting wi
+00010bf0: 7468 205b 2e2e 2e5d 6020 6974 2773 206c  th [...]` it's l
+00010c00: 696b 656c 7920 6265 6361 7573 6520 7468  ikely because th
+00010c10: 6520 7765 6273 6572 7665 7220 6973 2073  e webserver is s
+00010c20: 7472 6970 7069 6e67 2061 7761 7920 7468  tripping away th
+00010c30: 6520 7072 6f78 7920 6c6f 6361 7469 6f6e  e proxy location
+00010c40: 2066 726f 6d20 7468 6520 7265 7175 6573   from the reques
+00010c50: 7420 5552 4c73 202d 2d20 7365 6520 7468  t URLs -- see th
+00010c60: 6520 6050 726f 7879 5061 7373 6020 696e  e `ProxyPass` in
+00010c70: 2074 6865 2061 7061 6368 6520 6578 616d   the apache exam
+00010c80: 706c 6520 6265 6c6f 770a 0a73 6f6d 6520  ple below..some 
+00010c90: 7265 7665 7273 6520 7072 6f78 6965 7320  reverse proxies 
+00010ca0: 2873 7563 6820 6173 205b 4361 6464 795d  (such as [Caddy]
+00010cb0: 2868 7474 7073 3a2f 2f63 6164 6479 7365  (https://caddyse
+00010cc0: 7276 6572 2e63 6f6d 2f29 2920 6361 6e20  rver.com/)) can 
+00010cd0: 6175 746f 6d61 7469 6361 6c6c 7920 6f62  automatically ob
+00010ce0: 7461 696e 2061 2076 616c 6964 2068 7474  tain a valid htt
+00010cf0: 7073 2f74 6c73 2063 6572 7469 6669 6361  ps/tls certifica
+00010d00: 7465 2066 6f72 2079 6f75 2c20 616e 6420  te for you, and 
+00010d10: 736f 6d65 2073 7570 706f 7274 2048 5454  some support HTT
+00010d20: 502f 3220 616e 6420 5155 4943 2077 6869  P/2 and QUIC whi
+00010d30: 6368 2063 6f75 6c64 2062 6520 6120 6e69  ch could be a ni
+00010d40: 6365 2073 7065 6564 2062 6f6f 7374 0a0a  ce speed boost..
+00010d50: 6578 616d 706c 6520 7765 6273 6572 7665  example webserve
+00010d60: 7220 636f 6e66 6967 733a 0a0a 2a20 5b6e  r configs:..* [n
+00010d70: 6769 6e78 2063 6f6e 6669 675d 2863 6f6e  ginx config](con
+00010d80: 7472 6962 2f6e 6769 6e78 2f63 6f70 7970  trib/nginx/copyp
+00010d90: 6172 7479 2e63 6f6e 6629 202d 2d20 656e  arty.conf) -- en
+00010da0: 7469 7265 2064 6f6d 6169 6e2f 7375 6264  tire domain/subd
+00010db0: 6f6d 6169 6e0a 2a20 5b61 7061 6368 6532  omain.* [apache2
+00010dc0: 2063 6f6e 6669 675d 2863 6f6e 7472 6962   config](contrib
+00010dd0: 2f61 7061 6368 652f 636f 7079 7061 7274  /apache/copypart
+00010de0: 792e 636f 6e66 2920 2d2d 206c 6f63 6174  y.conf) -- locat
+00010df0: 696f 6e2d 6261 7365 640a 0a0a 2320 7061  ion-based...# pa
+00010e00: 636b 6167 6573 0a0a 7468 6520 7061 7274  ckages..the part
+00010e10: 7920 6d69 6768 7420 6265 2063 6c6f 7365  y might be close
+00010e20: 7220 7468 616e 2079 6f75 2074 6869 6e6b  r than you think
+00010e30: 0a0a 0a23 2320 6172 6368 2070 6163 6b61  ...## arch packa
+00010e40: 6765 0a0a 6e6f 7720 5b61 7661 696c 6162  ge..now [availab
+00010e50: 6c65 206f 6e20 6175 725d 2868 7474 7073  le on aur](https
+00010e60: 3a2f 2f61 7572 2e61 7263 686c 696e 7578  ://aur.archlinux
+00010e70: 2e6f 7267 2f70 6163 6b61 6765 732f 636f  .org/packages/co
+00010e80: 7079 7061 7274 7929 206d 6169 6e74 6169  pyparty) maintai
+00010e90: 6e65 6420 6279 205b 4069 6378 6573 5d28  ned by [@icxes](
+00010ea0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00010eb0: 6f6d 2f69 6378 6573 290a 0a0a 2323 206e  om/icxes)...## n
+00010ec0: 6978 2070 6163 6b61 6765 0a0a 606e 6978  ix package..`nix
+00010ed0: 2070 726f 6669 6c65 2069 6e73 7461 6c6c   profile install
+00010ee0: 2067 6974 6875 623a 3930 3031 2f63 6f70   github:9001/cop
+00010ef0: 7970 6172 7479 600a 0a72 6571 7569 7265  yparty`..require
+00010f00: 7320 6120 5b66 6c61 6b65 2d65 6e61 626c  s a [flake-enabl
+00010f10: 6564 5d28 6874 7470 733a 2f2f 6e69 786f  ed](https://nixo
+00010f20: 732e 7769 6b69 2f77 696b 692f 466c 616b  s.wiki/wiki/Flak
+00010f30: 6573 2920 696e 7374 616c 6c61 7469 6f6e  es) installation
+00010f40: 206f 6620 6e69 780a 0a73 6f6d 6520 7265   of nix..some re
+00010f50: 636f 6d6d 656e 6465 6420 6465 7065 6e64  commended depend
+00010f60: 656e 6369 6573 2061 7265 2065 6e61 626c  encies are enabl
+00010f70: 6564 2062 7920 6465 6661 756c 743b 205b  ed by default; [
+00010f80: 6f76 6572 7269 6465 2074 6865 2070 6163  override the pac
+00010f90: 6b61 6765 5d28 6874 7470 733a 2f2f 6769  kage](https://gi
+00010fa0: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
+00010fb0: 7079 7061 7274 792f 626c 6f62 2f68 6f76  pyparty/blob/hov
+00010fc0: 7564 7374 7261 756d 2f63 6f6e 7472 6962  udstraum/contrib
+00010fd0: 2f70 6163 6b61 6765 2f6e 6978 2f63 6f70  /package/nix/cop
+00010fe0: 7970 6172 7479 2f64 6566 6175 6c74 2e6e  yparty/default.n
+00010ff0: 6978 234c 332d 4c32 3229 2069 6620 796f  ix#L3-L22) if yo
+00011000: 7520 7761 6e74 2074 6f20 6164 642f 7265  u want to add/re
+00011010: 6d6f 7665 2073 6f6d 6520 6665 6174 7572  move some featur
+00011020: 6573 2f64 6570 730a 0a60 6666 6d70 6567  es/deps..`ffmpeg
+00011030: 2d66 756c 6c60 2077 6173 2063 686f 7365  -full` was chose
+00011040: 6e20 6f76 6572 2060 6666 6d70 6567 2d68  n over `ffmpeg-h
+00011050: 6561 646c 6573 7360 206d 6169 6e6c 7920  eadless` mainly 
+00011060: 6265 6361 7573 6520 7765 206e 6565 6420  because we need 
+00011070: 6077 6974 6857 6562 7060 2028 616e 6420  `withWebp` (and 
+00011080: 6077 6974 684f 7065 6e6d 7074 6020 6973  `withOpenmpt` is
+00011090: 2061 6c73 6f20 6e69 6365 2920 616e 6420   also nice) and 
+000110a0: 6265 696e 6720 6162 6c65 2074 6f20 7573  being able to us
+000110b0: 6520 6120 6361 6368 6564 2062 7569 6c64  e a cached build
+000110c0: 2066 656c 7420 6d6f 7265 2069 6d70 6f72   felt more impor
+000110d0: 7461 6e74 2074 6861 6e20 6f70 7469 6d69  tant than optimi
+000110e0: 7a69 6e67 2066 6f72 2073 697a 6520 6174  zing for size at
+000110f0: 2074 6865 2074 696d 6520 2d2d 2050 5273   the time -- PRs
+00011100: 2077 656c 636f 6d65 2069 6620 796f 7520   welcome if you 
+00011110: 6469 7361 6772 6565 20f0 9f91 8d0a 0a0a  disagree .......
+00011120: 2323 206e 6978 6f73 206d 6f64 756c 650a  ## nixos module.
+00011130: 0a66 6f72 2074 6869 7320 7365 7475 702c  .for this setup,
+00011140: 2079 6f75 2077 696c 6c20 6e65 6564 2061   you will need a
+00011150: 205b 666c 616b 652d 656e 6162 6c65 645d   [flake-enabled]
+00011160: 2868 7474 7073 3a2f 2f6e 6978 6f73 2e77  (https://nixos.w
+00011170: 696b 692f 7769 6b69 2f46 6c61 6b65 7329  iki/wiki/Flakes)
+00011180: 2069 6e73 7461 6c6c 6174 696f 6e20 6f66   installation of
+00011190: 204e 6978 4f53 2e0a 0a60 6060 6e69 780a   NixOS...```nix.
+000111a0: 7b0a 2020 2320 6164 6420 636f 7079 7061  {.  # add copypa
+000111b0: 7274 7920 666c 616b 6520 746f 2079 6f75  rty flake to you
+000111c0: 7220 696e 7075 7473 0a20 2069 6e70 7574  r inputs.  input
+000111d0: 732e 636f 7079 7061 7274 792e 7572 6c20  s.copyparty.url 
+000111e0: 3d20 2267 6974 6875 623a 3930 3031 2f63  = "github:9001/c
+000111f0: 6f70 7970 6172 7479 223b 0a0a 2020 2320  opyparty";..  # 
+00011200: 656e 7375 7265 2074 6861 7420 636f 7079  ensure that copy
+00011210: 7061 7274 7920 6973 2061 6e20 616c 6c6f  party is an allo
+00011220: 7765 6420 6172 6775 6d65 6e74 2074 6f20  wed argument to 
+00011230: 7468 6520 6f75 7470 7574 7320 6675 6e63  the outputs func
+00011240: 7469 6f6e 0a20 206f 7574 7075 7473 203d  tion.  outputs =
+00011250: 207b 2073 656c 662c 206e 6978 706b 6773   { self, nixpkgs
+00011260: 2c20 636f 7079 7061 7274 7920 7d3a 207b  , copyparty }: {
+00011270: 0a20 2020 206e 6978 6f73 436f 6e66 6967  .    nixosConfig
+00011280: 7572 6174 696f 6e73 2e79 6f75 7248 6f73  urations.yourHos
+00011290: 744e 616d 6520 3d20 6e69 7870 6b67 732e  tName = nixpkgs.
+000112a0: 6c69 622e 6e69 786f 7353 7973 7465 6d20  lib.nixosSystem 
+000112b0: 7b0a 2020 2020 2020 6d6f 6475 6c65 7320  {.      modules 
+000112c0: 3d20 5b0a 2020 2020 2020 2020 2320 6c6f  = [.        # lo
+000112d0: 6164 2074 6865 2063 6f70 7970 6172 7479  ad the copyparty
+000112e0: 204e 6978 4f53 206d 6f64 756c 650a 2020   NixOS module.  
+000112f0: 2020 2020 2020 636f 7079 7061 7274 792e        copyparty.
+00011300: 6e69 786f 734d 6f64 756c 6573 2e64 6566  nixosModules.def
+00011310: 6175 6c74 0a20 2020 2020 2020 2028 7b20  ault.        ({ 
+00011320: 706b 6773 2c20 2e2e 2e20 7d3a 207b 0a20  pkgs, ... }: {. 
+00011330: 2020 2020 2020 2020 2023 2061 6464 2074           # add t
+00011340: 6865 2063 6f70 7970 6172 7479 206f 7665  he copyparty ove
+00011350: 726c 6179 2074 6f20 6578 706f 7365 2074  rlay to expose t
+00011360: 6865 2070 6163 6b61 6765 2074 6f20 7468  he package to th
+00011370: 6520 6d6f 6475 6c65 0a20 2020 2020 2020  e module.       
+00011380: 2020 206e 6978 706b 6773 2e6f 7665 726c     nixpkgs.overl
+00011390: 6179 7320 3d20 5b20 636f 7079 7061 7274  ays = [ copypart
+000113a0: 792e 6f76 6572 6c61 7973 2e64 6566 6175  y.overlays.defau
+000113b0: 6c74 205d 3b0a 2020 2020 2020 2020 2020  lt ];.          
+000113c0: 2320 286f 7074 696f 6e61 6c29 2069 6e73  # (optional) ins
+000113d0: 7461 6c6c 2074 6865 2070 6163 6b61 6765  tall the package
+000113e0: 2067 6c6f 6261 6c6c 790a 2020 2020 2020   globally.      
+000113f0: 2020 2020 656e 7669 726f 6e6d 656e 742e      environment.
+00011400: 7379 7374 656d 5061 636b 6167 6573 203d  systemPackages =
+00011410: 205b 2070 6b67 732e 636f 7079 7061 7274   [ pkgs.copypart
+00011420: 7920 5d3b 0a20 2020 2020 2020 2020 2023  y ];.          #
+00011430: 2063 6f6e 6669 6775 7265 2074 6865 2063   configure the c
+00011440: 6f70 7970 6172 7479 206d 6f64 756c 650a  opyparty module.
+00011450: 2020 2020 2020 2020 2020 7365 7276 6963            servic
+00011460: 6573 2e63 6f70 7970 6172 7479 2e65 6e61  es.copyparty.ena
+00011470: 626c 6520 3d20 7472 7565 3b0a 2020 2020  ble = true;.    
+00011480: 2020 2020 7d29 0a20 2020 2020 205d 3b0a      }).      ];.
+00011490: 2020 2020 7d3b 0a20 207d 3b0a 7d0a 6060      };.  };.}.``
+000114a0: 600a 0a63 6f70 7970 6172 7479 206f 6e20  `..copyparty on 
+000114b0: 4e69 784f 5320 6973 2063 6f6e 6669 6775  NixOS is configu
+000114c0: 7265 6420 7669 6120 6073 6572 7669 6365  red via `service
+000114d0: 732e 636f 7079 7061 7274 7960 206f 7074  s.copyparty` opt
+000114e0: 696f 6e73 2c20 666f 7220 6578 616d 706c  ions, for exampl
+000114f0: 653a 0a60 6060 6e69 780a 7365 7276 6963  e:.```nix.servic
+00011500: 6573 2e63 6f70 7970 6172 7479 203d 207b  es.copyparty = {
+00011510: 0a20 2065 6e61 626c 6520 3d20 7472 7565  .  enable = true
+00011520: 3b0a 2020 2320 6469 7265 6374 6c79 206d  ;.  # directly m
+00011530: 6170 7320 746f 2076 616c 7565 7320 696e  aps to values in
+00011540: 2074 6865 205b 676c 6f62 616c 5d20 7365   the [global] se
+00011550: 6374 696f 6e20 6f66 2074 6865 2063 6f70  ction of the cop
+00011560: 7970 6172 7479 2063 6f6e 6669 672e 0a20  yparty config.. 
+00011570: 2023 2073 6565 2060 636f 7079 7061 7274   # see `copypart
+00011580: 7920 2d2d 6865 6c70 6020 666f 7220 6176  y --help` for av
+00011590: 6169 6c61 626c 6520 6f70 7469 6f6e 730a  ailable options.
+000115a0: 2020 7365 7474 696e 6773 203d 207b 0a20    settings = {. 
+000115b0: 2020 2069 203d 2022 302e 302e 302e 3022     i = "0.0.0.0"
+000115c0: 3b0a 2020 2020 2320 7573 6520 6c69 7374  ;.    # use list
+000115d0: 7320 746f 2073 6574 206d 756c 7469 706c  s to set multipl
+000115e0: 6520 7661 6c75 6573 0a20 2020 2070 203d  e values.    p =
+000115f0: 205b 2033 3231 3020 3332 3131 205d 3b0a   [ 3210 3211 ];.
+00011600: 2020 2020 2320 7573 6520 626f 6f6c 6561      # use boolea
+00011610: 6e73 2074 6f20 7365 7420 6269 6e61 7279  ns to set binary
+00011620: 2066 6c61 6773 0a20 2020 206e 6f2d 7265   flags.    no-re
+00011630: 6c6f 6164 203d 2074 7275 653b 0a20 2020  load = true;.   
+00011640: 2023 2075 7369 6e67 2027 6661 6c73 6527   # using 'false'
+00011650: 2077 696c 6c20 646f 206e 6f74 6869 6e67   will do nothing
+00011660: 2061 6e64 206f 6d69 7420 7468 6520 7661   and omit the va
+00011670: 6c75 6520 7768 656e 2067 656e 6572 6174  lue when generat
+00011680: 696e 6720 6120 636f 6e66 6967 0a20 2020  ing a config.   
+00011690: 2069 676e 6f72 6564 2d66 6c61 6720 3d20   ignored-flag = 
+000116a0: 6661 6c73 653b 0a20 207d 3b0a 0a20 2023  false;.  };..  #
+000116b0: 2063 7265 6174 6520 7573 6572 730a 2020   create users.  
+000116c0: 6163 636f 756e 7473 203d 207b 0a20 2020  accounts = {.   
+000116d0: 2023 2073 7065 6369 6679 2074 6865 2061   # specify the a
+000116e0: 6363 6f75 6e74 206e 616d 6520 6173 2074  ccount name as t
+000116f0: 6865 206b 6579 0a20 2020 2065 6420 3d20  he key.    ed = 
+00011700: 7b0a 2020 2020 2020 2320 7072 6f76 6964  {.      # provid
+00011710: 6520 7468 6520 7061 7468 2074 6f20 6120  e the path to a 
+00011720: 6669 6c65 2063 6f6e 7461 696e 696e 6720  file containing 
+00011730: 7468 6520 7061 7373 776f 7264 2c20 6b65  the password, ke
+00011740: 6570 696e 6720 6974 206f 7574 206f 6620  eping it out of 
+00011750: 2f6e 6978 2f73 746f 7265 0a20 2020 2020  /nix/store.     
+00011760: 2023 206d 7573 7420 6265 2072 6561 6461   # must be reada
+00011770: 626c 6520 6279 2074 6865 2063 6f70 7970  ble by the copyp
+00011780: 6172 7479 2073 6572 7669 6365 2075 7365  arty service use
+00011790: 720a 2020 2020 2020 7061 7373 776f 7264  r.      password
+000117a0: 4669 6c65 203d 2022 2f72 756e 2f6b 6579  File = "/run/key
+000117b0: 732f 636f 7079 7061 7274 792f 6564 5f70  s/copyparty/ed_p
+000117c0: 6173 7377 6f72 6422 3b0a 2020 2020 7d3b  assword";.    };
+000117d0: 0a20 2020 2023 206f 7220 646f 2062 6f74  .    # or do bot
+000117e0: 6820 696e 206f 6e65 2067 6f0a 2020 2020  h in one go.    
+000117f0: 6b2e 7061 7373 776f 7264 4669 6c65 203d  k.passwordFile =
+00011800: 2022 2f72 756e 2f6b 6579 732f 636f 7079   "/run/keys/copy
+00011810: 7061 7274 792f 6b5f 7061 7373 776f 7264  party/k_password
+00011820: 223b 0a20 207d 3b0a 0a20 2023 2063 7265  ";.  };..  # cre
+00011830: 6174 6520 6120 766f 6c75 6d65 0a20 2076  ate a volume.  v
+00011840: 6f6c 756d 6573 203d 207b 0a20 2020 2023  olumes = {.    #
+00011850: 2063 7265 6174 6520 6120 766f 6c75 6d65   create a volume
+00011860: 2061 7420 222f 2220 2874 6865 2077 6562   at "/" (the web
+00011870: 726f 6f74 292c 2077 6869 6368 2077 696c  root), which wil
+00011880: 6c0a 2020 2020 222f 2220 3d20 7b0a 2020  l.    "/" = {.  
+00011890: 2020 2020 2320 7368 6172 6520 7468 6520      # share the 
+000118a0: 636f 6e74 656e 7473 206f 6620 222f 7372  contents of "/sr
+000118b0: 762f 636f 7079 7061 7274 7922 0a20 2020  v/copyparty".   
+000118c0: 2020 2070 6174 6820 3d20 222f 7372 762f     path = "/srv/
+000118d0: 636f 7079 7061 7274 7922 3b0a 2020 2020  copyparty";.    
+000118e0: 2020 2320 7365 6520 6063 6f70 7970 6172    # see `copypar
+000118f0: 7479 202d 2d68 656c 702d 6163 636f 756e  ty --help-accoun
+00011900: 7473 6020 666f 7220 6176 6169 6c61 626c  ts` for availabl
+00011910: 6520 6f70 7469 6f6e 730a 2020 2020 2020  e options.      
+00011920: 6163 6365 7373 203d 207b 0a20 2020 2020  access = {.     
+00011930: 2020 2023 2065 7665 7279 6f6e 6520 6765     # everyone ge
+00011940: 7473 2072 6561 642d 6163 6365 7373 2c20  ts read-access, 
+00011950: 6275 740a 2020 2020 2020 2020 7220 3d20  but.        r = 
+00011960: 222a 223b 0a20 2020 2020 2020 2023 2075  "*";.        # u
+00011970: 7365 7273 2022 6564 2220 616e 6420 226b  sers "ed" and "k
+00011980: 2220 6765 7420 7265 6164 2d77 7269 7465  " get read-write
+00011990: 0a20 2020 2020 2020 2072 7720 3d20 5b20  .        rw = [ 
+000119a0: 2265 6422 2022 6b22 205d 3b0a 2020 2020  "ed" "k" ];.    
+000119b0: 2020 7d3b 0a20 2020 2020 2023 2073 6565    };.      # see
+000119c0: 2060 636f 7079 7061 7274 7920 2d2d 6865   `copyparty --he
+000119d0: 6c70 2d66 6c61 6773 6020 666f 7220 6176  lp-flags` for av
+000119e0: 6169 6c61 626c 6520 6f70 7469 6f6e 730a  ailable options.
+000119f0: 2020 2020 2020 666c 6167 7320 3d20 7b0a        flags = {.
+00011a00: 2020 2020 2020 2020 2320 2266 6b22 2065          # "fk" e
+00011a10: 6e61 626c 6573 2066 696c 656b 6579 7320  nables filekeys 
+00011a20: 286e 6563 6573 7361 7279 2066 6f72 2075  (necessary for u
+00011a30: 7067 6574 2070 6572 6d69 7373 696f 6e29  pget permission)
+00011a40: 2028 3420 6368 6172 7320 6c6f 6e67 290a   (4 chars long).
+00011a50: 2020 2020 2020 2020 666b 203d 2034 3b0a          fk = 4;.
+00011a60: 2020 2020 2020 2020 2320 7363 616e 2066          # scan f
+00011a70: 6f72 206e 6577 2066 696c 6573 2065 7665  or new files eve
+00011a80: 7279 2036 3073 6563 0a20 2020 2020 2020  ry 60sec.       
+00011a90: 2073 6361 6e20 3d20 3630 3b0a 2020 2020   scan = 60;.    
+00011aa0: 2020 2020 2320 766f 6c66 6c61 6720 2265      # volflag "e
+00011ab0: 3264 2220 656e 6162 6c65 7320 7468 6520  2d" enables the 
+00011ac0: 7570 6c6f 6164 7320 6461 7461 6261 7365  uploads database
+00011ad0: 0a20 2020 2020 2020 2065 3264 203d 2074  .        e2d = t
+00011ae0: 7275 653b 0a20 2020 2020 2020 2023 2022  rue;.        # "
+00011af0: 6432 7422 2064 6973 6162 6c65 7320 6d75  d2t" disables mu
+00011b00: 6c74 696d 6564 6961 2070 6172 7365 7273  ltimedia parsers
+00011b10: 2028 696e 2063 6173 6520 7468 6520 7570   (in case the up
+00011b20: 6c6f 6164 7320 6172 6520 6d61 6c69 6369  loads are malici
+00011b30: 6f75 7329 0a20 2020 2020 2020 2064 3274  ous).        d2t
+00011b40: 203d 2074 7275 653b 0a20 2020 2020 2020   = true;.       
+00011b50: 2023 2073 6b69 7073 2068 6173 6869 6e67   # skips hashing
+00011b60: 2066 696c 6520 636f 6e74 656e 7473 2069   file contents i
+00011b70: 6620 7061 7468 206d 6174 6368 6573 202a  f path matches *
+00011b80: 2e69 736f 0a20 2020 2020 2020 206e 6f68  .iso.        noh
+00011b90: 6173 6820 3d20 225c 2e69 736f 2422 3b0a  ash = "\.iso$";.
+00011ba0: 2020 2020 2020 7d3b 0a20 2020 207d 3b0a        };.    };.
+00011bb0: 2020 7d3b 0a20 2023 2079 6f75 206d 6179    };.  # you may
+00011bc0: 2069 6e63 7265 6173 6520 7468 6520 6f70   increase the op
+00011bd0: 656e 2066 696c 6520 6c69 6d69 7420 666f  en file limit fo
+00011be0: 7220 7468 6520 7072 6f63 6573 730a 2020  r the process.  
+00011bf0: 6f70 656e 4669 6c65 734c 696d 6974 203d  openFilesLimit =
+00011c00: 2038 3139 323b 0a7d 3b0a 6060 600a 0a74   8192;.};.```..t
+00011c10: 6865 2070 6173 7377 6f72 6446 696c 6520  he passwordFile 
+00011c20: 6174 202f 7275 6e2f 6b65 7973 2f63 6f70  at /run/keys/cop
+00011c30: 7970 6172 7479 2f20 636f 756c 6420 666f  yparty/ could fo
+00011c40: 7220 6578 616d 706c 6520 6265 2067 656e  r example be gen
+00011c50: 6572 6174 6564 2062 7920 5b61 6765 6e69  erated by [ageni
+00011c60: 785d 2868 7474 7073 3a2f 2f67 6974 6875  x](https://githu
+00011c70: 622e 636f 6d2f 7279 616e 746d 2f61 6765  b.com/ryantm/age
+00011c80: 6e69 7829 2c20 6f72 2079 6f75 2063 6f75  nix), or you cou
+00011c90: 6c64 206a 7573 7420 6475 6d70 2069 7420  ld just dump it 
+00011ca0: 696e 2074 6865 206e 6978 2073 746f 7265  in the nix store
+00011cb0: 2069 6e73 7465 6164 2069 6620 7468 6174   instead if that
+00011cc0: 2773 2061 6363 6570 7461 626c 650a 0a0a  's acceptable...
+00011cd0: 2320 6272 6f77 7365 7220 7375 7070 6f72  # browser suppor
+00011ce0: 740a 0a54 4c44 523a 2079 6573 0a0a 215b  t..TLDR: yes..![
+00011cf0: 636f 7079 7061 7274 792d 6965 342d 6673  copyparty-ie4-fs
+00011d00: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
+00011d10: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00011d20: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00011d30: 3033 322f 3131 3831 3932 3739 312d 6662  032/118192791-fb
+00011d40: 3331 6665 3030 2d62 3434 362d 3131 6562  31fe00-b446-11eb
+00011d50: 2d39 3634 372d 3839 3865 6138 6566 6331  -9647-898ea8efc1
+00011d60: 6637 2e70 6e67 290a 0a60 6965 6020 3d20  f7.png)..`ie` = 
+00011d70: 696e 7465 726e 6574 2d65 7870 6c6f 7265  internet-explore
+00011d80: 722c 2060 6666 6020 3d20 6669 7265 666f  r, `ff` = firefo
+00011d90: 782c 2060 6360 203d 2063 6872 6f6d 652c  x, `c` = chrome,
+00011da0: 2060 694f 5360 203d 2069 5068 6f6e 652f   `iOS` = iPhone/
+00011db0: 6950 6164 2c20 6041 6e64 7260 203d 2041  iPad, `Andr` = A
+00011dc0: 6e64 726f 6964 0a0a 7c20 6665 6174 7572  ndroid..| featur
+00011dd0: 6520 2020 2020 2020 2020 7c20 6965 3620  e         | ie6 
+00011de0: 7c20 6965 3920 207c 2069 6531 3020 7c20  | ie9  | ie10 | 
+00011df0: 6965 3131 207c 2066 6620 3532 207c 2063  ie11 | ff 52 | c
+00011e00: 2034 3920 7c20 694f 5320 7c20 416e 6472   49 | iOS | Andr
+00011e10: 207c 0a7c 202d 2d2d 2d2d 2d2d 2d2d 2d2d   |.| -----------
+00011e20: 2d2d 2d2d 207c 202d 2d2d 207c 202d 2d2d  ---- | --- | ---
+00011e30: 2d20 7c20 2d2d 2d2d 207c 202d 2d2d 2d20  - | ---- | ---- 
+00011e40: 7c20 2d2d 2d2d 2d20 7c20 2d2d 2d2d 207c  | ----- | ---- |
+00011e50: 202d 2d2d 207c 202d 2d2d 2d20 7c0a 7c20   --- | ---- |.| 
+00011e60: 6272 6f77 7365 2066 696c 6573 2020 2020  browse files    
+00011e70: 7c20 7965 7020 7c20 7965 7020 207c 2079  | yep | yep  | y
+00011e80: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
+00011e90: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011ea0: 7c20 7965 7020 207c 0a7c 2074 6875 6d62  | yep  |.| thumb
+00011eb0: 6e61 696c 2076 6965 7720 207c 2020 2d20  nail view  |  - 
+00011ec0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
+00011ed0: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
+00011ee0: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
+00011ef0: 2020 7c0a 7c20 6261 7369 6320 7570 6c6f    |.| basic uplo
+00011f00: 6164 6572 2020 7c20 7965 7020 7c20 7965  ader  | yep | ye
+00011f10: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011f20: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
+00011f30: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
+00011f40: 2075 7032 6b20 2020 2020 2020 2020 2020   up2k           
+00011f50: 207c 2020 2d20 207c 2020 2d20 2020 7c20   |  -  |  -   | 
+00011f60: 602a 3160 207c 2060 2a31 6020 7c20 2079  `*1` | `*1` |  y
+00011f70: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+00011f80: 207c 2079 6570 2020 7c0a 7c20 6d61 6b65   | yep  |.| make
+00011f90: 2064 6972 6563 746f 7279 2020 7c20 7965   directory  | ye
+00011fa0: 7020 7c20 7965 7020 207c 2079 6570 2020  p | yep  | yep  
+00011fb0: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
+00011fc0: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
+00011fd0: 7020 207c 0a7c 2073 656e 6420 6d65 7373  p  |.| send mess
+00011fe0: 6167 6520 2020 207c 2079 6570 207c 2079  age    | yep | y
+00011ff0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+00012000: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
+00012010: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
+00012020: 7c20 7365 7420 736f 7274 206f 7264 6572  | set sort order
+00012030: 2020 7c20 202d 2020 7c20 7965 7020 207c    |  -  | yep  |
+00012040: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
+00012050: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+00012060: 7020 7c20 7965 7020 207c 0a7c 207a 6970  p | yep  |.| zip
+00012070: 2073 656c 6563 7469 6f6e 2020 207c 2020   selection   |  
+00012080: 2d20 207c 2079 6570 2020 7c20 7965 7020  -  | yep  | yep 
+00012090: 207c 2079 6570 2020 7c20 2079 6570 2020   | yep  |  yep  
+000120a0: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
+000120b0: 6570 2020 7c0a 7c20 6669 6c65 2072 656e  ep  |.| file ren
+000120c0: 616d 6520 2020 2020 7c20 202d 2020 7c20  ame     |  -  | 
+000120d0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+000120e0: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
+000120f0: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
+00012100: 0a7c 2066 696c 6520 6375 742f 7061 7374  .| file cut/past
+00012110: 6520 207c 2020 2d20 207c 2079 6570 2020  e  |  -  | yep  
+00012120: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+00012130: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+00012140: 6570 207c 2079 6570 2020 7c0a 7c20 6e61  ep | yep  |.| na
+00012150: 7670 616e 6520 2020 2020 2020 2020 7c20  vpane         | 
+00012160: 202d 2020 7c20 7965 7020 207c 2079 6570   -  | yep  | yep
+00012170: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
+00012180: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
+00012190: 7965 7020 207c 0a7c 2069 6d61 6765 2076  yep  |.| image v
+000121a0: 6965 7765 7220 2020 207c 2020 2d20 207c  iewer    |  -  |
+000121b0: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+000121c0: 6570 2020 7c20 2079 6570 2020 7c20 7965  ep  |  yep  | ye
+000121d0: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
+000121e0: 7c0a 7c20 7669 6465 6f20 706c 6179 6572  |.| video player
+000121f0: 2020 2020 7c20 202d 2020 7c20 7965 7020      |  -  | yep 
+00012200: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
+00012210: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
+00012220: 7965 7020 7c20 7965 7020 207c 0a7c 206d  yep | yep  |.| m
+00012230: 6172 6b64 6f77 6e20 6564 6974 6f72 207c  arkdown editor |
+00012240: 2020 2d20 207c 2020 2d20 2020 7c20 7965    -  |  -   | ye
+00012250: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
+00012260: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
+00012270: 2079 6570 2020 7c0a 7c20 6d61 726b 646f   yep  |.| markdo
+00012280: 776e 2076 6965 7765 7220 7c20 202d 2020  wn viewer |  -  
+00012290: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+000122a0: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
+000122b0: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
+000122c0: 207c 0a7c 2070 6c61 7920 6d70 332f 6d34   |.| play mp3/m4
+000122d0: 6120 2020 207c 2020 2d20 207c 2079 6570  a    |  -  | yep
+000122e0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
+000122f0: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
+00012300: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
+00012310: 706c 6179 206f 6767 2f6f 7075 7320 2020  play ogg/opus   
+00012320: 7c20 202d 2020 7c20 202d 2020 207c 2020  |  -  |  -   |  
+00012330: 2d20 2020 7c20 202d 2020 207c 2020 7965  -   |  -   |  ye
+00012340: 7020 207c 2079 6570 2020 7c20 602a 3360  p  | yep  | `*3`
+00012350: 207c 2079 6570 207c 0a7c 202a 2a3d 2066   | yep |.| **= f
+00012360: 6561 7475 7265 203d 2a2a 207c 2069 6536  eature =** | ie6
+00012370: 207c 2069 6539 2020 7c20 6965 3130 207c   | ie9  | ie10 |
+00012380: 2069 6531 3120 7c20 6666 2035 3220 7c20   ie11 | ff 52 | 
+00012390: 6320 3439 207c 2069 4f53 207c 2041 6e64  c 49 | iOS | And
+000123a0: 7220 7c0a 0a2a 2069 6e74 6572 6e65 7420  r |..* internet 
+000123b0: 6578 706c 6f72 6572 2036 2074 6f20 3820  explorer 6 to 8 
+000123c0: 6265 6861 7665 2074 6865 2073 616d 650a  behave the same.
+000123d0: 2a20 6669 7265 666f 7820 3532 2061 6e64  * firefox 52 and
+000123e0: 2063 6872 6f6d 6520 3439 2061 7265 2074   chrome 49 are t
+000123f0: 6865 2066 696e 616c 2077 696e 7870 2076  he final winxp v
+00012400: 6572 7369 6f6e 730a 2a20 602a 3160 2079  ersions.* `*1` y
+00012410: 6573 2c20 6275 7420 6578 7472 656d 656c  es, but extremel
+00012420: 7920 736c 6f77 2028 6965 3130 3a20 6031  y slow (ie10: `1
+00012430: 204d 6942 2f73 602c 2069 6531 313a 2060   MiB/s`, ie11: `
+00012440: 3237 3020 4b69 422f 7360 290a 2a20 602a  270 KiB/s`).* `*
+00012450: 3360 2069 4f53 2031 3120 616e 6420 6e65  3` iOS 11 and ne
+00012460: 7765 722c 206f 7075 7320 6f6e 6c79 2c20  wer, opus only, 
+00012470: 616e 6420 7265 7175 6972 6573 2046 466d  and requires FFm
+00012480: 7065 6720 6f6e 2074 6865 2073 6572 7665  peg on the serve
+00012490: 720a 0a71 7569 636b 2073 756d 6d61 7279  r..quick summary
+000124a0: 206f 6620 6d6f 7265 2065 6363 656e 7472   of more eccentr
+000124b0: 6963 2077 6562 2d62 726f 7773 6572 7320  ic web-browsers 
+000124c0: 7472 7969 6e67 2074 6f20 7669 6577 2061  trying to view a
+000124d0: 2064 6972 6563 746f 7279 2069 6e64 6578   directory index
+000124e0: 3a0a 0a7c 2062 726f 7773 6572 207c 2077  :..| browser | w
+000124f0: 696c 6c20 6974 2062 6c65 6e64 207c 0a7c  ill it blend |.|
+00012500: 202d 2d2d 2d2d 2d2d 207c 202d 2d2d 2d2d   ------- | -----
+00012510: 2d2d 2d2d 2d2d 2d2d 207c 0a7c 202a 2a6c  -------- |.| **l
+00012520: 696e 6b73 2a2a 2028 322e 3231 2f6d 6163  inks** (2.21/mac
+00012530: 706f 7274 7329 207c 2063 616e 2062 726f  ports) | can bro
+00012540: 7773 652c 206c 6f67 696e 2c20 7570 6c6f  wse, login, uplo
+00012550: 6164 2f6d 6b64 6972 2f6d 7367 207c 0a7c  ad/mkdir/msg |.|
+00012560: 202a 2a6c 796e 782a 2a20 2832 2e38 2e39   **lynx** (2.8.9
+00012570: 2f6d 6163 706f 7274 7329 207c 2063 616e  /macports) | can
+00012580: 2062 726f 7773 652c 206c 6f67 696e 2c20   browse, login, 
+00012590: 7570 6c6f 6164 2f6d 6b64 6972 2f6d 7367  upload/mkdir/msg
+000125a0: 207c 0a7c 202a 2a77 336d 2a2a 2028 302e   |.| **w3m** (0.
+000125b0: 352e 332f 6d61 6370 6f72 7473 2920 207c  5.3/macports)  |
+000125c0: 2063 616e 2062 726f 7773 652c 206c 6f67   can browse, log
+000125d0: 696e 2c20 7570 6c6f 6164 2061 7420 3130  in, upload at 10
+000125e0: 306b 422f 732c 206d 6b64 6972 2f6d 7367  0kB/s, mkdir/msg
+000125f0: 207c 0a7c 202a 2a6e 6574 7375 7266 2a2a   |.| **netsurf**
+00012600: 2028 332e 3130 2f61 7263 6829 2020 207c   (3.10/arch)   |
+00012610: 2069 7320 6261 7369 6361 6c6c 7920 6965   is basically ie
+00012620: 3620 7769 7468 206d 7563 6820 6265 7474  6 with much bett
+00012630: 6572 2063 7373 2028 6a61 7661 7363 7269  er css (javascri
+00012640: 7074 2068 6173 2061 6c6d 6f73 7420 6e6f  pt has almost no
+00012650: 2065 6666 6563 7429 207c 200a 7c20 2a2a   effect) | .| **
+00012660: 6f70 6572 612a 2a20 2831 312e 3630 2f77  opera** (11.60/w
+00012670: 696e 7870 2920 2020 7c20 4f4b 3a20 7468  inxp)   | OK: th
+00012680: 756d 626e 6169 6c73 2c20 696d 6167 652d  umbnails, image-
+00012690: 7669 6577 6572 2c20 7a69 702d 7365 6c65  viewer, zip-sele
+000126a0: 6374 696f 6e2c 2072 656e 616d 652f 6375  ction, rename/cu
+000126b0: 742f 7061 7374 652e 204e 473a 2075 7032  t/paste. NG: up2
+000126c0: 6b2c 206e 6176 7061 6e65 2c20 6d61 726b  k, navpane, mark
+000126d0: 646f 776e 2c20 6175 6469 6f20 7c0a 7c20  down, audio |.| 
+000126e0: 2a2a 6965 342a 2a20 616e 6420 2a2a 6e65  **ie4** and **ne
+000126f0: 7473 6361 7065 2a2a 2034 2e30 2020 7c20  tscape** 4.0  | 
+00012700: 6361 6e20 6272 6f77 7365 2c20 7570 6c6f  can browse, uplo
+00012710: 6164 2077 6974 6820 603f 623d 7560 2c20  ad with `?b=u`, 
+00012720: 6175 7468 2077 6974 6820 6026 7077 3d77  auth with `&pw=w
+00012730: 6172 6b60 207c 0a7c 202a 2a6e 6373 6120  ark` |.| **ncsa 
+00012740: 6d6f 7361 6963 2a2a 2032 2e37 2020 2020  mosaic** 2.7    
+00012750: 2020 207c 2064 6f65 7320 6e6f 7420 6765     | does not ge
+00012760: 7420 6120 7061 7373 2c20 5b70 6963 315d  t a pass, [pic1]
+00012770: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
+00012780: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00012790: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+000127a0: 322f 3137 3431 3839 3232 372d 6165 3831  2/174189227-ae81
+000127b0: 3630 3236 2d63 6636 662d 3462 6535 2d61  6026-cf6f-4be5-a
+000127c0: 3236 652d 3162 3362 3037 3263 3162 3266  26e-1b3b072c1b2f
+000127d0: 2e70 6e67 2920 2d20 5b70 6963 325d 2868  .png) - [pic2](h
+000127e0: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+000127f0: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00012800: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00012810: 3137 3431 3839 3232 352d 3536 3531 6330  174189225-5651c0
+00012820: 3539 2d35 3135 322d 3436 6539 2d61 6332  59-5152-46e9-ac2
+00012830: 362d 3765 3938 6534 3937 3930 3162 2e70  6-7e98e497901b.p
+00012840: 6e67 2920 7c0a 7c20 2a2a 5365 7265 6e69  ng) |.| **Sereni
+00012850: 7479 4f53 2a2a 2028 3765 3938 3435 3729  tyOS** (7e98457)
+00012860: 2020 7c20 6869 7473 2061 2070 6167 6520    | hits a page 
+00012870: 6661 756c 742c 2077 6f72 6b73 2077 6974  fault, works wit
+00012880: 6820 603f 623d 7560 2c20 6669 6c65 2075  h `?b=u`, file u
+00012890: 706c 6f61 6420 6e6f 742d 696d 706c 207c  pload not-impl |
+000128a0: 0a0a 0a23 2063 6c69 656e 7420 6578 616d  ...# client exam
+000128b0: 706c 6573 0a0a 696e 7465 7261 6374 2077  ples..interact w
+000128c0: 6974 6820 636f 7079 7061 7274 7920 7573  ith copyparty us
+000128d0: 696e 6720 6e6f 6e2d 6272 6f77 7365 7220  ing non-browser 
+000128e0: 636c 6965 6e74 730a 0a2a 206a 6176 6173  clients..* javas
+000128f0: 6372 6970 743a 2064 756d 7020 736f 6d65  cript: dump some
+00012900: 2073 7461 7465 2069 6e74 6f20 6120 6669   state into a fi
+00012910: 6c65 2028 7477 6f20 7365 7061 7261 7465  le (two separate
+00012920: 2065 7861 6d70 6c65 7329 0a20 202a 2060   examples).  * `
+00012930: 6177 6169 7420 6665 7463 6828 272f 2f31  await fetch('//1
+00012940: 3237 2e30 2e30 2e31 3a33 3932 332f 272c  27.0.0.1:3923/',
+00012950: 207b 6d65 7468 6f64 3a22 5055 5422 2c20   {method:"PUT", 
+00012960: 626f 6479 3a20 4a53 4f4e 2e73 7472 696e  body: JSON.strin
+00012970: 6769 6679 2866 6f6f 297d 293b 600a 2020  gify(foo)});`.  
+00012980: 2a20 6076 6172 2078 6872 203d 206e 6577  * `var xhr = new
+00012990: 2058 4d4c 4874 7470 5265 7175 6573 7428   XMLHttpRequest(
+000129a0: 293b 2078 6872 2e6f 7065 6e28 2750 4f53  ); xhr.open('POS
+000129b0: 5427 2c20 272f 2f31 3237 2e30 2e30 2e31  T', '//127.0.0.1
+000129c0: 3a33 3932 332f 6d73 6773 3f72 6177 2729  :3923/msgs?raw')
+000129d0: 3b20 7868 722e 7365 6e64 2827 666f 6f27  ; xhr.send('foo'
+000129e0: 293b 600a 0a2a 2063 7572 6c2f 7767 6574  );`..* curl/wget
+000129f0: 3a20 7570 6c6f 6164 2073 6f6d 6520 6669  : upload some fi
+00012a00: 6c65 7320 2870 6f73 743d 6669 6c65 2c20  les (post=file, 
+00012a10: 6368 756e 6b3d 7374 6469 6e29 0a20 202a  chunk=stdin).  *
+00012a20: 2060 706f 7374 2829 7b20 6375 726c 202d   `post(){ curl -
+00012a30: 4620 6163 743d 6270 7574 202d 4620 663d  F act=bput -F f=
+00012a40: 4022 2431 2220 6874 7470 3a2f 2f31 3237  @"$1" http://127
+00012a50: 2e30 2e30 2e31 3a33 3932 332f 3f70 773d  .0.0.1:3923/?pw=
+00012a60: 7761 726b 3b7d 6020 200a 2020 2020 6070  wark;}`  .    `p
+00012a70: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012a80: 202a 2060 706f 7374 2829 7b20 6375 726c   * `post(){ curl
+00012a90: 202d 4820 7077 3a77 6172 6b20 2d48 2072   -H pw:wark -H r
+00012aa0: 616e 643a 3820 2d54 2022 2431 2220 6874  and:8 -T "$1" ht
+00012ab0: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a33  tp://127.0.0.1:3
+00012ac0: 3932 332f 3b7d 6020 200a 2020 2020 6070  923/;}`  .    `p
+00012ad0: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012ae0: 202a 2060 706f 7374 2829 7b20 7767 6574   * `post(){ wget
+00012af0: 202d 2d68 6561 6465 723d 2770 773a 2077   --header='pw: w
+00012b00: 6172 6b27 202d 2d70 6f73 742d 6669 6c65  ark' --post-file
+00012b10: 3d22 2431 2220 2d4f 2d20 6874 7470 3a2f  ="$1" -O- http:/
+00012b20: 2f31 3237 2e30 2e30 2e31 3a33 3932 332f  /127.0.0.1:3923/
+00012b30: 3f72 6177 3b7d 6020 200a 2020 2020 6070  ?raw;}`  .    `p
+00012b40: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012b50: 202a 2060 6368 756e 6b28 297b 2063 7572   * `chunk(){ cur
+00012b60: 6c20 2d48 2070 773a 7761 726b 202d 542d  l -H pw:wark -T-
+00012b70: 2068 7474 703a 2f2f 3132 372e 302e 302e   http://127.0.0.
+00012b80: 313a 3339 3233 2f3b 7d60 2020 0a20 2020  1:3923/;}`  .   
+00012b90: 2060 6368 756e 6b20 3c6d 6f76 6965 2e6d   `chunk <movie.m
+00012ba0: 6b76 600a 0a2a 2062 6173 683a 2077 6865  kv`..* bash: whe
+00012bb0: 6e20 6375 726c 2061 6e64 2077 6765 7420  n curl and wget 
+00012bc0: 6973 206e 6f74 2061 7661 696c 6162 6c65  is not available
+00012bd0: 206f 7220 746f 6f20 626f 7269 6e67 0a20   or too boring. 
+00012be0: 202a 2060 2870 7269 6e74 6620 2750 5554   * `(printf 'PUT
+00012bf0: 202f 6a75 6e6b 3f70 773d 7761 726b 2048   /junk?pw=wark H
+00012c00: 5454 502f 312e 315c 725c 6e5c 725c 6e27  TTP/1.1\r\n\r\n'
+00012c10: 3b20 6361 7420 6d6f 7669 652e 6d6b 7629  ; cat movie.mkv)
+00012c20: 207c 206e 6320 3132 372e 302e 302e 3120   | nc 127.0.0.1 
+00012c30: 3339 3233 600a 2020 2a20 6028 7072 696e  3923`.  * `(prin
+00012c40: 7466 2027 5055 5420 2f20 4854 5450 2f31  tf 'PUT / HTTP/1
+00012c50: 2e31 5c72 5c6e 5c72 5c6e 273b 2063 6174  .1\r\n\r\n'; cat
+00012c60: 206d 6f76 6965 2e6d 6b76 2920 3e2f 6465   movie.mkv) >/de
+00012c70: 762f 7463 702f 3132 372e 302e 302e 312f  v/tcp/127.0.0.1/
+00012c80: 3339 3233 600a 0a2a 2070 7974 686f 6e3a  3923`..* python:
+00012c90: 205b 7570 326b 2e70 795d 2868 7474 7073   [up2k.py](https
+00012ca0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00012cb0: 3031 2f63 6f70 7970 6172 7479 2f62 6c6f  01/copyparty/blo
+00012cc0: 622f 686f 7675 6473 7472 6175 6d2f 6269  b/hovudstraum/bi
+00012cd0: 6e2f 7570 326b 2e70 7929 2069 7320 6120  n/up2k.py) is a 
+00012ce0: 636f 6d6d 616e 642d 6c69 6e65 2075 7032  command-line up2
+00012cf0: 6b20 636c 6965 6e74 205b 2877 6562 6d29  k client [(webm)
+00012d00: 5d28 6874 7470 733a 2f2f 6f63 762e 6d65  ](https://ocv.me
+00012d10: 2f73 7475 6666 2f75 3263 6c69 2e77 6562  /stuff/u2cli.web
+00012d20: 6d29 0a20 202a 2066 696c 6520 7570 6c6f  m).  * file uplo
+00012d30: 6164 732c 2066 696c 652d 7365 6172 6368  ads, file-search
+00012d40: 2c20 5b66 6f6c 6465 7220 7379 6e63 5d28  , [folder sync](
+00012d50: 2366 6f6c 6465 722d 7379 6e63 292c 2061  #folder-sync), a
+00012d60: 7574 6f72 6573 756d 6520 6f66 2061 626f  utoresume of abo
+00012d70: 7274 6564 2f62 726f 6b65 6e20 7570 6c6f  rted/broken uplo
+00012d80: 6164 730a 2020 2a20 6361 6e20 6265 2064  ads.  * can be d
+00012d90: 6f77 6e6c 6f61 6465 6420 6672 6f6d 2063  ownloaded from c
+00012da0: 6f70 7970 6172 7479 3a20 636f 6e74 726f  opyparty: contro
+00012db0: 6c70 616e 656c 202d 3e20 636f 6e6e 6563  lpanel -> connec
+00012dc0: 7420 2d3e 205b 7570 326b 2e70 795d 2868  t -> [up2k.py](h
+00012dd0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+00012de0: 3339 3233 2f2e 6370 722f 612f 7570 326b  3923/.cpr/a/up2k
+00012df0: 2e70 7929 0a20 202a 2073 6565 205b 2e2f  .py).  * see [./
+00012e00: 6269 6e2f 5245 4144 4d45 2e6d 6423 7570  bin/README.md#up
+00012e10: 326b 7079 5d28 6269 6e2f 5245 4144 4d45  2kpy](bin/README
+00012e20: 2e6d 6423 7570 326b 7079 290a 0a2a 2046  .md#up2kpy)..* F
+00012e30: 5553 453a 206d 6f75 6e74 2061 2063 6f70  USE: mount a cop
+00012e40: 7970 6172 7479 2073 6572 7665 7220 6173  yparty server as
+00012e50: 2061 206c 6f63 616c 2066 696c 6573 7973   a local filesys
+00012e60: 7465 6d0a 2020 2a20 6372 6f73 732d 706c  tem.  * cross-pl
+00012e70: 6174 666f 726d 2070 7974 686f 6e20 636c  atform python cl
+00012e80: 6965 6e74 2061 7661 696c 6162 6c65 2069  ient available i
+00012e90: 6e20 5b2e 2f62 696e 2f5d 2862 696e 2f29  n [./bin/](bin/)
+00012ea0: 0a20 202a 2063 616e 2062 6520 646f 776e  .  * can be down
+00012eb0: 6c6f 6164 6564 2066 726f 6d20 636f 7079  loaded from copy
+00012ec0: 7061 7274 793a 2063 6f6e 7472 6f6c 7061  party: controlpa
+00012ed0: 6e65 6c20 2d3e 2063 6f6e 6e65 6374 202d  nel -> connect -
+00012ee0: 3e20 5b70 6172 7479 6675 7365 2e70 795d  > [partyfuse.py]
+00012ef0: 2868 7474 703a 2f2f 3132 372e 302e 302e  (http://127.0.0.
+00012f00: 313a 3339 3233 2f2e 6370 722f 612f 7061  1:3923/.cpr/a/pa
+00012f10: 7274 7966 7573 652e 7079 290a 2020 2a20  rtyfuse.py).  * 
+00012f20: 5b72 636c 6f6e 655d 2868 7474 7073 3a2f  [rclone](https:/
+00012f30: 2f72 636c 6f6e 652e 6f72 672f 2920 6173  /rclone.org/) as
+00012f40: 2063 6c69 656e 7420 6361 6e20 6769 7665   client can give
+00012f50: 207e 3578 2070 6572 666f 726d 616e 6365   ~5x performance
+00012f60: 2c20 7365 6520 5b2e 2f64 6f63 732f 7263  , see [./docs/rc
+00012f70: 6c6f 6e65 2e6d 645d 2864 6f63 732f 7263  lone.md](docs/rc
+00012f80: 6c6f 6e65 2e6d 6429 0a0a 2a20 7368 6172  lone.md)..* shar
+00012f90: 6578 2028 7363 7265 656e 7368 6f74 2075  ex (screenshot u
+00012fa0: 7469 6c69 7479 293a 2073 6565 205b 2e2f  tility): see [./
+00012fb0: 636f 6e74 7269 622f 7368 6172 6578 2e73  contrib/sharex.s
+00012fc0: 7863 755d 2863 6f6e 7472 6962 2f23 7368  xcu](contrib/#sh
+00012fd0: 6172 6578 7378 6375 290a 0a63 6f70 7970  arexsxcu)..copyp
+00012fe0: 6172 7479 2072 6574 7572 6e73 2061 2074  arty returns a t
+00012ff0: 7275 6e63 6174 6564 2073 6861 3531 3273  runcated sha512s
+00013000: 756d 206f 6620 796f 7572 2050 5554 2f50  um of your PUT/P
+00013010: 4f53 5420 6173 2062 6173 6536 343b 2079  OST as base64; y
+00013020: 6f75 2063 616e 2067 656e 6572 6174 6520  ou can generate 
+00013030: 7468 6520 7361 6d65 2063 6865 636b 7375  the same checksu
+00013040: 6d20 6c6f 6361 6c6c 7920 746f 2076 6572  m locally to ver
+00013050: 6966 7920 7570 6c61 6f64 733a 0a0a 2020  ify uplaods:..  
+00013060: 2020 6235 3132 2829 7b20 7072 696e 7466    b512(){ printf
+00013070: 2022 2428 2873 6861 3531 3273 756d 7c7c   "$((sha512sum||
+00013080: 7368 6173 756d 202d 6135 3132 297c 7365  shasum -a512)|se
+00013090: 6420 2d45 2027 732f 202e 2a2f 2f3b 732f  d -E 's/ .*//;s/
+000130a0: 282e 2e29 2f5c 5c78 5c31 2f67 2729 227c  (..)/\\x\1/g')"|
+000130b0: 6261 7365 3634 7c74 7220 272b 2f27 2027  base64|tr '+/' '
+000130c0: 2d5f 277c 6865 6164 202d 6334 343b 7d0a  -_'|head -c44;}.
+000130d0: 2020 2020 6235 3132 203c 6d6f 7669 652e      b512 <movie.
+000130e0: 6d6b 760a 0a79 6f75 2063 616e 2070 726f  mkv..you can pro
+000130f0: 7669 6465 2070 6173 7377 6f72 6473 2075  vide passwords u
+00013100: 7369 6e67 2068 6561 6465 7220 6050 573a  sing header `PW:
+00013110: 2068 756e 7465 7232 602c 2063 6f6f 6b69   hunter2`, cooki
+00013120: 6520 6063 7070 7764 3d68 756e 7465 7232  e `cppwd=hunter2
+00013130: 602c 2075 726c 2d70 6172 616d 2060 3f70  `, url-param `?p
+00013140: 773d 6875 6e74 6572 3260 2c20 6f72 2077  w=hunter2`, or w
+00013150: 6974 6820 6261 7369 632d 6175 7468 656e  ith basic-authen
+00013160: 7469 6361 7469 6f6e 2028 6569 7468 6572  tication (either
+00013170: 2061 7320 7468 6520 7573 6572 6e61 6d65   as the username
+00013180: 206f 7220 7061 7373 776f 7264 290a 0a4e   or password)..N
+00013190: 4f54 453a 2063 7572 6c20 7769 6c6c 206e  OTE: curl will n
+000131a0: 6f74 2073 656e 6420 7468 6520 6f72 6967  ot send the orig
+000131b0: 696e 616c 2066 696c 656e 616d 6520 6966  inal filename if
+000131c0: 2079 6f75 2075 7365 2060 2d54 6020 636f   you use `-T` co
+000131d0: 6d62 696e 6564 2077 6974 6820 7572 6c2d  mbined with url-
+000131e0: 7061 7261 6d73 2120 416c 736f 2c20 6d61  params! Also, ma
+000131f0: 6b65 2073 7572 6520 746f 2061 6c77 6179  ke sure to alway
+00013200: 7320 6c65 6176 6520 6120 7472 6169 6c69  s leave a traili
+00013210: 6e67 2073 6c61 7368 2069 6e20 5552 4c73  ng slash in URLs
+00013220: 2075 6e6c 6573 7320 796f 7520 7761 6e74   unless you want
+00013230: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
+00013240: 2066 696c 656e 616d 650a 0a0a 2323 2066   filename...## f
+00013250: 6f6c 6465 7220 7379 6e63 0a0a 7379 6e63  older sync..sync
+00013260: 2066 6f6c 6465 7273 2074 6f2f 6672 6f6d   folders to/from
+00013270: 2063 6f70 7970 6172 7479 0a0a 7468 6520   copyparty..the 
+00013280: 636f 6d6d 616e 646c 696e 6520 7570 6c6f  commandline uplo
+00013290: 6164 6572 205b 7570 326b 2e70 795d 2868  ader [up2k.py](h
+000132a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000132b0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+000132c0: 2f74 7265 652f 686f 7675 6473 7472 6175  /tree/hovudstrau
+000132d0: 6d2f 6269 6e23 7570 326b 7079 2920 7769  m/bin#up2kpy) wi
+000132e0: 7468 2060 2d2d 6472 6020 6973 2074 6865  th `--dr` is the
+000132f0: 2062 6573 7420 7761 7920 746f 2073 796e   best way to syn
+00013300: 6320 6120 666f 6c64 6572 2074 6f20 636f  c a folder to co
+00013310: 7079 7061 7274 793b 2076 6572 6966 6965  pyparty; verifie
+00013320: 7320 6368 6563 6b73 756d 7320 616e 6420  s checksums and 
+00013330: 646f 6573 2066 696c 6573 2069 6e20 7061  does files in pa
+00013340: 7261 6c6c 656c 2c20 616e 6420 6465 6c65  rallel, and dele
+00013350: 7465 7320 756e 6578 7065 6374 6564 2066  tes unexpected f
+00013360: 696c 6573 206f 6e20 7468 6520 7365 7276  iles on the serv
+00013370: 6572 2061 6674 6572 2075 706c 6f61 6420  er after upload 
+00013380: 6861 7320 6669 6e69 7368 6564 2077 6869  has finished whi
+00013390: 6368 206d 616b 6573 2066 696c 652d 7265  ch makes file-re
+000133a0: 6e61 6d65 7320 7265 616c 6c79 2063 6865  names really che
+000133b0: 6170 2028 6974 276c 6c20 7265 6e61 6d65  ap (it'll rename
+000133c0: 2073 6572 7665 7273 6964 6520 616e 6420   serverside and 
+000133d0: 736b 6970 2075 706c 6f61 6469 6e67 290a  skip uploading).
+000133e0: 0a61 6c74 6572 6e61 7469 7665 6c79 2074  .alternatively t
+000133f0: 6865 7265 2069 7320 5b72 636c 6f6e 655d  here is [rclone]
+00013400: 282e 2f64 6f63 732f 7263 6c6f 6e65 2e6d  (./docs/rclone.m
+00013410: 6429 2077 6869 6368 2061 6c6c 6f77 7320  d) which allows 
+00013420: 666f 7220 6269 6469 7265 6374 696f 6e61  for bidirectiona
+00013430: 6c20 7379 6e63 2061 6e64 2069 7320 2a77  l sync and is *w
+00013440: 6179 2a20 6d6f 7265 2066 6c65 7869 626c  ay* more flexibl
+00013450: 6520 2873 7472 6561 6d20 6669 6c65 7320  e (stream files 
+00013460: 7374 7261 6967 6874 2066 726f 6d20 7366  straight from sf
+00013470: 7470 2f73 332f 6763 7320 746f 2063 6f70  tp/s3/gcs to cop
+00013480: 7970 6172 7479 2c20 2e2e 2e29 2c20 616c  yparty, ...), al
+00013490: 7468 6f75 6768 2074 6865 7265 2069 7320  though there is 
+000134a0: 6e6f 2069 6e74 6567 7269 7479 2063 6865  no integrity che
+000134b0: 636b 2061 6e64 2069 7420 776f 6e27 7420  ck and it won't 
+000134c0: 776f 726b 2077 6974 6820 6669 6c65 7320  work with files 
+000134d0: 6f76 6572 2031 3030 204d 6942 2069 6620  over 100 MiB if 
+000134e0: 636f 7079 7061 7274 7920 6973 2062 6568  copyparty is beh
+000134f0: 696e 6420 636c 6f75 6466 6c61 7265 0a0a  ind cloudflare..
+00013500: 2a20 7374 6172 7469 6e67 2066 726f 6d20  * starting from 
+00013510: 7263 6c6f 6e65 2076 312e 3633 2028 6375  rclone v1.63 (cu
+00013520: 7272 656e 746c 7920 5b69 6e20 6265 7461  rrently [in beta
+00013530: 5d28 6874 7470 733a 2f2f 6265 7461 2e72  ](https://beta.r
+00013540: 636c 6f6e 652e 6f72 672f 3f66 696c 7465  clone.org/?filte
+00013550: 723d 6c61 7465 7374 2929 2c20 7263 6c6f  r=latest)), rclo
+00013560: 6e65 2077 696c 6c20 616c 736f 2062 6520  ne will also be 
+00013570: 6661 7374 6572 2074 6861 6e20 7570 326b  faster than up2k
+00013580: 2e70 790a 0a0a 2323 206d 6f75 6e74 2061  .py...## mount a
+00013590: 7320 6472 6976 650a 0a61 2072 656d 6f74  s drive..a remot
+000135a0: 6520 636f 7079 7061 7274 7920 7365 7276  e copyparty serv
+000135b0: 6572 2061 7320 6120 6c6f 6361 6c20 6669  er as a local fi
+000135c0: 6c65 7379 7374 656d 3b20 2067 6f20 746f  lesystem;  go to
+000135d0: 2074 6865 2063 6f6e 7472 6f6c 2d70 616e   the control-pan
+000135e0: 656c 2061 6e64 2063 6c69 636b 2060 636f  el and click `co
+000135f0: 6e6e 6563 7460 2074 6f20 7365 6520 6120  nnect` to see a 
+00013600: 6c69 7374 206f 6620 636f 6d6d 616e 6473  list of commands
+00013610: 2074 6f20 646f 2074 6861 740a 0a61 6c74   to do that..alt
+00013620: 6572 6e61 7469 7665 6c79 2c20 736f 6d65  ernatively, some
+00013630: 2061 6c74 6572 6e61 7469 7665 7320 726f   alternatives ro
+00013640: 7567 686c 7920 736f 7274 6564 2062 7920  ughly sorted by 
+00013650: 7370 6565 6420 2875 6e72 6570 726f 6475  speed (unreprodu
+00013660: 6369 626c 6520 6265 6e63 686d 6172 6b29  cible benchmark)
+00013670: 2c20 6265 7374 2066 6972 7374 3a0a 0a2a  , best first:..*
+00013680: 205b 7263 6c6f 6e65 2d77 6562 6461 765d   [rclone-webdav]
+00013690: 282e 2f64 6f63 732f 7263 6c6f 6e65 2e6d  (./docs/rclone.m
+000136a0: 6429 2028 3235 7329 2c20 7265 6164 2f57  d) (25s), read/W
+000136b0: 5249 5445 2028 5b76 312e 3633 2d62 6574  RITE ([v1.63-bet
+000136c0: 615d 2868 7474 7073 3a2f 2f62 6574 612e  a](https://beta.
+000136d0: 7263 6c6f 6e65 2e6f 7267 2f3f 6669 6c74  rclone.org/?filt
+000136e0: 6572 3d6c 6174 6573 7429 290a 2a20 5b72  er=latest)).* [r
+000136f0: 636c 6f6e 652d 6874 7470 5d28 2e2f 646f  clone-http](./do
+00013700: 6373 2f72 636c 6f6e 652e 6d64 2920 2832  cs/rclone.md) (2
+00013710: 3673 292c 2072 6561 642d 6f6e 6c79 0a2a  6s), read-only.*
+00013720: 205b 7061 7274 7966 7573 652e 7079 5d28   [partyfuse.py](
+00013730: 2e2f 6269 6e2f 2370 6172 7479 6675 7365  ./bin/#partyfuse
+00013740: 7079 2920 2833 3573 292c 2072 6561 642d  py) (35s), read-
+00013750: 6f6e 6c79 0a2a 205b 7263 6c6f 6e65 2d66  only.* [rclone-f
+00013760: 7470 5d28 2e2f 646f 6373 2f72 636c 6f6e  tp](./docs/rclon
+00013770: 652e 6d64 2920 2834 3773 292c 2072 6561  e.md) (47s), rea
+00013780: 642f 5752 4954 450a 2a20 6461 7666 7332  d/WRITE.* davfs2
+00013790: 2028 3130 3373 292c 2072 6561 642f 5752   (103s), read/WR
+000137a0: 4954 452c 202a 7665 7279 2066 6173 742a  ITE, *very fast*
+000137b0: 206f 6e20 736d 616c 6c20 6669 6c65 730a   on small files.
+000137c0: 2a20 5b77 696e 3130 2d77 6562 6461 765d  * [win10-webdav]
+000137d0: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
+000137e0: 2028 3133 3873 292c 2072 6561 642f 5752   (138s), read/WR
+000137f0: 4954 450a 2a20 5b77 696e 3130 2d73 6d62  ITE.* [win10-smb
+00013800: 325d 2823 736d 622d 7365 7276 6572 2920  2](#smb-server) 
+00013810: 2833 3837 7329 2c20 7265 6164 2f57 5249  (387s), read/WRI
+00013820: 5445 0a0a 6d6f 7374 2063 6c69 656e 7473  TE..most clients
+00013830: 2077 696c 6c20 6661 696c 2074 6f20 6d6f   will fail to mo
+00013840: 756e 7420 7468 6520 726f 6f74 206f 6620  unt the root of 
+00013850: 6120 636f 7079 7061 7274 7920 7365 7276  a copyparty serv
+00013860: 6572 2075 6e6c 6573 7320 7468 6572 6520  er unless there 
+00013870: 6973 2061 2072 6f6f 7420 766f 6c75 6d65  is a root volume
+00013880: 2028 736f 2079 6f75 2067 6574 2074 6865   (so you get the
+00013890: 2061 646d 696e 2d70 616e 656c 2069 6e73   admin-panel ins
+000138a0: 7465 6164 206f 6620 6120 6272 6f77 7365  tead of a browse
+000138b0: 7220 7768 656e 2061 6363 6573 7369 6e67  r when accessing
+000138c0: 2069 7429 202d 2d20 696e 2074 6861 7420   it) -- in that 
+000138d0: 6361 7365 2c20 6d6f 756e 7420 6120 7370  case, mount a sp
+000138e0: 6563 6966 6963 2076 6f6c 756d 6520 696e  ecific volume in
+000138f0: 7374 6561 640a 0a0a 2320 616e 6472 6f69  stead...# androi
+00013900: 6420 6170 700a 0a75 706c 6f61 6420 746f  d app..upload to
+00013910: 2063 6f70 7970 6172 7479 2077 6974 6820   copyparty with 
+00013920: 6f6e 6520 7461 700a 0a3c 6120 6872 6566  one tap..<a href
+00013930: 3d22 6874 7470 733a 2f2f 662d 6472 6f69  ="https://f-droi
+00013940: 642e 6f72 672f 7061 636b 6167 6573 2f6d  d.org/packages/m
+00013950: 652e 6f63 762e 7061 7274 7975 702f 223e  e.ocv.partyup/">
+00013960: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
+00013970: 2f2f 6f63 762e 6d65 2f66 6472 6f69 642e  //ocv.me/fdroid.
+00013980: 706e 6722 2061 6c74 3d22 4765 7420 6974  png" alt="Get it
+00013990: 206f 6e20 462d 4472 6f69 6422 2068 6569   on F-Droid" hei
+000139a0: 6768 743d 2235 3022 202f 3e20 2727 203c  ght="50" /> '' <
+000139b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+000139c0: 2f69 6d67 2e73 6869 656c 6473 2e69 6f2f  /img.shields.io/
+000139d0: 662d 6472 6f69 642f 762f 6d65 2e6f 6376  f-droid/v/me.ocv
+000139e0: 2e70 6172 7479 7570 2e73 7667 2220 616c  .partyup.svg" al
+000139f0: 743d 2266 2d64 726f 6964 2076 6572 7369  t="f-droid versi
+00013a00: 6f6e 2069 6e66 6f22 202f 3e3c 2f61 3e20  on info" /></a> 
+00013a10: 2727 203c 6120 6872 6566 3d22 6874 7470  '' <a href="http
+00013a20: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00013a30: 3030 312f 7061 7274 792d 7570 223e 3c69  001/party-up"><i
+00013a40: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+00013a50: 696d 672e 7368 6965 6c64 732e 696f 2f67  img.shields.io/g
+00013a60: 6974 6875 622f 7265 6c65 6173 652f 3930  ithub/release/90
+00013a70: 3031 2f70 6172 7479 2d75 702e 7376 673f  01/party-up.svg?
+00013a80: 6c6f 676f 3d67 6974 6875 6222 2061 6c74  logo=github" alt
+00013a90: 3d22 6769 7468 7562 2076 6572 7369 6f6e  ="github version
+00013aa0: 2069 6e66 6f22 202f 3e3c 2f61 3e0a 0a74   info" /></a>..t
+00013ab0: 6865 2061 7070 2069 7320 2a2a 4e4f 542a  he app is **NOT*
+00013ac0: 2a20 7468 6520 6675 6c6c 2063 6f70 7970  * the full copyp
+00013ad0: 6172 7479 2073 6572 7665 7221 206a 7573  arty server! jus
+00013ae0: 7420 6120 6261 7369 6320 7570 6c6f 6164  t a basic upload
+00013af0: 2063 6c69 656e 742c 206e 6f74 6869 6e67   client, nothing
+00013b00: 2066 616e 6379 2079 6574 0a0a 6966 2079   fancy yet..if y
+00013b10: 6f75 2077 616e 7420 746f 2072 756e 2074  ou want to run t
+00013b20: 6865 2063 6f70 7970 6172 7479 2073 6572  he copyparty ser
+00013b30: 7665 7220 6f6e 2079 6f75 7220 616e 6472  ver on your andr
+00013b40: 6f69 6420 6465 7669 6365 2c20 7365 6520  oid device, see 
+00013b50: 5b69 6e73 7461 6c6c 206f 6e20 616e 6472  [install on andr
+00013b60: 6f69 645d 2823 696e 7374 616c 6c2d 6f6e  oid](#install-on
+00013b70: 2d61 6e64 726f 6964 290a 0a0a 2320 694f  -android)...# iO
+00013b80: 5320 7368 6f72 7463 7574 730a 0a74 6865  S shortcuts..the
+00013b90: 7265 2069 7320 6e6f 2069 5068 6f6e 6520  re is no iPhone 
+00013ba0: 6170 702c 2062 7574 2020 7468 6520 666f  app, but  the fo
+00013bb0: 6c6c 6f77 696e 6720 7368 6f72 7463 7574  llowing shortcut
+00013bc0: 7320 6172 6520 616c 6d6f 7374 2061 7320  s are almost as 
+00013bd0: 676f 6f64 3a0a 0a2a 205b 7570 6c6f 6164  good:..* [upload
+00013be0: 2074 6f20 636f 7079 7061 7274 795d 2868   to copyparty](h
+00013bf0: 7474 7073 3a2f 2f77 7777 2e69 636c 6f75  ttps://www.iclou
+00013c00: 642e 636f 6d2f 7368 6f72 7463 7574 732f  d.com/shortcuts/
+00013c10: 3431 6539 3864 6439 3835 6362 3464 3362  41e98dd985cb4d3b
+00013c20: 6234 3333 3232 3262 6331 6539 6537 3730  b433222bc1e9e770
+00013c30: 2920 285b 6f66 666c 696e 655d 2868 7474  ) ([offline](htt
+00013c40: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00013c50: 3930 3031 2f63 6f70 7970 6172 7479 2f72  9001/copyparty/r
+00013c60: 6177 2f68 6f76 7564 7374 7261 756d 2f63  aw/hovudstraum/c
+00013c70: 6f6e 7472 6962 2f69 6f73 2f75 706c 6f61  ontrib/ios/uploa
+00013c80: 642d 746f 2d63 6f70 7970 6172 7479 2e73  d-to-copyparty.s
+00013c90: 686f 7274 6375 7429 2920 285b 706e 675d  hortcut)) ([png]
+00013ca0: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
+00013cb0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00013cc0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+00013cd0: 322f 3232 3631 3138 3035 332d 3738 3632  2/226118053-7862
+00013ce0: 3335 3534 2d62 3065 642d 3438 3265 2d39  3554-b0ed-482e-9
+00013cf0: 3865 342d 3664 3537 6164 6135 3865 6134  8e4-6d57ada58ea4
+00013d00: 2e70 6e67 2929 2062 6173 6564 206f 6e20  .png)) based on 
+00013d10: 7468 6520 5b6f 7269 6769 6e61 6c5d 2868  the [original](h
+00013d20: 7474 7073 3a2f 2f77 7777 2e69 636c 6f75  ttps://www.iclou
+00013d30: 642e 636f 6d2f 7368 6f72 7463 7574 732f  d.com/shortcuts/
+00013d40: 6162 3431 3564 3562 3464 6533 3436 3762  ab415d5b4de3467b
+00013d50: 3963 6536 6631 3531 6234 3339 6135 6437  9ce6f151b439a5d7
+00013d60: 2920 6279 205b 4461 6564 7265 6e5d 2868  ) by [Daedren](h
+00013d70: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00013d80: 6d2f 4461 6564 7265 6e29 2028 7468 7821  m/Daedren) (thx!
+00013d90: 290a 2020 2a20 6361 6e20 7374 7269 7020  ).  * can strip 
+00013da0: 6578 6966 2c20 7570 6c6f 6164 2066 696c  exif, upload fil
+00013db0: 6573 2c20 7069 6373 2c20 7669 6473 2c20  es, pics, vids, 
+00013dc0: 6c69 6e6b 732c 2063 6c69 7062 6f61 7264  links, clipboard
+00013dd0: 0a20 202a 2063 616e 2064 6f77 6e6c 6f61  .  * can downloa
+00013de0: 6420 6c69 6e6b 7320 616e 6420 7265 686f  d links and reho
+00013df0: 7374 2074 6865 2074 6172 6765 7420 6669  st the target fi
+00013e00: 6c65 206f 6e20 636f 7079 7061 7274 7920  le on copyparty 
+00013e10: 2873 6565 2066 6972 7374 2063 6f6d 6d65  (see first comme
+00013e20: 6e74 2069 6e73 6964 6520 7468 6520 7368  nt inside the sh
+00013e30: 6f72 7463 7574 290a 2020 2a20 7069 6373  ortcut).  * pics
+00013e40: 2062 6563 6f6d 6520 6c6f 7772 6573 2069   become lowres i
+00013e50: 6620 796f 7520 7368 6172 6520 6672 6f6d  f you share from
+00013e60: 2067 616c 6c65 7279 2074 6f20 7368 6f72   gallery to shor
+00013e70: 7463 7574 2c20 736f 2062 6574 7465 7220  tcut, so better 
+00013e80: 746f 206c 6175 6e63 6820 7468 6520 7368  to launch the sh
+00013e90: 6f72 7463 7574 2061 6e64 2070 6963 6b20  ortcut and pick 
+00013ea0: 7374 7566 6620 6672 6f6d 2074 6865 7265  stuff from there
+00013eb0: 0a0a 0a23 2070 6572 666f 726d 616e 6365  ...# performance
+00013ec0: 0a0a 6465 6661 756c 7473 2061 7265 2075  ..defaults are u
+00013ed0: 7375 616c 6c79 2066 696e 6520 2d20 6578  sually fine - ex
+00013ee0: 7065 6374 2060 3820 4769 422f 7360 2064  pect `8 GiB/s` d
+00013ef0: 6f77 6e6c 6f61 642c 2060 3120 4769 422f  ownload, `1 GiB/
+00013f00: 7360 2075 706c 6f61 640a 0a62 656c 6f77  s` upload..below
+00013f10: 2061 7265 2073 6f6d 6520 7477 6561 6b73   are some tweaks
+00013f20: 2072 6f75 6768 6c79 206f 7264 6572 6564   roughly ordered
+00013f30: 2062 7920 7573 6566 756c 6e65 7373 3a0a   by usefulness:.
+00013f40: 0a2a 2060 2d71 6020 6469 7361 626c 6573  .* `-q` disables
+00013f50: 206c 6f67 6769 6e67 2061 6e64 2063 616e   logging and can
+00013f60: 2068 656c 7020 6120 6275 6e63 682c 2065   help a bunch, e
+00013f70: 7665 6e20 7768 656e 2063 6f6d 6269 6e65  ven when combine
+00013f80: 6420 7769 7468 2060 2d6c 6f60 2074 6f20  d with `-lo` to 
+00013f90: 7265 6469 7265 6374 206c 6f67 7320 746f  redirect logs to
+00013fa0: 2066 696c 650a 2a20 602d 2d68 6973 7460   file.* `--hist`
+00013fb0: 2070 6f69 6e74 696e 6720 746f 2061 2066   pointing to a f
+00013fc0: 6173 7420 6c6f 6361 7469 6f6e 2028 7373  ast location (ss
+00013fd0: 6429 2077 696c 6c20 6d61 6b65 2064 6972  d) will make dir
+00013fe0: 6563 746f 7279 206c 6973 7469 6e67 7320  ectory listings 
+00013ff0: 616e 6420 7365 6172 6368 6573 2066 6173  and searches fas
+00014000: 7465 7220 7768 656e 2060 2d65 3264 6020  ter when `-e2d` 
+00014010: 6f72 2060 2d65 3274 6020 6973 2073 6574  or `-e2t` is set
+00014020: 0a2a 2060 2d2d 6e6f 2d68 6173 6820 2e60  .* `--no-hash .`
+00014030: 2077 6865 6e20 696e 6465 7869 6e67 2061   when indexing a
+00014040: 206e 6574 776f 726b 2d64 6973 6b20 6966   network-disk if
+00014050: 2079 6f75 2064 6f6e 2774 2063 6172 6520   you don't care 
+00014060: 6162 6f75 7420 7468 6520 6163 7475 616c  about the actual
+00014070: 2066 696c 6568 6173 6865 7320 616e 6420   filehashes and 
+00014080: 6f6e 6c79 2077 616e 7420 7468 6520 6e61  only want the na
+00014090: 6d65 732f 7461 6773 2073 6561 7263 6861  mes/tags searcha
+000140a0: 626c 650a 2a20 602d 2d6e 6f2d 6874 7020  ble.* `--no-htp 
+000140b0: 2d2d 6861 7368 2d6d 743d 3020 2d2d 6d74  --hash-mt=0 --mt
+000140c0: 6167 2d6d 743d 3120 2d2d 7468 2d6d 743d  ag-mt=1 --th-mt=
+000140d0: 3160 206d 696e 696d 697a 6573 2074 6865  1` minimizes the
+000140e0: 206e 756d 6265 7220 6f66 2074 6872 6561   number of threa
+000140f0: 6473 3b20 6361 6e20 6865 6c70 2069 6e20  ds; can help in 
+00014100: 736f 6d65 2065 6363 656e 7472 6963 2065  some eccentric e
+00014110: 6e76 6972 6f6e 6d65 6e74 7320 286c 696b  nvironments (lik
+00014120: 6520 7468 6520 7673 636f 6465 2064 6562  e the vscode deb
+00014130: 7567 6765 7229 0a2a 2060 2d6a 3060 2065  ugger).* `-j0` e
+00014140: 6e61 626c 6573 206d 756c 7469 7072 6f63  nables multiproc
+00014150: 6573 7369 6e67 2028 6163 7475 616c 206d  essing (actual m
+00014160: 756c 7469 7468 7265 6164 696e 6729 2c20  ultithreading), 
+00014170: 6361 6e20 7265 6475 6365 206c 6174 656e  can reduce laten
+00014180: 6379 2074 6f20 6032 302b 3830 2f6e 756d  cy to `20+80/num
+00014190: 436f 7265 7360 2070 6572 6365 6e74 2061  Cores` percent a
+000141a0: 6e64 2067 656e 6572 616c 6c79 2069 6d70  nd generally imp
+000141b0: 726f 7665 2070 6572 666f 726d 616e 6365  rove performance
+000141c0: 2069 6e20 6370 752d 696e 7465 6e73 6976   in cpu-intensiv
+000141d0: 6520 776f 726b 6c6f 6164 732c 2066 6f72  e workloads, for
+000141e0: 2065 7861 6d70 6c65 3a0a 2020 2a20 6c6f   example:.  * lo
+000141f0: 7473 206f 6620 636f 6e6e 6563 7469 6f6e  ts of connection
+00014200: 7320 286d 616e 7920 7573 6572 7320 6f72  s (many users or
+00014210: 2068 6561 7679 2063 6c69 656e 7473 290a   heavy clients).
+00014220: 2020 2a20 7369 6d75 6c74 616e 656f 7573    * simultaneous
+00014230: 2064 6f77 6e6c 6f61 6473 2061 6e64 2075   downloads and u
+00014240: 706c 6f61 6473 2073 6174 7572 6174 696e  ploads saturatin
+00014250: 6720 6120 3230 6762 7073 2063 6f6e 6e65  g a 20gbps conne
+00014260: 6374 696f 6e0a 2020 0a20 202e 2e2e 686f  ction.  .  ...ho
+00014270: 7765 7665 7220 6974 2061 6464 7320 616e  wever it adds an
+00014280: 206f 7665 7268 6561 6420 746f 2069 6e74   overhead to int
+00014290: 6572 6e61 6c20 636f 6d6d 756e 6963 6174  ernal communicat
+000142a0: 696f 6e20 736f 2069 7420 6d69 6768 7420  ion so it might 
+000142b0: 6265 2061 206e 6574 206c 6f73 732c 2073  be a net loss, s
+000142c0: 6565 2069 6620 6974 2077 6f72 6b73 2034  ee if it works 4
+000142d0: 2075 0a2a 2075 7369 6e67 205b 7079 7079   u.* using [pypy
+000142e0: 5d28 6874 7470 733a 2f2f 7777 772e 7079  ](https://www.py
+000142f0: 7079 2e6f 7267 2f29 2069 6e73 7465 6164  py.org/) instead
+00014300: 206f 6620 5b63 7079 7468 6f6e 5d28 6874   of [cpython](ht
+00014310: 7470 733a 2f2f 7777 772e 7079 7468 6f6e  tps://www.python
+00014320: 2e6f 7267 2f29 202a 6361 6e2a 2062 6520  .org/) *can* be 
+00014330: 3730 2520 6661 7374 6572 2066 6f72 2073  70% faster for s
+00014340: 6f6d 6520 776f 726b 6c6f 6164 732c 2062  ome workloads, b
+00014350: 7574 2073 6c6f 7765 7220 666f 7220 6d61  ut slower for ma
+00014360: 6e79 206f 7468 6572 730a 2020 2a20 616e  ny others.  * an
+00014370: 6420 7079 7079 2063 616e 2073 6f6d 6574  d pypy can somet
+00014380: 696d 6573 2063 7261 7368 206f 6e20 7374  imes crash on st
+00014390: 6172 7475 7020 7769 7468 2060 2d6a 3060  artup with `-j0`
+000143a0: 2028 544f 444f 206d 616b 6520 6973 7375   (TODO make issu
+000143b0: 6529 0a0a 0a23 2320 636c 6965 6e74 2d73  e)...## client-s
+000143c0: 6964 650a 0a77 6865 6e20 7570 6c6f 6164  ide..when upload
+000143d0: 696e 6720 6669 6c65 732c 0a0a 2a20 6368  ing files,..* ch
+000143e0: 726f 6d65 2069 7320 7265 636f 6d6d 656e  rome is recommen
+000143f0: 6465 642c 2061 7420 6c65 6173 7420 636f  ded, at least co
+00014400: 6d70 6172 6564 2074 6f20 6669 7265 666f  mpared to firefo
+00014410: 783a 0a20 202a 2075 7020 746f 2039 3025  x:.  * up to 90%
+00014420: 2066 6173 7465 7220 7768 656e 2068 6173   faster when has
+00014430: 6869 6e67 2c20 6573 7065 6369 616c 6c79  hing, especially
+00014440: 206f 6e20 5353 4473 0a20 202a 2075 7020   on SSDs.  * up 
+00014450: 746f 2034 3025 2066 6173 7465 7220 7768  to 40% faster wh
+00014460: 656e 2075 706c 6f61 6469 6e67 206f 7665  en uploading ove
+00014470: 7220 6578 7472 656d 656c 7920 6661 7374  r extremely fast
+00014480: 2069 6e74 6572 6e65 7473 0a20 202a 2062   internets.  * b
+00014490: 7574 205b 7570 326b 2e70 795d 2868 7474  ut [up2k.py](htt
+000144a0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+000144b0: 3930 3031 2f63 6f70 7970 6172 7479 2f62  9001/copyparty/b
+000144c0: 6c6f 622f 686f 7675 6473 7472 6175 6d2f  lob/hovudstraum/
+000144d0: 6269 6e2f 7570 326b 2e70 7929 2063 616e  bin/up2k.py) can
+000144e0: 2062 6520 3430 2520 6661 7374 6572 2074   be 40% faster t
+000144f0: 6861 6e20 6368 726f 6d65 2061 6761 696e  han chrome again
+00014500: 0a0a 2a20 6966 2079 6f75 2772 6520 6370  ..* if you're cp
+00014510: 752d 626f 7474 6c65 6e65 636b 6564 2c20  u-bottlenecked, 
+00014520: 6f72 2074 6865 2062 726f 7773 6572 2069  or the browser i
+00014530: 7320 6d61 7869 6e67 2061 2063 7075 2063  s maxing a cpu c
+00014540: 6f72 653a 0a20 202a 2075 7020 746f 2033  ore:.  * up to 3
+00014550: 3025 2066 6173 7465 7220 7570 6c6f 6164  0% faster upload
+00014560: 7320 6966 2079 6f75 2068 6964 6520 7468  s if you hide th
+00014570: 6520 7570 6c6f 6164 2073 7461 7475 7320  e upload status 
+00014580: 6c69 7374 2062 7920 7377 6974 6368 696e  list by switchin
+00014590: 6720 6177 6179 2066 726f 6d20 7468 6520  g away from the 
+000145a0: 605b f09f 9a80 5d60 2075 7032 6b20 7569  `[....]` up2k ui
+000145b0: 2d74 6162 2028 6f72 2063 6c6f 7369 6e67  -tab (or closing
+000145c0: 2069 7429 0a20 2020 202a 206f 7074 696f   it).    * optio
+000145d0: 6e61 6c6c 7920 796f 7520 6361 6e20 7377  nally you can sw
+000145e0: 6974 6368 2074 6f20 7468 6520 6c69 6768  itch to the ligh
+000145f0: 7477 6569 6768 7420 706f 7461 746f 2075  tweight potato u
+00014600: 6920 6279 2063 6c69 636b 696e 6720 7468  i by clicking th
+00014610: 6520 605b f09f a594 5d60 0a20 2020 202a  e `[....]`.    *
+00014620: 2073 7769 7463 6869 6e67 2074 6f20 616e   switching to an
+00014630: 6f74 6865 7220 6272 6f77 7365 722d 7461  other browser-ta
+00014640: 6220 616c 736f 2077 6f72 6b73 2c20 7468  b also works, th
+00014650: 6520 6661 7669 636f 6e20 7769 6c6c 2075  e favicon will u
+00014660: 7064 6174 6520 6576 6572 7920 3130 2073  pdate every 10 s
+00014670: 6563 6f6e 6473 2069 6e20 7468 6174 2063  econds in that c
+00014680: 6173 650a 2020 2a20 756e 6c69 6b65 6c79  ase.  * unlikely
+00014690: 2074 6f20 6265 2061 2070 726f 626c 656d   to be a problem
+000146a0: 2c20 6275 7420 6361 6e20 6861 7070 656e  , but can happen
+000146b0: 2077 6865 6e20 7570 6c6f 6469 6e67 206d   when uploding m
+000146c0: 616e 7920 736d 616c 6c20 6669 6c65 732c  any small files,
+000146d0: 206f 7220 796f 7572 2069 6e74 6572 6e65   or your interne
+000146e0: 7420 6973 2074 6f6f 2066 6173 742c 206f  t is too fast, o
+000146f0: 7220 5043 2074 6f6f 2073 6c6f 770a 0a0a  r PC too slow...
+00014700: 2320 7365 6375 7269 7479 0a0a 736f 6d65  # security..some
+00014710: 206e 6f74 6573 206f 6e20 6861 7264 656e   notes on harden
+00014720: 696e 670a 0a2a 2073 6574 2060 2d2d 7270  ing..* set `--rp
+00014730: 726f 7879 2030 6020 6966 2079 6f75 7220  roxy 0` if your 
+00014740: 636f 7079 7061 7274 7920 6973 2064 6972  copyparty is dir
+00014750: 6563 746c 7920 6661 6369 6e67 2074 6865  ectly facing the
+00014760: 2069 6e74 6572 6e65 7420 286e 6f74 2074   internet (not t
+00014770: 6872 6f75 6768 2061 2072 6576 6572 7365  hrough a reverse
+00014780: 2d70 726f 7879 290a 2020 2a20 636f 7273  -proxy).  * cors
+00014790: 2064 6f65 736e 2774 2077 6f72 6b20 7269   doesn't work ri
+000147a0: 6768 7420 6f74 6865 7277 6973 650a 0a73  ght otherwise..s
+000147b0: 6166 6574 7920 7072 6f66 696c 6573 3a0a  afety profiles:.
+000147c0: 0a2a 206f 7074 696f 6e20 602d 7360 2069  .* option `-s` i
+000147d0: 7320 6120 7368 6f72 7463 7574 2074 6f20  s a shortcut to 
+000147e0: 7365 7420 7468 6520 666f 6c6c 6f77 696e  set the followin
+000147f0: 6720 6f70 7469 6f6e 733a 0a20 202a 2060  g options:.  * `
+00014800: 2d2d 6e6f 2d74 6875 6d62 6020 6469 7361  --no-thumb` disa
+00014810: 626c 6573 2074 6875 6d62 6e61 696c 7320  bles thumbnails 
+00014820: 616e 6420 6175 6469 6f20 7472 616e 7363  and audio transc
+00014830: 6f64 696e 6720 746f 2073 746f 7020 636f  oding to stop co
+00014840: 7079 7061 7274 7920 6672 6f6d 2072 756e  pyparty from run
+00014850: 6e69 6e67 2060 4646 6d70 6567 602f 6050  ning `FFmpeg`/`P
+00014860: 696c 6c6f 7760 2f60 5649 5053 6020 6f6e  illow`/`VIPS` on
+00014870: 2075 706c 6f61 6465 6420 6669 6c65 732c   uploaded files,
+00014880: 2077 6869 6368 2069 7320 6120 5b67 6f6f   which is a [goo
+00014890: 6420 6964 6561 5d28 6874 7470 733a 2f2f  d idea](https://
+000148a0: 7777 772e 6376 6564 6574 6169 6c73 2e63  www.cvedetails.c
+000148b0: 6f6d 2f76 756c 6e65 7261 6269 6c69 7479  om/vulnerability
+000148c0: 2d6c 6973 742e 7068 703f 7665 6e64 6f72  -list.php?vendor
+000148d0: 5f69 643d 3336 3131 2920 6966 2061 6e6f  _id=3611) if ano
+000148e0: 6e79 6d6f 7573 2075 706c 6f61 6420 6973  nymous upload is
+000148f0: 2065 6e61 626c 6564 0a20 202a 2060 2d2d   enabled.  * `--
+00014900: 6e6f 2d6d 7461 672d 6666 6020 7573 6573  no-mtag-ff` uses
+00014910: 2060 6d75 7461 6765 6e60 2074 6f20 6772   `mutagen` to gr
+00014920: 6162 206d 7573 6963 2074 6167 7320 696e  ab music tags in
+00014930: 7374 6561 6420 6f66 2060 4646 6d70 6567  stead of `FFmpeg
+00014940: 602c 2077 6869 6368 2069 7320 7361 6665  `, which is safe
+00014950: 7220 616e 6420 6661 7374 6572 2062 7574  r and faster but
+00014960: 206c 6573 7320 6163 6375 7261 7465 0a20   less accurate. 
+00014970: 202a 2060 2d2d 646f 7470 6172 7460 2068   * `--dotpart` h
+00014980: 6964 6573 2075 706c 6f61 6473 2066 726f  ides uploads fro
+00014990: 6d20 6469 7265 6374 6f72 7920 6c69 7374  m directory list
+000149a0: 696e 6773 2077 6869 6c65 2074 6865 7927  ings while they'
+000149b0: 7265 2073 7469 6c6c 2069 6e63 6f6d 696e  re still incomin
+000149c0: 670a 2020 2a20 602d 2d6e 6f2d 726f 626f  g.  * `--no-robo
+000149d0: 7473 6020 616e 6420 602d 2d66 6f72 6365  ts` and `--force
+000149e0: 2d6a 7360 206d 616b 6573 206c 6966 6520  -js` makes life 
+000149f0: 6861 7264 6572 2066 6f72 2063 7261 776c  harder for crawl
+00014a00: 6572 732c 2073 6565 205b 6869 6469 6e67  ers, see [hiding
+00014a10: 2066 726f 6d20 676f 6f67 6c65 5d28 2368   from google](#h
+00014a20: 6964 696e 672d 6672 6f6d 2d67 6f6f 676c  iding-from-googl
+00014a30: 6529 0a0a 2a20 6f70 7469 6f6e 2060 2d73  e)..* option `-s
+00014a40: 7360 2069 7320 6120 7368 6f72 7463 7574  s` is a shortcut
+00014a50: 2066 6f72 2074 6865 2061 626f 7665 2070   for the above p
+00014a60: 6c75 733a 0a20 202a 2060 2d2d 756e 706f  lus:.  * `--unpo
+00014a70: 7374 2030 602c 2060 2d2d 6e6f 2d64 656c  st 0`, `--no-del
+00014a80: 602c 2060 2d2d 6e6f 2d6d 7660 2064 6973  `, `--no-mv` dis
+00014a90: 6162 6c65 7320 616c 6c20 6d6f 7665 2f64  ables all move/d
+00014aa0: 656c 6574 6520 7375 7070 6f72 740a 2020  elete support.  
+00014ab0: 2a20 602d 2d68 6172 646c 696e 6b60 2063  * `--hardlink` c
+00014ac0: 7265 6174 6573 2068 6172 646c 696e 6b73  reates hardlinks
+00014ad0: 2069 6e73 7465 6164 206f 6620 7379 6d6c   instead of syml
+00014ae0: 696e 6b73 2077 6865 6e20 6465 6475 706c  inks when dedupl
+00014af0: 6963 6174 696e 6720 7570 6c6f 6164 732c  icating uploads,
+00014b00: 2077 6869 6368 2069 7320 6c65 7373 206d   which is less m
+00014b10: 6169 6e74 656e 616e 6365 0a20 2020 202a  aintenance.    *
+00014b20: 2068 6f77 6576 6572 206e 6f74 6520 6966   however note if
+00014b30: 2079 6f75 2065 6469 7420 6f6e 6520 6669   you edit one fi
+00014b40: 6c65 2069 7420 7769 6c6c 2061 6c73 6f20  le it will also 
+00014b50: 6166 6665 6374 2074 6865 206f 7468 6572  affect the other
+00014b60: 2063 6f70 6965 730a 2020 2a20 602d 2d76   copies.  * `--v
+00014b70: 6167 7565 2d34 3031 6020 7265 7475 726e  ague-401` return
+00014b80: 7320 6120 2234 3034 206e 6f74 2066 6f75  s a "404 not fou
+00014b90: 6e64 2220 696e 7374 6561 6420 6f66 2022  nd" instead of "
+00014ba0: 3430 3120 756e 6175 7468 6f72 697a 6564  401 unauthorized
+00014bb0: 2220 7768 6963 6820 6973 2061 2063 6f6d  " which is a com
+00014bc0: 6d6f 6e20 656e 7465 7270 7269 7365 206d  mon enterprise m
+00014bd0: 656d 650a 2020 2a20 602d 2d62 616e 2d34  eme.  * `--ban-4
+00014be0: 3034 3d35 302c 3630 2c31 3434 3060 2062  04=50,60,1440` b
+00014bf0: 616e 2063 6c69 656e 7420 666f 7220 3134  an client for 14
+00014c00: 3430 6d69 6e20 2832 3468 2920 6966 2074  40min (24h) if t
+00014c10: 6865 7920 6869 7420 3530 2034 3034 2773  hey hit 50 404's
+00014c20: 2069 6e20 3630 6d69 6e0a 2020 2020 2a20   in 60min.    * 
+00014c30: 2a2a 4e42 3a2a 2a20 7769 6c6c 2062 616e  **NB:** will ban
+00014c40: 2061 6e79 6f6e 6520 7768 6f20 656e 6162   anyone who enab
+00014c50: 6c65 7320 7570 326b 2074 7572 626f 0a20  les up2k turbo. 
+00014c60: 202a 2060 2d2d 6e69 6860 2072 656d 6f76   * `--nih` remov
+00014c70: 6573 2074 6865 2073 6572 7665 7220 686f  es the server ho
+00014c80: 7374 6e61 6d65 2066 726f 6d20 6469 7265  stname from dire
+00014c90: 6374 6f72 7920 6c69 7374 696e 6773 0a0a  ctory listings..
+00014ca0: 2a20 6f70 7469 6f6e 2060 2d73 7373 6020  * option `-sss` 
+00014cb0: 6973 2061 2073 686f 7274 6375 7420 666f  is a shortcut fo
+00014cc0: 7220 7468 6520 6162 6f76 6520 706c 7573  r the above plus
+00014cd0: 3a0a 2020 2a20 602d 2d6e 6f2d 6461 7660  :.  * `--no-dav`
+00014ce0: 2064 6973 6162 6c65 7320 7765 6264 6176   disables webdav
+00014cf0: 2073 7570 706f 7274 0a20 202a 2060 2d2d   support.  * `--
+00014d00: 6e6f 2d6c 6f67 7565 7360 2061 6e64 2060  no-logues` and `
+00014d10: 2d2d 6e6f 2d72 6561 646d 6560 2064 6973  --no-readme` dis
+00014d20: 6162 6c65 7320 7375 7070 6f72 7420 666f  ables support fo
+00014d30: 7220 7265 6164 6d65 2773 2061 6e64 2070  r readme's and p
+00014d40: 726f 6c6f 6775 6573 202f 2065 7069 6c6f  rologues / epilo
+00014d50: 6775 6573 2069 6e20 6469 7265 6374 6f72  gues in director
+00014d60: 7920 6c69 7374 696e 6773 2c20 7768 6963  y listings, whic
+00014d70: 6820 6f74 6865 7277 6973 6520 6c65 7473  h otherwise lets
+00014d80: 2070 656f 706c 6520 7570 6c6f 6164 2061   people upload a
+00014d90: 7262 6974 7261 7279 2028 6275 7420 7361  rbitrary (but sa
+00014da0: 6e64 626f 7865 6429 2060 3c73 6372 6970  ndboxed) `<scrip
+00014db0: 743e 6020 7461 6773 0a20 202a 2060 2d6c  t>` tags.  * `-l
+00014dc0: 6f20 6370 702d 2559 2d25 6d25 642d 2548  o cpp-%Y-%m%d-%H
+00014dd0: 254d 2553 2e74 7874 2e78 7a60 2065 6e61  %M%S.txt.xz` ena
+00014de0: 626c 6573 206c 6f67 6769 6e67 2074 6f20  bles logging to 
+00014df0: 6469 736b 0a20 202a 2060 2d6c 7320 2a2a  disk.  * `-ls **
+00014e00: 2c2a 2c6c 6e2c 702c 7260 2064 6f65 7320  ,*,ln,p,r` does 
+00014e10: 6120 7363 616e 206f 6e20 7374 6172 7475  a scan on startu
+00014e20: 7020 666f 7220 616e 7920 6461 6e67 6572  p for any danger
+00014e30: 6f75 7320 7379 6d6c 696e 6b73 0a0a 6f74  ous symlinks..ot
+00014e40: 6865 7220 6d69 7363 206e 6f74 6573 3a0a  her misc notes:.
+00014e50: 0a2a 2079 6f75 2063 616e 2064 6973 6162  .* you can disab
+00014e60: 6c65 2064 6972 6563 746f 7279 206c 6973  le directory lis
+00014e70: 7469 6e67 7320 6279 2067 6976 696e 6720  tings by giving 
+00014e80: 7065 726d 6973 7369 6f6e 2060 6760 2069  permission `g` i
+00014e90: 6e73 7465 6164 206f 6620 6072 602c 206f  nstead of `r`, o
+00014ea0: 6e6c 7920 6163 6365 7074 696e 6720 6469  nly accepting di
+00014eb0: 7265 6374 2055 524c 7320 746f 2066 696c  rect URLs to fil
+00014ec0: 6573 0a20 202a 2063 6f6d 6269 6e65 2074  es.  * combine t
+00014ed0: 6869 7320 7769 7468 2076 6f6c 666c 6167  his with volflag
+00014ee0: 2060 632c 666b 6020 746f 2067 656e 6572   `c,fk` to gener
+00014ef0: 6174 6520 6669 6c65 6b65 7973 2028 7065  ate filekeys (pe
+00014f00: 722d 6669 6c65 2061 6363 6573 736b 6579  r-file accesskey
+00014f10: 7329 3b20 7573 6572 7320 7768 6963 6820  s); users which 
+00014f20: 6861 7665 2066 756c 6c20 7265 6164 2d61  have full read-a
+00014f30: 6363 6573 7320 7769 6c6c 2074 6865 6e20  ccess will then 
+00014f40: 7365 6520 5552 4c73 2077 6974 6820 603f  see URLs with `?
+00014f50: 6b3d 2e2e 2e60 2061 7070 656e 6465 6420  k=...` appended 
+00014f60: 746f 2074 6865 2065 6e64 2c20 616e 6420  to the end, and 
+00014f70: 6067 6020 7573 6572 7320 6d75 7374 2070  `g` users must p
+00014f80: 726f 7669 6465 2074 6861 7420 5552 4c20  rovide that URL 
+00014f90: 696e 636c 7564 696e 6720 7468 6520 636f  including the co
+00014fa0: 7272 6563 7420 6b65 7920 746f 2061 766f  rrect key to avo
+00014fb0: 6964 2061 2034 3034 0a20 2020 202a 2074  id a 404.    * t
+00014fc0: 6865 2064 6566 6175 6c74 2066 696c 656b  he default filek
+00014fd0: 6579 2065 6e74 726f 7079 2069 7320 6661  ey entropy is fa
+00014fe0: 6972 6c79 2073 6d61 6c6c 2073 6f20 6769  irly small so gi
+00014ff0: 7665 2060 2d2d 666b 2d73 616c 7460 2061  ve `--fk-salt` a
+00015000: 726f 756e 6420 3330 2063 6861 7261 6374  round 30 charact
+00015010: 6572 7320 6966 2079 6f75 2077 616e 7420  ers if you want 
+00015020: 6669 6c65 6b65 7973 206c 6f6e 6765 7220  filekeys longer 
+00015030: 7468 616e 2031 3620 6368 6172 730a 2020  than 16 chars.  
+00015040: 2a20 7065 726d 6973 7369 6f6e 7320 6077  * permissions `w
+00015050: 4760 206c 6574 7320 7573 6572 7320 7570  G` lets users up
+00015060: 6c6f 6164 2066 696c 6573 2061 6e64 2072  load files and r
+00015070: 6563 6569 7665 2074 6865 6972 206f 776e  eceive their own
+00015080: 2066 696c 656b 6579 732c 2073 7469 6c6c   filekeys, still
+00015090: 2077 6974 686f 7574 2062 6569 6e67 2061   without being a
+000150a0: 626c 6520 746f 2073 6565 206f 7468 6572  ble to see other
+000150b0: 2075 706c 6f61 6473 0a0a 0a23 2320 676f   uploads...## go
+000150c0: 7463 6861 730a 0a62 6568 6176 696f 7220  tchas..behavior 
+000150d0: 7468 6174 206d 6967 6874 2062 6520 756e  that might be un
+000150e0: 6578 7065 6374 6564 0a0a 2a20 7573 6572  expected..* user
+000150f0: 7320 7769 7468 6f75 7420 7265 6164 2d61  s without read-a
+00015100: 6363 6573 7320 746f 2061 2066 6f6c 6465  ccess to a folde
+00015110: 7220 6361 6e20 7374 696c 6c20 7365 6520  r can still see 
+00015120: 7468 6520 602e 7072 6f6c 6f67 7565 2e68  the `.prologue.h
+00015130: 746d 6c60 202f 2060 2e65 7069 6c6f 6775  tml` / `.epilogu
+00015140: 652e 6874 6d6c 6020 2f20 6052 4541 444d  e.html` / `READM
+00015150: 452e 6d64 6020 636f 6e74 656e 7473 2c20  E.md` contents, 
+00015160: 666f 7220 7468 6520 7075 7270 6f73 6520  for the purpose 
+00015170: 6f66 2073 686f 7769 6e67 2061 2064 6573  of showing a des
+00015180: 6372 6970 7469 6f6e 206f 6e20 686f 7720  cription on how 
+00015190: 746f 2075 7365 2074 6865 2075 706c 6f61  to use the uploa
+000151a0: 6465 7220 666f 7220 6578 616d 706c 650a  der for example.
+000151b0: 2a20 7573 6572 7320 6361 6e20 7375 626d  * users can subm
+000151c0: 6974 2060 3c73 6372 6970 743e 6073 2077  it `<script>`s w
+000151d0: 6869 6368 2061 7574 6f72 756e 2066 6f72  hich autorun for
+000151e0: 206f 7468 6572 2076 6973 6974 6f72 7320   other visitors 
+000151f0: 696e 2061 2066 6577 2077 6179 733b 0a20  in a few ways;. 
+00015200: 202a 2075 706c 6f61 6469 6e67 2061 2060   * uploading a `
+00015210: 5245 4144 4d45 2e6d 6460 202d 2d20 6176  README.md` -- av
+00015220: 6f69 6420 7769 7468 2060 2d2d 6e6f 2d72  oid with `--no-r
+00015230: 6561 646d 6560 0a20 202a 2072 656e 616d  eadme`.  * renam
+00015240: 696e 6720 6073 6f6d 652e 6874 6d6c 6020  ing `some.html` 
+00015250: 746f 2060 2e65 7069 6c6f 6775 652e 6874  to `.epilogue.ht
+00015260: 6d6c 6020 2d2d 2061 766f 6964 2077 6974  ml` -- avoid wit
+00015270: 6820 6569 7468 6572 2060 2d2d 6e6f 2d6c  h either `--no-l
+00015280: 6f67 7565 7360 206f 7220 602d 2d6e 6f2d  ogues` or `--no-
+00015290: 646f 742d 7265 6e60 0a20 202a 2074 6865  dot-ren`.  * the
+000152a0: 2064 6972 6563 746f 7279 2d6c 6973 7469   directory-listi
+000152b0: 6e67 2065 6d62 6564 2069 7320 7361 6e64  ng embed is sand
+000152c0: 626f 7865 6420 2873 6f20 616e 7920 6d61  boxed (so any ma
+000152d0: 6c69 6369 6f75 7320 7363 7269 7074 7320  licious scripts 
+000152e0: 6361 6e27 7420 646f 2061 6e79 2064 616d  can't do any dam
+000152f0: 6167 6529 2062 7574 2074 6865 206d 6172  age) but the mar
+00015300: 6b64 6f77 6e20 6564 6974 6f72 2069 7320  kdown editor is 
+00015310: 6e6f 740a 0a0a 2323 2063 6f72 730a 0a63  not...## cors..c
+00015320: 726f 7373 2d73 6974 6520 7265 7175 6573  ross-site reques
+00015330: 7420 636f 6e66 6967 0a0a 6279 2064 6566  t config..by def
+00015340: 6175 6c74 2c20 6578 6365 7074 2066 6f72  ault, except for
+00015350: 2060 4745 5460 2061 6e64 2060 4845 4144   `GET` and `HEAD
+00015360: 6020 6f70 6572 6174 696f 6e73 2c20 616c  ` operations, al
+00015370: 6c20 7265 7175 6573 7473 206d 7573 7420  l requests must 
+00015380: 6569 7468 6572 3a0a 2a20 6e6f 7420 636f  either:.* not co
+00015390: 6e74 6169 6e20 616e 2060 4f72 6967 696e  ntain an `Origin
+000153a0: 6020 6865 6164 6572 2061 7420 616c 6c0a  ` header at all.
+000153b0: 2a20 6f72 2068 6176 6520 616e 2060 4f72  * or have an `Or
+000153c0: 6967 696e 6020 6d61 7463 6869 6e67 2074  igin` matching t
+000153d0: 6865 2073 6572 7665 7220 646f 6d61 696e  he server domain
+000153e0: 0a2a 206f 7220 7468 6520 6865 6164 6572  .* or the header
+000153f0: 2060 5057 6020 7769 7468 2079 6f75 7220   `PW` with your 
+00015400: 7061 7373 776f 7264 2061 7320 7661 6c75  password as valu
+00015410: 650a 0a63 6f72 7320 6361 6e20 6265 2063  e..cors can be c
+00015420: 6f6e 6669 6775 7265 6420 7769 7468 2060  onfigured with `
+00015430: 2d2d 6163 616f 6020 616e 6420 602d 2d61  --acao` and `--a
+00015440: 6361 6d60 2c20 6f72 2074 6865 2070 726f  cam`, or the pro
+00015450: 7465 6374 696f 6e73 2065 6e74 6972 656c  tections entirel
+00015460: 7920 6469 7361 626c 6564 2077 6974 6820  y disabled with 
+00015470: 602d 2d61 6c6c 6f77 2d63 7372 6660 0a0a  `--allow-csrf`..
+00015480: 0a23 2320 6874 7470 730a 0a62 6f74 6820  .## https..both 
+00015490: 4854 5450 2061 6e64 2048 5454 5053 2061  HTTP and HTTPS a
+000154a0: 7265 2061 6363 6570 7465 6420 2062 7920  re accepted  by 
+000154b0: 6465 6661 756c 742c 2062 7574 206c 6574  default, but let
+000154c0: 7469 6e67 2061 205b 7265 7665 7273 6520  ting a [reverse 
+000154d0: 7072 6f78 795d 2823 7265 7665 7273 652d  proxy](#reverse-
+000154e0: 7072 6f78 7929 2068 616e 646c 6520 7468  proxy) handle th
+000154f0: 6520 6874 7470 732f 746c 732f 7373 6c20  e https/tls/ssl 
+00015500: 776f 756c 6420 6265 2062 6574 7465 7220  would be better 
+00015510: 2870 726f 6261 626c 7920 6d6f 7265 2073  (probably more s
+00015520: 6563 7572 6520 6279 2064 6566 6175 6c74  ecure by default
+00015530: 290a 0a63 6f70 7970 6172 7479 2064 6f65  )..copyparty doe
+00015540: 736e 2774 2073 7065 616b 2048 5454 502f  sn't speak HTTP/
+00015550: 3220 6f72 2051 5549 432c 2073 6f20 7573  2 or QUIC, so us
+00015560: 696e 6720 6120 7265 7665 7273 6520 7072  ing a reverse pr
+00015570: 6f78 7920 776f 756c 6420 736f 6c76 6520  oxy would solve 
+00015580: 7468 6174 2061 7320 7765 6c6c 0a0a 0a23  that as well...#
+00015590: 2072 6563 6f76 6572 696e 6720 6672 6f6d   recovering from
+000155a0: 2063 7261 7368 6573 0a0a 2323 2063 6c69   crashes..## cli
+000155b0: 656e 7420 6372 6173 6865 730a 0a23 2323  ent crashes..###
+000155c0: 2066 7265 666f 7820 7773 6f64 0a0a 6669   frefox wsod..fi
+000155d0: 7265 666f 7820 3837 2063 616e 2063 7261  refox 87 can cra
+000155e0: 7368 2064 7572 696e 6720 7570 6c6f 6164  sh during upload
+000155f0: 7320 202d 2d20 7468 6520 656e 7469 7265  s  -- the entire
+00015600: 2062 726f 7773 6572 2067 6f65 732c 2069   browser goes, i
+00015610: 6e63 6c75 6469 6e67 2061 6c6c 206f 7468  ncluding all oth
+00015620: 6572 2062 726f 7773 6572 2074 6162 732c  er browser tabs,
+00015630: 2065 7665 7279 7468 696e 6720 7475 726e   everything turn
+00015640: 7320 7768 6974 650a 0a68 6f77 6576 6572  s white..however
+00015650: 2079 6f75 2063 616e 2068 6974 2060 4631   you can hit `F1
+00015660: 3260 2069 6e20 7468 6520 7570 326b 2074  2` in the up2k t
+00015670: 6162 2061 6e64 2075 7365 2074 6865 2064  ab and use the d
+00015680: 6576 746f 6f6c 7320 746f 2073 6565 2068  evtools to see h
+00015690: 6f77 2066 6172 2079 6f75 2067 6f74 2069  ow far you got i
+000156a0: 6e20 7468 6520 7570 6c6f 6164 733a 0a0a  n the uploads:..
+000156b0: 2a20 6765 7420 6120 636f 6d70 6c65 7465  * get a complete
+000156c0: 206c 6973 7420 6f66 2061 6c6c 2075 706c   list of all upl
+000156d0: 6f61 6473 2c20 6f72 6761 6e69 7a65 6420  oads, organized 
+000156e0: 6279 2073 7461 7475 7473 2028 6f6b 202f  by statuts (ok /
+000156f0: 206e 6f2d 676f 6f64 202f 2062 7573 7920   no-good / busy 
+00015700: 2f20 7175 6575 6564 293a 2020 0a20 2060  / queued):  .  `
+00015710: 7661 7220 7461 6273 203d 207b 206f 6b3a  var tabs = { ok:
+00015720: 5b5d 2c20 6e67 3a5b 5d2c 2062 7a3a 5b5d  [], ng:[], bz:[]
+00015730: 2c20 713a 5b5d 207d 3b20 666f 7220 2876  , q:[] }; for (v
+00015740: 6172 2061 206f 6620 7570 326b 2e75 692e  ar a of up2k.ui.
+00015750: 7461 6229 2074 6162 735b 612e 696e 5d2e  tab) tabs[a.in].
+00015760: 7075 7368 2861 293b 2074 6162 7360 0a0a  push(a); tabs`..
+00015770: 2a20 6c69 7374 206f 6620 6669 6c65 6e61  * list of filena
+00015780: 6d65 7320 7768 6963 6820 6661 696c 6564  mes which failed
+00015790: 3a20 200a 2020 60e2 808b 7661 7220 6e67  :  .  `...var ng
+000157a0: 203d 205b 5d3b 2066 6f72 2028 7661 7220   = []; for (var 
+000157b0: 6120 6f66 2075 7032 6b2e 7569 2e74 6162  a of up2k.ui.tab
+000157c0: 2920 6966 2028 612e 696e 2021 3d20 276f  ) if (a.in != 'o
+000157d0: 6b27 2920 6e67 2e70 7573 6828 612e 686e  k') ng.push(a.hn
+000157e0: 2e73 706c 6974 2827 3c61 2068 7265 663d  .split('<a href=
+000157f0: 5c22 2729 2e73 6c69 6365 282d 3129 5b30  \"').slice(-1)[0
+00015800: 5d2e 7370 6c69 7428 275c 223e 2729 5b30  ].split('\">')[0
+00015810: 5d29 3b20 6e67 600a 0a2a 2073 656e 6420  ]); ng`..* send 
+00015820: 7468 6520 6c69 7374 206f 6620 6669 6c65  the list of file
+00015830: 6e61 6d65 7320 746f 2063 6f70 7970 6172  names to copypar
+00015840: 7479 2066 6f72 2073 6166 656b 6565 7069  ty for safekeepi
+00015850: 6e67 3a20 200a 2020 6061 7761 6974 2066  ng:  .  `await f
+00015860: 6574 6368 2827 2f69 6e63 272c 207b 6d65  etch('/inc', {me
+00015870: 7468 6f64 3a27 5055 5427 2c20 626f 6479  thod:'PUT', body
+00015880: 3a4a 534f 4e2e 7374 7269 6e67 6966 7928  :JSON.stringify(
+00015890: 6e67 2c6e 756c 6c2c 3129 7d29 600a 0a0a  ng,null,1)})`...
+000158a0: 2320 4854 5450 2041 5049 0a0a 7365 6520  # HTTP API..see 
+000158b0: 5b64 6576 6e6f 7465 735d 282e 2f64 6f63  [devnotes](./doc
+000158c0: 732f 6465 766e 6f74 6573 2e6d 6423 6874  s/devnotes.md#ht
+000158d0: 7470 2d61 7069 290a 0a0a 2320 6465 7065  tp-api)...# depe
+000158e0: 6e64 656e 6369 6573 0a0a 6d61 6e64 6174  ndencies..mandat
+000158f0: 6f72 7920 6465 7073 3a0a 2a20 606a 696e  ory deps:.* `jin
+00015900: 6a61 3260 2028 6973 2062 7569 6c74 2069  ja2` (is built i
+00015910: 6e74 6f20 7468 6520 5346 5829 0a0a 0a23  nto the SFX)...#
+00015920: 2320 6f70 7469 6f6e 616c 2064 6570 656e  # optional depen
+00015930: 6465 6e63 6965 730a 0a69 6e73 7461 6c6c  dencies..install
+00015940: 2074 6865 7365 2074 6f20 656e 6162 6c65   these to enable
+00015950: 2062 6f6e 7573 2066 6561 7475 7265 730a   bonus features.
+00015960: 0a65 6e61 626c 6520 6674 702d 7365 7276  .enable ftp-serv
+00015970: 6572 3a0a 2a20 666f 7220 6a75 7374 2070  er:.* for just p
+00015980: 6c61 696e 7465 7874 2046 5450 2c20 6070  laintext FTP, `p
+00015990: 7966 7470 646c 6962 6020 2869 7320 6275  yftpdlib` (is bu
+000159a0: 696c 7420 696e 746f 2074 6865 2053 4658  ilt into the SFX
+000159b0: 290a 2a20 7769 7468 2054 4c53 2065 6e63  ).* with TLS enc
+000159c0: 7279 7074 696f 6e2c 2060 7079 6674 7064  ryption, `pyftpd
+000159d0: 6c69 6220 7079 6f70 656e 7373 6c60 0a0a  lib pyopenssl`..
+000159e0: 656e 6162 6c65 206d 7573 6963 2074 6167  enable music tag
+000159f0: 733a 0a2a 2065 6974 6865 7220 606d 7574  s:.* either `mut
+00015a00: 6167 656e 6020 2866 6173 742c 2070 7572  agen` (fast, pur
+00015a10: 652d 7079 7468 6f6e 2c20 736b 6970 7320  e-python, skips 
+00015a20: 6120 6665 7720 7461 6773 2c20 6d61 6b65  a few tags, make
+00015a30: 7320 636f 7079 7061 7274 7920 4750 4c3f  s copyparty GPL?
+00015a40: 2069 646b 290a 2a20 6f72 2060 6666 7072   idk).* or `ffpr
+00015a50: 6f62 6560 2028 3230 7820 736c 6f77 6572  obe` (20x slower
+00015a60: 2c20 6d6f 7265 2061 6363 7572 6174 652c  , more accurate,
+00015a70: 2070 6f73 7369 626c 7920 6461 6e67 6572   possibly danger
+00015a80: 6f75 7320 6465 7065 6e64 696e 6720 6f6e  ous depending on
+00015a90: 2079 6f75 7220 6469 7374 726f 2061 6e64   your distro and
+00015aa0: 2075 7365 7273 290a 0a65 6e61 626c 6520   users)..enable 
+00015ab0: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+00015ac0: 756d 626e 6169 6c73 2920 6f66 2e2e 2e0a  umbnails) of....
+00015ad0: 2a20 2a2a 696d 6167 6573 3a2a 2a20 6050  * **images:** `P
+00015ae0: 696c 6c6f 7760 2061 6e64 2f6f 7220 6070  illow` and/or `p
+00015af0: 7976 6970 7360 2061 6e64 2f6f 7220 6066  yvips` and/or `f
+00015b00: 666d 7065 6760 2028 7265 7175 6972 6573  fmpeg` (requires
+00015b10: 2070 7932 2e37 206f 7220 7079 332e 352b   py2.7 or py3.5+
+00015b20: 290a 2a20 2a2a 7669 6465 6f73 2f61 7564  ).* **videos/aud
+00015b30: 696f 3a2a 2a20 6066 666d 7065 6760 2061  io:** `ffmpeg` a
+00015b40: 6e64 2060 6666 7072 6f62 6560 2073 6f6d  nd `ffprobe` som
+00015b50: 6577 6865 7265 2069 6e20 6024 5041 5448  ewhere in `$PATH
+00015b60: 600a 2a20 2a2a 4845 4946 2070 6963 7475  `.* **HEIF pictu
+00015b70: 7265 733a 2a2a 2060 7079 7669 7073 6020  res:** `pyvips` 
+00015b80: 6f72 2060 6666 6d70 6567 6020 6f72 2060  or `ffmpeg` or `
+00015b90: 7079 6865 6966 2d70 696c 6c6f 772d 6f70  pyheif-pillow-op
+00015ba0: 656e 6572 6020 2872 6571 7569 7265 7320  ener` (requires 
+00015bb0: 4c69 6e75 7820 6f72 2061 2043 2063 6f6d  Linux or a C com
+00015bc0: 7069 6c65 7229 0a2a 202a 2a41 5649 4620  piler).* **AVIF 
+00015bd0: 7069 6374 7572 6573 3a2a 2a20 6070 7976  pictures:** `pyv
+00015be0: 6970 7360 206f 7220 6066 666d 7065 6760  ips` or `ffmpeg`
+00015bf0: 206f 7220 6070 696c 6c6f 772d 6176 6966   or `pillow-avif
+00015c00: 2d70 6c75 6769 6e60 0a2a 202a 2a4a 5045  -plugin`.* **JPE
+00015c10: 4720 584c 2070 6963 7475 7265 733a 2a2a  G XL pictures:**
+00015c20: 2060 7079 7669 7073 6020 6f72 2060 6666   `pyvips` or `ff
+00015c30: 6d70 6567 600a 0a65 6e61 626c 6520 5b73  mpeg`..enable [s
+00015c40: 6d62 5d28 2373 6d62 2d73 6572 7665 7229  mb](#smb-server)
+00015c50: 2073 7570 706f 7274 2028 2a2a 6e6f 742a   support (**not*
+00015c60: 2a20 7265 636f 6d6d 656e 6465 6429 3a0a  * recommended):.
+00015c70: 2a20 6069 6d70 6163 6b65 743d 3d30 2e31  * `impacket==0.1
+00015c80: 302e 3060 0a0a 6070 7976 6970 7360 2067  0.0`..`pyvips` g
+00015c90: 6976 6573 2068 6967 6865 7220 7175 616c  ives higher qual
+00015ca0: 6974 7920 7468 756d 626e 6169 6c73 2074  ity thumbnails t
+00015cb0: 6861 6e20 6050 696c 6c6f 7760 2061 6e64  han `Pillow` and
+00015cc0: 2069 7320 3332 3025 2066 6173 7465 722c   is 320% faster,
+00015cd0: 2075 7369 6e67 2032 3730 2520 6d6f 7265   using 270% more
+00015ce0: 2072 616d 3a20 6073 7564 6f20 6170 7420   ram: `sudo apt 
+00015cf0: 696e 7374 616c 6c20 6c69 6276 6970 7334  install libvips4
+00015d00: 3220 2626 2070 7974 686f 6e33 202d 6d20  2 && python3 -m 
+00015d10: 7069 7020 696e 7374 616c 6c20 2d2d 7573  pip install --us
+00015d20: 6572 202d 5520 7079 7669 7073 600a 0a0a  er -U pyvips`...
+00015d30: 2323 206f 7074 696f 6e61 6c20 6770 6c20  ## optional gpl 
+00015d40: 7374 7566 660a 0a73 6f6d 6520 6275 6e64  stuff..some bund
+00015d50: 6c65 6420 746f 6f6c 7320 6861 7665 2063  led tools have c
+00015d60: 6f70 796c 6566 7420 6465 7065 6e64 656e  opyleft dependen
+00015d70: 6369 6573 2c20 7365 6520 5b2e 2f62 696e  cies, see [./bin
+00015d80: 2f23 6d74 6167 5d28 6269 6e2f 236d 7461  /#mtag](bin/#mta
+00015d90: 6729 0a0a 7468 6573 6520 6172 6520 7374  g)..these are st
+00015da0: 616e 6461 6c6f 6e65 2070 726f 6772 616d  andalone program
+00015db0: 7320 616e 6420 7769 6c6c 206e 6576 6572  s and will never
+00015dc0: 2062 6520 696d 706f 7274 6564 202f 2065   be imported / e
+00015dd0: 7661 6c75 6174 6564 2062 7920 636f 7079  valuated by copy
+00015de0: 7061 7274 792c 2061 6e64 206d 7573 7420  party, and must 
+00015df0: 6265 2065 6e61 626c 6564 2074 6872 6f75  be enabled throu
+00015e00: 6768 2060 2d6d 7470 6020 636f 6e66 6967  gh `-mtp` config
+00015e10: 730a 0a0a 2320 7366 780a 0a74 6865 2073  s...# sfx..the s
+00015e20: 656c 662d 636f 6e74 6169 6e65 6420 2262  elf-contained "b
+00015e30: 696e 6172 7922 2020 5b63 6f70 7970 6172  inary"  [copypar
+00015e40: 7479 2d73 6678 2e70 795d 2868 7474 7073  ty-sfx.py](https
+00015e50: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00015e60: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
+00015e70: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
+00015e80: 6e6c 6f61 642f 636f 7079 7061 7274 792d  nload/copyparty-
+00015e90: 7366 782e 7079 2920 7769 6c6c 2075 6e70  sfx.py) will unp
+00015ea0: 6163 6b20 6974 7365 6c66 2061 6e64 2072  ack itself and r
+00015eb0: 756e 2063 6f70 7970 6172 7479 2c20 6173  un copyparty, as
+00015ec0: 7375 6d69 6e67 2079 6f75 2068 6176 6520  suming you have 
+00015ed0: 7079 7468 6f6e 2069 6e73 7461 6c6c 6564  python installed
+00015ee0: 206f 6620 636f 7572 7365 0a0a 796f 7520   of course..you 
+00015ef0: 6361 6e20 7265 6475 6365 2074 6865 2073  can reduce the s
+00015f00: 6678 2073 697a 6520 6279 2072 6570 6163  fx size by repac
+00015f10: 6b69 6e67 2069 743b 2073 6565 205b 2e2f  king it; see [./
+00015f20: 646f 6373 2f64 6576 6e6f 7465 732e 6d64  docs/devnotes.md
+00015f30: 2373 6678 2d72 6570 6163 6b5d 282e 2f64  #sfx-repack](./d
+00015f40: 6f63 732f 6465 766e 6f74 6573 2e6d 6423  ocs/devnotes.md#
+00015f50: 7366 782d 7265 7061 636b 290a 0a0a 2323  sfx-repack)...##
+00015f60: 2063 6f70 7970 6172 7479 2e65 7865 0a0a   copyparty.exe..
+00015f70: 646f 776e 6c6f 6164 205b 636f 7079 7061  download [copypa
+00015f80: 7274 792e 6578 655d 2868 7474 7073 3a2f  rty.exe](https:/
+00015f90: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00015fa0: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
+00015fb0: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
+00015fc0: 6f61 642f 636f 7079 7061 7274 792e 6578  oad/copyparty.ex
+00015fd0: 6529 2028 7769 6e38 2b29 206f 7220 5b63  e) (win8+) or [c
+00015fe0: 6f70 7970 6172 7479 3332 2e65 7865 5d28  opyparty32.exe](
+00015ff0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016000: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00016010: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
+00016020: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
+00016030: 6172 7479 3332 2e65 7865 2920 2877 696e  arty32.exe) (win
+00016040: 372b 290a 0a21 5b63 6f70 7970 6172 7479  7+)..![copyparty
+00016050: 2d65 7865 2d66 7338 5d28 6874 7470 733a  -exe-fs8](https:
+00016060: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+00016070: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+00016080: 636f 6d2f 3234 3130 3332 2f32 3231 3434  com/241032/22144
+00016090: 3539 3436 2d31 6533 3238 6535 362d 3863  5946-1e328e56-8c
+000160a0: 3562 2d34 3461 392d 3862 3966 2d64 6565  5b-44a9-8b9f-dee
+000160b0: 3834 6439 3432 3533 352e 706e 6729 0a0a  84d942535.png)..
+000160c0: 6361 6e20 6265 2063 6f6e 7665 6e69 656e  can be convenien
+000160d0: 7420 6f6e 206d 6163 6869 6e65 7320 7768  t on machines wh
+000160e0: 6572 6520 696e 7374 616c 6c69 6e67 2070  ere installing p
+000160f0: 7974 686f 6e20 6973 2070 726f 626c 656d  ython is problem
+00016100: 6174 6963 2c20 686f 7765 7665 7220 6973  atic, however is
+00016110: 202a 2a6e 6f74 2072 6563 6f6d 6d65 6e64   **not recommend
+00016120: 6564 2a2a 202d 2d20 6966 2070 6f73 7369  ed** -- if possi
+00016130: 626c 652c 2070 6c65 6173 6520 7573 6520  ble, please use 
+00016140: 2a2a 5b63 6f70 7970 6172 7479 2d73 6678  **[copyparty-sfx
+00016150: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
+00016160: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+00016170: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+00016180: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+00016190: 636f 7079 7061 7274 792d 7366 782e 7079  copyparty-sfx.py
+000161a0: 292a 2a20 696e 7374 6561 640a 0a2a 205b  )** instead..* [
+000161b0: 636f 7079 7061 7274 792e 6578 655d 2868  copyparty.exe](h
+000161c0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000161d0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+000161e0: 2f72 656c 6561 7365 732f 6c61 7465 7374  /releases/latest
+000161f0: 2f64 6f77 6e6c 6f61 642f 636f 7079 7061  /download/copypa
+00016200: 7274 792e 6578 6529 2072 756e 7320 6f6e  rty.exe) runs on
+00016210: 2077 696e 3820 6f72 206e 6577 6572 2c20   win8 or newer, 
+00016220: 7761 7320 636f 6d70 696c 6564 206f 6e20  was compiled on 
+00016230: 7769 6e31 302c 2064 6f65 7320 7468 756d  win10, does thum
+00016240: 626e 6169 6c73 202b 206d 6564 6961 2074  bnails + media t
+00016250: 6167 732c 2061 6e64 2069 7320 2a63 7572  ags, and is *cur
+00016260: 7265 6e74 6c79 2a20 7361 6665 2074 6f20  rently* safe to 
+00016270: 7573 652c 2062 7574 2061 6e79 2066 7574  use, but any fut
+00016280: 7572 6520 7079 7468 6f6e 2f65 7870 6174  ure python/expat
+00016290: 2f70 696c 6c6f 7720 4356 4573 2063 616e  /pillow CVEs can
+000162a0: 206f 6e6c 7920 6265 2072 656d 6564 6965   only be remedie
+000162b0: 6420 6279 2064 6f77 6e6c 6f61 6469 6e67  d by downloading
+000162c0: 2061 206e 6577 6572 2076 6572 7369 6f6e   a newer version
+000162d0: 206f 6620 7468 6520 6578 650a 0a20 202a   of the exe..  *
+000162e0: 206f 6e20 7769 6e38 2069 7420 6e65 6564   on win8 it need
+000162f0: 7320 5b76 6320 7265 6469 7374 2032 3031  s [vc redist 201
+00016300: 355d 2868 7474 7073 3a2f 2f77 7777 2e6d  5](https://www.m
+00016310: 6963 726f 736f 6674 2e63 6f6d 2f65 6e2d  icrosoft.com/en-
+00016320: 7573 2f64 6f77 6e6c 6f61 642f 6465 7461  us/download/deta
+00016330: 696c 732e 6173 7078 3f69 643d 3438 3134  ils.aspx?id=4814
+00016340: 3529 2c20 6f6e 2077 696e 3130 2069 7420  5), on win10 it 
+00016350: 6a75 7374 2077 6f72 6b73 0a20 202a 2073  just works.  * s
+00016360: 6f6d 6520 616e 7469 7669 7275 7320 6d61  ome antivirus ma
+00016370: 7920 6672 6561 6b20 6f75 7420 2866 616c  y freak out (fal
+00016380: 7365 2d70 6f73 6974 6976 6529 2c20 706f  se-positive), po
+00016390: 7373 6962 6c79 205b 4176 6173 742c 2041  ssibly [Avast, A
+000163a0: 5647 2c20 616e 6420 4d63 4166 6565 5d28  VG, and McAfee](
+000163b0: 6874 7470 733a 2f2f 7777 772e 7669 7275  https://www.viru
+000163c0: 7374 6f74 616c 2e63 6f6d 2f67 7569 2f66  stotal.com/gui/f
+000163d0: 696c 652f 3532 3339 3161 3165 3938 3432  ile/52391a1e9842
+000163e0: 6366 3730 6164 3234 3365 6638 3338 3434  cf70ad243ef83844
+000163f0: 6434 3664 3239 6330 3034 3464 3130 3165  d46d29c0044d101e
+00016400: 6530 3133 3866 6364 6433 6338 6465 3232  e0138fcdd3c8de22
+00016410: 3337 6436 2f64 6574 6563 7469 6f6e 290a  37d6/detection).
+00016420: 0a2a 2064 616e 6765 726f 7573 3a20 5b63  .* dangerous: [c
+00016430: 6f70 7970 6172 7479 3332 2e65 7865 5d28  opyparty32.exe](
+00016440: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016450: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00016460: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
+00016470: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
+00016480: 6172 7479 3332 2e65 7865 2920 6973 2063  arty32.exe) is c
+00016490: 6f6d 7061 7469 626c 6520 7769 7468 205b  ompatible with [
+000164a0: 7769 6e64 6f77 7337 5d28 6874 7470 733a  windows7](https:
+000164b0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000164c0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000164d0: 636f 6d2f 3234 3130 3332 2f32 3231 3434  com/241032/22144
+000164e0: 3539 3434 2d61 6538 3564 3166 342d 6433  5944-ae85d1f4-d3
+000164f0: 3531 2d34 3833 372d 6231 3330 2d38 3263  51-4837-b130-82c
+00016500: 6162 3537 6436 6363 612e 706e 6729 2c20  ab57d6cca.png), 
+00016510: 7768 6963 6820 6d65 616e 7320 6974 2075  which means it u
+00016520: 7365 7320 616e 2061 6e63 6965 6e74 2063  ses an ancient c
+00016530: 6f70 7920 6f66 2070 7974 686f 6e20 2833  opy of python (3
+00016540: 2e37 2e39 2920 7768 6963 6820 6361 6e6e  .7.9) which cann
+00016550: 6f74 2062 6520 7570 6772 6164 6564 2061  ot be upgraded a
+00016560: 6e64 2073 686f 756c 6420 6e65 7665 7220  nd should never 
+00016570: 6265 2065 7870 6f73 6564 2074 6f20 7468  be exposed to th
+00016580: 6520 696e 7465 726e 6574 2028 4c41 4e20  e internet (LAN 
+00016590: 6973 2066 696e 6529 0a0a 2a20 6461 6e67  is fine)..* dang
+000165a0: 6572 6f75 7320 616e 6420 6465 7072 6563  erous and deprec
+000165b0: 6174 6564 3a20 5b63 6f70 7970 6172 7479  ated: [copyparty
+000165c0: 2d77 696e 7065 3634 2e65 7865 5d28 6874  -winpe64.exe](ht
+000165d0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+000165e0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
+000165f0: 7265 6c65 6173 6573 2f64 6f77 6e6c 6f61  releases/downloa
+00016600: 642f 7631 2e36 2e38 2f63 6f70 7970 6172  d/v1.6.8/copypar
+00016610: 7479 2d77 696e 7065 3634 2e65 7865 2920  ty-winpe64.exe) 
+00016620: 6c65 7473 2079 6f75 205b 7275 6e20 636f  lets you [run co
+00016630: 7079 7061 7274 7920 696e 2057 696e 5045  pyparty in WinPE
+00016640: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00016650: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00016660: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00016670: 3332 2f32 3035 3435 3439 3834 2d65 3662  32/205454984-e6b
+00016680: 3535 3064 662d 3363 3439 2d34 3836 642d  550df-3c49-486d-
+00016690: 3932 3637 2d31 3631 3430 3738 6464 3064  9267-1614078dd0d
+000166a0: 642e 706e 6729 2061 6e64 2069 7320 6f74  d.png) and is ot
+000166b0: 6865 7277 6973 6520 636f 6d70 6c65 7465  herwise complete
+000166c0: 6c79 2075 7365 6c65 7373 0a0a 6d65 616e  ly useless..mean
+000166d0: 7768 696c 6520 5b63 6f70 7970 6172 7479  while [copyparty
+000166e0: 2d73 6678 2e70 795d 2868 7474 7073 3a2f  -sfx.py](https:/
+000166f0: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00016700: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
+00016710: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
+00016720: 6f61 642f 636f 7079 7061 7274 792d 7366  oad/copyparty-sf
+00016730: 782e 7079 2920 696e 7374 6561 6420 7265  x.py) instead re
+00016740: 6c69 6573 206f 6e20 796f 7572 2073 7973  lies on your sys
+00016750: 7465 6d20 7079 7468 6f6e 2077 6869 6368  tem python which
+00016760: 2067 6976 6573 2062 6574 7465 7220 7065   gives better pe
+00016770: 7266 6f72 6d61 6e63 6520 616e 6420 7769  rformance and wi
+00016780: 6c6c 2073 7461 7920 7361 6665 2061 7320  ll stay safe as 
+00016790: 6c6f 6e67 2061 7320 796f 7520 6b65 6570  long as you keep
+000167a0: 2079 6f75 7220 7079 7468 6f6e 2069 6e73   your python ins
+000167b0: 7461 6c6c 2075 702d 746f 2d64 6174 650a  tall up-to-date.
+000167c0: 0a74 6865 6e20 6167 6169 6e2c 2069 6620  .then again, if 
+000167d0: 796f 7520 6172 6520 616c 7265 6164 7920  you are already 
+000167e0: 696e 746f 2064 6f77 6e6c 6f61 6469 6e67  into downloading
+000167f0: 2073 6861 6479 2062 696e 6172 6965 7320   shady binaries 
+00016800: 6672 6f6d 2074 6865 2069 6e74 6572 6e65  from the interne
+00016810: 742c 2079 6f75 206d 6179 2061 6c73 6f20  t, you may also 
+00016820: 7761 6e74 206d 7920 5b6d 696e 696d 616c  want my [minimal
+00016830: 2062 7569 6c64 735d 282e 2f73 6372 6970   builds](./scrip
+00016840: 7473 2f70 7969 6e73 7461 6c6c 6572 2366  ts/pyinstaller#f
+00016850: 666d 7065 6729 206f 6620 5b66 666d 7065  fmpeg) of [ffmpe
+00016860: 675d 2868 7474 7073 3a2f 2f6f 6376 2e6d  g](https://ocv.m
+00016870: 652f 7374 7566 662f 6269 6e2f 6666 6d70  e/stuff/bin/ffmp
+00016880: 6567 2e65 7865 2920 616e 6420 5b66 6670  eg.exe) and [ffp
+00016890: 726f 6265 5d28 6874 7470 733a 2f2f 6f63  robe](https://oc
+000168a0: 762e 6d65 2f73 7475 6666 2f62 696e 2f66  v.me/stuff/bin/f
+000168b0: 6670 726f 6265 2e65 7865 2920 7768 6963  fprobe.exe) whic
+000168c0: 6820 656e 6162 6c65 7320 636f 7079 7061  h enables copypa
+000168d0: 7274 7920 746f 2065 7874 7261 6374 206d  rty to extract m
+000168e0: 756c 7469 6d65 6469 612d 696e 666f 2c20  ultimedia-info, 
+000168f0: 646f 2061 7564 696f 2d74 7261 6e73 636f  do audio-transco
+00016900: 6469 6e67 2c20 616e 6420 7468 756d 626e  ding, and thumbn
+00016910: 6169 6c73 2f73 7065 6374 726f 6772 616d  ails/spectrogram
+00016920: 732f 7761 7665 666f 726d 732c 2068 6f77  s/waveforms, how
+00016930: 6576 6572 2069 7427 7320 6d75 6368 2062  ever it's much b
+00016940: 6574 7465 7220 746f 2069 6e73 7465 6164  etter to instead
+00016950: 2067 7261 6220 6120 5b72 6563 656e 7420   grab a [recent 
+00016960: 6f66 6669 6369 616c 2062 7569 6c64 5d28  official build](
+00016970: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016980: 6f6d 2f42 7462 4e2f 4646 6d70 6567 2d42  om/BtbN/FFmpeg-B
+00016990: 7569 6c64 732f 7265 6c65 6173 6573 2f64  uilds/releases/d
+000169a0: 6f77 6e6c 6f61 642f 6c61 7465 7374 2f66  ownload/latest/f
+000169b0: 666d 7065 672d 6d61 7374 6572 2d6c 6174  fmpeg-master-lat
+000169c0: 6573 742d 7769 6e36 342d 6770 6c2e 7a69  est-win64-gpl.zi
+000169d0: 7029 2065 7665 7279 206f 6e63 6520 696e  p) every once in
+000169e0: 6120 7768 696c 6520 6966 2079 6f75 2063  a while if you c
+000169f0: 616e 2061 6666 6f72 6420 7468 6520 7369  an afford the si
+00016a00: 7a65 0a0a 0a23 2069 6e73 7461 6c6c 206f  ze...# install o
+00016a10: 6e20 616e 6472 6f69 640a 0a69 6e73 7461  n android..insta
+00016a20: 6c6c 205b 5465 726d 7578 5d28 6874 7470  ll [Termux](http
+00016a30: 733a 2f2f 7465 726d 7578 2e63 6f6d 2f29  s://termux.com/)
+00016a40: 202b 2069 7473 2063 6f6d 7061 6e69 6f6e   + its companion
+00016a50: 2061 7070 2060 5465 726d 7578 3a41 5049   app `Termux:API
+00016a60: 6020 2873 6565 205b 6f63 762e 6d65 2f74  ` (see [ocv.me/t
+00016a70: 6572 6d75 785d 2868 7474 7073 3a2f 2f6f  ermux](https://o
+00016a80: 6376 2e6d 652f 7465 726d 7578 2f29 2920  cv.me/termux/)) 
+00016a90: 616e 6420 7468 656e 2063 6f70 792d 7061  and then copy-pa
+00016aa0: 7374 6520 7468 6973 2069 6e74 6f20 5465  ste this into Te
+00016ab0: 726d 7578 2028 6c6f 6e67 2d74 6170 2920  rmux (long-tap) 
+00016ac0: 616c 6c20 6174 206f 6e63 653a 0a60 6060  all at once:.```
+00016ad0: 7368 0a79 6573 207c 2070 6b67 2075 7067  sh.yes | pkg upg
+00016ae0: 7261 6465 2026 2620 7465 726d 7578 2d73  rade && termux-s
+00016af0: 6574 7570 2d73 746f 7261 6765 2026 2620  etup-storage && 
+00016b00: 7965 7320 7c20 706b 6720 696e 7374 616c  yes | pkg instal
+00016b10: 6c20 7079 7468 6f6e 2074 6572 6d75 782d  l python termux-
+00016b20: 6170 6920 2626 2070 7974 686f 6e20 2d6d  api && python -m
+00016b30: 2065 6e73 7572 6570 6970 2026 2620 7079   ensurepip && py
+00016b40: 7468 6f6e 202d 6d20 7069 7020 696e 7374  thon -m pip inst
+00016b50: 616c 6c20 2d2d 7573 6572 202d 5520 636f  all --user -U co
+00016b60: 7079 7061 7274 7920 2626 207b 2067 7265  pyparty && { gre
+00016b70: 7020 2d71 4520 2750 4154 483d 2e2a 5c2e  p -qE 'PATH=.*\.
+00016b80: 6c6f 6361 6c2f 6269 6e27 207e 2f2e 6261  local/bin' ~/.ba
+00016b90: 7368 7263 2032 3e2f 6465 762f 6e75 6c6c  shrc 2>/dev/null
+00016ba0: 207c 7c20 7b20 6563 686f 2027 5041 5448   || { echo 'PATH
+00016bb0: 3d22 2448 4f4d 452f 2e6c 6f63 616c 2f62  ="$HOME/.local/b
+00016bc0: 696e 3a24 5041 5448 2227 203e 3e20 7e2f  in:$PATH"' >> ~/
+00016bd0: 2e62 6173 6872 6320 2626 202e 207e 2f2e  .bashrc && . ~/.
+00016be0: 6261 7368 7263 3b20 7d3b 207d 0a65 6368  bashrc; }; }.ech
+00016bf0: 6f20 243f 0a60 6060 0a0a 6166 7465 7220  o $?.```..after 
+00016c00: 7468 6520 696e 6974 6961 6c20 7365 7475  the initial setu
+00016c10: 702c 2079 6f75 2063 616e 206c 6175 6e63  p, you can launc
+00016c20: 6820 636f 7079 7061 7274 7920 6174 2061  h copyparty at a
+00016c30: 6e79 2074 696d 6520 6279 2072 756e 6e69  ny time by runni
+00016c40: 6e67 2060 636f 7079 7061 7274 7960 2061  ng `copyparty` a
+00016c50: 6e79 7768 6572 6520 696e 2054 6572 6d75  nywhere in Termu
+00016c60: 7820 2d2d 2061 6e64 2069 6620 796f 7520  x -- and if you 
+00016c70: 7275 6e20 6974 2077 6974 6820 602d 2d71  run it with `--q
+00016c80: 7260 2079 6f75 276c 6c20 6765 7420 6120  r` you'll get a 
+00016c90: 5b6e 6561 7420 7172 2d63 6f64 655d 2823  [neat qr-code](#
+00016ca0: 7172 2d63 6f64 6529 2070 6f69 6e74 696e  qr-code) pointin
+00016cb0: 6720 746f 2079 6f75 7220 6578 7465 726e  g to your extern
+00016cc0: 616c 2069 700a 0a69 6620 796f 7520 7761  al ip..if you wa
+00016cd0: 6e74 2074 6875 6d62 6e61 696c 7320 2870  nt thumbnails (p
+00016ce0: 686f 746f 732b 7669 6465 6f73 2920 616e  hotos+videos) an
+00016cf0: 6420 796f 7527 7265 206f 6b61 7920 7769  d you're okay wi
+00016d00: 7468 2073 7065 6e64 696e 6720 616e 6f74  th spending anot
+00016d10: 6865 7220 3133 3220 4d69 4220 6f66 2073  her 132 MiB of s
+00016d20: 746f 7261 6765 2c20 6070 6b67 2069 6e73  torage, `pkg ins
+00016d30: 7461 6c6c 2066 666d 7065 6720 2626 2070  tall ffmpeg && p
+00016d40: 7974 686f 6e33 202d 6d20 7069 7020 696e  ython3 -m pip in
+00016d50: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
+00016d60: 7069 6c6c 6f77 600a 0a2a 206f 7220 6966  pillow`..* or if
+00016d70: 2079 6f75 2077 616e 7420 746f 2075 7365   you want to use
+00016d80: 2060 7669 7073 6020 666f 7220 7068 6f74   `vips` for phot
+00016d90: 6f2d 7468 756d 6273 2069 6e73 7465 6164  o-thumbs instead
+00016da0: 2c20 6070 6b67 2069 6e73 7461 6c6c 206c  , `pkg install l
+00016db0: 6962 7669 7073 2026 2620 7079 7468 6f6e  ibvips && python
+00016dc0: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
+00016dd0: 2d2d 7573 6572 202d 5520 7768 6565 6c20  --user -U wheel 
+00016de0: 2626 2070 7974 686f 6e20 2d6d 2070 6970  && python -m pip
+00016df0: 2069 6e73 7461 6c6c 202d 2d75 7365 7220   install --user 
+00016e00: 2d55 2070 7976 6970 7320 2626 2028 6364  -U pyvips && (cd
+00016e10: 202f 6461 7461 2f64 6174 612f 636f 6d2e   /data/data/com.
+00016e20: 7465 726d 7578 2f66 696c 6573 2f75 7372  termux/files/usr
+00016e30: 2f6c 6962 2f3b 206c 6e20 2d73 206c 6962  /lib/; ln -s lib
+00016e40: 676f 626a 6563 742d 322e 302e 736f 7b2c  gobject-2.0.so{,
+00016e50: 2e30 7d3b 206c 6e20 2d73 206c 6962 7669  .0}; ln -s libvi
+00016e60: 7073 2e73 6f7b 2c2e 3432 7d29 600a 0a0a  ps.so{,.42})`...
+00016e70: 2320 7265 706f 7274 696e 6720 6275 6773  # reporting bugs
+00016e80: 0a0a 6964 6561 7320 666f 7220 636f 6e74  ..ideas for cont
+00016e90: 6578 7420 746f 2069 6e63 6c75 6465 2069  ext to include i
+00016ea0: 6e20 6275 6720 7265 706f 7274 730a 0a69  n bug reports..i
+00016eb0: 6e20 6765 6e65 7261 6c2c 2063 6f6d 6d61  n general, comma
+00016ec0: 6e64 6c69 6e65 2061 7267 756d 656e 7473  ndline arguments
+00016ed0: 2028 616e 6420 636f 6e66 6967 2066 696c   (and config fil
+00016ee0: 6520 6966 2061 6e79 290a 0a69 6620 736f  e if any)..if so
+00016ef0: 6d65 7468 696e 6720 6272 6f6b 6520 6475  mething broke du
+00016f00: 7269 6e67 2061 6e20 7570 6c6f 6164 2028  ring an upload (
+00016f10: 7265 706c 6163 696e 6720 4649 4c45 4e41  replacing FILENA
+00016f20: 4d45 2077 6974 6820 6120 7061 7274 206f  ME with a part o
+00016f30: 6620 7468 6520 6669 6c65 6e61 6d65 2074  f the filename t
+00016f40: 6861 7420 6272 6f6b 6529 3a0a 6060 600a  hat broke):.```.
+00016f50: 6a6f 7572 6e61 6c63 746c 202d 6153 2027  journalctl -aS '
+00016f60: 3438 2068 6f75 7220 6167 6f27 202d 7520  48 hour ago' -u 
+00016f70: 636f 7079 7061 7274 7920 7c20 6772 6570  copyparty | grep
+00016f80: 202d 4331 3020 4649 4c45 4e41 4d45 207c   -C10 FILENAME |
+00016f90: 2074 6565 2062 7567 2e6c 6f67 0a60 6060   tee bug.log.```
+00016fa0: 0a0a 6966 2074 6865 7265 2773 2061 2077  ..if there's a w
+00016fb0: 616c 6c20 6f66 2062 6173 6536 3420 696e  all of base64 in
+00016fc0: 2074 6865 206c 6f67 2028 7468 7265 6164   the log (thread
+00016fd0: 2073 7461 636b 7329 2074 6865 6e20 706c   stacks) then pl
+00016fe0: 6561 7365 2069 6e63 6c75 6465 2074 6861  ease include tha
+00016ff0: 742c 2065 7370 6563 6961 6c6c 7920 6966  t, especially if
+00017000: 2079 6f75 2072 756e 2069 6e74 6f20 736f   you run into so
+00017010: 6d65 7468 696e 6720 6672 6565 7a69 6e67  mething freezing
+00017020: 2075 7020 6f72 2067 6574 7469 6e67 2073   up or getting s
+00017030: 7475 636b 2c20 666f 7220 6578 616d 706c  tuck, for exampl
+00017040: 6520 604f 7065 7261 7469 6f6e 616c 4572  e `OperationalEr
+00017050: 726f 7228 2764 6174 6162 6173 6520 6973  ror('database is
+00017060: 206c 6f63 6b65 6427 2960 202d 2d20 616c   locked')` -- al
+00017070: 7465 726e 6174 6976 656c 7920 796f 7520  ternatively you 
+00017080: 6361 6e20 7669 7369 7420 602f 3f73 7461  can visit `/?sta
+00017090: 636b 6020 746f 2073 6565 2074 6865 2073  ck` to see the s
+000170a0: 7461 636b 7320 6c69 7665 2c20 736f 2068  tacks live, so h
+000170b0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+000170c0: 3339 3233 2f3f 7374 6163 6b20 666f 7220  3923/?stack for 
+000170d0: 6578 616d 706c 650a 0a0a 2320 6465 766e  example...# devn
+000170e0: 6f74 6573 0a0a 666f 7220 6275 696c 6420  otes..for build 
+000170f0: 696e 7374 7275 6374 696f 6e73 2065 7463  instructions etc
+00017100: 2c20 7365 6520 5b2e 2f64 6f63 732f 6465  , see [./docs/de
+00017110: 766e 6f74 6573 2e6d 645d 282e 2f64 6f63  vnotes.md](./doc
+00017120: 732f 6465 766e 6f74 6573 2e6d 6429 0a    s/devnotes.md).
```

### Comparing `copyparty-1.6.9/README.md` & `copyparty-1.7.0/copyparty.egg-info/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,5056 +1,5907 @@
-00000000: 2320 f09f 92be f09f 8e89 2063 6f70 7970  # ........ copyp
-00000010: 6172 7479 0a0a 2a20 706f 7274 6162 6c65  arty..* portable
-00000020: 2066 696c 6520 7368 6172 696e 6720 6875   file sharing hu
-00000030: 6220 2870 7932 2f70 7933 2920 5b28 6f6e  b (py2/py3) [(on
-00000040: 2050 7950 4929 5d28 6874 7470 733a 2f2f   PyPI)](https://
-00000050: 7079 7069 2e6f 7267 2f70 726f 6a65 6374  pypi.org/project
-00000060: 2f63 6f70 7970 6172 7479 2f29 0a2a 204d  /copyparty/).* M
-00000070: 4954 2d4c 6963 656e 7365 642c 2032 3031  IT-Licensed, 201
-00000080: 392d 3035 2d32 362c 2065 6420 4020 6972  9-05-26, ed @ ir
-00000090: 632e 7269 7a6f 6e2e 6e65 740a 0a0a 2323  c.rizon.net...##
-000000a0: 2073 756d 6d61 7279 0a0a 7475 726e 2079   summary..turn y
-000000b0: 6f75 7220 7068 6f6e 6520 6f72 2072 6173  our phone or ras
-000000c0: 7069 2069 6e74 6f20 6120 706f 7274 6162  pi into a portab
-000000d0: 6c65 2066 696c 6520 7365 7276 6572 2077  le file server w
-000000e0: 6974 6820 7265 7375 6d61 626c 6520 7570  ith resumable up
-000000f0: 6c6f 6164 732f 646f 776e 6c6f 6164 7320  loads/downloads 
-00000100: 7573 696e 6720 2a61 6e79 2a20 7765 6220  using *any* web 
-00000110: 6272 6f77 7365 720a 0a2a 2073 6572 7665  browser..* serve
-00000120: 7220 6f6e 6c79 206e 6565 6473 2050 7974  r only needs Pyt
-00000130: 686f 6e20 2860 322e 3760 206f 7220 6033  hon (`2.7` or `3
-00000140: 2e33 2b60 292c 2061 6c6c 2064 6570 656e  .3+`), all depen
-00000150: 6465 6e63 6965 7320 6f70 7469 6f6e 616c  dencies optional
-00000160: 0a2a 2062 726f 7773 652f 7570 6c6f 6164  .* browse/upload
-00000170: 2077 6974 6820 5b49 4534 5d28 2362 726f   with [IE4](#bro
-00000180: 7773 6572 2d73 7570 706f 7274 2920 2f20  wser-support) / 
-00000190: 6e65 7473 6361 7065 342e 3020 6f6e 2077  netscape4.0 on w
-000001a0: 696e 332e 3131 2028 6865 6829 0a2a 2070  in3.11 (heh).* p
-000001b0: 726f 746f 636f 6c73 3a20 5b68 7474 705d  rotocols: [http]
-000001c0: 2823 7468 652d 6272 6f77 7365 7229 202f  (#the-browser) /
-000001d0: 2f20 5b66 7470 5d28 2366 7470 2d73 6572  / [ftp](#ftp-ser
-000001e0: 7665 7229 202f 2f20 5b77 6562 6461 765d  ver) // [webdav]
-000001f0: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
-00000200: 202f 2f20 5b73 6d62 2f63 6966 735d 2823   // [smb/cifs](#
-00000210: 736d 622d 7365 7276 6572 290a 0a2a 2a5b  smb-server)..**[
-00000220: 4765 7420 7374 6172 7465 645d 2823 7175  Get started](#qu
-00000230: 6963 6b73 7461 7274 2921 2a2a 206f 7220  ickstart)!** or 
-00000240: 7669 7369 7420 7468 6520 2a2a 5b72 6561  visit the **[rea
-00000250: 642d 6f6e 6c79 2064 656d 6f20 7365 7276  d-only demo serv
-00000260: 6572 5d28 6874 7470 733a 2f2f 612e 6f63  er](https://a.oc
-00000270: 762e 6d65 2f70 7562 2f64 656d 6f2f 292a  v.me/pub/demo/)*
-00000280: 2a20 f09f 9180 2072 756e 6e69 6e67 2066  * .... running f
-00000290: 726f 6d20 6120 6261 7365 6d65 6e74 2069  rom a basement i
-000002a0: 6e20 6669 6e6c 616e 640a 0af0 9f93 b720  n finland...... 
-000002b0: 2a2a 7363 7265 656e 7368 6f74 733a 2a2a  **screenshots:**
-000002c0: 205b 6272 6f77 7365 725d 2823 7468 652d   [browser](#the-
-000002d0: 6272 6f77 7365 7229 202f 2f20 5b75 706c  browser) // [upl
-000002e0: 6f61 645d 2823 7570 6c6f 6164 696e 6729  oad](#uploading)
-000002f0: 202f 2f20 5b75 6e70 6f73 745d 2823 756e   // [unpost](#un
-00000300: 706f 7374 2920 2f2f 205b 7468 756d 626e  post) // [thumbn
-00000310: 6169 6c73 5d28 2374 6875 6d62 6e61 696c  ails](#thumbnail
-00000320: 7329 202f 2f20 5b73 6561 7263 685d 2823  s) // [search](#
-00000330: 7365 6172 6368 696e 6729 202f 2f20 5b66  searching) // [f
-00000340: 7365 6172 6368 5d28 2366 696c 652d 7365  search](#file-se
-00000350: 6172 6368 2920 2f2f 205b 7a69 702d 444c  arch) // [zip-DL
-00000360: 5d28 237a 6970 2d64 6f77 6e6c 6f61 6473  ](#zip-downloads
-00000370: 2920 2f2f 205b 6d64 2d76 6965 7765 725d  ) // [md-viewer]
-00000380: 2823 6d61 726b 646f 776e 2d76 6965 7765  (#markdown-viewe
-00000390: 7229 0a0a 0a23 2320 6765 7420 7468 6520  r)...## get the 
-000003a0: 6170 700a 0a3c 6120 6872 6566 3d22 6874  app..<a href="ht
-000003b0: 7470 733a 2f2f 662d 6472 6f69 642e 6f72  tps://f-droid.or
-000003c0: 672f 7061 636b 6167 6573 2f6d 652e 6f63  g/packages/me.oc
-000003d0: 762e 7061 7274 7975 702f 223e 3c69 6d67  v.partyup/"><img
-000003e0: 2073 7263 3d22 6874 7470 733a 2f2f 6f63   src="https://oc
-000003f0: 762e 6d65 2f66 6472 6f69 642e 706e 6722  v.me/fdroid.png"
-00000400: 2061 6c74 3d22 4765 7420 6974 206f 6e20   alt="Get it on 
-00000410: 462d 4472 6f69 6422 2068 6569 6768 743d  F-Droid" height=
-00000420: 2235 3022 202f 3e20 2727 203c 696d 6720  "50" /> '' <img 
-00000430: 7372 633d 2268 7474 7073 3a2f 2f69 6d67  src="https://img
-00000440: 2e73 6869 656c 6473 2e69 6f2f 662d 6472  .shields.io/f-dr
-00000450: 6f69 642f 762f 6d65 2e6f 6376 2e70 6172  oid/v/me.ocv.par
-00000460: 7479 7570 2e73 7667 2220 616c 743d 2266  tyup.svg" alt="f
-00000470: 2d64 726f 6964 2076 6572 7369 6f6e 2069  -droid version i
-00000480: 6e66 6f22 202f 3e3c 2f61 3e20 2727 203c  nfo" /></a> '' <
-00000490: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
-000004a0: 6769 7468 7562 2e63 6f6d 2f39 3030 312f  github.com/9001/
-000004b0: 7061 7274 792d 7570 223e 3c69 6d67 2073  party-up"><img s
-000004c0: 7263 3d22 6874 7470 733a 2f2f 696d 672e  rc="https://img.
-000004d0: 7368 6965 6c64 732e 696f 2f67 6974 6875  shields.io/githu
-000004e0: 622f 7265 6c65 6173 652f 3930 3031 2f70  b/release/9001/p
-000004f0: 6172 7479 2d75 702e 7376 673f 6c6f 676f  arty-up.svg?logo
-00000500: 3d67 6974 6875 6222 2061 6c74 3d22 6769  =github" alt="gi
-00000510: 7468 7562 2076 6572 7369 6f6e 2069 6e66  thub version inf
-00000520: 6f22 202f 3e3c 2f61 3e0a 0a28 7468 6520  o" /></a>..(the 
-00000530: 6170 7020 6973 202a 2a4e 4f54 2a2a 2074  app is **NOT** t
-00000540: 6865 2066 756c 6c20 636f 7079 7061 7274  he full copypart
-00000550: 7920 7365 7276 6572 2120 6a75 7374 2061  y server! just a
-00000560: 2062 6173 6963 2075 706c 6f61 6420 636c   basic upload cl
-00000570: 6965 6e74 2c20 6e6f 7468 696e 6720 6661  ient, nothing fa
-00000580: 6e63 7920 7965 7429 0a0a 0a23 2320 7265  ncy yet)...## re
-00000590: 6164 6d65 2074 6f63 0a0a 2a20 746f 700a  adme toc..* top.
-000005a0: 2020 2020 2a20 5b71 7569 636b 7374 6172      * [quickstar
-000005b0: 745d 2823 7175 6963 6b73 7461 7274 2920  t](#quickstart) 
-000005c0: 2d20 6a75 7374 2072 756e 202a 2a5b 636f  - just run **[co
-000005d0: 7079 7061 7274 792d 7366 782e 7079 5d28  pyparty-sfx.py](
-000005e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000005f0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-00000600: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
-00000610: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
-00000620: 6172 7479 2d73 6678 2e70 7929 2a2a 202d  arty-sfx.py)** -
-00000630: 2d20 7468 6174 2773 2069 7421 20f0 9f8e  - that's it! ...
-00000640: 890a 2020 2020 2020 2020 2a20 5b6f 6e20  ..        * [on 
-00000650: 7365 7276 6572 735d 2823 6f6e 2d73 6572  servers](#on-ser
-00000660: 7665 7273 2920 2d20 796f 7520 6d61 7920  vers) - you may 
-00000670: 616c 736f 2077 616e 7420 7468 6573 652c  also want these,
-00000680: 2065 7370 6563 6961 6c6c 7920 6f6e 2073   especially on s
-00000690: 6572 7665 7273 0a20 2020 202a 205b 6665  ervers.    * [fe
-000006a0: 6174 7572 6573 5d28 2366 6561 7475 7265  atures](#feature
-000006b0: 7329 0a20 2020 202a 205b 7465 7374 696d  s).    * [testim
-000006c0: 6f6e 6961 6c73 5d28 2374 6573 7469 6d6f  onials](#testimo
-000006d0: 6e69 616c 7329 202d 2073 6d61 6c6c 2063  nials) - small c
-000006e0: 6f6c 6c65 6374 696f 6e20 6f66 2075 7365  ollection of use
-000006f0: 7220 6665 6564 6261 636b 0a2a 205b 6d6f  r feedback.* [mo
-00000700: 7469 7661 7469 6f6e 735d 2823 6d6f 7469  tivations](#moti
-00000710: 7661 7469 6f6e 7329 202d 2070 726f 6a65  vations) - proje
-00000720: 6374 2067 6f61 6c73 202f 2070 6869 6c6f  ct goals / philo
-00000730: 736f 7068 790a 2020 2020 2a20 5b6e 6f74  sophy.    * [not
-00000740: 6573 5d28 236e 6f74 6573 2920 2d20 6765  es](#notes) - ge
-00000750: 6e65 7261 6c20 6e6f 7465 730a 2a20 5b62  neral notes.* [b
-00000760: 7567 735d 2823 6275 6773 290a 2020 2020  ugs](#bugs).    
-00000770: 2a20 5b67 656e 6572 616c 2062 7567 735d  * [general bugs]
-00000780: 2823 6765 6e65 7261 6c2d 6275 6773 290a  (#general-bugs).
-00000790: 2020 2020 2a20 5b6e 6f74 206d 7920 6275      * [not my bu
-000007a0: 6773 5d28 236e 6f74 2d6d 792d 6275 6773  gs](#not-my-bugs
-000007b0: 290a 2a20 5b62 7265 616b 696e 6720 6368  ).* [breaking ch
-000007c0: 616e 6765 735d 2823 6272 6561 6b69 6e67  anges](#breaking
-000007d0: 2d63 6861 6e67 6573 2920 2d20 7570 6772  -changes) - upgr
-000007e0: 6164 6520 6e6f 7465 730a 2a20 5b46 4151  ade notes.* [FAQ
-000007f0: 5d28 2346 4151 2920 2d20 2266 7265 7175  ](#FAQ) - "frequ
-00000800: 656e 746c 7922 2061 736b 6564 2071 7565  ently" asked que
-00000810: 7374 696f 6e73 0a2a 205b 6163 636f 756e  stions.* [accoun
-00000820: 7473 2061 6e64 2076 6f6c 756d 6573 5d28  ts and volumes](
-00000830: 2361 6363 6f75 6e74 732d 616e 642d 766f  #accounts-and-vo
-00000840: 6c75 6d65 7329 202d 2070 6572 2d66 6f6c  lumes) - per-fol
-00000850: 6465 722c 2070 6572 2d75 7365 7220 7065  der, per-user pe
-00000860: 726d 6973 7369 6f6e 730a 2020 2020 2a20  rmissions.    * 
-00000870: 5b73 6861 646f 7769 6e67 5d28 2373 6861  [shadowing](#sha
-00000880: 646f 7769 6e67 2920 2d20 6869 6469 6e67  dowing) - hiding
-00000890: 2073 7065 6369 6669 6320 7375 6266 6f6c   specific subfol
-000008a0: 6465 7273 0a2a 205b 7468 6520 6272 6f77  ders.* [the brow
-000008b0: 7365 725d 2823 7468 652d 6272 6f77 7365  ser](#the-browse
-000008c0: 7229 202d 2061 6363 6573 7369 6e67 2061  r) - accessing a
-000008d0: 2063 6f70 7970 6172 7479 2073 6572 7665   copyparty serve
-000008e0: 7220 7573 696e 6720 6120 7765 622d 6272  r using a web-br
-000008f0: 6f77 7365 720a 2020 2020 2a20 5b74 6162  owser.    * [tab
-00000900: 735d 2823 7461 6273 2920 2d20 7468 6520  s](#tabs) - the 
-00000910: 6d61 696e 2074 6162 7320 696e 2074 6865  main tabs in the
-00000920: 2075 690a 2020 2020 2a20 5b68 6f74 6b65   ui.    * [hotke
-00000930: 7973 5d28 2368 6f74 6b65 7973 2920 2d20  ys](#hotkeys) - 
-00000940: 7468 6520 6272 6f77 7365 7220 6861 7320  the browser has 
-00000950: 7468 6520 666f 6c6c 6f77 696e 6720 686f  the following ho
-00000960: 746b 6579 730a 2020 2020 2a20 5b6e 6176  tkeys.    * [nav
-00000970: 7061 6e65 5d28 236e 6176 7061 6e65 2920  pane](#navpane) 
-00000980: 2d20 7377 6974 6368 696e 6720 6265 7477  - switching betw
-00000990: 6565 6e20 6272 6561 6463 7275 6d62 7320  een breadcrumbs 
-000009a0: 6f72 206e 6176 7061 6e65 0a20 2020 202a  or navpane.    *
-000009b0: 205b 7468 756d 626e 6169 6c73 5d28 2374   [thumbnails](#t
-000009c0: 6875 6d62 6e61 696c 7329 202d 2070 7265  humbnails) - pre
-000009d0: 7373 2060 6760 206f 7220 60e7 94b0 6020  ss `g` or `...` 
-000009e0: 746f 2074 6f67 676c 6520 6772 6964 2d76  to toggle grid-v
-000009f0: 6965 7720 696e 7374 6561 6420 6f66 2074  iew instead of t
-00000a00: 6865 2066 696c 6520 6c69 7374 696e 670a  he file listing.
-00000a10: 2020 2020 2a20 5b7a 6970 2064 6f77 6e6c      * [zip downl
-00000a20: 6f61 6473 5d28 237a 6970 2d64 6f77 6e6c  oads](#zip-downl
-00000a30: 6f61 6473 2920 2d20 646f 776e 6c6f 6164  oads) - download
-00000a40: 2066 6f6c 6465 7273 2028 6f72 2066 696c   folders (or fil
-00000a50: 6520 7365 6c65 6374 696f 6e73 2920 6173  e selections) as
-00000a60: 2060 7a69 7060 206f 7220 6074 6172 6020   `zip` or `tar` 
-00000a70: 6669 6c65 730a 2020 2020 2a20 5b75 706c  files.    * [upl
-00000a80: 6f61 6469 6e67 5d28 2375 706c 6f61 6469  oading](#uploadi
-00000a90: 6e67 2920 2d20 6472 6167 2066 696c 6573  ng) - drag files
-00000aa0: 2f66 6f6c 6465 7273 2069 6e74 6f20 7468  /folders into th
-00000ab0: 6520 7765 622d 6272 6f77 7365 7220 746f  e web-browser to
-00000ac0: 2075 706c 6f61 640a 2020 2020 2020 2020   upload.        
-00000ad0: 2a20 5b66 696c 652d 7365 6172 6368 5d28  * [file-search](
-00000ae0: 2366 696c 652d 7365 6172 6368 2920 2d20  #file-search) - 
-00000af0: 6472 6f70 7069 6e67 2066 696c 6573 2069  dropping files i
-00000b00: 6e74 6f20 7468 6520 6272 6f77 7365 7220  nto the browser 
-00000b10: 616c 736f 206c 6574 7320 796f 7520 7365  also lets you se
-00000b20: 6520 6966 2074 6865 7920 6578 6973 7420  e if they exist 
-00000b30: 6f6e 2074 6865 2073 6572 7665 720a 2020  on the server.  
-00000b40: 2020 2020 2020 2a20 5b75 6e70 6f73 745d        * [unpost]
-00000b50: 2823 756e 706f 7374 2920 2d20 756e 646f  (#unpost) - undo
-00000b60: 2f64 656c 6574 6520 6163 6369 6465 6e74  /delete accident
-00000b70: 616c 2075 706c 6f61 6473 0a20 2020 2020  al uploads.     
-00000b80: 2020 202a 205b 7365 6c66 2d64 6573 7472     * [self-destr
-00000b90: 7563 745d 2823 7365 6c66 2d64 6573 7472  uct](#self-destr
-00000ba0: 7563 7429 202d 2075 706c 6f61 6473 2063  uct) - uploads c
-00000bb0: 616e 2062 6520 6769 7665 6e20 6120 6c69  an be given a li
-00000bc0: 6665 7469 6d65 0a20 2020 202a 205b 6669  fetime.    * [fi
-00000bd0: 6c65 206d 616e 6167 6572 5d28 2366 696c  le manager](#fil
-00000be0: 652d 6d61 6e61 6765 7229 202d 2063 7574  e-manager) - cut
-00000bf0: 2f70 6173 7465 2c20 7265 6e61 6d65 2c20  /paste, rename, 
-00000c00: 616e 6420 6465 6c65 7465 2066 696c 6573  and delete files
-00000c10: 2f66 6f6c 6465 7273 2028 6966 2079 6f75  /folders (if you
-00000c20: 2068 6176 6520 7065 726d 6973 7369 6f6e   have permission
-00000c30: 290a 2020 2020 2a20 5b62 6174 6368 2072  ).    * [batch r
-00000c40: 656e 616d 655d 2823 6261 7463 682d 7265  ename](#batch-re
-00000c50: 6e61 6d65 2920 2d20 7365 6c65 6374 2073  name) - select s
-00000c60: 6f6d 6520 6669 6c65 7320 616e 6420 7072  ome files and pr
-00000c70: 6573 7320 6046 3260 2074 6f20 6272 696e  ess `F2` to brin
-00000c80: 6720 7570 2074 6865 2072 656e 616d 6520  g up the rename 
-00000c90: 5549 0a20 2020 202a 205b 6d61 726b 646f  UI.    * [markdo
-00000ca0: 776e 2076 6965 7765 725d 2823 6d61 726b  wn viewer](#mark
-00000cb0: 646f 776e 2d76 6965 7765 7229 202d 2061  down-viewer) - a
-00000cc0: 6e64 2074 6865 7265 2061 7265 202a 7477  nd there are *tw
-00000cd0: 6f2a 2065 6469 746f 7273 0a20 2020 202a  o* editors.    *
-00000ce0: 205b 6f74 6865 7220 7472 6963 6b73 5d28   [other tricks](
-00000cf0: 236f 7468 6572 2d74 7269 636b 7329 0a20  #other-tricks). 
-00000d00: 2020 202a 205b 7365 6172 6368 696e 675d     * [searching]
-00000d10: 2823 7365 6172 6368 696e 6729 202d 2073  (#searching) - s
-00000d20: 6561 7263 6820 6279 2073 697a 652c 2064  earch by size, d
-00000d30: 6174 652c 2070 6174 682f 6e61 6d65 2c20  ate, path/name, 
-00000d40: 6d70 332d 7461 6773 2c20 2e2e 2e0a 2a20  mp3-tags, ....* 
-00000d50: 5b73 6572 7665 7220 636f 6e66 6967 5d28  [server config](
-00000d60: 2373 6572 7665 722d 636f 6e66 6967 2920  #server-config) 
-00000d70: 2d20 7573 696e 6720 6172 6775 6d65 6e74  - using argument
-00000d80: 7320 6f72 2063 6f6e 6669 6720 6669 6c65  s or config file
-00000d90: 732c 206f 7220 6120 6d69 7820 6f66 2062  s, or a mix of b
-00000da0: 6f74 680a 2020 2020 2a20 5b7a 6572 6f63  oth.    * [zeroc
-00000db0: 6f6e 665d 2823 7a65 726f 636f 6e66 2920  onf](#zeroconf) 
-00000dc0: 2d20 616e 6e6f 756e 6365 2065 6e61 626c  - announce enabl
-00000dd0: 6564 2073 6572 7669 6365 7320 6f6e 2074  ed services on t
-00000de0: 6865 204c 414e 2028 5b70 6963 5d28 6874  he LAN ([pic](ht
-00000df0: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-00000e00: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-00000e10: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
-00000e20: 3135 3334 3437 3337 2d30 6561 6538 6439  15344737-0eae8d9
-00000e30: 382d 3934 3936 2d34 3235 362d 3961 6138  8-9496-4256-9aa8
-00000e40: 2d63 6432 6636 3937 3138 3130 642e 706e  -cd2f6971810d.pn
-00000e50: 6729 290a 2020 2020 2020 2020 2a20 5b6d  g)).        * [m
-00000e60: 646e 735d 2823 6d64 6e73 2920 2d20 4c41  dns](#mdns) - LA
-00000e70: 4e20 646f 6d61 696e 2d6e 616d 6520 616e  N domain-name an
-00000e80: 6420 6665 6174 7572 6520 616e 6e6f 756e  d feature announ
-00000e90: 6365 720a 2020 2020 2020 2020 2a20 5b73  cer.        * [s
-00000ea0: 7364 705d 2823 7373 6470 2920 2d20 7769  sdp](#ssdp) - wi
-00000eb0: 6e64 6f77 732d 6578 706c 6f72 6572 2061  ndows-explorer a
-00000ec0: 6e6e 6f75 6e63 6572 0a20 2020 202a 205b  nnouncer.    * [
-00000ed0: 7172 2d63 6f64 655d 2823 7172 2d63 6f64  qr-code](#qr-cod
-00000ee0: 6529 202d 2070 7269 6e74 2061 2071 722d  e) - print a qr-
-00000ef0: 636f 6465 205b 2873 6372 6565 6e73 686f  code [(screensho
-00000f00: 7429 5d28 6874 7470 733a 2f2f 7573 6572  t)](https://user
-00000f10: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00000f20: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-00000f30: 3130 3332 2f31 3934 3732 3835 3333 2d36  1032/194728533-6
-00000f40: 6630 3038 3439 622d 6336 6163 2d34 3363  f00849b-c6ac-43c
-00000f50: 362d 3933 3539 2d38 3365 3435 3464 3131  6-9359-83e454d11
-00000f60: 6530 302e 706e 6729 2066 6f72 2071 7569  e00.png) for qui
-00000f70: 636b 2061 6363 6573 730a 2020 2020 2a20  ck access.    * 
-00000f80: 5b66 7470 2073 6572 7665 725d 2823 6674  [ftp server](#ft
-00000f90: 702d 7365 7276 6572 2920 2d20 616e 2046  p-server) - an F
-00000fa0: 5450 2073 6572 7665 7220 6361 6e20 6265  TP server can be
-00000fb0: 2073 7461 7274 6564 2075 7369 6e67 2060   started using `
-00000fc0: 2d2d 6674 7020 3339 3231 600a 2020 2020  --ftp 3921`.    
-00000fd0: 2a20 5b77 6562 6461 7620 7365 7276 6572  * [webdav server
-00000fe0: 5d28 2377 6562 6461 762d 7365 7276 6572  ](#webdav-server
-00000ff0: 2920 2d20 7769 7468 2072 6561 642d 7772  ) - with read-wr
-00001000: 6974 6520 7375 7070 6f72 740a 2020 2020  ite support.    
-00001010: 2020 2020 2a20 5b63 6f6e 6e65 6374 696e      * [connectin
-00001020: 6720 746f 2077 6562 6461 7620 6672 6f6d  g to webdav from
-00001030: 2077 696e 646f 7773 5d28 2363 6f6e 6e65   windows](#conne
-00001040: 6374 696e 672d 746f 2d77 6562 6461 762d  cting-to-webdav-
-00001050: 6672 6f6d 2d77 696e 646f 7773 2920 2d20  from-windows) - 
-00001060: 7573 696e 6720 7468 6520 4755 490a 2020  using the GUI.  
-00001070: 2020 2a20 5b73 6d62 2073 6572 7665 725d    * [smb server]
-00001080: 2823 736d 622d 7365 7276 6572 2920 2d20  (#smb-server) - 
-00001090: 756e 7361 6665 2c20 736c 6f77 2c20 6e6f  unsafe, slow, no
-000010a0: 7420 7265 636f 6d6d 656e 6465 6420 666f  t recommended fo
-000010b0: 7220 7761 6e0a 2020 2020 2a20 5b66 696c  r wan.    * [fil
-000010c0: 6520 696e 6465 7869 6e67 5d28 2366 696c  e indexing](#fil
-000010d0: 652d 696e 6465 7869 6e67 2920 2d20 656e  e-indexing) - en
-000010e0: 6162 6c65 7320 6465 6475 7020 616e 6420  ables dedup and 
-000010f0: 6d75 7369 6320 7365 6172 6368 202b 2b0a  music search ++.
-00001100: 2020 2020 2020 2020 2a20 5b65 7863 6c75          * [exclu
-00001110: 6465 2d70 6174 7465 726e 735d 2823 6578  de-patterns](#ex
-00001120: 636c 7564 652d 7061 7474 6572 6e73 2920  clude-patterns) 
-00001130: 2d20 746f 2073 6176 6520 736f 6d65 2074  - to save some t
-00001140: 696d 650a 2020 2020 2020 2020 2a20 5b66  ime.        * [f
-00001150: 696c 6573 7973 7465 6d20 6775 6172 6473  ilesystem guards
-00001160: 5d28 2366 696c 6573 7973 7465 6d2d 6775  ](#filesystem-gu
-00001170: 6172 6473 2920 2d20 6176 6f69 6420 7472  ards) - avoid tr
-00001180: 6176 6572 7369 6e67 2069 6e74 6f20 6f74  aversing into ot
-00001190: 6865 7220 6669 6c65 7379 7374 656d 730a  her filesystems.
-000011a0: 2020 2020 2020 2020 2a20 5b70 6572 696f          * [perio
-000011b0: 6469 6320 7265 7363 616e 5d28 2370 6572  dic rescan](#per
-000011c0: 696f 6469 632d 7265 7363 616e 2920 2d20  iodic-rescan) - 
-000011d0: 6669 6c65 7379 7374 656d 206d 6f6e 6974  filesystem monit
-000011e0: 6f72 696e 670a 2020 2020 2a20 5b75 706c  oring.    * [upl
-000011f0: 6f61 6420 7275 6c65 735d 2823 7570 6c6f  oad rules](#uplo
-00001200: 6164 2d72 756c 6573 2920 2d20 7365 7420  ad-rules) - set 
-00001210: 7570 6c6f 6164 2072 756c 6573 2075 7369  upload rules usi
-00001220: 6e67 2076 6f6c 666c 6167 730a 2020 2020  ng volflags.    
-00001230: 2a20 5b63 6f6d 7072 6573 7320 7570 6c6f  * [compress uplo
-00001240: 6164 735d 2823 636f 6d70 7265 7373 2d75  ads](#compress-u
-00001250: 706c 6f61 6473 2920 2d20 6669 6c65 7320  ploads) - files 
-00001260: 6361 6e20 6265 2061 7574 6f63 6f6d 7072  can be autocompr
-00001270: 6573 7365 6420 6f6e 2075 706c 6f61 640a  essed on upload.
-00001280: 2020 2020 2a20 5b6f 7468 6572 2066 6c61      * [other fla
-00001290: 6773 5d28 236f 7468 6572 2d66 6c61 6773  gs](#other-flags
-000012a0: 290a 2020 2020 2a20 5b64 6174 6162 6173  ).    * [databas
-000012b0: 6520 6c6f 6361 7469 6f6e 5d28 2364 6174  e location](#dat
-000012c0: 6162 6173 652d 6c6f 6361 7469 6f6e 2920  abase-location) 
-000012d0: 2d20 696e 2d76 6f6c 756d 6520 2860 2e68  - in-volume (`.h
-000012e0: 6973 742f 7570 326b 2e64 6260 2c20 6465  ist/up2k.db`, de
-000012f0: 6661 756c 7429 206f 7220 736f 6d65 7768  fault) or somewh
-00001300: 6572 6520 656c 7365 0a20 2020 202a 205b  ere else.    * [
-00001310: 6d65 7461 6461 7461 2066 726f 6d20 6175  metadata from au
-00001320: 6469 6f20 6669 6c65 735d 2823 6d65 7461  dio files](#meta
-00001330: 6461 7461 2d66 726f 6d2d 6175 6469 6f2d  data-from-audio-
-00001340: 6669 6c65 7329 202d 2073 6574 2060 2d65  files) - set `-e
-00001350: 3274 6020 746f 2069 6e64 6578 2074 6167  2t` to index tag
-00001360: 7320 6f6e 2075 706c 6f61 640a 2020 2020  s on upload.    
-00001370: 2a20 5b66 696c 6520 7061 7273 6572 2070  * [file parser p
-00001380: 6c75 6769 6e73 5d28 2366 696c 652d 7061  lugins](#file-pa
-00001390: 7273 6572 2d70 6c75 6769 6e73 2920 2d20  rser-plugins) - 
-000013a0: 7072 6f76 6964 6520 6375 7374 6f6d 2070  provide custom p
-000013b0: 6172 7365 7273 2074 6f20 696e 6465 7820  arsers to index 
-000013c0: 6164 6469 7469 6f6e 616c 2074 6167 730a  additional tags.
-000013d0: 2020 2020 2a20 5b65 7665 6e74 2068 6f6f      * [event hoo
-000013e0: 6b73 5d28 2365 7665 6e74 2d68 6f6f 6b73  ks](#event-hooks
-000013f0: 2920 2d20 7472 6967 6765 7220 6120 7072  ) - trigger a pr
-00001400: 6f67 7261 6d20 6f6e 2075 706c 6f61 6473  ogram on uploads
-00001410: 2c20 7265 6e61 6d65 7320 6574 6320 285b  , renames etc ([
-00001420: 6578 616d 706c 6573 5d28 2e2f 6269 6e2f  examples](./bin/
-00001430: 686f 6f6b 732f 2929 0a20 2020 2020 2020  hooks/)).       
-00001440: 202a 205b 7570 6c6f 6164 2065 7665 6e74   * [upload event
-00001450: 735d 2823 7570 6c6f 6164 2d65 7665 6e74  s](#upload-event
-00001460: 7329 202d 2074 6865 206f 6c64 6572 2c20  s) - the older, 
-00001470: 6d6f 7265 2070 6f77 6572 6675 6c20 6170  more powerful ap
-00001480: 7072 6f61 6368 2028 5b65 7861 6d70 6c65  proach ([example
-00001490: 735d 282e 2f62 696e 2f6d 7461 672f 2929  s](./bin/mtag/))
-000014a0: 0a20 2020 202a 205b 6869 6469 6e67 2066  .    * [hiding f
-000014b0: 726f 6d20 676f 6f67 6c65 5d28 2368 6964  rom google](#hid
-000014c0: 696e 672d 6672 6f6d 2d67 6f6f 676c 6529  ing-from-google)
-000014d0: 202d 2074 656c 6c20 7365 6172 6368 2065   - tell search e
-000014e0: 6e67 696e 6573 2079 6f75 2064 6f6e 7420  ngines you dont 
-000014f0: 7761 6e6e 6120 6265 2069 6e64 6578 6564  wanna be indexed
-00001500: 0a20 2020 202a 205b 7468 656d 6573 5d28  .    * [themes](
-00001510: 2374 6865 6d65 7329 0a20 2020 202a 205b  #themes).    * [
-00001520: 636f 6d70 6c65 7465 2065 7861 6d70 6c65  complete example
-00001530: 735d 2823 636f 6d70 6c65 7465 2d65 7861  s](#complete-exa
-00001540: 6d70 6c65 7329 0a20 2020 202a 205b 7265  mples).    * [re
-00001550: 7665 7273 652d 7072 6f78 795d 2823 7265  verse-proxy](#re
-00001560: 7665 7273 652d 7072 6f78 7929 202d 2072  verse-proxy) - r
-00001570: 756e 6e69 6e67 2063 6f70 7970 6172 7479  unning copyparty
-00001580: 206e 6578 7420 746f 206f 7468 6572 2077   next to other w
-00001590: 6562 7369 7465 730a 2a20 5b62 726f 7773  ebsites.* [brows
-000015a0: 6572 2073 7570 706f 7274 5d28 2362 726f  er support](#bro
-000015b0: 7773 6572 2d73 7570 706f 7274 2920 2d20  wser-support) - 
-000015c0: 544c 4452 3a20 7965 730a 2a20 5b63 6c69  TLDR: yes.* [cli
-000015d0: 656e 7420 6578 616d 706c 6573 5d28 2363  ent examples](#c
-000015e0: 6c69 656e 742d 6578 616d 706c 6573 2920  lient-examples) 
-000015f0: 2d20 696e 7465 7261 6374 2077 6974 6820  - interact with 
-00001600: 636f 7079 7061 7274 7920 7573 696e 6720  copyparty using 
-00001610: 6e6f 6e2d 6272 6f77 7365 7220 636c 6965  non-browser clie
-00001620: 6e74 730a 2020 2020 2a20 5b6d 6f75 6e74  nts.    * [mount
-00001630: 2061 7320 6472 6976 655d 2823 6d6f 756e   as drive](#moun
-00001640: 742d 6173 2d64 7269 7665 2920 2d20 6120  t-as-drive) - a 
-00001650: 7265 6d6f 7465 2063 6f70 7970 6172 7479  remote copyparty
-00001660: 2073 6572 7665 7220 6173 2061 206c 6f63   server as a loc
-00001670: 616c 2066 696c 6573 7973 7465 6d0a 2a20  al filesystem.* 
-00001680: 5b70 6572 666f 726d 616e 6365 5d28 2370  [performance](#p
-00001690: 6572 666f 726d 616e 6365 2920 2d20 6465  erformance) - de
-000016a0: 6661 756c 7473 2061 7265 2075 7375 616c  faults are usual
-000016b0: 6c79 2066 696e 6520 2d20 6578 7065 6374  ly fine - expect
-000016c0: 2060 3820 4769 422f 7360 2064 6f77 6e6c   `8 GiB/s` downl
-000016d0: 6f61 642c 2060 3120 4769 422f 7360 2075  oad, `1 GiB/s` u
-000016e0: 706c 6f61 640a 2020 2020 2a20 5b63 6c69  pload.    * [cli
-000016f0: 656e 742d 7369 6465 5d28 2363 6c69 656e  ent-side](#clien
-00001700: 742d 7369 6465 2920 2d20 7768 656e 2075  t-side) - when u
-00001710: 706c 6f61 6469 6e67 2066 696c 6573 0a2a  ploading files.*
-00001720: 205b 7365 6375 7269 7479 5d28 2373 6563   [security](#sec
-00001730: 7572 6974 7929 202d 2073 6f6d 6520 6e6f  urity) - some no
-00001740: 7465 7320 6f6e 2068 6172 6465 6e69 6e67  tes on hardening
-00001750: 0a20 2020 202a 205b 676f 7463 6861 735d  .    * [gotchas]
-00001760: 2823 676f 7463 6861 7329 202d 2062 6568  (#gotchas) - beh
-00001770: 6176 696f 7220 7468 6174 206d 6967 6874  avior that might
-00001780: 2062 6520 756e 6578 7065 6374 6564 0a20   be unexpected. 
-00001790: 2020 202a 205b 636f 7273 5d28 2363 6f72     * [cors](#cor
-000017a0: 7329 202d 2063 726f 7373 2d73 6974 6520  s) - cross-site 
-000017b0: 7265 7175 6573 7420 636f 6e66 6967 0a2a  request config.*
-000017c0: 205b 7265 636f 7665 7269 6e67 2066 726f   [recovering fro
-000017d0: 6d20 6372 6173 6865 735d 2823 7265 636f  m crashes](#reco
-000017e0: 7665 7269 6e67 2d66 726f 6d2d 6372 6173  vering-from-cras
-000017f0: 6865 7329 0a20 2020 202a 205b 636c 6965  hes).    * [clie
-00001800: 6e74 2063 7261 7368 6573 5d28 2363 6c69  nt crashes](#cli
-00001810: 656e 742d 6372 6173 6865 7329 0a20 2020  ent-crashes).   
-00001820: 2020 2020 202a 205b 6672 6566 6f78 2077       * [frefox w
-00001830: 736f 645d 2823 6672 6566 6f78 2d77 736f  sod](#frefox-wso
-00001840: 6429 202d 2066 6972 6566 6f78 2038 3720  d) - firefox 87 
-00001850: 6361 6e20 6372 6173 6820 6475 7269 6e67  can crash during
-00001860: 2075 706c 6f61 6473 0a2a 205b 4854 5450   uploads.* [HTTP
-00001870: 2041 5049 5d28 2348 5454 502d 4150 4929   API](#HTTP-API)
-00001880: 202d 2073 6565 205b 6465 766e 6f74 6573   - see [devnotes
-00001890: 5d28 232e 2f64 6f63 732f 6465 766e 6f74  ](#./docs/devnot
-000018a0: 6573 2e6d 6423 6874 7470 2d61 7069 290a  es.md#http-api).
-000018b0: 2a20 5b64 6570 656e 6465 6e63 6965 735d  * [dependencies]
-000018c0: 2823 6465 7065 6e64 656e 6369 6573 2920  (#dependencies) 
-000018d0: 2d20 6d61 6e64 6174 6f72 7920 6465 7073  - mandatory deps
-000018e0: 0a20 2020 202a 205b 6f70 7469 6f6e 616c  .    * [optional
-000018f0: 2064 6570 656e 6465 6e63 6965 735d 2823   dependencies](#
-00001900: 6f70 7469 6f6e 616c 2d64 6570 656e 6465  optional-depende
-00001910: 6e63 6965 7329 202d 2069 6e73 7461 6c6c  ncies) - install
-00001920: 2074 6865 7365 2074 6f20 656e 6162 6c65   these to enable
-00001930: 2062 6f6e 7573 2066 6561 7475 7265 730a   bonus features.
-00001940: 2020 2020 2a20 5b6f 7074 696f 6e61 6c20      * [optional 
-00001950: 6770 6c20 7374 7566 665d 2823 6f70 7469  gpl stuff](#opti
-00001960: 6f6e 616c 2d67 706c 2d73 7475 6666 290a  onal-gpl-stuff).
-00001970: 2a20 5b73 6678 5d28 2373 6678 2920 2d20  * [sfx](#sfx) - 
-00001980: 7468 6520 7365 6c66 2d63 6f6e 7461 696e  the self-contain
-00001990: 6564 2022 6269 6e61 7279 220a 2020 2020  ed "binary".    
-000019a0: 2a20 5b63 6f70 7970 6172 7479 2e65 7865  * [copyparty.exe
-000019b0: 5d28 2363 6f70 7970 6172 7479 6578 6529  ](#copypartyexe)
-000019c0: 202d 2064 6f77 6e6c 6f61 6420 5b63 6f70   - download [cop
-000019d0: 7970 6172 7479 2e65 7865 5d28 6874 7470  yparty.exe](http
-000019e0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
-000019f0: 3030 312f 636f 7079 7061 7274 792f 7265  001/copyparty/re
-00001a00: 6c65 6173 6573 2f6c 6174 6573 742f 646f  leases/latest/do
-00001a10: 776e 6c6f 6164 2f63 6f70 7970 6172 7479  wnload/copyparty
-00001a20: 2e65 7865 2920 2877 696e 382b 2920 6f72  .exe) (win8+) or
-00001a30: 205b 636f 7079 7061 7274 7933 322e 6578   [copyparty32.ex
-00001a40: 655d 2868 7474 7073 3a2f 2f67 6974 6875  e](https://githu
-00001a50: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00001a60: 6172 7479 2f72 656c 6561 7365 732f 6c61  arty/releases/la
-00001a70: 7465 7374 2f64 6f77 6e6c 6f61 642f 636f  test/download/co
-00001a80: 7079 7061 7274 7933 322e 6578 6529 2028  pyparty32.exe) (
-00001a90: 7769 6e37 2b29 0a2a 205b 696e 7374 616c  win7+).* [instal
-00001aa0: 6c20 6f6e 2061 6e64 726f 6964 5d28 2369  l on android](#i
-00001ab0: 6e73 7461 6c6c 2d6f 6e2d 616e 6472 6f69  nstall-on-androi
-00001ac0: 6429 0a2a 205b 7265 706f 7274 696e 6720  d).* [reporting 
-00001ad0: 6275 6773 5d28 2372 6570 6f72 7469 6e67  bugs](#reporting
-00001ae0: 2d62 7567 7329 202d 2069 6465 6173 2066  -bugs) - ideas f
-00001af0: 6f72 2063 6f6e 7465 7874 2074 6f20 696e  or context to in
-00001b00: 636c 7564 6520 696e 2062 7567 2072 6570  clude in bug rep
-00001b10: 6f72 7473 0a2a 205b 6465 766e 6f74 6573  orts.* [devnotes
-00001b20: 5d28 2364 6576 6e6f 7465 7329 202d 2066  ](#devnotes) - f
-00001b30: 6f72 2062 7569 6c64 2069 6e73 7472 7563  or build instruc
-00001b40: 7469 6f6e 7320 6574 632c 2073 6565 205b  tions etc, see [
-00001b50: 2e2f 646f 6373 2f64 6576 6e6f 7465 732e  ./docs/devnotes.
-00001b60: 6d64 5d28 2e2f 646f 6373 2f64 6576 6e6f  md](./docs/devno
-00001b70: 7465 732e 6d64 290a 0a0a 2323 2071 7569  tes.md)...## qui
-00001b80: 636b 7374 6172 740a 0a6a 7573 7420 7275  ckstart..just ru
-00001b90: 6e20 2a2a 5b63 6f70 7970 6172 7479 2d73  n **[copyparty-s
-00001ba0: 6678 2e70 795d 2868 7474 7073 3a2f 2f67  fx.py](https://g
-00001bb0: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
-00001bc0: 6f70 7970 6172 7479 2f72 656c 6561 7365  opyparty/release
-00001bd0: 732f 6c61 7465 7374 2f64 6f77 6e6c 6f61  s/latest/downloa
-00001be0: 642f 636f 7079 7061 7274 792d 7366 782e  d/copyparty-sfx.
-00001bf0: 7079 292a 2a20 2d2d 2074 6861 7427 7320  py)** -- that's 
-00001c00: 6974 2120 f09f 8e89 0a0a 2a20 6f72 2069  it! ......* or i
-00001c10: 6e73 7461 6c6c 2074 6872 6f75 6768 2070  nstall through p
-00001c20: 7970 6920 2870 7974 686f 6e33 206f 6e6c  ypi (python3 onl
-00001c30: 7929 3a20 6070 7974 686f 6e33 202d 6d20  y): `python3 -m 
-00001c40: 7069 7020 696e 7374 616c 6c20 2d2d 7573  pip install --us
-00001c50: 6572 202d 5520 636f 7079 7061 7274 7960  er -U copyparty`
-00001c60: 0a2a 206f 7220 6966 2079 6f75 2063 616e  .* or if you can
-00001c70: 6e6f 7420 696e 7374 616c 6c20 7079 7468  not install pyth
-00001c80: 6f6e 2c20 796f 7520 6361 6e20 7573 6520  on, you can use 
-00001c90: 5b63 6f70 7970 6172 7479 2e65 7865 5d28  [copyparty.exe](
-00001ca0: 2363 6f70 7970 6172 7479 6578 6529 2069  #copypartyexe) i
-00001cb0: 6e73 7465 6164 0a2a 206f 7220 6966 2079  nstead.* or if y
-00001cc0: 6f75 2061 7265 206f 6e20 616e 6472 6f69  ou are on androi
-00001cd0: 642c 205b 696e 7374 616c 6c20 636f 7079  d, [install copy
-00001ce0: 7061 7274 7920 696e 2074 6572 6d75 785d  party in termux]
-00001cf0: 2823 696e 7374 616c 6c2d 6f6e 2d61 6e64  (#install-on-and
-00001d00: 726f 6964 290a 2a20 6f72 2069 6620 796f  roid).* or if yo
-00001d10: 7520 7072 6566 6572 2074 6f20 5b75 7365  u prefer to [use
-00001d20: 2064 6f63 6b65 725d 282e 2f73 6372 6970   docker](./scrip
-00001d30: 7473 2f64 6f63 6b65 722f 2920 f09f 908b  ts/docker/) ....
-00001d40: 2079 6f75 2063 616e 2064 6f20 7468 6174   you can do that
-00001d50: 2074 6f6f 0a20 202a 2064 6f63 6b65 7220   too.  * docker 
-00001d60: 6861 7320 616c 6c20 6465 7073 2062 7569  has all deps bui
-00001d70: 6c74 2d69 6e2c 2073 6f20 736b 6970 2074  lt-in, so skip t
-00001d80: 6869 7320 7374 6570 3a0a 0a65 6e61 626c  his step:..enabl
-00001d90: 6520 7468 756d 626e 6169 6c73 2028 696d  e thumbnails (im
-00001da0: 6167 6573 2f61 7564 696f 2f76 6964 656f  ages/audio/video
-00001db0: 292c 206d 6564 6961 2069 6e64 6578 696e  ), media indexin
-00001dc0: 672c 2061 6e64 2061 7564 696f 2074 7261  g, and audio tra
-00001dd0: 6e73 636f 6469 6e67 2062 7920 696e 7374  nscoding by inst
-00001de0: 616c 6c69 6e67 2073 6f6d 6520 7265 636f  alling some reco
-00001df0: 6d6d 656e 6465 6420 6465 7073 3a0a 0a2a  mmended deps:..*
-00001e00: 202a 2a41 6c70 696e 653a 2a2a 2060 6170   **Alpine:** `ap
-00001e10: 6b20 6164 6420 7079 332d 7069 6c6c 6f77  k add py3-pillow
-00001e20: 2066 666d 7065 6760 0a2a 202a 2a44 6562   ffmpeg`.* **Deb
-00001e30: 6961 6e3a 2a2a 2060 6170 7420 696e 7374  ian:** `apt inst
-00001e40: 616c 6c20 7079 7468 6f6e 332d 7069 6c20  all python3-pil 
-00001e50: 6666 6d70 6567 600a 2a20 2a2a 4665 646f  ffmpeg`.* **Fedo
-00001e60: 7261 3a2a 2a20 6064 6e66 2069 6e73 7461  ra:** `dnf insta
-00001e70: 6c6c 2070 7974 686f 6e33 2d70 696c 6c6f  ll python3-pillo
-00001e80: 7720 6666 6d70 6567 600a 2a20 2a2a 4672  w ffmpeg`.* **Fr
-00001e90: 6565 4253 443a 2a2a 2060 706b 6720 696e  eeBSD:** `pkg in
-00001ea0: 7374 616c 6c20 7079 3339 2d73 716c 6974  stall py39-sqlit
-00001eb0: 6533 2070 7933 392d 7069 6c6c 6f77 2066  e3 py39-pillow f
-00001ec0: 666d 7065 6760 0a2a 202a 2a4d 6163 4f53  fmpeg`.* **MacOS
-00001ed0: 3a2a 2a20 6070 6f72 7420 696e 7374 616c  :** `port instal
-00001ee0: 6c20 7079 2d50 696c 6c6f 7720 6666 6d70  l py-Pillow ffmp
-00001ef0: 6567 600a 2a20 2a2a 4d61 634f 532a 2a20  eg`.* **MacOS** 
-00001f00: 2861 6c74 6572 6e61 7469 7665 293a 2060  (alternative): `
-00001f10: 6272 6577 2069 6e73 7461 6c6c 2070 696c  brew install pil
-00001f20: 6c6f 7720 6666 6d70 6567 600a 2a20 2a2a  low ffmpeg`.* **
-00001f30: 5769 6e64 6f77 733a 2a2a 2060 7079 7468  Windows:** `pyth
-00001f40: 6f6e 202d 6d20 7069 7020 696e 7374 616c  on -m pip instal
-00001f50: 6c20 2d2d 7573 6572 202d 5520 5069 6c6c  l --user -U Pill
-00001f60: 6f77 600a 2020 2a20 696e 7374 616c 6c20  ow`.  * install 
-00001f70: 7079 7468 6f6e 2061 6e64 2066 666d 7065  python and ffmpe
-00001f80: 6720 6d61 6e75 616c 6c79 3b20 646f 206e  g manually; do n
-00001f90: 6f74 2075 7365 2060 7769 6e67 6574 6020  ot use `winget` 
-00001fa0: 6f72 2060 4d69 6372 6f73 6f66 7420 5374  or `Microsoft St
-00001fb0: 6f72 6560 2028 6974 2062 7265 616b 7320  ore` (it breaks 
-00001fc0: 2450 4154 4829 0a20 202a 2063 6f70 7970  $PATH).  * copyp
-00001fd0: 6172 7479 2e65 7865 2063 6f6d 6573 2077  arty.exe comes w
-00001fe0: 6974 6820 6050 696c 6c6f 7760 2061 6e64  ith `Pillow` and
-00001ff0: 206f 6e6c 7920 6e65 6564 7320 6066 666d   only needs `ffm
-00002000: 7065 6760 0a2a 2073 6565 205b 6f70 7469  peg`.* see [opti
-00002010: 6f6e 616c 2064 6570 656e 6465 6e63 6965  onal dependencie
-00002020: 735d 2823 6f70 7469 6f6e 616c 2d64 6570  s](#optional-dep
-00002030: 656e 6465 6e63 6965 7329 2074 6f20 656e  endencies) to en
-00002040: 6162 6c65 2065 7665 6e20 6d6f 7265 2066  able even more f
-00002050: 6561 7475 7265 730a 0a72 756e 6e69 6e67  eatures..running
-00002060: 2063 6f70 7970 6172 7479 2077 6974 686f   copyparty witho
-00002070: 7574 2061 7267 756d 656e 7473 2028 666f  ut arguments (fo
-00002080: 7220 6578 616d 706c 6520 646f 7562 6c65  r example double
-00002090: 636c 6963 6b69 6e67 2069 7420 6f6e 2057  clicking it on W
-000020a0: 696e 646f 7773 2920 7769 6c6c 2067 6976  indows) will giv
-000020b0: 6520 6576 6572 796f 6e65 2072 6561 642f  e everyone read/
-000020c0: 7772 6974 6520 6163 6365 7373 2074 6f20  write access to 
-000020d0: 7468 6520 6375 7272 656e 7420 666f 6c64  the current fold
-000020e0: 6572 3b20 796f 7520 6d61 7920 7761 6e74  er; you may want
-000020f0: 205b 6163 636f 756e 7473 2061 6e64 2076   [accounts and v
-00002100: 6f6c 756d 6573 5d28 2361 6363 6f75 6e74  olumes](#account
-00002110: 732d 616e 642d 766f 6c75 6d65 7329 0a0a  s-and-volumes)..
-00002120: 736f 6d65 2072 6563 6f6d 6d65 6e64 6564  some recommended
-00002130: 206f 7074 696f 6e73 3a0a 2a20 602d 6532   options:.* `-e2
-00002140: 6473 6160 2065 6e61 626c 6573 2067 656e  dsa` enables gen
-00002150: 6572 616c 205b 6669 6c65 2069 6e64 6578  eral [file index
-00002160: 696e 675d 2823 6669 6c65 2d69 6e64 6578  ing](#file-index
-00002170: 696e 6729 0a2a 2060 2d65 3274 7360 2065  ing).* `-e2ts` e
-00002180: 6e61 626c 6573 2061 7564 696f 206d 6574  nables audio met
-00002190: 6164 6174 6120 696e 6465 7869 6e67 2028  adata indexing (
-000021a0: 6e65 6564 7320 6569 7468 6572 2046 4670  needs either FFp
-000021b0: 726f 6265 206f 7220 4d75 7461 6765 6e29  robe or Mutagen)
-000021c0: 0a2a 2060 2d76 202f 6d6e 742f 6d75 7369  .* `-v /mnt/musi
-000021d0: 633a 2f6d 7573 6963 3a72 3a72 772c 666f  c:/music:r:rw,fo
-000021e0: 6f20 2d61 2066 6f6f 3a62 6172 6020 7368  o -a foo:bar` sh
-000021f0: 6172 6573 2060 2f6d 6e74 2f6d 7573 6963  ares `/mnt/music
-00002200: 6020 6173 2060 2f6d 7573 6963 602c 2060  ` as `/music`, `
-00002210: 7260 6561 6461 626c 6520 6279 2061 6e79  r`eadable by any
-00002220: 6f6e 652c 2061 6e64 2072 6561 642d 7772  one, and read-wr
-00002230: 6974 6520 666f 7220 7573 6572 2060 666f  ite for user `fo
-00002240: 6f60 2c20 7061 7373 776f 7264 2060 6261  o`, password `ba
-00002250: 7260 0a20 202a 2072 6570 6c61 6365 2060  r`.  * replace `
-00002260: 3a72 3a72 772c 666f 6f60 2077 6974 6820  :r:rw,foo` with 
-00002270: 603a 722c 666f 6f60 2074 6f20 6f6e 6c79  `:r,foo` to only
-00002280: 206d 616b 6520 7468 6520 666f 6c64 6572   make the folder
-00002290: 2072 6561 6461 626c 6520 6279 2060 666f   readable by `fo
-000022a0: 6f60 2061 6e64 206e 6f62 6f64 7920 656c  o` and nobody el
-000022b0: 7365 0a20 202a 2073 6565 205b 6163 636f  se.  * see [acco
-000022c0: 756e 7473 2061 6e64 2076 6f6c 756d 6573  unts and volumes
-000022d0: 5d28 2361 6363 6f75 6e74 732d 616e 642d  ](#accounts-and-
-000022e0: 766f 6c75 6d65 7329 2028 6f72 2060 2d2d  volumes) (or `--
-000022f0: 6865 6c70 2d61 6363 6f75 6e74 7360 2920  help-accounts`) 
-00002300: 666f 7220 7468 6520 7379 6e74 6178 2061  for the syntax a
-00002310: 6e64 206f 7468 6572 2070 6572 6d69 7373  nd other permiss
-00002320: 696f 6e73 0a0a 0a23 2323 206f 6e20 7365  ions...### on se
-00002330: 7276 6572 730a 0a79 6f75 206d 6179 2061  rvers..you may a
-00002340: 6c73 6f20 7761 6e74 2074 6865 7365 2c20  lso want these, 
-00002350: 6573 7065 6369 616c 6c79 206f 6e20 7365  especially on se
-00002360: 7276 6572 733a 0a0a 2a20 5b63 6f6e 7472  rvers:..* [contr
-00002370: 6962 2f73 7973 7465 6d64 2f63 6f70 7970  ib/systemd/copyp
-00002380: 6172 7479 2e73 6572 7669 6365 5d28 636f  arty.service](co
-00002390: 6e74 7269 622f 7379 7374 656d 642f 636f  ntrib/systemd/co
-000023a0: 7079 7061 7274 792e 7365 7276 6963 6529  pyparty.service)
-000023b0: 2074 6f20 7275 6e20 636f 7079 7061 7274   to run copypart
-000023c0: 7920 6173 2061 2073 7973 7465 6d64 2073  y as a systemd s
-000023d0: 6572 7669 6365 0a2a 205b 636f 6e74 7269  ervice.* [contri
-000023e0: 622f 7379 7374 656d 642f 7072 6973 6f6e  b/systemd/prison
-000023f0: 7061 7274 792e 7365 7276 6963 655d 2863  party.service](c
-00002400: 6f6e 7472 6962 2f73 7973 7465 6d64 2f70  ontrib/systemd/p
-00002410: 7269 736f 6e70 6172 7479 2e73 6572 7669  risonparty.servi
-00002420: 6365 2920 746f 2072 756e 2069 7420 696e  ce) to run it in
-00002430: 2061 2063 6872 6f6f 7420 2866 6f72 2065   a chroot (for e
-00002440: 7874 7261 2073 6563 7572 6974 7929 0a2a  xtra security).*
-00002450: 205b 636f 6e74 7269 622f 7263 2f63 6f70   [contrib/rc/cop
-00002460: 7970 6172 7479 5d28 636f 6e74 7269 622f  yparty](contrib/
-00002470: 7263 2f63 6f70 7970 6172 7479 2920 746f  rc/copyparty) to
-00002480: 2072 756e 2063 6f70 7970 6172 7479 206f   run copyparty o
-00002490: 6e20 4672 6565 4253 440a 2a20 5b63 6f6e  n FreeBSD.* [con
-000024a0: 7472 6962 2f6e 6769 6e78 2f63 6f70 7970  trib/nginx/copyp
-000024b0: 6172 7479 2e63 6f6e 665d 2863 6f6e 7472  arty.conf](contr
-000024c0: 6962 2f6e 6769 6e78 2f63 6f70 7970 6172  ib/nginx/copypar
-000024d0: 7479 2e63 6f6e 6629 2074 6f20 5b72 6576  ty.conf) to [rev
-000024e0: 6572 7365 2d70 726f 7879 5d28 2372 6576  erse-proxy](#rev
-000024f0: 6572 7365 2d70 726f 7879 2920 6265 6869  erse-proxy) behi
-00002500: 6e64 206e 6769 6e78 2028 666f 7220 6265  nd nginx (for be
-00002510: 7474 6572 2068 7474 7073 290a 0a61 6e64  tter https)..and
-00002520: 2072 656d 656d 6265 7220 746f 206f 7065   remember to ope
-00002530: 6e20 7468 6520 706f 7274 7320 796f 7520  n the ports you 
-00002540: 7761 6e74 3b20 6865 7265 2773 2061 2063  want; here's a c
-00002550: 6f6d 706c 6574 6520 6578 616d 706c 6520  omplete example 
-00002560: 696e 636c 7564 696e 6720 6576 6572 7920  including every 
-00002570: 6665 6174 7572 6520 636f 7079 7061 7274  feature copypart
-00002580: 7920 6861 7320 746f 206f 6666 6572 3a0a  y has to offer:.
-00002590: 6060 600a 6669 7265 7761 6c6c 2d63 6d64  ```.firewall-cmd
-000025a0: 202d 2d70 6572 6d61 6e65 6e74 202d 2d61   --permanent --a
-000025b0: 6464 2d70 6f72 743d 7b38 302c 3434 332c  dd-port={80,443,
-000025c0: 3339 3231 2c33 3932 332c 3339 3435 2c33  3921,3923,3945,3
-000025d0: 3939 307d 2f74 6370 2020 2320 2d2d 7a6f  990}/tcp  # --zo
-000025e0: 6e65 3d6c 6962 7669 7274 0a66 6972 6577  ne=libvirt.firew
-000025f0: 616c 6c2d 636d 6420 2d2d 7065 726d 616e  all-cmd --perman
-00002600: 656e 7420 2d2d 6164 642d 706f 7274 3d31  ent --add-port=1
-00002610: 3230 3030 2d31 3230 3939 2f74 6370 202d  2000-12099/tcp -
-00002620: 2d70 6572 6d61 6e65 6e74 2020 2320 2d2d  -permanent  # --
-00002630: 7a6f 6e65 3d6c 6962 7669 7274 0a66 6972  zone=libvirt.fir
-00002640: 6577 616c 6c2d 636d 6420 2d2d 7065 726d  ewall-cmd --perm
-00002650: 616e 656e 7420 2d2d 6164 642d 706f 7274  anent --add-port
-00002660: 3d7b 3139 3030 2c35 3335 337d 2f75 6470  ={1900,5353}/udp
-00002670: 2020 2320 2d2d 7a6f 6e65 3d6c 6962 7669    # --zone=libvi
-00002680: 7274 0a66 6972 6577 616c 6c2d 636d 6420  rt.firewall-cmd 
-00002690: 2d2d 7265 6c6f 6164 0a60 6060 0a28 3139  --reload.```.(19
-000026a0: 3030 3a73 7364 702c 2033 3932 313a 6674  00:ssdp, 3921:ft
-000026b0: 702c 2033 3932 333a 6874 7470 2f68 7474  p, 3923:http/htt
-000026c0: 7073 2c20 3339 3435 3a73 6d62 2c20 3339  ps, 3945:smb, 39
-000026d0: 3930 3a66 7470 732c 2035 3335 333a 6d64  90:ftps, 5353:md
-000026e0: 6e73 2c20 3132 3030 303a 7061 7373 6976  ns, 12000:passiv
-000026f0: 652d 6674 7029 0a0a 0a23 2320 6665 6174  e-ftp)...## feat
-00002700: 7572 6573 0a0a 2a20 6261 636b 656e 6420  ures..* backend 
-00002710: 7374 7566 660a 2020 2a20 e298 9120 4950  stuff.  * ... IP
-00002720: 7636 0a20 202a 20e2 9891 205b 6d75 6c74  v6.  * ... [mult
-00002730: 6970 726f 6365 7373 696e 675d 2823 7065  iprocessing](#pe
-00002740: 7266 6f72 6d61 6e63 6529 2028 6163 7475  rformance) (actu
-00002750: 616c 206d 756c 7469 7468 7265 6164 696e  al multithreadin
-00002760: 6729 0a20 202a 20e2 9891 2076 6f6c 756d  g).  * ... volum
-00002770: 6573 2028 6d6f 756e 7470 6f69 6e74 7329  es (mountpoints)
-00002780: 0a20 202a 20e2 9891 205b 6163 636f 756e  .  * ... [accoun
-00002790: 7473 5d28 2361 6363 6f75 6e74 732d 616e  ts](#accounts-an
-000027a0: 642d 766f 6c75 6d65 7329 0a20 202a 20e2  d-volumes).  * .
-000027b0: 9891 205b 6674 7020 7365 7276 6572 5d28  .. [ftp server](
-000027c0: 2366 7470 2d73 6572 7665 7229 0a20 202a  #ftp-server).  *
-000027d0: 20e2 9891 205b 7765 6264 6176 2073 6572   ... [webdav ser
-000027e0: 7665 725d 2823 7765 6264 6176 2d73 6572  ver](#webdav-ser
-000027f0: 7665 7229 0a20 202a 20e2 9891 205b 736d  ver).  * ... [sm
-00002800: 622f 6369 6673 2073 6572 7665 725d 2823  b/cifs server](#
-00002810: 736d 622d 7365 7276 6572 290a 2020 2a20  smb-server).  * 
-00002820: e298 9120 5b71 722d 636f 6465 5d28 2371  ... [qr-code](#q
-00002830: 722d 636f 6465 2920 666f 7220 7175 6963  r-code) for quic
-00002840: 6b20 6163 6365 7373 0a20 202a 20e2 9891  k access.  * ...
-00002850: 205b 7570 6e70 202f 207a 6572 6f63 6f6e   [upnp / zerocon
-00002860: 6620 2f20 6d64 6e73 202f 2073 7364 705d  f / mdns / ssdp]
-00002870: 2823 7a65 726f 636f 6e66 290a 2020 2a20  (#zeroconf).  * 
-00002880: e298 9120 5b65 7665 6e74 2068 6f6f 6b73  ... [event hooks
-00002890: 5d28 2365 7665 6e74 2d68 6f6f 6b73 2920  ](#event-hooks) 
-000028a0: 2f20 7363 7269 7074 2072 756e 6e65 720a  / script runner.
-000028b0: 2020 2a20 e298 9120 5b72 6576 6572 7365    * ... [reverse
-000028c0: 2d70 726f 7879 2073 7570 706f 7274 5d28  -proxy support](
-000028d0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000028e0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-000028f0: 7923 7265 7665 7273 652d 7072 6f78 7929  y#reverse-proxy)
-00002900: 0a2a 2075 706c 6f61 640a 2020 2a20 e298  .* upload.  * ..
-00002910: 9120 6261 7369 633a 2070 6c61 696e 206d  . basic: plain m
-00002920: 756c 7469 7061 7274 2c20 6965 3620 7375  ultipart, ie6 su
-00002930: 7070 6f72 740a 2020 2a20 e298 9120 5b75  pport.  * ... [u
-00002940: 7032 6b5d 2823 7570 6c6f 6164 696e 6729  p2k](#uploading)
-00002950: 3a20 6a73 2c20 7265 7375 6d61 626c 652c  : js, resumable,
-00002960: 206d 756c 7469 7468 7265 6164 6564 0a20   multithreaded. 
-00002970: 2020 202a 2075 6e61 6666 6563 7465 6420     * unaffected 
-00002980: 6279 2063 6c6f 7564 666c 6172 6527 7320  by cloudflare's 
-00002990: 6d61 782d 7570 6c6f 6164 2d73 697a 6520  max-upload-size 
-000029a0: 2831 3030 204d 6942 290a 2020 2a20 e298  (100 MiB).  * ..
-000029b0: 9120 7374 6173 683a 2073 696d 706c 6520  . stash: simple 
-000029c0: 5055 5420 6669 6c65 6472 6f70 7065 720a  PUT filedropper.
-000029d0: 2020 2a20 e298 9120 6669 6c65 6e61 6d65    * ... filename
-000029e0: 2072 616e 646f 6d69 7a65 720a 2020 2a20   randomizer.  * 
-000029f0: e298 9120 7772 6974 652d 6f6e 6c79 2066  ... write-only f
-00002a00: 6f6c 6465 7273 0a20 202a 20e2 9891 205b  olders.  * ... [
-00002a10: 756e 706f 7374 5d28 2375 6e70 6f73 7429  unpost](#unpost)
-00002a20: 3a20 756e 646f 2f64 656c 6574 6520 6163  : undo/delete ac
-00002a30: 6369 6465 6e74 616c 2075 706c 6f61 6473  cidental uploads
-00002a40: 0a20 202a 20e2 9891 205b 7365 6c66 2d64  .  * ... [self-d
-00002a50: 6573 7472 7563 745d 2823 7365 6c66 2d64  estruct](#self-d
-00002a60: 6573 7472 7563 7429 2028 7370 6563 6966  estruct) (specif
-00002a70: 6965 6420 7365 7276 6572 2d73 6964 6520  ied server-side 
-00002a80: 6f72 2063 6c69 656e 742d 7369 6465 290a  or client-side).
-00002a90: 2020 2a20 e298 9120 7379 6d6c 696e 6b2f    * ... symlink/
-00002aa0: 6469 7363 6172 6420 6578 6973 7469 6e67  discard existing
-00002ab0: 2066 696c 6573 2028 636f 6e74 656e 742d   files (content-
-00002ac0: 6d61 7463 6869 6e67 290a 2a20 646f 776e  matching).* down
-00002ad0: 6c6f 6164 0a20 202a 20e2 9891 2073 696e  load.  * ... sin
-00002ae0: 676c 6520 6669 6c65 7320 696e 2062 726f  gle files in bro
-00002af0: 7773 6572 0a20 202a 20e2 9891 205b 666f  wser.  * ... [fo
-00002b00: 6c64 6572 7320 6173 207a 6970 202f 2074  lders as zip / t
-00002b10: 6172 2066 696c 6573 5d28 237a 6970 2d64  ar files](#zip-d
-00002b20: 6f77 6e6c 6f61 6473 290a 2020 2a20 e298  ownloads).  * ..
-00002b30: 9120 5b46 5553 4520 636c 6965 6e74 5d28  . [FUSE client](
-00002b40: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-00002b50: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-00002b60: 792f 7472 6565 2f68 6f76 7564 7374 7261  y/tree/hovudstra
-00002b70: 756d 2f62 696e 2370 6172 7479 6675 7365  um/bin#partyfuse
-00002b80: 7079 2920 2872 6561 642d 6f6e 6c79 290a  py) (read-only).
-00002b90: 2a20 6272 6f77 7365 720a 2020 2a20 e298  * browser.  * ..
-00002ba0: 9120 5b6e 6176 7061 6e65 5d28 236e 6176  . [navpane](#nav
-00002bb0: 7061 6e65 2920 2864 6972 6563 746f 7279  pane) (directory
-00002bc0: 2074 7265 6520 7369 6465 6261 7229 0a20   tree sidebar). 
-00002bd0: 202a 20e2 9891 2066 696c 6520 6d61 6e61   * ... file mana
-00002be0: 6765 7220 2863 7574 2f70 6173 7465 2c20  ger (cut/paste, 
-00002bf0: 6465 6c65 7465 2c20 5b62 6174 6368 2d72  delete, [batch-r
-00002c00: 656e 616d 655d 2823 6261 7463 682d 7265  ename](#batch-re
-00002c10: 6e61 6d65 2929 0a20 202a 20e2 9891 2061  name)).  * ... a
-00002c20: 7564 696f 2070 6c61 7965 7220 2877 6974  udio player (wit
-00002c30: 6820 5b4f 5320 6d65 6469 6120 636f 6e74  h [OS media cont
-00002c40: 726f 6c73 5d28 6874 7470 733a 2f2f 7573  rols](https://us
-00002c50: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-00002c60: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-00002c70: 3234 3130 3332 2f32 3135 3334 3734 3932  241032/215347492
-00002c80: 2d62 3432 3530 3739 372d 3663 3930 2d34  -b4250797-6c90-4
-00002c90: 6530 392d 3961 3463 2d37 3231 6564 6632  e09-9a4c-721edf2
-00002ca0: 6662 3135 632e 706e 6729 2061 6e64 206f  fb15c.png) and o
-00002cb0: 7075 7320 7472 616e 7363 6f64 696e 6729  pus transcoding)
-00002cc0: 0a20 202a 20e2 9891 2069 6d61 6765 2067  .  * ... image g
-00002cd0: 616c 6c65 7279 2077 6974 6820 7765 626d  allery with webm
-00002ce0: 2070 6c61 7965 720a 2020 2a20 e298 9120   player.  * ... 
-00002cf0: 7465 7874 6669 6c65 2062 726f 7773 6572  textfile browser
-00002d00: 2077 6974 6820 7379 6e74 6178 2068 696c   with syntax hil
-00002d10: 6967 6874 696e 670a 2020 2a20 e298 9120  ighting.  * ... 
-00002d20: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
-00002d30: 756d 626e 6169 6c73 290a 2020 2020 2a20  umbnails).    * 
-00002d40: e298 9120 2e2e 2e6f 6620 696d 6167 6573  ... ...of images
-00002d50: 2075 7369 6e67 2050 696c 6c6f 772c 2070   using Pillow, p
-00002d60: 7976 6970 732c 206f 7220 4646 6d70 6567  yvips, or FFmpeg
-00002d70: 0a20 2020 202a 20e2 9891 202e 2e2e 6f66  .    * ... ...of
-00002d80: 2076 6964 656f 7320 7573 696e 6720 4646   videos using FF
-00002d90: 6d70 6567 0a20 2020 202a 20e2 9891 202e  mpeg.    * ... .
-00002da0: 2e2e 6f66 2061 7564 696f 2028 7370 6563  ..of audio (spec
-00002db0: 7472 6f67 7261 6d73 2920 7573 696e 6720  trograms) using 
-00002dc0: 4646 6d70 6567 0a20 2020 202a 20e2 9891  FFmpeg.    * ...
-00002dd0: 2063 6163 6865 2065 7669 6374 696f 6e20   cache eviction 
-00002de0: 286d 6178 2d61 6765 3b20 6d61 7962 6520  (max-age; maybe 
-00002df0: 6d61 782d 7369 7a65 2065 7665 6e74 7561  max-size eventua
-00002e00: 6c6c 7929 0a20 202a 20e2 9891 2053 5041  lly).  * ... SPA
-00002e10: 2028 6272 6f77 7365 2077 6869 6c65 2075   (browse while u
-00002e20: 706c 6f61 6469 6e67 290a 2a20 7365 7276  ploading).* serv
-00002e30: 6572 2069 6e64 6578 696e 670a 2020 2a20  er indexing.  * 
-00002e40: e298 9120 5b6c 6f63 6174 6520 6669 6c65  ... [locate file
-00002e50: 7320 6279 2063 6f6e 7465 6e74 735d 2823  s by contents](#
-00002e60: 6669 6c65 2d73 6561 7263 6829 0a20 202a  file-search).  *
-00002e70: 20e2 9891 2073 6561 7263 6820 6279 206e   ... search by n
-00002e80: 616d 652f 7061 7468 2f64 6174 652f 7369  ame/path/date/si
-00002e90: 7a65 0a20 202a 20e2 9891 205b 7365 6172  ze.  * ... [sear
-00002ea0: 6368 2062 7920 4944 332d 7461 6773 2065  ch by ID3-tags e
-00002eb0: 7463 2e5d 2823 7365 6172 6368 696e 6729  tc.](#searching)
-00002ec0: 0a2a 2063 6c69 656e 7420 7375 7070 6f72  .* client suppor
-00002ed0: 740a 2020 2a20 e298 9120 5b73 796e 6320  t.  * ... [sync 
-00002ee0: 666f 6c64 6572 2074 6f20 7365 7276 6572  folder to server
-00002ef0: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-00002f00: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
-00002f10: 7274 792f 7472 6565 2f68 6f76 7564 7374  rty/tree/hovudst
-00002f20: 7261 756d 2f62 696e 2375 7032 6b70 7929  raum/bin#up2kpy)
-00002f30: 0a20 202a 20e2 9891 205b 6375 726c 2d66  .  * ... [curl-f
-00002f40: 7269 656e 646c 795d 2868 7474 7073 3a2f  riendly](https:/
-00002f50: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-00002f60: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-00002f70: 6f6d 2f32 3431 3033 322f 3231 3533 3232  om/241032/215322
-00002f80: 3631 392d 6561 3566 6436 3036 2d33 3635  619-ea5fd606-365
-00002f90: 342d 3430 6164 2d39 3465 652d 3262 6330  4-40ad-94ee-2bc0
-00002fa0: 3538 3634 3762 6232 2e70 6e67 290a 2a20  58647bb2.png).* 
-00002fb0: 6d61 726b 646f 776e 0a20 202a 20e2 9891  markdown.  * ...
-00002fc0: 205b 7669 6577 6572 5d28 236d 6172 6b64   [viewer](#markd
-00002fd0: 6f77 6e2d 7669 6577 6572 290a 2020 2a20  own-viewer).  * 
-00002fe0: e298 9120 6564 6974 6f72 2028 7375 7265  ... editor (sure
-00002ff0: 2077 6879 206e 6f74 290a 0a50 533a 2073   why not)..PS: s
-00003000: 6f6d 6574 6869 6e67 206d 6973 7369 6e67  omething missing
-00003010: 3f20 706f 7374 2061 6e79 2063 7261 7a79  ? post any crazy
-00003020: 2069 6465 6173 2079 6f75 2776 6520 676f   ideas you've go
-00003030: 7420 6173 2061 205b 6665 6174 7572 6520  t as a [feature 
-00003040: 7265 7175 6573 745d 2868 7474 7073 3a2f  request](https:/
-00003050: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
-00003060: 2f63 6f70 7970 6172 7479 2f69 7373 7565  /copyparty/issue
-00003070: 732f 6e65 773f 6173 7369 676e 6565 733d  s/new?assignees=
-00003080: 3930 3031 266c 6162 656c 733d 656e 6861  9001&labels=enha
-00003090: 6e63 656d 656e 7426 7465 6d70 6c61 7465  ncement&template
-000030a0: 3d66 6561 7475 7265 5f72 6571 7565 7374  =feature_request
-000030b0: 2e6d 6429 206f 7220 5b64 6973 6375 7373  .md) or [discuss
-000030c0: 696f 6e5d 2868 7474 7073 3a2f 2f67 6974  ion](https://git
-000030d0: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-000030e0: 7970 6172 7479 2f64 6973 6375 7373 696f  yparty/discussio
-000030f0: 6e73 2f6e 6577 3f63 6174 6567 6f72 793d  ns/new?category=
-00003100: 6964 6561 7329 20f0 9fa4 990a 0a0a 2323  ideas) .......##
-00003110: 2074 6573 7469 6d6f 6e69 616c 730a 0a73   testimonials..s
-00003120: 6d61 6c6c 2063 6f6c 6c65 6374 696f 6e20  mall collection 
-00003130: 6f66 2075 7365 7220 6665 6564 6261 636b  of user feedback
-00003140: 0a0a 6067 6f6f 6420 656e 6f75 6768 602c  ..`good enough`,
-00003150: 2060 7375 7270 7269 7369 6e67 6c79 2063   `surprisingly c
-00003160: 6f72 7265 6374 602c 2060 6365 7274 6966  orrect`, `certif
-00003170: 6965 6420 676f 6f64 2073 6f66 7477 6172  ied good softwar
-00003180: 6560 2c20 606a 7573 7420 776f 726b 7360  e`, `just works`
-00003190: 2c20 6077 6879 602c 2060 776f 7720 7468  , `why`, `wow th
-000031a0: 6973 2069 7320 6265 7474 6572 2074 6861  is is better tha
-000031b0: 6e20 6e65 7874 636c 6f75 6460 0a0a 0a23  n nextcloud`...#
-000031c0: 206d 6f74 6976 6174 696f 6e73 0a0a 7072   motivations..pr
-000031d0: 6f6a 6563 7420 676f 616c 7320 2f20 7068  oject goals / ph
-000031e0: 696c 6f73 6f70 6879 0a0a 2a20 696e 7665  ilosophy..* inve
-000031f0: 7273 6520 6c69 6e75 7820 7068 696c 6f73  rse linux philos
-00003200: 6f70 6879 202d 2d20 646f 2061 6c6c 2074  ophy -- do all t
-00003210: 6865 2074 6869 6e67 732c 2061 6e64 2064  he things, and d
-00003220: 6f20 616e 202a 6f6b 6179 2a20 6a6f 620a  o an *okay* job.
-00003230: 2020 2a20 7175 6963 6b20 6472 6f70 2d69    * quick drop-i
-00003240: 6e20 7365 7276 6963 6520 746f 2067 6574  n service to get
-00003250: 2061 206c 6f74 206f 6620 6665 6174 7572   a lot of featur
-00003260: 6573 2069 6e20 6120 7069 6e63 680a 2020  es in a pinch.  
-00003270: 2a20 736f 6d65 206f 6620 5b74 6865 2061  * some of [the a
-00003280: 6c74 6572 6e61 7469 7665 735d 282e 2f64  lternatives](./d
-00003290: 6f63 732f 7665 7273 7573 2e6d 6429 206d  ocs/versus.md) m
-000032a0: 6967 6874 2062 6520 6120 6265 7474 6572  ight be a better
-000032b0: 2066 6974 2066 6f72 2079 6f75 0a2a 2072   fit for you.* r
-000032c0: 756e 2061 6e79 7768 6572 652c 2073 7570  un anywhere, sup
-000032d0: 706f 7274 2065 7665 7279 7468 696e 670a  port everything.
-000032e0: 2020 2a20 6173 206d 616e 7920 7765 622d    * as many web-
-000032f0: 6272 6f77 7365 7273 2061 6e64 2070 7974  browsers and pyt
-00003300: 686f 6e20 7665 7273 696f 6e73 2061 7320  hon versions as 
-00003310: 706f 7373 6962 6c65 0a20 2020 202a 2065  possible.    * e
-00003320: 7665 7279 2062 726f 7773 6572 2073 686f  very browser sho
-00003330: 756c 6420 6174 206c 6561 7374 2062 6520  uld at least be 
-00003340: 6162 6c65 2074 6f20 6272 6f77 7365 2c20  able to browse, 
-00003350: 646f 776e 6c6f 6164 2c20 7570 6c6f 6164  download, upload
-00003360: 2066 696c 6573 0a20 2020 202a 2062 6520   files.    * be 
-00003370: 6120 676f 6f64 2065 6d65 7267 656e 6379  a good emergency
-00003380: 2073 6f6c 7574 696f 6e20 666f 7220 7472   solution for tr
-00003390: 616e 7366 6572 7269 6e67 2073 7475 6666  ansferring stuff
-000033a0: 2062 6574 7765 656e 2061 6e63 6965 6e74   between ancient
-000033b0: 2062 6f78 6573 0a20 202a 206d 696e 696d   boxes.  * minim
-000033c0: 616c 2064 6570 656e 6465 6e63 6965 730a  al dependencies.
-000033d0: 2020 2020 2a20 6275 7420 6f70 7469 6f6e      * but option
-000033e0: 616c 2064 6570 656e 6465 6e63 6965 7320  al dependencies 
-000033f0: 6164 6469 6e67 2062 6f6e 7573 2d66 6561  adding bonus-fea
-00003400: 7475 7265 7320 6172 6520 6f6b 0a20 2020  tures are ok.   
-00003410: 202a 2065 7665 7279 7468 696e 6720 6265   * everything be
-00003420: 696e 6720 706c 6169 6e74 6578 7420 6d61  ing plaintext ma
-00003430: 6b65 7320 6974 2070 6f73 7369 626c 6520  kes it possible 
-00003440: 746f 2070 726f 6f66 7265 6164 2066 6f72  to proofread for
-00003450: 206d 616c 6963 696f 7573 2063 6f64 650a   malicious code.
-00003460: 2020 2a20 6e6f 2070 7265 7061 7261 7469    * no preparati
-00003470: 6f6e 7320 2f20 7365 7475 7020 6e65 6365  ons / setup nece
-00003480: 7373 6172 792c 206a 7573 7420 7275 6e20  ssary, just run 
-00003490: 7468 6520 7366 7820 2877 6869 6368 2069  the sfx (which i
-000034a0: 7320 616c 736f 2070 6c61 696e 7465 7874  s also plaintext
-000034b0: 290a 2a20 6164 6170 7461 626c 652c 206d  ).* adaptable, m
-000034c0: 616c 6c65 6162 6c65 2c20 6861 636b 6162  alleable, hackab
-000034d0: 6c65 0a20 202a 206e 6f20 6275 696c 6420  le.  * no build 
-000034e0: 7374 6570 733b 206d 6f64 6966 7920 7468  steps; modify th
-000034f0: 6520 6a73 2f70 7974 686f 6e20 7769 7468  e js/python with
-00003500: 6f75 7420 6e65 6564 696e 6720 6e6f 6465  out needing node
-00003510: 2e6a 7320 6f72 2061 6e79 7468 696e 6720  .js or anything 
-00003520: 6c69 6b65 2074 6861 740a 0a0a 2323 206e  like that...## n
-00003530: 6f74 6573 0a0a 6765 6e65 7261 6c20 6e6f  otes..general no
-00003540: 7465 733a 0a2a 2070 6170 6572 2d70 7269  tes:.* paper-pri
-00003550: 6e74 696e 6720 6973 2061 6666 6563 7465  nting is affecte
-00003560: 6420 6279 2064 6172 6b2f 6c69 6768 742d  d by dark/light-
-00003570: 6d6f 6465 2120 7573 6520 6c69 6768 746d  mode! use lightm
-00003580: 6f64 6520 666f 7220 636f 6c6f 722c 2064  ode for color, d
-00003590: 6172 6b6d 6f64 6520 666f 7220 6772 6179  arkmode for gray
-000035a0: 7363 616c 650a 2020 2a20 6265 6361 7573  scale.  * becaus
-000035b0: 6520 6e6f 2062 726f 7773 6572 7320 6375  e no browsers cu
-000035c0: 7272 656e 746c 7920 696d 706c 656d 656e  rrently implemen
-000035d0: 7420 7468 6520 6d65 6469 612d 7175 6572  t the media-quer
-000035e0: 7920 746f 2064 6f20 7468 6973 2070 726f  y to do this pro
-000035f0: 7065 726c 7920 6f72 7a0a 0a62 726f 7773  perly orz..brows
-00003600: 6572 2d73 7065 6369 6669 633a 0a2a 2069  er-specific:.* i
-00003610: 5068 6f6e 652f 6950 6164 3a20 7573 6520  Phone/iPad: use 
-00003620: 4669 7265 666f 7820 746f 2064 6f77 6e6c  Firefox to downl
-00003630: 6f61 6420 6669 6c65 730a 2a20 416e 6472  oad files.* Andr
-00003640: 6f69 642d 4368 726f 6d65 3a20 696e 6372  oid-Chrome: incr
-00003650: 6561 7365 2022 7061 7261 6c6c 656c 2075  ease "parallel u
-00003660: 706c 6f61 6473 2220 666f 7220 6869 6768  ploads" for high
-00003670: 6572 2073 7065 6564 2028 616e 6472 6f69  er speed (androi
-00003680: 6420 6275 6729 0a2a 2041 6e64 726f 6964  d bug).* Android
-00003690: 2d46 6972 6566 6f78 3a20 7461 6b65 7320  -Firefox: takes 
-000036a0: 6120 7768 696c 6520 746f 2073 656c 6563  a while to selec
-000036b0: 7420 6669 6c65 7320 2874 6865 6972 2066  t files (their f
-000036c0: 6978 2066 6f72 20e2 989d efb8 8f29 0a2a  ix for ......).*
-000036d0: 2044 6573 6b74 6f70 2d46 6972 6566 6f78   Desktop-Firefox
-000036e0: 3a20 7e7e 6d61 7920 7573 6520 6769 6761  : ~~may use giga
-000036f0: 6279 7465 7320 6f66 2052 414d 2069 6620  bytes of RAM if 
-00003700: 796f 7572 2066 696c 6573 2061 7265 206d  your files are m
-00003710: 6173 7369 7665 7e7e 202a 7365 656d 7320  assive~~ *seems 
-00003720: 746f 2062 6520 4f4b 206e 6f77 2a0a 2a20  to be OK now*.* 
-00003730: 4465 736b 746f 702d 4669 7265 666f 783a  Desktop-Firefox:
-00003740: 205b 6d61 7920 7374 6f70 2079 6f75 2066   [may stop you f
-00003750: 726f 6d20 756e 706c 7567 6769 6e67 2055  rom unplugging U
-00003760: 5342 2066 6c61 7368 6472 6976 6573 5d28  SB flashdrives](
-00003770: 6874 7470 733a 2f2f 6275 677a 696c 6c61  https://bugzilla
-00003780: 2e6d 6f7a 696c 6c61 2e6f 7267 2f73 686f  .mozilla.org/sho
-00003790: 775f 6275 672e 6367 693f 6964 3d31 3739  w_bug.cgi?id=179
-000037a0: 3235 3938 2920 756e 7469 6c20 796f 7520  2598) until you 
-000037b0: 7669 7369 7420 6061 626f 7574 3a6d 656d  visit `about:mem
-000037c0: 6f72 7960 2061 6e64 2063 6c69 636b 2060  ory` and click `
-000037d0: 4d69 6e69 6d69 7a65 206d 656d 6f72 7920  Minimize memory 
-000037e0: 7573 6167 6560 0a0a 7365 7276 6572 2d6f  usage`..server-o
-000037f0: 732d 7370 6563 6966 6963 3a0a 2a20 5248  s-specific:.* RH
-00003800: 454c 3820 2f20 526f 636b 7938 3a20 796f  EL8 / Rocky8: yo
-00003810: 7520 6361 6e20 7275 6e20 636f 7079 7061  u can run copypa
-00003820: 7274 7920 7573 696e 6720 602f 7573 722f  rty using `/usr/
-00003830: 6c69 6265 7865 632f 706c 6174 666f 726d  libexec/platform
-00003840: 2d70 7974 686f 6e60 0a0a 7365 7276 6572  -python`..server
-00003850: 206e 6f74 6573 3a0a 2a20 7079 7079 2069   notes:.* pypy i
-00003860: 7320 7375 7070 6f72 7465 6420 6275 7420  s supported but 
-00003870: 7265 6775 6c61 7220 6370 7974 686f 6e20  regular cpython 
-00003880: 6973 2066 6173 7465 7220 6966 2079 6f75  is faster if you
-00003890: 2065 6e61 626c 6520 7468 6520 6461 7461   enable the data
-000038a0: 6261 7365 0a0a 0a23 2062 7567 730a 0a2a  base...# bugs..*
-000038b0: 2057 696e 646f 7773 3a20 7079 7468 6f6e   Windows: python
-000038c0: 2032 2e37 2063 616e 6e6f 7420 696e 6465   2.7 cannot inde
-000038d0: 7820 6e6f 6e2d 6173 6369 6920 6669 6c65  x non-ascii file
-000038e0: 6e61 6d65 7320 7769 7468 2060 2d65 3264  names with `-e2d
-000038f0: 600a 2a20 5769 6e64 6f77 733a 2070 7974  `.* Windows: pyt
-00003900: 686f 6e20 322e 3720 6361 6e6e 6f74 2068  hon 2.7 cannot h
-00003910: 616e 646c 6520 6669 6c65 6e61 6d65 7320  andle filenames 
-00003920: 7769 7468 206d 6f6a 6962 616b 650a 2a20  with mojibake.* 
-00003930: 602d 2d74 682d 6666 2d6a 7067 6020 6d61  `--th-ff-jpg` ma
-00003940: 7920 6669 7820 7669 6465 6f20 7468 756d  y fix video thum
-00003950: 626e 6169 6c73 206f 6e20 736f 6d65 2046  bnails on some F
-00003960: 466d 7065 6720 7665 7273 696f 6e73 2028  Fmpeg versions (
-00003970: 6d61 636f 732c 2073 6f6d 6520 6c69 6e75  macos, some linu
-00003980: 7829 0a2a 2060 2d2d 7468 2d66 662d 7377  x).* `--th-ff-sw
-00003990: 7260 206d 6179 2066 6978 2061 7564 696f  r` may fix audio
-000039a0: 2074 6875 6d62 6e61 696c 7320 6f6e 2073   thumbnails on s
-000039b0: 6f6d 6520 4646 6d70 6567 2076 6572 7369  ome FFmpeg versi
-000039c0: 6f6e 730a 0a23 2320 6765 6e65 7261 6c20  ons..## general 
-000039d0: 6275 6773 0a0a 2a20 5769 6e64 6f77 733a  bugs..* Windows:
-000039e0: 2069 6620 7468 6520 6075 7032 6b2e 6462   if the `up2k.db
-000039f0: 6020 2866 696c 6573 7973 7465 6d20 696e  ` (filesystem in
-00003a00: 6465 7829 2069 7320 6f6e 2061 2073 616d  dex) is on a sam
-00003a10: 6261 2d73 6861 7265 206f 7220 6e65 7477  ba-share or netw
-00003a20: 6f72 6b20 6469 736b 2c20 796f 7527 6c6c  ork disk, you'll
-00003a30: 2067 6574 2075 6e70 7265 6469 6374 6162   get unpredictab
-00003a40: 6c65 2062 6568 6176 696f 7220 6966 2074  le behavior if t
-00003a50: 6865 2073 6861 7265 2069 7320 6469 7363  he share is disc
-00003a60: 6f6e 6e65 6374 6564 2066 6f72 2061 2062  onnected for a b
-00003a70: 6974 0a20 202a 2075 7365 2060 2d2d 6869  it.  * use `--hi
-00003a80: 7374 6020 6f72 2074 6865 2060 6869 7374  st` or the `hist
-00003a90: 6020 766f 6c66 6c61 6720 2860 2d76 205b  ` volflag (`-v [
-00003aa0: 2e2e 2e5d 3a63 2c68 6973 743d 2f74 6d70  ...]:c,hist=/tmp
-00003ab0: 2f66 6f6f 6029 2074 6f20 706c 6163 6520  /foo`) to place 
-00003ac0: 7468 6520 6462 206f 6e20 6120 6c6f 6361  the db on a loca
-00003ad0: 6c20 6469 736b 2069 6e73 7465 6164 0a2a  l disk instead.*
-00003ae0: 2061 6c6c 2076 6f6c 756d 6573 206d 7573   all volumes mus
-00003af0: 7420 6578 6973 7420 2f20 6265 2061 7661  t exist / be ava
-00003b00: 696c 6162 6c65 206f 6e20 7374 6172 7475  ilable on startu
-00003b10: 703b 2075 7032 6b20 286d 7470 2065 7370  p; up2k (mtp esp
-00003b20: 6563 6961 6c6c 7929 2067 6574 7320 6675  ecially) gets fu
-00003b30: 6e6b 7920 6f74 6865 7277 6973 650a 2a20  nky otherwise.* 
-00003b40: 7072 6f62 6162 6c79 206d 6f72 652c 2070  probably more, p
-00003b50: 6c73 206c 6574 206d 6520 6b6e 6f77 0a0a  ls let me know..
-00003b60: 2323 206e 6f74 206d 7920 6275 6773 0a0a  ## not my bugs..
-00003b70: 2a20 5b43 6872 6f6d 6520 6973 7375 6520  * [Chrome issue 
-00003b80: 3133 3137 3036 395d 2868 7474 7073 3a2f  1317069](https:/
-00003b90: 2f62 7567 732e 6368 726f 6d69 756d 2e6f  /bugs.chromium.o
-00003ba0: 7267 2f70 2f63 6872 6f6d 6975 6d2f 6973  rg/p/chromium/is
-00003bb0: 7375 6573 2f64 6574 6169 6c3f 6964 3d31  sues/detail?id=1
-00003bc0: 3331 3730 3639 2920 2d2d 2069 6620 796f  317069) -- if yo
-00003bd0: 7520 7472 7920 746f 2075 706c 6f61 6420  u try to upload 
-00003be0: 6120 666f 6c64 6572 2077 6869 6368 2063  a folder which c
-00003bf0: 6f6e 7461 696e 7320 7379 6d6c 696e 6b73  ontains symlinks
-00003c00: 2062 7920 6472 6167 6769 6e67 2069 7420   by dragging it 
-00003c10: 696e 746f 2074 6865 2062 726f 7773 6572  into the browser
-00003c20: 2c20 7468 6520 7379 6d6c 696e 6b65 6420  , the symlinked 
-00003c30: 6669 6c65 7320 7769 6c6c 206e 6f74 2067  files will not g
-00003c40: 6574 2075 706c 6f61 6465 640a 0a2a 205b  et uploaded..* [
-00003c50: 4368 726f 6d65 2069 7373 7565 2031 3335  Chrome issue 135
-00003c60: 3232 3130 5d28 6874 7470 733a 2f2f 6275  2210](https://bu
-00003c70: 6773 2e63 6872 6f6d 6975 6d2e 6f72 672f  gs.chromium.org/
-00003c80: 702f 6368 726f 6d69 756d 2f69 7373 7565  p/chromium/issue
-00003c90: 732f 6465 7461 696c 3f69 643d 3133 3532  s/detail?id=1352
-00003ca0: 3231 3029 202d 2d20 706c 6169 6e74 6578  210) -- plaintex
-00003cb0: 7420 6874 7470 206d 6179 2062 6520 6661  t http may be fa
-00003cc0: 7374 6572 2061 7420 6669 6c65 6861 7368  ster at filehash
-00003cd0: 696e 6720 7468 616e 2068 7474 7073 2028  ing than https (
-00003ce0: 6275 7420 616c 736f 2065 7874 7265 6d65  but also extreme
-00003cf0: 6c79 2043 5055 2d69 6e74 656e 7369 7665  ly CPU-intensive
-00003d00: 290a 0a2a 205b 4669 7265 666f 7820 6973  )..* [Firefox is
-00003d10: 7375 6520 3137 3930 3530 305d 2868 7474  sue 1790500](htt
-00003d20: 7073 3a2f 2f62 7567 7a69 6c6c 612e 6d6f  ps://bugzilla.mo
-00003d30: 7a69 6c6c 612e 6f72 672f 7368 6f77 5f62  zilla.org/show_b
-00003d40: 7567 2e63 6769 3f69 643d 3137 3930 3530  ug.cgi?id=179050
-00003d50: 3029 202d 2d20 656e 7469 7265 2062 726f  0) -- entire bro
-00003d60: 7773 6572 2063 616e 2063 7261 7368 2061  wser can crash a
-00003d70: 6674 6572 2075 706c 6f61 6469 6e67 207e  fter uploading ~
-00003d80: 3430 3030 2073 6d61 6c6c 2066 696c 6573  4000 small files
-00003d90: 0a0a 2a20 6950 686f 6e65 733a 2074 6865  ..* iPhones: the
-00003da0: 2076 6f6c 756d 6520 636f 6e74 726f 6c20   volume control 
-00003db0: 646f 6573 6e27 7420 776f 726b 2062 6563  doesn't work bec
-00003dc0: 6175 7365 205b 6170 706c 6520 646f 6573  ause [apple does
-00003dd0: 6e27 7420 7761 6e74 2069 7420 746f 5d28  n't want it to](
-00003de0: 6874 7470 733a 2f2f 6465 7665 6c6f 7065  https://develope
-00003df0: 722e 6170 706c 652e 636f 6d2f 6c69 6272  r.apple.com/libr
-00003e00: 6172 792f 6172 6368 6976 652f 646f 6375  ary/archive/docu
-00003e10: 6d65 6e74 6174 696f 6e2f 4175 6469 6f56  mentation/AudioV
-00003e20: 6964 656f 2f43 6f6e 6365 7074 7561 6c2f  ideo/Conceptual/
-00003e30: 5573 696e 675f 4854 4d4c 355f 4175 6469  Using_HTML5_Audi
-00003e40: 6f5f 5669 6465 6f2f 4465 7669 6365 2d53  o_Video/Device-S
-00003e50: 7065 6369 6669 6343 6f6e 7369 6465 7261  pecificConsidera
-00003e60: 7469 6f6e 732f 4465 7669 6365 2d53 7065  tions/Device-Spe
-00003e70: 6369 6669 6343 6f6e 7369 6465 7261 7469  cificConsiderati
-00003e80: 6f6e 732e 6874 6d6c 232f 2f61 7070 6c65  ons.html#//apple
-00003e90: 5f72 6566 2f64 6f63 2f75 6964 2f54 5034  _ref/doc/uid/TP4
-00003ea0: 3030 3039 3532 332d 4348 352d 5357 3131  0009523-CH5-SW11
-00003eb0: 290a 2020 2a20 2a66 7574 7572 6520 776f  ).  * *future wo
-00003ec0: 726b 6172 6f75 6e64 3a2a 2065 6e61 626c  rkaround:* enabl
-00003ed0: 6520 7468 6520 6571 7561 6c69 7a65 722c  e the equalizer,
-00003ee0: 206d 616b 6520 6974 2061 6c6c 2d7a 6572   make it all-zer
-00003ef0: 6f2c 2061 6e64 2073 6574 2061 206e 6567  o, and set a neg
-00003f00: 6174 6976 6520 626f 6f73 7420 746f 2072  ative boost to r
-00003f10: 6564 7563 6520 7468 6520 766f 6c75 6d65  educe the volume
-00003f20: 0a20 2020 202a 2022 6675 7475 7265 2220  .    * "future" 
-00003f30: 6265 6361 7573 6520 6041 7564 696f 436f  because `AudioCo
-00003f40: 6e74 6578 7460 2069 7320 6272 6f6b 656e  ntext` is broken
-00003f50: 2069 6e20 7468 6520 6375 7272 656e 7420   in the current 
-00003f60: 694f 5320 7665 7273 696f 6e20 2831 352e  iOS version (15.
-00003f70: 3129 2c20 6d61 7962 6520 6f6e 6520 6461  1), maybe one da
-00003f80: 792e 2e2e 0a0a 2a20 5769 6e64 6f77 733a  y.....* Windows:
-00003f90: 2066 6f6c 6465 7273 2063 616e 6e6f 7420   folders cannot 
-00003fa0: 6265 2061 6363 6573 7365 6420 6966 2074  be accessed if t
-00003fb0: 6865 206e 616d 6520 656e 6473 2077 6974  he name ends wit
-00003fc0: 6820 602e 600a 2020 2a20 7079 7468 6f6e  h `.`.  * python
-00003fd0: 206f 7220 7769 6e64 6f77 7320 6275 670a   or windows bug.
-00003fe0: 0a2a 2057 696e 646f 7773 3a20 6d73 7973  .* Windows: msys
-00003ff0: 322d 7079 7468 6f6e 2033 2e38 2e36 206f  2-python 3.8.6 o
-00004000: 6363 6173 696f 6e61 6c6c 7920 7468 726f  ccasionally thro
-00004010: 7773 2060 5275 6e74 696d 6545 7272 6f72  ws `RuntimeError
-00004020: 3a20 7265 6c65 6173 6520 756e 6c6f 636b  : release unlock
-00004030: 6564 206c 6f63 6b60 2077 6865 6e20 6c65  ed lock` when le
-00004040: 6176 696e 6720 6120 7363 6f70 6564 206d  aving a scoped m
-00004050: 7574 6578 2069 6e20 7570 326b 0a20 202a  utex in up2k.  *
-00004060: 2074 6869 7320 6973 2061 6e20 6d73 7973   this is an msys
-00004070: 3220 6275 672c 2074 6865 2072 6567 756c  2 bug, the regul
-00004080: 6172 2077 696e 646f 7773 2065 6469 7469  ar windows editi
-00004090: 6f6e 206f 6620 7079 7468 6f6e 2069 7320  on of python is 
-000040a0: 6669 6e65 0a0a 2a20 5669 7274 7561 6c42  fine..* VirtualB
-000040b0: 6f78 3a20 7371 6c69 7465 2074 6872 6f77  ox: sqlite throw
-000040c0: 7320 6044 6973 6b20 492f 4f20 4572 726f  s `Disk I/O Erro
-000040d0: 7260 2077 6865 6e20 7275 6e6e 696e 6720  r` when running 
-000040e0: 696e 2061 2056 4d20 616e 6420 7468 6520  in a VM and the 
-000040f0: 7570 326b 2064 6174 6162 6173 6520 6973  up2k database is
-00004100: 2069 6e20 6120 7662 6f78 7366 0a20 202a   in a vboxsf.  *
-00004110: 2075 7365 2060 2d2d 6869 7374 6020 6f72   use `--hist` or
-00004120: 2074 6865 2060 6869 7374 6020 766f 6c66   the `hist` volf
-00004130: 6c61 6720 2860 2d76 205b 2e2e 2e5d 3a63  lag (`-v [...]:c
-00004140: 2c68 6973 743d 2f74 6d70 2f66 6f6f 6029  ,hist=/tmp/foo`)
-00004150: 2074 6f20 706c 6163 6520 7468 6520 6462   to place the db
-00004160: 2069 6e73 6964 6520 7468 6520 766d 2069   inside the vm i
-00004170: 6e73 7465 6164 0a0a 2a20 5562 756e 7475  nstead..* Ubuntu
-00004180: 3a20 6472 6167 6769 6e67 2066 696c 6573  : dragging files
-00004190: 2066 726f 6d20 6365 7274 6169 6e20 666f   from certain fo
-000041a0: 6c64 6572 7320 696e 746f 2066 6972 6566  lders into firef
-000041b0: 6f78 206f 7220 6368 726f 6d65 2069 7320  ox or chrome is 
-000041c0: 696d 706f 7373 6962 6c65 0a20 202a 2064  impossible.  * d
-000041d0: 7565 2074 6f20 736e 6170 2073 6563 7572  ue to snap secur
-000041e0: 6974 7920 706f 6c69 6369 6573 202d 2d20  ity policies -- 
-000041f0: 7365 6520 6073 6e61 7020 636f 6e6e 6563  see `snap connec
-00004200: 7469 6f6e 7320 6669 7265 666f 7860 2066  tions firefox` f
-00004210: 6f72 2074 6865 2061 6c6c 6f77 6c69 7374  or the allowlist
-00004220: 2c20 6072 656d 6f76 6162 6c65 2d6d 6564  , `removable-med
-00004230: 6961 6020 7065 726d 6974 7320 616c 6c20  ia` permits all 
-00004240: 6f66 2060 2f6d 6e74 6020 616e 6420 602f  of `/mnt` and `/
-00004250: 6d65 6469 6160 2061 7070 6172 656e 746c  media` apparentl
-00004260: 790a 0a0a 2320 6272 6561 6b69 6e67 2063  y...# breaking c
-00004270: 6861 6e67 6573 0a0a 7570 6772 6164 6520  hanges..upgrade 
-00004280: 6e6f 7465 730a 0a2a 2060 312e 362e 3060  notes..* `1.6.0`
-00004290: 2028 3230 3233 2d30 312d 3239 293a 0a20   (2023-01-29):. 
-000042a0: 202a 2068 7474 702d 6170 693a 2064 656c   * http-api: del
-000042b0: 6574 652f 6d6f 7665 2069 7320 6e6f 7720  ete/move is now 
-000042c0: 6050 4f53 5460 2069 6e73 7465 6164 206f  `POST` instead o
-000042d0: 6620 6047 4554 600a 2020 2a20 6576 6572  f `GET`.  * ever
-000042e0: 7974 6869 6e67 206f 7468 6572 2074 6861  ything other tha
-000042f0: 6e20 6047 4554 6020 616e 6420 6048 4541  n `GET` and `HEA
-00004300: 4460 206d 7573 7420 7061 7373 205b 636f  D` must pass [co
-00004310: 7273 2076 616c 6964 6174 696f 6e5d 2823  rs validation](#
-00004320: 636f 7273 290a 2a20 6031 2e35 2e30 6020  cors).* `1.5.0` 
-00004330: 2832 3032 322d 3132 2d30 3329 3a20 5b6e  (2022-12-03): [n
-00004340: 6577 2063 6875 6e6b 7369 7a65 2066 6f72  ew chunksize for
-00004350: 6d75 6c61 5d28 6874 7470 733a 2f2f 6769  mula](https://gi
-00004360: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
-00004370: 7079 7061 7274 792f 636f 6d6d 6974 2f35  pyparty/commit/5
-00004380: 3465 3163 3864 3236 3164 6629 2066 6f72  4e1c8d261df) for
-00004390: 2066 696c 6573 206c 6172 6765 7220 7468   files larger th
-000043a0: 616e 2031 3238 2047 6942 0a20 202a 202a  an 128 GiB.  * *
-000043b0: 2a75 7365 7273 3a2a 2a20 7570 6772 6164  *users:** upgrad
-000043c0: 6520 746f 2074 6865 206c 6174 6573 7420  e to the latest 
-000043d0: 5b63 6c69 2075 706c 6f61 6465 725d 2868  [cli uploader](h
-000043e0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000043f0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-00004400: 2f62 6c6f 622f 686f 7675 6473 7472 6175  /blob/hovudstrau
-00004410: 6d2f 6269 6e2f 7570 326b 2e70 7929 2069  m/bin/up2k.py) i
-00004420: 6620 796f 7520 7573 6520 7468 6174 0a20  f you use that. 
-00004430: 202a 202a 2a64 6576 733a 2a2a 2075 7064   * **devs:** upd
-00004440: 6174 6520 7468 6972 642d 7061 7274 7920  ate third-party 
-00004450: 7570 326b 2063 6c69 656e 7473 2028 6966  up2k clients (if
-00004460: 2074 686f 7365 2065 7665 6e20 6578 6973   those even exis
-00004470: 7429 0a0a 0a23 2046 4151 0a0a 2266 7265  t)...# FAQ.."fre
-00004480: 7175 656e 746c 7922 2061 736b 6564 2071  quently" asked q
-00004490: 7565 7374 696f 6e73 0a0a 2a20 6973 2069  uestions..* is i
-000044a0: 7420 706f 7373 6962 6c65 2074 6f20 626c  t possible to bl
-000044b0: 6f63 6b20 7265 6164 2d61 6363 6573 7320  ock read-access 
-000044c0: 746f 2066 6f6c 6465 7273 2075 6e6c 6573  to folders unles
-000044d0: 7320 796f 7520 6b6e 6f77 2074 6865 2065  s you know the e
-000044e0: 7861 6374 2055 524c 2066 6f72 2061 2070  xact URL for a p
-000044f0: 6172 7469 6375 6c61 7220 6669 6c65 2069  articular file i
-00004500: 6e73 6964 653f 0a20 202a 2079 6573 2c20  nside?.  * yes, 
-00004510: 7573 696e 6720 7468 6520 5b60 6760 2070  using the [`g` p
-00004520: 6572 6d69 7373 696f 6e5d 2823 6163 636f  ermission](#acco
-00004530: 756e 7473 2d61 6e64 2d76 6f6c 756d 6573  unts-and-volumes
-00004540: 292c 2073 6565 2074 6865 2065 7861 6d70  ), see the examp
-00004550: 6c65 7320 7468 6572 650a 2020 2a20 796f  les there.  * yo
-00004560: 7520 6361 6e20 616c 736f 2064 6f20 7468  u can also do th
-00004570: 6973 2077 6974 6820 6c69 6e75 7820 6669  is with linux fi
-00004580: 6c65 7379 7374 656d 2070 6572 6d69 7373  lesystem permiss
-00004590: 696f 6e73 3b20 6063 686d 6f64 2031 3131  ions; `chmod 111
-000045a0: 206d 7573 6963 6020 7769 6c6c 206d 616b   music` will mak
-000045b0: 6520 6974 2070 6f73 7369 626c 6520 746f  e it possible to
-000045c0: 2061 6363 6573 7320 6669 6c65 7320 616e   access files an
-000045d0: 6420 666f 6c64 6572 7320 696e 7369 6465  d folders inside
-000045e0: 2074 6865 2060 6d75 7369 6360 2066 6f6c   the `music` fol
-000045f0: 6465 7220 6275 7420 6e6f 7420 6c69 7374  der but not list
-00004600: 2074 6865 2069 6d6d 6564 6961 7465 2063   the immediate c
-00004610: 6f6e 7465 6e74 7320 2d2d 2061 6c73 6f20  ontents -- also 
-00004620: 776f 726b 7320 7769 7468 206f 7468 6572  works with other
-00004630: 2073 6f66 7477 6172 652c 206e 6f74 206a   software, not j
-00004640: 7573 7420 636f 7079 7061 7274 790a 0a2a  ust copyparty..*
-00004650: 2063 616e 2049 206d 616b 6520 636f 7079   can I make copy
-00004660: 7061 7274 7920 646f 776e 6c6f 6164 2061  party download a
-00004670: 2066 696c 6520 746f 206d 7920 7365 7276   file to my serv
-00004680: 6572 2069 6620 4920 6769 7665 2069 7420  er if I give it 
-00004690: 6120 5552 4c3f 0a20 202a 2079 6573 2c20  a URL?.  * yes, 
-000046a0: 7573 696e 6720 5b68 6f6f 6b73 5d28 6874  using [hooks](ht
-000046b0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000046c0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
-000046d0: 626c 6f62 2f68 6f76 7564 7374 7261 756d  blob/hovudstraum
-000046e0: 2f62 696e 2f68 6f6f 6b73 2f77 6765 742e  /bin/hooks/wget.
-000046f0: 7079 290a 0a0a 2320 6163 636f 756e 7473  py)...# accounts
-00004700: 2061 6e64 2076 6f6c 756d 6573 0a0a 7065   and volumes..pe
-00004710: 722d 666f 6c64 6572 2c20 7065 722d 7573  r-folder, per-us
-00004720: 6572 2070 6572 6d69 7373 696f 6e73 2020  er permissions  
-00004730: 2d20 6966 2079 6f75 7220 7365 7475 7020  - if your setup 
-00004740: 6973 2067 6574 7469 6e67 2063 6f6d 706c  is getting compl
-00004750: 6578 2c20 636f 6e73 6964 6572 206d 616b  ex, consider mak
-00004760: 696e 6720 6120 5b63 6f6e 6669 6720 6669  ing a [config fi
-00004770: 6c65 5d28 2e2f 646f 6373 2f65 7861 6d70  le](./docs/examp
-00004780: 6c65 2e63 6f6e 6629 2069 6e73 7465 6164  le.conf) instead
-00004790: 206f 6620 7573 696e 6720 6172 6775 6d65   of using argume
-000047a0: 6e74 730a 2a20 6d75 6368 2065 6173 6965  nts.* much easie
-000047b0: 7220 746f 206d 616e 6167 652c 2061 6e64  r to manage, and
-000047c0: 2079 6f75 2063 616e 206d 6f64 6966 7920   you can modify 
-000047d0: 7468 6520 636f 6e66 6967 2061 7420 7275  the config at ru
-000047e0: 6e74 696d 6520 7769 7468 2060 7379 7374  ntime with `syst
-000047f0: 656d 6374 6c20 7265 6c6f 6164 2063 6f70  emctl reload cop
-00004800: 7970 6172 7479 6020 6f72 206d 6f72 6520  yparty` or more 
-00004810: 636f 6e76 656e 6965 6e74 6c79 2075 7369  conveniently usi
-00004820: 6e67 2074 6865 2060 5b72 656c 6f61 6420  ng the `[reload 
-00004830: 6366 675d 6020 6275 7474 6f6e 2069 6e20  cfg]` button in 
-00004840: 7468 6520 636f 6e74 726f 6c2d 7061 6e65  the control-pane
-00004850: 6c20 2869 6620 6c6f 6767 6564 2069 6e20  l (if logged in 
-00004860: 6173 2061 646d 696e 290a 2020 2a20 6368  as admin).  * ch
-00004870: 616e 6765 7320 746f 2074 6865 2060 5b67  anges to the `[g
-00004880: 6c6f 6261 6c5d 6020 636f 6e66 6967 2073  lobal]` config s
-00004890: 6563 7469 6f6e 2072 6571 7569 7265 7320  ection requires 
-000048a0: 6120 7265 7374 6172 7420 746f 2074 616b  a restart to tak
-000048b0: 6520 6566 6665 6374 0a0a 6120 7175 6963  e effect..a quic
-000048c0: 6b20 7375 6d6d 6172 7920 6361 6e20 6265  k summary can be
-000048d0: 2073 6565 6e20 7573 696e 6720 602d 2d68   seen using `--h
-000048e0: 656c 702d 6163 636f 756e 7473 600a 0a63  elp-accounts`..c
-000048f0: 6f6e 6669 6775 7269 6e67 2061 6363 6f75  onfiguring accou
-00004900: 6e74 732f 766f 6c75 6d65 7320 7769 7468  nts/volumes with
-00004910: 2061 7267 756d 656e 7473 3a0a 2a20 602d   arguments:.* `-
-00004920: 6120 7573 723a 7077 6460 2061 6464 7320  a usr:pwd` adds 
-00004930: 6163 636f 756e 7420 6075 7372 6020 7769  account `usr` wi
-00004940: 7468 2070 6173 7377 6f72 6420 6070 7764  th password `pwd
-00004950: 600a 2a20 602d 7620 2e3a 3a72 6020 6164  `.* `-v .::r` ad
-00004960: 6473 2063 7572 7265 6e74 2d66 6f6c 6465  ds current-folde
-00004970: 7220 602e 6020 6173 2074 6865 2077 6562  r `.` as the web
-00004980: 726f 6f74 2c20 6072 6065 6164 6162 6c65  root, `r`eadable
-00004990: 2062 7920 616e 796f 6e65 0a20 202a 2074   by anyone.  * t
-000049a0: 6865 2073 796e 7461 7820 6973 2060 2d76  he syntax is `-v
-000049b0: 2073 7263 3a64 7374 3a70 6572 6d3a 7065   src:dst:perm:pe
-000049c0: 726d 3a2e 2e2e 6020 736f 206c 6f63 616c  rm:...` so local
-000049d0: 2d70 6174 682c 2075 726c 2d70 6174 682c  -path, url-path,
-000049e0: 2061 6e64 206f 6e65 206f 7220 6d6f 7265   and one or more
-000049f0: 2070 6572 6d69 7373 696f 6e73 2074 6f20   permissions to 
-00004a00: 7365 740a 2020 2a20 6772 616e 7469 6e67  set.  * granting
-00004a10: 2074 6865 2073 616d 6520 7065 726d 6973   the same permis
-00004a20: 7369 6f6e 7320 746f 206d 756c 7469 706c  sions to multipl
-00004a30: 6520 6163 636f 756e 7473 3a20 200a 2020  e accounts:  .  
-00004a40: 2020 602d 7620 2e3a 3a72 2c75 7372 312c    `-v .::r,usr1,
-00004a50: 7573 7232 3a72 772c 7573 7233 2c75 7372  usr2:rw,usr3,usr
-00004a60: 3460 203d 2075 7372 312f 3220 7265 6164  4` = usr1/2 read
-00004a70: 2d6f 6e6c 792c 2033 2f34 2072 6561 642d  -only, 3/4 read-
-00004a80: 7772 6974 650a 0a70 6572 6d69 7373 696f  write..permissio
-00004a90: 6e73 3a0a 2a20 6072 6020 2872 6561 6429  ns:.* `r` (read)
-00004aa0: 3a20 6272 6f77 7365 2066 6f6c 6465 7220  : browse folder 
-00004ab0: 636f 6e74 656e 7473 2c20 646f 776e 6c6f  contents, downlo
-00004ac0: 6164 2066 696c 6573 2c20 646f 776e 6c6f  ad files, downlo
-00004ad0: 6164 2061 7320 7a69 702f 7461 720a 2a20  ad as zip/tar.* 
-00004ae0: 6077 6020 2877 7269 7465 293a 2075 706c  `w` (write): upl
-00004af0: 6f61 6420 6669 6c65 732c 206d 6f76 6520  oad files, move 
-00004b00: 6669 6c65 7320 2a69 6e74 6f2a 2074 6869  files *into* thi
-00004b10: 7320 666f 6c64 6572 0a2a 2060 6d60 2028  s folder.* `m` (
-00004b20: 6d6f 7665 293a 206d 6f76 6520 6669 6c65  move): move file
-00004b30: 732f 666f 6c64 6572 7320 2a66 726f 6d2a  s/folders *from*
-00004b40: 2074 6869 7320 666f 6c64 6572 0a2a 2060   this folder.* `
-00004b50: 6460 2028 6465 6c65 7465 293a 2064 656c  d` (delete): del
-00004b60: 6574 6520 6669 6c65 732f 666f 6c64 6572  ete files/folder
-00004b70: 730a 2a20 6067 6020 2867 6574 293a 206f  s.* `g` (get): o
-00004b80: 6e6c 7920 646f 776e 6c6f 6164 2066 696c  nly download fil
-00004b90: 6573 2c20 6361 6e6e 6f74 2073 6565 2066  es, cannot see f
-00004ba0: 6f6c 6465 7220 636f 6e74 656e 7473 206f  older contents o
-00004bb0: 7220 7a69 702f 7461 720a 2a20 6047 6020  r zip/tar.* `G` 
-00004bc0: 2875 7067 6574 293a 2073 616d 6520 6173  (upget): same as
-00004bd0: 2060 6760 2065 7863 6570 7420 7570 6c6f   `g` except uplo
-00004be0: 6164 6572 7320 6765 7420 746f 2073 6565  aders get to see
-00004bf0: 2074 6865 6972 206f 776e 2066 696c 656b   their own filek
-00004c00: 6579 7320 2873 6565 2060 666b 6020 696e  eys (see `fk` in
-00004c10: 2065 7861 6d70 6c65 7320 6265 6c6f 7729   examples below)
-00004c20: 0a0a 6578 616d 706c 6573 3a0a 2a20 6164  ..examples:.* ad
-00004c30: 6420 6163 636f 756e 7473 206e 616d 6564  d accounts named
-00004c40: 2075 312c 2075 322c 2075 3320 7769 7468   u1, u2, u3 with
-00004c50: 2070 6173 7377 6f72 6473 2070 312c 2070   passwords p1, p
-00004c60: 322c 2070 333a 2060 2d61 2075 313a 7031  2, p3: `-a u1:p1
-00004c70: 202d 6120 7532 3a70 3220 2d61 2075 333a   -a u2:p2 -a u3:
-00004c80: 7033 600a 2a20 6d61 6b65 2066 6f6c 6465  p3`.* make folde
-00004c90: 7220 602f 7372 7660 2074 6865 2072 6f6f  r `/srv` the roo
-00004ca0: 7420 6f66 2074 6865 2066 696c 6573 7973  t of the filesys
-00004cb0: 7465 6d2c 2072 6561 642d 6f6e 6c79 2062  tem, read-only b
-00004cc0: 7920 616e 796f 6e65 3a20 602d 7620 2f73  y anyone: `-v /s
-00004cd0: 7276 3a3a 7260 0a2a 206d 616b 6520 666f  rv::r`.* make fo
-00004ce0: 6c64 6572 2060 2f6d 6e74 2f6d 7573 6963  lder `/mnt/music
-00004cf0: 6020 6176 6169 6c61 626c 6520 6174 2060  ` available at `
-00004d00: 2f6d 7573 6963 602c 2072 6561 642d 6f6e  /music`, read-on
-00004d10: 6c79 2066 6f72 2075 3120 616e 6420 7532  ly for u1 and u2
-00004d20: 2c20 7265 6164 2d77 7269 7465 2066 6f72  , read-write for
-00004d30: 2075 333a 2060 2d76 202f 6d6e 742f 6d75   u3: `-v /mnt/mu
-00004d40: 7369 633a 6d75 7369 633a 722c 7531 2c75  sic:music:r,u1,u
-00004d50: 323a 7277 2c75 3360 0a20 202a 2075 6e61  2:rw,u3`.  * una
-00004d60: 7574 686f 7269 7a65 6420 7573 6572 7320  uthorized users 
-00004d70: 6163 6365 7373 696e 6720 7468 6520 7765  accessing the we
-00004d80: 6272 6f6f 7420 6361 6e20 7365 6520 7468  broot can see th
-00004d90: 6174 2074 6865 2060 6d75 7369 6360 2066  at the `music` f
-00004da0: 6f6c 6465 7220 6578 6973 7473 2c20 6275  older exists, bu
-00004db0: 7420 6361 6e6e 6f74 206f 7065 6e20 6974  t cannot open it
-00004dc0: 0a2a 206d 616b 6520 666f 6c64 6572 2060  .* make folder `
-00004dd0: 2f6d 6e74 2f69 6e63 6f6d 696e 6760 2061  /mnt/incoming` a
-00004de0: 7661 696c 6162 6c65 2061 7420 602f 696e  vailable at `/in
-00004df0: 6360 2c20 7772 6974 652d 6f6e 6c79 2066  c`, write-only f
-00004e00: 6f72 2075 312c 2072 6561 642d 6d6f 7665  or u1, read-move
-00004e10: 2066 6f72 2075 323a 2060 2d76 202f 6d6e   for u2: `-v /mn
-00004e20: 742f 696e 636f 6d69 6e67 3a69 6e63 3a77  t/incoming:inc:w
-00004e30: 2c75 313a 726d 2c75 3260 0a20 202a 2075  ,u1:rm,u2`.  * u
-00004e40: 6e61 7574 686f 7269 7a65 6420 7573 6572  nauthorized user
-00004e50: 7320 6163 6365 7373 696e 6720 7468 6520  s accessing the 
-00004e60: 7765 6272 6f6f 7420 6361 6e20 7365 6520  webroot can see 
-00004e70: 7468 6174 2074 6865 2060 696e 6360 2066  that the `inc` f
-00004e80: 6f6c 6465 7220 6578 6973 7473 2c20 6275  older exists, bu
-00004e90: 7420 6361 6e6e 6f74 206f 7065 6e20 6974  t cannot open it
-00004ea0: 0a20 202a 2060 7531 6020 6361 6e20 6f70  .  * `u1` can op
-00004eb0: 656e 2074 6865 2060 696e 6360 2066 6f6c  en the `inc` fol
-00004ec0: 6465 722c 2062 7574 2063 616e 6e6f 7420  der, but cannot 
-00004ed0: 7365 6520 7468 6520 636f 6e74 656e 7473  see the contents
-00004ee0: 2c20 6f6e 6c79 2075 706c 6f61 6420 6e65  , only upload ne
-00004ef0: 7720 6669 6c65 7320 746f 2069 740a 2020  w files to it.  
-00004f00: 2a20 6075 3260 2063 616e 2062 726f 7773  * `u2` can brows
-00004f10: 6520 6974 2061 6e64 206d 6f76 6520 6669  e it and move fi
-00004f20: 6c65 7320 2a66 726f 6d2a 2060 2f69 6e63  les *from* `/inc
-00004f30: 6020 696e 746f 2061 6e79 2066 6f6c 6465  ` into any folde
-00004f40: 7220 7768 6572 6520 6075 3260 2068 6173  r where `u2` has
-00004f50: 2077 7269 7465 2d61 6363 6573 730a 2a20   write-access.* 
-00004f60: 6d61 6b65 2066 6f6c 6465 7220 602f 6d6e  make folder `/mn
-00004f70: 742f 7373 6020 6176 6169 6c61 626c 6520  t/ss` available 
-00004f80: 6174 2060 2f69 602c 2072 6561 642d 7772  at `/i`, read-wr
-00004f90: 6974 6520 666f 7220 7531 2c20 6765 742d  ite for u1, get-
-00004fa0: 6f6e 6c79 2066 6f72 2065 7665 7279 6f6e  only for everyon
-00004fb0: 6520 656c 7365 2c20 616e 6420 656e 6162  e else, and enab
-00004fc0: 6c65 2066 696c 656b 6579 733a 2060 2d76  le filekeys: `-v
-00004fd0: 202f 6d6e 742f 7373 3a69 3a72 772c 7531   /mnt/ss:i:rw,u1
-00004fe0: 3a67 3a63 2c66 6b3d 3460 0a20 202a 2060  :g:c,fk=4`.  * `
-00004ff0: 632c 666b 3d34 6020 7365 7473 2074 6865  c,fk=4` sets the
-00005000: 2060 666b 6020 2866 696c 656b 6579 2920   `fk` (filekey) 
-00005010: 766f 6c66 6c61 6720 746f 2034 2c20 6d65  volflag to 4, me
-00005020: 616e 696e 6720 6561 6368 2066 696c 6520  aning each file 
-00005030: 6765 7473 2061 2034 2d63 6861 7261 6374  gets a 4-charact
-00005040: 6572 2061 6363 6573 736b 6579 0a20 202a  er accesskey.  *
-00005050: 2060 7531 6020 6361 6e20 7570 6c6f 6164   `u1` can upload
-00005060: 2066 696c 6573 2c20 6272 6f77 7365 2074   files, browse t
-00005070: 6865 2066 6f6c 6465 722c 2061 6e64 2073  he folder, and s
-00005080: 6565 2074 6865 2067 656e 6572 6174 6564  ee the generated
-00005090: 2066 696c 656b 6579 730a 2020 2a20 6f74   filekeys.  * ot
-000050a0: 6865 7220 7573 6572 7320 6361 6e6e 6f74  her users cannot
-000050b0: 2062 726f 7773 6520 7468 6520 666f 6c64   browse the fold
-000050c0: 6572 2c20 6275 7420 6361 6e20 6163 6365  er, but can acce
-000050d0: 7373 2074 6865 2066 696c 6573 2069 6620  ss the files if 
-000050e0: 7468 6579 2068 6176 6520 7468 6520 6675  they have the fu
-000050f0: 6c6c 2066 696c 6520 5552 4c20 7769 7468  ll file URL with
-00005100: 2074 6865 2066 696c 656b 6579 0a20 202a   the filekey.  *
-00005110: 2072 6570 6c61 6369 6e67 2074 6865 2060   replacing the `
-00005120: 6760 2070 6572 6d69 7373 696f 6e20 7769  g` permission wi
-00005130: 7468 2060 7767 6020 776f 756c 6420 6c65  th `wg` would le
-00005140: 7420 616e 6f6e 796d 6f75 7320 7573 6572  t anonymous user
-00005150: 7320 7570 6c6f 6164 2066 696c 6573 2c20  s upload files, 
-00005160: 6275 7420 6e6f 7420 7365 6520 7468 6520  but not see the 
-00005170: 7265 7175 6972 6564 2066 696c 656b 6579  required filekey
-00005180: 2074 6f20 6163 6365 7373 2069 740a 2020   to access it.  
-00005190: 2a20 7265 706c 6163 696e 6720 7468 6520  * replacing the 
-000051a0: 6067 6020 7065 726d 6973 7369 6f6e 2077  `g` permission w
-000051b0: 6974 6820 6077 4760 2077 6f75 6c64 206c  ith `wG` would l
-000051c0: 6574 2061 6e6f 6e79 6d6f 7573 2075 7365  et anonymous use
-000051d0: 7273 2075 706c 6f61 6420 6669 6c65 732c  rs upload files,
-000051e0: 2072 6563 6569 7669 6e67 2061 2077 6f72   receiving a wor
-000051f0: 6b69 6e67 2064 6972 6563 7420 6c69 6e6b  king direct link
-00005200: 2069 6e20 7265 7475 726e 0a0a 616e 796f   in return..anyo
-00005210: 6e65 2074 7279 696e 6720 746f 2062 7275  ne trying to bru
-00005220: 7465 666f 7263 6520 6120 7061 7373 776f  teforce a passwo
-00005230: 7264 2067 6574 7320 6261 6e6e 6564 2061  rd gets banned a
-00005240: 6363 6f72 6469 6e67 2074 6f20 602d 2d62  ccording to `--b
-00005250: 616e 2d70 7760 3b20 6465 6661 756c 7420  an-pw`; default 
-00005260: 6973 2032 3468 2062 616e 2066 6f72 2039  is 24h ban for 9
-00005270: 2066 6169 6c65 6420 6174 7465 6d70 7473   failed attempts
-00005280: 2069 6e20 3120 686f 7572 0a0a 0a23 2320   in 1 hour...## 
-00005290: 7368 6164 6f77 696e 670a 0a68 6964 696e  shadowing..hidin
-000052a0: 6720 7370 6563 6966 6963 2073 7562 666f  g specific subfo
-000052b0: 6c64 6572 7320 2062 7920 6d6f 756e 7469  lders  by mounti
-000052c0: 6e67 2061 6e6f 7468 6572 2076 6f6c 756d  ng another volum
-000052d0: 6520 6f6e 2074 6f70 206f 6620 7468 656d  e on top of them
-000052e0: 0a0a 666f 7220 6578 616d 706c 6520 602d  ..for example `-
-000052f0: 7620 2f6d 6e74 3a3a 7220 2d76 202f 7661  v /mnt::r -v /va
-00005300: 722f 656d 7074 793a 7765 622f 6365 7274  r/empty:web/cert
-00005310: 733a 7260 206d 6f75 6e74 7320 7468 6520  s:r` mounts the 
-00005320: 7365 7276 6572 2066 6f6c 6465 7220 602f  server folder `/
-00005330: 6d6e 7460 2061 7320 7468 6520 7765 6272  mnt` as the webr
-00005340: 6f6f 742c 2062 7574 2061 6e6f 7468 6572  oot, but another
-00005350: 2076 6f6c 756d 6520 6973 206d 6f75 6e74   volume is mount
-00005360: 6564 2061 7420 602f 7765 622f 6365 7274  ed at `/web/cert
-00005370: 7360 202d 2d20 736f 2076 6973 6974 6f72  s` -- so visitor
-00005380: 7320 6361 6e20 6f6e 6c79 2073 6565 2074  s can only see t
-00005390: 6865 2063 6f6e 7465 6e74 7320 6f66 2060  he contents of `
-000053a0: 2f6d 6e74 6020 616e 6420 602f 6d6e 742f  /mnt` and `/mnt/
-000053b0: 7765 6260 2028 6174 2055 524c 7320 602f  web` (at URLs `/
-000053c0: 6020 616e 6420 602f 7765 6260 292c 2062  ` and `/web`), b
-000053d0: 7574 206e 6f74 2060 2f6d 6e74 2f77 6562  ut not `/mnt/web
-000053e0: 2f63 6572 7473 6020 6265 6361 7573 6520  /certs` because 
-000053f0: 5552 4c20 602f 7765 622f 6365 7274 7360  URL `/web/certs`
-00005400: 2069 7320 6d61 7070 6564 2074 6f20 602f   is mapped to `/
-00005410: 7661 722f 656d 7074 7960 0a0a 0a23 2074  var/empty`...# t
-00005420: 6865 2062 726f 7773 6572 0a0a 6163 6365  he browser..acce
-00005430: 7373 696e 6720 6120 636f 7079 7061 7274  ssing a copypart
-00005440: 7920 7365 7276 6572 2075 7369 6e67 2061  y server using a
-00005450: 2077 6562 2d62 726f 7773 6572 0a0a 215b   web-browser..![
-00005460: 636f 7079 7061 7274 792d 6272 6f77 7365  copyparty-browse
-00005470: 722d 6673 385d 2868 7474 7073 3a2f 2f75  r-fs8](https://u
-00005480: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00005490: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-000054a0: 2f32 3431 3033 322f 3139 3230 3432 3639  /241032/19204269
-000054b0: 352d 3532 3262 3365 6337 2d36 3834 352d  5-522b3ec7-6845-
-000054c0: 3439 3461 2d61 6264 622d 6431 6330 6430  494a-abdb-d1c0d0
-000054d0: 6532 3338 3031 2e70 6e67 290a 0a0a 2323  e23801.png)...##
-000054e0: 2074 6162 730a 0a74 6865 206d 6169 6e20   tabs..the main 
-000054f0: 7461 6273 2069 6e20 7468 6520 7569 0a2a  tabs in the ui.*
-00005500: 2060 5bf0 9f94 8e5d 6020 5b73 6561 7263   `[....]` [searc
-00005510: 685d 2823 7365 6172 6368 696e 6729 2062  h](#searching) b
-00005520: 7920 7369 7a65 2c20 6461 7465 2c20 7061  y size, date, pa
-00005530: 7468 2f6e 616d 652c 206d 7033 2d74 6167  th/name, mp3-tag
-00005540: 7320 2e2e 2e0a 2a20 605b f09f a7af 5d60  s ....* `[....]`
-00005550: 205b 756e 706f 7374 5d28 2375 6e70 6f73   [unpost](#unpos
-00005560: 7429 3a20 756e 646f 2f64 656c 6574 6520  t): undo/delete 
-00005570: 6163 6369 6465 6e74 616c 2075 706c 6f61  accidental uploa
-00005580: 6473 0a2a 2060 5bf0 9f9a 805d 6020 616e  ds.* `[....]` an
-00005590: 6420 605b f09f 8e88 5d60 2061 7265 2074  d `[....]` are t
-000055a0: 6865 205b 7570 6c6f 6164 6572 735d 2823  he [uploaders](#
-000055b0: 7570 6c6f 6164 696e 6729 0a2a 2060 5bf0  uploading).* `[.
-000055c0: 9f93 825d 6020 6d6b 6469 723a 2063 7265  ...]` mkdir: cre
-000055d0: 6174 6520 6469 7265 6374 6f72 6965 730a  ate directories.
-000055e0: 2a20 605b f09f 939d 5d60 206e 6577 2d6d  * `[....]` new-m
-000055f0: 643a 2063 7265 6174 6520 6120 6e65 7720  d: create a new 
-00005600: 6d61 726b 646f 776e 2064 6f63 756d 656e  markdown documen
-00005610: 740a 2a20 605b f09f 939f 5d60 2073 656e  t.* `[....]` sen
-00005620: 642d 6d73 673a 2065 6974 6865 7220 746f  d-msg: either to
-00005630: 2073 6572 7665 722d 6c6f 6720 6f72 2069   server-log or i
-00005640: 6e74 6f20 7465 7874 6669 6c65 7320 6966  nto textfiles if
-00005650: 2060 2d2d 7572 6c66 6f72 6d20 7361 7665   `--urlform save
-00005660: 600a 2a20 605b f09f 8eba 5d60 2061 7564  `.* `[....]` aud
-00005670: 696f 2d70 6c61 7965 7220 636f 6e66 6967  io-player config
-00005680: 206f 7074 696f 6e73 0a2a 2060 5be2 9a99   options.* `[...
-00005690: efb8 8f5d 6020 6765 6e65 7261 6c20 636c  ...]` general cl
-000056a0: 6965 6e74 2063 6f6e 6669 6720 6f70 7469  ient config opti
-000056b0: 6f6e 730a 0a0a 2323 2068 6f74 6b65 7973  ons...## hotkeys
-000056c0: 0a0a 7468 6520 6272 6f77 7365 7220 6861  ..the browser ha
-000056d0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
-000056e0: 686f 746b 6579 7320 2028 616c 7761 7973  hotkeys  (always
-000056f0: 2071 7765 7274 7929 0a2a 2060 3f60 2073   qwerty).* `?` s
-00005700: 686f 7720 686f 746b 6579 7320 6865 6c70  how hotkeys help
-00005710: 0a2a 2060 4260 2074 6f67 676c 6520 6272  .* `B` toggle br
-00005720: 6561 6463 7275 6d62 7320 2f20 5b6e 6176  eadcrumbs / [nav
-00005730: 7061 6e65 5d28 236e 6176 7061 6e65 290a  pane](#navpane).
-00005740: 2a20 6049 2f4b 6020 7072 6576 2f6e 6578  * `I/K` prev/nex
-00005750: 7420 666f 6c64 6572 0a2a 2060 4d60 2070  t folder.* `M` p
-00005760: 6172 656e 7420 666f 6c64 6572 2028 6f72  arent folder (or
-00005770: 2075 6e65 7870 616e 6420 6375 7272 656e   unexpand curren
-00005780: 7429 0a2a 2060 5660 2074 6f67 676c 6520  t).* `V` toggle 
-00005790: 666f 6c64 6572 7320 2f20 7465 7874 6669  folders / textfi
-000057a0: 6c65 7320 696e 2074 6865 206e 6176 7061  les in the navpa
-000057b0: 6e65 0a2a 2060 4760 2074 6f67 676c 6520  ne.* `G` toggle 
-000057c0: 6c69 7374 202f 205b 6772 6964 2076 6965  list / [grid vie
-000057d0: 775d 2823 7468 756d 626e 6169 6c73 2920  w](#thumbnails) 
-000057e0: 2d2d 2073 616d 6520 6173 2060 e794 b060  -- same as `...`
-000057f0: 2062 6f74 746f 6d2d 7269 6768 740a 2a20   bottom-right.* 
-00005800: 6054 6020 746f 6767 6c65 2074 6875 6d62  `T` toggle thumb
-00005810: 6e61 696c 7320 2f20 6963 6f6e 730a 2a20  nails / icons.* 
-00005820: 6045 5343 6020 636c 6f73 6520 7661 7269  `ESC` close vari
-00005830: 6f75 7320 7468 696e 6773 0a2a 2060 6374  ous things.* `ct
-00005840: 726c 2d4b 6020 6465 6c65 7465 2073 656c  rl-K` delete sel
-00005850: 6563 7465 6420 6669 6c65 732f 666f 6c64  ected files/fold
-00005860: 6572 730a 2a20 6063 7472 6c2d 5860 2063  ers.* `ctrl-X` c
-00005870: 7574 2073 656c 6563 7465 6420 6669 6c65  ut selected file
-00005880: 732f 666f 6c64 6572 730a 2a20 6063 7472  s/folders.* `ctr
-00005890: 6c2d 5660 2070 6173 7465 0a2a 2060 5960  l-V` paste.* `Y`
-000058a0: 2064 6f77 6e6c 6f61 6420 7365 6c65 6374   download select
-000058b0: 6564 2066 696c 6573 0a2a 2060 4632 6020  ed files.* `F2` 
-000058c0: 5b72 656e 616d 655d 2823 6261 7463 682d  [rename](#batch-
-000058d0: 7265 6e61 6d65 2920 7365 6c65 6374 6564  rename) selected
-000058e0: 2066 696c 652f 666f 6c64 6572 0a2a 2077   file/folder.* w
-000058f0: 6865 6e20 6120 6669 6c65 2f66 6f6c 6465  hen a file/folde
-00005900: 7220 6973 2073 656c 6563 7465 6420 2869  r is selected (i
-00005910: 6e20 6e6f 742d 6772 6964 2d76 6965 7729  n not-grid-view)
-00005920: 3a0a 2020 2a20 6055 702f 446f 776e 6020  :.  * `Up/Down` 
-00005930: 6d6f 7665 2063 7572 736f 720a 2020 2a20  move cursor.  * 
-00005940: 7368 6966 742b 6055 702f 446f 776e 6020  shift+`Up/Down` 
-00005950: 7365 6c65 6374 2061 6e64 206d 6f76 6520  select and move 
-00005960: 6375 7273 6f72 0a20 202a 2063 7472 6c2b  cursor.  * ctrl+
-00005970: 6055 702f 446f 776e 6020 6d6f 7665 2063  `Up/Down` move c
-00005980: 7572 736f 7220 616e 6420 7363 726f 6c6c  ursor and scroll
-00005990: 2076 6965 7770 6f72 740a 2020 2a20 6053   viewport.  * `S
-000059a0: 7061 6365 6020 746f 6767 6c65 2066 696c  pace` toggle fil
-000059b0: 6520 7365 6c65 6374 696f 6e0a 2020 2a20  e selection.  * 
-000059c0: 6043 7472 6c2d 4160 2074 6f67 676c 6520  `Ctrl-A` toggle 
-000059d0: 7365 6c65 6374 2061 6c6c 0a2a 2077 6865  select all.* whe
-000059e0: 6e20 6120 7465 7874 6669 6c65 2069 7320  n a textfile is 
-000059f0: 6f70 656e 3a0a 2020 2a20 6049 2f4b 6020  open:.  * `I/K` 
-00005a00: 7072 6576 2f6e 6578 7420 7465 7874 6669  prev/next textfi
-00005a10: 6c65 0a20 202a 2060 5360 2074 6f67 676c  le.  * `S` toggl
-00005a20: 6520 7365 6c65 6374 696f 6e20 6f66 206f  e selection of o
-00005a30: 7065 6e20 6669 6c65 0a20 202a 2060 4d60  pen file.  * `M`
-00005a40: 2063 6c6f 7365 2074 6578 7466 696c 650a   close textfile.
-00005a50: 2a20 7768 656e 2070 6c61 7969 6e67 2061  * when playing a
-00005a60: 7564 696f 3a0a 2020 2a20 604a 2f4c 6020  udio:.  * `J/L` 
-00005a70: 7072 6576 2f6e 6578 7420 736f 6e67 0a20  prev/next song. 
-00005a80: 202a 2060 552f 4f60 2073 6b69 7020 3130   * `U/O` skip 10
-00005a90: 7365 6320 6261 636b 2f66 6f72 7761 7264  sec back/forward
-00005aa0: 0a20 202a 2060 302e 2e39 6020 6a75 6d70  .  * `0..9` jump
-00005ab0: 2074 6f20 3025 2e2e 3930 250a 2020 2a20   to 0%..90%.  * 
-00005ac0: 6050 6020 706c 6179 2f70 6175 7365 2028  `P` play/pause (
-00005ad0: 616c 736f 2073 7461 7274 7320 706c 6179  also starts play
-00005ae0: 696e 6720 7468 6520 666f 6c64 6572 290a  ing the folder).
-00005af0: 2020 2a20 6059 6020 646f 776e 6c6f 6164    * `Y` download
-00005b00: 2066 696c 650a 2a20 7768 656e 2076 6965   file.* when vie
-00005b10: 7769 6e67 2069 6d61 6765 7320 2f20 706c  wing images / pl
-00005b20: 6179 696e 6720 7669 6465 6f73 3a0a 2020  aying videos:.  
-00005b30: 2a20 604a 2f4c 2c20 4c65 6674 2f52 6967  * `J/L, Left/Rig
-00005b40: 6874 6020 7072 6576 2f6e 6578 7420 6669  ht` prev/next fi
-00005b50: 6c65 0a20 202a 2060 486f 6d65 2f45 6e64  le.  * `Home/End
-00005b60: 6020 6669 7273 742f 6c61 7374 2066 696c  ` first/last fil
-00005b70: 650a 2020 2a20 6046 6020 746f 6767 6c65  e.  * `F` toggle
-00005b80: 2066 756c 6c73 6372 6565 6e0a 2020 2a20   fullscreen.  * 
-00005b90: 6053 6020 746f 6767 6c65 2073 656c 6563  `S` toggle selec
-00005ba0: 7469 6f6e 0a20 202a 2060 5260 2072 6f74  tion.  * `R` rot
-00005bb0: 6174 6520 636c 6f63 6b77 6973 6520 2873  ate clockwise (s
-00005bc0: 6869 6674 3d63 6377 290a 2020 2a20 6059  hift=ccw).  * `Y
-00005bd0: 6020 646f 776e 6c6f 6164 2066 696c 650a  ` download file.
-00005be0: 2020 2a20 6045 7363 6020 636c 6f73 6520    * `Esc` close 
-00005bf0: 7669 6577 6572 0a20 202a 2076 6964 656f  viewer.  * video
-00005c00: 733a 0a20 2020 202a 2060 552f 4f60 2073  s:.    * `U/O` s
-00005c10: 6b69 7020 3130 7365 6320 6261 636b 2f66  kip 10sec back/f
-00005c20: 6f72 7761 7264 0a20 2020 202a 2060 302e  orward.    * `0.
-00005c30: 2e39 6020 6a75 6d70 2074 6f20 3025 2e2e  .9` jump to 0%..
-00005c40: 3930 250a 2020 2020 2a20 6050 2f4b 2f53  90%.    * `P/K/S
-00005c50: 7061 6365 6020 706c 6179 2f70 6175 7365  pace` play/pause
-00005c60: 0a20 2020 202a 2060 4d60 206d 7574 650a  .    * `M` mute.
-00005c70: 2020 2020 2a20 6043 6020 636f 6e74 696e      * `C` contin
-00005c80: 7565 2070 6c61 7969 6e67 206e 6578 7420  ue playing next 
-00005c90: 7669 6465 6f0a 2020 2020 2a20 6056 6020  video.    * `V` 
-00005ca0: 6c6f 6f70 2065 6e74 6972 6520 6669 6c65  loop entire file
-00005cb0: 0a20 2020 202a 2060 5b60 206c 6f6f 7020  .    * `[` loop 
-00005cc0: 7261 6e67 6520 2873 7461 7274 290a 2020  range (start).  
-00005cd0: 2020 2a20 605d 6020 6c6f 6f70 2072 616e    * `]` loop ran
-00005ce0: 6765 2028 656e 6429 0a2a 2077 6865 6e20  ge (end).* when 
-00005cf0: 7468 6520 6e61 7670 616e 6520 6973 206f  the navpane is o
-00005d00: 7065 6e3a 0a20 202a 2060 412f 4460 2061  pen:.  * `A/D` a
-00005d10: 646a 7573 7420 7472 6565 2077 6964 7468  djust tree width
-00005d20: 0a2a 2069 6e20 7468 6520 5b67 7269 6420  .* in the [grid 
-00005d30: 7669 6577 5d28 2374 6875 6d62 6e61 696c  view](#thumbnail
-00005d40: 7329 3a0a 2020 2a20 6053 6020 746f 6767  s):.  * `S` togg
-00005d50: 6c65 206d 756c 7469 7365 6c65 6374 0a20  le multiselect. 
-00005d60: 202a 2073 6869 6674 2b60 412f 4460 207a   * shift+`A/D` z
-00005d70: 6f6f 6d0a 2a20 696e 2074 6865 206d 6172  oom.* in the mar
-00005d80: 6b64 6f77 6e20 6564 6974 6f72 3a0a 2020  kdown editor:.  
-00005d90: 2a20 605e 7360 2073 6176 650a 2020 2a20  * `^s` save.  * 
-00005da0: 605e 6860 2068 6561 6465 720a 2020 2a20  `^h` header.  * 
-00005db0: 605e 6b60 2061 7574 6f66 6f72 6d61 7420  `^k` autoformat 
-00005dc0: 7461 626c 650a 2020 2a20 605e 7560 206a  table.  * `^u` j
-00005dd0: 756d 7020 746f 206e 6578 7420 756e 6963  ump to next unic
-00005de0: 6f64 6520 6368 6172 6163 7465 720a 2020  ode character.  
-00005df0: 2a20 605e 6560 2074 6f67 676c 6520 6564  * `^e` toggle ed
-00005e00: 6974 6f72 202f 2070 7265 7669 6577 0a20  itor / preview. 
-00005e10: 202a 2060 5e75 702c 205e 646f 776e 6020   * `^up, ^down` 
-00005e20: 6a75 6d70 2070 6172 6167 7261 7068 730a  jump paragraphs.
-00005e30: 0a0a 2323 206e 6176 7061 6e65 0a0a 7377  ..## navpane..sw
-00005e40: 6974 6368 696e 6720 6265 7477 6565 6e20  itching between 
-00005e50: 6272 6561 6463 7275 6d62 7320 6f72 206e  breadcrumbs or n
-00005e60: 6176 7061 6e65 0a0a 636c 6963 6b20 7468  avpane..click th
-00005e70: 6520 60f0 9f8c b260 206f 7220 7072 6573  e `....` or pres
-00005e80: 7369 6e67 2074 6865 2060 4260 2068 6f74  sing the `B` hot
-00005e90: 6b65 7920 746f 2074 6f67 676c 6520 6265  key to toggle be
-00005ea0: 7477 6565 6e20 6272 6561 6463 7275 6d62  tween breadcrumb
-00005eb0: 7320 7061 7468 2028 6465 6661 756c 7429  s path (default)
-00005ec0: 2c20 6f72 2061 206e 6176 7061 6e65 2028  , or a navpane (
-00005ed0: 7472 6565 2d62 726f 7773 6572 2073 6964  tree-browser sid
-00005ee0: 6562 6172 2074 6869 6e67 290a 0a2a 2060  ebar thing)..* `
-00005ef0: 5b2b 5d60 2061 6e64 2060 5b2d 5d60 2028  [+]` and `[-]` (
-00005f00: 6f72 2068 6f74 6b65 7973 2060 4160 2f60  or hotkeys `A`/`
-00005f10: 4460 2920 6164 6a75 7374 2074 6865 2073  D`) adjust the s
-00005f20: 697a 650a 2a20 605b f09f 8eaf 5d60 206a  ize.* `[....]` j
-00005f30: 756d 7073 2074 6f20 7468 6520 6375 7272  umps to the curr
-00005f40: 656e 746c 7920 6f70 656e 2066 6f6c 6465  ently open folde
-00005f50: 720a 2a20 605b f09f 9383 5d60 2074 6f67  r.* `[....]` tog
-00005f60: 676c 6573 2062 6574 7765 656e 2073 686f  gles between sho
-00005f70: 7769 6e67 2066 6f6c 6465 7273 2061 6e64  wing folders and
-00005f80: 2074 6578 7466 696c 6573 0a2a 2060 5bf0   textfiles.* `[.
-00005f90: 9f93 8c5d 6020 7368 6f77 7320 7468 6520  ...]` shows the 
-00005fa0: 6e61 6d65 206f 6620 616c 6c20 7061 7265  name of all pare
-00005fb0: 6e74 2066 6f6c 6465 7273 2069 6e20 6120  nt folders in a 
-00005fc0: 646f 636b 6564 2070 616e 656c 0a2a 2060  docked panel.* `
-00005fd0: 5b61 5d60 2074 6f67 676c 6573 2061 7574  [a]` toggles aut
-00005fe0: 6f6d 6174 6963 2077 6964 656e 696e 6720  omatic widening 
-00005ff0: 6173 2079 6f75 2067 6f20 6465 6570 6572  as you go deeper
-00006000: 0a2a 2060 5be2 86b5 5d60 2074 6f67 676c  .* `[...]` toggl
-00006010: 6573 2077 6f72 6477 7261 700a 2a20 605b  es wordwrap.* `[
-00006020: f09f 9180 5d60 2073 686f 7720 6675 6c6c  ....]` show full
-00006030: 206e 616d 6520 6f6e 2068 6f76 6572 2028   name on hover (
-00006040: 6966 2077 6f72 6477 7261 7020 6973 206f  if wordwrap is o
-00006050: 6666 290a 0a0a 2323 2074 6875 6d62 6e61  ff)...## thumbna
-00006060: 696c 730a 0a70 7265 7373 2060 6760 206f  ils..press `g` o
-00006070: 7220 60e7 94b0 6020 746f 2074 6f67 676c  r `...` to toggl
-00006080: 6520 6772 6964 2d76 6965 7720 696e 7374  e grid-view inst
-00006090: 6561 6420 6f66 2074 6865 2066 696c 6520  ead of the file 
-000060a0: 6c69 7374 696e 6720 2061 6e64 2060 7460  listing  and `t`
-000060b0: 2074 6f67 676c 6573 2069 636f 6e73 202f   toggles icons /
-000060c0: 2074 6875 6d62 6e61 696c 730a 0a21 5b63   thumbnails..![c
-000060d0: 6f70 7970 6172 7479 2d74 6875 6d62 732d  opyparty-thumbs-
-000060e0: 6673 385d 2868 7474 7073 3a2f 2f75 7365  fs8](https://use
-000060f0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00006100: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-00006110: 3431 3033 322f 3132 3936 3336 3231 312d  41032/129636211-
-00006120: 6162 6432 3066 6132 2d61 3935 332d 3433  abd20fa2-a953-43
-00006130: 3636 2d39 3432 332d 3163 3838 6562 6239  66-9423-1c88ebb9
-00006140: 3662 6139 2e70 6e67 290a 0a69 7420 646f  6ba9.png)..it do
-00006150: 6573 2073 7461 7469 6320 696d 6167 6573  es static images
-00006160: 2077 6974 6820 5069 6c6c 6f77 202f 2070   with Pillow / p
-00006170: 7976 6970 7320 2f20 4646 6d70 6567 2c20  yvips / FFmpeg, 
-00006180: 616e 6420 7573 6573 2046 466d 7065 6720  and uses FFmpeg 
-00006190: 666f 7220 7669 6465 6f20 6669 6c65 732c  for video files,
-000061a0: 2073 6f20 796f 7520 6d61 7920 7761 6e74   so you may want
-000061b0: 2074 6f20 602d 2d6e 6f2d 7468 756d 6260   to `--no-thumb`
-000061c0: 206f 7220 6d61 7962 6520 6a75 7374 2060   or maybe just `
-000061d0: 2d2d 6e6f 2d76 7468 756d 6260 2064 6570  --no-vthumb` dep
-000061e0: 656e 6469 6e67 206f 6e20 686f 7720 6461  ending on how da
-000061f0: 6e67 6572 6f75 7320 796f 7572 2075 7365  ngerous your use
-00006200: 7273 2061 7265 0a2a 2070 7976 6970 7320  rs are.* pyvips 
-00006210: 6973 2033 7820 6661 7374 6572 2074 6861  is 3x faster tha
-00006220: 6e20 5069 6c6c 6f77 2c20 5069 6c6c 6f77  n Pillow, Pillow
-00006230: 2069 7320 3378 2066 6173 7465 7220 7468   is 3x faster th
-00006240: 616e 2046 466d 7065 670a 2a20 6469 7361  an FFmpeg.* disa
-00006250: 626c 6520 7468 756d 626e 6169 6c73 2066  ble thumbnails f
-00006260: 6f72 2073 7065 6369 6669 6320 766f 6c75  or specific volu
-00006270: 6d65 7320 7769 7468 2076 6f6c 666c 6167  mes with volflag
-00006280: 2060 6474 6875 6d62 6020 666f 7220 616c   `dthumb` for al
-00006290: 6c2c 206f 7220 6064 7674 6875 6d62 6020  l, or `dvthumb` 
-000062a0: 2f20 6064 6174 6875 6d62 6020 2f20 6064  / `dathumb` / `d
-000062b0: 6974 6875 6d62 6020 666f 7220 7669 6465  ithumb` for vide
-000062c0: 6f2f 6175 6469 6f2f 696d 6167 6573 206f  o/audio/images o
-000062d0: 6e6c 790a 0a61 7564 696f 2066 696c 6573  nly..audio files
-000062e0: 2061 7265 2063 6f76 6e65 7274 6564 2069   are covnerted i
-000062f0: 6e74 6f20 7370 6563 7472 6f67 7261 6d73  nto spectrograms
-00006300: 2075 7369 6e67 2046 466d 7065 6720 756e   using FFmpeg un
-00006310: 6c65 7373 2079 6f75 2060 2d2d 6e6f 2d61  less you `--no-a
-00006320: 7468 756d 6260 2028 616e 6420 736f 6d65  thumb` (and some
-00006330: 2046 466d 7065 6720 6275 696c 6473 206d   FFmpeg builds m
-00006340: 6179 206e 6565 6420 602d 2d74 682d 6666  ay need `--th-ff
-00006350: 2d73 7772 6029 0a0a 696d 6167 6573 2077  -swr`)..images w
-00006360: 6974 6820 7468 6520 666f 6c6c 6f77 696e  ith the followin
-00006370: 6720 6e61 6d65 7320 2873 6565 2060 2d2d  g names (see `--
-00006380: 7468 2d63 6f76 6572 7360 2920 6265 636f  th-covers`) beco
-00006390: 6d65 2074 6865 2074 6875 6d62 6e61 696c  me the thumbnail
-000063a0: 206f 6620 7468 6520 666f 6c64 6572 2074   of the folder t
-000063b0: 6865 7927 7265 2069 6e3a 2060 666f 6c64  hey're in: `fold
-000063c0: 6572 2e70 6e67 602c 2060 666f 6c64 6572  er.png`, `folder
-000063d0: 2e6a 7067 602c 2060 636f 7665 722e 706e  .jpg`, `cover.pn
-000063e0: 6760 2c20 6063 6f76 6572 2e6a 7067 600a  g`, `cover.jpg`.
-000063f0: 0a69 6e20 7468 6520 6772 6964 2f74 6875  .in the grid/thu
-00006400: 6d62 6e61 696c 2076 6965 772c 2069 6620  mbnail view, if 
-00006410: 7468 6520 6175 6469 6f20 706c 6179 6572  the audio player
-00006420: 2070 616e 656c 2069 7320 6f70 656e 2c20   panel is open, 
-00006430: 736f 6e67 7320 7769 6c6c 2073 7461 7274  songs will start
-00006440: 2070 6c61 7969 6e67 2077 6865 6e20 636c   playing when cl
-00006450: 6963 6b65 640a 2a20 696e 6469 6361 7465  icked.* indicate
-00006460: 6420 6279 2074 6865 2061 7564 696f 2066  d by the audio f
-00006470: 696c 6573 2068 6176 696e 6720 7468 6520  iles having the 
-00006480: e296 b620 6963 6f6e 2069 6e73 7465 6164  ... icon instead
-00006490: 206f 6620 f09f 92be 0a0a 0a23 2320 7a69   of .......## zi
-000064a0: 7020 646f 776e 6c6f 6164 730a 0a64 6f77  p downloads..dow
-000064b0: 6e6c 6f61 6420 666f 6c64 6572 7320 286f  nload folders (o
-000064c0: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
-000064d0: 7329 2061 7320 607a 6970 6020 6f72 2060  s) as `zip` or `
-000064e0: 7461 7260 2066 696c 6573 0a0a 7365 6c65  tar` files..sele
-000064f0: 6374 2077 6869 6368 2074 7970 6520 6f66  ct which type of
-00006500: 2061 7263 6869 7665 2079 6f75 2077 616e   archive you wan
-00006510: 7420 696e 2074 6865 2060 5be2 9a99 efb8  t in the `[.....
-00006520: 8f5d 2063 6f6e 6669 6760 2074 6162 3a0a  .] config` tab:.
-00006530: 0a7c 206e 616d 6520 7c20 7572 6c2d 7375  .| name | url-su
-00006540: 6666 6978 207c 2064 6573 6372 6970 7469  ffix | descripti
-00006550: 6f6e 207c 0a7c 2d2d 7c2d 2d7c 2d2d 7c0a  on |.|--|--|--|.
-00006560: 7c20 6074 6172 6020 7c20 603f 7461 7260  | `tar` | `?tar`
-00006570: 207c 2070 6c61 696e 2067 6e75 7461 722c   | plain gnutar,
-00006580: 2077 6f72 6b73 2067 7265 6174 2077 6974   works great wit
-00006590: 6820 6063 7572 6c20 5c7c 2074 6172 202d  h `curl \| tar -
-000065a0: 7876 6020 7c0a 7c20 607a 6970 6020 7c20  xv` |.| `zip` | 
-000065b0: 603f 7a69 703d 7574 6638 6020 7c20 776f  `?zip=utf8` | wo
-000065c0: 726b 7320 6576 6572 7977 6865 7265 2c20  rks everywhere, 
-000065d0: 676c 6974 6368 7920 6669 6c65 6e61 6d65  glitchy filename
-000065e0: 7320 6f6e 2077 696e 3720 616e 6420 6f6c  s on win7 and ol
-000065f0: 6465 7220 7c0a 7c20 607a 6970 5f64 6f73  der |.| `zip_dos
-00006600: 6020 7c20 603f 7a69 7060 207c 2074 7261  ` | `?zip` | tra
-00006610: 6469 7469 6f6e 616c 2063 7034 3337 2028  ditional cp437 (
-00006620: 6e6f 2075 6e69 636f 6465 2920 746f 2066  no unicode) to f
-00006630: 6978 2067 6c69 7463 6879 2066 696c 656e  ix glitchy filen
-00006640: 616d 6573 207c 0a7c 2060 7a69 705f 6372  ames |.| `zip_cr
-00006650: 6360 207c 2060 3f7a 6970 3d63 7263 6020  c` | `?zip=crc` 
-00006660: 7c20 6370 3433 3720 7769 7468 2063 7263  | cp437 with crc
-00006670: 3332 2063 6f6d 7075 7465 6420 6561 726c  32 computed earl
-00006680: 7920 666f 7220 7472 756c 7920 616e 6369  y for truly anci
-00006690: 656e 7420 736f 6674 7761 7265 207c 0a0a  ent software |..
-000066a0: 2a20 6869 6464 656e 2066 696c 6573 2028  * hidden files (
-000066b0: 646f 7466 696c 6573 2920 6172 6520 6578  dotfiles) are ex
-000066c0: 636c 7564 6564 2075 6e6c 6573 7320 602d  cluded unless `-
-000066d0: 6564 600a 2020 2a20 6075 7032 6b2e 6462  ed`.  * `up2k.db
-000066e0: 6020 616e 6420 6064 6972 2e74 7874 6020  ` and `dir.txt` 
-000066f0: 6973 2061 6c77 6179 7320 6578 636c 7564  is always exclud
-00006700: 6564 0a2a 2060 7a69 705f 6372 6360 2077  ed.* `zip_crc` w
-00006710: 696c 6c20 7461 6b65 206c 6f6e 6765 7220  ill take longer 
-00006720: 746f 2064 6f77 6e6c 6f61 6420 7369 6e63  to download sinc
-00006730: 6520 7468 6520 7365 7276 6572 2068 6173  e the server has
-00006740: 2074 6f20 7265 6164 2065 6163 6820 6669   to read each fi
-00006750: 6c65 2074 7769 6365 0a20 202a 2074 6869  le twice.  * thi
-00006760: 7320 6973 206f 6e6c 7920 746f 2073 7570  s is only to sup
-00006770: 706f 7274 204d 532d 444f 5320 504b 5a49  port MS-DOS PKZI
-00006780: 5020 7632 2e30 3467 2028 6f63 746f 6265  P v2.04g (octobe
-00006790: 7220 3139 3933 2920 616e 6420 6f6c 6465  r 1993) and olde
-000067a0: 720a 2020 2020 2a20 686f 7720 6172 6520  r.    * how are 
-000067b0: 796f 7520 6163 6365 7373 696e 6720 636f  you accessing co
-000067c0: 7079 7061 7274 7920 6163 7475 616c 6c79  pyparty actually
-000067d0: 0a0a 796f 7520 6361 6e20 616c 736f 207a  ..you can also z
-000067e0: 6970 2061 2073 656c 6563 7469 6f6e 206f  ip a selection o
-000067f0: 6620 6669 6c65 7320 6f72 2066 6f6c 6465  f files or folde
-00006800: 7273 2062 7920 636c 6963 6b69 6e67 2074  rs by clicking t
-00006810: 6865 6d20 696e 2074 6865 2062 726f 7773  hem in the brows
-00006820: 6572 2c20 7468 6174 2062 7269 6e67 7320  er, that brings 
-00006830: 7570 2061 2073 656c 6563 7469 6f6e 2065  up a selection e
-00006840: 6469 746f 7220 616e 6420 7a69 7020 6275  ditor and zip bu
-00006850: 7474 6f6e 2069 6e20 7468 6520 626f 7474  tton in the bott
-00006860: 6f6d 2072 6967 6874 0a0a 215b 636f 7079  om right..![copy
-00006870: 7061 7274 792d 7a69 7073 656c 2d66 7338  party-zipsel-fs8
-00006880: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
-00006890: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-000068a0: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-000068b0: 3332 2f31 3239 3633 3533 3734 2d65 3531  32/129635374-e51
-000068c0: 3336 6530 312d 3437 3061 2d34 3962 312d  36e01-470a-49b1-
-000068d0: 6137 3632 2d38 3438 6538 6134 6339 6364  a762-848e8a4c9cd
-000068e0: 632e 706e 6729 0a0a 0a23 2320 7570 6c6f  c.png)...## uplo
-000068f0: 6164 696e 670a 0a64 7261 6720 6669 6c65  ading..drag file
-00006900: 732f 666f 6c64 6572 7320 696e 746f 2074  s/folders into t
-00006910: 6865 2077 6562 2d62 726f 7773 6572 2074  he web-browser t
-00006920: 6f20 7570 6c6f 6164 2020 286f 7220 7573  o upload  (or us
-00006930: 6520 7468 6520 5b63 6f6d 6d61 6e64 2d6c  e the [command-l
-00006940: 696e 6520 7570 6c6f 6164 6572 5d28 6874  ine uploader](ht
-00006950: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00006960: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
-00006970: 7472 6565 2f68 6f76 7564 7374 7261 756d  tree/hovudstraum
-00006980: 2f62 696e 2375 7032 6b70 7929 290a 0a74  /bin#up2kpy))..t
-00006990: 6869 7320 696e 6974 6961 7465 7320 616e  his initiates an
-000069a0: 2075 706c 6f61 6420 7573 696e 6720 6075   upload using `u
-000069b0: 7032 6b60 3b20 7468 6572 6520 6172 6520  p2k`; there are 
-000069c0: 7477 6f20 7570 6c6f 6164 6572 7320 6176  two uploaders av
-000069d0: 6169 6c61 626c 653a 0a2a 2060 5bf0 9f8e  ailable:.* `[...
-000069e0: 885d 2062 7570 602c 2074 6865 2062 6173  .] bup`, the bas
-000069f0: 6963 2075 706c 6f61 6465 722c 2073 7570  ic uploader, sup
-00006a00: 706f 7274 7320 616c 6d6f 7374 2065 7665  ports almost eve
-00006a10: 7279 2062 726f 7773 6572 2073 696e 6365  ry browser since
-00006a20: 206e 6574 7363 6170 6520 342e 300a 2a20   netscape 4.0.* 
-00006a30: 605b f09f 9a80 5d20 7570 326b 602c 2074  `[....] up2k`, t
-00006a40: 6865 2067 6f6f 6420 2f20 6661 6e63 7920  he good / fancy 
-00006a50: 6f6e 650a 0a4e 423a 2079 6f75 2063 616e  one..NB: you can
-00006a60: 2075 6e64 6f2f 6465 6c65 7465 2079 6f75   undo/delete you
-00006a70: 7220 6f77 6e20 7570 6c6f 6164 7320 7769  r own uploads wi
-00006a80: 7468 2060 5bf0 9fa7 af5d 6020 5b75 6e70  th `[....]` [unp
-00006a90: 6f73 745d 2823 756e 706f 7374 290a 0a75  ost](#unpost)..u
-00006aa0: 7032 6b20 6861 7320 7365 7665 7261 6c20  p2k has several 
-00006ab0: 6164 7661 6e74 6167 6573 3a0a 2a20 796f  advantages:.* yo
-00006ac0: 7520 6361 6e20 6472 6f70 2066 6f6c 6465  u can drop folde
-00006ad0: 7273 2069 6e74 6f20 7468 6520 6272 6f77  rs into the brow
-00006ae0: 7365 7220 2866 696c 6573 2061 7265 2061  ser (files are a
-00006af0: 6464 6564 2072 6563 7572 7369 7665 6c79  dded recursively
-00006b00: 290a 2a20 6669 6c65 7320 6172 6520 7072  ).* files are pr
-00006b10: 6f63 6573 7365 6420 696e 2063 6875 6e6b  ocessed in chunk
-00006b20: 732c 2061 6e64 2065 6163 6820 6368 756e  s, and each chun
-00006b30: 6b20 6973 2063 6865 636b 7375 6d6d 6564  k is checksummed
-00006b40: 0a20 202a 2075 706c 6f61 6473 2061 7574  .  * uploads aut
-00006b50: 6f72 6573 756d 6520 6966 2074 6865 7920  oresume if they 
-00006b60: 6172 6520 696e 7465 7272 7570 7465 6420  are interrupted 
-00006b70: 6279 206e 6574 776f 726b 2069 7373 7565  by network issue
-00006b80: 730a 2020 2a20 7570 6c6f 6164 7320 7265  s.  * uploads re
-00006b90: 7375 6d65 2069 6620 796f 7520 7265 626f  sume if you rebo
-00006ba0: 6f74 2079 6f75 7220 6272 6f77 7365 7220  ot your browser 
-00006bb0: 6f72 2070 632c 206a 7573 7420 7570 6c6f  or pc, just uplo
-00006bc0: 6164 2074 6865 2073 616d 6520 6669 6c65  ad the same file
-00006bd0: 7320 6167 6169 6e0a 2020 2a20 7365 7276  s again.  * serv
-00006be0: 6572 2064 6574 6563 7473 2061 6e79 2063  er detects any c
-00006bf0: 6f72 7275 7074 696f 6e3b 2074 6865 2063  orruption; the c
-00006c00: 6c69 656e 7420 7265 7570 6c6f 6164 7320  lient reuploads 
-00006c10: 6166 6665 6374 6564 2063 6875 6e6b 730a  affected chunks.
-00006c20: 2020 2a20 7468 6520 636c 6965 6e74 2064    * the client d
-00006c30: 6f65 736e 2774 2075 706c 6f61 6420 616e  oesn't upload an
-00006c40: 7974 6869 6e67 2074 6861 7420 616c 7265  ything that alre
-00006c50: 6164 7920 6578 6973 7473 206f 6e20 7468  ady exists on th
-00006c60: 6520 7365 7276 6572 0a2a 206d 7563 6820  e server.* much 
-00006c70: 6869 6768 6572 2073 7065 6564 7320 7468  higher speeds th
-00006c80: 616e 2066 7470 2f73 6370 2f74 6172 7069  an ftp/scp/tarpi
-00006c90: 7065 206f 6e20 736f 6d65 2069 6e74 6572  pe on some inter
-00006ca0: 6e65 7420 636f 6e6e 6563 7469 6f6e 7320  net connections 
-00006cb0: 286d 6169 6e6c 7920 616d 6572 6963 616e  (mainly american
-00006cc0: 206f 6e65 7329 2074 6861 6e6b 7320 746f   ones) thanks to
-00006cd0: 2070 6172 616c 6c65 6c20 636f 6e6e 6563   parallel connec
-00006ce0: 7469 6f6e 730a 2a20 7468 6520 6c61 7374  tions.* the last
-00006cf0: 2d6d 6f64 6966 6965 6420 7469 6d65 7374  -modified timest
-00006d00: 616d 7020 6f66 2074 6865 2066 696c 6520  amp of the file 
-00006d10: 6973 2070 7265 7365 7276 6564 0a0a 3e20  is preserved..> 
-00006d20: 6974 2069 7320 7065 7266 6563 746c 7920  it is perfectly 
-00006d30: 7361 6665 2074 6f20 7265 7374 6172 7420  safe to restart 
-00006d40: 2f20 7570 6772 6164 6520 636f 7079 7061  / upgrade copypa
-00006d50: 7274 7920 7768 696c 6520 736f 6d65 6f6e  rty while someon
-00006d60: 6520 6973 2075 706c 6f61 6469 6e67 2074  e is uploading t
-00006d70: 6f20 6974 2120 200a 3e20 616c 6c20 6b6e  o it!  .> all kn
-00006d80: 6f77 6e20 7570 326b 2063 6c69 656e 7473  own up2k clients
-00006d90: 2077 696c 6c20 7265 7375 6d65 206a 7573   will resume jus
-00006da0: 7420 6669 6e65 20f0 9f92 aa0a 0a73 6565  t fine ......see
-00006db0: 205b 7570 326b 5d28 2375 7032 6b29 2066   [up2k](#up2k) f
-00006dc0: 6f72 2064 6574 6169 6c73 206f 6e20 686f  or details on ho
-00006dd0: 7720 6974 2077 6f72 6b73 2c20 6f72 2077  w it works, or w
-00006de0: 6174 6368 2061 205b 6465 6d6f 2076 6964  atch a [demo vid
-00006df0: 656f 5d28 6874 7470 733a 2f2f 612e 6f63  eo](https://a.oc
-00006e00: 762e 6d65 2f70 7562 2f64 656d 6f2f 7069  v.me/pub/demo/pi
-00006e10: 6373 2d76 6964 732f 2367 662d 3066 3666  cs-vids/#gf-0f6f
-00006e20: 3563 3064 290a 0a21 5b63 6f70 7970 6172  5c0d)..![copypar
-00006e30: 7479 2d75 706c 6f61 642d 6673 385d 2868  ty-upload-fs8](h
-00006e40: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-00006e50: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-00006e60: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-00006e70: 3132 3936 3335 3337 312d 3438 6663 3534  129635371-48fc54
-00006e80: 6361 2d66 6139 312d 3438 6533 2d39 6231  ca-fa91-48e3-9b1
-00006e90: 642d 6261 3431 3365 3462 3638 6362 2e70  d-ba413e4b68cb.p
-00006ea0: 6e67 290a 0a2a 2a70 726f 7469 703a 2a2a  ng)..**protip:**
-00006eb0: 2079 6f75 2063 616e 2061 766f 6964 2073   you can avoid s
-00006ec0: 6361 7269 6e67 2061 7761 7920 7573 6572  caring away user
-00006ed0: 7320 7769 7468 205b 636f 6e74 7269 622f  s with [contrib/
-00006ee0: 706c 7567 696e 732f 6d69 6e69 6d61 6c2d  plugins/minimal-
-00006ef0: 7570 326b 2e6a 735d 2863 6f6e 7472 6962  up2k.js](contrib
-00006f00: 2f70 6c75 6769 6e73 2f6d 696e 696d 616c  /plugins/minimal
-00006f10: 2d75 7032 6b2e 6a73 2920 7768 6963 6820  -up2k.js) which 
-00006f20: 6d61 6b65 7320 6974 206c 6f6f 6b20 5b6d  makes it look [m
-00006f30: 7563 6820 7369 6d70 6c65 725d 2868 7474  uch simpler](htt
-00006f40: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-00006f50: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-00006f60: 6e74 2e63 6f6d 2f32 3431 3033 322f 3131  nt.com/241032/11
-00006f70: 3833 3131 3139 352d 6464 3663 6133 3830  8311195-dd6ca380
-00006f80: 2d62 3465 662d 3131 6562 2d38 3666 332d  -b4ef-11eb-86f3-
-00006f90: 3735 6133 6666 3265 3133 3332 2e70 6e67  75a3ff2e1332.png
-00006fa0: 290a 0a2a 2a70 726f 7469 703a 2a2a 2069  )..**protip:** i
-00006fb0: 6620 796f 7520 656e 6162 6c65 2060 6661  f you enable `fa
-00006fc0: 7669 636f 6e60 2069 6e20 7468 6520 605b  vicon` in the `[
-00006fd0: e29a 99ef b88f 5d20 7365 7474 696e 6773  ......] settings
-00006fe0: 6020 7461 6220 2862 7920 7479 7069 6e67  ` tab (by typing
-00006ff0: 2073 6f6d 6574 6869 6e67 2069 6e74 6f20   something into 
-00007000: 7468 6520 7465 7874 626f 7829 2c20 7468  the textbox), th
-00007010: 6520 6963 6f6e 2069 6e20 7468 6520 6272  e icon in the br
-00007020: 6f77 7365 7220 7461 6220 7769 6c6c 2069  owser tab will i
-00007030: 6e64 6963 6174 6520 7570 6c6f 6164 2070  ndicate upload p
-00007040: 726f 6772 6573 7320 2d2d 2061 6c73 6f2c  rogress -- also,
-00007050: 2074 6865 2060 5bf0 9f94 945d 6020 616e   the `[....]` an
-00007060: 642f 6f72 2060 5bf0 9f94 8a5d 6020 7377  d/or `[....]` sw
-00007070: 6974 6368 6573 2065 6e61 626c 6520 7669  itches enable vi
-00007080: 7369 626c 6520 616e 642f 6f72 2061 7564  sible and/or aud
-00007090: 6962 6c65 206e 6f74 6966 6963 6174 696f  ible notificatio
-000070a0: 6e73 206f 6e20 7570 6c6f 6164 2063 6f6d  ns on upload com
-000070b0: 706c 6574 696f 6e0a 0a74 6865 2075 7032  pletion..the up2
-000070c0: 6b20 5549 2069 7320 7468 6520 6570 6974  k UI is the epit
-000070d0: 6f6d 6520 6f66 2070 6f6c 6973 6865 6420  ome of polished 
-000070e0: 696e 7574 6974 6976 6520 6578 7065 7269  inutitive experi
-000070f0: 656e 6365 733a 0a2a 2022 7061 7261 6c6c  ences:.* "parall
-00007100: 656c 2075 706c 6f61 6473 2220 7370 6563  el uploads" spec
-00007110: 6966 6965 7320 686f 7720 6d61 6e79 2063  ifies how many c
-00007120: 6875 6e6b 7320 746f 2075 706c 6f61 6420  hunks to upload 
-00007130: 6174 2074 6865 2073 616d 6520 7469 6d65  at the same time
-00007140: 0a2a 2060 5bf0 9f8f 835d 6020 616e 616c  .* `[....]` anal
-00007150: 7973 6973 206f 6620 6f74 6865 7220 6669  ysis of other fi
-00007160: 6c65 7320 7368 6f75 6c64 2063 6f6e 7469  les should conti
-00007170: 6e75 6520 7768 696c 6520 6f6e 6520 6973  nue while one is
-00007180: 2075 706c 6f61 6469 6e67 0a2a 2060 5bf0   uploading.* `[.
-00007190: 9fa5 945d 6020 7368 6f77 7320 6120 7369  ...]` shows a si
-000071a0: 6d70 6c65 7220 5549 2066 6f72 2066 6173  mpler UI for fas
-000071b0: 7465 7220 7570 6c6f 6164 7320 6672 6f6d  ter uploads from
-000071c0: 2073 6c6f 7720 6465 7669 6365 730a 2a20   slow devices.* 
-000071d0: 605b f09f 92ad 5d60 2061 736b 2066 6f72  `[....]` ask for
-000071e0: 2063 6f6e 6669 726d 6174 696f 6e20 6265   confirmation be
-000071f0: 666f 7265 2066 696c 6573 2061 7265 2061  fore files are a
-00007200: 6464 6564 2074 6f20 7468 6520 7175 6575  dded to the queu
-00007210: 650a 2a20 605b f09f 948e 5d60 2073 7769  e.* `[....]` swi
-00007220: 7463 6820 6265 7477 6565 6e20 7570 6c6f  tch between uplo
-00007230: 6164 2061 6e64 205b 6669 6c65 2d73 6561  ad and [file-sea
-00007240: 7263 685d 2823 6669 6c65 2d73 6561 7263  rch](#file-searc
-00007250: 6829 206d 6f64 650a 2020 2a20 6967 6e6f  h) mode.  * igno
-00007260: 7265 2060 5bf0 9f94 8e5d 6020 6966 2079  re `[....]` if y
-00007270: 6f75 2061 6464 2066 696c 6573 2062 7920  ou add files by 
-00007280: 6472 6167 6769 6e67 2074 6865 6d20 696e  dragging them in
-00007290: 746f 2074 6865 2062 726f 7773 6572 0a0a  to the browser..
-000072a0: 616e 6420 7468 656e 2074 6865 7265 7320  and then theres 
-000072b0: 7468 6520 7461 6273 2062 656c 6f77 2069  the tabs below i
-000072c0: 742c 0a2a 2060 5b6f 6b5d 6020 6973 2074  t,.* `[ok]` is t
-000072d0: 6865 2066 696c 6573 2077 6869 6368 2063  he files which c
-000072e0: 6f6d 706c 6574 6564 2073 7563 6365 7373  ompleted success
-000072f0: 6675 6c6c 790a 2a20 605b 6e67 5d60 2069  fully.* `[ng]` i
-00007300: 7320 7468 6520 6f6e 6573 2074 6861 7420  s the ones that 
-00007310: 6661 696c 6564 202f 2067 6f74 2072 656a  failed / got rej
-00007320: 6563 7465 6420 2861 6c72 6561 6479 2065  ected (already e
-00007330: 7869 7374 732c 202e 2e2e 290a 2a20 605b  xists, ...).* `[
-00007340: 646f 6e65 5d60 2073 686f 7773 2061 2063  done]` shows a c
-00007350: 6f6d 6269 6e65 6420 6c69 7374 206f 6620  ombined list of 
-00007360: 605b 6f6b 5d60 2061 6e64 2060 5b6e 675d  `[ok]` and `[ng]
-00007370: 602c 2063 6872 6f6e 6f6c 6f67 6963 616c  `, chronological
-00007380: 206f 7264 6572 0a2a 2060 5b62 7573 795d   order.* `[busy]
-00007390: 6020 6669 6c65 7320 7768 6963 6820 6172  ` files which ar
-000073a0: 6520 6375 7272 656e 746c 7920 6861 7368  e currently hash
-000073b0: 696e 672c 2070 656e 6469 6e67 2d75 706c  ing, pending-upl
-000073c0: 6f61 642c 206f 7220 7570 6c6f 6164 696e  oad, or uploadin
-000073d0: 670a 2020 2a20 706c 7573 2075 7020 746f  g.  * plus up to
-000073e0: 2033 2065 6e74 7269 6573 2065 6163 6820   3 entries each 
-000073f0: 6672 6f6d 2060 5b64 6f6e 655d 6020 616e  from `[done]` an
-00007400: 6420 605b 7175 655d 6020 666f 7220 636f  d `[que]` for co
-00007410: 6e74 6578 740a 2a20 605b 7175 655d 6020  ntext.* `[que]` 
-00007420: 6973 2061 6c6c 2074 6865 2066 696c 6573  is all the files
-00007430: 2074 6861 7420 6172 6520 7374 696c 6c20   that are still 
-00007440: 7175 6575 6564 0a0a 6e6f 7465 2074 6861  queued..note tha
-00007450: 7420 7369 6e63 6520 7570 326b 2068 6173  t since up2k has
-00007460: 2074 6f20 7265 6164 2065 6163 6820 6669   to read each fi
-00007470: 6c65 2074 7769 6365 2c20 605b f09f 8e88  le twice, `[....
-00007480: 5d20 6275 7060 2063 616e 202a 7468 656f  ] bup` can *theo
-00007490: 7265 7469 6361 6c6c 792a 2062 6520 7570  retically* be up
-000074a0: 2074 6f20 3278 2066 6173 7465 7220 696e   to 2x faster in
-000074b0: 2073 6f6d 6520 6578 7472 656d 6520 6361   some extreme ca
-000074c0: 7365 7320 2866 696c 6573 2062 6967 6765  ses (files bigge
-000074d0: 7220 7468 616e 2079 6f75 7220 7261 6d2c  r than your ram,
-000074e0: 2063 6f6d 6269 6e65 6420 7769 7468 2061   combined with a
-000074f0: 6e20 696e 7465 726e 6574 2063 6f6e 6e65  n internet conne
-00007500: 6374 696f 6e20 6661 7374 6572 2074 6861  ction faster tha
-00007510: 6e20 7468 6520 7265 6164 2d73 7065 6564  n the read-speed
-00007520: 206f 6620 796f 7572 2048 4444 2c20 6f72   of your HDD, or
-00007530: 2069 6620 796f 7527 7265 2075 706c 6f61   if you're uploa
-00007540: 6469 6e67 2066 726f 6d20 6120 6375 6f32  ding from a cuo2
-00007550: 6475 6f29 0a0a 6966 2079 6f75 2061 7265  duo)..if you are
-00007560: 2072 6573 756d 696e 6720 6120 6d61 7373   resuming a mass
-00007570: 6976 6520 7570 6c6f 6164 2061 6e64 2077  ive upload and w
-00007580: 616e 7420 746f 2073 6b69 7020 6861 7368  ant to skip hash
-00007590: 696e 6720 7468 6520 6669 6c65 7320 7768  ing the files wh
-000075a0: 6963 6820 616c 7265 6164 7920 6669 6e69  ich already fini
-000075b0: 7368 6564 2c20 796f 7520 6361 6e20 656e  shed, you can en
-000075c0: 6162 6c65 2060 7475 7262 6f60 2069 6e20  able `turbo` in 
-000075d0: 7468 6520 605b e29a 99ef b88f 5d20 636f  the `[......] co
-000075e0: 6e66 6967 6020 7461 622c 2062 7574 2070  nfig` tab, but p
-000075f0: 6c65 6173 6520 7265 6164 2074 6865 2074  lease read the t
-00007600: 6f6f 6c74 6970 206f 6e20 7468 6174 2062  ooltip on that b
-00007610: 7574 746f 6e0a 0a0a 2323 2320 6669 6c65  utton...### file
-00007620: 2d73 6561 7263 680a 0a64 726f 7070 696e  -search..droppin
-00007630: 6720 6669 6c65 7320 696e 746f 2074 6865  g files into the
-00007640: 2062 726f 7773 6572 2061 6c73 6f20 6c65   browser also le
-00007650: 7473 2079 6f75 2073 6565 2069 6620 7468  ts you see if th
-00007660: 6579 2065 7869 7374 206f 6e20 7468 6520  ey exist on the 
-00007670: 7365 7276 6572 0a0a 215b 636f 7079 7061  server..![copypa
-00007680: 7274 792d 6673 6561 7263 682d 6673 385d  rty-fsearch-fs8]
-00007690: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
-000076a0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-000076b0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-000076c0: 322f 3132 3936 3335 3336 312d 6337 3932  2/129635361-c792
-000076d0: 3836 6630 2d62 3866 312d 3434 3065 2d61  86f0-b8f1-440e-a
-000076e0: 6166 342d 3665 3932 3934 3238 6661 6339  af4-6e929428fac9
-000076f0: 2e70 6e67 290a 0a77 6865 6e20 796f 7520  .png)..when you 
-00007700: 6472 6167 2f64 726f 7020 6669 6c65 7320  drag/drop files 
-00007710: 696e 746f 2074 6865 2062 726f 7773 6572  into the browser
-00007720: 2c20 796f 7520 7769 6c6c 2073 6565 2074  , you will see t
-00007730: 776f 2064 726f 707a 6f6e 6573 3a20 6055  wo dropzones: `U
-00007740: 706c 6f61 6460 2061 6e64 2060 5365 6172  pload` and `Sear
-00007750: 6368 600a 0a3e 206f 6e20 6120 7068 6f6e  ch`..> on a phon
-00007760: 653f 2074 6f67 676c 6520 7468 6520 605b  e? toggle the `[
-00007770: f09f 948e 5d60 2073 7769 7463 6820 6772  ....]` switch gr
-00007780: 6565 6e20 6265 666f 7265 2074 6170 7069  een before tappi
-00007790: 6e67 2074 6865 2062 6967 2079 656c 6c6f  ng the big yello
-000077a0: 7720 5365 6172 6368 2062 7574 746f 6e20  w Search button 
-000077b0: 746f 2073 656c 6563 7420 796f 7572 2066  to select your f
-000077c0: 696c 6573 0a0a 7468 6520 6669 6c65 7320  iles..the files 
-000077d0: 7769 6c6c 2062 6520 6861 7368 6564 206f  will be hashed o
-000077e0: 6e20 7468 6520 636c 6965 6e74 2d73 6964  n the client-sid
-000077f0: 652c 2061 6e64 2065 6163 6820 6861 7368  e, and each hash
-00007800: 2069 7320 7365 6e74 2074 6f20 7468 6520   is sent to the 
-00007810: 7365 7276 6572 2c20 7768 6963 6820 6368  server, which ch
-00007820: 6563 6b73 2069 6620 7468 6174 2066 696c  ecks if that fil
-00007830: 6520 6578 6973 7473 2073 6f6d 6577 6865  e exists somewhe
-00007840: 7265 0a0a 6669 6c65 7320 676f 2069 6e74  re..files go int
-00007850: 6f20 605b 6f6b 5d60 2069 6620 7468 6579  o `[ok]` if they
-00007860: 2065 7869 7374 2028 616e 6420 796f 7520   exist (and you 
-00007870: 6765 7420 6120 6c69 6e6b 2074 6f20 7768  get a link to wh
-00007880: 6572 6520 6974 2069 7329 2c20 6f74 6865  ere it is), othe
-00007890: 7277 6973 6520 7468 6579 206c 616e 6420  rwise they land 
-000078a0: 696e 2060 5b6e 675d 600a 2a20 7468 6520  in `[ng]`.* the 
-000078b0: 6d61 696e 2072 6561 736f 6e20 6669 6c65  main reason file
-000078c0: 7365 6172 6368 2069 7320 636f 6d62 696e  search is combin
-000078d0: 6564 2077 6974 6820 7468 6520 7570 6c6f  ed with the uplo
-000078e0: 6164 6572 2069 7320 6361 7573 6520 7468  ader is cause th
-000078f0: 6520 636f 6465 2077 6173 2074 6f6f 2073  e code was too s
-00007900: 7061 6768 6574 7469 2074 6f20 7365 7061  paghetti to sepa
-00007910: 7261 7465 2069 7420 6f75 7420 736f 6d65  rate it out some
-00007920: 7768 6572 6520 656c 7365 2c20 7468 6973  where else, this
-00007930: 2069 7320 6e6f 206c 6f6e 6765 7220 7468   is no longer th
-00007940: 6520 6361 7365 2062 7574 206e 6f77 2069  e case but now i
-00007950: 2776 6520 7761 726d 6564 2075 7020 746f  've warmed up to
-00007960: 2074 6865 2069 6465 6120 746f 6f20 6d75   the idea too mu
-00007970: 6368 0a0a 0a23 2323 2075 6e70 6f73 740a  ch...### unpost.
-00007980: 0a75 6e64 6f2f 6465 6c65 7465 2061 6363  .undo/delete acc
-00007990: 6964 656e 7461 6c20 7570 6c6f 6164 730a  idental uploads.
-000079a0: 0a21 5b63 6f70 7970 6172 7479 2d75 6e70  .![copyparty-unp
-000079b0: 6f73 742d 6673 385d 2868 7474 7073 3a2f  ost-fs8](https:/
-000079c0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-000079d0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-000079e0: 6f6d 2f32 3431 3033 322f 3132 3936 3335  om/241032/129635
-000079f0: 3336 382d 3361 6661 3636 3334 2d63 3230  368-3afa6634-c20
-00007a00: 662d 3431 3863 2d39 3064 632d 6563 3431  f-418c-90dc-ec41
-00007a10: 3166 3362 3338 3937 2e70 6e67 290a 0a79  1f3b3897.png)..y
-00007a20: 6f75 2063 616e 2075 6e70 6f73 7420 6576  ou can unpost ev
-00007a30: 656e 2069 6620 796f 7520 646f 6e27 7420  en if you don't 
-00007a40: 6861 7665 2072 6567 756c 6172 206d 6f76  have regular mov
-00007a50: 652f 6465 6c65 7465 2061 6363 6573 732c  e/delete access,
-00007a60: 2068 6f77 6576 6572 206f 6e6c 7920 666f   however only fo
-00007a70: 7220 6669 6c65 7320 7570 6c6f 6164 6564  r files uploaded
-00007a80: 2077 6974 6869 6e20 7468 6520 7061 7374   within the past
-00007a90: 2060 2d2d 756e 706f 7374 6020 7365 636f   `--unpost` seco
-00007aa0: 6e64 7320 2864 6566 6175 6c74 2031 3220  nds (default 12 
-00007ab0: 686f 7572 7329 2061 6e64 2074 6865 2073  hours) and the s
-00007ac0: 6572 7665 7220 6d75 7374 2062 6520 7275  erver must be ru
-00007ad0: 6e6e 696e 6720 7769 7468 2060 2d65 3264  nning with `-e2d
-00007ae0: 600a 0a0a 2323 2320 7365 6c66 2d64 6573  `...### self-des
-00007af0: 7472 7563 740a 0a75 706c 6f61 6473 2063  truct..uploads c
-00007b00: 616e 2062 6520 6769 7665 6e20 6120 6c69  an be given a li
-00007b10: 6665 7469 6d65 2c20 2061 6665 7220 7768  fetime,  afer wh
-00007b20: 6963 6820 7468 6579 2065 7870 6972 6520  ich they expire 
-00007b30: 2f20 7365 6c66 2d64 6573 7472 7563 740a  / self-destruct.
-00007b40: 0a74 6865 2066 6561 7475 7265 206d 7573  .the feature mus
-00007b50: 7420 6265 2065 6e61 626c 6564 2070 6572  t be enabled per
-00007b60: 2d76 6f6c 756d 6520 7769 7468 2074 6865  -volume with the
-00007b70: 2060 6c69 6665 7469 6d65 6020 5b75 706c   `lifetime` [upl
-00007b80: 6f61 6420 7275 6c65 5d28 2375 706c 6f61  oad rule](#uploa
-00007b90: 642d 7275 6c65 7329 2077 6869 6368 2073  d-rules) which s
-00007ba0: 6574 7320 7468 6520 7570 7065 7220 6c69  ets the upper li
-00007bb0: 6d69 7420 666f 7220 686f 7720 6c6f 6e67  mit for how long
-00007bc0: 2061 2066 696c 6520 6765 7473 2074 6f20   a file gets to 
-00007bd0: 7374 6179 206f 6e20 7468 6520 7365 7276  stay on the serv
-00007be0: 6572 0a0a 636c 6965 6e74 7320 6361 6e20  er..clients can 
-00007bf0: 7370 6563 6966 7920 6120 7368 6f72 7465  specify a shorte
-00007c00: 7220 6578 7069 7261 7469 6f6e 2074 696d  r expiration tim
-00007c10: 6520 7573 696e 6720 7468 6520 5b75 7032  e using the [up2
-00007c20: 6b20 7569 5d28 2375 706c 6f61 6469 6e67  k ui](#uploading
-00007c30: 2920 2d2d 2074 6865 2072 656c 6576 616e  ) -- the relevan
-00007c40: 7420 6f70 7469 6f6e 7320 6265 636f 6d65  t options become
-00007c50: 2076 6973 6962 6c65 2075 706f 6e20 6e61   visible upon na
-00007c60: 7669 6761 7469 6e67 2069 6e74 6f20 6120  vigating into a 
-00007c70: 666f 6c64 6572 2077 6974 6820 606c 6966  folder with `lif
-00007c80: 6574 696d 6573 6020 656e 6162 6c65 6420  etimes` enabled 
-00007c90: 2d2d 206f 7220 6279 2075 7369 6e67 2074  -- or by using t
-00007ca0: 6865 2060 6c69 6665 6020 5b75 706c 6f61  he `life` [uploa
-00007cb0: 6420 6d6f 6469 6669 6572 5d28 2377 7269  d modifier](#wri
-00007cc0: 7465 290a 0a73 7065 6369 6679 696e 6720  te)..specifying 
-00007cd0: 6120 6375 7374 6f6d 2065 7870 6972 6174  a custom expirat
-00007ce0: 696f 6e20 7469 6d65 2063 6c69 656e 742d  ion time client-
-00007cf0: 7369 6465 2077 696c 6c20 6166 6665 6374  side will affect
-00007d00: 2074 6865 2074 696d 6573 7061 6e20 696e   the timespan in
-00007d10: 2077 6869 6368 2075 6e70 6f73 7473 2061   which unposts a
-00007d20: 7265 2070 6572 6d69 7474 6564 2c20 736f  re permitted, so
-00007d30: 206b 6565 7020 616e 2065 7965 206f 6e20   keep an eye on 
-00007d40: 7468 6520 6573 7469 6d61 7465 7320 696e  the estimates in
-00007d50: 2074 6865 2075 7032 6b20 7569 0a0a 0a23   the up2k ui...#
-00007d60: 2320 6669 6c65 206d 616e 6167 6572 0a0a  # file manager..
-00007d70: 6375 742f 7061 7374 652c 2072 656e 616d  cut/paste, renam
-00007d80: 652c 2061 6e64 2064 656c 6574 6520 6669  e, and delete fi
-00007d90: 6c65 732f 666f 6c64 6572 7320 2869 6620  les/folders (if 
-00007da0: 796f 7520 6861 7665 2070 6572 6d69 7373  you have permiss
-00007db0: 696f 6e29 0a0a 6669 6c65 2073 656c 6563  ion)..file selec
-00007dc0: 7469 6f6e 3a20 636c 6963 6b20 736f 6d65  tion: click some
-00007dd0: 7768 6572 6520 6f6e 2074 6865 206c 696e  where on the lin
-00007de0: 6520 286e 6f74 2074 6865 206c 696e 6b20  e (not the link 
-00007df0: 6974 7365 6629 2c20 7468 656e 3a0a 2a20  itsef), then:.* 
-00007e00: 6073 7061 6365 6020 746f 2074 6f67 676c  `space` to toggl
-00007e10: 650a 2a20 6075 702f 646f 776e 6020 746f  e.* `up/down` to
-00007e20: 206d 6f76 650a 2a20 6073 6869 6674 2d75   move.* `shift-u
-00007e30: 702f 646f 776e 6020 746f 206d 6f76 652d  p/down` to move-
-00007e40: 616e 642d 7365 6c65 6374 0a2a 2060 6374  and-select.* `ct
-00007e50: 726c 2d73 6869 6674 2d75 702f 646f 776e  rl-shift-up/down
-00007e60: 6020 746f 2061 6c73 6f20 7363 726f 6c6c  ` to also scroll
-00007e70: 0a0a 2a20 6375 743a 2073 656c 6563 7420  ..* cut: select 
-00007e80: 736f 6d65 2066 696c 6573 2061 6e64 2060  some files and `
-00007e90: 6374 726c 2d78 600a 2a20 7061 7374 653a  ctrl-x`.* paste:
-00007ea0: 2060 6374 726c 2d76 6020 696e 2061 6e6f   `ctrl-v` in ano
-00007eb0: 7468 6572 2066 6f6c 6465 720a 2a20 7265  ther folder.* re
-00007ec0: 6e61 6d65 3a20 6046 3260 0a0a 796f 7520  name: `F2`..you 
-00007ed0: 6361 6e20 6d6f 7665 2066 696c 6573 2061  can move files a
-00007ee0: 6372 6f73 7320 6272 6f77 7365 7220 7461  cross browser ta
-00007ef0: 6273 2028 6375 7420 696e 206f 6e65 2074  bs (cut in one t
-00007f00: 6162 2c20 7061 7374 6520 696e 2061 6e6f  ab, paste in ano
-00007f10: 7468 6572 290a 0a0a 2323 2062 6174 6368  ther)...## batch
-00007f20: 2072 656e 616d 650a 0a73 656c 6563 7420   rename..select 
-00007f30: 736f 6d65 2066 696c 6573 2061 6e64 2070  some files and p
-00007f40: 7265 7373 2060 4632 6020 746f 2062 7269  ress `F2` to bri
-00007f50: 6e67 2075 7020 7468 6520 7265 6e61 6d65  ng up the rename
-00007f60: 2055 490a 0a21 5b62 6174 6368 2d72 656e   UI..![batch-ren
-00007f70: 616d 652d 6673 385d 2868 7474 7073 3a2f  ame-fs8](https:/
-00007f80: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-00007f90: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-00007fa0: 6f6d 2f32 3431 3033 322f 3132 3834 3334  om/241032/128434
-00007fb0: 3230 342d 6562 3133 3636 3830 2d33 6330  204-eb136680-3c0
-00007fc0: 372d 3465 6337 2d39 3265 302d 6165 3836  7-4ec7-92e0-ae86
-00007fd0: 6166 3230 6332 3431 2e70 6e67 290a 0a71  af20c241.png)..q
-00007fe0: 7569 636b 2065 7870 6c61 6e61 7469 6f6e  uick explanation
-00007ff0: 206f 6620 7468 6520 6275 7474 6f6e 732c   of the buttons,
-00008000: 2020 0a2a 2060 5be2 9c85 2061 7070 6c79    .* `[... apply
-00008010: 2072 656e 616d 655d 6020 636f 6e66 6972   rename]` confir
-00008020: 6d73 2061 6e64 2062 6567 696e 7320 7265  ms and begins re
-00008030: 6e61 6d69 6e67 0a2a 2060 5be2 9d8c 2063  naming.* `[... c
-00008040: 616e 6365 6c5d 6020 6162 6f72 7473 2061  ancel]` aborts a
-00008050: 6e64 2063 6c6f 7365 7320 7468 6520 7265  nd closes the re
-00008060: 6e61 6d65 2077 696e 646f 770a 2a20 605b  name window.* `[
-00008070: e286 ba20 7265 7365 745d 6020 7265 7665  ... reset]` reve
-00008080: 7274 7320 616e 7920 6669 6c65 6e61 6d65  rts any filename
-00008090: 2063 6861 6e67 6573 2062 6163 6b20 746f   changes back to
-000080a0: 2074 6865 206f 7269 6769 6e61 6c20 6e61   the original na
-000080b0: 6d65 0a2a 2060 5b64 6563 6f64 655d 6020  me.* `[decode]` 
-000080c0: 646f 6573 2061 2055 524c 2d64 6563 6f64  does a URL-decod
-000080d0: 6520 6f6e 2074 6865 2066 696c 656e 616d  e on the filenam
-000080e0: 652c 2066 6978 696e 6720 7374 7566 6620  e, fixing stuff 
-000080f0: 6c69 6b65 2060 2661 6d70 3b60 2061 6e64  like `&amp;` and
-00008100: 2060 2532 3060 0a2a 2060 5b61 6476 616e   `%20`.* `[advan
-00008110: 6365 645d 6020 746f 6767 6c65 7320 6164  ced]` toggles ad
-00008120: 7661 6e63 6564 206d 6f64 650a 0a61 6476  vanced mode..adv
-00008130: 616e 6365 6420 6d6f 6465 3a20 7265 6e61  anced mode: rena
-00008140: 6d65 2066 696c 6573 2062 6173 6564 206f  me files based o
-00008150: 6e20 7275 6c65 7320 746f 2064 6563 6964  n rules to decid
-00008160: 6520 7468 6520 6e65 7720 6e61 6d65 732c  e the new names,
-00008170: 2062 6173 6564 206f 6e20 7468 6520 6f72   based on the or
-00008180: 6967 696e 616c 206e 616d 6520 2872 6567  iginal name (reg
-00008190: 6578 292c 206f 7220 6261 7365 6420 6f6e  ex), or based on
-000081a0: 2074 6865 2074 6167 7320 636f 6c6c 6563   the tags collec
-000081b0: 7465 6420 6672 6f6d 2074 6865 2066 696c  ted from the fil
-000081c0: 6520 2861 7274 6973 742f 7469 746c 652f  e (artist/title/
-000081d0: 2e2e 2e29 2c20 6f72 2061 206d 6978 206f  ...), or a mix o
-000081e0: 6620 626f 7468 0a0a 696e 2061 6476 616e  f both..in advan
-000081f0: 6365 6420 6d6f 6465 2c20 200a 2a20 605b  ced mode,  .* `[
-00008200: 6361 7365 5d60 2074 6f67 676c 6573 2063  case]` toggles c
-00008210: 6173 652d 7365 6e73 6974 6976 6520 7265  ase-sensitive re
-00008220: 6765 780a 2a20 6072 6567 6578 6020 6973  gex.* `regex` is
-00008230: 2074 6865 2072 6567 6578 2070 6174 7465   the regex patte
-00008240: 726e 2074 6f20 6170 706c 7920 746f 2074  rn to apply to t
-00008250: 6865 206f 7269 6769 6e61 6c20 6669 6c65  he original file
-00008260: 6e61 6d65 3b20 616e 7920 6669 6c65 7320  name; any files 
-00008270: 7768 6963 6820 646f 6e27 7420 6d61 7463  which don't matc
-00008280: 6820 7769 6c6c 2062 6520 736b 6970 7065  h will be skippe
-00008290: 640a 2a20 6066 6f72 6d61 7460 2069 7320  d.* `format` is 
-000082a0: 7468 6520 6e65 7720 6669 6c65 6e61 6d65  the new filename
-000082b0: 2c20 7461 6b69 6e67 2076 616c 7565 7320  , taking values 
-000082c0: 6672 6f6d 2072 6567 6578 2063 6170 7475  from regex captu
-000082d0: 7269 6e67 2067 726f 7570 7320 616e 642f  ring groups and/
-000082e0: 6f72 2066 726f 6d20 6669 6c65 2074 6167  or from file tag
-000082f0: 730a 2020 2a20 7665 7279 206c 6f6f 7365  s.  * very loose
-00008300: 6c79 2062 6173 6564 206f 6e20 666f 6f62  ly based on foob
-00008310: 6172 3230 3030 2073 796e 7461 780a 2a20  ar2000 syntax.* 
-00008320: 6070 7265 7365 7473 6020 6c65 7473 2079  `presets` lets y
-00008330: 6f75 2073 6176 6520 7265 6e61 6d65 2072  ou save rename r
-00008340: 756c 6573 2066 6f72 206c 6174 6572 0a0a  ules for later..
-00008350: 6176 6169 6c61 626c 6520 6675 6e63 7469  available functi
-00008360: 6f6e 733a 0a2a 2060 246c 7061 6428 7465  ons:.* `$lpad(te
-00008370: 7874 2c20 6c65 6e67 7468 2c20 7061 645f  xt, length, pad_
-00008380: 6368 6172 2960 0a2a 2060 2472 7061 6428  char)`.* `$rpad(
-00008390: 7465 7874 2c20 6c65 6e67 7468 2c20 7061  text, length, pa
-000083a0: 645f 6368 6172 2960 0a0a 736f 2c0a 0a73  d_char)`..so,..s
-000083b0: 6179 2079 6f75 2068 6176 6520 6120 6669  ay you have a fi
-000083c0: 6c65 206e 616d 6564 205b 606d 6567 616e  le named [`megan
-000083d0: 656b 6f20 2d20 4563 6c69 7073 6520 2d20  eko - Eclipse - 
-000083e0: 3037 2053 6972 6975 7320 412e 6d70 3360  07 Sirius A.mp3`
-000083f0: 5d28 6874 7470 733a 2f2f 7777 772e 796f  ](https://www.yo
-00008400: 7574 7562 652e 636f 6d2f 7761 7463 683f  utube.com/watch?
-00008410: 763d 2d64 7462 3076 4450 7275 4929 2028  v=-dtb0vDPruI) (
-00008420: 6162 736f 6c75 7465 6c79 2066 616e 7461  absolutely fanta
-00008430: 7374 6963 2061 6c62 756d 2062 7477 2920  stic album btw) 
-00008440: 616e 6420 7468 6520 7461 6773 2061 7265  and the tags are
-00008450: 3a20 6041 6c62 756d 3a45 636c 6970 7365  : `Album:Eclipse
-00008460: 602c 2060 4172 7469 7374 3a6d 6567 616e  `, `Artist:megan
-00008470: 656b 6f60 2c20 6054 6974 6c65 3a53 6972  eko`, `Title:Sir
-00008480: 6975 7320 4160 2c20 6074 6e3a 3760 0a0a  ius A`, `tn:7`..
-00008490: 796f 7520 636f 756c 6420 7573 6520 6a75  you could use ju
-000084a0: 7374 2072 6567 6578 2074 6f20 7265 6e61  st regex to rena
-000084b0: 6d65 2069 743a 0a2a 2060 7265 6765 7860  me it:.* `regex`
-000084c0: 203d 2060 282e 2a29 202d 2028 2e2a 2920   = `(.*) - (.*) 
-000084d0: 2d20 285b 302d 395d 7b32 7d29 2028 2e2a  - ([0-9]{2}) (.*
-000084e0: 2960 0a2a 2060 666f 726d 6174 6020 3d20  )`.* `format` = 
-000084f0: 6028 3329 2e20 2831 2920 2d20 2834 2960  `(3). (1) - (4)`
-00008500: 0a2a 2060 6f75 7470 7574 6020 3d20 6030  .* `output` = `0
-00008510: 372e 206d 6567 616e 656b 6f20 2d20 5369  7. meganeko - Si
-00008520: 7269 7573 2041 2e6d 7033 600a 0a6f 7220  rius A.mp3`..or 
-00008530: 796f 7520 636f 756c 6420 7573 6520 6a75  you could use ju
-00008540: 7374 2074 6167 733a 0a2a 2060 666f 726d  st tags:.* `form
-00008550: 6174 6020 3d20 6024 6c70 6164 2828 746e  at` = `$lpad((tn
-00008560: 292c 322c 3029 2e20 2861 7274 6973 7429  ),2,0). (artist)
-00008570: 202d 2028 7469 746c 6529 2e28 6578 7429   - (title).(ext)
-00008580: 600a 2a20 606f 7574 7075 7460 203d 2060  `.* `output` = `
-00008590: 372e 206d 6567 616e 656b 6f20 2d20 5369  7. meganeko - Si
-000085a0: 7269 7573 2041 2e6d 7033 600a 0a6f 7220  rius A.mp3`..or 
-000085b0: 6120 6d69 7820 6f66 2062 6f74 683a 0a2a  a mix of both:.*
-000085c0: 2060 7265 6765 7860 203d 2060 202d 2028   `regex` = ` - (
-000085d0: 5b30 2d39 5d7b 327d 2920 600a 2a20 6066  [0-9]{2}) `.* `f
-000085e0: 6f72 6d61 7460 203d 2060 2831 292e 2028  ormat` = `(1). (
-000085f0: 6172 7469 7374 2920 2d20 2874 6974 6c65  artist) - (title
-00008600: 292e 2865 7874 2960 0a2a 2060 6f75 7470  ).(ext)`.* `outp
-00008610: 7574 6020 3d20 6030 372e 206d 6567 616e  ut` = `07. megan
-00008620: 656b 6f20 2d20 5369 7269 7573 2041 2e6d  eko - Sirius A.m
-00008630: 7033 600a 0a74 6865 206d 6574 6164 6174  p3`..the metadat
-00008640: 6120 6b65 7973 2079 6f75 2063 616e 2075  a keys you can u
-00008650: 7365 2069 6e20 7468 6520 666f 726d 6174  se in the format
-00008660: 2066 6965 6c64 2061 7265 2074 6865 206f   field are the o
-00008670: 6e65 7320 696e 2074 6865 2066 696c 652d  nes in the file-
-00008680: 6272 6f77 7365 7220 7461 626c 6520 6865  browser table he
-00008690: 6164 6572 2028 7768 6174 6576 6572 2069  ader (whatever i
-000086a0: 7320 636f 6c6c 6563 7465 6420 7769 7468  s collected with
-000086b0: 2060 2d6d 7465 6020 616e 6420 602d 6d74   `-mte` and `-mt
-000086c0: 7060 290a 0a0a 2323 206d 6172 6b64 6f77  p`)...## markdow
-000086d0: 6e20 7669 6577 6572 0a0a 616e 6420 7468  n viewer..and th
-000086e0: 6572 6520 6172 6520 2a74 776f 2a20 6564  ere are *two* ed
-000086f0: 6974 6f72 730a 0a21 5b63 6f70 7970 6172  itors..![copypar
-00008700: 7479 2d6d 642d 7265 6164 2d66 7338 5d28  ty-md-read-fs8](
-00008710: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
-00008720: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
-00008730: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
-00008740: 2f31 3135 3937 3830 3537 2d36 3634 3139  /115978057-66419
-00008750: 3038 302d 6135 3764 2d31 3165 622d 3835  080-a57d-11eb-85
-00008760: 3339 2d64 3262 6538 3433 3939 3161 612e  39-d2be843991aa.
-00008770: 706e 6729 0a0a 2a20 7468 6520 646f 6375  png)..* the docu
-00008780: 6d65 6e74 2070 7265 7669 6577 2068 6173  ment preview has
-00008790: 2061 206d 6178 2d77 6964 7468 2077 6869   a max-width whi
-000087a0: 6368 2069 7320 7468 6520 7361 6d65 2061  ch is the same a
-000087b0: 7320 616e 2041 3420 7061 7065 7220 7768  s an A4 paper wh
-000087c0: 656e 2070 7269 6e74 6564 0a0a 0a23 2320  en printed...## 
-000087d0: 6f74 6865 7220 7472 6963 6b73 0a0a 2a20  other tricks..* 
-000087e0: 796f 7520 6361 6e20 6c69 6e6b 2061 2070  you can link a p
-000087f0: 6172 7469 6375 6c61 7220 7469 6d65 7374  articular timest
-00008800: 616d 7020 696e 2061 6e20 6175 6469 6f20  amp in an audio 
-00008810: 6669 6c65 2062 7920 6164 6469 6e67 2069  file by adding i
-00008820: 7420 746f 2074 6865 2055 524c 2c20 7375  t to the URL, su
-00008830: 6368 2061 7320 6026 3230 6020 2f20 6026  ch as `&20` / `&
-00008840: 3230 7360 202f 2060 2631 6d32 3060 202f  20s` / `&1m20` /
-00008850: 2060 2674 3d31 3a32 3060 2061 6674 6572   `&t=1:20` after
-00008860: 2074 6865 2060 2e2e 2e2f 2361 662d 6338   the `.../#af-c8
-00008870: 3936 3064 6162 600a 0a2a 2065 6e61 626c  960dab`..* enabl
-00008880: 696e 6720 7468 6520 6175 6469 6f20 6571  ing the audio eq
-00008890: 7561 6c69 7a65 7220 6361 6e20 6865 6c70  ualizer can help
-000088a0: 206d 616b 6520 6761 706c 6573 7320 616c   make gapless al
-000088b0: 6275 6d73 2066 756c 6c79 2067 6170 6c65  bums fully gaple
-000088c0: 7373 2069 6e20 736f 6d65 2062 726f 7773  ss in some brows
-000088d0: 6572 7320 2863 6872 6f6d 6529 2c20 736f  ers (chrome), so
-000088e0: 2063 6f6e 7369 6465 7220 6c65 6176 696e   consider leavin
-000088f0: 6720 6974 206f 6e20 7769 7468 2061 6c6c  g it on with all
-00008900: 2074 6865 2076 616c 7565 7320 6174 207a   the values at z
-00008910: 6572 6f0a 0a2a 2067 6574 2061 2070 6c61  ero..* get a pla
-00008920: 696e 7465 7874 2066 696c 6520 6c69 7374  intext file list
-00008930: 696e 6720 6279 2061 6464 696e 6720 603f  ing by adding `?
-00008940: 6c73 3d74 6020 746f 2061 2055 524c 2c20  ls=t` to a URL, 
-00008950: 6f72 2061 2063 6f6d 7061 6374 2063 6f6c  or a compact col
-00008960: 6f72 6564 206f 6e65 2077 6974 6820 603f  ored one with `?
-00008970: 6c73 3d76 6020 2866 6f72 2075 6e69 7820  ls=v` (for unix 
-00008980: 7465 726d 696e 616c 7329 0a0a 2a20 6966  terminals)..* if
-00008990: 2079 6f75 2061 7265 2075 7369 6e67 206d   you are using m
-000089a0: 6564 6961 2068 6f74 6b65 7973 2074 6f20  edia hotkeys to 
-000089b0: 7377 6974 6368 2073 6f6e 6773 2061 6e64  switch songs and
-000089c0: 2061 7265 2067 6574 7469 6e67 2074 6972   are getting tir
-000089d0: 6564 206f 6620 7365 6569 6e67 2074 6865  ed of seeing the
-000089e0: 204f 5344 2070 6f70 7570 2077 6869 6368   OSD popup which
-000089f0: 2057 696e 646f 7773 2064 6f65 736e 2774   Windows doesn't
-00008a00: 206c 6574 2079 6f75 2064 6973 6162 6c65   let you disable
-00008a10: 2c20 636f 6e73 6964 6572 205b 2e2f 636f  , consider [./co
-00008a20: 6e74 7269 622f 6d65 6469 612d 6f73 642d  ntrib/media-osd-
-00008a30: 6267 6f6e 652e 7073 315d 2863 6f6e 7472  bgone.ps1](contr
-00008a40: 6962 2f23 6d65 6469 612d 6f73 642d 6267  ib/#media-osd-bg
-00008a50: 6f6e 6570 7331 290a 0a2a 2063 6c69 636b  oneps1)..* click
-00008a60: 2074 6865 2062 6f74 746f 6d2d 6c65 6674   the bottom-left
-00008a70: 2060 cf80 6020 746f 206f 7065 6e20 6120   `..` to open a 
-00008a80: 6a61 7661 7363 7269 7074 2070 726f 6d70  javascript promp
-00008a90: 7420 666f 7220 6465 6275 6767 696e 670a  t for debugging.
-00008aa0: 0a2a 2066 696c 6573 206e 616d 6564 2060  .* files named `
-00008ab0: 2e70 726f 6c6f 6775 652e 6874 6d6c 6020  .prologue.html` 
-00008ac0: 2f20 602e 6570 696c 6f67 7565 2e68 746d  / `.epilogue.htm
-00008ad0: 6c60 2077 696c 6c20 6265 2072 656e 6465  l` will be rende
-00008ae0: 7265 6420 6265 666f 7265 2f61 6674 6572  red before/after
-00008af0: 2064 6972 6563 746f 7279 206c 6973 7469   directory listi
-00008b00: 6e67 7320 756e 6c65 7373 2060 2d2d 6e6f  ngs unless `--no
-00008b10: 2d6c 6f67 7565 7360 0a0a 2a20 6669 6c65  -logues`..* file
-00008b20: 7320 6e61 6d65 6420 6052 4541 444d 452e  s named `README.
-00008b30: 6d64 6020 2f20 6072 6561 646d 652e 6d64  md` / `readme.md
-00008b40: 6020 7769 6c6c 2062 6520 7265 6e64 6572  ` will be render
-00008b50: 6564 2061 6674 6572 2064 6972 6563 746f  ed after directo
-00008b60: 7279 206c 6973 7469 6e67 7320 756e 6c65  ry listings unle
-00008b70: 7373 2060 2d2d 6e6f 2d72 6561 646d 6560  ss `--no-readme`
-00008b80: 2028 6275 7420 602e 6570 696c 6f67 7565   (but `.epilogue
-00008b90: 2e68 746d 6c60 2074 616b 6573 2070 7265  .html` takes pre
-00008ba0: 6365 6465 6e63 6529 0a0a 0a23 2320 7365  cedence)...## se
-00008bb0: 6172 6368 696e 670a 0a73 6561 7263 6820  arching..search 
-00008bc0: 6279 2073 697a 652c 2064 6174 652c 2070  by size, date, p
-00008bd0: 6174 682f 6e61 6d65 2c20 6d70 332d 7461  ath/name, mp3-ta
-00008be0: 6773 2c20 2e2e 2e0a 0a21 5b63 6f70 7970  gs, .....![copyp
-00008bf0: 6172 7479 2d73 6561 7263 682d 6673 385d  arty-search-fs8]
-00008c00: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
-00008c10: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-00008c20: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-00008c30: 322f 3132 3936 3335 3336 352d 6330 6666  2/129635365-c0ff
-00008c40: 3261 3966 2d30 6565 352d 3466 6333 2d38  2a9f-0ee5-4fc3-8
-00008c50: 6262 362d 3030 3630 3333 6366 3637 6238  bb6-006033cf67b8
-00008c60: 2e70 6e67 290a 0a77 6865 6e20 7374 6172  .png)..when star
-00008c70: 7465 6420 7769 7468 2060 2d65 3264 7361  ted with `-e2dsa
-00008c80: 6020 636f 7079 7061 7274 7920 7769 6c6c  ` copyparty will
-00008c90: 2073 6361 6e2f 696e 6465 7820 616c 6c20   scan/index all 
-00008ca0: 796f 7572 2066 696c 6573 2e20 5468 6973  your files. This
-00008cb0: 2061 766f 6964 7320 6475 706c 6963 6174   avoids duplicat
-00008cc0: 6573 206f 6e20 7570 6c6f 6164 2c20 616e  es on upload, an
-00008cd0: 6420 616c 736f 206d 616b 6573 2074 6865  d also makes the
-00008ce0: 2076 6f6c 756d 6573 2073 6561 7263 6861   volumes searcha
-00008cf0: 626c 6520 7468 726f 7567 6820 7468 6520  ble through the 
-00008d00: 7765 622d 7569 3a0a 2a20 6d61 6b65 2073  web-ui:.* make s
-00008d10: 6561 7263 6820 7175 6572 6965 7320 6279  earch queries by
-00008d20: 2060 7369 7a65 602f 6064 6174 6560 2f60   `size`/`date`/`
-00008d30: 6469 7265 6374 6f72 792d 7061 7468 602f  directory-path`/
-00008d40: 6066 696c 656e 616d 6560 2c20 6f72 2e2e  `filename`, or..
-00008d50: 2e0a 2a20 6472 6167 2f64 726f 7020 6120  ..* drag/drop a 
-00008d60: 6c6f 6361 6c20 6669 6c65 2074 6f20 7365  local file to se
-00008d70: 6520 6966 2074 6865 2073 616d 6520 636f  e if the same co
-00008d80: 6e74 656e 7473 2065 7869 7374 2073 6f6d  ntents exist som
-00008d90: 6577 6865 7265 206f 6e20 7468 6520 7365  ewhere on the se
-00008da0: 7276 6572 2c20 7365 6520 5b66 696c 652d  rver, see [file-
-00008db0: 7365 6172 6368 5d28 2366 696c 652d 7365  search](#file-se
-00008dc0: 6172 6368 290a 0a70 6174 682f 6e61 6d65  arch)..path/name
-00008dd0: 2071 7565 7269 6573 2061 7265 2073 7061   queries are spa
-00008de0: 6365 2d73 6570 6172 6174 6564 2c20 414e  ce-separated, AN
-00008df0: 4427 6564 2074 6f67 6574 6865 722c 2061  D'ed together, a
-00008e00: 6e64 2077 6f72 6473 2061 7265 206e 6567  nd words are neg
-00008e10: 6174 6564 2077 6974 6820 6120 602d 6020  ated with a `-` 
-00008e20: 7072 6566 6978 2c20 736f 2066 6f72 2065  prefix, so for e
-00008e30: 7861 6d70 6c65 3a0a 2a20 7061 7468 3a20  xample:.* path: 
-00008e40: 6073 6869 6261 7961 6e20 2d62 6f73 7361  `shibayan -bossa
-00008e50: 6020 6669 6e64 7320 616c 6c20 6669 6c65  ` finds all file
-00008e60: 7320 7768 6572 6520 6f6e 6520 6f66 2074  s where one of t
-00008e70: 6865 2066 6f6c 6465 7273 2063 6f6e 7461  he folders conta
-00008e80: 696e 2060 7368 6962 6179 616e 6020 6275  in `shibayan` bu
-00008e90: 7420 6669 6c74 6572 7320 6f75 7420 616e  t filters out an
-00008ea0: 7920 7265 7375 6c74 7320 7768 6572 6520  y results where 
-00008eb0: 6062 6f73 7361 6020 6578 6973 7473 2073  `bossa` exists s
-00008ec0: 6f6d 6577 6865 7265 2069 6e20 7468 6520  omewhere in the 
-00008ed0: 7061 7468 0a2a 206e 616d 653a 2060 6465  path.* name: `de
-00008ee0: 6d65 746f 7269 2073 7479 7860 2067 6976  metori styx` giv
-00008ef0: 6573 2079 6f75 205b 676f 6f64 2073 7475  es you [good stu
-00008f00: 6666 5d28 6874 7470 733a 2f2f 7777 772e  ff](https://www.
-00008f10: 796f 7574 7562 652e 636f 6d2f 7761 7463  youtube.com/watc
-00008f20: 683f 763d 7a47 6830 6731 345a 4a38 4926  h?v=zGh0g14ZJ8I&
-00008f30: 6c69 7374 3d50 4c33 4131 3437 4244 3135  list=PL3A147BD15
-00008f40: 3145 4535 3231 3826 696e 6465 783d 3929  1EE5218&index=9)
-00008f50: 0a0a 7468 6520 6072 6177 6020 6669 656c  ..the `raw` fiel
-00008f60: 6420 616c 6c6f 7773 2066 6f72 206d 6f72  d allows for mor
-00008f70: 6520 636f 6d70 6c65 7820 7374 7566 6620  e complex stuff 
-00008f80: 7375 6368 2061 7320 6028 2074 6167 7320  such as `( tags 
-00008f90: 6c69 6b65 202a 6e68 6174 6f2a 206f 7220  like *nhato* or 
-00008fa0: 7461 6773 206c 696b 6520 2a74 6169 7368  tags like *taish
-00008fb0: 692a 2029 2061 6e64 2028 206e 6f74 2074  i* ) and ( not t
-00008fc0: 6167 7320 6c69 6b65 202a 6e68 6174 6f2a  ags like *nhato*
-00008fd0: 206f 7220 6e6f 7420 7461 6773 206c 696b   or not tags lik
-00008fe0: 6520 2a74 6169 7368 692a 2029 6020 7768  e *taishi* )` wh
-00008ff0: 6963 6820 6669 6e64 7320 616c 6c20 736f  ich finds all so
-00009000: 6e67 7320 6279 2065 6974 6865 7220 6e68  ngs by either nh
-00009010: 6174 6f20 6f72 2074 6169 7368 692c 2065  ato or taishi, e
-00009020: 7863 6c75 6469 6e67 2063 6f6c 6c61 6273  xcluding collabs
-00009030: 2028 7465 7272 6962 6c65 2065 7861 6d70   (terrible examp
-00009040: 6c65 2c20 7768 7920 776f 756c 6420 796f  le, why would yo
-00009050: 7520 646f 2074 6861 7429 0a0a 666f 7220  u do that)..for 
-00009060: 7468 6520 6162 6f76 6520 6578 616d 706c  the above exampl
-00009070: 6520 746f 2077 6f72 6b2c 2061 6464 2074  e to work, add t
-00009080: 6865 2063 6f6d 6d61 6e64 6c69 6e65 2061  he commandline a
-00009090: 7267 756d 656e 7420 602d 6532 7473 6020  rgument `-e2ts` 
-000090a0: 746f 2061 6c73 6f20 7363 616e 2f69 6e64  to also scan/ind
-000090b0: 6578 2074 6167 7320 6672 6f6d 206d 7573  ex tags from mus
-000090c0: 6963 2066 696c 6573 2c20 7768 6963 6820  ic files, which 
-000090d0: 6272 696e 6773 2075 7320 6f76 6572 2074  brings us over t
-000090e0: 6f3a 0a0a 0a23 2073 6572 7665 7220 636f  o:...# server co
-000090f0: 6e66 6967 0a0a 7573 696e 6720 6172 6775  nfig..using argu
-00009100: 6d65 6e74 7320 6f72 2063 6f6e 6669 6720  ments or config 
-00009110: 6669 6c65 732c 206f 7220 6120 6d69 7820  files, or a mix 
-00009120: 6f66 2062 6f74 683a 0a2a 2063 6f6e 6669  of both:.* confi
-00009130: 6720 6669 6c65 7320 2860 2d63 2073 6f6d  g files (`-c som
-00009140: 652e 636f 6e66 6029 2063 616e 2073 6574  e.conf`) can set
-00009150: 2061 6464 6974 696f 6e61 6c20 636f 6d6d   additional comm
-00009160: 616e 646c 696e 6520 6172 6775 6d65 6e74  andline argument
-00009170: 733b 2073 6565 205b 2e2f 646f 6373 2f65  s; see [./docs/e
-00009180: 7861 6d70 6c65 2e63 6f6e 665d 2864 6f63  xample.conf](doc
-00009190: 732f 6578 616d 706c 652e 636f 6e66 2920  s/example.conf) 
-000091a0: 616e 6420 5b2e 2f64 6f63 732f 6578 616d  and [./docs/exam
-000091b0: 706c 6532 2e63 6f6e 665d 2864 6f63 732f  ple2.conf](docs/
-000091c0: 6578 616d 706c 6532 2e63 6f6e 6629 0a2a  example2.conf).*
-000091d0: 2060 6b69 6c6c 202d 7320 5553 5231 6020   `kill -s USR1` 
-000091e0: 2873 616d 6520 6173 2060 7379 7374 656d  (same as `system
-000091f0: 6374 6c20 7265 6c6f 6164 2063 6f70 7970  ctl reload copyp
-00009200: 6172 7479 6029 2074 6f20 7265 6c6f 6164  arty`) to reload
-00009210: 2061 6363 6f75 6e74 7320 616e 6420 766f   accounts and vo
-00009220: 6c75 6d65 7320 6672 6f6d 2063 6f6e 6669  lumes from confi
-00009230: 6720 6669 6c65 7320 7769 7468 6f75 7420  g files without 
-00009240: 7265 7374 6172 7469 6e67 0a20 202a 206f  restarting.  * o
-00009250: 7220 636c 6963 6b20 7468 6520 605b 7265  r click the `[re
-00009260: 6c6f 6164 2063 6667 5d60 2062 7574 746f  load cfg]` butto
-00009270: 6e20 696e 2074 6865 2063 6f6e 7472 6f6c  n in the control
-00009280: 2d70 616e 656c 2077 6865 6e20 6c6f 6767  -panel when logg
-00009290: 6564 2069 6e20 6173 2061 646d 696e 200a  ed in as admin .
-000092a0: 2020 2a20 6368 616e 6765 7320 746f 2074    * changes to t
-000092b0: 6865 2060 5b67 6c6f 6261 6c5d 6020 636f  he `[global]` co
-000092c0: 6e66 6967 2073 6563 7469 6f6e 2072 6571  nfig section req
-000092d0: 7569 7265 7320 6120 7265 7374 6172 7420  uires a restart 
-000092e0: 746f 2074 616b 6520 6566 6665 6374 0a0a  to take effect..
-000092f0: 0a23 2320 7a65 726f 636f 6e66 0a0a 616e  .## zeroconf..an
-00009300: 6e6f 756e 6365 2065 6e61 626c 6564 2073  nounce enabled s
-00009310: 6572 7669 6365 7320 6f6e 2074 6865 204c  ervices on the L
-00009320: 414e 2028 5b70 6963 5d28 6874 7470 733a  AN ([pic](https:
-00009330: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-00009340: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-00009350: 636f 6d2f 3234 3130 3332 2f32 3135 3334  com/241032/21534
-00009360: 3437 3337 2d30 6561 6538 6439 382d 3934  4737-0eae8d98-94
-00009370: 3936 2d34 3235 362d 3961 6138 2d63 6432  96-4256-9aa8-cd2
-00009380: 6636 3937 3138 3130 642e 706e 6729 2920  f6971810d.png)) 
-00009390: 202d 2d20 602d 7a60 2065 6e61 626c 6573   -- `-z` enables
-000093a0: 2062 6f74 6820 5b6d 646e 735d 2823 6d64   both [mdns](#md
-000093b0: 6e73 2920 616e 6420 5b73 7364 705d 2823  ns) and [ssdp](#
-000093c0: 7373 6470 290a 0a2a 2060 2d2d 7a2d 6f6e  ssdp)..* `--z-on
-000093d0: 6020 2f20 602d 2d7a 2d6f 6666 6027 206c  ` / `--z-off`' l
-000093e0: 696d 6974 7320 7468 6520 6665 6174 7572  imits the featur
-000093f0: 6520 746f 2063 6572 7461 696e 206e 6574  e to certain net
-00009400: 776f 726b 730a 0a0a 2323 2320 6d64 6e73  works...### mdns
-00009410: 0a0a 4c41 4e20 646f 6d61 696e 2d6e 616d  ..LAN domain-nam
-00009420: 6520 616e 6420 6665 6174 7572 6520 616e  e and feature an
-00009430: 6e6f 756e 6365 720a 0a75 7365 7320 5b6d  nouncer..uses [m
-00009440: 756c 7469 6361 7374 2064 6e73 5d28 6874  ulticast dns](ht
-00009450: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
-00009460: 6961 2e6f 7267 2f77 696b 692f 4d75 6c74  ia.org/wiki/Mult
-00009470: 6963 6173 745f 444e 5329 2074 6f20 6769  icast_DNS) to gi
-00009480: 7665 2063 6f70 7970 6172 7479 2061 2064  ve copyparty a d
-00009490: 6f6d 6169 6e20 7768 6963 6820 616e 7920  omain which any 
-000094a0: 6d61 6368 696e 6520 6f6e 2074 6865 204c  machine on the L
-000094b0: 414e 2063 616e 2075 7365 2074 6f20 6163  AN can use to ac
-000094c0: 6365 7373 2069 740a 0a61 6c6c 2065 6e61  cess it..all ena
-000094d0: 626c 6564 2073 6572 7669 6365 7320 285b  bled services ([
-000094e0: 7765 6264 6176 5d28 2377 6562 6461 762d  webdav](#webdav-
-000094f0: 7365 7276 6572 292c 205b 6674 705d 2823  server), [ftp](#
-00009500: 6674 702d 7365 7276 6572 292c 205b 736d  ftp-server), [sm
-00009510: 625d 2823 736d 622d 7365 7276 6572 2929  b](#smb-server))
-00009520: 2077 696c 6c20 6170 7065 6172 2069 6e20   will appear in 
-00009530: 6d44 4e53 2d61 7761 7265 2066 696c 6520  mDNS-aware file 
-00009540: 6d61 6e61 6765 7273 2028 4b44 452c 2067  managers (KDE, g
-00009550: 6e6f 6d65 2c20 6d61 634f 532c 202e 2e2e  nome, macOS, ...
-00009560: 290a 0a74 6865 2064 6f6d 6169 6e20 7769  )..the domain wi
-00009570: 6c6c 2062 6520 6874 7470 3a2f 2f70 6172  ll be http://par
-00009580: 7479 626f 782e 6c6f 6361 6c20 6966 2074  tybox.local if t
-00009590: 6865 206d 6163 6869 6e65 2773 2068 6f73  he machine's hos
-000095a0: 746e 616d 6520 6973 2060 7061 7274 7962  tname is `partyb
-000095b0: 6f78 6020 756e 6c65 7373 2060 2d2d 6e61  ox` unless `--na
-000095c0: 6d65 6020 7370 6563 6966 6965 7320 736f  me` specifies so
-000095d0: 656d 7468 696e 6720 656c 7365 0a0a 0a23  emthing else...#
-000095e0: 2323 2073 7364 700a 0a77 696e 646f 7773  ## ssdp..windows
-000095f0: 2d65 7870 6c6f 7265 7220 616e 6e6f 756e  -explorer announ
-00009600: 6365 720a 0a75 7365 7320 5b73 7364 705d  cer..uses [ssdp]
-00009610: 2868 7474 7073 3a2f 2f65 6e2e 7769 6b69  (https://en.wiki
-00009620: 7065 6469 612e 6f72 672f 7769 6b69 2f53  pedia.org/wiki/S
-00009630: 696d 706c 655f 5365 7276 6963 655f 4469  imple_Service_Di
-00009640: 7363 6f76 6572 795f 5072 6f74 6f63 6f6c  scovery_Protocol
-00009650: 2920 746f 206d 616b 6520 636f 7079 7061  ) to make copypa
-00009660: 7274 7920 6170 7065 6172 2069 6e20 7468  rty appear in th
-00009670: 6520 7769 6e64 6f77 7320 6669 6c65 2065  e windows file e
-00009680: 7870 6c6f 7265 7220 6f6e 2061 6c6c 206d  xplorer on all m
-00009690: 6163 6869 6e65 7320 6f6e 2074 6865 204c  achines on the L
-000096a0: 414e 0a0a 646f 7562 6c65 636c 6963 6b69  AN..doubleclicki
-000096b0: 6e67 2074 6865 2069 636f 6e20 6f70 656e  ng the icon open
-000096c0: 7320 7468 6520 2263 6f6e 6e65 6374 2220  s the "connect" 
-000096d0: 7061 6765 2077 6869 6368 2065 7870 6c61  page which expla
-000096e0: 696e 7320 686f 7720 746f 206d 6f75 6e74  ins how to mount
-000096f0: 2063 6f70 7970 6172 7479 2061 7320 6120   copyparty as a 
-00009700: 6c6f 6361 6c20 6669 6c65 7379 7374 656d  local filesystem
-00009710: 0a0a 6966 2063 6f70 7970 6172 7479 2064  ..if copyparty d
-00009720: 6f65 7320 6e6f 7420 6170 7065 6172 2069  oes not appear i
-00009730: 6e20 7769 6e64 6f77 7320 6578 706c 6f72  n windows explor
-00009740: 6572 2c20 7573 6520 602d 2d7a 7376 6020  er, use `--zsv` 
-00009750: 746f 2073 6565 2077 6879 3a0a 0a2a 206d  to see why:..* m
-00009760: 6179 6265 2074 6865 2064 6973 636f 7665  aybe the discove
-00009770: 7279 206d 756c 7469 6361 7374 2077 6173  ry multicast was
-00009780: 2073 656e 7420 6672 6f6d 2061 6e20 4950   sent from an IP
-00009790: 2077 6869 6368 2064 6f65 7320 6e6f 7420   which does not 
-000097a0: 696e 7465 7273 6563 7420 7769 7468 2074  intersect with t
-000097b0: 6865 2073 6572 7665 7220 7375 626e 6574  he server subnet
-000097c0: 730a 0a0a 2323 2071 722d 636f 6465 0a0a  s...## qr-code..
-000097d0: 7072 696e 7420 6120 7172 2d63 6f64 6520  print a qr-code 
-000097e0: 5b28 7363 7265 656e 7368 6f74 295d 2868  [(screenshot)](h
-000097f0: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-00009800: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-00009810: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-00009820: 3139 3437 3238 3533 332d 3666 3030 3834  194728533-6f0084
-00009830: 3962 2d63 3661 632d 3433 6336 2d39 3335  9b-c6ac-43c6-935
-00009840: 392d 3833 6534 3534 6431 3165 3030 2e70  9-83e454d11e00.p
-00009850: 6e67 2920 666f 7220 7175 6963 6b20 6163  ng) for quick ac
-00009860: 6365 7373 2c20 2067 7265 6174 2062 6574  cess,  great bet
-00009870: 7765 656e 2070 686f 6e65 7320 6f6e 2061  ween phones on a
-00009880: 6e64 726f 6964 2068 6f74 7370 6f74 7320  ndroid hotspots 
-00009890: 7768 6963 6820 6b65 6570 2063 6861 6e67  which keep chang
-000098a0: 696e 6720 7468 6520 7375 626e 6574 0a0a  ing the subnet..
-000098b0: 2a20 602d 2d71 7260 2065 6e61 626c 6573  * `--qr` enables
-000098c0: 2069 740a 2a20 602d 2d71 7273 6020 646f   it.* `--qrs` do
-000098d0: 6573 2068 7474 7073 2069 6e73 7465 6164  es https instead
-000098e0: 206f 6620 6874 7470 0a2a 2060 2d2d 7172   of http.* `--qr
-000098f0: 6c20 6c6f 6f74 626f 782f 3f70 773d 6875  l lootbox/?pw=hu
-00009900: 6e74 6572 3260 2061 7070 656e 6473 2074  nter2` appends t
-00009910: 6f20 7468 6520 7572 6c2c 206c 696e 6b69  o the url, linki
-00009920: 6e67 2074 6f20 7468 6520 606c 6f6f 7462  ng to the `lootb
-00009930: 6f78 6020 666f 6c64 6572 2077 6974 6820  ox` folder with 
-00009940: 7061 7373 776f 7264 2060 6875 6e74 6572  password `hunter
-00009950: 3260 0a2a 2060 2d2d 7172 7a20 3160 2066  2`.* `--qrz 1` f
-00009960: 6f72 6365 7320 3178 207a 6f6f 6d20 696e  orces 1x zoom in
-00009970: 7374 6561 6420 6f66 2061 7574 6f73 6361  stead of autosca
-00009980: 6c69 6e67 2074 6f20 6669 7420 7468 6520  ling to fit the 
-00009990: 7465 726d 696e 616c 2073 697a 650a 2020  terminal size.  
-000099a0: 2a20 3178 206d 6179 2072 656e 6465 7220  * 1x may render 
-000099b0: 696e 636f 7272 6563 746c 7920 6f6e 2073  incorrectly on s
-000099c0: 6f6d 6520 7465 726d 696e 616c 732f 666f  ome terminals/fo
-000099d0: 6e74 732c 2062 7574 2032 7820 7368 6f75  nts, but 2x shou
-000099e0: 6c64 2061 6c77 6179 7320 776f 726b 0a0a  ld always work..
-000099f0: 6974 2075 7365 7320 7468 6520 7365 7276  it uses the serv
-00009a00: 6572 2068 6f73 746e 616d 6520 6966 205b  er hostname if [
-00009a10: 6d64 6e73 5d28 236d 646e 7329 2069 7320  mdns](#mdns) is 
-00009a20: 656e 626c 6564 2c20 6f74 6865 7277 6973  enbled, otherwis
-00009a30: 6520 6974 276c 6c20 7573 6520 796f 7572  e it'll use your
-00009a40: 2065 7874 6572 6e61 6c20 6970 2028 6465   external ip (de
-00009a50: 6661 756c 7420 726f 7574 6529 2075 6e6c  fault route) unl
-00009a60: 6573 7320 602d 2d71 7269 6020 7370 6563  ess `--qri` spec
-00009a70: 6966 6965 7320 6120 7370 6563 6966 6963  ifies a specific
-00009a80: 2069 702d 7072 6566 6978 206f 7220 646f   ip-prefix or do
-00009a90: 6d61 696e 0a0a 0a23 2320 6674 7020 7365  main...## ftp se
-00009aa0: 7276 6572 0a0a 616e 2046 5450 2073 6572  rver..an FTP ser
-00009ab0: 7665 7220 6361 6e20 6265 2073 7461 7274  ver can be start
-00009ac0: 6564 2075 7369 6e67 2060 2d2d 6674 7020  ed using `--ftp 
-00009ad0: 3339 3231 602c 2020 616e 642f 6f72 2060  3921`,  and/or `
-00009ae0: 2d2d 6674 7073 6020 666f 7220 6578 706c  --ftps` for expl
-00009af0: 6963 6974 2054 4c53 2028 6674 7065 7329  icit TLS (ftpes)
-00009b00: 0a0a 2a20 6261 7365 6420 6f6e 205b 7079  ..* based on [py
-00009b10: 6674 7064 6c69 625d 2868 7474 7073 3a2f  ftpdlib](https:/
-00009b20: 2f67 6974 6875 622e 636f 6d2f 6769 616d  /github.com/giam
-00009b30: 7061 6f6c 6f2f 7079 6674 7064 6c69 6229  paolo/pyftpdlib)
-00009b40: 0a2a 206e 6565 6473 2061 2064 6564 6963  .* needs a dedic
-00009b50: 6174 6564 2070 6f72 7420 2863 616e 6e6f  ated port (canno
-00009b60: 7420 7368 6172 6520 7769 7468 2074 6865  t share with the
-00009b70: 2048 5454 502f 4854 5450 5320 4150 4929   HTTP/HTTPS API)
-00009b80: 0a2a 2075 706c 6f61 6473 2061 7265 206e  .* uploads are n
-00009b90: 6f74 2072 6573 756d 6162 6c65 202d 2d20  ot resumable -- 
-00009ba0: 6465 6c65 7465 2061 6e64 2072 6573 7461  delete and resta
-00009bb0: 7274 2069 6620 6e65 6365 7373 6172 790a  rt if necessary.
-00009bc0: 2a20 7275 6e73 2069 6e20 6163 7469 7665  * runs in active
-00009bd0: 206d 6f64 6520 6279 2064 6566 6175 6c74   mode by default
-00009be0: 2c20 796f 7520 7072 6f62 6162 6c79 2077  , you probably w
-00009bf0: 616e 7420 602d 2d66 7470 2d70 7220 3132  ant `--ftp-pr 12
-00009c00: 3030 302d 3133 3030 3060 0a20 202a 2069  000-13000`.  * i
-00009c10: 6620 796f 7520 656e 6162 6c65 2062 6f74  f you enable bot
-00009c20: 6820 6066 7470 6020 616e 6420 6066 7470  h `ftp` and `ftp
-00009c30: 7360 2c20 7468 6520 706f 7274 2d72 616e  s`, the port-ran
-00009c40: 6765 2077 696c 6c20 6265 2064 6976 6964  ge will be divid
-00009c50: 6564 2069 6e20 6861 6c66 0a20 202a 2073  ed in half.  * s
-00009c60: 6f6d 6520 6f6c 6465 7220 736f 6674 7761  ome older softwa
-00009c70: 7265 2028 6669 6c65 7a69 6c6c 6120 6f6e  re (filezilla on
-00009c80: 2064 6562 6961 6e2d 7374 6162 6c65 2920   debian-stable) 
-00009c90: 6361 6e6e 6f74 2070 6173 7369 7665 2d6d  cannot passive-m
-00009ca0: 6f64 6520 7769 7468 2054 4c53 0a2a 206c  ode with TLS.* l
-00009cb0: 6f67 696e 2077 6974 6820 616e 7920 7573  ogin with any us
-00009cc0: 6572 6e61 6d65 202b 2079 6f75 7220 7061  ername + your pa
-00009cd0: 7373 776f 7264 2c20 6f72 2070 7574 2079  ssword, or put y
-00009ce0: 6f75 7220 7061 7373 776f 7264 2069 6e20  our password in 
-00009cf0: 7468 6520 7573 6572 6e61 6d65 2066 6965  the username fie
-00009d00: 6c64 0a0a 0a23 2320 7765 6264 6176 2073  ld...## webdav s
-00009d10: 6572 7665 720a 0a77 6974 6820 7265 6164  erver..with read
-00009d20: 2d77 7269 7465 2073 7570 706f 7274 2c20  -write support, 
-00009d30: 2073 7570 706f 7274 7320 7769 6e58 5020   supports winXP 
-00009d40: 616e 6420 6c61 7465 722c 206d 6163 6f73  and later, macos
-00009d50: 2c20 6e61 7574 696c 7573 2f67 7666 730a  , nautilus/gvfs.
-00009d60: 0a63 6c69 636b 2074 6865 205b 636f 6e6e  .click the [conn
-00009d70: 6563 745d 2868 7474 703a 2f2f 3132 372e  ect](http://127.
-00009d80: 302e 302e 313a 3339 3233 2f3f 6863 2920  0.0.1:3923/?hc) 
-00009d90: 6275 7474 6f6e 2069 6e20 7468 6520 636f  button in the co
-00009da0: 6e74 726f 6c2d 7061 6e65 6c20 746f 2073  ntrol-panel to s
-00009db0: 6565 2063 6f6e 6e65 6374 696f 6e20 696e  ee connection in
-00009dc0: 7374 7275 6374 696f 6e73 2066 6f72 2077  structions for w
-00009dd0: 696e 646f 7773 2c20 6c69 6e75 782c 206d  indows, linux, m
-00009de0: 6163 6f73 0a0a 6765 6e65 7261 6c20 7573  acos..general us
-00009df0: 6167 653a 0a2a 206c 6f67 696e 2077 6974  age:.* login wit
-00009e00: 6820 616e 7920 7573 6572 6e61 6d65 202b  h any username +
-00009e10: 2079 6f75 7220 7061 7373 776f 7264 2c20   your password, 
-00009e20: 6f72 2070 7574 2079 6f75 7220 7061 7373  or put your pass
-00009e30: 776f 7264 2069 6e20 7468 6520 7573 6572  word in the user
-00009e40: 6e61 6d65 2066 6965 6c64 2028 7061 7373  name field (pass
-00009e50: 776f 7264 2066 6965 6c64 2063 616e 2062  word field can b
-00009e60: 6520 656d 7074 792f 7768 6174 6576 6572  e empty/whatever
-00009e70: 290a 0a6f 6e20 6d61 636f 732c 2063 6f6e  )..on macos, con
-00009e80: 6e65 6374 2066 726f 6d20 6669 6e64 6572  nect from finder
-00009e90: 3a0a 2a20 5b47 6f5d 202d 3e20 5b43 6f6e  :.* [Go] -> [Con
-00009ea0: 6e65 6374 2074 6f20 5365 7276 6572 2e2e  nect to Server..
-00009eb0: 2e5d 202d 3e20 6874 7470 3a2f 2f31 3932  .] -> http://192
-00009ec0: 2e31 3638 2e31 3233 2e31 3a33 3932 332f  .168.123.1:3923/
-00009ed0: 0a0a 696e 206f 7264 6572 2074 6f20 6772  ..in order to gr
-00009ee0: 616e 7420 6675 6c6c 2077 7269 7465 2d61  ant full write-a
-00009ef0: 6363 6573 7320 746f 2077 6562 6461 7620  ccess to webdav 
-00009f00: 636c 6965 6e74 732c 2074 6865 2076 6f6c  clients, the vol
-00009f10: 666c 6167 2060 6461 7760 206d 7573 7420  flag `daw` must 
-00009f20: 6265 2073 6574 2061 6e64 2074 6865 2061  be set and the a
-00009f30: 6363 6f75 6e74 206d 7573 7420 616c 736f  ccount must also
-00009f40: 2068 6176 6520 6465 6c65 7465 2d61 6363   have delete-acc
-00009f50: 6573 7320 286f 7468 6572 7769 7365 2074  ess (otherwise t
-00009f60: 6865 2063 6c69 656e 7420 776f 6e27 7420  he client won't 
-00009f70: 6265 2061 6c6c 6f77 6564 2074 6f20 7265  be allowed to re
-00009f80: 706c 6163 6520 7468 6520 636f 6e74 656e  place the conten
-00009f90: 7473 206f 6620 6578 6973 7469 6e67 2066  ts of existing f
-00009fa0: 696c 6573 2c20 7768 6963 6820 6973 2068  iles, which is h
-00009fb0: 6f77 2077 6562 6461 7620 776f 726b 7329  ow webdav works)
-00009fc0: 0a0a 0a23 2323 2063 6f6e 6e65 6374 696e  ...### connectin
-00009fd0: 6720 746f 2077 6562 6461 7620 6672 6f6d  g to webdav from
-00009fe0: 2077 696e 646f 7773 0a0a 7573 696e 6720   windows..using 
-00009ff0: 7468 6520 4755 4920 2028 7769 6e58 5020  the GUI  (winXP 
-0000a000: 6f72 206c 6174 6572 293a 0a2a 2072 6967  or later):.* rig
-0000a010: 6874 636c 6963 6b20 5b6d 7920 636f 6d70  htclick [my comp
-0000a020: 7574 6572 5d20 2d3e 205b 6d61 7020 6e65  uter] -> [map ne
-0000a030: 7477 6f72 6b20 6472 6976 655d 202d 3e20  twork drive] -> 
-0000a040: 466f 6c64 6572 3a20 6068 7474 703a 2f2f  Folder: `http://
-0000a050: 3139 322e 3136 382e 3132 332e 313a 3339  192.168.123.1:39
-0000a060: 3233 2f60 0a20 202a 206f 6e20 7769 6e58  23/`.  * on winX
-0000a070: 5020 6f6e 6c79 2c20 636c 6963 6b20 7468  P only, click th
-0000a080: 6520 6053 6967 6e20 7570 2066 6f72 206f  e `Sign up for o
-0000a090: 6e6c 696e 6520 7374 6f72 6167 6560 2068  nline storage` h
-0000a0a0: 7970 6572 6c69 6e6b 2069 6e73 7465 6164  yperlink instead
-0000a0b0: 2061 6e64 2070 7574 2074 6865 2055 524c   and put the URL
-0000a0c0: 2074 6865 7265 0a20 202a 2070 726f 7669   there.  * provi
-0000a0d0: 6469 6e67 2079 6f75 7220 7061 7373 776f  ding your passwo
-0000a0e0: 7264 2061 7320 7468 6520 7573 6572 6e61  rd as the userna
-0000a0f0: 6d65 2069 7320 7265 636f 6d6d 656e 6465  me is recommende
-0000a100: 643b 2074 6865 2070 6173 7377 6f72 6420  d; the password 
-0000a110: 6669 656c 6420 6361 6e20 6265 2061 6e79  field can be any
-0000a120: 7468 696e 6720 6f72 2065 6d70 7479 0a0a  thing or empty..
-0000a130: 6b6e 6f77 6e20 636c 6965 6e74 2062 7567  known client bug
-0000a140: 733a 0a2a 2077 696e 372b 2064 6f65 736e  s:.* win7+ doesn
-0000a150: 2774 2061 6374 7561 6c6c 7920 7365 6e64  't actually send
-0000a160: 2074 6865 2070 6173 7377 6f72 6420 746f   the password to
-0000a170: 2074 6865 2073 6572 7665 7220 7768 656e   the server when
-0000a180: 2072 6561 7574 6865 6e74 6963 6174 696e   reauthenticatin
-0000a190: 6720 6166 7465 7220 6120 7265 626f 6f74  g after a reboot
-0000a1a0: 2075 6e6c 6573 7320 796f 7520 6669 7273   unless you firs
-0000a1b0: 7420 7472 7920 746f 206c 6f67 696e 2077  t try to login w
-0000a1c0: 6974 6820 616e 2069 6e63 6f72 7265 6374  ith an incorrect
-0000a1d0: 2070 6173 7377 6f72 6420 616e 6420 7468   password and th
-0000a1e0: 656e 2073 7769 7463 6820 746f 2074 6865  en switch to the
-0000a1f0: 2063 6f72 7265 6374 2070 6173 7377 6f72   correct passwor
-0000a200: 640a 2020 2a20 6f72 206a 7573 7420 7479  d.  * or just ty
-0000a210: 7065 2079 6f75 7220 7061 7373 776f 7264  pe your password
-0000a220: 2069 6e74 6f20 7468 6520 7573 6572 6e61   into the userna
-0000a230: 6d65 2066 6965 6c64 2069 6e73 7465 6164  me field instead
-0000a240: 2074 6f20 6765 7420 6172 6f75 6e64 2069   to get around i
-0000a250: 7420 656e 7469 7265 6c79 0a2a 2063 6f6e  t entirely.* con
-0000a260: 6e65 6374 696e 6720 746f 2061 2066 6f6c  necting to a fol
-0000a270: 6465 7220 7768 6963 6820 616c 6c6f 7773  der which allows
-0000a280: 2061 6e6f 6e79 6d6f 7573 2072 6561 6420   anonymous read 
-0000a290: 7769 6c6c 206d 616b 6520 7772 6974 696e  will make writin
-0000a2a0: 6720 696d 706f 7373 6962 6c65 2c20 6173  g impossible, as
-0000a2b0: 2077 696e 646f 7773 2068 6173 2064 6563   windows has dec
-0000a2c0: 6964 6564 2069 7420 646f 6573 6e27 7420  ided it doesn't 
-0000a2d0: 6e65 6564 2074 6f20 6c6f 6769 6e0a 2020  need to login.  
-0000a2e0: 2a20 776f 726b 6172 6f75 6e64 3a20 636f  * workaround: co
-0000a2f0: 6e6e 6563 7420 7477 6963 653b 2066 6972  nnect twice; fir
-0000a300: 7374 2074 6f20 6120 666f 6c64 6572 2077  st to a folder w
-0000a310: 6869 6368 2072 6571 7569 7265 7320 6175  hich requires au
-0000a320: 7468 2c20 7468 656e 2074 6f20 7468 6520  th, then to the 
-0000a330: 666f 6c64 6572 2079 6f75 2061 6374 7561  folder you actua
-0000a340: 6c6c 7920 7761 6e74 2c20 616e 6420 6c65  lly want, and le
-0000a350: 6176 6520 626f 7468 206f 6620 7468 6f73  ave both of thos
-0000a360: 6520 6d6f 756e 7465 640a 2a20 7769 6e37  e mounted.* win7
-0000a370: 2b20 6d61 7920 6f70 656e 2061 206e 6577  + may open a new
-0000a380: 2074 6370 2063 6f6e 6e65 6374 696f 6e20   tcp connection 
-0000a390: 666f 7220 6576 6572 7920 6669 6c65 2061  for every file a
-0000a3a0: 6e64 2073 6f6d 6574 696d 6573 2066 6f72  nd sometimes for
-0000a3b0: 6765 7473 2074 6f20 636c 6f73 6520 7468  gets to close th
-0000a3c0: 656d 2c20 6576 656e 7475 616c 6c79 206e  em, eventually n
-0000a3d0: 6565 6469 6e67 2061 2072 6562 6f6f 740a  eeding a reboot.
-0000a3e0: 2020 2a20 6d61 7962 6520 4e49 432d 7265    * maybe NIC-re
-0000a3f0: 6c61 7465 6420 283f 3f29 2c20 6861 7070  lated (??), happ
-0000a400: 656e 7320 7769 7468 2077 696e 3130 2d6c  ens with win10-l
-0000a410: 7473 6320 6f6e 2065 3130 3030 6520 6275  tsc on e1000e bu
-0000a420: 7420 6e6f 7420 7669 7274 696f 0a2a 2077  t not virtio.* w
-0000a430: 696e 646f 7773 2063 616e 6e6f 7420 6163  indows cannot ac
-0000a440: 6365 7373 2066 6f6c 6465 7273 2077 6869  cess folders whi
-0000a450: 6368 2063 6f6e 7461 696e 2066 696c 656e  ch contain filen
-0000a460: 616d 6573 2077 6974 6820 696e 7661 6c69  ames with invali
-0000a470: 6420 756e 6963 6f64 6520 6f72 2066 6f72  d unicode or for
-0000a480: 6269 6464 656e 2063 6861 7261 6374 6572  bidden character
-0000a490: 7320 2860 3c3e 3a22 2f5c 7c3f 2a60 292c  s (`<>:"/\|?*`),
-0000a4a0: 206f 7220 6e61 6d65 7320 656e 6469 6e67   or names ending
-0000a4b0: 2077 6974 6820 602e 600a 2a20 7769 6e78   with `.`.* winx
-0000a4c0: 7020 6361 6e6e 6f74 2073 686f 7720 756e  p cannot show un
-0000a4d0: 6963 6f64 6520 6368 6172 6163 7465 7273  icode characters
-0000a4e0: 206f 7574 7369 6465 206f 6620 2a73 6f6d   outside of *som
-0000a4f0: 6520 7261 6e67 652a 0a20 202a 206c 6174  e range*.  * lat
-0000a500: 696e 2d31 2069 7320 6669 6e65 2c20 6869  in-1 is fine, hi
-0000a510: 7261 6761 6e61 2069 7320 6e6f 7420 286e  ragana is not (n
-0000a520: 6f74 2065 7665 6e20 6173 2073 6869 6674  ot even as shift
-0000a530: 2d6a 6973 206f 6e20 6a61 7061 6e65 7365  -jis on japanese
-0000a540: 2078 7029 0a0a 0a23 2320 736d 6220 7365   xp)...## smb se
-0000a550: 7276 6572 0a0a 756e 7361 6665 2c20 736c  rver..unsafe, sl
-0000a560: 6f77 2c20 6e6f 7420 7265 636f 6d6d 656e  ow, not recommen
-0000a570: 6465 6420 666f 7220 7761 6e2c 2020 656e  ded for wan,  en
-0000a580: 6162 6c65 2077 6974 6820 602d 2d73 6d62  able with `--smb
-0000a590: 6020 666f 7220 7265 6164 2d6f 6e6c 7920  ` for read-only 
-0000a5a0: 6f72 2060 2d2d 736d 6277 6020 666f 7220  or `--smbw` for 
-0000a5b0: 7265 6164 2d77 7269 7465 0a0a 636c 6963  read-write..clic
-0000a5c0: 6b20 7468 6520 5b63 6f6e 6e65 6374 5d28  k the [connect](
-0000a5d0: 6874 7470 3a2f 2f31 3237 2e30 2e30 2e31  http://127.0.0.1
-0000a5e0: 3a33 3932 332f 3f68 6329 2062 7574 746f  :3923/?hc) butto
-0000a5f0: 6e20 696e 2074 6865 2063 6f6e 7472 6f6c  n in the control
-0000a600: 2d70 616e 656c 2074 6f20 7365 6520 636f  -panel to see co
-0000a610: 6e6e 6563 7469 6f6e 2069 6e73 7472 7563  nnection instruc
-0000a620: 7469 6f6e 7320 666f 7220 7769 6e64 6f77  tions for window
-0000a630: 732c 206c 696e 7578 2c20 6d61 636f 730a  s, linux, macos.
-0000a640: 0a64 6570 656e 6465 6e63 6965 733a 2060  .dependencies: `
-0000a650: 7079 7468 6f6e 3320 2d6d 2070 6970 2069  python3 -m pip i
-0000a660: 6e73 7461 6c6c 202d 2d75 7365 7220 2d55  nstall --user -U
-0000a670: 2069 6d70 6163 6b65 743d 3d30 2e31 302e   impacket==0.10.
-0000a680: 3060 0a2a 206e 6577 6572 2076 6572 7369  0`.* newer versi
-0000a690: 6f6e 7320 6f66 2069 6d70 6163 6b65 7420  ons of impacket 
-0000a6a0: 7769 6c6c 2068 6f70 6566 756c 6c79 2077  will hopefully w
-0000a6b0: 6f72 6b20 6a75 7374 2066 696e 6520 6275  ork just fine bu
-0000a6c0: 7420 7468 6572 6520 6973 206d 6f6e 6b65  t there is monke
-0000a6d0: 7970 6174 6368 696e 6720 736f 206d 6179  ypatching so may
-0000a6e0: 6265 206e 6f74 0a0a 736f 6d65 202a 2a42  be not..some **B
-0000a6f0: 4947 2057 4152 4e49 4e47 532a 2a20 7370  IG WARNINGS** sp
-0000a700: 6563 6966 6963 2074 6f20 534d 422f 4349  ecific to SMB/CI
-0000a710: 4653 2c20 696e 2064 6563 7265 6173 696e  FS, in decreasin
-0000a720: 6720 696d 706f 7274 616e 6365 3a0a 2a20  g importance:.* 
-0000a730: 6e6f 7420 656e 7469 7265 6c79 2063 6f6e  not entirely con
-0000a740: 6669 6465 6e74 2074 6861 7420 7265 6164  fident that read
-0000a750: 2d6f 6e6c 7920 6973 2072 6561 642d 6f6e  -only is read-on
-0000a760: 6c79 0a2a 2074 6865 2073 6d62 2062 6163  ly.* the smb bac
-0000a770: 6b65 6e64 2069 7320 6e6f 7420 6675 6c6c  kend is not full
-0000a780: 7920 696e 7465 6772 6174 6564 2077 6974  y integrated wit
-0000a790: 6820 7666 732c 206d 6561 6e69 6e67 2074  h vfs, meaning t
-0000a7a0: 6865 7265 2063 6f75 6c64 2062 6520 7365  here could be se
-0000a7b0: 6375 7269 7479 2069 7373 7565 7320 2870  curity issues (p
-0000a7c0: 6174 6820 7472 6176 6572 7361 6c29 2e20  ath traversal). 
-0000a7d0: 506c 6561 7365 2075 7365 2060 2d2d 736d  Please use `--sm
-0000a7e0: 622d 706f 7274 6020 2873 6565 2062 656c  b-port` (see bel
-0000a7f0: 6f77 2920 616e 6420 5b70 7269 736f 6e70  ow) and [prisonp
-0000a800: 6172 7479 5d28 2e2f 6269 6e2f 7072 6973  arty](./bin/pris
-0000a810: 6f6e 7061 7274 792e 7368 290a 2020 2a20  onparty.sh).  * 
-0000a820: 6163 636f 756e 7420 7061 7373 776f 7264  account password
-0000a830: 7320 776f 726b 2070 6572 2d76 6f6c 756d  s work per-volum
-0000a840: 6520 6173 2065 7870 6563 7465 642c 2062  e as expected, b
-0000a850: 7574 2061 6363 6f75 6e74 2070 6572 6d69  ut account permi
-0000a860: 7373 696f 6e73 2061 7265 2063 6f61 6c65  ssions are coale
-0000a870: 7363 6564 3b20 616c 6c20 6163 636f 756e  sced; all accoun
-0000a880: 7473 2068 6176 6520 7265 6164 2d61 6363  ts have read-acc
-0000a890: 6573 7320 746f 2061 6c6c 2076 6f6c 756d  ess to all volum
-0000a8a0: 6573 2c20 616e 6420 6966 2061 2073 696e  es, and if a sin
-0000a8b0: 676c 6520 6163 636f 756e 7420 6861 7320  gle account has 
-0000a8c0: 7772 6974 652d 6163 6365 7373 2074 6f20  write-access to 
-0000a8d0: 736f 6d65 2076 6f6c 756d 6520 7468 656e  some volume then
-0000a8e0: 2061 6c6c 206f 7468 6572 2061 6363 6f75   all other accou
-0000a8f0: 6e74 7320 616c 736f 2064 6f0a 2020 2020  nts also do.    
-0000a900: 2a20 6966 206e 6f20 6163 636f 756e 7473  * if no accounts
-0000a910: 2068 6176 6520 7772 6974 652d 6163 6365   have write-acce
-0000a920: 7373 2074 6f20 6120 7370 6563 6966 6963  ss to a specific
-0000a930: 2076 6f6c 756d 652c 206f 7220 6966 2060   volume, or if `
-0000a940: 2d2d 736d 6277 6020 6973 206e 6f74 2073  --smbw` is not s
-0000a950: 6574 2c20 7468 656e 2077 7269 7469 6e67  et, then writing
-0000a960: 2074 6f20 7468 6174 2076 6f6c 756d 6520   to that volume 
-0000a970: 6672 6f6d 2073 6d62 202a 7368 6f75 6c64  from smb *should
-0000a980: 2a20 6265 2069 6d70 6f73 7369 626c 650a  * be impossible.
-0000a990: 2020 2020 2a20 7769 6c6c 2062 6520 6669      * will be fi
-0000a9a0: 7865 6420 6f6e 6365 205b 696d 7061 636b  xed once [impack
-0000a9b0: 6574 2076 302e 3131 2e30 5d28 6874 7470  et v0.11.0](http
-0000a9c0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f53  s://github.com/S
-0000a9d0: 6563 7572 6541 7574 6843 6f72 702f 696d  ecureAuthCorp/im
-0000a9e0: 7061 636b 6574 2f63 6f6d 6d69 742f 6439  packet/commit/d9
-0000a9f0: 3233 6330 3066 3735 6435 3462 3937 3262  23c00f75d54b972b
-0000aa00: 6361 3537 3361 3231 3161 3832 6630 3962  ca573a211a82f09b
-0000aa10: 3535 3236 3161 2920 6973 2072 656c 6561  55261a) is relea
-0000aa20: 7365 640a 2020 2a20 5b73 6861 646f 7769  sed.  * [shadowi
-0000aa30: 6e67 5d28 2373 6861 646f 7769 6e67 2920  ng](#shadowing) 
-0000aa40: 7072 6f62 6162 6c79 2077 6f72 6b73 2061  probably works a
-0000aa50: 7320 6578 7065 6374 6564 2062 7574 206e  s expected but n
-0000aa60: 6f20 6775 6172 616e 7465 6573 0a0a 616e  o guarantees..an
-0000aa70: 6420 736f 6d65 206d 696e 6f72 2069 7373  d some minor iss
-0000aa80: 7565 732c 0a2a 2063 6c69 656e 7473 206f  ues,.* clients o
-0000aa90: 6e6c 7920 7365 6520 7468 6520 6669 7273  nly see the firs
-0000aaa0: 7420 7e34 3030 2066 696c 6573 2069 6e20  t ~400 files in 
-0000aab0: 6269 6720 666f 6c64 6572 733b 205b 696d  big folders; [im
-0000aac0: 7061 636b 6574 2331 3433 335d 2868 7474  packet#1433](htt
-0000aad0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0000aae0: 5365 6375 7265 4175 7468 436f 7270 2f69  SecureAuthCorp/i
-0000aaf0: 6d70 6163 6b65 742f 6973 7375 6573 2f31  mpacket/issues/1
-0000ab00: 3433 3329 0a2a 2068 6f74 2d72 656c 6f61  433).* hot-reloa
-0000ab10: 6420 6f66 2073 6572 7665 7220 636f 6e66  d of server conf
-0000ab20: 6967 2028 602f 3f72 656c 6f61 643d 6366  ig (`/?reload=cf
-0000ab30: 6760 2920 646f 6573 206e 6f74 2069 6e63  g`) does not inc
-0000ab40: 6c75 6465 2074 6865 2060 5b67 6c6f 6261  lude the `[globa
-0000ab50: 6c5d 6020 7365 6374 696f 6e20 2863 6f6d  l]` section (com
-0000ab60: 6d61 6e64 6c69 6e65 2061 7267 7329 0a2a  mandline args).*
-0000ab70: 206c 6973 7465 6e73 206f 6e20 7468 6520   listens on the 
-0000ab80: 6669 7273 7420 4950 7634 2060 2d69 6020  first IPv4 `-i` 
-0000ab90: 696e 7465 7266 6163 6520 6f6e 6c79 2028  interface only (
-0000aba0: 6465 6661 756c 7420 3d20 3a3a 203d 2030  default = :: = 0
-0000abb0: 2e30 2e30 2e30 203d 2061 6c6c 290a 2a20  .0.0.0 = all).* 
-0000abc0: 6c6f 6769 6e20 646f 6573 6e27 7420 776f  login doesn't wo
-0000abd0: 726b 206f 6e20 7769 6e78 702c 2062 7574  rk on winxp, but
-0000abe0: 2061 6e6f 6e79 6d6f 7573 2061 6363 6573   anonymous acces
-0000abf0: 7320 6973 206f 6b20 2d2d 2072 656d 6f76  s is ok -- remov
-0000ac00: 6520 616c 6c20 6163 636f 756e 7473 2066  e all accounts f
-0000ac10: 726f 6d20 636f 7079 7061 7274 7920 636f  rom copyparty co
-0000ac20: 6e66 6967 2066 6f72 2074 6861 7420 746f  nfig for that to
-0000ac30: 2077 6f72 6b0a 2020 2a20 7769 6e31 3020   work.  * win10 
-0000ac40: 6f6e 7761 7264 7320 646f 6573 206e 6f74  onwards does not
-0000ac50: 2061 6c6c 6f77 2063 6f6e 6e65 6374 696e   allow connectin
-0000ac60: 6720 616e 6f6e 796d 6f75 736c 7920 2f20  g anonymously / 
-0000ac70: 7769 7468 6f75 7420 6163 636f 756e 7473  without accounts
-0000ac80: 0a2a 206f 6e20 7769 6e64 6f77 732c 2063  .* on windows, c
-0000ac90: 7265 6174 696e 6720 6120 6e65 7720 6669  reating a new fi
-0000aca0: 6c65 2074 6872 6f75 6768 2072 6967 6874  le through right
-0000acb0: 636c 6963 6b20 2d2d 3e20 6e65 7720 2d2d  click --> new --
-0000acc0: 3e20 7465 7874 6669 6c65 2074 6872 6f77  > textfile throw
-0000acd0: 7320 616e 2065 7272 6f72 2064 7565 2074  s an error due t
-0000ace0: 6f20 696d 7061 636b 6574 206c 696d 6974  o impacket limit
-0000acf0: 6174 696f 6e73 202d 2d20 6869 7420 4f4b  ations -- hit OK
-0000ad00: 2061 6e64 2046 3520 746f 2067 6574 2079   and F5 to get y
-0000ad10: 6f75 7220 6669 6c65 0a2a 2070 7974 686f  our file.* pytho
-0000ad20: 6e33 206f 6e6c 790a 2a20 736c 6f77 0a0a  n3 only.* slow..
-0000ad30: 6b6e 6f77 6e20 636c 6965 6e74 2062 7567  known client bug
-0000ad40: 733a 0a2a 206f 6e20 7769 6e37 206f 6e6c  s:.* on win7 onl
-0000ad50: 792c 2060 2d2d 736d 6231 6020 6973 206d  y, `--smb1` is m
-0000ad60: 7563 6820 6661 7374 6572 2074 6861 6e20  uch faster than 
-0000ad70: 736d 6232 2028 6465 6661 756c 7429 2062  smb2 (default) b
-0000ad80: 6563 6175 7365 2069 7420 6b65 6570 7320  ecause it keeps 
-0000ad90: 7265 7363 616e 6e69 6e67 2066 6f6c 6465  rescanning folde
-0000ada0: 7273 206f 6e20 736d 6232 0a20 202a 2068  rs on smb2.  * h
-0000adb0: 6f77 6576 6572 2073 6d62 3120 6973 2062  owever smb1 is b
-0000adc0: 7567 6779 2061 6e64 2069 7320 6e6f 7420  uggy and is not 
-0000add0: 656e 6162 6c65 6420 6279 2064 6566 6175  enabled by defau
-0000ade0: 6c74 206f 6e20 7769 6e31 3020 6f6e 7761  lt on win10 onwa
-0000adf0: 7264 730a 2a20 7769 6e64 6f77 7320 6361  rds.* windows ca
-0000ae00: 6e6e 6f74 2061 6363 6573 7320 666f 6c64  nnot access fold
-0000ae10: 6572 7320 7768 6963 6820 636f 6e74 6169  ers which contai
-0000ae20: 6e20 6669 6c65 6e61 6d65 7320 7769 7468  n filenames with
-0000ae30: 2069 6e76 616c 6964 2075 6e69 636f 6465   invalid unicode
-0000ae40: 206f 7220 666f 7262 6964 6465 6e20 6368   or forbidden ch
-0000ae50: 6172 6163 7465 7273 2028 603c 3e3a 222f  aracters (`<>:"/
-0000ae60: 5c7c 3f2a 6029 2c20 6f72 206e 616d 6573  \|?*`), or names
-0000ae70: 2065 6e64 696e 6720 7769 7468 2060 2e60   ending with `.`
-0000ae80: 0a0a 7468 6520 736d 6220 7072 6f74 6f63  ..the smb protoc
-0000ae90: 6f6c 206c 6973 7465 6e73 206f 6e20 5443  ol listens on TC
-0000aea0: 5020 706f 7274 2034 3435 2c20 7768 6963  P port 445, whic
-0000aeb0: 6820 6973 2061 2070 7269 7669 6c65 6765  h is a privilege
-0000aec0: 6420 706f 7274 206f 6e20 6c69 6e75 7820  d port on linux 
-0000aed0: 616e 6420 6d61 636f 732c 2077 6869 6368  and macos, which
-0000aee0: 2077 6f75 6c64 2072 6571 7569 7265 2072   would require r
-0000aef0: 756e 6e69 6e67 2063 6f70 7970 6172 7479  unning copyparty
-0000af00: 2061 7320 726f 6f74 2e20 486f 7765 7665   as root. Howeve
-0000af10: 722c 2074 6869 7320 6361 6e20 6265 2061  r, this can be a
-0000af20: 766f 6964 6564 2062 7920 6c69 7374 656e  voided by listen
-0000af30: 696e 6720 6f6e 2061 6e6f 7468 6572 2070  ing on another p
-0000af40: 6f72 7420 7573 696e 6720 602d 2d73 6d62  ort using `--smb
-0000af50: 2d70 6f72 7420 3339 3435 6020 616e 6420  -port 3945` and 
-0000af60: 7468 656e 2075 7369 6e67 204e 4154 2074  then using NAT t
-0000af70: 6f20 666f 7277 6172 6420 7468 6520 7472  o forward the tr
-0000af80: 6166 6669 6320 6672 6f6d 2034 3435 2074  affic from 445 t
-0000af90: 6f20 7468 6572 653b 0a2a 206f 6e20 6c69  o there;.* on li
-0000afa0: 6e75 783a 2060 6970 7461 626c 6573 202d  nux: `iptables -
-0000afb0: 7420 6e61 7420 2d41 2050 5245 524f 5554  t nat -A PREROUT
-0000afc0: 494e 4720 2d69 2065 7468 3020 2d70 2074  ING -i eth0 -p t
-0000afd0: 6370 202d 2d64 706f 7274 2034 3435 202d  cp --dport 445 -
-0000afe0: 6a20 5245 4449 5245 4354 202d 2d74 6f2d  j REDIRECT --to-
-0000aff0: 706f 7274 2033 3934 3560 0a0a 6175 7468  port 3945`..auth
-0000b000: 656e 7469 6361 7465 2077 6974 6820 6f6e  enticate with on
-0000b010: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
-0000b020: 6e67 3a0a 2a20 7573 6572 6e61 6d65 2060  ng:.* username `
-0000b030: 2475 7365 726e 616d 6560 2c20 7061 7373  $username`, pass
-0000b040: 776f 7264 2060 2470 6173 7377 6f72 6460  word `$password`
-0000b050: 0a2a 2075 7365 726e 616d 6520 6024 7061  .* username `$pa
-0000b060: 7373 776f 7264 602c 2070 6173 7377 6f72  ssword`, passwor
-0000b070: 6420 606b 600a 0a0a 2323 2066 696c 6520  d `k`...## file 
-0000b080: 696e 6465 7869 6e67 0a0a 656e 6162 6c65  indexing..enable
-0000b090: 7320 6465 6475 7020 616e 6420 6d75 7369  s dedup and musi
-0000b0a0: 6320 7365 6172 6368 202b 2b0a 0a66 696c  c search ++..fil
-0000b0b0: 6520 696e 6465 7869 6e67 2072 656c 6965  e indexing relie
-0000b0c0: 7320 6f6e 2074 776f 2064 6174 6162 6173  s on two databas
-0000b0d0: 6520 7461 626c 6573 2c20 7468 6520 7570  e tables, the up
-0000b0e0: 326b 2066 696c 6574 7265 6520 2860 2d65  2k filetree (`-e
-0000b0f0: 3264 6029 2061 6e64 2074 6865 206d 6574  2d`) and the met
-0000b100: 6164 6174 6120 7461 6773 2028 602d 6532  adata tags (`-e2
-0000b110: 7460 292c 2073 746f 7265 6420 696e 2060  t`), stored in `
-0000b120: 2e68 6973 742f 7570 326b 2e64 6260 2e20  .hist/up2k.db`. 
-0000b130: 436f 6e66 6967 7572 6174 696f 6e20 6361  Configuration ca
-0000b140: 6e20 6265 2064 6f6e 6520 7468 726f 7567  n be done throug
-0000b150: 6820 6172 6775 6d65 6e74 732c 2076 6f6c  h arguments, vol
-0000b160: 666c 6167 732c 206f 7220 6120 6d69 7820  flags, or a mix 
-0000b170: 6f66 2062 6f74 682e 0a0a 7468 726f 7567  of both...throug
-0000b180: 6820 6172 6775 6d65 6e74 733a 0a2a 2060  h arguments:.* `
-0000b190: 2d65 3264 6020 656e 6162 6c65 7320 6669  -e2d` enables fi
-0000b1a0: 6c65 2069 6e64 6578 696e 6720 6f6e 2075  le indexing on u
-0000b1b0: 706c 6f61 640a 2a20 602d 6532 6473 6020  pload.* `-e2ds` 
-0000b1c0: 616c 736f 2073 6361 6e73 2077 7269 7461  also scans writa
-0000b1d0: 626c 6520 666f 6c64 6572 7320 666f 7220  ble folders for 
-0000b1e0: 6e65 7720 6669 6c65 7320 6f6e 2073 7461  new files on sta
-0000b1f0: 7274 7570 0a2a 2060 2d65 3264 7361 6020  rtup.* `-e2dsa` 
-0000b200: 616c 736f 2073 6361 6e73 2061 6c6c 206d  also scans all m
-0000b210: 6f75 6e74 6564 2076 6f6c 756d 6573 2028  ounted volumes (
-0000b220: 696e 636c 7564 696e 6720 7265 6164 6f6e  including readon
-0000b230: 6c79 206f 6e65 7329 0a2a 2060 2d65 3274  ly ones).* `-e2t
-0000b240: 6020 656e 6162 6c65 7320 6d65 7461 6461  ` enables metada
-0000b250: 7461 2069 6e64 6578 696e 6720 6f6e 2075  ta indexing on u
-0000b260: 706c 6f61 640a 2a20 602d 6532 7473 6020  pload.* `-e2ts` 
-0000b270: 616c 736f 2073 6361 6e73 2066 6f72 2074  also scans for t
-0000b280: 6167 7320 696e 2061 6c6c 2066 696c 6573  ags in all files
-0000b290: 2074 6861 7420 646f 6e27 7420 6861 7665   that don't have
-0000b2a0: 2074 6167 7320 7965 740a 2a20 602d 6532   tags yet.* `-e2
-0000b2b0: 7473 7260 2061 6c73 6f20 6465 6c65 7465  tsr` also delete
-0000b2c0: 7320 616c 6c20 6578 6973 7469 6e67 2074  s all existing t
-0000b2d0: 6167 732c 2064 6f69 6e67 2061 2066 756c  ags, doing a ful
-0000b2e0: 6c20 7265 696e 6465 780a 2a20 602d 6532  l reindex.* `-e2
-0000b2f0: 7660 2076 6572 6669 6573 2066 696c 6520  v` verfies file 
-0000b300: 696e 7465 6772 6974 7920 6174 2073 7461  integrity at sta
-0000b310: 7274 7570 2c20 636f 6d70 6172 696e 6720  rtup, comparing 
-0000b320: 6861 7368 6573 2066 726f 6d20 7468 6520  hashes from the 
-0000b330: 6462 0a2a 2060 2d65 3276 7560 2070 6174  db.* `-e2vu` pat
-0000b340: 6368 6573 2074 6865 2064 6174 6162 6173  ches the databas
-0000b350: 6520 7769 7468 2074 6865 206e 6577 2068  e with the new h
-0000b360: 6173 6865 7320 6672 6f6d 2074 6865 2066  ashes from the f
-0000b370: 696c 6573 7973 7465 6d0a 2a20 602d 6532  ilesystem.* `-e2
-0000b380: 7670 6020 7061 6e69 6373 2061 6e64 206b  vp` panics and k
-0000b390: 696c 6c73 2063 6f70 7970 6172 7479 2069  ills copyparty i
-0000b3a0: 6e73 7465 6164 0a2a 2060 2d2d 786c 696e  nstead.* `--xlin
-0000b3b0: 6b60 2065 6e61 626c 6573 2064 6564 7570  k` enables dedup
-0000b3c0: 6c69 6361 7469 6f6e 2061 6372 6f73 7320  lication across 
-0000b3d0: 766f 6c75 6d65 730a 0a74 6865 2073 616d  volumes..the sam
-0000b3e0: 6520 6172 6775 6d65 6e74 7320 6361 6e20  e arguments can 
-0000b3f0: 6265 2073 6574 2061 7320 766f 6c66 6c61  be set as volfla
-0000b400: 6773 2c20 696e 2061 6464 6974 696f 6e20  gs, in addition 
-0000b410: 746f 2060 6432 6460 2c20 6064 3264 7360  to `d2d`, `d2ds`
-0000b420: 2c20 6064 3274 602c 2060 6432 7473 602c  , `d2t`, `d2ts`,
-0000b430: 2060 6432 7660 2066 6f72 2064 6973 6162   `d2v` for disab
-0000b440: 6c69 6e67 3a0a 2a20 602d 7620 7e2f 6d75  ling:.* `-v ~/mu
-0000b450: 7369 633a 3a72 3a63 2c65 3264 7361 2c65  sic::r:c,e2dsa,e
-0000b460: 3274 7372 6020 646f 6573 2061 2066 756c  2tsr` does a ful
-0000b470: 6c20 7265 696e 6465 7820 6f66 2065 7665  l reindex of eve
-0000b480: 7279 7468 696e 6720 6f6e 2073 7461 7274  rything on start
-0000b490: 7570 0a2a 2060 2d76 207e 2f6d 7573 6963  up.* `-v ~/music
-0000b4a0: 3a3a 723a 632c 6432 6460 2064 6973 6162  ::r:c,d2d` disab
-0000b4b0: 6c65 7320 2a2a 616c 6c2a 2a20 696e 6465  les **all** inde
-0000b4c0: 7869 6e67 2c20 6576 656e 2069 6620 616e  xing, even if an
-0000b4d0: 7920 602d 6532 2a60 2061 7265 206f 6e0a  y `-e2*` are on.
-0000b4e0: 2a20 602d 7620 7e2f 6d75 7369 633a 3a72  * `-v ~/music::r
-0000b4f0: 3a63 2c64 3274 6020 6469 7361 626c 6573  :c,d2t` disables
-0000b500: 2061 6c6c 2060 2d65 3274 2a60 2028 7461   all `-e2t*` (ta
-0000b510: 6773 292c 2064 6f65 7320 6e6f 7420 6166  gs), does not af
-0000b520: 6665 6374 2060 2d65 3264 2a60 0a2a 2060  fect `-e2d*`.* `
-0000b530: 2d76 207e 2f6d 7573 6963 3a3a 723a 632c  -v ~/music::r:c,
-0000b540: 6432 6473 6020 6469 7361 626c 6573 206f  d2ds` disables o
-0000b550: 6e2d 626f 6f74 2073 6361 6e73 3b20 6f6e  n-boot scans; on
-0000b560: 6c79 2069 6e64 6578 206e 6577 2075 706c  ly index new upl
-0000b570: 6f61 6473 0a2a 2060 2d76 207e 2f6d 7573  oads.* `-v ~/mus
-0000b580: 6963 3a3a 723a 632c 6432 7473 6020 7361  ic::r:c,d2ts` sa
-0000b590: 6d65 2065 7863 6570 7420 6f6e 6c79 2061  me except only a
-0000b5a0: 6666 6563 7469 6e67 2074 6167 730a 0a6e  ffecting tags..n
-0000b5b0: 6f74 653a 0a2a 2074 6865 2070 6172 7365  ote:.* the parse
-0000b5c0: 7220 6361 6e20 6669 6e61 6c6c 7920 6861  r can finally ha
-0000b5d0: 6e64 6c65 2060 632c 6532 6473 612c 6532  ndle `c,e2dsa,e2
-0000b5e0: 7473 7260 2073 6f20 796f 7520 6e6f 206c  tsr` so you no l
-0000b5f0: 6f6e 6765 7220 6861 7665 2074 6f20 6063  onger have to `c
-0000b600: 2c65 3264 7361 3a63 2c65 3274 7372 600a  ,e2dsa:c,e2tsr`.
-0000b610: 2a20 6065 3274 7372 6020 6973 2070 726f  * `e2tsr` is pro
-0000b620: 6261 626c 7920 616c 7761 7973 206f 7665  bably always ove
-0000b630: 726b 696c 6c2c 2073 696e 6365 2060 6532  rkill, since `e2
-0000b640: 6473 602f 6065 3264 7361 6020 776f 756c  ds`/`e2dsa` woul
-0000b650: 6420 7069 636b 2075 7020 616e 7920 6669  d pick up any fi
-0000b660: 6c65 206d 6f64 6966 6963 6174 696f 6e73  le modifications
-0000b670: 2061 6e64 2060 6532 7473 6020 776f 756c   and `e2ts` woul
-0000b680: 6420 7468 656e 2072 6569 6e64 6578 2074  d then reindex t
-0000b690: 686f 7365 2c20 756e 6c65 7373 2074 6865  hose, unless the
-0000b6a0: 7265 2069 7320 6120 6e65 7720 636f 7079  re is a new copy
-0000b6b0: 7061 7274 7920 7665 7273 696f 6e20 7769  party version wi
-0000b6c0: 7468 206e 6577 2070 6172 7365 7273 2061  th new parsers a
-0000b6d0: 6e64 2074 6865 2072 656c 6561 7365 206e  nd the release n
-0000b6e0: 6f74 6520 7361 7973 206f 7468 6572 7769  ote says otherwi
-0000b6f0: 7365 0a2a 2074 6865 2072 6573 6361 6e20  se.* the rescan 
-0000b700: 6275 7474 6f6e 2069 6e20 7468 6520 6164  button in the ad
-0000b710: 6d69 6e20 7061 6e65 6c20 6861 7320 6e6f  min panel has no
-0000b720: 2065 6666 6563 7420 756e 6c65 7373 2074   effect unless t
-0000b730: 6865 2076 6f6c 756d 6520 6861 7320 602d  he volume has `-
-0000b740: 6532 6473 6020 6f72 2068 6967 6865 720a  e2ds` or higher.
-0000b750: 2a20 6465 6475 706c 6963 6174 696f 6e20  * deduplication 
-0000b760: 6973 2070 6f73 7369 626c 6520 6f6e 2077  is possible on w
-0000b770: 696e 646f 7773 2069 6620 796f 7520 7275  indows if you ru
-0000b780: 6e20 636f 7079 7061 7274 7920 6173 2061  n copyparty as a
-0000b790: 646d 696e 6973 7472 6174 6f72 2028 6e6f  dministrator (no
-0000b7a0: 7420 7361 7969 6e67 2079 6f75 2073 686f  t saying you sho
-0000b7b0: 756c 6421 290a 0a23 2323 2065 7863 6c75  uld!)..### exclu
-0000b7c0: 6465 2d70 6174 7465 726e 730a 0a74 6f20  de-patterns..to 
-0000b7d0: 7361 7665 2073 6f6d 6520 7469 6d65 2c20  save some time, 
-0000b7e0: 2079 6f75 2063 616e 2070 726f 7669 6465   you can provide
-0000b7f0: 2061 2072 6567 6578 2070 6174 7465 726e   a regex pattern
-0000b800: 2066 6f72 2066 696c 6570 6174 6873 2074   for filepaths t
-0000b810: 6f20 6f6e 6c79 2069 6e64 6578 2062 7920  o only index by 
-0000b820: 6669 6c65 6e61 6d65 2f70 6174 682f 7369  filename/path/si
-0000b830: 7a65 2f6c 6173 742d 6d6f 6469 6669 6564  ze/last-modified
-0000b840: 2028 616e 6420 6e6f 7420 7468 6520 6861   (and not the ha
-0000b850: 7368 206f 6620 7468 6520 6669 6c65 2063  sh of the file c
-0000b860: 6f6e 7465 6e74 7329 2062 7920 7365 7474  ontents) by sett
-0000b870: 696e 6720 602d 2d6e 6f2d 6861 7368 205c  ing `--no-hash \
-0000b880: 2e69 736f 2460 206f 7220 7468 6520 766f  .iso$` or the vo
-0000b890: 6c66 6c61 6720 603a 632c 6e6f 6861 7368  lflag `:c,nohash
-0000b8a0: 3d5c 2e69 736f 2460 2c20 7468 6973 2068  =\.iso$`, this h
-0000b8b0: 6173 2074 6865 2066 6f6c 6c6f 7769 6e67  as the following
-0000b8c0: 2063 6f6e 7365 7175 656e 6365 733a 0a2a   consequences:.*
-0000b8d0: 2069 6e69 7469 616c 2069 6e64 6578 696e   initial indexin
-0000b8e0: 6720 6973 2077 6179 2066 6173 7465 722c  g is way faster,
-0000b8f0: 2065 7370 6563 6961 6c6c 7920 7768 656e   especially when
-0000b900: 2074 6865 2076 6f6c 756d 6520 6973 206f   the volume is o
-0000b910: 6e20 6120 6e65 7477 6f72 6b20 6469 736b  n a network disk
-0000b920: 0a2a 206d 616b 6573 2069 7420 696d 706f  .* makes it impo
-0000b930: 7373 6962 6c65 2074 6f20 5b66 696c 652d  ssible to [file-
-0000b940: 7365 6172 6368 5d28 2366 696c 652d 7365  search](#file-se
-0000b950: 6172 6368 290a 2a20 6966 2073 6f6d 656f  arch).* if someo
-0000b960: 6e65 2075 706c 6f61 6473 2074 6865 2073  ne uploads the s
-0000b970: 616d 6520 6669 6c65 2063 6f6e 7465 6e74  ame file content
-0000b980: 732c 2074 6865 2075 706c 6f61 6420 7769  s, the upload wi
-0000b990: 6c6c 206e 6f74 2062 6520 6465 7465 6374  ll not be detect
-0000b9a0: 6564 2061 7320 6120 6475 7065 2c20 736f  ed as a dupe, so
-0000b9b0: 2069 7420 7769 6c6c 206e 6f74 2067 6574   it will not get
-0000b9c0: 2073 796d 6c69 6e6b 6564 206f 7220 7265   symlinked or re
-0000b9d0: 6a65 6374 6564 0a0a 7369 6d69 6c61 726c  jected..similarl
-0000b9e0: 792c 2079 6f75 2063 616e 2066 756c 6c79  y, you can fully
-0000b9f0: 2069 676e 6f72 6520 6669 6c65 732f 666f   ignore files/fo
-0000ba00: 6c64 6572 7320 7573 696e 6720 602d 2d6e  lders using `--n
-0000ba10: 6f2d 6964 7820 5b2e 2e2e 5d60 2061 6e64  o-idx [...]` and
-0000ba20: 2060 3a63 2c6e 6f69 6478 3d5c 2e69 736f   `:c,noidx=\.iso
-0000ba30: 2460 0a0a 6966 2079 6f75 2073 6574 2060  $`..if you set `
-0000ba40: 2d2d 6e6f 2d68 6173 6820 5b2e 2e2e 5d60  --no-hash [...]`
-0000ba50: 2067 6c6f 6261 6c6c 792c 2079 6f75 2063   globally, you c
-0000ba60: 616e 2065 6e61 626c 6520 6861 7368 696e  an enable hashin
-0000ba70: 6720 666f 7220 7370 6563 6966 6963 2076  g for specific v
-0000ba80: 6f6c 756d 6573 2075 7369 6e67 2066 6c61  olumes using fla
-0000ba90: 6720 603a 632c 6e6f 6861 7368 3d60 0a0a  g `:c,nohash=`..
-0000baa0: 2323 2320 6669 6c65 7379 7374 656d 2067  ### filesystem g
-0000bab0: 7561 7264 730a 0a61 766f 6964 2074 7261  uards..avoid tra
-0000bac0: 7665 7273 696e 6720 696e 746f 206f 7468  versing into oth
-0000bad0: 6572 2066 696c 6573 7973 7465 6d73 2020  er filesystems  
-0000bae0: 7573 696e 6720 602d 2d78 6465 7660 202f  using `--xdev` /
-0000baf0: 2076 6f6c 666c 6167 2060 3a63 2c78 6465   volflag `:c,xde
-0000bb00: 7660 2c20 736b 6970 7069 6e67 2061 6e79  v`, skipping any
-0000bb10: 2073 796d 6c69 6e6b 7320 6f72 2062 696e   symlinks or bin
-0000bb20: 642d 6d6f 756e 7473 2074 6f20 616e 6f74  d-mounts to anot
-0000bb30: 6865 7220 4844 4420 666f 7220 6578 616d  her HDD for exam
-0000bb40: 706c 650a 0a61 6e64 2f6f 7220 796f 7520  ple..and/or you 
-0000bb50: 6361 6e20 602d 2d78 766f 6c60 202f 2060  can `--xvol` / `
-0000bb60: 3a63 2c78 766f 6c60 2074 6f20 6967 6e6f  :c,xvol` to igno
-0000bb70: 7265 2061 6c6c 2073 796d 6c69 6e6b 7320  re all symlinks 
-0000bb80: 6c65 6176 696e 6720 7468 6520 766f 6c75  leaving the volu
-0000bb90: 6d65 2773 2074 6f70 2064 6972 6563 746f  me's top directo
-0000bba0: 7279 2c20 6275 7420 7374 696c 6c20 616c  ry, but still al
-0000bbb0: 6c6f 7720 6269 6e64 2d6d 6f75 6e74 7320  low bind-mounts 
-0000bbc0: 706f 696e 7469 6e67 2065 6c73 6577 6865  pointing elsewhe
-0000bbd0: 7265 0a0a 2a2a 4e42 3a20 6f6e 6c79 2061  re..**NB: only a
-0000bbe0: 6666 6563 7473 2074 6865 2069 6e64 6578  ffects the index
-0000bbf0: 6572 2a2a 202d 2d20 7573 6572 7320 6361  er** -- users ca
-0000bc00: 6e20 7374 696c 6c20 6163 6365 7373 2061  n still access a
-0000bc10: 6e79 7468 696e 6720 696e 7369 6465 2061  nything inside a
-0000bc20: 2076 6f6c 756d 652c 2075 6e6c 6573 7320   volume, unless 
-0000bc30: 7368 6164 6f77 6564 2062 7920 616e 6f74  shadowed by anot
-0000bc40: 6865 7220 766f 6c75 6d65 0a0a 2323 2320  her volume..### 
-0000bc50: 7065 7269 6f64 6963 2072 6573 6361 6e0a  periodic rescan.
-0000bc60: 0a66 696c 6573 7973 7465 6d20 6d6f 6e69  .filesystem moni
-0000bc70: 746f 7269 6e67 3b20 2069 6620 636f 7079  toring;  if copy
-0000bc80: 7061 7274 7920 6973 206e 6f74 2074 6865  party is not the
-0000bc90: 206f 6e6c 7920 736f 6674 7761 7265 2064   only software d
-0000bca0: 6f69 6e67 2073 7475 6666 206f 6e20 796f  oing stuff on yo
-0000bcb0: 7572 2066 696c 6573 7973 7465 6d2c 2079  ur filesystem, y
-0000bcc0: 6f75 206d 6179 2077 616e 7420 746f 2065  ou may want to e
-0000bcd0: 6e61 626c 6520 7065 7269 6f64 6963 2072  nable periodic r
-0000bce0: 6573 6361 6e73 2074 6f20 6b65 6570 2074  escans to keep t
-0000bcf0: 6865 2069 6e64 6578 2075 7020 746f 2064  he index up to d
-0000bd00: 6174 650a 0a61 7267 756d 656e 7420 602d  ate..argument `-
-0000bd10: 2d72 652d 6d61 7861 6765 2036 3060 2077  -re-maxage 60` w
-0000bd20: 696c 6c20 7265 7363 616e 2061 6c6c 2076  ill rescan all v
-0000bd30: 6f6c 756d 6573 2065 7665 7279 2036 3020  olumes every 60 
-0000bd40: 7365 632c 2073 616d 6520 6173 2076 6f6c  sec, same as vol
-0000bd50: 666c 6167 2060 3a63 2c73 6361 6e3d 3630  flag `:c,scan=60
-0000bd60: 6020 746f 2073 7065 6369 6679 2069 7420  ` to specify it 
-0000bd70: 7065 722d 766f 6c75 6d65 0a0a 7570 6c6f  per-volume..uplo
-0000bd80: 6164 7320 6172 6520 6469 7361 626c 6564  ads are disabled
-0000bd90: 2077 6869 6c65 2061 2072 6573 6361 6e20   while a rescan 
-0000bda0: 6973 2068 6170 7065 6e69 6e67 2c20 736f  is happening, so
-0000bdb0: 2072 6573 6361 6e73 2077 696c 6c20 6265   rescans will be
-0000bdc0: 2064 656c 6179 6564 2062 7920 602d 2d64   delayed by `--d
-0000bdd0: 622d 6163 7460 2028 6465 6661 756c 7420  b-act` (default 
-0000bde0: 3130 2073 6563 2920 7768 656e 2074 6865  10 sec) when the
-0000bdf0: 7265 2069 7320 7772 6974 652d 6163 7469  re is write-acti
-0000be00: 7669 7479 2067 6f69 6e67 206f 6e20 2875  vity going on (u
-0000be10: 706c 6f61 6473 2c20 7265 6e61 6d65 732c  ploads, renames,
-0000be20: 202e 2e2e 290a 0a0a 2323 2075 706c 6f61   ...)...## uploa
-0000be30: 6420 7275 6c65 730a 0a73 6574 2075 706c  d rules..set upl
-0000be40: 6f61 6420 7275 6c65 7320 7573 696e 6720  oad rules using 
-0000be50: 766f 6c66 6c61 6773 2c20 2073 6f6d 6520  volflags,  some 
-0000be60: 6578 616d 706c 6573 3a0a 0a2a 2060 3a63  examples:..* `:c
-0000be70: 2c73 7a3d 316b 2d33 6d60 2073 6574 7320  ,sz=1k-3m` sets 
-0000be80: 616c 6c6f 7765 6420 6669 6c65 7369 7a65  allowed filesize
-0000be90: 2062 6574 7765 656e 2031 204b 6942 2061   between 1 KiB a
-0000bea0: 6e64 2033 204d 6942 2069 6e63 6c75 7369  nd 3 MiB inclusi
-0000beb0: 7665 2028 7375 6666 6978 6573 3a20 6062  ve (suffixes: `b
-0000bec0: 602c 2060 6b60 2c20 606d 602c 2060 6760  `, `k`, `m`, `g`
-0000bed0: 290a 2a20 603a 632c 6466 3d34 6760 2062  ).* `:c,df=4g` b
-0000bee0: 6c6f 636b 2075 706c 6f61 6473 2069 6620  lock uploads if 
-0000bef0: 7468 6572 6520 776f 756c 6420 6265 206c  there would be l
-0000bf00: 6573 7320 7468 616e 2034 2047 6942 2066  ess than 4 GiB f
-0000bf10: 7265 6520 6469 736b 2073 7061 6365 2061  ree disk space a
-0000bf20: 6674 6572 7761 7264 730a 2a20 603a 632c  fterwards.* `:c,
-0000bf30: 6e6f 7375 6260 2064 6973 616c 6c6f 7720  nosub` disallow 
-0000bf40: 7570 6c6f 6164 696e 6720 696e 746f 2073  uploading into s
-0000bf50: 7562 6469 7265 6374 6f72 6965 733b 2067  ubdirectories; g
-0000bf60: 6f65 7320 7765 6c6c 2077 6974 6820 6072  oes well with `r
-0000bf70: 6f74 6e60 2061 6e64 2060 726f 7466 603a  otn` and `rotf`:
-0000bf80: 0a2a 2060 3a63 2c72 6f74 6e3d 3130 3030  .* `:c,rotn=1000
-0000bf90: 2c32 6020 6d6f 7665 7320 7570 6c6f 6164  ,2` moves upload
-0000bfa0: 7320 696e 746f 2073 7562 666f 6c64 6572  s into subfolder
-0000bfb0: 732c 2075 7020 746f 2031 3030 3020 6669  s, up to 1000 fi
-0000bfc0: 6c65 7320 696e 2065 6163 6820 666f 6c64  les in each fold
-0000bfd0: 6572 2062 6566 6f72 6520 6d61 6b69 6e67  er before making
-0000bfe0: 2061 206e 6577 206f 6e65 2c20 7477 6f20   a new one, two 
-0000bff0: 6c65 7665 6c73 2064 6565 7020 286d 7573  levels deep (mus
-0000c000: 7420 6265 2061 7420 6c65 6173 7420 3129  t be at least 1)
-0000c010: 0a2a 2060 3a63 2c72 6f74 663d 2559 2f25  .* `:c,rotf=%Y/%
-0000c020: 6d2f 2564 2f25 4860 2065 6e66 6f72 6365  m/%d/%H` enforce
-0000c030: 7320 6669 6c65 7320 746f 2062 6520 7570  s files to be up
-0000c040: 6c6f 6164 6564 2069 6e74 6f20 6120 7374  loaded into a st
-0000c050: 7275 6374 7572 6520 6f66 2073 7562 666f  ructure of subfo
-0000c060: 6c64 6572 7320 6163 636f 7264 696e 6720  lders according 
-0000c070: 746f 2074 6861 7420 6461 7465 2066 6f72  to that date for
-0000c080: 6d61 740a 2020 2a20 6966 2073 6f6d 656f  mat.  * if someo
-0000c090: 6e65 2075 706c 6f61 6473 2074 6f20 602f  ne uploads to `/
-0000c0a0: 666f 6f2f 6261 7260 2074 6865 2070 6174  foo/bar` the pat
-0000c0b0: 6820 776f 756c 6420 6265 2072 6577 7269  h would be rewri
-0000c0c0: 7474 656e 2074 6f20 602f 666f 6f2f 6261  tten to `/foo/ba
-0000c0d0: 722f 3230 3231 2f30 382f 3036 2f32 3360  r/2021/08/06/23`
-0000c0e0: 2066 6f72 2065 7861 6d70 6c65 0a20 202a   for example.  *
-0000c0f0: 2062 7574 2074 6865 2061 6374 7561 6c20   but the actual 
-0000c100: 7661 6c75 6520 6973 206e 6f74 2076 6572  value is not ver
-0000c110: 6966 6965 642c 206a 7573 7420 7468 6520  ified, just the 
-0000c120: 7374 7275 6374 7572 652c 2073 6f20 7468  structure, so th
-0000c130: 6520 7570 6c6f 6164 6572 2063 616e 2063  e uploader can c
-0000c140: 686f 6f73 6520 616e 7920 7661 6c75 6573  hoose any values
-0000c150: 2077 6869 6368 2063 6f6e 666f 726d 2074   which conform t
-0000c160: 6f20 7468 6520 666f 726d 6174 2073 7472  o the format str
-0000c170: 696e 670a 2020 2020 2a20 6a75 7374 2074  ing.    * just t
-0000c180: 6f20 6176 6f69 6420 6164 6469 7469 6f6e  o avoid addition
-0000c190: 616c 2063 6f6d 706c 6578 6974 7920 696e  al complexity in
-0000c1a0: 2075 7032 6b20 7768 6963 6820 6973 2065   up2k which is e
-0000c1b0: 6e6f 7567 6820 6f66 2061 206d 6573 7320  nough of a mess 
-0000c1c0: 616c 7265 6164 790a 2a20 603a 632c 6c69  already.* `:c,li
-0000c1d0: 6665 7469 6d65 3d33 3030 6020 6465 6c65  fetime=300` dele
-0000c1e0: 7465 2075 706c 6f61 6465 6420 6669 6c65  te uploaded file
-0000c1f0: 7320 7768 656e 2074 6865 7920 6265 636f  s when they beco
-0000c200: 6d65 2035 206d 696e 7574 6573 206f 6c64  me 5 minutes old
-0000c210: 0a0a 796f 7520 6361 6e20 616c 736f 2073  ..you can also s
-0000c220: 6574 2074 7261 6e73 6163 7469 6f6e 206c  et transaction l
-0000c230: 696d 6974 7320 7768 6963 6820 6170 706c  imits which appl
-0000c240: 7920 7065 722d 4950 2061 6e64 2070 6572  y per-IP and per
-0000c250: 2d76 6f6c 756d 652c 2062 7574 2074 6865  -volume, but the
-0000c260: 7365 2061 7373 756d 6520 602d 6a20 3160  se assume `-j 1`
-0000c270: 2028 6465 6661 756c 7429 206f 7468 6572   (default) other
-0000c280: 7769 7365 2074 6865 206c 696d 6974 7320  wise the limits 
-0000c290: 7769 6c6c 2062 6520 6f66 662c 2066 6f72  will be off, for
-0000c2a0: 2065 7861 6d70 6c65 2060 2d6a 2034 6020   example `-j 4` 
-0000c2b0: 776f 756c 6420 616c 6c6f 7720 616e 7977  would allow anyw
-0000c2c0: 6865 7265 2062 6574 7765 656e 2031 7820  here between 1x 
-0000c2d0: 616e 6420 3478 2074 6865 206c 696d 6974  and 4x the limit
-0000c2e0: 7320 796f 7520 7365 7420 6465 7065 6e64  s you set depend
-0000c2f0: 696e 6720 6f6e 2077 6869 6368 2070 726f  ing on which pro
-0000c300: 6365 7373 696e 6720 6e6f 6465 2074 6865  cessing node the
-0000c310: 2063 6c69 656e 7420 6765 7473 2072 6f75   client gets rou
-0000c320: 7465 6420 746f 0a0a 2a20 603a 632c 6d61  ted to..* `:c,ma
-0000c330: 786e 3d32 3530 2c33 3630 3060 2061 6c6c  xn=250,3600` all
-0000c340: 6f77 7320 3235 3020 6669 6c65 7320 6f76  ows 250 files ov
-0000c350: 6572 2031 2068 6f75 7220 6672 6f6d 2065  er 1 hour from e
-0000c360: 6163 6820 4950 2028 7472 6163 6b65 6420  ach IP (tracked 
-0000c370: 7065 722d 766f 6c75 6d65 290a 2a20 603a  per-volume).* `:
-0000c380: 632c 6d61 7862 3d31 672c 3330 3060 2061  c,maxb=1g,300` a
-0000c390: 6c6c 6f77 7320 3120 4769 4220 746f 7461  llows 1 GiB tota
-0000c3a0: 6c20 6f76 6572 2035 206d 696e 7574 6573  l over 5 minutes
-0000c3b0: 2066 726f 6d20 6561 6368 2049 5020 2874   from each IP (t
-0000c3c0: 7261 636b 6564 2070 6572 2d76 6f6c 756d  racked per-volum
-0000c3d0: 6529 0a0a 0a23 2320 636f 6d70 7265 7373  e)...## compress
-0000c3e0: 2075 706c 6f61 6473 0a0a 6669 6c65 7320   uploads..files 
-0000c3f0: 6361 6e20 6265 2061 7574 6f63 6f6d 7072  can be autocompr
-0000c400: 6573 7365 6420 6f6e 2075 706c 6f61 642c  essed on upload,
-0000c410: 2020 6569 7468 6572 206f 6e20 7573 6572    either on user
-0000c420: 2d72 6571 7565 7374 2028 6966 2063 6f6e  -request (if con
-0000c430: 6669 6720 616c 6c6f 7773 2920 6f72 2066  fig allows) or f
-0000c440: 6f72 6365 6420 6279 2073 6572 7665 722d  orced by server-
-0000c450: 636f 6e66 6967 0a0a 2a20 766f 6c66 6c61  config..* volfla
-0000c460: 6720 6067 7a60 2061 6c6c 6f77 7320 677a  g `gz` allows gz
-0000c470: 2063 6f6d 7072 6573 7369 6f6e 0a2a 2076   compression.* v
-0000c480: 6f6c 666c 6167 2060 787a 6020 616c 6c6f  olflag `xz` allo
-0000c490: 7773 206c 7a6d 6120 636f 6d70 7265 7373  ws lzma compress
-0000c4a0: 696f 6e0a 2a20 766f 6c66 6c61 6720 6070  ion.* volflag `p
-0000c4b0: 6b60 202a 2a66 6f72 6365 732a 2a20 636f  k` **forces** co
-0000c4c0: 6d70 7265 7373 696f 6e20 6f6e 2061 6c6c  mpression on all
-0000c4d0: 2066 696c 6573 0a2a 2075 726c 2070 6172   files.* url par
-0000c4e0: 616d 6574 6572 2060 706b 6020 7265 7175  ameter `pk` requ
-0000c4f0: 6573 7473 2063 6f6d 7072 6573 7369 6f6e  ests compression
-0000c500: 2077 6974 6820 7365 7276 6572 2d64 6566   with server-def
-0000c510: 6175 6c74 2061 6c67 6f72 6974 686d 0a2a  ault algorithm.*
-0000c520: 2075 726c 2070 6172 616d 6574 6572 2060   url parameter `
-0000c530: 677a 6020 6f72 2060 787a 6020 7265 7175  gz` or `xz` requ
-0000c540: 6573 7473 2063 6f6d 7072 6573 7369 6f6e  ests compression
-0000c550: 2077 6974 6820 6120 7370 6563 6966 6963   with a specific
-0000c560: 2061 6c67 6f72 6974 686d 0a2a 2075 726c   algorithm.* url
-0000c570: 2070 6172 616d 6574 6572 2060 787a 6020   parameter `xz` 
-0000c580: 7265 7175 6573 7473 2078 7a20 636f 6d70  requests xz comp
-0000c590: 7265 7373 696f 6e0a 0a74 6869 6e67 7320  ression..things 
-0000c5a0: 746f 206e 6f74 652c 0a2a 2074 6865 2060  to note,.* the `
-0000c5b0: 677a 6020 616e 6420 6078 7a60 2061 7267  gz` and `xz` arg
-0000c5c0: 756d 656e 7473 2074 616b 6520 6120 7369  uments take a si
-0000c5d0: 6e67 6c65 206f 7074 696f 6e61 6c20 6172  ngle optional ar
-0000c5e0: 6775 6d65 6e74 2c20 7468 6520 636f 6d70  gument, the comp
-0000c5f0: 7265 7373 696f 6e20 6c65 7665 6c20 2872  ression level (r
-0000c600: 616e 6765 2030 2074 6f20 3929 0a2a 2074  ange 0 to 9).* t
-0000c610: 6865 2060 706b 6020 766f 6c66 6c61 6720  he `pk` volflag 
-0000c620: 7461 6b65 7320 7468 6520 6f70 7469 6f6e  takes the option
-0000c630: 616c 2061 7267 756d 656e 7420 6041 4c47  al argument `ALG
-0000c640: 4f52 4954 484d 2c4c 4556 454c 6020 7768  ORITHM,LEVEL` wh
-0000c650: 6963 6820 7769 6c6c 2074 6865 6e20 6265  ich will then be
-0000c660: 2066 6f72 6365 6420 666f 7220 616c 6c20   forced for all 
-0000c670: 7570 6c6f 6164 732c 2066 6f72 2065 7861  uploads, for exa
-0000c680: 6d70 6c65 2060 677a 2c39 6020 6f72 2060  mple `gz,9` or `
-0000c690: 787a 2c30 600a 2a20 6465 6661 756c 7420  xz,0`.* default 
-0000c6a0: 636f 6d70 7265 7373 696f 6e20 6973 2067  compression is g
-0000c6b0: 7a69 7020 6c65 7665 6c20 390a 2a20 616c  zip level 9.* al
-0000c6c0: 6c20 7570 6c6f 6164 206d 6574 686f 6473  l upload methods
-0000c6d0: 2065 7863 6570 7420 7570 326b 2061 7265   except up2k are
-0000c6e0: 2073 7570 706f 7274 6564 0a2a 2074 6865   supported.* the
-0000c6f0: 2066 696c 6573 2077 696c 6c20 6265 2069   files will be i
-0000c700: 6e64 6578 6564 2061 6674 6572 2063 6f6d  ndexed after com
-0000c710: 7072 6573 7369 6f6e 2c20 736f 2064 7570  pression, so dup
-0000c720: 652d 6465 7465 6374 696f 6e20 616e 6420  e-detection and 
-0000c730: 6669 6c65 2d73 6561 7263 6820 7769 6c6c  file-search will
-0000c740: 206e 6f74 2077 6f72 6b20 6173 2065 7870   not work as exp
-0000c750: 6563 7465 640a 0a73 6f6d 6520 6578 616d  ected..some exam
-0000c760: 706c 6573 2c0a 2a20 602d 7620 696e 633a  ples,.* `-v inc:
-0000c770: 696e 633a 773a 632c 706b 3d78 7a2c 3060  inc:w:c,pk=xz,0`
-0000c780: 2020 0a20 2066 6f6c 6465 7220 6e61 6d65    .  folder name
-0000c790: 6420 696e 632c 2073 6861 7265 6420 6174  d inc, shared at
-0000c7a0: 2069 6e63 2c20 7772 6974 652d 6f6e 6c79   inc, write-only
-0000c7b0: 2066 6f72 2065 7665 7279 6f6e 652c 2066   for everyone, f
-0000c7c0: 6f72 6365 7320 787a 2063 6f6d 7072 6573  orces xz compres
-0000c7d0: 7369 6f6e 2061 7420 6c65 7665 6c20 300a  sion at level 0.
-0000c7e0: 2a20 602d 7620 696e 633a 696e 633a 773a  * `-v inc:inc:w:
-0000c7f0: 632c 706b 6020 200a 2020 7361 6d65 2077  c,pk`  .  same w
-0000c800: 7269 7465 2d6f 6e6c 7920 696e 632c 2062  rite-only inc, b
-0000c810: 7574 2066 6f72 6365 7320 677a 2063 6f6d  ut forces gz com
-0000c820: 7072 6573 7369 6f6e 2028 6465 6661 756c  pression (defaul
-0000c830: 7429 2069 6e73 7465 6164 206f 6620 787a  t) instead of xz
-0000c840: 0a2a 2060 2d76 2069 6e63 3a69 6e63 3a77  .* `-v inc:inc:w
-0000c850: 3a63 2c67 7a60 2020 0a20 2061 6c6c 6f77  :c,gz`  .  allow
-0000c860: 7320 2862 7574 2064 6f65 7320 6e6f 7420  s (but does not 
-0000c870: 666f 7263 6529 2067 7a20 636f 6d70 7265  force) gz compre
-0000c880: 7373 696f 6e20 6966 2063 6c69 656e 7420  ssion if client 
-0000c890: 7570 6c6f 6164 7320 746f 2060 2f69 6e63  uploads to `/inc
-0000c8a0: 3f70 6b60 206f 7220 602f 696e 633f 677a  ?pk` or `/inc?gz
-0000c8b0: 6020 6f72 2060 2f69 6e63 3f67 7a3d 3460  ` or `/inc?gz=4`
-0000c8c0: 0a0a 0a23 2320 6f74 6865 7220 666c 6167  ...## other flag
-0000c8d0: 730a 0a2a 2060 3a63 2c6d 6167 6963 6020  s..* `:c,magic` 
-0000c8e0: 656e 6162 6c65 7320 6669 6c65 7479 7065  enables filetype
-0000c8f0: 2064 6574 6563 7469 6f6e 2066 6f72 206e   detection for n
-0000c900: 616d 656c 6573 7320 7570 6c6f 6164 732c  ameless uploads,
-0000c910: 2073 616d 6520 6173 2060 2d2d 6d61 6769   same as `--magi
-0000c920: 6360 0a20 202a 206e 6565 6473 2068 7474  c`.  * needs htt
-0000c930: 7073 3a2f 2f70 7970 692e 6f72 672f 7072  ps://pypi.org/pr
-0000c940: 6f6a 6563 742f 7079 7468 6f6e 2d6d 6167  oject/python-mag
-0000c950: 6963 2f20 6070 7974 686f 6e33 202d 6d20  ic/ `python3 -m 
-0000c960: 7069 7020 696e 7374 616c 6c20 2d2d 7573  pip install --us
-0000c970: 6572 202d 5520 7079 7468 6f6e 2d6d 6167  er -U python-mag
-0000c980: 6963 600a 2020 2a20 6f6e 2077 696e 646f  ic`.  * on windo
-0000c990: 7773 2067 7261 6220 7468 6973 2069 6e73  ws grab this ins
-0000c9a0: 7465 6164 2060 7079 7468 6f6e 3320 2d6d  tead `python3 -m
-0000c9b0: 2070 6970 2069 6e73 7461 6c6c 202d 2d75   pip install --u
-0000c9c0: 7365 7220 2d55 2070 7974 686f 6e2d 6d61  ser -U python-ma
-0000c9d0: 6769 632d 6269 6e60 0a0a 0a23 2320 6461  gic-bin`...## da
-0000c9e0: 7461 6261 7365 206c 6f63 6174 696f 6e0a  tabase location.
-0000c9f0: 0a69 6e2d 766f 6c75 6d65 2028 602e 6869  .in-volume (`.hi
-0000ca00: 7374 2f75 7032 6b2e 6462 602c 2064 6566  st/up2k.db`, def
-0000ca10: 6175 6c74 2920 6f72 2073 6f6d 6577 6865  ault) or somewhe
-0000ca20: 7265 2065 6c73 650a 0a63 6f70 7970 6172  re else..copypar
-0000ca30: 7479 2063 7265 6174 6573 2061 2073 7562  ty creates a sub
-0000ca40: 666f 6c64 6572 206e 616d 6564 2060 2e68  folder named `.h
-0000ca50: 6973 7460 2069 6e73 6964 6520 6561 6368  ist` inside each
-0000ca60: 2076 6f6c 756d 6520 7768 6572 6520 6974   volume where it
-0000ca70: 2073 746f 7265 7320 7468 6520 6461 7461   stores the data
-0000ca80: 6261 7365 2c20 7468 756d 626e 6169 6c73  base, thumbnails
-0000ca90: 2c20 616e 6420 736f 6d65 206f 7468 6572  , and some other
-0000caa0: 2073 7475 6666 0a0a 7468 6973 2063 616e   stuff..this can
-0000cab0: 2069 6e73 7465 6164 2062 6520 6b65 7074   instead be kept
-0000cac0: 2069 6e20 6120 7369 6e67 6c65 2070 6c61   in a single pla
-0000cad0: 6365 2075 7369 6e67 2074 6865 2060 2d2d  ce using the `--
-0000cae0: 6869 7374 6020 6172 6775 6d65 6e74 2c20  hist` argument, 
-0000caf0: 6f72 2074 6865 2060 6869 7374 3d60 2076  or the `hist=` v
-0000cb00: 6f6c 666c 6167 2c20 6f72 2061 206d 6978  olflag, or a mix
-0000cb10: 206f 6620 626f 7468 3a0a 2a20 602d 2d68   of both:.* `--h
-0000cb20: 6973 7420 7e2f 2e63 6163 6865 2f63 6f70  ist ~/.cache/cop
-0000cb30: 7970 6172 7479 202d 7620 7e2f 6d75 7369  yparty -v ~/musi
-0000cb40: 633a 3a72 3a63 2c68 6973 743d 2d60 2073  c::r:c,hist=-` s
-0000cb50: 6574 7320 607e 2f2e 6361 6368 652f 636f  ets `~/.cache/co
-0000cb60: 7079 7061 7274 7960 2061 7320 7468 6520  pyparty` as the 
-0000cb70: 6465 6661 756c 7420 706c 6163 6520 746f  default place to
-0000cb80: 2070 7574 2076 6f6c 756d 6520 696e 666f   put volume info
-0000cb90: 2c20 6275 7420 607e 2f6d 7573 6963 6020  , but `~/music` 
-0000cba0: 6765 7473 2074 6865 2072 6567 756c 6172  gets the regular
-0000cbb0: 2060 2e68 6973 7460 2073 7562 666f 6c64   `.hist` subfold
-0000cbc0: 6572 2028 602d 6020 7265 7374 6f72 6573  er (`-` restores
-0000cbd0: 2064 6566 6175 6c74 2062 6568 6176 696f   default behavio
-0000cbe0: 7229 0a0a 6e6f 7465 3a0a 2a20 6d61 726b  r)..note:.* mark
-0000cbf0: 646f 776e 2065 6469 7473 2061 7265 2061  down edits are a
-0000cc00: 6c77 6179 7320 7374 6f72 6564 2069 6e20  lways stored in 
-0000cc10: 6120 6c6f 6361 6c20 602e 6869 7374 6020  a local `.hist` 
-0000cc20: 7375 6264 6972 6563 746f 7279 0a2a 206f  subdirectory.* o
-0000cc30: 6e20 7769 6e64 6f77 7320 7468 6520 766f  n windows the vo
-0000cc40: 6c66 6c61 6720 7061 7468 2069 7320 6379  lflag path is cy
-0000cc50: 676c 696b 652c 2073 6f20 602f 632f 7465  glike, so `/c/te
-0000cc60: 6d70 6020 6d65 616e 7320 6043 3a5c 7465  mp` means `C:\te
-0000cc70: 6d70 6020 6275 7420 7573 6520 7265 6775  mp` but use regu
-0000cc80: 6c61 7220 7061 7468 7320 666f 7220 602d  lar paths for `-
-0000cc90: 2d68 6973 7460 0a20 202a 2079 6f75 2063  -hist`.  * you c
-0000cca0: 616e 2075 7365 2063 7967 7061 7468 7320  an use cygpaths 
-0000ccb0: 666f 7220 766f 6c75 6d65 7320 746f 6f2c  for volumes too,
-0000ccc0: 2060 2d76 2043 3a5c 5573 6572 733a 3a72   `-v C:\Users::r
-0000ccd0: 6020 616e 6420 602d 7620 2f63 2f75 7365  ` and `-v /c/use
-0000cce0: 7273 3a3a 7260 2062 6f74 6820 776f 726b  rs::r` both work
-0000ccf0: 0a0a 0a23 2320 6d65 7461 6461 7461 2066  ...## metadata f
-0000cd00: 726f 6d20 6175 6469 6f20 6669 6c65 730a  rom audio files.
-0000cd10: 0a73 6574 2060 2d65 3274 6020 746f 2069  .set `-e2t` to i
-0000cd20: 6e64 6578 2074 6167 7320 6f6e 2075 706c  ndex tags on upl
-0000cd30: 6f61 640a 0a60 2d6d 7465 6020 6465 6369  oad..`-mte` deci
-0000cd40: 6465 7320 7768 6963 6820 7461 6773 2074  des which tags t
-0000cd50: 6f20 696e 6465 7820 616e 6420 6469 7370  o index and disp
-0000cd60: 6c61 7920 696e 2074 6865 2062 726f 7773  lay in the brows
-0000cd70: 6572 2028 616e 6420 616c 736f 2074 6865  er (and also the
-0000cd80: 2064 6973 706c 6179 206f 7264 6572 292c   display order),
-0000cd90: 2074 6869 7320 6361 6e20 6265 2063 6861   this can be cha
-0000cda0: 6e67 6564 2070 6572 2d76 6f6c 756d 653a  nged per-volume:
-0000cdb0: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
-0000cdc0: 723a 632c 6d74 653d 7469 746c 652c 6172  r:c,mte=title,ar
-0000cdd0: 7469 7374 6020 696e 6465 7865 7320 616e  tist` indexes an
-0000cde0: 6420 6469 7370 6c61 7973 202a 7469 746c  d displays *titl
-0000cdf0: 652a 2066 6f6c 6c6f 7765 6420 6279 202a  e* followed by *
-0000ce00: 6172 7469 7374 2a0a 0a69 6620 796f 7520  artist*..if you 
-0000ce10: 6164 642f 7265 6d6f 7665 2061 2074 6167  add/remove a tag
-0000ce20: 2066 726f 6d20 606d 7465 6020 796f 7520   from `mte` you 
-0000ce30: 7769 6c6c 206e 6565 6420 746f 2072 756e  will need to run
-0000ce40: 2077 6974 6820 602d 6532 7473 7260 206f   with `-e2tsr` o
-0000ce50: 6e63 6520 746f 2072 6562 7569 6c64 2074  nce to rebuild t
-0000ce60: 6865 2064 6174 6162 6173 652c 206f 7468  he database, oth
-0000ce70: 6572 7769 7365 206f 6e6c 7920 6e65 7720  erwise only new 
-0000ce80: 6669 6c65 7320 7769 6c6c 2062 6520 6166  files will be af
-0000ce90: 6665 6374 6564 0a0a 6275 7420 696e 7374  fected..but inst
-0000cea0: 6561 6420 6f66 2075 7369 6e67 2060 2d6d  ead of using `-m
-0000ceb0: 7465 602c 2060 2d6d 7468 6020 6973 2061  te`, `-mth` is a
-0000cec0: 2062 6574 7465 7220 7761 7920 746f 2068   better way to h
-0000ced0: 6964 6520 7461 6773 2069 6e20 7468 6520  ide tags in the 
-0000cee0: 6272 6f77 7365 723a 2074 6865 7365 2074  browser: these t
-0000cef0: 6167 7320 7769 6c6c 206e 6f74 2062 6520  ags will not be 
-0000cf00: 6469 7370 6c61 7965 6420 6279 2064 6566  displayed by def
-0000cf10: 6175 6c74 2c20 6275 7420 7468 6579 2073  ault, but they s
-0000cf20: 7469 6c6c 2067 6574 2069 6e64 6578 6564  till get indexed
-0000cf30: 2061 6e64 2062 6563 6f6d 6520 7365 6172   and become sear
-0000cf40: 6368 6162 6c65 2c20 616e 6420 7573 6572  chable, and user
-0000cf50: 7320 6361 6e20 6368 6f6f 7365 2074 6f20  s can choose to 
-0000cf60: 756e 6869 6465 2074 6865 6d20 696e 2074  unhide them in t
-0000cf70: 6865 2060 5be2 9a99 efb8 8f5d 2063 6f6e  he `[......] con
-0000cf80: 6669 6760 2070 616e 650a 0a60 2d6d 746d  fig` pane..`-mtm
-0000cf90: 6020 6361 6e20 6265 2075 7365 6420 746f  ` can be used to
-0000cfa0: 2061 6464 206f 7220 7265 6465 6669 6e65   add or redefine
-0000cfb0: 2061 206d 6574 6164 6174 6120 6d61 7070   a metadata mapp
-0000cfc0: 696e 672c 2073 6179 2079 6f75 2068 6176  ing, say you hav
-0000cfd0: 6520 6d65 6469 6120 6669 6c65 7320 7769  e media files wi
-0000cfe0: 7468 2060 666f 6f60 2061 6e64 2060 6261  th `foo` and `ba
-0000cff0: 7260 2074 6167 7320 616e 6420 796f 7520  r` tags and you 
-0000d000: 7761 6e74 2074 6865 6d20 746f 2064 6973  want them to dis
-0000d010: 706c 6179 2061 7320 6071 7578 6020 696e  play as `qux` in
-0000d020: 2074 6865 2062 726f 7773 6572 2028 7072   the browser (pr
-0000d030: 6566 6572 7269 6e67 2060 666f 6f60 2069  eferring `foo` i
-0000d040: 6620 626f 7468 2061 7265 2070 7265 7365  f both are prese
-0000d050: 6e74 292c 2074 6865 6e20 646f 2060 2d6d  nt), then do `-m
-0000d060: 746d 2071 7578 3d66 6f6f 2c62 6172 6020  tm qux=foo,bar` 
-0000d070: 616e 6420 6e6f 7720 796f 7520 6361 6e20  and now you can 
-0000d080: 602d 6d74 6520 6172 7469 7374 2c74 6974  `-mte artist,tit
-0000d090: 6c65 2c71 7578 600a 0a74 6167 7320 7468  le,qux`..tags th
-0000d0a0: 6174 2073 7461 7274 2077 6974 6820 6120  at start with a 
-0000d0b0: 602e 6020 7375 6368 2061 7320 602e 6270  `.` such as `.bp
-0000d0c0: 6d60 2061 6e64 2060 2e64 7572 6028 6174  m` and `.dur`(at
-0000d0d0: 696f 6e29 2069 6e64 6963 6174 6520 6e75  ion) indicate nu
-0000d0e0: 6d65 7269 6320 7661 6c75 650a 0a73 6565  meric value..see
-0000d0f0: 2074 6865 2062 6561 7574 6966 756c 206d   the beautiful m
-0000d100: 6573 7320 6f66 2061 2064 6963 7469 6f6e  ess of a diction
-0000d110: 6172 7920 696e 205b 6d74 6167 2e70 795d  ary in [mtag.py]
-0000d120: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-0000d130: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
-0000d140: 7479 2f62 6c6f 622f 686f 7675 6473 7472  ty/blob/hovudstr
-0000d150: 6175 6d2f 636f 7079 7061 7274 792f 6d74  aum/copyparty/mt
-0000d160: 6167 2e70 7929 2066 6f72 2074 6865 2064  ag.py) for the d
-0000d170: 6566 6175 6c74 206d 6170 7069 6e67 7320  efault mappings 
-0000d180: 2873 686f 756c 6420 636f 7665 7220 6d70  (should cover mp
-0000d190: 332c 6f70 7573 2c66 6c61 632c 6d34 612c  3,opus,flac,m4a,
-0000d1a0: 7761 762c 6169 662c 290a 0a60 2d2d 6e6f  wav,aif,)..`--no
-0000d1b0: 2d6d 7574 6167 656e 6020 6469 7361 626c  -mutagen` disabl
-0000d1c0: 6573 204d 7574 6167 656e 2061 6e64 2075  es Mutagen and u
-0000d1d0: 7365 7320 4646 7072 6f62 6520 696e 7374  ses FFprobe inst
-0000d1e0: 6561 642c 2077 6869 6368 2e2e 2e0a 2a20  ead, which....* 
-0000d1f0: 6973 2061 626f 7574 2032 3078 2073 6c6f  is about 20x slo
-0000d200: 7765 7220 7468 616e 204d 7574 6167 656e  wer than Mutagen
-0000d210: 0a2a 2063 6174 6368 6573 2061 2066 6577  .* catches a few
-0000d220: 2074 6167 7320 7468 6174 204d 7574 6167   tags that Mutag
-0000d230: 656e 2064 6f65 736e 2774 0a20 202a 206d  en doesn't.  * m
-0000d240: 656c 6f64 6963 206b 6579 2c20 7669 6465  elodic key, vide
-0000d250: 6f20 7265 736f 6c75 7469 6f6e 2c20 6672  o resolution, fr
-0000d260: 616d 6572 6174 652c 2070 6978 666d 740a  amerate, pixfmt.
-0000d270: 2a20 6176 6f69 6473 2070 756c 6c69 6e67  * avoids pulling
-0000d280: 2061 6e79 2047 504c 2063 6f64 6520 696e   any GPL code in
-0000d290: 746f 2063 6f70 7970 6172 7479 0a2a 206d  to copyparty.* m
-0000d2a0: 6f72 6520 696d 706f 7274 616e 746c 7920  ore importantly 
-0000d2b0: 7275 6e73 2046 4670 726f 6265 206f 6e20  runs FFprobe on 
-0000d2c0: 696e 636f 6d69 6e67 2066 696c 6573 2077  incoming files w
-0000d2d0: 6869 6368 2069 7320 6261 6420 6966 2079  hich is bad if y
-0000d2e0: 6f75 7220 4646 6d70 6567 2068 6173 2061  our FFmpeg has a
-0000d2f0: 2063 7665 0a0a 602d 2d6d 7461 672d 746f   cve..`--mtag-to
-0000d300: 6020 7365 7473 2074 6865 2074 6167 2d73  ` sets the tag-s
-0000d310: 6361 6e20 7469 6d65 6f75 743b 2076 6572  can timeout; ver
-0000d320: 7920 6869 6768 2064 6566 6175 6c74 2028  y high default (
-0000d330: 3630 2073 6563 2920 746f 2063 6174 6572  60 sec) to cater
-0000d340: 2066 6f72 207a 6673 2061 6e64 206f 7468   for zfs and oth
-0000d350: 6572 2072 616e 646f 6d6c 792d 6672 6565  er randomly-free
-0000d360: 7a69 6e67 2066 696c 6573 7973 7465 6d73  zing filesystems
-0000d370: 2e20 4c6f 7765 7220 7661 6c75 6573 206c  . Lower values l
-0000d380: 696b 6520 3130 2061 7265 2075 7375 616c  ike 10 are usual
-0000d390: 6c79 2073 6166 652c 2061 6c6c 6f77 696e  ly safe, allowin
-0000d3a0: 6720 666f 7220 6661 7374 6572 2070 726f  g for faster pro
-0000d3b0: 6365 7373 696e 6720 6f66 2074 7269 636b  cessing of trick
-0000d3c0: 7920 6669 6c65 730a 0a0a 2323 2066 696c  y files...## fil
-0000d3d0: 6520 7061 7273 6572 2070 6c75 6769 6e73  e parser plugins
-0000d3e0: 0a0a 7072 6f76 6964 6520 6375 7374 6f6d  ..provide custom
-0000d3f0: 2070 6172 7365 7273 2074 6f20 696e 6465   parsers to inde
-0000d400: 7820 6164 6469 7469 6f6e 616c 2074 6167  x additional tag
-0000d410: 732c 2020 616c 736f 2073 6565 205b 2e2f  s,  also see [./
-0000d420: 6269 6e2f 6d74 6167 2f52 4541 444d 452e  bin/mtag/README.
-0000d430: 6d64 5d28 2e2f 6269 6e2f 6d74 6167 2f52  md](./bin/mtag/R
-0000d440: 4541 444d 452e 6d64 290a 0a63 6f70 7970  EADME.md)..copyp
-0000d450: 6172 7479 2063 616e 2069 6e76 6f6b 6520  arty can invoke 
-0000d460: 6578 7465 726e 616c 2070 726f 6772 616d  external program
-0000d470: 7320 746f 2063 6f6c 6c65 6374 2061 6464  s to collect add
-0000d480: 6974 696f 6e61 6c20 6d65 7461 6461 7461  itional metadata
-0000d490: 2066 6f72 2066 696c 6573 2075 7369 6e67   for files using
-0000d4a0: 2060 6d74 7060 2028 6569 7468 6572 2061   `mtp` (either a
-0000d4b0: 7320 6172 6775 6d65 6e74 206f 7220 766f  s argument or vo
-0000d4c0: 6c66 6c61 6729 2c20 7468 6572 6520 6973  lflag), there is
-0000d4d0: 2061 2064 6566 6175 6c74 2074 696d 656f   a default timeo
-0000d4e0: 7574 206f 6620 3630 7365 632c 2061 6e64  ut of 60sec, and
-0000d4f0: 206f 6e6c 7920 6669 6c65 7320 7768 6963   only files whic
-0000d500: 6820 636f 6e74 6169 6e20 6175 6469 6f20  h contain audio 
-0000d510: 6765 7420 616e 616c 797a 6564 2062 7920  get analyzed by 
-0000d520: 6465 6661 756c 7420 2873 6565 2061 792f  default (see ay/
-0000d530: 616e 2f61 6420 6265 6c6f 7729 0a0a 2a20  an/ad below)..* 
-0000d540: 602d 6d74 7020 2e62 706d 3d7e 2f62 696e  `-mtp .bpm=~/bin
-0000d550: 2f61 7564 696f 2d62 706d 2e70 7960 2077  /audio-bpm.py` w
-0000d560: 696c 6c20 6578 6563 7574 6520 607e 2f62  ill execute `~/b
-0000d570: 696e 2f61 7564 696f 2d62 706d 2e70 7960  in/audio-bpm.py`
-0000d580: 2077 6974 6820 7468 6520 6175 6469 6f20   with the audio 
-0000d590: 6669 6c65 2061 7320 6172 6775 6d65 6e74  file as argument
-0000d5a0: 2031 2074 6f20 7072 6f76 6964 6520 7468   1 to provide th
-0000d5b0: 6520 602e 6270 6d60 2074 6167 2c20 6966  e `.bpm` tag, if
-0000d5c0: 2074 6861 7420 646f 6573 206e 6f74 2065   that does not e
-0000d5d0: 7869 7374 2069 6e20 7468 6520 6175 6469  xist in the audi
-0000d5e0: 6f20 6d65 7461 6461 7461 0a2a 2060 2d6d  o metadata.* `-m
-0000d5f0: 7470 206b 6579 3d66 2c74 352c 7e2f 6269  tp key=f,t5,~/bi
-0000d600: 6e2f 6175 6469 6f2d 6b65 792e 7079 6020  n/audio-key.py` 
-0000d610: 7573 6573 2060 7e2f 6269 6e2f 6175 6469  uses `~/bin/audi
-0000d620: 6f2d 6b65 792e 7079 6020 746f 2067 6574  o-key.py` to get
-0000d630: 2074 6865 2060 6b65 7960 2074 6167 2c20   the `key` tag, 
-0000d640: 7265 706c 6163 696e 6720 616e 7920 6578  replacing any ex
-0000d650: 6973 7469 6e67 206d 6574 6164 6174 6120  isting metadata 
-0000d660: 7461 6720 2860 662c 6029 2c20 6162 6f72  tag (`f,`), abor
-0000d670: 7469 6e67 2069 6620 6974 2074 616b 6573  ting if it takes
-0000d680: 206c 6f6e 6765 7220 7468 616e 2035 7365   longer than 5se
-0000d690: 6320 2860 7435 2c60 290a 2a20 602d 7620  c (`t5,`).* `-v 
-0000d6a0: 7e2f 6d75 7369 633a 3a72 3a63 2c6d 7470  ~/music::r:c,mtp
-0000d6b0: 3d2e 6270 6d3d 7e2f 6269 6e2f 6175 6469  =.bpm=~/bin/audi
-0000d6c0: 6f2d 6270 6d2e 7079 3a63 2c6d 7470 3d6b  o-bpm.py:c,mtp=k
-0000d6d0: 6579 3d66 2c74 352c 7e2f 6269 6e2f 6175  ey=f,t5,~/bin/au
-0000d6e0: 6469 6f2d 6b65 792e 7079 6020 626f 7468  dio-key.py` both
-0000d6f0: 2061 7320 6120 7065 722d 766f 6c75 6d65   as a per-volume
-0000d700: 2063 6f6e 6669 6720 776f 7720 7468 6973   config wow this
-0000d710: 2069 7320 6765 7474 696e 6720 7567 6c79   is getting ugly
-0000d720: 0a0a 2a62 7574 2077 6169 742c 2074 6865  ..*but wait, the
-0000d730: 7265 2773 206d 6f72 6521 2a20 602d 6d74  re's more!* `-mt
-0000d740: 7060 2063 616e 2062 6520 7573 6564 2066  p` can be used f
-0000d750: 6f72 206e 6f6e 2d61 7564 696f 2066 696c  or non-audio fil
-0000d760: 6573 2061 7320 7765 6c6c 2075 7369 6e67  es as well using
-0000d770: 2074 6865 2060 6160 2066 6c61 673a 2060   the `a` flag: `
-0000d780: 6179 6020 6f6e 6c79 2064 6f20 6175 6469  ay` only do audi
-0000d790: 6f20 6669 6c65 7320 2864 6566 6175 6c74  o files (default
-0000d7a0: 292c 2060 616e 6020 6f6e 6c79 2064 6f20  ), `an` only do 
-0000d7b0: 6e6f 6e2d 6175 6469 6f20 6669 6c65 732c  non-audio files,
-0000d7c0: 206f 7220 6061 6460 2064 6f20 616c 6c20   or `ad` do all 
-0000d7d0: 6669 6c65 7320 2864 2061 7320 696e 2064  files (d as in d
-0000d7e0: 6f6e 7463 6172 6529 0a0a 2a20 2261 7564  ontcare)..* "aud
-0000d7f0: 696f 2066 696c 6522 2061 6c73 6f20 6d65  io file" also me
-0000d800: 616e 7320 7669 6465 6f73 2062 7477 2c20  ans videos btw, 
-0000d810: 6173 206c 6f6e 6720 6173 2074 6865 7265  as long as there
-0000d820: 2069 7320 616e 2061 7564 696f 2073 7472   is an audio str
-0000d830: 6561 6d0a 2a20 602d 6d74 7020 6578 743d  eam.* `-mtp ext=
-0000d840: 616e 2c7e 2f62 696e 2f66 696c 652d 6578  an,~/bin/file-ex
-0000d850: 742e 7079 6020 7275 6e73 2060 7e2f 6269  t.py` runs `~/bi
-0000d860: 6e2f 6669 6c65 2d65 7874 2e70 7960 2074  n/file-ext.py` t
-0000d870: 6f20 6765 7420 7468 6520 6065 7874 6020  o get the `ext` 
-0000d880: 7461 6720 6f6e 6c79 2069 6620 6669 6c65  tag only if file
-0000d890: 2069 7320 6e6f 7420 6175 6469 6f20 2860   is not audio (`
-0000d8a0: 616e 6029 0a2a 2060 2d6d 7470 2061 7263  an`).* `-mtp arc
-0000d8b0: 682c 6275 696c 742c 7665 722c 6f72 6967  h,built,ver,orig
-0000d8c0: 3d61 6e2c 6565 7865 2c65 646c 6c2c 7e2f  =an,eexe,edll,~/
-0000d8d0: 6269 6e2f 6578 652e 7079 6020 7275 6e73  bin/exe.py` runs
-0000d8e0: 2060 7e2f 6269 6e2f 6578 652e 7079 6020   `~/bin/exe.py` 
-0000d8f0: 746f 2067 6574 2070 726f 7065 7274 6965  to get propertie
-0000d900: 7320 6162 6f75 7420 7769 6e64 6f77 732d  s about windows-
-0000d910: 6269 6e61 7269 6573 206f 6e6c 7920 6966  binaries only if
-0000d920: 2066 696c 6520 6973 206e 6f74 2061 7564   file is not aud
-0000d930: 696f 2028 6061 6e60 2920 616e 6420 6669  io (`an`) and fi
-0000d940: 6c65 2065 7874 656e 7369 6f6e 2069 7320  le extension is 
-0000d950: 6578 6520 6f72 2064 6c6c 0a2a 2069 6620  exe or dll.* if 
-0000d960: 796f 7520 7761 6e74 2074 6f20 6461 6973  you want to dais
-0000d970: 7963 6861 696e 2070 6172 7365 7273 2c20  ychain parsers, 
-0000d980: 7573 6520 7468 6520 6070 6020 666c 6167  use the `p` flag
-0000d990: 2074 6f20 7365 7420 7072 6f63 6573 7369   to set processi
-0000d9a0: 6e67 206f 7264 6572 0a20 202a 2060 2d6d  ng order.  * `-m
-0000d9b0: 7470 2066 6f6f 3d70 312c 7e2f 612e 7079  tp foo=p1,~/a.py
-0000d9c0: 6020 7275 6e73 2062 6566 6f72 6520 602d  ` runs before `-
-0000d9d0: 6d74 7020 666f 6f3d 7032 2c7e 2f62 2e70  mtp foo=p2,~/b.p
-0000d9e0: 7960 2061 6e64 2077 696c 6c20 666f 7277  y` and will forw
-0000d9f0: 6172 6420 616c 6c20 7468 6520 7461 6773  ard all the tags
-0000da00: 2064 6574 6563 7465 6420 736f 2066 6172   detected so far
-0000da10: 2061 7320 6a73 6f6e 2074 6f20 7468 6520   as json to the 
-0000da20: 7374 6469 6e20 6f66 2062 2e70 790a 2a20  stdin of b.py.* 
-0000da30: 6f70 7469 6f6e 2060 6330 6020 6469 7361  option `c0` disa
-0000da40: 626c 6573 2063 6170 7475 7269 6e67 206f  bles capturing o
-0000da50: 6620 7374 646f 7574 2f73 7464 6572 722c  f stdout/stderr,
-0000da60: 2073 6f20 636f 7079 7061 7274 7920 7769   so copyparty wi
-0000da70: 6c6c 206e 6f74 2072 6563 6569 7665 2061  ll not receive a
-0000da80: 6e79 2074 6167 7320 6672 6f6d 2074 6865  ny tags from the
-0000da90: 2070 726f 6365 7373 2061 7420 616c 6c20   process at all 
-0000daa0: 2d2d 2069 6e73 7465 6164 2074 6865 2069  -- instead the i
-0000dab0: 6e76 6f6b 6564 2070 726f 6772 616d 2069  nvoked program i
-0000dac0: 7320 6672 6565 2074 6f20 7072 696e 7420  s free to print 
-0000dad0: 7768 6174 6576 6572 2074 6f20 7468 6520  whatever to the 
-0000dae0: 636f 6e73 6f6c 652c 206a 7573 7420 7573  console, just us
-0000daf0: 696e 6720 636f 7079 7061 7274 7920 6173  ing copyparty as
-0000db00: 2061 206c 6175 6e63 6865 720a 2020 2a20   a launcher.  * 
-0000db10: 6063 3160 2063 6170 7475 7265 7320 7374  `c1` captures st
-0000db20: 646f 7574 206f 6e6c 792c 2060 6332 6020  dout only, `c2` 
-0000db30: 6f6e 6c79 2073 7464 6572 722c 2061 6e64  only stderr, and
-0000db40: 2060 6333 6020 2864 6566 6175 6c74 2920   `c3` (default) 
-0000db50: 6361 7074 7572 6573 2062 6f74 680a 2a20  captures both.* 
-0000db60: 796f 7520 6361 6e20 636f 6e74 726f 6c20  you can control 
-0000db70: 686f 7720 7468 6520 7061 7273 6572 2069  how the parser i
-0000db80: 7320 6b69 6c6c 6564 2069 6620 6974 2074  s killed if it t
-0000db90: 696d 6573 206f 7574 2077 6974 6820 6f70  imes out with op
-0000dba0: 7469 6f6e 2060 6b74 6020 6b69 6c6c 696e  tion `kt` killin
-0000dbb0: 6720 7468 6520 656e 7469 7265 2070 726f  g the entire pro
-0000dbc0: 6365 7373 2074 7265 6520 2864 6566 6175  cess tree (defau
-0000dbd0: 6c74 292c 2060 6b6d 6020 6a75 7374 2074  lt), `km` just t
-0000dbe0: 6865 206d 6169 6e20 7072 6f63 6573 732c  he main process,
-0000dbf0: 206f 7220 606b 6e60 206c 6574 2069 7420   or `kn` let it 
-0000dc00: 636f 6e74 696e 7565 2072 756e 6e69 6e67  continue running
-0000dc10: 2075 6e74 696c 2063 6f70 7970 6172 7479   until copyparty
-0000dc20: 2069 7320 7465 726d 696e 6174 6564 0a0a   is terminated..
-0000dc30: 6966 2073 6f6d 6574 6869 6e67 2064 6f65  if something doe
-0000dc40: 736e 2774 2077 6f72 6b2c 2074 7279 2060  sn't work, try `
-0000dc50: 2d2d 6d74 6167 2d76 6020 666f 7220 7665  --mtag-v` for ve
-0000dc60: 7262 6f73 6520 6572 726f 7220 6d65 7373  rbose error mess
-0000dc70: 6167 6573 0a0a 0a23 2320 6576 656e 7420  ages...## event 
-0000dc80: 686f 6f6b 730a 0a74 7269 6767 6572 2061  hooks..trigger a
-0000dc90: 2070 726f 6772 616d 206f 6e20 7570 6c6f   program on uplo
-0000dca0: 6164 732c 2072 656e 616d 6573 2065 7463  ads, renames etc
-0000dcb0: 2028 5b65 7861 6d70 6c65 735d 282e 2f62   ([examples](./b
-0000dcc0: 696e 2f68 6f6f 6b73 2f29 290a 0a79 6f75  in/hooks/))..you
-0000dcd0: 2063 616e 2073 6574 2068 6f6f 6b73 2062   can set hooks b
-0000dce0: 6566 6f72 6520 616e 642f 6f72 2061 6674  efore and/or aft
-0000dcf0: 6572 2061 6e20 6576 656e 7420 6861 7070  er an event happ
-0000dd00: 656e 732c 2061 6e64 2063 7572 7265 6e74  ens, and current
-0000dd10: 6c79 2079 6f75 2063 616e 2068 6f6f 6b20  ly you can hook 
-0000dd20: 7570 6c6f 6164 732c 206d 6f76 6573 2f72  uploads, moves/r
-0000dd30: 656e 616d 6573 2c20 616e 6420 6465 6c65  enames, and dele
-0000dd40: 7465 730a 0a74 6865 7265 2773 2061 2062  tes..there's a b
-0000dd50: 756e 6368 206f 6620 666c 6167 7320 616e  unch of flags an
-0000dd60: 6420 7374 7566 662c 2073 6565 2060 2d2d  d stuff, see `--
-0000dd70: 6865 6c70 2d68 6f6f 6b73 600a 0a0a 2323  help-hooks`...##
-0000dd80: 2320 7570 6c6f 6164 2065 7665 6e74 730a  # upload events.
-0000dd90: 0a74 6865 206f 6c64 6572 2c20 6d6f 7265  .the older, more
-0000dda0: 2070 6f77 6572 6675 6c20 6170 7072 6f61   powerful approa
-0000ddb0: 6368 2028 5b65 7861 6d70 6c65 735d 282e  ch ([examples](.
-0000ddc0: 2f62 696e 2f6d 7461 672f 2929 3a0a 0a60  /bin/mtag/)):..`
-0000ddd0: 6060 0a2d 7620 2f6d 6e74 2f69 6e63 3a69  ``.-v /mnt/inc:i
-0000dde0: 6e63 3a77 3a63 2c6d 7465 3d2b 7831 3a63  nc:w:c,mte=+x1:c
-0000ddf0: 2c6d 7470 3d78 313d 6164 2c6b 6e2c 2f75  ,mtp=x1=ad,kn,/u
-0000de00: 7372 2f62 696e 2f6e 6f74 6966 792d 7365  sr/bin/notify-se
-0000de10: 6e64 0a60 6060 0a0a 736f 2066 696c 6573  nd.```..so files
-0000de20: 7973 7465 6d20 6c6f 6361 7469 6f6e 2060  ystem location `
-0000de30: 2f6d 6e74 2f69 6e63 6020 7368 6172 6564  /mnt/inc` shared
-0000de40: 2061 7420 602f 696e 6360 2c20 7772 6974   at `/inc`, writ
-0000de50: 652d 6f6e 6c79 2066 6f72 2065 7665 7279  e-only for every
-0000de60: 6f6e 652c 2061 7070 656e 6469 6e67 2060  one, appending `
-0000de70: 7831 6020 746f 2074 6865 206c 6973 7420  x1` to the list 
-0000de80: 6f66 2074 6167 7320 746f 2069 6e64 6578  of tags to index
-0000de90: 2028 606d 7465 6029 2c20 616e 6420 7573   (`mte`), and us
-0000dea0: 696e 6720 602f 7573 722f 6269 6e2f 6e6f  ing `/usr/bin/no
-0000deb0: 7469 6679 2d73 656e 6460 2074 6f20 2270  tify-send` to "p
-0000dec0: 726f 7669 6465 2220 7461 6720 6078 3160  rovide" tag `x1`
-0000ded0: 2066 6f72 2061 6e79 2066 696c 6574 7970   for any filetyp
-0000dee0: 6520 2860 6164 6029 2077 6974 6820 6b69  e (`ad`) with ki
-0000def0: 6c6c 2d6f 6e2d 7469 6d65 6f75 7420 6469  ll-on-timeout di
-0000df00: 7361 626c 6564 2028 606b 6e60 290a 0a74  sabled (`kn`)..t
-0000df10: 6861 7427 6c6c 2072 756e 2074 6865 2063  hat'll run the c
-0000df20: 6f6d 6d61 6e64 2060 6e6f 7469 6679 2d73  ommand `notify-s
-0000df30: 656e 6460 2077 6974 6820 7468 6520 7061  end` with the pa
-0000df40: 7468 2074 6f20 7468 6520 7570 6c6f 6164  th to the upload
-0000df50: 6564 2066 696c 6520 6173 2074 6865 2066  ed file as the f
-0000df60: 6972 7374 2061 6e64 206f 6e6c 7920 6172  irst and only ar
-0000df70: 6775 6d65 6e74 2028 736f 206f 6e20 6c69  gument (so on li
-0000df80: 6e75 7820 6974 276c 6c20 7368 6f77 2061  nux it'll show a
-0000df90: 206e 6f74 6966 6963 6174 696f 6e20 6f6e   notification on
-0000dfa0: 2d73 6372 6565 6e29 0a0a 6e6f 7465 2074  -screen)..note t
-0000dfb0: 6861 7420 7468 6973 2069 7320 7761 7920  hat this is way 
-0000dfc0: 6d6f 7265 2063 6f6d 706c 6963 6174 6564  more complicated
-0000dfd0: 2074 6861 6e20 7468 6520 6e65 7720 5b65   than the new [e
-0000dfe0: 7665 6e74 2068 6f6f 6b73 5d28 2365 7665  vent hooks](#eve
-0000dff0: 6e74 2d68 6f6f 6b73 2920 6275 7420 7468  nt-hooks) but th
-0000e000: 6973 2061 7070 726f 6163 6820 6861 7320  is approach has 
-0000e010: 7468 6520 666f 6c6c 6f77 696e 6720 6164  the following ad
-0000e020: 7661 6e74 6167 6573 3a0a 2a20 6e6f 6e2d  vantages:.* non-
-0000e030: 626c 6f63 6b69 6e67 2061 6e64 206d 756c  blocking and mul
-0000e040: 7469 7468 7265 6164 6564 3b20 646f 6573  tithreaded; does
-0000e050: 6e27 7420 686f 6c64 206f 7468 6572 2075  n't hold other u
-0000e060: 706c 6f61 6473 2062 6163 6b0a 2a20 796f  ploads back.* yo
-0000e070: 7520 6765 7420 6163 6365 7373 2074 6f20  u get access to 
-0000e080: 7461 6773 2066 726f 6d20 4646 6d70 6567  tags from FFmpeg
-0000e090: 2061 6e64 206f 7468 6572 206d 7470 2070   and other mtp p
-0000e0a0: 6172 7365 7273 0a2a 206f 6e6c 7920 7472  arsers.* only tr
-0000e0b0: 6967 6765 7220 6f6e 206e 6577 2075 6e69  igger on new uni
-0000e0c0: 7175 6520 6669 6c65 732c 206e 6f74 2064  que files, not d
-0000e0d0: 7570 6573 0a0a 6e6f 7465 2074 6861 7420  upes..note that 
-0000e0e0: 6974 2077 696c 6c20 6f63 6375 7079 2074  it will occupy t
-0000e0f0: 6865 2070 6172 7369 6e67 2074 6872 6561  he parsing threa
-0000e100: 6473 2c20 736f 2066 6f72 6b20 616e 7974  ds, so fork anyt
-0000e110: 6869 6e67 2065 7870 656e 7369 7665 2028  hing expensive (
-0000e120: 6f72 2073 6574 2060 6b6e 6020 746f 2068  or set `kn` to h
-0000e130: 6176 6520 636f 7079 7061 7274 7920 666f  ave copyparty fo
-0000e140: 726b 2069 7420 666f 7220 796f 7529 202d  rk it for you) -
-0000e150: 2d20 6f74 6f68 2069 6620 796f 7520 7761  - otoh if you wa
-0000e160: 6e74 2074 6f20 696e 7465 6e74 696f 6e61  nt to intentiona
-0000e170: 6c6c 7920 7175 6575 652f 7369 6e67 6c65  lly queue/single
-0000e180: 7468 7265 6164 2079 6f75 2063 616e 2063  thread you can c
-0000e190: 6f6d 6269 6e65 2069 7420 7769 7468 2060  ombine it with `
-0000e1a0: 2d2d 6d74 6167 2d6d 7420 3160 0a0a 0a23  --mtag-mt 1`...#
-0000e1b0: 2320 6869 6469 6e67 2066 726f 6d20 676f  # hiding from go
-0000e1c0: 6f67 6c65 0a0a 7465 6c6c 2073 6561 7263  ogle..tell searc
-0000e1d0: 6820 656e 6769 6e65 7320 796f 7520 646f  h engines you do
-0000e1e0: 6e74 2077 616e 6e61 2062 6520 696e 6465  nt wanna be inde
-0000e1f0: 7865 642c 2020 6569 7468 6572 2075 7369  xed,  either usi
-0000e200: 6e67 2074 6865 2067 6f6f 6420 6f6c 6420  ng the good old 
-0000e210: 5b72 6f62 6f74 732e 7478 745d 2868 7474  [robots.txt](htt
-0000e220: 7073 3a2f 2f77 7777 2e72 6f62 6f74 7374  ps://www.robotst
-0000e230: 7874 2e6f 7267 2f72 6f62 6f74 7374 7874  xt.org/robotstxt
-0000e240: 2e68 746d 6c29 206f 7220 7468 726f 7567  .html) or throug
-0000e250: 6820 636f 7079 7061 7274 7920 7365 7474  h copyparty sett
-0000e260: 696e 6773 3a0a 0a2a 2060 2d2d 6e6f 2d72  ings:..* `--no-r
-0000e270: 6f62 6f74 7360 2061 6464 7320 4854 5450  obots` adds HTTP
-0000e280: 2028 6058 2d52 6f62 6f74 732d 5461 6760   (`X-Robots-Tag`
-0000e290: 2920 616e 6420 4854 4d4c 2028 603c 6d65  ) and HTML (`<me
-0000e2a0: 7461 3e60 2920 6865 6164 6572 7320 7769  ta>`) headers wi
-0000e2b0: 7468 2060 6e6f 696e 6465 782c 206e 6f66  th `noindex, nof
-0000e2c0: 6f6c 6c6f 7760 2067 6c6f 6261 6c6c 790a  ollow` globally.
-0000e2d0: 2a20 766f 6c66 6c61 6720 605b 2e2e 2e5d  * volflag `[...]
-0000e2e0: 3a63 2c6e 6f72 6f62 6f74 7360 2064 6f65  :c,norobots` doe
-0000e2f0: 7320 7468 6520 7361 6d65 2074 6869 6e67  s the same thing
-0000e300: 2066 6f72 2074 6861 7420 7369 6e67 6c65   for that single
-0000e310: 2076 6f6c 756d 650a 2a20 766f 6c66 6c61   volume.* volfla
-0000e320: 6720 605b 2e2e 2e5d 3a63 2c72 6f62 6f74  g `[...]:c,robot
-0000e330: 7360 2041 4c4c 4f57 5320 7365 6172 6368  s` ALLOWS search
-0000e340: 2d65 6e67 696e 6520 6372 6177 6c69 6e67  -engine crawling
-0000e350: 2066 6f72 2074 6861 7420 766f 6c75 6d65   for that volume
-0000e360: 2c20 6576 656e 2069 6620 602d 2d6e 6f2d  , even if `--no-
-0000e370: 726f 626f 7473 6020 6973 2073 6574 2067  robots` is set g
-0000e380: 6c6f 6261 6c6c 790a 0a61 6c73 6f2c 2060  lobally..also, `
-0000e390: 2d2d 666f 7263 652d 6a73 6020 6469 7361  --force-js` disa
-0000e3a0: 626c 6573 2074 6865 2070 6c61 696e 2048  bles the plain H
-0000e3b0: 544d 4c20 666f 6c64 6572 206c 6973 7469  TML folder listi
-0000e3c0: 6e67 2c20 6d61 6b69 6e67 2074 6869 6e67  ng, making thing
-0000e3d0: 7320 6861 7264 6572 2074 6f20 7061 7273  s harder to pars
-0000e3e0: 6520 666f 7220 7365 6172 6368 2065 6e67  e for search eng
-0000e3f0: 696e 6573 0a0a 0a23 2320 7468 656d 6573  ines...## themes
-0000e400: 0a0a 796f 7520 6361 6e20 6368 616e 6765  ..you can change
-0000e410: 2074 6865 2064 6566 6175 6c74 2074 6865   the default the
-0000e420: 6d65 2077 6974 6820 602d 2d74 6865 6d65  me with `--theme
-0000e430: 2032 602c 2061 6e64 2061 6464 2079 6f75   2`, and add you
-0000e440: 7220 6f77 6e20 7468 656d 6573 2062 7920  r own themes by 
-0000e450: 6d6f 6469 6679 696e 6720 6062 726f 7773  modifying `brows
-0000e460: 6572 2e63 7373 6020 6f72 2070 726f 7669  er.css` or provi
-0000e470: 6469 6e67 2079 6f75 7220 6f77 6e20 6373  ding your own cs
-0000e480: 7320 746f 2060 2d2d 6373 732d 6272 6f77  s to `--css-brow
-0000e490: 7365 7260 2c20 7468 656e 2074 656c 6c69  ser`, then telli
-0000e4a0: 6e67 2063 6f70 7970 6172 7479 2074 6865  ng copyparty the
-0000e4b0: 7920 6578 6973 7420 6279 2069 6e63 7265  y exist by incre
-0000e4c0: 6173 696e 6720 602d 2d74 6865 6d65 7360  asing `--themes`
-0000e4d0: 0a0a 3c74 6162 6c65 3e3c 7472 3e3c 7464  ..<table><tr><td
-0000e4e0: 2077 6964 7468 3d22 3333 2522 2061 6c69   width="33%" ali
-0000e4f0: 676e 3d22 6365 6e74 6572 223e 3c61 2068  gn="center"><a h
-0000e500: 7265 663d 2268 7474 7073 3a2f 2f75 7365  ref="https://use
-0000e510: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-0000e520: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-0000e530: 3431 3033 322f 3136 3538 3634 3930 372d  41032/165864907-
-0000e540: 3137 6532 6163 3764 2d33 3139 642d 3466  17e2ac7d-319d-4f
-0000e550: 3235 2d38 3731 382d 3266 3337 3666 3631  25-8718-2f376f61
-0000e560: 3462 3531 2e70 6e67 223e 3c69 6d67 2073  4b51.png"><img s
-0000e570: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
-0000e580: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-0000e590: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-0000e5a0: 3130 3332 2f31 3635 3836 3735 3531 2d66  1032/165867551-f
-0000e5b0: 6365 6233 3564 642d 3338 6630 2d34 3262  ceb35dd-38f0-42b
-0000e5c0: 622d 6265 6633 2d32 3562 6136 3531 6361  b-bef3-25ba651ca
-0000e5d0: 3639 622e 706e 6722 3e3c 2f61 3e0a 302e  69b.png"></a>.0.
-0000e5e0: 2063 6c61 7373 6963 2064 6172 6b3c 2f74   classic dark</t
-0000e5f0: 643e 3c74 6420 7769 6474 683d 2233 3325  d><td width="33%
-0000e600: 2220 616c 6967 6e3d 2263 656e 7465 7222  " align="center"
-0000e610: 3e3c 6120 6872 6566 3d22 6874 7470 733a  ><a href="https:
-0000e620: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-0000e630: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-0000e640: 636f 6d2f 3234 3130 3332 2f31 3638 3634  com/241032/16864
-0000e650: 3433 3939 2d36 3839 3338 6465 352d 6461  4399-68938de5-da
-0000e660: 3962 2d34 3435 662d 3864 3932 2d62 3531  9b-445f-8d92-b51
-0000e670: 6337 3462 3566 3334 352e 706e 6722 3e3c  c74b5f345.png"><
-0000e680: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
-0000e690: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-0000e6a0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-0000e6b0: 6f6d 2f32 3431 3033 322f 3136 3836 3434  om/241032/168644
-0000e6c0: 3430 342d 3865 3161 3266 6463 2d36 6535  404-8e1a2fdc-6e5
-0000e6d0: 392d 3463 3431 2d39 3035 652d 6261 3533  9-4c41-905e-ba53
-0000e6e0: 3939 6564 3638 3666 2e70 6e67 223e 3c2f  99ed686f.png"></
-0000e6f0: 613e 0a32 2e20 666c 6174 2070 6d2d 6d6f  a>.2. flat pm-mo
-0000e700: 6e6f 6b61 693c 2f74 643e 3c74 6420 7769  nokai</td><td wi
-0000e710: 6474 683d 2233 3325 2220 616c 6967 6e3d  dth="33%" align=
-0000e720: 2263 656e 7465 7222 3e3c 6120 6872 6566  "center"><a href
-0000e730: 3d22 6874 7470 733a 2f2f 7573 6572 2d69  ="https://user-i
-0000e740: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-0000e750: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-0000e760: 3332 2f31 3635 3836 3439 3031 2d64 6231  32/165864901-db1
-0000e770: 3361 3432 392d 6135 6461 2d34 3936 642d  3a429-a5da-496d-
-0000e780: 3862 6336 2d63 6538 3338 3534 3766 3639  8bc6-ce838547f69
-0000e790: 642e 706e 6722 3e3c 696d 6720 7372 633d  d.png"><img src=
-0000e7a0: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
-0000e7b0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-0000e7c0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-0000e7d0: 322f 3136 3538 3637 3536 302d 6161 3833  2/165867560-aa83
-0000e7e0: 3461 6566 2d35 3864 632d 3461 6265 2d62  4aef-58dc-4abe-b
-0000e7f0: 6165 662d 3765 3536 3262 3634 3739 3435  aef-7e562b647945
-0000e800: 2e70 6e67 223e 3c2f 613e 0a34 2e20 7669  .png"></a>.4. vi
-0000e810: 6365 3c2f 7464 3e3c 2f74 723e 3c74 723e  ce</td></tr><tr>
-0000e820: 3c74 6420 616c 6967 6e3d 2263 656e 7465  <td align="cente
-0000e830: 7222 3e3c 6120 6872 6566 3d22 6874 7470  r"><a href="http
-0000e840: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
-0000e850: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
-0000e860: 742e 636f 6d2f 3234 3130 3332 2f31 3635  t.com/241032/165
-0000e870: 3836 3439 3035 2d36 3932 3638 3265 622d  864905-692682eb-
-0000e880: 3666 6234 2d34 6434 302d 6236 6665 2d32  6fb4-4d40-b6fe-2
-0000e890: 3764 3263 3764 3365 3261 372e 706e 6722  7d2c7d3e2a7.png"
-0000e8a0: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
-0000e8b0: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-0000e8c0: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-0000e8d0: 2e63 6f6d 2f32 3431 3033 322f 3136 3538  .com/241032/1658
-0000e8e0: 3637 3535 352d 3038 3062 3733 6236 2d36  67555-080b73b6-6
-0000e8f0: 6438 352d 3431 6262 2d61 3763 362d 6164  d85-41bb-a7c6-ad
-0000e900: 3237 3763 3630 3833 3635 2e70 6e67 223e  277c608365.png">
-0000e910: 3c2f 613e 0a31 2e20 636c 6173 7369 6320  </a>.1. classic 
-0000e920: 6c69 6768 743c 2f74 643e 3c74 6420 616c  light</td><td al
-0000e930: 6967 6e3d 2263 656e 7465 7222 3e3c 6120  ign="center"><a 
-0000e940: 6872 6566 3d22 6874 7470 733a 2f2f 7573  href="https://us
-0000e950: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-0000e960: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-0000e970: 3234 3130 3332 2f31 3638 3634 3532 3736  241032/168645276
-0000e980: 2d66 6230 3266 6431 392d 3139 3061 2d34  -fb02fd19-190a-4
-0000e990: 3037 612d 6238 6433 2d64 3538 6665 6532  07a-b8d3-d58fee2
-0000e9a0: 3737 6530 322e 706e 6722 3e3c 696d 6720  77e02.png"><img 
-0000e9b0: 7372 633d 2268 7474 7073 3a2f 2f75 7365  src="https://use
-0000e9c0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-0000e9d0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-0000e9e0: 3431 3033 322f 3136 3836 3435 3238 302d  41032/168645280-
-0000e9f0: 6630 3636 3262 3363 2d39 3736 342d 3438  f0662b3c-9764-48
-0000ea00: 3735 2d61 3265 322d 6439 3163 6338 3139  75-a2e2-d91cc819
-0000ea10: 3962 3233 2e70 6e67 223e 3c2f 613e 0a33  9b23.png"></a>.3
-0000ea20: 2e20 666c 6174 206c 6967 6874 0a3c 2f74  . flat light.</t
-0000ea30: 643e 3c74 6420 616c 6967 6e3d 2263 656e  d><td align="cen
-0000ea40: 7465 7222 3e3c 6120 6872 6566 3d22 6874  ter"><a href="ht
-0000ea50: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-0000ea60: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-0000ea70: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
-0000ea80: 3635 3836 3438 3938 2d31 3063 6537 3035  65864898-10ce705
-0000ea90: 322d 6131 3137 2d34 6663 662d 3834 3562  2-a117-4fcf-845b
-0000eaa0: 2d62 3536 6339 3136 3837 3930 382e 706e  -b56c91687908.pn
-0000eab0: 6722 3e3c 696d 6720 7372 633d 2268 7474  g"><img src="htt
-0000eac0: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-0000ead0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-0000eae0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
-0000eaf0: 3538 3637 3536 322d 6633 3030 3364 3435  5867562-f3003d45
-0000eb00: 2d64 6432 612d 3435 3634 2d38 6161 652d  -dd2a-4564-8aae-
-0000eb10: 6665 6434 3463 3161 6530 3634 2e70 6e67  fed44c1ae064.png
-0000eb20: 223e 3c2f 613e 0a35 2e20 3c61 2068 7265  "></a>.5. <a hre
-0000eb30: 663d 2268 7474 7073 3a2f 2f62 6c6f 672e  f="https://blog.
-0000eb40: 636f 6469 6e67 686f 7272 6f72 2e63 6f6d  codinghorror.com
-0000eb50: 2f61 2d74 7269 6275 7465 2d74 6f2d 7468  /a-tribute-to-th
-0000eb60: 652d 7769 6e64 6f77 732d 3331 2d68 6f74  e-windows-31-hot
-0000eb70: 2d64 6f67 2d73 7461 6e64 2d63 6f6c 6f72  -dog-stand-color
-0000eb80: 2d73 6368 656d 652f 223e 686f 7464 6f67  -scheme/">hotdog
-0000eb90: 2073 7461 6e64 3c2f 613e 3c2f 7464 3e3c   stand</a></td><
-0000eba0: 2f74 723e 3c2f 7461 626c 653e 0a0a 7468  /tr></table>..th
-0000ebb0: 6520 636c 6173 736e 616d 6520 6f66 2074  e classname of t
-0000ebc0: 6865 2048 544d 4c20 7461 6720 6973 2073  he HTML tag is s
-0000ebd0: 6574 2061 6363 6f72 6469 6e67 2074 6f20  et according to 
-0000ebe0: 7468 6520 7365 6c65 6374 6564 2074 6865  the selected the
-0000ebf0: 6d65 2c20 7768 6963 6820 6973 2075 7365  me, which is use
-0000ec00: 6420 746f 2073 6574 2063 6f6c 6f72 7320  d to set colors 
-0000ec10: 6173 2063 7373 2076 6172 6961 626c 6573  as css variables
-0000ec20: 202b 2b0a 0a2a 2065 6163 6820 7468 656d   ++..* each them
-0000ec30: 6520 2a67 656e 6572 616c 6c79 2a20 6861  e *generally* ha
-0000ec40: 7320 6120 6461 726b 2074 6865 6d65 2028  s a dark theme (
-0000ec50: 6576 656e 206e 756d 6265 7273 2920 616e  even numbers) an
-0000ec60: 6420 6120 6c69 6768 7420 7468 656d 6520  d a light theme 
-0000ec70: 286f 6464 206e 756d 6265 7273 292c 2073  (odd numbers), s
-0000ec80: 686f 7769 6e67 2069 6e20 7061 6972 730a  howing in pairs.
-0000ec90: 2a20 7468 6520 6669 7273 7420 7468 656d  * the first them
-0000eca0: 6520 2874 6865 6d65 2030 2061 6e64 2031  e (theme 0 and 1
-0000ecb0: 2920 6973 2060 6874 6d6c 2e61 602c 2073  ) is `html.a`, s
-0000ecc0: 6563 6f6e 6420 7468 656d 6520 2832 2061  econd theme (2 a
-0000ecd0: 6e64 2033 2920 6973 2060 6874 6d6c 2e62  nd 3) is `html.b
-0000ece0: 600a 2a20 6966 2061 206c 6967 6874 2074  `.* if a light t
-0000ecf0: 6865 6d65 2069 7320 7365 6c65 6374 6564  heme is selected
-0000ed00: 2c20 6068 746d 6c2e 7960 2069 7320 7365  , `html.y` is se
-0000ed10: 742c 206f 7468 6572 7769 7365 2060 6874  t, otherwise `ht
-0000ed20: 6d6c 2e7a 6020 6973 0a2a 2073 6f20 6966  ml.z` is.* so if
-0000ed30: 2074 6865 2064 6172 6b20 6564 6974 696f   the dark editio
-0000ed40: 6e20 6f66 2074 6865 2032 6e64 2074 6865  n of the 2nd the
-0000ed50: 6d65 2069 7320 7365 6c65 6374 6564 2c20  me is selected, 
-0000ed60: 796f 7520 7573 6520 616e 7920 6f66 2060  you use any of `
-0000ed70: 6874 6d6c 2e62 602c 2060 6874 6d6c 2e7a  html.b`, `html.z
-0000ed80: 602c 2060 6874 6d6c 2e62 7a60 2074 6f20  `, `html.bz` to 
-0000ed90: 7370 6563 6966 7920 7275 6c65 730a 0a73  specify rules..s
-0000eda0: 6565 2074 6865 2074 6f70 206f 6620 5b2e  ee the top of [.
-0000edb0: 2f63 6f70 7970 6172 7479 2f77 6562 2f62  /copyparty/web/b
-0000edc0: 726f 7773 6572 2e63 7373 5d28 2e2f 636f  rowser.css](./co
-0000edd0: 7079 7061 7274 792f 7765 622f 6272 6f77  pyparty/web/brow
-0000ede0: 7365 722e 6373 7329 2077 6865 7265 2074  ser.css) where t
-0000edf0: 6865 2063 6f6c 6f72 2076 6172 6961 626c  he color variabl
-0000ee00: 6573 2061 7265 2073 6574 2c20 616e 6420  es are set, and 
-0000ee10: 7468 6572 6527 7320 6c61 796f 7574 2d73  there's layout-s
-0000ee20: 7065 6369 6669 6320 7374 7566 6620 6e65  pecific stuff ne
-0000ee30: 6172 2074 6865 2062 6f74 746f 6d0a 0a0a  ar the bottom...
-0000ee40: 2323 2063 6f6d 706c 6574 6520 6578 616d  ## complete exam
-0000ee50: 706c 6573 0a0a 2a20 7265 6164 2d6f 6e6c  ples..* read-onl
-0000ee60: 7920 6d75 7369 6320 7365 7276 6572 2020  y music server  
-0000ee70: 0a20 2060 7079 7468 6f6e 2063 6f70 7970  .  `python copyp
-0000ee80: 6172 7479 2d73 6678 2e70 7920 2d76 202f  arty-sfx.py -v /
-0000ee90: 6d6e 742f 6e61 732f 6d75 7369 633a 2f6d  mnt/nas/music:/m
-0000eea0: 7573 6963 3a72 202d 6532 6473 6120 2d65  usic:r -e2dsa -e
-0000eeb0: 3274 7320 2d2d 6e6f 2d72 6f62 6f74 7320  2ts --no-robots 
-0000eec0: 2d2d 666f 7263 652d 6a73 202d 2d74 6865  --force-js --the
-0000eed0: 6d65 2032 600a 2020 0a20 202a 202e 2e2e  me 2`.  .  * ...
-0000eee0: 7769 7468 2062 706d 2061 6e64 206b 6579  with bpm and key
-0000eef0: 2073 6361 6e6e 696e 6720 200a 2020 2020   scanning  .    
-0000ef00: 602d 6d74 7020 2e62 706d 3d66 2c61 7564  `-mtp .bpm=f,aud
-0000ef10: 696f 2d62 706d 2e70 7920 2d6d 7470 206b  io-bpm.py -mtp k
-0000ef20: 6579 3d66 2c61 7564 696f 2d6b 6579 2e70  ey=f,audio-key.p
-0000ef30: 7960 0a20 200a 2020 2a20 2e2e 2e77 6974  y`.  .  * ...wit
-0000ef40: 6820 6120 7265 6164 2d77 7269 7465 2066  h a read-write f
-0000ef50: 6f6c 6465 7220 666f 7220 606b 6576 696e  older for `kevin
-0000ef60: 6020 7768 6f73 6520 7061 7373 776f 7264  ` whose password
-0000ef70: 2069 7320 606f 6b67 6f60 2020 0a20 2020   is `okgo`  .   
-0000ef80: 2060 2d61 206b 6576 696e 3a6f 6b67 6f20   `-a kevin:okgo 
-0000ef90: 2d76 202f 6d6e 742f 6e61 732f 696e 633a  -v /mnt/nas/inc:
-0000efa0: 2f69 6e63 3a72 772c 6b65 7669 6e60 0a20  /inc:rw,kevin`. 
-0000efb0: 200a 2020 2a20 2e2e 2e77 6974 6820 6c6f   .  * ...with lo
-0000efc0: 6767 696e 6720 746f 2064 6973 6b20 200a  gging to disk  .
-0000efd0: 2020 2020 602d 6c6f 206c 6f67 2f63 7070      `-lo log/cpp
-0000efe0: 2d25 592d 256d 2564 2d25 4825 4d25 532e  -%Y-%m%d-%H%M%S.
-0000eff0: 7478 742e 787a 600a 0a0a 2323 2072 6576  txt.xz`...## rev
-0000f000: 6572 7365 2d70 726f 7879 0a0a 7275 6e6e  erse-proxy..runn
-0000f010: 696e 6720 636f 7079 7061 7274 7920 6e65  ing copyparty ne
-0000f020: 7874 2074 6f20 6f74 6865 7220 7765 6273  xt to other webs
-0000f030: 6974 6573 2020 686f 7374 6564 206f 6e20  ites  hosted on 
-0000f040: 616e 2065 7869 7374 696e 6720 7765 6273  an existing webs
-0000f050: 6572 7665 7220 7375 6368 2061 7320 6e67  erver such as ng
-0000f060: 696e 7820 6f72 2061 7061 6368 650a 0a79  inx or apache..y
-0000f070: 6f75 2063 616e 2065 6974 6865 723a 0a2a  ou can either:.*
-0000f080: 2067 6976 6520 636f 7079 7061 7274 7920   give copyparty 
-0000f090: 6974 7320 6f77 6e20 646f 6d61 696e 206f  its own domain o
-0000f0a0: 7220 7375 6264 6f6d 6169 6e20 2872 6563  r subdomain (rec
-0000f0b0: 6f6d 6d65 6e64 6564 290a 2a20 6f72 2064  ommended).* or d
-0000f0c0: 6f20 6c6f 6361 7469 6f6e 2d62 6173 6564  o location-based
-0000f0d0: 2070 726f 7879 696e 672c 2075 7369 6e67   proxying, using
-0000f0e0: 2060 2d2d 7270 2d6c 6f63 3d2f 7374 7566   `--rp-loc=/stuf
-0000f0f0: 6660 2074 6f20 7465 6c6c 2063 6f70 7970  f` to tell copyp
-0000f100: 6172 7479 2077 6865 7265 2069 7420 6973  arty where it is
-0000f110: 206d 6f75 6e74 6564 202d 2d20 6861 7320   mounted -- has 
-0000f120: 6120 736c 6967 6874 2070 6572 666f 726d  a slight perform
-0000f130: 616e 6365 2063 6f73 7420 616e 6420 6869  ance cost and hi
-0000f140: 6768 6572 2063 6861 6e63 6520 6f66 2062  gher chance of b
-0000f150: 7567 730a 2020 2a20 6966 2063 6f70 7970  ugs.  * if copyp
-0000f160: 6172 7479 2073 6179 7320 6069 6e63 6f72  arty says `incor
-0000f170: 7265 6374 202d 2d72 702d 6c6f 6320 6f72  rect --rp-loc or
-0000f180: 2077 6562 7365 7276 6572 2063 6f6e 6669   webserver confi
-0000f190: 673b 2065 7870 6563 7465 6420 7670 6174  g; expected vpat
-0000f1a0: 6820 7374 6172 7469 6e67 2077 6974 6820  h starting with 
-0000f1b0: 5b2e 2e2e 5d60 2069 7427 7320 6c69 6b65  [...]` it's like
-0000f1c0: 6c79 2062 6563 6175 7365 2074 6865 2077  ly because the w
-0000f1d0: 6562 7365 7276 6572 2069 7320 7374 7269  ebserver is stri
-0000f1e0: 7070 696e 6720 6177 6179 2074 6865 2070  pping away the p
-0000f1f0: 726f 7879 206c 6f63 6174 696f 6e20 6672  roxy location fr
-0000f200: 6f6d 2074 6865 2072 6571 7565 7374 2055  om the request U
-0000f210: 524c 7320 2d2d 2073 6565 2074 6865 2060  RLs -- see the `
-0000f220: 5072 6f78 7950 6173 7360 2069 6e20 7468  ProxyPass` in th
-0000f230: 6520 6170 6163 6865 2065 7861 6d70 6c65  e apache example
-0000f240: 2062 656c 6f77 0a0a 6578 616d 706c 6520   below..example 
-0000f250: 7765 6273 6572 7665 7220 636f 6e66 6967  webserver config
-0000f260: 733a 0a0a 2a20 5b6e 6769 6e78 2063 6f6e  s:..* [nginx con
-0000f270: 6669 675d 2863 6f6e 7472 6962 2f6e 6769  fig](contrib/ngi
-0000f280: 6e78 2f63 6f70 7970 6172 7479 2e63 6f6e  nx/copyparty.con
-0000f290: 6629 202d 2d20 656e 7469 7265 2064 6f6d  f) -- entire dom
-0000f2a0: 6169 6e2f 7375 6264 6f6d 6169 6e0a 2a20  ain/subdomain.* 
-0000f2b0: 5b61 7061 6368 6532 2063 6f6e 6669 675d  [apache2 config]
-0000f2c0: 2863 6f6e 7472 6962 2f61 7061 6368 652f  (contrib/apache/
-0000f2d0: 636f 7079 7061 7274 792e 636f 6e66 2920  copyparty.conf) 
-0000f2e0: 2d2d 206c 6f63 6174 696f 6e2d 6261 7365  -- location-base
-0000f2f0: 640a 0a0a 2320 6272 6f77 7365 7220 7375  d...# browser su
-0000f300: 7070 6f72 740a 0a54 4c44 523a 2079 6573  pport..TLDR: yes
-0000f310: 0a0a 215b 636f 7079 7061 7274 792d 6965  ..![copyparty-ie
-0000f320: 342d 6673 385d 2868 7474 7073 3a2f 2f75  4-fs8](https://u
-0000f330: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-0000f340: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-0000f350: 2f32 3431 3033 322f 3131 3831 3932 3739  /241032/11819279
-0000f360: 312d 6662 3331 6665 3030 2d62 3434 362d  1-fb31fe00-b446-
-0000f370: 3131 6562 2d39 3634 372d 3839 3865 6138  11eb-9647-898ea8
-0000f380: 6566 6331 6637 2e70 6e67 290a 0a60 6965  efc1f7.png)..`ie
-0000f390: 6020 3d20 696e 7465 726e 6574 2d65 7870  ` = internet-exp
-0000f3a0: 6c6f 7265 722c 2060 6666 6020 3d20 6669  lorer, `ff` = fi
-0000f3b0: 7265 666f 782c 2060 6360 203d 2063 6872  refox, `c` = chr
-0000f3c0: 6f6d 652c 2060 694f 5360 203d 2069 5068  ome, `iOS` = iPh
-0000f3d0: 6f6e 652f 6950 6164 2c20 6041 6e64 7260  one/iPad, `Andr`
-0000f3e0: 203d 2041 6e64 726f 6964 0a0a 7c20 6665   = Android..| fe
-0000f3f0: 6174 7572 6520 2020 2020 2020 2020 7c20  ature         | 
-0000f400: 6965 3620 7c20 6965 3920 207c 2069 6531  ie6 | ie9  | ie1
-0000f410: 3020 7c20 6965 3131 207c 2066 6620 3532  0 | ie11 | ff 52
-0000f420: 207c 2063 2034 3920 7c20 694f 5320 7c20   | c 49 | iOS | 
-0000f430: 416e 6472 207c 0a7c 202d 2d2d 2d2d 2d2d  Andr |.| -------
-0000f440: 2d2d 2d2d 2d2d 2d2d 207c 202d 2d2d 207c  -------- | --- |
-0000f450: 202d 2d2d 2d20 7c20 2d2d 2d2d 207c 202d   ---- | ---- | -
-0000f460: 2d2d 2d20 7c20 2d2d 2d2d 2d20 7c20 2d2d  --- | ----- | --
-0000f470: 2d2d 207c 202d 2d2d 207c 202d 2d2d 2d20  -- | --- | ---- 
-0000f480: 7c0a 7c20 6272 6f77 7365 2066 696c 6573  |.| browse files
-0000f490: 2020 2020 7c20 7965 7020 7c20 7965 7020      | yep | yep 
-0000f4a0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000f4b0: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
-0000f4c0: 7965 7020 7c20 7965 7020 207c 0a7c 2074  yep | yep  |.| t
-0000f4d0: 6875 6d62 6e61 696c 2076 6965 7720 207c  humbnail view  |
-0000f4e0: 2020 2d20 207c 2079 6570 2020 7c20 7965    -  | yep  | ye
-0000f4f0: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
-0000f500: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
-0000f510: 2079 6570 2020 7c0a 7c20 6261 7369 6320   yep  |.| basic 
-0000f520: 7570 6c6f 6164 6572 2020 7c20 7965 7020  uploader  | yep 
-0000f530: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000f540: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
-0000f550: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
-0000f560: 207c 0a7c 2075 7032 6b20 2020 2020 2020   |.| up2k       
-0000f570: 2020 2020 207c 2020 2d20 207c 2020 2d20       |  -  |  - 
-0000f580: 2020 7c20 602a 3160 207c 2060 2a31 6020    | `*1` | `*1` 
-0000f590: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
-0000f5a0: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
-0000f5b0: 6d61 6b65 2064 6972 6563 746f 7279 2020  make directory  
-0000f5c0: 7c20 7965 7020 7c20 7965 7020 207c 2079  | yep | yep  | y
-0000f5d0: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
-0000f5e0: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000f5f0: 7c20 7965 7020 207c 0a7c 2073 656e 6420  | yep  |.| send 
-0000f600: 6d65 7373 6167 6520 2020 207c 2079 6570  message    | yep
-0000f610: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000f620: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
-0000f630: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
-0000f640: 2020 7c0a 7c20 7365 7420 736f 7274 206f    |.| set sort o
-0000f650: 7264 6572 2020 7c20 202d 2020 7c20 7965  rder  |  -  | ye
-0000f660: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000f670: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
-0000f680: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
-0000f690: 207a 6970 2073 656c 6563 7469 6f6e 2020   zip selection  
-0000f6a0: 207c 2020 2d20 207c 2079 6570 2020 7c20   |  -  | yep  | 
-0000f6b0: 7965 7020 207c 2079 6570 2020 7c20 2079  yep  | yep  |  y
-0000f6c0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
-0000f6d0: 207c 2079 6570 2020 7c0a 7c20 6669 6c65   | yep  |.| file
-0000f6e0: 2072 656e 616d 6520 2020 2020 7c20 202d   rename     |  -
-0000f6f0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
-0000f700: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
-0000f710: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
-0000f720: 7020 207c 0a7c 2066 696c 6520 6375 742f  p  |.| file cut/
-0000f730: 7061 7374 6520 207c 2020 2d20 207c 2079  paste  |  -  | y
-0000f740: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
-0000f750: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
-0000f760: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
-0000f770: 7c20 6e61 7670 616e 6520 2020 2020 2020  | navpane       
-0000f780: 2020 7c20 202d 2020 7c20 7965 7020 207c    |  -  | yep  |
-0000f790: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
-0000f7a0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000f7b0: 7020 7c20 7965 7020 207c 0a7c 2069 6d61  p | yep  |.| ima
-0000f7c0: 6765 2076 6965 7765 7220 2020 207c 2020  ge viewer    |  
-0000f7d0: 2d20 207c 2079 6570 2020 7c20 7965 7020  -  | yep  | yep 
-0000f7e0: 207c 2079 6570 2020 7c20 2079 6570 2020   | yep  |  yep  
-0000f7f0: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
-0000f800: 6570 2020 7c0a 7c20 7669 6465 6f20 706c  ep  |.| video pl
-0000f810: 6179 6572 2020 2020 7c20 202d 2020 7c20  ayer    |  -  | 
-0000f820: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000f830: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
-0000f840: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
-0000f850: 0a7c 206d 6172 6b64 6f77 6e20 6564 6974  .| markdown edit
-0000f860: 6f72 207c 2020 2d20 207c 2020 2d20 2020  or |  -  |  -   
-0000f870: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000f880: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
-0000f890: 6570 207c 2079 6570 2020 7c0a 7c20 6d61  ep | yep  |.| ma
-0000f8a0: 726b 646f 776e 2076 6965 7765 7220 7c20  rkdown viewer | 
-0000f8b0: 202d 2020 7c20 7965 7020 207c 2079 6570   -  | yep  | yep
-0000f8c0: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
-0000f8d0: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
-0000f8e0: 7965 7020 207c 0a7c 2070 6c61 7920 6d70  yep  |.| play mp
-0000f8f0: 332f 6d34 6120 2020 207c 2020 2d20 207c  3/m4a    |  -  |
-0000f900: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
-0000f910: 6570 2020 7c20 2079 6570 2020 7c20 7965  ep  |  yep  | ye
-0000f920: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
-0000f930: 7c0a 7c20 706c 6179 206f 6767 2f6f 7075  |.| play ogg/opu
-0000f940: 7320 2020 7c20 202d 2020 7c20 202d 2020  s   |  -  |  -  
-0000f950: 207c 2020 2d20 2020 7c20 202d 2020 207c   |  -   |  -   |
-0000f960: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
-0000f970: 602a 3360 207c 2079 6570 207c 0a7c 202a  `*3` | yep |.| *
-0000f980: 2a3d 2066 6561 7475 7265 203d 2a2a 207c  *= feature =** |
-0000f990: 2069 6536 207c 2069 6539 2020 7c20 6965   ie6 | ie9  | ie
-0000f9a0: 3130 207c 2069 6531 3120 7c20 6666 2035  10 | ie11 | ff 5
-0000f9b0: 3220 7c20 6320 3439 207c 2069 4f53 207c  2 | c 49 | iOS |
-0000f9c0: 2041 6e64 7220 7c0a 0a2a 2069 6e74 6572   Andr |..* inter
-0000f9d0: 6e65 7420 6578 706c 6f72 6572 2036 2074  net explorer 6 t
-0000f9e0: 6f20 3820 6265 6861 7665 2074 6865 2073  o 8 behave the s
-0000f9f0: 616d 650a 2a20 6669 7265 666f 7820 3532  ame.* firefox 52
-0000fa00: 2061 6e64 2063 6872 6f6d 6520 3439 2061   and chrome 49 a
-0000fa10: 7265 2074 6865 2066 696e 616c 2077 696e  re the final win
-0000fa20: 7870 2076 6572 7369 6f6e 730a 2a20 602a  xp versions.* `*
-0000fa30: 3160 2079 6573 2c20 6275 7420 6578 7472  1` yes, but extr
-0000fa40: 656d 656c 7920 736c 6f77 2028 6965 3130  emely slow (ie10
-0000fa50: 3a20 6031 204d 6942 2f73 602c 2069 6531  : `1 MiB/s`, ie1
-0000fa60: 313a 2060 3237 3020 4b69 422f 7360 290a  1: `270 KiB/s`).
-0000fa70: 2a20 602a 3360 2069 4f53 2031 3120 616e  * `*3` iOS 11 an
-0000fa80: 6420 6e65 7765 722c 206f 7075 7320 6f6e  d newer, opus on
-0000fa90: 6c79 2c20 616e 6420 7265 7175 6972 6573  ly, and requires
-0000faa0: 2046 466d 7065 6720 6f6e 2074 6865 2073   FFmpeg on the s
-0000fab0: 6572 7665 720a 0a71 7569 636b 2073 756d  erver..quick sum
-0000fac0: 6d61 7279 206f 6620 6d6f 7265 2065 6363  mary of more ecc
-0000fad0: 656e 7472 6963 2077 6562 2d62 726f 7773  entric web-brows
-0000fae0: 6572 7320 7472 7969 6e67 2074 6f20 7669  ers trying to vi
-0000faf0: 6577 2061 2064 6972 6563 746f 7279 2069  ew a directory i
-0000fb00: 6e64 6578 3a0a 0a7c 2062 726f 7773 6572  ndex:..| browser
-0000fb10: 207c 2077 696c 6c20 6974 2062 6c65 6e64   | will it blend
-0000fb20: 207c 0a7c 202d 2d2d 2d2d 2d2d 207c 202d   |.| ------- | -
-0000fb30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 207c 0a7c  ------------ |.|
-0000fb40: 202a 2a6c 696e 6b73 2a2a 2028 322e 3231   **links** (2.21
-0000fb50: 2f6d 6163 706f 7274 7329 207c 2063 616e  /macports) | can
-0000fb60: 2062 726f 7773 652c 206c 6f67 696e 2c20   browse, login, 
-0000fb70: 7570 6c6f 6164 2f6d 6b64 6972 2f6d 7367  upload/mkdir/msg
-0000fb80: 207c 0a7c 202a 2a6c 796e 782a 2a20 2832   |.| **lynx** (2
-0000fb90: 2e38 2e39 2f6d 6163 706f 7274 7329 207c  .8.9/macports) |
-0000fba0: 2063 616e 2062 726f 7773 652c 206c 6f67   can browse, log
-0000fbb0: 696e 2c20 7570 6c6f 6164 2f6d 6b64 6972  in, upload/mkdir
-0000fbc0: 2f6d 7367 207c 0a7c 202a 2a77 336d 2a2a  /msg |.| **w3m**
-0000fbd0: 2028 302e 352e 332f 6d61 6370 6f72 7473   (0.5.3/macports
-0000fbe0: 2920 207c 2063 616e 2062 726f 7773 652c  )  | can browse,
-0000fbf0: 206c 6f67 696e 2c20 7570 6c6f 6164 2061   login, upload a
-0000fc00: 7420 3130 306b 422f 732c 206d 6b64 6972  t 100kB/s, mkdir
-0000fc10: 2f6d 7367 207c 0a7c 202a 2a6e 6574 7375  /msg |.| **netsu
-0000fc20: 7266 2a2a 2028 332e 3130 2f61 7263 6829  rf** (3.10/arch)
-0000fc30: 2020 207c 2069 7320 6261 7369 6361 6c6c     | is basicall
-0000fc40: 7920 6965 3620 7769 7468 206d 7563 6820  y ie6 with much 
-0000fc50: 6265 7474 6572 2063 7373 2028 6a61 7661  better css (java
-0000fc60: 7363 7269 7074 2068 6173 2061 6c6d 6f73  script has almos
-0000fc70: 7420 6e6f 2065 6666 6563 7429 207c 200a  t no effect) | .
-0000fc80: 7c20 2a2a 6f70 6572 612a 2a20 2831 312e  | **opera** (11.
-0000fc90: 3630 2f77 696e 7870 2920 2020 7c20 4f4b  60/winxp)   | OK
-0000fca0: 3a20 7468 756d 626e 6169 6c73 2c20 696d  : thumbnails, im
-0000fcb0: 6167 652d 7669 6577 6572 2c20 7a69 702d  age-viewer, zip-
-0000fcc0: 7365 6c65 6374 696f 6e2c 2072 656e 616d  selection, renam
-0000fcd0: 652f 6375 742f 7061 7374 652e 204e 473a  e/cut/paste. NG:
-0000fce0: 2075 7032 6b2c 206e 6176 7061 6e65 2c20   up2k, navpane, 
-0000fcf0: 6d61 726b 646f 776e 2c20 6175 6469 6f20  markdown, audio 
-0000fd00: 7c0a 7c20 2a2a 6965 342a 2a20 616e 6420  |.| **ie4** and 
-0000fd10: 2a2a 6e65 7473 6361 7065 2a2a 2034 2e30  **netscape** 4.0
-0000fd20: 2020 7c20 6361 6e20 6272 6f77 7365 2c20    | can browse, 
-0000fd30: 7570 6c6f 6164 2077 6974 6820 603f 623d  upload with `?b=
-0000fd40: 7560 2c20 6175 7468 2077 6974 6820 6026  u`, auth with `&
-0000fd50: 7077 3d77 6172 6b60 207c 0a7c 202a 2a6e  pw=wark` |.| **n
-0000fd60: 6373 6120 6d6f 7361 6963 2a2a 2032 2e37  csa mosaic** 2.7
-0000fd70: 2020 2020 2020 207c 2064 6f65 7320 6e6f         | does no
-0000fd80: 7420 6765 7420 6120 7061 7373 2c20 5b70  t get a pass, [p
-0000fd90: 6963 315d 2868 7474 7073 3a2f 2f75 7365  ic1](https://use
-0000fda0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-0000fdb0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-0000fdc0: 3431 3033 322f 3137 3431 3839 3232 372d  41032/174189227-
-0000fdd0: 6165 3831 3630 3236 2d63 6636 662d 3462  ae816026-cf6f-4b
-0000fde0: 6535 2d61 3236 652d 3162 3362 3037 3263  e5-a26e-1b3b072c
-0000fdf0: 3162 3266 2e70 6e67 2920 2d20 5b70 6963  1b2f.png) - [pic
-0000fe00: 325d 2868 7474 7073 3a2f 2f75 7365 722d  2](https://user-
-0000fe10: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-0000fe20: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-0000fe30: 3033 322f 3137 3431 3839 3232 352d 3536  032/174189225-56
-0000fe40: 3531 6330 3539 2d35 3135 322d 3436 6539  51c059-5152-46e9
-0000fe50: 2d61 6332 362d 3765 3938 6534 3937 3930  -ac26-7e98e49790
-0000fe60: 3162 2e70 6e67 2920 7c0a 7c20 2a2a 5365  1b.png) |.| **Se
-0000fe70: 7265 6e69 7479 4f53 2a2a 2028 3765 3938  renityOS** (7e98
-0000fe80: 3435 3729 2020 7c20 6869 7473 2061 2070  457)  | hits a p
-0000fe90: 6167 6520 6661 756c 742c 2077 6f72 6b73  age fault, works
-0000fea0: 2077 6974 6820 603f 623d 7560 2c20 6669   with `?b=u`, fi
-0000feb0: 6c65 2075 706c 6f61 6420 6e6f 742d 696d  le upload not-im
-0000fec0: 706c 207c 0a0a 0a23 2063 6c69 656e 7420  pl |...# client 
-0000fed0: 6578 616d 706c 6573 0a0a 696e 7465 7261  examples..intera
-0000fee0: 6374 2077 6974 6820 636f 7079 7061 7274  ct with copypart
-0000fef0: 7920 7573 696e 6720 6e6f 6e2d 6272 6f77  y using non-brow
-0000ff00: 7365 7220 636c 6965 6e74 730a 0a2a 206a  ser clients..* j
-0000ff10: 6176 6173 6372 6970 743a 2064 756d 7020  avascript: dump 
-0000ff20: 736f 6d65 2073 7461 7465 2069 6e74 6f20  some state into 
-0000ff30: 6120 6669 6c65 2028 7477 6f20 7365 7061  a file (two sepa
-0000ff40: 7261 7465 2065 7861 6d70 6c65 7329 0a20  rate examples). 
-0000ff50: 202a 2060 6177 6169 7420 6665 7463 6828   * `await fetch(
-0000ff60: 272f 2f31 3237 2e30 2e30 2e31 3a33 3932  '//127.0.0.1:392
-0000ff70: 332f 272c 207b 6d65 7468 6f64 3a22 5055  3/', {method:"PU
-0000ff80: 5422 2c20 626f 6479 3a20 4a53 4f4e 2e73  T", body: JSON.s
-0000ff90: 7472 696e 6769 6679 2866 6f6f 297d 293b  tringify(foo)});
-0000ffa0: 600a 2020 2a20 6076 6172 2078 6872 203d  `.  * `var xhr =
-0000ffb0: 206e 6577 2058 4d4c 4874 7470 5265 7175   new XMLHttpRequ
-0000ffc0: 6573 7428 293b 2078 6872 2e6f 7065 6e28  est(); xhr.open(
-0000ffd0: 2750 4f53 5427 2c20 272f 2f31 3237 2e30  'POST', '//127.0
-0000ffe0: 2e30 2e31 3a33 3932 332f 6d73 6773 3f72  .0.1:3923/msgs?r
-0000fff0: 6177 2729 3b20 7868 722e 7365 6e64 2827  aw'); xhr.send('
-00010000: 666f 6f27 293b 600a 0a2a 2063 7572 6c2f  foo');`..* curl/
-00010010: 7767 6574 3a20 7570 6c6f 6164 2073 6f6d  wget: upload som
-00010020: 6520 6669 6c65 7320 2870 6f73 743d 6669  e files (post=fi
-00010030: 6c65 2c20 6368 756e 6b3d 7374 6469 6e29  le, chunk=stdin)
-00010040: 0a20 202a 2060 706f 7374 2829 7b20 6375  .  * `post(){ cu
-00010050: 726c 202d 4620 6163 743d 6270 7574 202d  rl -F act=bput -
-00010060: 4620 663d 4022 2431 2220 6874 7470 3a2f  F f=@"$1" http:/
-00010070: 2f31 3237 2e30 2e30 2e31 3a33 3932 332f  /127.0.0.1:3923/
-00010080: 3f70 773d 7761 726b 3b7d 6020 200a 2020  ?pw=wark;}`  .  
-00010090: 2020 6070 6f73 7420 6d6f 7669 652e 6d6b    `post movie.mk
-000100a0: 7660 0a20 202a 2060 706f 7374 2829 7b20  v`.  * `post(){ 
-000100b0: 6375 726c 202d 4820 7077 3a77 6172 6b20  curl -H pw:wark 
-000100c0: 2d48 2072 616e 643a 3820 2d54 2022 2431  -H rand:8 -T "$1
-000100d0: 2220 6874 7470 3a2f 2f31 3237 2e30 2e30  " http://127.0.0
-000100e0: 2e31 3a33 3932 332f 3b7d 6020 200a 2020  .1:3923/;}`  .  
-000100f0: 2020 6070 6f73 7420 6d6f 7669 652e 6d6b    `post movie.mk
-00010100: 7660 0a20 202a 2060 706f 7374 2829 7b20  v`.  * `post(){ 
-00010110: 7767 6574 202d 2d68 6561 6465 723d 2770  wget --header='p
-00010120: 773a 2077 6172 6b27 202d 2d70 6f73 742d  w: wark' --post-
-00010130: 6669 6c65 3d22 2431 2220 2d4f 2d20 6874  file="$1" -O- ht
-00010140: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a33  tp://127.0.0.1:3
-00010150: 3932 332f 3f72 6177 3b7d 6020 200a 2020  923/?raw;}`  .  
-00010160: 2020 6070 6f73 7420 6d6f 7669 652e 6d6b    `post movie.mk
-00010170: 7660 0a20 202a 2060 6368 756e 6b28 297b  v`.  * `chunk(){
-00010180: 2063 7572 6c20 2d48 2070 773a 7761 726b   curl -H pw:wark
-00010190: 202d 542d 2068 7474 703a 2f2f 3132 372e   -T- http://127.
-000101a0: 302e 302e 313a 3339 3233 2f3b 7d60 2020  0.0.1:3923/;}`  
-000101b0: 0a20 2020 2060 6368 756e 6b20 3c6d 6f76  .    `chunk <mov
-000101c0: 6965 2e6d 6b76 600a 0a2a 2062 6173 683a  ie.mkv`..* bash:
-000101d0: 2077 6865 6e20 6375 726c 2061 6e64 2077   when curl and w
-000101e0: 6765 7420 6973 206e 6f74 2061 7661 696c  get is not avail
-000101f0: 6162 6c65 206f 7220 746f 6f20 626f 7269  able or too bori
-00010200: 6e67 0a20 202a 2060 2870 7269 6e74 6620  ng.  * `(printf 
-00010210: 2750 5554 202f 6a75 6e6b 3f70 773d 7761  'PUT /junk?pw=wa
-00010220: 726b 2048 5454 502f 312e 315c 725c 6e5c  rk HTTP/1.1\r\n\
-00010230: 725c 6e27 3b20 6361 7420 6d6f 7669 652e  r\n'; cat movie.
-00010240: 6d6b 7629 207c 206e 6320 3132 372e 302e  mkv) | nc 127.0.
-00010250: 302e 3120 3339 3233 600a 2020 2a20 6028  0.1 3923`.  * `(
-00010260: 7072 696e 7466 2027 5055 5420 2f20 4854  printf 'PUT / HT
-00010270: 5450 2f31 2e31 5c72 5c6e 5c72 5c6e 273b  TP/1.1\r\n\r\n';
-00010280: 2063 6174 206d 6f76 6965 2e6d 6b76 2920   cat movie.mkv) 
-00010290: 3e2f 6465 762f 7463 702f 3132 372e 302e  >/dev/tcp/127.0.
-000102a0: 302e 312f 3339 3233 600a 0a2a 2070 7974  0.1/3923`..* pyt
-000102b0: 686f 6e3a 205b 7570 326b 2e70 795d 2868  hon: [up2k.py](h
-000102c0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000102d0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-000102e0: 2f62 6c6f 622f 686f 7675 6473 7472 6175  /blob/hovudstrau
-000102f0: 6d2f 6269 6e2f 7570 326b 2e70 7929 2069  m/bin/up2k.py) i
-00010300: 7320 6120 636f 6d6d 616e 642d 6c69 6e65  s a command-line
-00010310: 2075 7032 6b20 636c 6965 6e74 205b 2877   up2k client [(w
-00010320: 6562 6d29 5d28 6874 7470 733a 2f2f 6f63  ebm)](https://oc
-00010330: 762e 6d65 2f73 7475 6666 2f75 3263 6c69  v.me/stuff/u2cli
-00010340: 2e77 6562 6d29 0a20 202a 2066 696c 6520  .webm).  * file 
-00010350: 7570 6c6f 6164 732c 2066 696c 652d 7365  uploads, file-se
-00010360: 6172 6368 2c20 666f 6c64 6572 2073 796e  arch, folder syn
-00010370: 632c 2061 7574 6f72 6573 756d 6520 6f66  c, autoresume of
-00010380: 2061 626f 7274 6564 2f62 726f 6b65 6e20   aborted/broken 
-00010390: 7570 6c6f 6164 730a 2020 2a20 6361 6e20  uploads.  * can 
-000103a0: 6265 2064 6f77 6e6c 6f61 6465 6420 6672  be downloaded fr
-000103b0: 6f6d 2063 6f70 7970 6172 7479 3a20 636f  om copyparty: co
-000103c0: 6e74 726f 6c70 616e 656c 202d 3e20 636f  ntrolpanel -> co
-000103d0: 6e6e 6563 7420 2d3e 205b 7570 326b 2e70  nnect -> [up2k.p
-000103e0: 795d 2868 7474 703a 2f2f 3132 372e 302e  y](http://127.0.
-000103f0: 302e 313a 3339 3233 2f2e 6370 722f 612f  0.1:3923/.cpr/a/
-00010400: 7570 326b 2e70 7929 0a20 202a 2073 6565  up2k.py).  * see
-00010410: 205b 2e2f 6269 6e2f 5245 4144 4d45 2e6d   [./bin/README.m
-00010420: 6423 7570 326b 7079 5d28 6269 6e2f 5245  d#up2kpy](bin/RE
-00010430: 4144 4d45 2e6d 6423 7570 326b 7079 290a  ADME.md#up2kpy).
-00010440: 0a2a 2046 5553 453a 206d 6f75 6e74 2061  .* FUSE: mount a
-00010450: 2063 6f70 7970 6172 7479 2073 6572 7665   copyparty serve
-00010460: 7220 6173 2061 206c 6f63 616c 2066 696c  r as a local fil
-00010470: 6573 7973 7465 6d0a 2020 2a20 6372 6f73  esystem.  * cros
-00010480: 732d 706c 6174 666f 726d 2070 7974 686f  s-platform pytho
-00010490: 6e20 636c 6965 6e74 2061 7661 696c 6162  n client availab
-000104a0: 6c65 2069 6e20 5b2e 2f62 696e 2f5d 2862  le in [./bin/](b
-000104b0: 696e 2f29 0a20 202a 2063 616e 2062 6520  in/).  * can be 
-000104c0: 646f 776e 6c6f 6164 6564 2066 726f 6d20  downloaded from 
-000104d0: 636f 7079 7061 7274 793a 2063 6f6e 7472  copyparty: contr
-000104e0: 6f6c 7061 6e65 6c20 2d3e 2063 6f6e 6e65  olpanel -> conne
-000104f0: 6374 202d 3e20 5b70 6172 7479 6675 7365  ct -> [partyfuse
-00010500: 2e70 795d 2868 7474 703a 2f2f 3132 372e  .py](http://127.
-00010510: 302e 302e 313a 3339 3233 2f2e 6370 722f  0.0.1:3923/.cpr/
-00010520: 612f 7061 7274 7966 7573 652e 7079 290a  a/partyfuse.py).
-00010530: 2020 2a20 5b72 636c 6f6e 655d 2868 7474    * [rclone](htt
-00010540: 7073 3a2f 2f72 636c 6f6e 652e 6f72 672f  ps://rclone.org/
-00010550: 2920 6173 2063 6c69 656e 7420 6361 6e20  ) as client can 
-00010560: 6769 7665 207e 3578 2070 6572 666f 726d  give ~5x perform
-00010570: 616e 6365 2c20 7365 6520 5b2e 2f64 6f63  ance, see [./doc
-00010580: 732f 7263 6c6f 6e65 2e6d 645d 2864 6f63  s/rclone.md](doc
-00010590: 732f 7263 6c6f 6e65 2e6d 6429 0a0a 2a20  s/rclone.md)..* 
-000105a0: 7368 6172 6578 2028 7363 7265 656e 7368  sharex (screensh
-000105b0: 6f74 2075 7469 6c69 7479 293a 2073 6565  ot utility): see
-000105c0: 205b 2e2f 636f 6e74 7269 622f 7368 6172   [./contrib/shar
-000105d0: 6578 2e73 7863 755d 2863 6f6e 7472 6962  ex.sxcu](contrib
-000105e0: 2f23 7368 6172 6578 7378 6375 290a 0a63  /#sharexsxcu)..c
-000105f0: 6f70 7970 6172 7479 2072 6574 7572 6e73  opyparty returns
-00010600: 2061 2074 7275 6e63 6174 6564 2073 6861   a truncated sha
-00010610: 3531 3273 756d 206f 6620 796f 7572 2050  512sum of your P
-00010620: 5554 2f50 4f53 5420 6173 2062 6173 6536  UT/POST as base6
-00010630: 343b 2079 6f75 2063 616e 2067 656e 6572  4; you can gener
-00010640: 6174 6520 7468 6520 7361 6d65 2063 6865  ate the same che
-00010650: 636b 7375 6d20 6c6f 6361 6c6c 7920 746f  cksum locally to
-00010660: 2076 6572 6966 7920 7570 6c61 6f64 733a   verify uplaods:
-00010670: 0a0a 2020 2020 6235 3132 2829 7b20 7072  ..    b512(){ pr
-00010680: 696e 7466 2022 2428 2873 6861 3531 3273  intf "$((sha512s
-00010690: 756d 7c7c 7368 6173 756d 202d 6135 3132  um||shasum -a512
-000106a0: 297c 7365 6420 2d45 2027 732f 202e 2a2f  )|sed -E 's/ .*/
-000106b0: 2f3b 732f 282e 2e29 2f5c 5c78 5c31 2f67  /;s/(..)/\\x\1/g
-000106c0: 2729 227c 6261 7365 3634 7c74 7220 272b  ')"|base64|tr '+
-000106d0: 2f27 2027 2d5f 277c 6865 6164 202d 6334  /' '-_'|head -c4
-000106e0: 343b 7d0a 2020 2020 6235 3132 203c 6d6f  4;}.    b512 <mo
-000106f0: 7669 652e 6d6b 760a 0a79 6f75 2063 616e  vie.mkv..you can
-00010700: 2070 726f 7669 6465 2070 6173 7377 6f72   provide passwor
-00010710: 6473 2075 7369 6e67 2068 6561 6465 7220  ds using header 
-00010720: 6050 573a 2068 756e 7465 7232 602c 2063  `PW: hunter2`, c
-00010730: 6f6f 6b69 6520 6063 7070 7764 3d68 756e  ookie `cppwd=hun
-00010740: 7465 7232 602c 2075 726c 2d70 6172 616d  ter2`, url-param
-00010750: 2060 3f70 773d 6875 6e74 6572 3260 2c20   `?pw=hunter2`, 
-00010760: 6f72 2077 6974 6820 6261 7369 632d 6175  or with basic-au
-00010770: 7468 656e 7469 6361 7469 6f6e 2028 6569  thentication (ei
-00010780: 7468 6572 2061 7320 7468 6520 7573 6572  ther as the user
-00010790: 6e61 6d65 206f 7220 7061 7373 776f 7264  name or password
-000107a0: 290a 0a4e 4f54 453a 2063 7572 6c20 7769  )..NOTE: curl wi
-000107b0: 6c6c 206e 6f74 2073 656e 6420 7468 6520  ll not send the 
-000107c0: 6f72 6967 696e 616c 2066 696c 656e 616d  original filenam
-000107d0: 6520 6966 2079 6f75 2075 7365 2060 2d54  e if you use `-T
-000107e0: 6020 636f 6d62 696e 6564 2077 6974 6820  ` combined with 
-000107f0: 7572 6c2d 7061 7261 6d73 2120 416c 736f  url-params! Also
-00010800: 2c20 6d61 6b65 2073 7572 6520 746f 2061  , make sure to a
-00010810: 6c77 6179 7320 6c65 6176 6520 6120 7472  lways leave a tr
-00010820: 6169 6c69 6e67 2073 6c61 7368 2069 6e20  ailing slash in 
-00010830: 5552 4c73 2075 6e6c 6573 7320 796f 7520  URLs unless you 
-00010840: 7761 6e74 2074 6f20 6f76 6572 7269 6465  want to override
-00010850: 2074 6865 2066 696c 656e 616d 650a 0a0a   the filename...
-00010860: 2323 206d 6f75 6e74 2061 7320 6472 6976  ## mount as driv
-00010870: 650a 0a61 2072 656d 6f74 6520 636f 7079  e..a remote copy
-00010880: 7061 7274 7920 7365 7276 6572 2061 7320  party server as 
-00010890: 6120 6c6f 6361 6c20 6669 6c65 7379 7374  a local filesyst
-000108a0: 656d 3b20 2067 6f20 746f 2074 6865 2063  em;  go to the c
-000108b0: 6f6e 7472 6f6c 2d70 616e 656c 2061 6e64  ontrol-panel and
-000108c0: 2063 6c69 636b 2060 636f 6e6e 6563 7460   click `connect`
-000108d0: 2074 6f20 7365 6520 6120 6c69 7374 206f   to see a list o
-000108e0: 6620 636f 6d6d 616e 6473 2074 6f20 646f  f commands to do
-000108f0: 2074 6861 740a 0a61 6c74 6572 6e61 7469   that..alternati
-00010900: 7665 6c79 2c20 736f 6d65 2061 6c74 6572  vely, some alter
-00010910: 6e61 7469 7665 7320 726f 7567 686c 7920  natives roughly 
-00010920: 736f 7274 6564 2062 7920 7370 6565 6420  sorted by speed 
-00010930: 2875 6e72 6570 726f 6475 6369 626c 6520  (unreproducible 
-00010940: 6265 6e63 686d 6172 6b29 2c20 6265 7374  benchmark), best
-00010950: 2066 6972 7374 3a0a 0a2a 205b 7263 6c6f   first:..* [rclo
-00010960: 6e65 2d68 7474 705d 282e 2f64 6f63 732f  ne-http](./docs/
-00010970: 7263 6c6f 6e65 2e6d 6429 2028 3235 7329  rclone.md) (25s)
-00010980: 2c20 7265 6164 2d6f 6e6c 790a 2a20 5b72  , read-only.* [r
-00010990: 636c 6f6e 652d 6674 705d 282e 2f64 6f63  clone-ftp](./doc
-000109a0: 732f 7263 6c6f 6e65 2e6d 6429 2028 3437  s/rclone.md) (47
-000109b0: 7329 2c20 7265 6164 2f57 5249 5445 0a2a  s), read/WRITE.*
-000109c0: 205b 7263 6c6f 6e65 2d77 6562 6461 765d   [rclone-webdav]
-000109d0: 282e 2f64 6f63 732f 7263 6c6f 6e65 2e6d  (./docs/rclone.m
-000109e0: 6429 2028 3531 7329 2c20 7265 6164 2f57  d) (51s), read/W
-000109f0: 5249 5445 0a20 202a 2063 6f70 7970 6172  RITE.  * copypar
-00010a00: 7479 2d31 2e35 2e30 2773 2077 6562 6461  ty-1.5.0's webda
-00010a10: 7620 7365 7276 6572 2069 7320 6661 7374  v server is fast
-00010a20: 6572 2074 6861 6e20 7263 6c6f 6e65 2d31  er than rclone-1
-00010a30: 2e36 302e 3020 2836 3973 290a 2a20 5b70  .60.0 (69s).* [p
-00010a40: 6172 7479 6675 7365 2e70 795d 282e 2f62  artyfuse.py](./b
-00010a50: 696e 2f23 7061 7274 7966 7573 6570 7929  in/#partyfusepy)
-00010a60: 2028 3731 7329 2c20 7265 6164 2d6f 6e6c   (71s), read-onl
-00010a70: 790a 2a20 6461 7666 7332 2028 3130 3373  y.* davfs2 (103s
-00010a80: 292c 2072 6561 642f 5752 4954 452c 202a  ), read/WRITE, *
-00010a90: 7665 7279 2066 6173 742a 206f 6e20 736d  very fast* on sm
-00010aa0: 616c 6c20 6669 6c65 730a 2a20 5b77 696e  all files.* [win
-00010ab0: 3130 2d77 6562 6461 765d 2823 7765 6264  10-webdav](#webd
-00010ac0: 6176 2d73 6572 7665 7229 2028 3133 3873  av-server) (138s
-00010ad0: 292c 2072 6561 642f 5752 4954 450a 2a20  ), read/WRITE.* 
-00010ae0: 5b77 696e 3130 2d73 6d62 325d 2823 736d  [win10-smb2](#sm
-00010af0: 622d 7365 7276 6572 2920 2833 3837 7329  b-server) (387s)
-00010b00: 2c20 7265 6164 2f57 5249 5445 0a0a 6d6f  , read/WRITE..mo
-00010b10: 7374 2063 6c69 656e 7473 2077 696c 6c20  st clients will 
-00010b20: 6661 696c 2074 6f20 6d6f 756e 7420 7468  fail to mount th
-00010b30: 6520 726f 6f74 206f 6620 6120 636f 7079  e root of a copy
-00010b40: 7061 7274 7920 7365 7276 6572 2075 6e6c  party server unl
-00010b50: 6573 7320 7468 6572 6520 6973 2061 2072  ess there is a r
-00010b60: 6f6f 7420 766f 6c75 6d65 2028 736f 2079  oot volume (so y
-00010b70: 6f75 2067 6574 2074 6865 2061 646d 696e  ou get the admin
-00010b80: 2d70 616e 656c 2069 6e73 7465 6164 206f  -panel instead o
-00010b90: 6620 6120 6272 6f77 7365 7220 7768 656e  f a browser when
-00010ba0: 2061 6363 6573 7369 6e67 2069 7429 202d   accessing it) -
-00010bb0: 2d20 696e 2074 6861 7420 6361 7365 2c20  - in that case, 
-00010bc0: 6d6f 756e 7420 6120 7370 6563 6966 6963  mount a specific
-00010bd0: 2076 6f6c 756d 6520 696e 7374 6561 640a   volume instead.
-00010be0: 0a0a 2320 7065 7266 6f72 6d61 6e63 650a  ..# performance.
-00010bf0: 0a64 6566 6175 6c74 7320 6172 6520 7573  .defaults are us
-00010c00: 7561 6c6c 7920 6669 6e65 202d 2065 7870  ually fine - exp
-00010c10: 6563 7420 6038 2047 6942 2f73 6020 646f  ect `8 GiB/s` do
-00010c20: 776e 6c6f 6164 2c20 6031 2047 6942 2f73  wnload, `1 GiB/s
-00010c30: 6020 7570 6c6f 6164 0a0a 6265 6c6f 7720  ` upload..below 
-00010c40: 6172 6520 736f 6d65 2074 7765 616b 7320  are some tweaks 
-00010c50: 726f 7567 686c 7920 6f72 6465 7265 6420  roughly ordered 
-00010c60: 6279 2075 7365 6675 6c6e 6573 733a 0a0a  by usefulness:..
-00010c70: 2a20 602d 7160 2064 6973 6162 6c65 7320  * `-q` disables 
-00010c80: 6c6f 6767 696e 6720 616e 6420 6361 6e20  logging and can 
-00010c90: 6865 6c70 2061 2062 756e 6368 2c20 6576  help a bunch, ev
-00010ca0: 656e 2077 6865 6e20 636f 6d62 696e 6564  en when combined
-00010cb0: 2077 6974 6820 602d 6c6f 6020 746f 2072   with `-lo` to r
-00010cc0: 6564 6972 6563 7420 6c6f 6773 2074 6f20  edirect logs to 
-00010cd0: 6669 6c65 0a2a 2060 2d2d 6874 7470 2d6f  file.* `--http-o
-00010ce0: 6e6c 7960 206f 7220 602d 2d68 7474 7073  nly` or `--https
-00010cf0: 2d6f 6e6c 7960 2028 756e 6c65 7373 2079  -only` (unless y
-00010d00: 6f75 2077 616e 7420 746f 2073 7570 706f  ou want to suppo
-00010d10: 7274 2062 6f74 6820 7072 6f74 6f63 6f6c  rt both protocol
-00010d20: 7329 2077 696c 6c20 7265 6475 6365 2074  s) will reduce t
-00010d30: 6865 2064 656c 6179 2062 6566 6f72 6520  he delay before 
-00010d40: 6120 6e65 7720 636f 6e6e 6563 7469 6f6e  a new connection
-00010d50: 2069 7320 6573 7461 626c 6973 6865 640a   is established.
-00010d60: 2a20 602d 2d68 6973 7460 2070 6f69 6e74  * `--hist` point
-00010d70: 696e 6720 746f 2061 2066 6173 7420 6c6f  ing to a fast lo
-00010d80: 6361 7469 6f6e 2028 7373 6429 2077 696c  cation (ssd) wil
-00010d90: 6c20 6d61 6b65 2064 6972 6563 746f 7279  l make directory
-00010da0: 206c 6973 7469 6e67 7320 616e 6420 7365   listings and se
-00010db0: 6172 6368 6573 2066 6173 7465 7220 7768  arches faster wh
-00010dc0: 656e 2060 2d65 3264 6020 6f72 2060 2d65  en `-e2d` or `-e
-00010dd0: 3274 6020 6973 2073 6574 0a2a 2060 2d2d  2t` is set.* `--
-00010de0: 6e6f 2d68 6173 6820 2e60 2077 6865 6e20  no-hash .` when 
-00010df0: 696e 6465 7869 6e67 2061 206e 6574 776f  indexing a netwo
-00010e00: 726b 2d64 6973 6b20 6966 2079 6f75 2064  rk-disk if you d
-00010e10: 6f6e 2774 2063 6172 6520 6162 6f75 7420  on't care about 
-00010e20: 7468 6520 6163 7475 616c 2066 696c 6568  the actual fileh
-00010e30: 6173 6865 7320 616e 6420 6f6e 6c79 2077  ashes and only w
-00010e40: 616e 7420 7468 6520 6e61 6d65 732f 7461  ant the names/ta
-00010e50: 6773 2073 6561 7263 6861 626c 650a 2a20  gs searchable.* 
-00010e60: 602d 2d6e 6f2d 6874 7020 2d2d 6861 7368  `--no-htp --hash
-00010e70: 2d6d 743d 3020 2d2d 6d74 6167 2d6d 743d  -mt=0 --mtag-mt=
-00010e80: 3120 2d2d 7468 2d6d 743d 3160 206d 696e  1 --th-mt=1` min
-00010e90: 696d 697a 6573 2074 6865 206e 756d 6265  imizes the numbe
-00010ea0: 7220 6f66 2074 6872 6561 6473 3b20 6361  r of threads; ca
-00010eb0: 6e20 6865 6c70 2069 6e20 736f 6d65 2065  n help in some e
-00010ec0: 6363 656e 7472 6963 2065 6e76 6972 6f6e  ccentric environ
-00010ed0: 6d65 6e74 7320 286c 696b 6520 7468 6520  ments (like the 
-00010ee0: 7673 636f 6465 2064 6562 7567 6765 7229  vscode debugger)
-00010ef0: 0a2a 2060 2d6a 6020 656e 6162 6c65 7320  .* `-j` enables 
-00010f00: 6d75 6c74 6970 726f 6365 7373 696e 6720  multiprocessing 
-00010f10: 2861 6374 7561 6c20 6d75 6c74 6974 6872  (actual multithr
-00010f20: 6561 6469 6e67 2920 616e 6420 6361 6e20  eading) and can 
-00010f30: 6d61 6b65 2063 6f70 7970 6172 7479 2070  make copyparty p
-00010f40: 6572 666f 726d 2062 6574 7465 7220 696e  erform better in
-00010f50: 2063 7075 2d69 6e74 656e 7369 7665 2077   cpu-intensive w
-00010f60: 6f72 6b6c 6f61 6473 2c20 666f 7220 6578  orkloads, for ex
-00010f70: 616d 706c 653a 0a20 202a 2068 7567 6520  ample:.  * huge 
-00010f80: 616d 6f75 6e74 206f 6620 7368 6f72 742d  amount of short-
-00010f90: 6c69 7665 6420 636f 6e6e 6563 7469 6f6e  lived connection
-00010fa0: 730a 2020 2a20 7369 6d75 6c74 616e 656f  s.  * simultaneo
-00010fb0: 7573 2064 6f77 6e6c 6f61 6473 2061 6e64  us downloads and
-00010fc0: 2075 706c 6f61 6473 2073 6174 7572 6174   uploads saturat
-00010fd0: 696e 6720 6120 3230 6762 7073 2063 6f6e  ing a 20gbps con
-00010fe0: 6e65 6374 696f 6e0a 2020 0a20 202e 2e2e  nection.  .  ...
-00010ff0: 686f 7765 7665 7220 6974 2061 6464 7320  however it adds 
-00011000: 616e 206f 7665 7268 6561 6420 746f 2069  an overhead to i
-00011010: 6e74 6572 6e61 6c20 636f 6d6d 756e 6963  nternal communic
-00011020: 6174 696f 6e20 736f 2069 7420 6d69 6768  ation so it migh
-00011030: 7420 6265 2061 206e 6574 206c 6f73 732c  t be a net loss,
-00011040: 2073 6565 2069 6620 6974 2077 6f72 6b73   see if it works
-00011050: 2034 2075 0a0a 0a23 2320 636c 6965 6e74   4 u...## client
-00011060: 2d73 6964 650a 0a77 6865 6e20 7570 6c6f  -side..when uplo
-00011070: 6164 696e 6720 6669 6c65 732c 0a0a 2a20  ading files,..* 
-00011080: 6368 726f 6d65 2069 7320 7265 636f 6d6d  chrome is recomm
-00011090: 656e 6465 642c 2061 7420 6c65 6173 7420  ended, at least 
-000110a0: 636f 6d70 6172 6564 2074 6f20 6669 7265  compared to fire
-000110b0: 666f 783a 0a20 202a 2075 7020 746f 2039  fox:.  * up to 9
-000110c0: 3025 2066 6173 7465 7220 7768 656e 2068  0% faster when h
-000110d0: 6173 6869 6e67 2c20 6573 7065 6369 616c  ashing, especial
-000110e0: 6c79 206f 6e20 5353 4473 0a20 202a 2075  ly on SSDs.  * u
-000110f0: 7020 746f 2034 3025 2066 6173 7465 7220  p to 40% faster 
-00011100: 7768 656e 2075 706c 6f61 6469 6e67 206f  when uploading o
-00011110: 7665 7220 6578 7472 656d 656c 7920 6661  ver extremely fa
-00011120: 7374 2069 6e74 6572 6e65 7473 0a20 202a  st internets.  *
-00011130: 2062 7574 205b 7570 326b 2e70 795d 2868   but [up2k.py](h
-00011140: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00011150: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-00011160: 2f62 6c6f 622f 686f 7675 6473 7472 6175  /blob/hovudstrau
-00011170: 6d2f 6269 6e2f 7570 326b 2e70 7929 2063  m/bin/up2k.py) c
-00011180: 616e 2062 6520 3430 2520 6661 7374 6572  an be 40% faster
-00011190: 2074 6861 6e20 6368 726f 6d65 2061 6761   than chrome aga
-000111a0: 696e 0a0a 2a20 6966 2079 6f75 2772 6520  in..* if you're 
-000111b0: 6370 752d 626f 7474 6c65 6e65 636b 6564  cpu-bottlenecked
-000111c0: 2c20 6f72 2074 6865 2062 726f 7773 6572  , or the browser
-000111d0: 2069 7320 6d61 7869 6e67 2061 2063 7075   is maxing a cpu
-000111e0: 2063 6f72 653a 0a20 202a 2075 7020 746f   core:.  * up to
-000111f0: 2033 3025 2066 6173 7465 7220 7570 6c6f   30% faster uplo
-00011200: 6164 7320 6966 2079 6f75 2068 6964 6520  ads if you hide 
-00011210: 7468 6520 7570 6c6f 6164 2073 7461 7475  the upload statu
-00011220: 7320 6c69 7374 2062 7920 7377 6974 6368  s list by switch
-00011230: 696e 6720 6177 6179 2066 726f 6d20 7468  ing away from th
-00011240: 6520 605b f09f 9a80 5d60 2075 7032 6b20  e `[....]` up2k 
-00011250: 7569 2d74 6162 2028 6f72 2063 6c6f 7369  ui-tab (or closi
-00011260: 6e67 2069 7429 0a20 2020 202a 206f 7074  ng it).    * opt
-00011270: 696f 6e61 6c6c 7920 796f 7520 6361 6e20  ionally you can 
-00011280: 7377 6974 6368 2074 6f20 7468 6520 6c69  switch to the li
-00011290: 6768 7477 6569 6768 7420 706f 7461 746f  ghtweight potato
-000112a0: 2075 6920 6279 2063 6c69 636b 696e 6720   ui by clicking 
-000112b0: 7468 6520 605b f09f a594 5d60 0a20 2020  the `[....]`.   
-000112c0: 202a 2073 7769 7463 6869 6e67 2074 6f20   * switching to 
-000112d0: 616e 6f74 6865 7220 6272 6f77 7365 722d  another browser-
-000112e0: 7461 6220 616c 736f 2077 6f72 6b73 2c20  tab also works, 
-000112f0: 7468 6520 6661 7669 636f 6e20 7769 6c6c  the favicon will
-00011300: 2075 7064 6174 6520 6576 6572 7920 3130   update every 10
-00011310: 2073 6563 6f6e 6473 2069 6e20 7468 6174   seconds in that
-00011320: 2063 6173 650a 2020 2a20 756e 6c69 6b65   case.  * unlike
-00011330: 6c79 2074 6f20 6265 2061 2070 726f 626c  ly to be a probl
-00011340: 656d 2c20 6275 7420 6361 6e20 6861 7070  em, but can happ
-00011350: 656e 2077 6865 6e20 7570 6c6f 6469 6e67  en when uploding
-00011360: 206d 616e 7920 736d 616c 6c20 6669 6c65   many small file
-00011370: 732c 206f 7220 796f 7572 2069 6e74 6572  s, or your inter
-00011380: 6e65 7420 6973 2074 6f6f 2066 6173 742c  net is too fast,
-00011390: 206f 7220 5043 2074 6f6f 2073 6c6f 770a   or PC too slow.
-000113a0: 0a0a 2320 7365 6375 7269 7479 0a0a 736f  ..# security..so
-000113b0: 6d65 206e 6f74 6573 206f 6e20 6861 7264  me notes on hard
-000113c0: 656e 696e 670a 0a2a 2073 6574 2060 2d2d  ening..* set `--
-000113d0: 7270 726f 7879 2030 6020 6966 2079 6f75  rproxy 0` if you
-000113e0: 7220 636f 7079 7061 7274 7920 6973 2064  r copyparty is d
-000113f0: 6972 6563 746c 7920 6661 6369 6e67 2074  irectly facing t
-00011400: 6865 2069 6e74 6572 6e65 7420 286e 6f74  he internet (not
-00011410: 2074 6872 6f75 6768 2061 2072 6576 6572   through a rever
-00011420: 7365 2d70 726f 7879 290a 2020 2a20 636f  se-proxy).  * co
-00011430: 7273 2064 6f65 736e 2774 2077 6f72 6b20  rs doesn't work 
-00011440: 7269 6768 7420 6f74 6865 7277 6973 650a  right otherwise.
-00011450: 0a73 6166 6574 7920 7072 6f66 696c 6573  .safety profiles
-00011460: 3a0a 0a2a 206f 7074 696f 6e20 602d 7360  :..* option `-s`
-00011470: 2069 7320 6120 7368 6f72 7463 7574 2074   is a shortcut t
-00011480: 6f20 7365 7420 7468 6520 666f 6c6c 6f77  o set the follow
-00011490: 696e 6720 6f70 7469 6f6e 733a 0a20 202a  ing options:.  *
-000114a0: 2060 2d2d 6e6f 2d74 6875 6d62 6020 6469   `--no-thumb` di
-000114b0: 7361 626c 6573 2074 6875 6d62 6e61 696c  sables thumbnail
-000114c0: 7320 616e 6420 6175 6469 6f20 7472 616e  s and audio tran
-000114d0: 7363 6f64 696e 6720 746f 2073 746f 7020  scoding to stop 
-000114e0: 636f 7079 7061 7274 7920 6672 6f6d 2072  copyparty from r
-000114f0: 756e 6e69 6e67 2060 4646 6d70 6567 602f  unning `FFmpeg`/
-00011500: 6050 696c 6c6f 7760 2f60 5649 5053 6020  `Pillow`/`VIPS` 
-00011510: 6f6e 2075 706c 6f61 6465 6420 6669 6c65  on uploaded file
-00011520: 732c 2077 6869 6368 2069 7320 6120 5b67  s, which is a [g
-00011530: 6f6f 6420 6964 6561 5d28 6874 7470 733a  ood idea](https:
-00011540: 2f2f 7777 772e 6376 6564 6574 6169 6c73  //www.cvedetails
-00011550: 2e63 6f6d 2f76 756c 6e65 7261 6269 6c69  .com/vulnerabili
-00011560: 7479 2d6c 6973 742e 7068 703f 7665 6e64  ty-list.php?vend
-00011570: 6f72 5f69 643d 3336 3131 2920 6966 2061  or_id=3611) if a
-00011580: 6e6f 6e79 6d6f 7573 2075 706c 6f61 6420  nonymous upload 
-00011590: 6973 2065 6e61 626c 6564 0a20 202a 2060  is enabled.  * `
-000115a0: 2d2d 6e6f 2d6d 7461 672d 6666 6020 7573  --no-mtag-ff` us
-000115b0: 6573 2060 6d75 7461 6765 6e60 2074 6f20  es `mutagen` to 
-000115c0: 6772 6162 206d 7573 6963 2074 6167 7320  grab music tags 
-000115d0: 696e 7374 6561 6420 6f66 2060 4646 6d70  instead of `FFmp
-000115e0: 6567 602c 2077 6869 6368 2069 7320 7361  eg`, which is sa
-000115f0: 6665 7220 616e 6420 6661 7374 6572 2062  fer and faster b
-00011600: 7574 206c 6573 7320 6163 6375 7261 7465  ut less accurate
-00011610: 0a20 202a 2060 2d2d 646f 7470 6172 7460  .  * `--dotpart`
-00011620: 2068 6964 6573 2075 706c 6f61 6473 2066   hides uploads f
-00011630: 726f 6d20 6469 7265 6374 6f72 7920 6c69  rom directory li
-00011640: 7374 696e 6773 2077 6869 6c65 2074 6865  stings while the
-00011650: 7927 7265 2073 7469 6c6c 2069 6e63 6f6d  y're still incom
-00011660: 696e 670a 2020 2a20 602d 2d6e 6f2d 726f  ing.  * `--no-ro
-00011670: 626f 7473 6020 616e 6420 602d 2d66 6f72  bots` and `--for
-00011680: 6365 2d6a 7360 206d 616b 6573 206c 6966  ce-js` makes lif
-00011690: 6520 6861 7264 6572 2066 6f72 2063 7261  e harder for cra
-000116a0: 776c 6572 732c 2073 6565 205b 6869 6469  wlers, see [hidi
-000116b0: 6e67 2066 726f 6d20 676f 6f67 6c65 5d28  ng from google](
-000116c0: 2368 6964 696e 672d 6672 6f6d 2d67 6f6f  #hiding-from-goo
-000116d0: 676c 6529 0a0a 2a20 6f70 7469 6f6e 2060  gle)..* option `
-000116e0: 2d73 7360 2069 7320 6120 7368 6f72 7463  -ss` is a shortc
-000116f0: 7574 2066 6f72 2074 6865 2061 626f 7665  ut for the above
-00011700: 2070 6c75 733a 0a20 202a 2060 2d2d 756e   plus:.  * `--un
-00011710: 706f 7374 2030 602c 2060 2d2d 6e6f 2d64  post 0`, `--no-d
-00011720: 656c 602c 2060 2d2d 6e6f 2d6d 7660 2064  el`, `--no-mv` d
-00011730: 6973 6162 6c65 7320 616c 6c20 6d6f 7665  isables all move
-00011740: 2f64 656c 6574 6520 7375 7070 6f72 740a  /delete support.
-00011750: 2020 2a20 602d 2d68 6172 646c 696e 6b60    * `--hardlink`
-00011760: 2063 7265 6174 6573 2068 6172 646c 696e   creates hardlin
-00011770: 6b73 2069 6e73 7465 6164 206f 6620 7379  ks instead of sy
-00011780: 6d6c 696e 6b73 2077 6865 6e20 6465 6475  mlinks when dedu
-00011790: 706c 6963 6174 696e 6720 7570 6c6f 6164  plicating upload
-000117a0: 732c 2077 6869 6368 2069 7320 6c65 7373  s, which is less
-000117b0: 206d 6169 6e74 656e 616e 6365 0a20 2020   maintenance.   
-000117c0: 202a 2068 6f77 6576 6572 206e 6f74 6520   * however note 
-000117d0: 6966 2079 6f75 2065 6469 7420 6f6e 6520  if you edit one 
-000117e0: 6669 6c65 2069 7420 7769 6c6c 2061 6c73  file it will als
-000117f0: 6f20 6166 6665 6374 2074 6865 206f 7468  o affect the oth
-00011800: 6572 2063 6f70 6965 730a 2020 2a20 602d  er copies.  * `-
-00011810: 2d76 6167 7565 2d34 3031 6020 7265 7475  -vague-401` retu
-00011820: 726e 7320 6120 2234 3034 206e 6f74 2066  rns a "404 not f
-00011830: 6f75 6e64 2220 696e 7374 6561 6420 6f66  ound" instead of
-00011840: 2022 3430 3120 756e 6175 7468 6f72 697a   "401 unauthoriz
-00011850: 6564 2220 7768 6963 6820 6973 2061 2063  ed" which is a c
-00011860: 6f6d 6d6f 6e20 656e 7465 7270 7269 7365  ommon enterprise
-00011870: 206d 656d 650a 2020 2a20 602d 2d62 616e   meme.  * `--ban
-00011880: 2d34 3034 3d35 302c 3630 2c31 3434 3060  -404=50,60,1440`
-00011890: 2062 616e 2063 6c69 656e 7420 666f 7220   ban client for 
-000118a0: 3134 3430 6d69 6e20 2832 3468 2920 6966  1440min (24h) if
-000118b0: 2074 6865 7920 6869 7420 3530 2034 3034   they hit 50 404
-000118c0: 2773 2069 6e20 3630 6d69 6e0a 2020 2020  's in 60min.    
-000118d0: 2a20 2a2a 4e42 3a2a 2a20 7769 6c6c 2062  * **NB:** will b
-000118e0: 616e 2061 6e79 6f6e 6520 7768 6f20 656e  an anyone who en
-000118f0: 6162 6c65 7320 7570 326b 2074 7572 626f  ables up2k turbo
-00011900: 0a20 202a 2060 2d2d 6e69 6860 2072 656d  .  * `--nih` rem
-00011910: 6f76 6573 2074 6865 2073 6572 7665 7220  oves the server 
-00011920: 686f 7374 6e61 6d65 2066 726f 6d20 6469  hostname from di
-00011930: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
-00011940: 0a0a 2a20 6f70 7469 6f6e 2060 2d73 7373  ..* option `-sss
-00011950: 6020 6973 2061 2073 686f 7274 6375 7420  ` is a shortcut 
-00011960: 666f 7220 7468 6520 6162 6f76 6520 706c  for the above pl
-00011970: 7573 3a0a 2020 2a20 602d 2d6e 6f2d 6461  us:.  * `--no-da
-00011980: 7660 2064 6973 6162 6c65 7320 7765 6264  v` disables webd
-00011990: 6176 2073 7570 706f 7274 0a20 202a 2060  av support.  * `
-000119a0: 2d2d 6e6f 2d6c 6f67 7565 7360 2061 6e64  --no-logues` and
-000119b0: 2060 2d2d 6e6f 2d72 6561 646d 6560 2064   `--no-readme` d
-000119c0: 6973 6162 6c65 7320 7375 7070 6f72 7420  isables support 
-000119d0: 666f 7220 7265 6164 6d65 2773 2061 6e64  for readme's and
-000119e0: 2070 726f 6c6f 6775 6573 202f 2065 7069   prologues / epi
-000119f0: 6c6f 6775 6573 2069 6e20 6469 7265 6374  logues in direct
-00011a00: 6f72 7920 6c69 7374 696e 6773 2c20 7768  ory listings, wh
-00011a10: 6963 6820 6f74 6865 7277 6973 6520 6c65  ich otherwise le
-00011a20: 7473 2070 656f 706c 6520 7570 6c6f 6164  ts people upload
-00011a30: 2061 7262 6974 7261 7279 2028 6275 7420   arbitrary (but 
-00011a40: 7361 6e64 626f 7865 6429 2060 3c73 6372  sandboxed) `<scr
-00011a50: 6970 743e 6020 7461 6773 0a20 202a 2060  ipt>` tags.  * `
-00011a60: 2d6c 6f20 6370 702d 2559 2d25 6d25 642d  -lo cpp-%Y-%m%d-
-00011a70: 2548 254d 2553 2e74 7874 2e78 7a60 2065  %H%M%S.txt.xz` e
-00011a80: 6e61 626c 6573 206c 6f67 6769 6e67 2074  nables logging t
-00011a90: 6f20 6469 736b 0a20 202a 2060 2d6c 7320  o disk.  * `-ls 
-00011aa0: 2a2a 2c2a 2c6c 6e2c 702c 7260 2064 6f65  **,*,ln,p,r` doe
-00011ab0: 7320 6120 7363 616e 206f 6e20 7374 6172  s a scan on star
-00011ac0: 7475 7020 666f 7220 616e 7920 6461 6e67  tup for any dang
-00011ad0: 6572 6f75 7320 7379 6d6c 696e 6b73 0a0a  erous symlinks..
-00011ae0: 6f74 6865 7220 6d69 7363 206e 6f74 6573  other misc notes
-00011af0: 3a0a 0a2a 2079 6f75 2063 616e 2064 6973  :..* you can dis
-00011b00: 6162 6c65 2064 6972 6563 746f 7279 206c  able directory l
-00011b10: 6973 7469 6e67 7320 6279 2067 6976 696e  istings by givin
-00011b20: 6720 7065 726d 6973 7369 6f6e 2060 6760  g permission `g`
-00011b30: 2069 6e73 7465 6164 206f 6620 6072 602c   instead of `r`,
-00011b40: 206f 6e6c 7920 6163 6365 7074 696e 6720   only accepting 
-00011b50: 6469 7265 6374 2055 524c 7320 746f 2066  direct URLs to f
-00011b60: 696c 6573 0a20 202a 2063 6f6d 6269 6e65  iles.  * combine
-00011b70: 2074 6869 7320 7769 7468 2076 6f6c 666c   this with volfl
-00011b80: 6167 2060 632c 666b 6020 746f 2067 656e  ag `c,fk` to gen
-00011b90: 6572 6174 6520 6669 6c65 6b65 7973 2028  erate filekeys (
-00011ba0: 7065 722d 6669 6c65 2061 6363 6573 736b  per-file accessk
-00011bb0: 6579 7329 3b20 7573 6572 7320 7768 6963  eys); users whic
-00011bc0: 6820 6861 7665 2066 756c 6c20 7265 6164  h have full read
-00011bd0: 2d61 6363 6573 7320 7769 6c6c 2074 6865  -access will the
-00011be0: 6e20 7365 6520 5552 4c73 2077 6974 6820  n see URLs with 
-00011bf0: 603f 6b3d 2e2e 2e60 2061 7070 656e 6465  `?k=...` appende
-00011c00: 6420 746f 2074 6865 2065 6e64 2c20 616e  d to the end, an
-00011c10: 6420 6067 6020 7573 6572 7320 6d75 7374  d `g` users must
-00011c20: 2070 726f 7669 6465 2074 6861 7420 5552   provide that UR
-00011c30: 4c20 696e 636c 7564 696e 6720 7468 6520  L including the 
-00011c40: 636f 7272 6563 7420 6b65 7920 746f 2061  correct key to a
-00011c50: 766f 6964 2061 2034 3034 0a20 2020 202a  void a 404.    *
-00011c60: 2074 6865 2064 6566 6175 6c74 2066 696c   the default fil
-00011c70: 656b 6579 2065 6e74 726f 7079 2069 7320  ekey entropy is 
-00011c80: 6661 6972 6c79 2073 6d61 6c6c 2073 6f20  fairly small so 
-00011c90: 6769 7665 2060 2d2d 666b 2d73 616c 7460  give `--fk-salt`
-00011ca0: 2061 726f 756e 6420 3330 2063 6861 7261   around 30 chara
-00011cb0: 6374 6572 7320 6966 2079 6f75 2077 616e  cters if you wan
-00011cc0: 7420 6669 6c65 6b65 7973 206c 6f6e 6765  t filekeys longe
-00011cd0: 7220 7468 616e 2031 3620 6368 6172 730a  r than 16 chars.
-00011ce0: 2020 2a20 7065 726d 6973 7369 6f6e 7320    * permissions 
-00011cf0: 6077 4760 206c 6574 7320 7573 6572 7320  `wG` lets users 
-00011d00: 7570 6c6f 6164 2066 696c 6573 2061 6e64  upload files and
-00011d10: 2072 6563 6569 7665 2074 6865 6972 206f   receive their o
-00011d20: 776e 2066 696c 656b 6579 732c 2073 7469  wn filekeys, sti
-00011d30: 6c6c 2077 6974 686f 7574 2062 6569 6e67  ll without being
-00011d40: 2061 626c 6520 746f 2073 6565 206f 7468   able to see oth
-00011d50: 6572 2075 706c 6f61 6473 0a0a 0a23 2320  er uploads...## 
-00011d60: 676f 7463 6861 730a 0a62 6568 6176 696f  gotchas..behavio
-00011d70: 7220 7468 6174 206d 6967 6874 2062 6520  r that might be 
-00011d80: 756e 6578 7065 6374 6564 0a0a 2a20 7573  unexpected..* us
-00011d90: 6572 7320 7769 7468 6f75 7420 7265 6164  ers without read
-00011da0: 2d61 6363 6573 7320 746f 2061 2066 6f6c  -access to a fol
-00011db0: 6465 7220 6361 6e20 7374 696c 6c20 7365  der can still se
-00011dc0: 6520 7468 6520 602e 7072 6f6c 6f67 7565  e the `.prologue
-00011dd0: 2e68 746d 6c60 202f 2060 2e65 7069 6c6f  .html` / `.epilo
-00011de0: 6775 652e 6874 6d6c 6020 2f20 6052 4541  gue.html` / `REA
-00011df0: 444d 452e 6d64 6020 636f 6e74 656e 7473  DME.md` contents
-00011e00: 2c20 666f 7220 7468 6520 7075 7270 6f73  , for the purpos
-00011e10: 6520 6f66 2073 686f 7769 6e67 2061 2064  e of showing a d
-00011e20: 6573 6372 6970 7469 6f6e 206f 6e20 686f  escription on ho
-00011e30: 7720 746f 2075 7365 2074 6865 2075 706c  w to use the upl
-00011e40: 6f61 6465 7220 666f 7220 6578 616d 706c  oader for exampl
-00011e50: 650a 2a20 7573 6572 7320 6361 6e20 7375  e.* users can su
-00011e60: 626d 6974 2060 3c73 6372 6970 743e 6073  bmit `<script>`s
-00011e70: 2077 6869 6368 2061 7574 6f72 756e 2066   which autorun f
-00011e80: 6f72 206f 7468 6572 2076 6973 6974 6f72  or other visitor
-00011e90: 7320 696e 2061 2066 6577 2077 6179 733b  s in a few ways;
-00011ea0: 0a20 202a 2075 706c 6f61 6469 6e67 2061  .  * uploading a
-00011eb0: 2060 5245 4144 4d45 2e6d 6460 202d 2d20   `README.md` -- 
-00011ec0: 6176 6f69 6420 7769 7468 2060 2d2d 6e6f  avoid with `--no
-00011ed0: 2d72 6561 646d 6560 0a20 202a 2072 656e  -readme`.  * ren
-00011ee0: 616d 696e 6720 6073 6f6d 652e 6874 6d6c  aming `some.html
-00011ef0: 6020 746f 2060 2e65 7069 6c6f 6775 652e  ` to `.epilogue.
-00011f00: 6874 6d6c 6020 2d2d 2061 766f 6964 2077  html` -- avoid w
-00011f10: 6974 6820 6569 7468 6572 2060 2d2d 6e6f  ith either `--no
-00011f20: 2d6c 6f67 7565 7360 206f 7220 602d 2d6e  -logues` or `--n
-00011f30: 6f2d 646f 742d 7265 6e60 0a20 202a 2074  o-dot-ren`.  * t
-00011f40: 6865 2064 6972 6563 746f 7279 2d6c 6973  he directory-lis
-00011f50: 7469 6e67 2065 6d62 6564 2069 7320 7361  ting embed is sa
-00011f60: 6e64 626f 7865 6420 2873 6f20 616e 7920  ndboxed (so any 
-00011f70: 6d61 6c69 6369 6f75 7320 7363 7269 7074  malicious script
-00011f80: 7320 6361 6e27 7420 646f 2061 6e79 2064  s can't do any d
-00011f90: 616d 6167 6529 2062 7574 2074 6865 206d  amage) but the m
-00011fa0: 6172 6b64 6f77 6e20 6564 6974 6f72 2069  arkdown editor i
-00011fb0: 7320 6e6f 740a 0a0a 2323 2063 6f72 730a  s not...## cors.
-00011fc0: 0a63 726f 7373 2d73 6974 6520 7265 7175  .cross-site requ
-00011fd0: 6573 7420 636f 6e66 6967 0a0a 6279 2064  est config..by d
-00011fe0: 6566 6175 6c74 2c20 6578 6365 7074 2066  efault, except f
-00011ff0: 6f72 2060 4745 5460 2061 6e64 2060 4845  or `GET` and `HE
-00012000: 4144 6020 6f70 6572 6174 696f 6e73 2c20  AD` operations, 
-00012010: 616c 6c20 7265 7175 6573 7473 206d 7573  all requests mus
-00012020: 7420 6569 7468 6572 3a0a 2a20 6e6f 7420  t either:.* not 
-00012030: 636f 6e74 6169 6e20 616e 2060 4f72 6967  contain an `Orig
-00012040: 696e 6020 6865 6164 6572 2061 7420 616c  in` header at al
-00012050: 6c0a 2a20 6f72 2068 6176 6520 616e 2060  l.* or have an `
-00012060: 4f72 6967 696e 6020 6d61 7463 6869 6e67  Origin` matching
-00012070: 2074 6865 2073 6572 7665 7220 646f 6d61   the server doma
-00012080: 696e 0a2a 206f 7220 7468 6520 6865 6164  in.* or the head
-00012090: 6572 2060 5057 6020 7769 7468 2079 6f75  er `PW` with you
-000120a0: 7220 7061 7373 776f 7264 2061 7320 7661  r password as va
-000120b0: 6c75 650a 0a63 6f72 7320 6361 6e20 6265  lue..cors can be
-000120c0: 2063 6f6e 6669 6775 7265 6420 7769 7468   configured with
-000120d0: 2060 2d2d 6163 616f 6020 616e 6420 602d   `--acao` and `-
-000120e0: 2d61 6361 6d60 2c20 6f72 2074 6865 2070  -acam`, or the p
-000120f0: 726f 7465 6374 696f 6e73 2065 6e74 6972  rotections entir
-00012100: 656c 7920 6469 7361 626c 6564 2077 6974  ely disabled wit
-00012110: 6820 602d 2d61 6c6c 6f77 2d63 7372 6660  h `--allow-csrf`
-00012120: 0a0a 0a23 2072 6563 6f76 6572 696e 6720  ...# recovering 
-00012130: 6672 6f6d 2063 7261 7368 6573 0a0a 2323  from crashes..##
-00012140: 2063 6c69 656e 7420 6372 6173 6865 730a   client crashes.
-00012150: 0a23 2323 2066 7265 666f 7820 7773 6f64  .### frefox wsod
-00012160: 0a0a 6669 7265 666f 7820 3837 2063 616e  ..firefox 87 can
-00012170: 2063 7261 7368 2064 7572 696e 6720 7570   crash during up
-00012180: 6c6f 6164 7320 202d 2d20 7468 6520 656e  loads  -- the en
-00012190: 7469 7265 2062 726f 7773 6572 2067 6f65  tire browser goe
-000121a0: 732c 2069 6e63 6c75 6469 6e67 2061 6c6c  s, including all
-000121b0: 206f 7468 6572 2062 726f 7773 6572 2074   other browser t
-000121c0: 6162 732c 2065 7665 7279 7468 696e 6720  abs, everything 
-000121d0: 7475 726e 7320 7768 6974 650a 0a68 6f77  turns white..how
-000121e0: 6576 6572 2079 6f75 2063 616e 2068 6974  ever you can hit
-000121f0: 2060 4631 3260 2069 6e20 7468 6520 7570   `F12` in the up
-00012200: 326b 2074 6162 2061 6e64 2075 7365 2074  2k tab and use t
-00012210: 6865 2064 6576 746f 6f6c 7320 746f 2073  he devtools to s
-00012220: 6565 2068 6f77 2066 6172 2079 6f75 2067  ee how far you g
-00012230: 6f74 2069 6e20 7468 6520 7570 6c6f 6164  ot in the upload
-00012240: 733a 0a0a 2a20 6765 7420 6120 636f 6d70  s:..* get a comp
-00012250: 6c65 7465 206c 6973 7420 6f66 2061 6c6c  lete list of all
-00012260: 2075 706c 6f61 6473 2c20 6f72 6761 6e69   uploads, organi
-00012270: 7a65 6420 6279 2073 7461 7475 7473 2028  zed by statuts (
-00012280: 6f6b 202f 206e 6f2d 676f 6f64 202f 2062  ok / no-good / b
-00012290: 7573 7920 2f20 7175 6575 6564 293a 2020  usy / queued):  
-000122a0: 0a20 2060 7661 7220 7461 6273 203d 207b  .  `var tabs = {
-000122b0: 206f 6b3a 5b5d 2c20 6e67 3a5b 5d2c 2062   ok:[], ng:[], b
-000122c0: 7a3a 5b5d 2c20 713a 5b5d 207d 3b20 666f  z:[], q:[] }; fo
-000122d0: 7220 2876 6172 2061 206f 6620 7570 326b  r (var a of up2k
-000122e0: 2e75 692e 7461 6229 2074 6162 735b 612e  .ui.tab) tabs[a.
-000122f0: 696e 5d2e 7075 7368 2861 293b 2074 6162  in].push(a); tab
-00012300: 7360 0a0a 2a20 6c69 7374 206f 6620 6669  s`..* list of fi
-00012310: 6c65 6e61 6d65 7320 7768 6963 6820 6661  lenames which fa
-00012320: 696c 6564 3a20 200a 2020 60e2 808b 7661  iled:  .  `...va
-00012330: 7220 6e67 203d 205b 5d3b 2066 6f72 2028  r ng = []; for (
-00012340: 7661 7220 6120 6f66 2075 7032 6b2e 7569  var a of up2k.ui
-00012350: 2e74 6162 2920 6966 2028 612e 696e 2021  .tab) if (a.in !
-00012360: 3d20 276f 6b27 2920 6e67 2e70 7573 6828  = 'ok') ng.push(
-00012370: 612e 686e 2e73 706c 6974 2827 3c61 2068  a.hn.split('<a h
-00012380: 7265 663d 5c22 2729 2e73 6c69 6365 282d  ref=\"').slice(-
-00012390: 3129 5b30 5d2e 7370 6c69 7428 275c 223e  1)[0].split('\">
-000123a0: 2729 5b30 5d29 3b20 6e67 600a 0a2a 2073  ')[0]); ng`..* s
-000123b0: 656e 6420 7468 6520 6c69 7374 206f 6620  end the list of 
-000123c0: 6669 6c65 6e61 6d65 7320 746f 2063 6f70  filenames to cop
-000123d0: 7970 6172 7479 2066 6f72 2073 6166 656b  yparty for safek
-000123e0: 6565 7069 6e67 3a20 200a 2020 6061 7761  eeping:  .  `awa
-000123f0: 6974 2066 6574 6368 2827 2f69 6e63 272c  it fetch('/inc',
-00012400: 207b 6d65 7468 6f64 3a27 5055 5427 2c20   {method:'PUT', 
-00012410: 626f 6479 3a4a 534f 4e2e 7374 7269 6e67  body:JSON.string
-00012420: 6966 7928 6e67 2c6e 756c 6c2c 3129 7d29  ify(ng,null,1)})
-00012430: 600a 0a0a 2320 4854 5450 2041 5049 0a0a  `...# HTTP API..
-00012440: 7365 6520 5b64 6576 6e6f 7465 735d 2823  see [devnotes](#
-00012450: 2e2f 646f 6373 2f64 6576 6e6f 7465 732e  ./docs/devnotes.
-00012460: 6d64 2368 7474 702d 6170 6929 0a0a 0a23  md#http-api)...#
-00012470: 2064 6570 656e 6465 6e63 6965 730a 0a6d   dependencies..m
-00012480: 616e 6461 746f 7279 2064 6570 733a 0a2a  andatory deps:.*
-00012490: 2060 6a69 6e6a 6132 6020 2869 7320 6275   `jinja2` (is bu
-000124a0: 696c 7420 696e 746f 2074 6865 2053 4658  ilt into the SFX
-000124b0: 290a 0a0a 2323 206f 7074 696f 6e61 6c20  )...## optional 
-000124c0: 6465 7065 6e64 656e 6369 6573 0a0a 696e  dependencies..in
-000124d0: 7374 616c 6c20 7468 6573 6520 746f 2065  stall these to e
-000124e0: 6e61 626c 6520 626f 6e75 7320 6665 6174  nable bonus feat
-000124f0: 7572 6573 0a0a 656e 6162 6c65 2066 7470  ures..enable ftp
-00012500: 2d73 6572 7665 723a 0a2a 2066 6f72 206a  -server:.* for j
-00012510: 7573 7420 706c 6169 6e74 6578 7420 4654  ust plaintext FT
-00012520: 502c 2060 7079 6674 7064 6c69 6260 2028  P, `pyftpdlib` (
-00012530: 6973 2062 7569 6c74 2069 6e74 6f20 7468  is built into th
-00012540: 6520 5346 5829 0a2a 2077 6974 6820 544c  e SFX).* with TL
-00012550: 5320 656e 6372 7970 7469 6f6e 2c20 6070  S encryption, `p
-00012560: 7966 7470 646c 6962 2070 796f 7065 6e73  yftpdlib pyopens
-00012570: 736c 600a 0a65 6e61 626c 6520 6d75 7369  sl`..enable musi
-00012580: 6320 7461 6773 3a0a 2a20 6569 7468 6572  c tags:.* either
-00012590: 2060 6d75 7461 6765 6e60 2028 6661 7374   `mutagen` (fast
-000125a0: 2c20 7075 7265 2d70 7974 686f 6e2c 2073  , pure-python, s
-000125b0: 6b69 7073 2061 2066 6577 2074 6167 732c  kips a few tags,
-000125c0: 206d 616b 6573 2063 6f70 7970 6172 7479   makes copyparty
-000125d0: 2047 504c 3f20 6964 6b29 0a2a 206f 7220   GPL? idk).* or 
-000125e0: 6066 6670 726f 6265 6020 2832 3078 2073  `ffprobe` (20x s
-000125f0: 6c6f 7765 722c 206d 6f72 6520 6163 6375  lower, more accu
-00012600: 7261 7465 2c20 706f 7373 6962 6c79 2064  rate, possibly d
-00012610: 616e 6765 726f 7573 2064 6570 656e 6469  angerous dependi
-00012620: 6e67 206f 6e20 796f 7572 2064 6973 7472  ng on your distr
-00012630: 6f20 616e 6420 7573 6572 7329 0a0a 656e  o and users)..en
-00012640: 6162 6c65 205b 7468 756d 626e 6169 6c73  able [thumbnails
-00012650: 5d28 2374 6875 6d62 6e61 696c 7329 206f  ](#thumbnails) o
-00012660: 662e 2e2e 0a2a 202a 2a69 6d61 6765 733a  f....* **images:
-00012670: 2a2a 2060 5069 6c6c 6f77 6020 616e 642f  ** `Pillow` and/
-00012680: 6f72 2060 7079 7669 7073 6020 616e 642f  or `pyvips` and/
-00012690: 6f72 2060 6666 6d70 6567 6020 2872 6571  or `ffmpeg` (req
-000126a0: 7569 7265 7320 7079 322e 3720 6f72 2070  uires py2.7 or p
-000126b0: 7933 2e35 2b29 0a2a 202a 2a76 6964 656f  y3.5+).* **video
-000126c0: 732f 6175 6469 6f3a 2a2a 2060 6666 6d70  s/audio:** `ffmp
-000126d0: 6567 6020 616e 6420 6066 6670 726f 6265  eg` and `ffprobe
-000126e0: 6020 736f 6d65 7768 6572 6520 696e 2060  ` somewhere in `
-000126f0: 2450 4154 4860 0a2a 202a 2a48 4549 4620  $PATH`.* **HEIF 
-00012700: 7069 6374 7572 6573 3a2a 2a20 6070 7976  pictures:** `pyv
-00012710: 6970 7360 206f 7220 6066 666d 7065 6760  ips` or `ffmpeg`
-00012720: 206f 7220 6070 7968 6569 662d 7069 6c6c   or `pyheif-pill
-00012730: 6f77 2d6f 7065 6e65 7260 2028 7265 7175  ow-opener` (requ
-00012740: 6972 6573 204c 696e 7578 206f 7220 6120  ires Linux or a 
-00012750: 4320 636f 6d70 696c 6572 290a 2a20 2a2a  C compiler).* **
-00012760: 4156 4946 2070 6963 7475 7265 733a 2a2a  AVIF pictures:**
-00012770: 2060 7079 7669 7073 6020 6f72 2060 6666   `pyvips` or `ff
-00012780: 6d70 6567 6020 6f72 2060 7069 6c6c 6f77  mpeg` or `pillow
-00012790: 2d61 7669 662d 706c 7567 696e 600a 2a20  -avif-plugin`.* 
-000127a0: 2a2a 4a50 4547 2058 4c20 7069 6374 7572  **JPEG XL pictur
-000127b0: 6573 3a2a 2a20 6070 7976 6970 7360 206f  es:** `pyvips` o
-000127c0: 7220 6066 666d 7065 6760 0a0a 656e 6162  r `ffmpeg`..enab
-000127d0: 6c65 205b 736d 625d 2823 736d 622d 7365  le [smb](#smb-se
-000127e0: 7276 6572 2920 7375 7070 6f72 7420 282a  rver) support (*
-000127f0: 2a6e 6f74 2a2a 2072 6563 6f6d 6d65 6e64  *not** recommend
-00012800: 6564 293a 0a2a 2060 696d 7061 636b 6574  ed):.* `impacket
-00012810: 3d3d 302e 3130 2e30 600a 0a60 7079 7669  ==0.10.0`..`pyvi
-00012820: 7073 6020 6769 7665 7320 6869 6768 6572  ps` gives higher
-00012830: 2071 7561 6c69 7479 2074 6875 6d62 6e61   quality thumbna
-00012840: 696c 7320 7468 616e 2060 5069 6c6c 6f77  ils than `Pillow
-00012850: 6020 616e 6420 6973 2033 3230 2520 6661  ` and is 320% fa
-00012860: 7374 6572 2c20 7573 696e 6720 3237 3025  ster, using 270%
-00012870: 206d 6f72 6520 7261 6d3a 2060 7375 646f   more ram: `sudo
-00012880: 2061 7074 2069 6e73 7461 6c6c 206c 6962   apt install lib
-00012890: 7669 7073 3432 2026 2620 7079 7468 6f6e  vips42 && python
-000128a0: 3320 2d6d 2070 6970 2069 6e73 7461 6c6c  3 -m pip install
-000128b0: 202d 2d75 7365 7220 2d55 2070 7976 6970   --user -U pyvip
-000128c0: 7360 0a0a 0a23 2320 6f70 7469 6f6e 616c  s`...## optional
-000128d0: 2067 706c 2073 7475 6666 0a0a 736f 6d65   gpl stuff..some
-000128e0: 2062 756e 646c 6564 2074 6f6f 6c73 2068   bundled tools h
-000128f0: 6176 6520 636f 7079 6c65 6674 2064 6570  ave copyleft dep
-00012900: 656e 6465 6e63 6965 732c 2073 6565 205b  endencies, see [
-00012910: 2e2f 6269 6e2f 236d 7461 675d 2862 696e  ./bin/#mtag](bin
-00012920: 2f23 6d74 6167 290a 0a74 6865 7365 2061  /#mtag)..these a
-00012930: 7265 2073 7461 6e64 616c 6f6e 6520 7072  re standalone pr
-00012940: 6f67 7261 6d73 2061 6e64 2077 696c 6c20  ograms and will 
-00012950: 6e65 7665 7220 6265 2069 6d70 6f72 7465  never be importe
-00012960: 6420 2f20 6576 616c 7561 7465 6420 6279  d / evaluated by
-00012970: 2063 6f70 7970 6172 7479 2c20 616e 6420   copyparty, and 
-00012980: 6d75 7374 2062 6520 656e 6162 6c65 6420  must be enabled 
-00012990: 7468 726f 7567 6820 602d 6d74 7060 2063  through `-mtp` c
-000129a0: 6f6e 6669 6773 0a0a 0a23 2073 6678 0a0a  onfigs...# sfx..
-000129b0: 7468 6520 7365 6c66 2d63 6f6e 7461 696e  the self-contain
-000129c0: 6564 2022 6269 6e61 7279 2220 205b 636f  ed "binary"  [co
-000129d0: 7079 7061 7274 792d 7366 782e 7079 5d28  pyparty-sfx.py](
-000129e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000129f0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-00012a00: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
-00012a10: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
-00012a20: 6172 7479 2d73 6678 2e70 7929 2077 696c  arty-sfx.py) wil
-00012a30: 6c20 756e 7061 636b 2069 7473 656c 6620  l unpack itself 
-00012a40: 616e 6420 7275 6e20 636f 7079 7061 7274  and run copypart
-00012a50: 792c 2061 7373 756d 696e 6720 796f 7520  y, assuming you 
-00012a60: 6861 7665 2070 7974 686f 6e20 696e 7374  have python inst
-00012a70: 616c 6c65 6420 6f66 2063 6f75 7273 650a  alled of course.
-00012a80: 0a79 6f75 2063 616e 2072 6564 7563 6520  .you can reduce 
-00012a90: 7468 6520 7366 7820 7369 7a65 2062 7920  the sfx size by 
-00012aa0: 7265 7061 636b 696e 6720 6974 3b20 7365  repacking it; se
-00012ab0: 6520 5b2e 2f64 6f63 732f 6465 766e 6f74  e [./docs/devnot
-00012ac0: 6573 2e6d 6423 7366 782d 7265 7061 636b  es.md#sfx-repack
-00012ad0: 5d28 232e 2f64 6f63 732f 6465 766e 6f74  ](#./docs/devnot
-00012ae0: 6573 2e6d 6423 7366 782d 7265 7061 636b  es.md#sfx-repack
-00012af0: 290a 0a0a 2323 2063 6f70 7970 6172 7479  )...## copyparty
-00012b00: 2e65 7865 0a0a 646f 776e 6c6f 6164 205b  .exe..download [
-00012b10: 636f 7079 7061 7274 792e 6578 655d 2868  copyparty.exe](h
-00012b20: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00012b30: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-00012b40: 2f72 656c 6561 7365 732f 6c61 7465 7374  /releases/latest
-00012b50: 2f64 6f77 6e6c 6f61 642f 636f 7079 7061  /download/copypa
-00012b60: 7274 792e 6578 6529 2028 7769 6e38 2b29  rty.exe) (win8+)
-00012b70: 206f 7220 5b63 6f70 7970 6172 7479 3332   or [copyparty32
-00012b80: 2e65 7865 5d28 6874 7470 733a 2f2f 6769  .exe](https://gi
-00012b90: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
-00012ba0: 7079 7061 7274 792f 7265 6c65 6173 6573  pyparty/releases
-00012bb0: 2f6c 6174 6573 742f 646f 776e 6c6f 6164  /latest/download
-00012bc0: 2f63 6f70 7970 6172 7479 3332 2e65 7865  /copyparty32.exe
-00012bd0: 2920 2877 696e 372b 290a 0a21 5b63 6f70  ) (win7+)..![cop
-00012be0: 7970 6172 7479 2d65 7865 2d66 7338 5d28  yparty-exe-fs8](
-00012bf0: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
-00012c00: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
-00012c10: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
-00012c20: 2f32 3231 3434 3539 3436 2d31 6533 3238  /221445946-1e328
-00012c30: 6535 362d 3863 3562 2d34 3461 392d 3862  e56-8c5b-44a9-8b
-00012c40: 3966 2d64 6565 3834 6439 3432 3533 352e  9f-dee84d942535.
-00012c50: 706e 6729 0a0a 6361 6e20 6265 2063 6f6e  png)..can be con
-00012c60: 7665 6e69 656e 7420 6f6e 206d 6163 6869  venient on machi
-00012c70: 6e65 7320 7768 6572 6520 696e 7374 616c  nes where instal
-00012c80: 6c69 6e67 2070 7974 686f 6e20 6973 2070  ling python is p
-00012c90: 726f 626c 656d 6174 6963 2c20 686f 7765  roblematic, howe
-00012ca0: 7665 7220 6973 202a 2a6e 6f74 2072 6563  ver is **not rec
-00012cb0: 6f6d 6d65 6e64 6564 2a2a 202d 2d20 6966  ommended** -- if
-00012cc0: 2070 6f73 7369 626c 652c 2070 6c65 6173   possible, pleas
-00012cd0: 6520 7573 6520 2a2a 5b63 6f70 7970 6172  e use **[copypar
-00012ce0: 7479 2d73 6678 2e70 795d 2868 7474 7073  ty-sfx.py](https
-00012cf0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
-00012d00: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
-00012d10: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
-00012d20: 6e6c 6f61 642f 636f 7079 7061 7274 792d  nload/copyparty-
-00012d30: 7366 782e 7079 292a 2a20 696e 7374 6561  sfx.py)** instea
-00012d40: 640a 0a2a 205b 636f 7079 7061 7274 792e  d..* [copyparty.
-00012d50: 6578 655d 2868 7474 7073 3a2f 2f67 6974  exe](https://git
-00012d60: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-00012d70: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
-00012d80: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
-00012d90: 636f 7079 7061 7274 792e 6578 6529 2072  copyparty.exe) r
-00012da0: 756e 7320 6f6e 2077 696e 3820 6f72 206e  uns on win8 or n
-00012db0: 6577 6572 2c20 7761 7320 636f 6d70 696c  ewer, was compil
-00012dc0: 6564 206f 6e20 7769 6e31 302c 2064 6f65  ed on win10, doe
-00012dd0: 7320 7468 756d 626e 6169 6c73 202b 206d  s thumbnails + m
-00012de0: 6564 6961 2074 6167 732c 2061 6e64 2069  edia tags, and i
-00012df0: 7320 2a63 7572 7265 6e74 6c79 2a20 7361  s *currently* sa
-00012e00: 6665 2074 6f20 7573 652c 2062 7574 2061  fe to use, but a
-00012e10: 6e79 2066 7574 7572 6520 7079 7468 6f6e  ny future python
-00012e20: 2f65 7870 6174 2f70 696c 6c6f 7720 4356  /expat/pillow CV
-00012e30: 4573 2063 616e 206f 6e6c 7920 6265 2072  Es can only be r
-00012e40: 656d 6564 6965 6420 6279 2064 6f77 6e6c  emedied by downl
-00012e50: 6f61 6469 6e67 2061 206e 6577 6572 2076  oading a newer v
-00012e60: 6572 7369 6f6e 206f 6620 7468 6520 6578  ersion of the ex
-00012e70: 650a 0a20 202a 206f 6e20 7769 6e38 2069  e..  * on win8 i
-00012e80: 7420 6e65 6564 7320 5b76 6320 7265 6469  t needs [vc redi
-00012e90: 7374 2032 3031 355d 2868 7474 7073 3a2f  st 2015](https:/
-00012ea0: 2f77 7777 2e6d 6963 726f 736f 6674 2e63  /www.microsoft.c
-00012eb0: 6f6d 2f65 6e2d 7573 2f64 6f77 6e6c 6f61  om/en-us/downloa
-00012ec0: 642f 6465 7461 696c 732e 6173 7078 3f69  d/details.aspx?i
-00012ed0: 643d 3438 3134 3529 2c20 6f6e 2077 696e  d=48145), on win
-00012ee0: 3130 2069 7420 6a75 7374 2077 6f72 6b73  10 it just works
-00012ef0: 0a0a 2a20 6461 6e67 6572 6f75 733a 205b  ..* dangerous: [
-00012f00: 636f 7079 7061 7274 7933 322e 6578 655d  copyparty32.exe]
-00012f10: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00012f20: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
-00012f30: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
-00012f40: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
-00012f50: 7061 7274 7933 322e 6578 6529 2069 7320  party32.exe) is 
-00012f60: 636f 6d70 6174 6962 6c65 2077 6974 6820  compatible with 
-00012f70: 5b77 696e 646f 7773 375d 2868 7474 7073  [windows7](https
-00012f80: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-00012f90: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-00012fa0: 2e63 6f6d 2f32 3431 3033 322f 3232 3134  .com/241032/2214
-00012fb0: 3435 3934 342d 6165 3835 6431 6634 2d64  45944-ae85d1f4-d
-00012fc0: 3335 312d 3438 3337 2d62 3133 302d 3832  351-4837-b130-82
-00012fd0: 6361 6235 3764 3663 6361 2e70 6e67 292c  cab57d6cca.png),
-00012fe0: 2077 6869 6368 206d 6561 6e73 2069 7420   which means it 
-00012ff0: 7573 6573 2061 6e20 616e 6369 656e 7420  uses an ancient 
-00013000: 636f 7079 206f 6620 7079 7468 6f6e 2028  copy of python (
-00013010: 332e 372e 3929 2077 6869 6368 2063 616e  3.7.9) which can
-00013020: 6e6f 7420 6265 2075 7067 7261 6465 6420  not be upgraded 
-00013030: 616e 6420 7368 6f75 6c64 206e 6576 6572  and should never
-00013040: 2062 6520 6578 706f 7365 6420 746f 2074   be exposed to t
-00013050: 6865 2069 6e74 6572 6e65 7420 284c 414e  he internet (LAN
-00013060: 2069 7320 6669 6e65 290a 0a2a 2064 616e   is fine)..* dan
-00013070: 6765 726f 7573 2061 6e64 2064 6570 7265  gerous and depre
-00013080: 6361 7465 643a 205b 636f 7079 7061 7274  cated: [copypart
-00013090: 792d 7769 6e70 6536 342e 6578 655d 2868  y-winpe64.exe](h
-000130a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000130b0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-000130c0: 2f72 656c 6561 7365 732f 646f 776e 6c6f  /releases/downlo
-000130d0: 6164 2f76 312e 362e 382f 636f 7079 7061  ad/v1.6.8/copypa
-000130e0: 7274 792d 7769 6e70 6536 342e 6578 6529  rty-winpe64.exe)
-000130f0: 206c 6574 7320 796f 7520 5b72 756e 2063   lets you [run c
-00013100: 6f70 7970 6172 7479 2069 6e20 5769 6e50  opyparty in WinP
-00013110: 455d 2868 7474 7073 3a2f 2f75 7365 722d  E](https://user-
-00013120: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00013130: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-00013140: 3033 322f 3230 3534 3534 3938 342d 6536  032/205454984-e6
-00013150: 6235 3530 6466 2d33 6334 392d 3438 3664  b550df-3c49-486d
-00013160: 2d39 3236 372d 3136 3134 3037 3864 6430  -9267-1614078dd0
-00013170: 6464 2e70 6e67 2920 616e 6420 6973 206f  dd.png) and is o
-00013180: 7468 6572 7769 7365 2063 6f6d 706c 6574  therwise complet
-00013190: 656c 7920 7573 656c 6573 730a 0a6d 6561  ely useless..mea
-000131a0: 6e77 6869 6c65 205b 636f 7079 7061 7274  nwhile [copypart
-000131b0: 792d 7366 782e 7079 5d28 6874 7470 733a  y-sfx.py](https:
-000131c0: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
-000131d0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
-000131e0: 6173 6573 2f6c 6174 6573 742f 646f 776e  ases/latest/down
-000131f0: 6c6f 6164 2f63 6f70 7970 6172 7479 2d73  load/copyparty-s
-00013200: 6678 2e70 7929 2069 6e73 7465 6164 2072  fx.py) instead r
-00013210: 656c 6965 7320 6f6e 2079 6f75 7220 7379  elies on your sy
-00013220: 7374 656d 2070 7974 686f 6e20 7768 6963  stem python whic
-00013230: 6820 6769 7665 7320 6265 7474 6572 2070  h gives better p
-00013240: 6572 666f 726d 616e 6365 2061 6e64 2077  erformance and w
-00013250: 696c 6c20 7374 6179 2073 6166 6520 6173  ill stay safe as
-00013260: 206c 6f6e 6720 6173 2079 6f75 206b 6565   long as you kee
-00013270: 7020 796f 7572 2070 7974 686f 6e20 696e  p your python in
-00013280: 7374 616c 6c20 7570 2d74 6f2d 6461 7465  stall up-to-date
-00013290: 0a0a 7468 656e 2061 6761 696e 2c20 6966  ..then again, if
-000132a0: 2079 6f75 2061 7265 2061 6c72 6561 6479   you are already
-000132b0: 2069 6e74 6f20 646f 776e 6c6f 6164 696e   into downloadin
-000132c0: 6720 7368 6164 7920 6269 6e61 7269 6573  g shady binaries
-000132d0: 2066 726f 6d20 7468 6520 696e 7465 726e   from the intern
-000132e0: 6574 2c20 796f 7520 6d61 7920 616c 736f  et, you may also
-000132f0: 2077 616e 7420 6d79 205b 6d69 6e69 6d61   want my [minima
-00013300: 6c20 6275 696c 6473 5d28 2e2f 7363 7269  l builds](./scri
-00013310: 7074 732f 7079 696e 7374 616c 6c65 7223  pts/pyinstaller#
-00013320: 6666 6d70 6567 2920 6f66 205b 6666 6d70  ffmpeg) of [ffmp
-00013330: 6567 5d28 6874 7470 733a 2f2f 6f63 762e  eg](https://ocv.
-00013340: 6d65 2f73 7475 6666 2f62 696e 2f66 666d  me/stuff/bin/ffm
-00013350: 7065 672e 6578 6529 2061 6e64 205b 6666  peg.exe) and [ff
-00013360: 7072 6f62 655d 2868 7474 7073 3a2f 2f6f  probe](https://o
-00013370: 6376 2e6d 652f 7374 7566 662f 6269 6e2f  cv.me/stuff/bin/
-00013380: 6666 7072 6f62 652e 6578 6529 2077 6869  ffprobe.exe) whi
-00013390: 6368 2065 6e61 626c 6573 2063 6f70 7970  ch enables copyp
-000133a0: 6172 7479 2074 6f20 6578 7472 6163 7420  arty to extract 
-000133b0: 6d75 6c74 696d 6564 6961 2d69 6e66 6f2c  multimedia-info,
-000133c0: 2064 6f20 6175 6469 6f2d 7472 616e 7363   do audio-transc
-000133d0: 6f64 696e 672c 2061 6e64 2074 6875 6d62  oding, and thumb
-000133e0: 6e61 696c 732f 7370 6563 7472 6f67 7261  nails/spectrogra
-000133f0: 6d73 2f77 6176 6566 6f72 6d73 2c20 686f  ms/waveforms, ho
-00013400: 7765 7665 7220 6974 2773 206d 7563 6820  wever it's much 
-00013410: 6265 7474 6572 2074 6f20 696e 7374 6561  better to instea
-00013420: 6420 6772 6162 2061 205b 7265 6365 6e74  d grab a [recent
-00013430: 206f 6666 6963 6961 6c20 6275 696c 645d   official build]
-00013440: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-00013450: 636f 6d2f 4274 624e 2f46 466d 7065 672d  com/BtbN/FFmpeg-
-00013460: 4275 696c 6473 2f72 656c 6561 7365 732f  Builds/releases/
-00013470: 646f 776e 6c6f 6164 2f6c 6174 6573 742f  download/latest/
-00013480: 6666 6d70 6567 2d6d 6173 7465 722d 6c61  ffmpeg-master-la
-00013490: 7465 7374 2d77 696e 3634 2d67 706c 2e7a  test-win64-gpl.z
-000134a0: 6970 2920 6576 6572 7920 6f6e 6365 2069  ip) every once i
-000134b0: 6e61 2077 6869 6c65 2069 6620 796f 7520  na while if you 
-000134c0: 6361 6e20 6166 666f 7264 2074 6865 2073  can afford the s
-000134d0: 697a 650a 0a0a 2320 696e 7374 616c 6c20  ize...# install 
-000134e0: 6f6e 2061 6e64 726f 6964 0a0a 696e 7374  on android..inst
-000134f0: 616c 6c20 5b54 6572 6d75 785d 2868 7474  all [Termux](htt
-00013500: 7073 3a2f 2f74 6572 6d75 782e 636f 6d2f  ps://termux.com/
-00013510: 2920 2b20 6974 7320 636f 6d70 616e 696f  ) + its companio
-00013520: 6e20 6170 7020 6054 6572 6d75 783a 4150  n app `Termux:AP
-00013530: 4960 2028 7365 6520 5b6f 6376 2e6d 652f  I` (see [ocv.me/
-00013540: 7465 726d 7578 5d28 6874 7470 733a 2f2f  termux](https://
-00013550: 6f63 762e 6d65 2f74 6572 6d75 782f 2929  ocv.me/termux/))
-00013560: 2061 6e64 2074 6865 6e20 636f 7079 2d70   and then copy-p
-00013570: 6173 7465 2074 6869 7320 696e 746f 2054  aste this into T
-00013580: 6572 6d75 7820 286c 6f6e 672d 7461 7029  ermux (long-tap)
-00013590: 2061 6c6c 2061 7420 6f6e 6365 3a0a 6060   all at once:.``
-000135a0: 6073 680a 7965 7320 7c20 706b 6720 7570  `sh.yes | pkg up
-000135b0: 6772 6164 6520 2626 2074 6572 6d75 782d  grade && termux-
-000135c0: 7365 7475 702d 7374 6f72 6167 6520 2626  setup-storage &&
-000135d0: 2079 6573 207c 2070 6b67 2069 6e73 7461   yes | pkg insta
-000135e0: 6c6c 2070 7974 686f 6e20 7465 726d 7578  ll python termux
-000135f0: 2d61 7069 2026 2620 7079 7468 6f6e 202d  -api && python -
-00013600: 6d20 656e 7375 7265 7069 7020 2626 2070  m ensurepip && p
-00013610: 7974 686f 6e20 2d6d 2070 6970 2069 6e73  ython -m pip ins
-00013620: 7461 6c6c 202d 2d75 7365 7220 2d55 2063  tall --user -U c
-00013630: 6f70 7970 6172 7479 2026 2620 7b20 6772  opyparty && { gr
-00013640: 6570 202d 7145 2027 5041 5448 3d2e 2a5c  ep -qE 'PATH=.*\
-00013650: 2e6c 6f63 616c 2f62 696e 2720 7e2f 2e62  .local/bin' ~/.b
-00013660: 6173 6872 6320 323e 2f64 6576 2f6e 756c  ashrc 2>/dev/nul
-00013670: 6c20 7c7c 207b 2065 6368 6f20 2750 4154  l || { echo 'PAT
-00013680: 483d 2224 484f 4d45 2f2e 6c6f 6361 6c2f  H="$HOME/.local/
-00013690: 6269 6e3a 2450 4154 4822 2720 3e3e 207e  bin:$PATH"' >> ~
-000136a0: 2f2e 6261 7368 7263 2026 2620 2e20 7e2f  /.bashrc && . ~/
-000136b0: 2e62 6173 6872 633b 207d 3b20 7d0a 6563  .bashrc; }; }.ec
-000136c0: 686f 2024 3f0a 6060 600a 0a61 6674 6572  ho $?.```..after
-000136d0: 2074 6865 2069 6e69 7469 616c 2073 6574   the initial set
-000136e0: 7570 2c20 796f 7520 6361 6e20 6c61 756e  up, you can laun
-000136f0: 6368 2063 6f70 7970 6172 7479 2061 7420  ch copyparty at 
-00013700: 616e 7920 7469 6d65 2062 7920 7275 6e6e  any time by runn
-00013710: 696e 6720 6063 6f70 7970 6172 7479 6020  ing `copyparty` 
-00013720: 616e 7977 6865 7265 2069 6e20 5465 726d  anywhere in Term
-00013730: 7578 202d 2d20 616e 6420 6966 2079 6f75  ux -- and if you
-00013740: 2072 756e 2069 7420 7769 7468 2060 2d2d   run it with `--
-00013750: 7172 6020 796f 7527 6c6c 2067 6574 2061  qr` you'll get a
-00013760: 205b 6e65 6174 2071 722d 636f 6465 5d28   [neat qr-code](
-00013770: 2371 722d 636f 6465 2920 706f 696e 7469  #qr-code) pointi
-00013780: 6e67 2074 6f20 796f 7572 2065 7874 6572  ng to your exter
-00013790: 6e61 6c20 6970 0a0a 6966 2079 6f75 2077  nal ip..if you w
-000137a0: 616e 7420 7468 756d 626e 6169 6c73 2028  ant thumbnails (
-000137b0: 7068 6f74 6f73 2b76 6964 656f 7329 2061  photos+videos) a
-000137c0: 6e64 2079 6f75 2772 6520 6f6b 6179 2077  nd you're okay w
-000137d0: 6974 6820 7370 656e 6469 6e67 2061 6e6f  ith spending ano
-000137e0: 7468 6572 2031 3332 204d 6942 206f 6620  ther 132 MiB of 
-000137f0: 7374 6f72 6167 652c 2060 706b 6720 696e  storage, `pkg in
-00013800: 7374 616c 6c20 6666 6d70 6567 2026 2620  stall ffmpeg && 
-00013810: 7079 7468 6f6e 3320 2d6d 2070 6970 2069  python3 -m pip i
-00013820: 6e73 7461 6c6c 202d 2d75 7365 7220 2d55  nstall --user -U
-00013830: 2070 696c 6c6f 7760 0a0a 2a20 6f72 2069   pillow`..* or i
-00013840: 6620 796f 7520 7761 6e74 2074 6f20 7573  f you want to us
-00013850: 6520 6076 6970 7360 2066 6f72 2070 686f  e `vips` for pho
-00013860: 746f 2d74 6875 6d62 7320 696e 7374 6561  to-thumbs instea
-00013870: 642c 2060 706b 6720 696e 7374 616c 6c20  d, `pkg install 
-00013880: 6c69 6276 6970 7320 2626 2070 7974 686f  libvips && pytho
-00013890: 6e20 2d6d 2070 6970 2069 6e73 7461 6c6c  n -m pip install
-000138a0: 202d 2d75 7365 7220 2d55 2077 6865 656c   --user -U wheel
-000138b0: 2026 2620 7079 7468 6f6e 202d 6d20 7069   && python -m pi
-000138c0: 7020 696e 7374 616c 6c20 2d2d 7573 6572  p install --user
-000138d0: 202d 5520 7079 7669 7073 2026 2620 2863   -U pyvips && (c
-000138e0: 6420 2f64 6174 612f 6461 7461 2f63 6f6d  d /data/data/com
-000138f0: 2e74 6572 6d75 782f 6669 6c65 732f 7573  .termux/files/us
-00013900: 722f 6c69 622f 3b20 6c6e 202d 7320 6c69  r/lib/; ln -s li
-00013910: 6267 6f62 6a65 6374 2d32 2e30 2e73 6f7b  bgobject-2.0.so{
-00013920: 2c2e 307d 3b20 6c6e 202d 7320 6c69 6276  ,.0}; ln -s libv
-00013930: 6970 732e 736f 7b2c 2e34 327d 2960 0a0a  ips.so{,.42})`..
-00013940: 0a23 2072 6570 6f72 7469 6e67 2062 7567  .# reporting bug
-00013950: 730a 0a69 6465 6173 2066 6f72 2063 6f6e  s..ideas for con
-00013960: 7465 7874 2074 6f20 696e 636c 7564 6520  text to include 
-00013970: 696e 2062 7567 2072 6570 6f72 7473 0a0a  in bug reports..
-00013980: 696e 2067 656e 6572 616c 2c20 636f 6d6d  in general, comm
-00013990: 616e 646c 696e 6520 6172 6775 6d65 6e74  andline argument
-000139a0: 7320 2861 6e64 2063 6f6e 6669 6720 6669  s (and config fi
-000139b0: 6c65 2069 6620 616e 7929 0a0a 6966 2073  le if any)..if s
-000139c0: 6f6d 6574 6869 6e67 2062 726f 6b65 2064  omething broke d
-000139d0: 7572 696e 6720 616e 2075 706c 6f61 6420  uring an upload 
-000139e0: 2872 6570 6c61 6369 6e67 2046 494c 454e  (replacing FILEN
-000139f0: 414d 4520 7769 7468 2061 2070 6172 7420  AME with a part 
-00013a00: 6f66 2074 6865 2066 696c 656e 616d 6520  of the filename 
-00013a10: 7468 6174 2062 726f 6b65 293a 0a60 6060  that broke):.```
-00013a20: 0a6a 6f75 726e 616c 6374 6c20 2d61 5320  .journalctl -aS 
-00013a30: 2734 3820 686f 7572 2061 676f 2720 2d75  '48 hour ago' -u
-00013a40: 2063 6f70 7970 6172 7479 207c 2067 7265   copyparty | gre
-00013a50: 7020 2d43 3130 2046 494c 454e 414d 4520  p -C10 FILENAME 
-00013a60: 7c20 7465 6520 6275 672e 6c6f 670a 6060  | tee bug.log.``
-00013a70: 600a 0a69 6620 7468 6572 6527 7320 6120  `..if there's a 
-00013a80: 7761 6c6c 206f 6620 6261 7365 3634 2069  wall of base64 i
-00013a90: 6e20 7468 6520 6c6f 6720 2874 6872 6561  n the log (threa
-00013aa0: 6420 7374 6163 6b73 2920 7468 656e 2070  d stacks) then p
-00013ab0: 6c65 6173 6520 696e 636c 7564 6520 7468  lease include th
-00013ac0: 6174 2c20 6573 7065 6369 616c 6c79 2069  at, especially i
-00013ad0: 6620 796f 7520 7275 6e20 696e 746f 2073  f you run into s
-00013ae0: 6f6d 6574 6869 6e67 2066 7265 657a 696e  omething freezin
-00013af0: 6720 7570 206f 7220 6765 7474 696e 6720  g up or getting 
-00013b00: 7374 7563 6b2c 2066 6f72 2065 7861 6d70  stuck, for examp
-00013b10: 6c65 2060 4f70 6572 6174 696f 6e61 6c45  le `OperationalE
-00013b20: 7272 6f72 2827 6461 7461 6261 7365 2069  rror('database i
-00013b30: 7320 6c6f 636b 6564 2729 6020 2d2d 2061  s locked')` -- a
-00013b40: 6c74 6572 6e61 7469 7665 6c79 2079 6f75  lternatively you
-00013b50: 2063 616e 2076 6973 6974 2060 2f3f 7374   can visit `/?st
-00013b60: 6163 6b60 2074 6f20 7365 6520 7468 6520  ack` to see the 
-00013b70: 7374 6163 6b73 206c 6976 652c 2073 6f20  stacks live, so 
-00013b80: 6874 7470 3a2f 2f31 3237 2e30 2e30 2e31  http://127.0.0.1
-00013b90: 3a33 3932 332f 3f73 7461 636b 2066 6f72  :3923/?stack for
-00013ba0: 2065 7861 6d70 6c65 0a0a 0a23 2064 6576   example...# dev
-00013bb0: 6e6f 7465 730a 0a66 6f72 2062 7569 6c64  notes..for build
-00013bc0: 2069 6e73 7472 7563 7469 6f6e 7320 6574   instructions et
-00013bd0: 632c 2073 6565 205b 2e2f 646f 6373 2f64  c, see [./docs/d
-00013be0: 6576 6e6f 7465 732e 6d64 5d28 2e2f 646f  evnotes.md](./do
-00013bf0: 6373 2f64 6576 6e6f 7465 732e 6d64 290a  cs/devnotes.md).
+00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
+00000010: 3a20 322e 310a 4e61 6d65 3a20 636f 7079  : 2.1.Name: copy
+00000020: 7061 7274 790a 5665 7273 696f 6e3a 2031  party.Version: 1
+00000030: 2e37 2e30 0a53 756d 6d61 7279 3a20 506f  .7.0.Summary: Po
+00000040: 7274 6162 6c65 2066 696c 6520 7365 7276  rtable file serv
+00000050: 6572 2077 6974 6820 6163 6365 6c65 7261  er with accelera
+00000060: 7465 6420 7265 7375 6d61 626c 6520 7570  ted resumable up
+00000070: 6c6f 6164 732c 2064 6564 7570 6c69 6361  loads, deduplica
+00000080: 7469 6f6e 2c20 5765 6244 4156 2c20 4654  tion, WebDAV, FT
+00000090: 502c 207a 6572 6f63 6f6e 662c 206d 6564  P, zeroconf, med
+000000a0: 6961 2069 6e64 6578 6572 2c20 7669 6465  ia indexer, vide
+000000b0: 6f20 7468 756d 626e 6169 6c73 2c20 6175  o thumbnails, au
+000000c0: 6469 6f20 7472 616e 7363 6f64 696e 672c  dio transcoding,
+000000d0: 2061 6e64 2077 7269 7465 2d6f 6e6c 7920   and write-only 
+000000e0: 666f 6c64 6572 730a 486f 6d65 2d70 6167  folders.Home-pag
+000000f0: 653a 2068 7474 7073 3a2f 2f67 6974 6875  e: https://githu
+00000100: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
+00000110: 6172 7479 0a41 7574 686f 723a 2065 640a  arty.Author: ed.
+00000120: 4175 7468 6f72 2d65 6d61 696c 3a20 636f  Author-email: co
+00000130: 7079 7061 7274 7940 6f63 762e 6d65 0a4c  pyparty@ocv.me.L
+00000140: 6963 656e 7365 3a20 4d49 540a 436c 6173  icense: MIT.Clas
+00000150: 7369 6669 6572 3a20 4465 7665 6c6f 706d  sifier: Developm
+00000160: 656e 7420 5374 6174 7573 203a 3a20 3520  ent Status :: 5 
+00000170: 2d20 5072 6f64 7563 7469 6f6e 2f53 7461  - Production/Sta
+00000180: 626c 650a 436c 6173 7369 6669 6572 3a20  ble.Classifier: 
+00000190: 4c69 6365 6e73 6520 3a3a 204f 5349 2041  License :: OSI A
+000001a0: 7070 726f 7665 6420 3a3a 204d 4954 204c  pproved :: MIT L
+000001b0: 6963 656e 7365 0a43 6c61 7373 6966 6965  icense.Classifie
+000001c0: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
+000001d0: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
+000001e0: 6e0a 436c 6173 7369 6669 6572 3a20 5072  n.Classifier: Pr
+000001f0: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
+00000200: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
+00000210: 330a 436c 6173 7369 6669 6572 3a20 5072  3.Classifier: Pr
+00000220: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
+00000230: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
+00000240: 332e 330a 436c 6173 7369 6669 6572 3a20  3.3.Classifier: 
+00000250: 5072 6f67 7261 6d6d 696e 6720 4c61 6e67  Programming Lang
+00000260: 7561 6765 203a 3a20 5079 7468 6f6e 203a  uage :: Python :
+00000270: 3a20 332e 340a 436c 6173 7369 6669 6572  : 3.4.Classifier
+00000280: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
+00000290: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+000002a0: 203a 3a20 332e 350a 436c 6173 7369 6669   :: 3.5.Classifi
+000002b0: 6572 3a20 5072 6f67 7261 6d6d 696e 6720  er: Programming 
+000002c0: 4c61 6e67 7561 6765 203a 3a20 5079 7468  Language :: Pyth
+000002d0: 6f6e 203a 3a20 332e 360a 436c 6173 7369  on :: 3.6.Classi
+000002e0: 6669 6572 3a20 5072 6f67 7261 6d6d 696e  fier: Programmin
+000002f0: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
+00000300: 7468 6f6e 203a 3a20 332e 370a 436c 6173  thon :: 3.7.Clas
+00000310: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
+00000320: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
+00000330: 5079 7468 6f6e 203a 3a20 332e 380a 436c  Python :: 3.8.Cl
+00000340: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
+00000350: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
+00000360: 3a20 5079 7468 6f6e 203a 3a20 332e 390a  : Python :: 3.9.
+00000370: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
+00000380: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
+00000390: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
+000003a0: 3130 0a43 6c61 7373 6966 6965 723a 2050  10.Classifier: P
+000003b0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
+000003c0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
+000003d0: 2033 2e31 310a 436c 6173 7369 6669 6572   3.11.Classifier
+000003e0: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
+000003f0: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
+00000400: 203a 3a20 332e 3132 0a43 6c61 7373 6966   :: 3.12.Classif
+00000410: 6965 723a 2050 726f 6772 616d 6d69 6e67  ier: Programming
+00000420: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
+00000430: 686f 6e20 3a3a 2049 6d70 6c65 6d65 6e74  hon :: Implement
+00000440: 6174 696f 6e20 3a3a 2043 5079 7468 6f6e  ation :: CPython
+00000450: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
+00000460: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
+00000470: 6520 3a3a 2050 7974 686f 6e20 3a3a 2049  e :: Python :: I
+00000480: 6d70 6c65 6d65 6e74 6174 696f 6e20 3a3a  mplementation ::
+00000490: 204a 7974 686f 6e0a 436c 6173 7369 6669   Jython.Classifi
+000004a0: 6572 3a20 5072 6f67 7261 6d6d 696e 6720  er: Programming 
+000004b0: 4c61 6e67 7561 6765 203a 3a20 5079 7468  Language :: Pyth
+000004c0: 6f6e 203a 3a20 496d 706c 656d 656e 7461  on :: Implementa
+000004d0: 7469 6f6e 203a 3a20 5079 5079 0a43 6c61  tion :: PyPy.Cla
+000004e0: 7373 6966 6965 723a 2045 6e76 6972 6f6e  ssifier: Environ
+000004f0: 6d65 6e74 203a 3a20 436f 6e73 6f6c 650a  ment :: Console.
+00000500: 436c 6173 7369 6669 6572 3a20 456e 7669  Classifier: Envi
+00000510: 726f 6e6d 656e 7420 3a3a 204e 6f20 496e  ronment :: No In
+00000520: 7075 742f 4f75 7470 7574 2028 4461 656d  put/Output (Daem
+00000530: 6f6e 290a 436c 6173 7369 6669 6572 3a20  on).Classifier: 
+00000540: 496e 7465 6e64 6564 2041 7564 6965 6e63  Intended Audienc
+00000550: 6520 3a3a 2045 6e64 2055 7365 7273 2f44  e :: End Users/D
+00000560: 6573 6b74 6f70 0a43 6c61 7373 6966 6965  esktop.Classifie
+00000570: 723a 2049 6e74 656e 6465 6420 4175 6469  r: Intended Audi
+00000580: 656e 6365 203a 3a20 5379 7374 656d 2041  ence :: System A
+00000590: 646d 696e 6973 7472 6174 6f72 730a 436c  dministrators.Cl
+000005a0: 6173 7369 6669 6572 3a20 546f 7069 6320  assifier: Topic 
+000005b0: 3a3a 2043 6f6d 6d75 6e69 6361 7469 6f6e  :: Communication
+000005c0: 7320 3a3a 2046 696c 6520 5368 6172 696e  s :: File Sharin
+000005d0: 670a 436c 6173 7369 6669 6572 3a20 546f  g.Classifier: To
+000005e0: 7069 6320 3a3a 2049 6e74 6572 6e65 7420  pic :: Internet 
+000005f0: 3a3a 2046 696c 6520 5472 616e 7366 6572  :: File Transfer
+00000600: 2050 726f 746f 636f 6c20 2846 5450 290a   Protocol (FTP).
+00000610: 436c 6173 7369 6669 6572 3a20 546f 7069  Classifier: Topi
+00000620: 6320 3a3a 2049 6e74 6572 6e65 7420 3a3a  c :: Internet ::
+00000630: 2057 5757 2f48 5454 5020 3a3a 2048 5454   WWW/HTTP :: HTT
+00000640: 5020 5365 7276 6572 730a 4465 7363 7269  P Servers.Descri
+00000650: 7074 696f 6e2d 436f 6e74 656e 742d 5479  ption-Content-Ty
+00000660: 7065 3a20 7465 7874 2f6d 6172 6b64 6f77  pe: text/markdow
+00000670: 6e0a 5072 6f76 6964 6573 2d45 7874 7261  n.Provides-Extra
+00000680: 3a20 7468 756d 626e 6169 6c73 0a50 726f  : thumbnails.Pro
+00000690: 7669 6465 732d 4578 7472 613a 2074 6875  vides-Extra: thu
+000006a0: 6d62 6e61 696c 7332 0a50 726f 7669 6465  mbnails2.Provide
+000006b0: 732d 4578 7472 613a 2061 7564 696f 7461  s-Extra: audiota
+000006c0: 6773 0a50 726f 7669 6465 732d 4578 7472  gs.Provides-Extr
+000006d0: 613a 2066 7470 640a 5072 6f76 6964 6573  a: ftpd.Provides
+000006e0: 2d45 7874 7261 3a20 6674 7073 0a4c 6963  -Extra: ftps.Lic
+000006f0: 656e 7365 2d46 696c 653a 204c 4943 454e  ense-File: LICEN
+00000700: 5345 0a0a 2320 f09f 92be f09f 8e89 2063  SE..# ........ c
+00000710: 6f70 7970 6172 7479 0a0a 7475 726e 2061  opyparty..turn a
+00000720: 6c6d 6f73 7420 616e 7920 6465 7669 6365  lmost any device
+00000730: 2069 6e74 6f20 6120 6669 6c65 2073 6572   into a file ser
+00000740: 7665 7220 7769 7468 2072 6573 756d 6162  ver with resumab
+00000750: 6c65 2075 706c 6f61 6473 2f64 6f77 6e6c  le uploads/downl
+00000760: 6f61 6473 2075 7369 6e67 205b 2a61 6e79  oads using [*any
+00000770: 2a5d 2823 6272 6f77 7365 722d 7375 7070  *](#browser-supp
+00000780: 6f72 7429 2077 6562 2062 726f 7773 6572  ort) web browser
+00000790: 0a0a 2a20 7365 7276 6572 206f 6e6c 7920  ..* server only 
+000007a0: 6e65 6564 7320 5079 7468 6f6e 2028 3220  needs Python (2 
+000007b0: 6f72 2033 292c 2061 6c6c 2064 6570 656e  or 3), all depen
+000007c0: 6465 6e63 6965 7320 6f70 7469 6f6e 616c  dencies optional
+000007d0: 0a2a 20f0 9f94 8c20 7072 6f74 6f63 6f6c  .* .... protocol
+000007e0: 733a 205b 6874 7470 5d28 2374 6865 2d62  s: [http](#the-b
+000007f0: 726f 7773 6572 2920 2f2f 205b 6674 705d  rowser) // [ftp]
+00000800: 2823 6674 702d 7365 7276 6572 2920 2f2f  (#ftp-server) //
+00000810: 205b 7765 6264 6176 5d28 2377 6562 6461   [webdav](#webda
+00000820: 762d 7365 7276 6572 2920 2f2f 205b 736d  v-server) // [sm
+00000830: 622f 6369 6673 5d28 2373 6d62 2d73 6572  b/cifs](#smb-ser
+00000840: 7665 7229 0a2a 20f0 9f93 b120 5b61 6e64  ver).* .... [and
+00000850: 726f 6964 2061 7070 5d28 2361 6e64 726f  roid app](#andro
+00000860: 6964 2d61 7070 2920 2f2f 205b 6950 686f  id-app) // [iPho
+00000870: 6e65 2073 686f 7274 6375 7473 5d28 2369  ne shortcuts](#i
+00000880: 6f73 2d73 686f 7274 6375 7473 290a 0af0  os-shortcuts)...
+00000890: 9f91 8920 2a2a 5b47 6574 2073 7461 7274  ... **[Get start
+000008a0: 6564 5d28 2371 7569 636b 7374 6172 7429  ed](#quickstart)
+000008b0: 212a 2a20 6f72 2076 6973 6974 2074 6865  !** or visit the
+000008c0: 202a 2a5b 7265 6164 2d6f 6e6c 7920 6465   **[read-only de
+000008d0: 6d6f 2073 6572 7665 725d 2868 7474 7073  mo server](https
+000008e0: 3a2f 2f61 2e6f 6376 2e6d 652f 7075 622f  ://a.ocv.me/pub/
+000008f0: 6465 6d6f 2f29 2a2a 20f0 9f91 8020 7275  demo/)** .... ru
+00000900: 6e6e 696e 6720 6672 6f6d 2061 2062 6173  nning from a bas
+00000910: 656d 656e 7420 696e 2066 696e 6c61 6e64  ement in finland
+00000920: 0a0a f09f 93b7 202a 2a73 6372 6565 6e73  ...... **screens
+00000930: 686f 7473 3a2a 2a20 5b62 726f 7773 6572  hots:** [browser
+00000940: 5d28 2374 6865 2d62 726f 7773 6572 2920  ](#the-browser) 
+00000950: 2f2f 205b 7570 6c6f 6164 5d28 2375 706c  // [upload](#upl
+00000960: 6f61 6469 6e67 2920 2f2f 205b 756e 706f  oading) // [unpo
+00000970: 7374 5d28 2375 6e70 6f73 7429 202f 2f20  st](#unpost) // 
+00000980: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+00000990: 756d 626e 6169 6c73 2920 2f2f 205b 7365  umbnails) // [se
+000009a0: 6172 6368 5d28 2373 6561 7263 6869 6e67  arch](#searching
+000009b0: 2920 2f2f 205b 6673 6561 7263 685d 2823  ) // [fsearch](#
+000009c0: 6669 6c65 2d73 6561 7263 6829 202f 2f20  file-search) // 
+000009d0: 5b7a 6970 2d44 4c5d 2823 7a69 702d 646f  [zip-DL](#zip-do
+000009e0: 776e 6c6f 6164 7329 202f 2f20 5b6d 642d  wnloads) // [md-
+000009f0: 7669 6577 6572 5d28 236d 6172 6b64 6f77  viewer](#markdow
+00000a00: 6e2d 7669 6577 6572 290a 0a0a 2323 2072  n-viewer)...## r
+00000a10: 6561 646d 6520 746f 630a 0a2a 2074 6f70  eadme toc..* top
+00000a20: 0a20 2020 202a 205b 7175 6963 6b73 7461  .    * [quicksta
+00000a30: 7274 5d28 2371 7569 636b 7374 6172 7429  rt](#quickstart)
+00000a40: 202d 206a 7573 7420 7275 6e20 2a2a 5b63   - just run **[c
+00000a50: 6f70 7970 6172 7479 2d73 6678 2e70 795d  opyparty-sfx.py]
+00000a60: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00000a70: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00000a80: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00000a90: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00000aa0: 7061 7274 792d 7366 782e 7079 292a 2a20  party-sfx.py)** 
+00000ab0: 2d2d 2074 6861 7427 7320 6974 2120 f09f  -- that's it! ..
+00000ac0: 8e89 0a20 2020 2020 2020 202a 205b 6f6e  ...        * [on
+00000ad0: 2073 6572 7665 7273 5d28 236f 6e2d 7365   servers](#on-se
+00000ae0: 7276 6572 7329 202d 2079 6f75 206d 6179  rvers) - you may
+00000af0: 2061 6c73 6f20 7761 6e74 2074 6865 7365   also want these
+00000b00: 2c20 6573 7065 6369 616c 6c79 206f 6e20  , especially on 
+00000b10: 7365 7276 6572 730a 2020 2020 2a20 5b66  servers.    * [f
+00000b20: 6561 7475 7265 735d 2823 6665 6174 7572  eatures](#featur
+00000b30: 6573 290a 2020 2020 2a20 5b74 6573 7469  es).    * [testi
+00000b40: 6d6f 6e69 616c 735d 2823 7465 7374 696d  monials](#testim
+00000b50: 6f6e 6961 6c73 2920 2d20 736d 616c 6c20  onials) - small 
+00000b60: 636f 6c6c 6563 7469 6f6e 206f 6620 7573  collection of us
+00000b70: 6572 2066 6565 6462 6163 6b0a 2a20 5b6d  er feedback.* [m
+00000b80: 6f74 6976 6174 696f 6e73 5d28 236d 6f74  otivations](#mot
+00000b90: 6976 6174 696f 6e73 2920 2d20 7072 6f6a  ivations) - proj
+00000ba0: 6563 7420 676f 616c 7320 2f20 7068 696c  ect goals / phil
+00000bb0: 6f73 6f70 6879 0a20 2020 202a 205b 6e6f  osophy.    * [no
+00000bc0: 7465 735d 2823 6e6f 7465 7329 202d 2067  tes](#notes) - g
+00000bd0: 656e 6572 616c 206e 6f74 6573 0a2a 205b  eneral notes.* [
+00000be0: 6275 6773 5d28 2362 7567 7329 0a20 2020  bugs](#bugs).   
+00000bf0: 202a 205b 6765 6e65 7261 6c20 6275 6773   * [general bugs
+00000c00: 5d28 2367 656e 6572 616c 2d62 7567 7329  ](#general-bugs)
+00000c10: 0a20 2020 202a 205b 6e6f 7420 6d79 2062  .    * [not my b
+00000c20: 7567 735d 2823 6e6f 742d 6d79 2d62 7567  ugs](#not-my-bug
+00000c30: 7329 0a2a 205b 6272 6561 6b69 6e67 2063  s).* [breaking c
+00000c40: 6861 6e67 6573 5d28 2362 7265 616b 696e  hanges](#breakin
+00000c50: 672d 6368 616e 6765 7329 202d 2075 7067  g-changes) - upg
+00000c60: 7261 6465 206e 6f74 6573 0a2a 205b 4641  rade notes.* [FA
+00000c70: 515d 2823 4641 5129 202d 2022 6672 6571  Q](#FAQ) - "freq
+00000c80: 7565 6e74 6c79 2220 6173 6b65 6420 7175  uently" asked qu
+00000c90: 6573 7469 6f6e 730a 2a20 5b61 6363 6f75  estions.* [accou
+00000ca0: 6e74 7320 616e 6420 766f 6c75 6d65 735d  nts and volumes]
+00000cb0: 2823 6163 636f 756e 7473 2d61 6e64 2d76  (#accounts-and-v
+00000cc0: 6f6c 756d 6573 2920 2d20 7065 722d 666f  olumes) - per-fo
+00000cd0: 6c64 6572 2c20 7065 722d 7573 6572 2070  lder, per-user p
+00000ce0: 6572 6d69 7373 696f 6e73 0a20 2020 202a  ermissions.    *
+00000cf0: 205b 7368 6164 6f77 696e 675d 2823 7368   [shadowing](#sh
+00000d00: 6164 6f77 696e 6729 202d 2068 6964 696e  adowing) - hidin
+00000d10: 6720 7370 6563 6966 6963 2073 7562 666f  g specific subfo
+00000d20: 6c64 6572 730a 2a20 5b74 6865 2062 726f  lders.* [the bro
+00000d30: 7773 6572 5d28 2374 6865 2d62 726f 7773  wser](#the-brows
+00000d40: 6572 2920 2d20 6163 6365 7373 696e 6720  er) - accessing 
+00000d50: 6120 636f 7079 7061 7274 7920 7365 7276  a copyparty serv
+00000d60: 6572 2075 7369 6e67 2061 2077 6562 2d62  er using a web-b
+00000d70: 726f 7773 6572 0a20 2020 202a 205b 7461  rowser.    * [ta
+00000d80: 6273 5d28 2374 6162 7329 202d 2074 6865  bs](#tabs) - the
+00000d90: 206d 6169 6e20 7461 6273 2069 6e20 7468   main tabs in th
+00000da0: 6520 7569 0a20 2020 202a 205b 686f 746b  e ui.    * [hotk
+00000db0: 6579 735d 2823 686f 746b 6579 7329 202d  eys](#hotkeys) -
+00000dc0: 2074 6865 2062 726f 7773 6572 2068 6173   the browser has
+00000dd0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2068   the following h
+00000de0: 6f74 6b65 7973 0a20 2020 202a 205b 6e61  otkeys.    * [na
+00000df0: 7670 616e 655d 2823 6e61 7670 616e 6529  vpane](#navpane)
+00000e00: 202d 2073 7769 7463 6869 6e67 2062 6574   - switching bet
+00000e10: 7765 656e 2062 7265 6164 6372 756d 6273  ween breadcrumbs
+00000e20: 206f 7220 6e61 7670 616e 650a 2020 2020   or navpane.    
+00000e30: 2a20 5b74 6875 6d62 6e61 696c 735d 2823  * [thumbnails](#
+00000e40: 7468 756d 626e 6169 6c73 2920 2d20 7072  thumbnails) - pr
+00000e50: 6573 7320 6067 6020 6f72 2060 e794 b060  ess `g` or `...`
+00000e60: 2074 6f20 746f 6767 6c65 2067 7269 642d   to toggle grid-
+00000e70: 7669 6577 2069 6e73 7465 6164 206f 6620  view instead of 
+00000e80: 7468 6520 6669 6c65 206c 6973 7469 6e67  the file listing
+00000e90: 0a20 2020 202a 205b 7a69 7020 646f 776e  .    * [zip down
+00000ea0: 6c6f 6164 735d 2823 7a69 702d 646f 776e  loads](#zip-down
+00000eb0: 6c6f 6164 7329 202d 2064 6f77 6e6c 6f61  loads) - downloa
+00000ec0: 6420 666f 6c64 6572 7320 286f 7220 6669  d folders (or fi
+00000ed0: 6c65 2073 656c 6563 7469 6f6e 7329 2061  le selections) a
+00000ee0: 7320 607a 6970 6020 6f72 2060 7461 7260  s `zip` or `tar`
+00000ef0: 2066 696c 6573 0a20 2020 202a 205b 7570   files.    * [up
+00000f00: 6c6f 6164 696e 675d 2823 7570 6c6f 6164  loading](#upload
+00000f10: 696e 6729 202d 2064 7261 6720 6669 6c65  ing) - drag file
+00000f20: 732f 666f 6c64 6572 7320 696e 746f 2074  s/folders into t
+00000f30: 6865 2077 6562 2d62 726f 7773 6572 2074  he web-browser t
+00000f40: 6f20 7570 6c6f 6164 0a20 2020 2020 2020  o upload.       
+00000f50: 202a 205b 6669 6c65 2d73 6561 7263 685d   * [file-search]
+00000f60: 2823 6669 6c65 2d73 6561 7263 6829 202d  (#file-search) -
+00000f70: 2064 726f 7070 696e 6720 6669 6c65 7320   dropping files 
+00000f80: 696e 746f 2074 6865 2062 726f 7773 6572  into the browser
+00000f90: 2061 6c73 6f20 6c65 7473 2079 6f75 2073   also lets you s
+00000fa0: 6565 2069 6620 7468 6579 2065 7869 7374  ee if they exist
+00000fb0: 206f 6e20 7468 6520 7365 7276 6572 0a20   on the server. 
+00000fc0: 2020 2020 2020 202a 205b 756e 706f 7374         * [unpost
+00000fd0: 5d28 2375 6e70 6f73 7429 202d 2075 6e64  ](#unpost) - und
+00000fe0: 6f2f 6465 6c65 7465 2061 6363 6964 656e  o/delete acciden
+00000ff0: 7461 6c20 7570 6c6f 6164 730a 2020 2020  tal uploads.    
+00001000: 2020 2020 2a20 5b73 656c 662d 6465 7374      * [self-dest
+00001010: 7275 6374 5d28 2373 656c 662d 6465 7374  ruct](#self-dest
+00001020: 7275 6374 2920 2d20 7570 6c6f 6164 7320  ruct) - uploads 
+00001030: 6361 6e20 6265 2067 6976 656e 2061 206c  can be given a l
+00001040: 6966 6574 696d 650a 2020 2020 2a20 5b66  ifetime.    * [f
+00001050: 696c 6520 6d61 6e61 6765 725d 2823 6669  ile manager](#fi
+00001060: 6c65 2d6d 616e 6167 6572 2920 2d20 6375  le-manager) - cu
+00001070: 742f 7061 7374 652c 2072 656e 616d 652c  t/paste, rename,
+00001080: 2061 6e64 2064 656c 6574 6520 6669 6c65   and delete file
+00001090: 732f 666f 6c64 6572 7320 2869 6620 796f  s/folders (if yo
+000010a0: 7520 6861 7665 2070 6572 6d69 7373 696f  u have permissio
+000010b0: 6e29 0a20 2020 202a 205b 6261 7463 6820  n).    * [batch 
+000010c0: 7265 6e61 6d65 5d28 2362 6174 6368 2d72  rename](#batch-r
+000010d0: 656e 616d 6529 202d 2073 656c 6563 7420  ename) - select 
+000010e0: 736f 6d65 2066 696c 6573 2061 6e64 2070  some files and p
+000010f0: 7265 7373 2060 4632 6020 746f 2062 7269  ress `F2` to bri
+00001100: 6e67 2075 7020 7468 6520 7265 6e61 6d65  ng up the rename
+00001110: 2055 490a 2020 2020 2a20 5b6d 6564 6961   UI.    * [media
+00001120: 2070 6c61 7965 725d 2823 6d65 6469 612d   player](#media-
+00001130: 706c 6179 6572 2920 2d20 706c 6179 7320  player) - plays 
+00001140: 616c 6d6f 7374 2065 7665 7279 2061 7564  almost every aud
+00001150: 696f 2066 6f72 6d61 7420 7468 6572 6520  io format there 
+00001160: 6973 0a20 2020 2020 2020 202a 205b 6175  is.        * [au
+00001170: 6469 6f20 6571 7561 6c69 7a65 725d 2823  dio equalizer](#
+00001180: 6175 6469 6f2d 6571 7561 6c69 7a65 7229  audio-equalizer)
+00001190: 202d 2062 6173 7320 626f 6f73 7465 640a   - bass boosted.
+000011a0: 2020 2020 2020 2020 2a20 5b66 6978 2075          * [fix u
+000011b0: 6e72 656c 6961 626c 6520 706c 6179 6261  nreliable playba
+000011c0: 636b 206f 6e20 616e 6472 6f69 645d 2823  ck on android](#
+000011d0: 6669 782d 756e 7265 6c69 6162 6c65 2d70  fix-unreliable-p
+000011e0: 6c61 7962 6163 6b2d 6f6e 2d61 6e64 726f  layback-on-andro
+000011f0: 6964 2920 2d20 6475 6520 746f 2070 686f  id) - due to pho
+00001200: 6e65 202f 2061 7070 2073 6574 7469 6e67  ne / app setting
+00001210: 730a 2020 2020 2a20 5b6d 6172 6b64 6f77  s.    * [markdow
+00001220: 6e20 7669 6577 6572 5d28 236d 6172 6b64  n viewer](#markd
+00001230: 6f77 6e2d 7669 6577 6572 2920 2d20 616e  own-viewer) - an
+00001240: 6420 7468 6572 6520 6172 6520 2a74 776f  d there are *two
+00001250: 2a20 6564 6974 6f72 730a 2020 2020 2a20  * editors.    * 
+00001260: 5b6f 7468 6572 2074 7269 636b 735d 2823  [other tricks](#
+00001270: 6f74 6865 722d 7472 6963 6b73 290a 2020  other-tricks).  
+00001280: 2020 2a20 5b73 6561 7263 6869 6e67 5d28    * [searching](
+00001290: 2373 6561 7263 6869 6e67 2920 2d20 7365  #searching) - se
+000012a0: 6172 6368 2062 7920 7369 7a65 2c20 6461  arch by size, da
+000012b0: 7465 2c20 7061 7468 2f6e 616d 652c 206d  te, path/name, m
+000012c0: 7033 2d74 6167 732c 202e 2e2e 0a2a 205b  p3-tags, ....* [
+000012d0: 7365 7276 6572 2063 6f6e 6669 675d 2823  server config](#
+000012e0: 7365 7276 6572 2d63 6f6e 6669 6729 202d  server-config) -
+000012f0: 2075 7369 6e67 2061 7267 756d 656e 7473   using arguments
+00001300: 206f 7220 636f 6e66 6967 2066 696c 6573   or config files
+00001310: 2c20 6f72 2061 206d 6978 206f 6620 626f  , or a mix of bo
+00001320: 7468 0a20 2020 202a 205b 7a65 726f 636f  th.    * [zeroco
+00001330: 6e66 5d28 237a 6572 6f63 6f6e 6629 202d  nf](#zeroconf) -
+00001340: 2061 6e6e 6f75 6e63 6520 656e 6162 6c65   announce enable
+00001350: 6420 7365 7276 6963 6573 206f 6e20 7468  d services on th
+00001360: 6520 4c41 4e20 285b 7069 635d 2868 7474  e LAN ([pic](htt
+00001370: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00001380: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00001390: 6e74 2e63 6f6d 2f32 3431 3033 322f 3231  nt.com/241032/21
+000013a0: 3533 3434 3733 372d 3065 6165 3864 3938  5344737-0eae8d98
+000013b0: 2d39 3439 362d 3432 3536 2d39 6161 382d  -9496-4256-9aa8-
+000013c0: 6364 3266 3639 3731 3831 3064 2e70 6e67  cd2f6971810d.png
+000013d0: 2929 0a20 2020 2020 2020 202a 205b 6d64  )).        * [md
+000013e0: 6e73 5d28 236d 646e 7329 202d 204c 414e  ns](#mdns) - LAN
+000013f0: 2064 6f6d 6169 6e2d 6e61 6d65 2061 6e64   domain-name and
+00001400: 2066 6561 7475 7265 2061 6e6e 6f75 6e63   feature announc
+00001410: 6572 0a20 2020 2020 2020 202a 205b 7373  er.        * [ss
+00001420: 6470 5d28 2373 7364 7029 202d 2077 696e  dp](#ssdp) - win
+00001430: 646f 7773 2d65 7870 6c6f 7265 7220 616e  dows-explorer an
+00001440: 6e6f 756e 6365 720a 2020 2020 2a20 5b71  nouncer.    * [q
+00001450: 722d 636f 6465 5d28 2371 722d 636f 6465  r-code](#qr-code
+00001460: 2920 2d20 7072 696e 7420 6120 7172 2d63  ) - print a qr-c
+00001470: 6f64 6520 5b28 7363 7265 656e 7368 6f74  ode [(screenshot
+00001480: 295d 2868 7474 7073 3a2f 2f75 7365 722d  )](https://user-
+00001490: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+000014a0: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+000014b0: 3033 322f 3139 3437 3238 3533 332d 3666  032/194728533-6f
+000014c0: 3030 3834 3962 2d63 3661 632d 3433 6336  00849b-c6ac-43c6
+000014d0: 2d39 3335 392d 3833 6534 3534 6431 3165  -9359-83e454d11e
+000014e0: 3030 2e70 6e67 2920 666f 7220 7175 6963  00.png) for quic
+000014f0: 6b20 6163 6365 7373 0a20 2020 202a 205b  k access.    * [
+00001500: 6674 7020 7365 7276 6572 5d28 2366 7470  ftp server](#ftp
+00001510: 2d73 6572 7665 7229 202d 2061 6e20 4654  -server) - an FT
+00001520: 5020 7365 7276 6572 2063 616e 2062 6520  P server can be 
+00001530: 7374 6172 7465 6420 7573 696e 6720 602d  started using `-
+00001540: 2d66 7470 2033 3932 3160 0a20 2020 202a  -ftp 3921`.    *
+00001550: 205b 7765 6264 6176 2073 6572 7665 725d   [webdav server]
+00001560: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
+00001570: 202d 2077 6974 6820 7265 6164 2d77 7269   - with read-wri
+00001580: 7465 2073 7570 706f 7274 0a20 2020 2020  te support.     
+00001590: 2020 202a 205b 636f 6e6e 6563 7469 6e67     * [connecting
+000015a0: 2074 6f20 7765 6264 6176 2066 726f 6d20   to webdav from 
+000015b0: 7769 6e64 6f77 735d 2823 636f 6e6e 6563  windows](#connec
+000015c0: 7469 6e67 2d74 6f2d 7765 6264 6176 2d66  ting-to-webdav-f
+000015d0: 726f 6d2d 7769 6e64 6f77 7329 202d 2075  rom-windows) - u
+000015e0: 7369 6e67 2074 6865 2047 5549 0a20 2020  sing the GUI.   
+000015f0: 202a 205b 736d 6220 7365 7276 6572 5d28   * [smb server](
+00001600: 2373 6d62 2d73 6572 7665 7229 202d 2075  #smb-server) - u
+00001610: 6e73 6166 652c 2073 6c6f 772c 206e 6f74  nsafe, slow, not
+00001620: 2072 6563 6f6d 6d65 6e64 6564 2066 6f72   recommended for
+00001630: 2077 616e 0a20 2020 202a 205b 6669 6c65   wan.    * [file
+00001640: 2069 6e64 6578 696e 675d 2823 6669 6c65   indexing](#file
+00001650: 2d69 6e64 6578 696e 6729 202d 2065 6e61  -indexing) - ena
+00001660: 626c 6573 2064 6564 7570 2061 6e64 206d  bles dedup and m
+00001670: 7573 6963 2073 6561 7263 6820 2b2b 0a20  usic search ++. 
+00001680: 2020 2020 2020 202a 205b 6578 636c 7564         * [exclud
+00001690: 652d 7061 7474 6572 6e73 5d28 2365 7863  e-patterns](#exc
+000016a0: 6c75 6465 2d70 6174 7465 726e 7329 202d  lude-patterns) -
+000016b0: 2074 6f20 7361 7665 2073 6f6d 6520 7469   to save some ti
+000016c0: 6d65 0a20 2020 2020 2020 202a 205b 6669  me.        * [fi
+000016d0: 6c65 7379 7374 656d 2067 7561 7264 735d  lesystem guards]
+000016e0: 2823 6669 6c65 7379 7374 656d 2d67 7561  (#filesystem-gua
+000016f0: 7264 7329 202d 2061 766f 6964 2074 7261  rds) - avoid tra
+00001700: 7665 7273 696e 6720 696e 746f 206f 7468  versing into oth
+00001710: 6572 2066 696c 6573 7973 7465 6d73 0a20  er filesystems. 
+00001720: 2020 2020 2020 202a 205b 7065 7269 6f64         * [period
+00001730: 6963 2072 6573 6361 6e5d 2823 7065 7269  ic rescan](#peri
+00001740: 6f64 6963 2d72 6573 6361 6e29 202d 2066  odic-rescan) - f
+00001750: 696c 6573 7973 7465 6d20 6d6f 6e69 746f  ilesystem monito
+00001760: 7269 6e67 0a20 2020 202a 205b 7570 6c6f  ring.    * [uplo
+00001770: 6164 2072 756c 6573 5d28 2375 706c 6f61  ad rules](#uploa
+00001780: 642d 7275 6c65 7329 202d 2073 6574 2075  d-rules) - set u
+00001790: 706c 6f61 6420 7275 6c65 7320 7573 696e  pload rules usin
+000017a0: 6720 766f 6c66 6c61 6773 0a20 2020 202a  g volflags.    *
+000017b0: 205b 636f 6d70 7265 7373 2075 706c 6f61   [compress uploa
+000017c0: 6473 5d28 2363 6f6d 7072 6573 732d 7570  ds](#compress-up
+000017d0: 6c6f 6164 7329 202d 2066 696c 6573 2063  loads) - files c
+000017e0: 616e 2062 6520 6175 746f 636f 6d70 7265  an be autocompre
+000017f0: 7373 6564 206f 6e20 7570 6c6f 6164 0a20  ssed on upload. 
+00001800: 2020 202a 205b 6f74 6865 7220 666c 6167     * [other flag
+00001810: 735d 2823 6f74 6865 722d 666c 6167 7329  s](#other-flags)
+00001820: 0a20 2020 202a 205b 6461 7461 6261 7365  .    * [database
+00001830: 206c 6f63 6174 696f 6e5d 2823 6461 7461   location](#data
+00001840: 6261 7365 2d6c 6f63 6174 696f 6e29 202d  base-location) -
+00001850: 2069 6e2d 766f 6c75 6d65 2028 602e 6869   in-volume (`.hi
+00001860: 7374 2f75 7032 6b2e 6462 602c 2064 6566  st/up2k.db`, def
+00001870: 6175 6c74 2920 6f72 2073 6f6d 6577 6865  ault) or somewhe
+00001880: 7265 2065 6c73 650a 2020 2020 2a20 5b6d  re else.    * [m
+00001890: 6574 6164 6174 6120 6672 6f6d 2061 7564  etadata from aud
+000018a0: 696f 2066 696c 6573 5d28 236d 6574 6164  io files](#metad
+000018b0: 6174 612d 6672 6f6d 2d61 7564 696f 2d66  ata-from-audio-f
+000018c0: 696c 6573 2920 2d20 7365 7420 602d 6532  iles) - set `-e2
+000018d0: 7460 2074 6f20 696e 6465 7820 7461 6773  t` to index tags
+000018e0: 206f 6e20 7570 6c6f 6164 0a20 2020 202a   on upload.    *
+000018f0: 205b 6669 6c65 2070 6172 7365 7220 706c   [file parser pl
+00001900: 7567 696e 735d 2823 6669 6c65 2d70 6172  ugins](#file-par
+00001910: 7365 722d 706c 7567 696e 7329 202d 2070  ser-plugins) - p
+00001920: 726f 7669 6465 2063 7573 746f 6d20 7061  rovide custom pa
+00001930: 7273 6572 7320 746f 2069 6e64 6578 2061  rsers to index a
+00001940: 6464 6974 696f 6e61 6c20 7461 6773 0a20  dditional tags. 
+00001950: 2020 202a 205b 6576 656e 7420 686f 6f6b     * [event hook
+00001960: 735d 2823 6576 656e 742d 686f 6f6b 7329  s](#event-hooks)
+00001970: 202d 2074 7269 6767 6572 2061 2070 726f   - trigger a pro
+00001980: 6772 616d 206f 6e20 7570 6c6f 6164 732c  gram on uploads,
+00001990: 2072 656e 616d 6573 2065 7463 2028 5b65   renames etc ([e
+000019a0: 7861 6d70 6c65 735d 282e 2f62 696e 2f68  xamples](./bin/h
+000019b0: 6f6f 6b73 2f29 290a 2020 2020 2020 2020  ooks/)).        
+000019c0: 2a20 5b75 706c 6f61 6420 6576 656e 7473  * [upload events
+000019d0: 5d28 2375 706c 6f61 642d 6576 656e 7473  ](#upload-events
+000019e0: 2920 2d20 7468 6520 6f6c 6465 722c 206d  ) - the older, m
+000019f0: 6f72 6520 706f 7765 7266 756c 2061 7070  ore powerful app
+00001a00: 726f 6163 6820 285b 6578 616d 706c 6573  roach ([examples
+00001a10: 5d28 2e2f 6269 6e2f 6d74 6167 2f29 290a  ](./bin/mtag/)).
+00001a20: 2020 2020 2a20 5b68 6964 696e 6720 6672      * [hiding fr
+00001a30: 6f6d 2067 6f6f 676c 655d 2823 6869 6469  om google](#hidi
+00001a40: 6e67 2d66 726f 6d2d 676f 6f67 6c65 2920  ng-from-google) 
+00001a50: 2d20 7465 6c6c 2073 6561 7263 6820 656e  - tell search en
+00001a60: 6769 6e65 7320 796f 7520 646f 6e74 2077  gines you dont w
+00001a70: 616e 6e61 2062 6520 696e 6465 7865 640a  anna be indexed.
+00001a80: 2020 2020 2a20 5b74 6865 6d65 735d 2823      * [themes](#
+00001a90: 7468 656d 6573 290a 2020 2020 2a20 5b63  themes).    * [c
+00001aa0: 6f6d 706c 6574 6520 6578 616d 706c 6573  omplete examples
+00001ab0: 5d28 2363 6f6d 706c 6574 652d 6578 616d  ](#complete-exam
+00001ac0: 706c 6573 290a 2020 2020 2a20 5b72 6576  ples).    * [rev
+00001ad0: 6572 7365 2d70 726f 7879 5d28 2372 6576  erse-proxy](#rev
+00001ae0: 6572 7365 2d70 726f 7879 2920 2d20 7275  erse-proxy) - ru
+00001af0: 6e6e 696e 6720 636f 7079 7061 7274 7920  nning copyparty 
+00001b00: 6e65 7874 2074 6f20 6f74 6865 7220 7765  next to other we
+00001b10: 6273 6974 6573 0a2a 205b 7061 636b 6167  bsites.* [packag
+00001b20: 6573 5d28 2370 6163 6b61 6765 7329 202d  es](#packages) -
+00001b30: 2074 6865 2070 6172 7479 206d 6967 6874   the party might
+00001b40: 2062 6520 636c 6f73 6572 2074 6861 6e20   be closer than 
+00001b50: 796f 7520 7468 696e 6b0a 2020 2020 2a20  you think.    * 
+00001b60: 5b61 7263 6820 7061 636b 6167 655d 2823  [arch package](#
+00001b70: 6172 6368 2d70 6163 6b61 6765 2920 2d20  arch-package) - 
+00001b80: 6e6f 7720 5b61 7661 696c 6162 6c65 206f  now [available o
+00001b90: 6e20 6175 725d 2868 7474 7073 3a2f 2f61  n aur](https://a
+00001ba0: 7572 2e61 7263 686c 696e 7578 2e6f 7267  ur.archlinux.org
+00001bb0: 2f70 6163 6b61 6765 732f 636f 7079 7061  /packages/copypa
+00001bc0: 7274 7929 206d 6169 6e74 6169 6e65 6420  rty) maintained 
+00001bd0: 6279 205b 4069 6378 6573 5d28 6874 7470  by [@icxes](http
+00001be0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f69  s://github.com/i
+00001bf0: 6378 6573 290a 2020 2020 2a20 5b6e 6978  cxes).    * [nix
+00001c00: 2070 6163 6b61 6765 5d28 236e 6978 2d70   package](#nix-p
+00001c10: 6163 6b61 6765 2920 2d20 606e 6978 2070  ackage) - `nix p
+00001c20: 726f 6669 6c65 2069 6e73 7461 6c6c 2067  rofile install g
+00001c30: 6974 6875 623a 3930 3031 2f63 6f70 7970  ithub:9001/copyp
+00001c40: 6172 7479 600a 2020 2020 2a20 5b6e 6978  arty`.    * [nix
+00001c50: 6f73 206d 6f64 756c 655d 2823 6e69 786f  os module](#nixo
+00001c60: 732d 6d6f 6475 6c65 290a 2a20 5b62 726f  s-module).* [bro
+00001c70: 7773 6572 2073 7570 706f 7274 5d28 2362  wser support](#b
+00001c80: 726f 7773 6572 2d73 7570 706f 7274 2920  rowser-support) 
+00001c90: 2d20 544c 4452 3a20 7965 730a 2a20 5b63  - TLDR: yes.* [c
+00001ca0: 6c69 656e 7420 6578 616d 706c 6573 5d28  lient examples](
+00001cb0: 2363 6c69 656e 742d 6578 616d 706c 6573  #client-examples
+00001cc0: 2920 2d20 696e 7465 7261 6374 2077 6974  ) - interact wit
+00001cd0: 6820 636f 7079 7061 7274 7920 7573 696e  h copyparty usin
+00001ce0: 6720 6e6f 6e2d 6272 6f77 7365 7220 636c  g non-browser cl
+00001cf0: 6965 6e74 730a 2020 2020 2a20 5b66 6f6c  ients.    * [fol
+00001d00: 6465 7220 7379 6e63 5d28 2366 6f6c 6465  der sync](#folde
+00001d10: 722d 7379 6e63 2920 2d20 7379 6e63 2066  r-sync) - sync f
+00001d20: 6f6c 6465 7273 2074 6f2f 6672 6f6d 2063  olders to/from c
+00001d30: 6f70 7970 6172 7479 0a20 2020 202a 205b  opyparty.    * [
+00001d40: 6d6f 756e 7420 6173 2064 7269 7665 5d28  mount as drive](
+00001d50: 236d 6f75 6e74 2d61 732d 6472 6976 6529  #mount-as-drive)
+00001d60: 202d 2061 2072 656d 6f74 6520 636f 7079   - a remote copy
+00001d70: 7061 7274 7920 7365 7276 6572 2061 7320  party server as 
+00001d80: 6120 6c6f 6361 6c20 6669 6c65 7379 7374  a local filesyst
+00001d90: 656d 0a2a 205b 616e 6472 6f69 6420 6170  em.* [android ap
+00001da0: 705d 2823 616e 6472 6f69 642d 6170 7029  p](#android-app)
+00001db0: 202d 2075 706c 6f61 6420 746f 2063 6f70   - upload to cop
+00001dc0: 7970 6172 7479 2077 6974 6820 6f6e 6520  yparty with one 
+00001dd0: 7461 700a 2a20 5b69 4f53 2073 686f 7274  tap.* [iOS short
+00001de0: 6375 7473 5d28 2369 4f53 2d73 686f 7274  cuts](#iOS-short
+00001df0: 6375 7473 2920 2d20 7468 6572 6520 6973  cuts) - there is
+00001e00: 206e 6f20 6950 686f 6e65 2061 7070 2c20   no iPhone app, 
+00001e10: 6275 740a 2a20 5b70 6572 666f 726d 616e  but.* [performan
+00001e20: 6365 5d28 2370 6572 666f 726d 616e 6365  ce](#performance
+00001e30: 2920 2d20 6465 6661 756c 7473 2061 7265  ) - defaults are
+00001e40: 2075 7375 616c 6c79 2066 696e 6520 2d20   usually fine - 
+00001e50: 6578 7065 6374 2060 3820 4769 422f 7360  expect `8 GiB/s`
+00001e60: 2064 6f77 6e6c 6f61 642c 2060 3120 4769   download, `1 Gi
+00001e70: 422f 7360 2075 706c 6f61 640a 2020 2020  B/s` upload.    
+00001e80: 2a20 5b63 6c69 656e 742d 7369 6465 5d28  * [client-side](
+00001e90: 2363 6c69 656e 742d 7369 6465 2920 2d20  #client-side) - 
+00001ea0: 7768 656e 2075 706c 6f61 6469 6e67 2066  when uploading f
+00001eb0: 696c 6573 0a2a 205b 7365 6375 7269 7479  iles.* [security
+00001ec0: 5d28 2373 6563 7572 6974 7929 202d 2073  ](#security) - s
+00001ed0: 6f6d 6520 6e6f 7465 7320 6f6e 2068 6172  ome notes on har
+00001ee0: 6465 6e69 6e67 0a20 2020 202a 205b 676f  dening.    * [go
+00001ef0: 7463 6861 735d 2823 676f 7463 6861 7329  tchas](#gotchas)
+00001f00: 202d 2062 6568 6176 696f 7220 7468 6174   - behavior that
+00001f10: 206d 6967 6874 2062 6520 756e 6578 7065   might be unexpe
+00001f20: 6374 6564 0a20 2020 202a 205b 636f 7273  cted.    * [cors
+00001f30: 5d28 2363 6f72 7329 202d 2063 726f 7373  ](#cors) - cross
+00001f40: 2d73 6974 6520 7265 7175 6573 7420 636f  -site request co
+00001f50: 6e66 6967 0a20 2020 202a 205b 6874 7470  nfig.    * [http
+00001f60: 735d 2823 6874 7470 7329 202d 2062 6f74  s](#https) - bot
+00001f70: 6820 4854 5450 2061 6e64 2048 5454 5053  h HTTP and HTTPS
+00001f80: 2061 7265 2061 6363 6570 7465 640a 2a20   are accepted.* 
+00001f90: 5b72 6563 6f76 6572 696e 6720 6672 6f6d  [recovering from
+00001fa0: 2063 7261 7368 6573 5d28 2372 6563 6f76   crashes](#recov
+00001fb0: 6572 696e 672d 6672 6f6d 2d63 7261 7368  ering-from-crash
+00001fc0: 6573 290a 2020 2020 2a20 5b63 6c69 656e  es).    * [clien
+00001fd0: 7420 6372 6173 6865 735d 2823 636c 6965  t crashes](#clie
+00001fe0: 6e74 2d63 7261 7368 6573 290a 2020 2020  nt-crashes).    
+00001ff0: 2020 2020 2a20 5b66 7265 666f 7820 7773      * [frefox ws
+00002000: 6f64 5d28 2366 7265 666f 782d 7773 6f64  od](#frefox-wsod
+00002010: 2920 2d20 6669 7265 666f 7820 3837 2063  ) - firefox 87 c
+00002020: 616e 2063 7261 7368 2064 7572 696e 6720  an crash during 
+00002030: 7570 6c6f 6164 730a 2a20 5b48 5454 5020  uploads.* [HTTP 
+00002040: 4150 495d 2823 4854 5450 2d41 5049 2920  API](#HTTP-API) 
+00002050: 2d20 7365 6520 5b64 6576 6e6f 7465 735d  - see [devnotes]
+00002060: 282e 2f64 6f63 732f 6465 766e 6f74 6573  (./docs/devnotes
+00002070: 2e6d 6423 6874 7470 2d61 7069 290a 2a20  .md#http-api).* 
+00002080: 5b64 6570 656e 6465 6e63 6965 735d 2823  [dependencies](#
+00002090: 6465 7065 6e64 656e 6369 6573 2920 2d20  dependencies) - 
+000020a0: 6d61 6e64 6174 6f72 7920 6465 7073 0a20  mandatory deps. 
+000020b0: 2020 202a 205b 6f70 7469 6f6e 616c 2064     * [optional d
+000020c0: 6570 656e 6465 6e63 6965 735d 2823 6f70  ependencies](#op
+000020d0: 7469 6f6e 616c 2d64 6570 656e 6465 6e63  tional-dependenc
+000020e0: 6965 7329 202d 2069 6e73 7461 6c6c 2074  ies) - install t
+000020f0: 6865 7365 2074 6f20 656e 6162 6c65 2062  hese to enable b
+00002100: 6f6e 7573 2066 6561 7475 7265 730a 2020  onus features.  
+00002110: 2020 2a20 5b6f 7074 696f 6e61 6c20 6770    * [optional gp
+00002120: 6c20 7374 7566 665d 2823 6f70 7469 6f6e  l stuff](#option
+00002130: 616c 2d67 706c 2d73 7475 6666 290a 2a20  al-gpl-stuff).* 
+00002140: 5b73 6678 5d28 2373 6678 2920 2d20 7468  [sfx](#sfx) - th
+00002150: 6520 7365 6c66 2d63 6f6e 7461 696e 6564  e self-contained
+00002160: 2022 6269 6e61 7279 220a 2020 2020 2a20   "binary".    * 
+00002170: 5b63 6f70 7970 6172 7479 2e65 7865 5d28  [copyparty.exe](
+00002180: 2363 6f70 7970 6172 7479 6578 6529 202d  #copypartyexe) -
+00002190: 2064 6f77 6e6c 6f61 6420 5b63 6f70 7970   download [copyp
+000021a0: 6172 7479 2e65 7865 5d28 6874 7470 733a  arty.exe](https:
+000021b0: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+000021c0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
+000021d0: 6173 6573 2f6c 6174 6573 742f 646f 776e  ases/latest/down
+000021e0: 6c6f 6164 2f63 6f70 7970 6172 7479 2e65  load/copyparty.e
+000021f0: 7865 2920 2877 696e 382b 2920 6f72 205b  xe) (win8+) or [
+00002200: 636f 7079 7061 7274 7933 322e 6578 655d  copyparty32.exe]
+00002210: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00002220: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00002230: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00002240: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00002250: 7061 7274 7933 322e 6578 6529 2028 7769  party32.exe) (wi
+00002260: 6e37 2b29 0a2a 205b 696e 7374 616c 6c20  n7+).* [install 
+00002270: 6f6e 2061 6e64 726f 6964 5d28 2369 6e73  on android](#ins
+00002280: 7461 6c6c 2d6f 6e2d 616e 6472 6f69 6429  tall-on-android)
+00002290: 0a2a 205b 7265 706f 7274 696e 6720 6275  .* [reporting bu
+000022a0: 6773 5d28 2372 6570 6f72 7469 6e67 2d62  gs](#reporting-b
+000022b0: 7567 7329 202d 2069 6465 6173 2066 6f72  ugs) - ideas for
+000022c0: 2063 6f6e 7465 7874 2074 6f20 696e 636c   context to incl
+000022d0: 7564 6520 696e 2062 7567 2072 6570 6f72  ude in bug repor
+000022e0: 7473 0a2a 205b 6465 766e 6f74 6573 5d28  ts.* [devnotes](
+000022f0: 2364 6576 6e6f 7465 7329 202d 2066 6f72  #devnotes) - for
+00002300: 2062 7569 6c64 2069 6e73 7472 7563 7469   build instructi
+00002310: 6f6e 7320 6574 632c 2073 6565 205b 2e2f  ons etc, see [./
+00002320: 646f 6373 2f64 6576 6e6f 7465 732e 6d64  docs/devnotes.md
+00002330: 5d28 2e2f 646f 6373 2f64 6576 6e6f 7465  ](./docs/devnote
+00002340: 732e 6d64 290a 0a0a 2323 2071 7569 636b  s.md)...## quick
+00002350: 7374 6172 740a 0a6a 7573 7420 7275 6e20  start..just run 
+00002360: 2a2a 5b63 6f70 7970 6172 7479 2d73 6678  **[copyparty-sfx
+00002370: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
+00002380: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+00002390: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+000023a0: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+000023b0: 636f 7079 7061 7274 792d 7366 782e 7079  copyparty-sfx.py
+000023c0: 292a 2a20 2d2d 2074 6861 7427 7320 6974  )** -- that's it
+000023d0: 2120 f09f 8e89 0a0a 2a20 6f72 2069 6e73  ! ......* or ins
+000023e0: 7461 6c6c 2074 6872 6f75 6768 2070 7970  tall through pyp
+000023f0: 6920 2870 7974 686f 6e33 206f 6e6c 7929  i (python3 only)
+00002400: 3a20 6070 7974 686f 6e33 202d 6d20 7069  : `python3 -m pi
+00002410: 7020 696e 7374 616c 6c20 2d2d 7573 6572  p install --user
+00002420: 202d 5520 636f 7079 7061 7274 7960 0a2a   -U copyparty`.*
+00002430: 206f 7220 6966 2079 6f75 2063 616e 6e6f   or if you canno
+00002440: 7420 696e 7374 616c 6c20 7079 7468 6f6e  t install python
+00002450: 2c20 796f 7520 6361 6e20 7573 6520 5b63  , you can use [c
+00002460: 6f70 7970 6172 7479 2e65 7865 5d28 2363  opyparty.exe](#c
+00002470: 6f70 7970 6172 7479 6578 6529 2069 6e73  opypartyexe) ins
+00002480: 7465 6164 0a2a 206f 7220 5b69 6e73 7461  tead.* or [insta
+00002490: 6c6c 2074 6872 6f75 6768 206e 6978 5d28  ll through nix](
+000024a0: 236e 6978 2d70 6163 6b61 6765 292c 206f  #nix-package), o
+000024b0: 7220 5b6f 6e20 4e69 784f 535d 2823 6e69  r [on NixOS](#ni
+000024c0: 786f 732d 6d6f 6475 6c65 292c 206f 7220  xos-module), or 
+000024d0: 5b6f 6e20 6172 6368 5d28 2361 7263 682d  [on arch](#arch-
+000024e0: 7061 636b 6167 6529 0a2a 206f 7220 6966  package).* or if
+000024f0: 2079 6f75 2061 7265 206f 6e20 616e 6472   you are on andr
+00002500: 6f69 642c 205b 696e 7374 616c 6c20 636f  oid, [install co
+00002510: 7079 7061 7274 7920 696e 2074 6572 6d75  pyparty in termu
+00002520: 785d 2823 696e 7374 616c 6c2d 6f6e 2d61  x](#install-on-a
+00002530: 6e64 726f 6964 290a 2a20 6f72 2069 6620  ndroid).* or if 
+00002540: 796f 7520 7072 6566 6572 2074 6f20 5b75  you prefer to [u
+00002550: 7365 2064 6f63 6b65 725d 282e 2f73 6372  se docker](./scr
+00002560: 6970 7473 2f64 6f63 6b65 722f 2920 f09f  ipts/docker/) ..
+00002570: 908b 2079 6f75 2063 616e 2064 6f20 7468  .. you can do th
+00002580: 6174 2074 6f6f 0a20 202a 2064 6f63 6b65  at too.  * docke
+00002590: 7220 6861 7320 616c 6c20 6465 7073 2062  r has all deps b
+000025a0: 7569 6c74 2d69 6e2c 2073 6f20 736b 6970  uilt-in, so skip
+000025b0: 2074 6869 7320 7374 6570 3a0a 0a65 6e61   this step:..ena
+000025c0: 626c 6520 7468 756d 626e 6169 6c73 2028  ble thumbnails (
+000025d0: 696d 6167 6573 2f61 7564 696f 2f76 6964  images/audio/vid
+000025e0: 656f 292c 206d 6564 6961 2069 6e64 6578  eo), media index
+000025f0: 696e 672c 2061 6e64 2061 7564 696f 2074  ing, and audio t
+00002600: 7261 6e73 636f 6469 6e67 2062 7920 696e  ranscoding by in
+00002610: 7374 616c 6c69 6e67 2073 6f6d 6520 7265  stalling some re
+00002620: 636f 6d6d 656e 6465 6420 6465 7073 3a0a  commended deps:.
+00002630: 0a2a 202a 2a41 6c70 696e 653a 2a2a 2060  .* **Alpine:** `
+00002640: 6170 6b20 6164 6420 7079 332d 7069 6c6c  apk add py3-pill
+00002650: 6f77 2066 666d 7065 6760 0a2a 202a 2a44  ow ffmpeg`.* **D
+00002660: 6562 6961 6e3a 2a2a 2060 6170 7420 696e  ebian:** `apt in
+00002670: 7374 616c 6c20 7079 7468 6f6e 332d 7069  stall python3-pi
+00002680: 6c20 6666 6d70 6567 600a 2a20 2a2a 4665  l ffmpeg`.* **Fe
+00002690: 646f 7261 3a2a 2a20 6064 6e66 2069 6e73  dora:** `dnf ins
+000026a0: 7461 6c6c 2070 7974 686f 6e33 2d70 696c  tall python3-pil
+000026b0: 6c6f 7720 6666 6d70 6567 600a 2a20 2a2a  low ffmpeg`.* **
+000026c0: 4672 6565 4253 443a 2a2a 2060 706b 6720  FreeBSD:** `pkg 
+000026d0: 696e 7374 616c 6c20 7079 3339 2d73 716c  install py39-sql
+000026e0: 6974 6533 2070 7933 392d 7069 6c6c 6f77  ite3 py39-pillow
+000026f0: 2066 666d 7065 6760 0a2a 202a 2a4d 6163   ffmpeg`.* **Mac
+00002700: 4f53 3a2a 2a20 6070 6f72 7420 696e 7374  OS:** `port inst
+00002710: 616c 6c20 7079 2d50 696c 6c6f 7720 6666  all py-Pillow ff
+00002720: 6d70 6567 600a 2a20 2a2a 4d61 634f 532a  mpeg`.* **MacOS*
+00002730: 2a20 2861 6c74 6572 6e61 7469 7665 293a  * (alternative):
+00002740: 2060 6272 6577 2069 6e73 7461 6c6c 2070   `brew install p
+00002750: 696c 6c6f 7720 6666 6d70 6567 600a 2a20  illow ffmpeg`.* 
+00002760: 2a2a 5769 6e64 6f77 733a 2a2a 2060 7079  **Windows:** `py
+00002770: 7468 6f6e 202d 6d20 7069 7020 696e 7374  thon -m pip inst
+00002780: 616c 6c20 2d2d 7573 6572 202d 5520 5069  all --user -U Pi
+00002790: 6c6c 6f77 600a 2020 2a20 696e 7374 616c  llow`.  * instal
+000027a0: 6c20 7079 7468 6f6e 2061 6e64 2066 666d  l python and ffm
+000027b0: 7065 6720 6d61 6e75 616c 6c79 3b20 646f  peg manually; do
+000027c0: 206e 6f74 2075 7365 2060 7769 6e67 6574   not use `winget
+000027d0: 6020 6f72 2060 4d69 6372 6f73 6f66 7420  ` or `Microsoft 
+000027e0: 5374 6f72 6560 2028 6974 2062 7265 616b  Store` (it break
+000027f0: 7320 2450 4154 4829 0a20 202a 2063 6f70  s $PATH).  * cop
+00002800: 7970 6172 7479 2e65 7865 2063 6f6d 6573  yparty.exe comes
+00002810: 2077 6974 6820 6050 696c 6c6f 7760 2061   with `Pillow` a
+00002820: 6e64 206f 6e6c 7920 6e65 6564 7320 6066  nd only needs `f
+00002830: 666d 7065 6760 0a2a 2073 6565 205b 6f70  fmpeg`.* see [op
+00002840: 7469 6f6e 616c 2064 6570 656e 6465 6e63  tional dependenc
+00002850: 6965 735d 2823 6f70 7469 6f6e 616c 2d64  ies](#optional-d
+00002860: 6570 656e 6465 6e63 6965 7329 2074 6f20  ependencies) to 
+00002870: 656e 6162 6c65 2065 7665 6e20 6d6f 7265  enable even more
+00002880: 2066 6561 7475 7265 730a 0a72 756e 6e69   features..runni
+00002890: 6e67 2063 6f70 7970 6172 7479 2077 6974  ng copyparty wit
+000028a0: 686f 7574 2061 7267 756d 656e 7473 2028  hout arguments (
+000028b0: 666f 7220 6578 616d 706c 6520 646f 7562  for example doub
+000028c0: 6c65 636c 6963 6b69 6e67 2069 7420 6f6e  leclicking it on
+000028d0: 2057 696e 646f 7773 2920 7769 6c6c 2067   Windows) will g
+000028e0: 6976 6520 6576 6572 796f 6e65 2072 6561  ive everyone rea
+000028f0: 642f 7772 6974 6520 6163 6365 7373 2074  d/write access t
+00002900: 6f20 7468 6520 6375 7272 656e 7420 666f  o the current fo
+00002910: 6c64 6572 3b20 796f 7520 6d61 7920 7761  lder; you may wa
+00002920: 6e74 205b 6163 636f 756e 7473 2061 6e64  nt [accounts and
+00002930: 2076 6f6c 756d 6573 5d28 2361 6363 6f75   volumes](#accou
+00002940: 6e74 732d 616e 642d 766f 6c75 6d65 7329  nts-and-volumes)
+00002950: 0a0a 6f72 2073 6565 205b 636f 6d70 6c65  ..or see [comple
+00002960: 7465 2077 696e 646f 7773 2065 7861 6d70  te windows examp
+00002970: 6c65 5d28 2e2f 646f 6373 2f65 7861 6d70  le](./docs/examp
+00002980: 6c65 732f 7769 6e64 6f77 732e 6d64 290a  les/windows.md).
+00002990: 0a73 6f6d 6520 7265 636f 6d6d 656e 6465  .some recommende
+000029a0: 6420 6f70 7469 6f6e 733a 0a2a 2060 2d65  d options:.* `-e
+000029b0: 3264 7361 6020 656e 6162 6c65 7320 6765  2dsa` enables ge
+000029c0: 6e65 7261 6c20 5b66 696c 6520 696e 6465  neral [file inde
+000029d0: 7869 6e67 5d28 2366 696c 652d 696e 6465  xing](#file-inde
+000029e0: 7869 6e67 290a 2a20 602d 6532 7473 6020  xing).* `-e2ts` 
+000029f0: 656e 6162 6c65 7320 6175 6469 6f20 6d65  enables audio me
+00002a00: 7461 6461 7461 2069 6e64 6578 696e 6720  tadata indexing 
+00002a10: 286e 6565 6473 2065 6974 6865 7220 4646  (needs either FF
+00002a20: 7072 6f62 6520 6f72 204d 7574 6167 656e  probe or Mutagen
+00002a30: 290a 2a20 602d 7620 2f6d 6e74 2f6d 7573  ).* `-v /mnt/mus
+00002a40: 6963 3a2f 6d75 7369 633a 723a 7277 2c66  ic:/music:r:rw,f
+00002a50: 6f6f 202d 6120 666f 6f3a 6261 7260 2073  oo -a foo:bar` s
+00002a60: 6861 7265 7320 602f 6d6e 742f 6d75 7369  hares `/mnt/musi
+00002a70: 6360 2061 7320 602f 6d75 7369 6360 2c20  c` as `/music`, 
+00002a80: 6072 6065 6164 6162 6c65 2062 7920 616e  `r`eadable by an
+00002a90: 796f 6e65 2c20 616e 6420 7265 6164 2d77  yone, and read-w
+00002aa0: 7269 7465 2066 6f72 2075 7365 7220 6066  rite for user `f
+00002ab0: 6f6f 602c 2070 6173 7377 6f72 6420 6062  oo`, password `b
+00002ac0: 6172 600a 2020 2a20 7265 706c 6163 6520  ar`.  * replace 
+00002ad0: 603a 723a 7277 2c66 6f6f 6020 7769 7468  `:r:rw,foo` with
+00002ae0: 2060 3a72 2c66 6f6f 6020 746f 206f 6e6c   `:r,foo` to onl
+00002af0: 7920 6d61 6b65 2074 6865 2066 6f6c 6465  y make the folde
+00002b00: 7220 7265 6164 6162 6c65 2062 7920 6066  r readable by `f
+00002b10: 6f6f 6020 616e 6420 6e6f 626f 6479 2065  oo` and nobody e
+00002b20: 6c73 650a 2020 2a20 7365 6520 5b61 6363  lse.  * see [acc
+00002b30: 6f75 6e74 7320 616e 6420 766f 6c75 6d65  ounts and volume
+00002b40: 735d 2823 6163 636f 756e 7473 2d61 6e64  s](#accounts-and
+00002b50: 2d76 6f6c 756d 6573 2920 286f 7220 602d  -volumes) (or `-
+00002b60: 2d68 656c 702d 6163 636f 756e 7473 6029  -help-accounts`)
+00002b70: 2066 6f72 2074 6865 2073 796e 7461 7820   for the syntax 
+00002b80: 616e 6420 6f74 6865 7220 7065 726d 6973  and other permis
+00002b90: 7369 6f6e 730a 0a0a 2323 2320 6f6e 2073  sions...### on s
+00002ba0: 6572 7665 7273 0a0a 796f 7520 6d61 7920  ervers..you may 
+00002bb0: 616c 736f 2077 616e 7420 7468 6573 652c  also want these,
+00002bc0: 2065 7370 6563 6961 6c6c 7920 6f6e 2073   especially on s
+00002bd0: 6572 7665 7273 3a0a 0a2a 205b 636f 6e74  ervers:..* [cont
+00002be0: 7269 622f 7379 7374 656d 642f 636f 7079  rib/systemd/copy
+00002bf0: 7061 7274 792e 7365 7276 6963 655d 2863  party.service](c
+00002c00: 6f6e 7472 6962 2f73 7973 7465 6d64 2f63  ontrib/systemd/c
+00002c10: 6f70 7970 6172 7479 2e73 6572 7669 6365  opyparty.service
+00002c20: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
+00002c30: 7479 2061 7320 6120 7379 7374 656d 6420  ty as a systemd 
+00002c40: 7365 7276 6963 6520 2873 6565 2067 7569  service (see gui
+00002c50: 6465 2069 6e73 6964 6529 0a2a 205b 636f  de inside).* [co
+00002c60: 6e74 7269 622f 7379 7374 656d 642f 7072  ntrib/systemd/pr
+00002c70: 6973 6f6e 7061 7274 792e 7365 7276 6963  isonparty.servic
+00002c80: 655d 2863 6f6e 7472 6962 2f73 7973 7465  e](contrib/syste
+00002c90: 6d64 2f70 7269 736f 6e70 6172 7479 2e73  md/prisonparty.s
+00002ca0: 6572 7669 6365 2920 746f 2072 756e 2069  ervice) to run i
+00002cb0: 7420 696e 2061 2063 6872 6f6f 7420 2866  t in a chroot (f
+00002cc0: 6f72 2065 7874 7261 2073 6563 7572 6974  or extra securit
+00002cd0: 7929 0a2a 205b 636f 6e74 7269 622f 7263  y).* [contrib/rc
+00002ce0: 2f63 6f70 7970 6172 7479 5d28 636f 6e74  /copyparty](cont
+00002cf0: 7269 622f 7263 2f63 6f70 7970 6172 7479  rib/rc/copyparty
+00002d00: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
+00002d10: 7479 206f 6e20 4672 6565 4253 440a 2a20  ty on FreeBSD.* 
+00002d20: 5b63 6f6e 7472 6962 2f6e 6769 6e78 2f63  [contrib/nginx/c
+00002d30: 6f70 7970 6172 7479 2e63 6f6e 665d 2863  opyparty.conf](c
+00002d40: 6f6e 7472 6962 2f6e 6769 6e78 2f63 6f70  ontrib/nginx/cop
+00002d50: 7970 6172 7479 2e63 6f6e 6629 2074 6f20  yparty.conf) to 
+00002d60: 5b72 6576 6572 7365 2d70 726f 7879 5d28  [reverse-proxy](
+00002d70: 2372 6576 6572 7365 2d70 726f 7879 2920  #reverse-proxy) 
+00002d80: 6265 6869 6e64 206e 6769 6e78 2028 666f  behind nginx (fo
+00002d90: 7220 6265 7474 6572 2068 7474 7073 290a  r better https).
+00002da0: 2a20 5b6e 6978 6f73 206d 6f64 756c 655d  * [nixos module]
+00002db0: 2823 6e69 786f 732d 6d6f 6475 6c65 2920  (#nixos-module) 
+00002dc0: 746f 2072 756e 2063 6f70 7970 6172 7479  to run copyparty
+00002dd0: 206f 6e20 4e69 784f 5320 686f 7374 730a   on NixOS hosts.
+00002de0: 0a61 6e64 2072 656d 656d 6265 7220 746f  .and remember to
+00002df0: 206f 7065 6e20 7468 6520 706f 7274 7320   open the ports 
+00002e00: 796f 7520 7761 6e74 3b20 6865 7265 2773  you want; here's
+00002e10: 2061 2063 6f6d 706c 6574 6520 6578 616d   a complete exam
+00002e20: 706c 6520 696e 636c 7564 696e 6720 6576  ple including ev
+00002e30: 6572 7920 6665 6174 7572 6520 636f 7079  ery feature copy
+00002e40: 7061 7274 7920 6861 7320 746f 206f 6666  party has to off
+00002e50: 6572 3a0a 6060 600a 6669 7265 7761 6c6c  er:.```.firewall
+00002e60: 2d63 6d64 202d 2d70 6572 6d61 6e65 6e74  -cmd --permanent
+00002e70: 202d 2d61 6464 2d70 6f72 743d 7b38 302c   --add-port={80,
+00002e80: 3434 332c 3339 3231 2c33 3932 332c 3339  443,3921,3923,39
+00002e90: 3435 2c33 3939 307d 2f74 6370 2020 2320  45,3990}/tcp  # 
+00002ea0: 2d2d 7a6f 6e65 3d6c 6962 7669 7274 0a66  --zone=libvirt.f
+00002eb0: 6972 6577 616c 6c2d 636d 6420 2d2d 7065  irewall-cmd --pe
+00002ec0: 726d 616e 656e 7420 2d2d 6164 642d 706f  rmanent --add-po
+00002ed0: 7274 3d31 3230 3030 2d31 3230 3939 2f74  rt=12000-12099/t
+00002ee0: 6370 202d 2d70 6572 6d61 6e65 6e74 2020  cp --permanent  
+00002ef0: 2320 2d2d 7a6f 6e65 3d6c 6962 7669 7274  # --zone=libvirt
+00002f00: 0a66 6972 6577 616c 6c2d 636d 6420 2d2d  .firewall-cmd --
+00002f10: 7065 726d 616e 656e 7420 2d2d 6164 642d  permanent --add-
+00002f20: 706f 7274 3d7b 3139 3030 2c35 3335 337d  port={1900,5353}
+00002f30: 2f75 6470 2020 2320 2d2d 7a6f 6e65 3d6c  /udp  # --zone=l
+00002f40: 6962 7669 7274 0a66 6972 6577 616c 6c2d  ibvirt.firewall-
+00002f50: 636d 6420 2d2d 7265 6c6f 6164 0a60 6060  cmd --reload.```
+00002f60: 0a28 3139 3030 3a73 7364 702c 2033 3932  .(1900:ssdp, 392
+00002f70: 313a 6674 702c 2033 3932 333a 6874 7470  1:ftp, 3923:http
+00002f80: 2f68 7474 7073 2c20 3339 3435 3a73 6d62  /https, 3945:smb
+00002f90: 2c20 3339 3930 3a66 7470 732c 2035 3335  , 3990:ftps, 535
+00002fa0: 333a 6d64 6e73 2c20 3132 3030 303a 7061  3:mdns, 12000:pa
+00002fb0: 7373 6976 652d 6674 7029 0a0a 0a23 2320  ssive-ftp)...## 
+00002fc0: 6665 6174 7572 6573 0a0a 2a20 6261 636b  features..* back
+00002fd0: 656e 6420 7374 7566 660a 2020 2a20 e298  end stuff.  * ..
+00002fe0: 9120 4950 7636 0a20 202a 20e2 9891 205b  . IPv6.  * ... [
+00002ff0: 6d75 6c74 6970 726f 6365 7373 696e 675d  multiprocessing]
+00003000: 2823 7065 7266 6f72 6d61 6e63 6529 2028  (#performance) (
+00003010: 6163 7475 616c 206d 756c 7469 7468 7265  actual multithre
+00003020: 6164 696e 6729 0a20 202a 20e2 9891 2076  ading).  * ... v
+00003030: 6f6c 756d 6573 2028 6d6f 756e 7470 6f69  olumes (mountpoi
+00003040: 6e74 7329 0a20 202a 20e2 9891 205b 6163  nts).  * ... [ac
+00003050: 636f 756e 7473 5d28 2361 6363 6f75 6e74  counts](#account
+00003060: 732d 616e 642d 766f 6c75 6d65 7329 0a20  s-and-volumes). 
+00003070: 202a 20e2 9891 205b 6674 7020 7365 7276   * ... [ftp serv
+00003080: 6572 5d28 2366 7470 2d73 6572 7665 7229  er](#ftp-server)
+00003090: 0a20 202a 20e2 9891 205b 7765 6264 6176  .  * ... [webdav
+000030a0: 2073 6572 7665 725d 2823 7765 6264 6176   server](#webdav
+000030b0: 2d73 6572 7665 7229 0a20 202a 20e2 9891  -server).  * ...
+000030c0: 205b 736d 622f 6369 6673 2073 6572 7665   [smb/cifs serve
+000030d0: 725d 2823 736d 622d 7365 7276 6572 290a  r](#smb-server).
+000030e0: 2020 2a20 e298 9120 5b71 722d 636f 6465    * ... [qr-code
+000030f0: 5d28 2371 722d 636f 6465 2920 666f 7220  ](#qr-code) for 
+00003100: 7175 6963 6b20 6163 6365 7373 0a20 202a  quick access.  *
+00003110: 20e2 9891 205b 7570 6e70 202f 207a 6572   ... [upnp / zer
+00003120: 6f63 6f6e 6620 2f20 6d64 6e73 202f 2073  oconf / mdns / s
+00003130: 7364 705d 2823 7a65 726f 636f 6e66 290a  sdp](#zeroconf).
+00003140: 2020 2a20 e298 9120 5b65 7665 6e74 2068    * ... [event h
+00003150: 6f6f 6b73 5d28 2365 7665 6e74 2d68 6f6f  ooks](#event-hoo
+00003160: 6b73 2920 2f20 7363 7269 7074 2072 756e  ks) / script run
+00003170: 6e65 720a 2020 2a20 e298 9120 5b72 6576  ner.  * ... [rev
+00003180: 6572 7365 2d70 726f 7879 2073 7570 706f  erse-proxy suppo
+00003190: 7274 5d28 6874 7470 733a 2f2f 6769 7468  rt](https://gith
+000031a0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
+000031b0: 7061 7274 7923 7265 7665 7273 652d 7072  party#reverse-pr
+000031c0: 6f78 7929 0a2a 2075 706c 6f61 640a 2020  oxy).* upload.  
+000031d0: 2a20 e298 9120 6261 7369 633a 2070 6c61  * ... basic: pla
+000031e0: 696e 206d 756c 7469 7061 7274 2c20 6965  in multipart, ie
+000031f0: 3620 7375 7070 6f72 740a 2020 2a20 e298  6 support.  * ..
+00003200: 9120 5b75 7032 6b5d 2823 7570 6c6f 6164  . [up2k](#upload
+00003210: 696e 6729 3a20 6a73 2c20 7265 7375 6d61  ing): js, resuma
+00003220: 626c 652c 206d 756c 7469 7468 7265 6164  ble, multithread
+00003230: 6564 0a20 2020 202a 2075 6e61 6666 6563  ed.    * unaffec
+00003240: 7465 6420 6279 2063 6c6f 7564 666c 6172  ted by cloudflar
+00003250: 6527 7320 6d61 782d 7570 6c6f 6164 2d73  e's max-upload-s
+00003260: 697a 6520 2831 3030 204d 6942 290a 2020  ize (100 MiB).  
+00003270: 2a20 e298 9120 7374 6173 683a 2073 696d  * ... stash: sim
+00003280: 706c 6520 5055 5420 6669 6c65 6472 6f70  ple PUT filedrop
+00003290: 7065 720a 2020 2a20 e298 9120 6669 6c65  per.  * ... file
+000032a0: 6e61 6d65 2072 616e 646f 6d69 7a65 720a  name randomizer.
+000032b0: 2020 2a20 e298 9120 7772 6974 652d 6f6e    * ... write-on
+000032c0: 6c79 2066 6f6c 6465 7273 0a20 202a 20e2  ly folders.  * .
+000032d0: 9891 205b 756e 706f 7374 5d28 2375 6e70  .. [unpost](#unp
+000032e0: 6f73 7429 3a20 756e 646f 2f64 656c 6574  ost): undo/delet
+000032f0: 6520 6163 6369 6465 6e74 616c 2075 706c  e accidental upl
+00003300: 6f61 6473 0a20 202a 20e2 9891 205b 7365  oads.  * ... [se
+00003310: 6c66 2d64 6573 7472 7563 745d 2823 7365  lf-destruct](#se
+00003320: 6c66 2d64 6573 7472 7563 7429 2028 7370  lf-destruct) (sp
+00003330: 6563 6966 6965 6420 7365 7276 6572 2d73  ecified server-s
+00003340: 6964 6520 6f72 2063 6c69 656e 742d 7369  ide or client-si
+00003350: 6465 290a 2020 2a20 e298 9120 7379 6d6c  de).  * ... syml
+00003360: 696e 6b2f 6469 7363 6172 6420 6475 706c  ink/discard dupl
+00003370: 6963 6174 6573 2028 636f 6e74 656e 742d  icates (content-
+00003380: 6d61 7463 6869 6e67 290a 2a20 646f 776e  matching).* down
+00003390: 6c6f 6164 0a20 202a 20e2 9891 2073 696e  load.  * ... sin
+000033a0: 676c 6520 6669 6c65 7320 696e 2062 726f  gle files in bro
+000033b0: 7773 6572 0a20 202a 20e2 9891 205b 666f  wser.  * ... [fo
+000033c0: 6c64 6572 7320 6173 207a 6970 202f 2074  lders as zip / t
+000033d0: 6172 2066 696c 6573 5d28 237a 6970 2d64  ar files](#zip-d
+000033e0: 6f77 6e6c 6f61 6473 290a 2020 2a20 e298  ownloads).  * ..
+000033f0: 9120 5b46 5553 4520 636c 6965 6e74 5d28  . [FUSE client](
+00003400: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00003410: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00003420: 792f 7472 6565 2f68 6f76 7564 7374 7261  y/tree/hovudstra
+00003430: 756d 2f62 696e 2370 6172 7479 6675 7365  um/bin#partyfuse
+00003440: 7079 2920 2872 6561 642d 6f6e 6c79 290a  py) (read-only).
+00003450: 2a20 6272 6f77 7365 720a 2020 2a20 e298  * browser.  * ..
+00003460: 9120 5b6e 6176 7061 6e65 5d28 236e 6176  . [navpane](#nav
+00003470: 7061 6e65 2920 2864 6972 6563 746f 7279  pane) (directory
+00003480: 2074 7265 6520 7369 6465 6261 7229 0a20   tree sidebar). 
+00003490: 202a 20e2 9891 2066 696c 6520 6d61 6e61   * ... file mana
+000034a0: 6765 7220 2863 7574 2f70 6173 7465 2c20  ger (cut/paste, 
+000034b0: 6465 6c65 7465 2c20 5b62 6174 6368 2d72  delete, [batch-r
+000034c0: 656e 616d 655d 2823 6261 7463 682d 7265  ename](#batch-re
+000034d0: 6e61 6d65 2929 0a20 202a 20e2 9891 2061  name)).  * ... a
+000034e0: 7564 696f 2070 6c61 7965 7220 2877 6974  udio player (wit
+000034f0: 6820 5b4f 5320 6d65 6469 6120 636f 6e74  h [OS media cont
+00003500: 726f 6c73 5d28 6874 7470 733a 2f2f 7573  rols](https://us
+00003510: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00003520: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00003530: 3234 3130 3332 2f32 3135 3334 3734 3932  241032/215347492
+00003540: 2d62 3432 3530 3739 372d 3663 3930 2d34  -b4250797-6c90-4
+00003550: 6530 392d 3961 3463 2d37 3231 6564 6632  e09-9a4c-721edf2
+00003560: 6662 3135 632e 706e 6729 2061 6e64 206f  fb15c.png) and o
+00003570: 7075 7320 7472 616e 7363 6f64 696e 6729  pus transcoding)
+00003580: 0a20 202a 20e2 9891 2069 6d61 6765 2067  .  * ... image g
+00003590: 616c 6c65 7279 2077 6974 6820 7765 626d  allery with webm
+000035a0: 2070 6c61 7965 720a 2020 2a20 e298 9120   player.  * ... 
+000035b0: 7465 7874 6669 6c65 2062 726f 7773 6572  textfile browser
+000035c0: 2077 6974 6820 7379 6e74 6178 2068 696c   with syntax hil
+000035d0: 6967 6874 696e 670a 2020 2a20 e298 9120  ighting.  * ... 
+000035e0: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+000035f0: 756d 626e 6169 6c73 290a 2020 2020 2a20  umbnails).    * 
+00003600: e298 9120 2e2e 2e6f 6620 696d 6167 6573  ... ...of images
+00003610: 2075 7369 6e67 2050 696c 6c6f 772c 2070   using Pillow, p
+00003620: 7976 6970 732c 206f 7220 4646 6d70 6567  yvips, or FFmpeg
+00003630: 0a20 2020 202a 20e2 9891 202e 2e2e 6f66  .    * ... ...of
+00003640: 2076 6964 656f 7320 7573 696e 6720 4646   videos using FF
+00003650: 6d70 6567 0a20 2020 202a 20e2 9891 202e  mpeg.    * ... .
+00003660: 2e2e 6f66 2061 7564 696f 2028 7370 6563  ..of audio (spec
+00003670: 7472 6f67 7261 6d73 2920 7573 696e 6720  trograms) using 
+00003680: 4646 6d70 6567 0a20 2020 202a 20e2 9891  FFmpeg.    * ...
+00003690: 2063 6163 6865 2065 7669 6374 696f 6e20   cache eviction 
+000036a0: 286d 6178 2d61 6765 3b20 6d61 7962 6520  (max-age; maybe 
+000036b0: 6d61 782d 7369 7a65 2065 7665 6e74 7561  max-size eventua
+000036c0: 6c6c 7929 0a20 202a 20e2 9891 2053 5041  lly).  * ... SPA
+000036d0: 2028 6272 6f77 7365 2077 6869 6c65 2075   (browse while u
+000036e0: 706c 6f61 6469 6e67 290a 2a20 7365 7276  ploading).* serv
+000036f0: 6572 2069 6e64 6578 696e 670a 2020 2a20  er indexing.  * 
+00003700: e298 9120 5b6c 6f63 6174 6520 6669 6c65  ... [locate file
+00003710: 7320 6279 2063 6f6e 7465 6e74 735d 2823  s by contents](#
+00003720: 6669 6c65 2d73 6561 7263 6829 0a20 202a  file-search).  *
+00003730: 20e2 9891 2073 6561 7263 6820 6279 206e   ... search by n
+00003740: 616d 652f 7061 7468 2f64 6174 652f 7369  ame/path/date/si
+00003750: 7a65 0a20 202a 20e2 9891 205b 7365 6172  ze.  * ... [sear
+00003760: 6368 2062 7920 4944 332d 7461 6773 2065  ch by ID3-tags e
+00003770: 7463 2e5d 2823 7365 6172 6368 696e 6729  tc.](#searching)
+00003780: 0a2a 2063 6c69 656e 7420 7375 7070 6f72  .* client suppor
+00003790: 740a 2020 2a20 e298 9120 5b66 6f6c 6465  t.  * ... [folde
+000037a0: 7220 7379 6e63 5d28 2366 6f6c 6465 722d  r sync](#folder-
+000037b0: 7379 6e63 290a 2020 2a20 e298 9120 5b63  sync).  * ... [c
+000037c0: 7572 6c2d 6672 6965 6e64 6c79 5d28 6874  url-friendly](ht
+000037d0: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+000037e0: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+000037f0: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
+00003800: 3135 3332 3236 3139 2d65 6135 6664 3630  15322619-ea5fd60
+00003810: 362d 3336 3534 2d34 3061 642d 3934 6565  6-3654-40ad-94ee
+00003820: 2d32 6263 3035 3836 3437 6262 322e 706e  -2bc058647bb2.pn
+00003830: 6729 0a2a 206d 6172 6b64 6f77 6e0a 2020  g).* markdown.  
+00003840: 2a20 e298 9120 5b76 6965 7765 725d 2823  * ... [viewer](#
+00003850: 6d61 726b 646f 776e 2d76 6965 7765 7229  markdown-viewer)
+00003860: 0a20 202a 20e2 9891 2065 6469 746f 7220  .  * ... editor 
+00003870: 2873 7572 6520 7768 7920 6e6f 7429 0a0a  (sure why not)..
+00003880: 5053 3a20 736f 6d65 7468 696e 6720 6d69  PS: something mi
+00003890: 7373 696e 673f 2070 6f73 7420 616e 7920  ssing? post any 
+000038a0: 6372 617a 7920 6964 6561 7320 796f 7527  crazy ideas you'
+000038b0: 7665 2067 6f74 2061 7320 6120 5b66 6561  ve got as a [fea
+000038c0: 7475 7265 2072 6571 7565 7374 5d28 6874  ture request](ht
+000038d0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+000038e0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
+000038f0: 6973 7375 6573 2f6e 6577 3f61 7373 6967  issues/new?assig
+00003900: 6e65 6573 3d39 3030 3126 6c61 6265 6c73  nees=9001&labels
+00003910: 3d65 6e68 616e 6365 6d65 6e74 2674 656d  =enhancement&tem
+00003920: 706c 6174 653d 6665 6174 7572 655f 7265  plate=feature_re
+00003930: 7175 6573 742e 6d64 2920 6f72 205b 6469  quest.md) or [di
+00003940: 7363 7573 7369 6f6e 5d28 6874 7470 733a  scussion](https:
+00003950: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+00003960: 312f 636f 7079 7061 7274 792f 6469 7363  1/copyparty/disc
+00003970: 7573 7369 6f6e 732f 6e65 773f 6361 7465  ussions/new?cate
+00003980: 676f 7279 3d69 6465 6173 2920 f09f a499  gory=ideas) ....
+00003990: 0a0a 0a23 2320 7465 7374 696d 6f6e 6961  ...## testimonia
+000039a0: 6c73 0a0a 736d 616c 6c20 636f 6c6c 6563  ls..small collec
+000039b0: 7469 6f6e 206f 6620 7573 6572 2066 6565  tion of user fee
+000039c0: 6462 6163 6b0a 0a60 676f 6f64 2065 6e6f  dback..`good eno
+000039d0: 7567 6860 2c20 6073 7572 7072 6973 696e  ugh`, `surprisin
+000039e0: 676c 7920 636f 7272 6563 7460 2c20 6063  gly correct`, `c
+000039f0: 6572 7469 6669 6564 2067 6f6f 6420 736f  ertified good so
+00003a00: 6674 7761 7265 602c 2060 6a75 7374 2077  ftware`, `just w
+00003a10: 6f72 6b73 602c 2060 7768 7960 2c20 6077  orks`, `why`, `w
+00003a20: 6f77 2074 6869 7320 6973 2062 6574 7465  ow this is bette
+00003a30: 7220 7468 616e 206e 6578 7463 6c6f 7564  r than nextcloud
+00003a40: 600a 0a0a 2320 6d6f 7469 7661 7469 6f6e  `...# motivation
+00003a50: 730a 0a70 726f 6a65 6374 2067 6f61 6c73  s..project goals
+00003a60: 202f 2070 6869 6c6f 736f 7068 790a 0a2a   / philosophy..*
+00003a70: 2069 6e76 6572 7365 206c 696e 7578 2070   inverse linux p
+00003a80: 6869 6c6f 736f 7068 7920 2d2d 2064 6f20  hilosophy -- do 
+00003a90: 616c 6c20 7468 6520 7468 696e 6773 2c20  all the things, 
+00003aa0: 616e 6420 646f 2061 6e20 2a6f 6b61 792a  and do an *okay*
+00003ab0: 206a 6f62 0a20 202a 2071 7569 636b 2064   job.  * quick d
+00003ac0: 726f 702d 696e 2073 6572 7669 6365 2074  rop-in service t
+00003ad0: 6f20 6765 7420 6120 6c6f 7420 6f66 2066  o get a lot of f
+00003ae0: 6561 7475 7265 7320 696e 2061 2070 696e  eatures in a pin
+00003af0: 6368 0a20 202a 2073 6f6d 6520 6f66 205b  ch.  * some of [
+00003b00: 7468 6520 616c 7465 726e 6174 6976 6573  the alternatives
+00003b10: 5d28 2e2f 646f 6373 2f76 6572 7375 732e  ](./docs/versus.
+00003b20: 6d64 2920 6d69 6768 7420 6265 2061 2062  md) might be a b
+00003b30: 6574 7465 7220 6669 7420 666f 7220 796f  etter fit for yo
+00003b40: 750a 2a20 7275 6e20 616e 7977 6865 7265  u.* run anywhere
+00003b50: 2c20 7375 7070 6f72 7420 6576 6572 7974  , support everyt
+00003b60: 6869 6e67 0a20 202a 2061 7320 6d61 6e79  hing.  * as many
+00003b70: 2077 6562 2d62 726f 7773 6572 7320 616e   web-browsers an
+00003b80: 6420 7079 7468 6f6e 2076 6572 7369 6f6e  d python version
+00003b90: 7320 6173 2070 6f73 7369 626c 650a 2020  s as possible.  
+00003ba0: 2020 2a20 6576 6572 7920 6272 6f77 7365    * every browse
+00003bb0: 7220 7368 6f75 6c64 2061 7420 6c65 6173  r should at leas
+00003bc0: 7420 6265 2061 626c 6520 746f 2062 726f  t be able to bro
+00003bd0: 7773 652c 2064 6f77 6e6c 6f61 642c 2075  wse, download, u
+00003be0: 706c 6f61 6420 6669 6c65 730a 2020 2020  pload files.    
+00003bf0: 2a20 6265 2061 2067 6f6f 6420 656d 6572  * be a good emer
+00003c00: 6765 6e63 7920 736f 6c75 7469 6f6e 2066  gency solution f
+00003c10: 6f72 2074 7261 6e73 6665 7272 696e 6720  or transferring 
+00003c20: 7374 7566 6620 6265 7477 6565 6e20 616e  stuff between an
+00003c30: 6369 656e 7420 626f 7865 730a 2020 2a20  cient boxes.  * 
+00003c40: 6d69 6e69 6d61 6c20 6465 7065 6e64 656e  minimal dependen
+00003c50: 6369 6573 0a20 2020 202a 2062 7574 206f  cies.    * but o
+00003c60: 7074 696f 6e61 6c20 6465 7065 6e64 656e  ptional dependen
+00003c70: 6369 6573 2061 6464 696e 6720 626f 6e75  cies adding bonu
+00003c80: 732d 6665 6174 7572 6573 2061 7265 206f  s-features are o
+00003c90: 6b0a 2020 2020 2a20 6576 6572 7974 6869  k.    * everythi
+00003ca0: 6e67 2062 6569 6e67 2070 6c61 696e 7465  ng being plainte
+00003cb0: 7874 206d 616b 6573 2069 7420 706f 7373  xt makes it poss
+00003cc0: 6962 6c65 2074 6f20 7072 6f6f 6672 6561  ible to proofrea
+00003cd0: 6420 666f 7220 6d61 6c69 6369 6f75 7320  d for malicious 
+00003ce0: 636f 6465 0a20 202a 206e 6f20 7072 6570  code.  * no prep
+00003cf0: 6172 6174 696f 6e73 202f 2073 6574 7570  arations / setup
+00003d00: 206e 6563 6573 7361 7279 2c20 6a75 7374   necessary, just
+00003d10: 2072 756e 2074 6865 2073 6678 2028 7768   run the sfx (wh
+00003d20: 6963 6820 6973 2061 6c73 6f20 706c 6169  ich is also plai
+00003d30: 6e74 6578 7429 0a2a 2061 6461 7074 6162  ntext).* adaptab
+00003d40: 6c65 2c20 6d61 6c6c 6561 626c 652c 2068  le, malleable, h
+00003d50: 6163 6b61 626c 650a 2020 2a20 6e6f 2062  ackable.  * no b
+00003d60: 7569 6c64 2073 7465 7073 3b20 6d6f 6469  uild steps; modi
+00003d70: 6679 2074 6865 206a 732f 7079 7468 6f6e  fy the js/python
+00003d80: 2077 6974 686f 7574 206e 6565 6469 6e67   without needing
+00003d90: 206e 6f64 652e 6a73 206f 7220 616e 7974   node.js or anyt
+00003da0: 6869 6e67 206c 696b 6520 7468 6174 0a0a  hing like that..
+00003db0: 0a23 2320 6e6f 7465 730a 0a67 656e 6572  .## notes..gener
+00003dc0: 616c 206e 6f74 6573 3a0a 2a20 7061 7065  al notes:.* pape
+00003dd0: 722d 7072 696e 7469 6e67 2069 7320 6166  r-printing is af
+00003de0: 6665 6374 6564 2062 7920 6461 726b 2f6c  fected by dark/l
+00003df0: 6967 6874 2d6d 6f64 6521 2075 7365 206c  ight-mode! use l
+00003e00: 6967 6874 6d6f 6465 2066 6f72 2063 6f6c  ightmode for col
+00003e10: 6f72 2c20 6461 726b 6d6f 6465 2066 6f72  or, darkmode for
+00003e20: 2067 7261 7973 6361 6c65 0a20 202a 2062   grayscale.  * b
+00003e30: 6563 6175 7365 206e 6f20 6272 6f77 7365  ecause no browse
+00003e40: 7273 2063 7572 7265 6e74 6c79 2069 6d70  rs currently imp
+00003e50: 6c65 6d65 6e74 2074 6865 206d 6564 6961  lement the media
+00003e60: 2d71 7565 7279 2074 6f20 646f 2074 6869  -query to do thi
+00003e70: 7320 7072 6f70 6572 6c79 206f 727a 0a0a  s properly orz..
+00003e80: 6272 6f77 7365 722d 7370 6563 6966 6963  browser-specific
+00003e90: 3a0a 2a20 6950 686f 6e65 2f69 5061 643a  :.* iPhone/iPad:
+00003ea0: 2075 7365 2046 6972 6566 6f78 2074 6f20   use Firefox to 
+00003eb0: 646f 776e 6c6f 6164 2066 696c 6573 0a2a  download files.*
+00003ec0: 2041 6e64 726f 6964 2d43 6872 6f6d 653a   Android-Chrome:
+00003ed0: 2069 6e63 7265 6173 6520 2270 6172 616c   increase "paral
+00003ee0: 6c65 6c20 7570 6c6f 6164 7322 2066 6f72  lel uploads" for
+00003ef0: 2068 6967 6865 7220 7370 6565 6420 2861   higher speed (a
+00003f00: 6e64 726f 6964 2062 7567 290a 2a20 416e  ndroid bug).* An
+00003f10: 6472 6f69 642d 4669 7265 666f 783a 2074  droid-Firefox: t
+00003f20: 616b 6573 2061 2077 6869 6c65 2074 6f20  akes a while to 
+00003f30: 7365 6c65 6374 2066 696c 6573 2028 7468  select files (th
+00003f40: 6569 7220 6669 7820 666f 7220 e298 9def  eir fix for ....
+00003f50: b88f 290a 2a20 4465 736b 746f 702d 4669  ..).* Desktop-Fi
+00003f60: 7265 666f 783a 207e 7e6d 6179 2075 7365  refox: ~~may use
+00003f70: 2067 6967 6162 7974 6573 206f 6620 5241   gigabytes of RA
+00003f80: 4d20 6966 2079 6f75 7220 6669 6c65 7320  M if your files 
+00003f90: 6172 6520 6d61 7373 6976 657e 7e20 2a73  are massive~~ *s
+00003fa0: 6565 6d73 2074 6f20 6265 204f 4b20 6e6f  eems to be OK no
+00003fb0: 772a 0a2a 2044 6573 6b74 6f70 2d46 6972  w*.* Desktop-Fir
+00003fc0: 6566 6f78 3a20 5b6d 6179 2073 746f 7020  efox: [may stop 
+00003fd0: 796f 7520 6672 6f6d 2075 6e70 6c75 6767  you from unplugg
+00003fe0: 696e 6720 5553 4220 666c 6173 6864 7269  ing USB flashdri
+00003ff0: 7665 735d 2868 7474 7073 3a2f 2f62 7567  ves](https://bug
+00004000: 7a69 6c6c 612e 6d6f 7a69 6c6c 612e 6f72  zilla.mozilla.or
+00004010: 672f 7368 6f77 5f62 7567 2e63 6769 3f69  g/show_bug.cgi?i
+00004020: 643d 3137 3932 3539 3829 2075 6e74 696c  d=1792598) until
+00004030: 2079 6f75 2076 6973 6974 2060 6162 6f75   you visit `abou
+00004040: 743a 6d65 6d6f 7279 6020 616e 6420 636c  t:memory` and cl
+00004050: 6963 6b20 604d 696e 696d 697a 6520 6d65  ick `Minimize me
+00004060: 6d6f 7279 2075 7361 6765 600a 0a73 6572  mory usage`..ser
+00004070: 7665 722d 6f73 2d73 7065 6369 6669 633a  ver-os-specific:
+00004080: 0a2a 2052 4845 4c38 202f 2052 6f63 6b79  .* RHEL8 / Rocky
+00004090: 383a 2079 6f75 2063 616e 2072 756e 2063  8: you can run c
+000040a0: 6f70 7970 6172 7479 2075 7369 6e67 2060  opyparty using `
+000040b0: 2f75 7372 2f6c 6962 6578 6563 2f70 6c61  /usr/libexec/pla
+000040c0: 7466 6f72 6d2d 7079 7468 6f6e 600a 0a73  tform-python`..s
+000040d0: 6572 7665 7220 6e6f 7465 733a 0a2a 2070  erver notes:.* p
+000040e0: 7970 7920 6973 2073 7570 706f 7274 6564  ypy is supported
+000040f0: 2062 7574 2072 6567 756c 6172 2063 7079   but regular cpy
+00004100: 7468 6f6e 2069 7320 6661 7374 6572 2069  thon is faster i
+00004110: 6620 796f 7520 656e 6162 6c65 2074 6865  f you enable the
+00004120: 2064 6174 6162 6173 650a 0a0a 2320 6275   database...# bu
+00004130: 6773 0a0a 2a20 5769 6e64 6f77 733a 2070  gs..* Windows: p
+00004140: 7974 686f 6e20 322e 3720 6361 6e6e 6f74  ython 2.7 cannot
+00004150: 2069 6e64 6578 206e 6f6e 2d61 7363 6969   index non-ascii
+00004160: 2066 696c 656e 616d 6573 2077 6974 6820   filenames with 
+00004170: 602d 6532 6460 0a2a 2057 696e 646f 7773  `-e2d`.* Windows
+00004180: 3a20 7079 7468 6f6e 2032 2e37 2063 616e  : python 2.7 can
+00004190: 6e6f 7420 6861 6e64 6c65 2066 696c 656e  not handle filen
+000041a0: 616d 6573 2077 6974 6820 6d6f 6a69 6261  ames with mojiba
+000041b0: 6b65 0a2a 2060 2d2d 7468 2d66 662d 6a70  ke.* `--th-ff-jp
+000041c0: 6760 206d 6179 2066 6978 2076 6964 656f  g` may fix video
+000041d0: 2074 6875 6d62 6e61 696c 7320 6f6e 2073   thumbnails on s
+000041e0: 6f6d 6520 4646 6d70 6567 2076 6572 7369  ome FFmpeg versi
+000041f0: 6f6e 7320 286d 6163 6f73 2c20 736f 6d65  ons (macos, some
+00004200: 206c 696e 7578 290a 2a20 602d 2d74 682d   linux).* `--th-
+00004210: 6666 2d73 7772 6020 6d61 7920 6669 7820  ff-swr` may fix 
+00004220: 6175 6469 6f20 7468 756d 626e 6169 6c73  audio thumbnails
+00004230: 206f 6e20 736f 6d65 2046 466d 7065 6720   on some FFmpeg 
+00004240: 7665 7273 696f 6e73 0a0a 2323 2067 656e  versions..## gen
+00004250: 6572 616c 2062 7567 730a 0a2a 2057 696e  eral bugs..* Win
+00004260: 646f 7773 3a20 6966 2074 6865 2060 7570  dows: if the `up
+00004270: 326b 2e64 6260 2028 6669 6c65 7379 7374  2k.db` (filesyst
+00004280: 656d 2069 6e64 6578 2920 6973 206f 6e20  em index) is on 
+00004290: 6120 7361 6d62 612d 7368 6172 6520 6f72  a samba-share or
+000042a0: 206e 6574 776f 726b 2064 6973 6b2c 2079   network disk, y
+000042b0: 6f75 276c 6c20 6765 7420 756e 7072 6564  ou'll get unpred
+000042c0: 6963 7461 626c 6520 6265 6861 7669 6f72  ictable behavior
+000042d0: 2069 6620 7468 6520 7368 6172 6520 6973   if the share is
+000042e0: 2064 6973 636f 6e6e 6563 7465 6420 666f   disconnected fo
+000042f0: 7220 6120 6269 740a 2020 2a20 7573 6520  r a bit.  * use 
+00004300: 602d 2d68 6973 7460 206f 7220 7468 6520  `--hist` or the 
+00004310: 6068 6973 7460 2076 6f6c 666c 6167 2028  `hist` volflag (
+00004320: 602d 7620 5b2e 2e2e 5d3a 632c 6869 7374  `-v [...]:c,hist
+00004330: 3d2f 746d 702f 666f 6f60 2920 746f 2070  =/tmp/foo`) to p
+00004340: 6c61 6365 2074 6865 2064 6220 6f6e 2061  lace the db on a
+00004350: 206c 6f63 616c 2064 6973 6b20 696e 7374   local disk inst
+00004360: 6561 640a 2a20 616c 6c20 766f 6c75 6d65  ead.* all volume
+00004370: 7320 6d75 7374 2065 7869 7374 202f 2062  s must exist / b
+00004380: 6520 6176 6169 6c61 626c 6520 6f6e 2073  e available on s
+00004390: 7461 7274 7570 3b20 7570 326b 2028 6d74  tartup; up2k (mt
+000043a0: 7020 6573 7065 6369 616c 6c79 2920 6765  p especially) ge
+000043b0: 7473 2066 756e 6b79 206f 7468 6572 7769  ts funky otherwi
+000043c0: 7365 0a2a 2070 726f 6261 626c 7920 6d6f  se.* probably mo
+000043d0: 7265 2c20 706c 7320 6c65 7420 6d65 206b  re, pls let me k
+000043e0: 6e6f 770a 0a23 2320 6e6f 7420 6d79 2062  now..## not my b
+000043f0: 7567 730a 0a2a 205b 4368 726f 6d65 2069  ugs..* [Chrome i
+00004400: 7373 7565 2031 3331 3730 3639 5d28 6874  ssue 1317069](ht
+00004410: 7470 733a 2f2f 6275 6773 2e63 6872 6f6d  tps://bugs.chrom
+00004420: 6975 6d2e 6f72 672f 702f 6368 726f 6d69  ium.org/p/chromi
+00004430: 756d 2f69 7373 7565 732f 6465 7461 696c  um/issues/detail
+00004440: 3f69 643d 3133 3137 3036 3929 202d 2d20  ?id=1317069) -- 
+00004450: 6966 2079 6f75 2074 7279 2074 6f20 7570  if you try to up
+00004460: 6c6f 6164 2061 2066 6f6c 6465 7220 7768  load a folder wh
+00004470: 6963 6820 636f 6e74 6169 6e73 2073 796d  ich contains sym
+00004480: 6c69 6e6b 7320 6279 2064 7261 6767 696e  links by draggin
+00004490: 6720 6974 2069 6e74 6f20 7468 6520 6272  g it into the br
+000044a0: 6f77 7365 722c 2074 6865 2073 796d 6c69  owser, the symli
+000044b0: 6e6b 6564 2066 696c 6573 2077 696c 6c20  nked files will 
+000044c0: 6e6f 7420 6765 7420 7570 6c6f 6164 6564  not get uploaded
+000044d0: 0a0a 2a20 5b43 6872 6f6d 6520 6973 7375  ..* [Chrome issu
+000044e0: 6520 3133 3532 3231 305d 2868 7474 7073  e 1352210](https
+000044f0: 3a2f 2f62 7567 732e 6368 726f 6d69 756d  ://bugs.chromium
+00004500: 2e6f 7267 2f70 2f63 6872 6f6d 6975 6d2f  .org/p/chromium/
+00004510: 6973 7375 6573 2f64 6574 6169 6c3f 6964  issues/detail?id
+00004520: 3d31 3335 3232 3130 2920 2d2d 2070 6c61  =1352210) -- pla
+00004530: 696e 7465 7874 2068 7474 7020 6d61 7920  intext http may 
+00004540: 6265 2066 6173 7465 7220 6174 2066 696c  be faster at fil
+00004550: 6568 6173 6869 6e67 2074 6861 6e20 6874  ehashing than ht
+00004560: 7470 7320 2862 7574 2061 6c73 6f20 6578  tps (but also ex
+00004570: 7472 656d 656c 7920 4350 552d 696e 7465  tremely CPU-inte
+00004580: 6e73 6976 6529 0a0a 2a20 5b46 6972 6566  nsive)..* [Firef
+00004590: 6f78 2069 7373 7565 2031 3739 3035 3030  ox issue 1790500
+000045a0: 5d28 6874 7470 733a 2f2f 6275 677a 696c  ](https://bugzil
+000045b0: 6c61 2e6d 6f7a 696c 6c61 2e6f 7267 2f73  la.mozilla.org/s
+000045c0: 686f 775f 6275 672e 6367 693f 6964 3d31  how_bug.cgi?id=1
+000045d0: 3739 3035 3030 2920 2d2d 2065 6e74 6972  790500) -- entir
+000045e0: 6520 6272 6f77 7365 7220 6361 6e20 6372  e browser can cr
+000045f0: 6173 6820 6166 7465 7220 7570 6c6f 6164  ash after upload
+00004600: 696e 6720 7e34 3030 3020 736d 616c 6c20  ing ~4000 small 
+00004610: 6669 6c65 730a 0a2a 2041 6e64 726f 6964  files..* Android
+00004620: 3a20 6d75 7369 6320 706c 6179 6261 636b  : music playback
+00004630: 2072 616e 646f 6d6c 7920 7374 6f70 7320   randomly stops 
+00004640: 6475 6520 746f 205b 6261 7474 6572 7920  due to [battery 
+00004650: 7573 6167 6520 7365 7474 696e 6773 5d28  usage settings](
+00004660: 2366 6978 2d75 6e72 656c 6961 626c 652d  #fix-unreliable-
+00004670: 706c 6179 6261 636b 2d6f 6e2d 616e 6472  playback-on-andr
+00004680: 6f69 6429 0a0a 2a20 6950 686f 6e65 733a  oid)..* iPhones:
+00004690: 2074 6865 2076 6f6c 756d 6520 636f 6e74   the volume cont
+000046a0: 726f 6c20 646f 6573 6e27 7420 776f 726b  rol doesn't work
+000046b0: 2062 6563 6175 7365 205b 6170 706c 6520   because [apple 
+000046c0: 646f 6573 6e27 7420 7761 6e74 2069 7420  doesn't want it 
+000046d0: 746f 5d28 6874 7470 733a 2f2f 6465 7665  to](https://deve
+000046e0: 6c6f 7065 722e 6170 706c 652e 636f 6d2f  loper.apple.com/
+000046f0: 6c69 6272 6172 792f 6172 6368 6976 652f  library/archive/
+00004700: 646f 6375 6d65 6e74 6174 696f 6e2f 4175  documentation/Au
+00004710: 6469 6f56 6964 656f 2f43 6f6e 6365 7074  dioVideo/Concept
+00004720: 7561 6c2f 5573 696e 675f 4854 4d4c 355f  ual/Using_HTML5_
+00004730: 4175 6469 6f5f 5669 6465 6f2f 4465 7669  Audio_Video/Devi
+00004740: 6365 2d53 7065 6369 6669 6343 6f6e 7369  ce-SpecificConsi
+00004750: 6465 7261 7469 6f6e 732f 4465 7669 6365  derations/Device
+00004760: 2d53 7065 6369 6669 6343 6f6e 7369 6465  -SpecificConside
+00004770: 7261 7469 6f6e 732e 6874 6d6c 232f 2f61  rations.html#//a
+00004780: 7070 6c65 5f72 6566 2f64 6f63 2f75 6964  pple_ref/doc/uid
+00004790: 2f54 5034 3030 3039 3532 332d 4348 352d  /TP40009523-CH5-
+000047a0: 5357 3131 290a 2020 2a20 2a66 7574 7572  SW11).  * *futur
+000047b0: 6520 776f 726b 6172 6f75 6e64 3a2a 2065  e workaround:* e
+000047c0: 6e61 626c 6520 7468 6520 6571 7561 6c69  nable the equali
+000047d0: 7a65 722c 206d 616b 6520 6974 2061 6c6c  zer, make it all
+000047e0: 2d7a 6572 6f2c 2061 6e64 2073 6574 2061  -zero, and set a
+000047f0: 206e 6567 6174 6976 6520 626f 6f73 7420   negative boost 
+00004800: 746f 2072 6564 7563 6520 7468 6520 766f  to reduce the vo
+00004810: 6c75 6d65 0a20 2020 202a 2022 6675 7475  lume.    * "futu
+00004820: 7265 2220 6265 6361 7573 6520 6041 7564  re" because `Aud
+00004830: 696f 436f 6e74 6578 7460 2063 616e 2774  ioContext` can't
+00004840: 206d 6169 6e74 6169 6e20 6120 7374 6162   maintain a stab
+00004850: 6c65 2070 6c61 7962 6163 6b20 7370 6565  le playback spee
+00004860: 6420 696e 2074 6865 2063 7572 7265 6e74  d in the current
+00004870: 2069 4f53 2076 6572 7369 6f6e 2028 3135   iOS version (15
+00004880: 2e37 292c 206d 6179 6265 206f 6e65 2064  .7), maybe one d
+00004890: 6179 2e2e 2e0a 0a2a 2057 696e 646f 7773  ay.....* Windows
+000048a0: 3a20 666f 6c64 6572 7320 6361 6e6e 6f74  : folders cannot
+000048b0: 2062 6520 6163 6365 7373 6564 2069 6620   be accessed if 
+000048c0: 7468 6520 6e61 6d65 2065 6e64 7320 7769  the name ends wi
+000048d0: 7468 2060 2e60 0a20 202a 2070 7974 686f  th `.`.  * pytho
+000048e0: 6e20 6f72 2077 696e 646f 7773 2062 7567  n or windows bug
+000048f0: 0a0a 2a20 5769 6e64 6f77 733a 206d 7379  ..* Windows: msy
+00004900: 7332 2d70 7974 686f 6e20 332e 382e 3620  s2-python 3.8.6 
+00004910: 6f63 6361 7369 6f6e 616c 6c79 2074 6872  occasionally thr
+00004920: 6f77 7320 6052 756e 7469 6d65 4572 726f  ows `RuntimeErro
+00004930: 723a 2072 656c 6561 7365 2075 6e6c 6f63  r: release unloc
+00004940: 6b65 6420 6c6f 636b 6020 7768 656e 206c  ked lock` when l
+00004950: 6561 7669 6e67 2061 2073 636f 7065 6420  eaving a scoped 
+00004960: 6d75 7465 7820 696e 2075 7032 6b0a 2020  mutex in up2k.  
+00004970: 2a20 7468 6973 2069 7320 616e 206d 7379  * this is an msy
+00004980: 7332 2062 7567 2c20 7468 6520 7265 6775  s2 bug, the regu
+00004990: 6c61 7220 7769 6e64 6f77 7320 6564 6974  lar windows edit
+000049a0: 696f 6e20 6f66 2070 7974 686f 6e20 6973  ion of python is
+000049b0: 2066 696e 650a 0a2a 2056 6972 7475 616c   fine..* Virtual
+000049c0: 426f 783a 2073 716c 6974 6520 7468 726f  Box: sqlite thro
+000049d0: 7773 2060 4469 736b 2049 2f4f 2045 7272  ws `Disk I/O Err
+000049e0: 6f72 6020 7768 656e 2072 756e 6e69 6e67  or` when running
+000049f0: 2069 6e20 6120 564d 2061 6e64 2074 6865   in a VM and the
+00004a00: 2075 7032 6b20 6461 7461 6261 7365 2069   up2k database i
+00004a10: 7320 696e 2061 2076 626f 7873 660a 2020  s in a vboxsf.  
+00004a20: 2a20 7573 6520 602d 2d68 6973 7460 206f  * use `--hist` o
+00004a30: 7220 7468 6520 6068 6973 7460 2076 6f6c  r the `hist` vol
+00004a40: 666c 6167 2028 602d 7620 5b2e 2e2e 5d3a  flag (`-v [...]:
+00004a50: 632c 6869 7374 3d2f 746d 702f 666f 6f60  c,hist=/tmp/foo`
+00004a60: 2920 746f 2070 6c61 6365 2074 6865 2064  ) to place the d
+00004a70: 6220 696e 7369 6465 2074 6865 2076 6d20  b inside the vm 
+00004a80: 696e 7374 6561 640a 0a2a 2055 6275 6e74  instead..* Ubunt
+00004a90: 753a 2064 7261 6767 696e 6720 6669 6c65  u: dragging file
+00004aa0: 7320 6672 6f6d 2063 6572 7461 696e 2066  s from certain f
+00004ab0: 6f6c 6465 7273 2069 6e74 6f20 6669 7265  olders into fire
+00004ac0: 666f 7820 6f72 2063 6872 6f6d 6520 6973  fox or chrome is
+00004ad0: 2069 6d70 6f73 7369 626c 650a 2020 2a20   impossible.  * 
+00004ae0: 6475 6520 746f 2073 6e61 7020 7365 6375  due to snap secu
+00004af0: 7269 7479 2070 6f6c 6963 6965 7320 2d2d  rity policies --
+00004b00: 2073 6565 2060 736e 6170 2063 6f6e 6e65   see `snap conne
+00004b10: 6374 696f 6e73 2066 6972 6566 6f78 6020  ctions firefox` 
+00004b20: 666f 7220 7468 6520 616c 6c6f 776c 6973  for the allowlis
+00004b30: 742c 2060 7265 6d6f 7661 626c 652d 6d65  t, `removable-me
+00004b40: 6469 6160 2070 6572 6d69 7473 2061 6c6c  dia` permits all
+00004b50: 206f 6620 602f 6d6e 7460 2061 6e64 2060   of `/mnt` and `
+00004b60: 2f6d 6564 6961 6020 6170 7061 7265 6e74  /media` apparent
+00004b70: 6c79 0a0a 0a23 2062 7265 616b 696e 6720  ly...# breaking 
+00004b80: 6368 616e 6765 730a 0a75 7067 7261 6465  changes..upgrade
+00004b90: 206e 6f74 6573 0a0a 2a20 6031 2e36 2e30   notes..* `1.6.0
+00004ba0: 6020 2832 3032 332d 3031 2d32 3929 3a0a  ` (2023-01-29):.
+00004bb0: 2020 2a20 6874 7470 2d61 7069 3a20 6465    * http-api: de
+00004bc0: 6c65 7465 2f6d 6f76 6520 6973 206e 6f77  lete/move is now
+00004bd0: 2060 504f 5354 6020 696e 7374 6561 6420   `POST` instead 
+00004be0: 6f66 2060 4745 5460 0a20 202a 2065 7665  of `GET`.  * eve
+00004bf0: 7279 7468 696e 6720 6f74 6865 7220 7468  rything other th
+00004c00: 616e 2060 4745 5460 2061 6e64 2060 4845  an `GET` and `HE
+00004c10: 4144 6020 6d75 7374 2070 6173 7320 5b63  AD` must pass [c
+00004c20: 6f72 7320 7661 6c69 6461 7469 6f6e 5d28  ors validation](
+00004c30: 2363 6f72 7329 0a2a 2060 312e 352e 3060  #cors).* `1.5.0`
+00004c40: 2028 3230 3232 2d31 322d 3033 293a 205b   (2022-12-03): [
+00004c50: 6e65 7720 6368 756e 6b73 697a 6520 666f  new chunksize fo
+00004c60: 726d 756c 615d 2868 7474 7073 3a2f 2f67  rmula](https://g
+00004c70: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
+00004c80: 6f70 7970 6172 7479 2f63 6f6d 6d69 742f  opyparty/commit/
+00004c90: 3534 6531 6338 6432 3631 6466 2920 666f  54e1c8d261df) fo
+00004ca0: 7220 6669 6c65 7320 6c61 7267 6572 2074  r files larger t
+00004cb0: 6861 6e20 3132 3820 4769 420a 2020 2a20  han 128 GiB.  * 
+00004cc0: 2a2a 7573 6572 733a 2a2a 2075 7067 7261  **users:** upgra
+00004cd0: 6465 2074 6f20 7468 6520 6c61 7465 7374  de to the latest
+00004ce0: 205b 636c 6920 7570 6c6f 6164 6572 5d28   [cli uploader](
+00004cf0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00004d00: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00004d10: 792f 626c 6f62 2f68 6f76 7564 7374 7261  y/blob/hovudstra
+00004d20: 756d 2f62 696e 2f75 7032 6b2e 7079 2920  um/bin/up2k.py) 
+00004d30: 6966 2079 6f75 2075 7365 2074 6861 740a  if you use that.
+00004d40: 2020 2a20 2a2a 6465 7673 3a2a 2a20 7570    * **devs:** up
+00004d50: 6461 7465 2074 6869 7264 2d70 6172 7479  date third-party
+00004d60: 2075 7032 6b20 636c 6965 6e74 7320 2869   up2k clients (i
+00004d70: 6620 7468 6f73 6520 6576 656e 2065 7869  f those even exi
+00004d80: 7374 290a 0a0a 2320 4641 510a 0a22 6672  st)...# FAQ.."fr
+00004d90: 6571 7565 6e74 6c79 2220 6173 6b65 6420  equently" asked 
+00004da0: 7175 6573 7469 6f6e 730a 0a2a 2069 7320  questions..* is 
+00004db0: 6974 2070 6f73 7369 626c 6520 746f 2062  it possible to b
+00004dc0: 6c6f 636b 2072 6561 642d 6163 6365 7373  lock read-access
+00004dd0: 2074 6f20 666f 6c64 6572 7320 756e 6c65   to folders unle
+00004de0: 7373 2079 6f75 206b 6e6f 7720 7468 6520  ss you know the 
+00004df0: 6578 6163 7420 5552 4c20 666f 7220 6120  exact URL for a 
+00004e00: 7061 7274 6963 756c 6172 2066 696c 6520  particular file 
+00004e10: 696e 7369 6465 3f0a 2020 2a20 7965 732c  inside?.  * yes,
+00004e20: 2075 7369 6e67 2074 6865 205b 6067 6020   using the [`g` 
+00004e30: 7065 726d 6973 7369 6f6e 5d28 2361 6363  permission](#acc
+00004e40: 6f75 6e74 732d 616e 642d 766f 6c75 6d65  ounts-and-volume
+00004e50: 7329 2c20 7365 6520 7468 6520 6578 616d  s), see the exam
+00004e60: 706c 6573 2074 6865 7265 0a20 202a 2079  ples there.  * y
+00004e70: 6f75 2063 616e 2061 6c73 6f20 646f 2074  ou can also do t
+00004e80: 6869 7320 7769 7468 206c 696e 7578 2066  his with linux f
+00004e90: 696c 6573 7973 7465 6d20 7065 726d 6973  ilesystem permis
+00004ea0: 7369 6f6e 733b 2060 6368 6d6f 6420 3131  sions; `chmod 11
+00004eb0: 3120 6d75 7369 6360 2077 696c 6c20 6d61  1 music` will ma
+00004ec0: 6b65 2069 7420 706f 7373 6962 6c65 2074  ke it possible t
+00004ed0: 6f20 6163 6365 7373 2066 696c 6573 2061  o access files a
+00004ee0: 6e64 2066 6f6c 6465 7273 2069 6e73 6964  nd folders insid
+00004ef0: 6520 7468 6520 606d 7573 6963 6020 666f  e the `music` fo
+00004f00: 6c64 6572 2062 7574 206e 6f74 206c 6973  lder but not lis
+00004f10: 7420 7468 6520 696d 6d65 6469 6174 6520  t the immediate 
+00004f20: 636f 6e74 656e 7473 202d 2d20 616c 736f  contents -- also
+00004f30: 2077 6f72 6b73 2077 6974 6820 6f74 6865   works with othe
+00004f40: 7220 736f 6674 7761 7265 2c20 6e6f 7420  r software, not 
+00004f50: 6a75 7374 2063 6f70 7970 6172 7479 0a0a  just copyparty..
+00004f60: 2a20 6361 6e20 4920 6d61 6b65 2063 6f70  * can I make cop
+00004f70: 7970 6172 7479 2064 6f77 6e6c 6f61 6420  yparty download 
+00004f80: 6120 6669 6c65 2074 6f20 6d79 2073 6572  a file to my ser
+00004f90: 7665 7220 6966 2049 2067 6976 6520 6974  ver if I give it
+00004fa0: 2061 2055 524c 3f0a 2020 2a20 7965 732c   a URL?.  * yes,
+00004fb0: 2075 7369 6e67 205b 686f 6f6b 735d 2868   using [hooks](h
+00004fc0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00004fd0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+00004fe0: 2f62 6c6f 622f 686f 7675 6473 7472 6175  /blob/hovudstrau
+00004ff0: 6d2f 6269 6e2f 686f 6f6b 732f 7767 6574  m/bin/hooks/wget
+00005000: 2e70 7929 0a0a 0a23 2061 6363 6f75 6e74  .py)...# account
+00005010: 7320 616e 6420 766f 6c75 6d65 730a 0a70  s and volumes..p
+00005020: 6572 2d66 6f6c 6465 722c 2070 6572 2d75  er-folder, per-u
+00005030: 7365 7220 7065 726d 6973 7369 6f6e 7320  ser permissions 
+00005040: 202d 2069 6620 796f 7572 2073 6574 7570   - if your setup
+00005050: 2069 7320 6765 7474 696e 6720 636f 6d70   is getting comp
+00005060: 6c65 782c 2063 6f6e 7369 6465 7220 6d61  lex, consider ma
+00005070: 6b69 6e67 2061 205b 636f 6e66 6967 2066  king a [config f
+00005080: 696c 655d 282e 2f64 6f63 732f 6578 616d  ile](./docs/exam
+00005090: 706c 652e 636f 6e66 2920 696e 7374 6561  ple.conf) instea
+000050a0: 6420 6f66 2075 7369 6e67 2061 7267 756d  d of using argum
+000050b0: 656e 7473 0a2a 206d 7563 6820 6561 7369  ents.* much easi
+000050c0: 6572 2074 6f20 6d61 6e61 6765 2c20 616e  er to manage, an
+000050d0: 6420 796f 7520 6361 6e20 6d6f 6469 6679  d you can modify
+000050e0: 2074 6865 2063 6f6e 6669 6720 6174 2072   the config at r
+000050f0: 756e 7469 6d65 2077 6974 6820 6073 7973  untime with `sys
+00005100: 7465 6d63 746c 2072 656c 6f61 6420 636f  temctl reload co
+00005110: 7079 7061 7274 7960 206f 7220 6d6f 7265  pyparty` or more
+00005120: 2063 6f6e 7665 6e69 656e 746c 7920 7573   conveniently us
+00005130: 696e 6720 7468 6520 605b 7265 6c6f 6164  ing the `[reload
+00005140: 2063 6667 5d60 2062 7574 746f 6e20 696e   cfg]` button in
+00005150: 2074 6865 2063 6f6e 7472 6f6c 2d70 616e   the control-pan
+00005160: 656c 2028 6966 206c 6f67 6765 6420 696e  el (if logged in
+00005170: 2061 7320 6164 6d69 6e29 0a20 202a 2063   as admin).  * c
+00005180: 6861 6e67 6573 2074 6f20 7468 6520 605b  hanges to the `[
+00005190: 676c 6f62 616c 5d60 2063 6f6e 6669 6720  global]` config 
+000051a0: 7365 6374 696f 6e20 7265 7175 6972 6573  section requires
+000051b0: 2061 2072 6573 7461 7274 2074 6f20 7461   a restart to ta
+000051c0: 6b65 2065 6666 6563 740a 0a61 2071 7569  ke effect..a qui
+000051d0: 636b 2073 756d 6d61 7279 2063 616e 2062  ck summary can b
+000051e0: 6520 7365 656e 2075 7369 6e67 2060 2d2d  e seen using `--
+000051f0: 6865 6c70 2d61 6363 6f75 6e74 7360 0a0a  help-accounts`..
+00005200: 636f 6e66 6967 7572 696e 6720 6163 636f  configuring acco
+00005210: 756e 7473 2f76 6f6c 756d 6573 2077 6974  unts/volumes wit
+00005220: 6820 6172 6775 6d65 6e74 733a 0a2a 2060  h arguments:.* `
+00005230: 2d61 2075 7372 3a70 7764 6020 6164 6473  -a usr:pwd` adds
+00005240: 2061 6363 6f75 6e74 2060 7573 7260 2077   account `usr` w
+00005250: 6974 6820 7061 7373 776f 7264 2060 7077  ith password `pw
+00005260: 6460 0a2a 2060 2d76 202e 3a3a 7260 2061  d`.* `-v .::r` a
+00005270: 6464 7320 6375 7272 656e 742d 666f 6c64  dds current-fold
+00005280: 6572 2060 2e60 2061 7320 7468 6520 7765  er `.` as the we
+00005290: 6272 6f6f 742c 2060 7260 6561 6461 626c  broot, `r`eadabl
+000052a0: 6520 6279 2061 6e79 6f6e 650a 2020 2a20  e by anyone.  * 
+000052b0: 7468 6520 7379 6e74 6178 2069 7320 602d  the syntax is `-
+000052c0: 7620 7372 633a 6473 743a 7065 726d 3a70  v src:dst:perm:p
+000052d0: 6572 6d3a 2e2e 2e60 2073 6f20 6c6f 6361  erm:...` so loca
+000052e0: 6c2d 7061 7468 2c20 7572 6c2d 7061 7468  l-path, url-path
+000052f0: 2c20 616e 6420 6f6e 6520 6f72 206d 6f72  , and one or mor
+00005300: 6520 7065 726d 6973 7369 6f6e 7320 746f  e permissions to
+00005310: 2073 6574 0a20 202a 2067 7261 6e74 696e   set.  * grantin
+00005320: 6720 7468 6520 7361 6d65 2070 6572 6d69  g the same permi
+00005330: 7373 696f 6e73 2074 6f20 6d75 6c74 6970  ssions to multip
+00005340: 6c65 2061 6363 6f75 6e74 733a 2020 0a20  le accounts:  . 
+00005350: 2020 2060 2d76 202e 3a3a 722c 7573 7231     `-v .::r,usr1
+00005360: 2c75 7372 323a 7277 2c75 7372 332c 7573  ,usr2:rw,usr3,us
+00005370: 7234 6020 3d20 7573 7231 2f32 2072 6561  r4` = usr1/2 rea
+00005380: 642d 6f6e 6c79 2c20 332f 3420 7265 6164  d-only, 3/4 read
+00005390: 2d77 7269 7465 0a0a 7065 726d 6973 7369  -write..permissi
+000053a0: 6f6e 733a 0a2a 2060 7260 2028 7265 6164  ons:.* `r` (read
+000053b0: 293a 2062 726f 7773 6520 666f 6c64 6572  ): browse folder
+000053c0: 2063 6f6e 7465 6e74 732c 2064 6f77 6e6c   contents, downl
+000053d0: 6f61 6420 6669 6c65 732c 2064 6f77 6e6c  oad files, downl
+000053e0: 6f61 6420 6173 207a 6970 2f74 6172 0a2a  oad as zip/tar.*
+000053f0: 2060 7760 2028 7772 6974 6529 3a20 7570   `w` (write): up
+00005400: 6c6f 6164 2066 696c 6573 2c20 6d6f 7665  load files, move
+00005410: 2066 696c 6573 202a 696e 746f 2a20 7468   files *into* th
+00005420: 6973 2066 6f6c 6465 720a 2a20 606d 6020  is folder.* `m` 
+00005430: 286d 6f76 6529 3a20 6d6f 7665 2066 696c  (move): move fil
+00005440: 6573 2f66 6f6c 6465 7273 202a 6672 6f6d  es/folders *from
+00005450: 2a20 7468 6973 2066 6f6c 6465 720a 2a20  * this folder.* 
+00005460: 6064 6020 2864 656c 6574 6529 3a20 6465  `d` (delete): de
+00005470: 6c65 7465 2066 696c 6573 2f66 6f6c 6465  lete files/folde
+00005480: 7273 0a2a 2060 6760 2028 6765 7429 3a20  rs.* `g` (get): 
+00005490: 6f6e 6c79 2064 6f77 6e6c 6f61 6420 6669  only download fi
+000054a0: 6c65 732c 2063 616e 6e6f 7420 7365 6520  les, cannot see 
+000054b0: 666f 6c64 6572 2063 6f6e 7465 6e74 7320  folder contents 
+000054c0: 6f72 207a 6970 2f74 6172 0a2a 2060 4760  or zip/tar.* `G`
+000054d0: 2028 7570 6765 7429 3a20 7361 6d65 2061   (upget): same a
+000054e0: 7320 6067 6020 6578 6365 7074 2075 706c  s `g` except upl
+000054f0: 6f61 6465 7273 2067 6574 2074 6f20 7365  oaders get to se
+00005500: 6520 7468 6569 7220 6f77 6e20 6669 6c65  e their own file
+00005510: 6b65 7973 2028 7365 6520 6066 6b60 2069  keys (see `fk` i
+00005520: 6e20 6578 616d 706c 6573 2062 656c 6f77  n examples below
+00005530: 290a 0a65 7861 6d70 6c65 733a 0a2a 2061  )..examples:.* a
+00005540: 6464 2061 6363 6f75 6e74 7320 6e61 6d65  dd accounts name
+00005550: 6420 7531 2c20 7532 2c20 7533 2077 6974  d u1, u2, u3 wit
+00005560: 6820 7061 7373 776f 7264 7320 7031 2c20  h passwords p1, 
+00005570: 7032 2c20 7033 3a20 602d 6120 7531 3a70  p2, p3: `-a u1:p
+00005580: 3120 2d61 2075 323a 7032 202d 6120 7533  1 -a u2:p2 -a u3
+00005590: 3a70 3360 0a2a 206d 616b 6520 666f 6c64  :p3`.* make fold
+000055a0: 6572 2060 2f73 7276 6020 7468 6520 726f  er `/srv` the ro
+000055b0: 6f74 206f 6620 7468 6520 6669 6c65 7379  ot of the filesy
+000055c0: 7374 656d 2c20 7265 6164 2d6f 6e6c 7920  stem, read-only 
+000055d0: 6279 2061 6e79 6f6e 653a 2060 2d76 202f  by anyone: `-v /
+000055e0: 7372 763a 3a72 600a 2a20 6d61 6b65 2066  srv::r`.* make f
+000055f0: 6f6c 6465 7220 602f 6d6e 742f 6d75 7369  older `/mnt/musi
+00005600: 6360 2061 7661 696c 6162 6c65 2061 7420  c` available at 
+00005610: 602f 6d75 7369 6360 2c20 7265 6164 2d6f  `/music`, read-o
+00005620: 6e6c 7920 666f 7220 7531 2061 6e64 2075  nly for u1 and u
+00005630: 322c 2072 6561 642d 7772 6974 6520 666f  2, read-write fo
+00005640: 7220 7533 3a20 602d 7620 2f6d 6e74 2f6d  r u3: `-v /mnt/m
+00005650: 7573 6963 3a6d 7573 6963 3a72 2c75 312c  usic:music:r,u1,
+00005660: 7532 3a72 772c 7533 600a 2020 2a20 756e  u2:rw,u3`.  * un
+00005670: 6175 7468 6f72 697a 6564 2075 7365 7273  authorized users
+00005680: 2061 6363 6573 7369 6e67 2074 6865 2077   accessing the w
+00005690: 6562 726f 6f74 2063 616e 2073 6565 2074  ebroot can see t
+000056a0: 6861 7420 7468 6520 606d 7573 6963 6020  hat the `music` 
+000056b0: 666f 6c64 6572 2065 7869 7374 732c 2062  folder exists, b
+000056c0: 7574 2063 616e 6e6f 7420 6f70 656e 2069  ut cannot open i
+000056d0: 740a 2a20 6d61 6b65 2066 6f6c 6465 7220  t.* make folder 
+000056e0: 602f 6d6e 742f 696e 636f 6d69 6e67 6020  `/mnt/incoming` 
+000056f0: 6176 6169 6c61 626c 6520 6174 2060 2f69  available at `/i
+00005700: 6e63 602c 2077 7269 7465 2d6f 6e6c 7920  nc`, write-only 
+00005710: 666f 7220 7531 2c20 7265 6164 2d6d 6f76  for u1, read-mov
+00005720: 6520 666f 7220 7532 3a20 602d 7620 2f6d  e for u2: `-v /m
+00005730: 6e74 2f69 6e63 6f6d 696e 673a 696e 633a  nt/incoming:inc:
+00005740: 772c 7531 3a72 6d2c 7532 600a 2020 2a20  w,u1:rm,u2`.  * 
+00005750: 756e 6175 7468 6f72 697a 6564 2075 7365  unauthorized use
+00005760: 7273 2061 6363 6573 7369 6e67 2074 6865  rs accessing the
+00005770: 2077 6562 726f 6f74 2063 616e 2073 6565   webroot can see
+00005780: 2074 6861 7420 7468 6520 6069 6e63 6020   that the `inc` 
+00005790: 666f 6c64 6572 2065 7869 7374 732c 2062  folder exists, b
+000057a0: 7574 2063 616e 6e6f 7420 6f70 656e 2069  ut cannot open i
+000057b0: 740a 2020 2a20 6075 3160 2063 616e 206f  t.  * `u1` can o
+000057c0: 7065 6e20 7468 6520 6069 6e63 6020 666f  pen the `inc` fo
+000057d0: 6c64 6572 2c20 6275 7420 6361 6e6e 6f74  lder, but cannot
+000057e0: 2073 6565 2074 6865 2063 6f6e 7465 6e74   see the content
+000057f0: 732c 206f 6e6c 7920 7570 6c6f 6164 206e  s, only upload n
+00005800: 6577 2066 696c 6573 2074 6f20 6974 0a20  ew files to it. 
+00005810: 202a 2060 7532 6020 6361 6e20 6272 6f77   * `u2` can brow
+00005820: 7365 2069 7420 616e 6420 6d6f 7665 2066  se it and move f
+00005830: 696c 6573 202a 6672 6f6d 2a20 602f 696e  iles *from* `/in
+00005840: 6360 2069 6e74 6f20 616e 7920 666f 6c64  c` into any fold
+00005850: 6572 2077 6865 7265 2060 7532 6020 6861  er where `u2` ha
+00005860: 7320 7772 6974 652d 6163 6365 7373 0a2a  s write-access.*
+00005870: 206d 616b 6520 666f 6c64 6572 2060 2f6d   make folder `/m
+00005880: 6e74 2f73 7360 2061 7661 696c 6162 6c65  nt/ss` available
+00005890: 2061 7420 602f 6960 2c20 7265 6164 2d77   at `/i`, read-w
+000058a0: 7269 7465 2066 6f72 2075 312c 2067 6574  rite for u1, get
+000058b0: 2d6f 6e6c 7920 666f 7220 6576 6572 796f  -only for everyo
+000058c0: 6e65 2065 6c73 652c 2061 6e64 2065 6e61  ne else, and ena
+000058d0: 626c 6520 6669 6c65 6b65 7973 3a20 602d  ble filekeys: `-
+000058e0: 7620 2f6d 6e74 2f73 733a 693a 7277 2c75  v /mnt/ss:i:rw,u
+000058f0: 313a 673a 632c 666b 3d34 600a 2020 2a20  1:g:c,fk=4`.  * 
+00005900: 6063 2c66 6b3d 3460 2073 6574 7320 7468  `c,fk=4` sets th
+00005910: 6520 6066 6b60 2028 6669 6c65 6b65 7929  e `fk` (filekey)
+00005920: 2076 6f6c 666c 6167 2074 6f20 342c 206d   volflag to 4, m
+00005930: 6561 6e69 6e67 2065 6163 6820 6669 6c65  eaning each file
+00005940: 2067 6574 7320 6120 342d 6368 6172 6163   gets a 4-charac
+00005950: 7465 7220 6163 6365 7373 6b65 790a 2020  ter accesskey.  
+00005960: 2a20 6075 3160 2063 616e 2075 706c 6f61  * `u1` can uploa
+00005970: 6420 6669 6c65 732c 2062 726f 7773 6520  d files, browse 
+00005980: 7468 6520 666f 6c64 6572 2c20 616e 6420  the folder, and 
+00005990: 7365 6520 7468 6520 6765 6e65 7261 7465  see the generate
+000059a0: 6420 6669 6c65 6b65 7973 0a20 202a 206f  d filekeys.  * o
+000059b0: 7468 6572 2075 7365 7273 2063 616e 6e6f  ther users canno
+000059c0: 7420 6272 6f77 7365 2074 6865 2066 6f6c  t browse the fol
+000059d0: 6465 722c 2062 7574 2063 616e 2061 6363  der, but can acc
+000059e0: 6573 7320 7468 6520 6669 6c65 7320 6966  ess the files if
+000059f0: 2074 6865 7920 6861 7665 2074 6865 2066   they have the f
+00005a00: 756c 6c20 6669 6c65 2055 524c 2077 6974  ull file URL wit
+00005a10: 6820 7468 6520 6669 6c65 6b65 790a 2020  h the filekey.  
+00005a20: 2a20 7265 706c 6163 696e 6720 7468 6520  * replacing the 
+00005a30: 6067 6020 7065 726d 6973 7369 6f6e 2077  `g` permission w
+00005a40: 6974 6820 6077 6760 2077 6f75 6c64 206c  ith `wg` would l
+00005a50: 6574 2061 6e6f 6e79 6d6f 7573 2075 7365  et anonymous use
+00005a60: 7273 2075 706c 6f61 6420 6669 6c65 732c  rs upload files,
+00005a70: 2062 7574 206e 6f74 2073 6565 2074 6865   but not see the
+00005a80: 2072 6571 7569 7265 6420 6669 6c65 6b65   required fileke
+00005a90: 7920 746f 2061 6363 6573 7320 6974 0a20  y to access it. 
+00005aa0: 202a 2072 6570 6c61 6369 6e67 2074 6865   * replacing the
+00005ab0: 2060 6760 2070 6572 6d69 7373 696f 6e20   `g` permission 
+00005ac0: 7769 7468 2060 7747 6020 776f 756c 6420  with `wG` would 
+00005ad0: 6c65 7420 616e 6f6e 796d 6f75 7320 7573  let anonymous us
+00005ae0: 6572 7320 7570 6c6f 6164 2066 696c 6573  ers upload files
+00005af0: 2c20 7265 6365 6976 696e 6720 6120 776f  , receiving a wo
+00005b00: 726b 696e 6720 6469 7265 6374 206c 696e  rking direct lin
+00005b10: 6b20 696e 2072 6574 7572 6e0a 0a61 6e79  k in return..any
+00005b20: 6f6e 6520 7472 7969 6e67 2074 6f20 6272  one trying to br
+00005b30: 7574 6566 6f72 6365 2061 2070 6173 7377  uteforce a passw
+00005b40: 6f72 6420 6765 7473 2062 616e 6e65 6420  ord gets banned 
+00005b50: 6163 636f 7264 696e 6720 746f 2060 2d2d  according to `--
+00005b60: 6261 6e2d 7077 603b 2064 6566 6175 6c74  ban-pw`; default
+00005b70: 2069 7320 3234 6820 6261 6e20 666f 7220   is 24h ban for 
+00005b80: 3920 6661 696c 6564 2061 7474 656d 7074  9 failed attempt
+00005b90: 7320 696e 2031 2068 6f75 720a 0a0a 2323  s in 1 hour...##
+00005ba0: 2073 6861 646f 7769 6e67 0a0a 6869 6469   shadowing..hidi
+00005bb0: 6e67 2073 7065 6369 6669 6320 7375 6266  ng specific subf
+00005bc0: 6f6c 6465 7273 2020 6279 206d 6f75 6e74  olders  by mount
+00005bd0: 696e 6720 616e 6f74 6865 7220 766f 6c75  ing another volu
+00005be0: 6d65 206f 6e20 746f 7020 6f66 2074 6865  me on top of the
+00005bf0: 6d0a 0a66 6f72 2065 7861 6d70 6c65 2060  m..for example `
+00005c00: 2d76 202f 6d6e 743a 3a72 202d 7620 2f76  -v /mnt::r -v /v
+00005c10: 6172 2f65 6d70 7479 3a77 6562 2f63 6572  ar/empty:web/cer
+00005c20: 7473 3a72 6020 6d6f 756e 7473 2074 6865  ts:r` mounts the
+00005c30: 2073 6572 7665 7220 666f 6c64 6572 2060   server folder `
+00005c40: 2f6d 6e74 6020 6173 2074 6865 2077 6562  /mnt` as the web
+00005c50: 726f 6f74 2c20 6275 7420 616e 6f74 6865  root, but anothe
+00005c60: 7220 766f 6c75 6d65 2069 7320 6d6f 756e  r volume is moun
+00005c70: 7465 6420 6174 2060 2f77 6562 2f63 6572  ted at `/web/cer
+00005c80: 7473 6020 2d2d 2073 6f20 7669 7369 746f  ts` -- so visito
+00005c90: 7273 2063 616e 206f 6e6c 7920 7365 6520  rs can only see 
+00005ca0: 7468 6520 636f 6e74 656e 7473 206f 6620  the contents of 
+00005cb0: 602f 6d6e 7460 2061 6e64 2060 2f6d 6e74  `/mnt` and `/mnt
+00005cc0: 2f77 6562 6020 2861 7420 5552 4c73 2060  /web` (at URLs `
+00005cd0: 2f60 2061 6e64 2060 2f77 6562 6029 2c20  /` and `/web`), 
+00005ce0: 6275 7420 6e6f 7420 602f 6d6e 742f 7765  but not `/mnt/we
+00005cf0: 622f 6365 7274 7360 2062 6563 6175 7365  b/certs` because
+00005d00: 2055 524c 2060 2f77 6562 2f63 6572 7473   URL `/web/certs
+00005d10: 6020 6973 206d 6170 7065 6420 746f 2060  ` is mapped to `
+00005d20: 2f76 6172 2f65 6d70 7479 600a 0a0a 2320  /var/empty`...# 
+00005d30: 7468 6520 6272 6f77 7365 720a 0a61 6363  the browser..acc
+00005d40: 6573 7369 6e67 2061 2063 6f70 7970 6172  essing a copypar
+00005d50: 7479 2073 6572 7665 7220 7573 696e 6720  ty server using 
+00005d60: 6120 7765 622d 6272 6f77 7365 720a 0a21  a web-browser..!
+00005d70: 5b63 6f70 7970 6172 7479 2d62 726f 7773  [copyparty-brows
+00005d80: 6572 2d66 7338 5d28 6874 7470 733a 2f2f  er-fs8](https://
+00005d90: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00005da0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00005db0: 6d2f 3234 3130 3332 2f31 3932 3034 3236  m/241032/1920426
+00005dc0: 3935 2d35 3232 6233 6563 372d 3638 3435  95-522b3ec7-6845
+00005dd0: 2d34 3934 612d 6162 6462 2d64 3163 3064  -494a-abdb-d1c0d
+00005de0: 3065 3233 3830 312e 706e 6729 0a0a 0a23  0e23801.png)...#
+00005df0: 2320 7461 6273 0a0a 7468 6520 6d61 696e  # tabs..the main
+00005e00: 2074 6162 7320 696e 2074 6865 2075 690a   tabs in the ui.
+00005e10: 2a20 605b f09f 948e 5d60 205b 7365 6172  * `[....]` [sear
+00005e20: 6368 5d28 2373 6561 7263 6869 6e67 2920  ch](#searching) 
+00005e30: 6279 2073 697a 652c 2064 6174 652c 2070  by size, date, p
+00005e40: 6174 682f 6e61 6d65 2c20 6d70 332d 7461  ath/name, mp3-ta
+00005e50: 6773 202e 2e2e 0a2a 2060 5bf0 9fa7 af5d  gs ....* `[....]
+00005e60: 6020 5b75 6e70 6f73 745d 2823 756e 706f  ` [unpost](#unpo
+00005e70: 7374 293a 2075 6e64 6f2f 6465 6c65 7465  st): undo/delete
+00005e80: 2061 6363 6964 656e 7461 6c20 7570 6c6f   accidental uplo
+00005e90: 6164 730a 2a20 605b f09f 9a80 5d60 2061  ads.* `[....]` a
+00005ea0: 6e64 2060 5bf0 9f8e 885d 6020 6172 6520  nd `[....]` are 
+00005eb0: 7468 6520 5b75 706c 6f61 6465 7273 5d28  the [uploaders](
+00005ec0: 2375 706c 6f61 6469 6e67 290a 2a20 605b  #uploading).* `[
+00005ed0: f09f 9382 5d60 206d 6b64 6972 3a20 6372  ....]` mkdir: cr
+00005ee0: 6561 7465 2064 6972 6563 746f 7269 6573  eate directories
+00005ef0: 0a2a 2060 5bf0 9f93 9d5d 6020 6e65 772d  .* `[....]` new-
+00005f00: 6d64 3a20 6372 6561 7465 2061 206e 6577  md: create a new
+00005f10: 206d 6172 6b64 6f77 6e20 646f 6375 6d65   markdown docume
+00005f20: 6e74 0a2a 2060 5bf0 9f93 9f5d 6020 7365  nt.* `[....]` se
+00005f30: 6e64 2d6d 7367 3a20 6569 7468 6572 2074  nd-msg: either t
+00005f40: 6f20 7365 7276 6572 2d6c 6f67 206f 7220  o server-log or 
+00005f50: 696e 746f 2074 6578 7466 696c 6573 2069  into textfiles i
+00005f60: 6620 602d 2d75 726c 666f 726d 2073 6176  f `--urlform sav
+00005f70: 6560 0a2a 2060 5bf0 9f8e ba5d 6020 6175  e`.* `[....]` au
+00005f80: 6469 6f2d 706c 6179 6572 2063 6f6e 6669  dio-player confi
+00005f90: 6720 6f70 7469 6f6e 730a 2a20 605b e29a  g options.* `[..
+00005fa0: 99ef b88f 5d60 2067 656e 6572 616c 2063  ....]` general c
+00005fb0: 6c69 656e 7420 636f 6e66 6967 206f 7074  lient config opt
+00005fc0: 696f 6e73 0a0a 0a23 2320 686f 746b 6579  ions...## hotkey
+00005fd0: 730a 0a74 6865 2062 726f 7773 6572 2068  s..the browser h
+00005fe0: 6173 2074 6865 2066 6f6c 6c6f 7769 6e67  as the following
+00005ff0: 2068 6f74 6b65 7973 2020 2861 6c77 6179   hotkeys  (alway
+00006000: 7320 7177 6572 7479 290a 2a20 603f 6020  s qwerty).* `?` 
+00006010: 7368 6f77 2068 6f74 6b65 7973 2068 656c  show hotkeys hel
+00006020: 700a 2a20 6042 6020 746f 6767 6c65 2062  p.* `B` toggle b
+00006030: 7265 6164 6372 756d 6273 202f 205b 6e61  readcrumbs / [na
+00006040: 7670 616e 655d 2823 6e61 7670 616e 6529  vpane](#navpane)
+00006050: 0a2a 2060 492f 4b60 2070 7265 762f 6e65  .* `I/K` prev/ne
+00006060: 7874 2066 6f6c 6465 720a 2a20 604d 6020  xt folder.* `M` 
+00006070: 7061 7265 6e74 2066 6f6c 6465 7220 286f  parent folder (o
+00006080: 7220 756e 6578 7061 6e64 2063 7572 7265  r unexpand curre
+00006090: 6e74 290a 2a20 6056 6020 746f 6767 6c65  nt).* `V` toggle
+000060a0: 2066 6f6c 6465 7273 202f 2074 6578 7466   folders / textf
+000060b0: 696c 6573 2069 6e20 7468 6520 6e61 7670  iles in the navp
+000060c0: 616e 650a 2a20 6047 6020 746f 6767 6c65  ane.* `G` toggle
+000060d0: 206c 6973 7420 2f20 5b67 7269 6420 7669   list / [grid vi
+000060e0: 6577 5d28 2374 6875 6d62 6e61 696c 7329  ew](#thumbnails)
+000060f0: 202d 2d20 7361 6d65 2061 7320 60e7 94b0   -- same as `...
+00006100: 6020 626f 7474 6f6d 2d72 6967 6874 0a2a  ` bottom-right.*
+00006110: 2060 5460 2074 6f67 676c 6520 7468 756d   `T` toggle thum
+00006120: 626e 6169 6c73 202f 2069 636f 6e73 0a2a  bnails / icons.*
+00006130: 2060 4553 4360 2063 6c6f 7365 2076 6172   `ESC` close var
+00006140: 696f 7573 2074 6869 6e67 730a 2a20 6063  ious things.* `c
+00006150: 7472 6c2d 4b60 2064 656c 6574 6520 7365  trl-K` delete se
+00006160: 6c65 6374 6564 2066 696c 6573 2f66 6f6c  lected files/fol
+00006170: 6465 7273 0a2a 2060 6374 726c 2d58 6020  ders.* `ctrl-X` 
+00006180: 6375 7420 7365 6c65 6374 6564 2066 696c  cut selected fil
+00006190: 6573 2f66 6f6c 6465 7273 0a2a 2060 6374  es/folders.* `ct
+000061a0: 726c 2d56 6020 7061 7374 650a 2a20 6059  rl-V` paste.* `Y
+000061b0: 6020 646f 776e 6c6f 6164 2073 656c 6563  ` download selec
+000061c0: 7465 6420 6669 6c65 730a 2a20 6046 3260  ted files.* `F2`
+000061d0: 205b 7265 6e61 6d65 5d28 2362 6174 6368   [rename](#batch
+000061e0: 2d72 656e 616d 6529 2073 656c 6563 7465  -rename) selecte
+000061f0: 6420 6669 6c65 2f66 6f6c 6465 720a 2a20  d file/folder.* 
+00006200: 7768 656e 2061 2066 696c 652f 666f 6c64  when a file/fold
+00006210: 6572 2069 7320 7365 6c65 6374 6564 2028  er is selected (
+00006220: 696e 206e 6f74 2d67 7269 642d 7669 6577  in not-grid-view
+00006230: 293a 0a20 202a 2060 5570 2f44 6f77 6e60  ):.  * `Up/Down`
+00006240: 206d 6f76 6520 6375 7273 6f72 0a20 202a   move cursor.  *
+00006250: 2073 6869 6674 2b60 5570 2f44 6f77 6e60   shift+`Up/Down`
+00006260: 2073 656c 6563 7420 616e 6420 6d6f 7665   select and move
+00006270: 2063 7572 736f 720a 2020 2a20 6374 726c   cursor.  * ctrl
+00006280: 2b60 5570 2f44 6f77 6e60 206d 6f76 6520  +`Up/Down` move 
+00006290: 6375 7273 6f72 2061 6e64 2073 6372 6f6c  cursor and scrol
+000062a0: 6c20 7669 6577 706f 7274 0a20 202a 2060  l viewport.  * `
+000062b0: 5370 6163 6560 2074 6f67 676c 6520 6669  Space` toggle fi
+000062c0: 6c65 2073 656c 6563 7469 6f6e 0a20 202a  le selection.  *
+000062d0: 2060 4374 726c 2d41 6020 746f 6767 6c65   `Ctrl-A` toggle
+000062e0: 2073 656c 6563 7420 616c 6c0a 2a20 7768   select all.* wh
+000062f0: 656e 2061 2074 6578 7466 696c 6520 6973  en a textfile is
+00006300: 206f 7065 6e3a 0a20 202a 2060 492f 4b60   open:.  * `I/K`
+00006310: 2070 7265 762f 6e65 7874 2074 6578 7466   prev/next textf
+00006320: 696c 650a 2020 2a20 6053 6020 746f 6767  ile.  * `S` togg
+00006330: 6c65 2073 656c 6563 7469 6f6e 206f 6620  le selection of 
+00006340: 6f70 656e 2066 696c 650a 2020 2a20 604d  open file.  * `M
+00006350: 6020 636c 6f73 6520 7465 7874 6669 6c65  ` close textfile
+00006360: 0a2a 2077 6865 6e20 706c 6179 696e 6720  .* when playing 
+00006370: 6175 6469 6f3a 0a20 202a 2060 4a2f 4c60  audio:.  * `J/L`
+00006380: 2070 7265 762f 6e65 7874 2073 6f6e 670a   prev/next song.
+00006390: 2020 2a20 6055 2f4f 6020 736b 6970 2031    * `U/O` skip 1
+000063a0: 3073 6563 2062 6163 6b2f 666f 7277 6172  0sec back/forwar
+000063b0: 640a 2020 2a20 6030 2e2e 3960 206a 756d  d.  * `0..9` jum
+000063c0: 7020 746f 2030 252e 2e39 3025 0a20 202a  p to 0%..90%.  *
+000063d0: 2060 5060 2070 6c61 792f 7061 7573 6520   `P` play/pause 
+000063e0: 2861 6c73 6f20 7374 6172 7473 2070 6c61  (also starts pla
+000063f0: 7969 6e67 2074 6865 2066 6f6c 6465 7229  ying the folder)
+00006400: 0a20 202a 2060 5960 2064 6f77 6e6c 6f61  .  * `Y` downloa
+00006410: 6420 6669 6c65 0a2a 2077 6865 6e20 7669  d file.* when vi
+00006420: 6577 696e 6720 696d 6167 6573 202f 2070  ewing images / p
+00006430: 6c61 7969 6e67 2076 6964 656f 733a 0a20  laying videos:. 
+00006440: 202a 2060 4a2f 4c2c 204c 6566 742f 5269   * `J/L, Left/Ri
+00006450: 6768 7460 2070 7265 762f 6e65 7874 2066  ght` prev/next f
+00006460: 696c 650a 2020 2a20 6048 6f6d 652f 456e  ile.  * `Home/En
+00006470: 6460 2066 6972 7374 2f6c 6173 7420 6669  d` first/last fi
+00006480: 6c65 0a20 202a 2060 4660 2074 6f67 676c  le.  * `F` toggl
+00006490: 6520 6675 6c6c 7363 7265 656e 0a20 202a  e fullscreen.  *
+000064a0: 2060 5360 2074 6f67 676c 6520 7365 6c65   `S` toggle sele
+000064b0: 6374 696f 6e0a 2020 2a20 6052 6020 726f  ction.  * `R` ro
+000064c0: 7461 7465 2063 6c6f 636b 7769 7365 2028  tate clockwise (
+000064d0: 7368 6966 743d 6363 7729 0a20 202a 2060  shift=ccw).  * `
+000064e0: 5960 2064 6f77 6e6c 6f61 6420 6669 6c65  Y` download file
+000064f0: 0a20 202a 2060 4573 6360 2063 6c6f 7365  .  * `Esc` close
+00006500: 2076 6965 7765 720a 2020 2a20 7669 6465   viewer.  * vide
+00006510: 6f73 3a0a 2020 2020 2a20 6055 2f4f 6020  os:.    * `U/O` 
+00006520: 736b 6970 2031 3073 6563 2062 6163 6b2f  skip 10sec back/
+00006530: 666f 7277 6172 640a 2020 2020 2a20 6030  forward.    * `0
+00006540: 2e2e 3960 206a 756d 7020 746f 2030 252e  ..9` jump to 0%.
+00006550: 2e39 3025 0a20 2020 202a 2060 502f 4b2f  .90%.    * `P/K/
+00006560: 5370 6163 6560 2070 6c61 792f 7061 7573  Space` play/paus
+00006570: 650a 2020 2020 2a20 604d 6020 6d75 7465  e.    * `M` mute
+00006580: 0a20 2020 202a 2060 4360 2063 6f6e 7469  .    * `C` conti
+00006590: 6e75 6520 706c 6179 696e 6720 6e65 7874  nue playing next
+000065a0: 2076 6964 656f 0a20 2020 202a 2060 5660   video.    * `V`
+000065b0: 206c 6f6f 7020 656e 7469 7265 2066 696c   loop entire fil
+000065c0: 650a 2020 2020 2a20 605b 6020 6c6f 6f70  e.    * `[` loop
+000065d0: 2072 616e 6765 2028 7374 6172 7429 0a20   range (start). 
+000065e0: 2020 202a 2060 5d60 206c 6f6f 7020 7261     * `]` loop ra
+000065f0: 6e67 6520 2865 6e64 290a 2a20 7768 656e  nge (end).* when
+00006600: 2074 6865 206e 6176 7061 6e65 2069 7320   the navpane is 
+00006610: 6f70 656e 3a0a 2020 2a20 6041 2f44 6020  open:.  * `A/D` 
+00006620: 6164 6a75 7374 2074 7265 6520 7769 6474  adjust tree widt
+00006630: 680a 2a20 696e 2074 6865 205b 6772 6964  h.* in the [grid
+00006640: 2076 6965 775d 2823 7468 756d 626e 6169   view](#thumbnai
+00006650: 6c73 293a 0a20 202a 2060 5360 2074 6f67  ls):.  * `S` tog
+00006660: 676c 6520 6d75 6c74 6973 656c 6563 740a  gle multiselect.
+00006670: 2020 2a20 7368 6966 742b 6041 2f44 6020    * shift+`A/D` 
+00006680: 7a6f 6f6d 0a2a 2069 6e20 7468 6520 6d61  zoom.* in the ma
+00006690: 726b 646f 776e 2065 6469 746f 723a 0a20  rkdown editor:. 
+000066a0: 202a 2060 5e73 6020 7361 7665 0a20 202a   * `^s` save.  *
+000066b0: 2060 5e68 6020 6865 6164 6572 0a20 202a   `^h` header.  *
+000066c0: 2060 5e6b 6020 6175 746f 666f 726d 6174   `^k` autoformat
+000066d0: 2074 6162 6c65 0a20 202a 2060 5e75 6020   table.  * `^u` 
+000066e0: 6a75 6d70 2074 6f20 6e65 7874 2075 6e69  jump to next uni
+000066f0: 636f 6465 2063 6861 7261 6374 6572 0a20  code character. 
+00006700: 202a 2060 5e65 6020 746f 6767 6c65 2065   * `^e` toggle e
+00006710: 6469 746f 7220 2f20 7072 6576 6965 770a  ditor / preview.
+00006720: 2020 2a20 605e 7570 2c20 5e64 6f77 6e60    * `^up, ^down`
+00006730: 206a 756d 7020 7061 7261 6772 6170 6873   jump paragraphs
+00006740: 0a0a 0a23 2320 6e61 7670 616e 650a 0a73  ...## navpane..s
+00006750: 7769 7463 6869 6e67 2062 6574 7765 656e  witching between
+00006760: 2062 7265 6164 6372 756d 6273 206f 7220   breadcrumbs or 
+00006770: 6e61 7670 616e 650a 0a63 6c69 636b 2074  navpane..click t
+00006780: 6865 2060 f09f 8cb2 6020 6f72 2070 7265  he `....` or pre
+00006790: 7373 696e 6720 7468 6520 6042 6020 686f  ssing the `B` ho
+000067a0: 746b 6579 2074 6f20 746f 6767 6c65 2062  tkey to toggle b
+000067b0: 6574 7765 656e 2062 7265 6164 6372 756d  etween breadcrum
+000067c0: 6273 2070 6174 6820 2864 6566 6175 6c74  bs path (default
+000067d0: 292c 206f 7220 6120 6e61 7670 616e 6520  ), or a navpane 
+000067e0: 2874 7265 652d 6272 6f77 7365 7220 7369  (tree-browser si
+000067f0: 6465 6261 7220 7468 696e 6729 0a0a 2a20  debar thing)..* 
+00006800: 605b 2b5d 6020 616e 6420 605b 2d5d 6020  `[+]` and `[-]` 
+00006810: 286f 7220 686f 746b 6579 7320 6041 602f  (or hotkeys `A`/
+00006820: 6044 6029 2061 646a 7573 7420 7468 6520  `D`) adjust the 
+00006830: 7369 7a65 0a2a 2060 5bf0 9f8e af5d 6020  size.* `[....]` 
+00006840: 6a75 6d70 7320 746f 2074 6865 2063 7572  jumps to the cur
+00006850: 7265 6e74 6c79 206f 7065 6e20 666f 6c64  rently open fold
+00006860: 6572 0a2a 2060 5bf0 9f93 835d 6020 746f  er.* `[....]` to
+00006870: 6767 6c65 7320 6265 7477 6565 6e20 7368  ggles between sh
+00006880: 6f77 696e 6720 666f 6c64 6572 7320 616e  owing folders an
+00006890: 6420 7465 7874 6669 6c65 730a 2a20 605b  d textfiles.* `[
+000068a0: f09f 938c 5d60 2073 686f 7773 2074 6865  ....]` shows the
+000068b0: 206e 616d 6520 6f66 2061 6c6c 2070 6172   name of all par
+000068c0: 656e 7420 666f 6c64 6572 7320 696e 2061  ent folders in a
+000068d0: 2064 6f63 6b65 6420 7061 6e65 6c0a 2a20   docked panel.* 
+000068e0: 605b 615d 6020 746f 6767 6c65 7320 6175  `[a]` toggles au
+000068f0: 746f 6d61 7469 6320 7769 6465 6e69 6e67  tomatic widening
+00006900: 2061 7320 796f 7520 676f 2064 6565 7065   as you go deepe
+00006910: 720a 2a20 605b e286 b55d 6020 746f 6767  r.* `[...]` togg
+00006920: 6c65 7320 776f 7264 7772 6170 0a2a 2060  les wordwrap.* `
+00006930: 5bf0 9f91 805d 6020 7368 6f77 2066 756c  [....]` show ful
+00006940: 6c20 6e61 6d65 206f 6e20 686f 7665 7220  l name on hover 
+00006950: 2869 6620 776f 7264 7772 6170 2069 7320  (if wordwrap is 
+00006960: 6f66 6629 0a0a 0a23 2320 7468 756d 626e  off)...## thumbn
+00006970: 6169 6c73 0a0a 7072 6573 7320 6067 6020  ails..press `g` 
+00006980: 6f72 2060 e794 b060 2074 6f20 746f 6767  or `...` to togg
+00006990: 6c65 2067 7269 642d 7669 6577 2069 6e73  le grid-view ins
+000069a0: 7465 6164 206f 6620 7468 6520 6669 6c65  tead of the file
+000069b0: 206c 6973 7469 6e67 2020 616e 6420 6074   listing  and `t
+000069c0: 6020 746f 6767 6c65 7320 6963 6f6e 7320  ` toggles icons 
+000069d0: 2f20 7468 756d 626e 6169 6c73 0a0a 215b  / thumbnails..![
+000069e0: 636f 7079 7061 7274 792d 7468 756d 6273  copyparty-thumbs
+000069f0: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
+00006a00: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00006a10: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00006a20: 3234 3130 3332 2f31 3239 3633 3632 3131  241032/129636211
+00006a30: 2d61 6264 3230 6661 322d 6139 3533 2d34  -abd20fa2-a953-4
+00006a40: 3336 362d 3934 3233 2d31 6338 3865 6262  366-9423-1c88ebb
+00006a50: 3936 6261 392e 706e 6729 0a0a 6974 2064  96ba9.png)..it d
+00006a60: 6f65 7320 7374 6174 6963 2069 6d61 6765  oes static image
+00006a70: 7320 7769 7468 2050 696c 6c6f 7720 2f20  s with Pillow / 
+00006a80: 7079 7669 7073 202f 2046 466d 7065 672c  pyvips / FFmpeg,
+00006a90: 2061 6e64 2075 7365 7320 4646 6d70 6567   and uses FFmpeg
+00006aa0: 2066 6f72 2076 6964 656f 2066 696c 6573   for video files
+00006ab0: 2c20 736f 2079 6f75 206d 6179 2077 616e  , so you may wan
+00006ac0: 7420 746f 2060 2d2d 6e6f 2d74 6875 6d62  t to `--no-thumb
+00006ad0: 6020 6f72 206d 6179 6265 206a 7573 7420  ` or maybe just 
+00006ae0: 602d 2d6e 6f2d 7674 6875 6d62 6020 6465  `--no-vthumb` de
+00006af0: 7065 6e64 696e 6720 6f6e 2068 6f77 2064  pending on how d
+00006b00: 616e 6765 726f 7573 2079 6f75 7220 7573  angerous your us
+00006b10: 6572 7320 6172 650a 2a20 7079 7669 7073  ers are.* pyvips
+00006b20: 2069 7320 3378 2066 6173 7465 7220 7468   is 3x faster th
+00006b30: 616e 2050 696c 6c6f 772c 2050 696c 6c6f  an Pillow, Pillo
+00006b40: 7720 6973 2033 7820 6661 7374 6572 2074  w is 3x faster t
+00006b50: 6861 6e20 4646 6d70 6567 0a2a 2064 6973  han FFmpeg.* dis
+00006b60: 6162 6c65 2074 6875 6d62 6e61 696c 7320  able thumbnails 
+00006b70: 666f 7220 7370 6563 6966 6963 2076 6f6c  for specific vol
+00006b80: 756d 6573 2077 6974 6820 766f 6c66 6c61  umes with volfla
+00006b90: 6720 6064 7468 756d 6260 2066 6f72 2061  g `dthumb` for a
+00006ba0: 6c6c 2c20 6f72 2060 6476 7468 756d 6260  ll, or `dvthumb`
+00006bb0: 202f 2060 6461 7468 756d 6260 202f 2060   / `dathumb` / `
+00006bc0: 6469 7468 756d 6260 2066 6f72 2076 6964  dithumb` for vid
+00006bd0: 656f 2f61 7564 696f 2f69 6d61 6765 7320  eo/audio/images 
+00006be0: 6f6e 6c79 0a0a 6175 6469 6f20 6669 6c65  only..audio file
+00006bf0: 7320 6172 6520 636f 766e 6572 7465 6420  s are covnerted 
+00006c00: 696e 746f 2073 7065 6374 726f 6772 616d  into spectrogram
+00006c10: 7320 7573 696e 6720 4646 6d70 6567 2075  s using FFmpeg u
+00006c20: 6e6c 6573 7320 796f 7520 602d 2d6e 6f2d  nless you `--no-
+00006c30: 6174 6875 6d62 6020 2861 6e64 2073 6f6d  athumb` (and som
+00006c40: 6520 4646 6d70 6567 2062 7569 6c64 7320  e FFmpeg builds 
+00006c50: 6d61 7920 6e65 6564 2060 2d2d 7468 2d66  may need `--th-f
+00006c60: 662d 7377 7260 290a 0a69 6d61 6765 7320  f-swr`)..images 
+00006c70: 7769 7468 2074 6865 2066 6f6c 6c6f 7769  with the followi
+00006c80: 6e67 206e 616d 6573 2028 7365 6520 602d  ng names (see `-
+00006c90: 2d74 682d 636f 7665 7273 6029 2062 6563  -th-covers`) bec
+00006ca0: 6f6d 6520 7468 6520 7468 756d 626e 6169  ome the thumbnai
+00006cb0: 6c20 6f66 2074 6865 2066 6f6c 6465 7220  l of the folder 
+00006cc0: 7468 6579 2772 6520 696e 3a20 6066 6f6c  they're in: `fol
+00006cd0: 6465 722e 706e 6760 2c20 6066 6f6c 6465  der.png`, `folde
+00006ce0: 722e 6a70 6760 2c20 6063 6f76 6572 2e70  r.jpg`, `cover.p
+00006cf0: 6e67 602c 2060 636f 7665 722e 6a70 6760  ng`, `cover.jpg`
+00006d00: 0a0a 696e 2074 6865 2067 7269 642f 7468  ..in the grid/th
+00006d10: 756d 626e 6169 6c20 7669 6577 2c20 6966  umbnail view, if
+00006d20: 2074 6865 2061 7564 696f 2070 6c61 7965   the audio playe
+00006d30: 7220 7061 6e65 6c20 6973 206f 7065 6e2c  r panel is open,
+00006d40: 2073 6f6e 6773 2077 696c 6c20 7374 6172   songs will star
+00006d50: 7420 706c 6179 696e 6720 7768 656e 2063  t playing when c
+00006d60: 6c69 636b 6564 0a2a 2069 6e64 6963 6174  licked.* indicat
+00006d70: 6564 2062 7920 7468 6520 6175 6469 6f20  ed by the audio 
+00006d80: 6669 6c65 7320 6861 7669 6e67 2074 6865  files having the
+00006d90: 20e2 96b6 2069 636f 6e20 696e 7374 6561   ... icon instea
+00006da0: 6420 6f66 20f0 9f92 be0a 0a0a 2323 207a  d of .......## z
+00006db0: 6970 2064 6f77 6e6c 6f61 6473 0a0a 646f  ip downloads..do
+00006dc0: 776e 6c6f 6164 2066 6f6c 6465 7273 2028  wnload folders (
+00006dd0: 6f72 2066 696c 6520 7365 6c65 6374 696f  or file selectio
+00006de0: 6e73 2920 6173 2060 7a69 7060 206f 7220  ns) as `zip` or 
+00006df0: 6074 6172 6020 6669 6c65 730a 0a73 656c  `tar` files..sel
+00006e00: 6563 7420 7768 6963 6820 7479 7065 206f  ect which type o
+00006e10: 6620 6172 6368 6976 6520 796f 7520 7761  f archive you wa
+00006e20: 6e74 2069 6e20 7468 6520 605b e29a 99ef  nt in the `[....
+00006e30: b88f 5d20 636f 6e66 6967 6020 7461 623a  ..] config` tab:
+00006e40: 0a0a 7c20 6e61 6d65 207c 2075 726c 2d73  ..| name | url-s
+00006e50: 7566 6669 7820 7c20 6465 7363 7269 7074  uffix | descript
+00006e60: 696f 6e20 7c0a 7c2d 2d7c 2d2d 7c2d 2d7c  ion |.|--|--|--|
+00006e70: 0a7c 2060 7461 7260 207c 2060 3f74 6172  .| `tar` | `?tar
+00006e80: 6020 7c20 706c 6169 6e20 676e 7574 6172  ` | plain gnutar
+00006e90: 2c20 776f 726b 7320 6772 6561 7420 7769  , works great wi
+00006ea0: 7468 2060 6375 726c 205c 7c20 7461 7220  th `curl \| tar 
+00006eb0: 2d78 7660 207c 0a7c 2060 7a69 7060 207c  -xv` |.| `zip` |
+00006ec0: 2060 3f7a 6970 3d75 7466 3860 207c 2077   `?zip=utf8` | w
+00006ed0: 6f72 6b73 2065 7665 7279 7768 6572 652c  orks everywhere,
+00006ee0: 2067 6c69 7463 6879 2066 696c 656e 616d   glitchy filenam
+00006ef0: 6573 206f 6e20 7769 6e37 2061 6e64 206f  es on win7 and o
+00006f00: 6c64 6572 207c 0a7c 2060 7a69 705f 646f  lder |.| `zip_do
+00006f10: 7360 207c 2060 3f7a 6970 6020 7c20 7472  s` | `?zip` | tr
+00006f20: 6164 6974 696f 6e61 6c20 6370 3433 3720  aditional cp437 
+00006f30: 286e 6f20 756e 6963 6f64 6529 2074 6f20  (no unicode) to 
+00006f40: 6669 7820 676c 6974 6368 7920 6669 6c65  fix glitchy file
+00006f50: 6e61 6d65 7320 7c0a 7c20 607a 6970 5f63  names |.| `zip_c
+00006f60: 7263 6020 7c20 603f 7a69 703d 6372 6360  rc` | `?zip=crc`
+00006f70: 207c 2063 7034 3337 2077 6974 6820 6372   | cp437 with cr
+00006f80: 6333 3220 636f 6d70 7574 6564 2065 6172  c32 computed ear
+00006f90: 6c79 2066 6f72 2074 7275 6c79 2061 6e63  ly for truly anc
+00006fa0: 6965 6e74 2073 6f66 7477 6172 6520 7c0a  ient software |.
+00006fb0: 0a2a 2068 6964 6465 6e20 6669 6c65 7320  .* hidden files 
+00006fc0: 2864 6f74 6669 6c65 7329 2061 7265 2065  (dotfiles) are e
+00006fd0: 7863 6c75 6465 6420 756e 6c65 7373 2060  xcluded unless `
+00006fe0: 2d65 6460 0a20 202a 2060 7570 326b 2e64  -ed`.  * `up2k.d
+00006ff0: 6260 2061 6e64 2060 6469 722e 7478 7460  b` and `dir.txt`
+00007000: 2069 7320 616c 7761 7973 2065 7863 6c75   is always exclu
+00007010: 6465 640a 2a20 607a 6970 5f63 7263 6020  ded.* `zip_crc` 
+00007020: 7769 6c6c 2074 616b 6520 6c6f 6e67 6572  will take longer
+00007030: 2074 6f20 646f 776e 6c6f 6164 2073 696e   to download sin
+00007040: 6365 2074 6865 2073 6572 7665 7220 6861  ce the server ha
+00007050: 7320 746f 2072 6561 6420 6561 6368 2066  s to read each f
+00007060: 696c 6520 7477 6963 650a 2020 2a20 7468  ile twice.  * th
+00007070: 6973 2069 7320 6f6e 6c79 2074 6f20 7375  is is only to su
+00007080: 7070 6f72 7420 4d53 2d44 4f53 2050 4b5a  pport MS-DOS PKZ
+00007090: 4950 2076 322e 3034 6720 286f 6374 6f62  IP v2.04g (octob
+000070a0: 6572 2031 3939 3329 2061 6e64 206f 6c64  er 1993) and old
+000070b0: 6572 0a20 2020 202a 2068 6f77 2061 7265  er.    * how are
+000070c0: 2079 6f75 2061 6363 6573 7369 6e67 2063   you accessing c
+000070d0: 6f70 7970 6172 7479 2061 6374 7561 6c6c  opyparty actuall
+000070e0: 790a 0a79 6f75 2063 616e 2061 6c73 6f20  y..you can also 
+000070f0: 7a69 7020 6120 7365 6c65 6374 696f 6e20  zip a selection 
+00007100: 6f66 2066 696c 6573 206f 7220 666f 6c64  of files or fold
+00007110: 6572 7320 6279 2063 6c69 636b 696e 6720  ers by clicking 
+00007120: 7468 656d 2069 6e20 7468 6520 6272 6f77  them in the brow
+00007130: 7365 722c 2074 6861 7420 6272 696e 6773  ser, that brings
+00007140: 2075 7020 6120 7365 6c65 6374 696f 6e20   up a selection 
+00007150: 6564 6974 6f72 2061 6e64 207a 6970 2062  editor and zip b
+00007160: 7574 746f 6e20 696e 2074 6865 2062 6f74  utton in the bot
+00007170: 746f 6d20 7269 6768 740a 0a21 5b63 6f70  tom right..![cop
+00007180: 7970 6172 7479 2d7a 6970 7365 6c2d 6673  yparty-zipsel-fs
+00007190: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
+000071a0: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+000071b0: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+000071c0: 3033 322f 3132 3936 3335 3337 342d 6535  032/129635374-e5
+000071d0: 3133 3665 3031 2d34 3730 612d 3439 6231  136e01-470a-49b1
+000071e0: 2d61 3736 322d 3834 3865 3861 3463 3963  -a762-848e8a4c9c
+000071f0: 6463 2e70 6e67 290a 0a0a 2323 2075 706c  dc.png)...## upl
+00007200: 6f61 6469 6e67 0a0a 6472 6167 2066 696c  oading..drag fil
+00007210: 6573 2f66 6f6c 6465 7273 2069 6e74 6f20  es/folders into 
+00007220: 7468 6520 7765 622d 6272 6f77 7365 7220  the web-browser 
+00007230: 746f 2075 706c 6f61 6420 2028 6f72 2075  to upload  (or u
+00007240: 7365 2074 6865 205b 636f 6d6d 616e 642d  se the [command-
+00007250: 6c69 6e65 2075 706c 6f61 6465 725d 2868  line uploader](h
+00007260: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00007270: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+00007280: 2f74 7265 652f 686f 7675 6473 7472 6175  /tree/hovudstrau
+00007290: 6d2f 6269 6e23 7570 326b 7079 2929 0a0a  m/bin#up2kpy))..
+000072a0: 7468 6973 2069 6e69 7469 6174 6573 2061  this initiates a
+000072b0: 6e20 7570 6c6f 6164 2075 7369 6e67 2060  n upload using `
+000072c0: 7570 326b 603b 2074 6865 7265 2061 7265  up2k`; there are
+000072d0: 2074 776f 2075 706c 6f61 6465 7273 2061   two uploaders a
+000072e0: 7661 696c 6162 6c65 3a0a 2a20 605b f09f  vailable:.* `[..
+000072f0: 8e88 5d20 6275 7060 2c20 7468 6520 6261  ..] bup`, the ba
+00007300: 7369 6320 7570 6c6f 6164 6572 2c20 7375  sic uploader, su
+00007310: 7070 6f72 7473 2061 6c6d 6f73 7420 6576  pports almost ev
+00007320: 6572 7920 6272 6f77 7365 7220 7369 6e63  ery browser sinc
+00007330: 6520 6e65 7473 6361 7065 2034 2e30 0a2a  e netscape 4.0.*
+00007340: 2060 5bf0 9f9a 805d 2075 7032 6b60 2c20   `[....] up2k`, 
+00007350: 7468 6520 676f 6f64 202f 2066 616e 6379  the good / fancy
+00007360: 206f 6e65 0a0a 4e42 3a20 796f 7520 6361   one..NB: you ca
+00007370: 6e20 756e 646f 2f64 656c 6574 6520 796f  n undo/delete yo
+00007380: 7572 206f 776e 2075 706c 6f61 6473 2077  ur own uploads w
+00007390: 6974 6820 605b f09f a7af 5d60 205b 756e  ith `[....]` [un
+000073a0: 706f 7374 5d28 2375 6e70 6f73 7429 0a0a  post](#unpost)..
+000073b0: 7570 326b 2068 6173 2073 6576 6572 616c  up2k has several
+000073c0: 2061 6476 616e 7461 6765 733a 0a2a 2079   advantages:.* y
+000073d0: 6f75 2063 616e 2064 726f 7020 666f 6c64  ou can drop fold
+000073e0: 6572 7320 696e 746f 2074 6865 2062 726f  ers into the bro
+000073f0: 7773 6572 2028 6669 6c65 7320 6172 6520  wser (files are 
+00007400: 6164 6465 6420 7265 6375 7273 6976 656c  added recursivel
+00007410: 7929 0a2a 2066 696c 6573 2061 7265 2070  y).* files are p
+00007420: 726f 6365 7373 6564 2069 6e20 6368 756e  rocessed in chun
+00007430: 6b73 2c20 616e 6420 6561 6368 2063 6875  ks, and each chu
+00007440: 6e6b 2069 7320 6368 6563 6b73 756d 6d65  nk is checksumme
+00007450: 640a 2020 2a20 7570 6c6f 6164 7320 6175  d.  * uploads au
+00007460: 746f 7265 7375 6d65 2069 6620 7468 6579  toresume if they
+00007470: 2061 7265 2069 6e74 6572 7275 7074 6564   are interrupted
+00007480: 2062 7920 6e65 7477 6f72 6b20 6973 7375   by network issu
+00007490: 6573 0a20 202a 2075 706c 6f61 6473 2072  es.  * uploads r
+000074a0: 6573 756d 6520 6966 2079 6f75 2072 6562  esume if you reb
+000074b0: 6f6f 7420 796f 7572 2062 726f 7773 6572  oot your browser
+000074c0: 206f 7220 7063 2c20 6a75 7374 2075 706c   or pc, just upl
+000074d0: 6f61 6420 7468 6520 7361 6d65 2066 696c  oad the same fil
+000074e0: 6573 2061 6761 696e 0a20 202a 2073 6572  es again.  * ser
+000074f0: 7665 7220 6465 7465 6374 7320 616e 7920  ver detects any 
+00007500: 636f 7272 7570 7469 6f6e 3b20 7468 6520  corruption; the 
+00007510: 636c 6965 6e74 2072 6575 706c 6f61 6473  client reuploads
+00007520: 2061 6666 6563 7465 6420 6368 756e 6b73   affected chunks
+00007530: 0a20 202a 2074 6865 2063 6c69 656e 7420  .  * the client 
+00007540: 646f 6573 6e27 7420 7570 6c6f 6164 2061  doesn't upload a
+00007550: 6e79 7468 696e 6720 7468 6174 2061 6c72  nything that alr
+00007560: 6561 6479 2065 7869 7374 7320 6f6e 2074  eady exists on t
+00007570: 6865 2073 6572 7665 720a 2a20 6d75 6368  he server.* much
+00007580: 2068 6967 6865 7220 7370 6565 6473 2074   higher speeds t
+00007590: 6861 6e20 6674 702f 7363 702f 7461 7270  han ftp/scp/tarp
+000075a0: 6970 6520 6f6e 2073 6f6d 6520 696e 7465  ipe on some inte
+000075b0: 726e 6574 2063 6f6e 6e65 6374 696f 6e73  rnet connections
+000075c0: 2028 6d61 696e 6c79 2061 6d65 7269 6361   (mainly america
+000075d0: 6e20 6f6e 6573 2920 7468 616e 6b73 2074  n ones) thanks t
+000075e0: 6f20 7061 7261 6c6c 656c 2063 6f6e 6e65  o parallel conne
+000075f0: 6374 696f 6e73 0a2a 2074 6865 206c 6173  ctions.* the las
+00007600: 742d 6d6f 6469 6669 6564 2074 696d 6573  t-modified times
+00007610: 7461 6d70 206f 6620 7468 6520 6669 6c65  tamp of the file
+00007620: 2069 7320 7072 6573 6572 7665 640a 0a3e   is preserved..>
+00007630: 2069 7420 6973 2070 6572 6665 6374 6c79   it is perfectly
+00007640: 2073 6166 6520 746f 2072 6573 7461 7274   safe to restart
+00007650: 202f 2075 7067 7261 6465 2063 6f70 7970   / upgrade copyp
+00007660: 6172 7479 2077 6869 6c65 2073 6f6d 656f  arty while someo
+00007670: 6e65 2069 7320 7570 6c6f 6164 696e 6720  ne is uploading 
+00007680: 746f 2069 7421 2020 0a3e 2061 6c6c 206b  to it!  .> all k
+00007690: 6e6f 776e 2075 7032 6b20 636c 6965 6e74  nown up2k client
+000076a0: 7320 7769 6c6c 2072 6573 756d 6520 6a75  s will resume ju
+000076b0: 7374 2066 696e 6520 f09f 92aa 0a0a 7365  st fine ......se
+000076c0: 6520 5b75 7032 6b5d 2823 7570 326b 2920  e [up2k](#up2k) 
+000076d0: 666f 7220 6465 7461 696c 7320 6f6e 2068  for details on h
+000076e0: 6f77 2069 7420 776f 726b 732c 206f 7220  ow it works, or 
+000076f0: 7761 7463 6820 6120 5b64 656d 6f20 7669  watch a [demo vi
+00007700: 6465 6f5d 2868 7474 7073 3a2f 2f61 2e6f  deo](https://a.o
+00007710: 6376 2e6d 652f 7075 622f 6465 6d6f 2f70  cv.me/pub/demo/p
+00007720: 6963 732d 7669 6473 2f23 6766 2d30 6636  ics-vids/#gf-0f6
+00007730: 6635 6330 6429 0a0a 215b 636f 7079 7061  f5c0d)..![copypa
+00007740: 7274 792d 7570 6c6f 6164 2d66 7338 5d28  rty-upload-fs8](
+00007750: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
+00007760: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
+00007770: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
+00007780: 2f31 3239 3633 3533 3731 2d34 3866 6335  /129635371-48fc5
+00007790: 3463 612d 6661 3931 2d34 3865 332d 3962  4ca-fa91-48e3-9b
+000077a0: 3164 2d62 6134 3133 6534 6236 3863 622e  1d-ba413e4b68cb.
+000077b0: 706e 6729 0a0a 2a2a 7072 6f74 6970 3a2a  png)..**protip:*
+000077c0: 2a20 796f 7520 6361 6e20 6176 6f69 6420  * you can avoid 
+000077d0: 7363 6172 696e 6720 6177 6179 2075 7365  scaring away use
+000077e0: 7273 2077 6974 6820 5b63 6f6e 7472 6962  rs with [contrib
+000077f0: 2f70 6c75 6769 6e73 2f6d 696e 696d 616c  /plugins/minimal
+00007800: 2d75 7032 6b2e 6a73 5d28 636f 6e74 7269  -up2k.js](contri
+00007810: 622f 706c 7567 696e 732f 6d69 6e69 6d61  b/plugins/minima
+00007820: 6c2d 7570 326b 2e6a 7329 2077 6869 6368  l-up2k.js) which
+00007830: 206d 616b 6573 2069 7420 6c6f 6f6b 205b   makes it look [
+00007840: 6d75 6368 2073 696d 706c 6572 5d28 6874  much simpler](ht
+00007850: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+00007860: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+00007870: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+00007880: 3138 3331 3131 3935 2d64 6436 6361 3338  18311195-dd6ca38
+00007890: 302d 6234 6566 2d31 3165 622d 3836 6633  0-b4ef-11eb-86f3
+000078a0: 2d37 3561 3366 6632 6531 3333 322e 706e  -75a3ff2e1332.pn
+000078b0: 6729 0a0a 2a2a 7072 6f74 6970 3a2a 2a20  g)..**protip:** 
+000078c0: 6966 2079 6f75 2065 6e61 626c 6520 6066  if you enable `f
+000078d0: 6176 6963 6f6e 6020 696e 2074 6865 2060  avicon` in the `
+000078e0: 5be2 9a99 efb8 8f5d 2073 6574 7469 6e67  [......] setting
+000078f0: 7360 2074 6162 2028 6279 2074 7970 696e  s` tab (by typin
+00007900: 6720 736f 6d65 7468 696e 6720 696e 746f  g something into
+00007910: 2074 6865 2074 6578 7462 6f78 292c 2074   the textbox), t
+00007920: 6865 2069 636f 6e20 696e 2074 6865 2062  he icon in the b
+00007930: 726f 7773 6572 2074 6162 2077 696c 6c20  rowser tab will 
+00007940: 696e 6469 6361 7465 2075 706c 6f61 6420  indicate upload 
+00007950: 7072 6f67 7265 7373 202d 2d20 616c 736f  progress -- also
+00007960: 2c20 7468 6520 605b f09f 9494 5d60 2061  , the `[....]` a
+00007970: 6e64 2f6f 7220 605b f09f 948a 5d60 2073  nd/or `[....]` s
+00007980: 7769 7463 6865 7320 656e 6162 6c65 2076  witches enable v
+00007990: 6973 6962 6c65 2061 6e64 2f6f 7220 6175  isible and/or au
+000079a0: 6469 626c 6520 6e6f 7469 6669 6361 7469  dible notificati
+000079b0: 6f6e 7320 6f6e 2075 706c 6f61 6420 636f  ons on upload co
+000079c0: 6d70 6c65 7469 6f6e 0a0a 7468 6520 7570  mpletion..the up
+000079d0: 326b 2055 4920 6973 2074 6865 2065 7069  2k UI is the epi
+000079e0: 746f 6d65 206f 6620 706f 6c69 7368 6564  tome of polished
+000079f0: 2069 6e75 7469 7469 7665 2065 7870 6572   inutitive exper
+00007a00: 6965 6e63 6573 3a0a 2a20 2270 6172 616c  iences:.* "paral
+00007a10: 6c65 6c20 7570 6c6f 6164 7322 2073 7065  lel uploads" spe
+00007a20: 6369 6669 6573 2068 6f77 206d 616e 7920  cifies how many 
+00007a30: 6368 756e 6b73 2074 6f20 7570 6c6f 6164  chunks to upload
+00007a40: 2061 7420 7468 6520 7361 6d65 2074 696d   at the same tim
+00007a50: 650a 2a20 605b f09f 8f83 5d60 2061 6e61  e.* `[....]` ana
+00007a60: 6c79 7369 7320 6f66 206f 7468 6572 2066  lysis of other f
+00007a70: 696c 6573 2073 686f 756c 6420 636f 6e74  iles should cont
+00007a80: 696e 7565 2077 6869 6c65 206f 6e65 2069  inue while one i
+00007a90: 7320 7570 6c6f 6164 696e 670a 2a20 605b  s uploading.* `[
+00007aa0: f09f a594 5d60 2073 686f 7773 2061 2073  ....]` shows a s
+00007ab0: 696d 706c 6572 2055 4920 666f 7220 6661  impler UI for fa
+00007ac0: 7374 6572 2075 706c 6f61 6473 2066 726f  ster uploads fro
+00007ad0: 6d20 736c 6f77 2064 6576 6963 6573 0a2a  m slow devices.*
+00007ae0: 2060 5bf0 9f92 ad5d 6020 6173 6b20 666f   `[....]` ask fo
+00007af0: 7220 636f 6e66 6972 6d61 7469 6f6e 2062  r confirmation b
+00007b00: 6566 6f72 6520 6669 6c65 7320 6172 6520  efore files are 
+00007b10: 6164 6465 6420 746f 2074 6865 2071 7565  added to the que
+00007b20: 7565 0a2a 2060 5bf0 9f94 8e5d 6020 7377  ue.* `[....]` sw
+00007b30: 6974 6368 2062 6574 7765 656e 2075 706c  itch between upl
+00007b40: 6f61 6420 616e 6420 5b66 696c 652d 7365  oad and [file-se
+00007b50: 6172 6368 5d28 2366 696c 652d 7365 6172  arch](#file-sear
+00007b60: 6368 2920 6d6f 6465 0a20 202a 2069 676e  ch) mode.  * ign
+00007b70: 6f72 6520 605b f09f 948e 5d60 2069 6620  ore `[....]` if 
+00007b80: 796f 7520 6164 6420 6669 6c65 7320 6279  you add files by
+00007b90: 2064 7261 6767 696e 6720 7468 656d 2069   dragging them i
+00007ba0: 6e74 6f20 7468 6520 6272 6f77 7365 720a  nto the browser.
+00007bb0: 0a61 6e64 2074 6865 6e20 7468 6572 6573  .and then theres
+00007bc0: 2074 6865 2074 6162 7320 6265 6c6f 7720   the tabs below 
+00007bd0: 6974 2c0a 2a20 605b 6f6b 5d60 2069 7320  it,.* `[ok]` is 
+00007be0: 7468 6520 6669 6c65 7320 7768 6963 6820  the files which 
+00007bf0: 636f 6d70 6c65 7465 6420 7375 6363 6573  completed succes
+00007c00: 7366 756c 6c79 0a2a 2060 5b6e 675d 6020  sfully.* `[ng]` 
+00007c10: 6973 2074 6865 206f 6e65 7320 7468 6174  is the ones that
+00007c20: 2066 6169 6c65 6420 2f20 676f 7420 7265   failed / got re
+00007c30: 6a65 6374 6564 2028 616c 7265 6164 7920  jected (already 
+00007c40: 6578 6973 7473 2c20 2e2e 2e29 0a2a 2060  exists, ...).* `
+00007c50: 5b64 6f6e 655d 6020 7368 6f77 7320 6120  [done]` shows a 
+00007c60: 636f 6d62 696e 6564 206c 6973 7420 6f66  combined list of
+00007c70: 2060 5b6f 6b5d 6020 616e 6420 605b 6e67   `[ok]` and `[ng
+00007c80: 5d60 2c20 6368 726f 6e6f 6c6f 6769 6361  ]`, chronologica
+00007c90: 6c20 6f72 6465 720a 2a20 605b 6275 7379  l order.* `[busy
+00007ca0: 5d60 2066 696c 6573 2077 6869 6368 2061  ]` files which a
+00007cb0: 7265 2063 7572 7265 6e74 6c79 2068 6173  re currently has
+00007cc0: 6869 6e67 2c20 7065 6e64 696e 672d 7570  hing, pending-up
+00007cd0: 6c6f 6164 2c20 6f72 2075 706c 6f61 6469  load, or uploadi
+00007ce0: 6e67 0a20 202a 2070 6c75 7320 7570 2074  ng.  * plus up t
+00007cf0: 6f20 3320 656e 7472 6965 7320 6561 6368  o 3 entries each
+00007d00: 2066 726f 6d20 605b 646f 6e65 5d60 2061   from `[done]` a
+00007d10: 6e64 2060 5b71 7565 5d60 2066 6f72 2063  nd `[que]` for c
+00007d20: 6f6e 7465 7874 0a2a 2060 5b71 7565 5d60  ontext.* `[que]`
+00007d30: 2069 7320 616c 6c20 7468 6520 6669 6c65   is all the file
+00007d40: 7320 7468 6174 2061 7265 2073 7469 6c6c  s that are still
+00007d50: 2071 7565 7565 640a 0a6e 6f74 6520 7468   queued..note th
+00007d60: 6174 2073 696e 6365 2075 7032 6b20 6861  at since up2k ha
+00007d70: 7320 746f 2072 6561 6420 6561 6368 2066  s to read each f
+00007d80: 696c 6520 7477 6963 652c 2060 5bf0 9f8e  ile twice, `[...
+00007d90: 885d 2062 7570 6020 6361 6e20 2a74 6865  .] bup` can *the
+00007da0: 6f72 6574 6963 616c 6c79 2a20 6265 2075  oretically* be u
+00007db0: 7020 746f 2032 7820 6661 7374 6572 2069  p to 2x faster i
+00007dc0: 6e20 736f 6d65 2065 7874 7265 6d65 2063  n some extreme c
+00007dd0: 6173 6573 2028 6669 6c65 7320 6269 6767  ases (files bigg
+00007de0: 6572 2074 6861 6e20 796f 7572 2072 616d  er than your ram
+00007df0: 2c20 636f 6d62 696e 6564 2077 6974 6820  , combined with 
+00007e00: 616e 2069 6e74 6572 6e65 7420 636f 6e6e  an internet conn
+00007e10: 6563 7469 6f6e 2066 6173 7465 7220 7468  ection faster th
+00007e20: 616e 2074 6865 2072 6561 642d 7370 6565  an the read-spee
+00007e30: 6420 6f66 2079 6f75 7220 4844 442c 206f  d of your HDD, o
+00007e40: 7220 6966 2079 6f75 2772 6520 7570 6c6f  r if you're uplo
+00007e50: 6164 696e 6720 6672 6f6d 2061 2063 756f  ading from a cuo
+00007e60: 3264 756f 290a 0a69 6620 796f 7520 6172  2duo)..if you ar
+00007e70: 6520 7265 7375 6d69 6e67 2061 206d 6173  e resuming a mas
+00007e80: 7369 7665 2075 706c 6f61 6420 616e 6420  sive upload and 
+00007e90: 7761 6e74 2074 6f20 736b 6970 2068 6173  want to skip has
+00007ea0: 6869 6e67 2074 6865 2066 696c 6573 2077  hing the files w
+00007eb0: 6869 6368 2061 6c72 6561 6479 2066 696e  hich already fin
+00007ec0: 6973 6865 642c 2079 6f75 2063 616e 2065  ished, you can e
+00007ed0: 6e61 626c 6520 6074 7572 626f 6020 696e  nable `turbo` in
+00007ee0: 2074 6865 2060 5be2 9a99 efb8 8f5d 2063   the `[......] c
+00007ef0: 6f6e 6669 6760 2074 6162 2c20 6275 7420  onfig` tab, but 
+00007f00: 706c 6561 7365 2072 6561 6420 7468 6520  please read the 
+00007f10: 746f 6f6c 7469 7020 6f6e 2074 6861 7420  tooltip on that 
+00007f20: 6275 7474 6f6e 0a0a 0a23 2323 2066 696c  button...### fil
+00007f30: 652d 7365 6172 6368 0a0a 6472 6f70 7069  e-search..droppi
+00007f40: 6e67 2066 696c 6573 2069 6e74 6f20 7468  ng files into th
+00007f50: 6520 6272 6f77 7365 7220 616c 736f 206c  e browser also l
+00007f60: 6574 7320 796f 7520 7365 6520 6966 2074  ets you see if t
+00007f70: 6865 7920 6578 6973 7420 6f6e 2074 6865  hey exist on the
+00007f80: 2073 6572 7665 720a 0a21 5b63 6f70 7970   server..![copyp
+00007f90: 6172 7479 2d66 7365 6172 6368 2d66 7338  arty-fsearch-fs8
+00007fa0: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00007fb0: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00007fc0: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00007fd0: 3332 2f31 3239 3633 3533 3631 2d63 3739  32/129635361-c79
+00007fe0: 3238 3666 302d 6238 6631 2d34 3430 652d  286f0-b8f1-440e-
+00007ff0: 6161 6634 2d36 6539 3239 3432 3866 6163  aaf4-6e929428fac
+00008000: 392e 706e 6729 0a0a 7768 656e 2079 6f75  9.png)..when you
+00008010: 2064 7261 672f 6472 6f70 2066 696c 6573   drag/drop files
+00008020: 2069 6e74 6f20 7468 6520 6272 6f77 7365   into the browse
+00008030: 722c 2079 6f75 2077 696c 6c20 7365 6520  r, you will see 
+00008040: 7477 6f20 6472 6f70 7a6f 6e65 733a 2060  two dropzones: `
+00008050: 5570 6c6f 6164 6020 616e 6420 6053 6561  Upload` and `Sea
+00008060: 7263 6860 0a0a 3e20 6f6e 2061 2070 686f  rch`..> on a pho
+00008070: 6e65 3f20 746f 6767 6c65 2074 6865 2060  ne? toggle the `
+00008080: 5bf0 9f94 8e5d 6020 7377 6974 6368 2067  [....]` switch g
+00008090: 7265 656e 2062 6566 6f72 6520 7461 7070  reen before tapp
+000080a0: 696e 6720 7468 6520 6269 6720 7965 6c6c  ing the big yell
+000080b0: 6f77 2053 6561 7263 6820 6275 7474 6f6e  ow Search button
+000080c0: 2074 6f20 7365 6c65 6374 2079 6f75 7220   to select your 
+000080d0: 6669 6c65 730a 0a74 6865 2066 696c 6573  files..the files
+000080e0: 2077 696c 6c20 6265 2068 6173 6865 6420   will be hashed 
+000080f0: 6f6e 2074 6865 2063 6c69 656e 742d 7369  on the client-si
+00008100: 6465 2c20 616e 6420 6561 6368 2068 6173  de, and each has
+00008110: 6820 6973 2073 656e 7420 746f 2074 6865  h is sent to the
+00008120: 2073 6572 7665 722c 2077 6869 6368 2063   server, which c
+00008130: 6865 636b 7320 6966 2074 6861 7420 6669  hecks if that fi
+00008140: 6c65 2065 7869 7374 7320 736f 6d65 7768  le exists somewh
+00008150: 6572 650a 0a66 696c 6573 2067 6f20 696e  ere..files go in
+00008160: 746f 2060 5b6f 6b5d 6020 6966 2074 6865  to `[ok]` if the
+00008170: 7920 6578 6973 7420 2861 6e64 2079 6f75  y exist (and you
+00008180: 2067 6574 2061 206c 696e 6b20 746f 2077   get a link to w
+00008190: 6865 7265 2069 7420 6973 292c 206f 7468  here it is), oth
+000081a0: 6572 7769 7365 2074 6865 7920 6c61 6e64  erwise they land
+000081b0: 2069 6e20 605b 6e67 5d60 0a2a 2074 6865   in `[ng]`.* the
+000081c0: 206d 6169 6e20 7265 6173 6f6e 2066 696c   main reason fil
+000081d0: 6573 6561 7263 6820 6973 2063 6f6d 6269  esearch is combi
+000081e0: 6e65 6420 7769 7468 2074 6865 2075 706c  ned with the upl
+000081f0: 6f61 6465 7220 6973 2063 6175 7365 2074  oader is cause t
+00008200: 6865 2063 6f64 6520 7761 7320 746f 6f20  he code was too 
+00008210: 7370 6167 6865 7474 6920 746f 2073 6570  spaghetti to sep
+00008220: 6172 6174 6520 6974 206f 7574 2073 6f6d  arate it out som
+00008230: 6577 6865 7265 2065 6c73 652c 2074 6869  ewhere else, thi
+00008240: 7320 6973 206e 6f20 6c6f 6e67 6572 2074  s is no longer t
+00008250: 6865 2063 6173 6520 6275 7420 6e6f 7720  he case but now 
+00008260: 6927 7665 2077 6172 6d65 6420 7570 2074  i've warmed up t
+00008270: 6f20 7468 6520 6964 6561 2074 6f6f 206d  o the idea too m
+00008280: 7563 680a 0a0a 2323 2320 756e 706f 7374  uch...### unpost
+00008290: 0a0a 756e 646f 2f64 656c 6574 6520 6163  ..undo/delete ac
+000082a0: 6369 6465 6e74 616c 2075 706c 6f61 6473  cidental uploads
+000082b0: 0a0a 215b 636f 7079 7061 7274 792d 756e  ..![copyparty-un
+000082c0: 706f 7374 2d66 7338 5d28 6874 7470 733a  post-fs8](https:
+000082d0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000082e0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000082f0: 636f 6d2f 3234 3130 3332 2f31 3239 3633  com/241032/12963
+00008300: 3533 3638 2d33 6166 6136 3633 342d 6332  5368-3afa6634-c2
+00008310: 3066 2d34 3138 632d 3930 6463 2d65 6334  0f-418c-90dc-ec4
+00008320: 3131 6633 6233 3839 372e 706e 6729 0a0a  11f3b3897.png)..
+00008330: 796f 7520 6361 6e20 756e 706f 7374 2065  you can unpost e
+00008340: 7665 6e20 6966 2079 6f75 2064 6f6e 2774  ven if you don't
+00008350: 2068 6176 6520 7265 6775 6c61 7220 6d6f   have regular mo
+00008360: 7665 2f64 656c 6574 6520 6163 6365 7373  ve/delete access
+00008370: 2c20 686f 7765 7665 7220 6f6e 6c79 2066  , however only f
+00008380: 6f72 2066 696c 6573 2075 706c 6f61 6465  or files uploade
+00008390: 6420 7769 7468 696e 2074 6865 2070 6173  d within the pas
+000083a0: 7420 602d 2d75 6e70 6f73 7460 2073 6563  t `--unpost` sec
+000083b0: 6f6e 6473 2028 6465 6661 756c 7420 3132  onds (default 12
+000083c0: 2068 6f75 7273 2920 616e 6420 7468 6520   hours) and the 
+000083d0: 7365 7276 6572 206d 7573 7420 6265 2072  server must be r
+000083e0: 756e 6e69 6e67 2077 6974 6820 602d 6532  unning with `-e2
+000083f0: 6460 0a0a 0a23 2323 2073 656c 662d 6465  d`...### self-de
+00008400: 7374 7275 6374 0a0a 7570 6c6f 6164 7320  struct..uploads 
+00008410: 6361 6e20 6265 2067 6976 656e 2061 206c  can be given a l
+00008420: 6966 6574 696d 652c 2020 6166 6572 2077  ifetime,  afer w
+00008430: 6869 6368 2074 6865 7920 6578 7069 7265  hich they expire
+00008440: 202f 2073 656c 662d 6465 7374 7275 6374   / self-destruct
+00008450: 0a0a 7468 6520 6665 6174 7572 6520 6d75  ..the feature mu
+00008460: 7374 2062 6520 656e 6162 6c65 6420 7065  st be enabled pe
+00008470: 722d 766f 6c75 6d65 2077 6974 6820 7468  r-volume with th
+00008480: 6520 606c 6966 6574 696d 6560 205b 7570  e `lifetime` [up
+00008490: 6c6f 6164 2072 756c 655d 2823 7570 6c6f  load rule](#uplo
+000084a0: 6164 2d72 756c 6573 2920 7768 6963 6820  ad-rules) which 
+000084b0: 7365 7473 2074 6865 2075 7070 6572 206c  sets the upper l
+000084c0: 696d 6974 2066 6f72 2068 6f77 206c 6f6e  imit for how lon
+000084d0: 6720 6120 6669 6c65 2067 6574 7320 746f  g a file gets to
+000084e0: 2073 7461 7920 6f6e 2074 6865 2073 6572   stay on the ser
+000084f0: 7665 720a 0a63 6c69 656e 7473 2063 616e  ver..clients can
+00008500: 2073 7065 6369 6679 2061 2073 686f 7274   specify a short
+00008510: 6572 2065 7870 6972 6174 696f 6e20 7469  er expiration ti
+00008520: 6d65 2075 7369 6e67 2074 6865 205b 7570  me using the [up
+00008530: 326b 2075 695d 2823 7570 6c6f 6164 696e  2k ui](#uploadin
+00008540: 6729 202d 2d20 7468 6520 7265 6c65 7661  g) -- the releva
+00008550: 6e74 206f 7074 696f 6e73 2062 6563 6f6d  nt options becom
+00008560: 6520 7669 7369 626c 6520 7570 6f6e 206e  e visible upon n
+00008570: 6176 6967 6174 696e 6720 696e 746f 2061  avigating into a
+00008580: 2066 6f6c 6465 7220 7769 7468 2060 6c69   folder with `li
+00008590: 6665 7469 6d65 7360 2065 6e61 626c 6564  fetimes` enabled
+000085a0: 202d 2d20 6f72 2062 7920 7573 696e 6720   -- or by using 
+000085b0: 7468 6520 606c 6966 6560 205b 7570 6c6f  the `life` [uplo
+000085c0: 6164 206d 6f64 6966 6965 725d 2823 7772  ad modifier](#wr
+000085d0: 6974 6529 0a0a 7370 6563 6966 7969 6e67  ite)..specifying
+000085e0: 2061 2063 7573 746f 6d20 6578 7069 7261   a custom expira
+000085f0: 7469 6f6e 2074 696d 6520 636c 6965 6e74  tion time client
+00008600: 2d73 6964 6520 7769 6c6c 2061 6666 6563  -side will affec
+00008610: 7420 7468 6520 7469 6d65 7370 616e 2069  t the timespan i
+00008620: 6e20 7768 6963 6820 756e 706f 7374 7320  n which unposts 
+00008630: 6172 6520 7065 726d 6974 7465 642c 2073  are permitted, s
+00008640: 6f20 6b65 6570 2061 6e20 6579 6520 6f6e  o keep an eye on
+00008650: 2074 6865 2065 7374 696d 6174 6573 2069   the estimates i
+00008660: 6e20 7468 6520 7570 326b 2075 690a 0a0a  n the up2k ui...
+00008670: 2323 2066 696c 6520 6d61 6e61 6765 720a  ## file manager.
+00008680: 0a63 7574 2f70 6173 7465 2c20 7265 6e61  .cut/paste, rena
+00008690: 6d65 2c20 616e 6420 6465 6c65 7465 2066  me, and delete f
+000086a0: 696c 6573 2f66 6f6c 6465 7273 2028 6966  iles/folders (if
+000086b0: 2079 6f75 2068 6176 6520 7065 726d 6973   you have permis
+000086c0: 7369 6f6e 290a 0a66 696c 6520 7365 6c65  sion)..file sele
+000086d0: 6374 696f 6e3a 2063 6c69 636b 2073 6f6d  ction: click som
+000086e0: 6577 6865 7265 206f 6e20 7468 6520 6c69  ewhere on the li
+000086f0: 6e65 2028 6e6f 7420 7468 6520 6c69 6e6b  ne (not the link
+00008700: 2069 7473 6566 292c 2074 6865 6e3a 0a2a   itsef), then:.*
+00008710: 2060 7370 6163 6560 2074 6f20 746f 6767   `space` to togg
+00008720: 6c65 0a2a 2060 7570 2f64 6f77 6e60 2074  le.* `up/down` t
+00008730: 6f20 6d6f 7665 0a2a 2060 7368 6966 742d  o move.* `shift-
+00008740: 7570 2f64 6f77 6e60 2074 6f20 6d6f 7665  up/down` to move
+00008750: 2d61 6e64 2d73 656c 6563 740a 2a20 6063  -and-select.* `c
+00008760: 7472 6c2d 7368 6966 742d 7570 2f64 6f77  trl-shift-up/dow
+00008770: 6e60 2074 6f20 616c 736f 2073 6372 6f6c  n` to also scrol
+00008780: 6c0a 0a2a 2063 7574 3a20 7365 6c65 6374  l..* cut: select
+00008790: 2073 6f6d 6520 6669 6c65 7320 616e 6420   some files and 
+000087a0: 6063 7472 6c2d 7860 0a2a 2070 6173 7465  `ctrl-x`.* paste
+000087b0: 3a20 6063 7472 6c2d 7660 2069 6e20 616e  : `ctrl-v` in an
+000087c0: 6f74 6865 7220 666f 6c64 6572 0a2a 2072  other folder.* r
+000087d0: 656e 616d 653a 2060 4632 600a 0a79 6f75  ename: `F2`..you
+000087e0: 2063 616e 206d 6f76 6520 6669 6c65 7320   can move files 
+000087f0: 6163 726f 7373 2062 726f 7773 6572 2074  across browser t
+00008800: 6162 7320 2863 7574 2069 6e20 6f6e 6520  abs (cut in one 
+00008810: 7461 622c 2070 6173 7465 2069 6e20 616e  tab, paste in an
+00008820: 6f74 6865 7229 0a0a 0a23 2320 6261 7463  other)...## batc
+00008830: 6820 7265 6e61 6d65 0a0a 7365 6c65 6374  h rename..select
+00008840: 2073 6f6d 6520 6669 6c65 7320 616e 6420   some files and 
+00008850: 7072 6573 7320 6046 3260 2074 6f20 6272  press `F2` to br
+00008860: 696e 6720 7570 2074 6865 2072 656e 616d  ing up the renam
+00008870: 6520 5549 0a0a 215b 6261 7463 682d 7265  e UI..![batch-re
+00008880: 6e61 6d65 2d66 7338 5d28 6874 7470 733a  name-fs8](https:
+00008890: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000088a0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000088b0: 636f 6d2f 3234 3130 3332 2f31 3238 3433  com/241032/12843
+000088c0: 3432 3034 2d65 6231 3336 3638 302d 3363  4204-eb136680-3c
+000088d0: 3037 2d34 6563 372d 3932 6530 2d61 6538  07-4ec7-92e0-ae8
+000088e0: 3661 6632 3063 3234 312e 706e 6729 0a0a  6af20c241.png)..
+000088f0: 7175 6963 6b20 6578 706c 616e 6174 696f  quick explanatio
+00008900: 6e20 6f66 2074 6865 2062 7574 746f 6e73  n of the buttons
+00008910: 2c20 200a 2a20 605b e29c 8520 6170 706c  ,  .* `[... appl
+00008920: 7920 7265 6e61 6d65 5d60 2063 6f6e 6669  y rename]` confi
+00008930: 726d 7320 616e 6420 6265 6769 6e73 2072  rms and begins r
+00008940: 656e 616d 696e 670a 2a20 605b e29d 8c20  enaming.* `[... 
+00008950: 6361 6e63 656c 5d60 2061 626f 7274 7320  cancel]` aborts 
+00008960: 616e 6420 636c 6f73 6573 2074 6865 2072  and closes the r
+00008970: 656e 616d 6520 7769 6e64 6f77 0a2a 2060  ename window.* `
+00008980: 5be2 86ba 2072 6573 6574 5d60 2072 6576  [... reset]` rev
+00008990: 6572 7473 2061 6e79 2066 696c 656e 616d  erts any filenam
+000089a0: 6520 6368 616e 6765 7320 6261 636b 2074  e changes back t
+000089b0: 6f20 7468 6520 6f72 6967 696e 616c 206e  o the original n
+000089c0: 616d 650a 2a20 605b 6465 636f 6465 5d60  ame.* `[decode]`
+000089d0: 2064 6f65 7320 6120 5552 4c2d 6465 636f   does a URL-deco
+000089e0: 6465 206f 6e20 7468 6520 6669 6c65 6e61  de on the filena
+000089f0: 6d65 2c20 6669 7869 6e67 2073 7475 6666  me, fixing stuff
+00008a00: 206c 696b 6520 6026 616d 703b 6020 616e   like `&amp;` an
+00008a10: 6420 6025 3230 600a 2a20 605b 6164 7661  d `%20`.* `[adva
+00008a20: 6e63 6564 5d60 2074 6f67 676c 6573 2061  nced]` toggles a
+00008a30: 6476 616e 6365 6420 6d6f 6465 0a0a 6164  dvanced mode..ad
+00008a40: 7661 6e63 6564 206d 6f64 653a 2072 656e  vanced mode: ren
+00008a50: 616d 6520 6669 6c65 7320 6261 7365 6420  ame files based 
+00008a60: 6f6e 2072 756c 6573 2074 6f20 6465 6369  on rules to deci
+00008a70: 6465 2074 6865 206e 6577 206e 616d 6573  de the new names
+00008a80: 2c20 6261 7365 6420 6f6e 2074 6865 206f  , based on the o
+00008a90: 7269 6769 6e61 6c20 6e61 6d65 2028 7265  riginal name (re
+00008aa0: 6765 7829 2c20 6f72 2062 6173 6564 206f  gex), or based o
+00008ab0: 6e20 7468 6520 7461 6773 2063 6f6c 6c65  n the tags colle
+00008ac0: 6374 6564 2066 726f 6d20 7468 6520 6669  cted from the fi
+00008ad0: 6c65 2028 6172 7469 7374 2f74 6974 6c65  le (artist/title
+00008ae0: 2f2e 2e2e 292c 206f 7220 6120 6d69 7820  /...), or a mix 
+00008af0: 6f66 2062 6f74 680a 0a69 6e20 6164 7661  of both..in adva
+00008b00: 6e63 6564 206d 6f64 652c 2020 0a2a 2060  nced mode,  .* `
+00008b10: 5b63 6173 655d 6020 746f 6767 6c65 7320  [case]` toggles 
+00008b20: 6361 7365 2d73 656e 7369 7469 7665 2072  case-sensitive r
+00008b30: 6567 6578 0a2a 2060 7265 6765 7860 2069  egex.* `regex` i
+00008b40: 7320 7468 6520 7265 6765 7820 7061 7474  s the regex patt
+00008b50: 6572 6e20 746f 2061 7070 6c79 2074 6f20  ern to apply to 
+00008b60: 7468 6520 6f72 6967 696e 616c 2066 696c  the original fil
+00008b70: 656e 616d 653b 2061 6e79 2066 696c 6573  ename; any files
+00008b80: 2077 6869 6368 2064 6f6e 2774 206d 6174   which don't mat
+00008b90: 6368 2077 696c 6c20 6265 2073 6b69 7070  ch will be skipp
+00008ba0: 6564 0a2a 2060 666f 726d 6174 6020 6973  ed.* `format` is
+00008bb0: 2074 6865 206e 6577 2066 696c 656e 616d   the new filenam
+00008bc0: 652c 2074 616b 696e 6720 7661 6c75 6573  e, taking values
+00008bd0: 2066 726f 6d20 7265 6765 7820 6361 7074   from regex capt
+00008be0: 7572 696e 6720 6772 6f75 7073 2061 6e64  uring groups and
+00008bf0: 2f6f 7220 6672 6f6d 2066 696c 6520 7461  /or from file ta
+00008c00: 6773 0a20 202a 2076 6572 7920 6c6f 6f73  gs.  * very loos
+00008c10: 656c 7920 6261 7365 6420 6f6e 2066 6f6f  ely based on foo
+00008c20: 6261 7232 3030 3020 7379 6e74 6178 0a2a  bar2000 syntax.*
+00008c30: 2060 7072 6573 6574 7360 206c 6574 7320   `presets` lets 
+00008c40: 796f 7520 7361 7665 2072 656e 616d 6520  you save rename 
+00008c50: 7275 6c65 7320 666f 7220 6c61 7465 720a  rules for later.
+00008c60: 0a61 7661 696c 6162 6c65 2066 756e 6374  .available funct
+00008c70: 696f 6e73 3a0a 2a20 6024 6c70 6164 2874  ions:.* `$lpad(t
+00008c80: 6578 742c 206c 656e 6774 682c 2070 6164  ext, length, pad
+00008c90: 5f63 6861 7229 600a 2a20 6024 7270 6164  _char)`.* `$rpad
+00008ca0: 2874 6578 742c 206c 656e 6774 682c 2070  (text, length, p
+00008cb0: 6164 5f63 6861 7229 600a 0a73 6f2c 0a0a  ad_char)`..so,..
+00008cc0: 7361 7920 796f 7520 6861 7665 2061 2066  say you have a f
+00008cd0: 696c 6520 6e61 6d65 6420 5b60 6d65 6761  ile named [`mega
+00008ce0: 6e65 6b6f 202d 2045 636c 6970 7365 202d  neko - Eclipse -
+00008cf0: 2030 3720 5369 7269 7573 2041 2e6d 7033   07 Sirius A.mp3
+00008d00: 605d 2868 7474 7073 3a2f 2f77 7777 2e79  `](https://www.y
+00008d10: 6f75 7475 6265 2e63 6f6d 2f77 6174 6368  outube.com/watch
+00008d20: 3f76 3d2d 6474 6230 7644 5072 7549 2920  ?v=-dtb0vDPruI) 
+00008d30: 2861 6273 6f6c 7574 656c 7920 6661 6e74  (absolutely fant
+00008d40: 6173 7469 6320 616c 6275 6d20 6274 7729  astic album btw)
+00008d50: 2061 6e64 2074 6865 2074 6167 7320 6172   and the tags ar
+00008d60: 653a 2060 416c 6275 6d3a 4563 6c69 7073  e: `Album:Eclips
+00008d70: 6560 2c20 6041 7274 6973 743a 6d65 6761  e`, `Artist:mega
+00008d80: 6e65 6b6f 602c 2060 5469 746c 653a 5369  neko`, `Title:Si
+00008d90: 7269 7573 2041 602c 2060 746e 3a37 600a  rius A`, `tn:7`.
+00008da0: 0a79 6f75 2063 6f75 6c64 2075 7365 206a  .you could use j
+00008db0: 7573 7420 7265 6765 7820 746f 2072 656e  ust regex to ren
+00008dc0: 616d 6520 6974 3a0a 2a20 6072 6567 6578  ame it:.* `regex
+00008dd0: 6020 3d20 6028 2e2a 2920 2d20 282e 2a29  ` = `(.*) - (.*)
+00008de0: 202d 2028 5b30 2d39 5d7b 327d 2920 282e   - ([0-9]{2}) (.
+00008df0: 2a29 600a 2a20 6066 6f72 6d61 7460 203d  *)`.* `format` =
+00008e00: 2060 2833 292e 2028 3129 202d 2028 3429   `(3). (1) - (4)
+00008e10: 600a 2a20 606f 7574 7075 7460 203d 2060  `.* `output` = `
+00008e20: 3037 2e20 6d65 6761 6e65 6b6f 202d 2053  07. meganeko - S
+00008e30: 6972 6975 7320 412e 6d70 3360 0a0a 6f72  irius A.mp3`..or
+00008e40: 2079 6f75 2063 6f75 6c64 2075 7365 206a   you could use j
+00008e50: 7573 7420 7461 6773 3a0a 2a20 6066 6f72  ust tags:.* `for
+00008e60: 6d61 7460 203d 2060 246c 7061 6428 2874  mat` = `$lpad((t
+00008e70: 6e29 2c32 2c30 292e 2028 6172 7469 7374  n),2,0). (artist
+00008e80: 2920 2d20 2874 6974 6c65 292e 2865 7874  ) - (title).(ext
+00008e90: 2960 0a2a 2060 6f75 7470 7574 6020 3d20  )`.* `output` = 
+00008ea0: 6037 2e20 6d65 6761 6e65 6b6f 202d 2053  `7. meganeko - S
+00008eb0: 6972 6975 7320 412e 6d70 3360 0a0a 6f72  irius A.mp3`..or
+00008ec0: 2061 206d 6978 206f 6620 626f 7468 3a0a   a mix of both:.
+00008ed0: 2a20 6072 6567 6578 6020 3d20 6020 2d20  * `regex` = ` - 
+00008ee0: 285b 302d 395d 7b32 7d29 2060 0a2a 2060  ([0-9]{2}) `.* `
+00008ef0: 666f 726d 6174 6020 3d20 6028 3129 2e20  format` = `(1). 
+00008f00: 2861 7274 6973 7429 202d 2028 7469 746c  (artist) - (titl
+00008f10: 6529 2e28 6578 7429 600a 2a20 606f 7574  e).(ext)`.* `out
+00008f20: 7075 7460 203d 2060 3037 2e20 6d65 6761  put` = `07. mega
+00008f30: 6e65 6b6f 202d 2053 6972 6975 7320 412e  neko - Sirius A.
+00008f40: 6d70 3360 0a0a 7468 6520 6d65 7461 6461  mp3`..the metada
+00008f50: 7461 206b 6579 7320 796f 7520 6361 6e20  ta keys you can 
+00008f60: 7573 6520 696e 2074 6865 2066 6f72 6d61  use in the forma
+00008f70: 7420 6669 656c 6420 6172 6520 7468 6520  t field are the 
+00008f80: 6f6e 6573 2069 6e20 7468 6520 6669 6c65  ones in the file
+00008f90: 2d62 726f 7773 6572 2074 6162 6c65 2068  -browser table h
+00008fa0: 6561 6465 7220 2877 6861 7465 7665 7220  eader (whatever 
+00008fb0: 6973 2063 6f6c 6c65 6374 6564 2077 6974  is collected wit
+00008fc0: 6820 602d 6d74 6560 2061 6e64 2060 2d6d  h `-mte` and `-m
+00008fd0: 7470 6029 0a0a 0a23 2320 6d65 6469 6120  tp`)...## media 
+00008fe0: 706c 6179 6572 0a0a 706c 6179 7320 616c  player..plays al
+00008ff0: 6d6f 7374 2065 7665 7279 2061 7564 696f  most every audio
+00009000: 2066 6f72 6d61 7420 7468 6572 6520 6973   format there is
+00009010: 2020 2869 6620 7468 6520 7365 7276 6572    (if the server
+00009020: 2068 6173 2046 466d 7065 6720 696e 7374   has FFmpeg inst
+00009030: 616c 6c65 6420 666f 7220 6f6e 2d64 656d  alled for on-dem
+00009040: 616e 6420 7472 616e 7363 6f64 696e 6729  and transcoding)
+00009050: 0a0a 7468 6520 666f 6c6c 6f77 696e 6720  ..the following 
+00009060: 6175 6469 6f20 666f 726d 6174 7320 6172  audio formats ar
+00009070: 6520 7573 7561 6c6c 7920 616c 7761 7973  e usually always
+00009080: 2070 6c61 7961 626c 652c 2065 7665 6e20   playable, even 
+00009090: 7769 7468 6f75 7420 4646 6d70 6567 3a20  without FFmpeg: 
+000090a0: 6061 6163 7c66 6c61 637c 6d34 617c 6d70  `aac|flac|m4a|mp
+000090b0: 337c 6f67 677c 6f70 7573 7c77 6176 600a  3|ogg|opus|wav`.
+000090c0: 0a73 6f6d 6520 6869 6c69 6768 7473 3a0a  .some hilights:.
+000090d0: 2a20 4f53 2069 6e74 6567 7261 7469 6f6e  * OS integration
+000090e0: 3b20 636f 6e74 726f 6c20 706c 6179 6261  ; control playba
+000090f0: 636b 2066 726f 6d20 796f 7572 2070 686f  ck from your pho
+00009100: 6e65 2773 206c 6f63 6b73 6372 6565 6e20  ne's lockscreen 
+00009110: 285b 7769 6e64 6f77 735d 2868 7474 7073  ([windows](https
+00009120: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+00009130: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+00009140: 2e63 6f6d 2f32 3431 3033 322f 3233 3332  .com/241032/2332
+00009150: 3133 3032 322d 3239 3861 3938 6261 2d37  13022-298a98ba-7
+00009160: 3231 612d 3463 6631 2d61 3364 342d 6636  21a-4cf1-a3d4-f6
+00009170: 3236 3334 6263 3533 6435 2e70 6e67 2920  2634bc53d5.png) 
+00009180: 2f2f 205b 694f 535d 2868 7474 7073 3a2f  // [iOS](https:/
+00009190: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+000091a0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+000091b0: 6f6d 2f32 3431 3033 322f 3134 3237 3131  om/241032/142711
+000091c0: 3932 362d 3037 3030 6265 3663 2d33 6533  926-0700be6c-3e3
+000091d0: 312d 3437 6233 2d39 3932 382d 3533 3732  1-47b3-9928-5372
+000091e0: 3232 3231 6637 3232 2e70 6e67 2920 2f2f  2221f722.png) //
+000091f0: 205b 616e 6472 6f69 645d 2868 7474 7073   [android](https
+00009200: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+00009210: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+00009220: 2e63 6f6d 2f32 3431 3033 322f 3233 3332  .com/241032/2332
+00009230: 3132 3331 312d 6137 3336 3835 3930 2d30  12311-a7368590-0
+00009240: 3863 372d 3466 3966 2d61 3161 662d 3438  8c7-4f9f-a1af-48
+00009250: 6363 6633 6633 3666 6164 2e70 6e67 2929  ccf3f36fad.png))
+00009260: 0a2a 2073 686f 7773 2074 6865 2061 7564  .* shows the aud
+00009270: 696f 2077 6176 6566 6f72 6d20 696e 2074  io waveform in t
+00009280: 6865 2073 6565 6b62 6172 0a2a 206e 6f74  he seekbar.* not
+00009290: 2070 6572 6665 6374 6c79 2067 6170 6c65   perfectly gaple
+000092a0: 7373 2062 7574 2063 616e 2067 6574 2072  ss but can get r
+000092b0: 6561 6c6c 7920 636c 6f73 6520 2873 6565  eally close (see
+000092c0: 2073 6574 7469 6e67 7320 2b20 6571 2062   settings + eq b
+000092d0: 656c 6f77 293b 2067 6f6f 6420 656e 6f75  elow); good enou
+000092e0: 6768 2074 6f20 656e 6a6f 7920 6761 706c  gh to enjoy gapl
+000092f0: 6573 7320 616c 6275 6d73 2061 7320 696e  ess albums as in
+00009300: 7465 6e64 6564 0a0a 636c 6963 6b20 7468  tended..click th
+00009310: 6520 6070 6c61 7960 206c 696e 6b20 6e65  e `play` link ne
+00009320: 7874 2074 6f20 616e 2061 7564 696f 2066  xt to an audio f
+00009330: 696c 652c 206f 7220 636f 7079 2074 6865  ile, or copy the
+00009340: 206c 696e 6b20 7461 7267 6574 2074 6f20   link target to 
+00009350: 5b73 6861 7265 2069 745d 2868 7474 7073  [share it](https
+00009360: 3a2f 2f61 2e6f 6376 2e6d 652f 7075 622f  ://a.ocv.me/pub/
+00009370: 6465 6d6f 2f6d 7573 6963 2f55 6269 6b74  demo/music/Ubikt
+00009380: 756e 6525 3230 2d25 3230 534f 554e 4453  une%20-%20SOUNDS
+00009390: 484f 434b 2532 3032 2532 302d 2532 3046  HOCK%202%20-%20F
+000093a0: 4d25 3230 4655 4e4b 2532 3054 4552 5252  M%20FUNK%20TERRR
+000093b0: 4f52 2121 2f23 6166 2d31 6662 6662 6136  OR!!/#af-1fbfba6
+000093c0: 3126 743d 3138 2920 286f 7074 696f 6e61  1&t=18) (optiona
+000093d0: 6c6c 7920 7769 7468 2061 2074 696d 6573  lly with a times
+000093e0: 7461 6d70 2074 6f20 7374 6172 7420 706c  tamp to start pl
+000093f0: 6179 696e 6720 6672 6f6d 2c20 6c69 6b65  aying from, like
+00009400: 2074 6861 7420 6578 616d 706c 6520 646f   that example do
+00009410: 6573 290a 0a6f 7065 6e20 7468 6520 605b  es)..open the `[
+00009420: f09f 8eba 5d60 206d 6564 6961 2d70 6c61  ....]` media-pla
+00009430: 7965 722d 7365 7474 696e 6773 2074 6162  yer-settings tab
+00009440: 2074 6f20 636f 6e66 6967 7572 6520 6974   to configure it
+00009450: 2c0a 2a20 7377 6974 6368 6573 3a0a 2020  ,.* switches:.  
+00009460: 2a20 605b 7072 656c 6f61 645d 6020 7374  * `[preload]` st
+00009470: 6172 7473 206c 6f61 6469 6e67 2074 6865  arts loading the
+00009480: 206e 6578 7420 7472 6163 6b20 7768 656e   next track when
+00009490: 2069 7427 7320 6162 6f75 7420 746f 2065   it's about to e
+000094a0: 6e64 2c20 7265 6475 6365 7320 7468 6520  nd, reduces the 
+000094b0: 7369 6c65 6e63 6520 6265 7477 6565 6e20  silence between 
+000094c0: 736f 6e67 730a 2020 2a20 605b 6675 6c6c  songs.  * `[full
+000094d0: 5d60 2064 6f65 7320 6120 6675 6c6c 2070  ]` does a full p
+000094e0: 7265 6c6f 6164 2062 7920 646f 776e 6c6f  reload by downlo
+000094f0: 6164 696e 6720 7468 6520 656e 7469 7265  ading the entire
+00009500: 206e 6578 7420 6669 6c65 3b20 676f 6f64   next file; good
+00009510: 2066 6f72 2075 6e72 656c 6961 626c 6520   for unreliable 
+00009520: 636f 6e6e 6563 7469 6f6e 732c 2062 6164  connections, bad
+00009530: 2066 6f72 2073 6c6f 7720 636f 6e6e 6563   for slow connec
+00009540: 7469 6f6e 730a 2020 2a20 605b 7e73 5d60  tions.  * `[~s]`
+00009550: 2074 6f67 676c 6573 2074 6865 2073 6565   toggles the see
+00009560: 6b62 6172 2077 6176 6566 6f72 6d20 6469  kbar waveform di
+00009570: 7370 6c61 790a 2020 2a20 605b 2f6e 705d  splay.  * `[/np]
+00009580: 6020 656e 6162 6c65 7320 6275 7474 6f6e  ` enables button
+00009590: 7320 746f 2063 6f70 7920 7468 6520 6e6f  s to copy the no
+000095a0: 772d 706c 6179 696e 6720 696e 666f 2061  w-playing info a
+000095b0: 7320 616e 2069 7263 206d 6573 7361 6765  s an irc message
+000095c0: 0a20 202a 2060 5b6f 732d 6374 6c5d 6020  .  * `[os-ctl]` 
+000095d0: 6d61 6b65 7320 6974 2070 6f73 7369 626c  makes it possibl
+000095e0: 6520 746f 2063 6f6e 7472 6f6c 2061 7564  e to control aud
+000095f0: 696f 2070 6c61 7962 6163 6b20 6672 6f6d  io playback from
+00009600: 2074 6865 206c 6f63 6b73 6372 6565 6e20   the lockscreen 
+00009610: 6f66 2079 6f75 7220 6465 7669 6365 2028  of your device (
+00009620: 656e 6162 6c65 7320 5b6d 6564 6961 7365  enables [mediase
+00009630: 7373 696f 6e5d 2868 7474 7073 3a2f 2f64  ssion](https://d
+00009640: 6576 656c 6f70 6572 2e6d 6f7a 696c 6c61  eveloper.mozilla
+00009650: 2e6f 7267 2f65 6e2d 5553 2f64 6f63 732f  .org/en-US/docs/
+00009660: 5765 622f 4150 492f 4d65 6469 6153 6573  Web/API/MediaSes
+00009670: 7369 6f6e 2929 0a20 202a 2060 5b73 6565  sion)).  * `[see
+00009680: 6b5d 6020 616c 6c6f 7773 2073 6565 6b69  k]` allows seeki
+00009690: 6e67 2077 6974 6820 6c6f 636b 7363 7265  ng with lockscre
+000096a0: 656e 2063 6f6e 7472 6f6c 7320 2862 7567  en controls (bug
+000096b0: 6779 206f 6e20 736f 6d65 2064 6576 6963  gy on some devic
+000096c0: 6573 290a 2020 2a20 605b 6172 745d 6020  es).  * `[art]` 
+000096d0: 7368 6f77 7320 616c 6275 6d20 6172 7420  shows album art 
+000096e0: 6f6e 2074 6865 206c 6f63 6b73 6372 6565  on the lockscree
+000096f0: 6e0a 2020 2a20 605b f09f 8eaf 5d60 206b  n.  * `[....]` k
+00009700: 6565 7073 2074 6865 2070 6c61 7969 6e67  eeps the playing
+00009710: 2073 6f6e 6720 7363 726f 6c6c 6564 2069   song scrolled i
+00009720: 6e74 6f20 7669 6577 2028 676f 6f64 2077  nto view (good w
+00009730: 6865 6e20 7573 696e 6720 7468 6520 706c  hen using the pl
+00009740: 6179 6572 2061 7320 6120 7461 736b 6261  ayer as a taskba
+00009750: 7220 646f 636b 290a 2020 2a20 605b e29f  r dock).  * `[..
+00009760: 8e5d 6020 7368 7269 6e6b 7320 7468 6520  .]` shrinks the 
+00009770: 706c 6179 6261 636b 2063 6f6e 7472 6f6c  playback control
+00009780: 730a 2a20 706c 6179 6261 636b 206d 6f64  s.* playback mod
+00009790: 653a 0a20 202a 2060 5b6c 6f6f 705d 6020  e:.  * `[loop]` 
+000097a0: 6b65 6570 7320 6c6f 6f70 696e 6720 7468  keeps looping th
+000097b0: 6520 666f 6c64 6572 0a20 202a 2060 5b6e  e folder.  * `[n
+000097c0: 6578 745d 6020 706c 6179 7320 696e 746f  ext]` plays into
+000097d0: 2074 6865 206e 6578 7420 666f 6c64 6572   the next folder
+000097e0: 0a2a 2074 7261 6e73 636f 6465 3a0a 2020  .* transcode:.  
+000097f0: 2a20 605b 666c 6163 5d60 2063 6f6e 7665  * `[flac]` conve
+00009800: 7273 2060 666c 6163 6020 616e 6420 6077  rs `flac` and `w
+00009810: 6176 6020 6669 6c65 7320 696e 746f 206f  av` files into o
+00009820: 7075 730a 2020 2a20 605b 6161 635d 6020  pus.  * `[aac]` 
+00009830: 636f 6e76 6572 7473 2060 6161 6360 2061  converts `aac` a
+00009840: 6e64 2060 6d34 6160 2066 696c 6573 2069  nd `m4a` files i
+00009850: 6e74 6f20 6f70 7573 0a20 202a 2060 5b6f  nto opus.  * `[o
+00009860: 7468 5d60 2063 6f6e 7665 7274 7320 616c  th]` converts al
+00009870: 6c20 6f74 6865 7220 6b6e 6f77 6e20 666f  l other known fo
+00009880: 726d 6174 7320 696e 746f 206f 7075 730a  rmats into opus.
+00009890: 2020 2020 2a20 6061 6163 7c61 6333 7c61      * `aac|ac3|a
+000098a0: 6966 7c61 6966 667c 616c 6163 7c61 6c61  if|aiff|alac|ala
+000098b0: 777c 616d 727c 6170 657c 6175 7c64 6670  w|amr|ape|au|dfp
+000098c0: 776d 7c64 7473 7c66 6c61 637c 6773 6d7c  wm|dts|flac|gsm|
+000098d0: 6974 7c6d 3461 7c6d 6f33 7c6d 6f64 7c6d  it|m4a|mo3|mod|m
+000098e0: 7032 7c6d 7033 7c6d 7063 7c6d 7074 6d7c  p2|mp3|mpc|mptm|
+000098f0: 6d74 327c 6d75 6c61 777c 6f67 677c 6f6b  mt2|mulaw|ogg|ok
+00009900: 747c 6f70 7573 7c72 617c 7333 6d7c 7461  t|opus|ra|s3m|ta
+00009910: 6b7c 7474 617c 756c 6177 7c77 6176 7c77  k|tta|ulaw|wav|w
+00009920: 6d61 7c77 767c 786d 7c78 706b 600a 2a20  ma|wv|xm|xpk`.* 
+00009930: 2274 696e 7422 2072 6564 7563 6573 2074  "tint" reduces t
+00009940: 6865 2063 6f6e 7472 6173 7420 6f66 2074  he contrast of t
+00009950: 6865 2070 6c61 7962 6163 6b20 6261 720a  he playback bar.
+00009960: 0a0a 2323 2320 6175 6469 6f20 6571 7561  ..### audio equa
+00009970: 6c69 7a65 720a 0a62 6173 7320 626f 6f73  lizer..bass boos
+00009980: 7465 640a 0a63 616e 2061 6c73 6f20 626f  ted..can also bo
+00009990: 6f73 7420 7468 6520 766f 6c75 6d65 2069  ost the volume i
+000099a0: 6e20 6765 6e65 7261 6c2c 206f 7220 696e  n general, or in
+000099b0: 6372 6561 7365 2f64 6563 7265 6173 6520  crease/decrease 
+000099c0: 7374 6572 656f 2077 6964 7468 2028 6c69  stereo width (li
+000099d0: 6b65 205b 6372 6f73 7366 6565 645d 2868  ke [crossfeed](h
+000099e0: 7474 7073 3a2f 2f77 7777 2e66 6f6f 6261  ttps://www.fooba
+000099f0: 7232 3030 302e 6f72 672f 636f 6d70 6f6e  r2000.org/compon
+00009a00: 656e 7473 2f76 6965 772f 666f 6f5f 6473  ents/view/foo_ds
+00009a10: 705f 6d65 6965 7263 6629 206a 7573 7420  p_meiercf) just 
+00009a20: 776f 7273 6529 0a0a 6861 7320 7468 6520  worse)..has the 
+00009a30: 636f 6e76 656e 6965 6e74 2073 6964 652d  convenient side-
+00009a40: 6566 6665 6374 206f 6620 7265 6475 6369  effect of reduci
+00009a50: 6e67 2074 6865 2070 6175 7365 2062 6574  ng the pause bet
+00009a60: 7765 656e 2073 6f6e 6773 2c20 736f 2067  ween songs, so g
+00009a70: 6170 6c65 7373 2061 6c62 756d 7320 706c  apless albums pl
+00009a80: 6179 2062 6574 7465 7220 7769 7468 2074  ay better with t
+00009a90: 6865 2065 7120 656e 6162 6c65 6420 286a  he eq enabled (j
+00009aa0: 7573 7420 6d61 6b65 2069 7420 666c 6174  ust make it flat
+00009ab0: 290a 0a0a 2323 2320 6669 7820 756e 7265  )...### fix unre
+00009ac0: 6c69 6162 6c65 2070 6c61 7962 6163 6b20  liable playback 
+00009ad0: 6f6e 2061 6e64 726f 6964 0a0a 6475 6520  on android..due 
+00009ae0: 746f 2070 686f 6e65 202f 2061 7070 2073  to phone / app s
+00009af0: 6574 7469 6e67 732c 2020 616e 6472 6f69  ettings,  androi
+00009b00: 6420 7068 6f6e 6573 206d 6179 2072 616e  d phones may ran
+00009b10: 646f 6d6c 7920 7374 6f70 2070 6c61 7969  domly stop playi
+00009b20: 6e67 206d 7573 6963 2077 6865 6e20 7468  ng music when th
+00009b30: 6520 706f 7765 7220 7361 7665 7220 6b69  e power saver ki
+00009b40: 636b 7320 696e 2c20 6573 7065 6369 616c  cks in, especial
+00009b50: 6c79 2061 7420 7468 6520 656e 6420 6f66  ly at the end of
+00009b60: 2061 6e20 616c 6275 6d20 2d2d 2079 6f75   an album -- you
+00009b70: 2063 616e 2066 6978 2069 7420 6279 205b   can fix it by [
+00009b80: 6469 7361 626c 696e 6720 706f 7765 7220  disabling power 
+00009b90: 7361 7669 6e67 5d28 6874 7470 733a 2f2f  saving](https://
+00009ba0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00009bb0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00009bc0: 6d2f 3234 3130 3332 2f32 3335 3236 3231  m/241032/2352621
+00009bd0: 3233 2d63 3332 3863 6361 392d 3339 3330  23-c328cca9-3930
+00009be0: 2d34 3934 382d 6264 3138 2d33 3934 3962  -4948-bd18-3949b
+00009bf0: 3966 6433 6663 662e 706e 6729 2069 6e20  9fd3fcf.png) in 
+00009c00: 7468 6520 5b61 7070 2073 6574 7469 6e67  the [app setting
+00009c10: 735d 2868 7474 7073 3a2f 2f75 7365 722d  s](https://user-
+00009c20: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00009c30: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00009c40: 3033 322f 3233 3532 3632 3132 312d 3266  032/235262121-2f
+00009c50: 6663 3531 6165 2d37 3832 312d 3433 3130  fc51ae-7821-4310
+00009c60: 2d61 3332 322d 6333 6237 6135 3037 3839  -a322-c3b7a50789
+00009c70: 3063 2e70 6e67 2920 6f66 2074 6865 2062  0c.png) of the b
+00009c80: 726f 7773 6572 2079 6f75 2075 7365 2066  rowser you use f
+00009c90: 6f72 206d 7573 6963 2073 7472 6561 6d69  or music streami
+00009ca0: 6e67 2028 7072 6566 6572 6162 6c79 2061  ng (preferably a
+00009cb0: 2064 6564 6963 6174 6564 206f 6e65 290a   dedicated one).
+00009cc0: 0a0a 2323 206d 6172 6b64 6f77 6e20 7669  ..## markdown vi
+00009cd0: 6577 6572 0a0a 616e 6420 7468 6572 6520  ewer..and there 
+00009ce0: 6172 6520 2a74 776f 2a20 6564 6974 6f72  are *two* editor
+00009cf0: 730a 0a21 5b63 6f70 7970 6172 7479 2d6d  s..![copyparty-m
+00009d00: 642d 7265 6164 2d66 7338 5d28 6874 7470  d-read-fs8](http
+00009d10: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+00009d20: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+00009d30: 742e 636f 6d2f 3234 3130 3332 2f31 3135  t.com/241032/115
+00009d40: 3937 3830 3537 2d36 3634 3139 3038 302d  978057-66419080-
+00009d50: 6135 3764 2d31 3165 622d 3835 3339 2d64  a57d-11eb-8539-d
+00009d60: 3262 6538 3433 3939 3161 612e 706e 6729  2be843991aa.png)
+00009d70: 0a0a 7468 6572 6520 6973 2061 2062 7569  ..there is a bui
+00009d80: 6c74 2d69 6e20 6578 7465 6e73 696f 6e20  lt-in extension 
+00009d90: 666f 7220 696e 6c69 6e65 2063 6c69 636b  for inline click
+00009da0: 6162 6c65 2074 6875 6d62 6e61 696c 733b  able thumbnails;
+00009db0: 0a2a 2065 6e61 626c 6520 6974 2062 7920  .* enable it by 
+00009dc0: 6164 6469 6e67 2060 3c21 2d2d 2074 6820  adding `<!-- th 
+00009dd0: 2d2d 3e60 2073 6f6d 6577 6865 7265 2069  -->` somewhere i
+00009de0: 6e20 7468 6520 646f 630a 2a20 6164 6420  n the doc.* add 
+00009df0: 7468 756d 626e 6169 6c73 2077 6974 6820  thumbnails with 
+00009e00: 6021 7468 5b6c 5d28 796f 7572 2e6a 7067  `!th[l](your.jpg
+00009e10: 2960 2077 6865 7265 2060 6c60 206d 6561  )` where `l` mea
+00009e20: 6e73 206c 6566 742d 616c 6967 6e20 2860  ns left-align (`
+00009e30: 7260 203d 2072 6967 6874 2d61 6c69 676e  r` = right-align
+00009e40: 290a 2a20 6120 7369 6e67 6c65 206c 696e  ).* a single lin
+00009e50: 6520 7769 7468 2060 2d2d 2d60 2063 6c65  e with `---` cle
+00009e60: 6172 7320 7468 6520 666c 6f61 7420 2f20  ars the float / 
+00009e70: 696e 6c69 6e69 6e67 0a2a 2069 6e20 7468  inlining.* in th
+00009e80: 6520 6361 7365 206f 6620 5245 4144 4d45  e case of README
+00009e90: 2e6d 6420 6265 696e 6720 6469 7370 6c61  .md being displa
+00009ea0: 7965 6420 6265 6c6f 7720 6120 6669 6c65  yed below a file
+00009eb0: 206c 6973 7469 6e67 2c20 7468 756d 626e   listing, thumbn
+00009ec0: 6169 6c73 2077 696c 6c20 6f70 656e 2069  ails will open i
+00009ed0: 6e20 7468 6520 6761 6c6c 6572 7920 7669  n the gallery vi
+00009ee0: 6577 6572 0a0a 6f74 6865 7220 6e6f 7465  ewer..other note
+00009ef0: 732c 0a2a 2074 6865 2064 6f63 756d 656e  s,.* the documen
+00009f00: 7420 7072 6576 6965 7720 6861 7320 6120  t preview has a 
+00009f10: 6d61 782d 7769 6474 6820 7768 6963 6820  max-width which 
+00009f20: 6973 2074 6865 2073 616d 6520 6173 2061  is the same as a
+00009f30: 6e20 4134 2070 6170 6572 2077 6865 6e20  n A4 paper when 
+00009f40: 7072 696e 7465 640a 0a0a 2323 206f 7468  printed...## oth
+00009f50: 6572 2074 7269 636b 730a 0a2a 2079 6f75  er tricks..* you
+00009f60: 2063 616e 206c 696e 6b20 6120 7061 7274   can link a part
+00009f70: 6963 756c 6172 2074 696d 6573 7461 6d70  icular timestamp
+00009f80: 2069 6e20 616e 2061 7564 696f 2066 696c   in an audio fil
+00009f90: 6520 6279 2061 6464 696e 6720 6974 2074  e by adding it t
+00009fa0: 6f20 7468 6520 5552 4c2c 2073 7563 6820  o the URL, such 
+00009fb0: 6173 2060 2632 3060 202f 2060 2632 3073  as `&20` / `&20s
+00009fc0: 6020 2f20 6026 316d 3230 6020 2f20 6026  ` / `&1m20` / `&
+00009fd0: 743d 313a 3230 6020 6166 7465 7220 7468  t=1:20` after th
+00009fe0: 6520 602e 2e2e 2f23 6166 2d63 3839 3630  e `.../#af-c8960
+00009ff0: 6461 6260 0a0a 2a20 656e 6162 6c69 6e67  dab`..* enabling
+0000a000: 2074 6865 2061 7564 696f 2065 7175 616c   the audio equal
+0000a010: 697a 6572 2063 616e 2068 656c 7020 6d61  izer can help ma
+0000a020: 6b65 2067 6170 6c65 7373 2061 6c62 756d  ke gapless album
+0000a030: 7320 6675 6c6c 7920 6761 706c 6573 7320  s fully gapless 
+0000a040: 696e 2073 6f6d 6520 6272 6f77 7365 7273  in some browsers
+0000a050: 2028 6368 726f 6d65 292c 2073 6f20 636f   (chrome), so co
+0000a060: 6e73 6964 6572 206c 6561 7669 6e67 2069  nsider leaving i
+0000a070: 7420 6f6e 2077 6974 6820 616c 6c20 7468  t on with all th
+0000a080: 6520 7661 6c75 6573 2061 7420 7a65 726f  e values at zero
+0000a090: 0a0a 2a20 6765 7420 6120 706c 6169 6e74  ..* get a plaint
+0000a0a0: 6578 7420 6669 6c65 206c 6973 7469 6e67  ext file listing
+0000a0b0: 2062 7920 6164 6469 6e67 2060 3f6c 733d   by adding `?ls=
+0000a0c0: 7460 2074 6f20 6120 5552 4c2c 206f 7220  t` to a URL, or 
+0000a0d0: 6120 636f 6d70 6163 7420 636f 6c6f 7265  a compact colore
+0000a0e0: 6420 6f6e 6520 7769 7468 2060 3f6c 733d  d one with `?ls=
+0000a0f0: 7660 2028 666f 7220 756e 6978 2074 6572  v` (for unix ter
+0000a100: 6d69 6e61 6c73 290a 0a2a 2069 6620 796f  minals)..* if yo
+0000a110: 7520 6172 6520 7573 696e 6720 6d65 6469  u are using medi
+0000a120: 6120 686f 746b 6579 7320 746f 2073 7769  a hotkeys to swi
+0000a130: 7463 6820 736f 6e67 7320 616e 6420 6172  tch songs and ar
+0000a140: 6520 6765 7474 696e 6720 7469 7265 6420  e getting tired 
+0000a150: 6f66 2073 6565 696e 6720 7468 6520 4f53  of seeing the OS
+0000a160: 4420 706f 7075 7020 7768 6963 6820 5769  D popup which Wi
+0000a170: 6e64 6f77 7320 646f 6573 6e27 7420 6c65  ndows doesn't le
+0000a180: 7420 796f 7520 6469 7361 626c 652c 2063  t you disable, c
+0000a190: 6f6e 7369 6465 7220 5b2e 2f63 6f6e 7472  onsider [./contr
+0000a1a0: 6962 2f6d 6564 6961 2d6f 7364 2d62 676f  ib/media-osd-bgo
+0000a1b0: 6e65 2e70 7331 5d28 636f 6e74 7269 622f  ne.ps1](contrib/
+0000a1c0: 236d 6564 6961 2d6f 7364 2d62 676f 6e65  #media-osd-bgone
+0000a1d0: 7073 3129 0a0a 2a20 636c 6963 6b20 7468  ps1)..* click th
+0000a1e0: 6520 626f 7474 6f6d 2d6c 6566 7420 60cf  e bottom-left `.
+0000a1f0: 8060 2074 6f20 6f70 656e 2061 206a 6176  .` to open a jav
+0000a200: 6173 6372 6970 7420 7072 6f6d 7074 2066  ascript prompt f
+0000a210: 6f72 2064 6562 7567 6769 6e67 0a0a 2a20  or debugging..* 
+0000a220: 6669 6c65 7320 6e61 6d65 6420 602e 7072  files named `.pr
+0000a230: 6f6c 6f67 7565 2e68 746d 6c60 202f 2060  ologue.html` / `
+0000a240: 2e65 7069 6c6f 6775 652e 6874 6d6c 6020  .epilogue.html` 
+0000a250: 7769 6c6c 2062 6520 7265 6e64 6572 6564  will be rendered
+0000a260: 2062 6566 6f72 652f 6166 7465 7220 6469   before/after di
+0000a270: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
+0000a280: 2075 6e6c 6573 7320 602d 2d6e 6f2d 6c6f   unless `--no-lo
+0000a290: 6775 6573 600a 0a2a 2066 696c 6573 206e  gues`..* files n
+0000a2a0: 616d 6564 2060 5245 4144 4d45 2e6d 6460  amed `README.md`
+0000a2b0: 202f 2060 7265 6164 6d65 2e6d 6460 2077   / `readme.md` w
+0000a2c0: 696c 6c20 6265 2072 656e 6465 7265 6420  ill be rendered 
+0000a2d0: 6166 7465 7220 6469 7265 6374 6f72 7920  after directory 
+0000a2e0: 6c69 7374 696e 6773 2075 6e6c 6573 7320  listings unless 
+0000a2f0: 602d 2d6e 6f2d 7265 6164 6d65 6020 2862  `--no-readme` (b
+0000a300: 7574 2060 2e65 7069 6c6f 6775 652e 6874  ut `.epilogue.ht
+0000a310: 6d6c 6020 7461 6b65 7320 7072 6563 6564  ml` takes preced
+0000a320: 656e 6365 290a 0a0a 2323 2073 6561 7263  ence)...## searc
+0000a330: 6869 6e67 0a0a 7365 6172 6368 2062 7920  hing..search by 
+0000a340: 7369 7a65 2c20 6461 7465 2c20 7061 7468  size, date, path
+0000a350: 2f6e 616d 652c 206d 7033 2d74 6167 732c  /name, mp3-tags,
+0000a360: 202e 2e2e 0a0a 215b 636f 7079 7061 7274   .....![copypart
+0000a370: 792d 7365 6172 6368 2d66 7338 5d28 6874  y-search-fs8](ht
+0000a380: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+0000a390: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+0000a3a0: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+0000a3b0: 3239 3633 3533 3635 2d63 3066 6632 6139  29635365-c0ff2a9
+0000a3c0: 662d 3065 6535 2d34 6663 332d 3862 6236  f-0ee5-4fc3-8bb6
+0000a3d0: 2d30 3036 3033 3363 6636 3762 382e 706e  -006033cf67b8.pn
+0000a3e0: 6729 0a0a 7768 656e 2073 7461 7274 6564  g)..when started
+0000a3f0: 2077 6974 6820 602d 6532 6473 6160 2063   with `-e2dsa` c
+0000a400: 6f70 7970 6172 7479 2077 696c 6c20 7363  opyparty will sc
+0000a410: 616e 2f69 6e64 6578 2061 6c6c 2079 6f75  an/index all you
+0000a420: 7220 6669 6c65 732e 2054 6869 7320 6176  r files. This av
+0000a430: 6f69 6473 2064 7570 6c69 6361 7465 7320  oids duplicates 
+0000a440: 6f6e 2075 706c 6f61 642c 2061 6e64 2061  on upload, and a
+0000a450: 6c73 6f20 6d61 6b65 7320 7468 6520 766f  lso makes the vo
+0000a460: 6c75 6d65 7320 7365 6172 6368 6162 6c65  lumes searchable
+0000a470: 2074 6872 6f75 6768 2074 6865 2077 6562   through the web
+0000a480: 2d75 693a 0a2a 206d 616b 6520 7365 6172  -ui:.* make sear
+0000a490: 6368 2071 7565 7269 6573 2062 7920 6073  ch queries by `s
+0000a4a0: 697a 6560 2f60 6461 7465 602f 6064 6972  ize`/`date`/`dir
+0000a4b0: 6563 746f 7279 2d70 6174 6860 2f60 6669  ectory-path`/`fi
+0000a4c0: 6c65 6e61 6d65 602c 206f 722e 2e2e 0a2a  lename`, or....*
+0000a4d0: 2064 7261 672f 6472 6f70 2061 206c 6f63   drag/drop a loc
+0000a4e0: 616c 2066 696c 6520 746f 2073 6565 2069  al file to see i
+0000a4f0: 6620 7468 6520 7361 6d65 2063 6f6e 7465  f the same conte
+0000a500: 6e74 7320 6578 6973 7420 736f 6d65 7768  nts exist somewh
+0000a510: 6572 6520 6f6e 2074 6865 2073 6572 7665  ere on the serve
+0000a520: 722c 2073 6565 205b 6669 6c65 2d73 6561  r, see [file-sea
+0000a530: 7263 685d 2823 6669 6c65 2d73 6561 7263  rch](#file-searc
+0000a540: 6829 0a0a 7061 7468 2f6e 616d 6520 7175  h)..path/name qu
+0000a550: 6572 6965 7320 6172 6520 7370 6163 652d  eries are space-
+0000a560: 7365 7061 7261 7465 642c 2041 4e44 2765  separated, AND'e
+0000a570: 6420 746f 6765 7468 6572 2c20 616e 6420  d together, and 
+0000a580: 776f 7264 7320 6172 6520 6e65 6761 7465  words are negate
+0000a590: 6420 7769 7468 2061 2060 2d60 2070 7265  d with a `-` pre
+0000a5a0: 6669 782c 2073 6f20 666f 7220 6578 616d  fix, so for exam
+0000a5b0: 706c 653a 0a2a 2070 6174 683a 2060 7368  ple:.* path: `sh
+0000a5c0: 6962 6179 616e 202d 626f 7373 6160 2066  ibayan -bossa` f
+0000a5d0: 696e 6473 2061 6c6c 2066 696c 6573 2077  inds all files w
+0000a5e0: 6865 7265 206f 6e65 206f 6620 7468 6520  here one of the 
+0000a5f0: 666f 6c64 6572 7320 636f 6e74 6169 6e20  folders contain 
+0000a600: 6073 6869 6261 7961 6e60 2062 7574 2066  `shibayan` but f
+0000a610: 696c 7465 7273 206f 7574 2061 6e79 2072  ilters out any r
+0000a620: 6573 756c 7473 2077 6865 7265 2060 626f  esults where `bo
+0000a630: 7373 6160 2065 7869 7374 7320 736f 6d65  ssa` exists some
+0000a640: 7768 6572 6520 696e 2074 6865 2070 6174  where in the pat
+0000a650: 680a 2a20 6e61 6d65 3a20 6064 656d 6574  h.* name: `demet
+0000a660: 6f72 6920 7374 7978 6020 6769 7665 7320  ori styx` gives 
+0000a670: 796f 7520 5b67 6f6f 6420 7374 7566 665d  you [good stuff]
+0000a680: 2868 7474 7073 3a2f 2f77 7777 2e79 6f75  (https://www.you
+0000a690: 7475 6265 2e63 6f6d 2f77 6174 6368 3f76  tube.com/watch?v
+0000a6a0: 3d7a 4768 3067 3134 5a4a 3849 266c 6973  =zGh0g14ZJ8I&lis
+0000a6b0: 743d 504c 3341 3134 3742 4431 3531 4545  t=PL3A147BD151EE
+0000a6c0: 3532 3138 2669 6e64 6578 3d39 290a 0a74  5218&index=9)..t
+0000a6d0: 6865 2060 7261 7760 2066 6965 6c64 2061  he `raw` field a
+0000a6e0: 6c6c 6f77 7320 666f 7220 6d6f 7265 2063  llows for more c
+0000a6f0: 6f6d 706c 6578 2073 7475 6666 2073 7563  omplex stuff suc
+0000a700: 6820 6173 2060 2820 7461 6773 206c 696b  h as `( tags lik
+0000a710: 6520 2a6e 6861 746f 2a20 6f72 2074 6167  e *nhato* or tag
+0000a720: 7320 6c69 6b65 202a 7461 6973 6869 2a20  s like *taishi* 
+0000a730: 2920 616e 6420 2820 6e6f 7420 7461 6773  ) and ( not tags
+0000a740: 206c 696b 6520 2a6e 6861 746f 2a20 6f72   like *nhato* or
+0000a750: 206e 6f74 2074 6167 7320 6c69 6b65 202a   not tags like *
+0000a760: 7461 6973 6869 2a20 2960 2077 6869 6368  taishi* )` which
+0000a770: 2066 696e 6473 2061 6c6c 2073 6f6e 6773   finds all songs
+0000a780: 2062 7920 6569 7468 6572 206e 6861 746f   by either nhato
+0000a790: 206f 7220 7461 6973 6869 2c20 6578 636c   or taishi, excl
+0000a7a0: 7564 696e 6720 636f 6c6c 6162 7320 2874  uding collabs (t
+0000a7b0: 6572 7269 626c 6520 6578 616d 706c 652c  errible example,
+0000a7c0: 2077 6879 2077 6f75 6c64 2079 6f75 2064   why would you d
+0000a7d0: 6f20 7468 6174 290a 0a66 6f72 2074 6865  o that)..for the
+0000a7e0: 2061 626f 7665 2065 7861 6d70 6c65 2074   above example t
+0000a7f0: 6f20 776f 726b 2c20 6164 6420 7468 6520  o work, add the 
+0000a800: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
+0000a810: 6d65 6e74 2060 2d65 3274 7360 2074 6f20  ment `-e2ts` to 
+0000a820: 616c 736f 2073 6361 6e2f 696e 6465 7820  also scan/index 
+0000a830: 7461 6773 2066 726f 6d20 6d75 7369 6320  tags from music 
+0000a840: 6669 6c65 732c 2077 6869 6368 2062 7269  files, which bri
+0000a850: 6e67 7320 7573 206f 7665 7220 746f 3a0a  ngs us over to:.
+0000a860: 0a0a 2320 7365 7276 6572 2063 6f6e 6669  ..# server confi
+0000a870: 670a 0a75 7369 6e67 2061 7267 756d 656e  g..using argumen
+0000a880: 7473 206f 7220 636f 6e66 6967 2066 696c  ts or config fil
+0000a890: 6573 2c20 6f72 2061 206d 6978 206f 6620  es, or a mix of 
+0000a8a0: 626f 7468 3a0a 2a20 636f 6e66 6967 2066  both:.* config f
+0000a8b0: 696c 6573 2028 602d 6320 736f 6d65 2e63  iles (`-c some.c
+0000a8c0: 6f6e 6660 2920 6361 6e20 7365 7420 6164  onf`) can set ad
+0000a8d0: 6469 7469 6f6e 616c 2063 6f6d 6d61 6e64  ditional command
+0000a8e0: 6c69 6e65 2061 7267 756d 656e 7473 3b20  line arguments; 
+0000a8f0: 7365 6520 5b2e 2f64 6f63 732f 6578 616d  see [./docs/exam
+0000a900: 706c 652e 636f 6e66 5d28 646f 6373 2f65  ple.conf](docs/e
+0000a910: 7861 6d70 6c65 2e63 6f6e 6629 2061 6e64  xample.conf) and
+0000a920: 205b 2e2f 646f 6373 2f65 7861 6d70 6c65   [./docs/example
+0000a930: 322e 636f 6e66 5d28 646f 6373 2f65 7861  2.conf](docs/exa
+0000a940: 6d70 6c65 322e 636f 6e66 290a 2a20 606b  mple2.conf).* `k
+0000a950: 696c 6c20 2d73 2055 5352 3160 2028 7361  ill -s USR1` (sa
+0000a960: 6d65 2061 7320 6073 7973 7465 6d63 746c  me as `systemctl
+0000a970: 2072 656c 6f61 6420 636f 7079 7061 7274   reload copypart
+0000a980: 7960 2920 746f 2072 656c 6f61 6420 6163  y`) to reload ac
+0000a990: 636f 756e 7473 2061 6e64 2076 6f6c 756d  counts and volum
+0000a9a0: 6573 2066 726f 6d20 636f 6e66 6967 2066  es from config f
+0000a9b0: 696c 6573 2077 6974 686f 7574 2072 6573  iles without res
+0000a9c0: 7461 7274 696e 670a 2020 2a20 6f72 2063  tarting.  * or c
+0000a9d0: 6c69 636b 2074 6865 2060 5b72 656c 6f61  lick the `[reloa
+0000a9e0: 6420 6366 675d 6020 6275 7474 6f6e 2069  d cfg]` button i
+0000a9f0: 6e20 7468 6520 636f 6e74 726f 6c2d 7061  n the control-pa
+0000aa00: 6e65 6c20 7768 656e 206c 6f67 6765 6420  nel when logged 
+0000aa10: 696e 2061 7320 6164 6d69 6e20 0a20 202a  in as admin .  *
+0000aa20: 2063 6861 6e67 6573 2074 6f20 7468 6520   changes to the 
+0000aa30: 605b 676c 6f62 616c 5d60 2063 6f6e 6669  `[global]` confi
+0000aa40: 6720 7365 6374 696f 6e20 7265 7175 6972  g section requir
+0000aa50: 6573 2061 2072 6573 7461 7274 2074 6f20  es a restart to 
+0000aa60: 7461 6b65 2065 6666 6563 740a 0a0a 2323  take effect...##
+0000aa70: 207a 6572 6f63 6f6e 660a 0a61 6e6e 6f75   zeroconf..annou
+0000aa80: 6e63 6520 656e 6162 6c65 6420 7365 7276  nce enabled serv
+0000aa90: 6963 6573 206f 6e20 7468 6520 4c41 4e20  ices on the LAN 
+0000aaa0: 285b 7069 635d 2868 7474 7073 3a2f 2f75  ([pic](https://u
+0000aab0: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
+0000aac0: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
+0000aad0: 2f32 3431 3033 322f 3231 3533 3434 3733  /241032/21534473
+0000aae0: 372d 3065 6165 3864 3938 2d39 3439 362d  7-0eae8d98-9496-
+0000aaf0: 3432 3536 2d39 6161 382d 6364 3266 3639  4256-9aa8-cd2f69
+0000ab00: 3731 3831 3064 2e70 6e67 2929 2020 2d2d  71810d.png))  --
+0000ab10: 2060 2d7a 6020 656e 6162 6c65 7320 626f   `-z` enables bo
+0000ab20: 7468 205b 6d64 6e73 5d28 236d 646e 7329  th [mdns](#mdns)
+0000ab30: 2061 6e64 205b 7373 6470 5d28 2373 7364   and [ssdp](#ssd
+0000ab40: 7029 0a0a 2a20 602d 2d7a 2d6f 6e60 202f  p)..* `--z-on` /
+0000ab50: 2060 2d2d 7a2d 6f66 6660 2720 6c69 6d69   `--z-off`' limi
+0000ab60: 7473 2074 6865 2066 6561 7475 7265 2074  ts the feature t
+0000ab70: 6f20 6365 7274 6169 6e20 6e65 7477 6f72  o certain networ
+0000ab80: 6b73 0a0a 0a23 2323 206d 646e 730a 0a4c  ks...### mdns..L
+0000ab90: 414e 2064 6f6d 6169 6e2d 6e61 6d65 2061  AN domain-name a
+0000aba0: 6e64 2066 6561 7475 7265 2061 6e6e 6f75  nd feature annou
+0000abb0: 6e63 6572 0a0a 7573 6573 205b 6d75 6c74  ncer..uses [mult
+0000abc0: 6963 6173 7420 646e 735d 2868 7474 7073  icast dns](https
+0000abd0: 3a2f 2f65 6e2e 7769 6b69 7065 6469 612e  ://en.wikipedia.
+0000abe0: 6f72 672f 7769 6b69 2f4d 756c 7469 6361  org/wiki/Multica
+0000abf0: 7374 5f44 4e53 2920 746f 2067 6976 6520  st_DNS) to give 
+0000ac00: 636f 7079 7061 7274 7920 6120 646f 6d61  copyparty a doma
+0000ac10: 696e 2077 6869 6368 2061 6e79 206d 6163  in which any mac
+0000ac20: 6869 6e65 206f 6e20 7468 6520 4c41 4e20  hine on the LAN 
+0000ac30: 6361 6e20 7573 6520 746f 2061 6363 6573  can use to acces
+0000ac40: 7320 6974 0a0a 616c 6c20 656e 6162 6c65  s it..all enable
+0000ac50: 6420 7365 7276 6963 6573 2028 5b77 6562  d services ([web
+0000ac60: 6461 765d 2823 7765 6264 6176 2d73 6572  dav](#webdav-ser
+0000ac70: 7665 7229 2c20 5b66 7470 5d28 2366 7470  ver), [ftp](#ftp
+0000ac80: 2d73 6572 7665 7229 2c20 5b73 6d62 5d28  -server), [smb](
+0000ac90: 2373 6d62 2d73 6572 7665 7229 2920 7769  #smb-server)) wi
+0000aca0: 6c6c 2061 7070 6561 7220 696e 206d 444e  ll appear in mDN
+0000acb0: 532d 6177 6172 6520 6669 6c65 206d 616e  S-aware file man
+0000acc0: 6167 6572 7320 284b 4445 2c20 676e 6f6d  agers (KDE, gnom
+0000acd0: 652c 206d 6163 4f53 2c20 2e2e 2e29 0a0a  e, macOS, ...)..
+0000ace0: 7468 6520 646f 6d61 696e 2077 696c 6c20  the domain will 
+0000acf0: 6265 2068 7474 703a 2f2f 7061 7274 7962  be http://partyb
+0000ad00: 6f78 2e6c 6f63 616c 2069 6620 7468 6520  ox.local if the 
+0000ad10: 6d61 6368 696e 6527 7320 686f 7374 6e61  machine's hostna
+0000ad20: 6d65 2069 7320 6070 6172 7479 626f 7860  me is `partybox`
+0000ad30: 2075 6e6c 6573 7320 602d 2d6e 616d 6560   unless `--name`
+0000ad40: 2073 7065 6369 6669 6573 2073 6f65 6d74   specifies soemt
+0000ad50: 6869 6e67 2065 6c73 650a 0a0a 2323 2320  hing else...### 
+0000ad60: 7373 6470 0a0a 7769 6e64 6f77 732d 6578  ssdp..windows-ex
+0000ad70: 706c 6f72 6572 2061 6e6e 6f75 6e63 6572  plorer announcer
+0000ad80: 0a0a 7573 6573 205b 7373 6470 5d28 6874  ..uses [ssdp](ht
+0000ad90: 7470 733a 2f2f 656e 2e77 696b 6970 6564  tps://en.wikiped
+0000ada0: 6961 2e6f 7267 2f77 696b 692f 5369 6d70  ia.org/wiki/Simp
+0000adb0: 6c65 5f53 6572 7669 6365 5f44 6973 636f  le_Service_Disco
+0000adc0: 7665 7279 5f50 726f 746f 636f 6c29 2074  very_Protocol) t
+0000add0: 6f20 6d61 6b65 2063 6f70 7970 6172 7479  o make copyparty
+0000ade0: 2061 7070 6561 7220 696e 2074 6865 2077   appear in the w
+0000adf0: 696e 646f 7773 2066 696c 6520 6578 706c  indows file expl
+0000ae00: 6f72 6572 206f 6e20 616c 6c20 6d61 6368  orer on all mach
+0000ae10: 696e 6573 206f 6e20 7468 6520 4c41 4e0a  ines on the LAN.
+0000ae20: 0a64 6f75 626c 6563 6c69 636b 696e 6720  .doubleclicking 
+0000ae30: 7468 6520 6963 6f6e 206f 7065 6e73 2074  the icon opens t
+0000ae40: 6865 2022 636f 6e6e 6563 7422 2070 6167  he "connect" pag
+0000ae50: 6520 7768 6963 6820 6578 706c 6169 6e73  e which explains
+0000ae60: 2068 6f77 2074 6f20 6d6f 756e 7420 636f   how to mount co
+0000ae70: 7079 7061 7274 7920 6173 2061 206c 6f63  pyparty as a loc
+0000ae80: 616c 2066 696c 6573 7973 7465 6d0a 0a69  al filesystem..i
+0000ae90: 6620 636f 7079 7061 7274 7920 646f 6573  f copyparty does
+0000aea0: 206e 6f74 2061 7070 6561 7220 696e 2077   not appear in w
+0000aeb0: 696e 646f 7773 2065 7870 6c6f 7265 722c  indows explorer,
+0000aec0: 2075 7365 2060 2d2d 7a73 7660 2074 6f20   use `--zsv` to 
+0000aed0: 7365 6520 7768 793a 0a0a 2a20 6d61 7962  see why:..* mayb
+0000aee0: 6520 7468 6520 6469 7363 6f76 6572 7920  e the discovery 
+0000aef0: 6d75 6c74 6963 6173 7420 7761 7320 7365  multicast was se
+0000af00: 6e74 2066 726f 6d20 616e 2049 5020 7768  nt from an IP wh
+0000af10: 6963 6820 646f 6573 206e 6f74 2069 6e74  ich does not int
+0000af20: 6572 7365 6374 2077 6974 6820 7468 6520  ersect with the 
+0000af30: 7365 7276 6572 2073 7562 6e65 7473 0a0a  server subnets..
+0000af40: 0a23 2320 7172 2d63 6f64 650a 0a70 7269  .## qr-code..pri
+0000af50: 6e74 2061 2071 722d 636f 6465 205b 2873  nt a qr-code [(s
+0000af60: 6372 6565 6e73 686f 7429 5d28 6874 7470  creenshot)](http
+0000af70: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+0000af80: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+0000af90: 742e 636f 6d2f 3234 3130 3332 2f31 3934  t.com/241032/194
+0000afa0: 3732 3835 3333 2d36 6630 3038 3439 622d  728533-6f00849b-
+0000afb0: 6336 6163 2d34 3363 362d 3933 3539 2d38  c6ac-43c6-9359-8
+0000afc0: 3365 3435 3464 3131 6530 302e 706e 6729  3e454d11e00.png)
+0000afd0: 2066 6f72 2071 7569 636b 2061 6363 6573   for quick acces
+0000afe0: 732c 2020 6772 6561 7420 6265 7477 6565  s,  great betwee
+0000aff0: 6e20 7068 6f6e 6573 206f 6e20 616e 6472  n phones on andr
+0000b000: 6f69 6420 686f 7473 706f 7473 2077 6869  oid hotspots whi
+0000b010: 6368 206b 6565 7020 6368 616e 6769 6e67  ch keep changing
+0000b020: 2074 6865 2073 7562 6e65 740a 0a2a 2060   the subnet..* `
+0000b030: 2d2d 7172 6020 656e 6162 6c65 7320 6974  --qr` enables it
+0000b040: 0a2a 2060 2d2d 7172 7360 2064 6f65 7320  .* `--qrs` does 
+0000b050: 6874 7470 7320 696e 7374 6561 6420 6f66  https instead of
+0000b060: 2068 7474 700a 2a20 602d 2d71 726c 206c   http.* `--qrl l
+0000b070: 6f6f 7462 6f78 2f3f 7077 3d68 756e 7465  ootbox/?pw=hunte
+0000b080: 7232 6020 6170 7065 6e64 7320 746f 2074  r2` appends to t
+0000b090: 6865 2075 726c 2c20 6c69 6e6b 696e 6720  he url, linking 
+0000b0a0: 746f 2074 6865 2060 6c6f 6f74 626f 7860  to the `lootbox`
+0000b0b0: 2066 6f6c 6465 7220 7769 7468 2070 6173   folder with pas
+0000b0c0: 7377 6f72 6420 6068 756e 7465 7232 600a  sword `hunter2`.
+0000b0d0: 2a20 602d 2d71 727a 2031 6020 666f 7263  * `--qrz 1` forc
+0000b0e0: 6573 2031 7820 7a6f 6f6d 2069 6e73 7465  es 1x zoom inste
+0000b0f0: 6164 206f 6620 6175 746f 7363 616c 696e  ad of autoscalin
+0000b100: 6720 746f 2066 6974 2074 6865 2074 6572  g to fit the ter
+0000b110: 6d69 6e61 6c20 7369 7a65 0a20 202a 2031  minal size.  * 1
+0000b120: 7820 6d61 7920 7265 6e64 6572 2069 6e63  x may render inc
+0000b130: 6f72 7265 6374 6c79 206f 6e20 736f 6d65  orrectly on some
+0000b140: 2074 6572 6d69 6e61 6c73 2f66 6f6e 7473   terminals/fonts
+0000b150: 2c20 6275 7420 3278 2073 686f 756c 6420  , but 2x should 
+0000b160: 616c 7761 7973 2077 6f72 6b0a 0a69 7420  always work..it 
+0000b170: 7573 6573 2074 6865 2073 6572 7665 7220  uses the server 
+0000b180: 686f 7374 6e61 6d65 2069 6620 5b6d 646e  hostname if [mdn
+0000b190: 735d 2823 6d64 6e73 2920 6973 2065 6e62  s](#mdns) is enb
+0000b1a0: 6c65 642c 206f 7468 6572 7769 7365 2069  led, otherwise i
+0000b1b0: 7427 6c6c 2075 7365 2079 6f75 7220 6578  t'll use your ex
+0000b1c0: 7465 726e 616c 2069 7020 2864 6566 6175  ternal ip (defau
+0000b1d0: 6c74 2072 6f75 7465 2920 756e 6c65 7373  lt route) unless
+0000b1e0: 2060 2d2d 7172 6960 2073 7065 6369 6669   `--qri` specifi
+0000b1f0: 6573 2061 2073 7065 6369 6669 6320 6970  es a specific ip
+0000b200: 2d70 7265 6669 7820 6f72 2064 6f6d 6169  -prefix or domai
+0000b210: 6e0a 0a0a 2323 2066 7470 2073 6572 7665  n...## ftp serve
+0000b220: 720a 0a61 6e20 4654 5020 7365 7276 6572  r..an FTP server
+0000b230: 2063 616e 2062 6520 7374 6172 7465 6420   can be started 
+0000b240: 7573 696e 6720 602d 2d66 7470 2033 3932  using `--ftp 392
+0000b250: 3160 2c20 2061 6e64 2f6f 7220 602d 2d66  1`,  and/or `--f
+0000b260: 7470 7360 2066 6f72 2065 7870 6c69 6369  tps` for explici
+0000b270: 7420 544c 5320 2866 7470 6573 290a 0a2a  t TLS (ftpes)..*
+0000b280: 2062 6173 6564 206f 6e20 5b70 7966 7470   based on [pyftp
+0000b290: 646c 6962 5d28 6874 7470 733a 2f2f 6769  dlib](https://gi
+0000b2a0: 7468 7562 2e63 6f6d 2f67 6961 6d70 616f  thub.com/giampao
+0000b2b0: 6c6f 2f70 7966 7470 646c 6962 290a 2a20  lo/pyftpdlib).* 
+0000b2c0: 6e65 6564 7320 6120 6465 6469 6361 7465  needs a dedicate
+0000b2d0: 6420 706f 7274 2028 6361 6e6e 6f74 2073  d port (cannot s
+0000b2e0: 6861 7265 2077 6974 6820 7468 6520 4854  hare with the HT
+0000b2f0: 5450 2f48 5454 5053 2041 5049 290a 2a20  TP/HTTPS API).* 
+0000b300: 7570 6c6f 6164 7320 6172 6520 6e6f 7420  uploads are not 
+0000b310: 7265 7375 6d61 626c 6520 2d2d 2064 656c  resumable -- del
+0000b320: 6574 6520 616e 6420 7265 7374 6172 7420  ete and restart 
+0000b330: 6966 206e 6563 6573 7361 7279 0a2a 2072  if necessary.* r
+0000b340: 756e 7320 696e 2061 6374 6976 6520 6d6f  uns in active mo
+0000b350: 6465 2062 7920 6465 6661 756c 742c 2079  de by default, y
+0000b360: 6f75 2070 726f 6261 626c 7920 7761 6e74  ou probably want
+0000b370: 2060 2d2d 6674 702d 7072 2031 3230 3030   `--ftp-pr 12000
+0000b380: 2d31 3330 3030 600a 2020 2a20 6966 2079  -13000`.  * if y
+0000b390: 6f75 2065 6e61 626c 6520 626f 7468 2060  ou enable both `
+0000b3a0: 6674 7060 2061 6e64 2060 6674 7073 602c  ftp` and `ftps`,
+0000b3b0: 2074 6865 2070 6f72 742d 7261 6e67 6520   the port-range 
+0000b3c0: 7769 6c6c 2062 6520 6469 7669 6465 6420  will be divided 
+0000b3d0: 696e 2068 616c 660a 2020 2a20 736f 6d65  in half.  * some
+0000b3e0: 206f 6c64 6572 2073 6f66 7477 6172 6520   older software 
+0000b3f0: 2866 696c 657a 696c 6c61 206f 6e20 6465  (filezilla on de
+0000b400: 6269 616e 2d73 7461 626c 6529 2063 616e  bian-stable) can
+0000b410: 6e6f 7420 7061 7373 6976 652d 6d6f 6465  not passive-mode
+0000b420: 2077 6974 6820 544c 530a 2a20 6c6f 6769   with TLS.* logi
+0000b430: 6e20 7769 7468 2061 6e79 2075 7365 726e  n with any usern
+0000b440: 616d 6520 2b20 796f 7572 2070 6173 7377  ame + your passw
+0000b450: 6f72 642c 206f 7220 7075 7420 796f 7572  ord, or put your
+0000b460: 2070 6173 7377 6f72 6420 696e 2074 6865   password in the
+0000b470: 2075 7365 726e 616d 6520 6669 656c 640a   username field.
+0000b480: 0a73 6f6d 6520 7265 636f 6d6d 656e 6465  .some recommende
+0000b490: 6420 4654 5020 2f20 4654 5053 2063 6c69  d FTP / FTPS cli
+0000b4a0: 656e 7473 3b20 6077 6172 6b60 203d 2065  ents; `wark` = e
+0000b4b0: 7861 6d70 6c65 2070 6173 7377 6f72 643a  xample password:
+0000b4c0: 0a2a 2068 7474 7073 3a2f 2f77 696e 7363  .* https://winsc
+0000b4d0: 702e 6e65 742f 656e 672f 646f 776e 6c6f  p.net/eng/downlo
+0000b4e0: 6164 2e70 6870 0a2a 2068 7474 7073 3a2f  ad.php.* https:/
+0000b4f0: 2f66 696c 657a 696c 6c61 2d70 726f 6a65  /filezilla-proje
+0000b500: 6374 2e6f 7267 2f20 7374 7275 6767 6c65  ct.org/ struggle
+0000b510: 7320 6120 6269 7420 7769 7468 2066 7470  s a bit with ftp
+0000b520: 7320 696e 2061 6374 6976 652d 6d6f 6465  s in active-mode
+0000b530: 2c20 6275 7420 6973 2066 696e 6520 6f74  , but is fine ot
+0000b540: 6865 7277 6973 650a 2a20 6874 7470 733a  herwise.* https:
+0000b550: 2f2f 7263 6c6f 6e65 2e6f 7267 2f20 646f  //rclone.org/ do
+0000b560: 6573 2046 5450 5320 7769 7468 2060 746c  es FTPS with `tl
+0000b570: 733d 6661 6c73 6520 6578 706c 6963 6974  s=false explicit
+0000b580: 5f74 6c73 3d74 7275 6560 0a2a 2060 6c66  _tls=true`.* `lf
+0000b590: 7470 202d 7520 6b2c 7761 726b 202d 7020  tp -u k,wark -p 
+0000b5a0: 3339 3231 2031 3237 2e30 2e30 2e31 202d  3921 127.0.0.1 -
+0000b5b0: 6520 6c73 600a 2a20 606c 6674 7020 2d75  e ls`.* `lftp -u
+0000b5c0: 206b 2c77 6172 6b20 2d70 2033 3939 3020   k,wark -p 3990 
+0000b5d0: 3132 372e 302e 302e 3120 2d65 2027 7365  127.0.0.1 -e 'se
+0000b5e0: 7420 7373 6c3a 7665 7269 6679 2d63 6572  t ssl:verify-cer
+0000b5f0: 7469 6669 6361 7465 206e 6f3b 206c 7327  tificate no; ls'
+0000b600: 600a 0a0a 2323 2077 6562 6461 7620 7365  `...## webdav se
+0000b610: 7276 6572 0a0a 7769 7468 2072 6561 642d  rver..with read-
+0000b620: 7772 6974 6520 7375 7070 6f72 742c 2020  write support,  
+0000b630: 7375 7070 6f72 7473 2077 696e 5850 2061  supports winXP a
+0000b640: 6e64 206c 6174 6572 2c20 6d61 636f 732c  nd later, macos,
+0000b650: 206e 6175 7469 6c75 732f 6776 6673 0a0a   nautilus/gvfs..
+0000b660: 636c 6963 6b20 7468 6520 5b63 6f6e 6e65  click the [conne
+0000b670: 6374 5d28 6874 7470 3a2f 2f31 3237 2e30  ct](http://127.0
+0000b680: 2e30 2e31 3a33 3932 332f 3f68 6329 2062  .0.1:3923/?hc) b
+0000b690: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
+0000b6a0: 7472 6f6c 2d70 616e 656c 2074 6f20 7365  trol-panel to se
+0000b6b0: 6520 636f 6e6e 6563 7469 6f6e 2069 6e73  e connection ins
+0000b6c0: 7472 7563 7469 6f6e 7320 666f 7220 7769  tructions for wi
+0000b6d0: 6e64 6f77 732c 206c 696e 7578 2c20 6d61  ndows, linux, ma
+0000b6e0: 636f 730a 0a67 656e 6572 616c 2075 7361  cos..general usa
+0000b6f0: 6765 3a0a 2a20 6c6f 6769 6e20 7769 7468  ge:.* login with
+0000b700: 2061 6e79 2075 7365 726e 616d 6520 2b20   any username + 
+0000b710: 796f 7572 2070 6173 7377 6f72 642c 206f  your password, o
+0000b720: 7220 7075 7420 796f 7572 2070 6173 7377  r put your passw
+0000b730: 6f72 6420 696e 2074 6865 2075 7365 726e  ord in the usern
+0000b740: 616d 6520 6669 656c 6420 2870 6173 7377  ame field (passw
+0000b750: 6f72 6420 6669 656c 6420 6361 6e20 6265  ord field can be
+0000b760: 2065 6d70 7479 2f77 6861 7465 7665 7229   empty/whatever)
+0000b770: 0a0a 6f6e 206d 6163 6f73 2c20 636f 6e6e  ..on macos, conn
+0000b780: 6563 7420 6672 6f6d 2066 696e 6465 723a  ect from finder:
+0000b790: 0a2a 205b 476f 5d20 2d3e 205b 436f 6e6e  .* [Go] -> [Conn
+0000b7a0: 6563 7420 746f 2053 6572 7665 722e 2e2e  ect to Server...
+0000b7b0: 5d20 2d3e 2068 7474 703a 2f2f 3139 322e  ] -> http://192.
+0000b7c0: 3136 382e 3132 332e 313a 3339 3233 2f0a  168.123.1:3923/.
+0000b7d0: 0a69 6e20 6f72 6465 7220 746f 2067 7261  .in order to gra
+0000b7e0: 6e74 2066 756c 6c20 7772 6974 652d 6163  nt full write-ac
+0000b7f0: 6365 7373 2074 6f20 7765 6264 6176 2063  cess to webdav c
+0000b800: 6c69 656e 7473 2c20 7468 6520 766f 6c66  lients, the volf
+0000b810: 6c61 6720 6064 6177 6020 6d75 7374 2062  lag `daw` must b
+0000b820: 6520 7365 7420 616e 6420 7468 6520 6163  e set and the ac
+0000b830: 636f 756e 7420 6d75 7374 2061 6c73 6f20  count must also 
+0000b840: 6861 7665 2064 656c 6574 652d 6163 6365  have delete-acce
+0000b850: 7373 2028 6f74 6865 7277 6973 6520 7468  ss (otherwise th
+0000b860: 6520 636c 6965 6e74 2077 6f6e 2774 2062  e client won't b
+0000b870: 6520 616c 6c6f 7765 6420 746f 2072 6570  e allowed to rep
+0000b880: 6c61 6365 2074 6865 2063 6f6e 7465 6e74  lace the content
+0000b890: 7320 6f66 2065 7869 7374 696e 6720 6669  s of existing fi
+0000b8a0: 6c65 732c 2077 6869 6368 2069 7320 686f  les, which is ho
+0000b8b0: 7720 7765 6264 6176 2077 6f72 6b73 290a  w webdav works).
+0000b8c0: 0a0a 2323 2320 636f 6e6e 6563 7469 6e67  ..### connecting
+0000b8d0: 2074 6f20 7765 6264 6176 2066 726f 6d20   to webdav from 
+0000b8e0: 7769 6e64 6f77 730a 0a75 7369 6e67 2074  windows..using t
+0000b8f0: 6865 2047 5549 2020 2877 696e 5850 206f  he GUI  (winXP o
+0000b900: 7220 6c61 7465 7229 3a0a 2a20 7269 6768  r later):.* righ
+0000b910: 7463 6c69 636b 205b 6d79 2063 6f6d 7075  tclick [my compu
+0000b920: 7465 725d 202d 3e20 5b6d 6170 206e 6574  ter] -> [map net
+0000b930: 776f 726b 2064 7269 7665 5d20 2d3e 2046  work drive] -> F
+0000b940: 6f6c 6465 723a 2060 6874 7470 3a2f 2f31  older: `http://1
+0000b950: 3932 2e31 3638 2e31 3233 2e31 3a33 3932  92.168.123.1:392
+0000b960: 332f 600a 2020 2a20 6f6e 2077 696e 5850  3/`.  * on winXP
+0000b970: 206f 6e6c 792c 2063 6c69 636b 2074 6865   only, click the
+0000b980: 2060 5369 676e 2075 7020 666f 7220 6f6e   `Sign up for on
+0000b990: 6c69 6e65 2073 746f 7261 6765 6020 6879  line storage` hy
+0000b9a0: 7065 726c 696e 6b20 696e 7374 6561 6420  perlink instead 
+0000b9b0: 616e 6420 7075 7420 7468 6520 5552 4c20  and put the URL 
+0000b9c0: 7468 6572 650a 2020 2a20 7072 6f76 6964  there.  * provid
+0000b9d0: 696e 6720 796f 7572 2070 6173 7377 6f72  ing your passwor
+0000b9e0: 6420 6173 2074 6865 2075 7365 726e 616d  d as the usernam
+0000b9f0: 6520 6973 2072 6563 6f6d 6d65 6e64 6564  e is recommended
+0000ba00: 3b20 7468 6520 7061 7373 776f 7264 2066  ; the password f
+0000ba10: 6965 6c64 2063 616e 2062 6520 616e 7974  ield can be anyt
+0000ba20: 6869 6e67 206f 7220 656d 7074 790a 0a6b  hing or empty..k
+0000ba30: 6e6f 776e 2063 6c69 656e 7420 6275 6773  nown client bugs
+0000ba40: 3a0a 2a20 7769 6e37 2b20 646f 6573 6e27  :.* win7+ doesn'
+0000ba50: 7420 6163 7475 616c 6c79 2073 656e 6420  t actually send 
+0000ba60: 7468 6520 7061 7373 776f 7264 2074 6f20  the password to 
+0000ba70: 7468 6520 7365 7276 6572 2077 6865 6e20  the server when 
+0000ba80: 7265 6175 7468 656e 7469 6361 7469 6e67  reauthenticating
+0000ba90: 2061 6674 6572 2061 2072 6562 6f6f 7420   after a reboot 
+0000baa0: 756e 6c65 7373 2079 6f75 2066 6972 7374  unless you first
+0000bab0: 2074 7279 2074 6f20 6c6f 6769 6e20 7769   try to login wi
+0000bac0: 7468 2061 6e20 696e 636f 7272 6563 7420  th an incorrect 
+0000bad0: 7061 7373 776f 7264 2061 6e64 2074 6865  password and the
+0000bae0: 6e20 7377 6974 6368 2074 6f20 7468 6520  n switch to the 
+0000baf0: 636f 7272 6563 7420 7061 7373 776f 7264  correct password
+0000bb00: 0a20 202a 206f 7220 6a75 7374 2074 7970  .  * or just typ
+0000bb10: 6520 796f 7572 2070 6173 7377 6f72 6420  e your password 
+0000bb20: 696e 746f 2074 6865 2075 7365 726e 616d  into the usernam
+0000bb30: 6520 6669 656c 6420 696e 7374 6561 6420  e field instead 
+0000bb40: 746f 2067 6574 2061 726f 756e 6420 6974  to get around it
+0000bb50: 2065 6e74 6972 656c 790a 2a20 636f 6e6e   entirely.* conn
+0000bb60: 6563 7469 6e67 2074 6f20 6120 666f 6c64  ecting to a fold
+0000bb70: 6572 2077 6869 6368 2061 6c6c 6f77 7320  er which allows 
+0000bb80: 616e 6f6e 796d 6f75 7320 7265 6164 2077  anonymous read w
+0000bb90: 696c 6c20 6d61 6b65 2077 7269 7469 6e67  ill make writing
+0000bba0: 2069 6d70 6f73 7369 626c 652c 2061 7320   impossible, as 
+0000bbb0: 7769 6e64 6f77 7320 6861 7320 6465 6369  windows has deci
+0000bbc0: 6465 6420 6974 2064 6f65 736e 2774 206e  ded it doesn't n
+0000bbd0: 6565 6420 746f 206c 6f67 696e 0a20 202a  eed to login.  *
+0000bbe0: 2077 6f72 6b61 726f 756e 643a 2063 6f6e   workaround: con
+0000bbf0: 6e65 6374 2074 7769 6365 3b20 6669 7273  nect twice; firs
+0000bc00: 7420 746f 2061 2066 6f6c 6465 7220 7768  t to a folder wh
+0000bc10: 6963 6820 7265 7175 6972 6573 2061 7574  ich requires aut
+0000bc20: 682c 2074 6865 6e20 746f 2074 6865 2066  h, then to the f
+0000bc30: 6f6c 6465 7220 796f 7520 6163 7475 616c  older you actual
+0000bc40: 6c79 2077 616e 742c 2061 6e64 206c 6561  ly want, and lea
+0000bc50: 7665 2062 6f74 6820 6f66 2074 686f 7365  ve both of those
+0000bc60: 206d 6f75 6e74 6564 0a2a 2077 696e 372b   mounted.* win7+
+0000bc70: 206d 6179 206f 7065 6e20 6120 6e65 7720   may open a new 
+0000bc80: 7463 7020 636f 6e6e 6563 7469 6f6e 2066  tcp connection f
+0000bc90: 6f72 2065 7665 7279 2066 696c 6520 616e  or every file an
+0000bca0: 6420 736f 6d65 7469 6d65 7320 666f 7267  d sometimes forg
+0000bcb0: 6574 7320 746f 2063 6c6f 7365 2074 6865  ets to close the
+0000bcc0: 6d2c 2065 7665 6e74 7561 6c6c 7920 6e65  m, eventually ne
+0000bcd0: 6564 696e 6720 6120 7265 626f 6f74 0a20  eding a reboot. 
+0000bce0: 202a 206d 6179 6265 204e 4943 2d72 656c   * maybe NIC-rel
+0000bcf0: 6174 6564 2028 3f3f 292c 2068 6170 7065  ated (??), happe
+0000bd00: 6e73 2077 6974 6820 7769 6e31 302d 6c74  ns with win10-lt
+0000bd10: 7363 206f 6e20 6531 3030 3065 2062 7574  sc on e1000e but
+0000bd20: 206e 6f74 2076 6972 7469 6f0a 2a20 7769   not virtio.* wi
+0000bd30: 6e64 6f77 7320 6361 6e6e 6f74 2061 6363  ndows cannot acc
+0000bd40: 6573 7320 666f 6c64 6572 7320 7768 6963  ess folders whic
+0000bd50: 6820 636f 6e74 6169 6e20 6669 6c65 6e61  h contain filena
+0000bd60: 6d65 7320 7769 7468 2069 6e76 616c 6964  mes with invalid
+0000bd70: 2075 6e69 636f 6465 206f 7220 666f 7262   unicode or forb
+0000bd80: 6964 6465 6e20 6368 6172 6163 7465 7273  idden characters
+0000bd90: 2028 603c 3e3a 222f 5c7c 3f2a 6029 2c20   (`<>:"/\|?*`), 
+0000bda0: 6f72 206e 616d 6573 2065 6e64 696e 6720  or names ending 
+0000bdb0: 7769 7468 2060 2e60 0a2a 2077 696e 7870  with `.`.* winxp
+0000bdc0: 2063 616e 6e6f 7420 7368 6f77 2075 6e69   cannot show uni
+0000bdd0: 636f 6465 2063 6861 7261 6374 6572 7320  code characters 
+0000bde0: 6f75 7473 6964 6520 6f66 202a 736f 6d65  outside of *some
+0000bdf0: 2072 616e 6765 2a0a 2020 2a20 6c61 7469   range*.  * lati
+0000be00: 6e2d 3120 6973 2066 696e 652c 2068 6972  n-1 is fine, hir
+0000be10: 6167 616e 6120 6973 206e 6f74 2028 6e6f  agana is not (no
+0000be20: 7420 6576 656e 2061 7320 7368 6966 742d  t even as shift-
+0000be30: 6a69 7320 6f6e 206a 6170 616e 6573 6520  jis on japanese 
+0000be40: 7870 290a 0a0a 2323 2073 6d62 2073 6572  xp)...## smb ser
+0000be50: 7665 720a 0a75 6e73 6166 652c 2073 6c6f  ver..unsafe, slo
+0000be60: 772c 206e 6f74 2072 6563 6f6d 6d65 6e64  w, not recommend
+0000be70: 6564 2066 6f72 2077 616e 2c20 2065 6e61  ed for wan,  ena
+0000be80: 626c 6520 7769 7468 2060 2d2d 736d 6260  ble with `--smb`
+0000be90: 2066 6f72 2072 6561 642d 6f6e 6c79 206f   for read-only o
+0000bea0: 7220 602d 2d73 6d62 7760 2066 6f72 2072  r `--smbw` for r
+0000beb0: 6561 642d 7772 6974 650a 0a63 6c69 636b  ead-write..click
+0000bec0: 2074 6865 205b 636f 6e6e 6563 745d 2868   the [connect](h
+0000bed0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+0000bee0: 3339 3233 2f3f 6863 2920 6275 7474 6f6e  3923/?hc) button
+0000bef0: 2069 6e20 7468 6520 636f 6e74 726f 6c2d   in the control-
+0000bf00: 7061 6e65 6c20 746f 2073 6565 2063 6f6e  panel to see con
+0000bf10: 6e65 6374 696f 6e20 696e 7374 7275 6374  nection instruct
+0000bf20: 696f 6e73 2066 6f72 2077 696e 646f 7773  ions for windows
+0000bf30: 2c20 6c69 6e75 782c 206d 6163 6f73 0a0a  , linux, macos..
+0000bf40: 6465 7065 6e64 656e 6369 6573 3a20 6070  dependencies: `p
+0000bf50: 7974 686f 6e33 202d 6d20 7069 7020 696e  ython3 -m pip in
+0000bf60: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
+0000bf70: 696d 7061 636b 6574 3d3d 302e 3130 2e30  impacket==0.10.0
+0000bf80: 600a 2a20 6e65 7765 7220 7665 7273 696f  `.* newer versio
+0000bf90: 6e73 206f 6620 696d 7061 636b 6574 2077  ns of impacket w
+0000bfa0: 696c 6c20 686f 7065 6675 6c6c 7920 776f  ill hopefully wo
+0000bfb0: 726b 206a 7573 7420 6669 6e65 2062 7574  rk just fine but
+0000bfc0: 2074 6865 7265 2069 7320 6d6f 6e6b 6579   there is monkey
+0000bfd0: 7061 7463 6869 6e67 2073 6f20 6d61 7962  patching so mayb
+0000bfe0: 6520 6e6f 740a 0a73 6f6d 6520 2a2a 4249  e not..some **BI
+0000bff0: 4720 5741 524e 494e 4753 2a2a 2073 7065  G WARNINGS** spe
+0000c000: 6369 6669 6320 746f 2053 4d42 2f43 4946  cific to SMB/CIF
+0000c010: 532c 2069 6e20 6465 6372 6561 7369 6e67  S, in decreasing
+0000c020: 2069 6d70 6f72 7461 6e63 653a 0a2a 206e   importance:.* n
+0000c030: 6f74 2065 6e74 6972 656c 7920 636f 6e66  ot entirely conf
+0000c040: 6964 656e 7420 7468 6174 2072 6561 642d  ident that read-
+0000c050: 6f6e 6c79 2069 7320 7265 6164 2d6f 6e6c  only is read-onl
+0000c060: 790a 2a20 7468 6520 736d 6220 6261 636b  y.* the smb back
+0000c070: 656e 6420 6973 206e 6f74 2066 756c 6c79  end is not fully
+0000c080: 2069 6e74 6567 7261 7465 6420 7769 7468   integrated with
+0000c090: 2076 6673 2c20 6d65 616e 696e 6720 7468   vfs, meaning th
+0000c0a0: 6572 6520 636f 756c 6420 6265 2073 6563  ere could be sec
+0000c0b0: 7572 6974 7920 6973 7375 6573 2028 7061  urity issues (pa
+0000c0c0: 7468 2074 7261 7665 7273 616c 292e 2050  th traversal). P
+0000c0d0: 6c65 6173 6520 7573 6520 602d 2d73 6d62  lease use `--smb
+0000c0e0: 2d70 6f72 7460 2028 7365 6520 6265 6c6f  -port` (see belo
+0000c0f0: 7729 2061 6e64 205b 7072 6973 6f6e 7061  w) and [prisonpa
+0000c100: 7274 795d 282e 2f62 696e 2f70 7269 736f  rty](./bin/priso
+0000c110: 6e70 6172 7479 2e73 6829 0a20 202a 2061  nparty.sh).  * a
+0000c120: 6363 6f75 6e74 2070 6173 7377 6f72 6473  ccount passwords
+0000c130: 2077 6f72 6b20 7065 722d 766f 6c75 6d65   work per-volume
+0000c140: 2061 7320 6578 7065 6374 6564 2c20 6275   as expected, bu
+0000c150: 7420 6163 636f 756e 7420 7065 726d 6973  t account permis
+0000c160: 7369 6f6e 7320 6172 6520 636f 616c 6573  sions are coales
+0000c170: 6365 643b 2061 6c6c 2061 6363 6f75 6e74  ced; all account
+0000c180: 7320 6861 7665 2072 6561 642d 6163 6365  s have read-acce
+0000c190: 7373 2074 6f20 616c 6c20 766f 6c75 6d65  ss to all volume
+0000c1a0: 732c 2061 6e64 2069 6620 6120 7369 6e67  s, and if a sing
+0000c1b0: 6c65 2061 6363 6f75 6e74 2068 6173 2077  le account has w
+0000c1c0: 7269 7465 2d61 6363 6573 7320 746f 2073  rite-access to s
+0000c1d0: 6f6d 6520 766f 6c75 6d65 2074 6865 6e20  ome volume then 
+0000c1e0: 616c 6c20 6f74 6865 7220 6163 636f 756e  all other accoun
+0000c1f0: 7473 2061 6c73 6f20 646f 0a20 2020 202a  ts also do.    *
+0000c200: 2069 6620 6e6f 2061 6363 6f75 6e74 7320   if no accounts 
+0000c210: 6861 7665 2077 7269 7465 2d61 6363 6573  have write-acces
+0000c220: 7320 746f 2061 2073 7065 6369 6669 6320  s to a specific 
+0000c230: 766f 6c75 6d65 2c20 6f72 2069 6620 602d  volume, or if `-
+0000c240: 2d73 6d62 7760 2069 7320 6e6f 7420 7365  -smbw` is not se
+0000c250: 742c 2074 6865 6e20 7772 6974 696e 6720  t, then writing 
+0000c260: 746f 2074 6861 7420 766f 6c75 6d65 2066  to that volume f
+0000c270: 726f 6d20 736d 6220 2a73 686f 756c 642a  rom smb *should*
+0000c280: 2062 6520 696d 706f 7373 6962 6c65 0a20   be impossible. 
+0000c290: 2020 202a 2077 696c 6c20 6265 2066 6978     * will be fix
+0000c2a0: 6564 206f 6e63 6520 5b69 6d70 6163 6b65  ed once [impacke
+0000c2b0: 7420 7630 2e31 312e 305d 2868 7474 7073  t v0.11.0](https
+0000c2c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 5365  ://github.com/Se
+0000c2d0: 6375 7265 4175 7468 436f 7270 2f69 6d70  cureAuthCorp/imp
+0000c2e0: 6163 6b65 742f 636f 6d6d 6974 2f64 3932  acket/commit/d92
+0000c2f0: 3363 3030 6637 3564 3534 6239 3732 6263  3c00f75d54b972bc
+0000c300: 6135 3733 6132 3131 6138 3266 3039 6235  a573a211a82f09b5
+0000c310: 3532 3631 6129 2069 7320 7265 6c65 6173  5261a) is releas
+0000c320: 6564 0a20 202a 205b 7368 6164 6f77 696e  ed.  * [shadowin
+0000c330: 675d 2823 7368 6164 6f77 696e 6729 2070  g](#shadowing) p
+0000c340: 726f 6261 626c 7920 776f 726b 7320 6173  robably works as
+0000c350: 2065 7870 6563 7465 6420 6275 7420 6e6f   expected but no
+0000c360: 2067 7561 7261 6e74 6565 730a 0a61 6e64   guarantees..and
+0000c370: 2073 6f6d 6520 6d69 6e6f 7220 6973 7375   some minor issu
+0000c380: 6573 2c0a 2a20 636c 6965 6e74 7320 6f6e  es,.* clients on
+0000c390: 6c79 2073 6565 2074 6865 2066 6972 7374  ly see the first
+0000c3a0: 207e 3430 3020 6669 6c65 7320 696e 2062   ~400 files in b
+0000c3b0: 6967 2066 6f6c 6465 7273 3b20 5b69 6d70  ig folders; [imp
+0000c3c0: 6163 6b65 7423 3134 3333 5d28 6874 7470  acket#1433](http
+0000c3d0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f53  s://github.com/S
+0000c3e0: 6563 7572 6541 7574 6843 6f72 702f 696d  ecureAuthCorp/im
+0000c3f0: 7061 636b 6574 2f69 7373 7565 732f 3134  packet/issues/14
+0000c400: 3333 290a 2a20 686f 742d 7265 6c6f 6164  33).* hot-reload
+0000c410: 206f 6620 7365 7276 6572 2063 6f6e 6669   of server confi
+0000c420: 6720 2860 2f3f 7265 6c6f 6164 3d63 6667  g (`/?reload=cfg
+0000c430: 6029 2064 6f65 7320 6e6f 7420 696e 636c  `) does not incl
+0000c440: 7564 6520 7468 6520 605b 676c 6f62 616c  ude the `[global
+0000c450: 5d60 2073 6563 7469 6f6e 2028 636f 6d6d  ]` section (comm
+0000c460: 616e 646c 696e 6520 6172 6773 290a 2a20  andline args).* 
+0000c470: 6c69 7374 656e 7320 6f6e 2074 6865 2066  listens on the f
+0000c480: 6972 7374 2049 5076 3420 602d 6960 2069  irst IPv4 `-i` i
+0000c490: 6e74 6572 6661 6365 206f 6e6c 7920 2864  nterface only (d
+0000c4a0: 6566 6175 6c74 203d 203a 3a20 3d20 302e  efault = :: = 0.
+0000c4b0: 302e 302e 3020 3d20 616c 6c29 0a2a 206c  0.0.0 = all).* l
+0000c4c0: 6f67 696e 2064 6f65 736e 2774 2077 6f72  ogin doesn't wor
+0000c4d0: 6b20 6f6e 2077 696e 7870 2c20 6275 7420  k on winxp, but 
+0000c4e0: 616e 6f6e 796d 6f75 7320 6163 6365 7373  anonymous access
+0000c4f0: 2069 7320 6f6b 202d 2d20 7265 6d6f 7665   is ok -- remove
+0000c500: 2061 6c6c 2061 6363 6f75 6e74 7320 6672   all accounts fr
+0000c510: 6f6d 2063 6f70 7970 6172 7479 2063 6f6e  om copyparty con
+0000c520: 6669 6720 666f 7220 7468 6174 2074 6f20  fig for that to 
+0000c530: 776f 726b 0a20 202a 2077 696e 3130 206f  work.  * win10 o
+0000c540: 6e77 6172 6473 2064 6f65 7320 6e6f 7420  nwards does not 
+0000c550: 616c 6c6f 7720 636f 6e6e 6563 7469 6e67  allow connecting
+0000c560: 2061 6e6f 6e79 6d6f 7573 6c79 202f 2077   anonymously / w
+0000c570: 6974 686f 7574 2061 6363 6f75 6e74 730a  ithout accounts.
+0000c580: 2a20 6f6e 2077 696e 646f 7773 2c20 6372  * on windows, cr
+0000c590: 6561 7469 6e67 2061 206e 6577 2066 696c  eating a new fil
+0000c5a0: 6520 7468 726f 7567 6820 7269 6768 7463  e through rightc
+0000c5b0: 6c69 636b 202d 2d3e 206e 6577 202d 2d3e  lick --> new -->
+0000c5c0: 2074 6578 7466 696c 6520 7468 726f 7773   textfile throws
+0000c5d0: 2061 6e20 6572 726f 7220 6475 6520 746f   an error due to
+0000c5e0: 2069 6d70 6163 6b65 7420 6c69 6d69 7461   impacket limita
+0000c5f0: 7469 6f6e 7320 2d2d 2068 6974 204f 4b20  tions -- hit OK 
+0000c600: 616e 6420 4635 2074 6f20 6765 7420 796f  and F5 to get yo
+0000c610: 7572 2066 696c 650a 2a20 7079 7468 6f6e  ur file.* python
+0000c620: 3320 6f6e 6c79 0a2a 2073 6c6f 770a 0a6b  3 only.* slow..k
+0000c630: 6e6f 776e 2063 6c69 656e 7420 6275 6773  nown client bugs
+0000c640: 3a0a 2a20 6f6e 2077 696e 3720 6f6e 6c79  :.* on win7 only
+0000c650: 2c20 602d 2d73 6d62 3160 2069 7320 6d75  , `--smb1` is mu
+0000c660: 6368 2066 6173 7465 7220 7468 616e 2073  ch faster than s
+0000c670: 6d62 3220 2864 6566 6175 6c74 2920 6265  mb2 (default) be
+0000c680: 6361 7573 6520 6974 206b 6565 7073 2072  cause it keeps r
+0000c690: 6573 6361 6e6e 696e 6720 666f 6c64 6572  escanning folder
+0000c6a0: 7320 6f6e 2073 6d62 320a 2020 2a20 686f  s on smb2.  * ho
+0000c6b0: 7765 7665 7220 736d 6231 2069 7320 6275  wever smb1 is bu
+0000c6c0: 6767 7920 616e 6420 6973 206e 6f74 2065  ggy and is not e
+0000c6d0: 6e61 626c 6564 2062 7920 6465 6661 756c  nabled by defaul
+0000c6e0: 7420 6f6e 2077 696e 3130 206f 6e77 6172  t on win10 onwar
+0000c6f0: 6473 0a2a 2077 696e 646f 7773 2063 616e  ds.* windows can
+0000c700: 6e6f 7420 6163 6365 7373 2066 6f6c 6465  not access folde
+0000c710: 7273 2077 6869 6368 2063 6f6e 7461 696e  rs which contain
+0000c720: 2066 696c 656e 616d 6573 2077 6974 6820   filenames with 
+0000c730: 696e 7661 6c69 6420 756e 6963 6f64 6520  invalid unicode 
+0000c740: 6f72 2066 6f72 6269 6464 656e 2063 6861  or forbidden cha
+0000c750: 7261 6374 6572 7320 2860 3c3e 3a22 2f5c  racters (`<>:"/\
+0000c760: 7c3f 2a60 292c 206f 7220 6e61 6d65 7320  |?*`), or names 
+0000c770: 656e 6469 6e67 2077 6974 6820 602e 600a  ending with `.`.
+0000c780: 0a74 6865 2073 6d62 2070 726f 746f 636f  .the smb protoco
+0000c790: 6c20 6c69 7374 656e 7320 6f6e 2054 4350  l listens on TCP
+0000c7a0: 2070 6f72 7420 3434 352c 2077 6869 6368   port 445, which
+0000c7b0: 2069 7320 6120 7072 6976 696c 6567 6564   is a privileged
+0000c7c0: 2070 6f72 7420 6f6e 206c 696e 7578 2061   port on linux a
+0000c7d0: 6e64 206d 6163 6f73 2c20 7768 6963 6820  nd macos, which 
+0000c7e0: 776f 756c 6420 7265 7175 6972 6520 7275  would require ru
+0000c7f0: 6e6e 696e 6720 636f 7079 7061 7274 7920  nning copyparty 
+0000c800: 6173 2072 6f6f 742e 2048 6f77 6576 6572  as root. However
+0000c810: 2c20 7468 6973 2063 616e 2062 6520 6176  , this can be av
+0000c820: 6f69 6465 6420 6279 206c 6973 7465 6e69  oided by listeni
+0000c830: 6e67 206f 6e20 616e 6f74 6865 7220 706f  ng on another po
+0000c840: 7274 2075 7369 6e67 2060 2d2d 736d 622d  rt using `--smb-
+0000c850: 706f 7274 2033 3934 3560 2061 6e64 2074  port 3945` and t
+0000c860: 6865 6e20 7573 696e 6720 4e41 5420 746f  hen using NAT to
+0000c870: 2066 6f72 7761 7264 2074 6865 2074 7261   forward the tra
+0000c880: 6666 6963 2066 726f 6d20 3434 3520 746f  ffic from 445 to
+0000c890: 2074 6865 7265 3b0a 2a20 6f6e 206c 696e   there;.* on lin
+0000c8a0: 7578 3a20 6069 7074 6162 6c65 7320 2d74  ux: `iptables -t
+0000c8b0: 206e 6174 202d 4120 5052 4552 4f55 5449   nat -A PREROUTI
+0000c8c0: 4e47 202d 6920 6574 6830 202d 7020 7463  NG -i eth0 -p tc
+0000c8d0: 7020 2d2d 6470 6f72 7420 3434 3520 2d6a  p --dport 445 -j
+0000c8e0: 2052 4544 4952 4543 5420 2d2d 746f 2d70   REDIRECT --to-p
+0000c8f0: 6f72 7420 3339 3435 600a 0a61 7574 6865  ort 3945`..authe
+0000c900: 6e74 6963 6174 6520 7769 7468 206f 6e65  nticate with one
+0000c910: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+0000c920: 673a 0a2a 2075 7365 726e 616d 6520 6024  g:.* username `$
+0000c930: 7573 6572 6e61 6d65 602c 2070 6173 7377  username`, passw
+0000c940: 6f72 6420 6024 7061 7373 776f 7264 600a  ord `$password`.
+0000c950: 2a20 7573 6572 6e61 6d65 2060 2470 6173  * username `$pas
+0000c960: 7377 6f72 6460 2c20 7061 7373 776f 7264  sword`, password
+0000c970: 2060 6b60 0a0a 0a23 2320 6669 6c65 2069   `k`...## file i
+0000c980: 6e64 6578 696e 670a 0a65 6e61 626c 6573  ndexing..enables
+0000c990: 2064 6564 7570 2061 6e64 206d 7573 6963   dedup and music
+0000c9a0: 2073 6561 7263 6820 2b2b 0a0a 6669 6c65   search ++..file
+0000c9b0: 2069 6e64 6578 696e 6720 7265 6c69 6573   indexing relies
+0000c9c0: 206f 6e20 7477 6f20 6461 7461 6261 7365   on two database
+0000c9d0: 2074 6162 6c65 732c 2074 6865 2075 7032   tables, the up2
+0000c9e0: 6b20 6669 6c65 7472 6565 2028 602d 6532  k filetree (`-e2
+0000c9f0: 6460 2920 616e 6420 7468 6520 6d65 7461  d`) and the meta
+0000ca00: 6461 7461 2074 6167 7320 2860 2d65 3274  data tags (`-e2t
+0000ca10: 6029 2c20 7374 6f72 6564 2069 6e20 602e  `), stored in `.
+0000ca20: 6869 7374 2f75 7032 6b2e 6462 602e 2043  hist/up2k.db`. C
+0000ca30: 6f6e 6669 6775 7261 7469 6f6e 2063 616e  onfiguration can
+0000ca40: 2062 6520 646f 6e65 2074 6872 6f75 6768   be done through
+0000ca50: 2061 7267 756d 656e 7473 2c20 766f 6c66   arguments, volf
+0000ca60: 6c61 6773 2c20 6f72 2061 206d 6978 206f  lags, or a mix o
+0000ca70: 6620 626f 7468 2e0a 0a74 6872 6f75 6768  f both...through
+0000ca80: 2061 7267 756d 656e 7473 3a0a 2a20 602d   arguments:.* `-
+0000ca90: 6532 6460 2065 6e61 626c 6573 2066 696c  e2d` enables fil
+0000caa0: 6520 696e 6465 7869 6e67 206f 6e20 7570  e indexing on up
+0000cab0: 6c6f 6164 0a2a 2060 2d65 3264 7360 2061  load.* `-e2ds` a
+0000cac0: 6c73 6f20 7363 616e 7320 7772 6974 6162  lso scans writab
+0000cad0: 6c65 2066 6f6c 6465 7273 2066 6f72 206e  le folders for n
+0000cae0: 6577 2066 696c 6573 206f 6e20 7374 6172  ew files on star
+0000caf0: 7475 700a 2a20 602d 6532 6473 6160 2061  tup.* `-e2dsa` a
+0000cb00: 6c73 6f20 7363 616e 7320 616c 6c20 6d6f  lso scans all mo
+0000cb10: 756e 7465 6420 766f 6c75 6d65 7320 2869  unted volumes (i
+0000cb20: 6e63 6c75 6469 6e67 2072 6561 646f 6e6c  ncluding readonl
+0000cb30: 7920 6f6e 6573 290a 2a20 602d 6532 7460  y ones).* `-e2t`
+0000cb40: 2065 6e61 626c 6573 206d 6574 6164 6174   enables metadat
+0000cb50: 6120 696e 6465 7869 6e67 206f 6e20 7570  a indexing on up
+0000cb60: 6c6f 6164 0a2a 2060 2d65 3274 7360 2061  load.* `-e2ts` a
+0000cb70: 6c73 6f20 7363 616e 7320 666f 7220 7461  lso scans for ta
+0000cb80: 6773 2069 6e20 616c 6c20 6669 6c65 7320  gs in all files 
+0000cb90: 7468 6174 2064 6f6e 2774 2068 6176 6520  that don't have 
+0000cba0: 7461 6773 2079 6574 0a2a 2060 2d65 3274  tags yet.* `-e2t
+0000cbb0: 7372 6020 616c 736f 2064 656c 6574 6573  sr` also deletes
+0000cbc0: 2061 6c6c 2065 7869 7374 696e 6720 7461   all existing ta
+0000cbd0: 6773 2c20 646f 696e 6720 6120 6675 6c6c  gs, doing a full
+0000cbe0: 2072 6569 6e64 6578 0a2a 2060 2d65 3276   reindex.* `-e2v
+0000cbf0: 6020 7665 7266 6965 7320 6669 6c65 2069  ` verfies file i
+0000cc00: 6e74 6567 7269 7479 2061 7420 7374 6172  ntegrity at star
+0000cc10: 7475 702c 2063 6f6d 7061 7269 6e67 2068  tup, comparing h
+0000cc20: 6173 6865 7320 6672 6f6d 2074 6865 2064  ashes from the d
+0000cc30: 620a 2a20 602d 6532 7675 6020 7061 7463  b.* `-e2vu` patc
+0000cc40: 6865 7320 7468 6520 6461 7461 6261 7365  hes the database
+0000cc50: 2077 6974 6820 7468 6520 6e65 7720 6861   with the new ha
+0000cc60: 7368 6573 2066 726f 6d20 7468 6520 6669  shes from the fi
+0000cc70: 6c65 7379 7374 656d 0a2a 2060 2d65 3276  lesystem.* `-e2v
+0000cc80: 7060 2070 616e 6963 7320 616e 6420 6b69  p` panics and ki
+0000cc90: 6c6c 7320 636f 7079 7061 7274 7920 696e  lls copyparty in
+0000cca0: 7374 6561 640a 2a20 602d 2d78 6c69 6e6b  stead.* `--xlink
+0000ccb0: 6020 656e 6162 6c65 7320 6465 6475 706c  ` enables dedupl
+0000ccc0: 6963 6174 696f 6e20 6163 726f 7373 2076  ication across v
+0000ccd0: 6f6c 756d 6573 0a0a 7468 6520 7361 6d65  olumes..the same
+0000cce0: 2061 7267 756d 656e 7473 2063 616e 2062   arguments can b
+0000ccf0: 6520 7365 7420 6173 2076 6f6c 666c 6167  e set as volflag
+0000cd00: 732c 2069 6e20 6164 6469 7469 6f6e 2074  s, in addition t
+0000cd10: 6f20 6064 3264 602c 2060 6432 6473 602c  o `d2d`, `d2ds`,
+0000cd20: 2060 6432 7460 2c20 6064 3274 7360 2c20   `d2t`, `d2ts`, 
+0000cd30: 6064 3276 6020 666f 7220 6469 7361 626c  `d2v` for disabl
+0000cd40: 696e 673a 0a2a 2060 2d76 207e 2f6d 7573  ing:.* `-v ~/mus
+0000cd50: 6963 3a3a 723a 632c 6532 6473 612c 6532  ic::r:c,e2dsa,e2
+0000cd60: 7473 7260 2064 6f65 7320 6120 6675 6c6c  tsr` does a full
+0000cd70: 2072 6569 6e64 6578 206f 6620 6576 6572   reindex of ever
+0000cd80: 7974 6869 6e67 206f 6e20 7374 6172 7475  ything on startu
+0000cd90: 700a 2a20 602d 7620 7e2f 6d75 7369 633a  p.* `-v ~/music:
+0000cda0: 3a72 3a63 2c64 3264 6020 6469 7361 626c  :r:c,d2d` disabl
+0000cdb0: 6573 202a 2a61 6c6c 2a2a 2069 6e64 6578  es **all** index
+0000cdc0: 696e 672c 2065 7665 6e20 6966 2061 6e79  ing, even if any
+0000cdd0: 2060 2d65 322a 6020 6172 6520 6f6e 0a2a   `-e2*` are on.*
+0000cde0: 2060 2d76 207e 2f6d 7573 6963 3a3a 723a   `-v ~/music::r:
+0000cdf0: 632c 6432 7460 2064 6973 6162 6c65 7320  c,d2t` disables 
+0000ce00: 616c 6c20 602d 6532 742a 6020 2874 6167  all `-e2t*` (tag
+0000ce10: 7329 2c20 646f 6573 206e 6f74 2061 6666  s), does not aff
+0000ce20: 6563 7420 602d 6532 642a 600a 2a20 602d  ect `-e2d*`.* `-
+0000ce30: 7620 7e2f 6d75 7369 633a 3a72 3a63 2c64  v ~/music::r:c,d
+0000ce40: 3264 7360 2064 6973 6162 6c65 7320 6f6e  2ds` disables on
+0000ce50: 2d62 6f6f 7420 7363 616e 733b 206f 6e6c  -boot scans; onl
+0000ce60: 7920 696e 6465 7820 6e65 7720 7570 6c6f  y index new uplo
+0000ce70: 6164 730a 2a20 602d 7620 7e2f 6d75 7369  ads.* `-v ~/musi
+0000ce80: 633a 3a72 3a63 2c64 3274 7360 2073 616d  c::r:c,d2ts` sam
+0000ce90: 6520 6578 6365 7074 206f 6e6c 7920 6166  e except only af
+0000cea0: 6665 6374 696e 6720 7461 6773 0a0a 6e6f  fecting tags..no
+0000ceb0: 7465 3a0a 2a20 7468 6520 7061 7273 6572  te:.* the parser
+0000cec0: 2063 616e 2066 696e 616c 6c79 2068 616e   can finally han
+0000ced0: 646c 6520 6063 2c65 3264 7361 2c65 3274  dle `c,e2dsa,e2t
+0000cee0: 7372 6020 736f 2079 6f75 206e 6f20 6c6f  sr` so you no lo
+0000cef0: 6e67 6572 2068 6176 6520 746f 2060 632c  nger have to `c,
+0000cf00: 6532 6473 613a 632c 6532 7473 7260 0a2a  e2dsa:c,e2tsr`.*
+0000cf10: 2060 6532 7473 7260 2069 7320 7072 6f62   `e2tsr` is prob
+0000cf20: 6162 6c79 2061 6c77 6179 7320 6f76 6572  ably always over
+0000cf30: 6b69 6c6c 2c20 7369 6e63 6520 6065 3264  kill, since `e2d
+0000cf40: 7360 2f60 6532 6473 6160 2077 6f75 6c64  s`/`e2dsa` would
+0000cf50: 2070 6963 6b20 7570 2061 6e79 2066 696c   pick up any fil
+0000cf60: 6520 6d6f 6469 6669 6361 7469 6f6e 7320  e modifications 
+0000cf70: 616e 6420 6065 3274 7360 2077 6f75 6c64  and `e2ts` would
+0000cf80: 2074 6865 6e20 7265 696e 6465 7820 7468   then reindex th
+0000cf90: 6f73 652c 2075 6e6c 6573 7320 7468 6572  ose, unless ther
+0000cfa0: 6520 6973 2061 206e 6577 2063 6f70 7970  e is a new copyp
+0000cfb0: 6172 7479 2076 6572 7369 6f6e 2077 6974  arty version wit
+0000cfc0: 6820 6e65 7720 7061 7273 6572 7320 616e  h new parsers an
+0000cfd0: 6420 7468 6520 7265 6c65 6173 6520 6e6f  d the release no
+0000cfe0: 7465 2073 6179 7320 6f74 6865 7277 6973  te says otherwis
+0000cff0: 650a 2a20 7468 6520 7265 7363 616e 2062  e.* the rescan b
+0000d000: 7574 746f 6e20 696e 2074 6865 2061 646d  utton in the adm
+0000d010: 696e 2070 616e 656c 2068 6173 206e 6f20  in panel has no 
+0000d020: 6566 6665 6374 2075 6e6c 6573 7320 7468  effect unless th
+0000d030: 6520 766f 6c75 6d65 2068 6173 2060 2d65  e volume has `-e
+0000d040: 3264 7360 206f 7220 6869 6768 6572 0a2a  2ds` or higher.*
+0000d050: 2064 6564 7570 6c69 6361 7469 6f6e 2069   deduplication i
+0000d060: 7320 706f 7373 6962 6c65 206f 6e20 7769  s possible on wi
+0000d070: 6e64 6f77 7320 6966 2079 6f75 2072 756e  ndows if you run
+0000d080: 2063 6f70 7970 6172 7479 2061 7320 6164   copyparty as ad
+0000d090: 6d69 6e69 7374 7261 746f 7220 286e 6f74  ministrator (not
+0000d0a0: 2073 6179 696e 6720 796f 7520 7368 6f75   saying you shou
+0000d0b0: 6c64 2129 0a0a 2323 2320 6578 636c 7564  ld!)..### exclud
+0000d0c0: 652d 7061 7474 6572 6e73 0a0a 746f 2073  e-patterns..to s
+0000d0d0: 6176 6520 736f 6d65 2074 696d 652c 2020  ave some time,  
+0000d0e0: 796f 7520 6361 6e20 7072 6f76 6964 6520  you can provide 
+0000d0f0: 6120 7265 6765 7820 7061 7474 6572 6e20  a regex pattern 
+0000d100: 666f 7220 6669 6c65 7061 7468 7320 746f  for filepaths to
+0000d110: 206f 6e6c 7920 696e 6465 7820 6279 2066   only index by f
+0000d120: 696c 656e 616d 652f 7061 7468 2f73 697a  ilename/path/siz
+0000d130: 652f 6c61 7374 2d6d 6f64 6966 6965 6420  e/last-modified 
+0000d140: 2861 6e64 206e 6f74 2074 6865 2068 6173  (and not the has
+0000d150: 6820 6f66 2074 6865 2066 696c 6520 636f  h of the file co
+0000d160: 6e74 656e 7473 2920 6279 2073 6574 7469  ntents) by setti
+0000d170: 6e67 2060 2d2d 6e6f 2d68 6173 6820 5c2e  ng `--no-hash \.
+0000d180: 6973 6f24 6020 6f72 2074 6865 2076 6f6c  iso$` or the vol
+0000d190: 666c 6167 2060 3a63 2c6e 6f68 6173 683d  flag `:c,nohash=
+0000d1a0: 5c2e 6973 6f24 602c 2074 6869 7320 6861  \.iso$`, this ha
+0000d1b0: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
+0000d1c0: 636f 6e73 6571 7565 6e63 6573 3a0a 2a20  consequences:.* 
+0000d1d0: 696e 6974 6961 6c20 696e 6465 7869 6e67  initial indexing
+0000d1e0: 2069 7320 7761 7920 6661 7374 6572 2c20   is way faster, 
+0000d1f0: 6573 7065 6369 616c 6c79 2077 6865 6e20  especially when 
+0000d200: 7468 6520 766f 6c75 6d65 2069 7320 6f6e  the volume is on
+0000d210: 2061 206e 6574 776f 726b 2064 6973 6b0a   a network disk.
+0000d220: 2a20 6d61 6b65 7320 6974 2069 6d70 6f73  * makes it impos
+0000d230: 7369 626c 6520 746f 205b 6669 6c65 2d73  sible to [file-s
+0000d240: 6561 7263 685d 2823 6669 6c65 2d73 6561  earch](#file-sea
+0000d250: 7263 6829 0a2a 2069 6620 736f 6d65 6f6e  rch).* if someon
+0000d260: 6520 7570 6c6f 6164 7320 7468 6520 7361  e uploads the sa
+0000d270: 6d65 2066 696c 6520 636f 6e74 656e 7473  me file contents
+0000d280: 2c20 7468 6520 7570 6c6f 6164 2077 696c  , the upload wil
+0000d290: 6c20 6e6f 7420 6265 2064 6574 6563 7465  l not be detecte
+0000d2a0: 6420 6173 2061 2064 7570 652c 2073 6f20  d as a dupe, so 
+0000d2b0: 6974 2077 696c 6c20 6e6f 7420 6765 7420  it will not get 
+0000d2c0: 7379 6d6c 696e 6b65 6420 6f72 2072 656a  symlinked or rej
+0000d2d0: 6563 7465 640a 0a73 696d 696c 6172 6c79  ected..similarly
+0000d2e0: 2c20 796f 7520 6361 6e20 6675 6c6c 7920  , you can fully 
+0000d2f0: 6967 6e6f 7265 2066 696c 6573 2f66 6f6c  ignore files/fol
+0000d300: 6465 7273 2075 7369 6e67 2060 2d2d 6e6f  ders using `--no
+0000d310: 2d69 6478 205b 2e2e 2e5d 6020 616e 6420  -idx [...]` and 
+0000d320: 603a 632c 6e6f 6964 783d 5c2e 6973 6f24  `:c,noidx=\.iso$
+0000d330: 600a 0a69 6620 796f 7520 7365 7420 602d  `..if you set `-
+0000d340: 2d6e 6f2d 6861 7368 205b 2e2e 2e5d 6020  -no-hash [...]` 
+0000d350: 676c 6f62 616c 6c79 2c20 796f 7520 6361  globally, you ca
+0000d360: 6e20 656e 6162 6c65 2068 6173 6869 6e67  n enable hashing
+0000d370: 2066 6f72 2073 7065 6369 6669 6320 766f   for specific vo
+0000d380: 6c75 6d65 7320 7573 696e 6720 666c 6167  lumes using flag
+0000d390: 2060 3a63 2c6e 6f68 6173 683d 600a 0a23   `:c,nohash=`..#
+0000d3a0: 2323 2066 696c 6573 7973 7465 6d20 6775  ## filesystem gu
+0000d3b0: 6172 6473 0a0a 6176 6f69 6420 7472 6176  ards..avoid trav
+0000d3c0: 6572 7369 6e67 2069 6e74 6f20 6f74 6865  ersing into othe
+0000d3d0: 7220 6669 6c65 7379 7374 656d 7320 2075  r filesystems  u
+0000d3e0: 7369 6e67 2060 2d2d 7864 6576 6020 2f20  sing `--xdev` / 
+0000d3f0: 766f 6c66 6c61 6720 603a 632c 7864 6576  volflag `:c,xdev
+0000d400: 602c 2073 6b69 7070 696e 6720 616e 7920  `, skipping any 
+0000d410: 7379 6d6c 696e 6b73 206f 7220 6269 6e64  symlinks or bind
+0000d420: 2d6d 6f75 6e74 7320 746f 2061 6e6f 7468  -mounts to anoth
+0000d430: 6572 2048 4444 2066 6f72 2065 7861 6d70  er HDD for examp
+0000d440: 6c65 0a0a 616e 642f 6f72 2079 6f75 2063  le..and/or you c
+0000d450: 616e 2060 2d2d 7876 6f6c 6020 2f20 603a  an `--xvol` / `:
+0000d460: 632c 7876 6f6c 6020 746f 2069 676e 6f72  c,xvol` to ignor
+0000d470: 6520 616c 6c20 7379 6d6c 696e 6b73 206c  e all symlinks l
+0000d480: 6561 7669 6e67 2074 6865 2076 6f6c 756d  eaving the volum
+0000d490: 6527 7320 746f 7020 6469 7265 6374 6f72  e's top director
+0000d4a0: 792c 2062 7574 2073 7469 6c6c 2061 6c6c  y, but still all
+0000d4b0: 6f77 2062 696e 642d 6d6f 756e 7473 2070  ow bind-mounts p
+0000d4c0: 6f69 6e74 696e 6720 656c 7365 7768 6572  ointing elsewher
+0000d4d0: 650a 0a2a 2073 796d 6c69 6e6b 7320 6172  e..* symlinks ar
+0000d4e0: 6520 7065 726d 6974 7465 6420 7769 7468  e permitted with
+0000d4f0: 2060 7876 6f6c 6020 6966 2074 6865 7920   `xvol` if they 
+0000d500: 706f 696e 7420 696e 746f 2061 6e6f 7468  point into anoth
+0000d510: 6572 2076 6f6c 756d 6520 7768 6572 6520  er volume where 
+0000d520: 7468 6520 7573 6572 2068 6173 2074 6865  the user has the
+0000d530: 2073 616d 6520 6c65 7665 6c20 6f66 2061   same level of a
+0000d540: 6363 6573 730a 0a74 6865 7365 206f 7074  ccess..these opt
+0000d550: 696f 6e73 2077 696c 6c20 7265 6475 6365  ions will reduce
+0000d560: 2070 6572 666f 726d 616e 6365 3b20 756e   performance; un
+0000d570: 6c69 6b65 6c79 2077 6f72 7374 2d63 6173  likely worst-cas
+0000d580: 6520 6573 7469 6d61 7465 7320 6172 6520  e estimates are 
+0000d590: 3134 2520 7265 6475 6374 696f 6e20 666f  14% reduction fo
+0000d5a0: 7220 6469 7265 6374 6f72 7920 6c69 7374  r directory list
+0000d5b0: 696e 6773 2c20 3335 2520 666f 7220 646f  ings, 35% for do
+0000d5c0: 776e 6c6f 6164 2d61 732d 7461 720a 0a61  wnload-as-tar..a
+0000d5d0: 7320 6f66 2063 6f70 7970 6172 7479 2076  s of copyparty v
+0000d5e0: 312e 372e 3020 7468 6573 6520 6f70 7469  1.7.0 these opti
+0000d5f0: 6f6e 7320 616c 736f 2070 7265 7665 6e74  ons also prevent
+0000d600: 2066 696c 6520 6163 6365 7373 2061 7420   file access at 
+0000d610: 7275 6e74 696d 6520 2d2d 2069 6e20 7072  runtime -- in pr
+0000d620: 6576 696f 7573 2076 6572 7369 6f6e 7320  evious versions 
+0000d630: 6974 2077 6173 206a 7573 7420 6869 6e74  it was just hint
+0000d640: 7320 666f 7220 7468 6520 696e 6465 7865  s for the indexe
+0000d650: 720a 0a23 2323 2070 6572 696f 6469 6320  r..### periodic 
+0000d660: 7265 7363 616e 0a0a 6669 6c65 7379 7374  rescan..filesyst
+0000d670: 656d 206d 6f6e 6974 6f72 696e 673b 2020  em monitoring;  
+0000d680: 6966 2063 6f70 7970 6172 7479 2069 7320  if copyparty is 
+0000d690: 6e6f 7420 7468 6520 6f6e 6c79 2073 6f66  not the only sof
+0000d6a0: 7477 6172 6520 646f 696e 6720 7374 7566  tware doing stuf
+0000d6b0: 6620 6f6e 2079 6f75 7220 6669 6c65 7379  f on your filesy
+0000d6c0: 7374 656d 2c20 796f 7520 6d61 7920 7761  stem, you may wa
+0000d6d0: 6e74 2074 6f20 656e 6162 6c65 2070 6572  nt to enable per
+0000d6e0: 696f 6469 6320 7265 7363 616e 7320 746f  iodic rescans to
+0000d6f0: 206b 6565 7020 7468 6520 696e 6465 7820   keep the index 
+0000d700: 7570 2074 6f20 6461 7465 0a0a 6172 6775  up to date..argu
+0000d710: 6d65 6e74 2060 2d2d 7265 2d6d 6178 6167  ment `--re-maxag
+0000d720: 6520 3630 6020 7769 6c6c 2072 6573 6361  e 60` will resca
+0000d730: 6e20 616c 6c20 766f 6c75 6d65 7320 6576  n all volumes ev
+0000d740: 6572 7920 3630 2073 6563 2c20 7361 6d65  ery 60 sec, same
+0000d750: 2061 7320 766f 6c66 6c61 6720 603a 632c   as volflag `:c,
+0000d760: 7363 616e 3d36 3060 2074 6f20 7370 6563  scan=60` to spec
+0000d770: 6966 7920 6974 2070 6572 2d76 6f6c 756d  ify it per-volum
+0000d780: 650a 0a75 706c 6f61 6473 2061 7265 2064  e..uploads are d
+0000d790: 6973 6162 6c65 6420 7768 696c 6520 6120  isabled while a 
+0000d7a0: 7265 7363 616e 2069 7320 6861 7070 656e  rescan is happen
+0000d7b0: 696e 672c 2073 6f20 7265 7363 616e 7320  ing, so rescans 
+0000d7c0: 7769 6c6c 2062 6520 6465 6c61 7965 6420  will be delayed 
+0000d7d0: 6279 2060 2d2d 6462 2d61 6374 6020 2864  by `--db-act` (d
+0000d7e0: 6566 6175 6c74 2031 3020 7365 6329 2077  efault 10 sec) w
+0000d7f0: 6865 6e20 7468 6572 6520 6973 2077 7269  hen there is wri
+0000d800: 7465 2d61 6374 6976 6974 7920 676f 696e  te-activity goin
+0000d810: 6720 6f6e 2028 7570 6c6f 6164 732c 2072  g on (uploads, r
+0000d820: 656e 616d 6573 2c20 2e2e 2e29 0a0a 0a23  enames, ...)...#
+0000d830: 2320 7570 6c6f 6164 2072 756c 6573 0a0a  # upload rules..
+0000d840: 7365 7420 7570 6c6f 6164 2072 756c 6573  set upload rules
+0000d850: 2075 7369 6e67 2076 6f6c 666c 6167 732c   using volflags,
+0000d860: 2020 736f 6d65 2065 7861 6d70 6c65 733a    some examples:
+0000d870: 0a0a 2a20 603a 632c 737a 3d31 6b2d 336d  ..* `:c,sz=1k-3m
+0000d880: 6020 7365 7473 2061 6c6c 6f77 6564 2066  ` sets allowed f
+0000d890: 696c 6573 697a 6520 6265 7477 6565 6e20  ilesize between 
+0000d8a0: 3120 4b69 4220 616e 6420 3320 4d69 4220  1 KiB and 3 MiB 
+0000d8b0: 696e 636c 7573 6976 6520 2873 7566 6669  inclusive (suffi
+0000d8c0: 7865 733a 2060 6260 2c20 606b 602c 2060  xes: `b`, `k`, `
+0000d8d0: 6d60 2c20 6067 6029 0a2a 2060 3a63 2c64  m`, `g`).* `:c,d
+0000d8e0: 663d 3467 6020 626c 6f63 6b20 7570 6c6f  f=4g` block uplo
+0000d8f0: 6164 7320 6966 2074 6865 7265 2077 6f75  ads if there wou
+0000d900: 6c64 2062 6520 6c65 7373 2074 6861 6e20  ld be less than 
+0000d910: 3420 4769 4220 6672 6565 2064 6973 6b20  4 GiB free disk 
+0000d920: 7370 6163 6520 6166 7465 7277 6172 6473  space afterwards
+0000d930: 0a2a 2060 3a63 2c6e 6f73 7562 6020 6469  .* `:c,nosub` di
+0000d940: 7361 6c6c 6f77 2075 706c 6f61 6469 6e67  sallow uploading
+0000d950: 2069 6e74 6f20 7375 6264 6972 6563 746f   into subdirecto
+0000d960: 7269 6573 3b20 676f 6573 2077 656c 6c20  ries; goes well 
+0000d970: 7769 7468 2060 726f 746e 6020 616e 6420  with `rotn` and 
+0000d980: 6072 6f74 6660 3a0a 2a20 603a 632c 726f  `rotf`:.* `:c,ro
+0000d990: 746e 3d31 3030 302c 3260 206d 6f76 6573  tn=1000,2` moves
+0000d9a0: 2075 706c 6f61 6473 2069 6e74 6f20 7375   uploads into su
+0000d9b0: 6266 6f6c 6465 7273 2c20 7570 2074 6f20  bfolders, up to 
+0000d9c0: 3130 3030 2066 696c 6573 2069 6e20 6561  1000 files in ea
+0000d9d0: 6368 2066 6f6c 6465 7220 6265 666f 7265  ch folder before
+0000d9e0: 206d 616b 696e 6720 6120 6e65 7720 6f6e   making a new on
+0000d9f0: 652c 2074 776f 206c 6576 656c 7320 6465  e, two levels de
+0000da00: 6570 2028 6d75 7374 2062 6520 6174 206c  ep (must be at l
+0000da10: 6561 7374 2031 290a 2a20 603a 632c 726f  east 1).* `:c,ro
+0000da20: 7466 3d25 592f 256d 2f25 642f 2548 6020  tf=%Y/%m/%d/%H` 
+0000da30: 656e 666f 7263 6573 2066 696c 6573 2074  enforces files t
+0000da40: 6f20 6265 2075 706c 6f61 6465 6420 696e  o be uploaded in
+0000da50: 746f 2061 2073 7472 7563 7475 7265 206f  to a structure o
+0000da60: 6620 7375 6266 6f6c 6465 7273 2061 6363  f subfolders acc
+0000da70: 6f72 6469 6e67 2074 6f20 7468 6174 2064  ording to that d
+0000da80: 6174 6520 666f 726d 6174 0a20 202a 2069  ate format.  * i
+0000da90: 6620 736f 6d65 6f6e 6520 7570 6c6f 6164  f someone upload
+0000daa0: 7320 746f 2060 2f66 6f6f 2f62 6172 6020  s to `/foo/bar` 
+0000dab0: 7468 6520 7061 7468 2077 6f75 6c64 2062  the path would b
+0000dac0: 6520 7265 7772 6974 7465 6e20 746f 2060  e rewritten to `
+0000dad0: 2f66 6f6f 2f62 6172 2f32 3032 312f 3038  /foo/bar/2021/08
+0000dae0: 2f30 362f 3233 6020 666f 7220 6578 616d  /06/23` for exam
+0000daf0: 706c 650a 2020 2a20 6275 7420 7468 6520  ple.  * but the 
+0000db00: 6163 7475 616c 2076 616c 7565 2069 7320  actual value is 
+0000db10: 6e6f 7420 7665 7269 6669 6564 2c20 6a75  not verified, ju
+0000db20: 7374 2074 6865 2073 7472 7563 7475 7265  st the structure
+0000db30: 2c20 736f 2074 6865 2075 706c 6f61 6465  , so the uploade
+0000db40: 7220 6361 6e20 6368 6f6f 7365 2061 6e79  r can choose any
+0000db50: 2076 616c 7565 7320 7768 6963 6820 636f   values which co
+0000db60: 6e66 6f72 6d20 746f 2074 6865 2066 6f72  nform to the for
+0000db70: 6d61 7420 7374 7269 6e67 0a20 2020 202a  mat string.    *
+0000db80: 206a 7573 7420 746f 2061 766f 6964 2061   just to avoid a
+0000db90: 6464 6974 696f 6e61 6c20 636f 6d70 6c65  dditional comple
+0000dba0: 7869 7479 2069 6e20 7570 326b 2077 6869  xity in up2k whi
+0000dbb0: 6368 2069 7320 656e 6f75 6768 206f 6620  ch is enough of 
+0000dbc0: 6120 6d65 7373 2061 6c72 6561 6479 0a2a  a mess already.*
+0000dbd0: 2060 3a63 2c6c 6966 6574 696d 653d 3330   `:c,lifetime=30
+0000dbe0: 3060 2064 656c 6574 6520 7570 6c6f 6164  0` delete upload
+0000dbf0: 6564 2066 696c 6573 2077 6865 6e20 7468  ed files when th
+0000dc00: 6579 2062 6563 6f6d 6520 3520 6d69 6e75  ey become 5 minu
+0000dc10: 7465 7320 6f6c 640a 0a79 6f75 2063 616e  tes old..you can
+0000dc20: 2061 6c73 6f20 7365 7420 7472 616e 7361   also set transa
+0000dc30: 6374 696f 6e20 6c69 6d69 7473 2077 6869  ction limits whi
+0000dc40: 6368 2061 7070 6c79 2070 6572 2d49 5020  ch apply per-IP 
+0000dc50: 616e 6420 7065 722d 766f 6c75 6d65 2c20  and per-volume, 
+0000dc60: 6275 7420 7468 6573 6520 6173 7375 6d65  but these assume
+0000dc70: 2060 2d6a 2031 6020 2864 6566 6175 6c74   `-j 1` (default
+0000dc80: 2920 6f74 6865 7277 6973 6520 7468 6520  ) otherwise the 
+0000dc90: 6c69 6d69 7473 2077 696c 6c20 6265 206f  limits will be o
+0000dca0: 6666 2c20 666f 7220 6578 616d 706c 6520  ff, for example 
+0000dcb0: 602d 6a20 3460 2077 6f75 6c64 2061 6c6c  `-j 4` would all
+0000dcc0: 6f77 2061 6e79 7768 6572 6520 6265 7477  ow anywhere betw
+0000dcd0: 6565 6e20 3178 2061 6e64 2034 7820 7468  een 1x and 4x th
+0000dce0: 6520 6c69 6d69 7473 2079 6f75 2073 6574  e limits you set
+0000dcf0: 2064 6570 656e 6469 6e67 206f 6e20 7768   depending on wh
+0000dd00: 6963 6820 7072 6f63 6573 7369 6e67 206e  ich processing n
+0000dd10: 6f64 6520 7468 6520 636c 6965 6e74 2067  ode the client g
+0000dd20: 6574 7320 726f 7574 6564 2074 6f0a 0a2a  ets routed to..*
+0000dd30: 2060 3a63 2c6d 6178 6e3d 3235 302c 3336   `:c,maxn=250,36
+0000dd40: 3030 6020 616c 6c6f 7773 2032 3530 2066  00` allows 250 f
+0000dd50: 696c 6573 206f 7665 7220 3120 686f 7572  iles over 1 hour
+0000dd60: 2066 726f 6d20 6561 6368 2049 5020 2874   from each IP (t
+0000dd70: 7261 636b 6564 2070 6572 2d76 6f6c 756d  racked per-volum
+0000dd80: 6529 0a2a 2060 3a63 2c6d 6178 623d 3167  e).* `:c,maxb=1g
+0000dd90: 2c33 3030 6020 616c 6c6f 7773 2031 2047  ,300` allows 1 G
+0000dda0: 6942 2074 6f74 616c 206f 7665 7220 3520  iB total over 5 
+0000ddb0: 6d69 6e75 7465 7320 6672 6f6d 2065 6163  minutes from eac
+0000ddc0: 6820 4950 2028 7472 6163 6b65 6420 7065  h IP (tracked pe
+0000ddd0: 722d 766f 6c75 6d65 290a 0a0a 2323 2063  r-volume)...## c
+0000dde0: 6f6d 7072 6573 7320 7570 6c6f 6164 730a  ompress uploads.
+0000ddf0: 0a66 696c 6573 2063 616e 2062 6520 6175  .files can be au
+0000de00: 746f 636f 6d70 7265 7373 6564 206f 6e20  tocompressed on 
+0000de10: 7570 6c6f 6164 2c20 2065 6974 6865 7220  upload,  either 
+0000de20: 6f6e 2075 7365 722d 7265 7175 6573 7420  on user-request 
+0000de30: 2869 6620 636f 6e66 6967 2061 6c6c 6f77  (if config allow
+0000de40: 7329 206f 7220 666f 7263 6564 2062 7920  s) or forced by 
+0000de50: 7365 7276 6572 2d63 6f6e 6669 670a 0a2a  server-config..*
+0000de60: 2076 6f6c 666c 6167 2060 677a 6020 616c   volflag `gz` al
+0000de70: 6c6f 7773 2067 7a20 636f 6d70 7265 7373  lows gz compress
+0000de80: 696f 6e0a 2a20 766f 6c66 6c61 6720 6078  ion.* volflag `x
+0000de90: 7a60 2061 6c6c 6f77 7320 6c7a 6d61 2063  z` allows lzma c
+0000dea0: 6f6d 7072 6573 7369 6f6e 0a2a 2076 6f6c  ompression.* vol
+0000deb0: 666c 6167 2060 706b 6020 2a2a 666f 7263  flag `pk` **forc
+0000dec0: 6573 2a2a 2063 6f6d 7072 6573 7369 6f6e  es** compression
+0000ded0: 206f 6e20 616c 6c20 6669 6c65 730a 2a20   on all files.* 
+0000dee0: 7572 6c20 7061 7261 6d65 7465 7220 6070  url parameter `p
+0000def0: 6b60 2072 6571 7565 7374 7320 636f 6d70  k` requests comp
+0000df00: 7265 7373 696f 6e20 7769 7468 2073 6572  ression with ser
+0000df10: 7665 722d 6465 6661 756c 7420 616c 676f  ver-default algo
+0000df20: 7269 7468 6d0a 2a20 7572 6c20 7061 7261  rithm.* url para
+0000df30: 6d65 7465 7220 6067 7a60 206f 7220 6078  meter `gz` or `x
+0000df40: 7a60 2072 6571 7565 7374 7320 636f 6d70  z` requests comp
+0000df50: 7265 7373 696f 6e20 7769 7468 2061 2073  ression with a s
+0000df60: 7065 6369 6669 6320 616c 676f 7269 7468  pecific algorith
+0000df70: 6d0a 2a20 7572 6c20 7061 7261 6d65 7465  m.* url paramete
+0000df80: 7220 6078 7a60 2072 6571 7565 7374 7320  r `xz` requests 
+0000df90: 787a 2063 6f6d 7072 6573 7369 6f6e 0a0a  xz compression..
+0000dfa0: 7468 696e 6773 2074 6f20 6e6f 7465 2c0a  things to note,.
+0000dfb0: 2a20 7468 6520 6067 7a60 2061 6e64 2060  * the `gz` and `
+0000dfc0: 787a 6020 6172 6775 6d65 6e74 7320 7461  xz` arguments ta
+0000dfd0: 6b65 2061 2073 696e 676c 6520 6f70 7469  ke a single opti
+0000dfe0: 6f6e 616c 2061 7267 756d 656e 742c 2074  onal argument, t
+0000dff0: 6865 2063 6f6d 7072 6573 7369 6f6e 206c  he compression l
+0000e000: 6576 656c 2028 7261 6e67 6520 3020 746f  evel (range 0 to
+0000e010: 2039 290a 2a20 7468 6520 6070 6b60 2076   9).* the `pk` v
+0000e020: 6f6c 666c 6167 2074 616b 6573 2074 6865  olflag takes the
+0000e030: 206f 7074 696f 6e61 6c20 6172 6775 6d65   optional argume
+0000e040: 6e74 2060 414c 474f 5249 5448 4d2c 4c45  nt `ALGORITHM,LE
+0000e050: 5645 4c60 2077 6869 6368 2077 696c 6c20  VEL` which will 
+0000e060: 7468 656e 2062 6520 666f 7263 6564 2066  then be forced f
+0000e070: 6f72 2061 6c6c 2075 706c 6f61 6473 2c20  or all uploads, 
+0000e080: 666f 7220 6578 616d 706c 6520 6067 7a2c  for example `gz,
+0000e090: 3960 206f 7220 6078 7a2c 3060 0a2a 2064  9` or `xz,0`.* d
+0000e0a0: 6566 6175 6c74 2063 6f6d 7072 6573 7369  efault compressi
+0000e0b0: 6f6e 2069 7320 677a 6970 206c 6576 656c  on is gzip level
+0000e0c0: 2039 0a2a 2061 6c6c 2075 706c 6f61 6420   9.* all upload 
+0000e0d0: 6d65 7468 6f64 7320 6578 6365 7074 2075  methods except u
+0000e0e0: 7032 6b20 6172 6520 7375 7070 6f72 7465  p2k are supporte
+0000e0f0: 640a 2a20 7468 6520 6669 6c65 7320 7769  d.* the files wi
+0000e100: 6c6c 2062 6520 696e 6465 7865 6420 6166  ll be indexed af
+0000e110: 7465 7220 636f 6d70 7265 7373 696f 6e2c  ter compression,
+0000e120: 2073 6f20 6475 7065 2d64 6574 6563 7469   so dupe-detecti
+0000e130: 6f6e 2061 6e64 2066 696c 652d 7365 6172  on and file-sear
+0000e140: 6368 2077 696c 6c20 6e6f 7420 776f 726b  ch will not work
+0000e150: 2061 7320 6578 7065 6374 6564 0a0a 736f   as expected..so
+0000e160: 6d65 2065 7861 6d70 6c65 732c 0a2a 2060  me examples,.* `
+0000e170: 2d76 2069 6e63 3a69 6e63 3a77 3a63 2c70  -v inc:inc:w:c,p
+0000e180: 6b3d 787a 2c30 6020 200a 2020 666f 6c64  k=xz,0`  .  fold
+0000e190: 6572 206e 616d 6564 2069 6e63 2c20 7368  er named inc, sh
+0000e1a0: 6172 6564 2061 7420 696e 632c 2077 7269  ared at inc, wri
+0000e1b0: 7465 2d6f 6e6c 7920 666f 7220 6576 6572  te-only for ever
+0000e1c0: 796f 6e65 2c20 666f 7263 6573 2078 7a20  yone, forces xz 
+0000e1d0: 636f 6d70 7265 7373 696f 6e20 6174 206c  compression at l
+0000e1e0: 6576 656c 2030 0a2a 2060 2d76 2069 6e63  evel 0.* `-v inc
+0000e1f0: 3a69 6e63 3a77 3a63 2c70 6b60 2020 0a20  :inc:w:c,pk`  . 
+0000e200: 2073 616d 6520 7772 6974 652d 6f6e 6c79   same write-only
+0000e210: 2069 6e63 2c20 6275 7420 666f 7263 6573   inc, but forces
+0000e220: 2067 7a20 636f 6d70 7265 7373 696f 6e20   gz compression 
+0000e230: 2864 6566 6175 6c74 2920 696e 7374 6561  (default) instea
+0000e240: 6420 6f66 2078 7a0a 2a20 602d 7620 696e  d of xz.* `-v in
+0000e250: 633a 696e 633a 773a 632c 677a 6020 200a  c:inc:w:c,gz`  .
+0000e260: 2020 616c 6c6f 7773 2028 6275 7420 646f    allows (but do
+0000e270: 6573 206e 6f74 2066 6f72 6365 2920 677a  es not force) gz
+0000e280: 2063 6f6d 7072 6573 7369 6f6e 2069 6620   compression if 
+0000e290: 636c 6965 6e74 2075 706c 6f61 6473 2074  client uploads t
+0000e2a0: 6f20 602f 696e 633f 706b 6020 6f72 2060  o `/inc?pk` or `
+0000e2b0: 2f69 6e63 3f67 7a60 206f 7220 602f 696e  /inc?gz` or `/in
+0000e2c0: 633f 677a 3d34 600a 0a0a 2323 206f 7468  c?gz=4`...## oth
+0000e2d0: 6572 2066 6c61 6773 0a0a 2a20 603a 632c  er flags..* `:c,
+0000e2e0: 6d61 6769 6360 2065 6e61 626c 6573 2066  magic` enables f
+0000e2f0: 696c 6574 7970 6520 6465 7465 6374 696f  iletype detectio
+0000e300: 6e20 666f 7220 6e61 6d65 6c65 7373 2075  n for nameless u
+0000e310: 706c 6f61 6473 2c20 7361 6d65 2061 7320  ploads, same as 
+0000e320: 602d 2d6d 6167 6963 600a 2020 2a20 6e65  `--magic`.  * ne
+0000e330: 6564 7320 6874 7470 733a 2f2f 7079 7069  eds https://pypi
+0000e340: 2e6f 7267 2f70 726f 6a65 6374 2f70 7974  .org/project/pyt
+0000e350: 686f 6e2d 6d61 6769 632f 2060 7079 7468  hon-magic/ `pyth
+0000e360: 6f6e 3320 2d6d 2070 6970 2069 6e73 7461  on3 -m pip insta
+0000e370: 6c6c 202d 2d75 7365 7220 2d55 2070 7974  ll --user -U pyt
+0000e380: 686f 6e2d 6d61 6769 6360 0a20 202a 206f  hon-magic`.  * o
+0000e390: 6e20 7769 6e64 6f77 7320 6772 6162 2074  n windows grab t
+0000e3a0: 6869 7320 696e 7374 6561 6420 6070 7974  his instead `pyt
+0000e3b0: 686f 6e33 202d 6d20 7069 7020 696e 7374  hon3 -m pip inst
+0000e3c0: 616c 6c20 2d2d 7573 6572 202d 5520 7079  all --user -U py
+0000e3d0: 7468 6f6e 2d6d 6167 6963 2d62 696e 600a  thon-magic-bin`.
+0000e3e0: 0a0a 2323 2064 6174 6162 6173 6520 6c6f  ..## database lo
+0000e3f0: 6361 7469 6f6e 0a0a 696e 2d76 6f6c 756d  cation..in-volum
+0000e400: 6520 2860 2e68 6973 742f 7570 326b 2e64  e (`.hist/up2k.d
+0000e410: 6260 2c20 6465 6661 756c 7429 206f 7220  b`, default) or 
+0000e420: 736f 6d65 7768 6572 6520 656c 7365 0a0a  somewhere else..
+0000e430: 636f 7079 7061 7274 7920 6372 6561 7465  copyparty create
+0000e440: 7320 6120 7375 6266 6f6c 6465 7220 6e61  s a subfolder na
+0000e450: 6d65 6420 602e 6869 7374 6020 696e 7369  med `.hist` insi
+0000e460: 6465 2065 6163 6820 766f 6c75 6d65 2077  de each volume w
+0000e470: 6865 7265 2069 7420 7374 6f72 6573 2074  here it stores t
+0000e480: 6865 2064 6174 6162 6173 652c 2074 6875  he database, thu
+0000e490: 6d62 6e61 696c 732c 2061 6e64 2073 6f6d  mbnails, and som
+0000e4a0: 6520 6f74 6865 7220 7374 7566 660a 0a74  e other stuff..t
+0000e4b0: 6869 7320 6361 6e20 696e 7374 6561 6420  his can instead 
+0000e4c0: 6265 206b 6570 7420 696e 2061 2073 696e  be kept in a sin
+0000e4d0: 676c 6520 706c 6163 6520 7573 696e 6720  gle place using 
+0000e4e0: 7468 6520 602d 2d68 6973 7460 2061 7267  the `--hist` arg
+0000e4f0: 756d 656e 742c 206f 7220 7468 6520 6068  ument, or the `h
+0000e500: 6973 743d 6020 766f 6c66 6c61 672c 206f  ist=` volflag, o
+0000e510: 7220 6120 6d69 7820 6f66 2062 6f74 683a  r a mix of both:
+0000e520: 0a2a 2060 2d2d 6869 7374 207e 2f2e 6361  .* `--hist ~/.ca
+0000e530: 6368 652f 636f 7079 7061 7274 7920 2d76  che/copyparty -v
+0000e540: 207e 2f6d 7573 6963 3a3a 723a 632c 6869   ~/music::r:c,hi
+0000e550: 7374 3d2d 6020 7365 7473 2060 7e2f 2e63  st=-` sets `~/.c
+0000e560: 6163 6865 2f63 6f70 7970 6172 7479 6020  ache/copyparty` 
+0000e570: 6173 2074 6865 2064 6566 6175 6c74 2070  as the default p
+0000e580: 6c61 6365 2074 6f20 7075 7420 766f 6c75  lace to put volu
+0000e590: 6d65 2069 6e66 6f2c 2062 7574 2060 7e2f  me info, but `~/
+0000e5a0: 6d75 7369 6360 2067 6574 7320 7468 6520  music` gets the 
+0000e5b0: 7265 6775 6c61 7220 602e 6869 7374 6020  regular `.hist` 
+0000e5c0: 7375 6266 6f6c 6465 7220 2860 2d60 2072  subfolder (`-` r
+0000e5d0: 6573 746f 7265 7320 6465 6661 756c 7420  estores default 
+0000e5e0: 6265 6861 7669 6f72 290a 0a6e 6f74 653a  behavior)..note:
+0000e5f0: 0a2a 206d 6172 6b64 6f77 6e20 6564 6974  .* markdown edit
+0000e600: 7320 6172 6520 616c 7761 7973 2073 746f  s are always sto
+0000e610: 7265 6420 696e 2061 206c 6f63 616c 2060  red in a local `
+0000e620: 2e68 6973 7460 2073 7562 6469 7265 6374  .hist` subdirect
+0000e630: 6f72 790a 2a20 6f6e 2077 696e 646f 7773  ory.* on windows
+0000e640: 2074 6865 2076 6f6c 666c 6167 2070 6174   the volflag pat
+0000e650: 6820 6973 2063 7967 6c69 6b65 2c20 736f  h is cyglike, so
+0000e660: 2060 2f63 2f74 656d 7060 206d 6561 6e73   `/c/temp` means
+0000e670: 2060 433a 5c74 656d 7060 2062 7574 2075   `C:\temp` but u
+0000e680: 7365 2072 6567 756c 6172 2070 6174 6873  se regular paths
+0000e690: 2066 6f72 2060 2d2d 6869 7374 600a 2020   for `--hist`.  
+0000e6a0: 2a20 796f 7520 6361 6e20 7573 6520 6379  * you can use cy
+0000e6b0: 6770 6174 6873 2066 6f72 2076 6f6c 756d  gpaths for volum
+0000e6c0: 6573 2074 6f6f 2c20 602d 7620 433a 5c55  es too, `-v C:\U
+0000e6d0: 7365 7273 3a3a 7260 2061 6e64 2060 2d76  sers::r` and `-v
+0000e6e0: 202f 632f 7573 6572 733a 3a72 6020 626f   /c/users::r` bo
+0000e6f0: 7468 2077 6f72 6b0a 0a0a 2323 206d 6574  th work...## met
+0000e700: 6164 6174 6120 6672 6f6d 2061 7564 696f  adata from audio
+0000e710: 2066 696c 6573 0a0a 7365 7420 602d 6532   files..set `-e2
+0000e720: 7460 2074 6f20 696e 6465 7820 7461 6773  t` to index tags
+0000e730: 206f 6e20 7570 6c6f 6164 0a0a 602d 6d74   on upload..`-mt
+0000e740: 6560 2064 6563 6964 6573 2077 6869 6368  e` decides which
+0000e750: 2074 6167 7320 746f 2069 6e64 6578 2061   tags to index a
+0000e760: 6e64 2064 6973 706c 6179 2069 6e20 7468  nd display in th
+0000e770: 6520 6272 6f77 7365 7220 2861 6e64 2061  e browser (and a
+0000e780: 6c73 6f20 7468 6520 6469 7370 6c61 7920  lso the display 
+0000e790: 6f72 6465 7229 2c20 7468 6973 2063 616e  order), this can
+0000e7a0: 2062 6520 6368 616e 6765 6420 7065 722d   be changed per-
+0000e7b0: 766f 6c75 6d65 3a0a 2a20 602d 7620 7e2f  volume:.* `-v ~/
+0000e7c0: 6d75 7369 633a 3a72 3a63 2c6d 7465 3d74  music::r:c,mte=t
+0000e7d0: 6974 6c65 2c61 7274 6973 7460 2069 6e64  itle,artist` ind
+0000e7e0: 6578 6573 2061 6e64 2064 6973 706c 6179  exes and display
+0000e7f0: 7320 2a74 6974 6c65 2a20 666f 6c6c 6f77  s *title* follow
+0000e800: 6564 2062 7920 2a61 7274 6973 742a 0a0a  ed by *artist*..
+0000e810: 6966 2079 6f75 2061 6464 2f72 656d 6f76  if you add/remov
+0000e820: 6520 6120 7461 6720 6672 6f6d 2060 6d74  e a tag from `mt
+0000e830: 6560 2079 6f75 2077 696c 6c20 6e65 6564  e` you will need
+0000e840: 2074 6f20 7275 6e20 7769 7468 2060 2d65   to run with `-e
+0000e850: 3274 7372 6020 6f6e 6365 2074 6f20 7265  2tsr` once to re
+0000e860: 6275 696c 6420 7468 6520 6461 7461 6261  build the databa
+0000e870: 7365 2c20 6f74 6865 7277 6973 6520 6f6e  se, otherwise on
+0000e880: 6c79 206e 6577 2066 696c 6573 2077 696c  ly new files wil
+0000e890: 6c20 6265 2061 6666 6563 7465 640a 0a62  l be affected..b
+0000e8a0: 7574 2069 6e73 7465 6164 206f 6620 7573  ut instead of us
+0000e8b0: 696e 6720 602d 6d74 6560 2c20 602d 6d74  ing `-mte`, `-mt
+0000e8c0: 6860 2069 7320 6120 6265 7474 6572 2077  h` is a better w
+0000e8d0: 6179 2074 6f20 6869 6465 2074 6167 7320  ay to hide tags 
+0000e8e0: 696e 2074 6865 2062 726f 7773 6572 3a20  in the browser: 
+0000e8f0: 7468 6573 6520 7461 6773 2077 696c 6c20  these tags will 
+0000e900: 6e6f 7420 6265 2064 6973 706c 6179 6564  not be displayed
+0000e910: 2062 7920 6465 6661 756c 742c 2062 7574   by default, but
+0000e920: 2074 6865 7920 7374 696c 6c20 6765 7420   they still get 
+0000e930: 696e 6465 7865 6420 616e 6420 6265 636f  indexed and beco
+0000e940: 6d65 2073 6561 7263 6861 626c 652c 2061  me searchable, a
+0000e950: 6e64 2075 7365 7273 2063 616e 2063 686f  nd users can cho
+0000e960: 6f73 6520 746f 2075 6e68 6964 6520 7468  ose to unhide th
+0000e970: 656d 2069 6e20 7468 6520 605b e29a 99ef  em in the `[....
+0000e980: b88f 5d20 636f 6e66 6967 6020 7061 6e65  ..] config` pane
+0000e990: 0a0a 602d 6d74 6d60 2063 616e 2062 6520  ..`-mtm` can be 
+0000e9a0: 7573 6564 2074 6f20 6164 6420 6f72 2072  used to add or r
+0000e9b0: 6564 6566 696e 6520 6120 6d65 7461 6461  edefine a metada
+0000e9c0: 7461 206d 6170 7069 6e67 2c20 7361 7920  ta mapping, say 
+0000e9d0: 796f 7520 6861 7665 206d 6564 6961 2066  you have media f
+0000e9e0: 696c 6573 2077 6974 6820 6066 6f6f 6020  iles with `foo` 
+0000e9f0: 616e 6420 6062 6172 6020 7461 6773 2061  and `bar` tags a
+0000ea00: 6e64 2079 6f75 2077 616e 7420 7468 656d  nd you want them
+0000ea10: 2074 6f20 6469 7370 6c61 7920 6173 2060   to display as `
+0000ea20: 7175 7860 2069 6e20 7468 6520 6272 6f77  qux` in the brow
+0000ea30: 7365 7220 2870 7265 6665 7272 696e 6720  ser (preferring 
+0000ea40: 6066 6f6f 6020 6966 2062 6f74 6820 6172  `foo` if both ar
+0000ea50: 6520 7072 6573 656e 7429 2c20 7468 656e  e present), then
+0000ea60: 2064 6f20 602d 6d74 6d20 7175 783d 666f   do `-mtm qux=fo
+0000ea70: 6f2c 6261 7260 2061 6e64 206e 6f77 2079  o,bar` and now y
+0000ea80: 6f75 2063 616e 2060 2d6d 7465 2061 7274  ou can `-mte art
+0000ea90: 6973 742c 7469 746c 652c 7175 7860 0a0a  ist,title,qux`..
+0000eaa0: 7461 6773 2074 6861 7420 7374 6172 7420  tags that start 
+0000eab0: 7769 7468 2061 2060 2e60 2073 7563 6820  with a `.` such 
+0000eac0: 6173 2060 2e62 706d 6020 616e 6420 602e  as `.bpm` and `.
+0000ead0: 6475 7260 2861 7469 6f6e 2920 696e 6469  dur`(ation) indi
+0000eae0: 6361 7465 206e 756d 6572 6963 2076 616c  cate numeric val
+0000eaf0: 7565 0a0a 7365 6520 7468 6520 6265 6175  ue..see the beau
+0000eb00: 7469 6675 6c20 6d65 7373 206f 6620 6120  tiful mess of a 
+0000eb10: 6469 6374 696f 6e61 7279 2069 6e20 5b6d  dictionary in [m
+0000eb20: 7461 672e 7079 5d28 6874 7470 733a 2f2f  tag.py](https://
+0000eb30: 6769 7468 7562 2e63 6f6d 2f39 3030 312f  github.com/9001/
+0000eb40: 636f 7079 7061 7274 792f 626c 6f62 2f68  copyparty/blob/h
+0000eb50: 6f76 7564 7374 7261 756d 2f63 6f70 7970  ovudstraum/copyp
+0000eb60: 6172 7479 2f6d 7461 672e 7079 2920 666f  arty/mtag.py) fo
+0000eb70: 7220 7468 6520 6465 6661 756c 7420 6d61  r the default ma
+0000eb80: 7070 696e 6773 2028 7368 6f75 6c64 2063  ppings (should c
+0000eb90: 6f76 6572 206d 7033 2c6f 7075 732c 666c  over mp3,opus,fl
+0000eba0: 6163 2c6d 3461 2c77 6176 2c61 6966 2c29  ac,m4a,wav,aif,)
+0000ebb0: 0a0a 602d 2d6e 6f2d 6d75 7461 6765 6e60  ..`--no-mutagen`
+0000ebc0: 2064 6973 6162 6c65 7320 4d75 7461 6765   disables Mutage
+0000ebd0: 6e20 616e 6420 7573 6573 2046 4670 726f  n and uses FFpro
+0000ebe0: 6265 2069 6e73 7465 6164 2c20 7768 6963  be instead, whic
+0000ebf0: 682e 2e2e 0a2a 2069 7320 6162 6f75 7420  h....* is about 
+0000ec00: 3230 7820 736c 6f77 6572 2074 6861 6e20  20x slower than 
+0000ec10: 4d75 7461 6765 6e0a 2a20 6361 7463 6865  Mutagen.* catche
+0000ec20: 7320 6120 6665 7720 7461 6773 2074 6861  s a few tags tha
+0000ec30: 7420 4d75 7461 6765 6e20 646f 6573 6e27  t Mutagen doesn'
+0000ec40: 740a 2020 2a20 6d65 6c6f 6469 6320 6b65  t.  * melodic ke
+0000ec50: 792c 2076 6964 656f 2072 6573 6f6c 7574  y, video resolut
+0000ec60: 696f 6e2c 2066 7261 6d65 7261 7465 2c20  ion, framerate, 
+0000ec70: 7069 7866 6d74 0a2a 2061 766f 6964 7320  pixfmt.* avoids 
+0000ec80: 7075 6c6c 696e 6720 616e 7920 4750 4c20  pulling any GPL 
+0000ec90: 636f 6465 2069 6e74 6f20 636f 7079 7061  code into copypa
+0000eca0: 7274 790a 2a20 6d6f 7265 2069 6d70 6f72  rty.* more impor
+0000ecb0: 7461 6e74 6c79 2072 756e 7320 4646 7072  tantly runs FFpr
+0000ecc0: 6f62 6520 6f6e 2069 6e63 6f6d 696e 6720  obe on incoming 
+0000ecd0: 6669 6c65 7320 7768 6963 6820 6973 2062  files which is b
+0000ece0: 6164 2069 6620 796f 7572 2046 466d 7065  ad if your FFmpe
+0000ecf0: 6720 6861 7320 6120 6376 650a 0a60 2d2d  g has a cve..`--
+0000ed00: 6d74 6167 2d74 6f60 2073 6574 7320 7468  mtag-to` sets th
+0000ed10: 6520 7461 672d 7363 616e 2074 696d 656f  e tag-scan timeo
+0000ed20: 7574 3b20 7665 7279 2068 6967 6820 6465  ut; very high de
+0000ed30: 6661 756c 7420 2836 3020 7365 6329 2074  fault (60 sec) t
+0000ed40: 6f20 6361 7465 7220 666f 7220 7a66 7320  o cater for zfs 
+0000ed50: 616e 6420 6f74 6865 7220 7261 6e64 6f6d  and other random
+0000ed60: 6c79 2d66 7265 657a 696e 6720 6669 6c65  ly-freezing file
+0000ed70: 7379 7374 656d 732e 204c 6f77 6572 2076  systems. Lower v
+0000ed80: 616c 7565 7320 6c69 6b65 2031 3020 6172  alues like 10 ar
+0000ed90: 6520 7573 7561 6c6c 7920 7361 6665 2c20  e usually safe, 
+0000eda0: 616c 6c6f 7769 6e67 2066 6f72 2066 6173  allowing for fas
+0000edb0: 7465 7220 7072 6f63 6573 7369 6e67 206f  ter processing o
+0000edc0: 6620 7472 6963 6b79 2066 696c 6573 0a0a  f tricky files..
+0000edd0: 0a23 2320 6669 6c65 2070 6172 7365 7220  .## file parser 
+0000ede0: 706c 7567 696e 730a 0a70 726f 7669 6465  plugins..provide
+0000edf0: 2063 7573 746f 6d20 7061 7273 6572 7320   custom parsers 
+0000ee00: 746f 2069 6e64 6578 2061 6464 6974 696f  to index additio
+0000ee10: 6e61 6c20 7461 6773 2c20 2061 6c73 6f20  nal tags,  also 
+0000ee20: 7365 6520 5b2e 2f62 696e 2f6d 7461 672f  see [./bin/mtag/
+0000ee30: 5245 4144 4d45 2e6d 645d 282e 2f62 696e  README.md](./bin
+0000ee40: 2f6d 7461 672f 5245 4144 4d45 2e6d 6429  /mtag/README.md)
+0000ee50: 0a0a 636f 7079 7061 7274 7920 6361 6e20  ..copyparty can 
+0000ee60: 696e 766f 6b65 2065 7874 6572 6e61 6c20  invoke external 
+0000ee70: 7072 6f67 7261 6d73 2074 6f20 636f 6c6c  programs to coll
+0000ee80: 6563 7420 6164 6469 7469 6f6e 616c 206d  ect additional m
+0000ee90: 6574 6164 6174 6120 666f 7220 6669 6c65  etadata for file
+0000eea0: 7320 7573 696e 6720 606d 7470 6020 2865  s using `mtp` (e
+0000eeb0: 6974 6865 7220 6173 2061 7267 756d 656e  ither as argumen
+0000eec0: 7420 6f72 2076 6f6c 666c 6167 292c 2074  t or volflag), t
+0000eed0: 6865 7265 2069 7320 6120 6465 6661 756c  here is a defaul
+0000eee0: 7420 7469 6d65 6f75 7420 6f66 2036 3073  t timeout of 60s
+0000eef0: 6563 2c20 616e 6420 6f6e 6c79 2066 696c  ec, and only fil
+0000ef00: 6573 2077 6869 6368 2063 6f6e 7461 696e  es which contain
+0000ef10: 2061 7564 696f 2067 6574 2061 6e61 6c79   audio get analy
+0000ef20: 7a65 6420 6279 2064 6566 6175 6c74 2028  zed by default (
+0000ef30: 7365 6520 6179 2f61 6e2f 6164 2062 656c  see ay/an/ad bel
+0000ef40: 6f77 290a 0a2a 2060 2d6d 7470 202e 6270  ow)..* `-mtp .bp
+0000ef50: 6d3d 7e2f 6269 6e2f 6175 6469 6f2d 6270  m=~/bin/audio-bp
+0000ef60: 6d2e 7079 6020 7769 6c6c 2065 7865 6375  m.py` will execu
+0000ef70: 7465 2060 7e2f 6269 6e2f 6175 6469 6f2d  te `~/bin/audio-
+0000ef80: 6270 6d2e 7079 6020 7769 7468 2074 6865  bpm.py` with the
+0000ef90: 2061 7564 696f 2066 696c 6520 6173 2061   audio file as a
+0000efa0: 7267 756d 656e 7420 3120 746f 2070 726f  rgument 1 to pro
+0000efb0: 7669 6465 2074 6865 2060 2e62 706d 6020  vide the `.bpm` 
+0000efc0: 7461 672c 2069 6620 7468 6174 2064 6f65  tag, if that doe
+0000efd0: 7320 6e6f 7420 6578 6973 7420 696e 2074  s not exist in t
+0000efe0: 6865 2061 7564 696f 206d 6574 6164 6174  he audio metadat
+0000eff0: 610a 2a20 602d 6d74 7020 6b65 793d 662c  a.* `-mtp key=f,
+0000f000: 7435 2c7e 2f62 696e 2f61 7564 696f 2d6b  t5,~/bin/audio-k
+0000f010: 6579 2e70 7960 2075 7365 7320 607e 2f62  ey.py` uses `~/b
+0000f020: 696e 2f61 7564 696f 2d6b 6579 2e70 7960  in/audio-key.py`
+0000f030: 2074 6f20 6765 7420 7468 6520 606b 6579   to get the `key
+0000f040: 6020 7461 672c 2072 6570 6c61 6369 6e67  ` tag, replacing
+0000f050: 2061 6e79 2065 7869 7374 696e 6720 6d65   any existing me
+0000f060: 7461 6461 7461 2074 6167 2028 6066 2c60  tadata tag (`f,`
+0000f070: 292c 2061 626f 7274 696e 6720 6966 2069  ), aborting if i
+0000f080: 7420 7461 6b65 7320 6c6f 6e67 6572 2074  t takes longer t
+0000f090: 6861 6e20 3573 6563 2028 6074 352c 6029  han 5sec (`t5,`)
+0000f0a0: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
+0000f0b0: 723a 632c 6d74 703d 2e62 706d 3d7e 2f62  r:c,mtp=.bpm=~/b
+0000f0c0: 696e 2f61 7564 696f 2d62 706d 2e70 793a  in/audio-bpm.py:
+0000f0d0: 632c 6d74 703d 6b65 793d 662c 7435 2c7e  c,mtp=key=f,t5,~
+0000f0e0: 2f62 696e 2f61 7564 696f 2d6b 6579 2e70  /bin/audio-key.p
+0000f0f0: 7960 2062 6f74 6820 6173 2061 2070 6572  y` both as a per
+0000f100: 2d76 6f6c 756d 6520 636f 6e66 6967 2077  -volume config w
+0000f110: 6f77 2074 6869 7320 6973 2067 6574 7469  ow this is getti
+0000f120: 6e67 2075 676c 790a 0a2a 6275 7420 7761  ng ugly..*but wa
+0000f130: 6974 2c20 7468 6572 6527 7320 6d6f 7265  it, there's more
+0000f140: 212a 2060 2d6d 7470 6020 6361 6e20 6265  !* `-mtp` can be
+0000f150: 2075 7365 6420 666f 7220 6e6f 6e2d 6175   used for non-au
+0000f160: 6469 6f20 6669 6c65 7320 6173 2077 656c  dio files as wel
+0000f170: 6c20 7573 696e 6720 7468 6520 6061 6020  l using the `a` 
+0000f180: 666c 6167 3a20 6061 7960 206f 6e6c 7920  flag: `ay` only 
+0000f190: 646f 2061 7564 696f 2066 696c 6573 2028  do audio files (
+0000f1a0: 6465 6661 756c 7429 2c20 6061 6e60 206f  default), `an` o
+0000f1b0: 6e6c 7920 646f 206e 6f6e 2d61 7564 696f  nly do non-audio
+0000f1c0: 2066 696c 6573 2c20 6f72 2060 6164 6020   files, or `ad` 
+0000f1d0: 646f 2061 6c6c 2066 696c 6573 2028 6420  do all files (d 
+0000f1e0: 6173 2069 6e20 646f 6e74 6361 7265 290a  as in dontcare).
+0000f1f0: 0a2a 2022 6175 6469 6f20 6669 6c65 2220  .* "audio file" 
+0000f200: 616c 736f 206d 6561 6e73 2076 6964 656f  also means video
+0000f210: 7320 6274 772c 2061 7320 6c6f 6e67 2061  s btw, as long a
+0000f220: 7320 7468 6572 6520 6973 2061 6e20 6175  s there is an au
+0000f230: 6469 6f20 7374 7265 616d 0a2a 2060 2d6d  dio stream.* `-m
+0000f240: 7470 2065 7874 3d61 6e2c 7e2f 6269 6e2f  tp ext=an,~/bin/
+0000f250: 6669 6c65 2d65 7874 2e70 7960 2072 756e  file-ext.py` run
+0000f260: 7320 607e 2f62 696e 2f66 696c 652d 6578  s `~/bin/file-ex
+0000f270: 742e 7079 6020 746f 2067 6574 2074 6865  t.py` to get the
+0000f280: 2060 6578 7460 2074 6167 206f 6e6c 7920   `ext` tag only 
+0000f290: 6966 2066 696c 6520 6973 206e 6f74 2061  if file is not a
+0000f2a0: 7564 696f 2028 6061 6e60 290a 2a20 602d  udio (`an`).* `-
+0000f2b0: 6d74 7020 6172 6368 2c62 7569 6c74 2c76  mtp arch,built,v
+0000f2c0: 6572 2c6f 7269 673d 616e 2c65 6578 652c  er,orig=an,eexe,
+0000f2d0: 6564 6c6c 2c7e 2f62 696e 2f65 7865 2e70  edll,~/bin/exe.p
+0000f2e0: 7960 2072 756e 7320 607e 2f62 696e 2f65  y` runs `~/bin/e
+0000f2f0: 7865 2e70 7960 2074 6f20 6765 7420 7072  xe.py` to get pr
+0000f300: 6f70 6572 7469 6573 2061 626f 7574 2077  operties about w
+0000f310: 696e 646f 7773 2d62 696e 6172 6965 7320  indows-binaries 
+0000f320: 6f6e 6c79 2069 6620 6669 6c65 2069 7320  only if file is 
+0000f330: 6e6f 7420 6175 6469 6f20 2860 616e 6029  not audio (`an`)
+0000f340: 2061 6e64 2066 696c 6520 6578 7465 6e73   and file extens
+0000f350: 696f 6e20 6973 2065 7865 206f 7220 646c  ion is exe or dl
+0000f360: 6c0a 2a20 6966 2079 6f75 2077 616e 7420  l.* if you want 
+0000f370: 746f 2064 6169 7379 6368 6169 6e20 7061  to daisychain pa
+0000f380: 7273 6572 732c 2075 7365 2074 6865 2060  rsers, use the `
+0000f390: 7060 2066 6c61 6720 746f 2073 6574 2070  p` flag to set p
+0000f3a0: 726f 6365 7373 696e 6720 6f72 6465 720a  rocessing order.
+0000f3b0: 2020 2a20 602d 6d74 7020 666f 6f3d 7031    * `-mtp foo=p1
+0000f3c0: 2c7e 2f61 2e70 7960 2072 756e 7320 6265  ,~/a.py` runs be
+0000f3d0: 666f 7265 2060 2d6d 7470 2066 6f6f 3d70  fore `-mtp foo=p
+0000f3e0: 322c 7e2f 622e 7079 6020 616e 6420 7769  2,~/b.py` and wi
+0000f3f0: 6c6c 2066 6f72 7761 7264 2061 6c6c 2074  ll forward all t
+0000f400: 6865 2074 6167 7320 6465 7465 6374 6564  he tags detected
+0000f410: 2073 6f20 6661 7220 6173 206a 736f 6e20   so far as json 
+0000f420: 746f 2074 6865 2073 7464 696e 206f 6620  to the stdin of 
+0000f430: 622e 7079 0a2a 206f 7074 696f 6e20 6063  b.py.* option `c
+0000f440: 3060 2064 6973 6162 6c65 7320 6361 7074  0` disables capt
+0000f450: 7572 696e 6720 6f66 2073 7464 6f75 742f  uring of stdout/
+0000f460: 7374 6465 7272 2c20 736f 2063 6f70 7970  stderr, so copyp
+0000f470: 6172 7479 2077 696c 6c20 6e6f 7420 7265  arty will not re
+0000f480: 6365 6976 6520 616e 7920 7461 6773 2066  ceive any tags f
+0000f490: 726f 6d20 7468 6520 7072 6f63 6573 7320  rom the process 
+0000f4a0: 6174 2061 6c6c 202d 2d20 696e 7374 6561  at all -- instea
+0000f4b0: 6420 7468 6520 696e 766f 6b65 6420 7072  d the invoked pr
+0000f4c0: 6f67 7261 6d20 6973 2066 7265 6520 746f  ogram is free to
+0000f4d0: 2070 7269 6e74 2077 6861 7465 7665 7220   print whatever 
+0000f4e0: 746f 2074 6865 2063 6f6e 736f 6c65 2c20  to the console, 
+0000f4f0: 6a75 7374 2075 7369 6e67 2063 6f70 7970  just using copyp
+0000f500: 6172 7479 2061 7320 6120 6c61 756e 6368  arty as a launch
+0000f510: 6572 0a20 202a 2060 6331 6020 6361 7074  er.  * `c1` capt
+0000f520: 7572 6573 2073 7464 6f75 7420 6f6e 6c79  ures stdout only
+0000f530: 2c20 6063 3260 206f 6e6c 7920 7374 6465  , `c2` only stde
+0000f540: 7272 2c20 616e 6420 6063 3360 2028 6465  rr, and `c3` (de
+0000f550: 6661 756c 7429 2063 6170 7475 7265 7320  fault) captures 
+0000f560: 626f 7468 0a2a 2079 6f75 2063 616e 2063  both.* you can c
+0000f570: 6f6e 7472 6f6c 2068 6f77 2074 6865 2070  ontrol how the p
+0000f580: 6172 7365 7220 6973 206b 696c 6c65 6420  arser is killed 
+0000f590: 6966 2069 7420 7469 6d65 7320 6f75 7420  if it times out 
+0000f5a0: 7769 7468 206f 7074 696f 6e20 606b 7460  with option `kt`
+0000f5b0: 206b 696c 6c69 6e67 2074 6865 2065 6e74   killing the ent
+0000f5c0: 6972 6520 7072 6f63 6573 7320 7472 6565  ire process tree
+0000f5d0: 2028 6465 6661 756c 7429 2c20 606b 6d60   (default), `km`
+0000f5e0: 206a 7573 7420 7468 6520 6d61 696e 2070   just the main p
+0000f5f0: 726f 6365 7373 2c20 6f72 2060 6b6e 6020  rocess, or `kn` 
+0000f600: 6c65 7420 6974 2063 6f6e 7469 6e75 6520  let it continue 
+0000f610: 7275 6e6e 696e 6720 756e 7469 6c20 636f  running until co
+0000f620: 7079 7061 7274 7920 6973 2074 6572 6d69  pyparty is termi
+0000f630: 6e61 7465 640a 0a69 6620 736f 6d65 7468  nated..if someth
+0000f640: 696e 6720 646f 6573 6e27 7420 776f 726b  ing doesn't work
+0000f650: 2c20 7472 7920 602d 2d6d 7461 672d 7660  , try `--mtag-v`
+0000f660: 2066 6f72 2076 6572 626f 7365 2065 7272   for verbose err
+0000f670: 6f72 206d 6573 7361 6765 730a 0a0a 2323  or messages...##
+0000f680: 2065 7665 6e74 2068 6f6f 6b73 0a0a 7472   event hooks..tr
+0000f690: 6967 6765 7220 6120 7072 6f67 7261 6d20  igger a program 
+0000f6a0: 6f6e 2075 706c 6f61 6473 2c20 7265 6e61  on uploads, rena
+0000f6b0: 6d65 7320 6574 6320 285b 6578 616d 706c  mes etc ([exampl
+0000f6c0: 6573 5d28 2e2f 6269 6e2f 686f 6f6b 732f  es](./bin/hooks/
+0000f6d0: 2929 0a0a 796f 7520 6361 6e20 7365 7420  ))..you can set 
+0000f6e0: 686f 6f6b 7320 6265 666f 7265 2061 6e64  hooks before and
+0000f6f0: 2f6f 7220 6166 7465 7220 616e 2065 7665  /or after an eve
+0000f700: 6e74 2068 6170 7065 6e73 2c20 616e 6420  nt happens, and 
+0000f710: 6375 7272 656e 746c 7920 796f 7520 6361  currently you ca
+0000f720: 6e20 686f 6f6b 2075 706c 6f61 6473 2c20  n hook uploads, 
+0000f730: 6d6f 7665 732f 7265 6e61 6d65 732c 2061  moves/renames, a
+0000f740: 6e64 2064 656c 6574 6573 0a0a 7468 6572  nd deletes..ther
+0000f750: 6527 7320 6120 6275 6e63 6820 6f66 2066  e's a bunch of f
+0000f760: 6c61 6773 2061 6e64 2073 7475 6666 2c20  lags and stuff, 
+0000f770: 7365 6520 602d 2d68 656c 702d 686f 6f6b  see `--help-hook
+0000f780: 7360 0a0a 0a23 2323 2075 706c 6f61 6420  s`...### upload 
+0000f790: 6576 656e 7473 0a0a 7468 6520 6f6c 6465  events..the olde
+0000f7a0: 722c 206d 6f72 6520 706f 7765 7266 756c  r, more powerful
+0000f7b0: 2061 7070 726f 6163 6820 285b 6578 616d   approach ([exam
+0000f7c0: 706c 6573 5d28 2e2f 6269 6e2f 6d74 6167  ples](./bin/mtag
+0000f7d0: 2f29 293a 0a0a 6060 600a 2d76 202f 6d6e  /)):..```.-v /mn
+0000f7e0: 742f 696e 633a 696e 633a 773a 632c 6d74  t/inc:inc:w:c,mt
+0000f7f0: 653d 2b78 313a 632c 6d74 703d 7831 3d61  e=+x1:c,mtp=x1=a
+0000f800: 642c 6b6e 2c2f 7573 722f 6269 6e2f 6e6f  d,kn,/usr/bin/no
+0000f810: 7469 6679 2d73 656e 640a 6060 600a 0a73  tify-send.```..s
+0000f820: 6f20 6669 6c65 7379 7374 656d 206c 6f63  o filesystem loc
+0000f830: 6174 696f 6e20 602f 6d6e 742f 696e 6360  ation `/mnt/inc`
+0000f840: 2073 6861 7265 6420 6174 2060 2f69 6e63   shared at `/inc
+0000f850: 602c 2077 7269 7465 2d6f 6e6c 7920 666f  `, write-only fo
+0000f860: 7220 6576 6572 796f 6e65 2c20 6170 7065  r everyone, appe
+0000f870: 6e64 696e 6720 6078 3160 2074 6f20 7468  nding `x1` to th
+0000f880: 6520 6c69 7374 206f 6620 7461 6773 2074  e list of tags t
+0000f890: 6f20 696e 6465 7820 2860 6d74 6560 292c  o index (`mte`),
+0000f8a0: 2061 6e64 2075 7369 6e67 2060 2f75 7372   and using `/usr
+0000f8b0: 2f62 696e 2f6e 6f74 6966 792d 7365 6e64  /bin/notify-send
+0000f8c0: 6020 746f 2022 7072 6f76 6964 6522 2074  ` to "provide" t
+0000f8d0: 6167 2060 7831 6020 666f 7220 616e 7920  ag `x1` for any 
+0000f8e0: 6669 6c65 7479 7065 2028 6061 6460 2920  filetype (`ad`) 
+0000f8f0: 7769 7468 206b 696c 6c2d 6f6e 2d74 696d  with kill-on-tim
+0000f900: 656f 7574 2064 6973 6162 6c65 6420 2860  eout disabled (`
+0000f910: 6b6e 6029 0a0a 7468 6174 276c 6c20 7275  kn`)..that'll ru
+0000f920: 6e20 7468 6520 636f 6d6d 616e 6420 606e  n the command `n
+0000f930: 6f74 6966 792d 7365 6e64 6020 7769 7468  otify-send` with
+0000f940: 2074 6865 2070 6174 6820 746f 2074 6865   the path to the
+0000f950: 2075 706c 6f61 6465 6420 6669 6c65 2061   uploaded file a
+0000f960: 7320 7468 6520 6669 7273 7420 616e 6420  s the first and 
+0000f970: 6f6e 6c79 2061 7267 756d 656e 7420 2873  only argument (s
+0000f980: 6f20 6f6e 206c 696e 7578 2069 7427 6c6c  o on linux it'll
+0000f990: 2073 686f 7720 6120 6e6f 7469 6669 6361   show a notifica
+0000f9a0: 7469 6f6e 206f 6e2d 7363 7265 656e 290a  tion on-screen).
+0000f9b0: 0a6e 6f74 6520 7468 6174 2074 6869 7320  .note that this 
+0000f9c0: 6973 2077 6179 206d 6f72 6520 636f 6d70  is way more comp
+0000f9d0: 6c69 6361 7465 6420 7468 616e 2074 6865  licated than the
+0000f9e0: 206e 6577 205b 6576 656e 7420 686f 6f6b   new [event hook
+0000f9f0: 735d 2823 6576 656e 742d 686f 6f6b 7329  s](#event-hooks)
+0000fa00: 2062 7574 2074 6869 7320 6170 7072 6f61   but this approa
+0000fa10: 6368 2068 6173 2074 6865 2066 6f6c 6c6f  ch has the follo
+0000fa20: 7769 6e67 2061 6476 616e 7461 6765 733a  wing advantages:
+0000fa30: 0a2a 206e 6f6e 2d62 6c6f 636b 696e 6720  .* non-blocking 
+0000fa40: 616e 6420 6d75 6c74 6974 6872 6561 6465  and multithreade
+0000fa50: 643b 2064 6f65 736e 2774 2068 6f6c 6420  d; doesn't hold 
+0000fa60: 6f74 6865 7220 7570 6c6f 6164 7320 6261  other uploads ba
+0000fa70: 636b 0a2a 2079 6f75 2067 6574 2061 6363  ck.* you get acc
+0000fa80: 6573 7320 746f 2074 6167 7320 6672 6f6d  ess to tags from
+0000fa90: 2046 466d 7065 6720 616e 6420 6f74 6865   FFmpeg and othe
+0000faa0: 7220 6d74 7020 7061 7273 6572 730a 2a20  r mtp parsers.* 
+0000fab0: 6f6e 6c79 2074 7269 6767 6572 206f 6e20  only trigger on 
+0000fac0: 6e65 7720 756e 6971 7565 2066 696c 6573  new unique files
+0000fad0: 2c20 6e6f 7420 6475 7065 730a 0a6e 6f74  , not dupes..not
+0000fae0: 6520 7468 6174 2069 7420 7769 6c6c 206f  e that it will o
+0000faf0: 6363 7570 7920 7468 6520 7061 7273 696e  ccupy the parsin
+0000fb00: 6720 7468 7265 6164 732c 2073 6f20 666f  g threads, so fo
+0000fb10: 726b 2061 6e79 7468 696e 6720 6578 7065  rk anything expe
+0000fb20: 6e73 6976 6520 286f 7220 7365 7420 606b  nsive (or set `k
+0000fb30: 6e60 2074 6f20 6861 7665 2063 6f70 7970  n` to have copyp
+0000fb40: 6172 7479 2066 6f72 6b20 6974 2066 6f72  arty fork it for
+0000fb50: 2079 6f75 2920 2d2d 206f 746f 6820 6966   you) -- otoh if
+0000fb60: 2079 6f75 2077 616e 7420 746f 2069 6e74   you want to int
+0000fb70: 656e 7469 6f6e 616c 6c79 2071 7565 7565  entionally queue
+0000fb80: 2f73 696e 676c 6574 6872 6561 6420 796f  /singlethread yo
+0000fb90: 7520 6361 6e20 636f 6d62 696e 6520 6974  u can combine it
+0000fba0: 2077 6974 6820 602d 2d6d 7461 672d 6d74   with `--mtag-mt
+0000fbb0: 2031 600a 0a0a 2323 2068 6964 696e 6720   1`...## hiding 
+0000fbc0: 6672 6f6d 2067 6f6f 676c 650a 0a74 656c  from google..tel
+0000fbd0: 6c20 7365 6172 6368 2065 6e67 696e 6573  l search engines
+0000fbe0: 2079 6f75 2064 6f6e 7420 7761 6e6e 6120   you dont wanna 
+0000fbf0: 6265 2069 6e64 6578 6564 2c20 2065 6974  be indexed,  eit
+0000fc00: 6865 7220 7573 696e 6720 7468 6520 676f  her using the go
+0000fc10: 6f64 206f 6c64 205b 726f 626f 7473 2e74  od old [robots.t
+0000fc20: 7874 5d28 6874 7470 733a 2f2f 7777 772e  xt](https://www.
+0000fc30: 726f 626f 7473 7478 742e 6f72 672f 726f  robotstxt.org/ro
+0000fc40: 626f 7473 7478 742e 6874 6d6c 2920 6f72  botstxt.html) or
+0000fc50: 2074 6872 6f75 6768 2063 6f70 7970 6172   through copypar
+0000fc60: 7479 2073 6574 7469 6e67 733a 0a0a 2a20  ty settings:..* 
+0000fc70: 602d 2d6e 6f2d 726f 626f 7473 6020 6164  `--no-robots` ad
+0000fc80: 6473 2048 5454 5020 2860 582d 526f 626f  ds HTTP (`X-Robo
+0000fc90: 7473 2d54 6167 6029 2061 6e64 2048 544d  ts-Tag`) and HTM
+0000fca0: 4c20 2860 3c6d 6574 613e 6029 2068 6561  L (`<meta>`) hea
+0000fcb0: 6465 7273 2077 6974 6820 606e 6f69 6e64  ders with `noind
+0000fcc0: 6578 2c20 6e6f 666f 6c6c 6f77 6020 676c  ex, nofollow` gl
+0000fcd0: 6f62 616c 6c79 0a2a 2076 6f6c 666c 6167  obally.* volflag
+0000fce0: 2060 5b2e 2e2e 5d3a 632c 6e6f 726f 626f   `[...]:c,norobo
+0000fcf0: 7473 6020 646f 6573 2074 6865 2073 616d  ts` does the sam
+0000fd00: 6520 7468 696e 6720 666f 7220 7468 6174  e thing for that
+0000fd10: 2073 696e 676c 6520 766f 6c75 6d65 0a2a   single volume.*
+0000fd20: 2076 6f6c 666c 6167 2060 5b2e 2e2e 5d3a   volflag `[...]:
+0000fd30: 632c 726f 626f 7473 6020 414c 4c4f 5753  c,robots` ALLOWS
+0000fd40: 2073 6561 7263 682d 656e 6769 6e65 2063   search-engine c
+0000fd50: 7261 776c 696e 6720 666f 7220 7468 6174  rawling for that
+0000fd60: 2076 6f6c 756d 652c 2065 7665 6e20 6966   volume, even if
+0000fd70: 2060 2d2d 6e6f 2d72 6f62 6f74 7360 2069   `--no-robots` i
+0000fd80: 7320 7365 7420 676c 6f62 616c 6c79 0a0a  s set globally..
+0000fd90: 616c 736f 2c20 602d 2d66 6f72 6365 2d6a  also, `--force-j
+0000fda0: 7360 2064 6973 6162 6c65 7320 7468 6520  s` disables the 
+0000fdb0: 706c 6169 6e20 4854 4d4c 2066 6f6c 6465  plain HTML folde
+0000fdc0: 7220 6c69 7374 696e 672c 206d 616b 696e  r listing, makin
+0000fdd0: 6720 7468 696e 6773 2068 6172 6465 7220  g things harder 
+0000fde0: 746f 2070 6172 7365 2066 6f72 2073 6561  to parse for sea
+0000fdf0: 7263 6820 656e 6769 6e65 730a 0a0a 2323  rch engines...##
+0000fe00: 2074 6865 6d65 730a 0a79 6f75 2063 616e   themes..you can
+0000fe10: 2063 6861 6e67 6520 7468 6520 6465 6661   change the defa
+0000fe20: 756c 7420 7468 656d 6520 7769 7468 2060  ult theme with `
+0000fe30: 2d2d 7468 656d 6520 3260 2c20 616e 6420  --theme 2`, and 
+0000fe40: 6164 6420 796f 7572 206f 776e 2074 6865  add your own the
+0000fe50: 6d65 7320 6279 206d 6f64 6966 7969 6e67  mes by modifying
+0000fe60: 2060 6272 6f77 7365 722e 6373 7360 206f   `browser.css` o
+0000fe70: 7220 7072 6f76 6964 696e 6720 796f 7572  r providing your
+0000fe80: 206f 776e 2063 7373 2074 6f20 602d 2d63   own css to `--c
+0000fe90: 7373 2d62 726f 7773 6572 602c 2074 6865  ss-browser`, the
+0000fea0: 6e20 7465 6c6c 696e 6720 636f 7079 7061  n telling copypa
+0000feb0: 7274 7920 7468 6579 2065 7869 7374 2062  rty they exist b
+0000fec0: 7920 696e 6372 6561 7369 6e67 2060 2d2d  y increasing `--
+0000fed0: 7468 656d 6573 600a 0a3c 7461 626c 653e  themes`..<table>
+0000fee0: 3c74 723e 3c74 6420 7769 6474 683d 2233  <tr><td width="3
+0000fef0: 3325 2220 616c 6967 6e3d 2263 656e 7465  3%" align="cente
+0000ff00: 7222 3e3c 6120 6872 6566 3d22 6874 7470  r"><a href="http
+0000ff10: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+0000ff20: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+0000ff30: 742e 636f 6d2f 3234 3130 3332 2f31 3635  t.com/241032/165
+0000ff40: 3836 3439 3037 2d31 3765 3261 6337 642d  864907-17e2ac7d-
+0000ff50: 3331 3964 2d34 6632 352d 3837 3138 2d32  319d-4f25-8718-2
+0000ff60: 6633 3736 6636 3134 6235 312e 706e 6722  f376f614b51.png"
+0000ff70: 3e3c 696d 6720 7372 633d 2268 7474 7073  ><img src="https
+0000ff80: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+0000ff90: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+0000ffa0: 2e63 6f6d 2f32 3431 3033 322f 3136 3538  .com/241032/1658
+0000ffb0: 3637 3535 312d 6663 6562 3335 6464 2d33  67551-fceb35dd-3
+0000ffc0: 3866 302d 3432 6262 2d62 6566 332d 3235  8f0-42bb-bef3-25
+0000ffd0: 6261 3635 3163 6136 3962 2e70 6e67 223e  ba651ca69b.png">
+0000ffe0: 3c2f 613e 0a30 2e20 636c 6173 7369 6320  </a>.0. classic 
+0000fff0: 6461 726b 3c2f 7464 3e3c 7464 2077 6964  dark</td><td wid
+00010000: 7468 3d22 3333 2522 2061 6c69 676e 3d22  th="33%" align="
+00010010: 6365 6e74 6572 223e 3c61 2068 7265 663d  center"><a href=
+00010020: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
+00010030: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00010040: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+00010050: 322f 3136 3836 3434 3339 392d 3638 3933  2/168644399-6893
+00010060: 3864 6535 2d64 6139 622d 3434 3566 2d38  8de5-da9b-445f-8
+00010070: 6439 322d 6235 3163 3734 6235 6633 3435  d92-b51c74b5f345
+00010080: 2e70 6e67 223e 3c69 6d67 2073 7263 3d22  .png"><img src="
+00010090: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
+000100a0: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
+000100b0: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
+000100c0: 2f31 3638 3634 3434 3034 2d38 6531 6132  /168644404-8e1a2
+000100d0: 6664 632d 3665 3539 2d34 6334 312d 3930  fdc-6e59-4c41-90
+000100e0: 3565 2d62 6135 3339 3965 6436 3836 662e  5e-ba5399ed686f.
+000100f0: 706e 6722 3e3c 2f61 3e0a 322e 2066 6c61  png"></a>.2. fla
+00010100: 7420 706d 2d6d 6f6e 6f6b 6169 3c2f 7464  t pm-monokai</td
+00010110: 3e3c 7464 2077 6964 7468 3d22 3333 2522  ><td width="33%"
+00010120: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
+00010130: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
+00010140: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+00010150: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+00010160: 6f6d 2f32 3431 3033 322f 3136 3538 3634  om/241032/165864
+00010170: 3930 312d 6462 3133 6134 3239 2d61 3564  901-db13a429-a5d
+00010180: 612d 3439 3664 2d38 6263 362d 6365 3833  a-496d-8bc6-ce83
+00010190: 3835 3437 6636 3964 2e70 6e67 223e 3c69  8547f69d.png"><i
+000101a0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+000101b0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+000101c0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+000101d0: 6d2f 3234 3130 3332 2f31 3635 3836 3735  m/241032/1658675
+000101e0: 3630 2d61 6138 3334 6165 662d 3538 6463  60-aa834aef-58dc
+000101f0: 2d34 6162 652d 6261 6566 2d37 6535 3632  -4abe-baef-7e562
+00010200: 6236 3437 3934 352e 706e 6722 3e3c 2f61  b647945.png"></a
+00010210: 3e0a 342e 2076 6963 653c 2f74 643e 3c2f  >.4. vice</td></
+00010220: 7472 3e3c 7472 3e3c 7464 2061 6c69 676e  tr><tr><td align
+00010230: 3d22 6365 6e74 6572 223e 3c61 2068 7265  ="center"><a hre
+00010240: 663d 2268 7474 7073 3a2f 2f75 7365 722d  f="https://user-
+00010250: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00010260: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00010270: 3033 322f 3136 3538 3634 3930 352d 3639  032/165864905-69
+00010280: 3236 3832 6562 2d36 6662 342d 3464 3430  2682eb-6fb4-4d40
+00010290: 2d62 3666 652d 3237 6432 6337 6433 6532  -b6fe-27d2c7d3e2
+000102a0: 6137 2e70 6e67 223e 3c69 6d67 2073 7263  a7.png"><img src
+000102b0: 3d22 6874 7470 733a 2f2f 7573 6572 2d69  ="https://user-i
+000102c0: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+000102d0: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+000102e0: 3332 2f31 3635 3836 3735 3535 2d30 3830  32/165867555-080
+000102f0: 6237 3362 362d 3664 3835 2d34 3162 622d  b73b6-6d85-41bb-
+00010300: 6137 6336 2d61 6432 3737 6336 3038 3336  a7c6-ad277c60836
+00010310: 352e 706e 6722 3e3c 2f61 3e0a 312e 2063  5.png"></a>.1. c
+00010320: 6c61 7373 6963 206c 6967 6874 3c2f 7464  lassic light</td
+00010330: 3e3c 7464 2061 6c69 676e 3d22 6365 6e74  ><td align="cent
+00010340: 6572 223e 3c61 2068 7265 663d 2268 7474  er"><a href="htt
+00010350: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00010360: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00010370: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
+00010380: 3836 3435 3237 362d 6662 3032 6664 3139  8645276-fb02fd19
+00010390: 2d31 3930 612d 3430 3761 2d62 3864 332d  -190a-407a-b8d3-
+000103a0: 6435 3866 6565 3237 3765 3032 2e70 6e67  d58fee277e02.png
+000103b0: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
+000103c0: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+000103d0: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+000103e0: 742e 636f 6d2f 3234 3130 3332 2f31 3638  t.com/241032/168
+000103f0: 3634 3532 3830 2d66 3036 3632 6233 632d  645280-f0662b3c-
+00010400: 3937 3634 2d34 3837 352d 6132 6532 2d64  9764-4875-a2e2-d
+00010410: 3931 6363 3831 3939 6232 332e 706e 6722  91cc8199b23.png"
+00010420: 3e3c 2f61 3e0a 332e 2066 6c61 7420 6c69  ></a>.3. flat li
+00010430: 6768 740a 3c2f 7464 3e3c 7464 2061 6c69  ght.</td><td ali
+00010440: 676e 3d22 6365 6e74 6572 223e 3c61 2068  gn="center"><a h
+00010450: 7265 663d 2268 7474 7073 3a2f 2f75 7365  ref="https://use
+00010460: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
+00010470: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
+00010480: 3431 3033 322f 3136 3538 3634 3839 382d  41032/165864898-
+00010490: 3130 6365 3730 3532 2d61 3131 372d 3466  10ce7052-a117-4f
+000104a0: 6366 2d38 3435 622d 6235 3663 3931 3638  cf-845b-b56c9168
+000104b0: 3739 3038 2e70 6e67 223e 3c69 6d67 2073  7908.png"><img s
+000104c0: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
+000104d0: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
+000104e0: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
+000104f0: 3130 3332 2f31 3635 3836 3735 3632 2d66  1032/165867562-f
+00010500: 3330 3033 6434 352d 6464 3261 2d34 3536  3003d45-dd2a-456
+00010510: 342d 3861 6165 2d66 6564 3434 6331 6165  4-8aae-fed44c1ae
+00010520: 3036 342e 706e 6722 3e3c 2f61 3e0a 352e  064.png"></a>.5.
+00010530: 203c 6120 6872 6566 3d22 6874 7470 733a   <a href="https:
+00010540: 2f2f 626c 6f67 2e63 6f64 696e 6768 6f72  //blog.codinghor
+00010550: 726f 722e 636f 6d2f 612d 7472 6962 7574  ror.com/a-tribut
+00010560: 652d 746f 2d74 6865 2d77 696e 646f 7773  e-to-the-windows
+00010570: 2d33 312d 686f 742d 646f 672d 7374 616e  -31-hot-dog-stan
+00010580: 642d 636f 6c6f 722d 7363 6865 6d65 2f22  d-color-scheme/"
+00010590: 3e68 6f74 646f 6720 7374 616e 643c 2f61  >hotdog stand</a
+000105a0: 3e3c 2f74 643e 3c2f 7472 3e3c 2f74 6162  ></td></tr></tab
+000105b0: 6c65 3e0a 0a74 6865 2063 6c61 7373 6e61  le>..the classna
+000105c0: 6d65 206f 6620 7468 6520 4854 4d4c 2074  me of the HTML t
+000105d0: 6167 2069 7320 7365 7420 6163 636f 7264  ag is set accord
+000105e0: 696e 6720 746f 2074 6865 2073 656c 6563  ing to the selec
+000105f0: 7465 6420 7468 656d 652c 2077 6869 6368  ted theme, which
+00010600: 2069 7320 7573 6564 2074 6f20 7365 7420   is used to set 
+00010610: 636f 6c6f 7273 2061 7320 6373 7320 7661  colors as css va
+00010620: 7269 6162 6c65 7320 2b2b 0a0a 2a20 6561  riables ++..* ea
+00010630: 6368 2074 6865 6d65 202a 6765 6e65 7261  ch theme *genera
+00010640: 6c6c 792a 2068 6173 2061 2064 6172 6b20  lly* has a dark 
+00010650: 7468 656d 6520 2865 7665 6e20 6e75 6d62  theme (even numb
+00010660: 6572 7329 2061 6e64 2061 206c 6967 6874  ers) and a light
+00010670: 2074 6865 6d65 2028 6f64 6420 6e75 6d62   theme (odd numb
+00010680: 6572 7329 2c20 7368 6f77 696e 6720 696e  ers), showing in
+00010690: 2070 6169 7273 0a2a 2074 6865 2066 6972   pairs.* the fir
+000106a0: 7374 2074 6865 6d65 2028 7468 656d 6520  st theme (theme 
+000106b0: 3020 616e 6420 3129 2069 7320 6068 746d  0 and 1) is `htm
+000106c0: 6c2e 6160 2c20 7365 636f 6e64 2074 6865  l.a`, second the
+000106d0: 6d65 2028 3220 616e 6420 3329 2069 7320  me (2 and 3) is 
+000106e0: 6068 746d 6c2e 6260 0a2a 2069 6620 6120  `html.b`.* if a 
+000106f0: 6c69 6768 7420 7468 656d 6520 6973 2073  light theme is s
+00010700: 656c 6563 7465 642c 2060 6874 6d6c 2e79  elected, `html.y
+00010710: 6020 6973 2073 6574 2c20 6f74 6865 7277  ` is set, otherw
+00010720: 6973 6520 6068 746d 6c2e 7a60 2069 730a  ise `html.z` is.
+00010730: 2a20 736f 2069 6620 7468 6520 6461 726b  * so if the dark
+00010740: 2065 6469 7469 6f6e 206f 6620 7468 6520   edition of the 
+00010750: 326e 6420 7468 656d 6520 6973 2073 656c  2nd theme is sel
+00010760: 6563 7465 642c 2079 6f75 2075 7365 2061  ected, you use a
+00010770: 6e79 206f 6620 6068 746d 6c2e 6260 2c20  ny of `html.b`, 
+00010780: 6068 746d 6c2e 7a60 2c20 6068 746d 6c2e  `html.z`, `html.
+00010790: 627a 6020 746f 2073 7065 6369 6679 2072  bz` to specify r
+000107a0: 756c 6573 0a0a 7365 6520 7468 6520 746f  ules..see the to
+000107b0: 7020 6f66 205b 2e2f 636f 7079 7061 7274  p of [./copypart
+000107c0: 792f 7765 622f 6272 6f77 7365 722e 6373  y/web/browser.cs
+000107d0: 735d 282e 2f63 6f70 7970 6172 7479 2f77  s](./copyparty/w
+000107e0: 6562 2f62 726f 7773 6572 2e63 7373 2920  eb/browser.css) 
+000107f0: 7768 6572 6520 7468 6520 636f 6c6f 7220  where the color 
+00010800: 7661 7269 6162 6c65 7320 6172 6520 7365  variables are se
+00010810: 742c 2061 6e64 2074 6865 7265 2773 206c  t, and there's l
+00010820: 6179 6f75 742d 7370 6563 6966 6963 2073  ayout-specific s
+00010830: 7475 6666 206e 6561 7220 7468 6520 626f  tuff near the bo
+00010840: 7474 6f6d 0a0a 0a23 2320 636f 6d70 6c65  ttom...## comple
+00010850: 7465 2065 7861 6d70 6c65 730a 0a2a 205b  te examples..* [
+00010860: 7275 6e6e 696e 6720 6f6e 2077 696e 646f  running on windo
+00010870: 7773 5d28 2e2f 646f 6373 2f65 7861 6d70  ws](./docs/examp
+00010880: 6c65 732f 7769 6e64 6f77 732e 6d64 290a  les/windows.md).
+00010890: 0a2a 2072 6561 642d 6f6e 6c79 206d 7573  .* read-only mus
+000108a0: 6963 2073 6572 7665 7220 200a 2020 6070  ic server  .  `p
+000108b0: 7974 686f 6e20 636f 7079 7061 7274 792d  ython copyparty-
+000108c0: 7366 782e 7079 202d 7620 2f6d 6e74 2f6e  sfx.py -v /mnt/n
+000108d0: 6173 2f6d 7573 6963 3a2f 6d75 7369 633a  as/music:/music:
+000108e0: 7220 2d65 3264 7361 202d 6532 7473 202d  r -e2dsa -e2ts -
+000108f0: 2d6e 6f2d 726f 626f 7473 202d 2d66 6f72  -no-robots --for
+00010900: 6365 2d6a 7320 2d2d 7468 656d 6520 3260  ce-js --theme 2`
+00010910: 0a20 200a 2020 2a20 2e2e 2e77 6974 6820  .  .  * ...with 
+00010920: 6270 6d20 616e 6420 6b65 7920 7363 616e  bpm and key scan
+00010930: 6e69 6e67 2020 0a20 2020 2060 2d6d 7470  ning  .    `-mtp
+00010940: 202e 6270 6d3d 662c 6175 6469 6f2d 6270   .bpm=f,audio-bp
+00010950: 6d2e 7079 202d 6d74 7020 6b65 793d 662c  m.py -mtp key=f,
+00010960: 6175 6469 6f2d 6b65 792e 7079 600a 2020  audio-key.py`.  
+00010970: 0a20 202a 202e 2e2e 7769 7468 2061 2072  .  * ...with a r
+00010980: 6561 642d 7772 6974 6520 666f 6c64 6572  ead-write folder
+00010990: 2066 6f72 2060 6b65 7669 6e60 2077 686f   for `kevin` who
+000109a0: 7365 2070 6173 7377 6f72 6420 6973 2060  se password is `
+000109b0: 6f6b 676f 6020 200a 2020 2020 602d 6120  okgo`  .    `-a 
+000109c0: 6b65 7669 6e3a 6f6b 676f 202d 7620 2f6d  kevin:okgo -v /m
+000109d0: 6e74 2f6e 6173 2f69 6e63 3a2f 696e 633a  nt/nas/inc:/inc:
+000109e0: 7277 2c6b 6576 696e 600a 2020 0a20 202a  rw,kevin`.  .  *
+000109f0: 202e 2e2e 7769 7468 206c 6f67 6769 6e67   ...with logging
+00010a00: 2074 6f20 6469 736b 2020 0a20 2020 2060   to disk  .    `
+00010a10: 2d6c 6f20 6c6f 672f 6370 702d 2559 2d25  -lo log/cpp-%Y-%
+00010a20: 6d25 642d 2548 254d 2553 2e74 7874 2e78  m%d-%H%M%S.txt.x
+00010a30: 7a60 0a0a 0a23 2320 7265 7665 7273 652d  z`...## reverse-
+00010a40: 7072 6f78 790a 0a72 756e 6e69 6e67 2063  proxy..running c
+00010a50: 6f70 7970 6172 7479 206e 6578 7420 746f  opyparty next to
+00010a60: 206f 7468 6572 2077 6562 7369 7465 7320   other websites 
+00010a70: 2068 6f73 7465 6420 6f6e 2061 6e20 6578   hosted on an ex
+00010a80: 6973 7469 6e67 2077 6562 7365 7276 6572  isting webserver
+00010a90: 2073 7563 6820 6173 206e 6769 6e78 2c20   such as nginx, 
+00010aa0: 6361 6464 792c 206f 7220 6170 6163 6865  caddy, or apache
+00010ab0: 0a0a 796f 7520 6361 6e20 6569 7468 6572  ..you can either
+00010ac0: 3a0a 2a20 6769 7665 2063 6f70 7970 6172  :.* give copypar
+00010ad0: 7479 2069 7473 206f 776e 2064 6f6d 6169  ty its own domai
+00010ae0: 6e20 6f72 2073 7562 646f 6d61 696e 2028  n or subdomain (
+00010af0: 7265 636f 6d6d 656e 6465 6429 0a2a 206f  recommended).* o
+00010b00: 7220 646f 206c 6f63 6174 696f 6e2d 6261  r do location-ba
+00010b10: 7365 6420 7072 6f78 7969 6e67 2c20 7573  sed proxying, us
+00010b20: 696e 6720 602d 2d72 702d 6c6f 633d 2f73  ing `--rp-loc=/s
+00010b30: 7475 6666 6020 746f 2074 656c 6c20 636f  tuff` to tell co
+00010b40: 7079 7061 7274 7920 7768 6572 6520 6974  pyparty where it
+00010b50: 2069 7320 6d6f 756e 7465 6420 2d2d 2068   is mounted -- h
+00010b60: 6173 2061 2073 6c69 6768 7420 7065 7266  as a slight perf
+00010b70: 6f72 6d61 6e63 6520 636f 7374 2061 6e64  ormance cost and
+00010b80: 2068 6967 6865 7220 6368 616e 6365 206f   higher chance o
+00010b90: 6620 6275 6773 0a20 202a 2069 6620 636f  f bugs.  * if co
+00010ba0: 7079 7061 7274 7920 7361 7973 2060 696e  pyparty says `in
+00010bb0: 636f 7272 6563 7420 2d2d 7270 2d6c 6f63  correct --rp-loc
+00010bc0: 206f 7220 7765 6273 6572 7665 7220 636f   or webserver co
+00010bd0: 6e66 6967 3b20 6578 7065 6374 6564 2076  nfig; expected v
+00010be0: 7061 7468 2073 7461 7274 696e 6720 7769  path starting wi
+00010bf0: 7468 205b 2e2e 2e5d 6020 6974 2773 206c  th [...]` it's l
+00010c00: 696b 656c 7920 6265 6361 7573 6520 7468  ikely because th
+00010c10: 6520 7765 6273 6572 7665 7220 6973 2073  e webserver is s
+00010c20: 7472 6970 7069 6e67 2061 7761 7920 7468  tripping away th
+00010c30: 6520 7072 6f78 7920 6c6f 6361 7469 6f6e  e proxy location
+00010c40: 2066 726f 6d20 7468 6520 7265 7175 6573   from the reques
+00010c50: 7420 5552 4c73 202d 2d20 7365 6520 7468  t URLs -- see th
+00010c60: 6520 6050 726f 7879 5061 7373 6020 696e  e `ProxyPass` in
+00010c70: 2074 6865 2061 7061 6368 6520 6578 616d   the apache exam
+00010c80: 706c 6520 6265 6c6f 770a 0a73 6f6d 6520  ple below..some 
+00010c90: 7265 7665 7273 6520 7072 6f78 6965 7320  reverse proxies 
+00010ca0: 2873 7563 6820 6173 205b 4361 6464 795d  (such as [Caddy]
+00010cb0: 2868 7474 7073 3a2f 2f63 6164 6479 7365  (https://caddyse
+00010cc0: 7276 6572 2e63 6f6d 2f29 2920 6361 6e20  rver.com/)) can 
+00010cd0: 6175 746f 6d61 7469 6361 6c6c 7920 6f62  automatically ob
+00010ce0: 7461 696e 2061 2076 616c 6964 2068 7474  tain a valid htt
+00010cf0: 7073 2f74 6c73 2063 6572 7469 6669 6361  ps/tls certifica
+00010d00: 7465 2066 6f72 2079 6f75 2c20 616e 6420  te for you, and 
+00010d10: 736f 6d65 2073 7570 706f 7274 2048 5454  some support HTT
+00010d20: 502f 3220 616e 6420 5155 4943 2077 6869  P/2 and QUIC whi
+00010d30: 6368 2063 6f75 6c64 2062 6520 6120 6e69  ch could be a ni
+00010d40: 6365 2073 7065 6564 2062 6f6f 7374 0a0a  ce speed boost..
+00010d50: 6578 616d 706c 6520 7765 6273 6572 7665  example webserve
+00010d60: 7220 636f 6e66 6967 733a 0a0a 2a20 5b6e  r configs:..* [n
+00010d70: 6769 6e78 2063 6f6e 6669 675d 2863 6f6e  ginx config](con
+00010d80: 7472 6962 2f6e 6769 6e78 2f63 6f70 7970  trib/nginx/copyp
+00010d90: 6172 7479 2e63 6f6e 6629 202d 2d20 656e  arty.conf) -- en
+00010da0: 7469 7265 2064 6f6d 6169 6e2f 7375 6264  tire domain/subd
+00010db0: 6f6d 6169 6e0a 2a20 5b61 7061 6368 6532  omain.* [apache2
+00010dc0: 2063 6f6e 6669 675d 2863 6f6e 7472 6962   config](contrib
+00010dd0: 2f61 7061 6368 652f 636f 7079 7061 7274  /apache/copypart
+00010de0: 792e 636f 6e66 2920 2d2d 206c 6f63 6174  y.conf) -- locat
+00010df0: 696f 6e2d 6261 7365 640a 0a0a 2320 7061  ion-based...# pa
+00010e00: 636b 6167 6573 0a0a 7468 6520 7061 7274  ckages..the part
+00010e10: 7920 6d69 6768 7420 6265 2063 6c6f 7365  y might be close
+00010e20: 7220 7468 616e 2079 6f75 2074 6869 6e6b  r than you think
+00010e30: 0a0a 0a23 2320 6172 6368 2070 6163 6b61  ...## arch packa
+00010e40: 6765 0a0a 6e6f 7720 5b61 7661 696c 6162  ge..now [availab
+00010e50: 6c65 206f 6e20 6175 725d 2868 7474 7073  le on aur](https
+00010e60: 3a2f 2f61 7572 2e61 7263 686c 696e 7578  ://aur.archlinux
+00010e70: 2e6f 7267 2f70 6163 6b61 6765 732f 636f  .org/packages/co
+00010e80: 7079 7061 7274 7929 206d 6169 6e74 6169  pyparty) maintai
+00010e90: 6e65 6420 6279 205b 4069 6378 6573 5d28  ned by [@icxes](
+00010ea0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00010eb0: 6f6d 2f69 6378 6573 290a 0a0a 2323 206e  om/icxes)...## n
+00010ec0: 6978 2070 6163 6b61 6765 0a0a 606e 6978  ix package..`nix
+00010ed0: 2070 726f 6669 6c65 2069 6e73 7461 6c6c   profile install
+00010ee0: 2067 6974 6875 623a 3930 3031 2f63 6f70   github:9001/cop
+00010ef0: 7970 6172 7479 600a 0a72 6571 7569 7265  yparty`..require
+00010f00: 7320 6120 5b66 6c61 6b65 2d65 6e61 626c  s a [flake-enabl
+00010f10: 6564 5d28 6874 7470 733a 2f2f 6e69 786f  ed](https://nixo
+00010f20: 732e 7769 6b69 2f77 696b 692f 466c 616b  s.wiki/wiki/Flak
+00010f30: 6573 2920 696e 7374 616c 6c61 7469 6f6e  es) installation
+00010f40: 206f 6620 6e69 780a 0a73 6f6d 6520 7265   of nix..some re
+00010f50: 636f 6d6d 656e 6465 6420 6465 7065 6e64  commended depend
+00010f60: 656e 6369 6573 2061 7265 2065 6e61 626c  encies are enabl
+00010f70: 6564 2062 7920 6465 6661 756c 743b 205b  ed by default; [
+00010f80: 6f76 6572 7269 6465 2074 6865 2070 6163  override the pac
+00010f90: 6b61 6765 5d28 6874 7470 733a 2f2f 6769  kage](https://gi
+00010fa0: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
+00010fb0: 7079 7061 7274 792f 626c 6f62 2f68 6f76  pyparty/blob/hov
+00010fc0: 7564 7374 7261 756d 2f63 6f6e 7472 6962  udstraum/contrib
+00010fd0: 2f70 6163 6b61 6765 2f6e 6978 2f63 6f70  /package/nix/cop
+00010fe0: 7970 6172 7479 2f64 6566 6175 6c74 2e6e  yparty/default.n
+00010ff0: 6978 234c 332d 4c32 3229 2069 6620 796f  ix#L3-L22) if yo
+00011000: 7520 7761 6e74 2074 6f20 6164 642f 7265  u want to add/re
+00011010: 6d6f 7665 2073 6f6d 6520 6665 6174 7572  move some featur
+00011020: 6573 2f64 6570 730a 0a60 6666 6d70 6567  es/deps..`ffmpeg
+00011030: 2d66 756c 6c60 2077 6173 2063 686f 7365  -full` was chose
+00011040: 6e20 6f76 6572 2060 6666 6d70 6567 2d68  n over `ffmpeg-h
+00011050: 6561 646c 6573 7360 206d 6169 6e6c 7920  eadless` mainly 
+00011060: 6265 6361 7573 6520 7765 206e 6565 6420  because we need 
+00011070: 6077 6974 6857 6562 7060 2028 616e 6420  `withWebp` (and 
+00011080: 6077 6974 684f 7065 6e6d 7074 6020 6973  `withOpenmpt` is
+00011090: 2061 6c73 6f20 6e69 6365 2920 616e 6420   also nice) and 
+000110a0: 6265 696e 6720 6162 6c65 2074 6f20 7573  being able to us
+000110b0: 6520 6120 6361 6368 6564 2062 7569 6c64  e a cached build
+000110c0: 2066 656c 7420 6d6f 7265 2069 6d70 6f72   felt more impor
+000110d0: 7461 6e74 2074 6861 6e20 6f70 7469 6d69  tant than optimi
+000110e0: 7a69 6e67 2066 6f72 2073 697a 6520 6174  zing for size at
+000110f0: 2074 6865 2074 696d 6520 2d2d 2050 5273   the time -- PRs
+00011100: 2077 656c 636f 6d65 2069 6620 796f 7520   welcome if you 
+00011110: 6469 7361 6772 6565 20f0 9f91 8d0a 0a0a  disagree .......
+00011120: 2323 206e 6978 6f73 206d 6f64 756c 650a  ## nixos module.
+00011130: 0a66 6f72 2074 6869 7320 7365 7475 702c  .for this setup,
+00011140: 2079 6f75 2077 696c 6c20 6e65 6564 2061   you will need a
+00011150: 205b 666c 616b 652d 656e 6162 6c65 645d   [flake-enabled]
+00011160: 2868 7474 7073 3a2f 2f6e 6978 6f73 2e77  (https://nixos.w
+00011170: 696b 692f 7769 6b69 2f46 6c61 6b65 7329  iki/wiki/Flakes)
+00011180: 2069 6e73 7461 6c6c 6174 696f 6e20 6f66   installation of
+00011190: 204e 6978 4f53 2e0a 0a60 6060 6e69 780a   NixOS...```nix.
+000111a0: 7b0a 2020 2320 6164 6420 636f 7079 7061  {.  # add copypa
+000111b0: 7274 7920 666c 616b 6520 746f 2079 6f75  rty flake to you
+000111c0: 7220 696e 7075 7473 0a20 2069 6e70 7574  r inputs.  input
+000111d0: 732e 636f 7079 7061 7274 792e 7572 6c20  s.copyparty.url 
+000111e0: 3d20 2267 6974 6875 623a 3930 3031 2f63  = "github:9001/c
+000111f0: 6f70 7970 6172 7479 223b 0a0a 2020 2320  opyparty";..  # 
+00011200: 656e 7375 7265 2074 6861 7420 636f 7079  ensure that copy
+00011210: 7061 7274 7920 6973 2061 6e20 616c 6c6f  party is an allo
+00011220: 7765 6420 6172 6775 6d65 6e74 2074 6f20  wed argument to 
+00011230: 7468 6520 6f75 7470 7574 7320 6675 6e63  the outputs func
+00011240: 7469 6f6e 0a20 206f 7574 7075 7473 203d  tion.  outputs =
+00011250: 207b 2073 656c 662c 206e 6978 706b 6773   { self, nixpkgs
+00011260: 2c20 636f 7079 7061 7274 7920 7d3a 207b  , copyparty }: {
+00011270: 0a20 2020 206e 6978 6f73 436f 6e66 6967  .    nixosConfig
+00011280: 7572 6174 696f 6e73 2e79 6f75 7248 6f73  urations.yourHos
+00011290: 744e 616d 6520 3d20 6e69 7870 6b67 732e  tName = nixpkgs.
+000112a0: 6c69 622e 6e69 786f 7353 7973 7465 6d20  lib.nixosSystem 
+000112b0: 7b0a 2020 2020 2020 6d6f 6475 6c65 7320  {.      modules 
+000112c0: 3d20 5b0a 2020 2020 2020 2020 2320 6c6f  = [.        # lo
+000112d0: 6164 2074 6865 2063 6f70 7970 6172 7479  ad the copyparty
+000112e0: 204e 6978 4f53 206d 6f64 756c 650a 2020   NixOS module.  
+000112f0: 2020 2020 2020 636f 7079 7061 7274 792e        copyparty.
+00011300: 6e69 786f 734d 6f64 756c 6573 2e64 6566  nixosModules.def
+00011310: 6175 6c74 0a20 2020 2020 2020 2028 7b20  ault.        ({ 
+00011320: 706b 6773 2c20 2e2e 2e20 7d3a 207b 0a20  pkgs, ... }: {. 
+00011330: 2020 2020 2020 2020 2023 2061 6464 2074           # add t
+00011340: 6865 2063 6f70 7970 6172 7479 206f 7665  he copyparty ove
+00011350: 726c 6179 2074 6f20 6578 706f 7365 2074  rlay to expose t
+00011360: 6865 2070 6163 6b61 6765 2074 6f20 7468  he package to th
+00011370: 6520 6d6f 6475 6c65 0a20 2020 2020 2020  e module.       
+00011380: 2020 206e 6978 706b 6773 2e6f 7665 726c     nixpkgs.overl
+00011390: 6179 7320 3d20 5b20 636f 7079 7061 7274  ays = [ copypart
+000113a0: 792e 6f76 6572 6c61 7973 2e64 6566 6175  y.overlays.defau
+000113b0: 6c74 205d 3b0a 2020 2020 2020 2020 2020  lt ];.          
+000113c0: 2320 286f 7074 696f 6e61 6c29 2069 6e73  # (optional) ins
+000113d0: 7461 6c6c 2074 6865 2070 6163 6b61 6765  tall the package
+000113e0: 2067 6c6f 6261 6c6c 790a 2020 2020 2020   globally.      
+000113f0: 2020 2020 656e 7669 726f 6e6d 656e 742e      environment.
+00011400: 7379 7374 656d 5061 636b 6167 6573 203d  systemPackages =
+00011410: 205b 2070 6b67 732e 636f 7079 7061 7274   [ pkgs.copypart
+00011420: 7920 5d3b 0a20 2020 2020 2020 2020 2023  y ];.          #
+00011430: 2063 6f6e 6669 6775 7265 2074 6865 2063   configure the c
+00011440: 6f70 7970 6172 7479 206d 6f64 756c 650a  opyparty module.
+00011450: 2020 2020 2020 2020 2020 7365 7276 6963            servic
+00011460: 6573 2e63 6f70 7970 6172 7479 2e65 6e61  es.copyparty.ena
+00011470: 626c 6520 3d20 7472 7565 3b0a 2020 2020  ble = true;.    
+00011480: 2020 2020 7d29 0a20 2020 2020 205d 3b0a      }).      ];.
+00011490: 2020 2020 7d3b 0a20 207d 3b0a 7d0a 6060      };.  };.}.``
+000114a0: 600a 0a63 6f70 7970 6172 7479 206f 6e20  `..copyparty on 
+000114b0: 4e69 784f 5320 6973 2063 6f6e 6669 6775  NixOS is configu
+000114c0: 7265 6420 7669 6120 6073 6572 7669 6365  red via `service
+000114d0: 732e 636f 7079 7061 7274 7960 206f 7074  s.copyparty` opt
+000114e0: 696f 6e73 2c20 666f 7220 6578 616d 706c  ions, for exampl
+000114f0: 653a 0a60 6060 6e69 780a 7365 7276 6963  e:.```nix.servic
+00011500: 6573 2e63 6f70 7970 6172 7479 203d 207b  es.copyparty = {
+00011510: 0a20 2065 6e61 626c 6520 3d20 7472 7565  .  enable = true
+00011520: 3b0a 2020 2320 6469 7265 6374 6c79 206d  ;.  # directly m
+00011530: 6170 7320 746f 2076 616c 7565 7320 696e  aps to values in
+00011540: 2074 6865 205b 676c 6f62 616c 5d20 7365   the [global] se
+00011550: 6374 696f 6e20 6f66 2074 6865 2063 6f70  ction of the cop
+00011560: 7970 6172 7479 2063 6f6e 6669 672e 0a20  yparty config.. 
+00011570: 2023 2073 6565 2060 636f 7079 7061 7274   # see `copypart
+00011580: 7920 2d2d 6865 6c70 6020 666f 7220 6176  y --help` for av
+00011590: 6169 6c61 626c 6520 6f70 7469 6f6e 730a  ailable options.
+000115a0: 2020 7365 7474 696e 6773 203d 207b 0a20    settings = {. 
+000115b0: 2020 2069 203d 2022 302e 302e 302e 3022     i = "0.0.0.0"
+000115c0: 3b0a 2020 2020 2320 7573 6520 6c69 7374  ;.    # use list
+000115d0: 7320 746f 2073 6574 206d 756c 7469 706c  s to set multipl
+000115e0: 6520 7661 6c75 6573 0a20 2020 2070 203d  e values.    p =
+000115f0: 205b 2033 3231 3020 3332 3131 205d 3b0a   [ 3210 3211 ];.
+00011600: 2020 2020 2320 7573 6520 626f 6f6c 6561      # use boolea
+00011610: 6e73 2074 6f20 7365 7420 6269 6e61 7279  ns to set binary
+00011620: 2066 6c61 6773 0a20 2020 206e 6f2d 7265   flags.    no-re
+00011630: 6c6f 6164 203d 2074 7275 653b 0a20 2020  load = true;.   
+00011640: 2023 2075 7369 6e67 2027 6661 6c73 6527   # using 'false'
+00011650: 2077 696c 6c20 646f 206e 6f74 6869 6e67   will do nothing
+00011660: 2061 6e64 206f 6d69 7420 7468 6520 7661   and omit the va
+00011670: 6c75 6520 7768 656e 2067 656e 6572 6174  lue when generat
+00011680: 696e 6720 6120 636f 6e66 6967 0a20 2020  ing a config.   
+00011690: 2069 676e 6f72 6564 2d66 6c61 6720 3d20   ignored-flag = 
+000116a0: 6661 6c73 653b 0a20 207d 3b0a 0a20 2023  false;.  };..  #
+000116b0: 2063 7265 6174 6520 7573 6572 730a 2020   create users.  
+000116c0: 6163 636f 756e 7473 203d 207b 0a20 2020  accounts = {.   
+000116d0: 2023 2073 7065 6369 6679 2074 6865 2061   # specify the a
+000116e0: 6363 6f75 6e74 206e 616d 6520 6173 2074  ccount name as t
+000116f0: 6865 206b 6579 0a20 2020 2065 6420 3d20  he key.    ed = 
+00011700: 7b0a 2020 2020 2020 2320 7072 6f76 6964  {.      # provid
+00011710: 6520 7468 6520 7061 7468 2074 6f20 6120  e the path to a 
+00011720: 6669 6c65 2063 6f6e 7461 696e 696e 6720  file containing 
+00011730: 7468 6520 7061 7373 776f 7264 2c20 6b65  the password, ke
+00011740: 6570 696e 6720 6974 206f 7574 206f 6620  eping it out of 
+00011750: 2f6e 6978 2f73 746f 7265 0a20 2020 2020  /nix/store.     
+00011760: 2023 206d 7573 7420 6265 2072 6561 6461   # must be reada
+00011770: 626c 6520 6279 2074 6865 2063 6f70 7970  ble by the copyp
+00011780: 6172 7479 2073 6572 7669 6365 2075 7365  arty service use
+00011790: 720a 2020 2020 2020 7061 7373 776f 7264  r.      password
+000117a0: 4669 6c65 203d 2022 2f72 756e 2f6b 6579  File = "/run/key
+000117b0: 732f 636f 7079 7061 7274 792f 6564 5f70  s/copyparty/ed_p
+000117c0: 6173 7377 6f72 6422 3b0a 2020 2020 7d3b  assword";.    };
+000117d0: 0a20 2020 2023 206f 7220 646f 2062 6f74  .    # or do bot
+000117e0: 6820 696e 206f 6e65 2067 6f0a 2020 2020  h in one go.    
+000117f0: 6b2e 7061 7373 776f 7264 4669 6c65 203d  k.passwordFile =
+00011800: 2022 2f72 756e 2f6b 6579 732f 636f 7079   "/run/keys/copy
+00011810: 7061 7274 792f 6b5f 7061 7373 776f 7264  party/k_password
+00011820: 223b 0a20 207d 3b0a 0a20 2023 2063 7265  ";.  };..  # cre
+00011830: 6174 6520 6120 766f 6c75 6d65 0a20 2076  ate a volume.  v
+00011840: 6f6c 756d 6573 203d 207b 0a20 2020 2023  olumes = {.    #
+00011850: 2063 7265 6174 6520 6120 766f 6c75 6d65   create a volume
+00011860: 2061 7420 222f 2220 2874 6865 2077 6562   at "/" (the web
+00011870: 726f 6f74 292c 2077 6869 6368 2077 696c  root), which wil
+00011880: 6c0a 2020 2020 222f 2220 3d20 7b0a 2020  l.    "/" = {.  
+00011890: 2020 2020 2320 7368 6172 6520 7468 6520      # share the 
+000118a0: 636f 6e74 656e 7473 206f 6620 222f 7372  contents of "/sr
+000118b0: 762f 636f 7079 7061 7274 7922 0a20 2020  v/copyparty".   
+000118c0: 2020 2070 6174 6820 3d20 222f 7372 762f     path = "/srv/
+000118d0: 636f 7079 7061 7274 7922 3b0a 2020 2020  copyparty";.    
+000118e0: 2020 2320 7365 6520 6063 6f70 7970 6172    # see `copypar
+000118f0: 7479 202d 2d68 656c 702d 6163 636f 756e  ty --help-accoun
+00011900: 7473 6020 666f 7220 6176 6169 6c61 626c  ts` for availabl
+00011910: 6520 6f70 7469 6f6e 730a 2020 2020 2020  e options.      
+00011920: 6163 6365 7373 203d 207b 0a20 2020 2020  access = {.     
+00011930: 2020 2023 2065 7665 7279 6f6e 6520 6765     # everyone ge
+00011940: 7473 2072 6561 642d 6163 6365 7373 2c20  ts read-access, 
+00011950: 6275 740a 2020 2020 2020 2020 7220 3d20  but.        r = 
+00011960: 222a 223b 0a20 2020 2020 2020 2023 2075  "*";.        # u
+00011970: 7365 7273 2022 6564 2220 616e 6420 226b  sers "ed" and "k
+00011980: 2220 6765 7420 7265 6164 2d77 7269 7465  " get read-write
+00011990: 0a20 2020 2020 2020 2072 7720 3d20 5b20  .        rw = [ 
+000119a0: 2265 6422 2022 6b22 205d 3b0a 2020 2020  "ed" "k" ];.    
+000119b0: 2020 7d3b 0a20 2020 2020 2023 2073 6565    };.      # see
+000119c0: 2060 636f 7079 7061 7274 7920 2d2d 6865   `copyparty --he
+000119d0: 6c70 2d66 6c61 6773 6020 666f 7220 6176  lp-flags` for av
+000119e0: 6169 6c61 626c 6520 6f70 7469 6f6e 730a  ailable options.
+000119f0: 2020 2020 2020 666c 6167 7320 3d20 7b0a        flags = {.
+00011a00: 2020 2020 2020 2020 2320 2266 6b22 2065          # "fk" e
+00011a10: 6e61 626c 6573 2066 696c 656b 6579 7320  nables filekeys 
+00011a20: 286e 6563 6573 7361 7279 2066 6f72 2075  (necessary for u
+00011a30: 7067 6574 2070 6572 6d69 7373 696f 6e29  pget permission)
+00011a40: 2028 3420 6368 6172 7320 6c6f 6e67 290a   (4 chars long).
+00011a50: 2020 2020 2020 2020 666b 203d 2034 3b0a          fk = 4;.
+00011a60: 2020 2020 2020 2020 2320 7363 616e 2066          # scan f
+00011a70: 6f72 206e 6577 2066 696c 6573 2065 7665  or new files eve
+00011a80: 7279 2036 3073 6563 0a20 2020 2020 2020  ry 60sec.       
+00011a90: 2073 6361 6e20 3d20 3630 3b0a 2020 2020   scan = 60;.    
+00011aa0: 2020 2020 2320 766f 6c66 6c61 6720 2265      # volflag "e
+00011ab0: 3264 2220 656e 6162 6c65 7320 7468 6520  2d" enables the 
+00011ac0: 7570 6c6f 6164 7320 6461 7461 6261 7365  uploads database
+00011ad0: 0a20 2020 2020 2020 2065 3264 203d 2074  .        e2d = t
+00011ae0: 7275 653b 0a20 2020 2020 2020 2023 2022  rue;.        # "
+00011af0: 6432 7422 2064 6973 6162 6c65 7320 6d75  d2t" disables mu
+00011b00: 6c74 696d 6564 6961 2070 6172 7365 7273  ltimedia parsers
+00011b10: 2028 696e 2063 6173 6520 7468 6520 7570   (in case the up
+00011b20: 6c6f 6164 7320 6172 6520 6d61 6c69 6369  loads are malici
+00011b30: 6f75 7329 0a20 2020 2020 2020 2064 3274  ous).        d2t
+00011b40: 203d 2074 7275 653b 0a20 2020 2020 2020   = true;.       
+00011b50: 2023 2073 6b69 7073 2068 6173 6869 6e67   # skips hashing
+00011b60: 2066 696c 6520 636f 6e74 656e 7473 2069   file contents i
+00011b70: 6620 7061 7468 206d 6174 6368 6573 202a  f path matches *
+00011b80: 2e69 736f 0a20 2020 2020 2020 206e 6f68  .iso.        noh
+00011b90: 6173 6820 3d20 225c 2e69 736f 2422 3b0a  ash = "\.iso$";.
+00011ba0: 2020 2020 2020 7d3b 0a20 2020 207d 3b0a        };.    };.
+00011bb0: 2020 7d3b 0a20 2023 2079 6f75 206d 6179    };.  # you may
+00011bc0: 2069 6e63 7265 6173 6520 7468 6520 6f70   increase the op
+00011bd0: 656e 2066 696c 6520 6c69 6d69 7420 666f  en file limit fo
+00011be0: 7220 7468 6520 7072 6f63 6573 730a 2020  r the process.  
+00011bf0: 6f70 656e 4669 6c65 734c 696d 6974 203d  openFilesLimit =
+00011c00: 2038 3139 323b 0a7d 3b0a 6060 600a 0a74   8192;.};.```..t
+00011c10: 6865 2070 6173 7377 6f72 6446 696c 6520  he passwordFile 
+00011c20: 6174 202f 7275 6e2f 6b65 7973 2f63 6f70  at /run/keys/cop
+00011c30: 7970 6172 7479 2f20 636f 756c 6420 666f  yparty/ could fo
+00011c40: 7220 6578 616d 706c 6520 6265 2067 656e  r example be gen
+00011c50: 6572 6174 6564 2062 7920 5b61 6765 6e69  erated by [ageni
+00011c60: 785d 2868 7474 7073 3a2f 2f67 6974 6875  x](https://githu
+00011c70: 622e 636f 6d2f 7279 616e 746d 2f61 6765  b.com/ryantm/age
+00011c80: 6e69 7829 2c20 6f72 2079 6f75 2063 6f75  nix), or you cou
+00011c90: 6c64 206a 7573 7420 6475 6d70 2069 7420  ld just dump it 
+00011ca0: 696e 2074 6865 206e 6978 2073 746f 7265  in the nix store
+00011cb0: 2069 6e73 7465 6164 2069 6620 7468 6174   instead if that
+00011cc0: 2773 2061 6363 6570 7461 626c 650a 0a0a  's acceptable...
+00011cd0: 2320 6272 6f77 7365 7220 7375 7070 6f72  # browser suppor
+00011ce0: 740a 0a54 4c44 523a 2079 6573 0a0a 215b  t..TLDR: yes..![
+00011cf0: 636f 7079 7061 7274 792d 6965 342d 6673  copyparty-ie4-fs
+00011d00: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
+00011d10: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+00011d20: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+00011d30: 3033 322f 3131 3831 3932 3739 312d 6662  032/118192791-fb
+00011d40: 3331 6665 3030 2d62 3434 362d 3131 6562  31fe00-b446-11eb
+00011d50: 2d39 3634 372d 3839 3865 6138 6566 6331  -9647-898ea8efc1
+00011d60: 6637 2e70 6e67 290a 0a60 6965 6020 3d20  f7.png)..`ie` = 
+00011d70: 696e 7465 726e 6574 2d65 7870 6c6f 7265  internet-explore
+00011d80: 722c 2060 6666 6020 3d20 6669 7265 666f  r, `ff` = firefo
+00011d90: 782c 2060 6360 203d 2063 6872 6f6d 652c  x, `c` = chrome,
+00011da0: 2060 694f 5360 203d 2069 5068 6f6e 652f   `iOS` = iPhone/
+00011db0: 6950 6164 2c20 6041 6e64 7260 203d 2041  iPad, `Andr` = A
+00011dc0: 6e64 726f 6964 0a0a 7c20 6665 6174 7572  ndroid..| featur
+00011dd0: 6520 2020 2020 2020 2020 7c20 6965 3620  e         | ie6 
+00011de0: 7c20 6965 3920 207c 2069 6531 3020 7c20  | ie9  | ie10 | 
+00011df0: 6965 3131 207c 2066 6620 3532 207c 2063  ie11 | ff 52 | c
+00011e00: 2034 3920 7c20 694f 5320 7c20 416e 6472   49 | iOS | Andr
+00011e10: 207c 0a7c 202d 2d2d 2d2d 2d2d 2d2d 2d2d   |.| -----------
+00011e20: 2d2d 2d2d 207c 202d 2d2d 207c 202d 2d2d  ---- | --- | ---
+00011e30: 2d20 7c20 2d2d 2d2d 207c 202d 2d2d 2d20  - | ---- | ---- 
+00011e40: 7c20 2d2d 2d2d 2d20 7c20 2d2d 2d2d 207c  | ----- | ---- |
+00011e50: 202d 2d2d 207c 202d 2d2d 2d20 7c0a 7c20   --- | ---- |.| 
+00011e60: 6272 6f77 7365 2066 696c 6573 2020 2020  browse files    
+00011e70: 7c20 7965 7020 7c20 7965 7020 207c 2079  | yep | yep  | y
+00011e80: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
+00011e90: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011ea0: 7c20 7965 7020 207c 0a7c 2074 6875 6d62  | yep  |.| thumb
+00011eb0: 6e61 696c 2076 6965 7720 207c 2020 2d20  nail view  |  - 
+00011ec0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
+00011ed0: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
+00011ee0: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
+00011ef0: 2020 7c0a 7c20 6261 7369 6320 7570 6c6f    |.| basic uplo
+00011f00: 6164 6572 2020 7c20 7965 7020 7c20 7965  ader  | yep | ye
+00011f10: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011f20: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
+00011f30: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
+00011f40: 2075 7032 6b20 2020 2020 2020 2020 2020   up2k           
+00011f50: 207c 2020 2d20 207c 2020 2d20 2020 7c20   |  -  |  -   | 
+00011f60: 602a 3160 207c 2060 2a31 6020 7c20 2079  `*1` | `*1` |  y
+00011f70: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+00011f80: 207c 2079 6570 2020 7c0a 7c20 6d61 6b65   | yep  |.| make
+00011f90: 2064 6972 6563 746f 7279 2020 7c20 7965   directory  | ye
+00011fa0: 7020 7c20 7965 7020 207c 2079 6570 2020  p | yep  | yep  
+00011fb0: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
+00011fc0: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
+00011fd0: 7020 207c 0a7c 2073 656e 6420 6d65 7373  p  |.| send mess
+00011fe0: 6167 6520 2020 207c 2079 6570 207c 2079  age    | yep | y
+00011ff0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+00012000: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
+00012010: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
+00012020: 7c20 7365 7420 736f 7274 206f 7264 6572  | set sort order
+00012030: 2020 7c20 202d 2020 7c20 7965 7020 207c    |  -  | yep  |
+00012040: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
+00012050: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+00012060: 7020 7c20 7965 7020 207c 0a7c 207a 6970  p | yep  |.| zip
+00012070: 2073 656c 6563 7469 6f6e 2020 207c 2020   selection   |  
+00012080: 2d20 207c 2079 6570 2020 7c20 7965 7020  -  | yep  | yep 
+00012090: 207c 2079 6570 2020 7c20 2079 6570 2020   | yep  |  yep  
+000120a0: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
+000120b0: 6570 2020 7c0a 7c20 6669 6c65 2072 656e  ep  |.| file ren
+000120c0: 616d 6520 2020 2020 7c20 202d 2020 7c20  ame     |  -  | 
+000120d0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+000120e0: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
+000120f0: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
+00012100: 0a7c 2066 696c 6520 6375 742f 7061 7374  .| file cut/past
+00012110: 6520 207c 2020 2d20 207c 2079 6570 2020  e  |  -  | yep  
+00012120: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+00012130: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+00012140: 6570 207c 2079 6570 2020 7c0a 7c20 6e61  ep | yep  |.| na
+00012150: 7670 616e 6520 2020 2020 2020 2020 7c20  vpane         | 
+00012160: 202d 2020 7c20 7965 7020 207c 2079 6570   -  | yep  | yep
+00012170: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
+00012180: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
+00012190: 7965 7020 207c 0a7c 2069 6d61 6765 2076  yep  |.| image v
+000121a0: 6965 7765 7220 2020 207c 2020 2d20 207c  iewer    |  -  |
+000121b0: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+000121c0: 6570 2020 7c20 2079 6570 2020 7c20 7965  ep  |  yep  | ye
+000121d0: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
+000121e0: 7c0a 7c20 7669 6465 6f20 706c 6179 6572  |.| video player
+000121f0: 2020 2020 7c20 202d 2020 7c20 7965 7020      |  -  | yep 
+00012200: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
+00012210: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
+00012220: 7965 7020 7c20 7965 7020 207c 0a7c 206d  yep | yep  |.| m
+00012230: 6172 6b64 6f77 6e20 6564 6974 6f72 207c  arkdown editor |
+00012240: 2020 2d20 207c 2020 2d20 2020 7c20 7965    -  |  -   | ye
+00012250: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
+00012260: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
+00012270: 2079 6570 2020 7c0a 7c20 6d61 726b 646f   yep  |.| markdo
+00012280: 776e 2076 6965 7765 7220 7c20 202d 2020  wn viewer |  -  
+00012290: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+000122a0: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
+000122b0: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
+000122c0: 207c 0a7c 2070 6c61 7920 6d70 332f 6d34   |.| play mp3/m4
+000122d0: 6120 2020 207c 2020 2d20 207c 2079 6570  a    |  -  | yep
+000122e0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
+000122f0: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
+00012300: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
+00012310: 706c 6179 206f 6767 2f6f 7075 7320 2020  play ogg/opus   
+00012320: 7c20 202d 2020 7c20 202d 2020 207c 2020  |  -  |  -   |  
+00012330: 2d20 2020 7c20 202d 2020 207c 2020 7965  -   |  -   |  ye
+00012340: 7020 207c 2079 6570 2020 7c20 602a 3360  p  | yep  | `*3`
+00012350: 207c 2079 6570 207c 0a7c 202a 2a3d 2066   | yep |.| **= f
+00012360: 6561 7475 7265 203d 2a2a 207c 2069 6536  eature =** | ie6
+00012370: 207c 2069 6539 2020 7c20 6965 3130 207c   | ie9  | ie10 |
+00012380: 2069 6531 3120 7c20 6666 2035 3220 7c20   ie11 | ff 52 | 
+00012390: 6320 3439 207c 2069 4f53 207c 2041 6e64  c 49 | iOS | And
+000123a0: 7220 7c0a 0a2a 2069 6e74 6572 6e65 7420  r |..* internet 
+000123b0: 6578 706c 6f72 6572 2036 2074 6f20 3820  explorer 6 to 8 
+000123c0: 6265 6861 7665 2074 6865 2073 616d 650a  behave the same.
+000123d0: 2a20 6669 7265 666f 7820 3532 2061 6e64  * firefox 52 and
+000123e0: 2063 6872 6f6d 6520 3439 2061 7265 2074   chrome 49 are t
+000123f0: 6865 2066 696e 616c 2077 696e 7870 2076  he final winxp v
+00012400: 6572 7369 6f6e 730a 2a20 602a 3160 2079  ersions.* `*1` y
+00012410: 6573 2c20 6275 7420 6578 7472 656d 656c  es, but extremel
+00012420: 7920 736c 6f77 2028 6965 3130 3a20 6031  y slow (ie10: `1
+00012430: 204d 6942 2f73 602c 2069 6531 313a 2060   MiB/s`, ie11: `
+00012440: 3237 3020 4b69 422f 7360 290a 2a20 602a  270 KiB/s`).* `*
+00012450: 3360 2069 4f53 2031 3120 616e 6420 6e65  3` iOS 11 and ne
+00012460: 7765 722c 206f 7075 7320 6f6e 6c79 2c20  wer, opus only, 
+00012470: 616e 6420 7265 7175 6972 6573 2046 466d  and requires FFm
+00012480: 7065 6720 6f6e 2074 6865 2073 6572 7665  peg on the serve
+00012490: 720a 0a71 7569 636b 2073 756d 6d61 7279  r..quick summary
+000124a0: 206f 6620 6d6f 7265 2065 6363 656e 7472   of more eccentr
+000124b0: 6963 2077 6562 2d62 726f 7773 6572 7320  ic web-browsers 
+000124c0: 7472 7969 6e67 2074 6f20 7669 6577 2061  trying to view a
+000124d0: 2064 6972 6563 746f 7279 2069 6e64 6578   directory index
+000124e0: 3a0a 0a7c 2062 726f 7773 6572 207c 2077  :..| browser | w
+000124f0: 696c 6c20 6974 2062 6c65 6e64 207c 0a7c  ill it blend |.|
+00012500: 202d 2d2d 2d2d 2d2d 207c 202d 2d2d 2d2d   ------- | -----
+00012510: 2d2d 2d2d 2d2d 2d2d 207c 0a7c 202a 2a6c  -------- |.| **l
+00012520: 696e 6b73 2a2a 2028 322e 3231 2f6d 6163  inks** (2.21/mac
+00012530: 706f 7274 7329 207c 2063 616e 2062 726f  ports) | can bro
+00012540: 7773 652c 206c 6f67 696e 2c20 7570 6c6f  wse, login, uplo
+00012550: 6164 2f6d 6b64 6972 2f6d 7367 207c 0a7c  ad/mkdir/msg |.|
+00012560: 202a 2a6c 796e 782a 2a20 2832 2e38 2e39   **lynx** (2.8.9
+00012570: 2f6d 6163 706f 7274 7329 207c 2063 616e  /macports) | can
+00012580: 2062 726f 7773 652c 206c 6f67 696e 2c20   browse, login, 
+00012590: 7570 6c6f 6164 2f6d 6b64 6972 2f6d 7367  upload/mkdir/msg
+000125a0: 207c 0a7c 202a 2a77 336d 2a2a 2028 302e   |.| **w3m** (0.
+000125b0: 352e 332f 6d61 6370 6f72 7473 2920 207c  5.3/macports)  |
+000125c0: 2063 616e 2062 726f 7773 652c 206c 6f67   can browse, log
+000125d0: 696e 2c20 7570 6c6f 6164 2061 7420 3130  in, upload at 10
+000125e0: 306b 422f 732c 206d 6b64 6972 2f6d 7367  0kB/s, mkdir/msg
+000125f0: 207c 0a7c 202a 2a6e 6574 7375 7266 2a2a   |.| **netsurf**
+00012600: 2028 332e 3130 2f61 7263 6829 2020 207c   (3.10/arch)   |
+00012610: 2069 7320 6261 7369 6361 6c6c 7920 6965   is basically ie
+00012620: 3620 7769 7468 206d 7563 6820 6265 7474  6 with much bett
+00012630: 6572 2063 7373 2028 6a61 7661 7363 7269  er css (javascri
+00012640: 7074 2068 6173 2061 6c6d 6f73 7420 6e6f  pt has almost no
+00012650: 2065 6666 6563 7429 207c 200a 7c20 2a2a   effect) | .| **
+00012660: 6f70 6572 612a 2a20 2831 312e 3630 2f77  opera** (11.60/w
+00012670: 696e 7870 2920 2020 7c20 4f4b 3a20 7468  inxp)   | OK: th
+00012680: 756d 626e 6169 6c73 2c20 696d 6167 652d  umbnails, image-
+00012690: 7669 6577 6572 2c20 7a69 702d 7365 6c65  viewer, zip-sele
+000126a0: 6374 696f 6e2c 2072 656e 616d 652f 6375  ction, rename/cu
+000126b0: 742f 7061 7374 652e 204e 473a 2075 7032  t/paste. NG: up2
+000126c0: 6b2c 206e 6176 7061 6e65 2c20 6d61 726b  k, navpane, mark
+000126d0: 646f 776e 2c20 6175 6469 6f20 7c0a 7c20  down, audio |.| 
+000126e0: 2a2a 6965 342a 2a20 616e 6420 2a2a 6e65  **ie4** and **ne
+000126f0: 7473 6361 7065 2a2a 2034 2e30 2020 7c20  tscape** 4.0  | 
+00012700: 6361 6e20 6272 6f77 7365 2c20 7570 6c6f  can browse, uplo
+00012710: 6164 2077 6974 6820 603f 623d 7560 2c20  ad with `?b=u`, 
+00012720: 6175 7468 2077 6974 6820 6026 7077 3d77  auth with `&pw=w
+00012730: 6172 6b60 207c 0a7c 202a 2a6e 6373 6120  ark` |.| **ncsa 
+00012740: 6d6f 7361 6963 2a2a 2032 2e37 2020 2020  mosaic** 2.7    
+00012750: 2020 207c 2064 6f65 7320 6e6f 7420 6765     | does not ge
+00012760: 7420 6120 7061 7373 2c20 5b70 6963 315d  t a pass, [pic1]
+00012770: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
+00012780: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00012790: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+000127a0: 322f 3137 3431 3839 3232 372d 6165 3831  2/174189227-ae81
+000127b0: 3630 3236 2d63 6636 662d 3462 6535 2d61  6026-cf6f-4be5-a
+000127c0: 3236 652d 3162 3362 3037 3263 3162 3266  26e-1b3b072c1b2f
+000127d0: 2e70 6e67 2920 2d20 5b70 6963 325d 2868  .png) - [pic2](h
+000127e0: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+000127f0: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00012800: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00012810: 3137 3431 3839 3232 352d 3536 3531 6330  174189225-5651c0
+00012820: 3539 2d35 3135 322d 3436 6539 2d61 6332  59-5152-46e9-ac2
+00012830: 362d 3765 3938 6534 3937 3930 3162 2e70  6-7e98e497901b.p
+00012840: 6e67 2920 7c0a 7c20 2a2a 5365 7265 6e69  ng) |.| **Sereni
+00012850: 7479 4f53 2a2a 2028 3765 3938 3435 3729  tyOS** (7e98457)
+00012860: 2020 7c20 6869 7473 2061 2070 6167 6520    | hits a page 
+00012870: 6661 756c 742c 2077 6f72 6b73 2077 6974  fault, works wit
+00012880: 6820 603f 623d 7560 2c20 6669 6c65 2075  h `?b=u`, file u
+00012890: 706c 6f61 6420 6e6f 742d 696d 706c 207c  pload not-impl |
+000128a0: 0a0a 0a23 2063 6c69 656e 7420 6578 616d  ...# client exam
+000128b0: 706c 6573 0a0a 696e 7465 7261 6374 2077  ples..interact w
+000128c0: 6974 6820 636f 7079 7061 7274 7920 7573  ith copyparty us
+000128d0: 696e 6720 6e6f 6e2d 6272 6f77 7365 7220  ing non-browser 
+000128e0: 636c 6965 6e74 730a 0a2a 206a 6176 6173  clients..* javas
+000128f0: 6372 6970 743a 2064 756d 7020 736f 6d65  cript: dump some
+00012900: 2073 7461 7465 2069 6e74 6f20 6120 6669   state into a fi
+00012910: 6c65 2028 7477 6f20 7365 7061 7261 7465  le (two separate
+00012920: 2065 7861 6d70 6c65 7329 0a20 202a 2060   examples).  * `
+00012930: 6177 6169 7420 6665 7463 6828 272f 2f31  await fetch('//1
+00012940: 3237 2e30 2e30 2e31 3a33 3932 332f 272c  27.0.0.1:3923/',
+00012950: 207b 6d65 7468 6f64 3a22 5055 5422 2c20   {method:"PUT", 
+00012960: 626f 6479 3a20 4a53 4f4e 2e73 7472 696e  body: JSON.strin
+00012970: 6769 6679 2866 6f6f 297d 293b 600a 2020  gify(foo)});`.  
+00012980: 2a20 6076 6172 2078 6872 203d 206e 6577  * `var xhr = new
+00012990: 2058 4d4c 4874 7470 5265 7175 6573 7428   XMLHttpRequest(
+000129a0: 293b 2078 6872 2e6f 7065 6e28 2750 4f53  ); xhr.open('POS
+000129b0: 5427 2c20 272f 2f31 3237 2e30 2e30 2e31  T', '//127.0.0.1
+000129c0: 3a33 3932 332f 6d73 6773 3f72 6177 2729  :3923/msgs?raw')
+000129d0: 3b20 7868 722e 7365 6e64 2827 666f 6f27  ; xhr.send('foo'
+000129e0: 293b 600a 0a2a 2063 7572 6c2f 7767 6574  );`..* curl/wget
+000129f0: 3a20 7570 6c6f 6164 2073 6f6d 6520 6669  : upload some fi
+00012a00: 6c65 7320 2870 6f73 743d 6669 6c65 2c20  les (post=file, 
+00012a10: 6368 756e 6b3d 7374 6469 6e29 0a20 202a  chunk=stdin).  *
+00012a20: 2060 706f 7374 2829 7b20 6375 726c 202d   `post(){ curl -
+00012a30: 4620 6163 743d 6270 7574 202d 4620 663d  F act=bput -F f=
+00012a40: 4022 2431 2220 6874 7470 3a2f 2f31 3237  @"$1" http://127
+00012a50: 2e30 2e30 2e31 3a33 3932 332f 3f70 773d  .0.0.1:3923/?pw=
+00012a60: 7761 726b 3b7d 6020 200a 2020 2020 6070  wark;}`  .    `p
+00012a70: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012a80: 202a 2060 706f 7374 2829 7b20 6375 726c   * `post(){ curl
+00012a90: 202d 4820 7077 3a77 6172 6b20 2d48 2072   -H pw:wark -H r
+00012aa0: 616e 643a 3820 2d54 2022 2431 2220 6874  and:8 -T "$1" ht
+00012ab0: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a33  tp://127.0.0.1:3
+00012ac0: 3932 332f 3b7d 6020 200a 2020 2020 6070  923/;}`  .    `p
+00012ad0: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012ae0: 202a 2060 706f 7374 2829 7b20 7767 6574   * `post(){ wget
+00012af0: 202d 2d68 6561 6465 723d 2770 773a 2077   --header='pw: w
+00012b00: 6172 6b27 202d 2d70 6f73 742d 6669 6c65  ark' --post-file
+00012b10: 3d22 2431 2220 2d4f 2d20 6874 7470 3a2f  ="$1" -O- http:/
+00012b20: 2f31 3237 2e30 2e30 2e31 3a33 3932 332f  /127.0.0.1:3923/
+00012b30: 3f72 6177 3b7d 6020 200a 2020 2020 6070  ?raw;}`  .    `p
+00012b40: 6f73 7420 6d6f 7669 652e 6d6b 7660 0a20  ost movie.mkv`. 
+00012b50: 202a 2060 6368 756e 6b28 297b 2063 7572   * `chunk(){ cur
+00012b60: 6c20 2d48 2070 773a 7761 726b 202d 542d  l -H pw:wark -T-
+00012b70: 2068 7474 703a 2f2f 3132 372e 302e 302e   http://127.0.0.
+00012b80: 313a 3339 3233 2f3b 7d60 2020 0a20 2020  1:3923/;}`  .   
+00012b90: 2060 6368 756e 6b20 3c6d 6f76 6965 2e6d   `chunk <movie.m
+00012ba0: 6b76 600a 0a2a 2062 6173 683a 2077 6865  kv`..* bash: whe
+00012bb0: 6e20 6375 726c 2061 6e64 2077 6765 7420  n curl and wget 
+00012bc0: 6973 206e 6f74 2061 7661 696c 6162 6c65  is not available
+00012bd0: 206f 7220 746f 6f20 626f 7269 6e67 0a20   or too boring. 
+00012be0: 202a 2060 2870 7269 6e74 6620 2750 5554   * `(printf 'PUT
+00012bf0: 202f 6a75 6e6b 3f70 773d 7761 726b 2048   /junk?pw=wark H
+00012c00: 5454 502f 312e 315c 725c 6e5c 725c 6e27  TTP/1.1\r\n\r\n'
+00012c10: 3b20 6361 7420 6d6f 7669 652e 6d6b 7629  ; cat movie.mkv)
+00012c20: 207c 206e 6320 3132 372e 302e 302e 3120   | nc 127.0.0.1 
+00012c30: 3339 3233 600a 2020 2a20 6028 7072 696e  3923`.  * `(prin
+00012c40: 7466 2027 5055 5420 2f20 4854 5450 2f31  tf 'PUT / HTTP/1
+00012c50: 2e31 5c72 5c6e 5c72 5c6e 273b 2063 6174  .1\r\n\r\n'; cat
+00012c60: 206d 6f76 6965 2e6d 6b76 2920 3e2f 6465   movie.mkv) >/de
+00012c70: 762f 7463 702f 3132 372e 302e 302e 312f  v/tcp/127.0.0.1/
+00012c80: 3339 3233 600a 0a2a 2070 7974 686f 6e3a  3923`..* python:
+00012c90: 205b 7570 326b 2e70 795d 2868 7474 7073   [up2k.py](https
+00012ca0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00012cb0: 3031 2f63 6f70 7970 6172 7479 2f62 6c6f  01/copyparty/blo
+00012cc0: 622f 686f 7675 6473 7472 6175 6d2f 6269  b/hovudstraum/bi
+00012cd0: 6e2f 7570 326b 2e70 7929 2069 7320 6120  n/up2k.py) is a 
+00012ce0: 636f 6d6d 616e 642d 6c69 6e65 2075 7032  command-line up2
+00012cf0: 6b20 636c 6965 6e74 205b 2877 6562 6d29  k client [(webm)
+00012d00: 5d28 6874 7470 733a 2f2f 6f63 762e 6d65  ](https://ocv.me
+00012d10: 2f73 7475 6666 2f75 3263 6c69 2e77 6562  /stuff/u2cli.web
+00012d20: 6d29 0a20 202a 2066 696c 6520 7570 6c6f  m).  * file uplo
+00012d30: 6164 732c 2066 696c 652d 7365 6172 6368  ads, file-search
+00012d40: 2c20 5b66 6f6c 6465 7220 7379 6e63 5d28  , [folder sync](
+00012d50: 2366 6f6c 6465 722d 7379 6e63 292c 2061  #folder-sync), a
+00012d60: 7574 6f72 6573 756d 6520 6f66 2061 626f  utoresume of abo
+00012d70: 7274 6564 2f62 726f 6b65 6e20 7570 6c6f  rted/broken uplo
+00012d80: 6164 730a 2020 2a20 6361 6e20 6265 2064  ads.  * can be d
+00012d90: 6f77 6e6c 6f61 6465 6420 6672 6f6d 2063  ownloaded from c
+00012da0: 6f70 7970 6172 7479 3a20 636f 6e74 726f  opyparty: contro
+00012db0: 6c70 616e 656c 202d 3e20 636f 6e6e 6563  lpanel -> connec
+00012dc0: 7420 2d3e 205b 7570 326b 2e70 795d 2868  t -> [up2k.py](h
+00012dd0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+00012de0: 3339 3233 2f2e 6370 722f 612f 7570 326b  3923/.cpr/a/up2k
+00012df0: 2e70 7929 0a20 202a 2073 6565 205b 2e2f  .py).  * see [./
+00012e00: 6269 6e2f 5245 4144 4d45 2e6d 6423 7570  bin/README.md#up
+00012e10: 326b 7079 5d28 6269 6e2f 5245 4144 4d45  2kpy](bin/README
+00012e20: 2e6d 6423 7570 326b 7079 290a 0a2a 2046  .md#up2kpy)..* F
+00012e30: 5553 453a 206d 6f75 6e74 2061 2063 6f70  USE: mount a cop
+00012e40: 7970 6172 7479 2073 6572 7665 7220 6173  yparty server as
+00012e50: 2061 206c 6f63 616c 2066 696c 6573 7973   a local filesys
+00012e60: 7465 6d0a 2020 2a20 6372 6f73 732d 706c  tem.  * cross-pl
+00012e70: 6174 666f 726d 2070 7974 686f 6e20 636c  atform python cl
+00012e80: 6965 6e74 2061 7661 696c 6162 6c65 2069  ient available i
+00012e90: 6e20 5b2e 2f62 696e 2f5d 2862 696e 2f29  n [./bin/](bin/)
+00012ea0: 0a20 202a 2063 616e 2062 6520 646f 776e  .  * can be down
+00012eb0: 6c6f 6164 6564 2066 726f 6d20 636f 7079  loaded from copy
+00012ec0: 7061 7274 793a 2063 6f6e 7472 6f6c 7061  party: controlpa
+00012ed0: 6e65 6c20 2d3e 2063 6f6e 6e65 6374 202d  nel -> connect -
+00012ee0: 3e20 5b70 6172 7479 6675 7365 2e70 795d  > [partyfuse.py]
+00012ef0: 2868 7474 703a 2f2f 3132 372e 302e 302e  (http://127.0.0.
+00012f00: 313a 3339 3233 2f2e 6370 722f 612f 7061  1:3923/.cpr/a/pa
+00012f10: 7274 7966 7573 652e 7079 290a 2020 2a20  rtyfuse.py).  * 
+00012f20: 5b72 636c 6f6e 655d 2868 7474 7073 3a2f  [rclone](https:/
+00012f30: 2f72 636c 6f6e 652e 6f72 672f 2920 6173  /rclone.org/) as
+00012f40: 2063 6c69 656e 7420 6361 6e20 6769 7665   client can give
+00012f50: 207e 3578 2070 6572 666f 726d 616e 6365   ~5x performance
+00012f60: 2c20 7365 6520 5b2e 2f64 6f63 732f 7263  , see [./docs/rc
+00012f70: 6c6f 6e65 2e6d 645d 2864 6f63 732f 7263  lone.md](docs/rc
+00012f80: 6c6f 6e65 2e6d 6429 0a0a 2a20 7368 6172  lone.md)..* shar
+00012f90: 6578 2028 7363 7265 656e 7368 6f74 2075  ex (screenshot u
+00012fa0: 7469 6c69 7479 293a 2073 6565 205b 2e2f  tility): see [./
+00012fb0: 636f 6e74 7269 622f 7368 6172 6578 2e73  contrib/sharex.s
+00012fc0: 7863 755d 2863 6f6e 7472 6962 2f23 7368  xcu](contrib/#sh
+00012fd0: 6172 6578 7378 6375 290a 0a63 6f70 7970  arexsxcu)..copyp
+00012fe0: 6172 7479 2072 6574 7572 6e73 2061 2074  arty returns a t
+00012ff0: 7275 6e63 6174 6564 2073 6861 3531 3273  runcated sha512s
+00013000: 756d 206f 6620 796f 7572 2050 5554 2f50  um of your PUT/P
+00013010: 4f53 5420 6173 2062 6173 6536 343b 2079  OST as base64; y
+00013020: 6f75 2063 616e 2067 656e 6572 6174 6520  ou can generate 
+00013030: 7468 6520 7361 6d65 2063 6865 636b 7375  the same checksu
+00013040: 6d20 6c6f 6361 6c6c 7920 746f 2076 6572  m locally to ver
+00013050: 6966 7920 7570 6c61 6f64 733a 0a0a 2020  ify uplaods:..  
+00013060: 2020 6235 3132 2829 7b20 7072 696e 7466    b512(){ printf
+00013070: 2022 2428 2873 6861 3531 3273 756d 7c7c   "$((sha512sum||
+00013080: 7368 6173 756d 202d 6135 3132 297c 7365  shasum -a512)|se
+00013090: 6420 2d45 2027 732f 202e 2a2f 2f3b 732f  d -E 's/ .*//;s/
+000130a0: 282e 2e29 2f5c 5c78 5c31 2f67 2729 227c  (..)/\\x\1/g')"|
+000130b0: 6261 7365 3634 7c74 7220 272b 2f27 2027  base64|tr '+/' '
+000130c0: 2d5f 277c 6865 6164 202d 6334 343b 7d0a  -_'|head -c44;}.
+000130d0: 2020 2020 6235 3132 203c 6d6f 7669 652e      b512 <movie.
+000130e0: 6d6b 760a 0a79 6f75 2063 616e 2070 726f  mkv..you can pro
+000130f0: 7669 6465 2070 6173 7377 6f72 6473 2075  vide passwords u
+00013100: 7369 6e67 2068 6561 6465 7220 6050 573a  sing header `PW:
+00013110: 2068 756e 7465 7232 602c 2063 6f6f 6b69   hunter2`, cooki
+00013120: 6520 6063 7070 7764 3d68 756e 7465 7232  e `cppwd=hunter2
+00013130: 602c 2075 726c 2d70 6172 616d 2060 3f70  `, url-param `?p
+00013140: 773d 6875 6e74 6572 3260 2c20 6f72 2077  w=hunter2`, or w
+00013150: 6974 6820 6261 7369 632d 6175 7468 656e  ith basic-authen
+00013160: 7469 6361 7469 6f6e 2028 6569 7468 6572  tication (either
+00013170: 2061 7320 7468 6520 7573 6572 6e61 6d65   as the username
+00013180: 206f 7220 7061 7373 776f 7264 290a 0a4e   or password)..N
+00013190: 4f54 453a 2063 7572 6c20 7769 6c6c 206e  OTE: curl will n
+000131a0: 6f74 2073 656e 6420 7468 6520 6f72 6967  ot send the orig
+000131b0: 696e 616c 2066 696c 656e 616d 6520 6966  inal filename if
+000131c0: 2079 6f75 2075 7365 2060 2d54 6020 636f   you use `-T` co
+000131d0: 6d62 696e 6564 2077 6974 6820 7572 6c2d  mbined with url-
+000131e0: 7061 7261 6d73 2120 416c 736f 2c20 6d61  params! Also, ma
+000131f0: 6b65 2073 7572 6520 746f 2061 6c77 6179  ke sure to alway
+00013200: 7320 6c65 6176 6520 6120 7472 6169 6c69  s leave a traili
+00013210: 6e67 2073 6c61 7368 2069 6e20 5552 4c73  ng slash in URLs
+00013220: 2075 6e6c 6573 7320 796f 7520 7761 6e74   unless you want
+00013230: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
+00013240: 2066 696c 656e 616d 650a 0a0a 2323 2066   filename...## f
+00013250: 6f6c 6465 7220 7379 6e63 0a0a 7379 6e63  older sync..sync
+00013260: 2066 6f6c 6465 7273 2074 6f2f 6672 6f6d   folders to/from
+00013270: 2063 6f70 7970 6172 7479 0a0a 7468 6520   copyparty..the 
+00013280: 636f 6d6d 616e 646c 696e 6520 7570 6c6f  commandline uplo
+00013290: 6164 6572 205b 7570 326b 2e70 795d 2868  ader [up2k.py](h
+000132a0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000132b0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+000132c0: 2f74 7265 652f 686f 7675 6473 7472 6175  /tree/hovudstrau
+000132d0: 6d2f 6269 6e23 7570 326b 7079 2920 7769  m/bin#up2kpy) wi
+000132e0: 7468 2060 2d2d 6472 6020 6973 2074 6865  th `--dr` is the
+000132f0: 2062 6573 7420 7761 7920 746f 2073 796e   best way to syn
+00013300: 6320 6120 666f 6c64 6572 2074 6f20 636f  c a folder to co
+00013310: 7079 7061 7274 793b 2076 6572 6966 6965  pyparty; verifie
+00013320: 7320 6368 6563 6b73 756d 7320 616e 6420  s checksums and 
+00013330: 646f 6573 2066 696c 6573 2069 6e20 7061  does files in pa
+00013340: 7261 6c6c 656c 2c20 616e 6420 6465 6c65  rallel, and dele
+00013350: 7465 7320 756e 6578 7065 6374 6564 2066  tes unexpected f
+00013360: 696c 6573 206f 6e20 7468 6520 7365 7276  iles on the serv
+00013370: 6572 2061 6674 6572 2075 706c 6f61 6420  er after upload 
+00013380: 6861 7320 6669 6e69 7368 6564 2077 6869  has finished whi
+00013390: 6368 206d 616b 6573 2066 696c 652d 7265  ch makes file-re
+000133a0: 6e61 6d65 7320 7265 616c 6c79 2063 6865  names really che
+000133b0: 6170 2028 6974 276c 6c20 7265 6e61 6d65  ap (it'll rename
+000133c0: 2073 6572 7665 7273 6964 6520 616e 6420   serverside and 
+000133d0: 736b 6970 2075 706c 6f61 6469 6e67 290a  skip uploading).
+000133e0: 0a61 6c74 6572 6e61 7469 7665 6c79 2074  .alternatively t
+000133f0: 6865 7265 2069 7320 5b72 636c 6f6e 655d  here is [rclone]
+00013400: 282e 2f64 6f63 732f 7263 6c6f 6e65 2e6d  (./docs/rclone.m
+00013410: 6429 2077 6869 6368 2061 6c6c 6f77 7320  d) which allows 
+00013420: 666f 7220 6269 6469 7265 6374 696f 6e61  for bidirectiona
+00013430: 6c20 7379 6e63 2061 6e64 2069 7320 2a77  l sync and is *w
+00013440: 6179 2a20 6d6f 7265 2066 6c65 7869 626c  ay* more flexibl
+00013450: 6520 2873 7472 6561 6d20 6669 6c65 7320  e (stream files 
+00013460: 7374 7261 6967 6874 2066 726f 6d20 7366  straight from sf
+00013470: 7470 2f73 332f 6763 7320 746f 2063 6f70  tp/s3/gcs to cop
+00013480: 7970 6172 7479 2c20 2e2e 2e29 2c20 616c  yparty, ...), al
+00013490: 7468 6f75 6768 2074 6865 7265 2069 7320  though there is 
+000134a0: 6e6f 2069 6e74 6567 7269 7479 2063 6865  no integrity che
+000134b0: 636b 2061 6e64 2069 7420 776f 6e27 7420  ck and it won't 
+000134c0: 776f 726b 2077 6974 6820 6669 6c65 7320  work with files 
+000134d0: 6f76 6572 2031 3030 204d 6942 2069 6620  over 100 MiB if 
+000134e0: 636f 7079 7061 7274 7920 6973 2062 6568  copyparty is beh
+000134f0: 696e 6420 636c 6f75 6466 6c61 7265 0a0a  ind cloudflare..
+00013500: 2a20 7374 6172 7469 6e67 2066 726f 6d20  * starting from 
+00013510: 7263 6c6f 6e65 2076 312e 3633 2028 6375  rclone v1.63 (cu
+00013520: 7272 656e 746c 7920 5b69 6e20 6265 7461  rrently [in beta
+00013530: 5d28 6874 7470 733a 2f2f 6265 7461 2e72  ](https://beta.r
+00013540: 636c 6f6e 652e 6f72 672f 3f66 696c 7465  clone.org/?filte
+00013550: 723d 6c61 7465 7374 2929 2c20 7263 6c6f  r=latest)), rclo
+00013560: 6e65 2077 696c 6c20 616c 736f 2062 6520  ne will also be 
+00013570: 6661 7374 6572 2074 6861 6e20 7570 326b  faster than up2k
+00013580: 2e70 790a 0a0a 2323 206d 6f75 6e74 2061  .py...## mount a
+00013590: 7320 6472 6976 650a 0a61 2072 656d 6f74  s drive..a remot
+000135a0: 6520 636f 7079 7061 7274 7920 7365 7276  e copyparty serv
+000135b0: 6572 2061 7320 6120 6c6f 6361 6c20 6669  er as a local fi
+000135c0: 6c65 7379 7374 656d 3b20 2067 6f20 746f  lesystem;  go to
+000135d0: 2074 6865 2063 6f6e 7472 6f6c 2d70 616e   the control-pan
+000135e0: 656c 2061 6e64 2063 6c69 636b 2060 636f  el and click `co
+000135f0: 6e6e 6563 7460 2074 6f20 7365 6520 6120  nnect` to see a 
+00013600: 6c69 7374 206f 6620 636f 6d6d 616e 6473  list of commands
+00013610: 2074 6f20 646f 2074 6861 740a 0a61 6c74   to do that..alt
+00013620: 6572 6e61 7469 7665 6c79 2c20 736f 6d65  ernatively, some
+00013630: 2061 6c74 6572 6e61 7469 7665 7320 726f   alternatives ro
+00013640: 7567 686c 7920 736f 7274 6564 2062 7920  ughly sorted by 
+00013650: 7370 6565 6420 2875 6e72 6570 726f 6475  speed (unreprodu
+00013660: 6369 626c 6520 6265 6e63 686d 6172 6b29  cible benchmark)
+00013670: 2c20 6265 7374 2066 6972 7374 3a0a 0a2a  , best first:..*
+00013680: 205b 7263 6c6f 6e65 2d77 6562 6461 765d   [rclone-webdav]
+00013690: 282e 2f64 6f63 732f 7263 6c6f 6e65 2e6d  (./docs/rclone.m
+000136a0: 6429 2028 3235 7329 2c20 7265 6164 2f57  d) (25s), read/W
+000136b0: 5249 5445 2028 5b76 312e 3633 2d62 6574  RITE ([v1.63-bet
+000136c0: 615d 2868 7474 7073 3a2f 2f62 6574 612e  a](https://beta.
+000136d0: 7263 6c6f 6e65 2e6f 7267 2f3f 6669 6c74  rclone.org/?filt
+000136e0: 6572 3d6c 6174 6573 7429 290a 2a20 5b72  er=latest)).* [r
+000136f0: 636c 6f6e 652d 6874 7470 5d28 2e2f 646f  clone-http](./do
+00013700: 6373 2f72 636c 6f6e 652e 6d64 2920 2832  cs/rclone.md) (2
+00013710: 3673 292c 2072 6561 642d 6f6e 6c79 0a2a  6s), read-only.*
+00013720: 205b 7061 7274 7966 7573 652e 7079 5d28   [partyfuse.py](
+00013730: 2e2f 6269 6e2f 2370 6172 7479 6675 7365  ./bin/#partyfuse
+00013740: 7079 2920 2833 3573 292c 2072 6561 642d  py) (35s), read-
+00013750: 6f6e 6c79 0a2a 205b 7263 6c6f 6e65 2d66  only.* [rclone-f
+00013760: 7470 5d28 2e2f 646f 6373 2f72 636c 6f6e  tp](./docs/rclon
+00013770: 652e 6d64 2920 2834 3773 292c 2072 6561  e.md) (47s), rea
+00013780: 642f 5752 4954 450a 2a20 6461 7666 7332  d/WRITE.* davfs2
+00013790: 2028 3130 3373 292c 2072 6561 642f 5752   (103s), read/WR
+000137a0: 4954 452c 202a 7665 7279 2066 6173 742a  ITE, *very fast*
+000137b0: 206f 6e20 736d 616c 6c20 6669 6c65 730a   on small files.
+000137c0: 2a20 5b77 696e 3130 2d77 6562 6461 765d  * [win10-webdav]
+000137d0: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
+000137e0: 2028 3133 3873 292c 2072 6561 642f 5752   (138s), read/WR
+000137f0: 4954 450a 2a20 5b77 696e 3130 2d73 6d62  ITE.* [win10-smb
+00013800: 325d 2823 736d 622d 7365 7276 6572 2920  2](#smb-server) 
+00013810: 2833 3837 7329 2c20 7265 6164 2f57 5249  (387s), read/WRI
+00013820: 5445 0a0a 6d6f 7374 2063 6c69 656e 7473  TE..most clients
+00013830: 2077 696c 6c20 6661 696c 2074 6f20 6d6f   will fail to mo
+00013840: 756e 7420 7468 6520 726f 6f74 206f 6620  unt the root of 
+00013850: 6120 636f 7079 7061 7274 7920 7365 7276  a copyparty serv
+00013860: 6572 2075 6e6c 6573 7320 7468 6572 6520  er unless there 
+00013870: 6973 2061 2072 6f6f 7420 766f 6c75 6d65  is a root volume
+00013880: 2028 736f 2079 6f75 2067 6574 2074 6865   (so you get the
+00013890: 2061 646d 696e 2d70 616e 656c 2069 6e73   admin-panel ins
+000138a0: 7465 6164 206f 6620 6120 6272 6f77 7365  tead of a browse
+000138b0: 7220 7768 656e 2061 6363 6573 7369 6e67  r when accessing
+000138c0: 2069 7429 202d 2d20 696e 2074 6861 7420   it) -- in that 
+000138d0: 6361 7365 2c20 6d6f 756e 7420 6120 7370  case, mount a sp
+000138e0: 6563 6966 6963 2076 6f6c 756d 6520 696e  ecific volume in
+000138f0: 7374 6561 640a 0a0a 2320 616e 6472 6f69  stead...# androi
+00013900: 6420 6170 700a 0a75 706c 6f61 6420 746f  d app..upload to
+00013910: 2063 6f70 7970 6172 7479 2077 6974 6820   copyparty with 
+00013920: 6f6e 6520 7461 700a 0a3c 6120 6872 6566  one tap..<a href
+00013930: 3d22 6874 7470 733a 2f2f 662d 6472 6f69  ="https://f-droi
+00013940: 642e 6f72 672f 7061 636b 6167 6573 2f6d  d.org/packages/m
+00013950: 652e 6f63 762e 7061 7274 7975 702f 223e  e.ocv.partyup/">
+00013960: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
+00013970: 2f2f 6f63 762e 6d65 2f66 6472 6f69 642e  //ocv.me/fdroid.
+00013980: 706e 6722 2061 6c74 3d22 4765 7420 6974  png" alt="Get it
+00013990: 206f 6e20 462d 4472 6f69 6422 2068 6569   on F-Droid" hei
+000139a0: 6768 743d 2235 3022 202f 3e20 2727 203c  ght="50" /> '' <
+000139b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
+000139c0: 2f69 6d67 2e73 6869 656c 6473 2e69 6f2f  /img.shields.io/
+000139d0: 662d 6472 6f69 642f 762f 6d65 2e6f 6376  f-droid/v/me.ocv
+000139e0: 2e70 6172 7479 7570 2e73 7667 2220 616c  .partyup.svg" al
+000139f0: 743d 2266 2d64 726f 6964 2076 6572 7369  t="f-droid versi
+00013a00: 6f6e 2069 6e66 6f22 202f 3e3c 2f61 3e20  on info" /></a> 
+00013a10: 2727 203c 6120 6872 6566 3d22 6874 7470  '' <a href="http
+00013a20: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00013a30: 3030 312f 7061 7274 792d 7570 223e 3c69  001/party-up"><i
+00013a40: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+00013a50: 696d 672e 7368 6965 6c64 732e 696f 2f67  img.shields.io/g
+00013a60: 6974 6875 622f 7265 6c65 6173 652f 3930  ithub/release/90
+00013a70: 3031 2f70 6172 7479 2d75 702e 7376 673f  01/party-up.svg?
+00013a80: 6c6f 676f 3d67 6974 6875 6222 2061 6c74  logo=github" alt
+00013a90: 3d22 6769 7468 7562 2076 6572 7369 6f6e  ="github version
+00013aa0: 2069 6e66 6f22 202f 3e3c 2f61 3e0a 0a74   info" /></a>..t
+00013ab0: 6865 2061 7070 2069 7320 2a2a 4e4f 542a  he app is **NOT*
+00013ac0: 2a20 7468 6520 6675 6c6c 2063 6f70 7970  * the full copyp
+00013ad0: 6172 7479 2073 6572 7665 7221 206a 7573  arty server! jus
+00013ae0: 7420 6120 6261 7369 6320 7570 6c6f 6164  t a basic upload
+00013af0: 2063 6c69 656e 742c 206e 6f74 6869 6e67   client, nothing
+00013b00: 2066 616e 6379 2079 6574 0a0a 6966 2079   fancy yet..if y
+00013b10: 6f75 2077 616e 7420 746f 2072 756e 2074  ou want to run t
+00013b20: 6865 2063 6f70 7970 6172 7479 2073 6572  he copyparty ser
+00013b30: 7665 7220 6f6e 2079 6f75 7220 616e 6472  ver on your andr
+00013b40: 6f69 6420 6465 7669 6365 2c20 7365 6520  oid device, see 
+00013b50: 5b69 6e73 7461 6c6c 206f 6e20 616e 6472  [install on andr
+00013b60: 6f69 645d 2823 696e 7374 616c 6c2d 6f6e  oid](#install-on
+00013b70: 2d61 6e64 726f 6964 290a 0a0a 2320 694f  -android)...# iO
+00013b80: 5320 7368 6f72 7463 7574 730a 0a74 6865  S shortcuts..the
+00013b90: 7265 2069 7320 6e6f 2069 5068 6f6e 6520  re is no iPhone 
+00013ba0: 6170 702c 2062 7574 2020 7468 6520 666f  app, but  the fo
+00013bb0: 6c6c 6f77 696e 6720 7368 6f72 7463 7574  llowing shortcut
+00013bc0: 7320 6172 6520 616c 6d6f 7374 2061 7320  s are almost as 
+00013bd0: 676f 6f64 3a0a 0a2a 205b 7570 6c6f 6164  good:..* [upload
+00013be0: 2074 6f20 636f 7079 7061 7274 795d 2868   to copyparty](h
+00013bf0: 7474 7073 3a2f 2f77 7777 2e69 636c 6f75  ttps://www.iclou
+00013c00: 642e 636f 6d2f 7368 6f72 7463 7574 732f  d.com/shortcuts/
+00013c10: 3431 6539 3864 6439 3835 6362 3464 3362  41e98dd985cb4d3b
+00013c20: 6234 3333 3232 3262 6331 6539 6537 3730  b433222bc1e9e770
+00013c30: 2920 285b 6f66 666c 696e 655d 2868 7474  ) ([offline](htt
+00013c40: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00013c50: 3930 3031 2f63 6f70 7970 6172 7479 2f72  9001/copyparty/r
+00013c60: 6177 2f68 6f76 7564 7374 7261 756d 2f63  aw/hovudstraum/c
+00013c70: 6f6e 7472 6962 2f69 6f73 2f75 706c 6f61  ontrib/ios/uploa
+00013c80: 642d 746f 2d63 6f70 7970 6172 7479 2e73  d-to-copyparty.s
+00013c90: 686f 7274 6375 7429 2920 285b 706e 675d  hortcut)) ([png]
+00013ca0: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
+00013cb0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+00013cc0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+00013cd0: 322f 3232 3631 3138 3035 332d 3738 3632  2/226118053-7862
+00013ce0: 3335 3534 2d62 3065 642d 3438 3265 2d39  3554-b0ed-482e-9
+00013cf0: 3865 342d 3664 3537 6164 6135 3865 6134  8e4-6d57ada58ea4
+00013d00: 2e70 6e67 2929 2062 6173 6564 206f 6e20  .png)) based on 
+00013d10: 7468 6520 5b6f 7269 6769 6e61 6c5d 2868  the [original](h
+00013d20: 7474 7073 3a2f 2f77 7777 2e69 636c 6f75  ttps://www.iclou
+00013d30: 642e 636f 6d2f 7368 6f72 7463 7574 732f  d.com/shortcuts/
+00013d40: 6162 3431 3564 3562 3464 6533 3436 3762  ab415d5b4de3467b
+00013d50: 3963 6536 6631 3531 6234 3339 6135 6437  9ce6f151b439a5d7
+00013d60: 2920 6279 205b 4461 6564 7265 6e5d 2868  ) by [Daedren](h
+00013d70: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00013d80: 6d2f 4461 6564 7265 6e29 2028 7468 7821  m/Daedren) (thx!
+00013d90: 290a 2020 2a20 6361 6e20 7374 7269 7020  ).  * can strip 
+00013da0: 6578 6966 2c20 7570 6c6f 6164 2066 696c  exif, upload fil
+00013db0: 6573 2c20 7069 6373 2c20 7669 6473 2c20  es, pics, vids, 
+00013dc0: 6c69 6e6b 732c 2063 6c69 7062 6f61 7264  links, clipboard
+00013dd0: 0a20 202a 2063 616e 2064 6f77 6e6c 6f61  .  * can downloa
+00013de0: 6420 6c69 6e6b 7320 616e 6420 7265 686f  d links and reho
+00013df0: 7374 2074 6865 2074 6172 6765 7420 6669  st the target fi
+00013e00: 6c65 206f 6e20 636f 7079 7061 7274 7920  le on copyparty 
+00013e10: 2873 6565 2066 6972 7374 2063 6f6d 6d65  (see first comme
+00013e20: 6e74 2069 6e73 6964 6520 7468 6520 7368  nt inside the sh
+00013e30: 6f72 7463 7574 290a 2020 2a20 7069 6373  ortcut).  * pics
+00013e40: 2062 6563 6f6d 6520 6c6f 7772 6573 2069   become lowres i
+00013e50: 6620 796f 7520 7368 6172 6520 6672 6f6d  f you share from
+00013e60: 2067 616c 6c65 7279 2074 6f20 7368 6f72   gallery to shor
+00013e70: 7463 7574 2c20 736f 2062 6574 7465 7220  tcut, so better 
+00013e80: 746f 206c 6175 6e63 6820 7468 6520 7368  to launch the sh
+00013e90: 6f72 7463 7574 2061 6e64 2070 6963 6b20  ortcut and pick 
+00013ea0: 7374 7566 6620 6672 6f6d 2074 6865 7265  stuff from there
+00013eb0: 0a0a 0a23 2070 6572 666f 726d 616e 6365  ...# performance
+00013ec0: 0a0a 6465 6661 756c 7473 2061 7265 2075  ..defaults are u
+00013ed0: 7375 616c 6c79 2066 696e 6520 2d20 6578  sually fine - ex
+00013ee0: 7065 6374 2060 3820 4769 422f 7360 2064  pect `8 GiB/s` d
+00013ef0: 6f77 6e6c 6f61 642c 2060 3120 4769 422f  ownload, `1 GiB/
+00013f00: 7360 2075 706c 6f61 640a 0a62 656c 6f77  s` upload..below
+00013f10: 2061 7265 2073 6f6d 6520 7477 6561 6b73   are some tweaks
+00013f20: 2072 6f75 6768 6c79 206f 7264 6572 6564   roughly ordered
+00013f30: 2062 7920 7573 6566 756c 6e65 7373 3a0a   by usefulness:.
+00013f40: 0a2a 2060 2d71 6020 6469 7361 626c 6573  .* `-q` disables
+00013f50: 206c 6f67 6769 6e67 2061 6e64 2063 616e   logging and can
+00013f60: 2068 656c 7020 6120 6275 6e63 682c 2065   help a bunch, e
+00013f70: 7665 6e20 7768 656e 2063 6f6d 6269 6e65  ven when combine
+00013f80: 6420 7769 7468 2060 2d6c 6f60 2074 6f20  d with `-lo` to 
+00013f90: 7265 6469 7265 6374 206c 6f67 7320 746f  redirect logs to
+00013fa0: 2066 696c 650a 2a20 602d 2d68 6973 7460   file.* `--hist`
+00013fb0: 2070 6f69 6e74 696e 6720 746f 2061 2066   pointing to a f
+00013fc0: 6173 7420 6c6f 6361 7469 6f6e 2028 7373  ast location (ss
+00013fd0: 6429 2077 696c 6c20 6d61 6b65 2064 6972  d) will make dir
+00013fe0: 6563 746f 7279 206c 6973 7469 6e67 7320  ectory listings 
+00013ff0: 616e 6420 7365 6172 6368 6573 2066 6173  and searches fas
+00014000: 7465 7220 7768 656e 2060 2d65 3264 6020  ter when `-e2d` 
+00014010: 6f72 2060 2d65 3274 6020 6973 2073 6574  or `-e2t` is set
+00014020: 0a2a 2060 2d2d 6e6f 2d68 6173 6820 2e60  .* `--no-hash .`
+00014030: 2077 6865 6e20 696e 6465 7869 6e67 2061   when indexing a
+00014040: 206e 6574 776f 726b 2d64 6973 6b20 6966   network-disk if
+00014050: 2079 6f75 2064 6f6e 2774 2063 6172 6520   you don't care 
+00014060: 6162 6f75 7420 7468 6520 6163 7475 616c  about the actual
+00014070: 2066 696c 6568 6173 6865 7320 616e 6420   filehashes and 
+00014080: 6f6e 6c79 2077 616e 7420 7468 6520 6e61  only want the na
+00014090: 6d65 732f 7461 6773 2073 6561 7263 6861  mes/tags searcha
+000140a0: 626c 650a 2a20 602d 2d6e 6f2d 6874 7020  ble.* `--no-htp 
+000140b0: 2d2d 6861 7368 2d6d 743d 3020 2d2d 6d74  --hash-mt=0 --mt
+000140c0: 6167 2d6d 743d 3120 2d2d 7468 2d6d 743d  ag-mt=1 --th-mt=
+000140d0: 3160 206d 696e 696d 697a 6573 2074 6865  1` minimizes the
+000140e0: 206e 756d 6265 7220 6f66 2074 6872 6561   number of threa
+000140f0: 6473 3b20 6361 6e20 6865 6c70 2069 6e20  ds; can help in 
+00014100: 736f 6d65 2065 6363 656e 7472 6963 2065  some eccentric e
+00014110: 6e76 6972 6f6e 6d65 6e74 7320 286c 696b  nvironments (lik
+00014120: 6520 7468 6520 7673 636f 6465 2064 6562  e the vscode deb
+00014130: 7567 6765 7229 0a2a 2060 2d6a 3060 2065  ugger).* `-j0` e
+00014140: 6e61 626c 6573 206d 756c 7469 7072 6f63  nables multiproc
+00014150: 6573 7369 6e67 2028 6163 7475 616c 206d  essing (actual m
+00014160: 756c 7469 7468 7265 6164 696e 6729 2c20  ultithreading), 
+00014170: 6361 6e20 7265 6475 6365 206c 6174 656e  can reduce laten
+00014180: 6379 2074 6f20 6032 302b 3830 2f6e 756d  cy to `20+80/num
+00014190: 436f 7265 7360 2070 6572 6365 6e74 2061  Cores` percent a
+000141a0: 6e64 2067 656e 6572 616c 6c79 2069 6d70  nd generally imp
+000141b0: 726f 7665 2070 6572 666f 726d 616e 6365  rove performance
+000141c0: 2069 6e20 6370 752d 696e 7465 6e73 6976   in cpu-intensiv
+000141d0: 6520 776f 726b 6c6f 6164 732c 2066 6f72  e workloads, for
+000141e0: 2065 7861 6d70 6c65 3a0a 2020 2a20 6c6f   example:.  * lo
+000141f0: 7473 206f 6620 636f 6e6e 6563 7469 6f6e  ts of connection
+00014200: 7320 286d 616e 7920 7573 6572 7320 6f72  s (many users or
+00014210: 2068 6561 7679 2063 6c69 656e 7473 290a   heavy clients).
+00014220: 2020 2a20 7369 6d75 6c74 616e 656f 7573    * simultaneous
+00014230: 2064 6f77 6e6c 6f61 6473 2061 6e64 2075   downloads and u
+00014240: 706c 6f61 6473 2073 6174 7572 6174 696e  ploads saturatin
+00014250: 6720 6120 3230 6762 7073 2063 6f6e 6e65  g a 20gbps conne
+00014260: 6374 696f 6e0a 2020 0a20 202e 2e2e 686f  ction.  .  ...ho
+00014270: 7765 7665 7220 6974 2061 6464 7320 616e  wever it adds an
+00014280: 206f 7665 7268 6561 6420 746f 2069 6e74   overhead to int
+00014290: 6572 6e61 6c20 636f 6d6d 756e 6963 6174  ernal communicat
+000142a0: 696f 6e20 736f 2069 7420 6d69 6768 7420  ion so it might 
+000142b0: 6265 2061 206e 6574 206c 6f73 732c 2073  be a net loss, s
+000142c0: 6565 2069 6620 6974 2077 6f72 6b73 2034  ee if it works 4
+000142d0: 2075 0a2a 2075 7369 6e67 205b 7079 7079   u.* using [pypy
+000142e0: 5d28 6874 7470 733a 2f2f 7777 772e 7079  ](https://www.py
+000142f0: 7079 2e6f 7267 2f29 2069 6e73 7465 6164  py.org/) instead
+00014300: 206f 6620 5b63 7079 7468 6f6e 5d28 6874   of [cpython](ht
+00014310: 7470 733a 2f2f 7777 772e 7079 7468 6f6e  tps://www.python
+00014320: 2e6f 7267 2f29 202a 6361 6e2a 2062 6520  .org/) *can* be 
+00014330: 3730 2520 6661 7374 6572 2066 6f72 2073  70% faster for s
+00014340: 6f6d 6520 776f 726b 6c6f 6164 732c 2062  ome workloads, b
+00014350: 7574 2073 6c6f 7765 7220 666f 7220 6d61  ut slower for ma
+00014360: 6e79 206f 7468 6572 730a 2020 2a20 616e  ny others.  * an
+00014370: 6420 7079 7079 2063 616e 2073 6f6d 6574  d pypy can somet
+00014380: 696d 6573 2063 7261 7368 206f 6e20 7374  imes crash on st
+00014390: 6172 7475 7020 7769 7468 2060 2d6a 3060  artup with `-j0`
+000143a0: 2028 544f 444f 206d 616b 6520 6973 7375   (TODO make issu
+000143b0: 6529 0a0a 0a23 2320 636c 6965 6e74 2d73  e)...## client-s
+000143c0: 6964 650a 0a77 6865 6e20 7570 6c6f 6164  ide..when upload
+000143d0: 696e 6720 6669 6c65 732c 0a0a 2a20 6368  ing files,..* ch
+000143e0: 726f 6d65 2069 7320 7265 636f 6d6d 656e  rome is recommen
+000143f0: 6465 642c 2061 7420 6c65 6173 7420 636f  ded, at least co
+00014400: 6d70 6172 6564 2074 6f20 6669 7265 666f  mpared to firefo
+00014410: 783a 0a20 202a 2075 7020 746f 2039 3025  x:.  * up to 90%
+00014420: 2066 6173 7465 7220 7768 656e 2068 6173   faster when has
+00014430: 6869 6e67 2c20 6573 7065 6369 616c 6c79  hing, especially
+00014440: 206f 6e20 5353 4473 0a20 202a 2075 7020   on SSDs.  * up 
+00014450: 746f 2034 3025 2066 6173 7465 7220 7768  to 40% faster wh
+00014460: 656e 2075 706c 6f61 6469 6e67 206f 7665  en uploading ove
+00014470: 7220 6578 7472 656d 656c 7920 6661 7374  r extremely fast
+00014480: 2069 6e74 6572 6e65 7473 0a20 202a 2062   internets.  * b
+00014490: 7574 205b 7570 326b 2e70 795d 2868 7474  ut [up2k.py](htt
+000144a0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+000144b0: 3930 3031 2f63 6f70 7970 6172 7479 2f62  9001/copyparty/b
+000144c0: 6c6f 622f 686f 7675 6473 7472 6175 6d2f  lob/hovudstraum/
+000144d0: 6269 6e2f 7570 326b 2e70 7929 2063 616e  bin/up2k.py) can
+000144e0: 2062 6520 3430 2520 6661 7374 6572 2074   be 40% faster t
+000144f0: 6861 6e20 6368 726f 6d65 2061 6761 696e  han chrome again
+00014500: 0a0a 2a20 6966 2079 6f75 2772 6520 6370  ..* if you're cp
+00014510: 752d 626f 7474 6c65 6e65 636b 6564 2c20  u-bottlenecked, 
+00014520: 6f72 2074 6865 2062 726f 7773 6572 2069  or the browser i
+00014530: 7320 6d61 7869 6e67 2061 2063 7075 2063  s maxing a cpu c
+00014540: 6f72 653a 0a20 202a 2075 7020 746f 2033  ore:.  * up to 3
+00014550: 3025 2066 6173 7465 7220 7570 6c6f 6164  0% faster upload
+00014560: 7320 6966 2079 6f75 2068 6964 6520 7468  s if you hide th
+00014570: 6520 7570 6c6f 6164 2073 7461 7475 7320  e upload status 
+00014580: 6c69 7374 2062 7920 7377 6974 6368 696e  list by switchin
+00014590: 6720 6177 6179 2066 726f 6d20 7468 6520  g away from the 
+000145a0: 605b f09f 9a80 5d60 2075 7032 6b20 7569  `[....]` up2k ui
+000145b0: 2d74 6162 2028 6f72 2063 6c6f 7369 6e67  -tab (or closing
+000145c0: 2069 7429 0a20 2020 202a 206f 7074 696f   it).    * optio
+000145d0: 6e61 6c6c 7920 796f 7520 6361 6e20 7377  nally you can sw
+000145e0: 6974 6368 2074 6f20 7468 6520 6c69 6768  itch to the ligh
+000145f0: 7477 6569 6768 7420 706f 7461 746f 2075  tweight potato u
+00014600: 6920 6279 2063 6c69 636b 696e 6720 7468  i by clicking th
+00014610: 6520 605b f09f a594 5d60 0a20 2020 202a  e `[....]`.    *
+00014620: 2073 7769 7463 6869 6e67 2074 6f20 616e   switching to an
+00014630: 6f74 6865 7220 6272 6f77 7365 722d 7461  other browser-ta
+00014640: 6220 616c 736f 2077 6f72 6b73 2c20 7468  b also works, th
+00014650: 6520 6661 7669 636f 6e20 7769 6c6c 2075  e favicon will u
+00014660: 7064 6174 6520 6576 6572 7920 3130 2073  pdate every 10 s
+00014670: 6563 6f6e 6473 2069 6e20 7468 6174 2063  econds in that c
+00014680: 6173 650a 2020 2a20 756e 6c69 6b65 6c79  ase.  * unlikely
+00014690: 2074 6f20 6265 2061 2070 726f 626c 656d   to be a problem
+000146a0: 2c20 6275 7420 6361 6e20 6861 7070 656e  , but can happen
+000146b0: 2077 6865 6e20 7570 6c6f 6469 6e67 206d   when uploding m
+000146c0: 616e 7920 736d 616c 6c20 6669 6c65 732c  any small files,
+000146d0: 206f 7220 796f 7572 2069 6e74 6572 6e65   or your interne
+000146e0: 7420 6973 2074 6f6f 2066 6173 742c 206f  t is too fast, o
+000146f0: 7220 5043 2074 6f6f 2073 6c6f 770a 0a0a  r PC too slow...
+00014700: 2320 7365 6375 7269 7479 0a0a 736f 6d65  # security..some
+00014710: 206e 6f74 6573 206f 6e20 6861 7264 656e   notes on harden
+00014720: 696e 670a 0a2a 2073 6574 2060 2d2d 7270  ing..* set `--rp
+00014730: 726f 7879 2030 6020 6966 2079 6f75 7220  roxy 0` if your 
+00014740: 636f 7079 7061 7274 7920 6973 2064 6972  copyparty is dir
+00014750: 6563 746c 7920 6661 6369 6e67 2074 6865  ectly facing the
+00014760: 2069 6e74 6572 6e65 7420 286e 6f74 2074   internet (not t
+00014770: 6872 6f75 6768 2061 2072 6576 6572 7365  hrough a reverse
+00014780: 2d70 726f 7879 290a 2020 2a20 636f 7273  -proxy).  * cors
+00014790: 2064 6f65 736e 2774 2077 6f72 6b20 7269   doesn't work ri
+000147a0: 6768 7420 6f74 6865 7277 6973 650a 0a73  ght otherwise..s
+000147b0: 6166 6574 7920 7072 6f66 696c 6573 3a0a  afety profiles:.
+000147c0: 0a2a 206f 7074 696f 6e20 602d 7360 2069  .* option `-s` i
+000147d0: 7320 6120 7368 6f72 7463 7574 2074 6f20  s a shortcut to 
+000147e0: 7365 7420 7468 6520 666f 6c6c 6f77 696e  set the followin
+000147f0: 6720 6f70 7469 6f6e 733a 0a20 202a 2060  g options:.  * `
+00014800: 2d2d 6e6f 2d74 6875 6d62 6020 6469 7361  --no-thumb` disa
+00014810: 626c 6573 2074 6875 6d62 6e61 696c 7320  bles thumbnails 
+00014820: 616e 6420 6175 6469 6f20 7472 616e 7363  and audio transc
+00014830: 6f64 696e 6720 746f 2073 746f 7020 636f  oding to stop co
+00014840: 7079 7061 7274 7920 6672 6f6d 2072 756e  pyparty from run
+00014850: 6e69 6e67 2060 4646 6d70 6567 602f 6050  ning `FFmpeg`/`P
+00014860: 696c 6c6f 7760 2f60 5649 5053 6020 6f6e  illow`/`VIPS` on
+00014870: 2075 706c 6f61 6465 6420 6669 6c65 732c   uploaded files,
+00014880: 2077 6869 6368 2069 7320 6120 5b67 6f6f   which is a [goo
+00014890: 6420 6964 6561 5d28 6874 7470 733a 2f2f  d idea](https://
+000148a0: 7777 772e 6376 6564 6574 6169 6c73 2e63  www.cvedetails.c
+000148b0: 6f6d 2f76 756c 6e65 7261 6269 6c69 7479  om/vulnerability
+000148c0: 2d6c 6973 742e 7068 703f 7665 6e64 6f72  -list.php?vendor
+000148d0: 5f69 643d 3336 3131 2920 6966 2061 6e6f  _id=3611) if ano
+000148e0: 6e79 6d6f 7573 2075 706c 6f61 6420 6973  nymous upload is
+000148f0: 2065 6e61 626c 6564 0a20 202a 2060 2d2d   enabled.  * `--
+00014900: 6e6f 2d6d 7461 672d 6666 6020 7573 6573  no-mtag-ff` uses
+00014910: 2060 6d75 7461 6765 6e60 2074 6f20 6772   `mutagen` to gr
+00014920: 6162 206d 7573 6963 2074 6167 7320 696e  ab music tags in
+00014930: 7374 6561 6420 6f66 2060 4646 6d70 6567  stead of `FFmpeg
+00014940: 602c 2077 6869 6368 2069 7320 7361 6665  `, which is safe
+00014950: 7220 616e 6420 6661 7374 6572 2062 7574  r and faster but
+00014960: 206c 6573 7320 6163 6375 7261 7465 0a20   less accurate. 
+00014970: 202a 2060 2d2d 646f 7470 6172 7460 2068   * `--dotpart` h
+00014980: 6964 6573 2075 706c 6f61 6473 2066 726f  ides uploads fro
+00014990: 6d20 6469 7265 6374 6f72 7920 6c69 7374  m directory list
+000149a0: 696e 6773 2077 6869 6c65 2074 6865 7927  ings while they'
+000149b0: 7265 2073 7469 6c6c 2069 6e63 6f6d 696e  re still incomin
+000149c0: 670a 2020 2a20 602d 2d6e 6f2d 726f 626f  g.  * `--no-robo
+000149d0: 7473 6020 616e 6420 602d 2d66 6f72 6365  ts` and `--force
+000149e0: 2d6a 7360 206d 616b 6573 206c 6966 6520  -js` makes life 
+000149f0: 6861 7264 6572 2066 6f72 2063 7261 776c  harder for crawl
+00014a00: 6572 732c 2073 6565 205b 6869 6469 6e67  ers, see [hiding
+00014a10: 2066 726f 6d20 676f 6f67 6c65 5d28 2368   from google](#h
+00014a20: 6964 696e 672d 6672 6f6d 2d67 6f6f 676c  iding-from-googl
+00014a30: 6529 0a0a 2a20 6f70 7469 6f6e 2060 2d73  e)..* option `-s
+00014a40: 7360 2069 7320 6120 7368 6f72 7463 7574  s` is a shortcut
+00014a50: 2066 6f72 2074 6865 2061 626f 7665 2070   for the above p
+00014a60: 6c75 733a 0a20 202a 2060 2d2d 756e 706f  lus:.  * `--unpo
+00014a70: 7374 2030 602c 2060 2d2d 6e6f 2d64 656c  st 0`, `--no-del
+00014a80: 602c 2060 2d2d 6e6f 2d6d 7660 2064 6973  `, `--no-mv` dis
+00014a90: 6162 6c65 7320 616c 6c20 6d6f 7665 2f64  ables all move/d
+00014aa0: 656c 6574 6520 7375 7070 6f72 740a 2020  elete support.  
+00014ab0: 2a20 602d 2d68 6172 646c 696e 6b60 2063  * `--hardlink` c
+00014ac0: 7265 6174 6573 2068 6172 646c 696e 6b73  reates hardlinks
+00014ad0: 2069 6e73 7465 6164 206f 6620 7379 6d6c   instead of syml
+00014ae0: 696e 6b73 2077 6865 6e20 6465 6475 706c  inks when dedupl
+00014af0: 6963 6174 696e 6720 7570 6c6f 6164 732c  icating uploads,
+00014b00: 2077 6869 6368 2069 7320 6c65 7373 206d   which is less m
+00014b10: 6169 6e74 656e 616e 6365 0a20 2020 202a  aintenance.    *
+00014b20: 2068 6f77 6576 6572 206e 6f74 6520 6966   however note if
+00014b30: 2079 6f75 2065 6469 7420 6f6e 6520 6669   you edit one fi
+00014b40: 6c65 2069 7420 7769 6c6c 2061 6c73 6f20  le it will also 
+00014b50: 6166 6665 6374 2074 6865 206f 7468 6572  affect the other
+00014b60: 2063 6f70 6965 730a 2020 2a20 602d 2d76   copies.  * `--v
+00014b70: 6167 7565 2d34 3031 6020 7265 7475 726e  ague-401` return
+00014b80: 7320 6120 2234 3034 206e 6f74 2066 6f75  s a "404 not fou
+00014b90: 6e64 2220 696e 7374 6561 6420 6f66 2022  nd" instead of "
+00014ba0: 3430 3120 756e 6175 7468 6f72 697a 6564  401 unauthorized
+00014bb0: 2220 7768 6963 6820 6973 2061 2063 6f6d  " which is a com
+00014bc0: 6d6f 6e20 656e 7465 7270 7269 7365 206d  mon enterprise m
+00014bd0: 656d 650a 2020 2a20 602d 2d62 616e 2d34  eme.  * `--ban-4
+00014be0: 3034 3d35 302c 3630 2c31 3434 3060 2062  04=50,60,1440` b
+00014bf0: 616e 2063 6c69 656e 7420 666f 7220 3134  an client for 14
+00014c00: 3430 6d69 6e20 2832 3468 2920 6966 2074  40min (24h) if t
+00014c10: 6865 7920 6869 7420 3530 2034 3034 2773  hey hit 50 404's
+00014c20: 2069 6e20 3630 6d69 6e0a 2020 2020 2a20   in 60min.    * 
+00014c30: 2a2a 4e42 3a2a 2a20 7769 6c6c 2062 616e  **NB:** will ban
+00014c40: 2061 6e79 6f6e 6520 7768 6f20 656e 6162   anyone who enab
+00014c50: 6c65 7320 7570 326b 2074 7572 626f 0a20  les up2k turbo. 
+00014c60: 202a 2060 2d2d 6e69 6860 2072 656d 6f76   * `--nih` remov
+00014c70: 6573 2074 6865 2073 6572 7665 7220 686f  es the server ho
+00014c80: 7374 6e61 6d65 2066 726f 6d20 6469 7265  stname from dire
+00014c90: 6374 6f72 7920 6c69 7374 696e 6773 0a0a  ctory listings..
+00014ca0: 2a20 6f70 7469 6f6e 2060 2d73 7373 6020  * option `-sss` 
+00014cb0: 6973 2061 2073 686f 7274 6375 7420 666f  is a shortcut fo
+00014cc0: 7220 7468 6520 6162 6f76 6520 706c 7573  r the above plus
+00014cd0: 3a0a 2020 2a20 602d 2d6e 6f2d 6461 7660  :.  * `--no-dav`
+00014ce0: 2064 6973 6162 6c65 7320 7765 6264 6176   disables webdav
+00014cf0: 2073 7570 706f 7274 0a20 202a 2060 2d2d   support.  * `--
+00014d00: 6e6f 2d6c 6f67 7565 7360 2061 6e64 2060  no-logues` and `
+00014d10: 2d2d 6e6f 2d72 6561 646d 6560 2064 6973  --no-readme` dis
+00014d20: 6162 6c65 7320 7375 7070 6f72 7420 666f  ables support fo
+00014d30: 7220 7265 6164 6d65 2773 2061 6e64 2070  r readme's and p
+00014d40: 726f 6c6f 6775 6573 202f 2065 7069 6c6f  rologues / epilo
+00014d50: 6775 6573 2069 6e20 6469 7265 6374 6f72  gues in director
+00014d60: 7920 6c69 7374 696e 6773 2c20 7768 6963  y listings, whic
+00014d70: 6820 6f74 6865 7277 6973 6520 6c65 7473  h otherwise lets
+00014d80: 2070 656f 706c 6520 7570 6c6f 6164 2061   people upload a
+00014d90: 7262 6974 7261 7279 2028 6275 7420 7361  rbitrary (but sa
+00014da0: 6e64 626f 7865 6429 2060 3c73 6372 6970  ndboxed) `<scrip
+00014db0: 743e 6020 7461 6773 0a20 202a 2060 2d6c  t>` tags.  * `-l
+00014dc0: 6f20 6370 702d 2559 2d25 6d25 642d 2548  o cpp-%Y-%m%d-%H
+00014dd0: 254d 2553 2e74 7874 2e78 7a60 2065 6e61  %M%S.txt.xz` ena
+00014de0: 626c 6573 206c 6f67 6769 6e67 2074 6f20  bles logging to 
+00014df0: 6469 736b 0a20 202a 2060 2d6c 7320 2a2a  disk.  * `-ls **
+00014e00: 2c2a 2c6c 6e2c 702c 7260 2064 6f65 7320  ,*,ln,p,r` does 
+00014e10: 6120 7363 616e 206f 6e20 7374 6172 7475  a scan on startu
+00014e20: 7020 666f 7220 616e 7920 6461 6e67 6572  p for any danger
+00014e30: 6f75 7320 7379 6d6c 696e 6b73 0a0a 6f74  ous symlinks..ot
+00014e40: 6865 7220 6d69 7363 206e 6f74 6573 3a0a  her misc notes:.
+00014e50: 0a2a 2079 6f75 2063 616e 2064 6973 6162  .* you can disab
+00014e60: 6c65 2064 6972 6563 746f 7279 206c 6973  le directory lis
+00014e70: 7469 6e67 7320 6279 2067 6976 696e 6720  tings by giving 
+00014e80: 7065 726d 6973 7369 6f6e 2060 6760 2069  permission `g` i
+00014e90: 6e73 7465 6164 206f 6620 6072 602c 206f  nstead of `r`, o
+00014ea0: 6e6c 7920 6163 6365 7074 696e 6720 6469  nly accepting di
+00014eb0: 7265 6374 2055 524c 7320 746f 2066 696c  rect URLs to fil
+00014ec0: 6573 0a20 202a 2063 6f6d 6269 6e65 2074  es.  * combine t
+00014ed0: 6869 7320 7769 7468 2076 6f6c 666c 6167  his with volflag
+00014ee0: 2060 632c 666b 6020 746f 2067 656e 6572   `c,fk` to gener
+00014ef0: 6174 6520 6669 6c65 6b65 7973 2028 7065  ate filekeys (pe
+00014f00: 722d 6669 6c65 2061 6363 6573 736b 6579  r-file accesskey
+00014f10: 7329 3b20 7573 6572 7320 7768 6963 6820  s); users which 
+00014f20: 6861 7665 2066 756c 6c20 7265 6164 2d61  have full read-a
+00014f30: 6363 6573 7320 7769 6c6c 2074 6865 6e20  ccess will then 
+00014f40: 7365 6520 5552 4c73 2077 6974 6820 603f  see URLs with `?
+00014f50: 6b3d 2e2e 2e60 2061 7070 656e 6465 6420  k=...` appended 
+00014f60: 746f 2074 6865 2065 6e64 2c20 616e 6420  to the end, and 
+00014f70: 6067 6020 7573 6572 7320 6d75 7374 2070  `g` users must p
+00014f80: 726f 7669 6465 2074 6861 7420 5552 4c20  rovide that URL 
+00014f90: 696e 636c 7564 696e 6720 7468 6520 636f  including the co
+00014fa0: 7272 6563 7420 6b65 7920 746f 2061 766f  rrect key to avo
+00014fb0: 6964 2061 2034 3034 0a20 2020 202a 2074  id a 404.    * t
+00014fc0: 6865 2064 6566 6175 6c74 2066 696c 656b  he default filek
+00014fd0: 6579 2065 6e74 726f 7079 2069 7320 6661  ey entropy is fa
+00014fe0: 6972 6c79 2073 6d61 6c6c 2073 6f20 6769  irly small so gi
+00014ff0: 7665 2060 2d2d 666b 2d73 616c 7460 2061  ve `--fk-salt` a
+00015000: 726f 756e 6420 3330 2063 6861 7261 6374  round 30 charact
+00015010: 6572 7320 6966 2079 6f75 2077 616e 7420  ers if you want 
+00015020: 6669 6c65 6b65 7973 206c 6f6e 6765 7220  filekeys longer 
+00015030: 7468 616e 2031 3620 6368 6172 730a 2020  than 16 chars.  
+00015040: 2a20 7065 726d 6973 7369 6f6e 7320 6077  * permissions `w
+00015050: 4760 206c 6574 7320 7573 6572 7320 7570  G` lets users up
+00015060: 6c6f 6164 2066 696c 6573 2061 6e64 2072  load files and r
+00015070: 6563 6569 7665 2074 6865 6972 206f 776e  eceive their own
+00015080: 2066 696c 656b 6579 732c 2073 7469 6c6c   filekeys, still
+00015090: 2077 6974 686f 7574 2062 6569 6e67 2061   without being a
+000150a0: 626c 6520 746f 2073 6565 206f 7468 6572  ble to see other
+000150b0: 2075 706c 6f61 6473 0a0a 0a23 2320 676f   uploads...## go
+000150c0: 7463 6861 730a 0a62 6568 6176 696f 7220  tchas..behavior 
+000150d0: 7468 6174 206d 6967 6874 2062 6520 756e  that might be un
+000150e0: 6578 7065 6374 6564 0a0a 2a20 7573 6572  expected..* user
+000150f0: 7320 7769 7468 6f75 7420 7265 6164 2d61  s without read-a
+00015100: 6363 6573 7320 746f 2061 2066 6f6c 6465  ccess to a folde
+00015110: 7220 6361 6e20 7374 696c 6c20 7365 6520  r can still see 
+00015120: 7468 6520 602e 7072 6f6c 6f67 7565 2e68  the `.prologue.h
+00015130: 746d 6c60 202f 2060 2e65 7069 6c6f 6775  tml` / `.epilogu
+00015140: 652e 6874 6d6c 6020 2f20 6052 4541 444d  e.html` / `READM
+00015150: 452e 6d64 6020 636f 6e74 656e 7473 2c20  E.md` contents, 
+00015160: 666f 7220 7468 6520 7075 7270 6f73 6520  for the purpose 
+00015170: 6f66 2073 686f 7769 6e67 2061 2064 6573  of showing a des
+00015180: 6372 6970 7469 6f6e 206f 6e20 686f 7720  cription on how 
+00015190: 746f 2075 7365 2074 6865 2075 706c 6f61  to use the uploa
+000151a0: 6465 7220 666f 7220 6578 616d 706c 650a  der for example.
+000151b0: 2a20 7573 6572 7320 6361 6e20 7375 626d  * users can subm
+000151c0: 6974 2060 3c73 6372 6970 743e 6073 2077  it `<script>`s w
+000151d0: 6869 6368 2061 7574 6f72 756e 2066 6f72  hich autorun for
+000151e0: 206f 7468 6572 2076 6973 6974 6f72 7320   other visitors 
+000151f0: 696e 2061 2066 6577 2077 6179 733b 0a20  in a few ways;. 
+00015200: 202a 2075 706c 6f61 6469 6e67 2061 2060   * uploading a `
+00015210: 5245 4144 4d45 2e6d 6460 202d 2d20 6176  README.md` -- av
+00015220: 6f69 6420 7769 7468 2060 2d2d 6e6f 2d72  oid with `--no-r
+00015230: 6561 646d 6560 0a20 202a 2072 656e 616d  eadme`.  * renam
+00015240: 696e 6720 6073 6f6d 652e 6874 6d6c 6020  ing `some.html` 
+00015250: 746f 2060 2e65 7069 6c6f 6775 652e 6874  to `.epilogue.ht
+00015260: 6d6c 6020 2d2d 2061 766f 6964 2077 6974  ml` -- avoid wit
+00015270: 6820 6569 7468 6572 2060 2d2d 6e6f 2d6c  h either `--no-l
+00015280: 6f67 7565 7360 206f 7220 602d 2d6e 6f2d  ogues` or `--no-
+00015290: 646f 742d 7265 6e60 0a20 202a 2074 6865  dot-ren`.  * the
+000152a0: 2064 6972 6563 746f 7279 2d6c 6973 7469   directory-listi
+000152b0: 6e67 2065 6d62 6564 2069 7320 7361 6e64  ng embed is sand
+000152c0: 626f 7865 6420 2873 6f20 616e 7920 6d61  boxed (so any ma
+000152d0: 6c69 6369 6f75 7320 7363 7269 7074 7320  licious scripts 
+000152e0: 6361 6e27 7420 646f 2061 6e79 2064 616d  can't do any dam
+000152f0: 6167 6529 2062 7574 2074 6865 206d 6172  age) but the mar
+00015300: 6b64 6f77 6e20 6564 6974 6f72 2069 7320  kdown editor is 
+00015310: 6e6f 740a 0a0a 2323 2063 6f72 730a 0a63  not...## cors..c
+00015320: 726f 7373 2d73 6974 6520 7265 7175 6573  ross-site reques
+00015330: 7420 636f 6e66 6967 0a0a 6279 2064 6566  t config..by def
+00015340: 6175 6c74 2c20 6578 6365 7074 2066 6f72  ault, except for
+00015350: 2060 4745 5460 2061 6e64 2060 4845 4144   `GET` and `HEAD
+00015360: 6020 6f70 6572 6174 696f 6e73 2c20 616c  ` operations, al
+00015370: 6c20 7265 7175 6573 7473 206d 7573 7420  l requests must 
+00015380: 6569 7468 6572 3a0a 2a20 6e6f 7420 636f  either:.* not co
+00015390: 6e74 6169 6e20 616e 2060 4f72 6967 696e  ntain an `Origin
+000153a0: 6020 6865 6164 6572 2061 7420 616c 6c0a  ` header at all.
+000153b0: 2a20 6f72 2068 6176 6520 616e 2060 4f72  * or have an `Or
+000153c0: 6967 696e 6020 6d61 7463 6869 6e67 2074  igin` matching t
+000153d0: 6865 2073 6572 7665 7220 646f 6d61 696e  he server domain
+000153e0: 0a2a 206f 7220 7468 6520 6865 6164 6572  .* or the header
+000153f0: 2060 5057 6020 7769 7468 2079 6f75 7220   `PW` with your 
+00015400: 7061 7373 776f 7264 2061 7320 7661 6c75  password as valu
+00015410: 650a 0a63 6f72 7320 6361 6e20 6265 2063  e..cors can be c
+00015420: 6f6e 6669 6775 7265 6420 7769 7468 2060  onfigured with `
+00015430: 2d2d 6163 616f 6020 616e 6420 602d 2d61  --acao` and `--a
+00015440: 6361 6d60 2c20 6f72 2074 6865 2070 726f  cam`, or the pro
+00015450: 7465 6374 696f 6e73 2065 6e74 6972 656c  tections entirel
+00015460: 7920 6469 7361 626c 6564 2077 6974 6820  y disabled with 
+00015470: 602d 2d61 6c6c 6f77 2d63 7372 6660 0a0a  `--allow-csrf`..
+00015480: 0a23 2320 6874 7470 730a 0a62 6f74 6820  .## https..both 
+00015490: 4854 5450 2061 6e64 2048 5454 5053 2061  HTTP and HTTPS a
+000154a0: 7265 2061 6363 6570 7465 6420 2062 7920  re accepted  by 
+000154b0: 6465 6661 756c 742c 2062 7574 206c 6574  default, but let
+000154c0: 7469 6e67 2061 205b 7265 7665 7273 6520  ting a [reverse 
+000154d0: 7072 6f78 795d 2823 7265 7665 7273 652d  proxy](#reverse-
+000154e0: 7072 6f78 7929 2068 616e 646c 6520 7468  proxy) handle th
+000154f0: 6520 6874 7470 732f 746c 732f 7373 6c20  e https/tls/ssl 
+00015500: 776f 756c 6420 6265 2062 6574 7465 7220  would be better 
+00015510: 2870 726f 6261 626c 7920 6d6f 7265 2073  (probably more s
+00015520: 6563 7572 6520 6279 2064 6566 6175 6c74  ecure by default
+00015530: 290a 0a63 6f70 7970 6172 7479 2064 6f65  )..copyparty doe
+00015540: 736e 2774 2073 7065 616b 2048 5454 502f  sn't speak HTTP/
+00015550: 3220 6f72 2051 5549 432c 2073 6f20 7573  2 or QUIC, so us
+00015560: 696e 6720 6120 7265 7665 7273 6520 7072  ing a reverse pr
+00015570: 6f78 7920 776f 756c 6420 736f 6c76 6520  oxy would solve 
+00015580: 7468 6174 2061 7320 7765 6c6c 0a0a 0a23  that as well...#
+00015590: 2072 6563 6f76 6572 696e 6720 6672 6f6d   recovering from
+000155a0: 2063 7261 7368 6573 0a0a 2323 2063 6c69   crashes..## cli
+000155b0: 656e 7420 6372 6173 6865 730a 0a23 2323  ent crashes..###
+000155c0: 2066 7265 666f 7820 7773 6f64 0a0a 6669   frefox wsod..fi
+000155d0: 7265 666f 7820 3837 2063 616e 2063 7261  refox 87 can cra
+000155e0: 7368 2064 7572 696e 6720 7570 6c6f 6164  sh during upload
+000155f0: 7320 202d 2d20 7468 6520 656e 7469 7265  s  -- the entire
+00015600: 2062 726f 7773 6572 2067 6f65 732c 2069   browser goes, i
+00015610: 6e63 6c75 6469 6e67 2061 6c6c 206f 7468  ncluding all oth
+00015620: 6572 2062 726f 7773 6572 2074 6162 732c  er browser tabs,
+00015630: 2065 7665 7279 7468 696e 6720 7475 726e   everything turn
+00015640: 7320 7768 6974 650a 0a68 6f77 6576 6572  s white..however
+00015650: 2079 6f75 2063 616e 2068 6974 2060 4631   you can hit `F1
+00015660: 3260 2069 6e20 7468 6520 7570 326b 2074  2` in the up2k t
+00015670: 6162 2061 6e64 2075 7365 2074 6865 2064  ab and use the d
+00015680: 6576 746f 6f6c 7320 746f 2073 6565 2068  evtools to see h
+00015690: 6f77 2066 6172 2079 6f75 2067 6f74 2069  ow far you got i
+000156a0: 6e20 7468 6520 7570 6c6f 6164 733a 0a0a  n the uploads:..
+000156b0: 2a20 6765 7420 6120 636f 6d70 6c65 7465  * get a complete
+000156c0: 206c 6973 7420 6f66 2061 6c6c 2075 706c   list of all upl
+000156d0: 6f61 6473 2c20 6f72 6761 6e69 7a65 6420  oads, organized 
+000156e0: 6279 2073 7461 7475 7473 2028 6f6b 202f  by statuts (ok /
+000156f0: 206e 6f2d 676f 6f64 202f 2062 7573 7920   no-good / busy 
+00015700: 2f20 7175 6575 6564 293a 2020 0a20 2060  / queued):  .  `
+00015710: 7661 7220 7461 6273 203d 207b 206f 6b3a  var tabs = { ok:
+00015720: 5b5d 2c20 6e67 3a5b 5d2c 2062 7a3a 5b5d  [], ng:[], bz:[]
+00015730: 2c20 713a 5b5d 207d 3b20 666f 7220 2876  , q:[] }; for (v
+00015740: 6172 2061 206f 6620 7570 326b 2e75 692e  ar a of up2k.ui.
+00015750: 7461 6229 2074 6162 735b 612e 696e 5d2e  tab) tabs[a.in].
+00015760: 7075 7368 2861 293b 2074 6162 7360 0a0a  push(a); tabs`..
+00015770: 2a20 6c69 7374 206f 6620 6669 6c65 6e61  * list of filena
+00015780: 6d65 7320 7768 6963 6820 6661 696c 6564  mes which failed
+00015790: 3a20 200a 2020 60e2 808b 7661 7220 6e67  :  .  `...var ng
+000157a0: 203d 205b 5d3b 2066 6f72 2028 7661 7220   = []; for (var 
+000157b0: 6120 6f66 2075 7032 6b2e 7569 2e74 6162  a of up2k.ui.tab
+000157c0: 2920 6966 2028 612e 696e 2021 3d20 276f  ) if (a.in != 'o
+000157d0: 6b27 2920 6e67 2e70 7573 6828 612e 686e  k') ng.push(a.hn
+000157e0: 2e73 706c 6974 2827 3c61 2068 7265 663d  .split('<a href=
+000157f0: 5c22 2729 2e73 6c69 6365 282d 3129 5b30  \"').slice(-1)[0
+00015800: 5d2e 7370 6c69 7428 275c 223e 2729 5b30  ].split('\">')[0
+00015810: 5d29 3b20 6e67 600a 0a2a 2073 656e 6420  ]); ng`..* send 
+00015820: 7468 6520 6c69 7374 206f 6620 6669 6c65  the list of file
+00015830: 6e61 6d65 7320 746f 2063 6f70 7970 6172  names to copypar
+00015840: 7479 2066 6f72 2073 6166 656b 6565 7069  ty for safekeepi
+00015850: 6e67 3a20 200a 2020 6061 7761 6974 2066  ng:  .  `await f
+00015860: 6574 6368 2827 2f69 6e63 272c 207b 6d65  etch('/inc', {me
+00015870: 7468 6f64 3a27 5055 5427 2c20 626f 6479  thod:'PUT', body
+00015880: 3a4a 534f 4e2e 7374 7269 6e67 6966 7928  :JSON.stringify(
+00015890: 6e67 2c6e 756c 6c2c 3129 7d29 600a 0a0a  ng,null,1)})`...
+000158a0: 2320 4854 5450 2041 5049 0a0a 7365 6520  # HTTP API..see 
+000158b0: 5b64 6576 6e6f 7465 735d 282e 2f64 6f63  [devnotes](./doc
+000158c0: 732f 6465 766e 6f74 6573 2e6d 6423 6874  s/devnotes.md#ht
+000158d0: 7470 2d61 7069 290a 0a0a 2320 6465 7065  tp-api)...# depe
+000158e0: 6e64 656e 6369 6573 0a0a 6d61 6e64 6174  ndencies..mandat
+000158f0: 6f72 7920 6465 7073 3a0a 2a20 606a 696e  ory deps:.* `jin
+00015900: 6a61 3260 2028 6973 2062 7569 6c74 2069  ja2` (is built i
+00015910: 6e74 6f20 7468 6520 5346 5829 0a0a 0a23  nto the SFX)...#
+00015920: 2320 6f70 7469 6f6e 616c 2064 6570 656e  # optional depen
+00015930: 6465 6e63 6965 730a 0a69 6e73 7461 6c6c  dencies..install
+00015940: 2074 6865 7365 2074 6f20 656e 6162 6c65   these to enable
+00015950: 2062 6f6e 7573 2066 6561 7475 7265 730a   bonus features.
+00015960: 0a65 6e61 626c 6520 6674 702d 7365 7276  .enable ftp-serv
+00015970: 6572 3a0a 2a20 666f 7220 6a75 7374 2070  er:.* for just p
+00015980: 6c61 696e 7465 7874 2046 5450 2c20 6070  laintext FTP, `p
+00015990: 7966 7470 646c 6962 6020 2869 7320 6275  yftpdlib` (is bu
+000159a0: 696c 7420 696e 746f 2074 6865 2053 4658  ilt into the SFX
+000159b0: 290a 2a20 7769 7468 2054 4c53 2065 6e63  ).* with TLS enc
+000159c0: 7279 7074 696f 6e2c 2060 7079 6674 7064  ryption, `pyftpd
+000159d0: 6c69 6220 7079 6f70 656e 7373 6c60 0a0a  lib pyopenssl`..
+000159e0: 656e 6162 6c65 206d 7573 6963 2074 6167  enable music tag
+000159f0: 733a 0a2a 2065 6974 6865 7220 606d 7574  s:.* either `mut
+00015a00: 6167 656e 6020 2866 6173 742c 2070 7572  agen` (fast, pur
+00015a10: 652d 7079 7468 6f6e 2c20 736b 6970 7320  e-python, skips 
+00015a20: 6120 6665 7720 7461 6773 2c20 6d61 6b65  a few tags, make
+00015a30: 7320 636f 7079 7061 7274 7920 4750 4c3f  s copyparty GPL?
+00015a40: 2069 646b 290a 2a20 6f72 2060 6666 7072   idk).* or `ffpr
+00015a50: 6f62 6560 2028 3230 7820 736c 6f77 6572  obe` (20x slower
+00015a60: 2c20 6d6f 7265 2061 6363 7572 6174 652c  , more accurate,
+00015a70: 2070 6f73 7369 626c 7920 6461 6e67 6572   possibly danger
+00015a80: 6f75 7320 6465 7065 6e64 696e 6720 6f6e  ous depending on
+00015a90: 2079 6f75 7220 6469 7374 726f 2061 6e64   your distro and
+00015aa0: 2075 7365 7273 290a 0a65 6e61 626c 6520   users)..enable 
+00015ab0: 5b74 6875 6d62 6e61 696c 735d 2823 7468  [thumbnails](#th
+00015ac0: 756d 626e 6169 6c73 2920 6f66 2e2e 2e0a  umbnails) of....
+00015ad0: 2a20 2a2a 696d 6167 6573 3a2a 2a20 6050  * **images:** `P
+00015ae0: 696c 6c6f 7760 2061 6e64 2f6f 7220 6070  illow` and/or `p
+00015af0: 7976 6970 7360 2061 6e64 2f6f 7220 6066  yvips` and/or `f
+00015b00: 666d 7065 6760 2028 7265 7175 6972 6573  fmpeg` (requires
+00015b10: 2070 7932 2e37 206f 7220 7079 332e 352b   py2.7 or py3.5+
+00015b20: 290a 2a20 2a2a 7669 6465 6f73 2f61 7564  ).* **videos/aud
+00015b30: 696f 3a2a 2a20 6066 666d 7065 6760 2061  io:** `ffmpeg` a
+00015b40: 6e64 2060 6666 7072 6f62 6560 2073 6f6d  nd `ffprobe` som
+00015b50: 6577 6865 7265 2069 6e20 6024 5041 5448  ewhere in `$PATH
+00015b60: 600a 2a20 2a2a 4845 4946 2070 6963 7475  `.* **HEIF pictu
+00015b70: 7265 733a 2a2a 2060 7079 7669 7073 6020  res:** `pyvips` 
+00015b80: 6f72 2060 6666 6d70 6567 6020 6f72 2060  or `ffmpeg` or `
+00015b90: 7079 6865 6966 2d70 696c 6c6f 772d 6f70  pyheif-pillow-op
+00015ba0: 656e 6572 6020 2872 6571 7569 7265 7320  ener` (requires 
+00015bb0: 4c69 6e75 7820 6f72 2061 2043 2063 6f6d  Linux or a C com
+00015bc0: 7069 6c65 7229 0a2a 202a 2a41 5649 4620  piler).* **AVIF 
+00015bd0: 7069 6374 7572 6573 3a2a 2a20 6070 7976  pictures:** `pyv
+00015be0: 6970 7360 206f 7220 6066 666d 7065 6760  ips` or `ffmpeg`
+00015bf0: 206f 7220 6070 696c 6c6f 772d 6176 6966   or `pillow-avif
+00015c00: 2d70 6c75 6769 6e60 0a2a 202a 2a4a 5045  -plugin`.* **JPE
+00015c10: 4720 584c 2070 6963 7475 7265 733a 2a2a  G XL pictures:**
+00015c20: 2060 7079 7669 7073 6020 6f72 2060 6666   `pyvips` or `ff
+00015c30: 6d70 6567 600a 0a65 6e61 626c 6520 5b73  mpeg`..enable [s
+00015c40: 6d62 5d28 2373 6d62 2d73 6572 7665 7229  mb](#smb-server)
+00015c50: 2073 7570 706f 7274 2028 2a2a 6e6f 742a   support (**not*
+00015c60: 2a20 7265 636f 6d6d 656e 6465 6429 3a0a  * recommended):.
+00015c70: 2a20 6069 6d70 6163 6b65 743d 3d30 2e31  * `impacket==0.1
+00015c80: 302e 3060 0a0a 6070 7976 6970 7360 2067  0.0`..`pyvips` g
+00015c90: 6976 6573 2068 6967 6865 7220 7175 616c  ives higher qual
+00015ca0: 6974 7920 7468 756d 626e 6169 6c73 2074  ity thumbnails t
+00015cb0: 6861 6e20 6050 696c 6c6f 7760 2061 6e64  han `Pillow` and
+00015cc0: 2069 7320 3332 3025 2066 6173 7465 722c   is 320% faster,
+00015cd0: 2075 7369 6e67 2032 3730 2520 6d6f 7265   using 270% more
+00015ce0: 2072 616d 3a20 6073 7564 6f20 6170 7420   ram: `sudo apt 
+00015cf0: 696e 7374 616c 6c20 6c69 6276 6970 7334  install libvips4
+00015d00: 3220 2626 2070 7974 686f 6e33 202d 6d20  2 && python3 -m 
+00015d10: 7069 7020 696e 7374 616c 6c20 2d2d 7573  pip install --us
+00015d20: 6572 202d 5520 7079 7669 7073 600a 0a0a  er -U pyvips`...
+00015d30: 2323 206f 7074 696f 6e61 6c20 6770 6c20  ## optional gpl 
+00015d40: 7374 7566 660a 0a73 6f6d 6520 6275 6e64  stuff..some bund
+00015d50: 6c65 6420 746f 6f6c 7320 6861 7665 2063  led tools have c
+00015d60: 6f70 796c 6566 7420 6465 7065 6e64 656e  opyleft dependen
+00015d70: 6369 6573 2c20 7365 6520 5b2e 2f62 696e  cies, see [./bin
+00015d80: 2f23 6d74 6167 5d28 6269 6e2f 236d 7461  /#mtag](bin/#mta
+00015d90: 6729 0a0a 7468 6573 6520 6172 6520 7374  g)..these are st
+00015da0: 616e 6461 6c6f 6e65 2070 726f 6772 616d  andalone program
+00015db0: 7320 616e 6420 7769 6c6c 206e 6576 6572  s and will never
+00015dc0: 2062 6520 696d 706f 7274 6564 202f 2065   be imported / e
+00015dd0: 7661 6c75 6174 6564 2062 7920 636f 7079  valuated by copy
+00015de0: 7061 7274 792c 2061 6e64 206d 7573 7420  party, and must 
+00015df0: 6265 2065 6e61 626c 6564 2074 6872 6f75  be enabled throu
+00015e00: 6768 2060 2d6d 7470 6020 636f 6e66 6967  gh `-mtp` config
+00015e10: 730a 0a0a 2320 7366 780a 0a74 6865 2073  s...# sfx..the s
+00015e20: 656c 662d 636f 6e74 6169 6e65 6420 2262  elf-contained "b
+00015e30: 696e 6172 7922 2020 5b63 6f70 7970 6172  inary"  [copypar
+00015e40: 7479 2d73 6678 2e70 795d 2868 7474 7073  ty-sfx.py](https
+00015e50: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00015e60: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
+00015e70: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
+00015e80: 6e6c 6f61 642f 636f 7079 7061 7274 792d  nload/copyparty-
+00015e90: 7366 782e 7079 2920 7769 6c6c 2075 6e70  sfx.py) will unp
+00015ea0: 6163 6b20 6974 7365 6c66 2061 6e64 2072  ack itself and r
+00015eb0: 756e 2063 6f70 7970 6172 7479 2c20 6173  un copyparty, as
+00015ec0: 7375 6d69 6e67 2079 6f75 2068 6176 6520  suming you have 
+00015ed0: 7079 7468 6f6e 2069 6e73 7461 6c6c 6564  python installed
+00015ee0: 206f 6620 636f 7572 7365 0a0a 796f 7520   of course..you 
+00015ef0: 6361 6e20 7265 6475 6365 2074 6865 2073  can reduce the s
+00015f00: 6678 2073 697a 6520 6279 2072 6570 6163  fx size by repac
+00015f10: 6b69 6e67 2069 743b 2073 6565 205b 2e2f  king it; see [./
+00015f20: 646f 6373 2f64 6576 6e6f 7465 732e 6d64  docs/devnotes.md
+00015f30: 2373 6678 2d72 6570 6163 6b5d 282e 2f64  #sfx-repack](./d
+00015f40: 6f63 732f 6465 766e 6f74 6573 2e6d 6423  ocs/devnotes.md#
+00015f50: 7366 782d 7265 7061 636b 290a 0a0a 2323  sfx-repack)...##
+00015f60: 2063 6f70 7970 6172 7479 2e65 7865 0a0a   copyparty.exe..
+00015f70: 646f 776e 6c6f 6164 205b 636f 7079 7061  download [copypa
+00015f80: 7274 792e 6578 655d 2868 7474 7073 3a2f  rty.exe](https:/
+00015f90: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00015fa0: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
+00015fb0: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
+00015fc0: 6f61 642f 636f 7079 7061 7274 792e 6578  oad/copyparty.ex
+00015fd0: 6529 2028 7769 6e38 2b29 206f 7220 5b63  e) (win8+) or [c
+00015fe0: 6f70 7970 6172 7479 3332 2e65 7865 5d28  opyparty32.exe](
+00015ff0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016000: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00016010: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
+00016020: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
+00016030: 6172 7479 3332 2e65 7865 2920 2877 696e  arty32.exe) (win
+00016040: 372b 290a 0a21 5b63 6f70 7970 6172 7479  7+)..![copyparty
+00016050: 2d65 7865 2d66 7338 5d28 6874 7470 733a  -exe-fs8](https:
+00016060: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+00016070: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+00016080: 636f 6d2f 3234 3130 3332 2f32 3231 3434  com/241032/22144
+00016090: 3539 3436 2d31 6533 3238 6535 362d 3863  5946-1e328e56-8c
+000160a0: 3562 2d34 3461 392d 3862 3966 2d64 6565  5b-44a9-8b9f-dee
+000160b0: 3834 6439 3432 3533 352e 706e 6729 0a0a  84d942535.png)..
+000160c0: 6361 6e20 6265 2063 6f6e 7665 6e69 656e  can be convenien
+000160d0: 7420 6f6e 206d 6163 6869 6e65 7320 7768  t on machines wh
+000160e0: 6572 6520 696e 7374 616c 6c69 6e67 2070  ere installing p
+000160f0: 7974 686f 6e20 6973 2070 726f 626c 656d  ython is problem
+00016100: 6174 6963 2c20 686f 7765 7665 7220 6973  atic, however is
+00016110: 202a 2a6e 6f74 2072 6563 6f6d 6d65 6e64   **not recommend
+00016120: 6564 2a2a 202d 2d20 6966 2070 6f73 7369  ed** -- if possi
+00016130: 626c 652c 2070 6c65 6173 6520 7573 6520  ble, please use 
+00016140: 2a2a 5b63 6f70 7970 6172 7479 2d73 6678  **[copyparty-sfx
+00016150: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
+00016160: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+00016170: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+00016180: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+00016190: 636f 7079 7061 7274 792d 7366 782e 7079  copyparty-sfx.py
+000161a0: 292a 2a20 696e 7374 6561 640a 0a2a 205b  )** instead..* [
+000161b0: 636f 7079 7061 7274 792e 6578 655d 2868  copyparty.exe](h
+000161c0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000161d0: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
+000161e0: 2f72 656c 6561 7365 732f 6c61 7465 7374  /releases/latest
+000161f0: 2f64 6f77 6e6c 6f61 642f 636f 7079 7061  /download/copypa
+00016200: 7274 792e 6578 6529 2072 756e 7320 6f6e  rty.exe) runs on
+00016210: 2077 696e 3820 6f72 206e 6577 6572 2c20   win8 or newer, 
+00016220: 7761 7320 636f 6d70 696c 6564 206f 6e20  was compiled on 
+00016230: 7769 6e31 302c 2064 6f65 7320 7468 756d  win10, does thum
+00016240: 626e 6169 6c73 202b 206d 6564 6961 2074  bnails + media t
+00016250: 6167 732c 2061 6e64 2069 7320 2a63 7572  ags, and is *cur
+00016260: 7265 6e74 6c79 2a20 7361 6665 2074 6f20  rently* safe to 
+00016270: 7573 652c 2062 7574 2061 6e79 2066 7574  use, but any fut
+00016280: 7572 6520 7079 7468 6f6e 2f65 7870 6174  ure python/expat
+00016290: 2f70 696c 6c6f 7720 4356 4573 2063 616e  /pillow CVEs can
+000162a0: 206f 6e6c 7920 6265 2072 656d 6564 6965   only be remedie
+000162b0: 6420 6279 2064 6f77 6e6c 6f61 6469 6e67  d by downloading
+000162c0: 2061 206e 6577 6572 2076 6572 7369 6f6e   a newer version
+000162d0: 206f 6620 7468 6520 6578 650a 0a20 202a   of the exe..  *
+000162e0: 206f 6e20 7769 6e38 2069 7420 6e65 6564   on win8 it need
+000162f0: 7320 5b76 6320 7265 6469 7374 2032 3031  s [vc redist 201
+00016300: 355d 2868 7474 7073 3a2f 2f77 7777 2e6d  5](https://www.m
+00016310: 6963 726f 736f 6674 2e63 6f6d 2f65 6e2d  icrosoft.com/en-
+00016320: 7573 2f64 6f77 6e6c 6f61 642f 6465 7461  us/download/deta
+00016330: 696c 732e 6173 7078 3f69 643d 3438 3134  ils.aspx?id=4814
+00016340: 3529 2c20 6f6e 2077 696e 3130 2069 7420  5), on win10 it 
+00016350: 6a75 7374 2077 6f72 6b73 0a20 202a 2073  just works.  * s
+00016360: 6f6d 6520 616e 7469 7669 7275 7320 6d61  ome antivirus ma
+00016370: 7920 6672 6561 6b20 6f75 7420 2866 616c  y freak out (fal
+00016380: 7365 2d70 6f73 6974 6976 6529 2c20 706f  se-positive), po
+00016390: 7373 6962 6c79 205b 4176 6173 742c 2041  ssibly [Avast, A
+000163a0: 5647 2c20 616e 6420 4d63 4166 6565 5d28  VG, and McAfee](
+000163b0: 6874 7470 733a 2f2f 7777 772e 7669 7275  https://www.viru
+000163c0: 7374 6f74 616c 2e63 6f6d 2f67 7569 2f66  stotal.com/gui/f
+000163d0: 696c 652f 3532 3339 3161 3165 3938 3432  ile/52391a1e9842
+000163e0: 6366 3730 6164 3234 3365 6638 3338 3434  cf70ad243ef83844
+000163f0: 6434 3664 3239 6330 3034 3464 3130 3165  d46d29c0044d101e
+00016400: 6530 3133 3866 6364 6433 6338 6465 3232  e0138fcdd3c8de22
+00016410: 3337 6436 2f64 6574 6563 7469 6f6e 290a  37d6/detection).
+00016420: 0a2a 2064 616e 6765 726f 7573 3a20 5b63  .* dangerous: [c
+00016430: 6f70 7970 6172 7479 3332 2e65 7865 5d28  opyparty32.exe](
+00016440: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016450: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00016460: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
+00016470: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
+00016480: 6172 7479 3332 2e65 7865 2920 6973 2063  arty32.exe) is c
+00016490: 6f6d 7061 7469 626c 6520 7769 7468 205b  ompatible with [
+000164a0: 7769 6e64 6f77 7337 5d28 6874 7470 733a  windows7](https:
+000164b0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000164c0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000164d0: 636f 6d2f 3234 3130 3332 2f32 3231 3434  com/241032/22144
+000164e0: 3539 3434 2d61 6538 3564 3166 342d 6433  5944-ae85d1f4-d3
+000164f0: 3531 2d34 3833 372d 6231 3330 2d38 3263  51-4837-b130-82c
+00016500: 6162 3537 6436 6363 612e 706e 6729 2c20  ab57d6cca.png), 
+00016510: 7768 6963 6820 6d65 616e 7320 6974 2075  which means it u
+00016520: 7365 7320 616e 2061 6e63 6965 6e74 2063  ses an ancient c
+00016530: 6f70 7920 6f66 2070 7974 686f 6e20 2833  opy of python (3
+00016540: 2e37 2e39 2920 7768 6963 6820 6361 6e6e  .7.9) which cann
+00016550: 6f74 2062 6520 7570 6772 6164 6564 2061  ot be upgraded a
+00016560: 6e64 2073 686f 756c 6420 6e65 7665 7220  nd should never 
+00016570: 6265 2065 7870 6f73 6564 2074 6f20 7468  be exposed to th
+00016580: 6520 696e 7465 726e 6574 2028 4c41 4e20  e internet (LAN 
+00016590: 6973 2066 696e 6529 0a0a 2a20 6461 6e67  is fine)..* dang
+000165a0: 6572 6f75 7320 616e 6420 6465 7072 6563  erous and deprec
+000165b0: 6174 6564 3a20 5b63 6f70 7970 6172 7479  ated: [copyparty
+000165c0: 2d77 696e 7065 3634 2e65 7865 5d28 6874  -winpe64.exe](ht
+000165d0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
+000165e0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
+000165f0: 7265 6c65 6173 6573 2f64 6f77 6e6c 6f61  releases/downloa
+00016600: 642f 7631 2e36 2e38 2f63 6f70 7970 6172  d/v1.6.8/copypar
+00016610: 7479 2d77 696e 7065 3634 2e65 7865 2920  ty-winpe64.exe) 
+00016620: 6c65 7473 2079 6f75 205b 7275 6e20 636f  lets you [run co
+00016630: 7079 7061 7274 7920 696e 2057 696e 5045  pyparty in WinPE
+00016640: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00016650: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00016660: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00016670: 3332 2f32 3035 3435 3439 3834 2d65 3662  32/205454984-e6b
+00016680: 3535 3064 662d 3363 3439 2d34 3836 642d  550df-3c49-486d-
+00016690: 3932 3637 2d31 3631 3430 3738 6464 3064  9267-1614078dd0d
+000166a0: 642e 706e 6729 2061 6e64 2069 7320 6f74  d.png) and is ot
+000166b0: 6865 7277 6973 6520 636f 6d70 6c65 7465  herwise complete
+000166c0: 6c79 2075 7365 6c65 7373 0a0a 6d65 616e  ly useless..mean
+000166d0: 7768 696c 6520 5b63 6f70 7970 6172 7479  while [copyparty
+000166e0: 2d73 6678 2e70 795d 2868 7474 7073 3a2f  -sfx.py](https:/
+000166f0: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00016700: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
+00016710: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
+00016720: 6f61 642f 636f 7079 7061 7274 792d 7366  oad/copyparty-sf
+00016730: 782e 7079 2920 696e 7374 6561 6420 7265  x.py) instead re
+00016740: 6c69 6573 206f 6e20 796f 7572 2073 7973  lies on your sys
+00016750: 7465 6d20 7079 7468 6f6e 2077 6869 6368  tem python which
+00016760: 2067 6976 6573 2062 6574 7465 7220 7065   gives better pe
+00016770: 7266 6f72 6d61 6e63 6520 616e 6420 7769  rformance and wi
+00016780: 6c6c 2073 7461 7920 7361 6665 2061 7320  ll stay safe as 
+00016790: 6c6f 6e67 2061 7320 796f 7520 6b65 6570  long as you keep
+000167a0: 2079 6f75 7220 7079 7468 6f6e 2069 6e73   your python ins
+000167b0: 7461 6c6c 2075 702d 746f 2d64 6174 650a  tall up-to-date.
+000167c0: 0a74 6865 6e20 6167 6169 6e2c 2069 6620  .then again, if 
+000167d0: 796f 7520 6172 6520 616c 7265 6164 7920  you are already 
+000167e0: 696e 746f 2064 6f77 6e6c 6f61 6469 6e67  into downloading
+000167f0: 2073 6861 6479 2062 696e 6172 6965 7320   shady binaries 
+00016800: 6672 6f6d 2074 6865 2069 6e74 6572 6e65  from the interne
+00016810: 742c 2079 6f75 206d 6179 2061 6c73 6f20  t, you may also 
+00016820: 7761 6e74 206d 7920 5b6d 696e 696d 616c  want my [minimal
+00016830: 2062 7569 6c64 735d 282e 2f73 6372 6970   builds](./scrip
+00016840: 7473 2f70 7969 6e73 7461 6c6c 6572 2366  ts/pyinstaller#f
+00016850: 666d 7065 6729 206f 6620 5b66 666d 7065  fmpeg) of [ffmpe
+00016860: 675d 2868 7474 7073 3a2f 2f6f 6376 2e6d  g](https://ocv.m
+00016870: 652f 7374 7566 662f 6269 6e2f 6666 6d70  e/stuff/bin/ffmp
+00016880: 6567 2e65 7865 2920 616e 6420 5b66 6670  eg.exe) and [ffp
+00016890: 726f 6265 5d28 6874 7470 733a 2f2f 6f63  robe](https://oc
+000168a0: 762e 6d65 2f73 7475 6666 2f62 696e 2f66  v.me/stuff/bin/f
+000168b0: 6670 726f 6265 2e65 7865 2920 7768 6963  fprobe.exe) whic
+000168c0: 6820 656e 6162 6c65 7320 636f 7079 7061  h enables copypa
+000168d0: 7274 7920 746f 2065 7874 7261 6374 206d  rty to extract m
+000168e0: 756c 7469 6d65 6469 612d 696e 666f 2c20  ultimedia-info, 
+000168f0: 646f 2061 7564 696f 2d74 7261 6e73 636f  do audio-transco
+00016900: 6469 6e67 2c20 616e 6420 7468 756d 626e  ding, and thumbn
+00016910: 6169 6c73 2f73 7065 6374 726f 6772 616d  ails/spectrogram
+00016920: 732f 7761 7665 666f 726d 732c 2068 6f77  s/waveforms, how
+00016930: 6576 6572 2069 7427 7320 6d75 6368 2062  ever it's much b
+00016940: 6574 7465 7220 746f 2069 6e73 7465 6164  etter to instead
+00016950: 2067 7261 6220 6120 5b72 6563 656e 7420   grab a [recent 
+00016960: 6f66 6669 6369 616c 2062 7569 6c64 5d28  official build](
+00016970: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00016980: 6f6d 2f42 7462 4e2f 4646 6d70 6567 2d42  om/BtbN/FFmpeg-B
+00016990: 7569 6c64 732f 7265 6c65 6173 6573 2f64  uilds/releases/d
+000169a0: 6f77 6e6c 6f61 642f 6c61 7465 7374 2f66  ownload/latest/f
+000169b0: 666d 7065 672d 6d61 7374 6572 2d6c 6174  fmpeg-master-lat
+000169c0: 6573 742d 7769 6e36 342d 6770 6c2e 7a69  est-win64-gpl.zi
+000169d0: 7029 2065 7665 7279 206f 6e63 6520 696e  p) every once in
+000169e0: 6120 7768 696c 6520 6966 2079 6f75 2063  a while if you c
+000169f0: 616e 2061 6666 6f72 6420 7468 6520 7369  an afford the si
+00016a00: 7a65 0a0a 0a23 2069 6e73 7461 6c6c 206f  ze...# install o
+00016a10: 6e20 616e 6472 6f69 640a 0a69 6e73 7461  n android..insta
+00016a20: 6c6c 205b 5465 726d 7578 5d28 6874 7470  ll [Termux](http
+00016a30: 733a 2f2f 7465 726d 7578 2e63 6f6d 2f29  s://termux.com/)
+00016a40: 202b 2069 7473 2063 6f6d 7061 6e69 6f6e   + its companion
+00016a50: 2061 7070 2060 5465 726d 7578 3a41 5049   app `Termux:API
+00016a60: 6020 2873 6565 205b 6f63 762e 6d65 2f74  ` (see [ocv.me/t
+00016a70: 6572 6d75 785d 2868 7474 7073 3a2f 2f6f  ermux](https://o
+00016a80: 6376 2e6d 652f 7465 726d 7578 2f29 2920  cv.me/termux/)) 
+00016a90: 616e 6420 7468 656e 2063 6f70 792d 7061  and then copy-pa
+00016aa0: 7374 6520 7468 6973 2069 6e74 6f20 5465  ste this into Te
+00016ab0: 726d 7578 2028 6c6f 6e67 2d74 6170 2920  rmux (long-tap) 
+00016ac0: 616c 6c20 6174 206f 6e63 653a 0a60 6060  all at once:.```
+00016ad0: 7368 0a79 6573 207c 2070 6b67 2075 7067  sh.yes | pkg upg
+00016ae0: 7261 6465 2026 2620 7465 726d 7578 2d73  rade && termux-s
+00016af0: 6574 7570 2d73 746f 7261 6765 2026 2620  etup-storage && 
+00016b00: 7965 7320 7c20 706b 6720 696e 7374 616c  yes | pkg instal
+00016b10: 6c20 7079 7468 6f6e 2074 6572 6d75 782d  l python termux-
+00016b20: 6170 6920 2626 2070 7974 686f 6e20 2d6d  api && python -m
+00016b30: 2065 6e73 7572 6570 6970 2026 2620 7079   ensurepip && py
+00016b40: 7468 6f6e 202d 6d20 7069 7020 696e 7374  thon -m pip inst
+00016b50: 616c 6c20 2d2d 7573 6572 202d 5520 636f  all --user -U co
+00016b60: 7079 7061 7274 7920 2626 207b 2067 7265  pyparty && { gre
+00016b70: 7020 2d71 4520 2750 4154 483d 2e2a 5c2e  p -qE 'PATH=.*\.
+00016b80: 6c6f 6361 6c2f 6269 6e27 207e 2f2e 6261  local/bin' ~/.ba
+00016b90: 7368 7263 2032 3e2f 6465 762f 6e75 6c6c  shrc 2>/dev/null
+00016ba0: 207c 7c20 7b20 6563 686f 2027 5041 5448   || { echo 'PATH
+00016bb0: 3d22 2448 4f4d 452f 2e6c 6f63 616c 2f62  ="$HOME/.local/b
+00016bc0: 696e 3a24 5041 5448 2227 203e 3e20 7e2f  in:$PATH"' >> ~/
+00016bd0: 2e62 6173 6872 6320 2626 202e 207e 2f2e  .bashrc && . ~/.
+00016be0: 6261 7368 7263 3b20 7d3b 207d 0a65 6368  bashrc; }; }.ech
+00016bf0: 6f20 243f 0a60 6060 0a0a 6166 7465 7220  o $?.```..after 
+00016c00: 7468 6520 696e 6974 6961 6c20 7365 7475  the initial setu
+00016c10: 702c 2079 6f75 2063 616e 206c 6175 6e63  p, you can launc
+00016c20: 6820 636f 7079 7061 7274 7920 6174 2061  h copyparty at a
+00016c30: 6e79 2074 696d 6520 6279 2072 756e 6e69  ny time by runni
+00016c40: 6e67 2060 636f 7079 7061 7274 7960 2061  ng `copyparty` a
+00016c50: 6e79 7768 6572 6520 696e 2054 6572 6d75  nywhere in Termu
+00016c60: 7820 2d2d 2061 6e64 2069 6620 796f 7520  x -- and if you 
+00016c70: 7275 6e20 6974 2077 6974 6820 602d 2d71  run it with `--q
+00016c80: 7260 2079 6f75 276c 6c20 6765 7420 6120  r` you'll get a 
+00016c90: 5b6e 6561 7420 7172 2d63 6f64 655d 2823  [neat qr-code](#
+00016ca0: 7172 2d63 6f64 6529 2070 6f69 6e74 696e  qr-code) pointin
+00016cb0: 6720 746f 2079 6f75 7220 6578 7465 726e  g to your extern
+00016cc0: 616c 2069 700a 0a69 6620 796f 7520 7761  al ip..if you wa
+00016cd0: 6e74 2074 6875 6d62 6e61 696c 7320 2870  nt thumbnails (p
+00016ce0: 686f 746f 732b 7669 6465 6f73 2920 616e  hotos+videos) an
+00016cf0: 6420 796f 7527 7265 206f 6b61 7920 7769  d you're okay wi
+00016d00: 7468 2073 7065 6e64 696e 6720 616e 6f74  th spending anot
+00016d10: 6865 7220 3133 3220 4d69 4220 6f66 2073  her 132 MiB of s
+00016d20: 746f 7261 6765 2c20 6070 6b67 2069 6e73  torage, `pkg ins
+00016d30: 7461 6c6c 2066 666d 7065 6720 2626 2070  tall ffmpeg && p
+00016d40: 7974 686f 6e33 202d 6d20 7069 7020 696e  ython3 -m pip in
+00016d50: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
+00016d60: 7069 6c6c 6f77 600a 0a2a 206f 7220 6966  pillow`..* or if
+00016d70: 2079 6f75 2077 616e 7420 746f 2075 7365   you want to use
+00016d80: 2060 7669 7073 6020 666f 7220 7068 6f74   `vips` for phot
+00016d90: 6f2d 7468 756d 6273 2069 6e73 7465 6164  o-thumbs instead
+00016da0: 2c20 6070 6b67 2069 6e73 7461 6c6c 206c  , `pkg install l
+00016db0: 6962 7669 7073 2026 2620 7079 7468 6f6e  ibvips && python
+00016dc0: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
+00016dd0: 2d2d 7573 6572 202d 5520 7768 6565 6c20  --user -U wheel 
+00016de0: 2626 2070 7974 686f 6e20 2d6d 2070 6970  && python -m pip
+00016df0: 2069 6e73 7461 6c6c 202d 2d75 7365 7220   install --user 
+00016e00: 2d55 2070 7976 6970 7320 2626 2028 6364  -U pyvips && (cd
+00016e10: 202f 6461 7461 2f64 6174 612f 636f 6d2e   /data/data/com.
+00016e20: 7465 726d 7578 2f66 696c 6573 2f75 7372  termux/files/usr
+00016e30: 2f6c 6962 2f3b 206c 6e20 2d73 206c 6962  /lib/; ln -s lib
+00016e40: 676f 626a 6563 742d 322e 302e 736f 7b2c  gobject-2.0.so{,
+00016e50: 2e30 7d3b 206c 6e20 2d73 206c 6962 7669  .0}; ln -s libvi
+00016e60: 7073 2e73 6f7b 2c2e 3432 7d29 600a 0a0a  ps.so{,.42})`...
+00016e70: 2320 7265 706f 7274 696e 6720 6275 6773  # reporting bugs
+00016e80: 0a0a 6964 6561 7320 666f 7220 636f 6e74  ..ideas for cont
+00016e90: 6578 7420 746f 2069 6e63 6c75 6465 2069  ext to include i
+00016ea0: 6e20 6275 6720 7265 706f 7274 730a 0a69  n bug reports..i
+00016eb0: 6e20 6765 6e65 7261 6c2c 2063 6f6d 6d61  n general, comma
+00016ec0: 6e64 6c69 6e65 2061 7267 756d 656e 7473  ndline arguments
+00016ed0: 2028 616e 6420 636f 6e66 6967 2066 696c   (and config fil
+00016ee0: 6520 6966 2061 6e79 290a 0a69 6620 736f  e if any)..if so
+00016ef0: 6d65 7468 696e 6720 6272 6f6b 6520 6475  mething broke du
+00016f00: 7269 6e67 2061 6e20 7570 6c6f 6164 2028  ring an upload (
+00016f10: 7265 706c 6163 696e 6720 4649 4c45 4e41  replacing FILENA
+00016f20: 4d45 2077 6974 6820 6120 7061 7274 206f  ME with a part o
+00016f30: 6620 7468 6520 6669 6c65 6e61 6d65 2074  f the filename t
+00016f40: 6861 7420 6272 6f6b 6529 3a0a 6060 600a  hat broke):.```.
+00016f50: 6a6f 7572 6e61 6c63 746c 202d 6153 2027  journalctl -aS '
+00016f60: 3438 2068 6f75 7220 6167 6f27 202d 7520  48 hour ago' -u 
+00016f70: 636f 7079 7061 7274 7920 7c20 6772 6570  copyparty | grep
+00016f80: 202d 4331 3020 4649 4c45 4e41 4d45 207c   -C10 FILENAME |
+00016f90: 2074 6565 2062 7567 2e6c 6f67 0a60 6060   tee bug.log.```
+00016fa0: 0a0a 6966 2074 6865 7265 2773 2061 2077  ..if there's a w
+00016fb0: 616c 6c20 6f66 2062 6173 6536 3420 696e  all of base64 in
+00016fc0: 2074 6865 206c 6f67 2028 7468 7265 6164   the log (thread
+00016fd0: 2073 7461 636b 7329 2074 6865 6e20 706c   stacks) then pl
+00016fe0: 6561 7365 2069 6e63 6c75 6465 2074 6861  ease include tha
+00016ff0: 742c 2065 7370 6563 6961 6c6c 7920 6966  t, especially if
+00017000: 2079 6f75 2072 756e 2069 6e74 6f20 736f   you run into so
+00017010: 6d65 7468 696e 6720 6672 6565 7a69 6e67  mething freezing
+00017020: 2075 7020 6f72 2067 6574 7469 6e67 2073   up or getting s
+00017030: 7475 636b 2c20 666f 7220 6578 616d 706c  tuck, for exampl
+00017040: 6520 604f 7065 7261 7469 6f6e 616c 4572  e `OperationalEr
+00017050: 726f 7228 2764 6174 6162 6173 6520 6973  ror('database is
+00017060: 206c 6f63 6b65 6427 2960 202d 2d20 616c   locked')` -- al
+00017070: 7465 726e 6174 6976 656c 7920 796f 7520  ternatively you 
+00017080: 6361 6e20 7669 7369 7420 602f 3f73 7461  can visit `/?sta
+00017090: 636b 6020 746f 2073 6565 2074 6865 2073  ck` to see the s
+000170a0: 7461 636b 7320 6c69 7665 2c20 736f 2068  tacks live, so h
+000170b0: 7474 703a 2f2f 3132 372e 302e 302e 313a  ttp://127.0.0.1:
+000170c0: 3339 3233 2f3f 7374 6163 6b20 666f 7220  3923/?stack for 
+000170d0: 6578 616d 706c 650a 0a0a 2320 6465 766e  example...# devn
+000170e0: 6f74 6573 0a0a 666f 7220 6275 696c 6420  otes..for build 
+000170f0: 696e 7374 7275 6374 696f 6e73 2065 7463  instructions etc
+00017100: 2c20 7365 6520 5b2e 2f64 6f63 732f 6465  , see [./docs/de
+00017110: 766e 6f74 6573 2e6d 645d 282e 2f64 6f63  vnotes.md](./doc
+00017120: 732f 6465 766e 6f74 6573 2e6d 6429 0a    s/devnotes.md).
```

### Comparing `copyparty-1.6.9/bin/partyfuse.py` & `copyparty-1.7.0/bin/partyfuse.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/bin/up2k.py` & `copyparty-1.7.0/bin/up2k.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 #!/usr/bin/env python3
 from __future__ import print_function, unicode_literals
 
-S_VERSION = "1.5"
-S_BUILD_DT = "2023-03-12"
+S_VERSION = "1.8"
+S_BUILD_DT = "2023-04-27"
 
 """
 up2k.py: upload to copyparty
 2021, ed <irc.rizon.net>, MIT-Licensed
 https://github.com/9001/copyparty/blob/hovudstraum/bin/up2k.py
 
 - dependencies: requests
@@ -17,14 +17,15 @@
 import os
 import sys
 import stat
 import math
 import time
 import atexit
 import signal
+import socket
 import base64
 import hashlib
 import platform
 import threading
 import datetime
 
 EXE = sys.executable.endswith("exe")
@@ -54,21 +55,23 @@
 
 
 # from copyparty/__init__.py
 PY2 = sys.version_info < (3,)
 if PY2:
     from Queue import Queue
     from urllib import quote, unquote
+    from urlparse import urlsplit, urlunsplit
 
     sys.dont_write_bytecode = True
     bytes = str
 else:
     from queue import Queue
     from urllib.parse import unquote_to_bytes as unquote
     from urllib.parse import quote_from_bytes as quote
+    from urllib.parse import urlsplit, urlunsplit
 
     unicode = str
 
 VT100 = platform.system() != "Windows"
 
 
 req_ses = requests.Session()
@@ -333,14 +336,40 @@
             t = "{0}\033[{1}A".format("\n" * margin, margin)
             eprint("{0}\033[s\033[1;{1}r\033[u".format(t, self.g - 1))
 
 
 ss = CTermsize()
 
 
+def undns(url):
+    usp = urlsplit(url)
+    hn = usp.hostname
+    gai = None
+    eprint("resolving host [{0}] ...".format(hn), end="")
+    try:
+        gai = socket.getaddrinfo(hn, None)
+        hn = gai[0][4][0]
+    except KeyboardInterrupt:
+        raise
+    except:
+        t = "\n\033[31mfailed to resolve upload destination host;\033[0m\ngai={0}\n"
+        eprint(t.format(repr(gai)))
+        raise
+
+    if usp.port:
+        hn = "{0}:{1}".format(hn, usp.port)
+    if usp.username or usp.password:
+        hn = "{0}:{1}@{2}".format(usp.username, usp.password, hn)
+
+    usp = usp._replace(netloc=hn)
+    url = urlunsplit(usp)
+    eprint(" {0}".format(url))
+    return url
+
+
 def _scd(err, top):
     """non-recursive listing of directory contents, along with stat() info"""
     with os.scandir(top) as dh:
         for fh in dh:
             abspath = os.path.join(top, fh.name)
             try:
                 yield [abspath, fh.stat()]
@@ -649,14 +678,15 @@
                 eprint("hint: aborting because --ok is not set\n")
                 return
 
         eprint("found {0} files, {1}\n\n".format(nfiles, humansize(nbytes)))
         return nfiles, nbytes
 
     def __init__(self, ar, stats=None):
+        self.ok = False
         self.ar = ar
         self.stats = stats or self._scan()
         if not self.stats:
             return
 
         self.nfiles, self.nbytes = self.stats
 
@@ -696,14 +726,16 @@
             self.st_hash = [None, "(idle, starting...)"]  # type: tuple[File, int]
             self.st_up = [None, "(idle, starting...)"]  # type: tuple[File, int]
 
             self.mth = MTHash(ar.J) if ar.J > 1 else None
 
             self._fancy()
 
+        self.ok = True
+
     def _safe(self):
         """minimal basic slow boring fallback codepath"""
         search = self.ar.s
         for nf, (top, rel, inf) in enumerate(self.filegen):
             if stat.S_ISDIR(inf.st_mode) or not rel:
                 continue
 
@@ -846,15 +878,15 @@
                         headers["Cookie"] = "=".join(["cppwd", self.ar.a])
 
                     ls = {}
                     try:
                         print("      ls ~{0}".format(srd))
                         zb = self.ar.url.encode("utf-8")
                         zb += quotep(rd.replace(b"\\", b"/"))
-                        r = req_ses.get(zb + b"?ls&dots", headers=headers)
+                        r = req_ses.get(zb + b"?ls&lt&dots", headers=headers)
                         if not r:
                             raise Exception("HTTP {0}".format(r.status_code))
 
                         j = r.json()
                         for f in j["dirs"] + j["files"]:
                             rfn = f["href"].split("?")[0].rstrip("/")
                             ls[unquote(rfn.encode("utf-8", "replace"))] = f
@@ -924,15 +956,15 @@
                 break
 
             with self.mutex:
                 self.handshaker_busy += 1
 
             upath = file.abs.decode("utf-8", "replace")
             if not VT100:
-                upath = upath[4:]
+                upath = upath.lstrip("\\?")
 
             hs, sprs = handshake(self.ar, file, search)
             if search:
                 if hs:
                     for hit in hs:
                         t = "found: {0}\n  {1}{2}\n"
                         print(t.format(upath, burl, hit["rp"]), end="")
@@ -1005,16 +1037,17 @@
                 int((self.nbytes - self.up_b) / (1024 * 1024)),
                 self.eta,
             )
 
             file, cid = task
             try:
                 upload(file, cid, self.ar.a, stats)
-            except:
-                eprint("upload failed, retrying: {0} #{1}\n".format(file.name, cid[:8]))
+            except Exception as ex:
+                t = "upload failed, retrying: {0} #{1} ({2})\n"
+                eprint(t.format(file.name, cid[:8], ex))
                 # handshake will fix it
 
             with self.mutex:
                 sz = file.kchunks[cid][1]
                 file.ucids = [x for x in file.ucids if x != cid]
                 if not file.ucids:
                     self.q_handshake.put(file)
@@ -1045,14 +1078,16 @@
     hcores = min(cores, 3)  # 4% faster than 4+ on py3.9 @ r5-4500U
 
     ver = "{0}, v{1}".format(S_BUILD_DT, S_VERSION)
     if "--version" in sys.argv:
         print(ver)
         return
 
+    sys.argv = [x for x in sys.argv if x != "--ws"]
+
     # fmt: off
     ap = app = argparse.ArgumentParser(formatter_class=APF, description="copyparty up2k uploader / filesearch tool, " + ver, epilog="""
 NOTE:
 source file/folder selection uses rsync syntax, meaning that:
   "foo" uploads the entire folder to URL/foo/
   "foo/" uploads the CONTENTS of the folder into URL/
 """)
@@ -1063,15 +1098,15 @@
     ap.add_argument("-a", metavar="PASSWORD", help="password or $filepath")
     ap.add_argument("-s", action="store_true", help="file-search (disables upload)")
     ap.add_argument("--ok", action="store_true", help="continue even if some local files are inaccessible")
     ap.add_argument("--version", action="store_true", help="show version and exit")
 
     ap = app.add_argument_group("compatibility")
     ap.add_argument("--cls", action="store_true", help="clear screen before start")
-    ap.add_argument("--ws", action="store_true", help="copyparty is running on windows; wait before deleting files after uploading")
+    ap.add_argument("--rh", type=int, metavar="TRIES", default=0, help="resolve server hostname before upload (good for buggy networks, but TLS certs will break)")
 
     ap = app.add_argument_group("folder sync")
     ap.add_argument("--dl", action="store_true", help="delete local files after uploading")
     ap.add_argument("--dr", action="store_true", help="delete remote files which don't exist locally")
     ap.add_argument("--drd", action="store_true", help="delete remote files during upload instead of afterwards; reduces peak disk space usage, but will reupload instead of detecting renames")
 
     ap = app.add_argument_group("performance tweaks")
@@ -1087,15 +1122,15 @@
     ap.add_argument("-td", action="store_true", help="disable certificate check")
     # fmt: on
 
     try:
         ar = app.parse_args()
     finally:
         if EXE and not sys.argv[1:]:
-            print("*** hit enter to exit ***")
+            eprint("*** hit enter to exit ***")
             try:
                 input()
             except:
                 pass
 
     if ar.drd:
         ar.dr = True
@@ -1120,25 +1155,33 @@
 
     if ar.a and ar.a.startswith("$"):
         fn = ar.a[1:]
         print("reading password from file [{0}]".format(fn))
         with open(fn, "rb") as f:
             ar.a = f.read().decode("utf-8").strip()
 
+    for n in range(ar.rh):
+        try:
+            ar.url = undns(ar.url)
+            break
+        except KeyboardInterrupt:
+            raise
+        except:
+            if n > ar.rh - 2:
+                raise
+
     if ar.cls:
-        print("\x1b\x5b\x48\x1b\x5b\x32\x4a\x1b\x5b\x33\x4a", end="")
+        eprint("\x1b\x5b\x48\x1b\x5b\x32\x4a\x1b\x5b\x33\x4a", end="")
 
     ctl = Ctl(ar)
 
-    if ar.dr and not ar.drd:
+    if ar.dr and not ar.drd and ctl.ok:
         print("\npass 2/2: delete")
-        if getattr(ctl, "up_br") and ar.ws:
-            # wait for up2k to mtime if there was uploads
-            time.sleep(4)
-
         ar.drd = True
         ar.z = True
-        Ctl(ar, ctl.stats)
+        ctl = Ctl(ar, ctl.stats)
+
+    sys.exit(0 if ctl.ok else 1)
 
 
 if __name__ == "__main__":
     main()
```

### Comparing `copyparty-1.6.9/copyparty/__init__.py` & `copyparty-1.7.0/copyparty/__init__.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/__main__.py` & `copyparty-1.7.0/copyparty/__main__.py`

 * *Files 2% similar despite different names*

```diff
@@ -251,32 +251,47 @@
         except:
             continue
 
     t = "setlocale {} failed,\n  sorting and dates might get funky\n"
     warn(t.format(safe))
 
 
-def ensure_cert()  :
+def ensure_cert(al )  :
     """
     the default cert (and the entire TLS support) is only here to enable the
     crypto.subtle javascript API, which is necessary due to the webkit guys
     being massive memers (https://www.chromium.org/blink/webcrypto)
 
     i feel awful about this and so should they
     """
     cert_insec = os.path.join(E.mod, "res/insecure.pem")
-    cert_cfg = os.path.join(E.cfg, "cert.pem")
-    if not os.path.exists(cert_cfg):
-        shutil.copy(cert_insec, cert_cfg)
+    cert_appdata = os.path.join(E.cfg, "cert.pem")
+    if not os.path.isfile(al.cert):
+        if cert_appdata != al.cert:
+            raise Exception("certificate file does not exist: " + al.cert)
+
+        shutil.copy(cert_insec, al.cert)
+
+    with open(al.cert, "rb") as f:
+        buf = f.read()
+        o1 = buf.find(b" PRIVATE KEY-")
+        o2 = buf.find(b" CERTIFICATE-")
+        m = "unsupported certificate format: "
+        if o1 < 0:
+            raise Exception(m + "no private key inside pem")
+        if o2 < 0:
+            raise Exception(m + "no server certificate inside pem")
+        if o1 > o2:
+            raise Exception(m + "private key must appear before server certificate")
 
     try:
-        if filecmp.cmp(cert_cfg, cert_insec):
+        if filecmp.cmp(al.cert, cert_insec):
             lprint(
                 "\033[33musing default TLS certificate; https will be insecure."
-                + "\033[36m\ncertificate location: {}\033[0m\n".format(cert_cfg)
+                + "\033[36m\ncertificate location: {}\033[0m\n".format(al.cert)
             )
     except:
         pass
 
     # speaking of the default cert,
     # printf 'NO\n.\n.\n.\n.\ncopyparty-insecure\n.\n' | faketime '2000-01-01 00:00:00' openssl req -x509 -sha256 -newkey rsa:2048 -keyout insecure.pem -out insecure.pem -days $((($(printf %d 0x7fffffff)-$(date +%s --date=2000-01-01T00:00:00Z))/(60*60*24))) -nodes && ls -al insecure.pem && openssl x509 -in insecure.pem -text -noout
 
@@ -489,16 +504,20 @@
         [
             "flags",
             "list of volflags",
             dedent(
                 """
             volflags are appended to volume definitions, for example,
             to create a write-only volume with the \033[33mnodupe\033[0m and \033[32mnosub\033[0m flags:
-              \033[35m-v /mnt/inc:/inc:w\033[33m:c,nodupe\033[32m:c,nosub"""
-            )
+              \033[35m-v /mnt/inc:/inc:w\033[33m:c,nodupe\033[32m:c,nosub\033[0m
+
+            if global config defines a volflag for all volumes,
+            you can unset it for a specific volume with -flag
+            """
+            ).rstrip()
             + build_flags_desc(),
         ],
         [
             "hooks",
             "execute commands before/after various events",
             dedent(
                 """
@@ -590,17 +609,17 @@
             "database durability profiles",
             dedent(
                 """
             mainly affects uploads of many small files on slow HDDs; speeds measured uploading 520 files on a WD20SPZX (SMR 2.5" 5400rpm 4kb)
 
             \033[32macid\033[0m = extremely safe but slow; the old default. Should never lose any data no matter what
 
-            \033[32mswal\033[0m = 2.4x faster uploads yet 99.9%% as safe -- theoretical chance of losing metadata for the ~200 most recently uploaded files if there's a power-loss or your OS crashes
+            \033[32mswal\033[0m = 2.4x faster uploads yet 99.9% as safe -- theoretical chance of losing metadata for the ~200 most recently uploaded files if there's a power-loss or your OS crashes
 
-            \033[32mwal\033[0m = another 21x faster on HDDs yet 90%% as safe; same pitfall as \033[33mswal\033[0m except more likely
+            \033[32mwal\033[0m = another 21x faster on HDDs yet 90% as safe; same pitfall as \033[33mswal\033[0m except more likely
 
             \033[32myolo\033[0m = another 1.5x faster, and removes the occasional sudden upload-pause while the disk syncs, but now you're at risk of losing the entire database in a powerloss / OS-crash
 
             profiles can be set globally (--dbd=yolo), or per-volume with volflags: -v ~/Music:music:r:c,dbd=acid
             """
             ),
         ],
@@ -681,24 +700,27 @@
     ap2.add_argument("--ll", action="store_true", help="include link-local IPv4/IPv6 even if the NIC has routable IPs (breaks some mdns clients)")
     ap2.add_argument("--rproxy", metavar="DEPTH", type=int, default=1, help="which ip to keep; [\033[32m0\033[0m]=tcp, [\033[32m1\033[0m]=origin (first x-fwd), [\033[32m2\033[0m]=cloudflare, [\033[32m3\033[0m]=nginx, [\033[32m-1\033[0m]=closest proxy")
     ap2.add_argument("--rp-loc", metavar="PATH", type=u, default="", help="if reverse-proxying on a location instead of a dedicated domain/subdomain, provide the base location here (eg. /foo/bar)")
     if ANYWIN:
         ap2.add_argument("--reuseaddr", action="store_true", help="set reuseaddr on listening sockets on windows; allows rapid restart of copyparty at the expense of being able to accidentally start multiple instances")
     else:
         ap2.add_argument("--freebind", action="store_true", help="allow listening on IPs which do not yet exist, for example if the network interfaces haven't finished going up. Only makes sense for IPs other than '0.0.0.0', '127.0.0.1', '::', and '::1'. May require running as root (unless net.ipv6.ip_nonlocal_bind)")
+    ap2.add_argument("--s-thead", metavar="SEC", type=int, default=120, help="socket timeout (read request header)")
+    ap2.add_argument("--s-tbody", metavar="SEC", type=float, default=186, help="socket timeout (read/write request/response bodies). Use 60 on fast servers (default is extremely safe). Disable with 0 if reverse-proxied for a 2%% speed boost")
     ap2.add_argument("--s-wr-sz", metavar="B", type=int, default=256*1024, help="socket write size in bytes")
     ap2.add_argument("--s-wr-slp", metavar="SEC", type=float, default=0, help="debug: socket write delay in seconds")
     ap2.add_argument("--rsp-slp", metavar="SEC", type=float, default=0, help="debug: response delay in seconds")
     ap2.add_argument("--rsp-jtr", metavar="SEC", type=float, default=0, help="debug: response delay, random duration 0..SEC")
 
 
-def add_tls(ap):
+def add_tls(ap, cert_path):
     ap2 = ap.add_argument_group('SSL/TLS options')
     ap2.add_argument("--http-only", action="store_true", help="disable ssl/tls -- force plaintext")
     ap2.add_argument("--https-only", action="store_true", help="disable plaintext -- force tls")
+    ap2.add_argument("--cert", metavar="PATH", type=u, default=cert_path, help="path to TLS certificate")
     ap2.add_argument("--ssl-ver", metavar="LIST", type=u, help="set allowed ssl/tls versions; [\033[32mhelp\033[0m] shows available versions; default is what your python version considers safe")
     ap2.add_argument("--ciphers", metavar="LIST", type=u, help="set allowed ssl/tls ciphers; [\033[32mhelp\033[0m] shows available ciphers")
     ap2.add_argument("--ssl-dbg", action="store_true", help="dump some tls info")
     ap2.add_argument("--ssl-log", metavar="PATH", type=u, help="log master secrets for later decryption in wireshark")
 
 
 def add_zeroconf(ap):
@@ -741,24 +763,26 @@
 
 
 def add_ftp(ap):
     ap2 = ap.add_argument_group('FTP options')
     ap2.add_argument("--ftp", metavar="PORT", type=int, help="enable FTP server on PORT, for example \033[32m3921")
     ap2.add_argument("--ftps", metavar="PORT", type=int, help="enable FTPS server on PORT, for example \033[32m3990")
     ap2.add_argument("--ftpv", action="store_true", help="verbose")
+    ap2.add_argument("--ftp4", action="store_true", help="only listen on IPv4")
     ap2.add_argument("--ftp-wt", metavar="SEC", type=int, default=7, help="grace period for resuming interrupted uploads (any client can write to any file last-modified more recently than SEC seconds ago)")
     ap2.add_argument("--ftp-nat", metavar="ADDR", type=u, help="the NAT address to use for passive connections")
     ap2.add_argument("--ftp-pr", metavar="P-P", type=u, help="the range of TCP ports to use for passive connections, for example \033[32m12000-13000")
 
 
 def add_webdav(ap):
     ap2 = ap.add_argument_group('WebDAV options')
-    ap2.add_argument("--daw", action="store_true", help="enable full write support. \033[1;31mWARNING:\033[0m This has side-effects -- PUT-operations will now \033[1;31mOVERWRITE\033[0m existing files, rather than inventing new filenames to avoid loss of data. You might want to instead set this as a volflag where needed. By not setting this flag, uploaded files can get written to a filename which the client does not expect (which might be okay, depending on client)")
+    ap2.add_argument("--daw", action="store_true", help="enable full write support, even if client may not be webdav. \033[1;31mWARNING:\033[0m This has side-effects -- PUT-operations will now \033[1;31mOVERWRITE\033[0m existing files, rather than inventing new filenames to avoid loss of data. You might want to instead set this as a volflag where needed. By not setting this flag, uploaded files can get written to a filename which the client does not expect (which might be okay, depending on client)")
     ap2.add_argument("--dav-inf", action="store_true", help="allow depth:infinite requests (recursive file listing); extremely server-heavy but required for spec compliance -- luckily few clients rely on this")
     ap2.add_argument("--dav-mac", action="store_true", help="disable apple-garbage filter -- allow macos to create junk files (._* and .DS_Store, .Spotlight-*, .fseventsd, .Trashes, .AppleDouble, __MACOS)")
+    ap2.add_argument("--dav-rt", action="store_true", help="show symlink-destination's lastmodified instead of the link itself; always enabled for recursive listings (volflag=davrt)")
 
 
 def add_smb(ap):
     ap2 = ap.add_argument_group('SMB/CIFS options')
     ap2.add_argument("--smb", action="store_true", help="enable smb (read-only) -- this requires running copyparty as root on linux and macos unless --smb-port is set above 1024 and your OS does port-forwarding from 445 to that.\n\033[1;31mWARNING:\033[0m this protocol is dangerous! Never expose to the internet. Account permissions are coalesced; if one account has write-access to a volume, then all accounts do.")
     ap2.add_argument("--smbw", action="store_true", help="enable write support (please dont)")
     ap2.add_argument("--smb1", action="store_true", help="disable SMBv2, only enable SMBv1 (CIFS)")
@@ -804,14 +828,16 @@
 
 def add_safety(ap, fk_salt):
     ap2 = ap.add_argument_group('safety options')
     ap2.add_argument("-s", action="count", default=0, help="increase safety: Disable thumbnails / potentially dangerous software (ffmpeg/pillow/vips), hide partial uploads, avoid crawlers.\n Alias of\033[32m --dotpart --no-thumb --no-mtag-ff --no-robots --force-js")
     ap2.add_argument("-ss", action="store_true", help="further increase safety: Prevent js-injection, accidental move/delete, broken symlinks, webdav, 404 on 403, ban on excessive 404s.\n Alias of\033[32m -s --unpost=0 --no-del --no-mv --hardlink --vague-403 --ban-404=50,60,1440 -nih")
     ap2.add_argument("-sss", action="store_true", help="further increase safety: Enable logging to disk, scan for dangerous symlinks.\n Alias of\033[32m -ss --no-dav --no-logues --no-readme -lo=cpp-%%Y-%%m%%d-%%H%%M%%S.txt.xz --ls=**,*,ln,p,r")
     ap2.add_argument("--ls", metavar="U[,V[,F]]", type=u, help="do a sanity/safety check of all volumes on startup; arguments \033[33mUSER\033[0m,\033[33mVOL\033[0m,\033[33mFLAGS\033[0m; example [\033[32m**,*,ln,p,r\033[0m]")
+    ap2.add_argument("--xvol", action="store_true", help="never follow symlinks leaving the volume root, unless the link is into another volume where the user has similar access (volflag=xvol)")
+    ap2.add_argument("--xdev", action="store_true", help="stay within the filesystem of the volume root; do not descend into other devices (symlink or bind-mount to another HDD, ...) (volflag=xdev)")
     ap2.add_argument("--salt", type=u, default="hunter2", help="up2k file-hash salt; serves no purpose, no reason to change this (but delete all databases if you do)")
     ap2.add_argument("--fk-salt", metavar="SALT", type=u, default=fk_salt, help="per-file accesskey salt; used to generate unpredictable URLs for hidden files -- this one DOES matter")
     ap2.add_argument("--no-dot-mv", action="store_true", help="disallow moving dotfiles; makes it impossible to move folders containing dotfiles")
     ap2.add_argument("--no-dot-ren", action="store_true", help="disallow renaming dotfiles; makes it impossible to make something a dotfile")
     ap2.add_argument("--no-logues", action="store_true", help="disable rendering .prologue/.epilogue.html into directory listings")
     ap2.add_argument("--no-readme", action="store_true", help="disable rendering readme.md into directory listings")
     ap2.add_argument("--vague-403", action="store_true", help="send 404 instead of 403 (security through ambiguity, very enterprise)")
@@ -890,23 +916,21 @@
     ap2.add_argument("-e2d", action="store_true", help="enable up2k database, making files searchable + enables upload deduplication")
     ap2.add_argument("-e2ds", action="store_true", help="scan writable folders for new files on startup; sets -e2d")
     ap2.add_argument("-e2dsa", action="store_true", help="scans all folders on startup; sets -e2ds")
     ap2.add_argument("-e2v", action="store_true", help="verify file integrity; rehash all files and compare with db")
     ap2.add_argument("-e2vu", action="store_true", help="on hash mismatch: update the database with the new hash")
     ap2.add_argument("-e2vp", action="store_true", help="on hash mismatch: panic and quit copyparty")
     ap2.add_argument("--hist", metavar="PATH", type=u, help="where to store volume data (db, thumbs) (volflag=hist)")
-    ap2.add_argument("--no-hash", metavar="PTN", type=u, help="regex: disable hashing of matching paths during e2ds folder scans (volflag=nohash)")
-    ap2.add_argument("--no-idx", metavar="PTN", type=u, help="regex: disable indexing of matching paths during e2ds folder scans (volflag=noidx)")
+    ap2.add_argument("--no-hash", metavar="PTN", type=u, help="regex: disable hashing of matching absolute-filesystem-paths during e2ds folder scans (volflag=nohash)")
+    ap2.add_argument("--no-idx", metavar="PTN", type=u, help="regex: disable indexing of matching absolute-filesystem-paths during e2ds folder scans (volflag=noidx)")
     ap2.add_argument("--no-dhash", action="store_true", help="disable rescan acceleration; do full database integrity check -- makes the db ~5%% smaller and bootup/rescans 3~10x slower")
     ap2.add_argument("--re-dhash", action="store_true", help="rebuild the cache if it gets out of sync (for example crash on startup during metadata scanning)")
     ap2.add_argument("--no-forget", action="store_true", help="never forget indexed files, even when deleted from disk -- makes it impossible to ever upload the same file twice (volflag=noforget)")
     ap2.add_argument("--dbd", metavar="PROFILE", default="wal", help="database durability profile; sets the tradeoff between robustness and speed, see --help-dbd (volflag=dbd)")
     ap2.add_argument("--xlink", action="store_true", help="on upload: check all volumes for dupes, not just the target volume (volflag=xlink)")
-    ap2.add_argument("--xdev", action="store_true", help="do not descend into other filesystems (symlink or bind-mount to another HDD, ...) (volflag=xdev)")
-    ap2.add_argument("--xvol", action="store_true", help="skip symlinks leaving the volume root (volflag=xvol)")
     ap2.add_argument("--hash-mt", metavar="CORES", type=int, default=hcores, help="num cpu cores to use for file hashing; set 0 or 1 for single-core hashing")
     ap2.add_argument("--re-maxage", metavar="SEC", type=int, default=0, help="disk rescan volume interval, 0=off (volflag=scan)")
     ap2.add_argument("--db-act", metavar="SEC", type=float, default=10, help="defer any scheduled volume reindexing until SEC seconds after last db write (uploads, renames, ...)")
     ap2.add_argument("--srch-time", metavar="SEC", type=int, default=45, help="search deadline -- terminate searches running for more than SEC seconds")
     ap2.add_argument("--srch-hits", metavar="N", type=int, default=7999, help="max search results to allow clients to fetch; 125 results will be shown initially")
     ap2.add_argument("--dotsrch", action="store_true", help="show dotfiles in search results (volflags: dotsrch | nodotsrch)")
 
@@ -977,28 +1001,30 @@
 )  :
     ap = argparse.ArgumentParser(
         formatter_class=formatter,
         prog="copyparty",
         description="http file sharing hub v{} ({})".format(S_VERSION, S_BUILD_DT),
     )
 
+    cert_path = os.path.join(E.cfg, "cert.pem")
+
     try:
-        fk_salt = unicode(os.path.getmtime(os.path.join(E.cfg, "cert.pem")))
+        fk_salt = unicode(os.path.getmtime(cert_path))
     except:
         fk_salt = "hunter2"
 
     hcores = min(CORES, 4)  # optimal on py3.11 @ r5-4500U
 
     tty = os.environ.get("TERM", "").lower() == "linux"
 
     srvname = get_srvname()
 
     add_general(ap, nc, srvname)
     add_network(ap)
-    add_tls(ap)
+    add_tls(ap, cert_path)
     add_qr(ap, tty)
     add_zeroconf(ap)
     add_zc_mdns(ap)
     add_zc_ssdp(ap)
     add_upload(ap)
     add_db_general(ap, hcores)
     add_db_metadata(ap)
@@ -1074,16 +1100,14 @@
         showlic()
         sys.exit(0)
 
     if EXE:
         print("pybin: {}\n".format(pybin), end="")
 
     ensure_locale()
-    if HAVE_SSL:
-        ensure_cert()
 
     for k, v in zip(argv[1:], argv[2:]):
         if k == "-c" and os.path.isfile(v):
             supp = args_from_cfg(v)
             argv.extend(supp)
 
     for k in argv[1:]:
@@ -1143,14 +1167,17 @@
     try:
         assert al  # type: ignore
         assert dal  # type: ignore
         al.E = E  # __init__ is not shared when oxidized
     except:
         sys.exit(1)
 
+    if HAVE_SSL:
+        ensure_cert(al)
+
     if WINDOWS and not al.keep_qem:
         try:
             disable_quickedit()
         except:
             lprint("\nfailed to disable quick-edit-mode:\n" + min_ex() + "\n")
 
     if not VT100:
```

### Comparing `copyparty-1.6.9/copyparty/authsrv.py` & `copyparty-1.7.0/copyparty/authsrv.py`

 * *Files 1% similar despite different names*

```diff
@@ -56,17 +56,17 @@
         self.uwrite  = set(uwrite or [])
         self.umove  = set(umove or [])
         self.udel  = set(udel or [])
         self.uget  = set(uget or [])
         self.upget  = set(upget or [])
 
     def __repr__(self)  :
-        return "AXS({})".format(
+        return "AXS(%s)" % (
             ", ".join(
-                "{}={!r}".format(k, self.__dict__[k])
+                "%s=%r" % (k, self.__dict__[k])
                 for k in "uread uwrite umove udel uget upget".split()
             )
         )
 
 
 class Lim(object):
     def __init__(self, log_func )  :
@@ -274,46 +274,64 @@
         flags  ,
     )  :
         self.log = log
         self.realpath = realpath  # absolute path on host filesystem
         self.vpath = vpath  # absolute path in the virtual filesystem
         self.axs = axs
         self.flags = flags  # config options
+        self.root = self
+        self.dev = 0  # st_dev
         self.nodes   = {}  # child nodes
         self.histtab   = {}  # all realpath->histpath
         self.dbv  = None  # closest full/non-jump parent
         self.lim  = None  # upload limits; only set for dbv
         self.aread   = {}
         self.awrite   = {}
         self.amove   = {}
         self.adel   = {}
         self.aget   = {}
         self.apget   = {}
 
         if realpath:
+            rp = realpath + ("" if realpath.endswith(os.sep) else os.sep)
+            vp = vpath + ("/" if vpath else "")
             self.histpath = os.path.join(realpath, ".hist")  # db / thumbcache
             self.all_vols = {vpath: self}  # flattened recursive
+            self.all_aps = [(rp, self)]
+            self.all_vps = [(vp, self)]
         else:
             self.histpath = ""
             self.all_vols = {}
+            self.all_aps = []
+            self.all_vps = []
 
     def __repr__(self)  :
-        return "VFS({})".format(
+        return "VFS(%s)" % (
             ", ".join(
-                "{}={!r}".format(k, self.__dict__[k])
+                "%s=%r" % (k, self.__dict__[k])
                 for k in "realpath vpath axs flags".split()
             )
         )
 
-    def get_all_vols(self, outdict  )  :
+    def get_all_vols(
+        self,
+        vols  ,
+        aps  ,
+        vps  ,
+    )  :
         if self.realpath:
-            outdict[self.vpath] = self
+            vols[self.vpath] = self
+            rp = self.realpath
+            rp += "" if rp.endswith(os.sep) else os.sep
+            vp = self.vpath + ("/" if self.vpath else "")
+            aps.append((rp, self))
+            vps.append((vp, self))
 
         for v in self.nodes.values():
-            v.get_all_vols(outdict)
+            v.get_all_vols(vols, aps, vps)
 
     def add(self, src , dst )  :
         """get existing, or add new path to the vfs"""
         assert not src.endswith("/")  # nosec
         assert not dst.endswith("/")  # nosec
 
         if "/" in dst:
@@ -345,15 +363,16 @@
         self.nodes[dst] = vn
         return vn
 
     def _copy_flags(self, name )   :
         flags = {k: v for k, v in self.flags.items()}
         hist = flags.get("hist")
         if hist and hist != "-":
-            flags["hist"] = "{}/{}".format(hist.rstrip("/"), name)
+            zs = "{}/{}".format(hist.rstrip("/"), name)
+            flags["hist"] = os.path.expanduser(zs) if zs.startswith("~") else zs
 
         return flags
 
     def bubble_flags(self)  :
         if self.dbv:
             for k, v in self.dbv.flags.items():
                 if k not in ["hist"]:
@@ -378,15 +397,19 @@
 
         return self, vpath
 
     def can_access(
         self, vpath , uname 
     )       :
         """can Read,Write,Move,Delete,Get,Upget"""
-        vn, _ = self._find(undot(vpath))
+        if vpath:
+            vn, _ = self._find(undot(vpath))
+        else:
+            vn = self
+
         c = vn.axs
         return (
             uname in c.uread or "*" in c.uread,
             uname in c.uwrite or "*" in c.uwrite,
             uname in c.umove or "*" in c.umove,
             uname in c.udel or "*" in c.udel,
             uname in c.uget or "*" in c.uget,
@@ -533,17 +556,28 @@
             and fsroot in seen
         ):
             if self.log:
                 t = "bailing from symlink loop,\n  prev: {}\n  curr: {}\n  from: {}/{}"
                 self.log("vfs.walk", t.format(seen[-1], fsroot, self.vpath, rem), 3)
             return
 
+        if "xdev" in self.flags or "xvol" in self.flags:
+            rm1 = []
+            for le in vfs_ls:
+                ap = absreal(os.path.join(fsroot, le[0]))
+                vn2 = self.chk_ap(ap)
+                if not vn2 or not vn2.get("", uname, True, False):
+                    rm1.append(le)
+            _ = [vfs_ls.remove(x) for x in rm1]  # type: ignore
+
         seen = seen[:] + [fsroot]
         rfiles = [x for x in vfs_ls if not stat.S_ISDIR(x[1].st_mode)]
         rdirs = [x for x in vfs_ls if stat.S_ISDIR(x[1].st_mode)]
+        # if lstat: ignore folder symlinks since copyparty will never make those
+        #            (and we definitely don't want to descend into them)
 
         rfiles.sort()
         rdirs.sort()
 
         yield dbv, vrem, rel, fsroot, rfiles, rdirs, vfs_virt
 
         for rdir, _ in rdirs:
@@ -566,26 +600,27 @@
 
             wrel = (rel + "/" + n).lstrip("/")
             for x in vfs.walk(wrel, "", seen, uname, permsets, dots, scandir, lstat):
                 yield x
 
     def zipgen(
         self,
+        vpath ,
         vrem ,
         flt ,
         uname ,
         dots ,
         dirs ,
         scandir ,
         wrap  = True,
     )     :
 
         # if multiselect: add all items to archive root
         # if single folder: the folder itself is the top-level item
-        folder = "" if flt or not wrap else (vrem.split("/")[-1].lstrip(".") or "top")
+        folder = "" if flt or not wrap else (vpath.split("/")[-1].lstrip(".") or "top")
 
         g = self.walk(folder, vrem, [], uname, [[True, False]], dots, scandir, False)
         for _, _, vpath, apath, files, rd, vd in g:
             if flt:
                 files = [x for x in files if x[0] in flt]
 
                 rm1 = [x for x in rd if x[0] not in flt]
@@ -628,14 +663,52 @@
             dstats += [st] * len(vd)
             vpaths = [vpath + "/" + n for n in dnames] if vpath else dnames
             apaths = [os.path.join(apath, n) for n in dnames]
             ret2 = list(zip(vpaths, apaths, dstats))
             for d in [{"vp": v, "ap": a, "st": n} for v, a, n in ret2]:
                 yield d
 
+    def chk_ap(self, ap , st  = None)  :
+        aps = ap + os.sep
+        if "xdev" in self.flags and not ANYWIN:
+            if not st:
+                ap2 = ap.replace("\\", "/") if ANYWIN else ap
+                while ap2:
+                    try:
+                        st = bos.stat(ap2)
+                        break
+                    except:
+                        if "/" not in ap2:
+                            raise
+                        ap2 = ap2.rsplit("/", 1)[0]
+                assert st
+
+            vdev = self.dev
+            if not vdev:
+                vdev = self.dev = bos.stat(self.realpath).st_dev
+
+            if vdev != st.st_dev:
+                if self.log:
+                    t = "xdev: {}[{}] => {}[{}]"
+                    self.log("vfs", t.format(vdev, self.realpath, st.st_dev, ap), 3)
+
+                return None
+
+        if "xvol" in self.flags:
+            for vap, vn in self.root.all_aps:
+                if aps.startswith(vap):
+                    return vn
+
+            if self.log:
+                self.log("vfs", "xvol: [{}]".format(ap), 3)
+
+            return None
+
+        return self
+
 
 if WINDOWS:
     re_vol = re.compile(r"^([a-zA-Z]:[\\/][^:]*|[^:]*):([^:]*):(.*)$")
 else:
     re_vol = re.compile(r"^([^:]*):([^:]*):(.*)$")
 
 
@@ -846,15 +919,15 @@
             if cat == catf:
                 err = ""
                 try:
                     self._l(ln, 6, "volume-specific config:")
                     zd = split_cfg_ln(ln)
                     fstr = ""
                     for sk, sv in zd.items():
-                        bad = re.sub(r"[a-z0-9_]", "", sk)
+                        bad = re.sub(r"[a-z0-9_-]", "", sk).lstrip("-")
                         if bad:
                             err = "bad characters [{}] in volflag name [{}]; "
                             err = err.format(bad, sk)
                             raise Exception(err)
                         if sv is True:
                             fstr += "," + sk
                         else:
@@ -922,15 +995,22 @@
     def _read_volflag(
         self,
         flags  ,
         name ,
         value   ,
         is_list ,
     )  :
-        desc = flagdescs.get(name, "?").replace("\n", " ")
+        desc = flagdescs.get(name.lstrip("-"), "?").replace("\n", " ")
+
+        if re.match("^-[^-]+$", name):
+            t = "unset volflag [{}]  ({})"
+            self._e(t.format(name[1:], desc))
+            flags[name] = True
+            return
+
         if name not in "mtp xbu xau xiu xbr xar xbd xad xm".split():
             if value is True:
                 t = "add volflag [{}] = {}  ({})"
             else:
                 t = "add volflag [{}] = [{}]  ({})"
             self._e(t.format(name, value, desc))
             flags[name] = value
@@ -1047,15 +1127,21 @@
             zv = vfs.add(mount[dst], dst)
             zv.axs = daxs[dst]
             zv.flags = mflags[dst]
             zv.dbv = None
 
         assert vfs
         vfs.all_vols = {}
-        vfs.get_all_vols(vfs.all_vols)
+        vfs.all_aps = []
+        vfs.all_vps = []
+        vfs.get_all_vols(vfs.all_vols, vfs.all_aps, vfs.all_vps)
+        for vol in vfs.all_vols.values():
+            vol.all_aps.sort(key=lambda x: len(x[0]), reverse=True)
+            vol.all_vps.sort(key=lambda x: len(x[0]), reverse=True)
+            vol.root = vfs
 
         for perm in "read write move del get pget".split():
             axs_key = "u" + perm
             unames = ["*"] + list(acct.keys())
             umap   = {x: [] for x in unames}
             for usr in unames:
                 for vp, vol in vfs.all_vols.items():
@@ -1090,14 +1176,17 @@
         for vol in vfs.all_vols.values():
             zb = hashlib.sha512(afsenc(vol.realpath)).digest()
             hid = base64.b32encode(zb).decode("ascii").lower()
             vflag = vol.flags.get("hist")
             if vflag == "-":
                 pass
             elif vflag:
+                if vflag.startswith("~"):
+                    vflag = os.path.expanduser(vflag)
+
                 vol.histpath = uncyg(vflag) if WINDOWS else vflag
             elif self.args.hist:
                 for nch in range(len(hid)):
                     hpath = os.path.join(self.args.hist, hid[: nch + 1])
                     bos.makedirs(hpath)
 
                     powner = os.path.join(hpath, "owner.txt")
@@ -1425,14 +1514,20 @@
                 have_daw = True
 
         if have_daw and self.args.no_dav:
             t = 'volume "/{}" has volflag "daw" (webdav write-access), but --no-dav is set'
             self.log(t, 1)
             errors = True
 
+        for vol in vfs.all_vols.values():
+            for k in list(vol.flags.keys()):
+                if re.match("^-[^-]+$", k):
+                    vol.flags.pop(k[1:], None)
+                    vol.flags.pop(k)
+
         if errors:
             sys.exit(1)
 
         vfs.bubble_flags()
 
         have_e2d = False
         t = "volumes and permissions:\n"
```

### Comparing `copyparty-1.6.9/copyparty/bos/bos.py` & `copyparty-1.7.0/copyparty/bos/bos.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/bos/path.py` & `copyparty-1.7.0/copyparty/bos/path.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/broker_mp.py` & `copyparty-1.7.0/copyparty/broker_mp.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/broker_mpw.py` & `copyparty-1.7.0/copyparty/broker_mpw.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/broker_thr.py` & `copyparty-1.7.0/copyparty/broker_thr.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/broker_util.py` & `copyparty-1.7.0/copyparty/broker_util.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/cfg.py` & `copyparty-1.7.0/copyparty/cfg.py`

 * *Files 6% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 def vf_bmap()   :
     """argv-to-volflag: simple bools"""
     ret = {
         "never_symlink": "neversymlink",
         "no_dedup": "copydupes",
         "no_dupe": "nodupe",
         "no_forget": "noforget",
+        "dav_rt": "davrt",
     }
     for k in (
         "dotsrch",
         "e2t",
         "e2ts",
         "e2tsr",
         "e2v",
@@ -102,15 +103,15 @@
         "scan=60": "scan for new files every 60sec, same as --re-maxage",
         "nohash=\\.iso$": "skips hashing file contents if path matches *.iso",
         "noidx=\\.iso$": "fully ignores the contents at paths matching *.iso",
         "noforget": "don't forget files when deleted from disk",
         "dbd=[acid|swal|wal|yolo]": "database speed-durability tradeoff",
         "xlink": "cross-volume dupe detection / linking",
         "xdev": "do not descend into other filesystems",
-        "xvol": "skip symlinks leaving the volume root",
+        "xvol": "do not follow symlinks leaving the volume root",
         "dotsrch": "show dotfiles in search results",
         "nodotsrch": "hide dotfiles in search results (default)",
     },
     'database, audio tags\n"mte", "mth", "mtp", "mtm" all work the same as -mte, -mth, ...': {
         "mtp=.bpm=f,audio-bpm.py": 'uses the "audio-bpm.py" program to\ngenerate ".bpm" tags from uploads (f = overwrite tags)',
         "mtp=ahash,vhash=media-hash.py": "collects two tags at once",
     },
@@ -138,13 +139,14 @@
         "no_sb_lg": "disable js sandbox for prologue/epilogue",
         "sb_md": "enable js sandbox for markdown files (default)",
         "sb_lg": "enable js sandbox for prologue/epilogue (default)",
         "md_sbf": "list of markdown-sandbox safeguards to disable",
         "lg_sbf": "list of *logue-sandbox safeguards to disable",
     },
     "others": {
-        "fk=8": 'generates per-file accesskeys,\nwhich will then be required at the "g" permission'
+        "fk=8": 'generates per-file accesskeys,\nwhich will then be required at the "g" permission',
+        "davrt": "show lastmod time of symlink destination, not the link itself\n(note: this option is always enabled for recursive listings)",
     },
 }
 
 
 flagdescs = {k.split("=")[0]: v for tab in flagcats.values() for k, v in tab.items()}
```

### Comparing `copyparty-1.6.9/copyparty/dxml.py` & `copyparty-1.7.0/copyparty/dxml.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/fsutil.py` & `copyparty-1.7.0/copyparty/fsutil.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/ftpd.py` & `copyparty-1.7.0/copyparty/ftpd.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,25 +1,26 @@
 # coding: utf-8
 from __future__ import print_function, unicode_literals
 
 import argparse
+import errno
 import logging
 import os
 import stat
 import sys
 import time
 
 from pyftpdlib.authorizers import AuthenticationFailed, DummyAuthorizer
 from pyftpdlib.filesystems import AbstractedFS, FilesystemError
 from pyftpdlib.handlers import FTPHandler
 from pyftpdlib.servers import FTPServer
 
 from .__init__ import ANYWIN, PY2, TYPE_CHECKING, E
-from .bos import bos
 from .authsrv import VFS
+from .bos import bos
 from .util import (
     Daemon,
     Pebkac,
     exclude_dotfiles,
     fsenc,
     ipnorm,
     pybin,
@@ -37,23 +38,30 @@
     sys.path.append(p)
     from pyftpdlib.ioloop import IOLoop
 
 
 if TYPE_CHECKING:
     from .svchub import SvcHub
 
+class FSE(FilesystemError):
+    def __init__(self, msg , severity  = 0)  :
+        super(FilesystemError, self).__init__(msg)
+        self.severity = severity
+
+
 class FtpAuth(DummyAuthorizer):
     def __init__(self, hub )  :
         super(FtpAuth, self).__init__()
         self.hub = hub
 
     def validate_authentication(
         self, username , password , handler 
     )  :
         handler.username = "{}:{}".format(username, password)
+        handler.uname = "*"
 
         ip = handler.addr[0]
         if ip.startswith("::ffff:"):
             ip = ip[7:]
 
         ip = ipnorm(ip)
         bans = self.hub.bans
@@ -77,22 +85,22 @@
                 bonk, ip = g.bonk(ip, handler.username)
                 if bonk:
                     logging.warning("client banned: invalid passwords")
                     bans[ip] = bonk
 
             raise AuthenticationFailed("Authentication failed.")
 
-        handler.username = uname
+        handler.uname = uname
 
     def get_home_dir(self, username )  :
         return "/"
 
     def has_user(self, username )  :
         asrv = self.hub.asrv
-        return username in asrv.acct
+        return username in asrv.acct or username in asrv.iacct
 
     def has_perm(self, username , perm , path  = None)  :
         return True  # handled at filesystem layer
 
     def get_perms(self, username )  :
         return "elradfmwMT"
 
@@ -103,57 +111,66 @@
         return "cya"
 
 
 class FtpFs(AbstractedFS):
     def __init__(
         self, root , cmd_channel 
     )  :  # pylint: disable=super-init-not-called
-        self.h = self.cmd_channel = cmd_channel  # type: FTPHandler
+        self.h = cmd_channel  # type: FTPHandler
+        self.cmd_channel = cmd_channel  # type: FTPHandler
         self.hub  = cmd_channel.hub
         self.args = cmd_channel.args
-
-        self.uname = self.hub.asrv.iacct.get(cmd_channel.password, "*")
+        self.uname = cmd_channel.uname
 
         self.cwd = "/"  # pyftpdlib convention of leading slash
         self.root = "/var/lib/empty"
 
         self.can_read = self.can_write = self.can_move = False
         self.can_delete = self.can_get = self.can_upget = False
 
         self.listdirinfo = self.listdir
         self.chdir(".")
 
-    def die(self, msg):
-        self.h.die(msg)
-        raise Exception()
-
     def v2a(
         self,
         vpath ,
         r  = False,
         w  = False,
         m  = False,
         d  = False,
     )    :
         try:
-            vpath = vpath.replace("\\", "/").lstrip("/")
+            vpath = vpath.replace("\\", "/").strip("/")
             rd, fn = os.path.split(vpath)
             if ANYWIN and relchk(rd):
                 logging.warning("malicious vpath: %s", vpath)
-                self.die("Unsupported characters in filepath")
+                t = "Unsupported characters in [{}]"
+                raise FSE(t.format(vpath), 1)
 
             fn = sanitize_fn(fn or "", "", [".prologue.html", ".epilogue.html"])
             vpath = vjoin(rd, fn)
             vfs, rem = self.hub.asrv.vfs.get(vpath, self.uname, r, w, m, d)
             if not vfs.realpath:
-                self.die("No filesystem mounted at this path")
+                t = "No filesystem mounted at [{}]"
+                raise FSE(t.format(vpath))
+
+            if "xdev" in vfs.flags or "xvol" in vfs.flags:
+                ap = vfs.canonical(rem)
+                avfs = vfs.chk_ap(ap)
+                t = "Permission denied in [{}]"
+                if not avfs:
+                    raise FSE(t.format(vpath), 1)
+
+                cr, cw, cm, cd, _, _ = avfs.can_access("", self.h.uname)
+                if r and not cr or w and not cw or m and not cm or d and not cd:
+                    raise FSE(t.format(vpath), 1)
 
             return os.path.join(vfs.realpath, rem), vfs, rem
         except Pebkac as ex:
-            self.die(str(ex))
+            raise FSE(str(ex))
 
     def rv2a(
         self,
         vpath ,
         r  = False,
         w  = False,
         m  = False,
@@ -168,15 +185,15 @@
     def fs2ftp(self, fspath )  :
         # raise NotImplementedError()
         return fspath
 
     def validpath(self, path )  :
         if "/.hist/" in path:
             if "/up2k." in path or path.endswith("/dir.txt"):
-                self.die("Access to this file is forbidden")
+                raise FSE("Access to this file is forbidden", 1)
 
         return True
 
     def open(self, filename , mode )  :
         r = "r" in mode
         w = "w" in mode or "a" in mode or "+" in mode
 
@@ -185,45 +202,55 @@
             try:
                 st = bos.stat(ap)
                 td = time.time() - st.st_mtime
             except:
                 td = 0
 
             if td < -1 or td > self.args.ftp_wt:
-                self.die("Cannot open existing file for writing")
+                raise FSE("Cannot open existing file for writing")
 
         self.validpath(ap)
         return open(fsenc(ap), mode)
 
     def chdir(self, path )  :
         nwd = join(self.cwd, path)
         vfs, rem = self.hub.asrv.vfs.get(nwd, self.uname, False, False)
         ap = vfs.canonical(rem)
-        if not bos.path.isdir(ap):
+        try:
+            st = bos.stat(ap)
+            if not stat.S_ISDIR(st.st_mode):
+                raise Exception()
+        except:
             # returning 550 is library-default and suitable
-            self.die("Failed to change directory")
+            raise FSE("No such file or directory")
+
+        avfs = vfs.chk_ap(ap, st)
+        if not avfs:
+            raise FSE("Permission denied", 1)
 
         self.cwd = nwd
         (
             self.can_read,
             self.can_write,
             self.can_move,
             self.can_delete,
             self.can_get,
             self.can_upget,
-        ) = self.hub.asrv.vfs.can_access(self.cwd.lstrip("/"), self.h.username)
+        ) = avfs.can_access("", self.h.uname)
 
     def mkdir(self, path )  :
         ap = self.rv2a(path, w=True)[0]
         bos.makedirs(ap)  # filezilla expects this
 
     def listdir(self, path )  :
-        vpath = join(self.cwd, path).lstrip("/")
+        vpath = join(self.cwd, path)
         try:
-            vfs, rem = self.hub.asrv.vfs.get(vpath, self.uname, True, False)
+            ap, vfs, rem = self.v2a(vpath, True, False)
+            if not bos.path.isdir(ap):
+                raise FSE("No such file or directory", 1)
 
             fsroot, vfs_ls1, vfs_virt = vfs.ls(
                 rem,
                 self.uname,
                 not self.args.no_scandir,
                 [[True, False], [False, True]],
             )
@@ -231,59 +258,70 @@
             vfs_ls.extend(vfs_virt.keys())
 
             if not self.args.ed:
                 vfs_ls = exclude_dotfiles(vfs_ls)
 
             vfs_ls.sort()
             return vfs_ls
-        except:
-            if vpath:
+        except Exception as ex:
+            # panic on malicious names
+            if getattr(ex, "severity", 0):
+                raise
+
+            if vpath.strip("/"):
                 # display write-only folders as empty
                 return []
 
             # return list of volumes
             r = {x.split("/")[0]: 1 for x in self.hub.asrv.vfs.all_vols.keys()}
             return list(sorted(list(r.keys())))
 
     def rmdir(self, path )  :
         ap = self.rv2a(path, d=True)[0]
-        bos.rmdir(ap)
+        try:
+            bos.rmdir(ap)
+        except OSError as e:
+            if e.errno != errno.ENOENT:
+                raise
 
     def remove(self, path )  :
         if self.args.no_del:
-            self.die("The delete feature is disabled in server config")
+            raise FSE("The delete feature is disabled in server config")
 
         vp = join(self.cwd, path).lstrip("/")
         try:
-            self.hub.up2k.handle_rm(self.uname, self.h.cli_ip, [vp], [])
+            self.hub.up2k.handle_rm(self.uname, self.h.cli_ip, [vp], [], False)
         except Exception as ex:
-            self.die(str(ex))
+            raise FSE(str(ex))
 
     def rename(self, src , dst )  :
         if not self.can_move:
-            self.die("Not allowed for user " + self.h.username)
+            raise FSE("Not allowed for user " + self.h.uname)
 
         if self.args.no_mv:
-            self.die("The rename/move feature is disabled in server config")
+            raise FSE("The rename/move feature is disabled in server config")
 
         svp = join(self.cwd, src).lstrip("/")
         dvp = join(self.cwd, dst).lstrip("/")
         try:
             self.hub.up2k.handle_mv(self.uname, svp, dvp)
         except Exception as ex:
-            self.die(str(ex))
+            raise FSE(str(ex))
 
     def chmod(self, path , mode )  :
         pass
 
     def stat(self, path )  :
         try:
             ap = self.rv2a(path, r=True)[0]
             return bos.stat(ap)
-        except:
+        except FSE as ex:
+            if ex.severity:
+                raise
+
             ap = self.rv2a(path)[0]
             st = bos.stat(ap)
             if not stat.S_ISDIR(st.st_mode):
                 raise
 
             return st
 
@@ -295,26 +333,32 @@
         ap = self.rv2a(path)[0]
         return bos.stat(ap)
 
     def isfile(self, path )  :
         try:
             st = self.stat(path)
             return stat.S_ISREG(st.st_mode)
-        except:
+        except Exception as ex:
+            if getattr(ex, "severity", 0):
+                raise
+
             return False  # expected for mojibake in ftp_SIZE()
 
     def islink(self, path )  :
         ap = self.rv2a(path)[0]
         return bos.path.islink(ap)
 
     def isdir(self, path )  :
         try:
             st = self.stat(path)
             return stat.S_ISDIR(st.st_mode)
-        except:
+        except Exception as ex:
+            if getattr(ex, "severity", 0):
+                raise
+
             return True
 
     def getsize(self, path )  :
         ap = self.rv2a(path)[0]
         return bos.path.getsize(ap)
 
     def getmtime(self, path )  :
@@ -335,18 +379,20 @@
         return "root"
 
 
 class FtpHandler(FTPHandler):
     abstracted_fs = FtpFs
     #hub: "SvcHub"
     #args: argparse.Namespace
+    #uname: str
 
     def __init__(self, conn , server , ioloop  = None)  :
         self.hub  = FtpHandler.hub
         self.args  = FtpHandler.args
+        self.uname = "*"
 
         if PY2:
             FTPHandler.__init__(self, conn, server, ioloop)
         else:
             super(FtpHandler, self).__init__(conn, server, ioloop)
 
         cip = self.remote_ip
@@ -354,38 +400,34 @@
 
         # abspath->vpath mapping to resolve log_transfer paths
         self.vfs_map   = {}
 
         # reduce non-debug logging
         self.log_cmds_list = [x for x in self.log_cmds_list if x not in ("CWD", "XCWD")]
 
-    def die(self, msg):
-        self.respond("550 {}".format(msg))
-        raise FilesystemError(msg)
-
     def ftp_STOR(self, file , mode  = "w")  :
         # Optional[str]
         vp = join(self.fs.cwd, file).lstrip("/")
-        ap, vfs, rem = self.fs.v2a(vp)
+        ap, vfs, rem = self.fs.v2a(vp, w=True)
         self.vfs_map[ap] = vp
         xbu = vfs.flags.get("xbu")
         if xbu and not runhook(
             None,
             xbu,
             ap,
             vfs.canonical(rem),
             "",
-            self.username,
+            self.uname,
             0,
             0,
             self.cli_ip,
             0,
             "",
         ):
-            self.die("Upload blocked by xbu server config")
+            raise FSE("Upload blocked by xbu server config")
 
         # print("ftp_STOR: {} {} => {}".format(vp, mode, ap))
         ret = FTPHandler.ftp_STOR(self, file, mode)
         # print("ftp_STOR: {} {} OK".format(vp, mode))
         return ret
 
     def log_transfer(
@@ -399,25 +441,25 @@
     )  :
         # None
         ap = filename.decode("utf-8", "replace")
         vp = self.vfs_map.pop(ap, None)
         # print("xfer_end: {} => {}".format(ap, vp))
         if vp:
             vp, fn = os.path.split(vp)
-            vfs, rem = self.hub.asrv.vfs.get(vp, self.username, False, True)
+            vfs, rem = self.hub.asrv.vfs.get(vp, self.uname, False, True)
             vfs, rem = vfs.get_dbv(rem)
             self.hub.up2k.hash_file(
                 vfs.realpath,
                 vfs.vpath,
                 vfs.flags,
                 rem,
                 fn,
                 self.cli_ip,
                 time.time(),
-                self.username,
+                self.uname,
             )
 
         return FTPHandler.log_transfer(
             self, cmd, filename, receive, completed, elapsed, bytes
         )
 
 
@@ -443,15 +485,15 @@
             try:
                 h1 = SftpHandler
             except:
                 t = "\nftps requires pyopenssl;\nplease run the following:\n\n  {} -m pip install --user pyopenssl\n"
                 print(t.format(pybin))
                 sys.exit(1)
 
-            h1.certfile = os.path.join(self.args.E.cfg, "cert.pem")
+            h1.certfile = self.args.cert
             h1.tls_control_required = True
             h1.tls_data_required = True
 
             hs.append([h1, self.args.ftps])
 
         for h_lp in hs:
             h2, lp = h_lp
@@ -477,14 +519,17 @@
         lgr = logging.getLogger("pyftpdlib")
         lgr.setLevel(logging.DEBUG if self.args.ftpv else logging.INFO)
 
         ips = self.args.i
         if "::" in ips:
             ips.append("0.0.0.0")
 
+        if self.args.ftp4:
+            ips = [x for x in ips if ":" not in x]
+
         ioloop = IOLoop()
         for ip in ips:
             for h, lp in hs:
                 try:
                     FTPServer((ip, int(lp)), h, ioloop)
                 except:
                     if ip != "0.0.0.0" or "::" not in ips:
```

### Comparing `copyparty-1.6.9/copyparty/httpcli.py` & `copyparty-1.7.0/copyparty/httpcli.py`

 * *Files 1% similar despite different names*

```diff
@@ -171,7323 +171,7480 @@
 00000aa0: 5f72 636c 6f6e 6520 3d20 4661 6c73 650a  _rclone = False.
 00000ab0: 2020 2020 2020 2020 7365 6c66 2e6f 7570          self.oup
 00000ac0: 6172 616d 2020 203d 207b 7d0a 2020 2020  aram   = {}.    
 00000ad0: 2020 2020 7365 6c66 2e75 7061 7261 6d20      self.uparam 
 00000ae0: 2020 3d20 7b7d 0a20 2020 2020 2020 2073    = {}.        s
 00000af0: 656c 662e 636f 6f6b 6965 7320 2020 3d20  elf.cookies   = 
 00000b00: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
-00000b10: 7670 6174 6820 3d20 2220 220a 2020 2020  vpath = " ".    
-00000b20: 2020 2020 7365 6c66 2e75 6e61 6d65 203d      self.uname =
+00000b10: 6176 6e20 203d 204e 6f6e 650a 2020 2020  avn  = None.    
+00000b20: 2020 2020 7365 6c66 2e76 7061 7468 203d      self.vpath =
 00000b30: 2022 2022 0a20 2020 2020 2020 2073 656c   " ".        sel
-00000b40: 662e 7077 203d 2022 2022 0a20 2020 2020  f.pw = " ".     
-00000b50: 2020 2073 656c 662e 7276 6f6c 203d 205b     self.rvol = [
-00000b60: 2220 225d 0a20 2020 2020 2020 2073 656c  " "].        sel
-00000b70: 662e 7776 6f6c 203d 205b 2220 225d 0a20  f.wvol = [" "]. 
-00000b80: 2020 2020 2020 2073 656c 662e 6d76 6f6c         self.mvol
-00000b90: 203d 205b 2220 225d 0a20 2020 2020 2020   = [" "].       
-00000ba0: 2073 656c 662e 6476 6f6c 203d 205b 2220   self.dvol = [" 
-00000bb0: 225d 0a20 2020 2020 2020 2073 656c 662e  "].        self.
-00000bc0: 6776 6f6c 203d 205b 2220 225d 0a20 2020  gvol = [" "].   
-00000bd0: 2020 2020 2073 656c 662e 7570 766f 6c20       self.upvol 
-00000be0: 3d20 5b22 2022 5d0a 2020 2020 2020 2020  = [" "].        
-00000bf0: 7365 6c66 2e64 6f5f 6c6f 6720 3d20 5472  self.do_log = Tr
-00000c00: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
-00000c10: 6361 6e5f 7265 6164 203d 2046 616c 7365  can_read = False
-00000c20: 0a20 2020 2020 2020 2073 656c 662e 6361  .        self.ca
-00000c30: 6e5f 7772 6974 6520 3d20 4661 6c73 650a  n_write = False.
-00000c40: 2020 2020 2020 2020 7365 6c66 2e63 616e          self.can
-00000c50: 5f6d 6f76 6520 3d20 4661 6c73 650a 2020  _move = False.  
-00000c60: 2020 2020 2020 7365 6c66 2e63 616e 5f64        self.can_d
-00000c70: 656c 6574 6520 3d20 4661 6c73 650a 2020  elete = False.  
-00000c80: 2020 2020 2020 7365 6c66 2e63 616e 5f67        self.can_g
-00000c90: 6574 203d 2046 616c 7365 0a20 2020 2020  et = False.     
-00000ca0: 2020 2073 656c 662e 6361 6e5f 7570 6765     self.can_upge
-00000cb0: 7420 3d20 4661 6c73 650a 2020 2020 2020  t = False.      
-00000cc0: 2020 2320 706f 7374 0a20 2020 2020 2020    # post.       
-00000cd0: 2073 656c 662e 7061 7273 6572 2020 3d20   self.parser  = 
-00000ce0: 4e6f 6e65 0a20 2020 2020 2020 2023 2065  None.        # e
-00000cf0: 6e64 2070 6c61 6365 686f 6c64 6572 730a  nd placeholders.
-00000d00: 0a20 2020 2020 2020 2073 656c 662e 6275  .        self.bu
-00000d10: 6673 7a20 3d20 3130 3234 202a 2033 320a  fsz = 1024 * 32.
-00000d20: 2020 2020 2020 2020 7365 6c66 2e68 696e          self.hin
-00000d30: 7420 3d20 2222 0a20 2020 2020 2020 2073  t = "".        s
-00000d40: 656c 662e 7472 6169 6c69 6e67 5f73 6c61  elf.trailing_sla
-00000d50: 7368 203d 2054 7275 650a 2020 2020 2020  sh = True.      
-00000d60: 2020 7365 6c66 2e6f 7574 5f68 6561 6465    self.out_heade
-00000d70: 726c 6973 7420 2020 3d20 5b5d 0a20 2020  rlist   = [].   
-00000d80: 2020 2020 2073 656c 662e 6f75 745f 6865       self.out_he
-00000d90: 6164 6572 7320 3d20 7b0a 2020 2020 2020  aders = {.      
-00000da0: 2020 2020 2020 2256 6172 7922 3a20 224f        "Vary": "O
-00000db0: 7269 6769 6e2c 2050 572c 2043 6f6f 6b69  rigin, PW, Cooki
-00000dc0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00000dd0: 2243 6163 6865 2d43 6f6e 7472 6f6c 223a  "Cache-Control":
-00000de0: 2022 6e6f 2d73 746f 7265 2c20 6d61 782d   "no-store, max-
-00000df0: 6167 653d 3022 2c0a 2020 2020 2020 2020  age=0",.        
-00000e00: 7d0a 2020 2020 2020 2020 6820 3d20 7365  }.        h = se
-00000e10: 6c66 2e61 7267 732e 6874 6d6c 5f68 6561  lf.args.html_hea
-00000e20: 640a 2020 2020 2020 2020 6966 2073 656c  d.        if sel
-00000e30: 662e 6172 6773 2e6e 6f5f 726f 626f 7473  f.args.no_robots
-00000e40: 3a0a 2020 2020 2020 2020 2020 2020 6820  :.            h 
-00000e50: 3d20 4d45 5441 5f4e 4f42 4f54 5320 2b20  = META_NOBOTS + 
-00000e60: 2828 225c 6e22 202b 2068 2920 6966 2068  (("\n" + h) if h
-00000e70: 2065 6c73 6520 2222 290a 2020 2020 2020   else "").      
-00000e80: 2020 2020 2020 7365 6c66 2e6f 7574 5f68        self.out_h
-00000e90: 6561 6465 7273 5b22 582d 526f 626f 7473  eaders["X-Robots
-00000ea0: 2d54 6167 225d 203d 2022 6e6f 696e 6465  -Tag"] = "noinde
-00000eb0: 782c 206e 6f66 6f6c 6c6f 7722 0a20 2020  x, nofollow".   
-00000ec0: 2020 2020 2073 656c 662e 6874 6d6c 5f68       self.html_h
-00000ed0: 6561 6420 3d20 680a 0a20 2020 2064 6566  ead = h..    def
-00000ee0: 206c 6f67 2873 656c 662c 206d 7367 202c   log(self, msg ,
-00000ef0: 2063 2020 203d 2030 2920 203a 0a20 2020   c   = 0)  :.   
-00000f00: 2020 2020 2070 746e 203d 2073 656c 662e       ptn = self.
-00000f10: 6173 7276 2e72 655f 7077 640a 2020 2020  asrv.re_pwd.    
-00000f20: 2020 2020 6966 2070 746e 2061 6e64 2070      if ptn and p
-00000f30: 746e 2e73 6561 7263 6828 6d73 6729 3a0a  tn.search(msg):.
-00000f40: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00000f50: 3d20 7074 6e2e 7375 6228 7365 6c66 2e75  = ptn.sub(self.u
-00000f60: 6e70 7764 2c20 6d73 6729 0a0a 2020 2020  npwd, msg)..    
-00000f70: 2020 2020 7365 6c66 2e6c 6f67 5f66 756e      self.log_fun
-00000f80: 6328 7365 6c66 2e6c 6f67 5f73 7263 2c20  c(self.log_src, 
-00000f90: 6d73 672c 2063 290a 0a20 2020 2064 6566  msg, c)..    def
-00000fa0: 2075 6e70 7764 2873 656c 662c 206d 2029   unpwd(self, m )
-00000fb0: 2020 3a0a 2020 2020 2020 2020 612c 2062    :.        a, b
-00000fc0: 203d 206d 2e67 726f 7570 7328 290a 2020   = m.groups().  
-00000fd0: 2020 2020 2020 7265 7475 726e 2022 3d5c        return "=\
-00000fe0: 3033 335b 376d 207b 7d20 5c30 3333 5b32  033[7m {} \033[2
-00000ff0: 376d 7b7d 222e 666f 726d 6174 2873 656c  7m{}".format(sel
-00001000: 662e 6173 7276 2e69 6163 6374 5b61 5d2c  f.asrv.iacct[a],
-00001010: 2062 290a 0a20 2020 2064 6566 205f 6368   b)..    def _ch
-00001020: 6563 6b5f 6e6f 6e66 6174 616c 2873 656c  eck_nonfatal(sel
-00001030: 662c 2065 7820 2c20 706f 7374 2029 2020  f, ex , post )  
-00001040: 3a0a 2020 2020 2020 2020 6966 2070 6f73  :.        if pos
-00001050: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-00001060: 6574 7572 6e20 6578 2e63 6f64 6520 3c20  eturn ex.code < 
-00001070: 3330 300a 0a20 2020 2020 2020 2072 6574  300..        ret
-00001080: 7572 6e20 6578 2e63 6f64 6520 3c20 3430  urn ex.code < 40
-00001090: 3020 6f72 2065 782e 636f 6465 2069 6e20  0 or ex.code in 
-000010a0: 5b34 3034 2c20 3432 395d 0a0a 2020 2020  [404, 429]..    
-000010b0: 6465 6620 5f61 7373 6572 745f 7361 6665  def _assert_safe
-000010c0: 5f72 656d 2873 656c 662c 2072 656d 2029  _rem(self, rem )
-000010d0: 2020 3a0a 2020 2020 2020 2020 2320 7361    :.        # sa
-000010e0: 6e69 7479 2063 6865 636b 2074 6f20 7072  nity check to pr
-000010f0: 6576 656e 7420 616e 7920 6469 7361 7374  event any disast
-00001100: 6572 730a 2020 2020 2020 2020 6966 2072  ers.        if r
-00001110: 656d 2e73 7461 7274 7377 6974 6828 222f  em.startswith("/
-00001120: 2229 206f 7220 7265 6d2e 7374 6172 7473  ") or rem.starts
-00001130: 7769 7468 2822 2e2e 2f22 2920 6f72 2022  with("../") or "
-00001140: 2f2e 2e2f 2220 696e 2072 656d 3a0a 2020  /../" in rem:.  
-00001150: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00001160: 4578 6365 7074 696f 6e28 2274 6861 7420  Exception("that 
-00001170: 7761 7320 636c 6f73 6522 290a 0a20 2020  was close")..   
-00001180: 2064 6566 205f 6765 6e5f 666b 2873 656c   def _gen_fk(sel
-00001190: 662c 2073 616c 7420 2c20 6673 7061 7468  f, salt , fspath
-000011a0: 202c 2066 7369 7a65 202c 2069 6e6f 6465   , fsize , inode
-000011b0: 2029 2020 3a0a 2020 2020 2020 2020 7265   )  :.        re
-000011c0: 7475 726e 2067 656e 5f66 696c 656b 6579  turn gen_filekey
-000011d0: 5f64 6267 2873 616c 742c 2066 7370 6174  _dbg(salt, fspat
-000011e0: 682c 2066 7369 7a65 2c20 696e 6f64 652c  h, fsize, inode,
-000011f0: 2073 656c 662e 6c6f 672c 2073 656c 662e   self.log, self.
-00001200: 6172 6773 2e6c 6f67 5f66 6b29 0a0a 2020  args.log_fk)..  
-00001210: 2020 6465 6620 6a32 7328 7365 6c66 2c20    def j2s(self, 
-00001220: 6e61 6d65 202c 202a 2a6b 6120 2920 203a  name , **ka )  :
-00001230: 0a20 2020 2020 2020 2074 706c 203d 2073  .        tpl = s
-00001240: 656c 662e 636f 6e6e 2e68 7372 762e 6a32  elf.conn.hsrv.j2
-00001250: 5b6e 616d 655d 0a20 2020 2020 2020 206b  [name].        k
-00001260: 615b 2272 225d 203d 2073 656c 662e 6172  a["r"] = self.ar
-00001270: 6773 2e53 5220 6966 2073 656c 662e 6973  gs.SR if self.is
-00001280: 5f76 7072 6f78 6965 6420 656c 7365 2022  _vproxied else "
-00001290: 220a 2020 2020 2020 2020 6b61 5b22 7473  ".        ka["ts
-000012a0: 225d 203d 2073 656c 662e 636f 6e6e 2e68  "] = self.conn.h
-000012b0: 7372 762e 6361 6368 6562 7573 7465 7228  srv.cachebuster(
-000012c0: 290a 2020 2020 2020 2020 6b61 5b22 6c61  ).        ka["la
-000012d0: 6e67 225d 203d 2073 656c 662e 6172 6773  ng"] = self.args
-000012e0: 2e6c 616e 670a 2020 2020 2020 2020 6b61  .lang.        ka
-000012f0: 5b22 6661 7669 636f 225d 203d 2073 656c  ["favico"] = sel
-00001300: 662e 6172 6773 2e66 6176 6963 6f0a 2020  f.args.favico.  
-00001310: 2020 2020 2020 6b61 5b22 7376 636e 616d        ka["svcnam
-00001320: 6522 5d20 3d20 7365 6c66 2e61 7267 732e  e"] = self.args.
-00001330: 646f 6374 6974 6c65 0a20 2020 2020 2020  doctitle.       
-00001340: 206b 615b 2268 746d 6c5f 6865 6164 225d   ka["html_head"]
-00001350: 203d 2073 656c 662e 6874 6d6c 5f68 6561   = self.html_hea
-00001360: 640a 2020 2020 2020 2020 7265 7475 726e  d.        return
-00001370: 2074 706c 2e72 656e 6465 7228 2a2a 6b61   tpl.render(**ka
-00001380: 2920 2023 2074 7970 653a 2069 676e 6f72  )  # type: ignor
-00001390: 650a 0a20 2020 2064 6566 206a 326a 2873  e..    def j2j(s
-000013a0: 656c 662c 206e 616d 6520 2920 203a 0a20  elf, name )  :. 
-000013b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000013c0: 6c66 2e63 6f6e 6e2e 6873 7276 2e6a 325b  lf.conn.hsrv.j2[
-000013d0: 6e61 6d65 5d0a 0a20 2020 2064 6566 2072  name]..    def r
-000013e0: 756e 2873 656c 6629 2020 3a0a 2020 2020  un(self)  :.    
-000013f0: 2020 2020 2222 2272 6574 7572 6e73 2074      """returns t
-00001400: 7275 6520 6966 2063 6f6e 6e65 6374 696f  rue if connectio
-00001410: 6e20 6361 6e20 6265 2072 6575 7365 6422  n can be reused"
-00001420: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00001430: 6b65 6570 616c 6976 6520 3d20 4661 6c73  keepalive = Fals
-00001440: 650a 2020 2020 2020 2020 7365 6c66 2e69  e.        self.i
-00001450: 735f 6874 7470 7320 3d20 4661 6c73 650a  s_https = False.
-00001460: 2020 2020 2020 2020 7365 6c66 2e68 6561          self.hea
-00001470: 6465 7273 203d 207b 7d0a 2020 2020 2020  ders = {}.      
-00001480: 2020 7365 6c66 2e68 696e 7420 3d20 2222    self.hint = ""
-00001490: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000014a0: 662e 6973 5f62 616e 6e65 6428 293a 0a20  f.is_banned():. 
-000014b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000014c0: 6e20 4661 6c73 650a 0a20 2020 2020 2020  n False..       
-000014d0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-000014e0: 2020 7365 6c66 2e73 2e73 6574 7469 6d65    self.s.settime
-000014f0: 6f75 7428 3229 0a20 2020 2020 2020 2020  out(2).         
-00001500: 2020 2068 6561 6465 726c 696e 6573 203d     headerlines =
-00001510: 2072 6561 645f 6865 6164 6572 2873 656c   read_header(sel
-00001520: 662e 7372 290a 2020 2020 2020 2020 2020  f.sr).          
-00001530: 2020 7365 6c66 2e69 6e5f 6864 725f 7265    self.in_hdr_re
-00001540: 6376 203d 2046 616c 7365 0a20 2020 2020  cv = False.     
-00001550: 2020 2020 2020 2069 6620 6e6f 7420 6865         if not he
-00001560: 6164 6572 6c69 6e65 733a 0a20 2020 2020  aderlines:.     
-00001570: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00001580: 6e20 4661 6c73 650a 0a20 2020 2020 2020  n False..       
-00001590: 2020 2020 2069 6620 6e6f 7420 6865 6164       if not head
-000015a0: 6572 6c69 6e65 735b 305d 3a0a 2020 2020  erlines[0]:.    
-000015b0: 2020 2020 2020 2020 2020 2020 2320 7365              # se
-000015c0: 656e 2061 6674 6572 206c 6f67 696e 2077  en after login w
-000015d0: 6974 6820 4945 362e 302e 3239 3030 2e35  ith IE6.0.2900.5
-000015e0: 3531 322e 7870 7370 2e30 3830 3431 332d  512.xpsp.080413-
-000015f0: 3231 3131 2028 7870 2d73 7033 290a 2020  2111 (xp-sp3).  
-00001600: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00001610: 6c66 2e6c 6f67 2822 4255 473a 2074 7261  lf.log("BUG: tra
-00001620: 696c 696e 6720 6e65 776c 696e 6520 6672  iling newline fr
-00001630: 6f6d 2070 7265 7669 6f75 7320 7265 7175  om previous requ
-00001640: 6573 7422 2c20 633d 2231 3b33 3122 290a  est", c="1;31").
-00001650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001660: 6865 6164 6572 6c69 6e65 732e 706f 7028  headerlines.pop(
-00001670: 3029 0a0a 2020 2020 2020 2020 2020 2020  0)..            
-00001680: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00001690: 2020 2020 2073 656c 662e 6d6f 6465 2c20       self.mode, 
-000016a0: 7365 6c66 2e72 6571 2c20 7365 6c66 2e68  self.req, self.h
-000016b0: 7474 705f 7665 7220 3d20 6865 6164 6572  ttp_ver = header
-000016c0: 6c69 6e65 735b 305d 2e73 706c 6974 2822  lines[0].split("
-000016d0: 2022 290a 0a20 2020 2020 2020 2020 2020   ")..           
-000016e0: 2020 2020 2023 206e 6f72 6d61 6c69 7a65       # normalize
-000016f0: 2069 6e63 6f6d 696e 6720 6865 6164 6572   incoming header
-00001700: 7320 746f 206c 6f77 6572 6361 7365 3b0a  s to lowercase;.
-00001710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001720: 2320 6f75 7467 6f69 6e67 2068 6561 6465  # outgoing heade
-00001730: 7273 2068 6f77 6576 6572 2061 7265 2043  rs however are C
-00001740: 6f72 7265 6374 2d43 6173 650a 2020 2020  orrect-Case.    
-00001750: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00001760: 6865 6164 6572 5f6c 696e 6520 696e 2068  header_line in h
-00001770: 6561 6465 726c 696e 6573 5b31 3a5d 3a0a  eaderlines[1:]:.
-00001780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001790: 2020 2020 6b2c 207a 7320 3d20 6865 6164      k, zs = head
-000017a0: 6572 5f6c 696e 652e 7370 6c69 7428 223a  er_line.split(":
-000017b0: 222c 2031 290a 2020 2020 2020 2020 2020  ", 1).          
-000017c0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-000017d0: 6561 6465 7273 5b6b 2e6c 6f77 6572 2829  eaders[k.lower()
-000017e0: 5d20 3d20 7a73 2e73 7472 6970 2829 0a20  ] = zs.strip(). 
-000017f0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00001800: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-00001810: 2020 206d 7367 203d 2022 205d 5c6e 235b     msg = " ]\n#[
-00001820: 2022 2e6a 6f69 6e28 6865 6164 6572 6c69   ".join(headerli
-00001830: 6e65 7329 0a20 2020 2020 2020 2020 2020  nes).           
-00001840: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-00001850: 6328 3430 302c 2022 6261 6420 6865 6164  c(400, "bad head
-00001860: 6572 733a 5c6e 235b 2022 202b 206d 7367  ers:\n#[ " + msg
-00001870: 202b 2022 205d 2229 0a0a 2020 2020 2020   + " ]")..      
-00001880: 2020 6578 6365 7074 2050 6562 6b61 6320    except Pebkac 
-00001890: 6173 2065 783a 0a20 2020 2020 2020 2020  as ex:.         
-000018a0: 2020 2073 656c 662e 6d6f 6465 203d 2022     self.mode = "
-000018b0: 4745 5422 0a20 2020 2020 2020 2020 2020  GET".           
-000018c0: 2073 656c 662e 7265 7120 3d20 225b 6a75   self.req = "[ju
-000018d0: 6e6b 5d22 0a20 2020 2020 2020 2020 2020  nk]".           
-000018e0: 2073 656c 662e 6874 7470 5f76 6572 203d   self.http_ver =
-000018f0: 2022 4854 5450 2f31 2e31 220a 2020 2020   "HTTP/1.1".    
-00001900: 2020 2020 2020 2020 2320 7365 6c66 2e6c          # self.l
-00001910: 6f67 2822 7065 626b 6163 2061 7420 6874  og("pebkac at ht
-00001920: 7470 636c 692e 7275 6e20 2331 3a20 2220  tpcli.run #1: " 
-00001930: 2b20 7265 7072 2865 7829 290a 2020 2020  + repr(ex)).    
-00001940: 2020 2020 2020 2020 7365 6c66 2e6b 6565          self.kee
-00001950: 7061 6c69 7665 203d 2046 616c 7365 0a20  palive = False. 
-00001960: 2020 2020 2020 2020 2020 2068 203d 207b             h = {
-00001970: 2257 5757 2d41 7574 6865 6e74 6963 6174  "WWW-Authenticat
-00001980: 6522 3a20 2742 6173 6963 2072 6561 6c6d  e": 'Basic realm
-00001990: 3d22 6122 277d 2069 6620 6578 2e63 6f64  ="a"'} if ex.cod
-000019a0: 6520 3d3d 2034 3031 2065 6c73 6520 7b7d  e == 401 else {}
-000019b0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-000019c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000019d0: 2020 7365 6c66 2e6c 6f75 645f 7265 706c    self.loud_repl
-000019e0: 7928 756e 6963 6f64 6528 6578 292c 2073  y(unicode(ex), s
-000019f0: 7461 7475 733d 6578 2e63 6f64 652c 2068  tatus=ex.code, h
-00001a00: 6561 6465 7273 3d68 2c20 766f 6c73 616e  eaders=h, volsan
-00001a10: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00001a20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001a30: 6c66 2e6b 6565 7061 6c69 7665 0a20 2020  lf.keepalive.   
-00001a40: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00001a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001a60: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-00001a70: 2020 2020 2020 2073 656c 662e 7561 203d         self.ua =
-00001a80: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
-00001a90: 7428 2275 7365 722d 6167 656e 7422 2c20  t("user-agent", 
-00001aa0: 2222 290a 2020 2020 2020 2020 7365 6c66  "").        self
-00001ab0: 2e69 735f 7263 6c6f 6e65 203d 2073 656c  .is_rclone = sel
-00001ac0: 662e 7561 2e73 7461 7274 7377 6974 6828  f.ua.startswith(
-00001ad0: 2272 636c 6f6e 652f 2229 0a0a 2020 2020  "rclone/")..    
-00001ae0: 2020 2020 7a73 203d 2073 656c 662e 6865      zs = self.he
-00001af0: 6164 6572 732e 6765 7428 2263 6f6e 6e65  aders.get("conne
-00001b00: 6374 696f 6e22 2c20 2222 292e 6c6f 7765  ction", "").lowe
-00001b10: 7228 290a 2020 2020 2020 2020 7365 6c66  r().        self
-00001b20: 2e6b 6565 7061 6c69 7665 203d 2022 636c  .keepalive = "cl
-00001b30: 6f73 6522 206e 6f74 2069 6e20 7a73 2061  ose" not in zs a
-00001b40: 6e64 2028 0a20 2020 2020 2020 2020 2020  nd (.           
-00001b50: 2073 656c 662e 6874 7470 5f76 6572 2021   self.http_ver !
-00001b60: 3d20 2248 5454 502f 312e 3022 206f 7220  = "HTTP/1.0" or 
-00001b70: 7a73 203d 3d20 226b 6565 702d 616c 6976  zs == "keep-aliv
-00001b80: 6522 0a20 2020 2020 2020 2029 0a20 2020  e".        ).   
-00001b90: 2020 2020 2073 656c 662e 6973 5f68 7474       self.is_htt
-00001ba0: 7073 203d 2028 0a20 2020 2020 2020 2020  ps = (.         
-00001bb0: 2020 2073 656c 662e 6865 6164 6572 732e     self.headers.
-00001bc0: 6765 7428 2278 2d66 6f72 7761 7264 6564  get("x-forwarded
-00001bd0: 2d70 726f 746f 222c 2022 2229 2e6c 6f77  -proto", "").low
-00001be0: 6572 2829 203d 3d20 2268 7474 7073 2220  er() == "https" 
-00001bf0: 6f72 2073 656c 662e 746c 730a 2020 2020  or self.tls.    
-00001c00: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00001c10: 6c66 2e68 6f73 7420 3d20 7365 6c66 2e68  lf.host = self.h
-00001c20: 6561 6465 7273 2e67 6574 2822 686f 7374  eaders.get("host
-00001c30: 2229 206f 7220 227b 7d3a 7b7d 222e 666f  ") or "{}:{}".fo
-00001c40: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-00001c50: 2020 2a6c 6973 7428 7365 6c66 2e73 2e67    *list(self.s.g
-00001c60: 6574 736f 636b 6e61 6d65 2829 5b3a 325d  etsockname()[:2]
-00001c70: 290a 2020 2020 2020 2020 290a 0a20 2020  ).        )..   
-00001c80: 2020 2020 206e 203d 2073 656c 662e 6172       n = self.ar
-00001c90: 6773 2e72 7072 6f78 790a 2020 2020 2020  gs.rproxy.      
-00001ca0: 2020 6966 206e 3a0a 2020 2020 2020 2020    if n:.        
-00001cb0: 2020 2020 7a73 6f20 3d20 7365 6c66 2e68      zso = self.h
-00001cc0: 6561 6465 7273 2e67 6574 2822 782d 666f  eaders.get("x-fo
-00001cd0: 7277 6172 6465 642d 666f 7222 290a 2020  rwarded-for").  
-00001ce0: 2020 2020 2020 2020 2020 6966 207a 736f            if zso
-00001cf0: 2061 6e64 2073 656c 662e 636f 6e6e 2e61   and self.conn.a
-00001d00: 6464 725b 305d 2069 6e20 5b22 3132 372e  ddr[0] in ["127.
-00001d10: 302e 302e 3122 2c20 223a 3a31 225d 3a0a  0.0.1", "::1"]:.
-00001d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d30: 6966 206e 203e 2030 3a0a 2020 2020 2020  if n > 0:.      
-00001d40: 2020 2020 2020 2020 2020 2020 2020 6e20                n 
-00001d50: 2d3d 2031 0a0a 2020 2020 2020 2020 2020  -= 1..          
-00001d60: 2020 2020 2020 7a73 6c20 3d20 7a73 6f2e        zsl = zso.
-00001d70: 7370 6c69 7428 222c 2229 0a20 2020 2020  split(",").     
-00001d80: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00001d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001da0: 2020 2020 7365 6c66 2e69 7020 3d20 7a73      self.ip = zs
-00001db0: 6c5b 6e5d 2e73 7472 6970 2829 0a20 2020  l[n].strip().   
-00001dc0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-00001dd0: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
-00001de0: 2020 2020 2020 2020 2073 656c 662e 6970           self.ip
-00001df0: 203d 207a 736c 5b30 5d2e 7374 7269 7028   = zsl[0].strip(
-00001e00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00001e10: 2020 2020 2020 7420 3d20 2272 7072 6f78        t = "rprox
-00001e20: 793d 7b7d 206f 6f62 2078 2d66 7764 207b  y={} oob x-fwd {
-00001e30: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00001e40: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-00001e50: 742e 666f 726d 6174 2873 656c 662e 6172  t.format(self.ar
-00001e60: 6773 2e72 7072 6f78 792c 207a 736f 292c  gs.rproxy, zso),
-00001e70: 2063 3d33 290a 0a20 2020 2020 2020 2020   c=3)..         
-00001e80: 2020 2020 2020 2073 656c 662e 6c6f 675f         self.log_
-00001e90: 7372 6320 3d20 7365 6c66 2e63 6f6e 6e2e  src = self.conn.
-00001ea0: 7365 745f 7270 726f 7879 2873 656c 662e  set_rproxy(self.
-00001eb0: 6970 290a 2020 2020 2020 2020 2020 2020  ip).            
-00001ec0: 2020 2020 7365 6c66 2e69 735f 7670 726f      self.is_vpro
-00001ed0: 7869 6564 203d 2062 6f6f 6c28 7365 6c66  xied = bool(self
-00001ee0: 2e61 7267 732e 5229 0a20 2020 2020 2020  .args.R).       
-00001ef0: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
-00001f00: 7374 203d 2073 656c 662e 6865 6164 6572  st = self.header
-00001f10: 732e 6765 7428 2278 2d66 6f72 7761 7264  s.get("x-forward
-00001f20: 6564 2d68 6f73 7422 2920 6f72 2073 656c  ed-host") or sel
-00001f30: 662e 686f 7374 0a0a 2020 2020 2020 2020  f.host..        
-00001f40: 6966 2073 656c 662e 6973 5f62 616e 6e65  if self.is_banne
-00001f50: 6428 293a 0a20 2020 2020 2020 2020 2020  d():.           
-00001f60: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
-00001f70: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00001f80: 6f6e 6e2e 6163 6c6f 7365 3a0a 2020 2020  onn.aclose:.    
-00001f90: 2020 2020 2020 2020 6e6b 6120 3d20 7365          nka = se
-00001fa0: 6c66 2e63 6f6e 6e2e 6163 6c6f 7365 0a20  lf.conn.aclose. 
-00001fb0: 2020 2020 2020 2020 2020 2069 7020 3d20             ip = 
-00001fc0: 6970 6e6f 726d 2873 656c 662e 6970 290a  ipnorm(self.ip).
-00001fd0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00001fe0: 7020 696e 206e 6b61 3a0a 2020 2020 2020  p in nka:.      
-00001ff0: 2020 2020 2020 2020 2020 7274 203d 206e            rt = n
-00002000: 6b61 5b69 705d 202d 2074 696d 652e 7469  ka[ip] - time.ti
-00002010: 6d65 2829 0a20 2020 2020 2020 2020 2020  me().           
-00002020: 2020 2020 2069 6620 7274 203c 2030 3a0a       if rt < 0:.
-00002030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002040: 2020 2020 7365 6c66 2e6c 6f67 2822 636c      self.log("cl
-00002050: 6965 6e74 2075 6e63 6170 7065 6422 2c20  ient uncapped", 
-00002060: 3329 0a20 2020 2020 2020 2020 2020 2020  3).             
-00002070: 2020 2020 2020 2064 656c 206e 6b61 5b69         del nka[i
-00002080: 705d 0a20 2020 2020 2020 2020 2020 2020  p].             
-00002090: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000020a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000020b0: 662e 6b65 6570 616c 6976 6520 3d20 4661  f.keepalive = Fa
-000020c0: 6c73 650a 0a20 2020 2020 2020 2070 746e  lse..        ptn
-000020d0: 2020 3d20 7365 6c66 2e63 6f6e 6e2e 6c66    = self.conn.lf
-000020e0: 5f75 726c 2020 2320 6d79 7079 3430 340a  _url  # mypy404.
-000020f0: 2020 2020 2020 2020 7365 6c66 2e64 6f5f          self.do_
-00002100: 6c6f 6720 3d20 6e6f 7420 7074 6e20 6f72  log = not ptn or
-00002110: 206e 6f74 2070 746e 2e73 6561 7263 6828   not ptn.search(
-00002120: 7365 6c66 2e72 6571 290a 0a20 2020 2020  self.req)..     
-00002130: 2020 2069 6620 7365 6c66 2e61 7267 732e     if self.args.
-00002140: 6968 6561 6420 616e 6420 7365 6c66 2e64  ihead and self.d
-00002150: 6f5f 6c6f 673a 0a20 2020 2020 2020 2020  o_log:.         
-00002160: 2020 206b 6579 7320 3d20 7365 6c66 2e61     keys = self.a
-00002170: 7267 732e 6968 6561 640a 2020 2020 2020  rgs.ihead.      
-00002180: 2020 2020 2020 6966 2022 2a22 2069 6e20        if "*" in 
-00002190: 6b65 7973 3a0a 2020 2020 2020 2020 2020  keys:.          
-000021a0: 2020 2020 2020 6b65 7973 203d 206c 6973        keys = lis
-000021b0: 7428 736f 7274 6564 2873 656c 662e 6865  t(sorted(self.he
-000021c0: 6164 6572 732e 6b65 7973 2829 2929 0a0a  aders.keys()))..
-000021d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000021e0: 6b20 696e 206b 6579 733a 0a20 2020 2020  k in keys:.     
-000021f0: 2020 2020 2020 2020 2020 207a 736f 203d             zso =
-00002200: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
-00002210: 7428 6b29 0a20 2020 2020 2020 2020 2020  t(k).           
-00002220: 2020 2020 2069 6620 7a73 6f20 6973 206e       if zso is n
-00002230: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00002240: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00002250: 662e 6c6f 6728 225b 485d 207b 7d3a 205c  f.log("[H] {}: \
-00002260: 3033 335b 3333 6d5b 7b7d 5d22 2e66 6f72  033[33m[{}]".for
-00002270: 6d61 7428 6b2c 207a 736f 292c 2036 290a  mat(k, zso), 6).
-00002280: 0a20 2020 2020 2020 2069 6620 2226 2220  .        if "&" 
-00002290: 696e 2073 656c 662e 7265 7120 616e 6420  in self.req and 
-000022a0: 223f 2220 6e6f 7420 696e 2073 656c 662e  "?" not in self.
-000022b0: 7265 713a 0a20 2020 2020 2020 2020 2020  req:.           
-000022c0: 2073 656c 662e 6869 6e74 203d 2022 6469   self.hint = "di
-000022d0: 6420 796f 7520 6d65 616e 2027 3f27 2069  d you mean '?' i
-000022e0: 6e73 7465 6164 206f 6620 2726 2722 0a0a  nstead of '&'"..
-000022f0: 2020 2020 2020 2020 2320 7370 6c69 7420          # split 
-00002300: 7265 7120 696e 746f 2076 7061 7468 202b  req into vpath +
-00002310: 2075 7061 7261 6d0a 2020 2020 2020 2020   uparam.        
-00002320: 7570 6172 616d 203d 207b 7d0a 2020 2020  uparam = {}.    
-00002330: 2020 2020 6966 2022 3f22 206e 6f74 2069      if "?" not i
-00002340: 6e20 7365 6c66 2e72 6571 3a0a 2020 2020  n self.req:.    
-00002350: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
-00002360: 696c 696e 675f 736c 6173 6820 3d20 7365  iling_slash = se
-00002370: 6c66 2e72 6571 2e65 6e64 7377 6974 6828  lf.req.endswith(
-00002380: 222f 2229 0a20 2020 2020 2020 2020 2020  "/").           
-00002390: 2076 7061 7468 203d 2075 6e64 6f74 2873   vpath = undot(s
-000023a0: 656c 662e 7265 7129 0a20 2020 2020 2020  elf.req).       
-000023b0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000023c0: 2020 2076 7061 7468 2c20 6172 676c 6973     vpath, arglis
-000023d0: 7420 3d20 7365 6c66 2e72 6571 2e73 706c  t = self.req.spl
-000023e0: 6974 2822 3f22 2c20 3129 0a20 2020 2020  it("?", 1).     
-000023f0: 2020 2020 2020 2073 656c 662e 7472 6169         self.trai
-00002400: 6c69 6e67 5f73 6c61 7368 203d 2076 7061  ling_slash = vpa
-00002410: 7468 2e65 6e64 7377 6974 6828 222f 2229  th.endswith("/")
-00002420: 0a20 2020 2020 2020 2020 2020 2076 7061  .            vpa
-00002430: 7468 203d 2075 6e64 6f74 2876 7061 7468  th = undot(vpath
-00002440: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00002450: 7220 6b20 696e 2061 7267 6c69 7374 2e73  r k in arglist.s
-00002460: 706c 6974 2822 2622 293a 0a20 2020 2020  plit("&"):.     
-00002470: 2020 2020 2020 2020 2020 2069 6620 223d             if "=
-00002480: 2220 696e 206b 3a0a 2020 2020 2020 2020  " in k:.        
-00002490: 2020 2020 2020 2020 2020 2020 6b2c 207a              k, z
-000024a0: 7320 3d20 6b2e 7370 6c69 7428 223d 222c  s = k.split("=",
-000024b0: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
-000024c0: 2020 2020 2020 2020 7570 6172 616d 5b6b          uparam[k
-000024d0: 2e6c 6f77 6572 2829 5d20 3d20 7a73 2e73  .lower()] = zs.s
-000024e0: 7472 6970 2829 0a20 2020 2020 2020 2020  trip().         
-000024f0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00002500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002510: 2075 7061 7261 6d5b 6b2e 6c6f 7765 7228   uparam[k.lower(
-00002520: 295d 203d 2022 220a 0a20 2020 2020 2020  )] = ""..       
-00002530: 2069 6620 7365 6c66 2e69 735f 7670 726f   if self.is_vpro
-00002540: 7869 6564 3a0a 2020 2020 2020 2020 2020  xied:.          
-00002550: 2020 6966 2076 7061 7468 2e73 7461 7274    if vpath.start
-00002560: 7377 6974 6828 7365 6c66 2e61 7267 732e  swith(self.args.
-00002570: 5229 3a0a 2020 2020 2020 2020 2020 2020  R):.            
-00002580: 2020 2020 7670 6174 6820 3d20 7670 6174      vpath = vpat
-00002590: 685b 6c65 6e28 7365 6c66 2e61 7267 732e  h[len(self.args.
-000025a0: 5229 202b 2031 203a 5d0a 2020 2020 2020  R) + 1 :].      
-000025b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000025c0: 2020 2020 2020 2020 2020 2020 7420 3d20              t = 
-000025d0: 2269 6e63 6f72 7265 6374 202d 2d72 702d  "incorrect --rp-
-000025e0: 6c6f 6320 6f72 2077 6562 7365 7276 6572  loc or webserver
-000025f0: 2063 6f6e 6669 673b 2065 7870 6563 7465   config; expecte
-00002600: 6420 7670 6174 6820 7374 6172 7469 6e67  d vpath starting
-00002610: 2077 6974 6820 5b7b 7d5d 2062 7574 2067   with [{}] but g
-00002620: 6f74 205b 7b7d 5d22 0a20 2020 2020 2020  ot [{}]".       
-00002630: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00002640: 6728 742e 666f 726d 6174 2873 656c 662e  g(t.format(self.
-00002650: 6172 6773 2e52 2c20 7670 6174 6829 2c20  args.R, vpath), 
-00002660: 3129 0a0a 2020 2020 2020 2020 7365 6c66  1)..        self
-00002670: 2e6f 7570 6172 616d 203d 207b 6b3a 207a  .ouparam = {k: z
-00002680: 7320 666f 7220 6b2c 207a 7320 696e 2075  s for k, zs in u
-00002690: 7061 7261 6d2e 6974 656d 7328 297d 0a0a  param.items()}..
-000026a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000026b0: 6172 6773 2e72 7370 5f73 6c70 3a0a 2020  args.rsp_slp:.  
-000026c0: 2020 2020 2020 2020 2020 7469 6d65 2e73            time.s
-000026d0: 6c65 6570 2873 656c 662e 6172 6773 2e72  leep(self.args.r
-000026e0: 7370 5f73 6c70 290a 2020 2020 2020 2020  sp_slp).        
-000026f0: 2020 2020 6966 2073 656c 662e 6172 6773      if self.args
-00002700: 2e72 7370 5f6a 7472 3a0a 2020 2020 2020  .rsp_jtr:.      
-00002710: 2020 2020 2020 2020 2020 7469 6d65 2e73            time.s
-00002720: 6c65 6570 2872 616e 646f 6d2e 7261 6e64  leep(random.rand
-00002730: 6f6d 2829 202a 2073 656c 662e 6172 6773  om() * self.args
-00002740: 2e72 7370 5f6a 7472 290a 0a20 2020 2020  .rsp_jtr)..     
-00002750: 2020 207a 736f 203d 2073 656c 662e 6865     zso = self.he
-00002760: 6164 6572 732e 6765 7428 2263 6f6f 6b69  aders.get("cooki
-00002770: 6522 290a 2020 2020 2020 2020 6966 207a  e").        if z
-00002780: 736f 3a0a 2020 2020 2020 2020 2020 2020  so:.            
-00002790: 7a73 6c6c 203d 205b 782e 7370 6c69 7428  zsll = [x.split(
-000027a0: 223d 222c 2031 2920 666f 7220 7820 696e  "=", 1) for x in
-000027b0: 207a 736f 2e73 706c 6974 2822 3b22 2920   zso.split(";") 
-000027c0: 6966 2022 3d22 2069 6e20 785d 0a20 2020  if "=" in x].   
-000027d0: 2020 2020 2020 2020 2063 6f6f 6b69 6573           cookies
-000027e0: 203d 207b 6b2e 7374 7269 7028 293a 2075   = {k.strip(): u
-000027f0: 6e65 7363 6170 655f 636f 6f6b 6965 287a  nescape_cookie(z
-00002800: 7329 2066 6f72 206b 2c20 7a73 2069 6e20  s) for k, zs in 
-00002810: 7a73 6c6c 7d0a 2020 2020 2020 2020 2020  zsll}.          
-00002820: 2020 636f 6f6b 6965 5f70 7720 3d20 636f    cookie_pw = co
-00002830: 6f6b 6965 732e 6765 7428 2263 7070 7773  okies.get("cppws
-00002840: 2229 206f 7220 636f 6f6b 6965 732e 6765  ") or cookies.ge
-00002850: 7428 2263 7070 7764 2229 206f 7220 2222  t("cppwd") or ""
-00002860: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00002870: 2262 2220 696e 2063 6f6f 6b69 6573 2061  "b" in cookies a
-00002880: 6e64 2022 6222 206e 6f74 2069 6e20 7570  nd "b" not in up
-00002890: 6172 616d 3a0a 2020 2020 2020 2020 2020  aram:.          
-000028a0: 2020 2020 2020 7570 6172 616d 5b22 6222        uparam["b"
-000028b0: 5d20 3d20 636f 6f6b 6965 735b 2262 225d  ] = cookies["b"]
-000028c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000028d0: 2020 2020 2020 2020 2020 2063 6f6f 6b69             cooki
-000028e0: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
-000028f0: 2020 2020 636f 6f6b 6965 5f70 7720 3d20      cookie_pw = 
-00002900: 2222 0a0a 2020 2020 2020 2020 6966 206c  ""..        if l
-00002910: 656e 2875 7061 7261 6d29 203e 2031 3020  en(uparam) > 10 
-00002920: 6f72 206c 656e 2863 6f6f 6b69 6573 2920  or len(cookies) 
-00002930: 3e20 3530 3a0a 2020 2020 2020 2020 2020  > 50:.          
-00002940: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
-00002950: 3030 2c20 2275 2077 6f74 206d 3822 290a  00, "u wot m8").
-00002960: 0a20 2020 2020 2020 2073 656c 662e 7570  .        self.up
-00002970: 6172 616d 203d 2075 7061 7261 6d0a 2020  aram = uparam.  
-00002980: 2020 2020 2020 7365 6c66 2e63 6f6f 6b69        self.cooki
-00002990: 6573 203d 2063 6f6f 6b69 6573 0a20 2020  es = cookies.   
-000029a0: 2020 2020 2073 656c 662e 7670 6174 6820       self.vpath 
-000029b0: 3d20 756e 7175 6f74 6570 2876 7061 7468  = unquotep(vpath
-000029c0: 2920 2023 206e 6f74 2071 7565 7279 2c20  )  # not query, 
-000029d0: 736f 202b 206d 6561 6e73 202b 0a0a 2020  so + means +..  
-000029e0: 2020 2020 2020 6f6b 203d 2022 5c78 3030        ok = "\x00
-000029f0: 2220 6e6f 7420 696e 2073 656c 662e 7670  " not in self.vp
-00002a00: 6174 680a 2020 2020 2020 2020 6966 2041  ath.        if A
-00002a10: 4e59 5749 4e3a 0a20 2020 2020 2020 2020  NYWIN:.         
-00002a20: 2020 206f 6b20 3d20 6f6b 2061 6e64 206e     ok = ok and n
-00002a30: 6f74 2072 656c 6368 6b28 7365 6c66 2e76  ot relchk(self.v
-00002a40: 7061 7468 290a 0a20 2020 2020 2020 2069  path)..        i
-00002a50: 6620 6e6f 7420 6f6b 2061 6e64 2028 7365  f not ok and (se
-00002a60: 6c66 2e76 7061 7468 2021 3d20 222a 2220  lf.vpath != "*" 
-00002a70: 6f72 2073 656c 662e 6d6f 6465 2021 3d20  or self.mode != 
-00002a80: 224f 5054 494f 4e53 2229 3a0a 2020 2020  "OPTIONS"):.    
-00002a90: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00002aa0: 2822 696e 7661 6c69 6420 7265 6c70 6174  ("invalid relpat
-00002ab0: 6820 5b7b 7d5d 222e 666f 726d 6174 2873  h [{}]".format(s
-00002ac0: 656c 662e 7670 6174 6829 290a 2020 2020  elf.vpath)).    
-00002ad0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00002ae0: 656c 662e 7478 5f34 3034 2829 2061 6e64  elf.tx_404() and
-00002af0: 2073 656c 662e 6b65 6570 616c 6976 650a   self.keepalive.
-00002b00: 0a20 2020 2020 2020 207a 736f 203d 2073  .        zso = s
-00002b10: 656c 662e 6865 6164 6572 732e 6765 7428  elf.headers.get(
-00002b20: 2261 7574 686f 7269 7a61 7469 6f6e 2229  "authorization")
-00002b30: 0a20 2020 2020 2020 2062 6175 7468 203d  .        bauth =
-00002b40: 2022 220a 2020 2020 2020 2020 6966 207a   "".        if z
-00002b50: 736f 3a0a 2020 2020 2020 2020 2020 2020  so:.            
-00002b60: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00002b70: 2020 2020 207a 6220 3d20 7a73 6f2e 7370       zb = zso.sp
-00002b80: 6c69 7428 2220 2229 5b31 5d2e 656e 636f  lit(" ")[1].enco
-00002b90: 6465 2822 6173 6369 6922 290a 2020 2020  de("ascii").    
-00002ba0: 2020 2020 2020 2020 2020 2020 7a73 203d              zs =
-00002bb0: 2062 6173 6536 342e 6236 3464 6563 6f64   base64.b64decod
-00002bc0: 6528 7a62 292e 6465 636f 6465 2822 7574  e(zb).decode("ut
-00002bd0: 662d 3822 290a 2020 2020 2020 2020 2020  f-8").          
-00002be0: 2020 2020 2020 2320 7472 7920 2270 7764        # try "pwd
-00002bf0: 222c 2022 783a 7077 6422 2c20 2270 7764  ", "x:pwd", "pwd
-00002c00: 3a78 220a 2020 2020 2020 2020 2020 2020  :x".            
-00002c10: 2020 2020 666f 7220 6261 7574 6820 696e      for bauth in
-00002c20: 205b 7a73 5d20 2b20 7a73 2e73 706c 6974   [zs] + zs.split
-00002c30: 2822 3a22 2c20 3129 5b3a 3a2d 315d 3a0a  (":", 1)[::-1]:.
-00002c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c50: 2020 2020 6966 2073 656c 662e 6173 7276      if self.asrv
-00002c60: 2e69 6163 6374 2e67 6574 2862 6175 7468  .iacct.get(bauth
-00002c70: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00002c80: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00002c90: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-00002ca0: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
-00002cb0: 2020 2020 2070 6173 730a 0a20 2020 2020       pass..     
-00002cc0: 2020 2073 656c 662e 7077 203d 2075 7061     self.pw = upa
-00002cd0: 7261 6d2e 6765 7428 2270 7722 2920 6f72  ram.get("pw") or
-00002ce0: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
-00002cf0: 7428 2270 7722 2920 6f72 2062 6175 7468  t("pw") or bauth
-00002d00: 206f 7220 636f 6f6b 6965 5f70 770a 2020   or cookie_pw.  
-00002d10: 2020 2020 2020 7365 6c66 2e75 6e61 6d65        self.uname
-00002d20: 203d 2073 656c 662e 6173 7276 2e69 6163   = self.asrv.iac
-00002d30: 6374 2e67 6574 2873 656c 662e 7077 2920  ct.get(self.pw) 
-00002d40: 6f72 2022 2a22 0a20 2020 2020 2020 2073  or "*".        s
-00002d50: 656c 662e 7276 6f6c 203d 2073 656c 662e  elf.rvol = self.
-00002d60: 6173 7276 2e76 6673 2e61 7265 6164 5b73  asrv.vfs.aread[s
-00002d70: 656c 662e 756e 616d 655d 0a20 2020 2020  elf.uname].     
-00002d80: 2020 2073 656c 662e 7776 6f6c 203d 2073     self.wvol = s
-00002d90: 656c 662e 6173 7276 2e76 6673 2e61 7772  elf.asrv.vfs.awr
-00002da0: 6974 655b 7365 6c66 2e75 6e61 6d65 5d0a  ite[self.uname].
-00002db0: 2020 2020 2020 2020 7365 6c66 2e6d 766f          self.mvo
-00002dc0: 6c20 3d20 7365 6c66 2e61 7372 762e 7666  l = self.asrv.vf
-00002dd0: 732e 616d 6f76 655b 7365 6c66 2e75 6e61  s.amove[self.una
-00002de0: 6d65 5d0a 2020 2020 2020 2020 7365 6c66  me].        self
-00002df0: 2e64 766f 6c20 3d20 7365 6c66 2e61 7372  .dvol = self.asr
-00002e00: 762e 7666 732e 6164 656c 5b73 656c 662e  v.vfs.adel[self.
-00002e10: 756e 616d 655d 0a20 2020 2020 2020 2073  uname].        s
-00002e20: 656c 662e 6776 6f6c 203d 2073 656c 662e  elf.gvol = self.
-00002e30: 6173 7276 2e76 6673 2e61 6765 745b 7365  asrv.vfs.aget[se
-00002e40: 6c66 2e75 6e61 6d65 5d0a 2020 2020 2020  lf.uname].      
-00002e50: 2020 7365 6c66 2e75 7076 6f6c 203d 2073    self.upvol = s
-00002e60: 656c 662e 6173 7276 2e76 6673 2e61 7067  elf.asrv.vfs.apg
-00002e70: 6574 5b73 656c 662e 756e 616d 655d 0a0a  et[self.uname]..
-00002e80: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002e90: 7077 2061 6e64 2028 0a20 2020 2020 2020  pw and (.       
-00002ea0: 2020 2020 2073 656c 662e 7077 2021 3d20       self.pw != 
-00002eb0: 636f 6f6b 6965 5f70 7720 6f72 2073 656c  cookie_pw or sel
-00002ec0: 662e 636f 6e6e 2e66 7265 7368 656e 5f70  f.conn.freshen_p
-00002ed0: 7764 202b 2033 3020 3c20 7469 6d65 2e74  wd + 30 < time.t
-00002ee0: 696d 6528 290a 2020 2020 2020 2020 293a  ime().        ):
-00002ef0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00002f00: 662e 636f 6e6e 2e66 7265 7368 656e 5f70  f.conn.freshen_p
-00002f10: 7764 203d 2074 696d 652e 7469 6d65 2829  wd = time.time()
-00002f20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00002f30: 662e 6765 745f 7077 645f 636f 6f6b 6965  f.get_pwd_cookie
-00002f40: 2873 656c 662e 7077 290a 0a20 2020 2020  (self.pw)..     
-00002f50: 2020 2069 6620 7365 6c66 2e69 735f 7263     if self.is_rc
-00002f60: 6c6f 6e65 3a0a 2020 2020 2020 2020 2020  lone:.          
-00002f70: 2020 7570 6172 616d 5b22 646f 7473 225d    uparam["dots"]
-00002f80: 203d 2022 220a 2020 2020 2020 2020 2020   = "".          
-00002f90: 2020 7570 6172 616d 5b22 6222 5d20 3d20    uparam["b"] = 
-00002fa0: 2222 0a20 2020 2020 2020 2020 2020 2063  "".            c
-00002fb0: 6f6f 6b69 6573 5b22 6222 5d20 3d20 2222  ookies["b"] = ""
-00002fc0: 0a0a 2020 2020 2020 2020 280a 2020 2020  ..        (.    
-00002fd0: 2020 2020 2020 2020 7365 6c66 2e63 616e          self.can
-00002fe0: 5f72 6561 642c 0a20 2020 2020 2020 2020  _read,.         
-00002ff0: 2020 2073 656c 662e 6361 6e5f 7772 6974     self.can_writ
-00003000: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-00003010: 656c 662e 6361 6e5f 6d6f 7665 2c0a 2020  elf.can_move,.  
-00003020: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00003030: 616e 5f64 656c 6574 652c 0a20 2020 2020  an_delete,.     
-00003040: 2020 2020 2020 2073 656c 662e 6361 6e5f         self.can_
-00003050: 6765 742c 0a20 2020 2020 2020 2020 2020  get,.           
-00003060: 2073 656c 662e 6361 6e5f 7570 6765 742c   self.can_upget,
-00003070: 0a20 2020 2020 2020 2029 203d 2073 656c  .        ) = sel
-00003080: 662e 6173 7276 2e76 6673 2e63 616e 5f61  f.asrv.vfs.can_a
-00003090: 6363 6573 7328 7365 6c66 2e76 7061 7468  ccess(self.vpath
-000030a0: 2c20 7365 6c66 2e75 6e61 6d65 290a 0a20  , self.uname).. 
-000030b0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-000030c0: 2020 2020 2020 2020 636f 7273 5f6b 203d          cors_k =
-000030d0: 2073 656c 662e 5f63 6f72 7328 290a 2020   self._cors().  
-000030e0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-000030f0: 662e 6d6f 6465 2069 6e20 2822 4745 5422  f.mode in ("GET"
-00003100: 2c20 2248 4541 4422 293a 0a20 2020 2020  , "HEAD"):.     
-00003110: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00003120: 6e20 7365 6c66 2e68 616e 646c 655f 6765  n self.handle_ge
-00003130: 7428 2920 616e 6420 7365 6c66 2e6b 6565  t() and self.kee
-00003140: 7061 6c69 7665 0a20 2020 2020 2020 2020  palive.         
-00003150: 2020 2069 6620 7365 6c66 2e6d 6f64 6520     if self.mode 
-00003160: 3d3d 2022 4f50 5449 4f4e 5322 3a0a 2020  == "OPTIONS":.  
-00003170: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00003180: 7475 726e 2073 656c 662e 6861 6e64 6c65  turn self.handle
-00003190: 5f6f 7074 696f 6e73 2829 2061 6e64 2073  _options() and s
-000031a0: 656c 662e 6b65 6570 616c 6976 650a 0a20  elf.keepalive.. 
-000031b0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-000031c0: 7420 636f 7273 5f6b 3a0a 2020 2020 2020  t cors_k:.      
-000031d0: 2020 2020 2020 2020 2020 6f72 6967 696e            origin
-000031e0: 203d 2073 656c 662e 6865 6164 6572 732e   = self.headers.
-000031f0: 6765 7428 226f 7269 6769 6e22 2c20 223c  get("origin", "<
-00003200: 3f3e 2229 0a20 2020 2020 2020 2020 2020  ?>").           
-00003210: 2020 2020 2073 656c 662e 6c6f 6728 2263       self.log("c
-00003220: 6f72 732d 7265 6a65 6374 207b 7d20 6672  ors-reject {} fr
-00003230: 6f6d 207b 7d22 2e66 6f72 6d61 7428 7365  om {}".format(se
-00003240: 6c66 2e6d 6f64 652c 206f 7269 6769 6e29  lf.mode, origin)
-00003250: 2c20 3329 0a20 2020 2020 2020 2020 2020  , 3).           
-00003260: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-00003270: 6328 3430 332c 2022 6e6f 2073 7572 6669  c(403, "no surfi
-00003280: 6e67 2229 0a0a 2020 2020 2020 2020 2020  ng")..          
-00003290: 2020 2320 6765 7461 7474 7228 7365 6c66    # getattr(self
-000032a0: 2e6d 6f64 6529 2069 7320 6e6f 7420 7965  .mode) is not ye
-000032b0: 7420 6661 7374 6572 2074 6861 6e20 7468  t faster than th
-000032c0: 6973 0a20 2020 2020 2020 2020 2020 2069  is.            i
-000032d0: 6620 7365 6c66 2e6d 6f64 6520 3d3d 2022  f self.mode == "
-000032e0: 504f 5354 223a 0a20 2020 2020 2020 2020  POST":.         
-000032f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00003300: 6c66 2e68 616e 646c 655f 706f 7374 2829  lf.handle_post()
-00003310: 2061 6e64 2073 656c 662e 6b65 6570 616c   and self.keepal
-00003320: 6976 650a 2020 2020 2020 2020 2020 2020  ive.            
-00003330: 656c 6966 2073 656c 662e 6d6f 6465 203d  elif self.mode =
-00003340: 3d20 2250 5554 223a 0a20 2020 2020 2020  = "PUT":.       
-00003350: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00003360: 7365 6c66 2e68 616e 646c 655f 7075 7428  self.handle_put(
-00003370: 2920 616e 6420 7365 6c66 2e6b 6565 7061  ) and self.keepa
-00003380: 6c69 7665 0a20 2020 2020 2020 2020 2020  live.           
-00003390: 2065 6c69 6620 7365 6c66 2e6d 6f64 6520   elif self.mode 
-000033a0: 3d3d 2022 5052 4f50 4649 4e44 223a 0a20  == "PROPFIND":. 
-000033b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000033c0: 6574 7572 6e20 7365 6c66 2e68 616e 646c  eturn self.handl
-000033d0: 655f 7072 6f70 6669 6e64 2829 2061 6e64  e_propfind() and
-000033e0: 2073 656c 662e 6b65 6570 616c 6976 650a   self.keepalive.
-000033f0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00003400: 2073 656c 662e 6d6f 6465 203d 3d20 2244   self.mode == "D
-00003410: 454c 4554 4522 3a0a 2020 2020 2020 2020  ELETE":.        
-00003420: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00003430: 656c 662e 6861 6e64 6c65 5f64 656c 6574  elf.handle_delet
-00003440: 6528 2920 616e 6420 7365 6c66 2e6b 6565  e() and self.kee
-00003450: 7061 6c69 7665 0a20 2020 2020 2020 2020  palive.         
-00003460: 2020 2065 6c69 6620 7365 6c66 2e6d 6f64     elif self.mod
-00003470: 6520 3d3d 2022 5052 4f50 5041 5443 4822  e == "PROPPATCH"
-00003480: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00003490: 2020 7265 7475 726e 2073 656c 662e 6861    return self.ha
-000034a0: 6e64 6c65 5f70 726f 7070 6174 6368 2829  ndle_proppatch()
-000034b0: 2061 6e64 2073 656c 662e 6b65 6570 616c   and self.keepal
-000034c0: 6976 650a 2020 2020 2020 2020 2020 2020  ive.            
-000034d0: 656c 6966 2073 656c 662e 6d6f 6465 203d  elif self.mode =
-000034e0: 3d20 224c 4f43 4b22 3a0a 2020 2020 2020  = "LOCK":.      
-000034f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003500: 2073 656c 662e 6861 6e64 6c65 5f6c 6f63   self.handle_loc
-00003510: 6b28 2920 616e 6420 7365 6c66 2e6b 6565  k() and self.kee
-00003520: 7061 6c69 7665 0a20 2020 2020 2020 2020  palive.         
-00003530: 2020 2065 6c69 6620 7365 6c66 2e6d 6f64     elif self.mod
-00003540: 6520 3d3d 2022 554e 4c4f 434b 223a 0a20  e == "UNLOCK":. 
-00003550: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00003560: 6574 7572 6e20 7365 6c66 2e68 616e 646c  eturn self.handl
-00003570: 655f 756e 6c6f 636b 2829 2061 6e64 2073  e_unlock() and s
-00003580: 656c 662e 6b65 6570 616c 6976 650a 2020  elf.keepalive.  
-00003590: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-000035a0: 656c 662e 6d6f 6465 203d 3d20 224d 4b43  elf.mode == "MKC
-000035b0: 4f4c 223a 0a20 2020 2020 2020 2020 2020  OL":.           
-000035c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000035d0: 2e68 616e 646c 655f 6d6b 636f 6c28 2920  .handle_mkcol() 
-000035e0: 616e 6420 7365 6c66 2e6b 6565 7061 6c69  and self.keepali
-000035f0: 7665 0a20 2020 2020 2020 2020 2020 2065  ve.            e
-00003600: 6c69 6620 7365 6c66 2e6d 6f64 6520 3d3d  lif self.mode ==
-00003610: 2022 4d4f 5645 223a 0a20 2020 2020 2020   "MOVE":.       
-00003620: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00003630: 7365 6c66 2e68 616e 646c 655f 6d6f 7665  self.handle_move
-00003640: 2829 2061 6e64 2073 656c 662e 6b65 6570  () and self.keep
-00003650: 616c 6976 650a 2020 2020 2020 2020 2020  alive.          
-00003660: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00003670: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-00003680: 626b 6163 2834 3030 2c20 2769 6e76 616c  bkac(400, 'inval
-00003690: 6964 2048 5454 5020 6d6f 6465 2022 7b30  id HTTP mode "{0
-000036a0: 7d22 272e 666f 726d 6174 2873 656c 662e  }"'.format(self.
-000036b0: 6d6f 6465 2929 0a0a 2020 2020 2020 2020  mode))..        
-000036c0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-000036d0: 2061 7320 6578 3a0a 2020 2020 2020 2020   as ex:.        
-000036e0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-000036f0: 7461 6e63 6528 6578 2c20 5065 626b 6163  tance(ex, Pebkac
-00003700: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00003710: 2020 2070 6578 203d 2050 6562 6b61 6328     pex = Pebkac(
-00003720: 3530 3029 0a20 2020 2020 2020 2020 2020  500).           
-00003730: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00003740: 2020 2020 2020 2070 6578 2020 3d20 6578         pex  = ex
-00003750: 2020 2320 7479 7065 3a20 6967 6e6f 7265    # type: ignore
-00003760: 0a0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00003770: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00003780: 2020 2070 6f73 7420 3d20 7365 6c66 2e6d     post = self.m
-00003790: 6f64 6520 696e 205b 2250 4f53 5422 2c20  ode in ["POST", 
-000037a0: 2250 5554 225d 206f 7220 2263 6f6e 7465  "PUT"] or "conte
-000037b0: 6e74 2d6c 656e 6774 6822 2069 6e20 7365  nt-length" in se
-000037c0: 6c66 2e68 6561 6465 7273 0a20 2020 2020  lf.headers.     
-000037d0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-000037e0: 7420 7365 6c66 2e5f 6368 6563 6b5f 6e6f  t self._check_no
-000037f0: 6e66 6174 616c 2870 6578 2c20 706f 7374  nfatal(pex, post
-00003800: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00003810: 2020 2020 2020 2073 656c 662e 6b65 6570         self.keep
-00003820: 616c 6976 6520 3d20 4661 6c73 650a 0a20  alive = False.. 
-00003830: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00003840: 6d20 3d20 7374 7228 6578 290a 2020 2020  m = str(ex).    
-00003850: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00003860: 3d20 656d 2069 6620 7065 7820 3d3d 2065  = em if pex == e
-00003870: 7820 656c 7365 206d 696e 5f65 7828 290a  x else min_ex().
-00003880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003890: 6966 2070 6578 2e63 6f64 6520 213d 2034  if pex.code != 4
-000038a0: 3034 206f 7220 7365 6c66 2e64 6f5f 6c6f  04 or self.do_lo
-000038b0: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-000038c0: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-000038d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000038e0: 2020 2020 2020 2020 2022 7b7d 5c30 3333           "{}\033
-000038f0: 5b30 6d2c 207b 7d22 2e66 6f72 6d61 7428  [0m, {}".format(
-00003900: 6d73 672c 2073 656c 662e 7670 6174 6829  msg, self.vpath)
-00003910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003920: 2020 2020 2020 2020 2020 3620 6966 2065            6 if e
-00003930: 6d2e 7374 6172 7473 7769 7468 2822 636c  m.startswith("cl
-00003940: 6965 6e74 2064 2f63 2022 2920 656c 7365  ient d/c ") else
-00003950: 2033 2c0a 2020 2020 2020 2020 2020 2020   3,.            
-00003960: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00003970: 2020 2020 2020 2020 2020 206d 7367 203d             msg =
-00003980: 2022 7b7d 5c72 5c6e 5552 4c3a 207b 7d5c   "{}\r\nURL: {}\
-00003990: 725c 6e22 2e66 6f72 6d61 7428 656d 2c20  r\n".format(em, 
-000039a0: 7365 6c66 2e76 7061 7468 290a 2020 2020  self.vpath).    
-000039b0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-000039c0: 656c 662e 6869 6e74 3a0a 2020 2020 2020  elf.hint:.      
-000039d0: 2020 2020 2020 2020 2020 2020 2020 6d73                ms
-000039e0: 6720 2b3d 2022 6869 6e74 3a20 7b7d 5c72  g += "hint: {}\r
-000039f0: 5c6e 222e 666f 726d 6174 2873 656c 662e  \n".format(self.
-00003a00: 6869 6e74 290a 0a20 2020 2020 2020 2020  hint)..         
-00003a10: 2020 2020 2020 2069 6620 2264 6174 6162         if "datab
-00003a20: 6173 6520 6973 206c 6f63 6b65 6422 2069  ase is locked" i
-00003a30: 6e20 656d 3a0a 2020 2020 2020 2020 2020  n em:.          
-00003a40: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-00003a50: 6f6e 6e2e 6873 7276 2e62 726f 6b65 722e  onn.hsrv.broker.
-00003a60: 7361 7928 226c 6f67 5f73 7461 636b 7322  say("log_stacks"
-00003a70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00003a80: 2020 2020 2020 6d73 6720 2b3d 2022 6869        msg += "hi
-00003a90: 6e74 3a20 696d 706f 7274 616e 7420 696e  nt: important in
-00003aa0: 666f 2069 6e20 7468 6520 7365 7276 6572  fo in the server
-00003ab0: 206c 6f67 5c72 5c6e 220a 0a20 2020 2020   log\r\n"..     
-00003ac0: 2020 2020 2020 2020 2020 207a 6220 3d20             zb = 
-00003ad0: 6222 3c70 7265 3e22 202b 2068 746d 6c5f  b"<pre>" + html_
-00003ae0: 6573 6361 7065 286d 7367 292e 656e 636f  escape(msg).enco
-00003af0: 6465 2822 7574 662d 3822 2c20 2272 6570  de("utf-8", "rep
-00003b00: 6c61 6365 2229 0a20 2020 2020 2020 2020  lace").         
-00003b10: 2020 2020 2020 2068 203d 207b 2257 5757         h = {"WWW
-00003b20: 2d41 7574 6865 6e74 6963 6174 6522 3a20  -Authenticate": 
-00003b30: 2742 6173 6963 2072 6561 6c6d 3d22 6122  'Basic realm="a"
-00003b40: 277d 2069 6620 7065 782e 636f 6465 203d  '} if pex.code =
-00003b50: 3d20 3430 3120 656c 7365 207b 7d0a 2020  = 401 else {}.  
-00003b60: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00003b70: 6c66 2e72 6570 6c79 287a 622c 2073 7461  lf.reply(zb, sta
-00003b80: 7475 733d 7065 782e 636f 6465 2c20 6865  tus=pex.code, he
-00003b90: 6164 6572 733d 682c 2076 6f6c 7361 6e3d  aders=h, volsan=
-00003ba0: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
-00003bb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003bc0: 662e 6b65 6570 616c 6976 650a 2020 2020  f.keepalive.    
-00003bd0: 2020 2020 2020 2020 6578 6365 7074 2050          except P
-00003be0: 6562 6b61 633a 0a20 2020 2020 2020 2020  ebkac:.         
-00003bf0: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
-00003c00: 6c73 650a 0a20 2020 2064 6566 2064 6970  lse..    def dip
-00003c10: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
-00003c20: 2020 6966 2073 656c 662e 6172 6773 2e70    if self.args.p
-00003c30: 6c61 696e 5f69 703a 0a20 2020 2020 2020  lain_ip:.       
-00003c40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00003c50: 2e69 702e 7265 706c 6163 6528 223a 222c  .ip.replace(":",
-00003c60: 2022 2e22 290a 2020 2020 2020 2020 656c   ".").        el
-00003c70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00003c80: 7265 7475 726e 2073 656c 662e 636f 6e6e  return self.conn
-00003c90: 2e69 7068 6173 682e 7328 7365 6c66 2e69  .iphash.s(self.i
-00003ca0: 7029 0a0a 2020 2020 6465 6620 6973 5f62  p)..    def is_b
-00003cb0: 616e 6e65 6428 7365 6c66 2920 203a 0a20  anned(self)  :. 
-00003cc0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00003cd0: 6c66 2e63 6f6e 6e2e 6261 6e73 3a0a 2020  lf.conn.bans:.  
-00003ce0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003cf0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00003d00: 6261 6e73 203d 2073 656c 662e 636f 6e6e  bans = self.conn
-00003d10: 2e62 616e 730a 2020 2020 2020 2020 6970  .bans.        ip
-00003d20: 203d 2069 706e 6f72 6d28 7365 6c66 2e69   = ipnorm(self.i
-00003d30: 7029 0a20 2020 2020 2020 2069 6620 6970  p).        if ip
-00003d40: 206e 6f74 2069 6e20 6261 6e73 3a0a 2020   not in bans:.  
-00003d50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003d60: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00003d70: 7274 203d 2062 616e 735b 6970 5d20 2d20  rt = bans[ip] - 
-00003d80: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
-00003d90: 2020 2020 6966 2072 7420 3c20 303a 0a20      if rt < 0:. 
-00003da0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00003db0: 6c6f 6728 2263 6c69 656e 7420 756e 6261  log("client unba
-00003dc0: 6e6e 6564 222c 2033 290a 2020 2020 2020  nned", 3).      
-00003dd0: 2020 2020 2020 6465 6c20 6261 6e73 5b69        del bans[i
-00003de0: 705d 0a20 2020 2020 2020 2020 2020 2072  p].            r
-00003df0: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
-00003e00: 2020 2020 2073 656c 662e 6c6f 6728 2262       self.log("b
-00003e10: 616e 6e65 6420 666f 7220 7b3a 2e30 667d  anned for {:.0f}
-00003e20: 2073 6563 222e 666f 726d 6174 2872 7429   sec".format(rt)
-00003e30: 2c20 3629 0a20 2020 2020 2020 207a 6220  , 6).        zb 
-00003e40: 3d20 6222 4854 5450 2f31 2e30 2034 3033  = b"HTTP/1.0 403
-00003e50: 2046 6f72 6269 6464 656e 5c72 5c6e 5c72   Forbidden\r\n\r
-00003e60: 5c6e 7468 616e 6b20 796f 7520 666f 7220  \nthank you for 
-00003e70: 706c 6179 696e 6722 0a20 2020 2020 2020  playing".       
-00003e80: 2073 656c 662e 732e 7365 6e64 616c 6c28   self.s.sendall(
-00003e90: 7a62 290a 2020 2020 2020 2020 7265 7475  zb).        retu
-00003ea0: 726e 2054 7275 650a 0a20 2020 2064 6566  rn True..    def
-00003eb0: 2070 6572 6d69 745f 6361 6368 696e 6728   permit_caching(
-00003ec0: 7365 6c66 2920 203a 0a20 2020 2020 2020  self)  :.       
-00003ed0: 2063 6163 6865 203d 2073 656c 662e 7570   cache = self.up
-00003ee0: 6172 616d 2e67 6574 2822 6361 6368 6522  aram.get("cache"
-00003ef0: 290a 2020 2020 2020 2020 6966 2063 6163  ).        if cac
-00003f00: 6865 2069 7320 4e6f 6e65 3a0a 2020 2020  he is None:.    
-00003f10: 2020 2020 2020 2020 7365 6c66 2e6f 7574          self.out
-00003f20: 5f68 6561 6465 7273 2e75 7064 6174 6528  _headers.update(
-00003f30: 4e4f 5f43 4143 4845 290a 2020 2020 2020  NO_CACHE).      
-00003f40: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-00003f50: 2020 2020 2020 6e20 3d20 2236 3034 3836        n = "60486
-00003f60: 3922 2069 6620 6361 6368 6520 3d3d 2022  9" if cache == "
-00003f70: 6922 2065 6c73 6520 6361 6368 6520 6f72  i" else cache or
-00003f80: 2022 3639 220a 2020 2020 2020 2020 7365   "69".        se
-00003f90: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
-00003fa0: 4361 6368 652d 436f 6e74 726f 6c22 5d20  Cache-Control"] 
-00003fb0: 3d20 226d 6178 2d61 6765 3d22 202b 206e  = "max-age=" + n
-00003fc0: 0a0a 2020 2020 6465 6620 6b33 3034 2873  ..    def k304(s
-00003fd0: 656c 6629 2020 3a0a 2020 2020 2020 2020  elf)  :.        
-00003fe0: 6b33 3034 203d 2073 656c 662e 636f 6f6b  k304 = self.cook
-00003ff0: 6965 732e 6765 7428 226b 3330 3422 290a  ies.get("k304").
-00004000: 2020 2020 2020 2020 7265 7475 726e 206b          return k
-00004010: 3330 3420 3d3d 2022 7922 206f 7220 2822  304 == "y" or ("
-00004020: 3b20 5472 6964 656e 742f 2220 696e 2073  ; Trident/" in s
-00004030: 656c 662e 7561 2061 6e64 206e 6f74 206b  elf.ua and not k
-00004040: 3330 3429 0a0a 2020 2020 6465 6620 7365  304)..    def se
-00004050: 6e64 5f68 6561 6465 7273 280a 2020 2020  nd_headers(.    
-00004060: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00004070: 2020 6c65 6e67 7468 202c 0a20 2020 2020    length ,.     
-00004080: 2020 2073 7461 7475 7320 203d 2032 3030     status  = 200
-00004090: 2c0a 2020 2020 2020 2020 6d69 6d65 2020  ,.        mime  
-000040a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000040b0: 6865 6164 6572 7320 2020 3d20 4e6f 6e65  headers   = None
-000040c0: 2c0a 2020 2020 2920 203a 0a20 2020 2020  ,.    )  :.     
-000040d0: 2020 2072 6573 706f 6e73 6520 3d20 5b22     response = ["
-000040e0: 7b7d 207b 7d20 7b7d 222e 666f 726d 6174  {} {} {}".format
-000040f0: 2873 656c 662e 6874 7470 5f76 6572 2c20  (self.http_ver, 
-00004100: 7374 6174 7573 2c20 4854 5450 434f 4445  status, HTTPCODE
-00004110: 5b73 7461 7475 735d 295d 0a0a 2020 2020  [status])]..    
-00004120: 2020 2020 6966 206c 656e 6774 6820 6973      if length is
-00004130: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00004140: 2020 2020 2020 2072 6573 706f 6e73 652e         response.
-00004150: 6170 7065 6e64 2822 436f 6e74 656e 742d  append("Content-
-00004160: 4c65 6e67 7468 3a20 2220 2b20 756e 6963  Length: " + unic
-00004170: 6f64 6528 6c65 6e67 7468 2929 0a0a 2020  ode(length))..  
-00004180: 2020 2020 2020 6966 2073 7461 7475 7320        if status 
-00004190: 3d3d 2033 3034 2061 6e64 2073 656c 662e  == 304 and self.
-000041a0: 6b33 3034 2829 3a0a 2020 2020 2020 2020  k304():.        
-000041b0: 2020 2020 7365 6c66 2e6b 6565 7061 6c69      self.keepali
-000041c0: 7665 203d 2046 616c 7365 0a0a 2020 2020  ve = False..    
-000041d0: 2020 2020 2320 636c 6f73 6520 6966 2075      # close if u
-000041e0: 6e6b 6e6f 776e 206c 656e 6774 682c 206f  nknown length, o
-000041f0: 7468 6572 7769 7365 2074 616b 6520 636c  therwise take cl
-00004200: 6965 6e74 2773 2070 7265 6665 7265 6e63  ient's preferenc
-00004210: 650a 2020 2020 2020 2020 7265 7370 6f6e  e.        respon
-00004220: 7365 2e61 7070 656e 6428 2243 6f6e 6e65  se.append("Conne
-00004230: 6374 696f 6e3a 2022 202b 2028 224b 6565  ction: " + ("Kee
-00004240: 702d 416c 6976 6522 2069 6620 7365 6c66  p-Alive" if self
-00004250: 2e6b 6565 7061 6c69 7665 2065 6c73 6520  .keepalive else 
-00004260: 2243 6c6f 7365 2229 290a 2020 2020 2020  "Close")).      
-00004270: 2020 7265 7370 6f6e 7365 2e61 7070 656e    response.appen
-00004280: 6428 2244 6174 653a 2022 202b 2066 6f72  d("Date: " + for
-00004290: 6d61 7464 6174 6528 7573 6567 6d74 3d54  matdate(usegmt=T
-000042a0: 7275 6529 290a 0a20 2020 2020 2020 2023  rue))..        #
-000042b0: 2068 6561 6465 7273 7b7d 206f 7665 7272   headers{} overr
-000042c0: 6964 6573 2061 6e79 7468 696e 6720 7365  ides anything se
-000042d0: 7420 7072 6576 696f 7573 6c79 0a20 2020  t previously.   
-000042e0: 2020 2020 2069 6620 6865 6164 6572 733a       if headers:
-000042f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00004300: 662e 6f75 745f 6865 6164 6572 732e 7570  f.out_headers.up
-00004310: 6461 7465 2868 6561 6465 7273 290a 0a20  date(headers).. 
-00004320: 2020 2020 2020 2023 2064 6566 6175 6c74         # default
-00004330: 2074 6f20 7574 6638 2068 746d 6c20 6966   to utf8 html if
-00004340: 206e 6f20 636f 6e74 656e 742d 7479 7065   no content-type
-00004350: 2069 7320 7365 740a 2020 2020 2020 2020   is set.        
-00004360: 6966 206e 6f74 206d 696d 653a 0a20 2020  if not mime:.   
-00004370: 2020 2020 2020 2020 206d 696d 6520 3d20           mime = 
-00004380: 7365 6c66 2e6f 7574 5f68 6561 6465 7273  self.out_headers
-00004390: 2e67 6574 2822 436f 6e74 656e 742d 5479  .get("Content-Ty
-000043a0: 7065 222c 2022 7465 7874 2f68 746d 6c3b  pe", "text/html;
-000043b0: 2063 6861 7273 6574 3d75 7466 2d38 2229   charset=utf-8")
-000043c0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
-000043d0: 206d 696d 650a 2020 2020 2020 2020 7365   mime.        se
-000043e0: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
-000043f0: 436f 6e74 656e 742d 5479 7065 225d 203d  Content-Type"] =
-00004400: 206d 696d 650a 0a20 2020 2020 2020 2066   mime..        f
-00004410: 6f72 206b 2c20 7a73 2069 6e20 6c69 7374  or k, zs in list
-00004420: 2873 656c 662e 6f75 745f 6865 6164 6572  (self.out_header
-00004430: 732e 6974 656d 7328 2929 202b 2073 656c  s.items()) + sel
-00004440: 662e 6f75 745f 6865 6164 6572 6c69 7374  f.out_headerlist
-00004450: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00004460: 7370 6f6e 7365 2e61 7070 656e 6428 227b  sponse.append("{
-00004470: 7d3a 207b 7d22 2e66 6f72 6d61 7428 6b2c  }: {}".format(k,
-00004480: 207a 7329 290a 0a20 2020 2020 2020 2074   zs))..        t
-00004490: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-000044a0: 2320 6265 7374 2070 7261 6374 6963 6520  # best practice 
-000044b0: 746f 2073 6570 6172 6174 6520 6865 6164  to separate head
-000044c0: 6572 7320 616e 6420 626f 6479 2069 6e74  ers and body int
-000044d0: 6f20 6469 6666 6572 656e 7420 7061 636b  o different pack
-000044e0: 6574 730a 2020 2020 2020 2020 2020 2020  ets.            
-000044f0: 7365 6c66 2e73 2e73 6574 7469 6d65 6f75  self.s.settimeou
-00004500: 7428 4e6f 6e65 290a 2020 2020 2020 2020  t(None).        
-00004510: 2020 2020 7365 6c66 2e73 2e73 656e 6461      self.s.senda
-00004520: 6c6c 2822 5c72 5c6e 222e 6a6f 696e 2872  ll("\r\n".join(r
-00004530: 6573 706f 6e73 6529 2e65 6e63 6f64 6528  esponse).encode(
-00004540: 2275 7466 2d38 2229 202b 2062 225c 725c  "utf-8") + b"\r\
-00004550: 6e5c 725c 6e22 290a 2020 2020 2020 2020  n\r\n").        
-00004560: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-00004570: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
-00004580: 2834 3030 2c20 2263 6c69 656e 7420 642f  (400, "client d/
-00004590: 6320 7768 696c 6520 7265 706c 7969 6e67  c while replying
-000045a0: 2068 6561 6465 7273 2229 0a0a 2020 2020   headers")..    
-000045b0: 6465 6620 7265 706c 7928 0a20 2020 2020  def reply(.     
-000045c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000045d0: 2062 6f64 7920 2c0a 2020 2020 2020 2020   body ,.        
-000045e0: 7374 6174 7573 2020 3d20 3230 302c 0a20  status  = 200,. 
-000045f0: 2020 2020 2020 206d 696d 6520 203d 204e         mime  = N
-00004600: 6f6e 652c 0a20 2020 2020 2020 2068 6561  one,.        hea
-00004610: 6465 7273 2020 203d 204e 6f6e 652c 0a20  ders   = None,. 
-00004620: 2020 2020 2020 2076 6f6c 7361 6e20 203d         volsan  =
-00004630: 2046 616c 7365 2c0a 2020 2020 2920 203a   False,.    )  :
-00004640: 0a20 2020 2020 2020 2069 6620 7374 6174  .        if stat
-00004650: 7573 203d 3d20 3430 343a 0a20 2020 2020  us == 404:.     
-00004660: 2020 2020 2020 2067 203d 2073 656c 662e         g = self.
-00004670: 636f 6e6e 2e68 7372 762e 6734 3034 0a20  conn.hsrv.g404. 
-00004680: 2020 2020 2020 2020 2020 2069 6620 672e             if g.
-00004690: 6c69 6d3a 0a20 2020 2020 2020 2020 2020  lim:.           
-000046a0: 2020 2020 2062 6f6e 6b2c 2069 7020 3d20       bonk, ip = 
-000046b0: 672e 626f 6e6b 2873 656c 662e 6970 2c20  g.bonk(self.ip, 
-000046c0: 7365 6c66 2e76 7061 7468 290a 2020 2020  self.vpath).    
-000046d0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-000046e0: 6f6e 6b3a 0a20 2020 2020 2020 2020 2020  onk:.           
-000046f0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00004700: 6728 2263 6c69 656e 7420 6261 6e6e 6564  g("client banned
-00004710: 3a20 3430 3473 222c 2031 290a 2020 2020  : 404s", 1).    
-00004720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004730: 7365 6c66 2e63 6f6e 6e2e 6873 7276 2e62  self.conn.hsrv.b
-00004740: 616e 735b 6970 5d20 3d20 626f 6e6b 0a0a  ans[ip] = bonk..
-00004750: 2020 2020 2020 2020 6966 2076 6f6c 7361          if volsa
-00004760: 6e3a 0a20 2020 2020 2020 2020 2020 2076  n:.            v
-00004770: 6f6c 7320 3d20 6c69 7374 2873 656c 662e  ols = list(self.
-00004780: 6173 7276 2e76 6673 2e61 6c6c 5f76 6f6c  asrv.vfs.all_vol
-00004790: 732e 7661 6c75 6573 2829 290a 2020 2020  s.values()).    
-000047a0: 2020 2020 2020 2020 626f 6479 203d 2076          body = v
-000047b0: 6f6c 5f73 616e 2876 6f6c 732c 2062 6f64  ol_san(vols, bod
-000047c0: 7929 0a0a 2020 2020 2020 2020 7365 6c66  y)..        self
-000047d0: 2e73 656e 645f 6865 6164 6572 7328 6c65  .send_headers(le
-000047e0: 6e28 626f 6479 292c 2073 7461 7475 732c  n(body), status,
-000047f0: 206d 696d 652c 2068 6561 6465 7273 290a   mime, headers).
-00004800: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00004810: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00004820: 662e 6d6f 6465 2021 3d20 2248 4541 4422  f.mode != "HEAD"
-00004830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004840: 2020 7365 6c66 2e73 2e73 656e 6461 6c6c    self.s.sendall
-00004850: 2862 6f64 7929 0a20 2020 2020 2020 2065  (body).        e
-00004860: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-00004870: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
-00004880: 3430 302c 2022 636c 6965 6e74 2064 2f63  400, "client d/c
-00004890: 2077 6869 6c65 2072 6570 6c79 696e 6720   while replying 
-000048a0: 626f 6479 2229 0a0a 2020 2020 2020 2020  body")..        
-000048b0: 7265 7475 726e 2062 6f64 790a 0a20 2020  return body..   
-000048c0: 2064 6566 206c 6f75 645f 7265 706c 7928   def loud_reply(
-000048d0: 7365 6c66 2c20 626f 6479 202c 202a 6172  self, body , *ar
-000048e0: 6773 202c 202a 2a6b 7761 7267 7320 2920  gs , **kwargs ) 
-000048f0: 203a 0a20 2020 2020 2020 2069 6620 6e6f   :.        if no
-00004900: 7420 6b77 6172 6773 2e67 6574 2822 6d69  t kwargs.get("mi
-00004910: 6d65 2229 3a0a 2020 2020 2020 2020 2020  me"):.          
-00004920: 2020 6b77 6172 6773 5b22 6d69 6d65 225d    kwargs["mime"]
-00004930: 203d 2022 7465 7874 2f70 6c61 696e 3b20   = "text/plain; 
-00004940: 6368 6172 7365 743d 7574 662d 3822 0a0a  charset=utf-8"..
-00004950: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00004960: 2862 6f64 792e 7273 7472 6970 2829 290a  (body.rstrip()).
-00004970: 2020 2020 2020 2020 7365 6c66 2e72 6570          self.rep
-00004980: 6c79 2862 6f64 792e 656e 636f 6465 2822  ly(body.encode("
-00004990: 7574 662d 3822 2920 2b20 6222 5c72 5c6e  utf-8") + b"\r\n
-000049a0: 222c 202a 6c69 7374 2861 7267 7329 2c20  ", *list(args), 
-000049b0: 2a2a 6b77 6172 6773 290a 0a20 2020 2064  **kwargs)..    d
-000049c0: 6566 2075 726c 7128 7365 6c66 2c20 6164  ef urlq(self, ad
-000049d0: 6420 202c 2072 6d20 2920 203a 0a20 2020  d  , rm )  :.   
-000049e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000049f0: 2067 656e 6572 6174 6573 2075 726c 2071   generates url q
-00004a00: 7565 7279 2062 6173 6564 206f 6e20 7570  uery based on up
-00004a10: 6172 616d 2028 622c 2070 772c 2061 6c6c  aram (b, pw, all
-00004a20: 206f 7468 6572 7329 0a20 2020 2020 2020   others).       
-00004a30: 2072 656d 6f76 696e 6720 616e 7974 6869   removing anythi
-00004a40: 6e67 2069 6e20 726d 2c20 6164 6469 6e67  ng in rm, adding
-00004a50: 2070 6169 7273 2069 6e20 6164 640a 0a20   pairs in add.. 
-00004a60: 2020 2020 2020 2061 6c73 6f20 6c69 7374         also list
-00004a70: 2066 6173 7465 7220 7468 616e 2073 6574   faster than set
-00004a80: 2075 6e74 696c 207e 3230 2069 7465 6d73   until ~20 items
-00004a90: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
-00004aa0: 2020 2020 2020 6966 2073 656c 662e 6973        if self.is
-00004ab0: 5f72 636c 6f6e 653a 0a20 2020 2020 2020  _rclone:.       
-00004ac0: 2020 2020 2072 6574 7572 6e20 2222 0a0a       return ""..
-00004ad0: 2020 2020 2020 2020 6b76 203d 207b 6b3a          kv = {k:
-00004ae0: 207a 7320 666f 7220 6b2c 207a 7320 696e   zs for k, zs in
-00004af0: 2073 656c 662e 7570 6172 616d 2e69 7465   self.uparam.ite
-00004b00: 6d73 2829 2069 6620 6b20 6e6f 7420 696e  ms() if k not in
-00004b10: 2072 6d7d 0a20 2020 2020 2020 2069 6620   rm}.        if 
-00004b20: 2270 7722 2069 6e20 6b76 3a0a 2020 2020  "pw" in kv:.    
-00004b30: 2020 2020 2020 2020 7077 203d 2073 656c          pw = sel
-00004b40: 662e 636f 6f6b 6965 732e 6765 7428 2263  f.cookies.get("c
-00004b50: 7070 7773 2229 206f 7220 7365 6c66 2e63  ppws") or self.c
-00004b60: 6f6f 6b69 6573 2e67 6574 2822 6370 7077  ookies.get("cppw
-00004b70: 6422 290a 2020 2020 2020 2020 2020 2020  d").            
-00004b80: 6966 206b 765b 2270 7722 5d20 3d3d 2070  if kv["pw"] == p
-00004b90: 773a 0a20 2020 2020 2020 2020 2020 2020  w:.             
-00004ba0: 2020 2064 656c 206b 765b 2270 7722 5d0a     del kv["pw"].
-00004bb0: 0a20 2020 2020 2020 206b 762e 7570 6461  .        kv.upda
-00004bc0: 7465 2861 6464 290a 2020 2020 2020 2020  te(add).        
-00004bd0: 6966 206e 6f74 206b 763a 0a20 2020 2020  if not kv:.     
-00004be0: 2020 2020 2020 2072 6574 7572 6e20 2222         return ""
-00004bf0: 0a0a 2020 2020 2020 2020 7220 3d20 5b22  ..        r = ["
-00004c00: 7b7d 3d7b 7d22 2e66 6f72 6d61 7428 6b2c  {}={}".format(k,
-00004c10: 2071 756f 7465 7028 7a73 2929 2069 6620   quotep(zs)) if 
-00004c20: 7a73 2065 6c73 6520 6b20 666f 7220 6b2c  zs else k for k,
-00004c30: 207a 7320 696e 206b 762e 6974 656d 7328   zs in kv.items(
-00004c40: 295d 0a20 2020 2020 2020 2072 6574 7572  )].        retur
-00004c50: 6e20 223f 2220 2b20 2226 616d 703b 222e  n "?" + "&amp;".
-00004c60: 6a6f 696e 2872 290a 0a20 2020 2064 6566  join(r)..    def
-00004c70: 2072 6564 6972 6563 7428 0a20 2020 2020   redirect(.     
-00004c80: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00004c90: 2076 7061 7468 202c 0a20 2020 2020 2020   vpath ,.       
-00004ca0: 2073 7566 2020 3d20 2222 2c0a 2020 2020   suf  = "",.    
-00004cb0: 2020 2020 6d73 6720 203d 2022 6169 6768      msg  = "aigh
-00004cc0: 7422 2c0a 2020 2020 2020 2020 666c 6176  t",.        flav
-00004cd0: 6f72 2020 3d20 2267 6f20 746f 222c 0a20  or  = "go to",. 
-00004ce0: 2020 2020 2020 2063 6c69 636b 2020 3d20         click  = 
-00004cf0: 5472 7565 2c0a 2020 2020 2020 2020 7374  True,.        st
-00004d00: 6174 7573 2020 3d20 3230 302c 0a20 2020  atus  = 200,.   
-00004d10: 2020 2020 2075 7365 3330 3220 203d 2046       use302  = F
-00004d20: 616c 7365 2c0a 2020 2020 2920 203a 0a20  alse,.    )  :. 
-00004d30: 2020 2020 2020 2076 7020 3d20 7365 6c66         vp = self
-00004d40: 2e61 7267 732e 5253 202b 2076 7061 7468  .args.RS + vpath
-00004d50: 0a20 2020 2020 2020 2068 746d 6c20 3d20  .        html = 
-00004d60: 7365 6c66 2e6a 3273 280a 2020 2020 2020  self.j2s(.      
-00004d70: 2020 2020 2020 226d 7367 222c 0a20 2020        "msg",.   
-00004d80: 2020 2020 2020 2020 2068 323d 273c 6120           h2='<a 
-00004d90: 6872 6566 3d22 2f7b 7d22 3e7b 7d20 2f7b  href="/{}">{} /{
-00004da0: 7d3c 2f61 3e27 2e66 6f72 6d61 7428 0a20  }</a>'.format(. 
-00004db0: 2020 2020 2020 2020 2020 2020 2020 2071                 q
-00004dc0: 756f 7465 7028 7670 2920 2b20 7375 662c  uotep(vp) + suf,
-00004dd0: 2066 6c61 766f 722c 2068 746d 6c5f 6573   flavor, html_es
-00004de0: 6361 7065 2876 702c 2063 726c 663d 5472  cape(vp, crlf=Tr
-00004df0: 7565 2920 2b20 7375 660a 2020 2020 2020  ue) + suf.      
-00004e00: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00004e10: 2020 2020 2070 7265 3d6d 7367 2c0a 2020       pre=msg,.  
-00004e20: 2020 2020 2020 2020 2020 636c 6963 6b3d            click=
-00004e30: 636c 6963 6b2c 0a20 2020 2020 2020 2029  click,.        )
-00004e40: 2e65 6e63 6f64 6528 2275 7466 2d38 222c  .encode("utf-8",
-00004e50: 2022 7265 706c 6163 6522 290a 0a20 2020   "replace")..   
-00004e60: 2020 2020 2069 6620 7573 6533 3032 3a0a       if use302:.
-00004e70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00004e80: 2e72 6570 6c79 2868 746d 6c2c 2073 7461  .reply(html, sta
-00004e90: 7475 733d 3330 322c 2068 6561 6465 7273  tus=302, headers
-00004ea0: 3d7b 224c 6f63 6174 696f 6e22 3a20 222f  ={"Location": "/
-00004eb0: 2220 2b20 7670 6174 687d 290a 2020 2020  " + vpath}).    
-00004ec0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00004ed0: 2020 2020 2020 7365 6c66 2e72 6570 6c79        self.reply
-00004ee0: 2868 746d 6c2c 2073 7461 7475 733d 7374  (html, status=st
-00004ef0: 6174 7573 290a 0a20 2020 2020 2020 2072  atus)..        r
-00004f00: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00004f10: 6465 6620 5f63 6f72 7328 7365 6c66 2920  def _cors(self) 
-00004f20: 203a 0a20 2020 2020 2020 2069 6820 3d20   :.        ih = 
-00004f30: 7365 6c66 2e68 6561 6465 7273 0a20 2020  self.headers.   
-00004f40: 2020 2020 206f 7269 6769 6e20 3d20 6968       origin = ih
-00004f50: 2e67 6574 2822 6f72 6967 696e 2229 0a20  .get("origin"). 
-00004f60: 2020 2020 2020 2069 6620 6e6f 7420 6f72         if not or
-00004f70: 6967 696e 3a0a 2020 2020 2020 2020 2020  igin:.          
-00004f80: 2020 7366 7369 7465 203d 2069 682e 6765    sfsite = ih.ge
-00004f90: 7428 2273 6563 2d66 6574 6368 2d73 6974  t("sec-fetch-sit
-00004fa0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00004fb0: 6966 2073 6673 6974 6520 616e 6420 7366  if sfsite and sf
-00004fc0: 7369 7465 2e6c 6f77 6572 2829 2e73 7461  site.lower().sta
-00004fd0: 7274 7377 6974 6828 2263 726f 7373 2229  rtswith("cross")
-00004fe0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004ff0: 2020 6f72 6967 696e 203d 2022 3a7c 2220    origin = ":|" 
-00005000: 2023 2073 616e 6462 6f78 6564 2069 6672   # sandboxed ifr
-00005010: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-00005020: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00005030: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-00005040: 650a 0a20 2020 2020 2020 206f 6820 3d20  e..        oh = 
-00005050: 7365 6c66 2e6f 7574 5f68 6561 6465 7273  self.out_headers
-00005060: 0a20 2020 2020 2020 206f 7269 6769 6e20  .        origin 
-00005070: 3d20 6f72 6967 696e 2e6c 6f77 6572 2829  = origin.lower()
-00005080: 0a20 2020 2020 2020 2067 6f6f 645f 6f72  .        good_or
-00005090: 6967 696e 7320 3d20 7365 6c66 2e61 7267  igins = self.arg
-000050a0: 732e 6163 616f 202b 205b 0a20 2020 2020  s.acao + [.     
-000050b0: 2020 2020 2020 2022 7b7d 3a2f 2f7b 7d22         "{}://{}"
-000050c0: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
-000050d0: 2020 2020 2020 2020 2022 6874 7470 7322           "https"
-000050e0: 2069 6620 7365 6c66 2e69 735f 6874 7470   if self.is_http
-000050f0: 7320 656c 7365 2022 6874 7470 222c 0a20  s else "http",. 
-00005100: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00005110: 656c 662e 686f 7374 2e6c 6f77 6572 2829  elf.host.lower()
-00005120: 2e73 706c 6974 2822 3a22 295b 305d 2c0a  .split(":")[0],.
-00005130: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00005140: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00005150: 6966 2072 652e 7375 6228 7222 283a 5b30  if re.sub(r"(:[0
-00005160: 2d39 5d7b 312c 357d 293f 2f3f 2422 2c20  -9]{1,5})?/?$", 
-00005170: 2222 2c20 6f72 6967 696e 2920 696e 2067  "", origin) in g
-00005180: 6f6f 645f 6f72 6967 696e 733a 0a20 2020  ood_origins:.   
-00005190: 2020 2020 2020 2020 2067 6f6f 645f 6f72           good_or
-000051a0: 6967 696e 203d 2054 7275 650a 2020 2020  igin = True.    
-000051b0: 2020 2020 2020 2020 6261 645f 6864 7273          bad_hdrs
-000051c0: 203d 2028 2222 2c29 0a20 2020 2020 2020   = ("",).       
-000051d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000051e0: 2020 2067 6f6f 645f 6f72 6967 696e 203d     good_origin =
-000051f0: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00005200: 2020 2062 6164 5f68 6472 7320 3d20 2822     bad_hdrs = ("
-00005210: 222c 2022 7077 2229 0a0a 2020 2020 2020  ", "pw")..      
-00005220: 2020 2320 272a 2720 626c 6f63 6b73 2061    # '*' blocks a
-00005230: 6c6c 2063 7265 6465 6e74 6961 6c73 2028  ll credentials (
-00005240: 636f 6f6b 6965 732c 2068 7474 702d 6175  cookies, http-au
-00005250: 7468 293b 0a20 2020 2020 2020 2023 2065  th);.        # e
-00005260: 7861 6374 2d6d 6174 6368 2066 6f72 204f  xact-match for O
-00005270: 7269 6769 6e20 6973 206e 6563 6573 7361  rigin is necessa
-00005280: 7279 2074 6f20 756e 6c6f 636b 2074 686f  ry to unlock tho
-00005290: 7365 2c0a 2020 2020 2020 2020 2320 686f  se,.        # ho
-000052a0: 7765 7665 7220 796f 6c6f 2d72 6571 7565  wever yolo-reque
-000052b0: 7374 7320 283f 7077 3d29 2061 7265 2061  sts (?pw=) are a
-000052c0: 6c77 6179 7320 616c 6c6f 7765 640a 2020  lways allowed.  
-000052d0: 2020 2020 2020 6163 6168 203d 2069 682e        acah = ih.
-000052e0: 6765 7428 2261 6363 6573 732d 636f 6e74  get("access-cont
-000052f0: 726f 6c2d 7265 7175 6573 742d 6865 6164  rol-request-head
-00005300: 6572 7322 2c20 2222 290a 2020 2020 2020  ers", "").      
-00005310: 2020 6163 616f 203d 2028 6f72 6967 696e    acao = (origin
-00005320: 2069 6620 676f 6f64 5f6f 7269 6769 6e20   if good_origin 
-00005330: 656c 7365 204e 6f6e 6529 206f 7220 280a  else None) or (.
-00005340: 2020 2020 2020 2020 2020 2020 222a 2220              "*" 
-00005350: 6966 2022 2a22 2069 6e20 676f 6f64 5f6f  if "*" in good_o
-00005360: 7269 6769 6e73 2065 6c73 6520 4e6f 6e65  rigins else None
-00005370: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00005380: 2020 2069 6620 7365 6c66 2e61 7267 732e     if self.args.
-00005390: 616c 6c6f 775f 6373 7266 3a0a 2020 2020  allow_csrf:.    
-000053a0: 2020 2020 2020 2020 6163 616f 203d 206f          acao = o
-000053b0: 7269 6769 6e20 6f72 2061 6361 6f20 6f72  rigin or acao or
-000053c0: 2022 2a22 2020 2320 6578 706c 6963 6974   "*"  # explicit
-000053d0: 6c79 2070 6572 6d69 7420 696d 7065 7273  ly permit impers
-000053e0: 6f6e 6174 696f 6e0a 2020 2020 2020 2020  onation.        
-000053f0: 2020 2020 6163 616d 203d 2022 2c20 222e      acam = ", ".
-00005400: 6a6f 696e 2873 656c 662e 636f 6e6e 2e68  join(self.conn.h
-00005410: 7372 762e 6d61 6c6c 6f77 2920 2023 2061  srv.mallow)  # a
-00005420: 6e64 2061 6c6c 206d 6574 686f 6473 202b  nd all methods +
-00005430: 2068 6561 6465 7273 0a20 2020 2020 2020   headers.       
-00005440: 2020 2020 206f 685b 2241 6363 6573 732d       oh["Access-
-00005450: 436f 6e74 726f 6c2d 416c 6c6f 772d 4372  Control-Allow-Cr
-00005460: 6564 656e 7469 616c 7322 5d20 3d20 2274  edentials"] = "t
-00005470: 7275 6522 0a20 2020 2020 2020 2020 2020  rue".           
-00005480: 2067 6f6f 645f 6f72 6967 696e 203d 2054   good_origin = T
-00005490: 7275 650a 2020 2020 2020 2020 656c 7365  rue.        else
-000054a0: 3a0a 2020 2020 2020 2020 2020 2020 6163  :.            ac
-000054b0: 616d 203d 2022 2c20 222e 6a6f 696e 2873  am = ", ".join(s
-000054c0: 656c 662e 6172 6773 2e61 6361 6d29 0a20  elf.args.acam). 
-000054d0: 2020 2020 2020 2020 2020 2023 2077 6173             # was
-000054e0: 6820 636c 6965 6e74 2d72 6571 7565 7374  h client-request
-000054f0: 6564 2068 6561 6465 7273 2061 6e64 2072  ed headers and r
-00005500: 6f6c 6c20 7769 7468 2074 6861 740a 2020  oll with that.  
-00005510: 2020 2020 2020 2020 2020 6966 2022 7261            if "ra
-00005520: 6e67 6522 206e 6f74 2069 6e20 6163 6168  nge" not in acah
-00005530: 2e6c 6f77 6572 2829 3a0a 2020 2020 2020  .lower():.      
-00005540: 2020 2020 2020 2020 2020 6163 6168 202b            acah +
-00005550: 3d20 222c 5261 6e67 6522 2020 2320 6669  = ",Range"  # fi
-00005560: 7265 666f 780a 2020 2020 2020 2020 2020  refox.          
-00005570: 2020 7265 715f 6820 3d20 6163 6168 2e73    req_h = acah.s
-00005580: 706c 6974 2822 2c22 290a 2020 2020 2020  plit(",").      
-00005590: 2020 2020 2020 7265 715f 6820 3d20 5b78        req_h = [x
-000055a0: 2e73 7472 6970 2829 2066 6f72 2078 2069  .strip() for x i
-000055b0: 6e20 7265 715f 685d 0a20 2020 2020 2020  n req_h].       
-000055c0: 2020 2020 2072 6571 5f68 203d 205b 7820       req_h = [x 
-000055d0: 666f 7220 7820 696e 2072 6571 5f68 2069  for x in req_h i
-000055e0: 6620 782e 6c6f 7765 7228 2920 6e6f 7420  f x.lower() not 
-000055f0: 696e 2062 6164 5f68 6472 735d 0a20 2020  in bad_hdrs].   
-00005600: 2020 2020 2020 2020 2061 6361 6820 3d20           acah = 
-00005610: 222c 2022 2e6a 6f69 6e28 7265 715f 6829  ", ".join(req_h)
-00005620: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00005630: 2061 6361 6f3a 0a20 2020 2020 2020 2020   acao:.         
-00005640: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
-00005650: 0a20 2020 2020 2020 206f 685b 2241 6363  .        oh["Acc
-00005660: 6573 732d 436f 6e74 726f 6c2d 416c 6c6f  ess-Control-Allo
-00005670: 772d 4f72 6967 696e 225d 203d 2061 6361  w-Origin"] = aca
-00005680: 6f0a 2020 2020 2020 2020 6f68 5b22 4163  o.        oh["Ac
-00005690: 6365 7373 2d43 6f6e 7472 6f6c 2d41 6c6c  cess-Control-All
-000056a0: 6f77 2d4d 6574 686f 6473 225d 203d 2061  ow-Methods"] = a
-000056b0: 6361 6d2e 7570 7065 7228 290a 2020 2020  cam.upper().    
-000056c0: 2020 2020 6966 2061 6361 683a 0a20 2020      if acah:.   
-000056d0: 2020 2020 2020 2020 206f 685b 2241 6363           oh["Acc
-000056e0: 6573 732d 436f 6e74 726f 6c2d 416c 6c6f  ess-Control-Allo
-000056f0: 772d 4865 6164 6572 7322 5d20 3d20 6163  w-Headers"] = ac
-00005700: 6168 0a0a 2020 2020 2020 2020 7265 7475  ah..        retu
-00005710: 726e 2067 6f6f 645f 6f72 6967 696e 0a0a  rn good_origin..
-00005720: 2020 2020 6465 6620 6861 6e64 6c65 5f67      def handle_g
-00005730: 6574 2873 656c 6629 2020 3a0a 2020 2020  et(self)  :.    
-00005740: 2020 2020 6966 2073 656c 662e 646f 5f6c      if self.do_l
-00005750: 6f67 3a0a 2020 2020 2020 2020 2020 2020  og:.            
-00005760: 6c6f 676d 7367 203d 2022 7b3a 347d 207b  logmsg = "{:4} {
-00005770: 7d22 2e66 6f72 6d61 7428 7365 6c66 2e6d  }".format(self.m
-00005780: 6f64 652c 2073 656c 662e 7265 7129 0a0a  ode, self.req)..
-00005790: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-000057a0: 7261 6e67 6522 2069 6e20 7365 6c66 2e68  range" in self.h
-000057b0: 6561 6465 7273 3a0a 2020 2020 2020 2020  eaders:.        
-000057c0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-000057d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057e0: 2072 7661 6c20 3d20 7365 6c66 2e68 6561   rval = self.hea
-000057f0: 6465 7273 5b22 7261 6e67 6522 5d2e 7370  ders["range"].sp
-00005800: 6c69 7428 223d 222c 2031 295b 315d 0a20  lit("=", 1)[1]. 
-00005810: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00005820: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-00005830: 2020 2020 2020 2020 2020 2072 7661 6c20             rval 
-00005840: 3d20 7365 6c66 2e68 6561 6465 7273 5b22  = self.headers["
-00005850: 7261 6e67 6522 5d0a 0a20 2020 2020 2020  range"]..       
-00005860: 2020 2020 2020 2020 206c 6f67 6d73 6720           logmsg 
-00005870: 2b3d 2022 205b 5c30 3333 5b33 366d 2220  += " [\033[36m" 
-00005880: 2b20 7276 616c 202b 2022 5c30 3333 5b30  + rval + "\033[0
-00005890: 6d5d 220a 0a20 2020 2020 2020 2020 2020  m]"..           
-000058a0: 2073 656c 662e 6c6f 6728 6c6f 676d 7367   self.log(logmsg
-000058b0: 290a 0a20 2020 2020 2020 2023 2022 656d  )..        # "em
-000058c0: 6265 6464 6564 2220 7265 736f 7572 6365  bedded" resource
-000058d0: 730a 2020 2020 2020 2020 6966 2073 656c  s.        if sel
-000058e0: 662e 7670 6174 682e 7374 6172 7473 7769  f.vpath.startswi
-000058f0: 7468 2822 2e63 7072 2229 3a0a 2020 2020  th(".cpr"):.    
-00005900: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00005910: 7670 6174 682e 7374 6172 7473 7769 7468  vpath.startswith
-00005920: 2822 2e63 7072 2f69 636f 2f22 293a 0a20  (".cpr/ico/"):. 
-00005930: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005940: 6574 7572 6e20 7365 6c66 2e74 785f 6963  eturn self.tx_ic
-00005950: 6f28 7365 6c66 2e76 7061 7468 2e73 706c  o(self.vpath.spl
-00005960: 6974 2822 2f22 295b 2d31 5d2c 2065 7861  it("/")[-1], exa
-00005970: 6374 3d54 7275 6529 0a0a 2020 2020 2020  ct=True)..      
-00005980: 2020 2020 2020 6966 2073 656c 662e 7670        if self.vp
-00005990: 6174 682e 7374 6172 7473 7769 7468 2822  ath.startswith("
-000059a0: 2e63 7072 2f73 7364 7022 293a 0a20 2020  .cpr/ssdp"):.   
-000059b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000059c0: 7572 6e20 7365 6c66 2e63 6f6e 6e2e 6873  urn self.conn.hs
-000059d0: 7276 2e73 7364 702e 7265 706c 7928 7365  rv.ssdp.reply(se
-000059e0: 6c66 290a 0a20 2020 2020 2020 2020 2020  lf)..           
-000059f0: 2069 6620 7365 6c66 2e76 7061 7468 2e73   if self.vpath.s
-00005a00: 7461 7274 7377 6974 6828 222e 6370 722f  tartswith(".cpr/
-00005a10: 6464 2f22 2920 616e 6420 7365 6c66 2e61  dd/") and self.a
-00005a20: 7267 732e 6d70 6d63 3a0a 2020 2020 2020  rgs.mpmc:.      
-00005a30: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00005a40: 662e 6172 6773 2e6d 706d 6320 3d3d 2022  f.args.mpmc == "
-00005a50: 2e22 3a0a 2020 2020 2020 2020 2020 2020  .":.            
-00005a60: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-00005a70: 626b 6163 2834 3034 290a 0a20 2020 2020  bkac(404)..     
-00005a80: 2020 2020 2020 2020 2020 206c 6f63 203d             loc =
-00005a90: 2073 656c 662e 6172 6773 2e6d 706d 632e   self.args.mpmc.
-00005aa0: 7273 7472 6970 2822 2f22 2920 2b20 7365  rstrip("/") + se
-00005ab0: 6c66 2e76 7061 7468 5b73 656c 662e 7670  lf.vpath[self.vp
-00005ac0: 6174 682e 7266 696e 6428 222f 2229 203a  ath.rfind("/") :
-00005ad0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00005ae0: 2020 6820 3d20 7b22 4c6f 6361 7469 6f6e    h = {"Location
-00005af0: 223a 206c 6f63 2c20 2243 6163 6865 2d43  ": loc, "Cache-C
-00005b00: 6f6e 7472 6f6c 223a 2022 6d61 782d 6167  ontrol": "max-ag
-00005b10: 653d 3339 227d 0a20 2020 2020 2020 2020  e=39"}.         
-00005b20: 2020 2020 2020 2073 656c 662e 7265 706c         self.repl
-00005b30: 7928 6222 222c 2033 3031 2c20 6865 6164  y(b"", 301, head
-00005b40: 6572 733d 6829 0a20 2020 2020 2020 2020  ers=h).         
-00005b50: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00005b60: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-00005b70: 7374 6174 6963 5f70 6174 6820 3d20 6f73  static_path = os
-00005b80: 2e70 6174 682e 6a6f 696e 2873 656c 662e  .path.join(self.
-00005b90: 452e 6d6f 642c 2022 7765 622f 222c 2073  E.mod, "web/", s
-00005ba0: 656c 662e 7670 6174 685b 353a 5d29 0a20  elf.vpath[5:]). 
-00005bb0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00005bc0: 6e20 7365 6c66 2e74 785f 6669 6c65 2873  n self.tx_file(s
-00005bd0: 7461 7469 635f 7061 7468 290a 0a20 2020  tatic_path)..   
-00005be0: 2020 2020 2069 6620 2263 665f 6368 616c       if "cf_chal
-00005bf0: 6c65 6e67 6522 2069 6e20 7365 6c66 2e75  lenge" in self.u
-00005c00: 7061 7261 6d3a 0a20 2020 2020 2020 2020  param:.         
-00005c10: 2020 2073 656c 662e 7265 706c 7928 7365     self.reply(se
-00005c20: 6c66 2e6a 3273 2822 6366 2229 2e65 6e63  lf.j2s("cf").enc
-00005c30: 6f64 6528 2275 7466 2d38 222c 2022 7265  ode("utf-8", "re
-00005c40: 706c 6163 6522 2929 0a20 2020 2020 2020  place")).       
-00005c50: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00005c60: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00005c70: 2073 656c 662e 6361 6e5f 7265 6164 2061   self.can_read a
-00005c80: 6e64 206e 6f74 2073 656c 662e 6361 6e5f  nd not self.can_
-00005c90: 7772 6974 6520 616e 6420 6e6f 7420 7365  write and not se
-00005ca0: 6c66 2e63 616e 5f67 6574 3a0a 2020 2020  lf.can_get:.    
-00005cb0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00005cc0: 7670 6174 683a 0a20 2020 2020 2020 2020  vpath:.         
-00005cd0: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-00005ce0: 2269 6e61 6363 6573 7369 626c 653a 205b  "inaccessible: [
-00005cf0: 7b7d 5d22 2e66 6f72 6d61 7428 7365 6c66  {}]".format(self
-00005d00: 2e76 7061 7468 2929 0a20 2020 2020 2020  .vpath)).       
-00005d10: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00005d20: 7365 6c66 2e74 785f 3430 3428 5472 7565  self.tx_404(True
-00005d30: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00005d40: 656c 662e 7570 6172 616d 5b22 6822 5d20  elf.uparam["h"] 
-00005d50: 3d20 2222 0a0a 2020 2020 2020 2020 6966  = ""..        if
-00005d60: 2022 7472 6565 2220 696e 2073 656c 662e   "tree" in self.
-00005d70: 7570 6172 616d 3a0a 2020 2020 2020 2020  uparam:.        
-00005d80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00005d90: 7478 5f74 7265 6528 290a 0a20 2020 2020  tx_tree()..     
-00005da0: 2020 2069 6620 2273 6361 6e22 2069 6e20     if "scan" in 
-00005db0: 7365 6c66 2e75 7061 7261 6d3a 0a20 2020  self.uparam:.   
-00005dc0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00005dd0: 7365 6c66 2e73 6361 6e76 6f6c 2829 0a0a  self.scanvol()..
-00005de0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00005df0: 6172 6773 2e67 6574 6d6f 643a 0a20 2020  args.getmod:.   
-00005e00: 2020 2020 2020 2020 2069 6620 2264 656c           if "del
-00005e10: 6574 6522 2069 6e20 7365 6c66 2e75 7061  ete" in self.upa
-00005e20: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
-00005e30: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00005e40: 2e68 616e 646c 655f 726d 285b 5d29 0a0a  .handle_rm([])..
-00005e50: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-00005e60: 6d6f 7665 2220 696e 2073 656c 662e 7570  move" in self.up
-00005e70: 6172 616d 3a0a 2020 2020 2020 2020 2020  aram:.          
-00005e80: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00005e90: 662e 6861 6e64 6c65 5f6d 7628 290a 0a20  f.handle_mv().. 
-00005ea0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00005eb0: 6c66 2e76 7061 7468 3a0a 2020 2020 2020  lf.vpath:.      
-00005ec0: 2020 2020 2020 6966 2022 7265 6c6f 6164        if "reload
-00005ed0: 2220 696e 2073 656c 662e 7570 6172 616d  " in self.uparam
-00005ee0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00005ef0: 2020 7265 7475 726e 2073 656c 662e 6861    return self.ha
-00005f00: 6e64 6c65 5f72 656c 6f61 6428 290a 0a20  ndle_reload().. 
-00005f10: 2020 2020 2020 2020 2020 2069 6620 2273             if "s
-00005f20: 7461 636b 2220 696e 2073 656c 662e 7570  tack" in self.up
-00005f30: 6172 616d 3a0a 2020 2020 2020 2020 2020  aram:.          
-00005f40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00005f50: 662e 7478 5f73 7461 636b 2829 0a0a 2020  f.tx_stack()..  
-00005f60: 2020 2020 2020 2020 2020 6966 2022 7570            if "up
-00005f70: 7322 2069 6e20 7365 6c66 2e75 7061 7261  s" in self.upara
-00005f80: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
-00005f90: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
-00005fa0: 785f 7570 7328 290a 0a20 2020 2020 2020  x_ups()..       
-00005fb0: 2020 2020 2069 6620 226b 3330 3422 2069       if "k304" i
-00005fc0: 6e20 7365 6c66 2e75 7061 7261 6d3a 0a20  n self.uparam:. 
-00005fd0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005fe0: 6574 7572 6e20 7365 6c66 2e73 6574 5f6b  eturn self.set_k
-00005ff0: 3330 3428 290a 0a20 2020 2020 2020 2020  304()..         
-00006000: 2020 2069 6620 2273 6574 636b 2220 696e     if "setck" in
-00006010: 2073 656c 662e 7570 6172 616d 3a0a 2020   self.uparam:.  
-00006020: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00006030: 7475 726e 2073 656c 662e 7365 7463 6b28  turn self.setck(
-00006040: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00006050: 6620 2272 6573 6574 2220 696e 2073 656c  f "reset" in sel
-00006060: 662e 7570 6172 616d 3a0a 2020 2020 2020  f.uparam:.      
-00006070: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00006080: 2073 656c 662e 7365 745f 6366 675f 7265   self.set_cfg_re
-00006090: 7365 7428 290a 0a20 2020 2020 2020 2020  set()..         
-000060a0: 2020 2069 6620 2268 6322 2069 6e20 7365     if "hc" in se
-000060b0: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
-000060c0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000060d0: 6e20 7365 6c66 2e74 785f 7376 6373 2829  n self.tx_svcs()
-000060e0: 0a0a 2020 2020 2020 2020 6966 2022 6822  ..        if "h"
-000060f0: 2069 6e20 7365 6c66 2e75 7061 7261 6d3a   in self.uparam:
-00006100: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00006110: 7572 6e20 7365 6c66 2e74 785f 6d6f 756e  urn self.tx_moun
-00006120: 7473 2829 0a0a 2020 2020 2020 2020 2320  ts()..        # 
-00006130: 636f 6e64 6974 696f 6e61 6c20 7265 6469  conditional redi
-00006140: 7265 6374 2074 6f20 7369 6e67 6c65 2076  rect to single v
-00006150: 6f6c 756d 6573 0a20 2020 2020 2020 2069  olumes.        i
-00006160: 6620 7365 6c66 2e76 7061 7468 203d 3d20  f self.vpath == 
-00006170: 2222 2061 6e64 206e 6f74 2073 656c 662e  "" and not self.
-00006180: 6f75 7061 7261 6d3a 0a20 2020 2020 2020  ouparam:.       
-00006190: 2020 2020 206e 7265 6164 203d 206c 656e       nread = len
-000061a0: 2873 656c 662e 7276 6f6c 290a 2020 2020  (self.rvol).    
-000061b0: 2020 2020 2020 2020 6e77 7269 7465 203d          nwrite =
-000061c0: 206c 656e 2873 656c 662e 7776 6f6c 290a   len(self.wvol).
-000061d0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000061e0: 7265 6164 202b 206e 7772 6974 6520 3d3d  read + nwrite ==
-000061f0: 2031 206f 7220 2873 656c 662e 7276 6f6c   1 or (self.rvol
-00006200: 203d 3d20 7365 6c66 2e77 766f 6c20 616e   == self.wvol an
-00006210: 6420 6e72 6561 6420 3d3d 2031 293a 0a20  d nread == 1):. 
-00006220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00006230: 6620 6e72 6561 6420 3d3d 2031 3a0a 2020  f nread == 1:.  
-00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006250: 2020 7670 6174 6820 3d20 7365 6c66 2e72    vpath = self.r
-00006260: 766f 6c5b 305d 0a20 2020 2020 2020 2020  vol[0].         
-00006270: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00006280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006290: 2076 7061 7468 203d 2073 656c 662e 7776   vpath = self.wv
-000062a0: 6f6c 5b30 5d0a 0a20 2020 2020 2020 2020  ol[0]..         
-000062b0: 2020 2020 2020 2069 6620 7365 6c66 2e76         if self.v
-000062c0: 7061 7468 2021 3d20 7670 6174 683a 0a20  path != vpath:. 
-000062d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000062e0: 2020 2073 656c 662e 7265 6469 7265 6374     self.redirect
-000062f0: 2876 7061 7468 2c20 666c 6176 6f72 3d22  (vpath, flavor="
-00006300: 7265 6469 7265 6374 696e 6720 746f 222c  redirecting to",
-00006310: 2075 7365 3330 323d 5472 7565 290a 2020   use302=True).  
-00006320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006330: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00006340: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00006350: 6c66 2e74 785f 6272 6f77 7365 7228 290a  lf.tx_browser().
-00006360: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
-00006370: 7072 6f70 6669 6e64 2873 656c 6629 2020  propfind(self)  
-00006380: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-00006390: 662e 646f 5f6c 6f67 3a0a 2020 2020 2020  f.do_log:.      
-000063a0: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
-000063b0: 5046 494e 4420 2220 2b20 7365 6c66 2e72  PFIND " + self.r
-000063c0: 6571 290a 0a20 2020 2020 2020 2069 6620  eq)..        if 
-000063d0: 7365 6c66 2e61 7267 732e 6e6f 5f64 6176  self.args.no_dav
-000063e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-000063f0: 6973 6520 5065 626b 6163 2834 3035 2c20  ise Pebkac(405, 
-00006400: 2257 6562 4441 5620 6973 2064 6973 6162  "WebDAV is disab
-00006410: 6c65 6420 696e 2073 6572 7665 7220 636f  led in server co
-00006420: 6e66 6967 2229 0a0a 2020 2020 2020 2020  nfig")..        
-00006430: 6966 206e 6f74 2073 656c 662e 6361 6e5f  if not self.can_
-00006440: 7265 6164 2061 6e64 206e 6f74 2073 656c  read and not sel
-00006450: 662e 6361 6e5f 7772 6974 6520 616e 6420  f.can_write and 
-00006460: 6e6f 7420 7365 6c66 2e63 616e 5f67 6574  not self.can_get
-00006470: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00006480: 2073 656c 662e 7670 6174 683a 0a20 2020   self.vpath:.   
-00006490: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000064a0: 662e 6c6f 6728 2269 6e61 6363 6573 7369  f.log("inaccessi
-000064b0: 626c 653a 205b 7b7d 5d22 2e66 6f72 6d61  ble: [{}]".forma
-000064c0: 7428 7365 6c66 2e76 7061 7468 2929 0a20  t(self.vpath)). 
-000064d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000064e0: 6169 7365 2050 6562 6b61 6328 3430 312c  aise Pebkac(401,
-000064f0: 2022 6175 7468 656e 7469 6361 7465 2229   "authenticate")
-00006500: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00006510: 6c66 2e75 7061 7261 6d5b 2268 225d 203d  lf.uparam["h"] =
-00006520: 2022 220a 0a20 2020 2020 2020 2066 726f   ""..        fro
-00006530: 6d20 2e64 786d 6c20 696d 706f 7274 2070  m .dxml import p
-00006540: 6172 7365 5f78 6d6c 0a0a 2020 2020 2020  arse_xml..      
-00006550: 2020 2320 656e 6320 3d20 2277 696e 646f    # enc = "windo
-00006560: 7773 2d33 316a 220a 2020 2020 2020 2020  ws-31j".        
-00006570: 2320 656e 6320 3d20 2273 6869 6674 5f6a  # enc = "shift_j
-00006580: 6973 220a 2020 2020 2020 2020 656e 6320  is".        enc 
-00006590: 3d20 2275 7466 2d38 220a 2020 2020 2020  = "utf-8".      
-000065a0: 2020 7565 6e63 203d 2065 6e63 2e75 7070    uenc = enc.upp
-000065b0: 6572 2829 0a0a 2020 2020 2020 2020 636c  er()..        cl
-000065c0: 656e 203d 2069 6e74 2873 656c 662e 6865  en = int(self.he
-000065d0: 6164 6572 732e 6765 7428 2263 6f6e 7465  aders.get("conte
-000065e0: 6e74 2d6c 656e 6774 6822 2c20 3029 290a  nt-length", 0)).
-000065f0: 2020 2020 2020 2020 6966 2063 6c65 6e3a          if clen:
-00006600: 0a20 2020 2020 2020 2020 2020 2062 7566  .            buf
-00006610: 203d 2062 2222 0a20 2020 2020 2020 2020   = b"".         
-00006620: 2020 2066 6f72 2072 6275 6620 696e 2073     for rbuf in s
-00006630: 656c 662e 6765 745f 626f 6479 5f72 6561  elf.get_body_rea
-00006640: 6465 7228 295b 305d 3a0a 2020 2020 2020  der()[0]:.      
-00006650: 2020 2020 2020 2020 2020 6275 6620 2b3d            buf +=
-00006660: 2072 6275 660a 2020 2020 2020 2020 2020   rbuf.          
-00006670: 2020 2020 2020 6966 206e 6f74 2072 6275        if not rbu
-00006680: 6620 6f72 206c 656e 2862 7566 2920 3e3d  f or len(buf) >=
-00006690: 2033 3237 3638 3a0a 2020 2020 2020 2020   32768:.        
-000066a0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-000066b0: 6b0a 0a20 2020 2020 2020 2020 2020 2078  k..            x
-000066c0: 726f 6f74 203d 2070 6172 7365 5f78 6d6c  root = parse_xml
-000066d0: 2862 7566 2e64 6563 6f64 6528 656e 632c  (buf.decode(enc,
-000066e0: 2022 7265 706c 6163 6522 2929 0a20 2020   "replace")).   
-000066f0: 2020 2020 2020 2020 2078 7461 6720 3d20           xtag = 
-00006700: 6e65 7874 2878 2066 6f72 2078 2069 6e20  next(x for x in 
-00006710: 7872 6f6f 7420 6966 2078 2e74 6167 2e73  xroot if x.tag.s
-00006720: 706c 6974 2822 7d22 295b 2d31 5d20 3d3d  plit("}")[-1] ==
-00006730: 2022 7072 6f70 2229 0a20 2020 2020 2020   "prop").       
-00006740: 2020 2020 2070 726f 7073 5f6c 7374 203d       props_lst =
-00006750: 205b 792e 7461 672e 7370 6c69 7428 227d   [y.tag.split("}
-00006760: 2229 5b2d 315d 2066 6f72 2079 2069 6e20  ")[-1] for y in 
-00006770: 7874 6167 5d0a 2020 2020 2020 2020 656c  xtag].        el
-00006780: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00006790: 7072 6f70 735f 6c73 7420 3d20 5b0a 2020  props_lst = [.  
-000067a0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-000067b0: 6f6e 7465 6e74 636c 6173 7322 2c0a 2020  ontentclass",.  
-000067c0: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-000067d0: 7265 6174 696f 6e64 6174 6522 2c0a 2020  reationdate",.  
-000067e0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-000067f0: 6566 6175 6c74 646f 6375 6d65 6e74 222c  efaultdocument",
-00006800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006810: 2022 6469 7370 6c61 796e 616d 6522 2c0a   "displayname",.
-00006820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006830: 2267 6574 636f 6e74 656e 746c 616e 6775  "getcontentlangu
-00006840: 6167 6522 2c0a 2020 2020 2020 2020 2020  age",.          
-00006850: 2020 2020 2020 2267 6574 636f 6e74 656e        "getconten
-00006860: 746c 656e 6774 6822 2c0a 2020 2020 2020  tlength",.      
-00006870: 2020 2020 2020 2020 2020 2267 6574 636f            "getco
-00006880: 6e74 656e 7474 7970 6522 2c0a 2020 2020  ntenttype",.    
-00006890: 2020 2020 2020 2020 2020 2020 2267 6574              "get
-000068a0: 6c61 7374 6d6f 6469 6669 6564 222c 0a20  lastmodified",. 
-000068b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000068c0: 6872 6566 222c 0a20 2020 2020 2020 2020  href",.         
-000068d0: 2020 2020 2020 2022 6973 636f 6c6c 6563         "iscollec
-000068e0: 7469 6f6e 222c 0a20 2020 2020 2020 2020  tion",.         
-000068f0: 2020 2020 2020 2022 6973 6869 6464 656e         "ishidden
-00006900: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00006910: 2020 2022 6973 7265 6164 6f6e 6c79 222c     "isreadonly",
-00006920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006930: 2022 6973 726f 6f74 222c 0a20 2020 2020   "isroot",.     
-00006940: 2020 2020 2020 2020 2020 2022 6973 7374             "isst
-00006950: 7275 6374 7572 6564 646f 6375 6d65 6e74  ructureddocument
-00006960: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00006970: 2020 2022 6c61 7374 6163 6365 7373 6564     "lastaccessed
-00006980: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00006990: 2020 2022 6e61 6d65 222c 0a20 2020 2020     "name",.     
-000069a0: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
-000069b0: 6e74 6e61 6d65 222c 0a20 2020 2020 2020  ntname",.       
-000069c0: 2020 2020 2020 2020 2022 7265 736f 7572           "resour
-000069d0: 6365 7479 7065 222c 0a20 2020 2020 2020  cetype",.       
-000069e0: 2020 2020 2020 2020 2022 7375 7070 6f72           "suppor
-000069f0: 7465 646c 6f63 6b22 2c0a 2020 2020 2020  tedlock",.      
-00006a00: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-00006a10: 2070 726f 7073 203d 2073 6574 2870 726f   props = set(pro
-00006a20: 7073 5f6c 7374 290a 2020 2020 2020 2020  ps_lst).        
-00006a30: 766e 2c20 7265 6d20 3d20 7365 6c66 2e61  vn, rem = self.a
-00006a40: 7372 762e 7666 732e 6765 7428 7365 6c66  srv.vfs.get(self
-00006a50: 2e76 7061 7468 2c20 7365 6c66 2e75 6e61  .vpath, self.una
-00006a60: 6d65 2c20 5472 7565 2c20 4661 6c73 652c  me, True, False,
-00006a70: 2065 7272 3d34 3031 290a 2020 2020 2020   err=401).      
-00006a80: 2020 6465 7074 6820 3d20 7365 6c66 2e68    depth = self.h
-00006a90: 6561 6465 7273 2e67 6574 2822 6465 7074  eaders.get("dept
-00006aa0: 6822 2c20 2269 6e66 696e 6974 7922 292e  h", "infinity").
-00006ab0: 6c6f 7765 7228 290a 0a20 2020 2020 2020  lower()..       
-00006ac0: 2069 6620 6465 7074 6820 3d3d 2022 696e   if depth == "in
-00006ad0: 6669 6e69 7479 223a 0a20 2020 2020 2020  finity":.       
-00006ae0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00006af0: 2e61 7267 732e 6461 765f 696e 663a 0a20  .args.dav_inf:. 
-00006b00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00006b10: 656c 662e 6c6f 6728 2263 6c69 656e 7420  elf.log("client 
-00006b20: 7761 6e74 7320 2d2d 6461 762d 696e 6622  wants --dav-inf"
-00006b30: 2c20 3329 0a20 2020 2020 2020 2020 2020  , 3).           
-00006b40: 2020 2020 207a 6220 3d20 6227 3c3f 786d       zb = b'<?xm
-00006b50: 6c20 7665 7273 696f 6e3d 2231 2e30 2220  l version="1.0" 
-00006b60: 656e 636f 6469 6e67 3d22 7574 662d 3822  encoding="utf-8"
-00006b70: 3f3e 5c6e 3c44 3a65 7272 6f72 2078 6d6c  ?>\n<D:error xml
-00006b80: 6e73 3a44 3d22 4441 563a 223e 3c44 3a70  ns:D="DAV:"><D:p
-00006b90: 726f 7066 696e 642d 6669 6e69 7465 2d64  ropfind-finite-d
-00006ba0: 6570 7468 2f3e 3c2f 443a 6572 726f 723e  epth/></D:error>
-00006bb0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00006bc0: 2020 7365 6c66 2e72 6570 6c79 287a 622c    self.reply(zb,
-00006bd0: 2034 3033 2c20 2261 7070 6c69 6361 7469   403, "applicati
-00006be0: 6f6e 2f78 6d6c 3b20 6368 6172 7365 743d  on/xml; charset=
-00006bf0: 7574 662d 3822 290a 2020 2020 2020 2020  utf-8").        
-00006c00: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00006c10: 7275 650a 0a20 2020 2020 2020 2020 2020  rue..           
-00006c20: 2066 6765 6e20 3d20 766e 2e7a 6970 6765   fgen = vn.zipge
-00006c30: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00006c40: 2020 2072 656d 2c0a 2020 2020 2020 2020     rem,.        
-00006c50: 2020 2020 2020 2020 7365 7428 292c 0a20          set(),. 
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00006c70: 656c 662e 756e 616d 652c 0a20 2020 2020  elf.uname,.     
-00006c80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00006c90: 6172 6773 2e65 642c 0a20 2020 2020 2020  args.ed,.       
-00006ca0: 2020 2020 2020 2020 2054 7275 652c 0a20           True,. 
-00006cb0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00006cc0: 6f74 2073 656c 662e 6172 6773 2e6e 6f5f  ot self.args.no_
-00006cd0: 7363 616e 6469 722c 0a20 2020 2020 2020  scandir,.       
-00006ce0: 2020 2020 2020 2020 2077 7261 703d 4661           wrap=Fa
-00006cf0: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-00006d00: 2029 0a0a 2020 2020 2020 2020 656c 6966   )..        elif
-00006d10: 2064 6570 7468 203d 3d20 2231 223a 0a20   depth == "1":. 
-00006d20: 2020 2020 2020 2020 2020 205f 2c20 7666             _, vf
-00006d30: 735f 6c73 2c20 7666 735f 7669 7274 203d  s_ls, vfs_virt =
-00006d40: 2076 6e2e 6c73 280a 2020 2020 2020 2020   vn.ls(.        
-00006d50: 2020 2020 2020 2020 7265 6d2c 2073 656c          rem, sel
-00006d60: 662e 756e 616d 652c 206e 6f74 2073 656c  f.uname, not sel
-00006d70: 662e 6172 6773 2e6e 6f5f 7363 616e 6469  f.args.no_scandi
-00006d80: 722c 205b 5b54 7275 652c 2046 616c 7365  r, [[True, False
-00006d90: 5d5d 0a20 2020 2020 2020 2020 2020 2029  ]].            )
-00006da0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00006db0: 6e6f 7420 7365 6c66 2e61 7267 732e 6564  not self.args.ed
-00006dc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006dd0: 2020 6e61 6d65 7320 3d20 7365 7428 6578    names = set(ex
-00006de0: 636c 7564 655f 646f 7466 696c 6573 285b  clude_dotfiles([
-00006df0: 785b 305d 2066 6f72 2078 2069 6e20 7666  x[0] for x in vf
-00006e00: 735f 6c73 5d29 290a 2020 2020 2020 2020  s_ls])).        
-00006e10: 2020 2020 2020 2020 7666 735f 6c73 203d          vfs_ls =
-00006e20: 205b 7820 666f 7220 7820 696e 2076 6673   [x for x in vfs
-00006e30: 5f6c 7320 6966 2078 5b30 5d20 696e 206e  _ls if x[0] in n
-00006e40: 616d 6573 5d0a 0a20 2020 2020 2020 2020  ames]..         
-00006e50: 2020 207a 6920 3d20 696e 7428 7469 6d65     zi = int(time
-00006e60: 2e74 696d 6528 2929 0a20 2020 2020 2020  .time()).       
-00006e70: 2020 2020 207a 7372 203d 206f 732e 7374       zsr = os.st
-00006e80: 6174 5f72 6573 756c 7428 2831 3638 3737  at_result((16877
-00006e90: 2c20 2d31 2c20 2d31 2c20 312c 2031 3030  , -1, -1, 1, 100
-00006ea0: 302c 2031 3030 302c 2038 2c20 7a69 2c20  0, 1000, 8, zi, 
-00006eb0: 7a69 2c20 7a69 2929 0a20 2020 2020 2020  zi, zi)).       
-00006ec0: 2020 2020 206c 7320 3d20 5b7b 2276 7022       ls = [{"vp"
-00006ed0: 3a20 7670 2c20 2273 7422 3a20 7374 7d20  : vp, "st": st} 
-00006ee0: 666f 7220 7670 2c20 7374 2069 6e20 7666  for vp, st in vf
-00006ef0: 735f 6c73 5d0a 2020 2020 2020 2020 2020  s_ls].          
-00006f00: 2020 6c73 202b 3d20 5b7b 2276 7022 3a20    ls += [{"vp": 
-00006f10: 762c 2022 7374 223a 207a 7372 7d20 666f  v, "st": zsr} fo
-00006f20: 7220 7620 696e 2076 6673 5f76 6972 745d  r v in vfs_virt]
-00006f30: 0a20 2020 2020 2020 2020 2020 2066 6765  .            fge
-00006f40: 6e20 3d20 6c73 2020 2320 7479 7065 3a20  n = ls  # type: 
-00006f50: 6967 6e6f 7265 0a0a 2020 2020 2020 2020  ignore..        
-00006f60: 656c 6966 2064 6570 7468 203d 3d20 2230  elif depth == "0
-00006f70: 223a 0a20 2020 2020 2020 2020 2020 2066  ":.            f
-00006f80: 6765 6e20 3d20 5b5d 2020 2320 7479 7065  gen = []  # type
-00006f90: 3a20 6967 6e6f 7265 0a0a 2020 2020 2020  : ignore..      
-00006fa0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00006fb0: 2020 2020 7420 3d20 2269 6e76 616c 6964      t = "invalid
-00006fc0: 2064 6570 7468 2076 616c 7565 2027 7b7d   depth value '{}
-00006fd0: 2720 286d 7573 7420 6265 2065 6974 6865  ' (must be eithe
-00006fe0: 7220 2730 2720 6f72 2027 3127 7b7d 2922  r '0' or '1'{})"
-00006ff0: 0a20 2020 2020 2020 2020 2020 2074 3220  .            t2 
-00007000: 3d20 2220 6f72 2027 696e 6669 6e69 7479  = " or 'infinity
-00007010: 2722 2069 6620 7365 6c66 2e61 7267 732e  '" if self.args.
-00007020: 6461 765f 696e 6620 656c 7365 2022 220a  dav_inf else "".
-00007030: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007040: 6520 5065 626b 6163 2834 3132 2c20 742e  e Pebkac(412, t.
-00007050: 666f 726d 6174 2864 6570 7468 2c20 7432  format(depth, t2
-00007060: 2929 0a0a 2020 2020 2020 2020 7472 793a  ))..        try:
-00007070: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-00007080: 6469 7220 3d20 7b22 7670 223a 2022 222c  dir = {"vp": "",
-00007090: 2022 7374 223a 206f 732e 7374 6174 2876   "st": os.stat(v
-000070a0: 6e2e 6361 6e6f 6e69 6361 6c28 7265 6d29  n.canonical(rem)
-000070b0: 297d 0a20 2020 2020 2020 2065 7863 6570  )}.        excep
-000070c0: 7420 4f53 4572 726f 7220 6173 2065 783a  t OSError as ex:
-000070d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000070e0: 6578 2e65 7272 6e6f 2021 3d20 6572 726e  ex.errno != errn
-000070f0: 6f2e 454e 4f45 4e54 3a0a 2020 2020 2020  o.ENOENT:.      
-00007100: 2020 2020 2020 2020 2020 7261 6973 650a            raise.
-00007110: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007120: 6520 5065 626b 6163 2834 3034 290a 0a20  e Pebkac(404).. 
-00007130: 2020 2020 2020 2066 6765 6e20 3d20 6974         fgen = it
-00007140: 6572 746f 6f6c 732e 6368 6169 6e28 5b74  ertools.chain([t
-00007150: 6f70 6469 725d 2c20 6667 656e 2920 2023  opdir], fgen)  #
-00007160: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
-00007170: 2020 2020 2020 7674 6f70 203d 2076 6a6f        vtop = vjo
-00007180: 696e 2873 656c 662e 6172 6773 2e52 2c20  in(self.args.R, 
-00007190: 766a 6f69 6e28 766e 2e76 7061 7468 2c20  vjoin(vn.vpath, 
-000071a0: 7265 6d29 290a 0a20 2020 2020 2020 2063  rem))..        c
-000071b0: 6875 6e6b 737a 203d 2030 7837 4646 3820  hunksz = 0x7FF8 
-000071c0: 2023 2070 7265 6665 7272 6564 2062 7920   # preferred by 
-000071d0: 6e67 696e 7820 6f72 2063 6620 2864 756e  nginx or cf (dun
-000071e0: 6e6f 2077 6869 6368 290a 0a20 2020 2020  no which)..     
-000071f0: 2020 2073 656c 662e 7365 6e64 5f68 6561     self.send_hea
-00007200: 6465 7273 280a 2020 2020 2020 2020 2020  ders(.          
-00007210: 2020 4e6f 6e65 2c20 3230 372c 2022 7465    None, 207, "te
-00007220: 7874 2f78 6d6c 3b20 6368 6172 7365 743d  xt/xml; charset=
-00007230: 2220 2b20 656e 632c 207b 2254 7261 6e73  " + enc, {"Trans
-00007240: 6665 722d 456e 636f 6469 6e67 223a 2022  fer-Encoding": "
-00007250: 6368 756e 6b65 6422 7d0a 2020 2020 2020  chunked"}.      
-00007260: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-00007270: 203d 2027 3c3f 786d 6c20 7665 7273 696f   = '<?xml versio
-00007280: 6e3d 2231 2e30 2220 656e 636f 6469 6e67  n="1.0" encoding
-00007290: 3d22 7b7d 223f 3e5c 6e3c 443a 6d75 6c74  ="{}"?>\n<D:mult
-000072a0: 6973 7461 7475 7320 786d 6c6e 733a 443d  istatus xmlns:D=
-000072b0: 2244 4156 3a22 3e27 0a20 2020 2020 2020  "DAV:">'.       
-000072c0: 2072 6574 203d 2072 6574 2e66 6f72 6d61   ret = ret.forma
-000072d0: 7428 7565 6e63 290a 2020 2020 2020 2020  t(uenc).        
-000072e0: 666f 7220 7820 696e 2066 6765 6e3a 0a20  for x in fgen:. 
-000072f0: 2020 2020 2020 2020 2020 2072 7020 3d20             rp = 
-00007300: 766a 6f69 6e28 7674 6f70 2c20 785b 2276  vjoin(vtop, x["v
-00007310: 7022 5d29 0a20 2020 2020 2020 2020 2020  p"]).           
-00007320: 2073 7420 203d 2078 5b22 7374 225d 0a20   st  = x["st"]. 
-00007330: 2020 2020 2020 2020 2020 2069 7364 6972             isdir
-00007340: 203d 2073 7461 742e 535f 4953 4449 5228   = stat.S_ISDIR(
-00007350: 7374 2e73 745f 6d6f 6465 290a 0a20 2020  st.st_mode)..   
-00007360: 2020 2020 2020 2020 2074 203d 2022 3c44           t = "<D
-00007370: 3a72 6573 706f 6e73 653e 3c44 3a68 7265  :response><D:hre
-00007380: 663e 2f7b 7d7b 7d3c 2f44 3a68 7265 663e  f>/{}{}</D:href>
-00007390: 3c44 3a70 726f 7073 7461 743e 3c44 3a70  <D:propstat><D:p
-000073a0: 726f 703e 220a 2020 2020 2020 2020 2020  rop>".          
-000073b0: 2020 7265 7420 2b3d 2074 2e66 6f72 6d61    ret += t.forma
-000073c0: 7428 7175 6f74 6570 2872 7029 2c20 222f  t(quotep(rp), "/
-000073d0: 2220 6966 2069 7364 6972 2061 6e64 2072  " if isdir and r
-000073e0: 7020 656c 7365 2022 2229 0a0a 2020 2020  p else "")..    
-000073f0: 2020 2020 2020 2020 7076 7320 2020 3d20          pvs   = 
-00007400: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-00007410: 2020 2264 6973 706c 6179 6e61 6d65 223a    "displayname":
-00007420: 2068 746d 6c5f 6573 6361 7065 2872 702e   html_escape(rp.
-00007430: 7370 6c69 7428 222f 2229 5b2d 315d 292c  split("/")[-1]),
-00007440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007450: 2022 6765 746c 6173 746d 6f64 6966 6965   "getlastmodifie
-00007460: 6422 3a20 666f 726d 6174 6461 7465 2873  d": formatdate(s
-00007470: 742e 7374 5f6d 7469 6d65 2c20 7573 6567  t.st_mtime, useg
-00007480: 6d74 3d54 7275 6529 2c0a 2020 2020 2020  mt=True),.      
-00007490: 2020 2020 2020 2020 2020 2272 6573 6f75            "resou
-000074a0: 7263 6574 7970 6522 3a20 273c 443a 636f  rcetype": '<D:co
-000074b0: 6c6c 6563 7469 6f6e 2078 6d6c 6e73 3a44  llection xmlns:D
-000074c0: 3d22 4441 563a 222f 3e27 2069 6620 6973  ="DAV:"/>' if is
-000074d0: 6469 7220 656c 7365 2022 222c 0a20 2020  dir else "",.   
-000074e0: 2020 2020 2020 2020 2020 2020 2022 7375               "su
-000074f0: 7070 6f72 7465 646c 6f63 6b22 3a20 273c  pportedlock": '<
-00007500: 443a 6c6f 636b 656e 7472 7920 786d 6c6e  D:lockentry xmln
-00007510: 733a 443d 2244 4156 3a22 3e3c 443a 6c6f  s:D="DAV:"><D:lo
-00007520: 636b 7363 6f70 653e 3c44 3a65 7863 6c75  ckscope><D:exclu
-00007530: 7369 7665 2f3e 3c2f 443a 6c6f 636b 7363  sive/></D:locksc
-00007540: 6f70 653e 3c44 3a6c 6f63 6b74 7970 653e  ope><D:locktype>
-00007550: 3c44 3a77 7269 7465 2f3e 3c2f 443a 6c6f  <D:write/></D:lo
-00007560: 636b 7479 7065 3e3c 2f44 3a6c 6f63 6b65  cktype></D:locke
-00007570: 6e74 7279 3e27 2c0a 2020 2020 2020 2020  ntry>',.        
-00007580: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-00007590: 2020 6966 206e 6f74 2069 7364 6972 3a0a    if not isdir:.
-000075a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075b0: 7076 735b 2267 6574 636f 6e74 656e 7474  pvs["getcontentt
-000075c0: 7970 6522 5d20 3d20 6874 6d6c 5f65 7363  ype"] = html_esc
-000075d0: 6170 6528 6775 6573 735f 6d69 6d65 2872  ape(guess_mime(r
-000075e0: 7029 290a 2020 2020 2020 2020 2020 2020  p)).            
-000075f0: 2020 2020 7076 735b 2267 6574 636f 6e74      pvs["getcont
-00007600: 656e 746c 656e 6774 6822 5d20 3d20 7374  entlength"] = st
-00007610: 7228 7374 2e73 745f 7369 7a65 290a 0a20  r(st.st_size).. 
-00007620: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00007630: 2c20 7620 696e 2070 7673 2e69 7465 6d73  , v in pvs.items
-00007640: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00007650: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
-00007660: 7072 6f70 733a 0a20 2020 2020 2020 2020  props:.         
-00007670: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00007680: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
-00007690: 2020 2020 656c 6966 2076 3a0a 2020 2020      elif v:.    
-000076a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076b0: 7265 7420 2b3d 2022 3c44 3a7b 307d 3e7b  ret += "<D:{0}>{
-000076c0: 317d 3c2f 443a 7b30 7d3e 222e 666f 726d  1}</D:{0}>".form
-000076d0: 6174 286b 2c20 7629 0a20 2020 2020 2020  at(k, v).       
-000076e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000076f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007700: 2020 2072 6574 202b 3d20 223c 443a 7b7d     ret += "<D:{}
-00007710: 2f3e 222e 666f 726d 6174 286b 290a 0a20  />".format(k).. 
-00007720: 2020 2020 2020 2020 2020 2072 6574 202b             ret +
-00007730: 3d20 223c 2f44 3a70 726f 703e 3c44 3a73  = "</D:prop><D:s
-00007740: 7461 7475 733e 4854 5450 2f31 2e31 2032  tatus>HTTP/1.1 2
-00007750: 3030 204f 4b3c 2f44 3a73 7461 7475 733e  00 OK</D:status>
-00007760: 3c2f 443a 7072 6f70 7374 6174 3e22 0a0a  </D:propstat>"..
-00007770: 2020 2020 2020 2020 2020 2020 6d69 7373              miss
-00007780: 696e 6720 3d20 5b22 3c44 3a7b 7d2f 3e22  ing = ["<D:{}/>"
-00007790: 2e66 6f72 6d61 7428 7829 2066 6f72 2078  .format(x) for x
-000077a0: 2069 6e20 7072 6f70 7320 6966 2078 206e   in props if x n
-000077b0: 6f74 2069 6e20 7076 735d 0a20 2020 2020  ot in pvs].     
-000077c0: 2020 2020 2020 2069 6620 6d69 7373 696e         if missin
-000077d0: 6720 616e 6420 636c 656e 3a0a 2020 2020  g and clen:.    
-000077e0: 2020 2020 2020 2020 2020 2020 7420 3d20              t = 
-000077f0: 223c 443a 7072 6f70 7374 6174 3e3c 443a  "<D:propstat><D:
-00007800: 7072 6f70 3e7b 7d3c 2f44 3a70 726f 703e  prop>{}</D:prop>
-00007810: 3c44 3a73 7461 7475 733e 4854 5450 2f31  <D:status>HTTP/1
-00007820: 2e31 2034 3034 204e 6f74 2046 6f75 6e64  .1 404 Not Found
-00007830: 3c2f 443a 7374 6174 7573 3e3c 2f44 3a70  </D:status></D:p
-00007840: 726f 7073 7461 743e 220a 2020 2020 2020  ropstat>".      
-00007850: 2020 2020 2020 2020 2020 7265 7420 2b3d            ret +=
-00007860: 2074 2e66 6f72 6d61 7428 2222 2e6a 6f69   t.format("".joi
-00007870: 6e28 6d69 7373 696e 6729 290a 0a20 2020  n(missing))..   
-00007880: 2020 2020 2020 2020 2072 6574 202b 3d20           ret += 
-00007890: 223c 2f44 3a72 6573 706f 6e73 653e 220a  "</D:response>".
-000078a0: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-000078b0: 6520 6c65 6e28 7265 7429 203e 3d20 6368  e len(ret) >= ch
-000078c0: 756e 6b73 7a3a 0a20 2020 2020 2020 2020  unksz:.         
-000078d0: 2020 2020 2020 2072 6574 203d 2073 656c         ret = sel
-000078e0: 662e 7365 6e64 5f63 6875 6e6b 2872 6574  f.send_chunk(ret
-000078f0: 2c20 656e 632c 2063 6875 6e6b 737a 290a  , enc, chunksz).
-00007900: 0a20 2020 2020 2020 2072 6574 202b 3d20  .        ret += 
-00007910: 223c 2f44 3a6d 756c 7469 7374 6174 7573  "</D:multistatus
-00007920: 3e22 0a20 2020 2020 2020 2077 6869 6c65  >".        while
-00007930: 2072 6574 3a0a 2020 2020 2020 2020 2020   ret:.          
-00007940: 2020 7265 7420 3d20 7365 6c66 2e73 656e    ret = self.sen
-00007950: 645f 6368 756e 6b28 7265 742c 2065 6e63  d_chunk(ret, enc
-00007960: 2c20 6368 756e 6b73 7a29 0a0a 2020 2020  , chunksz)..    
-00007970: 2020 2020 7365 6c66 2e73 656e 645f 6368      self.send_ch
-00007980: 756e 6b28 2222 2c20 656e 632c 2063 6875  unk("", enc, chu
-00007990: 6e6b 737a 290a 2020 2020 2020 2020 2320  nksz).        # 
-000079a0: 7365 6c66 2e72 6570 6c79 2872 6574 2e65  self.reply(ret.e
-000079b0: 6e63 6f64 6528 656e 632c 2022 7265 706c  ncode(enc, "repl
-000079c0: 6163 6522 292c 3230 372c 2022 7465 7874  ace"),207, "text
-000079d0: 2f78 6d6c 3b20 6368 6172 7365 743d 2220  /xml; charset=" 
-000079e0: 2b20 656e 6329 0a20 2020 2020 2020 2072  + enc).        r
-000079f0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00007a00: 6465 6620 6861 6e64 6c65 5f70 726f 7070  def handle_propp
-00007a10: 6174 6368 2873 656c 6629 2020 3a0a 2020  atch(self)  :.  
-00007a20: 2020 2020 2020 6966 2073 656c 662e 646f        if self.do
-00007a30: 5f6c 6f67 3a0a 2020 2020 2020 2020 2020  _log:.          
-00007a40: 2020 7365 6c66 2e6c 6f67 2822 5050 4154    self.log("PPAT
-00007a50: 4348 2022 202b 2073 656c 662e 7265 7129  CH " + self.req)
-00007a60: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00007a70: 662e 6172 6773 2e6e 6f5f 6461 763a 0a20  f.args.no_dav:. 
-00007a80: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00007a90: 2050 6562 6b61 6328 3430 352c 2022 5765   Pebkac(405, "We
-00007aa0: 6244 4156 2069 7320 6469 7361 626c 6564  bDAV is disabled
-00007ab0: 2069 6e20 7365 7276 6572 2063 6f6e 6669   in server confi
-00007ac0: 6722 290a 0a20 2020 2020 2020 2069 6620  g")..        if 
-00007ad0: 6e6f 7420 7365 6c66 2e63 616e 5f77 7269  not self.can_wri
-00007ae0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-00007af0: 7365 6c66 2e6c 6f67 2822 7b7d 2074 7269  self.log("{} tri
-00007b00: 6564 2074 6f20 7072 6f70 7061 7463 6820  ed to proppatch 
-00007b10: 5b7b 7d5d 222e 666f 726d 6174 2873 656c  [{}]".format(sel
-00007b20: 662e 756e 616d 652c 2073 656c 662e 7670  f.uname, self.vp
-00007b30: 6174 6829 290a 2020 2020 2020 2020 2020  ath)).          
-00007b40: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
-00007b50: 3031 2c20 2261 7574 6865 6e74 6963 6174  01, "authenticat
-00007b60: 6522 290a 0a20 2020 2020 2020 2066 726f  e")..        fro
-00007b70: 6d20 786d 6c2e 6574 7265 6520 696d 706f  m xml.etree impo
-00007b80: 7274 2045 6c65 6d65 6e74 5472 6565 2061  rt ElementTree a
-00007b90: 7320 4554 0a0a 2020 2020 2020 2020 6672  s ET..        fr
-00007ba0: 6f6d 202e 6478 6d6c 2069 6d70 6f72 7420  om .dxml import 
-00007bb0: 6d6b 656e 6f64 2c20 6d6b 746e 6f64 2c20  mkenod, mktnod, 
-00007bc0: 7061 7273 655f 786d 6c0a 0a20 2020 2020  parse_xml..     
-00007bd0: 2020 2073 656c 662e 6173 7276 2e76 6673     self.asrv.vfs
-00007be0: 2e67 6574 2873 656c 662e 7670 6174 682c  .get(self.vpath,
-00007bf0: 2073 656c 662e 756e 616d 652c 2046 616c   self.uname, Fal
-00007c00: 7365 2c20 4661 6c73 6529 0a20 2020 2020  se, False).     
-00007c10: 2020 2023 2061 6273 7061 7468 203d 2076     # abspath = v
-00007c20: 6e2e 6463 616e 6f6e 6963 616c 2872 656d  n.dcanonical(rem
-00007c30: 290a 0a20 2020 2020 2020 2062 7566 203d  )..        buf =
-00007c40: 2062 2222 0a20 2020 2020 2020 2066 6f72   b"".        for
-00007c50: 2072 6275 6620 696e 2073 656c 662e 6765   rbuf in self.ge
-00007c60: 745f 626f 6479 5f72 6561 6465 7228 295b  t_body_reader()[
-00007c70: 305d 3a0a 2020 2020 2020 2020 2020 2020  0]:.            
-00007c80: 6275 6620 2b3d 2072 6275 660a 2020 2020  buf += rbuf.    
-00007c90: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
-00007ca0: 6275 6620 6f72 206c 656e 2862 7566 2920  buf or len(buf) 
-00007cb0: 3e3d 2031 3238 202a 2031 3032 343a 0a20  >= 128 * 1024:. 
-00007cc0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00007cd0: 7265 616b 0a0a 2020 2020 2020 2020 6966  reak..        if
-00007ce0: 2073 656c 662e 5f61 7070 6c65 7361 6e28   self._applesan(
-00007cf0: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00007d00: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
-00007d10: 2020 2020 7478 7420 3d20 6275 662e 6465      txt = buf.de
-00007d20: 636f 6465 2822 6173 6369 6922 2c20 2272  code("ascii", "r
-00007d30: 6570 6c61 6365 2229 2e6c 6f77 6572 2829  eplace").lower()
-00007d40: 0a20 2020 2020 2020 2065 6e63 203d 2073  .        enc = s
-00007d50: 656c 662e 6765 745f 786d 6c5f 656e 6328  elf.get_xml_enc(
-00007d60: 7478 7429 0a20 2020 2020 2020 2075 656e  txt).        uen
-00007d70: 6320 3d20 656e 632e 7570 7065 7228 290a  c = enc.upper().
-00007d80: 0a20 2020 2020 2020 2074 7874 203d 2062  .        txt = b
-00007d90: 7566 2e64 6563 6f64 6528 656e 632c 2022  uf.decode(enc, "
-00007da0: 7265 706c 6163 6522 290a 2020 2020 2020  replace").      
-00007db0: 2020 4554 2e72 6567 6973 7465 725f 6e61    ET.register_na
-00007dc0: 6d65 7370 6163 6528 2244 222c 2022 4441  mespace("D", "DA
-00007dd0: 563a 2229 0a20 2020 2020 2020 2078 726f  V:").        xro
-00007de0: 6f74 203d 206d 6b65 6e6f 6428 2244 3a6f  ot = mkenod("D:o
-00007df0: 727a 2229 0a20 2020 2020 2020 2078 726f  rz").        xro
-00007e00: 6f74 2e69 6e73 6572 7428 302c 2070 6172  ot.insert(0, par
-00007e10: 7365 5f78 6d6c 2874 7874 2929 0a20 2020  se_xml(txt)).   
-00007e20: 2020 2020 2078 7072 6f70 203d 2078 726f       xprop = xro
-00007e30: 6f74 2e66 696e 6428 7222 2e2f 7b44 4156  ot.find(r"./{DAV
-00007e40: 3a7d 7072 6f70 6572 7479 7570 6461 7465  :}propertyupdate
-00007e50: 2f7b 4441 563a 7d73 6574 2f7b 4441 563a  /{DAV:}set/{DAV:
-00007e60: 7d70 726f 7022 290a 2020 2020 2020 2020  }prop").        
-00007e70: 6173 7365 7274 2078 7072 6f70 0a20 2020  assert xprop.   
-00007e80: 2020 2020 2066 6f72 207a 6520 696e 2078       for ze in x
-00007e90: 7072 6f70 3a0a 2020 2020 2020 2020 2020  prop:.          
-00007ea0: 2020 7a65 2e63 6c65 6172 2829 0a0a 2020    ze.clear()..  
-00007eb0: 2020 2020 2020 7478 7420 3d20 2222 223c        txt = """<
-00007ec0: 6d75 6c74 6973 7461 7475 7320 786d 6c6e  multistatus xmln
-00007ed0: 733d 2244 4156 3a22 3e3c 7265 7370 6f6e  s="DAV:"><respon
-00007ee0: 7365 3e3c 7072 6f70 7374 6174 3e3c 7374  se><propstat><st
-00007ef0: 6174 7573 3e48 5454 502f 312e 3120 3430  atus>HTTP/1.1 40
-00007f00: 3320 466f 7262 6964 6465 6e3c 2f73 7461  3 Forbidden</sta
-00007f10: 7475 733e 3c2f 7072 6f70 7374 6174 3e3c  tus></propstat><
-00007f20: 2f72 6573 706f 6e73 653e 3c2f 6d75 6c74  /response></mult
-00007f30: 6973 7461 7475 733e 2222 220a 2020 2020  istatus>""".    
-00007f40: 2020 2020 7872 6f6f 7420 3d20 7061 7273      xroot = pars
-00007f50: 655f 786d 6c28 7478 7429 0a0a 2020 2020  e_xml(txt)..    
-00007f60: 2020 2020 656c 203d 2078 726f 6f74 2e66      el = xroot.f
-00007f70: 696e 6428 7222 2e2f 7b44 4156 3a7d 7265  ind(r"./{DAV:}re
-00007f80: 7370 6f6e 7365 2229 0a20 2020 2020 2020  sponse").       
-00007f90: 2061 7373 6572 7420 656c 0a20 2020 2020   assert el.     
-00007fa0: 2020 2065 3220 3d20 6d6b 746e 6f64 2822     e2 = mktnod("
-00007fb0: 443a 6872 6566 222c 2071 756f 7465 7028  D:href", quotep(
-00007fc0: 7365 6c66 2e61 7267 732e 5352 5320 2b20  self.args.SRS + 
-00007fd0: 7365 6c66 2e76 7061 7468 2929 0a20 2020  self.vpath)).   
-00007fe0: 2020 2020 2065 6c2e 696e 7365 7274 2830       el.insert(0
-00007ff0: 2c20 6532 290a 0a20 2020 2020 2020 2065  , e2)..        e
-00008000: 6c20 3d20 7872 6f6f 742e 6669 6e64 2872  l = xroot.find(r
-00008010: 222e 2f7b 4441 563a 7d72 6573 706f 6e73  "./{DAV:}respons
-00008020: 652f 7b44 4156 3a7d 7072 6f70 7374 6174  e/{DAV:}propstat
-00008030: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
-00008040: 7420 656c 0a20 2020 2020 2020 2065 6c2e  t el.        el.
-00008050: 696e 7365 7274 2830 2c20 7870 726f 7029  insert(0, xprop)
-00008060: 0a0a 2020 2020 2020 2020 7265 7420 3d20  ..        ret = 
-00008070: 273c 3f78 6d6c 2076 6572 7369 6f6e 3d22  '<?xml version="
-00008080: 312e 3022 2065 6e63 6f64 696e 673d 227b  1.0" encoding="{
-00008090: 7d22 3f3e 5c6e 272e 666f 726d 6174 2875  }"?>\n'.format(u
-000080a0: 656e 6329 0a20 2020 2020 2020 2072 6574  enc).        ret
-000080b0: 202b 3d20 4554 2e74 6f73 7472 696e 6728   += ET.tostring(
-000080c0: 7872 6f6f 7429 2e64 6563 6f64 6528 2275  xroot).decode("u
-000080d0: 7466 2d38 2229 0a0a 2020 2020 2020 2020  tf-8")..        
-000080e0: 7365 6c66 2e72 6570 6c79 2872 6574 2e65  self.reply(ret.e
-000080f0: 6e63 6f64 6528 656e 632c 2022 7265 706c  ncode(enc, "repl
-00008100: 6163 6522 292c 2032 3037 2c20 2274 6578  ace"), 207, "tex
-00008110: 742f 786d 6c3b 2063 6861 7273 6574 3d22  t/xml; charset="
-00008120: 202b 2065 6e63 290a 2020 2020 2020 2020   + enc).        
-00008130: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00008140: 2064 6566 2068 616e 646c 655f 6c6f 636b   def handle_lock
-00008150: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
-00008160: 2020 6966 2073 656c 662e 646f 5f6c 6f67    if self.do_log
-00008170: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00008180: 6c66 2e6c 6f67 2822 4c4f 434b 2022 202b  lf.log("LOCK " +
-00008190: 2073 656c 662e 7265 7129 0a0a 2020 2020   self.req)..    
-000081a0: 2020 2020 6966 2073 656c 662e 6172 6773      if self.args
-000081b0: 2e6e 6f5f 6461 763a 0a20 2020 2020 2020  .no_dav:.       
-000081c0: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-000081d0: 6328 3430 352c 2022 5765 6244 4156 2069  c(405, "WebDAV i
-000081e0: 7320 6469 7361 626c 6564 2069 6e20 7365  s disabled in se
-000081f0: 7276 6572 2063 6f6e 6669 6722 290a 0a20  rver config").. 
-00008200: 2020 2020 2020 2023 2077 696e 372b 2064         # win7+ d
-00008210: 6561 646c 6f63 6b73 2069 6620 7765 2073  eadlocks if we s
-00008220: 6179 206e 6f3b 206a 7573 7420 736d 696c  ay no; just smil
-00008230: 6520 616e 6420 6e6f 640a 2020 2020 2020  e and nod.      
-00008240: 2020 6966 206e 6f74 2073 656c 662e 6361    if not self.ca
-00008250: 6e5f 7772 6974 6520 616e 6420 224d 6963  n_write and "Mic
-00008260: 726f 736f 6674 2d57 6562 4441 5622 206e  rosoft-WebDAV" n
-00008270: 6f74 2069 6e20 7365 6c66 2e75 613a 0a20  ot in self.ua:. 
-00008280: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00008290: 6c6f 6728 227b 7d20 7472 6965 6420 746f  log("{} tried to
-000082a0: 206c 6f63 6b20 5b7b 7d5d 222e 666f 726d   lock [{}]".form
-000082b0: 6174 2873 656c 662e 756e 616d 652c 2073  at(self.uname, s
-000082c0: 656c 662e 7670 6174 6829 290a 2020 2020  elf.vpath)).    
-000082d0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-000082e0: 626b 6163 2834 3031 2c20 2261 7574 6865  bkac(401, "authe
-000082f0: 6e74 6963 6174 6522 290a 0a20 2020 2020  nticate")..     
-00008300: 2020 2066 726f 6d20 786d 6c2e 6574 7265     from xml.etre
-00008310: 6520 696d 706f 7274 2045 6c65 6d65 6e74  e import Element
-00008320: 5472 6565 2061 7320 4554 0a0a 2020 2020  Tree as ET..    
-00008330: 2020 2020 6672 6f6d 202e 6478 6d6c 2069      from .dxml i
-00008340: 6d70 6f72 7420 6d6b 656e 6f64 2c20 6d6b  mport mkenod, mk
-00008350: 746e 6f64 2c20 7061 7273 655f 786d 6c0a  tnod, parse_xml.
-00008360: 0a20 2020 2020 2020 2076 6e2c 2072 656d  .        vn, rem
-00008370: 203d 2073 656c 662e 6173 7276 2e76 6673   = self.asrv.vfs
-00008380: 2e67 6574 2873 656c 662e 7670 6174 682c  .get(self.vpath,
-00008390: 2073 656c 662e 756e 616d 652c 2046 616c   self.uname, Fal
-000083a0: 7365 2c20 4661 6c73 6529 0a20 2020 2020  se, False).     
-000083b0: 2020 2061 6273 7061 7468 203d 2076 6e2e     abspath = vn.
-000083c0: 6463 616e 6f6e 6963 616c 2872 656d 290a  dcanonical(rem).
-000083d0: 0a20 2020 2020 2020 2062 7566 203d 2062  .        buf = b
-000083e0: 2222 0a20 2020 2020 2020 2066 6f72 2072  "".        for r
-000083f0: 6275 6620 696e 2073 656c 662e 6765 745f  buf in self.get_
-00008400: 626f 6479 5f72 6561 6465 7228 295b 305d  body_reader()[0]
-00008410: 3a0a 2020 2020 2020 2020 2020 2020 6275  :.            bu
-00008420: 6620 2b3d 2072 6275 660a 2020 2020 2020  f += rbuf.      
-00008430: 2020 2020 2020 6966 206e 6f74 2072 6275        if not rbu
-00008440: 6620 6f72 206c 656e 2862 7566 2920 3e3d  f or len(buf) >=
-00008450: 2031 3238 202a 2031 3032 343a 0a20 2020   128 * 1024:.   
-00008460: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00008470: 616b 0a0a 2020 2020 2020 2020 6966 2073  ak..        if s
-00008480: 656c 662e 5f61 7070 6c65 7361 6e28 293a  elf._applesan():
-00008490: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000084a0: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
-000084b0: 2020 7478 7420 3d20 6275 662e 6465 636f    txt = buf.deco
-000084c0: 6465 2822 6173 6369 6922 2c20 2272 6570  de("ascii", "rep
-000084d0: 6c61 6365 2229 2e6c 6f77 6572 2829 0a20  lace").lower(). 
-000084e0: 2020 2020 2020 2065 6e63 203d 2073 656c         enc = sel
-000084f0: 662e 6765 745f 786d 6c5f 656e 6328 7478  f.get_xml_enc(tx
-00008500: 7429 0a20 2020 2020 2020 2075 656e 6320  t).        uenc 
-00008510: 3d20 656e 632e 7570 7065 7228 290a 0a20  = enc.upper().. 
-00008520: 2020 2020 2020 2074 7874 203d 2062 7566         txt = buf
-00008530: 2e64 6563 6f64 6528 656e 632c 2022 7265  .decode(enc, "re
-00008540: 706c 6163 6522 290a 2020 2020 2020 2020  place").        
-00008550: 4554 2e72 6567 6973 7465 725f 6e61 6d65  ET.register_name
-00008560: 7370 6163 6528 2244 222c 2022 4441 563a  space("D", "DAV:
-00008570: 2229 0a20 2020 2020 2020 206c 6b20 3d20  ").        lk = 
-00008580: 7061 7273 655f 786d 6c28 7478 7429 0a20  parse_xml(txt). 
-00008590: 2020 2020 2020 2061 7373 6572 7420 6c6b         assert lk
-000085a0: 2e74 6167 203d 3d20 227b 4441 563a 7d6c  .tag == "{DAV:}l
-000085b0: 6f63 6b69 6e66 6f22 0a0a 2020 2020 2020  ockinfo"..      
-000085c0: 2020 746f 6b65 6e20 3d20 7374 7228 7575    token = str(uu
-000085d0: 6964 2e75 7569 6434 2829 290a 0a20 2020  id.uuid4())..   
-000085e0: 2020 2020 2069 6620 6e6f 7420 6c6b 2e66       if not lk.f
-000085f0: 696e 6428 7222 2e2f 7b44 4156 3a7d 6465  ind(r"./{DAV:}de
-00008600: 7074 6822 293a 0a20 2020 2020 2020 2020  pth"):.         
-00008610: 2020 2064 6570 7468 203d 2073 656c 662e     depth = self.
-00008620: 6865 6164 6572 732e 6765 7428 2264 6570  headers.get("dep
-00008630: 7468 222c 2022 696e 6669 6e69 7479 2229  th", "infinity")
-00008640: 0a20 2020 2020 2020 2020 2020 206c 6b2e  .            lk.
-00008650: 6170 7065 6e64 286d 6b74 6e6f 6428 2244  append(mktnod("D
-00008660: 3a64 6570 7468 222c 2064 6570 7468 2929  :depth", depth))
-00008670: 0a0a 2020 2020 2020 2020 6c6b 2e61 7070  ..        lk.app
-00008680: 656e 6428 6d6b 746e 6f64 2822 443a 7469  end(mktnod("D:ti
-00008690: 6d65 6f75 7422 2c20 2253 6563 6f6e 642d  meout", "Second-
-000086a0: 3333 3130 2229 290a 2020 2020 2020 2020  3310")).        
-000086b0: 6c6b 2e61 7070 656e 6428 6d6b 656e 6f64  lk.append(mkenod
-000086c0: 2822 443a 6c6f 636b 746f 6b65 6e22 2c20  ("D:locktoken", 
-000086d0: 6d6b 746e 6f64 2822 443a 6872 6566 222c  mktnod("D:href",
-000086e0: 2074 6f6b 656e 2929 290a 2020 2020 2020   token))).      
-000086f0: 2020 6c6b 2e61 7070 656e 6428 0a20 2020    lk.append(.   
-00008700: 2020 2020 2020 2020 206d 6b65 6e6f 6428           mkenod(
-00008710: 2244 3a6c 6f63 6b72 6f6f 7422 2c20 6d6b  "D:lockroot", mk
-00008720: 746e 6f64 2822 443a 6872 6566 222c 2071  tnod("D:href", q
-00008730: 756f 7465 7028 7365 6c66 2e61 7267 732e  uotep(self.args.
-00008740: 5352 5320 2b20 7365 6c66 2e76 7061 7468  SRS + self.vpath
-00008750: 2929 290a 2020 2020 2020 2020 290a 0a20  ))).        ).. 
-00008760: 2020 2020 2020 206c 6b32 203d 206d 6b65         lk2 = mke
-00008770: 6e6f 6428 2244 3a61 6374 6976 656c 6f63  nod("D:activeloc
-00008780: 6b22 290a 2020 2020 2020 2020 7872 6f6f  k").        xroo
-00008790: 7420 3d20 6d6b 656e 6f64 2822 443a 7072  t = mkenod("D:pr
-000087a0: 6f70 222c 206d 6b65 6e6f 6428 2244 3a6c  op", mkenod("D:l
-000087b0: 6f63 6b64 6973 636f 7665 7279 222c 206c  ockdiscovery", l
-000087c0: 6b32 2929 0a20 2020 2020 2020 2066 6f72  k2)).        for
-000087d0: 2061 2069 6e20 6c6b 3a0a 2020 2020 2020   a in lk:.      
-000087e0: 2020 2020 2020 6c6b 322e 6170 7065 6e64        lk2.append
-000087f0: 2861 290a 0a20 2020 2020 2020 2072 6574  (a)..        ret
-00008800: 203d 2027 3c3f 786d 6c20 7665 7273 696f   = '<?xml versio
-00008810: 6e3d 2231 2e30 2220 656e 636f 6469 6e67  n="1.0" encoding
-00008820: 3d22 7b7d 223f 3e5c 6e27 2e66 6f72 6d61  ="{}"?>\n'.forma
-00008830: 7428 7565 6e63 290a 2020 2020 2020 2020  t(uenc).        
-00008840: 7265 7420 2b3d 2045 542e 746f 7374 7269  ret += ET.tostri
-00008850: 6e67 2878 726f 6f74 292e 6465 636f 6465  ng(xroot).decode
-00008860: 2822 7574 662d 3822 290a 0a20 2020 2020  ("utf-8")..     
-00008870: 2020 2072 6320 3d20 3230 300a 2020 2020     rc = 200.    
-00008880: 2020 2020 6966 2073 656c 662e 6361 6e5f      if self.can_
-00008890: 7772 6974 6520 616e 6420 6e6f 7420 626f  write and not bo
-000088a0: 732e 7061 7468 2e69 7366 696c 6528 6162  s.path.isfile(ab
-000088b0: 7370 6174 6829 3a0a 2020 2020 2020 2020  spath):.        
-000088c0: 2020 2020 7769 7468 206f 7065 6e28 6673      with open(fs
-000088d0: 656e 6328 6162 7370 6174 6829 2c20 2277  enc(abspath), "w
-000088e0: 6222 2920 6173 205f 3a0a 2020 2020 2020  b") as _:.      
-000088f0: 2020 2020 2020 2020 2020 7263 203d 2032            rc = 2
-00008900: 3031 0a0a 2020 2020 2020 2020 7365 6c66  01..        self
-00008910: 2e6f 7574 5f68 6561 6465 7273 5b22 4c6f  .out_headers["Lo
-00008920: 636b 2d54 6f6b 656e 225d 203d 2022 3c7b  ck-Token"] = "<{
-00008930: 7d3e 222e 666f 726d 6174 2874 6f6b 656e  }>".format(token
-00008940: 290a 2020 2020 2020 2020 7365 6c66 2e72  ).        self.r
-00008950: 6570 6c79 2872 6574 2e65 6e63 6f64 6528  eply(ret.encode(
-00008960: 656e 632c 2022 7265 706c 6163 6522 292c  enc, "replace"),
-00008970: 2072 632c 2022 7465 7874 2f78 6d6c 3b20   rc, "text/xml; 
-00008980: 6368 6172 7365 743d 2220 2b20 656e 6329  charset=" + enc)
-00008990: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000089a0: 5472 7565 0a0a 2020 2020 6465 6620 6861  True..    def ha
-000089b0: 6e64 6c65 5f75 6e6c 6f63 6b28 7365 6c66  ndle_unlock(self
-000089c0: 2920 203a 0a20 2020 2020 2020 2069 6620  )  :.        if 
-000089d0: 7365 6c66 2e64 6f5f 6c6f 673a 0a20 2020  self.do_log:.   
-000089e0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000089f0: 6728 2255 4e4c 4f43 4b20 2220 2b20 7365  g("UNLOCK " + se
-00008a00: 6c66 2e72 6571 290a 0a20 2020 2020 2020  lf.req)..       
-00008a10: 2069 6620 7365 6c66 2e61 7267 732e 6e6f   if self.args.no
-00008a20: 5f64 6176 3a0a 2020 2020 2020 2020 2020  _dav:.          
-00008a30: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
-00008a40: 3035 2c20 2257 6562 4441 5620 6973 2064  05, "WebDAV is d
-00008a50: 6973 6162 6c65 6420 696e 2073 6572 7665  isabled in serve
-00008a60: 7220 636f 6e66 6967 2229 0a0a 2020 2020  r config")..    
-00008a70: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00008a80: 6361 6e5f 7772 6974 6520 616e 6420 224d  can_write and "M
-00008a90: 6963 726f 736f 6674 2d57 6562 4441 5622  icrosoft-WebDAV"
-00008aa0: 206e 6f74 2069 6e20 7365 6c66 2e75 613a   not in self.ua:
-00008ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00008ac0: 662e 6c6f 6728 227b 7d20 7472 6965 6420  f.log("{} tried 
-00008ad0: 746f 206c 6f63 6b20 5b7b 7d5d 222e 666f  to lock [{}]".fo
-00008ae0: 726d 6174 2873 656c 662e 756e 616d 652c  rmat(self.uname,
-00008af0: 2073 656c 662e 7670 6174 6829 290a 2020   self.vpath)).  
-00008b00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00008b10: 5065 626b 6163 2834 3031 2c20 2261 7574  Pebkac(401, "aut
-00008b20: 6865 6e74 6963 6174 6522 290a 0a20 2020  henticate")..   
-00008b30: 2020 2020 2073 656c 662e 7365 6e64 5f68       self.send_h
-00008b40: 6561 6465 7273 284e 6f6e 652c 2032 3034  eaders(None, 204
-00008b50: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00008b60: 2054 7275 650a 0a20 2020 2064 6566 2068   True..    def h
-00008b70: 616e 646c 655f 6d6b 636f 6c28 7365 6c66  andle_mkcol(self
-00008b80: 2920 203a 0a20 2020 2020 2020 2069 6620  )  :.        if 
-00008b90: 7365 6c66 2e5f 6170 706c 6573 616e 2829  self._applesan()
-00008ba0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00008bb0: 7475 726e 2054 7275 650a 0a20 2020 2020  turn True..     
-00008bc0: 2020 2069 6620 7365 6c66 2e64 6f5f 6c6f     if self.do_lo
-00008bd0: 673a 0a20 2020 2020 2020 2020 2020 2073  g:.            s
-00008be0: 656c 662e 6c6f 6728 224d 4b43 4f4c 2022  elf.log("MKCOL "
-00008bf0: 202b 2073 656c 662e 7265 7129 0a0a 2020   + self.req)..  
-00008c00: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00008c10: 662e 5f6d 6b64 6972 2873 656c 662e 7670  f._mkdir(self.vp
-00008c20: 6174 6829 0a0a 2020 2020 6465 6620 6861  ath)..    def ha
-00008c30: 6e64 6c65 5f6d 6f76 6528 7365 6c66 2920  ndle_move(self) 
-00008c40: 203a 0a20 2020 2020 2020 2064 7374 203d   :.        dst =
-00008c50: 2073 656c 662e 6865 6164 6572 735b 2264   self.headers["d
-00008c60: 6573 7469 6e61 7469 6f6e 225d 0a20 2020  estination"].   
-00008c70: 2020 2020 2064 7374 203d 2072 652e 7375       dst = re.su
-00008c80: 6228 225e 6874 7470 733f 3a2f 2f5b 5e2f  b("^https?://[^/
-00008c90: 5d2b 222c 2022 222c 2064 7374 292e 6c73  ]+", "", dst).ls
-00008ca0: 7472 6970 2829 0a20 2020 2020 2020 2064  trip().        d
-00008cb0: 7374 203d 2075 6e71 756f 7465 7028 6473  st = unquotep(ds
-00008cc0: 7429 0a20 2020 2020 2020 2069 6620 6e6f  t).        if no
-00008cd0: 7420 7365 6c66 2e5f 6d76 2873 656c 662e  t self._mv(self.
-00008ce0: 7670 6174 682c 2064 7374 293a 0a20 2020  vpath, dst):.   
-00008cf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008d00: 4661 6c73 650a 0a20 2020 2020 2020 2023  False..        #
-00008d10: 2075 7032 6b20 6f6e 6c79 2063 6172 6573   up2k only cares
-00008d20: 2061 626f 7574 2066 696c 6573 2061 6e64   about files and
-00008d30: 2072 656d 6f76 6573 2061 6c6c 2065 6d70   removes all emp
-00008d40: 7479 2066 6f6c 6465 7273 3b0a 2020 2020  ty folders;.    
-00008d50: 2020 2020 2320 636c 6965 6e74 7320 6e61      # clients na
-00008d60: 7475 7261 6c6c 7920 6578 7065 6374 2065  turally expect e
-00008d70: 6d70 7479 2066 6f6c 6465 7273 2074 6f20  mpty folders to 
-00008d80: 7375 7276 6976 6520 6120 7265 6e61 6d65  survive a rename
-00008d90: 0a20 2020 2020 2020 2076 6e2c 2072 656d  .        vn, rem
-00008da0: 203d 2073 656c 662e 6173 7276 2e76 6673   = self.asrv.vfs
-00008db0: 2e67 6574 2864 7374 2c20 7365 6c66 2e75  .get(dst, self.u
-00008dc0: 6e61 6d65 2c20 4661 6c73 652c 2046 616c  name, False, Fal
-00008dd0: 7365 290a 2020 2020 2020 2020 6461 6273  se).        dabs
-00008de0: 203d 2076 6e2e 6361 6e6f 6e69 6361 6c28   = vn.canonical(
-00008df0: 7265 6d29 0a20 2020 2020 2020 2074 7279  rem).        try
-00008e00: 3a0a 2020 2020 2020 2020 2020 2020 626f  :.            bo
-00008e10: 732e 6d61 6b65 6469 7273 2864 6162 7329  s.makedirs(dabs)
-00008e20: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00008e30: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00008e40: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-00008e50: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
-00008e60: 5f61 7070 6c65 7361 6e28 7365 6c66 2920  _applesan(self) 
-00008e70: 203a 0a20 2020 2020 2020 2069 6620 7365   :.        if se
-00008e80: 6c66 2e61 7267 732e 6461 765f 6d61 6320  lf.args.dav_mac 
-00008e90: 6f72 2022 4461 7277 696e 2f22 206e 6f74  or "Darwin/" not
-00008ea0: 2069 6e20 7365 6c66 2e75 613a 0a20 2020   in self.ua:.   
-00008eb0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00008ec0: 4661 6c73 650a 0a20 2020 2020 2020 2076  False..        v
-00008ed0: 7020 3d20 222f 2220 2b20 7365 6c66 2e76  p = "/" + self.v
-00008ee0: 7061 7468 0a20 2020 2020 2020 2070 746e  path.        ptn
-00008ef0: 203d 2072 222f 5c2e 285f 7c44 535f 5374   = r"/\.(_|DS_St
-00008f00: 6f72 657c 5370 6f74 6c69 6768 742d 7c66  ore|Spotlight-|f
-00008f10: 7365 7665 6e74 7364 7c54 7261 7368 6573  seventsd|Trashes
-00008f20: 7c41 7070 6c65 446f 7562 6c65 297c 2f5f  |AppleDouble)|/_
-00008f30: 5f4d 4143 4f53 220a 2020 2020 2020 2020  _MACOS".        
-00008f40: 6966 2072 652e 7365 6172 6368 2870 746e  if re.search(ptn
-00008f50: 2c20 7670 293a 0a20 2020 2020 2020 2020  , vp):.         
-00008f60: 2020 207a 7420 3d20 273c 3f78 6d6c 2076     zt = '<?xml v
-00008f70: 6572 7369 6f6e 3d22 312e 3022 2065 6e63  ersion="1.0" enc
-00008f80: 6f64 696e 673d 2275 7466 2d38 223f 3e5c  oding="utf-8"?>\
-00008f90: 6e3c 443a 6572 726f 7220 786d 6c6e 733a  n<D:error xmlns:
-00008fa0: 443d 2244 4156 3a22 3e3c 443a 6c6f 636b  D="DAV:"><D:lock
-00008fb0: 2d74 6f6b 656e 2d73 7562 6d69 7474 6564  -token-submitted
-00008fc0: 3e3c 443a 6872 6566 3e7b 7d3c 2f44 3a68  ><D:href>{}</D:h
-00008fd0: 7265 663e 3c2f 443a 6c6f 636b 2d74 6f6b  ref></D:lock-tok
-00008fe0: 656e 2d73 7562 6d69 7474 6564 3e3c 2f44  en-submitted></D
-00008ff0: 3a65 7272 6f72 3e27 0a20 2020 2020 2020  :error>'.       
-00009000: 2020 2020 207a 6220 3d20 7a74 2e66 6f72       zb = zt.for
-00009010: 6d61 7428 7670 292e 656e 636f 6465 2822  mat(vp).encode("
-00009020: 7574 662d 3822 2c20 2272 6570 6c61 6365  utf-8", "replace
-00009030: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
-00009040: 656c 662e 7265 706c 7928 7a62 2c20 3432  elf.reply(zb, 42
-00009050: 332c 2022 7465 7874 2f78 6d6c 3b20 6368  3, "text/xml; ch
-00009060: 6172 7365 743d 7574 662d 3822 290a 2020  arset=utf-8").  
-00009070: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009080: 2054 7275 650a 0a20 2020 2020 2020 2072   True..        r
-00009090: 6574 7572 6e20 4661 6c73 650a 0a20 2020  eturn False..   
-000090a0: 2064 6566 2073 656e 645f 6368 756e 6b28   def send_chunk(
-000090b0: 7365 6c66 2c20 7478 7420 2c20 656e 6320  self, txt , enc 
-000090c0: 2c20 626d 6178 2029 2020 3a0a 2020 2020  , bmax )  :.    
-000090d0: 2020 2020 6f72 6967 5f6c 656e 203d 206c      orig_len = l
-000090e0: 656e 2874 7874 290a 2020 2020 2020 2020  en(txt).        
-000090f0: 6275 6620 3d20 7478 745b 3a62 6d61 785d  buf = txt[:bmax]
-00009100: 2e65 6e63 6f64 6528 656e 632c 2022 7265  .encode(enc, "re
-00009110: 706c 6163 6522 295b 3a62 6d61 785d 0a20  place")[:bmax]. 
-00009120: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00009130: 2020 2020 2020 2020 5f20 3d20 6275 662e          _ = buf.
-00009140: 6465 636f 6465 2865 6e63 290a 2020 2020  decode(enc).    
-00009150: 2020 2020 6578 6365 7074 2055 6e69 636f      except Unico
-00009160: 6465 4465 636f 6465 4572 726f 7220 6173  deDecodeError as
-00009170: 2075 6465 3a0a 2020 2020 2020 2020 2020   ude:.          
-00009180: 2020 6275 6620 3d20 6275 665b 3a20 7564    buf = buf[: ud
-00009190: 652e 7374 6172 745d 0a0a 2020 2020 2020  e.start]..      
-000091a0: 2020 7478 7420 3d20 7478 745b 6c65 6e28    txt = txt[len(
-000091b0: 6275 662e 6465 636f 6465 2865 6e63 2929  buf.decode(enc))
-000091c0: 203a 5d0a 2020 2020 2020 2020 6966 2074   :].        if t
-000091d0: 7874 2061 6e64 206c 656e 2874 7874 2920  xt and len(txt) 
-000091e0: 3d3d 206f 7269 675f 6c65 6e3a 0a20 2020  == orig_len:.   
-000091f0: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-00009200: 6562 6b61 6328 3530 302c 2022 6368 756e  ebkac(500, "chun
-00009210: 6b20 736c 6963 696e 6720 6661 696c 6564  k slicing failed
-00009220: 2229 0a0a 2020 2020 2020 2020 6275 6620  ")..        buf 
-00009230: 3d20 227b 3a78 7d5c 725c 6e22 2e66 6f72  = "{:x}\r\n".for
-00009240: 6d61 7428 6c65 6e28 6275 6629 292e 656e  mat(len(buf)).en
-00009250: 636f 6465 2865 6e63 2920 2b20 6275 660a  code(enc) + buf.
-00009260: 2020 2020 2020 2020 7365 6c66 2e73 2e73          self.s.s
-00009270: 656e 6461 6c6c 2862 7566 202b 2062 225c  endall(buf + b"\
-00009280: 725c 6e22 290a 2020 2020 2020 2020 7265  r\n").        re
-00009290: 7475 726e 2074 7874 0a0a 2020 2020 6465  turn txt..    de
-000092a0: 6620 6861 6e64 6c65 5f6f 7074 696f 6e73  f handle_options
-000092b0: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
-000092c0: 2020 6966 2073 656c 662e 646f 5f6c 6f67    if self.do_log
-000092d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000092e0: 6c66 2e6c 6f67 2822 4f50 5449 4f4e 5320  lf.log("OPTIONS 
-000092f0: 2220 2b20 7365 6c66 2e72 6571 290a 0a20  " + self.req).. 
-00009300: 2020 2020 2020 206f 6820 3d20 7365 6c66         oh = self
-00009310: 2e6f 7574 5f68 6561 6465 7273 0a20 2020  .out_headers.   
-00009320: 2020 2020 206f 685b 2241 6c6c 6f77 225d       oh["Allow"]
-00009330: 203d 2022 2c20 222e 6a6f 696e 2873 656c   = ", ".join(sel
-00009340: 662e 636f 6e6e 2e68 7372 762e 6d61 6c6c  f.conn.hsrv.mall
-00009350: 6f77 290a 0a20 2020 2020 2020 2069 6620  ow)..        if 
-00009360: 6e6f 7420 7365 6c66 2e61 7267 732e 6e6f  not self.args.no
-00009370: 5f64 6176 3a0a 2020 2020 2020 2020 2020  _dav:.          
-00009380: 2020 2320 5052 4f50 5041 5443 482c 204c    # PROPPATCH, L
-00009390: 4f43 4b2c 2055 4e4c 4f43 4b2c 2043 4f50  OCK, UNLOCK, COP
-000093a0: 593a 206e 6f6f 7020 2873 7065 632d 6d75  Y: noop (spec-mu
-000093b0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
-000093c0: 6f68 5b22 4461 7622 5d20 3d20 2231 2c20  oh["Dav"] = "1, 
-000093d0: 3222 0a20 2020 2020 2020 2020 2020 206f  2".            o
-000093e0: 685b 224d 732d 4175 7468 6f72 2d56 6961  h["Ms-Author-Via
-000093f0: 225d 203d 2022 4441 5622 0a0a 2020 2020  "] = "DAV"..    
-00009400: 2020 2020 2320 7769 6e78 702d 7765 6264      # winxp-webd
-00009410: 6176 2064 6f65 736e 7420 6b6e 6f77 2077  av doesnt know w
-00009420: 6861 7420 3230 3420 6973 0a20 2020 2020  hat 204 is.     
-00009430: 2020 2073 656c 662e 7365 6e64 5f68 6561     self.send_hea
-00009440: 6465 7273 2830 2c20 3230 3029 0a20 2020  ders(0, 200).   
-00009450: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-00009460: 0a0a 2020 2020 6465 6620 6861 6e64 6c65  ..    def handle
-00009470: 5f64 656c 6574 6528 7365 6c66 2920 203a  _delete(self)  :
-00009480: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-00009490: 6728 2244 454c 4554 4520 2220 2b20 7365  g("DELETE " + se
-000094a0: 6c66 2e72 6571 290a 2020 2020 2020 2020  lf.req).        
-000094b0: 7265 7475 726e 2073 656c 662e 6861 6e64  return self.hand
-000094c0: 6c65 5f72 6d28 5b5d 290a 0a20 2020 2064  le_rm([])..    d
-000094d0: 6566 2068 616e 646c 655f 7075 7428 7365  ef handle_put(se
-000094e0: 6c66 2920 203a 0a20 2020 2020 2020 2073  lf)  :.        s
-000094f0: 656c 662e 6c6f 6728 2250 5554 2022 202b  elf.log("PUT " +
-00009500: 2073 656c 662e 7265 7129 0a0a 2020 2020   self.req)..    
-00009510: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00009520: 6361 6e5f 7772 6974 653a 0a20 2020 2020  can_write:.     
-00009530: 2020 2020 2020 2074 203d 2022 7573 6572         t = "user
-00009540: 207b 7d20 646f 6573 206e 6f74 2068 6176   {} does not hav
-00009550: 6520 7772 6974 652d 6163 6365 7373 2068  e write-access h
-00009560: 6572 6522 0a20 2020 2020 2020 2020 2020  ere".           
-00009570: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
-00009580: 332c 2074 2e66 6f72 6d61 7428 7365 6c66  3, t.format(self
-00009590: 2e75 6e61 6d65 2929 0a0a 2020 2020 2020  .uname))..      
-000095a0: 2020 6966 206e 6f74 2073 656c 662e 6172    if not self.ar
-000095b0: 6773 2e6e 6f5f 6461 7620 616e 6420 7365  gs.no_dav and se
-000095c0: 6c66 2e5f 6170 706c 6573 616e 2829 3a0a  lf._applesan():.
-000095d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000095e0: 726e 2073 656c 662e 6865 6164 6572 732e  rn self.headers.
-000095f0: 6765 7428 2263 6f6e 7465 6e74 2d6c 656e  get("content-len
-00009600: 6774 6822 2920 3d3d 2022 3022 0a0a 2020  gth") == "0"..  
-00009610: 2020 2020 2020 6966 2073 656c 662e 6865        if self.he
-00009620: 6164 6572 732e 6765 7428 2265 7870 6563  aders.get("expec
-00009630: 7422 2c20 2222 292e 6c6f 7765 7228 2920  t", "").lower() 
-00009640: 3d3d 2022 3130 302d 636f 6e74 696e 7565  == "100-continue
-00009650: 223a 0a20 2020 2020 2020 2020 2020 2074  ":.            t
-00009660: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00009670: 2020 2020 7365 6c66 2e73 2e73 6574 7469      self.s.setti
-00009680: 6d65 6f75 7428 4e6f 6e65 290a 2020 2020  meout(None).    
-00009690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000096a0: 2e73 2e73 656e 6461 6c6c 2862 2248 5454  .s.sendall(b"HTT
-000096b0: 502f 312e 3120 3130 3020 436f 6e74 696e  P/1.1 100 Contin
-000096c0: 7565 5c72 5c6e 5c72 5c6e 2229 0a20 2020  ue\r\n\r\n").   
-000096d0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-000096e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000096f0: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
-00009700: 302c 2022 636c 6965 6e74 2064 2f63 2062  0, "client d/c b
-00009710: 6566 6f72 6520 3130 3020 636f 6e74 696e  efore 100 contin
-00009720: 7565 2229 0a0a 2020 2020 2020 2020 7265  ue")..        re
-00009730: 7475 726e 2073 656c 662e 6861 6e64 6c65  turn self.handle
-00009740: 5f73 7461 7368 2854 7275 6529 0a0a 2020  _stash(True)..  
-00009750: 2020 6465 6620 6861 6e64 6c65 5f70 6f73    def handle_pos
-00009760: 7428 7365 6c66 2920 203a 0a20 2020 2020  t(self)  :.     
-00009770: 2020 2073 656c 662e 6c6f 6728 2250 4f53     self.log("POS
-00009780: 5420 2220 2b20 7365 6c66 2e72 6571 290a  T " + self.req).
-00009790: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000097a0: 2e68 6561 6465 7273 2e67 6574 2822 6578  .headers.get("ex
-000097b0: 7065 6374 222c 2022 2229 2e6c 6f77 6572  pect", "").lower
-000097c0: 2829 203d 3d20 2231 3030 2d63 6f6e 7469  () == "100-conti
-000097d0: 6e75 6522 3a0a 2020 2020 2020 2020 2020  nue":.          
-000097e0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-000097f0: 2020 2020 2020 2073 656c 662e 732e 7365         self.s.se
-00009800: 7474 696d 656f 7574 284e 6f6e 6529 0a20  ttimeout(None). 
-00009810: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00009820: 656c 662e 732e 7365 6e64 616c 6c28 6222  elf.s.sendall(b"
-00009830: 4854 5450 2f31 2e31 2031 3030 2043 6f6e  HTTP/1.1 100 Con
-00009840: 7469 6e75 655c 725c 6e5c 725c 6e22 290a  tinue\r\n\r\n").
-00009850: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00009860: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-00009870: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
-00009880: 2834 3030 2c20 2263 6c69 656e 7420 642f  (400, "client d/
-00009890: 6320 6265 666f 7265 2031 3030 2063 6f6e  c before 100 con
-000098a0: 7469 6e75 6522 290a 0a20 2020 2020 2020  tinue")..       
-000098b0: 2069 6620 2272 6177 2220 696e 2073 656c   if "raw" in sel
-000098c0: 662e 7570 6172 616d 3a0a 2020 2020 2020  f.uparam:.      
-000098d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000098e0: 662e 6861 6e64 6c65 5f73 7461 7368 2846  f.handle_stash(F
-000098f0: 616c 7365 290a 0a20 2020 2020 2020 2063  alse)..        c
-00009900: 7479 7065 203d 2073 656c 662e 6865 6164  type = self.head
-00009910: 6572 732e 6765 7428 2263 6f6e 7465 6e74  ers.get("content
-00009920: 2d74 7970 6522 2c20 2222 292e 6c6f 7765  -type", "").lowe
-00009930: 7228 290a 0a20 2020 2020 2020 2069 6620  r()..        if 
-00009940: 226d 756c 7469 7061 7274 2f66 6f72 6d2d  "multipart/form-
-00009950: 6461 7461 2220 696e 2063 7479 7065 3a0a  data" in ctype:.
-00009960: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00009970: 726e 2073 656c 662e 6861 6e64 6c65 5f70  rn self.handle_p
-00009980: 6f73 745f 6d75 6c74 6970 6172 7428 290a  ost_multipart().
-00009990: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
-000099a0: 2020 2020 2020 2020 2020 2261 7070 6c69            "appli
-000099b0: 6361 7469 6f6e 2f6a 736f 6e22 2069 6e20  cation/json" in 
-000099c0: 6374 7970 650a 2020 2020 2020 2020 2020  ctype.          
-000099d0: 2020 6f72 2022 7465 7874 2f70 6c61 696e    or "text/plain
-000099e0: 2220 696e 2063 7479 7065 0a20 2020 2020  " in ctype.     
-000099f0: 2020 2020 2020 206f 7220 2261 7070 6c69         or "appli
-00009a00: 6361 7469 6f6e 2f78 6d6c 2220 696e 2063  cation/xml" in c
-00009a10: 7479 7065 0a20 2020 2020 2020 2029 3a0a  type.        ):.
-00009a20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00009a30: 726e 2073 656c 662e 6861 6e64 6c65 5f70  rn self.handle_p
-00009a40: 6f73 745f 6a73 6f6e 2829 0a0a 2020 2020  ost_json()..    
-00009a50: 2020 2020 6966 2022 6d6f 7665 2220 696e      if "move" in
-00009a60: 2073 656c 662e 7570 6172 616d 3a0a 2020   self.uparam:.  
-00009a70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009a80: 2073 656c 662e 6861 6e64 6c65 5f6d 7628   self.handle_mv(
-00009a90: 290a 0a20 2020 2020 2020 2069 6620 2264  )..        if "d
-00009aa0: 656c 6574 6522 2069 6e20 7365 6c66 2e75  elete" in self.u
-00009ab0: 7061 7261 6d3a 0a20 2020 2020 2020 2020  param:.         
-00009ac0: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
-00009ad0: 616e 646c 655f 726d 285b 5d29 0a0a 2020  andle_rm([])..  
-00009ae0: 2020 2020 2020 6966 2022 6170 706c 6963        if "applic
-00009af0: 6174 696f 6e2f 6f63 7465 742d 7374 7265  ation/octet-stre
-00009b00: 616d 2220 696e 2063 7479 7065 3a0a 2020  am" in ctype:.  
-00009b10: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009b20: 2073 656c 662e 6861 6e64 6c65 5f70 6f73   self.handle_pos
-00009b30: 745f 6269 6e61 7279 2829 0a0a 2020 2020  t_binary()..    
-00009b40: 2020 2020 6966 2022 6170 706c 6963 6174      if "applicat
-00009b50: 696f 6e2f 782d 7777 772d 666f 726d 2d75  ion/x-www-form-u
-00009b60: 726c 656e 636f 6465 6422 2069 6e20 6374  rlencoded" in ct
-00009b70: 7970 653a 0a20 2020 2020 2020 2020 2020  ype:.           
-00009b80: 206f 7074 203d 2073 656c 662e 6172 6773   opt = self.args
-00009b90: 2e75 726c 666f 726d 0a20 2020 2020 2020  .urlform.       
-00009ba0: 2020 2020 2069 6620 2273 7461 7368 2220       if "stash" 
-00009bb0: 696e 206f 7074 3a0a 2020 2020 2020 2020  in opt:.        
-00009bc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00009bd0: 656c 662e 6861 6e64 6c65 5f73 7461 7368  elf.handle_stash
-00009be0: 2846 616c 7365 290a 0a20 2020 2020 2020  (False)..       
-00009bf0: 2020 2020 2069 6620 2273 6176 6522 2069       if "save" i
-00009c00: 6e20 6f70 743a 0a20 2020 2020 2020 2020  n opt:.         
-00009c10: 2020 2020 2020 2070 6f73 745f 737a 2c20         post_sz, 
-00009c20: 5f2c 205f 2c20 5f2c 2070 6174 682c 205f  _, _, _, path, _
-00009c30: 203d 2073 656c 662e 6475 6d70 5f74 6f5f   = self.dump_to_
-00009c40: 6669 6c65 2846 616c 7365 290a 2020 2020  file(False).    
-00009c50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00009c60: 2e6c 6f67 2822 7572 6c66 6f72 6d3a 207b  .log("urlform: {
-00009c70: 7d20 6279 7465 732c 207b 7d22 2e66 6f72  } bytes, {}".for
-00009c80: 6d61 7428 706f 7374 5f73 7a2c 2070 6174  mat(post_sz, pat
-00009c90: 6829 290a 2020 2020 2020 2020 2020 2020  h)).            
-00009ca0: 656c 6966 2022 7072 696e 7422 2069 6e20  elif "print" in 
-00009cb0: 6f70 743a 0a20 2020 2020 2020 2020 2020  opt:.           
-00009cc0: 2020 2020 2072 6561 6465 722c 205f 203d       reader, _ =
-00009cd0: 2073 656c 662e 6765 745f 626f 6479 5f72   self.get_body_r
-00009ce0: 6561 6465 7228 290a 2020 2020 2020 2020  eader().        
-00009cf0: 2020 2020 2020 2020 6275 6620 3d20 6222          buf = b"
-00009d00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00009d10: 2020 666f 7220 7262 7566 2069 6e20 7265    for rbuf in re
-00009d20: 6164 6572 3a0a 2020 2020 2020 2020 2020  ader:.          
-00009d30: 2020 2020 2020 2020 2020 6275 6620 2b3d            buf +=
-00009d40: 2072 6275 660a 2020 2020 2020 2020 2020   rbuf.          
-00009d50: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00009d60: 2072 6275 6620 6f72 206c 656e 2862 7566   rbuf or len(buf
-00009d70: 2920 3e3d 2033 3237 3638 3a0a 2020 2020  ) >= 32768:.    
-00009d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d90: 2020 2020 6272 6561 6b0a 0a20 2020 2020      break..     
-00009da0: 2020 2020 2020 2020 2020 2069 6620 6275             if bu
-00009db0: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
-00009dc0: 2020 2020 2020 206f 7269 6720 3d20 6275         orig = bu
-00009dd0: 662e 6465 636f 6465 2822 7574 662d 3822  f.decode("utf-8"
-00009de0: 2c20 2272 6570 6c61 6365 2229 0a20 2020  , "replace").   
-00009df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e00: 2074 203d 2022 7572 6c66 6f72 6d5f 7261   t = "urlform_ra
-00009e10: 7720 7b7d 2040 207b 7d5c 6e20 207b 7d5c  w {} @ {}\n  {}\
-00009e20: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-00009e30: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-00009e40: 742e 666f 726d 6174 286c 656e 286f 7269  t.format(len(ori
-00009e50: 6729 2c20 7365 6c66 2e76 7061 7468 2c20  g), self.vpath, 
-00009e60: 6f72 6967 2929 0a20 2020 2020 2020 2020  orig)).         
-00009e70: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00009e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e90: 2020 2020 2020 2020 7a62 203d 2075 6e71          zb = unq
-00009ea0: 756f 7465 2862 7566 2e72 6570 6c61 6365  uote(buf.replace
-00009eb0: 2862 222b 222c 2062 2220 2229 290a 2020  (b"+", b" ")).  
-00009ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ed0: 2020 2020 2020 706c 6169 6e20 3d20 7a62        plain = zb
-00009ee0: 2e64 6563 6f64 6528 2275 7466 2d38 222c  .decode("utf-8",
-00009ef0: 2022 7265 706c 6163 6522 290a 2020 2020   "replace").    
-00009f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f10: 2020 2020 6966 2062 7566 2e73 7461 7274      if buf.start
-00009f20: 7377 6974 6828 6222 6d73 673d 2229 3a0a  swith(b"msg="):.
-00009f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f40: 2020 2020 2020 2020 2020 2020 706c 6169              plai
-00009f50: 6e20 3d20 706c 6169 6e5b 343a 5d0a 2020  n = plain[4:].  
-00009f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f70: 2020 2020 2020 2020 2020 7666 732c 2072            vfs, r
-00009f80: 656d 203d 2073 656c 662e 6173 7276 2e76  em = self.asrv.v
-00009f90: 6673 2e67 6574 280a 2020 2020 2020 2020  fs.get(.        
-00009fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fb0: 2020 2020 2020 2020 7365 6c66 2e76 7061          self.vpa
-00009fc0: 7468 2c20 7365 6c66 2e75 6e61 6d65 2c20  th, self.uname, 
-00009fd0: 4661 6c73 652c 2046 616c 7365 0a20 2020  False, False.   
-00009fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ff0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a010: 2020 2020 2020 2078 6d20 3d20 7666 732e         xm = vfs.
-0000a020: 666c 6167 732e 6765 7428 2278 6d22 290a  flags.get("xm").
-0000a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a040: 2020 2020 2020 2020 2020 2020 6966 2078              if x
-0000a050: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
-0000a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a070: 2020 2072 756e 686f 6f6b 280a 2020 2020     runhook(.    
-0000a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0a0: 7365 6c66 2e6c 6f67 2c0a 2020 2020 2020  self.log,.      
-0000a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0c0: 2020 2020 2020 2020 2020 2020 2020 786d                xm
-0000a0d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0f0: 2020 2020 2020 7666 732e 6361 6e6f 6e69        vfs.canoni
-0000a100: 6361 6c28 7265 6d29 2c0a 2020 2020 2020  cal(rem),.      
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a120: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a130: 6c66 2e76 7061 7468 2c0a 2020 2020 2020  lf.vpath,.      
-0000a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a150: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000a160: 6c66 2e68 6f73 742c 0a20 2020 2020 2020  lf.host,.       
-0000a170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a180: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000a190: 662e 756e 616d 652c 0a20 2020 2020 2020  f.uname,.       
-0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1b0: 2020 2020 2020 2020 2020 2020 2074 696d               tim
-0000a1c0: 652e 7469 6d65 2829 2c0a 2020 2020 2020  e.time(),.      
-0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1e0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-0000a1f0: 6e28 786d 292c 0a20 2020 2020 2020 2020  n(xm),.         
-0000a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a210: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000a220: 6970 2c0a 2020 2020 2020 2020 2020 2020  ip,.            
-0000a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a240: 2020 2020 2020 2020 7469 6d65 2e74 696d          time.tim
-0000a250: 6528 292c 0a20 2020 2020 2020 2020 2020  e(),.           
-0000a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a270: 2020 2020 2020 2020 2070 6c61 696e 2c0a           plain,.
-0000a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2a0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000a2b0: 2020 2020 2020 2020 2020 2074 203d 2022             t = "
-0000a2c0: 7572 6c66 6f72 6d5f 6465 6320 7b7d 2040  urlform_dec {} @
-0000a2d0: 207b 7d5c 6e20 207b 7d5c 6e22 0a20 2020   {}\n  {}\n".   
-0000a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2f0: 2020 2020 2073 656c 662e 6c6f 6728 742e       self.log(t.
-0000a300: 666f 726d 6174 286c 656e 2870 6c61 696e  format(len(plain
-0000a310: 292c 2073 656c 662e 7670 6174 682c 2070  ), self.vpath, p
-0000a320: 6c61 696e 2929 0a0a 2020 2020 2020 2020  lain))..        
-0000a330: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000a340: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-0000a350: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
-0000a360: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000a370: 2e6c 6f67 2872 6570 7228 6578 2929 0a0a  .log(repr(ex))..
-0000a380: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-0000a390: 6765 7422 2069 6e20 6f70 743a 0a20 2020  get" in opt:.   
-0000a3a0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0000a3b0: 7572 6e20 7365 6c66 2e68 616e 646c 655f  urn self.handle_
-0000a3c0: 6765 7428 290a 0a20 2020 2020 2020 2020  get()..         
-0000a3d0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
-0000a3e0: 3430 352c 2022 504f 5354 287b 7d29 2069  405, "POST({}) i
-0000a3f0: 7320 6469 7361 626c 6564 2069 6e20 7365  s disabled in se
-0000a400: 7276 6572 2063 6f6e 6669 6722 2e66 6f72  rver config".for
-0000a410: 6d61 7428 6374 7970 6529 290a 0a20 2020  mat(ctype))..   
-0000a420: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-0000a430: 6328 3430 352c 2022 646f 6e27 7420 6b6e  c(405, "don't kn
-0000a440: 6f77 2068 6f77 2074 6f20 6861 6e64 6c65  ow how to handle
-0000a450: 2050 4f53 5428 7b7d 2922 2e66 6f72 6d61   POST({})".forma
-0000a460: 7428 6374 7970 6529 290a 0a20 2020 2064  t(ctype))..    d
-0000a470: 6566 2067 6574 5f78 6d6c 5f65 6e63 2873  ef get_xml_enc(s
-0000a480: 656c 662c 2074 7874 2029 2020 3a0a 2020  elf, txt )  :.  
-0000a490: 2020 2020 2020 6f66 7320 3d20 7478 745b        ofs = txt[
-0000a4a0: 3a35 3132 5d2e 6669 6e64 2827 2065 6e63  :512].find(' enc
-0000a4b0: 6f64 696e 673d 2227 290a 2020 2020 2020  oding="').      
-0000a4c0: 2020 656e 6320 3d20 2222 0a20 2020 2020    enc = "".     
-0000a4d0: 2020 2069 6620 6f66 7320 2b20 313a 0a20     if ofs + 1:. 
-0000a4e0: 2020 2020 2020 2020 2020 2065 6e63 203d             enc =
-0000a4f0: 2074 7874 5b6f 6673 202b 2036 203a 5d2e   txt[ofs + 6 :].
-0000a500: 7370 6c69 7428 2722 2729 5b31 5d0a 2020  split('"')[1].  
-0000a510: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000a520: 2020 2020 2020 2020 656e 6320 3d20 7365          enc = se
-0000a530: 6c66 2e68 6561 6465 7273 2e67 6574 2822  lf.headers.get("
-0000a540: 636f 6e74 656e 742d 7479 7065 222c 2022  content-type", "
-0000a550: 2229 2e6c 6f77 6572 2829 0a20 2020 2020  ").lower().     
-0000a560: 2020 2020 2020 206f 6673 203d 2065 6e63         ofs = enc
-0000a570: 2e66 696e 6428 2263 6861 7273 6574 3d22  .find("charset="
-0000a580: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-0000a590: 206f 6673 202b 2031 3a0a 2020 2020 2020   ofs + 1:.      
-0000a5a0: 2020 2020 2020 2020 2020 656e 6320 3d20            enc = 
-0000a5b0: 656e 635b 6f66 7320 2b20 345d 2e73 706c  enc[ofs + 4].spl
-0000a5c0: 6974 2822 3d22 295b 315d 2e73 706c 6974  it("=")[1].split
-0000a5d0: 2822 3b22 295b 305d 2e73 7472 6970 2822  (";")[0].strip("
-0000a5e0: 5c22 2722 290a 2020 2020 2020 2020 2020  \"'").          
-0000a5f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000a600: 2020 2020 2020 2020 656e 6320 3d20 2222          enc = ""
-0000a610: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0000a620: 2065 6e63 206f 7220 2275 7466 2d38 220a   enc or "utf-8".
-0000a630: 0a20 2020 2064 6566 2067 6574 5f62 6f64  .    def get_bod
-0000a640: 795f 7265 6164 6572 2873 656c 6629 2020  y_reader(self)  
-0000a650: 2020 203a 0a20 2020 2020 2020 2069 6620     :.        if 
-0000a660: 2263 6875 6e6b 6564 2220 696e 2073 656c  "chunked" in sel
-0000a670: 662e 6865 6164 6572 732e 6765 7428 2274  f.headers.get("t
-0000a680: 7261 6e73 6665 722d 656e 636f 6469 6e67  ransfer-encoding
-0000a690: 222c 2022 2229 2e6c 6f77 6572 2829 3a0a  ", "").lower():.
-0000a6a0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000a6b0: 726e 2072 6561 645f 736f 636b 6574 5f63  rn read_socket_c
-0000a6c0: 6875 6e6b 6564 2873 656c 662e 7372 292c  hunked(self.sr),
-0000a6d0: 202d 310a 0a20 2020 2020 2020 2072 656d   -1..        rem
-0000a6e0: 6169 6e73 203d 2069 6e74 2873 656c 662e  ains = int(self.
-0000a6f0: 6865 6164 6572 732e 6765 7428 2263 6f6e  headers.get("con
-0000a700: 7465 6e74 2d6c 656e 6774 6822 2c20 2d31  tent-length", -1
-0000a710: 2929 0a20 2020 2020 2020 2069 6620 7265  )).        if re
-0000a720: 6d61 696e 7320 3d3d 202d 313a 0a20 2020  mains == -1:.   
-0000a730: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
-0000a740: 6570 616c 6976 6520 3d20 4661 6c73 650a  epalive = False.
-0000a750: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000a760: 726e 2072 6561 645f 736f 636b 6574 5f75  rn read_socket_u
-0000a770: 6e62 6f75 6e64 6564 2873 656c 662e 7372  nbounded(self.sr
-0000a780: 292c 2072 656d 6169 6e73 0a20 2020 2020  ), remains.     
-0000a790: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000a7a0: 2020 2020 2072 6574 7572 6e20 7265 6164       return read
-0000a7b0: 5f73 6f63 6b65 7428 7365 6c66 2e73 722c  _socket(self.sr,
-0000a7c0: 2072 656d 6169 6e73 292c 2072 656d 6169   remains), remai
-0000a7d0: 6e73 0a0a 2020 2020 6465 6620 6475 6d70  ns..    def dump
-0000a7e0: 5f74 6f5f 6669 6c65 2873 656c 662c 2069  _to_file(self, i
-0000a7f0: 735f 7075 7420 2920 2020 2020 2020 3a0a  s_put )       :.
-0000a800: 2020 2020 2020 2020 2320 706f 7374 5f73          # post_s
-0000a810: 7a2c 2073 6861 5f68 6578 2c20 7368 615f  z, sha_hex, sha_
-0000a820: 6236 342c 2072 656d 6169 6e73 2c20 7061  b64, remains, pa
-0000a830: 7468 2c20 7572 6c0a 2020 2020 2020 2020  th, url.        
-0000a840: 7265 6164 6572 2c20 7265 6d61 696e 7320  reader, remains 
-0000a850: 3d20 7365 6c66 2e67 6574 5f62 6f64 795f  = self.get_body_
-0000a860: 7265 6164 6572 2829 0a20 2020 2020 2020  reader().       
-0000a870: 2076 6673 2c20 7265 6d20 3d20 7365 6c66   vfs, rem = self
-0000a880: 2e61 7372 762e 7666 732e 6765 7428 7365  .asrv.vfs.get(se
-0000a890: 6c66 2e76 7061 7468 2c20 7365 6c66 2e75  lf.vpath, self.u
-0000a8a0: 6e61 6d65 2c20 4661 6c73 652c 2054 7275  name, False, Tru
-0000a8b0: 6529 0a20 2020 2020 2020 2072 6e64 2c20  e).        rnd, 
-0000a8c0: 5f2c 206c 6966 6574 696d 652c 2078 6275  _, lifetime, xbu
-0000a8d0: 2c20 7861 7520 3d20 7365 6c66 2e75 706c  , xau = self.upl
-0000a8e0: 6f61 645f 666c 6167 7328 7666 7329 0a20  oad_flags(vfs). 
-0000a8f0: 2020 2020 2020 206c 696d 203d 2076 6673         lim = vfs
-0000a900: 2e67 6574 5f64 6276 2872 656d 295b 305d  .get_dbv(rem)[0]
-0000a910: 2e6c 696d 0a20 2020 2020 2020 2066 6469  .lim.        fdi
-0000a920: 7220 3d20 7666 732e 6361 6e6f 6e69 6361  r = vfs.canonica
-0000a930: 6c28 7265 6d29 0a20 2020 2020 2020 2069  l(rem).        i
-0000a940: 6620 6c69 6d3a 0a20 2020 2020 2020 2020  f lim:.         
-0000a950: 2020 2066 6469 722c 2072 656d 203d 206c     fdir, rem = l
-0000a960: 696d 2e61 6c6c 2873 656c 662e 6970 2c20  im.all(self.ip, 
-0000a970: 7265 6d2c 2072 656d 6169 6e73 2c20 6664  rem, remains, fd
-0000a980: 6972 290a 0a20 2020 2020 2020 2066 6e20  ir)..        fn 
-0000a990: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
-0000a9a0: 6620 7265 6d20 616e 6420 6e6f 7420 7365  f rem and not se
-0000a9b0: 6c66 2e74 7261 696c 696e 675f 736c 6173  lf.trailing_slas
-0000a9c0: 6820 616e 6420 6e6f 7420 626f 732e 7061  h and not bos.pa
-0000a9d0: 7468 2e69 7364 6972 2866 6469 7229 3a0a  th.isdir(fdir):.
-0000a9e0: 2020 2020 2020 2020 2020 2020 6664 6972              fdir
-0000a9f0: 2c20 666e 203d 206f 732e 7061 7468 2e73  , fn = os.path.s
-0000aa00: 706c 6974 2866 6469 7229 0a20 2020 2020  plit(fdir).     
-0000aa10: 2020 2020 2020 2072 656d 2c20 5f20 3d20         rem, _ = 
-0000aa20: 7673 706c 6974 2872 656d 290a 0a20 2020  vsplit(rem)..   
-0000aa30: 2020 2020 2062 6f73 2e6d 616b 6564 6972       bos.makedir
-0000aa40: 7328 6664 6972 290a 0a20 2020 2020 2020  s(fdir)..       
-0000aa50: 206f 7065 6e5f 6b61 2020 203d 207b 2266   open_ka   = {"f
-0000aa60: 756e 223a 206f 7065 6e7d 0a20 2020 2020  un": open}.     
-0000aa70: 2020 206f 7065 6e5f 6120 3d20 5b22 7762     open_a = ["wb
-0000aa80: 222c 2035 3132 202a 2031 3032 345d 0a0a  ", 512 * 1024]..
-0000aa90: 2020 2020 2020 2020 2320 7573 6572 2d72          # user-r
-0000aaa0: 6571 7565 7374 207c 7c20 636f 6e66 6967  equest || config
-0000aab0: 2d66 6f72 6365 0a20 2020 2020 2020 2069  -force.        i
-0000aac0: 6620 2822 677a 2220 696e 2076 6673 2e66  f ("gz" in vfs.f
-0000aad0: 6c61 6773 206f 7220 2278 7a22 2069 6e20  lags or "xz" in 
-0000aae0: 7666 732e 666c 6167 7329 2061 6e64 2028  vfs.flags) and (
-0000aaf0: 0a20 2020 2020 2020 2020 2020 2022 706b  .            "pk
-0000ab00: 2220 696e 2076 6673 2e66 6c61 6773 0a20  " in vfs.flags. 
-0000ab10: 2020 2020 2020 2020 2020 206f 7220 2270             or "p
-0000ab20: 6b22 2069 6e20 7365 6c66 2e75 7061 7261  k" in self.upara
-0000ab30: 6d0a 2020 2020 2020 2020 2020 2020 6f72  m.            or
-0000ab40: 2022 677a 2220 696e 2073 656c 662e 7570   "gz" in self.up
-0000ab50: 6172 616d 0a20 2020 2020 2020 2020 2020  aram.           
-0000ab60: 206f 7220 2278 7a22 2069 6e20 7365 6c66   or "xz" in self
-0000ab70: 2e75 7061 7261 6d0a 2020 2020 2020 2020  .uparam.        
-0000ab80: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-0000ab90: 6220 3d20 7b22 677a 223a 2039 2c20 2278  b = {"gz": 9, "x
-0000aba0: 7a22 3a20 307d 2020 2320 6465 6661 756c  z": 0}  # defaul
-0000abb0: 742f 6661 6c6c 6261 636b 206c 6576 656c  t/fallback level
-0000abc0: 0a20 2020 2020 2020 2020 2020 206c 7620  .            lv 
-0000abd0: 3d20 7b7d 2020 2320 7365 6c65 6374 6564  = {}  # selected
-0000abe0: 206c 6576 656c 0a20 2020 2020 2020 2020   level.         
-0000abf0: 2020 2061 6c67 203d 2022 2220 2023 2073     alg = ""  # s
-0000ac00: 656c 6563 7465 6420 616c 676f 2028 677a  elected algo (gz
-0000ac10: 3d70 7265 6665 7272 6564 290a 0a20 2020  =preferred)..   
-0000ac20: 2020 2020 2020 2020 2023 2075 7365 722d           # user-
-0000ac30: 7072 6566 7320 6669 7273 740a 2020 2020  prefs first.    
-0000ac40: 2020 2020 2020 2020 6966 2022 677a 2220          if "gz" 
-0000ac50: 696e 2073 656c 662e 7570 6172 616d 206f  in self.uparam o
-0000ac60: 7220 2270 6b22 2069 6e20 7365 6c66 2e75  r "pk" in self.u
-0000ac70: 7061 7261 6d3a 2020 2320 6465 662e 706b  param:  # def.pk
-0000ac80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ac90: 2061 6c67 203d 2022 677a 220a 2020 2020   alg = "gz".    
-0000aca0: 2020 2020 2020 2020 6966 2022 787a 2220          if "xz" 
-0000acb0: 696e 2073 656c 662e 7570 6172 616d 3a0a  in self.uparam:.
-0000acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000acd0: 616c 6720 3d20 2278 7a22 0a20 2020 2020  alg = "xz".     
-0000ace0: 2020 2020 2020 2069 6620 616c 673a 0a20         if alg:. 
-0000acf0: 2020 2020 2020 2020 2020 2020 2020 207a                 z
-0000ad00: 736f 203d 2073 656c 662e 7570 6172 616d  so = self.uparam
-0000ad10: 2e67 6574 2861 6c67 290a 2020 2020 2020  .get(alg).      
-0000ad20: 2020 2020 2020 2020 2020 6c76 5b61 6c67            lv[alg
-0000ad30: 5d20 3d20 6662 5b61 6c67 5d20 6966 207a  ] = fb[alg] if z
-0000ad40: 736f 2069 7320 4e6f 6e65 2065 6c73 6520  so is None else 
-0000ad50: 696e 7428 7a73 6f29 0a0a 2020 2020 2020  int(zso)..      
-0000ad60: 2020 2020 2020 6966 2061 6c67 206e 6f74        if alg not
-0000ad70: 2069 6e20 7666 732e 666c 6167 733a 0a20   in vfs.flags:. 
-0000ad80: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000ad90: 6c67 203d 2022 677a 2220 6966 2022 677a  lg = "gz" if "gz
-0000ada0: 2220 696e 2076 6673 2e66 6c61 6773 2065  " in vfs.flags e
-0000adb0: 6c73 6520 2278 7a22 0a0a 2020 2020 2020  lse "xz"..      
-0000adc0: 2020 2020 2020 2320 7468 656e 2073 6572        # then ser
-0000add0: 7665 7220 6f76 6572 7269 6465 730a 2020  ver overrides.  
-0000ade0: 2020 2020 2020 2020 2020 706b 203d 2076            pk = v
-0000adf0: 6673 2e66 6c61 6773 2e67 6574 2822 706b  fs.flags.get("pk
-0000ae00: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
-0000ae10: 6620 706b 2069 7320 6e6f 7420 4e6f 6e65  f pk is not None
-0000ae20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ae30: 2020 2320 636f 6e66 6967 2d66 6f72 6365    # config-force
-0000ae40: 6420 6f6e 0a20 2020 2020 2020 2020 2020  d on.           
-0000ae50: 2020 2020 2061 6c67 203d 2061 6c67 206f       alg = alg o
-0000ae60: 7220 2267 7a22 2020 2320 6465 662e 706b  r "gz"  # def.pk
-0000ae70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ae80: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000ae90: 2020 2020 2020 2020 2020 2320 636f 6e66            # conf
-0000aea0: 6967 2d66 6f72 6365 6420 6f70 7473 0a20  ig-forced opts. 
-0000aeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aec0: 2020 2061 6c67 2c20 6e6c 7620 3d20 706b     alg, nlv = pk
-0000aed0: 2e73 706c 6974 2822 2c22 290a 2020 2020  .split(",").    
-0000aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aef0: 6c76 5b61 6c67 5d20 3d20 696e 7428 6e6c  lv[alg] = int(nl
-0000af00: 7629 0a20 2020 2020 2020 2020 2020 2020  v).             
-0000af10: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
-0000af20: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000af30: 6173 730a 0a20 2020 2020 2020 2020 2020  ass..           
-0000af40: 206c 765b 616c 675d 203d 206c 762e 6765   lv[alg] = lv.ge
-0000af50: 7428 616c 6729 206f 7220 6662 2e67 6574  t(alg) or fb.get
-0000af60: 2861 6c67 2920 6f72 2030 0a0a 2020 2020  (alg) or 0..    
-0000af70: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0000af80: 2822 636f 6d70 7265 7373 696e 6720 7769  ("compressing wi
-0000af90: 7468 207b 7d20 6c65 7665 6c20 7b7d 222e  th {} level {}".
-0000afa0: 666f 726d 6174 2861 6c67 2c20 6c76 2e67  format(alg, lv.g
-0000afb0: 6574 2861 6c67 2929 290a 2020 2020 2020  et(alg))).      
-0000afc0: 2020 2020 2020 6966 2061 6c67 203d 3d20        if alg == 
-0000afd0: 2267 7a22 3a0a 2020 2020 2020 2020 2020  "gz":.          
-0000afe0: 2020 2020 2020 6f70 656e 5f6b 615b 2266        open_ka["f
-0000aff0: 756e 225d 203d 2067 7a69 702e 477a 6970  un"] = gzip.Gzip
-0000b000: 4669 6c65 0a20 2020 2020 2020 2020 2020  File.           
-0000b010: 2020 2020 206f 7065 6e5f 6120 3d20 5b22       open_a = ["
-0000b020: 7762 222c 206c 765b 616c 675d 2c20 4e6f  wb", lv[alg], No
-0000b030: 6e65 2c20 3078 3546 4545 3636 3030 5d20  ne, 0x5FEE6600] 
-0000b040: 2023 2032 3032 312d 3031 2d30 310a 2020   # 2021-01-01.  
-0000b050: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
-0000b060: 6c67 203d 3d20 2278 7a22 3a0a 2020 2020  lg == "xz":.    
-0000b070: 2020 2020 2020 2020 2020 2020 6f70 656e              open
-0000b080: 5f6b 6120 3d20 7b22 6675 6e22 3a20 6c7a  _ka = {"fun": lz
-0000b090: 6d61 2e6f 7065 6e2c 2022 7072 6573 6574  ma.open, "preset
-0000b0a0: 223a 206c 765b 616c 675d 7d0a 2020 2020  ": lv[alg]}.    
-0000b0b0: 2020 2020 2020 2020 2020 2020 6f70 656e              open
-0000b0c0: 5f61 203d 205b 2277 6222 5d0a 2020 2020  _a = ["wb"].    
-0000b0d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000b0e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000b0f0: 6c66 2e6c 6f67 2822 6661 6c6c 7468 726f  lf.log("fallthro
-0000b100: 7567 683f 2074 6861 7473 2061 2062 7567  ugh? thats a bug
-0000b110: 222c 2031 290a 0a20 2020 2020 2020 2073  ", 1)..        s
-0000b120: 7566 6669 7820 3d20 222d 7b3a 2e36 667d  uffix = "-{:.6f}
-0000b130: 2d7b 7d22 2e66 6f72 6d61 7428 7469 6d65  -{}".format(time
-0000b140: 2e74 696d 6528 292c 2073 656c 662e 6469  .time(), self.di
-0000b150: 7028 2929 0a20 2020 2020 2020 206e 616d  p()).        nam
-0000b160: 656c 6573 7320 3d20 6e6f 7420 666e 0a20  eless = not fn. 
-0000b170: 2020 2020 2020 2069 6620 6e61 6d65 6c65         if namele
-0000b180: 7373 3a0a 2020 2020 2020 2020 2020 2020  ss:.            
-0000b190: 7375 6666 6978 202b 3d20 222e 6269 6e22  suffix += ".bin"
-0000b1a0: 0a20 2020 2020 2020 2020 2020 2066 6e20  .            fn 
-0000b1b0: 3d20 2270 7574 2220 2b20 7375 6666 6978  = "put" + suffix
-0000b1c0: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-0000b1d0: 203d 207b 2273 7566 6669 7822 3a20 7375   = {"suffix": su
-0000b1e0: 6666 6978 2c20 2266 6469 7222 3a20 6664  ffix, "fdir": fd
-0000b1f0: 6972 7d0a 2020 2020 2020 2020 6966 2073  ir}.        if s
-0000b200: 656c 662e 6172 6773 2e6e 773a 0a20 2020  elf.args.nw:.   
-0000b210: 2020 2020 2020 2020 2070 6172 616d 7320           params 
-0000b220: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-0000b230: 2066 6e20 3d20 6f73 2e64 6576 6e75 6c6c   fn = os.devnull
-0000b240: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-0000b250: 2e75 7064 6174 6528 6f70 656e 5f6b 6129  .update(open_ka)
-0000b260: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0000b270: 666e 0a0a 2020 2020 2020 2020 6966 206e  fn..        if n
-0000b280: 6f74 2073 656c 662e 6172 6773 2e6e 773a  ot self.args.nw:
-0000b290: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000b2a0: 726e 643a 0a20 2020 2020 2020 2020 2020  rnd:.           
-0000b2b0: 2020 2020 2066 6e20 3d20 7261 6e64 5f6e       fn = rand_n
-0000b2c0: 616d 6528 6664 6972 2c20 666e 2c20 726e  ame(fdir, fn, rn
-0000b2d0: 6429 0a0a 2020 2020 2020 2020 2020 2020  d)..            
-0000b2e0: 666e 203d 2073 616e 6974 697a 655f 666e  fn = sanitize_fn
-0000b2f0: 2866 6e20 6f72 2022 222c 2022 222c 205b  (fn or "", "", [
-0000b300: 222e 7072 6f6c 6f67 7565 2e68 746d 6c22  ".prologue.html"
-0000b310: 2c20 222e 6570 696c 6f67 7565 2e68 746d  , ".epilogue.htm
-0000b320: 6c22 5d29 0a0a 2020 2020 2020 2020 7061  l"])..        pa
-0000b330: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-0000b340: 6e28 6664 6972 2c20 666e 290a 0a20 2020  n(fdir, fn)..   
-0000b350: 2020 2020 2069 6620 7862 753a 0a20 2020       if xbu:.   
-0000b360: 2020 2020 2020 2020 2061 7420 3d20 7469           at = ti
-0000b370: 6d65 2e74 696d 6528 2920 2d20 6c69 6665  me.time() - life
-0000b380: 7469 6d65 0a20 2020 2020 2020 2020 2020  time.           
-0000b390: 2069 6620 6e6f 7420 7275 6e68 6f6f 6b28   if not runhook(
-0000b3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b3b0: 2073 656c 662e 6c6f 672c 0a20 2020 2020   self.log,.     
-0000b3c0: 2020 2020 2020 2020 2020 2078 6275 2c0a             xbu,.
-0000b3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3e0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-0000b3f0: 2020 2020 2020 7365 6c66 2e76 7061 7468        self.vpath
-0000b400: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b410: 2020 7365 6c66 2e68 6f73 742c 0a20 2020    self.host,.   
-0000b420: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000b430: 662e 756e 616d 652c 0a20 2020 2020 2020  f.uname,.       
-0000b440: 2020 2020 2020 2020 2061 742c 0a20 2020           at,.   
-0000b450: 2020 2020 2020 2020 2020 2020 2072 656d               rem
-0000b460: 6169 6e73 2c0a 2020 2020 2020 2020 2020  ains,.          
-0000b470: 2020 2020 2020 7365 6c66 2e69 702c 0a20        self.ip,. 
-0000b480: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000b490: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0000b4a0: 2020 2022 222c 0a20 2020 2020 2020 2020     "",.         
-0000b4b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-0000b4c0: 2020 2020 2020 7420 3d20 2275 706c 6f61        t = "uploa
-0000b4d0: 6420 626c 6f63 6b65 6420 6279 2078 6275  d blocked by xbu
-0000b4e0: 2073 6572 7665 7220 636f 6e66 6967 220a   server config".
-0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b500: 7365 6c66 2e6c 6f67 2874 2c20 3129 0a20  self.log(t, 1). 
-0000b510: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000b520: 6169 7365 2050 6562 6b61 6328 3430 332c  aise Pebkac(403,
-0000b530: 2074 290a 0a20 2020 2020 2020 2069 6620   t)..        if 
-0000b540: 6973 5f70 7574 2061 6e64 206e 6f74 2028  is_put and not (
-0000b550: 7365 6c66 2e61 7267 732e 6e6f 5f64 6176  self.args.no_dav
-0000b560: 206f 7220 7365 6c66 2e61 7267 732e 6e77   or self.args.nw
-0000b570: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0000b580: 2061 6c6c 6f77 206f 7665 7277 7269 7465   allow overwrite
-0000b590: 2069 662e 2e2e 0a20 2020 2020 2020 2020   if....         
-0000b5a0: 2020 2023 2020 2a20 766f 6c66 6c61 6720     #  * volflag 
-0000b5b0: 2764 6177 2720 6973 2073 6574 0a20 2020  'daw' is set.   
-0000b5c0: 2020 2020 2020 2020 2023 2020 2a20 616e           #  * an
-0000b5d0: 6420 6163 636f 756e 7420 6861 7320 6465  d account has de
-0000b5e0: 6c65 7465 2d61 6363 6573 730a 2020 2020  lete-access.    
-0000b5f0: 2020 2020 2020 2020 2320 6f72 2e2e 2e0a          # or....
-0000b600: 2020 2020 2020 2020 2020 2020 2320 202a              #  *
-0000b610: 2066 696c 6520 6578 6973 7473 2c20 6973   file exists, is
-0000b620: 2065 6d70 7479 2c20 7375 6666 6963 6965   empty, sufficie
-0000b630: 6e74 6c79 206e 6577 0a20 2020 2020 2020  ntly new.       
-0000b640: 2020 2020 2023 2020 2a20 616e 6420 7468       #  * and th
-0000b650: 6572 6520 6973 206e 6f20 2e50 4152 5449  ere is no .PARTI
-0000b660: 414c 0a0a 2020 2020 2020 2020 2020 2020  AL..            
-0000b670: 746e 616d 203d 2066 6e20 2b20 222e 5041  tnam = fn + ".PA
-0000b680: 5254 4941 4c22 0a20 2020 2020 2020 2020  RTIAL".         
-0000b690: 2020 2069 6620 7365 6c66 2e61 7267 732e     if self.args.
-0000b6a0: 646f 7470 6172 743a 0a20 2020 2020 2020  dotpart:.       
-0000b6b0: 2020 2020 2020 2020 2074 6e61 6d20 3d20           tnam = 
-0000b6c0: 222e 2220 2b20 746e 616d 0a0a 2020 2020  "." + tnam..    
-0000b6d0: 2020 2020 2020 2020 6966 2028 7666 732e          if (vfs.
-0000b6e0: 666c 6167 732e 6765 7428 2264 6177 2229  flags.get("daw")
-0000b6f0: 2061 6e64 2073 656c 662e 6361 6e5f 6465   and self.can_de
-0000b700: 6c65 7465 2920 6f72 2028 0a20 2020 2020  lete) or (.     
-0000b710: 2020 2020 2020 2020 2020 206e 6f74 2062             not b
-0000b720: 6f73 2e70 6174 682e 6578 6973 7473 286f  os.path.exists(o
-0000b730: 732e 7061 7468 2e6a 6f69 6e28 6664 6972  s.path.join(fdir
-0000b740: 2c20 746e 616d 2929 0a20 2020 2020 2020  , tnam)).       
-0000b750: 2020 2020 2020 2020 2061 6e64 2062 6f73           and bos
-0000b760: 2e70 6174 682e 6578 6973 7473 2870 6174  .path.exists(pat
-0000b770: 6829 0a20 2020 2020 2020 2020 2020 2020  h).             
-0000b780: 2020 2061 6e64 206e 6f74 2062 6f73 2e70     and not bos.p
-0000b790: 6174 682e 6765 7473 697a 6528 7061 7468  ath.getsize(path
-0000b7a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000b7b0: 2020 616e 6420 626f 732e 7061 7468 2e67    and bos.path.g
-0000b7c0: 6574 6d74 696d 6528 7061 7468 2920 3e3d  etmtime(path) >=
-0000b7d0: 2074 696d 652e 7469 6d65 2829 202d 2073   time.time() - s
-0000b7e0: 656c 662e 6172 6773 2e62 6c61 6e6b 5f77  elf.args.blank_w
-0000b7f0: 740a 2020 2020 2020 2020 2020 2020 293a  t.            ):
-0000b800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b810: 2023 2073 6d61 6c6c 2074 6f63 746f 752c   # small toctou,
-0000b820: 2062 7574 2062 6574 7465 7220 7468 616e   but better than
-0000b830: 2063 6c6f 6262 6572 696e 6720 6120 6861   clobbering a ha
-0000b840: 7264 6c69 6e6b 0a20 2020 2020 2020 2020  rdlink.         
-0000b850: 2020 2020 2020 2062 6f73 2e75 6e6c 696e         bos.unlin
-0000b860: 6b28 7061 7468 290a 0a20 2020 2020 2020  k(path)..       
-0000b870: 2077 6974 6820 7265 6e5f 6f70 656e 2866   with ren_open(f
-0000b880: 6e2c 202a 6f70 656e 5f61 2c20 2a2a 7061  n, *open_a, **pa
-0000b890: 7261 6d73 2920 6173 207a 6677 3a0a 2020  rams) as zfw:.  
-0000b8a0: 2020 2020 2020 2020 2020 662c 2066 6e20            f, fn 
-0000b8b0: 3d20 7a66 775b 226f 727a 225d 0a20 2020  = zfw["orz"].   
-0000b8c0: 2020 2020 2020 2020 2070 6174 6820 3d20           path = 
-0000b8d0: 6f73 2e70 6174 682e 6a6f 696e 2866 6469  os.path.join(fdi
-0000b8e0: 722c 2066 6e29 0a20 2020 2020 2020 2020  r, fn).         
-0000b8f0: 2020 2070 6f73 745f 737a 2c20 7368 615f     post_sz, sha_
-0000b900: 6865 782c 2073 6861 5f62 3634 203d 2068  hex, sha_b64 = h
-0000b910: 6173 6863 6f70 7928 7265 6164 6572 2c20  ashcopy(reader, 
-0000b920: 662c 2073 656c 662e 6172 6773 2e73 5f77  f, self.args.s_w
-0000b930: 725f 736c 7029 0a0a 2020 2020 2020 2020  r_slp)..        
-0000b940: 6966 206c 696d 3a0a 2020 2020 2020 2020  if lim:.        
-0000b950: 2020 2020 6c69 6d2e 6e75 7028 7365 6c66      lim.nup(self
-0000b960: 2e69 7029 0a20 2020 2020 2020 2020 2020  .ip).           
-0000b970: 206c 696d 2e62 7570 2873 656c 662e 6970   lim.bup(self.ip
-0000b980: 2c20 706f 7374 5f73 7a29 0a20 2020 2020  , post_sz).     
-0000b990: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000b9a0: 2020 2020 2020 2020 2020 2020 6c69 6d2e              lim.
-0000b9b0: 6368 6b5f 737a 2870 6f73 745f 737a 290a  chk_sz(post_sz).
-0000b9c0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000b9d0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-0000b9e0: 2020 2020 626f 732e 756e 6c69 6e6b 2870      bos.unlink(p
-0000b9f0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
-0000ba00: 2020 2020 2072 6169 7365 0a0a 2020 2020       raise..    
-0000ba10: 2020 2020 6966 2073 656c 662e 6172 6773      if self.args
-0000ba20: 2e6e 773a 0a20 2020 2020 2020 2020 2020  .nw:.           
-0000ba30: 2072 6574 7572 6e20 706f 7374 5f73 7a2c   return post_sz,
-0000ba40: 2073 6861 5f68 6578 2c20 7368 615f 6236   sha_hex, sha_b6
-0000ba50: 342c 2072 656d 6169 6e73 2c20 7061 7468  4, remains, path
-0000ba60: 2c20 2222 0a0a 2020 2020 2020 2020 6966  , ""..        if
-0000ba70: 206e 616d 656c 6573 7320 616e 6420 226d   nameless and "m
-0000ba80: 6167 6963 2220 696e 2076 6673 2e66 6c61  agic" in vfs.fla
-0000ba90: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-0000baa0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000bab0: 2020 2020 2065 7874 203d 2073 656c 662e       ext = self.
-0000bac0: 636f 6e6e 2e68 7372 762e 6d61 6769 6369  conn.hsrv.magici
-0000bad0: 616e 2e65 7874 2870 6174 6829 0a20 2020  an.ext(path).   
-0000bae0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0000baf0: 4578 6365 7074 696f 6e20 6173 2065 783a  Exception as ex:
-0000bb00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bb10: 2073 656c 662e 6c6f 6728 2266 696c 6574   self.log("filet
-0000bb20: 7970 6520 6465 7465 6374 696f 6e20 6661  ype detection fa
-0000bb30: 696c 6564 2066 6f72 205b 7b7d 5d3a 207b  iled for [{}]: {
-0000bb40: 7d22 2e66 6f72 6d61 7428 7061 7468 2c20  }".format(path, 
-0000bb50: 6578 292c 2036 290a 2020 2020 2020 2020  ex), 6).        
-0000bb60: 2020 2020 2020 2020 6578 7420 3d20 4e6f          ext = No
-0000bb70: 6e65 0a0a 2020 2020 2020 2020 2020 2020  ne..            
-0000bb80: 6966 2065 7874 3a0a 2020 2020 2020 2020  if ext:.        
-0000bb90: 2020 2020 2020 2020 6966 2072 6e64 3a0a          if rnd:.
-0000bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbb0: 2020 2020 666e 3220 3d20 7261 6e64 5f6e      fn2 = rand_n
-0000bbc0: 616d 6528 6664 6972 2c20 2261 2e22 202b  ame(fdir, "a." +
-0000bbd0: 2065 7874 2c20 726e 6429 0a20 2020 2020   ext, rnd).     
-0000bbe0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000bbf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bc00: 2020 2020 2066 6e32 203d 2066 6e2e 7273       fn2 = fn.rs
-0000bc10: 706c 6974 2822 2e22 2c20 3129 5b30 5d20  plit(".", 1)[0] 
-0000bc20: 2b20 222e 2220 2b20 6578 740a 0a20 2020  + "." + ext..   
-0000bc30: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0000bc40: 616d 735b 2273 7566 6669 7822 5d20 3d20  ams["suffix"] = 
-0000bc50: 7375 6666 6978 5b3a 2d34 5d0a 2020 2020  suffix[:-4].    
-0000bc60: 2020 2020 2020 2020 2020 2020 7769 7468              with
-0000bc70: 2072 656e 5f6f 7065 6e28 666e 2c20 2a6f   ren_open(fn, *o
-0000bc80: 7065 6e5f 612c 202a 2a70 6172 616d 7329  pen_a, **params)
-0000bc90: 2061 7320 7a66 773a 0a20 2020 2020 2020   as zfw:.       
-0000bca0: 2020 2020 2020 2020 2020 2020 2066 2c20               f, 
-0000bcb0: 666e 203d 207a 6677 5b22 6f72 7a22 5d0a  fn = zfw["orz"].
-0000bcc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bcd0: 2070 6174 6832 203d 206f 732e 7061 7468   path2 = os.path
-0000bce0: 2e6a 6f69 6e28 6664 6972 2c20 666e 3229  .join(fdir, fn2)
-0000bcf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000bd00: 2061 746f 6d69 635f 6d6f 7665 2870 6174   atomic_move(pat
-0000bd10: 682c 2070 6174 6832 290a 2020 2020 2020  h, path2).      
-0000bd20: 2020 2020 2020 2020 2020 666e 203d 2066            fn = f
-0000bd30: 6e32 0a20 2020 2020 2020 2020 2020 2020  n2.             
-0000bd40: 2020 2070 6174 6820 3d20 7061 7468 320a     path = path2.
-0000bd50: 0a20 2020 2020 2020 2061 7420 3d20 7469  .        at = ti
-0000bd60: 6d65 2e74 696d 6528 2920 2d20 6c69 6665  me.time() - life
-0000bd70: 7469 6d65 0a20 2020 2020 2020 2069 6620  time.        if 
-0000bd80: 7861 7520 616e 6420 6e6f 7420 7275 6e68  xau and not runh
-0000bd90: 6f6f 6b28 0a20 2020 2020 2020 2020 2020  ook(.           
-0000bda0: 2073 656c 662e 6c6f 672c 0a20 2020 2020   self.log,.     
-0000bdb0: 2020 2020 2020 2078 6175 2c0a 2020 2020         xau,.    
-0000bdc0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-0000bdd0: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
-0000bde0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
-0000bdf0: 2020 7365 6c66 2e68 6f73 742c 0a20 2020    self.host,.   
-0000be00: 2020 2020 2020 2020 2073 656c 662e 756e           self.un
-0000be10: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0000be20: 2061 742c 0a20 2020 2020 2020 2020 2020   at,.           
-0000be30: 2070 6f73 745f 737a 2c0a 2020 2020 2020   post_sz,.      
-0000be40: 2020 2020 2020 7365 6c66 2e69 702c 0a20        self.ip,. 
-0000be50: 2020 2020 2020 2020 2020 2061 742c 0a20             at,. 
-0000be60: 2020 2020 2020 2020 2020 2022 222c 0a20             "",. 
-0000be70: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0000be80: 2020 2020 2020 7420 3d20 2275 706c 6f61        t = "uploa
-0000be90: 6420 626c 6f63 6b65 6420 6279 2078 6175  d blocked by xau
-0000bea0: 2073 6572 7665 7220 636f 6e66 6967 220a   server config".
-0000beb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000bec0: 2e6c 6f67 2874 2c20 3129 0a20 2020 2020  .log(t, 1).     
-0000bed0: 2020 2020 2020 206f 732e 756e 6c69 6e6b         os.unlink
-0000bee0: 2870 6174 6829 0a20 2020 2020 2020 2020  (path).         
-0000bef0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
-0000bf00: 3430 332c 2074 290a 0a20 2020 2020 2020  403, t)..       
-0000bf10: 2076 6673 2c20 7265 6d20 3d20 7666 732e   vfs, rem = vfs.
-0000bf20: 6765 745f 6462 7628 7265 6d29 0a20 2020  get_dbv(rem).   
-0000bf30: 2020 2020 2073 656c 662e 636f 6e6e 2e68       self.conn.h
-0000bf40: 7372 762e 6272 6f6b 6572 2e73 6179 280a  srv.broker.say(.
-0000bf50: 2020 2020 2020 2020 2020 2020 2275 7032              "up2
-0000bf60: 6b2e 6861 7368 5f66 696c 6522 2c0a 2020  k.hash_file",.  
-0000bf70: 2020 2020 2020 2020 2020 7666 732e 7265            vfs.re
-0000bf80: 616c 7061 7468 2c0a 2020 2020 2020 2020  alpath,.        
-0000bf90: 2020 2020 7666 732e 7670 6174 682c 0a20      vfs.vpath,. 
-0000bfa0: 2020 2020 2020 2020 2020 2076 6673 2e66             vfs.f
-0000bfb0: 6c61 6773 2c0a 2020 2020 2020 2020 2020  lags,.          
-0000bfc0: 2020 7265 6d2c 0a20 2020 2020 2020 2020    rem,.         
-0000bfd0: 2020 2066 6e2c 0a20 2020 2020 2020 2020     fn,.         
-0000bfe0: 2020 2073 656c 662e 6970 2c0a 2020 2020     self.ip,.    
-0000bff0: 2020 2020 2020 2020 6174 2c0a 2020 2020          at,.    
-0000c000: 2020 2020 2020 2020 7365 6c66 2e75 6e61          self.una
-0000c010: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-0000c020: 5472 7565 2c0a 2020 2020 2020 2020 290a  True,.        ).
-0000c030: 0a20 2020 2020 2020 2076 7375 6620 3d20  .        vsuf = 
-0000c040: 2222 0a20 2020 2020 2020 2069 6620 2873  "".        if (s
-0000c050: 656c 662e 6361 6e5f 7265 6164 206f 7220  elf.can_read or 
-0000c060: 7365 6c66 2e63 616e 5f75 7067 6574 2920  self.can_upget) 
-0000c070: 616e 6420 2266 6b22 2069 6e20 7666 732e  and "fk" in vfs.
-0000c080: 666c 6167 733a 0a20 2020 2020 2020 2020  flags:.         
-0000c090: 2020 2076 7375 6620 3d20 223f 6b3d 2220     vsuf = "?k=" 
-0000c0a0: 2b20 7365 6c66 2e67 656e 5f66 6b28 0a20  + self.gen_fk(. 
-0000c0b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000c0c0: 656c 662e 6172 6773 2e66 6b5f 7361 6c74  elf.args.fk_salt
-0000c0d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c0e0: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
-0000c0f0: 2020 2020 2020 2020 706f 7374 5f73 7a2c          post_sz,
-0000c100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c110: 2030 2069 6620 414e 5957 494e 2065 6c73   0 if ANYWIN els
-0000c120: 6520 626f 732e 7374 6174 2870 6174 6829  e bos.stat(path)
-0000c130: 2e73 745f 696e 6f2c 0a20 2020 2020 2020  .st_ino,.       
-0000c140: 2020 2020 2029 5b3a 2076 6673 2e66 6c61       )[: vfs.fla
-0000c150: 6773 5b22 666b 225d 5d0a 0a20 2020 2020  gs["fk"]]..     
-0000c160: 2020 2076 7061 7468 203d 2022 2f22 2e6a     vpath = "/".j
-0000c170: 6f69 6e28 5b78 2066 6f72 2078 2069 6e20  oin([x for x in 
-0000c180: 5b76 6673 2e76 7061 7468 2c20 7265 6d2c  [vfs.vpath, rem,
-0000c190: 2066 6e5d 2069 6620 785d 290a 2020 2020   fn] if x]).    
-0000c1a0: 2020 2020 7670 6174 6820 3d20 7175 6f74      vpath = quot
-0000c1b0: 6570 2876 7061 7468 290a 0a20 2020 2020  ep(vpath)..     
-0000c1c0: 2020 2075 726c 203d 2022 7b7d 3a2f 2f7b     url = "{}://{
-0000c1d0: 7d2f 7b7d 222e 666f 726d 6174 280a 2020  }/{}".format(.  
-0000c1e0: 2020 2020 2020 2020 2020 2268 7474 7073            "https
-0000c1f0: 2220 6966 2073 656c 662e 6973 5f68 7474  " if self.is_htt
-0000c200: 7073 2065 6c73 6520 2268 7474 7022 2c0a  ps else "http",.
-0000c210: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000c220: 2e68 6f73 742c 0a20 2020 2020 2020 2020  .host,.         
-0000c230: 2020 2073 656c 662e 6172 6773 2e52 5320     self.args.RS 
-0000c240: 2b20 7670 6174 6820 2b20 7673 7566 2c0a  + vpath + vsuf,.
-0000c250: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0000c260: 2020 2072 6574 7572 6e20 706f 7374 5f73     return post_s
-0000c270: 7a2c 2073 6861 5f68 6578 2c20 7368 615f  z, sha_hex, sha_
-0000c280: 6236 342c 2072 656d 6169 6e73 2c20 7061  b64, remains, pa
-0000c290: 7468 2c20 7572 6c0a 0a20 2020 2064 6566  th, url..    def
-0000c2a0: 2068 616e 646c 655f 7374 6173 6828 7365   handle_stash(se
-0000c2b0: 6c66 2c20 6973 5f70 7574 2029 2020 3a0a  lf, is_put )  :.
-0000c2c0: 2020 2020 2020 2020 706f 7374 5f73 7a2c          post_sz,
-0000c2d0: 2073 6861 5f68 6578 2c20 7368 615f 6236   sha_hex, sha_b6
-0000c2e0: 342c 2072 656d 6169 6e73 2c20 7061 7468  4, remains, path
-0000c2f0: 2c20 7572 6c20 3d20 7365 6c66 2e64 756d  , url = self.dum
-0000c300: 705f 746f 5f66 696c 6528 6973 5f70 7574  p_to_file(is_put
-0000c310: 290a 2020 2020 2020 2020 7370 6420 3d20  ).        spd = 
-0000c320: 7365 6c66 2e5f 7370 6428 706f 7374 5f73  self._spd(post_s
-0000c330: 7a29 0a20 2020 2020 2020 2074 203d 2022  z).        t = "
-0000c340: 7b7d 2077 726f 7465 207b 7d2f 7b7d 2062  {} wrote {}/{} b
-0000c350: 7974 6573 2074 6f20 7b7d 2020 2320 7b7d  ytes to {}  # {}
-0000c360: 220a 2020 2020 2020 2020 7365 6c66 2e6c  ".        self.l
-0000c370: 6f67 2874 2e66 6f72 6d61 7428 7370 642c  og(t.format(spd,
-0000c380: 2070 6f73 745f 737a 2c20 7265 6d61 696e   post_sz, remain
-0000c390: 732c 2070 6174 682c 2073 6861 5f62 3634  s, path, sha_b64
-0000c3a0: 5b3a 3238 5d29 2920 2023 2032 310a 0a20  [:28]))  # 21.. 
-0000c3b0: 2020 2020 2020 2061 6320 3d20 7365 6c66         ac = self
-0000c3c0: 2e75 7061 7261 6d2e 6765 7428 0a20 2020  .uparam.get(.   
-0000c3d0: 2020 2020 2020 2020 2022 7761 6e74 222c           "want",
-0000c3e0: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
-0000c3f0: 7428 2261 6363 6570 7422 2c20 2222 292e  t("accept", "").
-0000c400: 6c6f 7765 7228 292e 7370 6c69 7428 223b  lower().split(";
-0000c410: 2229 5b2d 315d 0a20 2020 2020 2020 2029  ")[-1].        )
-0000c420: 0a20 2020 2020 2020 2069 6620 6163 203d  .        if ac =
-0000c430: 3d20 2275 726c 223a 0a20 2020 2020 2020  = "url":.       
-0000c440: 2020 2020 2074 203d 2075 726c 0a20 2020       t = url.   
-0000c450: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000c460: 2020 2020 2020 2074 203d 2022 7b7d 5c6e         t = "{}\n
-0000c470: 7b7d 5c6e 7b7d 5c6e 7b7d 5c6e 222e 666f  {}\n{}\n{}\n".fo
-0000c480: 726d 6174 2870 6f73 745f 737a 2c20 7368  rmat(post_sz, sh
-0000c490: 615f 6236 342c 2073 6861 5f68 6578 5b3a  a_b64, sha_hex[:
-0000c4a0: 3536 5d2c 2075 726c 290a 0a20 2020 2020  56], url)..     
-0000c4b0: 2020 2068 203d 207b 224c 6f63 6174 696f     h = {"Locatio
-0000c4c0: 6e22 3a20 7572 6c7d 2069 6620 6973 5f70  n": url} if is_p
-0000c4d0: 7574 2061 6e64 2075 726c 2065 6c73 6520  ut and url else 
-0000c4e0: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
-0000c4f0: 7265 706c 7928 742e 656e 636f 6465 2822  reply(t.encode("
-0000c500: 7574 662d 3822 292c 2032 3031 2c20 6865  utf-8"), 201, he
-0000c510: 6164 6572 733d 6829 0a20 2020 2020 2020  aders=h).       
-0000c520: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-0000c530: 2020 6465 6620 6261 6b66 6c69 7028 7365    def bakflip(se
-0000c540: 6c66 2c20 6620 2c20 6f66 7320 2c20 737a  lf, f , ofs , sz
-0000c550: 202c 2073 6861 2029 2020 3a0a 2020 2020   , sha )  :.    
-0000c560: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-0000c570: 6172 6773 2e62 616b 5f66 6c69 7073 206f  args.bak_flips o
-0000c580: 7220 7365 6c66 2e61 7267 732e 6e77 3a0a  r self.args.nw:.
-0000c590: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000c5a0: 726e 0a0a 2020 2020 2020 2020 7364 6972  rn..        sdir
-0000c5b0: 203d 2073 656c 662e 6172 6773 2e62 665f   = self.args.bf_
-0000c5c0: 6469 720a 2020 2020 2020 2020 6670 203d  dir.        fp =
-0000c5d0: 206f 732e 7061 7468 2e6a 6f69 6e28 7364   os.path.join(sd
-0000c5e0: 6972 2c20 7368 6129 0a20 2020 2020 2020  ir, sha).       
-0000c5f0: 2069 6620 626f 732e 7061 7468 2e65 7869   if bos.path.exi
-0000c600: 7374 7328 6670 293a 0a20 2020 2020 2020  sts(fp):.       
-0000c610: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000c620: 2e6c 6f67 2822 6e6f 2062 616b 666c 6970  .log("no bakflip
-0000c630: 3b20 6861 7665 2069 7422 2c20 3629 0a0a  ; have it", 6)..
-0000c640: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
-0000c650: 6f73 2e70 6174 682e 6973 6469 7228 7364  os.path.isdir(sd
-0000c660: 6972 293a 0a20 2020 2020 2020 2020 2020  ir):.           
-0000c670: 2062 6f73 2e6d 616b 6564 6972 7328 7364   bos.makedirs(sd
-0000c680: 6972 290a 0a20 2020 2020 2020 2069 6620  ir)..        if 
-0000c690: 6c65 6e28 626f 732e 6c69 7374 6469 7228  len(bos.listdir(
-0000c6a0: 7364 6972 2929 203e 3d20 7365 6c66 2e61  sdir)) >= self.a
-0000c6b0: 7267 732e 6266 5f6e 633a 0a20 2020 2020  rgs.bf_nc:.     
-0000c6c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000c6d0: 6c66 2e6c 6f67 2822 6e6f 2062 616b 666c  lf.log("no bakfl
-0000c6e0: 6970 3b20 746f 6f20 6d61 6e79 222c 2033  ip; too many", 3
-0000c6f0: 290a 0a20 2020 2020 2020 206e 7265 6d20  )..        nrem 
-0000c700: 3d20 737a 0a20 2020 2020 2020 2066 2e73  = sz.        f.s
-0000c710: 6565 6b28 6f66 7329 0a20 2020 2020 2020  eek(ofs).       
-0000c720: 2077 6974 6820 6f70 656e 2866 702c 2022   with open(fp, "
-0000c730: 7762 2229 2061 7320 666f 3a0a 2020 2020  wb") as fo:.    
-0000c740: 2020 2020 2020 2020 7768 696c 6520 6e72          while nr
-0000c750: 656d 3a0a 2020 2020 2020 2020 2020 2020  em:.            
-0000c760: 2020 2020 6275 6620 3d20 662e 7265 6164      buf = f.read
-0000c770: 286d 696e 286e 7265 6d2c 2035 3132 202a  (min(nrem, 512 *
-0000c780: 2031 3032 3429 290a 2020 2020 2020 2020   1024)).        
-0000c790: 2020 2020 2020 2020 6966 206e 6f74 2062          if not b
-0000c7a0: 7566 3a0a 2020 2020 2020 2020 2020 2020  uf:.            
-0000c7b0: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000c7d0: 7265 6d20 2d3d 206c 656e 2862 7566 290a  rem -= len(buf).
-0000c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7f0: 666f 2e77 7269 7465 2862 7566 290a 0a20  fo.write(buf).. 
-0000c800: 2020 2020 2020 2069 6620 6e72 656d 3a0a         if nrem:.
-0000c810: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000c820: 2e6c 6f67 2822 6261 6b66 6c69 7020 7472  .log("bakflip tr
-0000c830: 756e 6361 7465 643b 207b 7d20 7265 6d61  uncated; {} rema
-0000c840: 696e 7322 2e66 6f72 6d61 7428 6e72 656d  ins".format(nrem
-0000c850: 292c 2031 290a 2020 2020 2020 2020 2020  ), 1).          
-0000c860: 2020 6174 6f6d 6963 5f6d 6f76 6528 6670    atomic_move(fp
-0000c870: 2c20 6670 202b 2022 2e74 7275 6e63 2229  , fp + ".trunc")
-0000c880: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000c890: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c8a0: 6c6f 6728 2262 616b 666c 6970 206f 6b22  log("bakflip ok"
-0000c8b0: 2c20 3229 0a0a 2020 2020 6465 6620 5f73  , 2)..    def _s
-0000c8c0: 7064 2873 656c 662c 206e 6279 7465 7320  pd(self, nbytes 
-0000c8d0: 2c20 6164 6420 203d 2054 7275 6529 2020  , add  = True)  
-0000c8e0: 3a0a 2020 2020 2020 2020 6966 2061 6464  :.        if add
-0000c8f0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000c900: 6c66 2e63 6f6e 6e2e 6e62 7974 6520 2b3d  lf.conn.nbyte +=
-0000c910: 206e 6279 7465 730a 0a20 2020 2020 2020   nbytes..       
-0000c920: 2073 7064 3120 3d20 6765 745f 7370 6428   spd1 = get_spd(
-0000c930: 6e62 7974 6573 2c20 7365 6c66 2e74 3029  nbytes, self.t0)
-0000c940: 0a20 2020 2020 2020 2073 7064 3220 3d20  .        spd2 = 
-0000c950: 6765 745f 7370 6428 7365 6c66 2e63 6f6e  get_spd(self.con
-0000c960: 6e2e 6e62 7974 652c 2073 656c 662e 636f  n.nbyte, self.co
-0000c970: 6e6e 2e74 3029 0a20 2020 2020 2020 2072  nn.t0).        r
-0000c980: 6574 7572 6e20 227b 7d20 7b7d 206e 7b7d  eturn "{} {} n{}
-0000c990: 222e 666f 726d 6174 2873 7064 312c 2073  ".format(spd1, s
-0000c9a0: 7064 322c 2073 656c 662e 636f 6e6e 2e6e  pd2, self.conn.n
-0000c9b0: 7265 7129 0a0a 2020 2020 6465 6620 6861  req)..    def ha
-0000c9c0: 6e64 6c65 5f70 6f73 745f 6d75 6c74 6970  ndle_post_multip
-0000c9d0: 6172 7428 7365 6c66 2920 203a 0a20 2020  art(self)  :.   
-0000c9e0: 2020 2020 2073 656c 662e 7061 7273 6572       self.parser
-0000c9f0: 203d 204d 756c 7469 7061 7274 5061 7273   = MultipartPars
-0000ca00: 6572 2873 656c 662e 6c6f 672c 2073 656c  er(self.log, sel
-0000ca10: 662e 7372 2c20 7365 6c66 2e68 6561 6465  f.sr, self.heade
-0000ca20: 7273 290a 2020 2020 2020 2020 7365 6c66  rs).        self
-0000ca30: 2e70 6172 7365 722e 7061 7273 6528 290a  .parser.parse().
-0000ca40: 0a20 2020 2020 2020 2061 6374 203d 2073  .        act = s
-0000ca50: 656c 662e 7061 7273 6572 2e72 6571 7569  elf.parser.requi
-0000ca60: 7265 2822 6163 7422 2c20 3634 290a 0a20  re("act", 64).. 
-0000ca70: 2020 2020 2020 2069 6620 6163 7420 3d3d         if act ==
-0000ca80: 2022 6c6f 6769 6e22 3a0a 2020 2020 2020   "login":.      
-0000ca90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000caa0: 662e 6861 6e64 6c65 5f6c 6f67 696e 2829  f.handle_login()
-0000cab0: 0a0a 2020 2020 2020 2020 6966 2061 6374  ..        if act
-0000cac0: 203d 3d20 226d 6b64 6972 223a 0a20 2020   == "mkdir":.   
-0000cad0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000cae0: 7365 6c66 2e68 616e 646c 655f 6d6b 6469  self.handle_mkdi
-0000caf0: 7228 290a 0a20 2020 2020 2020 2069 6620  r()..        if 
-0000cb00: 6163 7420 3d3d 2022 6e65 775f 6d64 223a  act == "new_md":
-0000cb10: 0a20 2020 2020 2020 2020 2020 2023 206b  .            # k
-0000cb20: 696e 6461 2073 696c 6c79 2062 7574 2068  inda silly but h
-0000cb30: 6173 2074 6865 206c 6561 7374 2073 6964  as the least sid
-0000cb40: 6520 6566 6665 6374 730a 2020 2020 2020  e effects.      
-0000cb50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000cb60: 662e 6861 6e64 6c65 5f6e 6577 5f6d 6428  f.handle_new_md(
-0000cb70: 290a 0a20 2020 2020 2020 2069 6620 6163  )..        if ac
-0000cb80: 7420 3d3d 2022 6270 7574 223a 0a20 2020  t == "bput":.   
-0000cb90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000cba0: 7365 6c66 2e68 616e 646c 655f 706c 6169  self.handle_plai
-0000cbb0: 6e5f 7570 6c6f 6164 2829 0a0a 2020 2020  n_upload()..    
-0000cbc0: 2020 2020 6966 2061 6374 203d 3d20 2274      if act == "t
-0000cbd0: 7075 7422 3a0a 2020 2020 2020 2020 2020  put":.          
-0000cbe0: 2020 7265 7475 726e 2073 656c 662e 6861    return self.ha
-0000cbf0: 6e64 6c65 5f74 6578 745f 7570 6c6f 6164  ndle_text_upload
-0000cc00: 2829 0a0a 2020 2020 2020 2020 6966 2061  ()..        if a
-0000cc10: 6374 203d 3d20 227a 6970 223a 0a20 2020  ct == "zip":.   
-0000cc20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000cc30: 7365 6c66 2e68 616e 646c 655f 7a69 705f  self.handle_zip_
-0000cc40: 706f 7374 2829 0a0a 2020 2020 2020 2020  post()..        
-0000cc50: 7261 6973 6520 5065 626b 6163 2834 3232  raise Pebkac(422
-0000cc60: 2c20 2769 6e76 616c 6964 2061 6374 696f  , 'invalid actio
-0000cc70: 6e20 227b 7d22 272e 666f 726d 6174 2861  n "{}"'.format(a
-0000cc80: 6374 2929 0a0a 2020 2020 6465 6620 6861  ct))..    def ha
-0000cc90: 6e64 6c65 5f7a 6970 5f70 6f73 7428 7365  ndle_zip_post(se
-0000cca0: 6c66 2920 203a 0a20 2020 2020 2020 2061  lf)  :.        a
-0000ccb0: 7373 6572 7420 7365 6c66 2e70 6172 7365  ssert self.parse
-0000ccc0: 720a 2020 2020 2020 2020 7472 793a 0a20  r.        try:. 
-0000ccd0: 2020 2020 2020 2020 2020 206b 203d 206e             k = n
-0000cce0: 6578 7428 7820 666f 7220 7820 696e 2073  ext(x for x in s
-0000ccf0: 656c 662e 7570 6172 616d 2069 6620 7820  elf.uparam if x 
-0000cd00: 696e 2028 227a 6970 222c 2022 7461 7222  in ("zip", "tar"
-0000cd10: 2929 0a20 2020 2020 2020 2065 7863 6570  )).        excep
-0000cd20: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-0000cd30: 6169 7365 2050 6562 6b61 6328 3432 322c  aise Pebkac(422,
-0000cd40: 2022 6e65 6564 207a 6970 206f 7220 7461   "need zip or ta
-0000cd50: 7220 6b65 7977 6f72 6422 290a 0a20 2020  r keyword")..   
-0000cd60: 2020 2020 2076 203d 2073 656c 662e 7570       v = self.up
-0000cd70: 6172 616d 5b6b 5d0a 0a20 2020 2020 2020  aram[k]..       
-0000cd80: 2076 6e2c 2072 656d 203d 2073 656c 662e   vn, rem = self.
-0000cd90: 6173 7276 2e76 6673 2e67 6574 2873 656c  asrv.vfs.get(sel
-0000cda0: 662e 7670 6174 682c 2073 656c 662e 756e  f.vpath, self.un
-0000cdb0: 616d 652c 2054 7275 652c 2046 616c 7365  ame, True, False
-0000cdc0: 290a 2020 2020 2020 2020 7a73 203d 2073  ).        zs = s
-0000cdd0: 656c 662e 7061 7273 6572 2e72 6571 7569  elf.parser.requi
-0000cde0: 7265 2822 6669 6c65 7322 2c20 3130 3234  re("files", 1024
-0000cdf0: 202a 2031 3032 3429 0a20 2020 2020 2020   * 1024).       
-0000ce00: 2069 6620 6e6f 7420 7a73 3a0a 2020 2020   if not zs:.    
-0000ce10: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-0000ce20: 626b 6163 2834 3232 2c20 226e 6565 6420  bkac(422, "need 
-0000ce30: 6669 6c65 7320 6c69 7374 2229 0a0a 2020  files list")..  
-0000ce40: 2020 2020 2020 6974 656d 7320 3d20 7a73        items = zs
-0000ce50: 2e72 6570 6c61 6365 2822 5c72 222c 2022  .replace("\r", "
-0000ce60: 2229 2e73 706c 6974 2822 5c6e 2229 0a20  ").split("\n"). 
-0000ce70: 2020 2020 2020 2069 7465 6d73 203d 205b         items = [
-0000ce80: 756e 7175 6f74 6570 2878 2920 666f 7220  unquotep(x) for 
-0000ce90: 7820 696e 2069 7465 6d73 2069 6620 6974  x in items if it
-0000cea0: 656d 735d 0a0a 2020 2020 2020 2020 7365  ems]..        se
-0000ceb0: 6c66 2e70 6172 7365 722e 6472 6f70 2829  lf.parser.drop()
-0000cec0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000ced0: 7365 6c66 2e74 785f 7a69 7028 6b2c 2076  self.tx_zip(k, v
-0000cee0: 2c20 766e 2c20 7265 6d2c 2069 7465 6d73  , vn, rem, items
-0000cef0: 2c20 7365 6c66 2e61 7267 732e 6564 290a  , self.args.ed).
-0000cf00: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
-0000cf10: 706f 7374 5f6a 736f 6e28 7365 6c66 2920  post_json(self) 
-0000cf20: 203a 0a20 2020 2020 2020 2074 7279 3a0a   :.        try:.
-0000cf30: 2020 2020 2020 2020 2020 2020 7265 6d61              rema
-0000cf40: 696e 7320 3d20 696e 7428 7365 6c66 2e68  ins = int(self.h
-0000cf50: 6561 6465 7273 5b22 636f 6e74 656e 742d  eaders["content-
-0000cf60: 6c65 6e67 7468 225d 290a 2020 2020 2020  length"]).      
-0000cf70: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-0000cf80: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
-0000cf90: 6163 2834 3131 290a 0a20 2020 2020 2020  ac(411)..       
-0000cfa0: 2069 6620 7265 6d61 696e 7320 3e20 3130   if remains > 10
-0000cfb0: 3234 202a 2031 3032 343a 0a20 2020 2020  24 * 1024:.     
-0000cfc0: 2020 2020 2020 2072 6169 7365 2050 6562         raise Peb
-0000cfd0: 6b61 6328 3431 332c 2022 6a73 6f6e 2032  kac(413, "json 2
-0000cfe0: 6269 6722 290a 0a20 2020 2020 2020 2065  big")..        e
-0000cff0: 6e63 203d 2022 7574 662d 3822 0a20 2020  nc = "utf-8".   
-0000d000: 2020 2020 2063 7479 7065 203d 2073 656c       ctype = sel
-0000d010: 662e 6865 6164 6572 732e 6765 7428 2263  f.headers.get("c
-0000d020: 6f6e 7465 6e74 2d74 7970 6522 2c20 2222  ontent-type", ""
-0000d030: 292e 6c6f 7765 7228 290a 2020 2020 2020  ).lower().      
-0000d040: 2020 6966 2022 6368 6172 7365 7422 2069    if "charset" i
-0000d050: 6e20 6374 7970 653a 0a20 2020 2020 2020  n ctype:.       
-0000d060: 2020 2020 2065 6e63 203d 2063 7479 7065       enc = ctype
-0000d070: 2e73 706c 6974 2822 6368 6172 7365 7422  .split("charset"
-0000d080: 295b 315d 2e73 7472 6970 2822 203d 2229  )[1].strip(" =")
-0000d090: 2e73 706c 6974 2822 3b22 295b 305d 2e73  .split(";")[0].s
-0000d0a0: 7472 6970 2829 0a0a 2020 2020 2020 2020  trip()..        
-0000d0b0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000d0c0: 206a 736f 6e5f 6275 6620 3d20 7365 6c66   json_buf = self
-0000d0d0: 2e73 722e 7265 6376 5f65 7828 7265 6d61  .sr.recv_ex(rema
-0000d0e0: 696e 7329 0a20 2020 2020 2020 2065 7863  ins).        exc
-0000d0f0: 6570 7420 556e 7265 6376 454f 463a 0a20  ept UnrecvEOF:. 
-0000d100: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000d110: 2050 6562 6b61 6328 3432 322c 2022 636c   Pebkac(422, "cl
-0000d120: 6965 6e74 2064 6973 636f 6e6e 6563 7465  ient disconnecte
-0000d130: 6420 7768 696c 6520 706f 7374 696e 6720  d while posting 
-0000d140: 4a53 4f4e 2229 0a0a 2020 2020 2020 2020  JSON")..        
-0000d150: 7365 6c66 2e6c 6f67 2822 6465 636f 6469  self.log("decodi
-0000d160: 6e67 207b 7d20 6279 7465 7320 6f66 207b  ng {} bytes of {
-0000d170: 7d20 6a73 6f6e 222e 666f 726d 6174 286c  } json".format(l
-0000d180: 656e 286a 736f 6e5f 6275 6629 2c20 656e  en(json_buf), en
-0000d190: 6329 290a 2020 2020 2020 2020 7472 793a  c)).        try:
-0000d1a0: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
-0000d1b0: 7920 3d20 6a73 6f6e 2e6c 6f61 6473 286a  y = json.loads(j
-0000d1c0: 736f 6e5f 6275 662e 6465 636f 6465 2865  son_buf.decode(e
-0000d1d0: 6e63 2c20 2272 6570 6c61 6365 2229 290a  nc, "replace")).
-0000d1e0: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
-0000d1f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d200: 6520 5065 626b 6163 2834 3232 2c20 2279  e Pebkac(422, "y
-0000d210: 6f75 2050 4f53 5465 6420 696e 7661 6c69  ou POSTed invali
-0000d220: 6420 6a73 6f6e 2229 0a0a 2020 2020 2020  d json")..      
-0000d230: 2020 2320 7365 6c66 2e72 6570 6c79 2862    # self.reply(b
-0000d240: 2263 6c6f 7564 666c 6172 6522 2c20 3530  "cloudflare", 50
-0000d250: 3329 0a20 2020 2020 2020 2023 2072 6574  3).        # ret
-0000d260: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
-0000d270: 2020 6966 2022 7372 6368 2220 696e 2073    if "srch" in s
-0000d280: 656c 662e 7570 6172 616d 206f 7220 2273  elf.uparam or "s
-0000d290: 7263 6822 2069 6e20 626f 6479 3a0a 2020  rch" in body:.  
-0000d2a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000d2b0: 2073 656c 662e 6861 6e64 6c65 5f73 6561   self.handle_sea
-0000d2c0: 7263 6828 626f 6479 290a 0a20 2020 2020  rch(body)..     
-0000d2d0: 2020 2069 6620 2264 656c 6574 6522 2069     if "delete" i
-0000d2e0: 6e20 7365 6c66 2e75 7061 7261 6d3a 0a20  n self.uparam:. 
-0000d2f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000d300: 6e20 7365 6c66 2e68 616e 646c 655f 726d  n self.handle_rm
-0000d310: 2862 6f64 7929 0a0a 2020 2020 2020 2020  (body)..        
-0000d320: 6e61 6d65 203d 2075 6e64 6f74 2862 6f64  name = undot(bod
-0000d330: 795b 226e 616d 6522 5d29 0a20 2020 2020  y["name"]).     
-0000d340: 2020 2069 6620 222f 2220 696e 206e 616d     if "/" in nam
-0000d350: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000d360: 6169 7365 2050 6562 6b61 6328 3430 302c  aise Pebkac(400,
-0000d370: 2022 796f 7572 2063 6c69 656e 7420 6973   "your client is
-0000d380: 206f 6c64 3b20 7072 6573 7320 4354 524c   old; press CTRL
-0000d390: 2d53 4849 4654 2d52 2061 6e64 2074 7279  -SHIFT-R and try
-0000d3a0: 2061 6761 696e 2229 0a0a 2020 2020 2020   again")..      
-0000d3b0: 2020 7666 732c 2072 656d 203d 2073 656c    vfs, rem = sel
-0000d3c0: 662e 6173 7276 2e76 6673 2e67 6574 2873  f.asrv.vfs.get(s
-0000d3d0: 656c 662e 7670 6174 682c 2073 656c 662e  elf.vpath, self.
-0000d3e0: 756e 616d 652c 2046 616c 7365 2c20 5472  uname, False, Tr
-0000d3f0: 7565 290a 2020 2020 2020 2020 6462 762c  ue).        dbv,
-0000d400: 2076 7265 6d20 3d20 7666 732e 6765 745f   vrem = vfs.get_
-0000d410: 6462 7628 7265 6d29 0a0a 2020 2020 2020  dbv(rem)..      
-0000d420: 2020 626f 6479 5b22 7674 6f70 225d 203d    body["vtop"] =
-0000d430: 2064 6276 2e76 7061 7468 0a20 2020 2020   dbv.vpath.     
-0000d440: 2020 2062 6f64 795b 2270 746f 7022 5d20     body["ptop"] 
-0000d450: 3d20 6462 762e 7265 616c 7061 7468 0a20  = dbv.realpath. 
-0000d460: 2020 2020 2020 2062 6f64 795b 2270 7265         body["pre
-0000d470: 6c22 5d20 3d20 7672 656d 0a20 2020 2020  l"] = vrem.     
-0000d480: 2020 2062 6f64 795b 2268 6f73 7422 5d20     body["host"] 
-0000d490: 3d20 7365 6c66 2e68 6f73 740a 2020 2020  = self.host.    
-0000d4a0: 2020 2020 626f 6479 5b22 7573 6572 225d      body["user"]
-0000d4b0: 203d 2073 656c 662e 756e 616d 650a 2020   = self.uname.  
-0000d4c0: 2020 2020 2020 626f 6479 5b22 6164 6472        body["addr
-0000d4d0: 225d 203d 2073 656c 662e 6970 0a20 2020  "] = self.ip.   
-0000d4e0: 2020 2020 2062 6f64 795b 2276 6366 6722       body["vcfg"
-0000d4f0: 5d20 3d20 6462 762e 666c 6167 730a 0a20  ] = dbv.flags.. 
-0000d500: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0000d510: 6c66 2e63 616e 5f64 656c 6574 653a 0a20  lf.can_delete:. 
-0000d520: 2020 2020 2020 2020 2020 2062 6f64 792e             body.
-0000d530: 706f 7028 2272 6570 6c61 6365 222c 204e  pop("replace", N
-0000d540: 6f6e 6529 0a0a 2020 2020 2020 2020 6966  one)..        if
-0000d550: 2072 656d 3a0a 2020 2020 2020 2020 2020   rem:.          
-0000d560: 2020 6473 7420 3d20 7666 732e 6361 6e6f    dst = vfs.cano
-0000d570: 6e69 6361 6c28 7265 6d29 0a20 2020 2020  nical(rem).     
-0000d580: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000d590: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000d5a0: 6f74 2062 6f73 2e70 6174 682e 6973 6469  ot bos.path.isdi
-0000d5b0: 7228 6473 7429 3a0a 2020 2020 2020 2020  r(dst):.        
-0000d5c0: 2020 2020 2020 2020 2020 2020 626f 732e              bos.
-0000d5d0: 6d61 6b65 6469 7273 2864 7374 290a 2020  makedirs(dst).  
-0000d5e0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0000d5f0: 204f 5345 7272 6f72 2061 7320 6578 3a0a   OSError as ex:.
-0000d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d610: 7365 6c66 2e6c 6f67 2822 6d61 6b65 6469  self.log("makedi
-0000d620: 7273 2066 6169 6c65 6420 5b7b 7d5d 222e  rs failed [{}]".
-0000d630: 666f 726d 6174 2864 7374 2929 0a20 2020  format(dst)).   
-0000d640: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000d650: 6e6f 7420 626f 732e 7061 7468 2e69 7364  not bos.path.isd
-0000d660: 6972 2864 7374 293a 0a20 2020 2020 2020  ir(dst):.       
-0000d670: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000d680: 6578 2e65 7272 6e6f 203d 3d20 6572 726e  ex.errno == errn
-0000d690: 6f2e 4541 4343 4553 3a0a 2020 2020 2020  o.EACCES:.      
-0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6b0: 2020 7261 6973 6520 5065 626b 6163 2835    raise Pebkac(5
-0000d6c0: 3030 2c20 2274 6865 2073 6572 7665 7220  00, "the server 
-0000d6d0: 4f53 2064 656e 6965 6420 7772 6974 652d  OS denied write-
-0000d6e0: 6163 6365 7373 2229 0a0a 2020 2020 2020  access")..      
-0000d6f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000d700: 2065 782e 6572 726e 6f20 3d3d 2065 7272   ex.errno == err
-0000d710: 6e6f 2e45 4558 4953 543a 0a20 2020 2020  no.EEXIST:.     
-0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d730: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
-0000d740: 3430 302c 2022 736f 6d65 2066 696c 6520  400, "some file 
-0000d750: 676f 7420 796f 7572 2066 6f6c 6465 7220  got your folder 
-0000d760: 6e61 6d65 2229 0a0a 2020 2020 2020 2020  name")..        
-0000d770: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d780: 6520 5065 626b 6163 2835 3030 2c20 6d69  e Pebkac(500, mi
-0000d790: 6e5f 6578 2829 290a 2020 2020 2020 2020  n_ex()).        
-0000d7a0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-0000d7b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000d7c0: 6520 5065 626b 6163 2835 3030 2c20 6d69  e Pebkac(500, mi
-0000d7d0: 6e5f 6578 2829 290a 0a20 2020 2020 2020  n_ex())..       
-0000d7e0: 2078 203d 2073 656c 662e 636f 6e6e 2e68   x = self.conn.h
-0000d7f0: 7372 762e 6272 6f6b 6572 2e61 736b 2822  srv.broker.ask("
-0000d800: 7570 326b 2e68 616e 646c 655f 6a73 6f6e  up2k.handle_json
-0000d810: 222c 2062 6f64 792c 2073 656c 662e 7532  ", body, self.u2
-0000d820: 6668 2e61 7073 290a 2020 2020 2020 2020  fh.aps).        
-0000d830: 7265 7420 3d20 782e 6765 7428 290a 2020  ret = x.get().  
-0000d840: 2020 2020 2020 6966 2073 656c 662e 6973        if self.is
-0000d850: 5f76 7072 6f78 6965 643a 0a20 2020 2020  _vproxied:.     
-0000d860: 2020 2020 2020 2069 6620 2270 7572 6c22         if "purl"
-0000d870: 2069 6e20 7265 743a 0a20 2020 2020 2020   in ret:.       
-0000d880: 2020 2020 2020 2020 2072 6574 5b22 7075           ret["pu
-0000d890: 726c 225d 203d 2073 656c 662e 6172 6773  rl"] = self.args
-0000d8a0: 2e53 5220 2b20 7265 745b 2270 7572 6c22  .SR + ret["purl"
-0000d8b0: 5d0a 0a20 2020 2020 2020 2072 6574 203d  ]..        ret =
-0000d8c0: 206a 736f 6e2e 6475 6d70 7328 7265 7429   json.dumps(ret)
-0000d8d0: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
-0000d8e0: 6728 7265 7429 0a20 2020 2020 2020 2073  g(ret).        s
-0000d8f0: 656c 662e 7265 706c 7928 7265 742e 656e  elf.reply(ret.en
-0000d900: 636f 6465 2822 7574 662d 3822 292c 206d  code("utf-8"), m
-0000d910: 696d 653d 2261 7070 6c69 6361 7469 6f6e  ime="application
-0000d920: 2f6a 736f 6e22 290a 2020 2020 2020 2020  /json").        
-0000d930: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-0000d940: 2064 6566 2068 616e 646c 655f 7365 6172   def handle_sear
-0000d950: 6368 2873 656c 662c 2062 6f64 7920 2029  ch(self, body  )
-0000d960: 2020 3a0a 2020 2020 2020 2020 6964 7820    :.        idx 
-0000d970: 3d20 7365 6c66 2e63 6f6e 6e2e 6765 745f  = self.conn.get_
-0000d980: 7532 6964 7828 290a 2020 2020 2020 2020  u2idx().        
-0000d990: 6966 206e 6f74 2068 6173 6174 7472 2869  if not hasattr(i
-0000d9a0: 6478 2c20 2270 5f65 6e64 2229 3a0a 2020  dx, "p_end"):.  
-0000d9b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000d9c0: 5065 626b 6163 2835 3030 2c20 2273 716c  Pebkac(500, "sql
-0000d9d0: 6974 6533 2069 7320 6e6f 7420 6176 6169  ite3 is not avai
-0000d9e0: 6c61 626c 6520 6f6e 2074 6865 2073 6572  lable on the ser
-0000d9f0: 7665 723b 2063 616e 6e6f 7420 7365 6172  ver; cannot sear
-0000da00: 6368 2229 0a0a 2020 2020 2020 2020 766f  ch")..        vo
-0000da10: 6c73 203d 205b 5d0a 2020 2020 2020 2020  ls = [].        
-0000da20: 7365 656e 203d 207b 7d0a 2020 2020 2020  seen = {}.      
-0000da30: 2020 666f 7220 7674 6f70 2069 6e20 7365    for vtop in se
-0000da40: 6c66 2e72 766f 6c3a 0a20 2020 2020 2020  lf.rvol:.       
-0000da50: 2020 2020 2076 6673 2c20 5f20 3d20 7365       vfs, _ = se
-0000da60: 6c66 2e61 7372 762e 7666 732e 6765 7428  lf.asrv.vfs.get(
-0000da70: 7674 6f70 2c20 7365 6c66 2e75 6e61 6d65  vtop, self.uname
-0000da80: 2c20 5472 7565 2c20 4661 6c73 6529 0a20  , True, False). 
-0000da90: 2020 2020 2020 2020 2020 2076 6673 203d             vfs =
-0000daa0: 2076 6673 2e64 6276 206f 7220 7666 730a   vfs.dbv or vfs.
-0000dab0: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-0000dac0: 6673 2069 6e20 7365 656e 3a0a 2020 2020  fs in seen:.    
-0000dad0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0000dae0: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
-0000daf0: 2020 7365 656e 5b76 6673 5d20 3d20 5472    seen[vfs] = Tr
-0000db00: 7565 0a20 2020 2020 2020 2020 2020 2076  ue.            v
-0000db10: 6f6c 732e 6170 7065 6e64 2828 7666 732e  ols.append((vfs.
-0000db20: 7670 6174 682c 2076 6673 2e72 6561 6c70  vpath, vfs.realp
-0000db30: 6174 682c 2076 6673 2e66 6c61 6773 2929  ath, vfs.flags))
-0000db40: 0a0a 2020 2020 2020 2020 7430 203d 2074  ..        t0 = t
-0000db50: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-0000db60: 2020 2069 6620 6964 782e 705f 656e 643a     if idx.p_end:
-0000db70: 0a20 2020 2020 2020 2020 2020 2070 656e  .            pen
-0000db80: 616c 7479 203d 2030 2e37 0a20 2020 2020  alty = 0.7.     
-0000db90: 2020 2020 2020 2074 5f69 646c 6520 3d20         t_idle = 
-0000dba0: 7430 202d 2069 6478 2e70 5f65 6e64 0a20  t0 - idx.p_end. 
-0000dbb0: 2020 2020 2020 2020 2020 2069 6620 6964             if id
-0000dbc0: 782e 705f 6475 7220 3e20 302e 3720 616e  x.p_dur > 0.7 an
-0000dbd0: 6420 745f 6964 6c65 203c 2070 656e 616c  d t_idle < penal
-0000dbe0: 7479 3a0a 2020 2020 2020 2020 2020 2020  ty:.            
-0000dbf0: 2020 2020 7420 3d20 2272 6174 652d 6c69      t = "rate-li
-0000dc00: 6d69 7420 7b3a 2e31 667d 2073 6563 2c20  mit {:.1f} sec, 
-0000dc10: 636f 7374 207b 3a2e 3266 7d2c 2069 646c  cost {:.2f}, idl
-0000dc20: 6520 7b3a 2e32 667d 220a 2020 2020 2020  e {:.2f}".      
-0000dc30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000dc40: 5065 626b 6163 2834 3239 2c20 742e 666f  Pebkac(429, t.fo
-0000dc50: 726d 6174 2870 656e 616c 7479 2c20 6964  rmat(penalty, id
-0000dc60: 782e 705f 6475 722c 2074 5f69 646c 6529  x.p_dur, t_idle)
-0000dc70: 290a 0a20 2020 2020 2020 2069 6620 2273  )..        if "s
-0000dc80: 7263 6822 2069 6e20 626f 6479 3a0a 2020  rch" in body:.  
-0000dc90: 2020 2020 2020 2020 2020 2320 7365 6172            # sear
-0000dca0: 6368 2062 7920 7570 326b 2068 6173 686c  ch by up2k hashl
-0000dcb0: 6973 740a 2020 2020 2020 2020 2020 2020  ist.            
-0000dcc0: 7662 6f64 7920 3d20 636f 7079 2e64 6565  vbody = copy.dee
-0000dcd0: 7063 6f70 7928 626f 6479 290a 2020 2020  pcopy(body).    
-0000dce0: 2020 2020 2020 2020 7662 6f64 795b 2268          vbody["h
-0000dcf0: 6173 6822 5d20 3d20 6c65 6e28 7662 6f64  ash"] = len(vbod
-0000dd00: 795b 2268 6173 6822 5d29 0a20 2020 2020  y["hash"]).     
-0000dd10: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-0000dd20: 2271 6a3a 2022 202b 2072 6570 7228 7662  "qj: " + repr(vb
-0000dd30: 6f64 7929 290a 2020 2020 2020 2020 2020  ody)).          
-0000dd40: 2020 6869 7473 203d 2069 6478 2e66 7365    hits = idx.fse
-0000dd50: 6172 6368 2876 6f6c 732c 2062 6f64 7929  arch(vols, body)
-0000dd60: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0000dd70: 2020 3d20 7265 7072 2868 6974 7329 0a20    = repr(hits). 
-0000dd80: 2020 2020 2020 2020 2020 2074 6167 6c69             tagli
-0000dd90: 7374 2020 3d20 5b5d 0a20 2020 2020 2020  st  = [].       
-0000dda0: 2020 2020 2074 7275 6e63 203d 2046 616c       trunc = Fal
-0000ddb0: 7365 0a20 2020 2020 2020 2065 6c73 653a  se.        else:
-0000ddc0: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-0000ddd0: 6561 7263 6820 6279 2071 7565 7279 2070  earch by query p
-0000dde0: 6172 616d 730a 2020 2020 2020 2020 2020  arams.          
-0000ddf0: 2020 7120 3d20 626f 6479 5b22 7122 5d0a    q = body["q"].
-0000de00: 2020 2020 2020 2020 2020 2020 6e20 3d20              n = 
-0000de10: 626f 6479 2e67 6574 2822 6e22 2c20 7365  body.get("n", se
-0000de20: 6c66 2e61 7267 732e 7372 6368 5f68 6974  lf.args.srch_hit
-0000de30: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-0000de40: 656c 662e 6c6f 6728 2271 6a3a 207b 7d20  elf.log("qj: {} 
-0000de50: 7c7b 7d7c 222e 666f 726d 6174 2871 2c20  |{}|".format(q, 
-0000de60: 6e29 290a 2020 2020 2020 2020 2020 2020  n)).            
-0000de70: 6869 7473 2c20 7461 676c 6973 742c 2074  hits, taglist, t
-0000de80: 7275 6e63 203d 2069 6478 2e73 6561 7263  runc = idx.searc
-0000de90: 6828 766f 6c73 2c20 712c 206e 290a 2020  h(vols, q, n).  
-0000dea0: 2020 2020 2020 2020 2020 6d73 6720 3d20            msg = 
-0000deb0: 6c65 6e28 6869 7473 290a 0a20 2020 2020  len(hits)..     
-0000dec0: 2020 2069 6478 2e70 5f65 6e64 203d 2074     idx.p_end = t
-0000ded0: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-0000dee0: 2020 2069 6478 2e70 5f64 7572 203d 2069     idx.p_dur = i
-0000def0: 6478 2e70 5f65 6e64 202d 2074 300a 2020  dx.p_end - t0.  
-0000df00: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
-0000df10: 7123 3a20 7b7d 2028 7b3a 2e32 667d 7329  q#: {} ({:.2f}s)
-0000df20: 222e 666f 726d 6174 286d 7367 2c20 6964  ".format(msg, id
-0000df30: 782e 705f 6475 7229 290a 0a20 2020 2020  x.p_dur))..     
-0000df40: 2020 206f 7264 6572 203d 205b 5d0a 2020     order = [].  
-0000df50: 2020 2020 2020 6366 6720 3d20 7365 6c66        cfg = self
-0000df60: 2e61 7267 732e 6d74 652e 7370 6c69 7428  .args.mte.split(
-0000df70: 222c 2229 0a20 2020 2020 2020 2066 6f72  ",").        for
-0000df80: 2074 2069 6e20 6366 673a 0a20 2020 2020   t in cfg:.     
-0000df90: 2020 2020 2020 2069 6620 7420 696e 2074         if t in t
-0000dfa0: 6167 6c69 7374 3a0a 2020 2020 2020 2020  aglist:.        
-0000dfb0: 2020 2020 2020 2020 6f72 6465 722e 6170          order.ap
-0000dfc0: 7065 6e64 2874 290a 2020 2020 2020 2020  pend(t).        
-0000dfd0: 666f 7220 7420 696e 2074 6167 6c69 7374  for t in taglist
-0000dfe0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000dff0: 2074 206e 6f74 2069 6e20 6f72 6465 723a   t not in order:
-0000e000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e010: 206f 7264 6572 2e61 7070 656e 6428 7429   order.append(t)
-0000e020: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000e030: 662e 6973 5f76 7072 6f78 6965 643a 0a20  f.is_vproxied:. 
-0000e040: 2020 2020 2020 2020 2020 2066 6f72 2068             for h
-0000e050: 6974 2069 6e20 6869 7473 3a0a 2020 2020  it in hits:.    
-0000e060: 2020 2020 2020 2020 2020 2020 6869 745b              hit[
-0000e070: 2272 7022 5d20 3d20 7365 6c66 2e61 7267  "rp"] = self.arg
-0000e080: 732e 5253 202b 2068 6974 5b22 7270 225d  s.RS + hit["rp"]
-0000e090: 0a0a 2020 2020 2020 2020 726a 203d 207b  ..        rj = {
-0000e0a0: 2268 6974 7322 3a20 6869 7473 2c20 2274  "hits": hits, "t
-0000e0b0: 6167 5f6f 7264 6572 223a 206f 7264 6572  ag_order": order
-0000e0c0: 2c20 2274 7275 6e63 223a 2074 7275 6e63  , "trunc": trunc
-0000e0d0: 7d0a 2020 2020 2020 2020 7220 3d20 6a73  }.        r = js
-0000e0e0: 6f6e 2e64 756d 7073 2872 6a29 2e65 6e63  on.dumps(rj).enc
-0000e0f0: 6f64 6528 2275 7466 2d38 2229 0a20 2020  ode("utf-8").   
-0000e100: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
-0000e110: 722c 206d 696d 653d 2261 7070 6c69 6361  r, mime="applica
-0000e120: 7469 6f6e 2f6a 736f 6e22 290a 2020 2020  tion/json").    
-0000e130: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0000e140: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
-0000e150: 706f 7374 5f62 696e 6172 7928 7365 6c66  post_binary(self
-0000e160: 2920 203a 0a20 2020 2020 2020 2074 7279  )  :.        try
-0000e170: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000e180: 6d61 696e 7320 3d20 696e 7428 7365 6c66  mains = int(self
-0000e190: 2e68 6561 6465 7273 5b22 636f 6e74 656e  .headers["conten
-0000e1a0: 742d 6c65 6e67 7468 225d 290a 2020 2020  t-length"]).    
-0000e1b0: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-0000e1c0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-0000e1d0: 626b 6163 2834 3030 2c20 2279 6f75 206d  bkac(400, "you m
-0000e1e0: 7573 7420 7375 7070 6c79 2061 2063 6f6e  ust supply a con
-0000e1f0: 7465 6e74 2d6c 656e 6774 6820 666f 7220  tent-length for 
-0000e200: 6269 6e61 7279 2050 4f53 5422 290a 0a20  binary POST").. 
-0000e210: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000e220: 2020 2020 2020 2020 6368 6173 6820 3d20          chash = 
-0000e230: 7365 6c66 2e68 6561 6465 7273 5b22 782d  self.headers["x-
-0000e240: 7570 326b 2d68 6173 6822 5d0a 2020 2020  up2k-hash"].    
-0000e250: 2020 2020 2020 2020 7761 726b 203d 2073          wark = s
-0000e260: 656c 662e 6865 6164 6572 735b 2278 2d75  elf.headers["x-u
-0000e270: 7032 6b2d 7761 726b 225d 0a20 2020 2020  p2k-wark"].     
-0000e280: 2020 2065 7863 6570 7420 4b65 7945 7272     except KeyErr
-0000e290: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-0000e2a0: 7261 6973 6520 5065 626b 6163 2834 3030  raise Pebkac(400
-0000e2b0: 2c20 226e 6565 6420 6861 7368 2061 6e64  , "need hash and
-0000e2c0: 2077 6172 6b20 6865 6164 6572 7320 666f   wark headers fo
-0000e2d0: 7220 6269 6e61 7279 2050 4f53 5422 290a  r binary POST").
-0000e2e0: 0a20 2020 2020 2020 2076 6673 2c20 5f20  .        vfs, _ 
-0000e2f0: 3d20 7365 6c66 2e61 7372 762e 7666 732e  = self.asrv.vfs.
-0000e300: 6765 7428 7365 6c66 2e76 7061 7468 2c20  get(self.vpath, 
-0000e310: 7365 6c66 2e75 6e61 6d65 2c20 4661 6c73  self.uname, Fals
-0000e320: 652c 2054 7275 6529 0a20 2020 2020 2020  e, True).       
-0000e330: 2070 746f 7020 3d20 2876 6673 2e64 6276   ptop = (vfs.dbv
-0000e340: 206f 7220 7666 7329 2e72 6561 6c70 6174   or vfs).realpat
-0000e350: 680a 0a20 2020 2020 2020 2078 203d 2073  h..        x = s
-0000e360: 656c 662e 636f 6e6e 2e68 7372 762e 6272  elf.conn.hsrv.br
-0000e370: 6f6b 6572 2e61 736b 2822 7570 326b 2e68  oker.ask("up2k.h
-0000e380: 616e 646c 655f 6368 756e 6b22 2c20 7074  andle_chunk", pt
-0000e390: 6f70 2c20 7761 726b 2c20 6368 6173 6829  op, wark, chash)
-0000e3a0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-0000e3b0: 6520 3d20 782e 6765 7428 290a 2020 2020  e = x.get().    
-0000e3c0: 2020 2020 6368 756e 6b73 697a 652c 2063      chunksize, c
-0000e3d0: 7374 6172 742c 2070 6174 682c 206c 6173  start, path, las
-0000e3e0: 746d 6f64 2c20 7370 7273 203d 2072 6573  tmod, sprs = res
-0000e3f0: 706f 6e73 650a 0a20 2020 2020 2020 2074  ponse..        t
-0000e400: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0000e410: 6966 2073 656c 662e 6172 6773 2e6e 773a  if self.args.nw:
-0000e420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e430: 2070 6174 6820 3d20 6f73 2e64 6576 6e75   path = os.devnu
-0000e440: 6c6c 0a0a 2020 2020 2020 2020 2020 2020  ll..            
-0000e450: 6966 2072 656d 6169 6e73 203e 2063 6875  if remains > chu
-0000e460: 6e6b 7369 7a65 3a0a 2020 2020 2020 2020  nksize:.        
-0000e470: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-0000e480: 626b 6163 2834 3030 2c20 2279 6f75 7220  bkac(400, "your 
-0000e490: 6368 756e 6b20 6973 2074 6f6f 2062 6967  chunk is too big
-0000e4a0: 2074 6f20 6669 7422 290a 0a20 2020 2020   to fit")..     
-0000e4b0: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-0000e4c0: 2277 7269 7469 6e67 207b 7d20 237b 7d20  "writing {} #{} 
-0000e4d0: 407b 7d20 6c65 6e20 7b7d 222e 666f 726d  @{} len {}".form
-0000e4e0: 6174 2870 6174 682c 2063 6861 7368 2c20  at(path, chash, 
-0000e4f0: 6373 7461 7274 2c20 7265 6d61 696e 7329  cstart, remains)
-0000e500: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
-0000e510: 6561 6465 7220 3d20 7265 6164 5f73 6f63  eader = read_soc
-0000e520: 6b65 7428 7365 6c66 2e73 722c 2072 656d  ket(self.sr, rem
-0000e530: 6169 6e73 290a 0a20 2020 2020 2020 2020  ains)..         
-0000e540: 2020 2066 203d 204e 6f6e 650a 2020 2020     f = None.    
-0000e550: 2020 2020 2020 2020 6670 6f6f 6c20 3d20          fpool = 
-0000e560: 6e6f 7420 7365 6c66 2e61 7267 732e 6e6f  not self.args.no
-0000e570: 5f66 706f 6f6c 2061 6e64 2073 7072 730a  _fpool and sprs.
-0000e580: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-0000e590: 706f 6f6c 3a0a 2020 2020 2020 2020 2020  pool:.          
-0000e5a0: 2020 2020 2020 7769 7468 2073 656c 662e        with self.
-0000e5b0: 6d75 7465 783a 0a20 2020 2020 2020 2020  mutex:.         
-0000e5c0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-0000e5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5e0: 2020 2020 2020 2020 6620 3d20 7365 6c66          f = self
-0000e5f0: 2e75 3266 682e 706f 7028 7061 7468 290a  .u2fh.pop(path).
-0000e600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e610: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
-0000e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e630: 2020 2020 7061 7373 0a0a 2020 2020 2020      pass..      
-0000e640: 2020 2020 2020 6620 3d20 6620 6f72 206f        f = f or o
-0000e650: 7065 6e28 6673 656e 6328 7061 7468 292c  pen(fsenc(path),
-0000e660: 2022 7262 2b22 2c20 3531 3220 2a20 3130   "rb+", 512 * 10
-0000e670: 3234 290a 0a20 2020 2020 2020 2020 2020  24)..           
-0000e680: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000e690: 2020 2020 2020 662e 7365 656b 2863 7374        f.seek(cst
-0000e6a0: 6172 745b 305d 290a 2020 2020 2020 2020  art[0]).        
-0000e6b0: 2020 2020 2020 2020 706f 7374 5f73 7a2c          post_sz,
-0000e6c0: 205f 2c20 7368 615f 6236 3420 3d20 6861   _, sha_b64 = ha
-0000e6d0: 7368 636f 7079 2872 6561 6465 722c 2066  shcopy(reader, f
-0000e6e0: 2c20 7365 6c66 2e61 7267 732e 735f 7772  , self.args.s_wr
-0000e6f0: 5f73 6c70 290a 0a20 2020 2020 2020 2020  _slp)..         
-0000e700: 2020 2020 2020 2069 6620 7368 615f 6236         if sha_b6
-0000e710: 3420 213d 2063 6861 7368 3a0a 2020 2020  4 != chash:.    
-0000e720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e730: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0000e740: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000e750: 662e 6261 6b66 6c69 7028 662c 2063 7374  f.bakflip(f, cst
-0000e760: 6172 745b 305d 2c20 706f 7374 5f73 7a2c  art[0], post_sz,
-0000e770: 2073 6861 5f62 3634 290a 2020 2020 2020   sha_b64).      
-0000e780: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0000e790: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
-0000e7a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0000e7b0: 6c66 2e6c 6f67 2822 6261 6b66 6c69 7020  lf.log("bakflip 
-0000e7c0: 6661 696c 6564 3a20 2220 2b20 6d69 6e5f  failed: " + min_
-0000e7d0: 6578 2829 290a 0a20 2020 2020 2020 2020  ex())..         
-0000e7e0: 2020 2020 2020 2020 2020 2074 203d 2022             t = "
-0000e7f0: 796f 7572 2063 6875 6e6b 2067 6f74 2063  your chunk got c
-0000e800: 6f72 7275 7074 6564 2073 6f6d 6568 6f77  orrupted somehow
-0000e810: 2028 7265 6365 6976 6564 207b 7d20 6279   (received {} by
-0000e820: 7465 7329 3b20 6578 7065 6374 6564 2076  tes); expected v
-0000e830: 7320 7265 6365 6976 6564 2068 6173 683a  s received hash:
-0000e840: 5c6e 7b7d 5c6e 7b7d 220a 2020 2020 2020  \n{}\n{}".      
-0000e850: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000e860: 6973 6520 5065 626b 6163 2834 3030 2c20  ise Pebkac(400, 
-0000e870: 742e 666f 726d 6174 2870 6f73 745f 737a  t.format(post_sz
-0000e880: 2c20 6368 6173 682c 2073 6861 5f62 3634  , chash, sha_b64
-0000e890: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-0000e8a0: 2020 2020 6966 206c 656e 2863 7374 6172      if len(cstar
-0000e8b0: 7429 203e 2031 2061 6e64 2070 6174 6820  t) > 1 and path 
-0000e8c0: 213d 206f 732e 6465 766e 756c 6c3a 0a20  != os.devnull:. 
-0000e8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8e0: 2020 2073 656c 662e 6c6f 6728 0a20 2020     self.log(.   
-0000e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e900: 2020 2020 2022 636c 6f6e 6520 7b7d 2074       "clone {} t
-0000e910: 6f20 7b7d 222e 666f 726d 6174 280a 2020  o {}".format(.  
-0000e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e930: 2020 2020 2020 2020 2020 6373 7461 7274            cstart
-0000e940: 5b30 5d2c 2022 2026 2022 2e6a 6f69 6e28  [0], " & ".join(
-0000e950: 756e 6963 6f64 6528 7829 2066 6f72 2078  unicode(x) for x
-0000e960: 2069 6e20 6373 7461 7274 5b31 3a5d 290a   in cstart[1:]).
-0000e970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e980: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e990: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9b0: 2020 2020 6f66 7320 3d20 300a 2020 2020      ofs = 0.    
-0000e9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9d0: 7768 696c 6520 6f66 7320 3c20 6368 756e  while ofs < chun
-0000e9e0: 6b73 697a 653a 0a20 2020 2020 2020 2020  ksize:.         
-0000e9f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000ea00: 7566 737a 203d 206d 696e 2863 6875 6e6b  ufsz = min(chunk
-0000ea10: 7369 7a65 202d 206f 6673 2c20 3420 2a20  size - ofs, 4 * 
-0000ea20: 3130 3234 202a 2031 3032 3429 0a20 2020  1024 * 1024).   
-0000ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea40: 2020 2020 2066 2e73 6565 6b28 6373 7461       f.seek(csta
-0000ea50: 7274 5b30 5d20 2b20 6f66 7329 0a20 2020  rt[0] + ofs).   
-0000ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea70: 2020 2020 2062 7566 203d 2066 2e72 6561       buf = f.rea
-0000ea80: 6428 6275 6673 7a29 0a20 2020 2020 2020  d(bufsz).       
-0000ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eaa0: 2066 6f72 2077 6f66 7320 696e 2063 7374   for wofs in cst
-0000eab0: 6172 745b 313a 5d3a 0a20 2020 2020 2020  art[1:]:.       
-0000eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ead0: 2020 2020 2066 2e73 6565 6b28 776f 6673       f.seek(wofs
-0000eae0: 202b 206f 6673 290a 2020 2020 2020 2020   + ofs).        
-0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb00: 2020 2020 662e 7772 6974 6528 6275 6629      f.write(buf)
-0000eb10: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000eb20: 2020 2020 2020 2020 2020 6f66 7320 2b3d            ofs +=
-0000eb30: 206c 656e 2862 7566 290a 0a20 2020 2020   len(buf)..     
-0000eb40: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000eb50: 656c 662e 6c6f 6728 2263 6c6f 6e65 207b  elf.log("clone {
-0000eb60: 7d20 646f 6e65 222e 666f 726d 6174 2863  } done".format(c
-0000eb70: 7374 6172 745b 305d 2929 0a0a 2020 2020  start[0]))..    
-0000eb80: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000eb90: 6f74 2066 706f 6f6c 3a0a 2020 2020 2020  ot fpool:.      
-0000eba0: 2020 2020 2020 2020 2020 2020 2020 662e                f.
-0000ebb0: 636c 6f73 6528 290a 2020 2020 2020 2020  close().        
-0000ebc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000ebd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebe0: 2020 7769 7468 2073 656c 662e 6d75 7465    with self.mute
-0000ebf0: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
-0000ec00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000ec10: 7532 6668 2e70 7574 2870 6174 682c 2066  u2fh.put(path, f
-0000ec20: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-0000ec30: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
-0000ec40: 2020 2020 2020 2320 6d61 7962 6520 6275        # maybe bu
-0000ec50: 7374 6564 2068 616e 646c 6520 2865 672e  sted handle (eg.
-0000ec60: 2064 6973 6b20 7765 6e74 2066 756c 6c29   disk went full)
-0000ec70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ec80: 2066 2e63 6c6f 7365 2829 0a20 2020 2020   f.close().     
-0000ec90: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000eca0: 0a20 2020 2020 2020 2066 696e 616c 6c79  .        finally
-0000ecb0: 3a0a 2020 2020 2020 2020 2020 2020 7820  :.            x 
-0000ecc0: 3d20 7365 6c66 2e63 6f6e 6e2e 6873 7276  = self.conn.hsrv
-0000ecd0: 2e62 726f 6b65 722e 6173 6b28 2275 7032  .broker.ask("up2
-0000ece0: 6b2e 7265 6c65 6173 655f 6368 756e 6b22  k.release_chunk"
-0000ecf0: 2c20 7074 6f70 2c20 7761 726b 2c20 6368  , ptop, wark, ch
-0000ed00: 6173 6829 0a20 2020 2020 2020 2020 2020  ash).           
-0000ed10: 2078 2e67 6574 2829 2020 2320 626c 6f63   x.get()  # bloc
-0000ed20: 6b20 636c 6965 6e74 2075 6e74 696c 2072  k client until r
-0000ed30: 656c 6561 7365 640a 0a20 2020 2020 2020  eleased..       
-0000ed40: 2078 203d 2073 656c 662e 636f 6e6e 2e68   x = self.conn.h
-0000ed50: 7372 762e 6272 6f6b 6572 2e61 736b 2822  srv.broker.ask("
-0000ed60: 7570 326b 2e63 6f6e 6669 726d 5f63 6875  up2k.confirm_chu
-0000ed70: 6e6b 222c 2070 746f 702c 2077 6172 6b2c  nk", ptop, wark,
-0000ed80: 2063 6861 7368 290a 2020 2020 2020 2020   chash).        
-0000ed90: 7a74 6973 203d 2078 2e67 6574 2829 0a20  ztis = x.get(). 
-0000eda0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000edb0: 2020 2020 2020 2020 6e75 6d5f 6c65 6674          num_left
-0000edc0: 2c20 6669 6e5f 7061 7468 203d 207a 7469  , fin_path = zti
-0000edd0: 730a 2020 2020 2020 2020 6578 6365 7074  s.        except
-0000ede0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000edf0: 6c66 2e6c 6f75 645f 7265 706c 7928 7a74  lf.loud_reply(zt
-0000ee00: 6973 2c20 7374 6174 7573 3d35 3030 290a  is, status=500).
-0000ee10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000ee20: 726e 2046 616c 7365 0a0a 2020 2020 2020  rn False..      
-0000ee30: 2020 6966 206e 6f74 206e 756d 5f6c 6566    if not num_lef
-0000ee40: 7420 616e 6420 6670 6f6f 6c3a 0a20 2020  t and fpool:.   
-0000ee50: 2020 2020 2020 2020 2077 6974 6820 7365           with se
-0000ee60: 6c66 2e6d 7574 6578 3a0a 2020 2020 2020  lf.mutex:.      
-0000ee70: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
-0000ee80: 3266 682e 636c 6f73 6528 7061 7468 290a  2fh.close(path).
-0000ee90: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0000eea0: 6e75 6d5f 6c65 6674 2061 6e64 206e 6f74  num_left and not
-0000eeb0: 2073 656c 662e 6172 6773 2e6e 773a 0a20   self.args.nw:. 
-0000eec0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000eed0: 636f 6e6e 2e68 7372 762e 6272 6f6b 6572  conn.hsrv.broker
-0000eee0: 2e61 736b 280a 2020 2020 2020 2020 2020  .ask(.          
-0000eef0: 2020 2020 2020 2275 7032 6b2e 6669 6e69        "up2k.fini
-0000ef00: 7368 5f75 706c 6f61 6422 2c20 7074 6f70  sh_upload", ptop
-0000ef10: 2c20 7761 726b 2c20 7365 6c66 2e75 3266  , wark, self.u2f
-0000ef20: 682e 6170 730a 2020 2020 2020 2020 2020  h.aps.          
-0000ef30: 2020 292e 6765 7428 290a 0a20 2020 2020    ).get()..     
-0000ef40: 2020 2063 696e 6620 3d20 7365 6c66 2e68     cinf = self.h
-0000ef50: 6561 6465 7273 2e67 6574 2822 782d 7570  eaders.get("x-up
-0000ef60: 326b 2d73 7461 7422 2c20 2222 290a 0a20  2k-stat", "").. 
-0000ef70: 2020 2020 2020 2073 7064 203d 2073 656c         spd = sel
-0000ef80: 662e 5f73 7064 2870 6f73 745f 737a 290a  f._spd(post_sz).
-0000ef90: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0000efa0: 2822 7b3a 3730 7d20 7468 616e 6b20 7b7d  ("{:70} thank {}
-0000efb0: 222e 666f 726d 6174 2873 7064 2c20 6369  ".format(spd, ci
-0000efc0: 6e66 2929 0a20 2020 2020 2020 2073 656c  nf)).        sel
-0000efd0: 662e 7265 706c 7928 6222 7468 616e 6b22  f.reply(b"thank"
-0000efe0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000eff0: 2054 7275 650a 0a20 2020 2064 6566 2068   True..    def h
-0000f000: 616e 646c 655f 6c6f 6769 6e28 7365 6c66  andle_login(self
-0000f010: 2920 203a 0a20 2020 2020 2020 2061 7373  )  :.        ass
-0000f020: 6572 7420 7365 6c66 2e70 6172 7365 720a  ert self.parser.
-0000f030: 2020 2020 2020 2020 7077 6420 3d20 7365          pwd = se
-0000f040: 6c66 2e70 6172 7365 722e 7265 7175 6972  lf.parser.requir
-0000f050: 6528 2263 7070 7764 222c 2036 3429 0a20  e("cppwd", 64). 
-0000f060: 2020 2020 2020 2073 656c 662e 7061 7273         self.pars
-0000f070: 6572 2e64 726f 7028 290a 0a20 2020 2020  er.drop()..     
-0000f080: 2020 2073 656c 662e 6f75 745f 6865 6164     self.out_head
-0000f090: 6572 6c69 7374 203d 205b 0a20 2020 2020  erlist = [.     
-0000f0a0: 2020 2020 2020 2078 2066 6f72 2078 2069         x for x i
-0000f0b0: 6e20 7365 6c66 2e6f 7574 5f68 6561 6465  n self.out_heade
-0000f0c0: 726c 6973 7420 6966 2078 5b30 5d20 213d  rlist if x[0] !=
-0000f0d0: 2022 5365 742d 436f 6f6b 6965 2220 6f72   "Set-Cookie" or
-0000f0e0: 2022 6370 7077 2220 213d 2078 5b31 5d5b   "cppw" != x[1][
-0000f0f0: 3a34 5d0a 2020 2020 2020 2020 5d0a 0a20  :4].        ].. 
-0000f100: 2020 2020 2020 2064 7374 203d 2073 656c         dst = sel
-0000f110: 662e 6172 6773 2e53 5253 0a20 2020 2020  f.args.SRS.     
-0000f120: 2020 2069 6620 7365 6c66 2e76 7061 7468     if self.vpath
-0000f130: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-0000f140: 7420 2b3d 2071 756f 7465 7028 7365 6c66  t += quotep(self
-0000f150: 2e76 7061 7468 290a 0a20 2020 2020 2020  .vpath)..       
-0000f160: 206d 7367 203d 2073 656c 662e 6765 745f   msg = self.get_
-0000f170: 7077 645f 636f 6f6b 6965 2870 7764 290a  pwd_cookie(pwd).
-0000f180: 2020 2020 2020 2020 6874 6d6c 203d 2073          html = s
-0000f190: 656c 662e 6a32 7328 226d 7367 222c 2068  elf.j2s("msg", h
-0000f1a0: 313d 6d73 672c 2068 323d 273c 6120 6872  1=msg, h2='<a hr
-0000f1b0: 6566 3d22 2720 2b20 6473 7420 2b20 2722  ef="' + dst + '"
-0000f1c0: 3e61 636b 3c2f 613e 272c 2072 6564 6972  >ack</a>', redir
-0000f1d0: 3d64 7374 290a 2020 2020 2020 2020 7365  =dst).        se
-0000f1e0: 6c66 2e72 6570 6c79 2868 746d 6c2e 656e  lf.reply(html.en
-0000f1f0: 636f 6465 2822 7574 662d 3822 2929 0a20  code("utf-8")). 
-0000f200: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-0000f210: 7565 0a0a 2020 2020 6465 6620 6765 745f  ue..    def get_
-0000f220: 7077 645f 636f 6f6b 6965 2873 656c 662c  pwd_cookie(self,
-0000f230: 2070 7764 2029 2020 3a0a 2020 2020 2020   pwd )  :.      
-0000f240: 2020 6966 2070 7764 2069 6e20 7365 6c66    if pwd in self
-0000f250: 2e61 7372 762e 6961 6363 743a 0a20 2020  .asrv.iacct:.   
-0000f260: 2020 2020 2020 2020 206d 7367 203d 2022           msg = "
-0000f270: 6c6f 6769 6e20 6f6b 220a 2020 2020 2020  login ok".      
-0000f280: 2020 2020 2020 6475 7220 3d20 696e 7428        dur = int(
-0000f290: 3630 202a 2036 3020 2a20 7365 6c66 2e61  60 * 60 * self.a
-0000f2a0: 7267 732e 6c6f 676f 7574 290a 2020 2020  rgs.logout).    
-0000f2b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000f2c0: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
-0000f2d0: 696e 7661 6c69 6420 7061 7373 776f 7264  invalid password
-0000f2e0: 3a20 7b7d 222e 666f 726d 6174 2870 7764  : {}".format(pwd
-0000f2f0: 292c 2033 290a 2020 2020 2020 2020 2020  ), 3).          
-0000f300: 2020 6720 3d20 7365 6c66 2e63 6f6e 6e2e    g = self.conn.
-0000f310: 6873 7276 2e67 7077 640a 2020 2020 2020  hsrv.gpwd.      
-0000f320: 2020 2020 2020 6966 2067 2e6c 696d 3a0a        if g.lim:.
-0000f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f340: 626f 6e6b 2c20 6970 203d 2067 2e62 6f6e  bonk, ip = g.bon
-0000f350: 6b28 7365 6c66 2e69 702c 2070 7764 290a  k(self.ip, pwd).
-0000f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f370: 6966 2062 6f6e 6b3a 0a20 2020 2020 2020  if bonk:.       
-0000f380: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000f390: 662e 6c6f 6728 2263 6c69 656e 7420 6261  f.log("client ba
-0000f3a0: 6e6e 6564 3a20 696e 7661 6c69 6420 7061  nned: invalid pa
-0000f3b0: 7373 776f 7264 7322 2c20 3129 0a20 2020  sswords", 1).   
-0000f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3d0: 2073 656c 662e 636f 6e6e 2e68 7372 762e   self.conn.hsrv.
-0000f3e0: 6261 6e73 5b69 705d 203d 2062 6f6e 6b0a  bans[ip] = bonk.
-0000f3f0: 0a20 2020 2020 2020 2020 2020 206d 7367  .            msg
-0000f400: 203d 2022 6e61 7720 6475 6465 220a 2020   = "naw dude".  
-0000f410: 2020 2020 2020 2020 2020 7077 6420 3d20            pwd = 
-0000f420: 2278 2220 2023 206e 6f73 6563 0a20 2020  "x"  # nosec.   
-0000f430: 2020 2020 2020 2020 2064 7572 203d 204e           dur = N
-0000f440: 6f6e 650a 0a20 2020 2020 2020 2069 6620  one..        if 
-0000f450: 7077 6420 3d3d 2022 7822 3a0a 2020 2020  pwd == "x":.    
-0000f460: 2020 2020 2020 2020 2320 7265 7365 7420          # reset 
-0000f470: 626f 7468 2070 6c61 696e 7465 7874 2061  both plaintext a
-0000f480: 6e64 2074 6c73 0a20 2020 2020 2020 2020  nd tls.         
-0000f490: 2020 2023 2028 6f6e 6c79 2061 6666 6563     # (only affec
-0000f4a0: 7473 2061 6374 6976 6520 746c 7320 636f  ts active tls co
-0000f4b0: 6f6b 6965 7320 7768 656e 2074 6c73 290a  okies when tls).
-0000f4c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000f4d0: 6b20 696e 2028 2263 7070 7764 222c 2022  k in ("cppwd", "
-0000f4e0: 6370 7077 7322 2920 6966 2073 656c 662e  cppws") if self.
-0000f4f0: 6973 5f68 7474 7073 2065 6c73 6520 2822  is_https else ("
-0000f500: 6370 7077 6422 2c29 3a0a 2020 2020 2020  cppwd",):.      
-0000f510: 2020 2020 2020 2020 2020 636b 203d 2067            ck = g
-0000f520: 656e 636f 6f6b 6965 286b 2c20 7077 642c  encookie(k, pwd,
-0000f530: 2073 656c 662e 6172 6773 2e52 2c20 4661   self.args.R, Fa
-0000f540: 6c73 652c 2064 7572 290a 2020 2020 2020  lse, dur).      
-0000f550: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
-0000f560: 7574 5f68 6561 6465 726c 6973 742e 6170  ut_headerlist.ap
-0000f570: 7065 6e64 2828 2253 6574 2d43 6f6f 6b69  pend(("Set-Cooki
-0000f580: 6522 2c20 636b 2929 0a20 2020 2020 2020  e", ck)).       
-0000f590: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000f5a0: 2020 206b 203d 2022 6370 7077 7322 2069     k = "cppws" i
-0000f5b0: 6620 7365 6c66 2e69 735f 6874 7470 7320  f self.is_https 
-0000f5c0: 656c 7365 2022 6370 7077 6422 0a20 2020  else "cppwd".   
-0000f5d0: 2020 2020 2020 2020 2063 6b20 3d20 6765           ck = ge
-0000f5e0: 6e63 6f6f 6b69 6528 6b2c 2070 7764 2c20  ncookie(k, pwd, 
-0000f5f0: 7365 6c66 2e61 7267 732e 522c 2073 656c  self.args.R, sel
-0000f600: 662e 6973 5f68 7474 7073 2c20 6475 7229  f.is_https, dur)
-0000f610: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f620: 662e 6f75 745f 6865 6164 6572 6c69 7374  f.out_headerlist
-0000f630: 2e61 7070 656e 6428 2822 5365 742d 436f  .append(("Set-Co
-0000f640: 6f6b 6965 222c 2063 6b29 290a 0a20 2020  okie", ck))..   
-0000f650: 2020 2020 2072 6574 7572 6e20 6d73 670a       return msg.
-0000f660: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
-0000f670: 6d6b 6469 7228 7365 6c66 2920 203a 0a20  mkdir(self)  :. 
-0000f680: 2020 2020 2020 2061 7373 6572 7420 7365         assert se
-0000f690: 6c66 2e70 6172 7365 720a 2020 2020 2020  lf.parser.      
-0000f6a0: 2020 6e65 775f 6469 7220 3d20 7365 6c66    new_dir = self
-0000f6b0: 2e70 6172 7365 722e 7265 7175 6972 6528  .parser.require(
-0000f6c0: 226e 616d 6522 2c20 3531 3229 0a20 2020  "name", 512).   
-0000f6d0: 2020 2020 2073 656c 662e 7061 7273 6572       self.parser
-0000f6e0: 2e64 726f 7028 290a 0a20 2020 2020 2020  .drop()..       
-0000f6f0: 2073 616e 6974 697a 6564 203d 2073 616e   sanitized = san
-0000f700: 6974 697a 655f 666e 286e 6577 5f64 6972  itize_fn(new_dir
-0000f710: 2c20 2222 2c20 5b5d 290a 2020 2020 2020  , "", []).      
-0000f720: 2020 7265 7475 726e 2073 656c 662e 5f6d    return self._m
-0000f730: 6b64 6972 2876 6a6f 696e 2873 656c 662e  kdir(vjoin(self.
-0000f740: 7670 6174 682c 2073 616e 6974 697a 6564  vpath, sanitized
-0000f750: 2929 0a0a 2020 2020 6465 6620 5f6d 6b64  ))..    def _mkd
-0000f760: 6972 2873 656c 662c 2076 7061 7468 2029  ir(self, vpath )
-0000f770: 2020 3a0a 2020 2020 2020 2020 6e75 6c6c    :.        null
-0000f780: 7772 6974 6520 3d20 7365 6c66 2e61 7267  write = self.arg
-0000f790: 732e 6e77 0a20 2020 2020 2020 2076 6673  s.nw.        vfs
-0000f7a0: 2c20 7265 6d20 3d20 7365 6c66 2e61 7372  , rem = self.asr
-0000f7b0: 762e 7666 732e 6765 7428 7670 6174 682c  v.vfs.get(vpath,
-0000f7c0: 2073 656c 662e 756e 616d 652c 2046 616c   self.uname, Fal
-0000f7d0: 7365 2c20 5472 7565 290a 2020 2020 2020  se, True).      
-0000f7e0: 2020 7365 6c66 2e5f 6173 7365 7274 5f73    self._assert_s
-0000f7f0: 6166 655f 7265 6d28 7265 6d29 0a20 2020  afe_rem(rem).   
-0000f800: 2020 2020 2066 6e20 3d20 7666 732e 6361       fn = vfs.ca
-0000f810: 6e6f 6e69 6361 6c28 7265 6d29 0a0a 2020  nonical(rem)..  
-0000f820: 2020 2020 2020 6966 206e 6f74 206e 756c        if not nul
-0000f830: 6c77 7269 7465 3a0a 2020 2020 2020 2020  lwrite:.        
-0000f840: 2020 2020 6664 6972 203d 206f 732e 7061      fdir = os.pa
-0000f850: 7468 2e64 6972 6e61 6d65 2866 6e29 0a0a  th.dirname(fn)..
-0000f860: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0000f870: 6f74 2062 6f73 2e70 6174 682e 6973 6469  ot bos.path.isdi
-0000f880: 7228 6664 6972 293a 0a20 2020 2020 2020  r(fdir):.       
-0000f890: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-0000f8a0: 6562 6b61 6328 3430 392c 2022 7061 7265  ebkac(409, "pare
-0000f8b0: 6e74 2066 6f6c 6465 7220 646f 6573 206e  nt folder does n
-0000f8c0: 6f74 2065 7869 7374 2229 0a0a 2020 2020  ot exist")..    
-0000f8d0: 2020 2020 2020 2020 6966 2062 6f73 2e70          if bos.p
-0000f8e0: 6174 682e 6973 6469 7228 666e 293a 0a20  ath.isdir(fn):. 
-0000f8f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0000f900: 6169 7365 2050 6562 6b61 6328 3430 352c  aise Pebkac(405,
-0000f910: 2022 7468 6174 2066 6f6c 6465 7220 6578   "that folder ex
-0000f920: 6973 7473 2061 6c72 6561 6479 2229 0a0a  ists already")..
-0000f930: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0000f940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f950: 2062 6f73 2e6d 6b64 6972 2866 6e29 0a20   bos.mkdir(fn). 
-0000f960: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0000f970: 7420 4f53 4572 726f 7220 6173 2065 783a  t OSError as ex:
-0000f980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f990: 2069 6620 6578 2e65 7272 6e6f 203d 3d20   if ex.errno == 
-0000f9a0: 6572 726e 6f2e 4541 4343 4553 3a0a 2020  errno.EACCES:.  
-0000f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9c0: 2020 7261 6973 6520 5065 626b 6163 2835    raise Pebkac(5
-0000f9d0: 3030 2c20 2274 6865 2073 6572 7665 7220  00, "the server 
-0000f9e0: 4f53 2064 656e 6965 6420 7772 6974 652d  OS denied write-
-0000f9f0: 6163 6365 7373 2229 0a0a 2020 2020 2020  access")..      
-0000fa00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000fa10: 5065 626b 6163 2835 3030 2c20 226d 6b64  Pebkac(500, "mkd
-0000fa20: 6972 2066 6169 6c65 643a 5c6e 2220 2b20  ir failed:\n" + 
-0000fa30: 6d69 6e5f 6578 2829 290a 2020 2020 2020  min_ex()).      
-0000fa40: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-0000fa50: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000fa60: 6973 6520 5065 626b 6163 2835 3030 2c20  ise Pebkac(500, 
-0000fa70: 6d69 6e5f 6578 2829 290a 0a20 2020 2020  min_ex())..     
-0000fa80: 2020 2073 656c 662e 6f75 745f 6865 6164     self.out_head
-0000fa90: 6572 735b 2258 2d4e 6577 2d44 6972 225d  ers["X-New-Dir"]
-0000faa0: 203d 2071 756f 7465 7028 7670 6174 682e   = quotep(vpath.
-0000fab0: 7370 6c69 7428 222f 2229 5b2d 315d 290a  split("/")[-1]).
-0000fac0: 2020 2020 2020 2020 7365 6c66 2e72 6564          self.red
-0000fad0: 6972 6563 7428 7670 6174 682c 2073 7461  irect(vpath, sta
-0000fae0: 7475 733d 3230 3129 0a20 2020 2020 2020  tus=201).       
-0000faf0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
-0000fb00: 2020 6465 6620 6861 6e64 6c65 5f6e 6577    def handle_new
-0000fb10: 5f6d 6428 7365 6c66 2920 203a 0a20 2020  _md(self)  :.   
-0000fb20: 2020 2020 2061 7373 6572 7420 7365 6c66       assert self
-0000fb30: 2e70 6172 7365 720a 2020 2020 2020 2020  .parser.        
-0000fb40: 6e65 775f 6669 6c65 203d 2073 656c 662e  new_file = self.
-0000fb50: 7061 7273 6572 2e72 6571 7569 7265 2822  parser.require("
-0000fb60: 6e61 6d65 222c 2035 3132 290a 2020 2020  name", 512).    
-0000fb70: 2020 2020 7365 6c66 2e70 6172 7365 722e      self.parser.
-0000fb80: 6472 6f70 2829 0a0a 2020 2020 2020 2020  drop()..        
-0000fb90: 6e75 6c6c 7772 6974 6520 3d20 7365 6c66  nullwrite = self
-0000fba0: 2e61 7267 732e 6e77 0a20 2020 2020 2020  .args.nw.       
-0000fbb0: 2076 6673 2c20 7265 6d20 3d20 7365 6c66   vfs, rem = self
-0000fbc0: 2e61 7372 762e 7666 732e 6765 7428 7365  .asrv.vfs.get(se
-0000fbd0: 6c66 2e76 7061 7468 2c20 7365 6c66 2e75  lf.vpath, self.u
-0000fbe0: 6e61 6d65 2c20 4661 6c73 652c 2054 7275  name, False, Tru
-0000fbf0: 6529 0a20 2020 2020 2020 2073 656c 662e  e).        self.
-0000fc00: 5f61 7373 6572 745f 7361 6665 5f72 656d  _assert_safe_rem
-0000fc10: 2872 656d 290a 0a20 2020 2020 2020 2069  (rem)..        i
-0000fc20: 6620 6e6f 7420 6e65 775f 6669 6c65 2e65  f not new_file.e
-0000fc30: 6e64 7377 6974 6828 222e 6d64 2229 3a0a  ndswith(".md"):.
-0000fc40: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0000fc50: 6669 6c65 202b 3d20 222e 6d64 220a 0a20  file += ".md".. 
-0000fc60: 2020 2020 2020 2073 616e 6974 697a 6564         sanitized
-0000fc70: 203d 2073 616e 6974 697a 655f 666e 286e   = sanitize_fn(n
-0000fc80: 6577 5f66 696c 652c 2022 222c 205b 5d29  ew_file, "", [])
-0000fc90: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000fca0: 206e 756c 6c77 7269 7465 3a0a 2020 2020   nullwrite:.    
-0000fcb0: 2020 2020 2020 2020 6664 6972 203d 2076          fdir = v
-0000fcc0: 6673 2e63 616e 6f6e 6963 616c 2872 656d  fs.canonical(rem
-0000fcd0: 290a 2020 2020 2020 2020 2020 2020 666e  ).            fn
-0000fce0: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-0000fcf0: 6664 6972 2c20 7361 6e69 7469 7a65 6429  fdir, sanitized)
-0000fd00: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0000fd10: 2062 6f73 2e70 6174 682e 6578 6973 7473   bos.path.exists
-0000fd20: 2866 6e29 3a0a 2020 2020 2020 2020 2020  (fn):.          
-0000fd30: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
-0000fd40: 6163 2835 3030 2c20 2274 6861 7420 6669  ac(500, "that fi
-0000fd50: 6c65 2065 7869 7374 7320 616c 7265 6164  le exists alread
-0000fd60: 7922 290a 0a20 2020 2020 2020 2020 2020  y")..           
-0000fd70: 2077 6974 6820 6f70 656e 2866 7365 6e63   with open(fsenc
-0000fd80: 2866 6e29 2c20 2277 6222 2920 6173 2066  (fn), "wb") as f
-0000fd90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000fda0: 2020 662e 7772 6974 6528 6222 6047 5255    f.write(b"`GRU
-0000fdb0: 4e4e 5552 605c 6e22 290a 0a20 2020 2020  NNUR`\n")..     
-0000fdc0: 2020 2076 7061 7468 203d 2022 7b7d 2f7b     vpath = "{}/{
-0000fdd0: 7d22 2e66 6f72 6d61 7428 7365 6c66 2e76  }".format(self.v
-0000fde0: 7061 7468 2c20 7361 6e69 7469 7a65 6429  path, sanitized)
-0000fdf0: 2e6c 7374 7269 7028 222f 2229 0a20 2020  .lstrip("/").   
-0000fe00: 2020 2020 2073 656c 662e 7265 6469 7265       self.redire
-0000fe10: 6374 2876 7061 7468 2c20 223f 6564 6974  ct(vpath, "?edit
-0000fe20: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-0000fe30: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
-0000fe40: 7570 6c6f 6164 5f66 6c61 6773 2873 656c  upload_flags(sel
-0000fe50: 662c 2076 6673 2029 2020 2020 2020 3a0a  f, vfs )      :.
-0000fe60: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000fe70: 6172 6773 2e6e 773a 0a20 2020 2020 2020  args.nw:.       
-0000fe80: 2020 2020 2072 6e64 203d 2030 0a20 2020       rnd = 0.   
-0000fe90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000fea0: 2020 2020 2020 2072 6e64 203d 2069 6e74         rnd = int
-0000feb0: 2873 656c 662e 7570 6172 616d 2e67 6574  (self.uparam.get
-0000fec0: 2822 7261 6e64 2229 206f 7220 7365 6c66  ("rand") or self
-0000fed0: 2e68 6561 6465 7273 2e67 6574 2822 7261  .headers.get("ra
-0000fee0: 6e64 2229 206f 7220 3029 0a20 2020 2020  nd") or 0).     
-0000fef0: 2020 2020 2020 2069 6620 7666 732e 666c         if vfs.fl
-0000ff00: 6167 732e 6765 7428 2272 616e 6422 293a  ags.get("rand"):
-0000ff10: 2020 2320 666f 7263 652d 656e 6162 6c65    # force-enable
-0000ff20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ff30: 2072 6e64 203d 206d 6178 2872 6e64 2c20   rnd = max(rnd, 
-0000ff40: 7666 732e 666c 6167 735b 226e 7261 6e64  vfs.flags["nrand
-0000ff50: 225d 290a 0a20 2020 2020 2020 2061 6320  "])..        ac 
-0000ff60: 3d20 7365 6c66 2e75 7061 7261 6d2e 6765  = self.uparam.ge
-0000ff70: 7428 0a20 2020 2020 2020 2020 2020 2022  t(.            "
-0000ff80: 7761 6e74 222c 2073 656c 662e 6865 6164  want", self.head
-0000ff90: 6572 732e 6765 7428 2261 6363 6570 7422  ers.get("accept"
-0000ffa0: 2c20 2222 292e 6c6f 7765 7228 292e 7370  , "").lower().sp
-0000ffb0: 6c69 7428 223b 2229 5b2d 315d 0a20 2020  lit(";")[-1].   
-0000ffc0: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-0000ffd0: 616e 745f 7572 6c20 3d20 6163 203d 3d20  ant_url = ac == 
-0000ffe0: 2275 726c 220a 2020 2020 2020 2020 7a73  "url".        zs
-0000fff0: 203d 2073 656c 662e 7570 6172 616d 2e67   = self.uparam.g
-00010000: 6574 2822 6c69 6665 222c 2073 656c 662e  et("life", self.
-00010010: 6865 6164 6572 732e 6765 7428 226c 6966  headers.get("lif
-00010020: 6522 2c20 2222 2929 0a20 2020 2020 2020  e", "")).       
-00010030: 2069 6620 7a73 3a0a 2020 2020 2020 2020   if zs:.        
-00010040: 2020 2020 766c 6966 6520 3d20 7666 732e      vlife = vfs.
-00010050: 666c 6167 732e 6765 7428 226c 6966 6574  flags.get("lifet
-00010060: 696d 6522 2920 6f72 2030 0a20 2020 2020  ime") or 0.     
-00010070: 2020 2020 2020 206c 6966 6574 696d 6520         lifetime 
-00010080: 3d20 6d61 7828 302c 2069 6e74 2876 6c69  = max(0, int(vli
-00010090: 6665 202d 2069 6e74 287a 7329 2929 0a20  fe - int(zs))). 
-000100a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000100b0: 2020 2020 2020 2020 206c 6966 6574 696d           lifetim
-000100c0: 6520 3d20 300a 0a20 2020 2020 2020 2072  e = 0..        r
-000100d0: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
-000100e0: 2020 2020 726e 642c 0a20 2020 2020 2020      rnd,.       
-000100f0: 2020 2020 2077 616e 745f 7572 6c2c 0a20       want_url,. 
-00010100: 2020 2020 2020 2020 2020 206c 6966 6574             lifet
-00010110: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
-00010120: 2076 6673 2e66 6c61 6773 2e67 6574 2822   vfs.flags.get("
-00010130: 7862 7522 2920 6f72 205b 5d2c 0a20 2020  xbu") or [],.   
-00010140: 2020 2020 2020 2020 2076 6673 2e66 6c61           vfs.fla
-00010150: 6773 2e67 6574 2822 7861 7522 2920 6f72  gs.get("xau") or
-00010160: 205b 5d2c 0a20 2020 2020 2020 2029 0a0a   [],.        )..
-00010170: 2020 2020 6465 6620 6861 6e64 6c65 5f70      def handle_p
-00010180: 6c61 696e 5f75 706c 6f61 6428 7365 6c66  lain_upload(self
-00010190: 2920 203a 0a20 2020 2020 2020 2061 7373  )  :.        ass
-000101a0: 6572 7420 7365 6c66 2e70 6172 7365 720a  ert self.parser.
-000101b0: 2020 2020 2020 2020 6e75 6c6c 7772 6974          nullwrit
-000101c0: 6520 3d20 7365 6c66 2e61 7267 732e 6e77  e = self.args.nw
-000101d0: 0a20 2020 2020 2020 2076 6673 2c20 7265  .        vfs, re
-000101e0: 6d20 3d20 7365 6c66 2e61 7372 762e 7666  m = self.asrv.vf
-000101f0: 732e 6765 7428 7365 6c66 2e76 7061 7468  s.get(self.vpath
-00010200: 2c20 7365 6c66 2e75 6e61 6d65 2c20 4661  , self.uname, Fa
-00010210: 6c73 652c 2054 7275 6529 0a20 2020 2020  lse, True).     
-00010220: 2020 2073 656c 662e 5f61 7373 6572 745f     self._assert_
-00010230: 7361 6665 5f72 656d 2872 656d 290a 0a20  safe_rem(rem).. 
-00010240: 2020 2020 2020 2075 706c 6f61 645f 7670         upload_vp
-00010250: 6174 6820 3d20 7365 6c66 2e76 7061 7468  ath = self.vpath
-00010260: 0a20 2020 2020 2020 206c 696d 203d 2076  .        lim = v
-00010270: 6673 2e67 6574 5f64 6276 2872 656d 295b  fs.get_dbv(rem)[
-00010280: 305d 2e6c 696d 0a20 2020 2020 2020 2066  0].lim.        f
-00010290: 6469 725f 6261 7365 203d 2076 6673 2e63  dir_base = vfs.c
-000102a0: 616e 6f6e 6963 616c 2872 656d 290a 2020  anonical(rem).  
-000102b0: 2020 2020 2020 6966 206c 696d 3a0a 2020        if lim:.  
-000102c0: 2020 2020 2020 2020 2020 6664 6972 5f62            fdir_b
-000102d0: 6173 652c 2072 656d 203d 206c 696d 2e61  ase, rem = lim.a
-000102e0: 6c6c 2873 656c 662e 6970 2c20 7265 6d2c  ll(self.ip, rem,
-000102f0: 202d 312c 2066 6469 725f 6261 7365 290a   -1, fdir_base).
-00010300: 2020 2020 2020 2020 2020 2020 7570 6c6f              uplo
-00010310: 6164 5f76 7061 7468 203d 2022 7b7d 2f7b  ad_vpath = "{}/{
-00010320: 7d22 2e66 6f72 6d61 7428 7666 732e 7670  }".format(vfs.vp
-00010330: 6174 682c 2072 656d 292e 7374 7269 7028  ath, rem).strip(
-00010340: 222f 2229 0a20 2020 2020 2020 2020 2020  "/").           
-00010350: 2069 6620 6e6f 7420 6e75 6c6c 7772 6974   if not nullwrit
-00010360: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00010370: 2020 2062 6f73 2e6d 616b 6564 6972 7328     bos.makedirs(
-00010380: 6664 6972 5f62 6173 6529 0a0a 2020 2020  fdir_base)..    
-00010390: 2020 2020 726e 642c 2077 616e 745f 7572      rnd, want_ur
-000103a0: 6c2c 206c 6966 6574 696d 652c 2078 6275  l, lifetime, xbu
-000103b0: 2c20 7861 7520 3d20 7365 6c66 2e75 706c  , xau = self.upl
-000103c0: 6f61 645f 666c 6167 7328 7666 7329 0a0a  oad_flags(vfs)..
-000103d0: 2020 2020 2020 2020 6669 6c65 7320 2020          files   
-000103e0: 2020 2020 3d20 5b5d 0a20 2020 2020 2020      = [].       
-000103f0: 2023 2073 7a2c 2073 6861 5f68 6578 2c20   # sz, sha_hex, 
-00010400: 7368 615f 6236 342c 2070 5f66 696c 652c  sha_b64, p_file,
-00010410: 2066 6e61 6d65 2c20 6162 7370 6174 680a   fname, abspath.
-00010420: 2020 2020 2020 2020 6572 726d 7367 203d          errmsg =
-00010430: 2022 220a 2020 2020 2020 2020 6469 7020   "".        dip 
-00010440: 3d20 7365 6c66 2e64 6970 2829 0a20 2020  = self.dip().   
-00010450: 2020 2020 2074 3020 3d20 7469 6d65 2e74       t0 = time.t
-00010460: 696d 6528 290a 2020 2020 2020 2020 7472  ime().        tr
-00010470: 793a 0a20 2020 2020 2020 2020 2020 2061  y:.            a
-00010480: 7373 6572 7420 7365 6c66 2e70 6172 7365  ssert self.parse
-00010490: 722e 6765 6e0a 2020 2020 2020 2020 2020  r.gen.          
-000104a0: 2020 666f 7220 6e66 696c 652c 2028 705f    for nfile, (p_
-000104b0: 6669 656c 642c 2070 5f66 696c 652c 2070  field, p_file, p
-000104c0: 5f64 6174 6129 2069 6e20 656e 756d 6572  _data) in enumer
-000104d0: 6174 6528 7365 6c66 2e70 6172 7365 722e  ate(self.parser.
-000104e0: 6765 6e29 3a0a 2020 2020 2020 2020 2020  gen):.          
-000104f0: 2020 2020 2020 6966 206e 6f74 2070 5f66        if not p_f
-00010500: 696c 653a 0a20 2020 2020 2020 2020 2020  ile:.           
-00010510: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00010520: 6728 2264 6973 6361 7264 696e 6720 696e  g("discarding in
-00010530: 636f 6d69 6e67 2066 696c 6520 7769 7468  coming file with
-00010540: 6f75 7420 6669 6c65 6e61 6d65 2229 0a20  out filename"). 
-00010550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010560: 2020 2023 2066 616c 6c74 6872 6f75 6768     # fallthrough
-00010570: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010580: 2020 6664 6972 203d 2066 6469 725f 6261    fdir = fdir_ba
-00010590: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-000105a0: 2020 2066 6e61 6d65 203d 2073 616e 6974     fname = sanit
-000105b0: 697a 655f 666e 280a 2020 2020 2020 2020  ize_fn(.        
-000105c0: 2020 2020 2020 2020 2020 2020 705f 6669              p_fi
-000105d0: 6c65 206f 7220 2222 2c20 2222 2c20 5b22  le or "", "", ["
-000105e0: 2e70 726f 6c6f 6775 652e 6874 6d6c 222c  .prologue.html",
-000105f0: 2022 2e65 7069 6c6f 6775 652e 6874 6d6c   ".epilogue.html
-00010600: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00010610: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00010620: 2020 2020 2069 6620 705f 6669 6c65 2061       if p_file a
-00010630: 6e64 206e 6f74 206e 756c 6c77 7269 7465  nd not nullwrite
-00010640: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010650: 2020 2020 2020 6966 2072 6e64 3a0a 2020        if rnd:.  
-00010660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010670: 2020 2020 2020 666e 616d 6520 3d20 7261        fname = ra
-00010680: 6e64 5f6e 616d 6528 6664 6972 2c20 666e  nd_name(fdir, fn
-00010690: 616d 652c 2072 6e64 290a 0a20 2020 2020  ame, rnd)..     
-000106a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000106b0: 6620 6e6f 7420 626f 732e 7061 7468 2e69  f not bos.path.i
-000106c0: 7364 6972 2866 6469 7229 3a0a 2020 2020  sdir(fdir):.    
-000106d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106e0: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
-000106f0: 2834 3034 2c20 2274 6861 7420 666f 6c64  (404, "that fold
-00010700: 6572 2064 6f65 7320 6e6f 7420 6578 6973  er does not exis
-00010710: 7422 290a 0a20 2020 2020 2020 2020 2020  t")..           
-00010720: 2020 2020 2020 2020 2073 7566 6669 7820           suffix 
-00010730: 3d20 222d 7b3a 2e36 667d 2d7b 7d22 2e66  = "-{:.6f}-{}".f
-00010740: 6f72 6d61 7428 7469 6d65 2e74 696d 6528  ormat(time.time(
-00010750: 292c 2064 6970 290a 2020 2020 2020 2020  ), dip).        
-00010760: 2020 2020 2020 2020 2020 2020 6f70 656e              open
-00010770: 5f61 7267 7320 3d20 7b22 6664 6972 223a  _args = {"fdir":
-00010780: 2066 6469 722c 2022 7375 6666 6978 223a   fdir, "suffix":
-00010790: 2073 7566 6669 787d 0a0a 2020 2020 2020   suffix}..      
-000107a0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000107b0: 7265 7365 7276 6520 6465 7374 696e 6174  reserve destinat
-000107c0: 696f 6e20 6669 6c65 6e61 6d65 0a20 2020  ion filename.   
-000107d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107e0: 2077 6974 6820 7265 6e5f 6f70 656e 2866   with ren_open(f
-000107f0: 6e61 6d65 2c20 2277 6222 2c20 6664 6972  name, "wb", fdir
-00010800: 3d66 6469 722c 2073 7566 6669 783d 7375  =fdir, suffix=su
-00010810: 6666 6978 2920 6173 207a 6677 3a0a 2020  ffix) as zfw:.  
-00010820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010830: 2020 2020 2020 666e 616d 6520 3d20 7a66        fname = zf
-00010840: 775b 226f 727a 225d 5b31 5d0a 0a20 2020  w["orz"][1]..   
-00010850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010860: 2074 6e61 6d20 3d20 666e 616d 6520 2b20   tnam = fname + 
-00010870: 222e 5041 5254 4941 4c22 0a20 2020 2020  ".PARTIAL".     
-00010880: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00010890: 6620 7365 6c66 2e61 7267 732e 646f 7470  f self.args.dotp
-000108a0: 6172 743a 0a20 2020 2020 2020 2020 2020  art:.           
-000108b0: 2020 2020 2020 2020 2020 2020 2074 6e61               tna
-000108c0: 6d20 3d20 222e 2220 2b20 746e 616d 0a0a  m = "." + tnam..
-000108d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108e0: 2020 2020 6162 7370 6174 6820 3d20 6f73      abspath = os
-000108f0: 2e70 6174 682e 6a6f 696e 2866 6469 722c  .path.join(fdir,
-00010900: 2066 6e61 6d65 290a 2020 2020 2020 2020   fname).        
-00010910: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00010920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010930: 2020 6f70 656e 5f61 7267 7320 3d20 7b7d    open_args = {}
-00010940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010950: 2020 2020 2074 6e61 6d20 3d20 666e 616d       tnam = fnam
-00010960: 6520 3d20 6f73 2e64 6576 6e75 6c6c 0a20  e = os.devnull. 
-00010970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010980: 2020 2066 6469 7220 3d20 6162 7370 6174     fdir = abspat
-00010990: 6820 3d20 2222 0a0a 2020 2020 2020 2020  h = ""..        
-000109a0: 2020 2020 2020 2020 6966 2078 6275 3a0a          if xbu:.
-000109b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109c0: 2020 2020 6174 203d 2074 696d 652e 7469      at = time.ti
-000109d0: 6d65 2829 202d 206c 6966 6574 696d 650a  me() - lifetime.
-000109e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109f0: 2020 2020 6966 206e 6f74 2072 756e 686f      if not runho
-00010a00: 6f6b 280a 2020 2020 2020 2020 2020 2020  ok(.            
-00010a10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010a20: 2e6c 6f67 2c0a 2020 2020 2020 2020 2020  .log,.          
-00010a30: 2020 2020 2020 2020 2020 2020 2020 7862                xb
-00010a40: 752c 0a20 2020 2020 2020 2020 2020 2020  u,.             
-00010a50: 2020 2020 2020 2020 2020 2061 6273 7061             abspa
-00010a60: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-00010a70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00010a80: 2e76 7061 7468 2c0a 2020 2020 2020 2020  .vpath,.        
-00010a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010aa0: 7365 6c66 2e68 6f73 742c 0a20 2020 2020  self.host,.     
-00010ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ac0: 2020 2073 656c 662e 756e 616d 652c 0a20     self.uname,. 
-00010ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ae0: 2020 2020 2020 2061 742c 0a20 2020 2020         at,.     
-00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b00: 2020 2030 2c0a 2020 2020 2020 2020 2020     0,.          
-00010b10: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00010b20: 6c66 2e69 702c 0a20 2020 2020 2020 2020  lf.ip,.         
-00010b30: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00010b40: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00010b50: 2020 2020 2020 2020 2020 2022 222c 0a20             "",. 
-00010b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b70: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00010b80: 2020 2020 2020 2020 2020 2020 2020 7420                t 
-00010b90: 3d20 2275 706c 6f61 6420 626c 6f63 6b65  = "upload blocke
-00010ba0: 6420 6279 2078 6275 2073 6572 7665 7220  d by xbu server 
-00010bb0: 636f 6e66 6967 220a 2020 2020 2020 2020  config".        
-00010bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bd0: 7365 6c66 2e6c 6f67 2874 2c20 3129 0a20  self.log(t, 1). 
-00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bf0: 2020 2020 2020 2072 6169 7365 2050 6562         raise Peb
-00010c00: 6b61 6328 3430 332c 2074 290a 0a20 2020  kac(403, t)..   
-00010c10: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00010c20: 6c69 6d3a 0a20 2020 2020 2020 2020 2020  lim:.           
-00010c30: 2020 2020 2020 2020 206c 696d 2e63 686b           lim.chk
-00010c40: 5f62 7570 2873 656c 662e 6970 290a 2020  _bup(self.ip).  
-00010c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c60: 2020 6c69 6d2e 6368 6b5f 6e75 7028 7365    lim.chk_nup(se
-00010c70: 6c66 2e69 7029 0a0a 2020 2020 2020 2020  lf.ip)..        
-00010c80: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00010c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ca0: 206d 6178 5f73 7a20 3d20 300a 2020 2020   max_sz = 0.    
-00010cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cc0: 6966 206c 696d 3a0a 2020 2020 2020 2020  if lim:.        
-00010cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ce0: 7631 203d 206c 696d 2e73 6d61 780a 2020  v1 = lim.smax.  
+00000b40: 662e 756e 616d 6520 3d20 2220 220a 2020  f.uname = " ".  
+00000b50: 2020 2020 2020 7365 6c66 2e70 7720 3d20        self.pw = 
+00000b60: 2220 220a 2020 2020 2020 2020 7365 6c66  " ".        self
+00000b70: 2e72 766f 6c20 3d20 5b22 2022 5d0a 2020  .rvol = [" "].  
+00000b80: 2020 2020 2020 7365 6c66 2e77 766f 6c20        self.wvol 
+00000b90: 3d20 5b22 2022 5d0a 2020 2020 2020 2020  = [" "].        
+00000ba0: 7365 6c66 2e6d 766f 6c20 3d20 5b22 2022  self.mvol = [" "
+00000bb0: 5d0a 2020 2020 2020 2020 7365 6c66 2e64  ].        self.d
+00000bc0: 766f 6c20 3d20 5b22 2022 5d0a 2020 2020  vol = [" "].    
+00000bd0: 2020 2020 7365 6c66 2e67 766f 6c20 3d20      self.gvol = 
+00000be0: 5b22 2022 5d0a 2020 2020 2020 2020 7365  [" "].        se
+00000bf0: 6c66 2e75 7076 6f6c 203d 205b 2220 225d  lf.upvol = [" "]
+00000c00: 0a20 2020 2020 2020 2073 656c 662e 646f  .        self.do
+00000c10: 5f6c 6f67 203d 2054 7275 650a 2020 2020  _log = True.    
+00000c20: 2020 2020 7365 6c66 2e63 616e 5f72 6561      self.can_rea
+00000c30: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
+00000c40: 2020 7365 6c66 2e63 616e 5f77 7269 7465    self.can_write
+00000c50: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00000c60: 2073 656c 662e 6361 6e5f 6d6f 7665 203d   self.can_move =
+00000c70: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+00000c80: 656c 662e 6361 6e5f 6465 6c65 7465 203d  elf.can_delete =
+00000c90: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+00000ca0: 656c 662e 6361 6e5f 6765 7420 3d20 4661  elf.can_get = Fa
+00000cb0: 6c73 650a 2020 2020 2020 2020 7365 6c66  lse.        self
+00000cc0: 2e63 616e 5f75 7067 6574 203d 2046 616c  .can_upget = Fal
+00000cd0: 7365 0a20 2020 2020 2020 2023 2070 6f73  se.        # pos
+00000ce0: 740a 2020 2020 2020 2020 7365 6c66 2e70  t.        self.p
+00000cf0: 6172 7365 7220 203d 204e 6f6e 650a 2020  arser  = None.  
+00000d00: 2020 2020 2020 2320 656e 6420 706c 6163        # end plac
+00000d10: 6568 6f6c 6465 7273 0a0a 2020 2020 2020  eholders..      
+00000d20: 2020 7365 6c66 2e62 7566 737a 203d 2031    self.bufsz = 1
+00000d30: 3032 3420 2a20 3332 0a20 2020 2020 2020  024 * 32.       
+00000d40: 2073 656c 662e 6869 6e74 203d 2022 220a   self.hint = "".
+00000d50: 2020 2020 2020 2020 7365 6c66 2e74 7261          self.tra
+00000d60: 696c 696e 675f 736c 6173 6820 3d20 5472  iling_slash = Tr
+00000d70: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
+00000d80: 6f75 745f 6865 6164 6572 6c69 7374 2020  out_headerlist  
+00000d90: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+00000da0: 6c66 2e6f 7574 5f68 6561 6465 7273 203d  lf.out_headers =
+00000db0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00000dc0: 5661 7279 223a 2022 4f72 6967 696e 2c20  Vary": "Origin, 
+00000dd0: 5057 2c20 436f 6f6b 6965 222c 0a20 2020  PW, Cookie",.   
+00000de0: 2020 2020 2020 2020 2022 4361 6368 652d           "Cache-
+00000df0: 436f 6e74 726f 6c22 3a20 226e 6f2d 7374  Control": "no-st
+00000e00: 6f72 652c 206d 6178 2d61 6765 3d30 222c  ore, max-age=0",
+00000e10: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+00000e20: 2020 2068 203d 2073 656c 662e 6172 6773     h = self.args
+00000e30: 2e68 746d 6c5f 6865 6164 0a20 2020 2020  .html_head.     
+00000e40: 2020 2069 6620 7365 6c66 2e61 7267 732e     if self.args.
+00000e50: 6e6f 5f72 6f62 6f74 733a 0a20 2020 2020  no_robots:.     
+00000e60: 2020 2020 2020 2068 203d 204d 4554 415f         h = META_
+00000e70: 4e4f 424f 5453 202b 2028 2822 5c6e 2220  NOBOTS + (("\n" 
+00000e80: 2b20 6829 2069 6620 6820 656c 7365 2022  + h) if h else "
+00000e90: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
+00000ea0: 656c 662e 6f75 745f 6865 6164 6572 735b  elf.out_headers[
+00000eb0: 2258 2d52 6f62 6f74 732d 5461 6722 5d20  "X-Robots-Tag"] 
+00000ec0: 3d20 226e 6f69 6e64 6578 2c20 6e6f 666f  = "noindex, nofo
+00000ed0: 6c6c 6f77 220a 2020 2020 2020 2020 7365  llow".        se
+00000ee0: 6c66 2e68 746d 6c5f 6865 6164 203d 2068  lf.html_head = h
+00000ef0: 0a0a 2020 2020 6465 6620 6c6f 6728 7365  ..    def log(se
+00000f00: 6c66 2c20 6d73 6720 2c20 6320 2020 3d20  lf, msg , c   = 
+00000f10: 3029 2020 3a0a 2020 2020 2020 2020 7074  0)  :.        pt
+00000f20: 6e20 3d20 7365 6c66 2e61 7372 762e 7265  n = self.asrv.re
+00000f30: 5f70 7764 0a20 2020 2020 2020 2069 6620  _pwd.        if 
+00000f40: 7074 6e20 616e 6420 7074 6e2e 7365 6172  ptn and ptn.sear
+00000f50: 6368 286d 7367 293a 0a20 2020 2020 2020  ch(msg):.       
+00000f60: 2020 2020 206d 7367 203d 2070 746e 2e73       msg = ptn.s
+00000f70: 7562 2873 656c 662e 756e 7077 642c 206d  ub(self.unpwd, m
+00000f80: 7367 290a 0a20 2020 2020 2020 2073 656c  sg)..        sel
+00000f90: 662e 6c6f 675f 6675 6e63 2873 656c 662e  f.log_func(self.
+00000fa0: 6c6f 675f 7372 632c 206d 7367 2c20 6329  log_src, msg, c)
+00000fb0: 0a0a 2020 2020 6465 6620 756e 7077 6428  ..    def unpwd(
+00000fc0: 7365 6c66 2c20 6d20 2920 203a 0a20 2020  self, m )  :.   
+00000fd0: 2020 2020 2061 2c20 6220 3d20 6d2e 6772       a, b = m.gr
+00000fe0: 6f75 7073 2829 0a20 2020 2020 2020 2072  oups().        r
+00000ff0: 6574 7572 6e20 223d 5c30 3333 5b37 6d20  eturn "=\033[7m 
+00001000: 7b7d 205c 3033 335b 3237 6d7b 7d22 2e66  {} \033[27m{}".f
+00001010: 6f72 6d61 7428 7365 6c66 2e61 7372 762e  ormat(self.asrv.
+00001020: 6961 6363 745b 615d 2c20 6229 0a0a 2020  iacct[a], b)..  
+00001030: 2020 6465 6620 5f63 6865 636b 5f6e 6f6e    def _check_non
+00001040: 6661 7461 6c28 7365 6c66 2c20 6578 202c  fatal(self, ex ,
+00001050: 2070 6f73 7420 2920 203a 0a20 2020 2020   post )  :.     
+00001060: 2020 2069 6620 706f 7374 3a0a 2020 2020     if post:.    
+00001070: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+00001080: 782e 636f 6465 203c 2033 3030 0a0a 2020  x.code < 300..  
+00001090: 2020 2020 2020 7265 7475 726e 2065 782e        return ex.
+000010a0: 636f 6465 203c 2034 3030 206f 7220 6578  code < 400 or ex
+000010b0: 2e63 6f64 6520 696e 205b 3430 342c 2034  .code in [404, 4
+000010c0: 3239 5d0a 0a20 2020 2064 6566 205f 6173  29]..    def _as
+000010d0: 7365 7274 5f73 6166 655f 7265 6d28 7365  sert_safe_rem(se
+000010e0: 6c66 2c20 7265 6d20 2920 203a 0a20 2020  lf, rem )  :.   
+000010f0: 2020 2020 2023 2073 616e 6974 7920 6368       # sanity ch
+00001100: 6563 6b20 746f 2070 7265 7665 6e74 2061  eck to prevent a
+00001110: 6e79 2064 6973 6173 7465 7273 0a20 2020  ny disasters.   
+00001120: 2020 2020 2069 6620 7265 6d2e 7374 6172       if rem.star
+00001130: 7473 7769 7468 2822 2f22 2920 6f72 2072  tswith("/") or r
+00001140: 656d 2e73 7461 7274 7377 6974 6828 222e  em.startswith(".
+00001150: 2e2f 2229 206f 7220 222f 2e2e 2f22 2069  ./") or "/../" i
+00001160: 6e20 7265 6d3a 0a20 2020 2020 2020 2020  n rem:.         
+00001170: 2020 2072 6169 7365 2045 7863 6570 7469     raise Excepti
+00001180: 6f6e 2822 7468 6174 2077 6173 2063 6c6f  on("that was clo
+00001190: 7365 2229 0a0a 2020 2020 6465 6620 5f67  se")..    def _g
+000011a0: 656e 5f66 6b28 7365 6c66 2c20 7361 6c74  en_fk(self, salt
+000011b0: 202c 2066 7370 6174 6820 2c20 6673 697a   , fspath , fsiz
+000011c0: 6520 2c20 696e 6f64 6520 2920 203a 0a20  e , inode )  :. 
+000011d0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
+000011e0: 6e5f 6669 6c65 6b65 795f 6462 6728 7361  n_filekey_dbg(sa
+000011f0: 6c74 2c20 6673 7061 7468 2c20 6673 697a  lt, fspath, fsiz
+00001200: 652c 2069 6e6f 6465 2c20 7365 6c66 2e6c  e, inode, self.l
+00001210: 6f67 2c20 7365 6c66 2e61 7267 732e 6c6f  og, self.args.lo
+00001220: 675f 666b 290a 0a20 2020 2064 6566 206a  g_fk)..    def j
+00001230: 3273 2873 656c 662c 206e 616d 6520 2c20  2s(self, name , 
+00001240: 2a2a 6b61 2029 2020 3a0a 2020 2020 2020  **ka )  :.      
+00001250: 2020 7470 6c20 3d20 7365 6c66 2e63 6f6e    tpl = self.con
+00001260: 6e2e 6873 7276 2e6a 325b 6e61 6d65 5d0a  n.hsrv.j2[name].
+00001270: 2020 2020 2020 2020 6b61 5b22 7222 5d20          ka["r"] 
+00001280: 3d20 7365 6c66 2e61 7267 732e 5352 2069  = self.args.SR i
+00001290: 6620 7365 6c66 2e69 735f 7670 726f 7869  f self.is_vproxi
+000012a0: 6564 2065 6c73 6520 2222 0a20 2020 2020  ed else "".     
+000012b0: 2020 206b 615b 2274 7322 5d20 3d20 7365     ka["ts"] = se
+000012c0: 6c66 2e63 6f6e 6e2e 6873 7276 2e63 6163  lf.conn.hsrv.cac
+000012d0: 6865 6275 7374 6572 2829 0a20 2020 2020  hebuster().     
+000012e0: 2020 206b 615b 226c 616e 6722 5d20 3d20     ka["lang"] = 
+000012f0: 7365 6c66 2e61 7267 732e 6c61 6e67 0a20  self.args.lang. 
+00001300: 2020 2020 2020 206b 615b 2266 6176 6963         ka["favic
+00001310: 6f22 5d20 3d20 7365 6c66 2e61 7267 732e  o"] = self.args.
+00001320: 6661 7669 636f 0a20 2020 2020 2020 206b  favico.        k
+00001330: 615b 2273 7663 6e61 6d65 225d 203d 2073  a["svcname"] = s
+00001340: 656c 662e 6172 6773 2e64 6f63 7469 746c  elf.args.doctitl
+00001350: 650a 2020 2020 2020 2020 6b61 5b22 6874  e.        ka["ht
+00001360: 6d6c 5f68 6561 6422 5d20 3d20 7365 6c66  ml_head"] = self
+00001370: 2e68 746d 6c5f 6865 6164 0a20 2020 2020  .html_head.     
+00001380: 2020 2072 6574 7572 6e20 7470 6c2e 7265     return tpl.re
+00001390: 6e64 6572 282a 2a6b 6129 2020 2320 7479  nder(**ka)  # ty
+000013a0: 7065 3a20 6967 6e6f 7265 0a0a 2020 2020  pe: ignore..    
+000013b0: 6465 6620 6a32 6a28 7365 6c66 2c20 6e61  def j2j(self, na
+000013c0: 6d65 2029 2020 3a0a 2020 2020 2020 2020  me )  :.        
+000013d0: 7265 7475 726e 2073 656c 662e 636f 6e6e  return self.conn
+000013e0: 2e68 7372 762e 6a32 5b6e 616d 655d 0a0a  .hsrv.j2[name]..
+000013f0: 2020 2020 6465 6620 7275 6e28 7365 6c66      def run(self
+00001400: 2920 203a 0a20 2020 2020 2020 2022 2222  )  :.        """
+00001410: 7265 7475 726e 7320 7472 7565 2069 6620  returns true if 
+00001420: 636f 6e6e 6563 7469 6f6e 2063 616e 2062  connection can b
+00001430: 6520 7265 7573 6564 2222 220a 2020 2020  e reused""".    
+00001440: 2020 2020 7365 6c66 2e6b 6565 7061 6c69      self.keepali
+00001450: 7665 203d 2046 616c 7365 0a20 2020 2020  ve = False.     
+00001460: 2020 2073 656c 662e 6973 5f68 7474 7073     self.is_https
+00001470: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00001480: 2073 656c 662e 6865 6164 6572 7320 3d20   self.headers = 
+00001490: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
+000014a0: 6869 6e74 203d 2022 220a 0a20 2020 2020  hint = ""..     
+000014b0: 2020 2069 6620 7365 6c66 2e69 735f 6261     if self.is_ba
+000014c0: 6e6e 6564 2829 3a0a 2020 2020 2020 2020  nned():.        
+000014d0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+000014e0: 0a0a 2020 2020 2020 2020 7472 793a 0a20  ..        try:. 
+000014f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001500: 732e 7365 7474 696d 656f 7574 2832 290a  s.settimeout(2).
+00001510: 2020 2020 2020 2020 2020 2020 6865 6164              head
+00001520: 6572 6c69 6e65 7320 3d20 7265 6164 5f68  erlines = read_h
+00001530: 6561 6465 7228 7365 6c66 2e73 722c 2073  eader(self.sr, s
+00001540: 656c 662e 6172 6773 2e73 5f74 6865 6164  elf.args.s_thead
+00001550: 2c20 7365 6c66 2e61 7267 732e 735f 7468  , self.args.s_th
+00001560: 6561 6429 0a20 2020 2020 2020 2020 2020  ead).           
+00001570: 2073 656c 662e 696e 5f68 6472 5f72 6563   self.in_hdr_rec
+00001580: 7620 3d20 4661 6c73 650a 2020 2020 2020  v = False.      
+00001590: 2020 2020 2020 6966 206e 6f74 2068 6561        if not hea
+000015a0: 6465 726c 696e 6573 3a0a 2020 2020 2020  derlines:.      
+000015b0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000015c0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+000015d0: 2020 2020 6966 206e 6f74 2068 6561 6465      if not heade
+000015e0: 726c 696e 6573 5b30 5d3a 0a20 2020 2020  rlines[0]:.     
+000015f0: 2020 2020 2020 2020 2020 2023 2073 6565             # see
+00001600: 6e20 6166 7465 7220 6c6f 6769 6e20 7769  n after login wi
+00001610: 7468 2049 4536 2e30 2e32 3930 302e 3535  th IE6.0.2900.55
+00001620: 3132 2e78 7073 702e 3038 3034 3133 2d32  12.xpsp.080413-2
+00001630: 3131 3120 2878 702d 7370 3329 0a20 2020  111 (xp-sp3).   
+00001640: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00001650: 662e 6c6f 6728 2242 5547 3a20 7472 6169  f.log("BUG: trai
+00001660: 6c69 6e67 206e 6577 6c69 6e65 2066 726f  ling newline fro
+00001670: 6d20 7072 6576 696f 7573 2072 6571 7565  m previous reque
+00001680: 7374 222c 2063 3d22 313b 3331 2229 0a20  st", c="1;31"). 
+00001690: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+000016a0: 6561 6465 726c 696e 6573 2e70 6f70 2830  eaderlines.pop(0
+000016b0: 290a 0a20 2020 2020 2020 2020 2020 2074  )..            t
+000016c0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+000016d0: 2020 2020 7365 6c66 2e6d 6f64 652c 2073      self.mode, s
+000016e0: 656c 662e 7265 712c 2073 656c 662e 6874  elf.req, self.ht
+000016f0: 7470 5f76 6572 203d 2068 6561 6465 726c  tp_ver = headerl
+00001700: 696e 6573 5b30 5d2e 7370 6c69 7428 2220  ines[0].split(" 
+00001710: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00001720: 2020 2020 2320 6e6f 726d 616c 697a 6520      # normalize 
+00001730: 696e 636f 6d69 6e67 2068 6561 6465 7273  incoming headers
+00001740: 2074 6f20 6c6f 7765 7263 6173 653b 0a20   to lowercase;. 
+00001750: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00001760: 206f 7574 676f 696e 6720 6865 6164 6572   outgoing header
+00001770: 7320 686f 7765 7665 7220 6172 6520 436f  s however are Co
+00001780: 7272 6563 742d 4361 7365 0a20 2020 2020  rrect-Case.     
+00001790: 2020 2020 2020 2020 2020 2066 6f72 2068             for h
+000017a0: 6561 6465 725f 6c69 6e65 2069 6e20 6865  eader_line in he
+000017b0: 6164 6572 6c69 6e65 735b 313a 5d3a 0a20  aderlines[1:]:. 
+000017c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000017d0: 2020 206b 2c20 7a73 203d 2068 6561 6465     k, zs = heade
+000017e0: 725f 6c69 6e65 2e73 706c 6974 2822 3a22  r_line.split(":"
+000017f0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+00001800: 2020 2020 2020 2020 2073 656c 662e 6865           self.he
+00001810: 6164 6572 735b 6b2e 6c6f 7765 7228 295d  aders[k.lower()]
+00001820: 203d 207a 732e 7374 7269 7028 290a 2020   = zs.strip().  
+00001830: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00001840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00001850: 2020 6d73 6720 3d20 2220 5d5c 6e23 5b20    msg = " ]\n#[ 
+00001860: 222e 6a6f 696e 2868 6561 6465 726c 696e  ".join(headerlin
+00001870: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00001880: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+00001890: 2834 3030 2c20 2262 6164 2068 6561 6465  (400, "bad heade
+000018a0: 7273 3a5c 6e23 5b20 2220 2b20 6d73 6720  rs:\n#[ " + msg 
+000018b0: 2b20 2220 5d22 290a 0a20 2020 2020 2020  + " ]")..       
+000018c0: 2065 7863 6570 7420 5065 626b 6163 2061   except Pebkac a
+000018d0: 7320 6578 3a0a 2020 2020 2020 2020 2020  s ex:.          
+000018e0: 2020 7365 6c66 2e6d 6f64 6520 3d20 2247    self.mode = "G
+000018f0: 4554 220a 2020 2020 2020 2020 2020 2020  ET".            
+00001900: 7365 6c66 2e72 6571 203d 2022 5b6a 756e  self.req = "[jun
+00001910: 6b5d 220a 2020 2020 2020 2020 2020 2020  k]".            
+00001920: 7365 6c66 2e68 7474 705f 7665 7220 3d20  self.http_ver = 
+00001930: 2248 5454 502f 312e 3122 0a20 2020 2020  "HTTP/1.1".     
+00001940: 2020 2020 2020 2023 2073 656c 662e 6c6f         # self.lo
+00001950: 6728 2270 6562 6b61 6320 6174 2068 7474  g("pebkac at htt
+00001960: 7063 6c69 2e72 756e 2023 313a 2022 202b  pcli.run #1: " +
+00001970: 2072 6570 7228 6578 2929 0a20 2020 2020   repr(ex)).     
+00001980: 2020 2020 2020 2073 656c 662e 6b65 6570         self.keep
+00001990: 616c 6976 6520 3d20 4661 6c73 650a 2020  alive = False.  
+000019a0: 2020 2020 2020 2020 2020 6820 3d20 7b22            h = {"
+000019b0: 5757 572d 4175 7468 656e 7469 6361 7465  WWW-Authenticate
+000019c0: 223a 2027 4261 7369 6320 7265 616c 6d3d  ": 'Basic realm=
+000019d0: 2261 2227 7d20 6966 2065 782e 636f 6465  "a"'} if ex.code
+000019e0: 203d 3d20 3430 3120 656c 7365 207b 7d0a   == 401 else {}.
+000019f0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00001a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001a10: 2073 656c 662e 6c6f 7564 5f72 6570 6c79   self.loud_reply
+00001a20: 2875 6e69 636f 6465 2865 7829 2c20 7374  (unicode(ex), st
+00001a30: 6174 7573 3d65 782e 636f 6465 2c20 6865  atus=ex.code, he
+00001a40: 6164 6572 733d 682c 2076 6f6c 7361 6e3d  aders=h, volsan=
+00001a50: 5472 7565 290a 2020 2020 2020 2020 2020  True).          
+00001a60: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00001a70: 662e 6b65 6570 616c 6976 650a 2020 2020  f.keepalive.    
+00001a80: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+00001a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001aa0: 7265 7475 726e 2046 616c 7365 0a0a 2020  return False..  
+00001ab0: 2020 2020 2020 7365 6c66 2e75 6120 3d20        self.ua = 
+00001ac0: 7365 6c66 2e68 6561 6465 7273 2e67 6574  self.headers.get
+00001ad0: 2822 7573 6572 2d61 6765 6e74 222c 2022  ("user-agent", "
+00001ae0: 2229 0a20 2020 2020 2020 2073 656c 662e  ").        self.
+00001af0: 6973 5f72 636c 6f6e 6520 3d20 7365 6c66  is_rclone = self
+00001b00: 2e75 612e 7374 6172 7473 7769 7468 2822  .ua.startswith("
+00001b10: 7263 6c6f 6e65 2f22 290a 0a20 2020 2020  rclone/")..     
+00001b20: 2020 207a 7320 3d20 7365 6c66 2e68 6561     zs = self.hea
+00001b30: 6465 7273 2e67 6574 2822 636f 6e6e 6563  ders.get("connec
+00001b40: 7469 6f6e 222c 2022 2229 2e6c 6f77 6572  tion", "").lower
+00001b50: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
+00001b60: 6b65 6570 616c 6976 6520 3d20 2263 6c6f  keepalive = "clo
+00001b70: 7365 2220 6e6f 7420 696e 207a 7320 616e  se" not in zs an
+00001b80: 6420 280a 2020 2020 2020 2020 2020 2020  d (.            
+00001b90: 7365 6c66 2e68 7474 705f 7665 7220 213d  self.http_ver !=
+00001ba0: 2022 4854 5450 2f31 2e30 2220 6f72 207a   "HTTP/1.0" or z
+00001bb0: 7320 3d3d 2022 6b65 6570 2d61 6c69 7665  s == "keep-alive
+00001bc0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+00001bd0: 2020 2020 7365 6c66 2e69 735f 6874 7470      self.is_http
+00001be0: 7320 3d20 280a 2020 2020 2020 2020 2020  s = (.          
+00001bf0: 2020 7365 6c66 2e68 6561 6465 7273 2e67    self.headers.g
+00001c00: 6574 2822 782d 666f 7277 6172 6465 642d  et("x-forwarded-
+00001c10: 7072 6f74 6f22 2c20 2222 292e 6c6f 7765  proto", "").lowe
+00001c20: 7228 2920 3d3d 2022 6874 7470 7322 206f  r() == "https" o
+00001c30: 7220 7365 6c66 2e74 6c73 0a20 2020 2020  r self.tls.     
+00001c40: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00001c50: 662e 686f 7374 203d 2073 656c 662e 6865  f.host = self.he
+00001c60: 6164 6572 732e 6765 7428 2268 6f73 7422  aders.get("host"
+00001c70: 2920 6f72 2022 220a 2020 2020 2020 2020  ) or "".        
+00001c80: 6966 206e 6f74 2073 656c 662e 686f 7374  if not self.host
+00001c90: 3a0a 2020 2020 2020 2020 2020 2020 7a73  :.            zs
+00001ca0: 203d 2022 2573 3a25 7322 2025 2073 656c   = "%s:%s" % sel
+00001cb0: 662e 732e 6765 7473 6f63 6b6e 616d 6528  f.s.getsockname(
+00001cc0: 295b 3a32 5d0a 2020 2020 2020 2020 2020  )[:2].          
+00001cd0: 2020 7365 6c66 2e68 6f73 7420 3d20 7a73    self.host = zs
+00001ce0: 5b37 3a5d 2069 6620 7a73 2e73 7461 7274  [7:] if zs.start
+00001cf0: 7377 6974 6828 223a 3a66 6666 663a 2229  swith("::ffff:")
+00001d00: 2065 6c73 6520 7a73 0a0a 2020 2020 2020   else zs..      
+00001d10: 2020 6e20 3d20 7365 6c66 2e61 7267 732e    n = self.args.
+00001d20: 7270 726f 7879 0a20 2020 2020 2020 2069  rproxy.        i
+00001d30: 6620 6e3a 0a20 2020 2020 2020 2020 2020  f n:.           
+00001d40: 207a 736f 203d 2073 656c 662e 6865 6164   zso = self.head
+00001d50: 6572 732e 6765 7428 2278 2d66 6f72 7761  ers.get("x-forwa
+00001d60: 7264 6564 2d66 6f72 2229 0a20 2020 2020  rded-for").     
+00001d70: 2020 2020 2020 2069 6620 7a73 6f20 616e         if zso an
+00001d80: 6420 7365 6c66 2e63 6f6e 6e2e 6164 6472  d self.conn.addr
+00001d90: 5b30 5d20 696e 205b 2231 3237 2e30 2e30  [0] in ["127.0.0
+00001da0: 2e31 222c 2022 3a3a 3122 5d3a 0a20 2020  .1", "::1"]:.   
+00001db0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00001dc0: 6e20 3e20 303a 0a20 2020 2020 2020 2020  n > 0:.         
+00001dd0: 2020 2020 2020 2020 2020 206e 202d 3d20             n -= 
+00001de0: 310a 0a20 2020 2020 2020 2020 2020 2020  1..             
+00001df0: 2020 207a 736c 203d 207a 736f 2e73 706c     zsl = zso.spl
+00001e00: 6974 2822 2c22 290a 2020 2020 2020 2020  it(",").        
+00001e10: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00001e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001e30: 2073 656c 662e 6970 203d 207a 736c 5b6e   self.ip = zsl[n
+00001e40: 5d2e 7374 7269 7028 290a 2020 2020 2020  ].strip().      
+00001e50: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00001e60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00001e70: 2020 2020 2020 7365 6c66 2e69 7020 3d20        self.ip = 
+00001e80: 7a73 6c5b 305d 2e73 7472 6970 2829 0a20  zsl[0].strip(). 
+00001e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ea0: 2020 2074 203d 2022 7270 726f 7879 3d7b     t = "rproxy={
+00001eb0: 7d20 6f6f 6220 782d 6677 6420 7b7d 220a  } oob x-fwd {}".
+00001ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ed0: 2020 2020 7365 6c66 2e6c 6f67 2874 2e66      self.log(t.f
+00001ee0: 6f72 6d61 7428 7365 6c66 2e61 7267 732e  ormat(self.args.
+00001ef0: 7270 726f 7879 2c20 7a73 6f29 2c20 633d  rproxy, zso), c=
+00001f00: 3329 0a0a 2020 2020 2020 2020 2020 2020  3)..            
+00001f10: 2020 2020 7365 6c66 2e6c 6f67 5f73 7263      self.log_src
+00001f20: 203d 2073 656c 662e 636f 6e6e 2e73 6574   = self.conn.set
+00001f30: 5f72 7072 6f78 7928 7365 6c66 2e69 7029  _rproxy(self.ip)
+00001f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001f50: 2073 656c 662e 6973 5f76 7072 6f78 6965   self.is_vproxie
+00001f60: 6420 3d20 626f 6f6c 2873 656c 662e 6172  d = bool(self.ar
+00001f70: 6773 2e52 290a 2020 2020 2020 2020 2020  gs.R).          
+00001f80: 2020 2020 2020 7365 6c66 2e68 6f73 7420        self.host 
+00001f90: 3d20 7365 6c66 2e68 6561 6465 7273 2e67  = self.headers.g
+00001fa0: 6574 2822 782d 666f 7277 6172 6465 642d  et("x-forwarded-
+00001fb0: 686f 7374 2229 206f 7220 7365 6c66 2e68  host") or self.h
+00001fc0: 6f73 740a 0a20 2020 2020 2020 2069 6620  ost..        if 
+00001fd0: 7365 6c66 2e69 735f 6261 6e6e 6564 2829  self.is_banned()
+00001fe0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00001ff0: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+00002000: 2020 2020 6966 2073 656c 662e 636f 6e6e      if self.conn
+00002010: 2e61 636c 6f73 653a 0a20 2020 2020 2020  .aclose:.       
+00002020: 2020 2020 206e 6b61 203d 2073 656c 662e       nka = self.
+00002030: 636f 6e6e 2e61 636c 6f73 650a 2020 2020  conn.aclose.    
+00002040: 2020 2020 2020 2020 6970 203d 2069 706e          ip = ipn
+00002050: 6f72 6d28 7365 6c66 2e69 7029 0a20 2020  orm(self.ip).   
+00002060: 2020 2020 2020 2020 2069 6620 6970 2069           if ip i
+00002070: 6e20 6e6b 613a 0a20 2020 2020 2020 2020  n nka:.         
+00002080: 2020 2020 2020 2072 7420 3d20 6e6b 615b         rt = nka[
+00002090: 6970 5d20 2d20 7469 6d65 2e74 696d 6528  ip] - time.time(
+000020a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000020b0: 2020 6966 2072 7420 3c20 303a 0a20 2020    if rt < 0:.   
+000020c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000020d0: 2073 656c 662e 6c6f 6728 2263 6c69 656e   self.log("clien
+000020e0: 7420 756e 6361 7070 6564 222c 2033 290a  t uncapped", 3).
+000020f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002100: 2020 2020 6465 6c20 6e6b 615b 6970 5d0a      del nka[ip].
+00002110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002120: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00002130: 2020 2020 2020 2020 2020 7365 6c66 2e6b            self.k
+00002140: 6565 7061 6c69 7665 203d 2046 616c 7365  eepalive = False
+00002150: 0a0a 2020 2020 2020 2020 7074 6e20 203d  ..        ptn  =
+00002160: 2073 656c 662e 636f 6e6e 2e6c 665f 7572   self.conn.lf_ur
+00002170: 6c20 2023 206d 7970 7934 3034 0a20 2020  l  # mypy404.   
+00002180: 2020 2020 2073 656c 662e 646f 5f6c 6f67       self.do_log
+00002190: 203d 206e 6f74 2070 746e 206f 7220 6e6f   = not ptn or no
+000021a0: 7420 7074 6e2e 7365 6172 6368 2873 656c  t ptn.search(sel
+000021b0: 662e 7265 7129 0a0a 2020 2020 2020 2020  f.req)..        
+000021c0: 6966 2073 656c 662e 6172 6773 2e69 6865  if self.args.ihe
+000021d0: 6164 2061 6e64 2073 656c 662e 646f 5f6c  ad and self.do_l
+000021e0: 6f67 3a0a 2020 2020 2020 2020 2020 2020  og:.            
+000021f0: 6b65 7973 203d 2073 656c 662e 6172 6773  keys = self.args
+00002200: 2e69 6865 6164 0a20 2020 2020 2020 2020  .ihead.         
+00002210: 2020 2069 6620 222a 2220 696e 206b 6579     if "*" in key
+00002220: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00002230: 2020 206b 6579 7320 3d20 6c69 7374 2873     keys = list(s
+00002240: 6f72 7465 6428 7365 6c66 2e68 6561 6465  orted(self.heade
+00002250: 7273 2e6b 6579 7328 2929 290a 0a20 2020  rs.keys()))..   
+00002260: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
+00002270: 6e20 6b65 7973 3a0a 2020 2020 2020 2020  n keys:.        
+00002280: 2020 2020 2020 2020 7a73 6f20 3d20 7365          zso = se
+00002290: 6c66 2e68 6561 6465 7273 2e67 6574 286b  lf.headers.get(k
+000022a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000022b0: 2020 6966 207a 736f 2069 7320 6e6f 7420    if zso is not 
+000022c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000022d0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+000022e0: 6f67 2822 5b48 5d20 7b7d 3a20 5c30 3333  og("[H] {}: \033
+000022f0: 5b33 336d 5b7b 7d5d 222e 666f 726d 6174  [33m[{}]".format
+00002300: 286b 2c20 7a73 6f29 2c20 3629 0a0a 2020  (k, zso), 6)..  
+00002310: 2020 2020 2020 6966 2022 2622 2069 6e20        if "&" in 
+00002320: 7365 6c66 2e72 6571 2061 6e64 2022 3f22  self.req and "?"
+00002330: 206e 6f74 2069 6e20 7365 6c66 2e72 6571   not in self.req
+00002340: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00002350: 6c66 2e68 696e 7420 3d20 2264 6964 2079  lf.hint = "did y
+00002360: 6f75 206d 6561 6e20 273f 2720 696e 7374  ou mean '?' inst
+00002370: 6561 6420 6f66 2027 2627 220a 0a20 2020  ead of '&'"..   
+00002380: 2020 2020 2023 2073 706c 6974 2072 6571       # split req
+00002390: 2069 6e74 6f20 7670 6174 6820 2b20 7570   into vpath + up
+000023a0: 6172 616d 0a20 2020 2020 2020 2075 7061  aram.        upa
+000023b0: 7261 6d20 3d20 7b7d 0a20 2020 2020 2020  ram = {}.       
+000023c0: 2069 6620 223f 2220 6e6f 7420 696e 2073   if "?" not in s
+000023d0: 656c 662e 7265 713a 0a20 2020 2020 2020  elf.req:.       
+000023e0: 2020 2020 2073 656c 662e 7472 6169 6c69       self.traili
+000023f0: 6e67 5f73 6c61 7368 203d 2073 656c 662e  ng_slash = self.
+00002400: 7265 712e 656e 6473 7769 7468 2822 2f22  req.endswith("/"
+00002410: 290a 2020 2020 2020 2020 2020 2020 7670  ).            vp
+00002420: 6174 6820 3d20 756e 646f 7428 7365 6c66  ath = undot(self
+00002430: 2e72 6571 290a 2020 2020 2020 2020 656c  .req).        el
+00002440: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00002450: 7670 6174 682c 2061 7267 6c69 7374 203d  vpath, arglist =
+00002460: 2073 656c 662e 7265 712e 7370 6c69 7428   self.req.split(
+00002470: 223f 222c 2031 290a 2020 2020 2020 2020  "?", 1).        
+00002480: 2020 2020 7365 6c66 2e74 7261 696c 696e      self.trailin
+00002490: 675f 736c 6173 6820 3d20 7670 6174 682e  g_slash = vpath.
+000024a0: 656e 6473 7769 7468 2822 2f22 290a 2020  endswith("/").  
+000024b0: 2020 2020 2020 2020 2020 7670 6174 6820            vpath 
+000024c0: 3d20 756e 646f 7428 7670 6174 6829 0a20  = undot(vpath). 
+000024d0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+000024e0: 2069 6e20 6172 676c 6973 742e 7370 6c69   in arglist.spli
+000024f0: 7428 2226 2229 3a0a 2020 2020 2020 2020  t("&"):.        
+00002500: 2020 2020 2020 2020 6966 2022 3d22 2069          if "=" i
+00002510: 6e20 6b3a 0a20 2020 2020 2020 2020 2020  n k:.           
+00002520: 2020 2020 2020 2020 206b 2c20 7a73 203d           k, zs =
+00002530: 206b 2e73 706c 6974 2822 3d22 2c20 3129   k.split("=", 1)
+00002540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002550: 2020 2020 2075 7061 7261 6d5b 6b2e 6c6f       uparam[k.lo
+00002560: 7765 7228 295d 203d 207a 732e 7374 7269  wer()] = zs.stri
+00002570: 7028 290a 2020 2020 2020 2020 2020 2020  p().            
+00002580: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00002590: 2020 2020 2020 2020 2020 2020 2020 7570                up
+000025a0: 6172 616d 5b6b 2e6c 6f77 6572 2829 5d20  aram[k.lower()] 
+000025b0: 3d20 2222 0a0a 2020 2020 2020 2020 6966  = ""..        if
+000025c0: 2073 656c 662e 6973 5f76 7072 6f78 6965   self.is_vproxie
+000025d0: 643a 0a20 2020 2020 2020 2020 2020 2069  d:.            i
+000025e0: 6620 7670 6174 682e 7374 6172 7473 7769  f vpath.startswi
+000025f0: 7468 2873 656c 662e 6172 6773 2e52 293a  th(self.args.R):
+00002600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002610: 2076 7061 7468 203d 2076 7061 7468 5b6c   vpath = vpath[l
+00002620: 656e 2873 656c 662e 6172 6773 2e52 2920  en(self.args.R) 
+00002630: 2b20 3120 3a5d 0a20 2020 2020 2020 2020  + 1 :].         
+00002640: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00002650: 2020 2020 2020 2020 2074 203d 2022 696e           t = "in
+00002660: 636f 7272 6563 7420 2d2d 7270 2d6c 6f63  correct --rp-loc
+00002670: 206f 7220 7765 6273 6572 7665 7220 636f   or webserver co
+00002680: 6e66 6967 3b20 6578 7065 6374 6564 2076  nfig; expected v
+00002690: 7061 7468 2073 7461 7274 696e 6720 7769  path starting wi
+000026a0: 7468 205b 7b7d 5d20 6275 7420 676f 7420  th [{}] but got 
+000026b0: 5b7b 7d5d 220a 2020 2020 2020 2020 2020  [{}]".          
+000026c0: 2020 2020 2020 7365 6c66 2e6c 6f67 2874        self.log(t
+000026d0: 2e66 6f72 6d61 7428 7365 6c66 2e61 7267  .format(self.arg
+000026e0: 732e 522c 2076 7061 7468 292c 2031 290a  s.R, vpath), 1).
+000026f0: 0a20 2020 2020 2020 2073 656c 662e 6f75  .        self.ou
+00002700: 7061 7261 6d20 3d20 7b6b 3a20 7a73 2066  param = {k: zs f
+00002710: 6f72 206b 2c20 7a73 2069 6e20 7570 6172  or k, zs in upar
+00002720: 616d 2e69 7465 6d73 2829 7d0a 0a20 2020  am.items()}..   
+00002730: 2020 2020 2069 6620 7365 6c66 2e61 7267       if self.arg
+00002740: 732e 7273 705f 736c 703a 0a20 2020 2020  s.rsp_slp:.     
+00002750: 2020 2020 2020 2074 696d 652e 736c 6565         time.slee
+00002760: 7028 7365 6c66 2e61 7267 732e 7273 705f  p(self.args.rsp_
+00002770: 736c 7029 0a20 2020 2020 2020 2020 2020  slp).           
+00002780: 2069 6620 7365 6c66 2e61 7267 732e 7273   if self.args.rs
+00002790: 705f 6a74 723a 0a20 2020 2020 2020 2020  p_jtr:.         
+000027a0: 2020 2020 2020 2074 696d 652e 736c 6565         time.slee
+000027b0: 7028 7261 6e64 6f6d 2e72 616e 646f 6d28  p(random.random(
+000027c0: 2920 2a20 7365 6c66 2e61 7267 732e 7273  ) * self.args.rs
+000027d0: 705f 6a74 7229 0a0a 2020 2020 2020 2020  p_jtr)..        
+000027e0: 7a73 6f20 3d20 7365 6c66 2e68 6561 6465  zso = self.heade
+000027f0: 7273 2e67 6574 2822 636f 6f6b 6965 2229  rs.get("cookie")
+00002800: 0a20 2020 2020 2020 2069 6620 7a73 6f3a  .        if zso:
+00002810: 0a20 2020 2020 2020 2020 2020 207a 736c  .            zsl
+00002820: 6c20 3d20 5b78 2e73 706c 6974 2822 3d22  l = [x.split("="
+00002830: 2c20 3129 2066 6f72 2078 2069 6e20 7a73  , 1) for x in zs
+00002840: 6f2e 7370 6c69 7428 223b 2229 2069 6620  o.split(";") if 
+00002850: 223d 2220 696e 2078 5d0a 2020 2020 2020  "=" in x].      
+00002860: 2020 2020 2020 636f 6f6b 6965 7320 3d20        cookies = 
+00002870: 7b6b 2e73 7472 6970 2829 3a20 756e 6573  {k.strip(): unes
+00002880: 6361 7065 5f63 6f6f 6b69 6528 7a73 2920  cape_cookie(zs) 
+00002890: 666f 7220 6b2c 207a 7320 696e 207a 736c  for k, zs in zsl
+000028a0: 6c7d 0a20 2020 2020 2020 2020 2020 2063  l}.            c
+000028b0: 6f6f 6b69 655f 7077 203d 2063 6f6f 6b69  ookie_pw = cooki
+000028c0: 6573 2e67 6574 2822 6370 7077 7322 2920  es.get("cppws") 
+000028d0: 6f72 2063 6f6f 6b69 6573 2e67 6574 2822  or cookies.get("
+000028e0: 6370 7077 6422 2920 6f72 2022 220a 2020  cppwd") or "".  
+000028f0: 2020 2020 2020 2020 2020 6966 2022 6222            if "b"
+00002900: 2069 6e20 636f 6f6b 6965 7320 616e 6420   in cookies and 
+00002910: 2262 2220 6e6f 7420 696e 2075 7061 7261  "b" not in upara
+00002920: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+00002930: 2020 2075 7061 7261 6d5b 2262 225d 203d     uparam["b"] =
+00002940: 2063 6f6f 6b69 6573 5b22 6222 5d0a 2020   cookies["b"].  
+00002950: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00002960: 2020 2020 2020 2020 636f 6f6b 6965 7320          cookies 
+00002970: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+00002980: 2063 6f6f 6b69 655f 7077 203d 2022 220a   cookie_pw = "".
+00002990: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+000029a0: 7570 6172 616d 2920 3e20 3130 206f 7220  uparam) > 10 or 
+000029b0: 6c65 6e28 636f 6f6b 6965 7329 203e 2035  len(cookies) > 5
+000029c0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
+000029d0: 6169 7365 2050 6562 6b61 6328 3430 302c  aise Pebkac(400,
+000029e0: 2022 7520 776f 7420 6d38 2229 0a0a 2020   "u wot m8")..  
+000029f0: 2020 2020 2020 7365 6c66 2e75 7061 7261        self.upara
+00002a00: 6d20 3d20 7570 6172 616d 0a20 2020 2020  m = uparam.     
+00002a10: 2020 2073 656c 662e 636f 6f6b 6965 7320     self.cookies 
+00002a20: 3d20 636f 6f6b 6965 730a 2020 2020 2020  = cookies.      
+00002a30: 2020 7365 6c66 2e76 7061 7468 203d 2075    self.vpath = u
+00002a40: 6e71 756f 7465 7028 7670 6174 6829 2020  nquotep(vpath)  
+00002a50: 2320 6e6f 7420 7175 6572 792c 2073 6f20  # not query, so 
+00002a60: 2b20 6d65 616e 7320 2b0a 0a20 2020 2020  + means +..     
+00002a70: 2020 206f 6b20 3d20 225c 7830 3022 206e     ok = "\x00" n
+00002a80: 6f74 2069 6e20 7365 6c66 2e76 7061 7468  ot in self.vpath
+00002a90: 0a20 2020 2020 2020 2069 6620 414e 5957  .        if ANYW
+00002aa0: 494e 3a0a 2020 2020 2020 2020 2020 2020  IN:.            
+00002ab0: 6f6b 203d 206f 6b20 616e 6420 6e6f 7420  ok = ok and not 
+00002ac0: 7265 6c63 686b 2873 656c 662e 7670 6174  relchk(self.vpat
+00002ad0: 6829 0a0a 2020 2020 2020 2020 6966 206e  h)..        if n
+00002ae0: 6f74 206f 6b20 616e 6420 2873 656c 662e  ot ok and (self.
+00002af0: 7670 6174 6820 213d 2022 2a22 206f 7220  vpath != "*" or 
+00002b00: 7365 6c66 2e6d 6f64 6520 213d 2022 4f50  self.mode != "OP
+00002b10: 5449 4f4e 5322 293a 0a20 2020 2020 2020  TIONS"):.       
+00002b20: 2020 2020 2073 656c 662e 6c6f 6728 2269       self.log("i
+00002b30: 6e76 616c 6964 2072 656c 7061 7468 205b  nvalid relpath [
+00002b40: 7b7d 5d22 2e66 6f72 6d61 7428 7365 6c66  {}]".format(self
+00002b50: 2e76 7061 7468 2929 0a20 2020 2020 2020  .vpath)).       
+00002b60: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00002b70: 2e74 785f 3430 3428 2920 616e 6420 7365  .tx_404() and se
+00002b80: 6c66 2e6b 6565 7061 6c69 7665 0a0a 2020  lf.keepalive..  
+00002b90: 2020 2020 2020 7a73 6f20 3d20 7365 6c66        zso = self
+00002ba0: 2e68 6561 6465 7273 2e67 6574 2822 6175  .headers.get("au
+00002bb0: 7468 6f72 697a 6174 696f 6e22 290a 2020  thorization").  
+00002bc0: 2020 2020 2020 6261 7574 6820 3d20 2222        bauth = ""
+00002bd0: 0a20 2020 2020 2020 2069 6620 7a73 6f3a  .        if zso:
+00002be0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
+00002bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002c00: 2020 7a62 203d 207a 736f 2e73 706c 6974    zb = zso.split
+00002c10: 2822 2022 295b 315d 2e65 6e63 6f64 6528  (" ")[1].encode(
+00002c20: 2261 7363 6969 2229 0a20 2020 2020 2020  "ascii").       
+00002c30: 2020 2020 2020 2020 207a 7320 3d20 6261           zs = ba
+00002c40: 7365 3634 2e62 3634 6465 636f 6465 287a  se64.b64decode(z
+00002c50: 6229 2e64 6563 6f64 6528 2275 7466 2d38  b).decode("utf-8
+00002c60: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00002c70: 2020 2023 2074 7279 2022 7077 6422 2c20     # try "pwd", 
+00002c80: 2278 3a70 7764 222c 2022 7077 643a 7822  "x:pwd", "pwd:x"
+00002c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002ca0: 2066 6f72 2062 6175 7468 2069 6e20 5b7a   for bauth in [z
+00002cb0: 735d 202b 207a 732e 7370 6c69 7428 223a  s] + zs.split(":
+00002cc0: 222c 2031 295b 3a3a 2d31 5d3a 0a20 2020  ", 1)[::-1]:.   
+00002cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ce0: 2069 6620 7365 6c66 2e61 7372 762e 6961   if self.asrv.ia
+00002cf0: 6363 742e 6765 7428 6261 7574 6829 3a0a  cct.get(bauth):.
+00002d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002d10: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00002d20: 2020 2020 2020 2020 2020 6578 6365 7074            except
+00002d30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00002d40: 2020 7061 7373 0a0a 2020 2020 2020 2020    pass..        
+00002d50: 7365 6c66 2e70 7720 3d20 7570 6172 616d  self.pw = uparam
+00002d60: 2e67 6574 2822 7077 2229 206f 7220 7365  .get("pw") or se
+00002d70: 6c66 2e68 6561 6465 7273 2e67 6574 2822  lf.headers.get("
+00002d80: 7077 2229 206f 7220 6261 7574 6820 6f72  pw") or bauth or
+00002d90: 2063 6f6f 6b69 655f 7077 0a20 2020 2020   cookie_pw.     
+00002da0: 2020 2073 656c 662e 756e 616d 6520 3d20     self.uname = 
+00002db0: 7365 6c66 2e61 7372 762e 6961 6363 742e  self.asrv.iacct.
+00002dc0: 6765 7428 7365 6c66 2e70 7729 206f 7220  get(self.pw) or 
+00002dd0: 222a 220a 2020 2020 2020 2020 7365 6c66  "*".        self
+00002de0: 2e72 766f 6c20 3d20 7365 6c66 2e61 7372  .rvol = self.asr
+00002df0: 762e 7666 732e 6172 6561 645b 7365 6c66  v.vfs.aread[self
+00002e00: 2e75 6e61 6d65 5d0a 2020 2020 2020 2020  .uname].        
+00002e10: 7365 6c66 2e77 766f 6c20 3d20 7365 6c66  self.wvol = self
+00002e20: 2e61 7372 762e 7666 732e 6177 7269 7465  .asrv.vfs.awrite
+00002e30: 5b73 656c 662e 756e 616d 655d 0a20 2020  [self.uname].   
+00002e40: 2020 2020 2073 656c 662e 6d76 6f6c 203d       self.mvol =
+00002e50: 2073 656c 662e 6173 7276 2e76 6673 2e61   self.asrv.vfs.a
+00002e60: 6d6f 7665 5b73 656c 662e 756e 616d 655d  move[self.uname]
+00002e70: 0a20 2020 2020 2020 2073 656c 662e 6476  .        self.dv
+00002e80: 6f6c 203d 2073 656c 662e 6173 7276 2e76  ol = self.asrv.v
+00002e90: 6673 2e61 6465 6c5b 7365 6c66 2e75 6e61  fs.adel[self.una
+00002ea0: 6d65 5d0a 2020 2020 2020 2020 7365 6c66  me].        self
+00002eb0: 2e67 766f 6c20 3d20 7365 6c66 2e61 7372  .gvol = self.asr
+00002ec0: 762e 7666 732e 6167 6574 5b73 656c 662e  v.vfs.aget[self.
+00002ed0: 756e 616d 655d 0a20 2020 2020 2020 2073  uname].        s
+00002ee0: 656c 662e 7570 766f 6c20 3d20 7365 6c66  elf.upvol = self
+00002ef0: 2e61 7372 762e 7666 732e 6170 6765 745b  .asrv.vfs.apget[
+00002f00: 7365 6c66 2e75 6e61 6d65 5d0a 0a20 2020  self.uname]..   
+00002f10: 2020 2020 2069 6620 7365 6c66 2e70 7720       if self.pw 
+00002f20: 616e 6420 280a 2020 2020 2020 2020 2020  and (.          
+00002f30: 2020 7365 6c66 2e70 7720 213d 2063 6f6f    self.pw != coo
+00002f40: 6b69 655f 7077 206f 7220 7365 6c66 2e63  kie_pw or self.c
+00002f50: 6f6e 6e2e 6672 6573 6865 6e5f 7077 6420  onn.freshen_pwd 
+00002f60: 2b20 3330 203c 2074 696d 652e 7469 6d65  + 30 < time.time
+00002f70: 2829 0a20 2020 2020 2020 2029 3a0a 2020  ().        ):.  
+00002f80: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00002f90: 6f6e 6e2e 6672 6573 6865 6e5f 7077 6420  onn.freshen_pwd 
+00002fa0: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
+00002fb0: 2020 2020 2020 2020 2020 7365 6c66 2e67            self.g
+00002fc0: 6574 5f70 7764 5f63 6f6f 6b69 6528 7365  et_pwd_cookie(se
+00002fd0: 6c66 2e70 7729 0a0a 2020 2020 2020 2020  lf.pw)..        
+00002fe0: 6966 2073 656c 662e 6973 5f72 636c 6f6e  if self.is_rclon
+00002ff0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+00003000: 2064 6f74 733a 2061 6c77 6179 7320 696e   dots: always in
+00003010: 636c 7564 6520 646f 7466 696c 6573 2069  clude dotfiles i
+00003020: 6620 7065 726d 6974 7465 640a 2020 2020  f permitted.    
+00003030: 2020 2020 2020 2020 2320 6c74 3a20 7072          # lt: pr
+00003040: 6f62 6162 6c79 206d 6f72 6520 696d 706f  obably more impo
+00003050: 7274 616e 7420 7368 6f77 696e 6720 7468  rtant showing th
+00003060: 6520 636f 7272 6563 7420 7469 6d65 7374  e correct timest
+00003070: 616d 7073 206f 6620 616e 7920 6475 7065  amps of any dupe
+00003080: 7320 6974 206a 7573 7420 7570 6c6f 6164  s it just upload
+00003090: 6564 2072 6174 6865 7220 7468 616e 2074  ed rather than t
+000030a0: 6865 206c 6173 746d 6f64 2074 696d 6520  he lastmod time 
+000030b0: 6f66 2061 6e79 206e 6f6e 2d63 6f70 7970  of any non-copyp
+000030c0: 6172 7479 2d6d 616e 6167 6564 2073 796d  arty-managed sym
+000030d0: 6c69 6e6b 730a 2020 2020 2020 2020 2020  links.          
+000030e0: 2020 2320 623a 2062 6173 6963 2d62 726f    # b: basic-bro
+000030f0: 7773 6572 2069 6620 6974 2074 7269 6573  wser if it tries
+00003100: 2074 6f20 7061 7273 6520 7468 6520 6874   to parse the ht
+00003110: 6d6c 206c 6973 7469 6e67 0a20 2020 2020  ml listing.     
+00003120: 2020 2020 2020 2075 7061 7261 6d5b 2264         uparam["d
+00003130: 6f74 7322 5d20 3d20 2222 0a20 2020 2020  ots"] = "".     
+00003140: 2020 2020 2020 2075 7061 7261 6d5b 226c         uparam["l
+00003150: 7422 5d20 3d20 2222 0a20 2020 2020 2020  t"] = "".       
+00003160: 2020 2020 2075 7061 7261 6d5b 2262 225d       uparam["b"]
+00003170: 203d 2022 220a 2020 2020 2020 2020 2020   = "".          
+00003180: 2020 636f 6f6b 6965 735b 2262 225d 203d    cookies["b"] =
+00003190: 2022 220a 0a20 2020 2020 2020 2076 6e2c   ""..        vn,
+000031a0: 2072 656d 203d 2073 656c 662e 6173 7276   rem = self.asrv
+000031b0: 2e76 6673 2e67 6574 2873 656c 662e 7670  .vfs.get(self.vp
+000031c0: 6174 682c 2073 656c 662e 756e 616d 652c  ath, self.uname,
+000031d0: 2046 616c 7365 2c20 4661 6c73 6529 0a20   False, False). 
+000031e0: 2020 2020 2020 2069 6620 2278 6465 7622         if "xdev"
+000031f0: 2069 6e20 766e 2e66 6c61 6773 206f 7220   in vn.flags or 
+00003200: 2278 766f 6c22 2069 6e20 766e 2e66 6c61  "xvol" in vn.fla
+00003210: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00003220: 6170 203d 2076 6e2e 6361 6e6f 6e69 6361  ap = vn.canonica
+00003230: 6c28 7265 6d29 0a20 2020 2020 2020 2020  l(rem).         
+00003240: 2020 2061 766e 203d 2076 6e2e 6368 6b5f     avn = vn.chk_
+00003250: 6170 2861 7029 0a20 2020 2020 2020 2065  ap(ap).        e
+00003260: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00003270: 2061 766e 203d 2076 6e0a 0a20 2020 2020   avn = vn..     
+00003280: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+00003290: 2073 656c 662e 6361 6e5f 7265 6164 2c0a   self.can_read,.
+000032a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000032b0: 2e63 616e 5f77 7269 7465 2c0a 2020 2020  .can_write,.    
+000032c0: 2020 2020 2020 2020 7365 6c66 2e63 616e          self.can
+000032d0: 5f6d 6f76 652c 0a20 2020 2020 2020 2020  _move,.         
+000032e0: 2020 2073 656c 662e 6361 6e5f 6465 6c65     self.can_dele
+000032f0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00003300: 7365 6c66 2e63 616e 5f67 6574 2c0a 2020  self.can_get,.  
+00003310: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
+00003320: 616e 5f75 7067 6574 2c0a 2020 2020 2020  an_upget,.      
+00003330: 2020 2920 3d20 280a 2020 2020 2020 2020    ) = (.        
+00003340: 2020 2020 6176 6e2e 6361 6e5f 6163 6365      avn.can_acce
+00003350: 7373 2822 222c 2073 656c 662e 756e 616d  ss("", self.unam
+00003360: 6529 2069 6620 6176 6e20 656c 7365 205b  e) if avn else [
+00003370: 4661 6c73 655d 202a 2036 0a20 2020 2020  False] * 6.     
+00003380: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00003390: 662e 6176 6e20 3d20 6176 6e0a 0a20 2020  f.avn = avn..   
+000033a0: 2020 2020 2073 656c 662e 732e 7365 7474       self.s.sett
+000033b0: 696d 656f 7574 2873 656c 662e 6172 6773  imeout(self.args
+000033c0: 2e73 5f74 626f 6479 206f 7220 4e6f 6e65  .s_tbody or None
+000033d0: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
+000033e0: 2020 2020 2020 2020 2020 2020 636f 7273              cors
+000033f0: 5f6b 203d 2073 656c 662e 5f63 6f72 7328  _k = self._cors(
+00003400: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00003410: 2073 656c 662e 6d6f 6465 2069 6e20 2822   self.mode in ("
+00003420: 4745 5422 2c20 2248 4541 4422 293a 0a20  GET", "HEAD"):. 
+00003430: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00003440: 6574 7572 6e20 7365 6c66 2e68 616e 646c  eturn self.handl
+00003450: 655f 6765 7428 2920 616e 6420 7365 6c66  e_get() and self
+00003460: 2e6b 6565 7061 6c69 7665 0a20 2020 2020  .keepalive.     
+00003470: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
+00003480: 6f64 6520 3d3d 2022 4f50 5449 4f4e 5322  ode == "OPTIONS"
+00003490: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000034a0: 2020 7265 7475 726e 2073 656c 662e 6861    return self.ha
+000034b0: 6e64 6c65 5f6f 7074 696f 6e73 2829 2061  ndle_options() a
+000034c0: 6e64 2073 656c 662e 6b65 6570 616c 6976  nd self.keepaliv
+000034d0: 650a 0a20 2020 2020 2020 2020 2020 2069  e..            i
+000034e0: 6620 6e6f 7420 636f 7273 5f6b 3a0a 2020  f not cors_k:.  
+000034f0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00003500: 6967 696e 203d 2073 656c 662e 6865 6164  igin = self.head
+00003510: 6572 732e 6765 7428 226f 7269 6769 6e22  ers.get("origin"
+00003520: 2c20 223c 3f3e 2229 0a20 2020 2020 2020  , "<?>").       
+00003530: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00003540: 6728 2263 6f72 732d 7265 6a65 6374 207b  g("cors-reject {
+00003550: 7d20 6672 6f6d 207b 7d22 2e66 6f72 6d61  } from {}".forma
+00003560: 7428 7365 6c66 2e6d 6f64 652c 206f 7269  t(self.mode, ori
+00003570: 6769 6e29 2c20 3329 0a20 2020 2020 2020  gin), 3).       
+00003580: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
+00003590: 6562 6b61 6328 3430 332c 2022 6e6f 2073  ebkac(403, "no s
+000035a0: 7572 6669 6e67 2229 0a0a 2020 2020 2020  urfing")..      
+000035b0: 2020 2020 2020 2320 6765 7461 7474 7228        # getattr(
+000035c0: 7365 6c66 2e6d 6f64 6529 2069 7320 6e6f  self.mode) is no
+000035d0: 7420 7965 7420 6661 7374 6572 2074 6861  t yet faster tha
+000035e0: 6e20 7468 6973 0a20 2020 2020 2020 2020  n this.         
+000035f0: 2020 2069 6620 7365 6c66 2e6d 6f64 6520     if self.mode 
+00003600: 3d3d 2022 504f 5354 223a 0a20 2020 2020  == "POST":.     
+00003610: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00003620: 6e20 7365 6c66 2e68 616e 646c 655f 706f  n self.handle_po
+00003630: 7374 2829 2061 6e64 2073 656c 662e 6b65  st() and self.ke
+00003640: 6570 616c 6976 650a 2020 2020 2020 2020  epalive.        
+00003650: 2020 2020 656c 6966 2073 656c 662e 6d6f      elif self.mo
+00003660: 6465 203d 3d20 2250 5554 223a 0a20 2020  de == "PUT":.   
+00003670: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00003680: 7572 6e20 7365 6c66 2e68 616e 646c 655f  urn self.handle_
+00003690: 7075 7428 2920 616e 6420 7365 6c66 2e6b  put() and self.k
+000036a0: 6565 7061 6c69 7665 0a20 2020 2020 2020  eepalive.       
+000036b0: 2020 2020 2065 6c69 6620 7365 6c66 2e6d       elif self.m
+000036c0: 6f64 6520 3d3d 2022 5052 4f50 4649 4e44  ode == "PROPFIND
+000036d0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+000036e0: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+000036f0: 616e 646c 655f 7072 6f70 6669 6e64 2829  andle_propfind()
+00003700: 2061 6e64 2073 656c 662e 6b65 6570 616c   and self.keepal
+00003710: 6976 650a 2020 2020 2020 2020 2020 2020  ive.            
+00003720: 656c 6966 2073 656c 662e 6d6f 6465 203d  elif self.mode =
+00003730: 3d20 2244 454c 4554 4522 3a0a 2020 2020  = "DELETE":.    
+00003740: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00003750: 726e 2073 656c 662e 6861 6e64 6c65 5f64  rn self.handle_d
+00003760: 656c 6574 6528 2920 616e 6420 7365 6c66  elete() and self
+00003770: 2e6b 6565 7061 6c69 7665 0a20 2020 2020  .keepalive.     
+00003780: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00003790: 2e6d 6f64 6520 3d3d 2022 5052 4f50 5041  .mode == "PROPPA
+000037a0: 5443 4822 3a0a 2020 2020 2020 2020 2020  TCH":.          
+000037b0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000037c0: 662e 6861 6e64 6c65 5f70 726f 7070 6174  f.handle_proppat
+000037d0: 6368 2829 2061 6e64 2073 656c 662e 6b65  ch() and self.ke
+000037e0: 6570 616c 6976 650a 2020 2020 2020 2020  epalive.        
+000037f0: 2020 2020 656c 6966 2073 656c 662e 6d6f      elif self.mo
+00003800: 6465 203d 3d20 224c 4f43 4b22 3a0a 2020  de == "LOCK":.  
+00003810: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00003820: 7475 726e 2073 656c 662e 6861 6e64 6c65  turn self.handle
+00003830: 5f6c 6f63 6b28 2920 616e 6420 7365 6c66  _lock() and self
+00003840: 2e6b 6565 7061 6c69 7665 0a20 2020 2020  .keepalive.     
+00003850: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00003860: 2e6d 6f64 6520 3d3d 2022 554e 4c4f 434b  .mode == "UNLOCK
+00003870: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00003880: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+00003890: 616e 646c 655f 756e 6c6f 636b 2829 2061  andle_unlock() a
+000038a0: 6e64 2073 656c 662e 6b65 6570 616c 6976  nd self.keepaliv
+000038b0: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
+000038c0: 6966 2073 656c 662e 6d6f 6465 203d 3d20  if self.mode == 
+000038d0: 224d 4b43 4f4c 223a 0a20 2020 2020 2020  "MKCOL":.       
+000038e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000038f0: 7365 6c66 2e68 616e 646c 655f 6d6b 636f  self.handle_mkco
+00003900: 6c28 2920 616e 6420 7365 6c66 2e6b 6565  l() and self.kee
+00003910: 7061 6c69 7665 0a20 2020 2020 2020 2020  palive.         
+00003920: 2020 2065 6c69 6620 7365 6c66 2e6d 6f64     elif self.mod
+00003930: 6520 3d3d 2022 4d4f 5645 223a 0a20 2020  e == "MOVE":.   
+00003940: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00003950: 7572 6e20 7365 6c66 2e68 616e 646c 655f  urn self.handle_
+00003960: 6d6f 7665 2829 2061 6e64 2073 656c 662e  move() and self.
+00003970: 6b65 6570 616c 6976 650a 2020 2020 2020  keepalive.      
+00003980: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00003990: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000039a0: 6520 5065 626b 6163 2834 3030 2c20 2769  e Pebkac(400, 'i
+000039b0: 6e76 616c 6964 2048 5454 5020 6d6f 6465  nvalid HTTP mode
+000039c0: 2022 7b30 7d22 272e 666f 726d 6174 2873   "{0}"'.format(s
+000039d0: 656c 662e 6d6f 6465 2929 0a0a 2020 2020  elf.mode))..    
+000039e0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+000039f0: 7469 6f6e 2061 7320 6578 3a0a 2020 2020  tion as ex:.    
+00003a00: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00003a10: 7369 6e73 7461 6e63 6528 6578 2c20 5065  sinstance(ex, Pe
+00003a20: 626b 6163 293a 0a20 2020 2020 2020 2020  bkac):.         
+00003a30: 2020 2020 2020 2070 6578 203d 2050 6562         pex = Peb
+00003a40: 6b61 6328 3530 3029 0a20 2020 2020 2020  kac(500).       
+00003a50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00003a60: 2020 2020 2020 2020 2020 2070 6578 2020             pex  
+00003a70: 3d20 6578 2020 2320 7479 7065 3a20 6967  = ex  # type: ig
+00003a80: 6e6f 7265 0a0a 2020 2020 2020 2020 2020  nore..          
+00003a90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00003aa0: 2020 2020 2020 2070 6f73 7420 3d20 7365         post = se
+00003ab0: 6c66 2e6d 6f64 6520 696e 205b 2250 4f53  lf.mode in ["POS
+00003ac0: 5422 2c20 2250 5554 225d 206f 7220 2263  T", "PUT"] or "c
+00003ad0: 6f6e 7465 6e74 2d6c 656e 6774 6822 2069  ontent-length" i
+00003ae0: 6e20 7365 6c66 2e68 6561 6465 7273 0a20  n self.headers. 
+00003af0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00003b00: 6620 6e6f 7420 7365 6c66 2e5f 6368 6563  f not self._chec
+00003b10: 6b5f 6e6f 6e66 6174 616c 2870 6578 2c20  k_nonfatal(pex, 
+00003b20: 706f 7374 293a 0a20 2020 2020 2020 2020  post):.         
+00003b30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003b40: 6b65 6570 616c 6976 6520 3d20 4661 6c73  keepalive = Fals
+00003b50: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+00003b60: 2020 2065 6d20 3d20 7374 7228 6578 290a     em = str(ex).
+00003b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b80: 6d73 6720 3d20 656d 2069 6620 7065 7820  msg = em if pex 
+00003b90: 3d3d 2065 7820 656c 7365 206d 696e 5f65  == ex else min_e
+00003ba0: 7828 290a 2020 2020 2020 2020 2020 2020  x().            
+00003bb0: 2020 2020 6966 2070 6578 2e63 6f64 6520      if pex.code 
+00003bc0: 213d 2034 3034 206f 7220 7365 6c66 2e64  != 404 or self.d
+00003bd0: 6f5f 6c6f 673a 0a20 2020 2020 2020 2020  o_log:.         
+00003be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003bf0: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
+00003c00: 2020 2020 2020 2020 2020 2020 2022 7b7d               "{}
+00003c10: 5c30 3333 5b30 6d2c 207b 7d22 2e66 6f72  \033[0m, {}".for
+00003c20: 6d61 7428 6d73 672c 2073 656c 662e 7670  mat(msg, self.vp
+00003c30: 6174 6829 2c0a 2020 2020 2020 2020 2020  ath),.          
+00003c40: 2020 2020 2020 2020 2020 2020 2020 3620                6 
+00003c50: 6966 2065 6d2e 7374 6172 7473 7769 7468  if em.startswith
+00003c60: 2822 636c 6965 6e74 2064 2f63 2022 2920  ("client d/c ") 
+00003c70: 656c 7365 2033 2c0a 2020 2020 2020 2020  else 3,.        
+00003c80: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00003c90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00003ca0: 7367 203d 2022 7b7d 5c72 5c6e 5552 4c3a  sg = "{}\r\nURL:
+00003cb0: 207b 7d5c 725c 6e22 2e66 6f72 6d61 7428   {}\r\n".format(
+00003cc0: 656d 2c20 7365 6c66 2e76 7061 7468 290a  em, self.vpath).
+00003cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ce0: 6966 2073 656c 662e 6869 6e74 3a0a 2020  if self.hint:.  
+00003cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d00: 2020 6d73 6720 2b3d 2022 6869 6e74 3a20    msg += "hint: 
+00003d10: 7b7d 5c72 5c6e 222e 666f 726d 6174 2873  {}\r\n".format(s
+00003d20: 656c 662e 6869 6e74 290a 0a20 2020 2020  elf.hint)..     
+00003d30: 2020 2020 2020 2020 2020 2069 6620 2264             if "d
+00003d40: 6174 6162 6173 6520 6973 206c 6f63 6b65  atabase is locke
+00003d50: 6422 2069 6e20 656d 3a0a 2020 2020 2020  d" in em:.      
+00003d60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00003d70: 6c66 2e63 6f6e 6e2e 6873 7276 2e62 726f  lf.conn.hsrv.bro
+00003d80: 6b65 722e 7361 7928 226c 6f67 5f73 7461  ker.say("log_sta
+00003d90: 636b 7322 290a 2020 2020 2020 2020 2020  cks").          
+00003da0: 2020 2020 2020 2020 2020 6d73 6720 2b3d            msg +=
+00003db0: 2022 6869 6e74 3a20 696d 706f 7274 616e   "hint: importan
+00003dc0: 7420 696e 666f 2069 6e20 7468 6520 7365  t info in the se
+00003dd0: 7276 6572 206c 6f67 5c72 5c6e 220a 0a20  rver log\r\n".. 
+00003de0: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+00003df0: 6220 3d20 6222 3c70 7265 3e22 202b 2068  b = b"<pre>" + h
+00003e00: 746d 6c5f 6573 6361 7065 286d 7367 292e  tml_escape(msg).
+00003e10: 656e 636f 6465 2822 7574 662d 3822 2c20  encode("utf-8", 
+00003e20: 2272 6570 6c61 6365 2229 0a20 2020 2020  "replace").     
+00003e30: 2020 2020 2020 2020 2020 2068 203d 207b             h = {
+00003e40: 2257 5757 2d41 7574 6865 6e74 6963 6174  "WWW-Authenticat
+00003e50: 6522 3a20 2742 6173 6963 2072 6561 6c6d  e": 'Basic realm
+00003e60: 3d22 6122 277d 2069 6620 7065 782e 636f  ="a"'} if pex.co
+00003e70: 6465 203d 3d20 3430 3120 656c 7365 207b  de == 401 else {
+00003e80: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00003e90: 2020 7365 6c66 2e72 6570 6c79 287a 622c    self.reply(zb,
+00003ea0: 2073 7461 7475 733d 7065 782e 636f 6465   status=pex.code
+00003eb0: 2c20 6865 6164 6572 733d 682c 2076 6f6c  , headers=h, vol
+00003ec0: 7361 6e3d 5472 7565 290a 2020 2020 2020  san=True).      
+00003ed0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003ee0: 2073 656c 662e 6b65 6570 616c 6976 650a   self.keepalive.
+00003ef0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00003f00: 7074 2050 6562 6b61 633a 0a20 2020 2020  pt Pebkac:.     
+00003f10: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00003f20: 6e20 4661 6c73 650a 0a20 2020 2064 6566  n False..    def
+00003f30: 2064 6970 2873 656c 6629 2020 3a0a 2020   dip(self)  :.  
+00003f40: 2020 2020 2020 6966 2073 656c 662e 6172        if self.ar
+00003f50: 6773 2e70 6c61 696e 5f69 703a 0a20 2020  gs.plain_ip:.   
+00003f60: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00003f70: 7365 6c66 2e69 702e 7265 706c 6163 6528  self.ip.replace(
+00003f80: 223a 222c 2022 2e22 290a 2020 2020 2020  ":", ".").      
+00003f90: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00003fa0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00003fb0: 636f 6e6e 2e69 7068 6173 682e 7328 7365  conn.iphash.s(se
+00003fc0: 6c66 2e69 7029 0a0a 2020 2020 6465 6620  lf.ip)..    def 
+00003fd0: 6973 5f62 616e 6e65 6428 7365 6c66 2920  is_banned(self) 
+00003fe0: 203a 0a20 2020 2020 2020 2069 6620 6e6f   :.        if no
+00003ff0: 7420 7365 6c66 2e63 6f6e 6e2e 6261 6e73  t self.conn.bans
+00004000: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00004010: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+00004020: 2020 2020 6261 6e73 203d 2073 656c 662e      bans = self.
+00004030: 636f 6e6e 2e62 616e 730a 2020 2020 2020  conn.bans.      
+00004040: 2020 6970 203d 2069 706e 6f72 6d28 7365    ip = ipnorm(se
+00004050: 6c66 2e69 7029 0a20 2020 2020 2020 2069  lf.ip).        i
+00004060: 6620 6970 206e 6f74 2069 6e20 6261 6e73  f ip not in bans
+00004070: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00004080: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+00004090: 2020 2020 7274 203d 2062 616e 735b 6970      rt = bans[ip
+000040a0: 5d20 2d20 7469 6d65 2e74 696d 6528 290a  ] - time.time().
+000040b0: 2020 2020 2020 2020 6966 2072 7420 3c20          if rt < 
+000040c0: 303a 0a20 2020 2020 2020 2020 2020 2073  0:.            s
+000040d0: 656c 662e 6c6f 6728 2263 6c69 656e 7420  elf.log("client 
+000040e0: 756e 6261 6e6e 6564 222c 2033 290a 2020  unbanned", 3).  
+000040f0: 2020 2020 2020 2020 2020 6465 6c20 6261            del ba
+00004100: 6e73 5b69 705d 0a20 2020 2020 2020 2020  ns[ip].         
+00004110: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+00004120: 0a20 2020 2020 2020 2073 656c 662e 6c6f  .        self.lo
+00004130: 6728 2262 616e 6e65 6420 666f 7220 7b3a  g("banned for {:
+00004140: 2e30 667d 2073 6563 222e 666f 726d 6174  .0f} sec".format
+00004150: 2872 7429 2c20 3629 0a20 2020 2020 2020  (rt), 6).       
+00004160: 207a 6220 3d20 6222 4854 5450 2f31 2e30   zb = b"HTTP/1.0
+00004170: 2034 3033 2046 6f72 6269 6464 656e 5c72   403 Forbidden\r
+00004180: 5c6e 5c72 5c6e 7468 616e 6b20 796f 7520  \n\r\nthank you 
+00004190: 666f 7220 706c 6179 696e 6722 0a20 2020  for playing".   
+000041a0: 2020 2020 2073 656c 662e 732e 7365 6e64       self.s.send
+000041b0: 616c 6c28 7a62 290a 2020 2020 2020 2020  all(zb).        
+000041c0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+000041d0: 2064 6566 2070 6572 6d69 745f 6361 6368   def permit_cach
+000041e0: 696e 6728 7365 6c66 2920 203a 0a20 2020  ing(self)  :.   
+000041f0: 2020 2020 2063 6163 6865 203d 2073 656c       cache = sel
+00004200: 662e 7570 6172 616d 2e67 6574 2822 6361  f.uparam.get("ca
+00004210: 6368 6522 290a 2020 2020 2020 2020 6966  che").        if
+00004220: 2063 6163 6865 2069 7320 4e6f 6e65 3a0a   cache is None:.
+00004230: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00004240: 2e6f 7574 5f68 6561 6465 7273 2e75 7064  .out_headers.upd
+00004250: 6174 6528 4e4f 5f43 4143 4845 290a 2020  ate(NO_CACHE).  
+00004260: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00004270: 0a0a 2020 2020 2020 2020 6e20 3d20 2236  ..        n = "6
+00004280: 3034 3836 3922 2069 6620 6361 6368 6520  04869" if cache 
+00004290: 3d3d 2022 6922 2065 6c73 6520 6361 6368  == "i" else cach
+000042a0: 6520 6f72 2022 3639 220a 2020 2020 2020  e or "69".      
+000042b0: 2020 7365 6c66 2e6f 7574 5f68 6561 6465    self.out_heade
+000042c0: 7273 5b22 4361 6368 652d 436f 6e74 726f  rs["Cache-Contro
+000042d0: 6c22 5d20 3d20 226d 6178 2d61 6765 3d22  l"] = "max-age="
+000042e0: 202b 206e 0a0a 2020 2020 6465 6620 6b33   + n..    def k3
+000042f0: 3034 2873 656c 6629 2020 3a0a 2020 2020  04(self)  :.    
+00004300: 2020 2020 6b33 3034 203d 2073 656c 662e      k304 = self.
+00004310: 636f 6f6b 6965 732e 6765 7428 226b 3330  cookies.get("k30
+00004320: 3422 290a 2020 2020 2020 2020 7265 7475  4").        retu
+00004330: 726e 206b 3330 3420 3d3d 2022 7922 206f  rn k304 == "y" o
+00004340: 7220 2822 3b20 5472 6964 656e 742f 2220  r ("; Trident/" 
+00004350: 696e 2073 656c 662e 7561 2061 6e64 206e  in self.ua and n
+00004360: 6f74 206b 3330 3429 0a0a 2020 2020 6465  ot k304)..    de
+00004370: 6620 7365 6e64 5f68 6561 6465 7273 280a  f send_headers(.
+00004380: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00004390: 2020 2020 2020 6c65 6e67 7468 202c 0a20        length ,. 
+000043a0: 2020 2020 2020 2073 7461 7475 7320 203d         status  =
+000043b0: 2032 3030 2c0a 2020 2020 2020 2020 6d69   200,.        mi
+000043c0: 6d65 2020 3d20 4e6f 6e65 2c0a 2020 2020  me  = None,.    
+000043d0: 2020 2020 6865 6164 6572 7320 2020 3d20      headers   = 
+000043e0: 4e6f 6e65 2c0a 2020 2020 2920 203a 0a20  None,.    )  :. 
+000043f0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+00004400: 3d20 5b22 2573 2025 7320 2573 2220 2520  = ["%s %s %s" % 
+00004410: 2873 656c 662e 6874 7470 5f76 6572 2c20  (self.http_ver, 
+00004420: 7374 6174 7573 2c20 4854 5450 434f 4445  status, HTTPCODE
+00004430: 5b73 7461 7475 735d 295d 0a0a 2020 2020  [status])]..    
+00004440: 2020 2020 6966 206c 656e 6774 6820 6973      if length is
+00004450: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00004460: 2020 2020 2020 2072 6573 706f 6e73 652e         response.
+00004470: 6170 7065 6e64 2822 436f 6e74 656e 742d  append("Content-
+00004480: 4c65 6e67 7468 3a20 2220 2b20 756e 6963  Length: " + unic
+00004490: 6f64 6528 6c65 6e67 7468 2929 0a0a 2020  ode(length))..  
+000044a0: 2020 2020 2020 6966 2073 7461 7475 7320        if status 
+000044b0: 3d3d 2033 3034 2061 6e64 2073 656c 662e  == 304 and self.
+000044c0: 6b33 3034 2829 3a0a 2020 2020 2020 2020  k304():.        
+000044d0: 2020 2020 7365 6c66 2e6b 6565 7061 6c69      self.keepali
+000044e0: 7665 203d 2046 616c 7365 0a0a 2020 2020  ve = False..    
+000044f0: 2020 2020 2320 636c 6f73 6520 6966 2075      # close if u
+00004500: 6e6b 6e6f 776e 206c 656e 6774 682c 206f  nknown length, o
+00004510: 7468 6572 7769 7365 2074 616b 6520 636c  therwise take cl
+00004520: 6965 6e74 2773 2070 7265 6665 7265 6e63  ient's preferenc
+00004530: 650a 2020 2020 2020 2020 7265 7370 6f6e  e.        respon
+00004540: 7365 2e61 7070 656e 6428 2243 6f6e 6e65  se.append("Conne
+00004550: 6374 696f 6e3a 2022 202b 2028 224b 6565  ction: " + ("Kee
+00004560: 702d 416c 6976 6522 2069 6620 7365 6c66  p-Alive" if self
+00004570: 2e6b 6565 7061 6c69 7665 2065 6c73 6520  .keepalive else 
+00004580: 2243 6c6f 7365 2229 290a 2020 2020 2020  "Close")).      
+00004590: 2020 7265 7370 6f6e 7365 2e61 7070 656e    response.appen
+000045a0: 6428 2244 6174 653a 2022 202b 2066 6f72  d("Date: " + for
+000045b0: 6d61 7464 6174 6528 7573 6567 6d74 3d54  matdate(usegmt=T
+000045c0: 7275 6529 290a 0a20 2020 2020 2020 2023  rue))..        #
+000045d0: 2068 6561 6465 7273 7b7d 206f 7665 7272   headers{} overr
+000045e0: 6964 6573 2061 6e79 7468 696e 6720 7365  ides anything se
+000045f0: 7420 7072 6576 696f 7573 6c79 0a20 2020  t previously.   
+00004600: 2020 2020 2069 6620 6865 6164 6572 733a       if headers:
+00004610: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004620: 662e 6f75 745f 6865 6164 6572 732e 7570  f.out_headers.up
+00004630: 6461 7465 2868 6561 6465 7273 290a 0a20  date(headers).. 
+00004640: 2020 2020 2020 2023 2064 6566 6175 6c74         # default
+00004650: 2074 6f20 7574 6638 2068 746d 6c20 6966   to utf8 html if
+00004660: 206e 6f20 636f 6e74 656e 742d 7479 7065   no content-type
+00004670: 2069 7320 7365 740a 2020 2020 2020 2020   is set.        
+00004680: 6966 206e 6f74 206d 696d 653a 0a20 2020  if not mime:.   
+00004690: 2020 2020 2020 2020 206d 696d 6520 3d20           mime = 
+000046a0: 7365 6c66 2e6f 7574 5f68 6561 6465 7273  self.out_headers
+000046b0: 2e67 6574 2822 436f 6e74 656e 742d 5479  .get("Content-Ty
+000046c0: 7065 222c 2022 7465 7874 2f68 746d 6c3b  pe", "text/html;
+000046d0: 2063 6861 7273 6574 3d75 7466 2d38 2229   charset=utf-8")
+000046e0: 0a0a 2020 2020 2020 2020 6173 7365 7274  ..        assert
+000046f0: 206d 696d 650a 2020 2020 2020 2020 7365   mime.        se
+00004700: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
+00004710: 436f 6e74 656e 742d 5479 7065 225d 203d  Content-Type"] =
+00004720: 206d 696d 650a 0a20 2020 2020 2020 2066   mime..        f
+00004730: 6f72 206b 2c20 7a73 2069 6e20 6c69 7374  or k, zs in list
+00004740: 2873 656c 662e 6f75 745f 6865 6164 6572  (self.out_header
+00004750: 732e 6974 656d 7328 2929 202b 2073 656c  s.items()) + sel
+00004760: 662e 6f75 745f 6865 6164 6572 6c69 7374  f.out_headerlist
+00004770: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00004780: 7370 6f6e 7365 2e61 7070 656e 6428 2225  sponse.append("%
+00004790: 733a 2025 7322 2025 2028 6b2c 207a 7329  s: %s" % (k, zs)
+000047a0: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
+000047b0: 2020 2020 2020 2020 2020 2020 2320 6265              # be
+000047c0: 7374 2070 7261 6374 6963 6520 746f 2073  st practice to s
+000047d0: 6570 6172 6174 6520 6865 6164 6572 7320  eparate headers 
+000047e0: 616e 6420 626f 6479 2069 6e74 6f20 6469  and body into di
+000047f0: 6666 6572 656e 7420 7061 636b 6574 730a  fferent packets.
+00004800: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00004810: 2e73 2e73 656e 6461 6c6c 2822 5c72 5c6e  .s.sendall("\r\n
+00004820: 222e 6a6f 696e 2872 6573 706f 6e73 6529  ".join(response)
+00004830: 2e65 6e63 6f64 6528 2275 7466 2d38 2229  .encode("utf-8")
+00004840: 202b 2062 225c 725c 6e5c 725c 6e22 290a   + b"\r\n\r\n").
+00004850: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+00004860: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00004870: 6520 5065 626b 6163 2834 3030 2c20 2263  e Pebkac(400, "c
+00004880: 6c69 656e 7420 642f 6320 7768 696c 6520  lient d/c while 
+00004890: 7265 706c 7969 6e67 2068 6561 6465 7273  replying headers
+000048a0: 2229 0a0a 2020 2020 6465 6620 7265 706c  ")..    def repl
+000048b0: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
+000048c0: 0a20 2020 2020 2020 2062 6f64 7920 2c0a  .        body ,.
+000048d0: 2020 2020 2020 2020 7374 6174 7573 2020          status  
+000048e0: 3d20 3230 302c 0a20 2020 2020 2020 206d  = 200,.        m
+000048f0: 696d 6520 203d 204e 6f6e 652c 0a20 2020  ime  = None,.   
+00004900: 2020 2020 2068 6561 6465 7273 2020 203d       headers   =
+00004910: 204e 6f6e 652c 0a20 2020 2020 2020 2076   None,.        v
+00004920: 6f6c 7361 6e20 203d 2046 616c 7365 2c0a  olsan  = False,.
+00004930: 2020 2020 2920 203a 0a20 2020 2020 2020      )  :.       
+00004940: 2069 6620 7374 6174 7573 203d 3d20 3430   if status == 40
+00004950: 343a 0a20 2020 2020 2020 2020 2020 2067  4:.            g
+00004960: 203d 2073 656c 662e 636f 6e6e 2e68 7372   = self.conn.hsr
+00004970: 762e 6734 3034 0a20 2020 2020 2020 2020  v.g404.         
+00004980: 2020 2069 6620 672e 6c69 6d3a 0a20 2020     if g.lim:.   
+00004990: 2020 2020 2020 2020 2020 2020 2062 6f6e               bon
+000049a0: 6b2c 2069 7020 3d20 672e 626f 6e6b 2873  k, ip = g.bonk(s
+000049b0: 656c 662e 6970 2c20 7365 6c66 2e76 7061  elf.ip, self.vpa
+000049c0: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
+000049d0: 2020 2020 6966 2062 6f6e 6b3a 0a20 2020      if bonk:.   
+000049e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049f0: 2073 656c 662e 6c6f 6728 2263 6c69 656e   self.log("clien
+00004a00: 7420 6261 6e6e 6564 3a20 3430 3473 222c  t banned: 404s",
+00004a10: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+00004a20: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00004a30: 6e2e 6873 7276 2e62 616e 735b 6970 5d20  n.hsrv.bans[ip] 
+00004a40: 3d20 626f 6e6b 0a0a 2020 2020 2020 2020  = bonk..        
+00004a50: 6966 2076 6f6c 7361 6e3a 0a20 2020 2020  if volsan:.     
+00004a60: 2020 2020 2020 2076 6f6c 7320 3d20 6c69         vols = li
+00004a70: 7374 2873 656c 662e 6173 7276 2e76 6673  st(self.asrv.vfs
+00004a80: 2e61 6c6c 5f76 6f6c 732e 7661 6c75 6573  .all_vols.values
+00004a90: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+00004aa0: 626f 6479 203d 2076 6f6c 5f73 616e 2876  body = vol_san(v
+00004ab0: 6f6c 732c 2062 6f64 7929 0a0a 2020 2020  ols, body)..    
+00004ac0: 2020 2020 7365 6c66 2e73 656e 645f 6865      self.send_he
+00004ad0: 6164 6572 7328 6c65 6e28 626f 6479 292c  aders(len(body),
+00004ae0: 2073 7461 7475 732c 206d 696d 652c 2068   status, mime, h
+00004af0: 6561 6465 7273 290a 0a20 2020 2020 2020  eaders)..       
+00004b00: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00004b10: 2020 6966 2073 656c 662e 6d6f 6465 2021    if self.mode !
+00004b20: 3d20 2248 4541 4422 3a0a 2020 2020 2020  = "HEAD":.      
+00004b30: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00004b40: 2e73 656e 6461 6c6c 2862 6f64 7929 0a20  .sendall(body). 
+00004b50: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
+00004b60: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00004b70: 2050 6562 6b61 6328 3430 302c 2022 636c   Pebkac(400, "cl
+00004b80: 6965 6e74 2064 2f63 2077 6869 6c65 2072  ient d/c while r
+00004b90: 6570 6c79 696e 6720 626f 6479 2229 0a0a  eplying body")..
+00004ba0: 2020 2020 2020 2020 7265 7475 726e 2062          return b
+00004bb0: 6f64 790a 0a20 2020 2064 6566 206c 6f75  ody..    def lou
+00004bc0: 645f 7265 706c 7928 7365 6c66 2c20 626f  d_reply(self, bo
+00004bd0: 6479 202c 202a 6172 6773 202c 202a 2a6b  dy , *args , **k
+00004be0: 7761 7267 7320 2920 203a 0a20 2020 2020  wargs )  :.     
+00004bf0: 2020 2069 6620 6e6f 7420 6b77 6172 6773     if not kwargs
+00004c00: 2e67 6574 2822 6d69 6d65 2229 3a0a 2020  .get("mime"):.  
+00004c10: 2020 2020 2020 2020 2020 6b77 6172 6773            kwargs
+00004c20: 5b22 6d69 6d65 225d 203d 2022 7465 7874  ["mime"] = "text
+00004c30: 2f70 6c61 696e 3b20 6368 6172 7365 743d  /plain; charset=
+00004c40: 7574 662d 3822 0a0a 2020 2020 2020 2020  utf-8"..        
+00004c50: 7365 6c66 2e6c 6f67 2862 6f64 792e 7273  self.log(body.rs
+00004c60: 7472 6970 2829 290a 2020 2020 2020 2020  trip()).        
+00004c70: 7365 6c66 2e72 6570 6c79 2862 6f64 792e  self.reply(body.
+00004c80: 656e 636f 6465 2822 7574 662d 3822 2920  encode("utf-8") 
+00004c90: 2b20 6222 5c72 5c6e 222c 202a 6c69 7374  + b"\r\n", *list
+00004ca0: 2861 7267 7329 2c20 2a2a 6b77 6172 6773  (args), **kwargs
+00004cb0: 290a 0a20 2020 2064 6566 2075 726c 7128  )..    def urlq(
+00004cc0: 7365 6c66 2c20 6164 6420 202c 2072 6d20  self, add  , rm 
+00004cd0: 2920 203a 0a20 2020 2020 2020 2022 2222  )  :.        """
+00004ce0: 0a20 2020 2020 2020 2067 656e 6572 6174  .        generat
+00004cf0: 6573 2075 726c 2071 7565 7279 2062 6173  es url query bas
+00004d00: 6564 206f 6e20 7570 6172 616d 2028 622c  ed on uparam (b,
+00004d10: 2070 772c 2061 6c6c 206f 7468 6572 7329   pw, all others)
+00004d20: 0a20 2020 2020 2020 2072 656d 6f76 696e  .        removin
+00004d30: 6720 616e 7974 6869 6e67 2069 6e20 726d  g anything in rm
+00004d40: 2c20 6164 6469 6e67 2070 6169 7273 2069  , adding pairs i
+00004d50: 6e20 6164 640a 0a20 2020 2020 2020 2061  n add..        a
+00004d60: 6c73 6f20 6c69 7374 2066 6173 7465 7220  lso list faster 
+00004d70: 7468 616e 2073 6574 2075 6e74 696c 207e  than set until ~
+00004d80: 3230 2069 7465 6d73 0a20 2020 2020 2020  20 items.       
+00004d90: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
+00004da0: 2073 656c 662e 6973 5f72 636c 6f6e 653a   self.is_rclone:
+00004db0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00004dc0: 7572 6e20 2222 0a0a 2020 2020 2020 2020  urn ""..        
+00004dd0: 6b76 203d 207b 6b3a 207a 7320 666f 7220  kv = {k: zs for 
+00004de0: 6b2c 207a 7320 696e 2073 656c 662e 7570  k, zs in self.up
+00004df0: 6172 616d 2e69 7465 6d73 2829 2069 6620  aram.items() if 
+00004e00: 6b20 6e6f 7420 696e 2072 6d7d 0a20 2020  k not in rm}.   
+00004e10: 2020 2020 2069 6620 2270 7722 2069 6e20       if "pw" in 
+00004e20: 6b76 3a0a 2020 2020 2020 2020 2020 2020  kv:.            
+00004e30: 7077 203d 2073 656c 662e 636f 6f6b 6965  pw = self.cookie
+00004e40: 732e 6765 7428 2263 7070 7773 2229 206f  s.get("cppws") o
+00004e50: 7220 7365 6c66 2e63 6f6f 6b69 6573 2e67  r self.cookies.g
+00004e60: 6574 2822 6370 7077 6422 290a 2020 2020  et("cppwd").    
+00004e70: 2020 2020 2020 2020 6966 206b 765b 2270          if kv["p
+00004e80: 7722 5d20 3d3d 2070 773a 0a20 2020 2020  w"] == pw:.     
+00004e90: 2020 2020 2020 2020 2020 2064 656c 206b             del k
+00004ea0: 765b 2270 7722 5d0a 0a20 2020 2020 2020  v["pw"]..       
+00004eb0: 206b 762e 7570 6461 7465 2861 6464 290a   kv.update(add).
+00004ec0: 2020 2020 2020 2020 6966 206e 6f74 206b          if not k
+00004ed0: 763a 0a20 2020 2020 2020 2020 2020 2072  v:.            r
+00004ee0: 6574 7572 6e20 2222 0a0a 2020 2020 2020  eturn ""..      
+00004ef0: 2020 7220 3d20 5b22 2573 3d25 7322 2025    r = ["%s=%s" %
+00004f00: 2028 6b2c 2071 756f 7465 7028 7a73 2929   (k, quotep(zs))
+00004f10: 2069 6620 7a73 2065 6c73 6520 6b20 666f   if zs else k fo
+00004f20: 7220 6b2c 207a 7320 696e 206b 762e 6974  r k, zs in kv.it
+00004f30: 656d 7328 295d 0a20 2020 2020 2020 2072  ems()].        r
+00004f40: 6574 7572 6e20 223f 2220 2b20 2226 616d  eturn "?" + "&am
+00004f50: 703b 222e 6a6f 696e 2872 290a 0a20 2020  p;".join(r)..   
+00004f60: 2064 6566 2072 6564 6972 6563 7428 0a20   def redirect(. 
+00004f70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00004f80: 2020 2020 2076 7061 7468 202c 0a20 2020       vpath ,.   
+00004f90: 2020 2020 2073 7566 2020 3d20 2222 2c0a       suf  = "",.
+00004fa0: 2020 2020 2020 2020 6d73 6720 203d 2022          msg  = "
+00004fb0: 6169 6768 7422 2c0a 2020 2020 2020 2020  aight",.        
+00004fc0: 666c 6176 6f72 2020 3d20 2267 6f20 746f  flavor  = "go to
+00004fd0: 222c 0a20 2020 2020 2020 2063 6c69 636b  ",.        click
+00004fe0: 2020 3d20 5472 7565 2c0a 2020 2020 2020    = True,.      
+00004ff0: 2020 7374 6174 7573 2020 3d20 3230 302c    status  = 200,
+00005000: 0a20 2020 2020 2020 2075 7365 3330 3220  .        use302 
+00005010: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+00005020: 203a 0a20 2020 2020 2020 2076 7020 3d20   :.        vp = 
+00005030: 7365 6c66 2e61 7267 732e 5253 202b 2076  self.args.RS + v
+00005040: 7061 7468 0a20 2020 2020 2020 2068 746d  path.        htm
+00005050: 6c20 3d20 7365 6c66 2e6a 3273 280a 2020  l = self.j2s(.  
+00005060: 2020 2020 2020 2020 2020 226d 7367 222c            "msg",
+00005070: 0a20 2020 2020 2020 2020 2020 2068 323d  .            h2=
+00005080: 273c 6120 6872 6566 3d22 2f7b 7d22 3e7b  '<a href="/{}">{
+00005090: 7d20 2f7b 7d3c 2f61 3e27 2e66 6f72 6d61  } /{}</a>'.forma
+000050a0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000050b0: 2020 2071 756f 7465 7028 7670 2920 2b20     quotep(vp) + 
+000050c0: 7375 662c 2066 6c61 766f 722c 2068 746d  suf, flavor, htm
+000050d0: 6c5f 6573 6361 7065 2876 702c 2063 726c  l_escape(vp, crl
+000050e0: 663d 5472 7565 2920 2b20 7375 660a 2020  f=True) + suf.  
+000050f0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00005100: 2020 2020 2020 2020 2070 7265 3d6d 7367           pre=msg
+00005110: 2c0a 2020 2020 2020 2020 2020 2020 636c  ,.            cl
+00005120: 6963 6b3d 636c 6963 6b2c 0a20 2020 2020  ick=click,.     
+00005130: 2020 2029 2e65 6e63 6f64 6528 2275 7466     ).encode("utf
+00005140: 2d38 222c 2022 7265 706c 6163 6522 290a  -8", "replace").
+00005150: 0a20 2020 2020 2020 2069 6620 7573 6533  .        if use3
+00005160: 3032 3a0a 2020 2020 2020 2020 2020 2020  02:.            
+00005170: 7365 6c66 2e72 6570 6c79 2868 746d 6c2c  self.reply(html,
+00005180: 2073 7461 7475 733d 3330 322c 2068 6561   status=302, hea
+00005190: 6465 7273 3d7b 224c 6f63 6174 696f 6e22  ders={"Location"
+000051a0: 3a20 222f 2220 2b20 7670 6174 687d 290a  : "/" + vpath}).
+000051b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000051c0: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+000051d0: 6570 6c79 2868 746d 6c2c 2073 7461 7475  eply(html, statu
+000051e0: 733d 7374 6174 7573 290a 0a20 2020 2020  s=status)..     
+000051f0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+00005200: 2020 2020 6465 6620 5f63 6f72 7328 7365      def _cors(se
+00005210: 6c66 2920 203a 0a20 2020 2020 2020 2069  lf)  :.        i
+00005220: 6820 3d20 7365 6c66 2e68 6561 6465 7273  h = self.headers
+00005230: 0a20 2020 2020 2020 206f 7269 6769 6e20  .        origin 
+00005240: 3d20 6968 2e67 6574 2822 6f72 6967 696e  = ih.get("origin
+00005250: 2229 0a20 2020 2020 2020 2069 6620 6e6f  ").        if no
+00005260: 7420 6f72 6967 696e 3a0a 2020 2020 2020  t origin:.      
+00005270: 2020 2020 2020 7366 7369 7465 203d 2069        sfsite = i
+00005280: 682e 6765 7428 2273 6563 2d66 6574 6368  h.get("sec-fetch
+00005290: 2d73 6974 6522 290a 2020 2020 2020 2020  -site").        
+000052a0: 2020 2020 6966 2073 6673 6974 6520 616e      if sfsite an
+000052b0: 6420 7366 7369 7465 2e6c 6f77 6572 2829  d sfsite.lower()
+000052c0: 2e73 7461 7274 7377 6974 6828 2263 726f  .startswith("cro
+000052d0: 7373 2229 3a0a 2020 2020 2020 2020 2020  ss"):.          
+000052e0: 2020 2020 2020 6f72 6967 696e 203d 2022        origin = "
+000052f0: 3a7c 2220 2023 2073 616e 6462 6f78 6564  :|"  # sandboxed
+00005300: 2069 6672 616d 650a 2020 2020 2020 2020   iframe.        
+00005310: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00005320: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00005330: 2054 7275 650a 0a20 2020 2020 2020 206f   True..        o
+00005340: 6820 3d20 7365 6c66 2e6f 7574 5f68 6561  h = self.out_hea
+00005350: 6465 7273 0a20 2020 2020 2020 206f 7269  ders.        ori
+00005360: 6769 6e20 3d20 6f72 6967 696e 2e6c 6f77  gin = origin.low
+00005370: 6572 2829 0a20 2020 2020 2020 2067 6f6f  er().        goo
+00005380: 645f 6f72 6967 696e 7320 3d20 7365 6c66  d_origins = self
+00005390: 2e61 7267 732e 6163 616f 202b 205b 0a20  .args.acao + [. 
+000053a0: 2020 2020 2020 2020 2020 2022 7b7d 3a2f             "{}:/
+000053b0: 2f7b 7d22 2e66 6f72 6d61 7428 0a20 2020  /{}".format(.   
+000053c0: 2020 2020 2020 2020 2020 2020 2022 6874               "ht
+000053d0: 7470 7322 2069 6620 7365 6c66 2e69 735f  tps" if self.is_
+000053e0: 6874 7470 7320 656c 7365 2022 6874 7470  https else "http
+000053f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00005400: 2020 2073 656c 662e 686f 7374 2e6c 6f77     self.host.low
+00005410: 6572 2829 2e73 706c 6974 2822 3a22 295b  er().split(":")[
+00005420: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+00005430: 290a 2020 2020 2020 2020 5d0a 2020 2020  ).        ].    
+00005440: 2020 2020 6966 2072 652e 7375 6228 7222      if re.sub(r"
+00005450: 283a 5b30 2d39 5d7b 312c 357d 293f 2f3f  (:[0-9]{1,5})?/?
+00005460: 2422 2c20 2222 2c20 6f72 6967 696e 2920  $", "", origin) 
+00005470: 696e 2067 6f6f 645f 6f72 6967 696e 733a  in good_origins:
+00005480: 0a20 2020 2020 2020 2020 2020 2067 6f6f  .            goo
+00005490: 645f 6f72 6967 696e 203d 2054 7275 650a  d_origin = True.
+000054a0: 2020 2020 2020 2020 2020 2020 6261 645f              bad_
+000054b0: 6864 7273 203d 2028 2222 2c29 0a20 2020  hdrs = ("",).   
+000054c0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000054d0: 2020 2020 2020 2067 6f6f 645f 6f72 6967         good_orig
+000054e0: 696e 203d 2046 616c 7365 0a20 2020 2020  in = False.     
+000054f0: 2020 2020 2020 2062 6164 5f68 6472 7320         bad_hdrs 
+00005500: 3d20 2822 222c 2022 7077 2229 0a0a 2020  = ("", "pw")..  
+00005510: 2020 2020 2020 2320 272a 2720 626c 6f63        # '*' bloc
+00005520: 6b73 2061 6c6c 2063 7265 6465 6e74 6961  ks all credentia
+00005530: 6c73 2028 636f 6f6b 6965 732c 2068 7474  ls (cookies, htt
+00005540: 702d 6175 7468 293b 0a20 2020 2020 2020  p-auth);.       
+00005550: 2023 2065 7861 6374 2d6d 6174 6368 2066   # exact-match f
+00005560: 6f72 204f 7269 6769 6e20 6973 206e 6563  or Origin is nec
+00005570: 6573 7361 7279 2074 6f20 756e 6c6f 636b  essary to unlock
+00005580: 2074 686f 7365 2c0a 2020 2020 2020 2020   those,.        
+00005590: 2320 686f 7765 7665 7220 796f 6c6f 2d72  # however yolo-r
+000055a0: 6571 7565 7374 7320 283f 7077 3d29 2061  equests (?pw=) a
+000055b0: 7265 2061 6c77 6179 7320 616c 6c6f 7765  re always allowe
+000055c0: 640a 2020 2020 2020 2020 6163 6168 203d  d.        acah =
+000055d0: 2069 682e 6765 7428 2261 6363 6573 732d   ih.get("access-
+000055e0: 636f 6e74 726f 6c2d 7265 7175 6573 742d  control-request-
+000055f0: 6865 6164 6572 7322 2c20 2222 290a 2020  headers", "").  
+00005600: 2020 2020 2020 6163 616f 203d 2028 6f72        acao = (or
+00005610: 6967 696e 2069 6620 676f 6f64 5f6f 7269  igin if good_ori
+00005620: 6769 6e20 656c 7365 204e 6f6e 6529 206f  gin else None) o
+00005630: 7220 280a 2020 2020 2020 2020 2020 2020  r (.            
+00005640: 222a 2220 6966 2022 2a22 2069 6e20 676f  "*" if "*" in go
+00005650: 6f64 5f6f 7269 6769 6e73 2065 6c73 6520  od_origins else 
+00005660: 4e6f 6e65 0a20 2020 2020 2020 2029 0a20  None.        ). 
+00005670: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
+00005680: 7267 732e 616c 6c6f 775f 6373 7266 3a0a  rgs.allow_csrf:.
+00005690: 2020 2020 2020 2020 2020 2020 6163 616f              acao
+000056a0: 203d 206f 7269 6769 6e20 6f72 2061 6361   = origin or aca
+000056b0: 6f20 6f72 2022 2a22 2020 2320 6578 706c  o or "*"  # expl
+000056c0: 6963 6974 6c79 2070 6572 6d69 7420 696d  icitly permit im
+000056d0: 7065 7273 6f6e 6174 696f 6e0a 2020 2020  personation.    
+000056e0: 2020 2020 2020 2020 6163 616d 203d 2022          acam = "
+000056f0: 2c20 222e 6a6f 696e 2873 656c 662e 636f  , ".join(self.co
+00005700: 6e6e 2e68 7372 762e 6d61 6c6c 6f77 2920  nn.hsrv.mallow) 
+00005710: 2023 2061 6e64 2061 6c6c 206d 6574 686f   # and all metho
+00005720: 6473 202b 2068 6561 6465 7273 0a20 2020  ds + headers.   
+00005730: 2020 2020 2020 2020 206f 685b 2241 6363           oh["Acc
+00005740: 6573 732d 436f 6e74 726f 6c2d 416c 6c6f  ess-Control-Allo
+00005750: 772d 4372 6564 656e 7469 616c 7322 5d20  w-Credentials"] 
+00005760: 3d20 2274 7275 6522 0a20 2020 2020 2020  = "true".       
+00005770: 2020 2020 2067 6f6f 645f 6f72 6967 696e       good_origin
+00005780: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00005790: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000057a0: 2020 6163 616d 203d 2022 2c20 222e 6a6f    acam = ", ".jo
+000057b0: 696e 2873 656c 662e 6172 6773 2e61 6361  in(self.args.aca
+000057c0: 6d29 0a20 2020 2020 2020 2020 2020 2023  m).            #
+000057d0: 2077 6173 6820 636c 6965 6e74 2d72 6571   wash client-req
+000057e0: 7565 7374 6564 2068 6561 6465 7273 2061  uested headers a
+000057f0: 6e64 2072 6f6c 6c20 7769 7468 2074 6861  nd roll with tha
+00005800: 740a 2020 2020 2020 2020 2020 2020 6966  t.            if
+00005810: 2022 7261 6e67 6522 206e 6f74 2069 6e20   "range" not in 
+00005820: 6163 6168 2e6c 6f77 6572 2829 3a0a 2020  acah.lower():.  
+00005830: 2020 2020 2020 2020 2020 2020 2020 6163                ac
+00005840: 6168 202b 3d20 222c 5261 6e67 6522 2020  ah += ",Range"  
+00005850: 2320 6669 7265 666f 780a 2020 2020 2020  # firefox.      
+00005860: 2020 2020 2020 7265 715f 6820 3d20 6163        req_h = ac
+00005870: 6168 2e73 706c 6974 2822 2c22 290a 2020  ah.split(",").  
+00005880: 2020 2020 2020 2020 2020 7265 715f 6820            req_h 
+00005890: 3d20 5b78 2e73 7472 6970 2829 2066 6f72  = [x.strip() for
+000058a0: 2078 2069 6e20 7265 715f 685d 0a20 2020   x in req_h].   
+000058b0: 2020 2020 2020 2020 2072 6571 5f68 203d           req_h =
+000058c0: 205b 7820 666f 7220 7820 696e 2072 6571   [x for x in req
+000058d0: 5f68 2069 6620 782e 6c6f 7765 7228 2920  _h if x.lower() 
+000058e0: 6e6f 7420 696e 2062 6164 5f68 6472 735d  not in bad_hdrs]
+000058f0: 0a20 2020 2020 2020 2020 2020 2061 6361  .            aca
+00005900: 6820 3d20 222c 2022 2e6a 6f69 6e28 7265  h = ", ".join(re
+00005910: 715f 6829 0a0a 2020 2020 2020 2020 6966  q_h)..        if
+00005920: 206e 6f74 2061 6361 6f3a 0a20 2020 2020   not acao:.     
+00005930: 2020 2020 2020 2072 6574 7572 6e20 4661         return Fa
+00005940: 6c73 650a 0a20 2020 2020 2020 206f 685b  lse..        oh[
+00005950: 2241 6363 6573 732d 436f 6e74 726f 6c2d  "Access-Control-
+00005960: 416c 6c6f 772d 4f72 6967 696e 225d 203d  Allow-Origin"] =
+00005970: 2061 6361 6f0a 2020 2020 2020 2020 6f68   acao.        oh
+00005980: 5b22 4163 6365 7373 2d43 6f6e 7472 6f6c  ["Access-Control
+00005990: 2d41 6c6c 6f77 2d4d 6574 686f 6473 225d  -Allow-Methods"]
+000059a0: 203d 2061 6361 6d2e 7570 7065 7228 290a   = acam.upper().
+000059b0: 2020 2020 2020 2020 6966 2061 6361 683a          if acah:
+000059c0: 0a20 2020 2020 2020 2020 2020 206f 685b  .            oh[
+000059d0: 2241 6363 6573 732d 436f 6e74 726f 6c2d  "Access-Control-
+000059e0: 416c 6c6f 772d 4865 6164 6572 7322 5d20  Allow-Headers"] 
+000059f0: 3d20 6163 6168 0a0a 2020 2020 2020 2020  = acah..        
+00005a00: 7265 7475 726e 2067 6f6f 645f 6f72 6967  return good_orig
+00005a10: 696e 0a0a 2020 2020 6465 6620 6861 6e64  in..    def hand
+00005a20: 6c65 5f67 6574 2873 656c 6629 2020 3a0a  le_get(self)  :.
+00005a30: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00005a40: 646f 5f6c 6f67 3a0a 2020 2020 2020 2020  do_log:.        
+00005a50: 2020 2020 6c6f 676d 7367 203d 2022 7b3a      logmsg = "{:
+00005a60: 347d 207b 7d22 2e66 6f72 6d61 7428 7365  4} {}".format(se
+00005a70: 6c66 2e6d 6f64 652c 2073 656c 662e 7265  lf.mode, self.re
+00005a80: 7129 0a0a 2020 2020 2020 2020 2020 2020  q)..            
+00005a90: 6966 2022 7261 6e67 6522 2069 6e20 7365  if "range" in se
+00005aa0: 6c66 2e68 6561 6465 7273 3a0a 2020 2020  lf.headers:.    
+00005ab0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00005ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005ad0: 2020 2020 2072 7661 6c20 3d20 7365 6c66       rval = self
+00005ae0: 2e68 6561 6465 7273 5b22 7261 6e67 6522  .headers["range"
+00005af0: 5d2e 7370 6c69 7428 223d 222c 2031 295b  ].split("=", 1)[
+00005b00: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+00005b10: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00005b20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00005b30: 7661 6c20 3d20 7365 6c66 2e68 6561 6465  val = self.heade
+00005b40: 7273 5b22 7261 6e67 6522 5d0a 0a20 2020  rs["range"]..   
+00005b50: 2020 2020 2020 2020 2020 2020 206c 6f67               log
+00005b60: 6d73 6720 2b3d 2022 205b 5c30 3333 5b33  msg += " [\033[3
+00005b70: 366d 2220 2b20 7276 616c 202b 2022 5c30  6m" + rval + "\0
+00005b80: 3333 5b30 6d5d 220a 0a20 2020 2020 2020  33[0m]"..       
+00005b90: 2020 2020 2073 656c 662e 6c6f 6728 6c6f       self.log(lo
+00005ba0: 676d 7367 290a 0a20 2020 2020 2020 2023  gmsg)..        #
+00005bb0: 2022 656d 6265 6464 6564 2220 7265 736f   "embedded" reso
+00005bc0: 7572 6365 730a 2020 2020 2020 2020 6966  urces.        if
+00005bd0: 2073 656c 662e 7670 6174 682e 7374 6172   self.vpath.star
+00005be0: 7473 7769 7468 2822 2e63 7072 2229 3a0a  tswith(".cpr"):.
+00005bf0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00005c00: 656c 662e 7670 6174 682e 7374 6172 7473  elf.vpath.starts
+00005c10: 7769 7468 2822 2e63 7072 2f69 636f 2f22  with(".cpr/ico/"
+00005c20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00005c30: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
+00005c40: 785f 6963 6f28 7365 6c66 2e76 7061 7468  x_ico(self.vpath
+00005c50: 2e73 706c 6974 2822 2f22 295b 2d31 5d2c  .split("/")[-1],
+00005c60: 2065 7861 6374 3d54 7275 6529 0a0a 2020   exact=True)..  
+00005c70: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00005c80: 662e 7670 6174 682e 7374 6172 7473 7769  f.vpath.startswi
+00005c90: 7468 2822 2e63 7072 2f73 7364 7022 293a  th(".cpr/ssdp"):
+00005ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005cb0: 2072 6574 7572 6e20 7365 6c66 2e63 6f6e   return self.con
+00005cc0: 6e2e 6873 7276 2e73 7364 702e 7265 706c  n.hsrv.ssdp.repl
+00005cd0: 7928 7365 6c66 290a 0a20 2020 2020 2020  y(self)..       
+00005ce0: 2020 2020 2069 6620 7365 6c66 2e76 7061       if self.vpa
+00005cf0: 7468 2e73 7461 7274 7377 6974 6828 222e  th.startswith(".
+00005d00: 6370 722f 6464 2f22 2920 616e 6420 7365  cpr/dd/") and se
+00005d10: 6c66 2e61 7267 732e 6d70 6d63 3a0a 2020  lf.args.mpmc:.  
+00005d20: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00005d30: 2073 656c 662e 6172 6773 2e6d 706d 6320   self.args.mpmc 
+00005d40: 3d3d 2022 2e22 3a0a 2020 2020 2020 2020  == ".":.        
+00005d50: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00005d60: 6520 5065 626b 6163 2834 3034 290a 0a20  e Pebkac(404).. 
+00005d70: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00005d80: 6f63 203d 2073 656c 662e 6172 6773 2e6d  oc = self.args.m
+00005d90: 706d 632e 7273 7472 6970 2822 2f22 2920  pmc.rstrip("/") 
+00005da0: 2b20 7365 6c66 2e76 7061 7468 5b73 656c  + self.vpath[sel
+00005db0: 662e 7670 6174 682e 7266 696e 6428 222f  f.vpath.rfind("/
+00005dc0: 2229 203a 5d0a 2020 2020 2020 2020 2020  ") :].          
+00005dd0: 2020 2020 2020 6820 3d20 7b22 4c6f 6361        h = {"Loca
+00005de0: 7469 6f6e 223a 206c 6f63 2c20 2243 6163  tion": loc, "Cac
+00005df0: 6865 2d43 6f6e 7472 6f6c 223a 2022 6d61  he-Control": "ma
+00005e00: 782d 6167 653d 3339 227d 0a20 2020 2020  x-age=39"}.     
+00005e10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005e20: 7265 706c 7928 6222 222c 2033 3031 2c20  reply(b"", 301, 
+00005e30: 6865 6164 6572 733d 6829 0a20 2020 2020  headers=h).     
+00005e40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00005e50: 6e20 5472 7565 0a0a 2020 2020 2020 2020  n True..        
+00005e60: 2020 2020 7374 6174 6963 5f70 6174 6820      static_path 
+00005e70: 3d20 6f73 2e70 6174 682e 6a6f 696e 2873  = os.path.join(s
+00005e80: 656c 662e 452e 6d6f 642c 2022 7765 622f  elf.E.mod, "web/
+00005e90: 222c 2073 656c 662e 7670 6174 685b 353a  ", self.vpath[5:
+00005ea0: 5d29 0a20 2020 2020 2020 2020 2020 2072  ]).            r
+00005eb0: 6574 7572 6e20 7365 6c66 2e74 785f 6669  eturn self.tx_fi
+00005ec0: 6c65 2873 7461 7469 635f 7061 7468 290a  le(static_path).
+00005ed0: 0a20 2020 2020 2020 2069 6620 2263 665f  .        if "cf_
+00005ee0: 6368 616c 6c65 6e67 6522 2069 6e20 7365  challenge" in se
+00005ef0: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
+00005f00: 2020 2020 2020 2073 656c 662e 7265 706c         self.repl
+00005f10: 7928 7365 6c66 2e6a 3273 2822 6366 2229  y(self.j2s("cf")
+00005f20: 2e65 6e63 6f64 6528 2275 7466 2d38 222c  .encode("utf-8",
+00005f30: 2022 7265 706c 6163 6522 2929 0a20 2020   "replace")).   
+00005f40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00005f50: 5472 7565 0a0a 2020 2020 2020 2020 6966  True..        if
+00005f60: 206e 6f74 2073 656c 662e 6361 6e5f 7265   not self.can_re
+00005f70: 6164 2061 6e64 206e 6f74 2073 656c 662e  ad and not self.
+00005f80: 6361 6e5f 7772 6974 6520 616e 6420 6e6f  can_write and no
+00005f90: 7420 7365 6c66 2e63 616e 5f67 6574 3a0a  t self.can_get:.
+00005fa0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00005fb0: 656c 662e 7670 6174 683a 0a20 2020 2020  elf.vpath:.     
+00005fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00005fd0: 6c6f 6728 2269 6e61 6363 6573 7369 626c  log("inaccessibl
+00005fe0: 653a 205b 7b7d 5d22 2e66 6f72 6d61 7428  e: [{}]".format(
+00005ff0: 7365 6c66 2e76 7061 7468 2929 0a20 2020  self.vpath)).   
+00006000: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00006010: 7572 6e20 7365 6c66 2e74 785f 3430 3428  urn self.tx_404(
+00006020: 5472 7565 290a 0a20 2020 2020 2020 2020  True)..         
+00006030: 2020 2073 656c 662e 7570 6172 616d 5b22     self.uparam["
+00006040: 6822 5d20 3d20 2222 0a0a 2020 2020 2020  h"] = ""..      
+00006050: 2020 6966 2022 7472 6565 2220 696e 2073    if "tree" in s
+00006060: 656c 662e 7570 6172 616d 3a0a 2020 2020  elf.uparam:.    
+00006070: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00006080: 656c 662e 7478 5f74 7265 6528 290a 0a20  elf.tx_tree().. 
+00006090: 2020 2020 2020 2069 6620 2273 6361 6e22         if "scan"
+000060a0: 2069 6e20 7365 6c66 2e75 7061 7261 6d3a   in self.uparam:
+000060b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000060c0: 7572 6e20 7365 6c66 2e73 6361 6e76 6f6c  urn self.scanvol
+000060d0: 2829 0a0a 2020 2020 2020 2020 6966 2073  ()..        if s
+000060e0: 656c 662e 6172 6773 2e67 6574 6d6f 643a  elf.args.getmod:
+000060f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006100: 2264 656c 6574 6522 2069 6e20 7365 6c66  "delete" in self
+00006110: 2e75 7061 7261 6d3a 0a20 2020 2020 2020  .uparam:.       
+00006120: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00006130: 7365 6c66 2e68 616e 646c 655f 726d 285b  self.handle_rm([
+00006140: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+00006150: 6966 2022 6d6f 7665 2220 696e 2073 656c  if "move" in sel
+00006160: 662e 7570 6172 616d 3a0a 2020 2020 2020  f.uparam:.      
+00006170: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006180: 2073 656c 662e 6861 6e64 6c65 5f6d 7628   self.handle_mv(
+00006190: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+000061a0: 7420 7365 6c66 2e76 7061 7468 3a0a 2020  t self.vpath:.  
+000061b0: 2020 2020 2020 2020 2020 6966 2022 7265            if "re
+000061c0: 6c6f 6164 2220 696e 2073 656c 662e 7570  load" in self.up
+000061d0: 6172 616d 3a0a 2020 2020 2020 2020 2020  aram:.          
+000061e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000061f0: 662e 6861 6e64 6c65 5f72 656c 6f61 6428  f.handle_reload(
+00006200: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00006210: 6620 2273 7461 636b 2220 696e 2073 656c  f "stack" in sel
+00006220: 662e 7570 6172 616d 3a0a 2020 2020 2020  f.uparam:.      
+00006230: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00006240: 2073 656c 662e 7478 5f73 7461 636b 2829   self.tx_stack()
+00006250: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00006260: 2022 7570 7322 2069 6e20 7365 6c66 2e75   "ups" in self.u
+00006270: 7061 7261 6d3a 0a20 2020 2020 2020 2020  param:.         
+00006280: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00006290: 6c66 2e74 785f 7570 7328 290a 0a20 2020  lf.tx_ups()..   
+000062a0: 2020 2020 2020 2020 2069 6620 226b 3330           if "k30
+000062b0: 3422 2069 6e20 7365 6c66 2e75 7061 7261  4" in self.upara
+000062c0: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+000062d0: 2020 2072 6574 7572 6e20 7365 6c66 2e73     return self.s
+000062e0: 6574 5f6b 3330 3428 290a 0a20 2020 2020  et_k304()..     
+000062f0: 2020 2020 2020 2069 6620 2273 6574 636b         if "setck
+00006300: 2220 696e 2073 656c 662e 7570 6172 616d  " in self.uparam
+00006310: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006320: 2020 7265 7475 726e 2073 656c 662e 7365    return self.se
+00006330: 7463 6b28 290a 0a20 2020 2020 2020 2020  tck()..         
+00006340: 2020 2069 6620 2272 6573 6574 2220 696e     if "reset" in
+00006350: 2073 656c 662e 7570 6172 616d 3a0a 2020   self.uparam:.  
+00006360: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00006370: 7475 726e 2073 656c 662e 7365 745f 6366  turn self.set_cf
+00006380: 675f 7265 7365 7428 290a 0a20 2020 2020  g_reset()..     
+00006390: 2020 2020 2020 2069 6620 2268 6322 2069         if "hc" i
+000063a0: 6e20 7365 6c66 2e75 7061 7261 6d3a 0a20  n self.uparam:. 
+000063b0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000063c0: 6574 7572 6e20 7365 6c66 2e74 785f 7376  eturn self.tx_sv
+000063d0: 6373 2829 0a0a 2020 2020 2020 2020 6966  cs()..        if
+000063e0: 2022 6822 2069 6e20 7365 6c66 2e75 7061   "h" in self.upa
+000063f0: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
+00006400: 2072 6574 7572 6e20 7365 6c66 2e74 785f   return self.tx_
+00006410: 6d6f 756e 7473 2829 0a0a 2020 2020 2020  mounts()..      
+00006420: 2020 2320 636f 6e64 6974 696f 6e61 6c20    # conditional 
+00006430: 7265 6469 7265 6374 2074 6f20 7369 6e67  redirect to sing
+00006440: 6c65 2076 6f6c 756d 6573 0a20 2020 2020  le volumes.     
+00006450: 2020 2069 6620 7365 6c66 2e76 7061 7468     if self.vpath
+00006460: 203d 3d20 2222 2061 6e64 206e 6f74 2073   == "" and not s
+00006470: 656c 662e 6f75 7061 7261 6d3a 0a20 2020  elf.ouparam:.   
+00006480: 2020 2020 2020 2020 206e 7265 6164 203d           nread =
+00006490: 206c 656e 2873 656c 662e 7276 6f6c 290a   len(self.rvol).
+000064a0: 2020 2020 2020 2020 2020 2020 6e77 7269              nwri
+000064b0: 7465 203d 206c 656e 2873 656c 662e 7776  te = len(self.wv
+000064c0: 6f6c 290a 2020 2020 2020 2020 2020 2020  ol).            
+000064d0: 6966 206e 7265 6164 202b 206e 7772 6974  if nread + nwrit
+000064e0: 6520 3d3d 2031 206f 7220 2873 656c 662e  e == 1 or (self.
+000064f0: 7276 6f6c 203d 3d20 7365 6c66 2e77 766f  rvol == self.wvo
+00006500: 6c20 616e 6420 6e72 6561 6420 3d3d 2031  l and nread == 1
+00006510: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00006520: 2020 2069 6620 6e72 6561 6420 3d3d 2031     if nread == 1
+00006530: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006540: 2020 2020 2020 7670 6174 6820 3d20 7365        vpath = se
+00006550: 6c66 2e72 766f 6c5b 305d 0a20 2020 2020  lf.rvol[0].     
+00006560: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00006570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006580: 2020 2020 2076 7061 7468 203d 2073 656c       vpath = sel
+00006590: 662e 7776 6f6c 5b30 5d0a 0a20 2020 2020  f.wvol[0]..     
+000065a0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000065b0: 6c66 2e76 7061 7468 2021 3d20 7670 6174  lf.vpath != vpat
+000065c0: 683a 0a20 2020 2020 2020 2020 2020 2020  h:.             
+000065d0: 2020 2020 2020 2073 656c 662e 7265 6469         self.redi
+000065e0: 7265 6374 2876 7061 7468 2c20 666c 6176  rect(vpath, flav
+000065f0: 6f72 3d22 7265 6469 7265 6374 696e 6720  or="redirecting 
+00006600: 746f 222c 2075 7365 3330 323d 5472 7565  to", use302=True
+00006610: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006620: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00006630: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+00006640: 6e20 7365 6c66 2e74 785f 6272 6f77 7365  n self.tx_browse
+00006650: 7228 290a 0a20 2020 2064 6566 2068 616e  r()..    def han
+00006660: 646c 655f 7072 6f70 6669 6e64 2873 656c  dle_propfind(sel
+00006670: 6629 2020 3a0a 2020 2020 2020 2020 6966  f)  :.        if
+00006680: 2073 656c 662e 646f 5f6c 6f67 3a0a 2020   self.do_log:.  
+00006690: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+000066a0: 6f67 2822 5046 494e 4420 2220 2b20 7365  og("PFIND " + se
+000066b0: 6c66 2e72 6571 290a 0a20 2020 2020 2020  lf.req)..       
+000066c0: 2069 6620 7365 6c66 2e61 7267 732e 6e6f   if self.args.no
+000066d0: 5f64 6176 3a0a 2020 2020 2020 2020 2020  _dav:.          
+000066e0: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+000066f0: 3035 2c20 2257 6562 4441 5620 6973 2064  05, "WebDAV is d
+00006700: 6973 6162 6c65 6420 696e 2073 6572 7665  isabled in serve
+00006710: 7220 636f 6e66 6967 2229 0a0a 2020 2020  r config")..    
+00006720: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+00006730: 6361 6e5f 7265 6164 2061 6e64 206e 6f74  can_read and not
+00006740: 2073 656c 662e 6361 6e5f 7772 6974 6520   self.can_write 
+00006750: 616e 6420 6e6f 7420 7365 6c66 2e63 616e  and not self.can
+00006760: 5f67 6574 3a0a 2020 2020 2020 2020 2020  _get:.          
+00006770: 2020 6966 2073 656c 662e 7670 6174 683a    if self.vpath:
+00006780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006790: 2073 656c 662e 6c6f 6728 2269 6e61 6363   self.log("inacc
+000067a0: 6573 7369 626c 653a 205b 7b7d 5d22 2e66  essible: [{}]".f
+000067b0: 6f72 6d61 7428 7365 6c66 2e76 7061 7468  ormat(self.vpath
+000067c0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+000067d0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
+000067e0: 3430 312c 2022 6175 7468 656e 7469 6361  401, "authentica
+000067f0: 7465 2229 0a0a 2020 2020 2020 2020 2020  te")..          
+00006800: 2020 7365 6c66 2e75 7061 7261 6d5b 2268    self.uparam["h
+00006810: 225d 203d 2022 220a 0a20 2020 2020 2020  "] = ""..       
+00006820: 2066 726f 6d20 2e64 786d 6c20 696d 706f   from .dxml impo
+00006830: 7274 2070 6172 7365 5f78 6d6c 0a0a 2020  rt parse_xml..  
+00006840: 2020 2020 2020 2320 656e 6320 3d20 2277        # enc = "w
+00006850: 696e 646f 7773 2d33 316a 220a 2020 2020  indows-31j".    
+00006860: 2020 2020 2320 656e 6320 3d20 2273 6869      # enc = "shi
+00006870: 6674 5f6a 6973 220a 2020 2020 2020 2020  ft_jis".        
+00006880: 656e 6320 3d20 2275 7466 2d38 220a 2020  enc = "utf-8".  
+00006890: 2020 2020 2020 7565 6e63 203d 2065 6e63        uenc = enc
+000068a0: 2e75 7070 6572 2829 0a0a 2020 2020 2020  .upper()..      
+000068b0: 2020 636c 656e 203d 2069 6e74 2873 656c    clen = int(sel
+000068c0: 662e 6865 6164 6572 732e 6765 7428 2263  f.headers.get("c
+000068d0: 6f6e 7465 6e74 2d6c 656e 6774 6822 2c20  ontent-length", 
+000068e0: 3029 290a 2020 2020 2020 2020 6966 2063  0)).        if c
+000068f0: 6c65 6e3a 0a20 2020 2020 2020 2020 2020  len:.           
+00006900: 2062 7566 203d 2062 2222 0a20 2020 2020   buf = b"".     
+00006910: 2020 2020 2020 2066 6f72 2072 6275 6620         for rbuf 
+00006920: 696e 2073 656c 662e 6765 745f 626f 6479  in self.get_body
+00006930: 5f72 6561 6465 7228 295b 305d 3a0a 2020  _reader()[0]:.  
+00006940: 2020 2020 2020 2020 2020 2020 2020 6275                bu
+00006950: 6620 2b3d 2072 6275 660a 2020 2020 2020  f += rbuf.      
+00006960: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00006970: 2072 6275 6620 6f72 206c 656e 2862 7566   rbuf or len(buf
+00006980: 2920 3e3d 2033 3237 3638 3a0a 2020 2020  ) >= 32768:.    
+00006990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000069a0: 6272 6561 6b0a 0a20 2020 2020 2020 2020  break..         
+000069b0: 2020 2078 726f 6f74 203d 2070 6172 7365     xroot = parse
+000069c0: 5f78 6d6c 2862 7566 2e64 6563 6f64 6528  _xml(buf.decode(
+000069d0: 656e 632c 2022 7265 706c 6163 6522 2929  enc, "replace"))
+000069e0: 0a20 2020 2020 2020 2020 2020 2078 7461  .            xta
+000069f0: 6720 3d20 6e65 7874 2878 2066 6f72 2078  g = next(x for x
+00006a00: 2069 6e20 7872 6f6f 7420 6966 2078 2e74   in xroot if x.t
+00006a10: 6167 2e73 706c 6974 2822 7d22 295b 2d31  ag.split("}")[-1
+00006a20: 5d20 3d3d 2022 7072 6f70 2229 0a20 2020  ] == "prop").   
+00006a30: 2020 2020 2020 2020 2070 726f 7073 5f6c           props_l
+00006a40: 7374 203d 205b 792e 7461 672e 7370 6c69  st = [y.tag.spli
+00006a50: 7428 227d 2229 5b2d 315d 2066 6f72 2079  t("}")[-1] for y
+00006a60: 2069 6e20 7874 6167 5d0a 2020 2020 2020   in xtag].      
+00006a70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00006a80: 2020 2020 7072 6f70 735f 6c73 7420 3d20      props_lst = 
+00006a90: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00006aa0: 2020 2263 6f6e 7465 6e74 636c 6173 7322    "contentclass"
+00006ab0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006ac0: 2020 2263 7265 6174 696f 6e64 6174 6522    "creationdate"
+00006ad0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006ae0: 2020 2264 6566 6175 6c74 646f 6375 6d65    "defaultdocume
+00006af0: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
+00006b00: 2020 2020 2022 6469 7370 6c61 796e 616d       "displaynam
+00006b10: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00006b20: 2020 2020 2267 6574 636f 6e74 656e 746c      "getcontentl
+00006b30: 616e 6775 6167 6522 2c0a 2020 2020 2020  anguage",.      
+00006b40: 2020 2020 2020 2020 2020 2267 6574 636f            "getco
+00006b50: 6e74 656e 746c 656e 6774 6822 2c0a 2020  ntentlength",.  
+00006b60: 2020 2020 2020 2020 2020 2020 2020 2267                "g
+00006b70: 6574 636f 6e74 656e 7474 7970 6522 2c0a  etcontenttype",.
+00006b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006b90: 2267 6574 6c61 7374 6d6f 6469 6669 6564  "getlastmodified
+00006ba0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00006bb0: 2020 2022 6872 6566 222c 0a20 2020 2020     "href",.     
+00006bc0: 2020 2020 2020 2020 2020 2022 6973 636f             "isco
+00006bd0: 6c6c 6563 7469 6f6e 222c 0a20 2020 2020  llection",.     
+00006be0: 2020 2020 2020 2020 2020 2022 6973 6869             "ishi
+00006bf0: 6464 656e 222c 0a20 2020 2020 2020 2020  dden",.         
+00006c00: 2020 2020 2020 2022 6973 7265 6164 6f6e         "isreadon
+00006c10: 6c79 222c 0a20 2020 2020 2020 2020 2020  ly",.           
+00006c20: 2020 2020 2022 6973 726f 6f74 222c 0a20       "isroot",. 
+00006c30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006c40: 6973 7374 7275 6374 7572 6564 646f 6375  isstructureddocu
+00006c50: 6d65 6e74 222c 0a20 2020 2020 2020 2020  ment",.         
+00006c60: 2020 2020 2020 2022 6c61 7374 6163 6365         "lastacce
+00006c70: 7373 6564 222c 0a20 2020 2020 2020 2020  ssed",.         
+00006c80: 2020 2020 2020 2022 6e61 6d65 222c 0a20         "name",. 
+00006c90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00006ca0: 7061 7265 6e74 6e61 6d65 222c 0a20 2020  parentname",.   
+00006cb0: 2020 2020 2020 2020 2020 2020 2022 7265               "re
+00006cc0: 736f 7572 6365 7479 7065 222c 0a20 2020  sourcetype",.   
+00006cd0: 2020 2020 2020 2020 2020 2020 2022 7375               "su
+00006ce0: 7070 6f72 7465 646c 6f63 6b22 2c0a 2020  pportedlock",.  
+00006cf0: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
+00006d00: 2020 2020 2070 726f 7073 203d 2073 6574       props = set
+00006d10: 2870 726f 7073 5f6c 7374 290a 2020 2020  (props_lst).    
+00006d20: 2020 2020 766e 2c20 7265 6d20 3d20 7365      vn, rem = se
+00006d30: 6c66 2e61 7372 762e 7666 732e 6765 7428  lf.asrv.vfs.get(
+00006d40: 7365 6c66 2e76 7061 7468 2c20 7365 6c66  self.vpath, self
+00006d50: 2e75 6e61 6d65 2c20 5472 7565 2c20 4661  .uname, True, Fa
+00006d60: 6c73 652c 2065 7272 3d34 3031 290a 2020  lse, err=401).  
+00006d70: 2020 2020 2020 7461 7020 3d20 766e 2e63        tap = vn.c
+00006d80: 616e 6f6e 6963 616c 2872 656d 290a 2020  anonical(rem).  
+00006d90: 2020 2020 2020 6465 7074 6820 3d20 7365        depth = se
+00006da0: 6c66 2e68 6561 6465 7273 2e67 6574 2822  lf.headers.get("
+00006db0: 6465 7074 6822 2c20 2269 6e66 696e 6974  depth", "infinit
+00006dc0: 7922 292e 6c6f 7765 7228 290a 0a20 2020  y").lower()..   
+00006dd0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00006de0: 2020 2020 2020 746f 7064 6972 203d 207b        topdir = {
+00006df0: 2276 7022 3a20 2222 2c20 2273 7422 3a20  "vp": "", "st": 
+00006e00: 626f 732e 7374 6174 2874 6170 297d 0a20  bos.stat(tap)}. 
+00006e10: 2020 2020 2020 2065 7863 6570 7420 4f53         except OS
+00006e20: 4572 726f 7220 6173 2065 783a 0a20 2020  Error as ex:.   
+00006e30: 2020 2020 2020 2020 2069 6620 6578 2e65           if ex.e
+00006e40: 7272 6e6f 206e 6f74 2069 6e20 2865 7272  rrno not in (err
+00006e50: 6e6f 2e45 4e4f 454e 542c 2065 7272 6e6f  no.ENOENT, errno
+00006e60: 2e45 4e4f 5444 4952 293a 0a20 2020 2020  .ENOTDIR):.     
+00006e70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00006e80: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00006e90: 7365 2050 6562 6b61 6328 3430 3429 0a0a  se Pebkac(404)..
+00006ea0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00006eb0: 7461 742e 535f 4953 4449 5228 746f 7064  tat.S_ISDIR(topd
+00006ec0: 6972 5b22 7374 225d 2e73 745f 6d6f 6465  ir["st"].st_mode
+00006ed0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00006ee0: 6765 6e20 3d20 5b5d 0a0a 2020 2020 2020  gen = []..      
+00006ef0: 2020 656c 6966 2064 6570 7468 203d 3d20    elif depth == 
+00006f00: 2269 6e66 696e 6974 7922 3a0a 2020 2020  "infinity":.    
+00006f10: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00006f20: 656c 662e 6172 6773 2e64 6176 5f69 6e66  elf.args.dav_inf
+00006f30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006f40: 2020 7365 6c66 2e6c 6f67 2822 636c 6965    self.log("clie
+00006f50: 6e74 2077 616e 7473 202d 2d64 6176 2d69  nt wants --dav-i
+00006f60: 6e66 222c 2033 290a 2020 2020 2020 2020  nf", 3).        
+00006f70: 2020 2020 2020 2020 7a62 203d 2062 273c          zb = b'<
+00006f80: 3f78 6d6c 2076 6572 7369 6f6e 3d22 312e  ?xml version="1.
+00006f90: 3022 2065 6e63 6f64 696e 673d 2275 7466  0" encoding="utf
+00006fa0: 2d38 223f 3e5c 6e3c 443a 6572 726f 7220  -8"?>\n<D:error 
+00006fb0: 786d 6c6e 733a 443d 2244 4156 3a22 3e3c  xmlns:D="DAV:"><
+00006fc0: 443a 7072 6f70 6669 6e64 2d66 696e 6974  D:propfind-finit
+00006fd0: 652d 6465 7074 682f 3e3c 2f44 3a65 7272  e-depth/></D:err
+00006fe0: 6f72 3e27 0a20 2020 2020 2020 2020 2020  or>'.           
+00006ff0: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
+00007000: 7a62 2c20 3430 332c 2022 6170 706c 6963  zb, 403, "applic
+00007010: 6174 696f 6e2f 786d 6c3b 2063 6861 7273  ation/xml; chars
+00007020: 6574 3d75 7466 2d38 2229 0a20 2020 2020  et=utf-8").     
+00007030: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00007040: 6e20 5472 7565 0a0a 2020 2020 2020 2020  n True..        
+00007050: 2020 2020 2320 7468 6973 2077 696c 6c20      # this will 
+00007060: 7265 7475 726e 2073 796d 6c69 6e6b 2d74  return symlink-t
+00007070: 6172 6765 7420 7469 6d65 7374 616d 7073  arget timestamps
+00007080: 0a20 2020 2020 2020 2020 2020 2023 2062  .            # b
+00007090: 6563 6175 7365 206c 7374 6174 3d74 7275  ecause lstat=tru
+000070a0: 6520 776f 756c 6420 6e6f 7420 7265 6375  e would not recu
+000070b0: 7273 6520 696e 746f 2073 7562 666f 6c64  rse into subfold
+000070c0: 6572 730a 2020 2020 2020 2020 2020 2020  ers.            
+000070d0: 2320 616e 6420 7468 6973 2069 7320 6120  # and this is a 
+000070e0: 7261 7265 2063 6173 6520 7768 6572 6520  rare case where 
+000070f0: 7765 2061 6374 7561 6c6c 7920 7761 6e74  we actually want
+00007100: 2074 6861 740a 2020 2020 2020 2020 2020   that.          
+00007110: 2020 6667 656e 203d 2076 6e2e 7a69 7067    fgen = vn.zipg
+00007120: 656e 280a 2020 2020 2020 2020 2020 2020  en(.            
+00007130: 2020 2020 7265 6d2c 0a20 2020 2020 2020      rem,.       
+00007140: 2020 2020 2020 2020 2072 656d 2c0a 2020           rem,.  
+00007150: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00007160: 7428 292c 0a20 2020 2020 2020 2020 2020  t(),.           
+00007170: 2020 2020 2073 656c 662e 756e 616d 652c       self.uname,
+00007180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007190: 2073 656c 662e 6172 6773 2e65 642c 0a20   self.args.ed,. 
+000071a0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+000071b0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+000071c0: 2020 2020 206e 6f74 2073 656c 662e 6172       not self.ar
+000071d0: 6773 2e6e 6f5f 7363 616e 6469 722c 0a20  gs.no_scandir,. 
+000071e0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+000071f0: 7261 703d 4661 6c73 652c 0a20 2020 2020  rap=False,.     
+00007200: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00007210: 2020 656c 6966 2064 6570 7468 203d 3d20    elif depth == 
+00007220: 2231 223a 0a20 2020 2020 2020 2020 2020  "1":.           
+00007230: 205f 2c20 7666 735f 6c73 2c20 7666 735f   _, vfs_ls, vfs_
+00007240: 7669 7274 203d 2076 6e2e 6c73 280a 2020  virt = vn.ls(.  
+00007250: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00007260: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
+00007270: 2020 2073 656c 662e 756e 616d 652c 0a20     self.uname,. 
+00007280: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00007290: 6f74 2073 656c 662e 6172 6773 2e6e 6f5f  ot self.args.no_
+000072a0: 7363 616e 6469 722c 0a20 2020 2020 2020  scandir,.       
+000072b0: 2020 2020 2020 2020 205b 5b54 7275 652c           [[True,
+000072c0: 2046 616c 7365 5d5d 2c0a 2020 2020 2020   False]],.      
+000072d0: 2020 2020 2020 2020 2020 6c73 7461 743d            lstat=
+000072e0: 2264 6176 7274 2220 6e6f 7420 696e 2076  "davrt" not in v
+000072f0: 6e2e 666c 6167 732c 0a20 2020 2020 2020  n.flags,.       
+00007300: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00007310: 2020 2069 6620 6e6f 7420 7365 6c66 2e61     if not self.a
+00007320: 7267 732e 6564 3a0a 2020 2020 2020 2020  rgs.ed:.        
+00007330: 2020 2020 2020 2020 6e61 6d65 7320 3d20          names = 
+00007340: 7365 7428 6578 636c 7564 655f 646f 7466  set(exclude_dotf
+00007350: 696c 6573 285b 785b 305d 2066 6f72 2078  iles([x[0] for x
+00007360: 2069 6e20 7666 735f 6c73 5d29 290a 2020   in vfs_ls])).  
+00007370: 2020 2020 2020 2020 2020 2020 2020 7666                vf
+00007380: 735f 6c73 203d 205b 7820 666f 7220 7820  s_ls = [x for x 
+00007390: 696e 2076 6673 5f6c 7320 6966 2078 5b30  in vfs_ls if x[0
+000073a0: 5d20 696e 206e 616d 6573 5d0a 0a20 2020  ] in names]..   
+000073b0: 2020 2020 2020 2020 207a 6920 3d20 696e           zi = in
+000073c0: 7428 7469 6d65 2e74 696d 6528 2929 0a20  t(time.time()). 
+000073d0: 2020 2020 2020 2020 2020 207a 7372 203d             zsr =
+000073e0: 206f 732e 7374 6174 5f72 6573 756c 7428   os.stat_result(
+000073f0: 2831 3638 3737 2c20 2d31 2c20 2d31 2c20  (16877, -1, -1, 
+00007400: 312c 2031 3030 302c 2031 3030 302c 2038  1, 1000, 1000, 8
+00007410: 2c20 7a69 2c20 7a69 2c20 7a69 2929 0a20  , zi, zi, zi)). 
+00007420: 2020 2020 2020 2020 2020 206c 7320 3d20             ls = 
+00007430: 5b7b 2276 7022 3a20 7670 2c20 2273 7422  [{"vp": vp, "st"
+00007440: 3a20 7374 7d20 666f 7220 7670 2c20 7374  : st} for vp, st
+00007450: 2069 6e20 7666 735f 6c73 5d0a 2020 2020   in vfs_ls].    
+00007460: 2020 2020 2020 2020 6c73 202b 3d20 5b7b          ls += [{
+00007470: 2276 7022 3a20 762c 2022 7374 223a 207a  "vp": v, "st": z
+00007480: 7372 7d20 666f 7220 7620 696e 2076 6673  sr} for v in vfs
+00007490: 5f76 6972 745d 0a20 2020 2020 2020 2020  _virt].         
+000074a0: 2020 2066 6765 6e20 3d20 6c73 2020 2320     fgen = ls  # 
+000074b0: 7479 7065 3a20 6967 6e6f 7265 0a0a 2020  type: ignore..  
+000074c0: 2020 2020 2020 656c 6966 2064 6570 7468        elif depth
+000074d0: 203d 3d20 2230 223a 0a20 2020 2020 2020   == "0":.       
+000074e0: 2020 2020 2066 6765 6e20 3d20 5b5d 2020       fgen = []  
+000074f0: 2320 7479 7065 3a20 6967 6e6f 7265 0a0a  # type: ignore..
+00007500: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007510: 2020 2020 2020 2020 2020 7420 3d20 2269            t = "i
+00007520: 6e76 616c 6964 2064 6570 7468 2076 616c  nvalid depth val
+00007530: 7565 2027 7b7d 2720 286d 7573 7420 6265  ue '{}' (must be
+00007540: 2065 6974 6865 7220 2730 2720 6f72 2027   either '0' or '
+00007550: 3127 7b7d 2922 0a20 2020 2020 2020 2020  1'{})".         
+00007560: 2020 2074 3220 3d20 2220 6f72 2027 696e     t2 = " or 'in
+00007570: 6669 6e69 7479 2722 2069 6620 7365 6c66  finity'" if self
+00007580: 2e61 7267 732e 6461 765f 696e 6620 656c  .args.dav_inf el
+00007590: 7365 2022 220a 2020 2020 2020 2020 2020  se "".          
+000075a0: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+000075b0: 3132 2c20 742e 666f 726d 6174 2864 6570  12, t.format(dep
+000075c0: 7468 2c20 7432 2929 0a0a 2020 2020 2020  th, t2))..      
+000075d0: 2020 6667 656e 203d 2069 7465 7274 6f6f    fgen = itertoo
+000075e0: 6c73 2e63 6861 696e 285b 746f 7064 6972  ls.chain([topdir
+000075f0: 5d2c 2066 6765 6e29 2020 2320 7479 7065  ], fgen)  # type
+00007600: 3a20 6967 6e6f 7265 0a20 2020 2020 2020  : ignore.       
+00007610: 2076 746f 7020 3d20 766a 6f69 6e28 7365   vtop = vjoin(se
+00007620: 6c66 2e61 7267 732e 522c 2076 6a6f 696e  lf.args.R, vjoin
+00007630: 2876 6e2e 7670 6174 682c 2072 656d 2929  (vn.vpath, rem))
+00007640: 0a0a 2020 2020 2020 2020 6368 756e 6b73  ..        chunks
+00007650: 7a20 3d20 3078 3746 4638 2020 2320 7072  z = 0x7FF8  # pr
+00007660: 6566 6572 7265 6420 6279 206e 6769 6e78  eferred by nginx
+00007670: 206f 7220 6366 2028 6475 6e6e 6f20 7768   or cf (dunno wh
+00007680: 6963 6829 0a0a 2020 2020 2020 2020 7365  ich)..        se
+00007690: 6c66 2e73 656e 645f 6865 6164 6572 7328  lf.send_headers(
+000076a0: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
+000076b0: 652c 2032 3037 2c20 2274 6578 742f 786d  e, 207, "text/xm
+000076c0: 6c3b 2063 6861 7273 6574 3d22 202b 2065  l; charset=" + e
+000076d0: 6e63 2c20 7b22 5472 616e 7366 6572 2d45  nc, {"Transfer-E
+000076e0: 6e63 6f64 696e 6722 3a20 2263 6875 6e6b  ncoding": "chunk
+000076f0: 6564 227d 0a20 2020 2020 2020 2029 0a0a  ed"}.        )..
+00007700: 2020 2020 2020 2020 7265 7420 3d20 273c          ret = '<
+00007710: 3f78 6d6c 2076 6572 7369 6f6e 3d22 312e  ?xml version="1.
+00007720: 3022 2065 6e63 6f64 696e 673d 227b 7d22  0" encoding="{}"
+00007730: 3f3e 5c6e 3c44 3a6d 756c 7469 7374 6174  ?>\n<D:multistat
+00007740: 7573 2078 6d6c 6e73 3a44 3d22 4441 563a  us xmlns:D="DAV:
+00007750: 223e 270a 2020 2020 2020 2020 7265 7420  ">'.        ret 
+00007760: 3d20 7265 742e 666f 726d 6174 2875 656e  = ret.format(uen
+00007770: 6329 0a20 2020 2020 2020 2066 6f72 2078  c).        for x
+00007780: 2069 6e20 6667 656e 3a0a 2020 2020 2020   in fgen:.      
+00007790: 2020 2020 2020 7270 203d 2076 6a6f 696e        rp = vjoin
+000077a0: 2876 746f 702c 2078 5b22 7670 225d 290a  (vtop, x["vp"]).
+000077b0: 2020 2020 2020 2020 2020 2020 7374 2020              st  
+000077c0: 3d20 785b 2273 7422 5d0a 2020 2020 2020  = x["st"].      
+000077d0: 2020 2020 2020 6d74 696d 6520 3d20 7374        mtime = st
+000077e0: 2e73 745f 6d74 696d 650a 2020 2020 2020  .st_mtime.      
+000077f0: 2020 2020 2020 6966 2073 7461 742e 535f        if stat.S_
+00007800: 4953 4c4e 4b28 7374 2e73 745f 6d6f 6465  ISLNK(st.st_mode
+00007810: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00007820: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00007830: 2020 2020 2020 2020 2020 2020 7374 203d              st =
+00007840: 2062 6f73 2e73 7461 7428 6f73 2e70 6174   bos.stat(os.pat
+00007850: 682e 6a6f 696e 2874 6170 2c20 785b 2276  h.join(tap, x["v
+00007860: 7022 5d29 290a 2020 2020 2020 2020 2020  p"])).          
+00007870: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+00007880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007890: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
+000078a0: 2020 2020 2020 2020 6973 6469 7220 3d20          isdir = 
+000078b0: 7374 6174 2e53 5f49 5344 4952 2873 742e  stat.S_ISDIR(st.
+000078c0: 7374 5f6d 6f64 6529 0a0a 2020 2020 2020  st_mode)..      
+000078d0: 2020 2020 2020 7265 7420 2b3d 2022 3c44        ret += "<D
+000078e0: 3a72 6573 706f 6e73 653e 3c44 3a68 7265  :response><D:hre
+000078f0: 663e 2f25 7325 733c 2f44 3a68 7265 663e  f>/%s%s</D:href>
+00007900: 3c44 3a70 726f 7073 7461 743e 3c44 3a70  <D:propstat><D:p
+00007910: 726f 703e 2220 2520 280a 2020 2020 2020  rop>" % (.      
+00007920: 2020 2020 2020 2020 2020 7175 6f74 6570            quotep
+00007930: 2872 7029 2c0a 2020 2020 2020 2020 2020  (rp),.          
+00007940: 2020 2020 2020 222f 2220 6966 2069 7364        "/" if isd
+00007950: 6972 2061 6e64 2072 7020 656c 7365 2022  ir and rp else "
+00007960: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
+00007970: 0a0a 2020 2020 2020 2020 2020 2020 7076  ..            pv
+00007980: 7320 2020 3d20 7b0a 2020 2020 2020 2020  s   = {.        
+00007990: 2020 2020 2020 2020 2264 6973 706c 6179          "display
+000079a0: 6e61 6d65 223a 2068 746d 6c5f 6573 6361  name": html_esca
+000079b0: 7065 2872 702e 7370 6c69 7428 222f 2229  pe(rp.split("/")
+000079c0: 5b2d 315d 292c 0a20 2020 2020 2020 2020  [-1]),.         
+000079d0: 2020 2020 2020 2022 6765 746c 6173 746d         "getlastm
+000079e0: 6f64 6966 6965 6422 3a20 666f 726d 6174  odified": format
+000079f0: 6461 7465 286d 7469 6d65 2c20 7573 6567  date(mtime, useg
+00007a00: 6d74 3d54 7275 6529 2c0a 2020 2020 2020  mt=True),.      
+00007a10: 2020 2020 2020 2020 2020 2272 6573 6f75            "resou
+00007a20: 7263 6574 7970 6522 3a20 273c 443a 636f  rcetype": '<D:co
+00007a30: 6c6c 6563 7469 6f6e 2078 6d6c 6e73 3a44  llection xmlns:D
+00007a40: 3d22 4441 563a 222f 3e27 2069 6620 6973  ="DAV:"/>' if is
+00007a50: 6469 7220 656c 7365 2022 222c 0a20 2020  dir else "",.   
+00007a60: 2020 2020 2020 2020 2020 2020 2022 7375               "su
+00007a70: 7070 6f72 7465 646c 6f63 6b22 3a20 273c  pportedlock": '<
+00007a80: 443a 6c6f 636b 656e 7472 7920 786d 6c6e  D:lockentry xmln
+00007a90: 733a 443d 2244 4156 3a22 3e3c 443a 6c6f  s:D="DAV:"><D:lo
+00007aa0: 636b 7363 6f70 653e 3c44 3a65 7863 6c75  ckscope><D:exclu
+00007ab0: 7369 7665 2f3e 3c2f 443a 6c6f 636b 7363  sive/></D:locksc
+00007ac0: 6f70 653e 3c44 3a6c 6f63 6b74 7970 653e  ope><D:locktype>
+00007ad0: 3c44 3a77 7269 7465 2f3e 3c2f 443a 6c6f  <D:write/></D:lo
+00007ae0: 636b 7479 7065 3e3c 2f44 3a6c 6f63 6b65  cktype></D:locke
+00007af0: 6e74 7279 3e27 2c0a 2020 2020 2020 2020  ntry>',.        
+00007b00: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+00007b10: 2020 6966 206e 6f74 2069 7364 6972 3a0a    if not isdir:.
+00007b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b30: 7076 735b 2267 6574 636f 6e74 656e 7474  pvs["getcontentt
+00007b40: 7970 6522 5d20 3d20 6874 6d6c 5f65 7363  ype"] = html_esc
+00007b50: 6170 6528 6775 6573 735f 6d69 6d65 2872  ape(guess_mime(r
+00007b60: 7029 290a 2020 2020 2020 2020 2020 2020  p)).            
+00007b70: 2020 2020 7076 735b 2267 6574 636f 6e74      pvs["getcont
+00007b80: 656e 746c 656e 6774 6822 5d20 3d20 7374  entlength"] = st
+00007b90: 7228 7374 2e73 745f 7369 7a65 290a 0a20  r(st.st_size).. 
+00007ba0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+00007bb0: 2c20 7620 696e 2070 7673 2e69 7465 6d73  , v in pvs.items
+00007bc0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00007bd0: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
+00007be0: 7072 6f70 733a 0a20 2020 2020 2020 2020  props:.         
+00007bf0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00007c00: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
+00007c10: 2020 2020 656c 6966 2076 3a0a 2020 2020      elif v:.    
+00007c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c30: 7265 7420 2b3d 2022 3c44 3a25 733e 2573  ret += "<D:%s>%s
+00007c40: 3c2f 443a 2573 3e22 2025 2028 6b2c 2076  </D:%s>" % (k, v
+00007c50: 2c20 6b29 0a20 2020 2020 2020 2020 2020  , k).           
+00007c60: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00007c70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00007c80: 6574 202b 3d20 223c 443a 2573 2f3e 2220  et += "<D:%s/>" 
+00007c90: 2520 286b 2c29 0a0a 2020 2020 2020 2020  % (k,)..        
+00007ca0: 2020 2020 7265 7420 2b3d 2022 3c2f 443a      ret += "</D:
+00007cb0: 7072 6f70 3e3c 443a 7374 6174 7573 3e48  prop><D:status>H
+00007cc0: 5454 502f 312e 3120 3230 3020 4f4b 3c2f  TTP/1.1 200 OK</
+00007cd0: 443a 7374 6174 7573 3e3c 2f44 3a70 726f  D:status></D:pro
+00007ce0: 7073 7461 743e 220a 0a20 2020 2020 2020  pstat>"..       
+00007cf0: 2020 2020 206d 6973 7369 6e67 203d 205b       missing = [
+00007d00: 223c 443a 2573 2f3e 2220 2520 2878 2c29  "<D:%s/>" % (x,)
+00007d10: 2066 6f72 2078 2069 6e20 7072 6f70 7320   for x in props 
+00007d20: 6966 2078 206e 6f74 2069 6e20 7076 735d  if x not in pvs]
+00007d30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00007d40: 6d69 7373 696e 6720 616e 6420 636c 656e  missing and clen
+00007d50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007d60: 2020 7420 3d20 223c 443a 7072 6f70 7374    t = "<D:propst
+00007d70: 6174 3e3c 443a 7072 6f70 3e7b 7d3c 2f44  at><D:prop>{}</D
+00007d80: 3a70 726f 703e 3c44 3a73 7461 7475 733e  :prop><D:status>
+00007d90: 4854 5450 2f31 2e31 2034 3034 204e 6f74  HTTP/1.1 404 Not
+00007da0: 2046 6f75 6e64 3c2f 443a 7374 6174 7573   Found</D:status
+00007db0: 3e3c 2f44 3a70 726f 7073 7461 743e 220a  ></D:propstat>".
+00007dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007dd0: 7265 7420 2b3d 2074 2e66 6f72 6d61 7428  ret += t.format(
+00007de0: 2222 2e6a 6f69 6e28 6d69 7373 696e 6729  "".join(missing)
+00007df0: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00007e00: 6574 202b 3d20 223c 2f44 3a72 6573 706f  et += "</D:respo
+00007e10: 6e73 653e 220a 2020 2020 2020 2020 2020  nse>".          
+00007e20: 2020 7768 696c 6520 6c65 6e28 7265 7429    while len(ret)
+00007e30: 203e 3d20 6368 756e 6b73 7a3a 0a20 2020   >= chunksz:.   
+00007e40: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00007e50: 203d 2073 656c 662e 7365 6e64 5f63 6875   = self.send_chu
+00007e60: 6e6b 2872 6574 2c20 656e 632c 2063 6875  nk(ret, enc, chu
+00007e70: 6e6b 737a 290a 0a20 2020 2020 2020 2072  nksz)..        r
+00007e80: 6574 202b 3d20 223c 2f44 3a6d 756c 7469  et += "</D:multi
+00007e90: 7374 6174 7573 3e22 0a20 2020 2020 2020  status>".       
+00007ea0: 2077 6869 6c65 2072 6574 3a0a 2020 2020   while ret:.    
+00007eb0: 2020 2020 2020 2020 7265 7420 3d20 7365          ret = se
+00007ec0: 6c66 2e73 656e 645f 6368 756e 6b28 7265  lf.send_chunk(re
+00007ed0: 742c 2065 6e63 2c20 6368 756e 6b73 7a29  t, enc, chunksz)
+00007ee0: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+00007ef0: 656e 645f 6368 756e 6b28 2222 2c20 656e  end_chunk("", en
+00007f00: 632c 2063 6875 6e6b 737a 290a 2020 2020  c, chunksz).    
+00007f10: 2020 2020 2320 7365 6c66 2e72 6570 6c79      # self.reply
+00007f20: 2872 6574 2e65 6e63 6f64 6528 656e 632c  (ret.encode(enc,
+00007f30: 2022 7265 706c 6163 6522 292c 3230 372c   "replace"),207,
+00007f40: 2022 7465 7874 2f78 6d6c 3b20 6368 6172   "text/xml; char
+00007f50: 7365 743d 2220 2b20 656e 6329 0a20 2020  set=" + enc).   
+00007f60: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00007f70: 0a0a 2020 2020 6465 6620 6861 6e64 6c65  ..    def handle
+00007f80: 5f70 726f 7070 6174 6368 2873 656c 6629  _proppatch(self)
+00007f90: 2020 3a0a 2020 2020 2020 2020 6966 2073    :.        if s
+00007fa0: 656c 662e 646f 5f6c 6f67 3a0a 2020 2020  elf.do_log:.    
+00007fb0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00007fc0: 2822 5050 4154 4348 2022 202b 2073 656c  ("PPATCH " + sel
+00007fd0: 662e 7265 7129 0a0a 2020 2020 2020 2020  f.req)..        
+00007fe0: 6966 2073 656c 662e 6172 6773 2e6e 6f5f  if self.args.no_
+00007ff0: 6461 763a 0a20 2020 2020 2020 2020 2020  dav:.           
+00008000: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
+00008010: 352c 2022 5765 6244 4156 2069 7320 6469  5, "WebDAV is di
+00008020: 7361 626c 6564 2069 6e20 7365 7276 6572  sabled in server
+00008030: 2063 6f6e 6669 6722 290a 0a20 2020 2020   config")..     
+00008040: 2020 2069 6620 6e6f 7420 7365 6c66 2e63     if not self.c
+00008050: 616e 5f77 7269 7465 3a0a 2020 2020 2020  an_write:.      
+00008060: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
+00008070: 7b7d 2074 7269 6564 2074 6f20 7072 6f70  {} tried to prop
+00008080: 7061 7463 6820 5b7b 7d5d 222e 666f 726d  patch [{}]".form
+00008090: 6174 2873 656c 662e 756e 616d 652c 2073  at(self.uname, s
+000080a0: 656c 662e 7670 6174 6829 290a 2020 2020  elf.vpath)).    
+000080b0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
+000080c0: 626b 6163 2834 3031 2c20 2261 7574 6865  bkac(401, "authe
+000080d0: 6e74 6963 6174 6522 290a 0a20 2020 2020  nticate")..     
+000080e0: 2020 2066 726f 6d20 786d 6c2e 6574 7265     from xml.etre
+000080f0: 6520 696d 706f 7274 2045 6c65 6d65 6e74  e import Element
+00008100: 5472 6565 2061 7320 4554 0a0a 2020 2020  Tree as ET..    
+00008110: 2020 2020 6672 6f6d 202e 6478 6d6c 2069      from .dxml i
+00008120: 6d70 6f72 7420 6d6b 656e 6f64 2c20 6d6b  mport mkenod, mk
+00008130: 746e 6f64 2c20 7061 7273 655f 786d 6c0a  tnod, parse_xml.
+00008140: 0a20 2020 2020 2020 2073 656c 662e 6173  .        self.as
+00008150: 7276 2e76 6673 2e67 6574 2873 656c 662e  rv.vfs.get(self.
+00008160: 7670 6174 682c 2073 656c 662e 756e 616d  vpath, self.unam
+00008170: 652c 2046 616c 7365 2c20 4661 6c73 6529  e, False, False)
+00008180: 0a20 2020 2020 2020 2023 2061 6273 7061  .        # abspa
+00008190: 7468 203d 2076 6e2e 6463 616e 6f6e 6963  th = vn.dcanonic
+000081a0: 616c 2872 656d 290a 0a20 2020 2020 2020  al(rem)..       
+000081b0: 2062 7566 203d 2062 2222 0a20 2020 2020   buf = b"".     
+000081c0: 2020 2066 6f72 2072 6275 6620 696e 2073     for rbuf in s
+000081d0: 656c 662e 6765 745f 626f 6479 5f72 6561  elf.get_body_rea
+000081e0: 6465 7228 295b 305d 3a0a 2020 2020 2020  der()[0]:.      
+000081f0: 2020 2020 2020 6275 6620 2b3d 2072 6275        buf += rbu
+00008200: 660a 2020 2020 2020 2020 2020 2020 6966  f.            if
+00008210: 206e 6f74 2072 6275 6620 6f72 206c 656e   not rbuf or len
+00008220: 2862 7566 2920 3e3d 2031 3238 202a 2031  (buf) >= 128 * 1
+00008230: 3032 343a 0a20 2020 2020 2020 2020 2020  024:.           
+00008240: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
+00008250: 2020 2020 6966 2073 656c 662e 5f61 7070      if self._app
+00008260: 6c65 7361 6e28 293a 0a20 2020 2020 2020  lesan():.       
+00008270: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+00008280: 0a0a 2020 2020 2020 2020 7478 7420 3d20  ..        txt = 
+00008290: 6275 662e 6465 636f 6465 2822 6173 6369  buf.decode("asci
+000082a0: 6922 2c20 2272 6570 6c61 6365 2229 2e6c  i", "replace").l
+000082b0: 6f77 6572 2829 0a20 2020 2020 2020 2065  ower().        e
+000082c0: 6e63 203d 2073 656c 662e 6765 745f 786d  nc = self.get_xm
+000082d0: 6c5f 656e 6328 7478 7429 0a20 2020 2020  l_enc(txt).     
+000082e0: 2020 2075 656e 6320 3d20 656e 632e 7570     uenc = enc.up
+000082f0: 7065 7228 290a 0a20 2020 2020 2020 2074  per()..        t
+00008300: 7874 203d 2062 7566 2e64 6563 6f64 6528  xt = buf.decode(
+00008310: 656e 632c 2022 7265 706c 6163 6522 290a  enc, "replace").
+00008320: 2020 2020 2020 2020 4554 2e72 6567 6973          ET.regis
+00008330: 7465 725f 6e61 6d65 7370 6163 6528 2244  ter_namespace("D
+00008340: 222c 2022 4441 563a 2229 0a20 2020 2020  ", "DAV:").     
+00008350: 2020 2078 726f 6f74 203d 206d 6b65 6e6f     xroot = mkeno
+00008360: 6428 2244 3a6f 727a 2229 0a20 2020 2020  d("D:orz").     
+00008370: 2020 2078 726f 6f74 2e69 6e73 6572 7428     xroot.insert(
+00008380: 302c 2070 6172 7365 5f78 6d6c 2874 7874  0, parse_xml(txt
+00008390: 2929 0a20 2020 2020 2020 2078 7072 6f70  )).        xprop
+000083a0: 203d 2078 726f 6f74 2e66 696e 6428 7222   = xroot.find(r"
+000083b0: 2e2f 7b44 4156 3a7d 7072 6f70 6572 7479  ./{DAV:}property
+000083c0: 7570 6461 7465 2f7b 4441 563a 7d73 6574  update/{DAV:}set
+000083d0: 2f7b 4441 563a 7d70 726f 7022 290a 2020  /{DAV:}prop").  
+000083e0: 2020 2020 2020 6173 7365 7274 2078 7072        assert xpr
+000083f0: 6f70 0a20 2020 2020 2020 2066 6f72 207a  op.        for z
+00008400: 6520 696e 2078 7072 6f70 3a0a 2020 2020  e in xprop:.    
+00008410: 2020 2020 2020 2020 7a65 2e63 6c65 6172          ze.clear
+00008420: 2829 0a0a 2020 2020 2020 2020 7478 7420  ()..        txt 
+00008430: 3d20 2222 223c 6d75 6c74 6973 7461 7475  = """<multistatu
+00008440: 7320 786d 6c6e 733d 2244 4156 3a22 3e3c  s xmlns="DAV:"><
+00008450: 7265 7370 6f6e 7365 3e3c 7072 6f70 7374  response><propst
+00008460: 6174 3e3c 7374 6174 7573 3e48 5454 502f  at><status>HTTP/
+00008470: 312e 3120 3430 3320 466f 7262 6964 6465  1.1 403 Forbidde
+00008480: 6e3c 2f73 7461 7475 733e 3c2f 7072 6f70  n</status></prop
+00008490: 7374 6174 3e3c 2f72 6573 706f 6e73 653e  stat></response>
+000084a0: 3c2f 6d75 6c74 6973 7461 7475 733e 2222  </multistatus>""
+000084b0: 220a 2020 2020 2020 2020 7872 6f6f 7420  ".        xroot 
+000084c0: 3d20 7061 7273 655f 786d 6c28 7478 7429  = parse_xml(txt)
+000084d0: 0a0a 2020 2020 2020 2020 656c 203d 2078  ..        el = x
+000084e0: 726f 6f74 2e66 696e 6428 7222 2e2f 7b44  root.find(r"./{D
+000084f0: 4156 3a7d 7265 7370 6f6e 7365 2229 0a20  AV:}response"). 
+00008500: 2020 2020 2020 2061 7373 6572 7420 656c         assert el
+00008510: 0a20 2020 2020 2020 2065 3220 3d20 6d6b  .        e2 = mk
+00008520: 746e 6f64 2822 443a 6872 6566 222c 2071  tnod("D:href", q
+00008530: 756f 7465 7028 7365 6c66 2e61 7267 732e  uotep(self.args.
+00008540: 5352 5320 2b20 7365 6c66 2e76 7061 7468  SRS + self.vpath
+00008550: 2929 0a20 2020 2020 2020 2065 6c2e 696e  )).        el.in
+00008560: 7365 7274 2830 2c20 6532 290a 0a20 2020  sert(0, e2)..   
+00008570: 2020 2020 2065 6c20 3d20 7872 6f6f 742e       el = xroot.
+00008580: 6669 6e64 2872 222e 2f7b 4441 563a 7d72  find(r"./{DAV:}r
+00008590: 6573 706f 6e73 652f 7b44 4156 3a7d 7072  esponse/{DAV:}pr
+000085a0: 6f70 7374 6174 2229 0a20 2020 2020 2020  opstat").       
+000085b0: 2061 7373 6572 7420 656c 0a20 2020 2020   assert el.     
+000085c0: 2020 2065 6c2e 696e 7365 7274 2830 2c20     el.insert(0, 
+000085d0: 7870 726f 7029 0a0a 2020 2020 2020 2020  xprop)..        
+000085e0: 7265 7420 3d20 273c 3f78 6d6c 2076 6572  ret = '<?xml ver
+000085f0: 7369 6f6e 3d22 312e 3022 2065 6e63 6f64  sion="1.0" encod
+00008600: 696e 673d 227b 7d22 3f3e 5c6e 272e 666f  ing="{}"?>\n'.fo
+00008610: 726d 6174 2875 656e 6329 0a20 2020 2020  rmat(uenc).     
+00008620: 2020 2072 6574 202b 3d20 4554 2e74 6f73     ret += ET.tos
+00008630: 7472 696e 6728 7872 6f6f 7429 2e64 6563  tring(xroot).dec
+00008640: 6f64 6528 2275 7466 2d38 2229 0a0a 2020  ode("utf-8")..  
+00008650: 2020 2020 2020 7365 6c66 2e72 6570 6c79        self.reply
+00008660: 2872 6574 2e65 6e63 6f64 6528 656e 632c  (ret.encode(enc,
+00008670: 2022 7265 706c 6163 6522 292c 2032 3037   "replace"), 207
+00008680: 2c20 2274 6578 742f 786d 6c3b 2063 6861  , "text/xml; cha
+00008690: 7273 6574 3d22 202b 2065 6e63 290a 2020  rset=" + enc).  
+000086a0: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+000086b0: 650a 0a20 2020 2064 6566 2068 616e 646c  e..    def handl
+000086c0: 655f 6c6f 636b 2873 656c 6629 2020 3a0a  e_lock(self)  :.
+000086d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000086e0: 646f 5f6c 6f67 3a0a 2020 2020 2020 2020  do_log:.        
+000086f0: 2020 2020 7365 6c66 2e6c 6f67 2822 4c4f      self.log("LO
+00008700: 434b 2022 202b 2073 656c 662e 7265 7129  CK " + self.req)
+00008710: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00008720: 662e 6172 6773 2e6e 6f5f 6461 763a 0a20  f.args.no_dav:. 
+00008730: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00008740: 2050 6562 6b61 6328 3430 352c 2022 5765   Pebkac(405, "We
+00008750: 6244 4156 2069 7320 6469 7361 626c 6564  bDAV is disabled
+00008760: 2069 6e20 7365 7276 6572 2063 6f6e 6669   in server confi
+00008770: 6722 290a 0a20 2020 2020 2020 2023 2077  g")..        # w
+00008780: 696e 372b 2064 6561 646c 6f63 6b73 2069  in7+ deadlocks i
+00008790: 6620 7765 2073 6179 206e 6f3b 206a 7573  f we say no; jus
+000087a0: 7420 736d 696c 6520 616e 6420 6e6f 640a  t smile and nod.
+000087b0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000087c0: 656c 662e 6361 6e5f 7772 6974 6520 616e  elf.can_write an
+000087d0: 6420 224d 6963 726f 736f 6674 2d57 6562  d "Microsoft-Web
+000087e0: 4441 5622 206e 6f74 2069 6e20 7365 6c66  DAV" not in self
+000087f0: 2e75 613a 0a20 2020 2020 2020 2020 2020  .ua:.           
+00008800: 2073 656c 662e 6c6f 6728 227b 7d20 7472   self.log("{} tr
+00008810: 6965 6420 746f 206c 6f63 6b20 5b7b 7d5d  ied to lock [{}]
+00008820: 222e 666f 726d 6174 2873 656c 662e 756e  ".format(self.un
+00008830: 616d 652c 2073 656c 662e 7670 6174 6829  ame, self.vpath)
+00008840: 290a 2020 2020 2020 2020 2020 2020 7261  ).            ra
+00008850: 6973 6520 5065 626b 6163 2834 3031 2c20  ise Pebkac(401, 
+00008860: 2261 7574 6865 6e74 6963 6174 6522 290a  "authenticate").
+00008870: 0a20 2020 2020 2020 2066 726f 6d20 786d  .        from xm
+00008880: 6c2e 6574 7265 6520 696d 706f 7274 2045  l.etree import E
+00008890: 6c65 6d65 6e74 5472 6565 2061 7320 4554  lementTree as ET
+000088a0: 0a0a 2020 2020 2020 2020 6672 6f6d 202e  ..        from .
+000088b0: 6478 6d6c 2069 6d70 6f72 7420 6d6b 656e  dxml import mken
+000088c0: 6f64 2c20 6d6b 746e 6f64 2c20 7061 7273  od, mktnod, pars
+000088d0: 655f 786d 6c0a 0a20 2020 2020 2020 2076  e_xml..        v
+000088e0: 6e2c 2072 656d 203d 2073 656c 662e 6173  n, rem = self.as
+000088f0: 7276 2e76 6673 2e67 6574 2873 656c 662e  rv.vfs.get(self.
+00008900: 7670 6174 682c 2073 656c 662e 756e 616d  vpath, self.unam
+00008910: 652c 2046 616c 7365 2c20 4661 6c73 6529  e, False, False)
+00008920: 0a20 2020 2020 2020 2061 6273 7061 7468  .        abspath
+00008930: 203d 2076 6e2e 6463 616e 6f6e 6963 616c   = vn.dcanonical
+00008940: 2872 656d 290a 0a20 2020 2020 2020 2062  (rem)..        b
+00008950: 7566 203d 2062 2222 0a20 2020 2020 2020  uf = b"".       
+00008960: 2066 6f72 2072 6275 6620 696e 2073 656c   for rbuf in sel
+00008970: 662e 6765 745f 626f 6479 5f72 6561 6465  f.get_body_reade
+00008980: 7228 295b 305d 3a0a 2020 2020 2020 2020  r()[0]:.        
+00008990: 2020 2020 6275 6620 2b3d 2072 6275 660a      buf += rbuf.
+000089a0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000089b0: 6f74 2072 6275 6620 6f72 206c 656e 2862  ot rbuf or len(b
+000089c0: 7566 2920 3e3d 2031 3238 202a 2031 3032  uf) >= 128 * 102
+000089d0: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
+000089e0: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+000089f0: 2020 6966 2073 656c 662e 5f61 7070 6c65    if self._apple
+00008a00: 7361 6e28 293a 0a20 2020 2020 2020 2020  san():.         
+00008a10: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+00008a20: 2020 2020 2020 2020 7478 7420 3d20 6275          txt = bu
+00008a30: 662e 6465 636f 6465 2822 6173 6369 6922  f.decode("ascii"
+00008a40: 2c20 2272 6570 6c61 6365 2229 2e6c 6f77  , "replace").low
+00008a50: 6572 2829 0a20 2020 2020 2020 2065 6e63  er().        enc
+00008a60: 203d 2073 656c 662e 6765 745f 786d 6c5f   = self.get_xml_
+00008a70: 656e 6328 7478 7429 0a20 2020 2020 2020  enc(txt).       
+00008a80: 2075 656e 6320 3d20 656e 632e 7570 7065   uenc = enc.uppe
+00008a90: 7228 290a 0a20 2020 2020 2020 2074 7874  r()..        txt
+00008aa0: 203d 2062 7566 2e64 6563 6f64 6528 656e   = buf.decode(en
+00008ab0: 632c 2022 7265 706c 6163 6522 290a 2020  c, "replace").  
+00008ac0: 2020 2020 2020 4554 2e72 6567 6973 7465        ET.registe
+00008ad0: 725f 6e61 6d65 7370 6163 6528 2244 222c  r_namespace("D",
+00008ae0: 2022 4441 563a 2229 0a20 2020 2020 2020   "DAV:").       
+00008af0: 206c 6b20 3d20 7061 7273 655f 786d 6c28   lk = parse_xml(
+00008b00: 7478 7429 0a20 2020 2020 2020 2061 7373  txt).        ass
+00008b10: 6572 7420 6c6b 2e74 6167 203d 3d20 227b  ert lk.tag == "{
+00008b20: 4441 563a 7d6c 6f63 6b69 6e66 6f22 0a0a  DAV:}lockinfo"..
+00008b30: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
+00008b40: 7374 7228 7575 6964 2e75 7569 6434 2829  str(uuid.uuid4()
+00008b50: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+00008b60: 7420 6c6b 2e66 696e 6428 7222 2e2f 7b44  t lk.find(r"./{D
+00008b70: 4156 3a7d 6465 7074 6822 293a 0a20 2020  AV:}depth"):.   
+00008b80: 2020 2020 2020 2020 2064 6570 7468 203d           depth =
+00008b90: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
+00008ba0: 7428 2264 6570 7468 222c 2022 696e 6669  t("depth", "infi
+00008bb0: 6e69 7479 2229 0a20 2020 2020 2020 2020  nity").         
+00008bc0: 2020 206c 6b2e 6170 7065 6e64 286d 6b74     lk.append(mkt
+00008bd0: 6e6f 6428 2244 3a64 6570 7468 222c 2064  nod("D:depth", d
+00008be0: 6570 7468 2929 0a0a 2020 2020 2020 2020  epth))..        
+00008bf0: 6c6b 2e61 7070 656e 6428 6d6b 746e 6f64  lk.append(mktnod
+00008c00: 2822 443a 7469 6d65 6f75 7422 2c20 2253  ("D:timeout", "S
+00008c10: 6563 6f6e 642d 3333 3130 2229 290a 2020  econd-3310")).  
+00008c20: 2020 2020 2020 6c6b 2e61 7070 656e 6428        lk.append(
+00008c30: 6d6b 656e 6f64 2822 443a 6c6f 636b 746f  mkenod("D:lockto
+00008c40: 6b65 6e22 2c20 6d6b 746e 6f64 2822 443a  ken", mktnod("D:
+00008c50: 6872 6566 222c 2074 6f6b 656e 2929 290a  href", token))).
+00008c60: 2020 2020 2020 2020 6c6b 2e61 7070 656e          lk.appen
+00008c70: 6428 0a20 2020 2020 2020 2020 2020 206d  d(.            m
+00008c80: 6b65 6e6f 6428 2244 3a6c 6f63 6b72 6f6f  kenod("D:lockroo
+00008c90: 7422 2c20 6d6b 746e 6f64 2822 443a 6872  t", mktnod("D:hr
+00008ca0: 6566 222c 2071 756f 7465 7028 7365 6c66  ef", quotep(self
+00008cb0: 2e61 7267 732e 5352 5320 2b20 7365 6c66  .args.SRS + self
+00008cc0: 2e76 7061 7468 2929 290a 2020 2020 2020  .vpath))).      
+00008cd0: 2020 290a 0a20 2020 2020 2020 206c 6b32    )..        lk2
+00008ce0: 203d 206d 6b65 6e6f 6428 2244 3a61 6374   = mkenod("D:act
+00008cf0: 6976 656c 6f63 6b22 290a 2020 2020 2020  ivelock").      
+00008d00: 2020 7872 6f6f 7420 3d20 6d6b 656e 6f64    xroot = mkenod
+00008d10: 2822 443a 7072 6f70 222c 206d 6b65 6e6f  ("D:prop", mkeno
+00008d20: 6428 2244 3a6c 6f63 6b64 6973 636f 7665  d("D:lockdiscove
+00008d30: 7279 222c 206c 6b32 2929 0a20 2020 2020  ry", lk2)).     
+00008d40: 2020 2066 6f72 2061 2069 6e20 6c6b 3a0a     for a in lk:.
+00008d50: 2020 2020 2020 2020 2020 2020 6c6b 322e              lk2.
+00008d60: 6170 7065 6e64 2861 290a 0a20 2020 2020  append(a)..     
+00008d70: 2020 2072 6574 203d 2027 3c3f 786d 6c20     ret = '<?xml 
+00008d80: 7665 7273 696f 6e3d 2231 2e30 2220 656e  version="1.0" en
+00008d90: 636f 6469 6e67 3d22 7b7d 223f 3e5c 6e27  coding="{}"?>\n'
+00008da0: 2e66 6f72 6d61 7428 7565 6e63 290a 2020  .format(uenc).  
+00008db0: 2020 2020 2020 7265 7420 2b3d 2045 542e        ret += ET.
+00008dc0: 746f 7374 7269 6e67 2878 726f 6f74 292e  tostring(xroot).
+00008dd0: 6465 636f 6465 2822 7574 662d 3822 290a  decode("utf-8").
+00008de0: 0a20 2020 2020 2020 2072 6320 3d20 3230  .        rc = 20
+00008df0: 300a 2020 2020 2020 2020 6966 2073 656c  0.        if sel
+00008e00: 662e 6361 6e5f 7772 6974 6520 616e 6420  f.can_write and 
+00008e10: 6e6f 7420 626f 732e 7061 7468 2e69 7366  not bos.path.isf
+00008e20: 696c 6528 6162 7370 6174 6829 3a0a 2020  ile(abspath):.  
+00008e30: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+00008e40: 7065 6e28 6673 656e 6328 6162 7370 6174  pen(fsenc(abspat
+00008e50: 6829 2c20 2277 6222 2920 6173 205f 3a0a  h), "wb") as _:.
+00008e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008e70: 7263 203d 2032 3031 0a0a 2020 2020 2020  rc = 201..      
+00008e80: 2020 7365 6c66 2e6f 7574 5f68 6561 6465    self.out_heade
+00008e90: 7273 5b22 4c6f 636b 2d54 6f6b 656e 225d  rs["Lock-Token"]
+00008ea0: 203d 2022 3c7b 7d3e 222e 666f 726d 6174   = "<{}>".format
+00008eb0: 2874 6f6b 656e 290a 2020 2020 2020 2020  (token).        
+00008ec0: 7365 6c66 2e72 6570 6c79 2872 6574 2e65  self.reply(ret.e
+00008ed0: 6e63 6f64 6528 656e 632c 2022 7265 706c  ncode(enc, "repl
+00008ee0: 6163 6522 292c 2072 632c 2022 7465 7874  ace"), rc, "text
+00008ef0: 2f78 6d6c 3b20 6368 6172 7365 743d 2220  /xml; charset=" 
+00008f00: 2b20 656e 6329 0a20 2020 2020 2020 2072  + enc).        r
+00008f10: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00008f20: 6465 6620 6861 6e64 6c65 5f75 6e6c 6f63  def handle_unloc
+00008f30: 6b28 7365 6c66 2920 203a 0a20 2020 2020  k(self)  :.     
+00008f40: 2020 2069 6620 7365 6c66 2e64 6f5f 6c6f     if self.do_lo
+00008f50: 673a 0a20 2020 2020 2020 2020 2020 2073  g:.            s
+00008f60: 656c 662e 6c6f 6728 2255 4e4c 4f43 4b20  elf.log("UNLOCK 
+00008f70: 2220 2b20 7365 6c66 2e72 6571 290a 0a20  " + self.req).. 
+00008f80: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
+00008f90: 7267 732e 6e6f 5f64 6176 3a0a 2020 2020  rgs.no_dav:.    
+00008fa0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
+00008fb0: 626b 6163 2834 3035 2c20 2257 6562 4441  bkac(405, "WebDA
+00008fc0: 5620 6973 2064 6973 6162 6c65 6420 696e  V is disabled in
+00008fd0: 2073 6572 7665 7220 636f 6e66 6967 2229   server config")
+00008fe0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00008ff0: 2073 656c 662e 6361 6e5f 7772 6974 6520   self.can_write 
+00009000: 616e 6420 224d 6963 726f 736f 6674 2d57  and "Microsoft-W
+00009010: 6562 4441 5622 206e 6f74 2069 6e20 7365  ebDAV" not in se
+00009020: 6c66 2e75 613a 0a20 2020 2020 2020 2020  lf.ua:.         
+00009030: 2020 2073 656c 662e 6c6f 6728 227b 7d20     self.log("{} 
+00009040: 7472 6965 6420 746f 206c 6f63 6b20 5b7b  tried to lock [{
+00009050: 7d5d 222e 666f 726d 6174 2873 656c 662e  }]".format(self.
+00009060: 756e 616d 652c 2073 656c 662e 7670 6174  uname, self.vpat
+00009070: 6829 290a 2020 2020 2020 2020 2020 2020  h)).            
+00009080: 7261 6973 6520 5065 626b 6163 2834 3031  raise Pebkac(401
+00009090: 2c20 2261 7574 6865 6e74 6963 6174 6522  , "authenticate"
+000090a0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000090b0: 7365 6e64 5f68 6561 6465 7273 284e 6f6e  send_headers(Non
+000090c0: 652c 2032 3034 290a 2020 2020 2020 2020  e, 204).        
+000090d0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+000090e0: 2064 6566 2068 616e 646c 655f 6d6b 636f   def handle_mkco
+000090f0: 6c28 7365 6c66 2920 203a 0a20 2020 2020  l(self)  :.     
+00009100: 2020 2069 6620 7365 6c66 2e5f 6170 706c     if self._appl
+00009110: 6573 616e 2829 3a0a 2020 2020 2020 2020  esan():.        
+00009120: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+00009130: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00009140: 2e64 6f5f 6c6f 673a 0a20 2020 2020 2020  .do_log:.       
+00009150: 2020 2020 2073 656c 662e 6c6f 6728 224d       self.log("M
+00009160: 4b43 4f4c 2022 202b 2073 656c 662e 7265  KCOL " + self.re
+00009170: 7129 0a0a 2020 2020 2020 2020 7472 793a  q)..        try:
+00009180: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00009190: 7572 6e20 7365 6c66 2e5f 6d6b 6469 7228  urn self._mkdir(
+000091a0: 7365 6c66 2e76 7061 7468 2c20 5472 7565  self.vpath, True
+000091b0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+000091c0: 2050 6562 6b61 6320 6173 2065 783a 0a20   Pebkac as ex:. 
+000091d0: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
+000091e0: 2e63 6f64 6520 3e3d 2035 3030 3a0a 2020  .code >= 500:.  
+000091f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00009200: 6973 650a 0a20 2020 2020 2020 2020 2020  ise..           
+00009210: 2073 656c 662e 7265 706c 7928 6222 222c   self.reply(b"",
+00009220: 2065 782e 636f 6465 290a 2020 2020 2020   ex.code).      
+00009230: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+00009240: 650a 0a20 2020 2064 6566 2068 616e 646c  e..    def handl
+00009250: 655f 6d6f 7665 2873 656c 6629 2020 3a0a  e_move(self)  :.
+00009260: 2020 2020 2020 2020 6473 7420 3d20 7365          dst = se
+00009270: 6c66 2e68 6561 6465 7273 5b22 6465 7374  lf.headers["dest
+00009280: 696e 6174 696f 6e22 5d0a 2020 2020 2020  ination"].      
+00009290: 2020 6473 7420 3d20 7265 2e73 7562 2822    dst = re.sub("
+000092a0: 5e68 7474 7073 3f3a 2f2f 5b5e 2f5d 2b22  ^https?://[^/]+"
+000092b0: 2c20 2222 2c20 6473 7429 2e6c 7374 7269  , "", dst).lstri
+000092c0: 7028 290a 2020 2020 2020 2020 6473 7420  p().        dst 
+000092d0: 3d20 756e 7175 6f74 6570 2864 7374 290a  = unquotep(dst).
+000092e0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000092f0: 656c 662e 5f6d 7628 7365 6c66 2e76 7061  elf._mv(self.vpa
+00009300: 7468 2c20 6473 742e 6c73 7472 6970 2822  th, dst.lstrip("
+00009310: 2f22 2929 3a0a 2020 2020 2020 2020 2020  /")):.          
+00009320: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
+00009330: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00009340: 7275 650a 0a20 2020 2064 6566 205f 6170  rue..    def _ap
+00009350: 706c 6573 616e 2873 656c 6629 2020 3a0a  plesan(self)  :.
+00009360: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00009370: 6172 6773 2e64 6176 5f6d 6163 206f 7220  args.dav_mac or 
+00009380: 2244 6172 7769 6e2f 2220 6e6f 7420 696e  "Darwin/" not in
+00009390: 2073 656c 662e 7561 3a0a 2020 2020 2020   self.ua:.      
+000093a0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+000093b0: 7365 0a0a 2020 2020 2020 2020 7670 203d  se..        vp =
+000093c0: 2022 2f22 202b 2073 656c 662e 7670 6174   "/" + self.vpat
+000093d0: 680a 2020 2020 2020 2020 7074 6e20 3d20  h.        ptn = 
+000093e0: 7222 2f5c 2e28 5f7c 4453 5f53 746f 7265  r"/\.(_|DS_Store
+000093f0: 7c53 706f 746c 6967 6874 2d7c 6673 6576  |Spotlight-|fsev
+00009400: 656e 7473 647c 5472 6173 6865 737c 4170  entsd|Trashes|Ap
+00009410: 706c 6544 6f75 626c 6529 7c2f 5f5f 4d41  pleDouble)|/__MA
+00009420: 434f 5322 0a20 2020 2020 2020 2069 6620  COS".        if 
+00009430: 7265 2e73 6561 7263 6828 7074 6e2c 2076  re.search(ptn, v
+00009440: 7029 3a0a 2020 2020 2020 2020 2020 2020  p):.            
+00009450: 7a74 203d 2027 3c3f 786d 6c20 7665 7273  zt = '<?xml vers
+00009460: 696f 6e3d 2231 2e30 2220 656e 636f 6469  ion="1.0" encodi
+00009470: 6e67 3d22 7574 662d 3822 3f3e 5c6e 3c44  ng="utf-8"?>\n<D
+00009480: 3a65 7272 6f72 2078 6d6c 6e73 3a44 3d22  :error xmlns:D="
+00009490: 4441 563a 223e 3c44 3a6c 6f63 6b2d 746f  DAV:"><D:lock-to
+000094a0: 6b65 6e2d 7375 626d 6974 7465 643e 3c44  ken-submitted><D
+000094b0: 3a68 7265 663e 7b7d 3c2f 443a 6872 6566  :href>{}</D:href
+000094c0: 3e3c 2f44 3a6c 6f63 6b2d 746f 6b65 6e2d  ></D:lock-token-
+000094d0: 7375 626d 6974 7465 643e 3c2f 443a 6572  submitted></D:er
+000094e0: 726f 723e 270a 2020 2020 2020 2020 2020  ror>'.          
+000094f0: 2020 7a62 203d 207a 742e 666f 726d 6174    zb = zt.format
+00009500: 2876 7029 2e65 6e63 6f64 6528 2275 7466  (vp).encode("utf
+00009510: 2d38 222c 2022 7265 706c 6163 6522 290a  -8", "replace").
+00009520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009530: 2e72 6570 6c79 287a 622c 2034 3233 2c20  .reply(zb, 423, 
+00009540: 2274 6578 742f 786d 6c3b 2063 6861 7273  "text/xml; chars
+00009550: 6574 3d75 7466 2d38 2229 0a20 2020 2020  et=utf-8").     
+00009560: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+00009570: 7565 0a0a 2020 2020 2020 2020 7265 7475  ue..        retu
+00009580: 726e 2046 616c 7365 0a0a 2020 2020 6465  rn False..    de
+00009590: 6620 7365 6e64 5f63 6875 6e6b 2873 656c  f send_chunk(sel
+000095a0: 662c 2074 7874 202c 2065 6e63 202c 2062  f, txt , enc , b
+000095b0: 6d61 7820 2920 203a 0a20 2020 2020 2020  max )  :.       
+000095c0: 206f 7269 675f 6c65 6e20 3d20 6c65 6e28   orig_len = len(
+000095d0: 7478 7429 0a20 2020 2020 2020 2062 7566  txt).        buf
+000095e0: 203d 2074 7874 5b3a 626d 6178 5d2e 656e   = txt[:bmax].en
+000095f0: 636f 6465 2865 6e63 2c20 2272 6570 6c61  code(enc, "repla
+00009600: 6365 2229 5b3a 626d 6178 5d0a 2020 2020  ce")[:bmax].    
+00009610: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00009620: 2020 2020 205f 203d 2062 7566 2e64 6563       _ = buf.dec
+00009630: 6f64 6528 656e 6329 0a20 2020 2020 2020  ode(enc).       
+00009640: 2065 7863 6570 7420 556e 6963 6f64 6544   except UnicodeD
+00009650: 6563 6f64 6545 7272 6f72 2061 7320 7564  ecodeError as ud
+00009660: 653a 0a20 2020 2020 2020 2020 2020 2062  e:.            b
+00009670: 7566 203d 2062 7566 5b3a 2075 6465 2e73  uf = buf[: ude.s
+00009680: 7461 7274 5d0a 0a20 2020 2020 2020 2074  tart]..        t
+00009690: 7874 203d 2074 7874 5b6c 656e 2862 7566  xt = txt[len(buf
+000096a0: 2e64 6563 6f64 6528 656e 6329 2920 3a5d  .decode(enc)) :]
+000096b0: 0a20 2020 2020 2020 2069 6620 7478 7420  .        if txt 
+000096c0: 616e 6420 6c65 6e28 7478 7429 203d 3d20  and len(txt) == 
+000096d0: 6f72 6967 5f6c 656e 3a0a 2020 2020 2020  orig_len:.      
+000096e0: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+000096f0: 6163 2835 3030 2c20 2263 6875 6e6b 2073  ac(500, "chunk s
+00009700: 6c69 6369 6e67 2066 6169 6c65 6422 290a  licing failed").
+00009710: 0a20 2020 2020 2020 2062 7566 203d 2022  .        buf = "
+00009720: 7b3a 787d 5c72 5c6e 222e 666f 726d 6174  {:x}\r\n".format
+00009730: 286c 656e 2862 7566 2929 2e65 6e63 6f64  (len(buf)).encod
+00009740: 6528 656e 6329 202b 2062 7566 0a20 2020  e(enc) + buf.   
+00009750: 2020 2020 2073 656c 662e 732e 7365 6e64       self.s.send
+00009760: 616c 6c28 6275 6620 2b20 6222 5c72 5c6e  all(buf + b"\r\n
+00009770: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
+00009780: 6e20 7478 740a 0a20 2020 2064 6566 2068  n txt..    def h
+00009790: 616e 646c 655f 6f70 7469 6f6e 7328 7365  andle_options(se
+000097a0: 6c66 2920 203a 0a20 2020 2020 2020 2069  lf)  :.        i
+000097b0: 6620 7365 6c66 2e64 6f5f 6c6f 673a 0a20  f self.do_log:. 
+000097c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000097d0: 6c6f 6728 224f 5054 494f 4e53 2022 202b  log("OPTIONS " +
+000097e0: 2073 656c 662e 7265 7129 0a0a 2020 2020   self.req)..    
+000097f0: 2020 2020 6f68 203d 2073 656c 662e 6f75      oh = self.ou
+00009800: 745f 6865 6164 6572 730a 2020 2020 2020  t_headers.      
+00009810: 2020 6f68 5b22 416c 6c6f 7722 5d20 3d20    oh["Allow"] = 
+00009820: 222c 2022 2e6a 6f69 6e28 7365 6c66 2e63  ", ".join(self.c
+00009830: 6f6e 6e2e 6873 7276 2e6d 616c 6c6f 7729  onn.hsrv.mallow)
+00009840: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00009850: 2073 656c 662e 6172 6773 2e6e 6f5f 6461   self.args.no_da
+00009860: 763a 0a20 2020 2020 2020 2020 2020 2023  v:.            #
+00009870: 2050 524f 5050 4154 4348 2c20 4c4f 434b   PROPPATCH, LOCK
+00009880: 2c20 554e 4c4f 434b 2c20 434f 5059 3a20  , UNLOCK, COPY: 
+00009890: 6e6f 6f70 2028 7370 6563 2d6d 7573 7429  noop (spec-must)
+000098a0: 0a20 2020 2020 2020 2020 2020 206f 685b  .            oh[
+000098b0: 2244 6176 225d 203d 2022 312c 2032 220a  "Dav"] = "1, 2".
+000098c0: 2020 2020 2020 2020 2020 2020 6f68 5b22              oh["
+000098d0: 4d73 2d41 7574 686f 722d 5669 6122 5d20  Ms-Author-Via"] 
+000098e0: 3d20 2244 4156 220a 0a20 2020 2020 2020  = "DAV"..       
+000098f0: 2023 2077 696e 7870 2d77 6562 6461 7620   # winxp-webdav 
+00009900: 646f 6573 6e74 206b 6e6f 7720 7768 6174  doesnt know what
+00009910: 2032 3034 2069 730a 2020 2020 2020 2020   204 is.        
+00009920: 7365 6c66 2e73 656e 645f 6865 6164 6572  self.send_header
+00009930: 7328 302c 2032 3030 290a 2020 2020 2020  s(0, 200).      
+00009940: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00009950: 2020 2064 6566 2068 616e 646c 655f 6465     def handle_de
+00009960: 6c65 7465 2873 656c 6629 2020 3a0a 2020  lete(self)  :.  
+00009970: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
+00009980: 4445 4c45 5445 2022 202b 2073 656c 662e  DELETE " + self.
+00009990: 7265 7129 0a20 2020 2020 2020 2072 6574  req).        ret
+000099a0: 7572 6e20 7365 6c66 2e68 616e 646c 655f  urn self.handle_
+000099b0: 726d 285b 5d29 0a0a 2020 2020 6465 6620  rm([])..    def 
+000099c0: 6861 6e64 6c65 5f70 7574 2873 656c 6629  handle_put(self)
+000099d0: 2020 3a0a 2020 2020 2020 2020 7365 6c66    :.        self
+000099e0: 2e6c 6f67 2822 5055 5420 2220 2b20 7365  .log("PUT " + se
+000099f0: 6c66 2e72 6571 290a 0a20 2020 2020 2020  lf.req)..       
+00009a00: 2069 6620 6e6f 7420 7365 6c66 2e63 616e   if not self.can
+00009a10: 5f77 7269 7465 3a0a 2020 2020 2020 2020  _write:.        
+00009a20: 2020 2020 7420 3d20 2275 7365 7220 7b7d      t = "user {}
+00009a30: 2064 6f65 7320 6e6f 7420 6861 7665 2077   does not have w
+00009a40: 7269 7465 2d61 6363 6573 7320 6865 7265  rite-access here
+00009a50: 220a 2020 2020 2020 2020 2020 2020 7261  ".            ra
+00009a60: 6973 6520 5065 626b 6163 2834 3033 2c20  ise Pebkac(403, 
+00009a70: 742e 666f 726d 6174 2873 656c 662e 756e  t.format(self.un
+00009a80: 616d 6529 290a 0a20 2020 2020 2020 2069  ame))..        i
+00009a90: 6620 6e6f 7420 7365 6c66 2e61 7267 732e  f not self.args.
+00009aa0: 6e6f 5f64 6176 2061 6e64 2073 656c 662e  no_dav and self.
+00009ab0: 5f61 7070 6c65 7361 6e28 293a 0a20 2020  _applesan():.   
+00009ac0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00009ad0: 7365 6c66 2e68 6561 6465 7273 2e67 6574  self.headers.get
+00009ae0: 2822 636f 6e74 656e 742d 6c65 6e67 7468  ("content-length
+00009af0: 2229 203d 3d20 2230 220a 0a20 2020 2020  ") == "0"..     
+00009b00: 2020 2069 6620 7365 6c66 2e68 6561 6465     if self.heade
+00009b10: 7273 2e67 6574 2822 6578 7065 6374 222c  rs.get("expect",
+00009b20: 2022 2229 2e6c 6f77 6572 2829 203d 3d20   "").lower() == 
+00009b30: 2231 3030 2d63 6f6e 7469 6e75 6522 3a0a  "100-continue":.
+00009b40: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00009b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009b60: 2073 656c 662e 732e 7365 6e64 616c 6c28   self.s.sendall(
+00009b70: 6222 4854 5450 2f31 2e31 2031 3030 2043  b"HTTP/1.1 100 C
+00009b80: 6f6e 7469 6e75 655c 725c 6e5c 725c 6e22  ontinue\r\n\r\n"
+00009b90: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
+00009ba0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
+00009bb0: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+00009bc0: 6163 2834 3030 2c20 2263 6c69 656e 7420  ac(400, "client 
+00009bd0: 642f 6320 6265 666f 7265 2031 3030 2063  d/c before 100 c
+00009be0: 6f6e 7469 6e75 6522 290a 0a20 2020 2020  ontinue")..     
+00009bf0: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+00009c00: 616e 646c 655f 7374 6173 6828 5472 7565  andle_stash(True
+00009c10: 290a 0a20 2020 2064 6566 2068 616e 646c  )..    def handl
+00009c20: 655f 706f 7374 2873 656c 6629 2020 3a0a  e_post(self)  :.
+00009c30: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00009c40: 2822 504f 5354 2022 202b 2073 656c 662e  ("POST " + self.
+00009c50: 7265 7129 0a0a 2020 2020 2020 2020 6966  req)..        if
+00009c60: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
+00009c70: 7428 2265 7870 6563 7422 2c20 2222 292e  t("expect", "").
+00009c80: 6c6f 7765 7228 2920 3d3d 2022 3130 302d  lower() == "100-
+00009c90: 636f 6e74 696e 7565 223a 0a20 2020 2020  continue":.     
+00009ca0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00009cb0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00009cc0: 2e73 2e73 656e 6461 6c6c 2862 2248 5454  .s.sendall(b"HTT
+00009cd0: 502f 312e 3120 3130 3020 436f 6e74 696e  P/1.1 100 Contin
+00009ce0: 7565 5c72 5c6e 5c72 5c6e 2229 0a20 2020  ue\r\n\r\n").   
+00009cf0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00009d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009d10: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
+00009d20: 302c 2022 636c 6965 6e74 2064 2f63 2062  0, "client d/c b
+00009d30: 6566 6f72 6520 3130 3020 636f 6e74 696e  efore 100 contin
+00009d40: 7565 2229 0a0a 2020 2020 2020 2020 6966  ue")..        if
+00009d50: 2022 7261 7722 2069 6e20 7365 6c66 2e75   "raw" in self.u
+00009d60: 7061 7261 6d3a 0a20 2020 2020 2020 2020  param:.         
+00009d70: 2020 2072 6574 7572 6e20 7365 6c66 2e68     return self.h
+00009d80: 616e 646c 655f 7374 6173 6828 4661 6c73  andle_stash(Fals
+00009d90: 6529 0a0a 2020 2020 2020 2020 6374 7970  e)..        ctyp
+00009da0: 6520 3d20 7365 6c66 2e68 6561 6465 7273  e = self.headers
+00009db0: 2e67 6574 2822 636f 6e74 656e 742d 7479  .get("content-ty
+00009dc0: 7065 222c 2022 2229 2e6c 6f77 6572 2829  pe", "").lower()
+00009dd0: 0a0a 2020 2020 2020 2020 6966 2022 6d75  ..        if "mu
+00009de0: 6c74 6970 6172 742f 666f 726d 2d64 6174  ltipart/form-dat
+00009df0: 6122 2069 6e20 6374 7970 653a 0a20 2020  a" in ctype:.   
+00009e00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00009e10: 7365 6c66 2e68 616e 646c 655f 706f 7374  self.handle_post
+00009e20: 5f6d 756c 7469 7061 7274 2829 0a0a 2020  _multipart()..  
+00009e30: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+00009e40: 2020 2020 2020 2022 6170 706c 6963 6174         "applicat
+00009e50: 696f 6e2f 6a73 6f6e 2220 696e 2063 7479  ion/json" in cty
+00009e60: 7065 0a20 2020 2020 2020 2020 2020 206f  pe.            o
+00009e70: 7220 2274 6578 742f 706c 6169 6e22 2069  r "text/plain" i
+00009e80: 6e20 6374 7970 650a 2020 2020 2020 2020  n ctype.        
+00009e90: 2020 2020 6f72 2022 6170 706c 6963 6174      or "applicat
+00009ea0: 696f 6e2f 786d 6c22 2069 6e20 6374 7970  ion/xml" in ctyp
+00009eb0: 650a 2020 2020 2020 2020 293a 0a20 2020  e.        ):.   
+00009ec0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00009ed0: 7365 6c66 2e68 616e 646c 655f 706f 7374  self.handle_post
+00009ee0: 5f6a 736f 6e28 290a 0a20 2020 2020 2020  _json()..       
+00009ef0: 2069 6620 226d 6f76 6522 2069 6e20 7365   if "move" in se
+00009f00: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
+00009f10: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00009f20: 6c66 2e68 616e 646c 655f 6d76 2829 0a0a  lf.handle_mv()..
+00009f30: 2020 2020 2020 2020 6966 2022 6465 6c65          if "dele
+00009f40: 7465 2220 696e 2073 656c 662e 7570 6172  te" in self.upar
+00009f50: 616d 3a0a 2020 2020 2020 2020 2020 2020  am:.            
+00009f60: 7265 7475 726e 2073 656c 662e 6861 6e64  return self.hand
+00009f70: 6c65 5f72 6d28 5b5d 290a 0a20 2020 2020  le_rm([])..     
+00009f80: 2020 2069 6620 2261 7070 6c69 6361 7469     if "applicati
+00009f90: 6f6e 2f6f 6374 6574 2d73 7472 6561 6d22  on/octet-stream"
+00009fa0: 2069 6e20 6374 7970 653a 0a20 2020 2020   in ctype:.     
+00009fb0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00009fc0: 6c66 2e68 616e 646c 655f 706f 7374 5f62  lf.handle_post_b
+00009fd0: 696e 6172 7928 290a 0a20 2020 2020 2020  inary()..       
+00009fe0: 2069 6620 2261 7070 6c69 6361 7469 6f6e   if "application
+00009ff0: 2f78 2d77 7777 2d66 6f72 6d2d 7572 6c65  /x-www-form-urle
+0000a000: 6e63 6f64 6564 2220 696e 2063 7479 7065  ncoded" in ctype
+0000a010: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
+0000a020: 7420 3d20 7365 6c66 2e61 7267 732e 7572  t = self.args.ur
+0000a030: 6c66 6f72 6d0a 2020 2020 2020 2020 2020  lform.          
+0000a040: 2020 6966 2022 7374 6173 6822 2069 6e20    if "stash" in 
+0000a050: 6f70 743a 0a20 2020 2020 2020 2020 2020  opt:.           
+0000a060: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000a070: 2e68 616e 646c 655f 7374 6173 6828 4661  .handle_stash(Fa
+0000a080: 6c73 6529 0a0a 2020 2020 2020 2020 2020  lse)..          
+0000a090: 2020 6966 2022 7361 7665 2220 696e 206f    if "save" in o
+0000a0a0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+0000a0b0: 2020 2020 706f 7374 5f73 7a2c 205f 2c20      post_sz, _, 
+0000a0c0: 5f2c 205f 2c20 7061 7468 2c20 5f20 3d20  _, _, path, _ = 
+0000a0d0: 7365 6c66 2e64 756d 705f 746f 5f66 696c  self.dump_to_fil
+0000a0e0: 6528 4661 6c73 6529 0a20 2020 2020 2020  e(False).       
+0000a0f0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0000a100: 6728 2275 726c 666f 726d 3a20 7b7d 2062  g("urlform: {} b
+0000a110: 7974 6573 2c20 7b7d 222e 666f 726d 6174  ytes, {}".format
+0000a120: 2870 6f73 745f 737a 2c20 7061 7468 2929  (post_sz, path))
+0000a130: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000a140: 6620 2270 7269 6e74 2220 696e 206f 7074  f "print" in opt
+0000a150: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a160: 2020 7265 6164 6572 2c20 5f20 3d20 7365    reader, _ = se
+0000a170: 6c66 2e67 6574 5f62 6f64 795f 7265 6164  lf.get_body_read
+0000a180: 6572 2829 0a20 2020 2020 2020 2020 2020  er().           
+0000a190: 2020 2020 2062 7566 203d 2062 2222 0a20       buf = b"". 
+0000a1a0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000a1b0: 6f72 2072 6275 6620 696e 2072 6561 6465  or rbuf in reade
+0000a1c0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0000a1d0: 2020 2020 2020 2062 7566 202b 3d20 7262         buf += rb
+0000a1e0: 7566 0a20 2020 2020 2020 2020 2020 2020  uf.             
+0000a1f0: 2020 2020 2020 2069 6620 6e6f 7420 7262         if not rb
+0000a200: 7566 206f 7220 6c65 6e28 6275 6629 203e  uf or len(buf) >
+0000a210: 3d20 3332 3736 383a 0a20 2020 2020 2020  = 32768:.       
+0000a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a230: 2062 7265 616b 0a0a 2020 2020 2020 2020   break..        
+0000a240: 2020 2020 2020 2020 6966 2062 7566 3a0a          if buf:.
+0000a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a260: 2020 2020 6f72 6967 203d 2062 7566 2e64      orig = buf.d
+0000a270: 6563 6f64 6528 2275 7466 2d38 222c 2022  ecode("utf-8", "
+0000a280: 7265 706c 6163 6522 290a 2020 2020 2020  replace").      
+0000a290: 2020 2020 2020 2020 2020 2020 2020 7420                t 
+0000a2a0: 3d20 2275 726c 666f 726d 5f72 6177 207b  = "urlform_raw {
+0000a2b0: 7d20 4020 7b7d 5c6e 2020 7b7d 5c6e 220a  } @ {}\n  {}\n".
+0000a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a2d0: 2020 2020 7365 6c66 2e6c 6f67 2874 2e66      self.log(t.f
+0000a2e0: 6f72 6d61 7428 6c65 6e28 6f72 6967 292c  ormat(len(orig),
+0000a2f0: 2073 656c 662e 7670 6174 682c 206f 7269   self.vpath, ori
+0000a300: 6729 290a 2020 2020 2020 2020 2020 2020  g)).            
+0000a310: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a330: 2020 2020 207a 6220 3d20 756e 7175 6f74       zb = unquot
+0000a340: 6528 6275 662e 7265 706c 6163 6528 6222  e(buf.replace(b"
+0000a350: 2b22 2c20 6222 2022 2929 0a20 2020 2020  +", b" ")).     
+0000a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a370: 2020 2070 6c61 696e 203d 207a 622e 6465     plain = zb.de
+0000a380: 636f 6465 2822 7574 662d 3822 2c20 2272  code("utf-8", "r
+0000a390: 6570 6c61 6365 2229 0a20 2020 2020 2020  eplace").       
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3b0: 2069 6620 6275 662e 7374 6172 7473 7769   if buf.startswi
+0000a3c0: 7468 2862 226d 7367 3d22 293a 0a20 2020  th(b"msg="):.   
+0000a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3e0: 2020 2020 2020 2020 2070 6c61 696e 203d           plain =
+0000a3f0: 2070 6c61 696e 5b34 3a5d 0a20 2020 2020   plain[4:].     
+0000a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a410: 2020 2020 2020 2076 6673 2c20 7265 6d20         vfs, rem 
+0000a420: 3d20 7365 6c66 2e61 7372 762e 7666 732e  = self.asrv.vfs.
+0000a430: 6765 7428 0a20 2020 2020 2020 2020 2020  get(.           
+0000a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a450: 2020 2020 2073 656c 662e 7670 6174 682c       self.vpath,
+0000a460: 2073 656c 662e 756e 616d 652c 2046 616c   self.uname, Fal
+0000a470: 7365 2c20 4661 6c73 650a 2020 2020 2020  se, False.      
+0000a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a490: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a4b0: 2020 2020 786d 203d 2076 6673 2e66 6c61      xm = vfs.fla
+0000a4c0: 6773 2e67 6574 2822 786d 2229 0a20 2020  gs.get("xm").   
+0000a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a4e0: 2020 2020 2020 2020 2069 6620 786d 3a0a           if xm:.
+0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a510: 7275 6e68 6f6f 6b28 0a20 2020 2020 2020  runhook(.       
+0000a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a530: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a540: 662e 6c6f 672c 0a20 2020 2020 2020 2020  f.log,.         
+0000a550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a560: 2020 2020 2020 2020 2020 2078 6d2c 0a20             xm,. 
+0000a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a590: 2020 2076 6673 2e63 616e 6f6e 6963 616c     vfs.canonical
+0000a5a0: 2872 656d 292c 0a20 2020 2020 2020 2020  (rem),.         
+0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a5d0: 7670 6174 682c 0a20 2020 2020 2020 2020  vpath,.         
+0000a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a600: 686f 7374 2c0a 2020 2020 2020 2020 2020  host,.          
+0000a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a620: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+0000a630: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0000a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a650: 2020 2020 2020 2020 2020 7469 6d65 2e74            time.t
+0000a660: 696d 6528 292c 0a20 2020 2020 2020 2020  ime(),.         
+0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a680: 2020 2020 2020 2020 2020 206c 656e 2878             len(x
+0000a690: 6d29 2c0a 2020 2020 2020 2020 2020 2020  m),.            
+0000a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6b0: 2020 2020 2020 2020 7365 6c66 2e69 702c          self.ip,
+0000a6c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6e0: 2020 2020 2074 696d 652e 7469 6d65 2829       time.time()
+0000a6f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a710: 2020 2020 2020 706c 6169 6e2c 0a20 2020        plain,.   
+0000a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a730: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0000a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a750: 2020 2020 2020 2020 7420 3d20 2275 726c          t = "url
+0000a760: 666f 726d 5f64 6563 207b 7d20 4020 7b7d  form_dec {} @ {}
+0000a770: 5c6e 2020 7b7d 5c6e 220a 2020 2020 2020  \n  {}\n".      
+0000a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a790: 2020 7365 6c66 2e6c 6f67 2874 2e66 6f72    self.log(t.for
+0000a7a0: 6d61 7428 6c65 6e28 706c 6169 6e29 2c20  mat(len(plain), 
+0000a7b0: 7365 6c66 2e76 7061 7468 2c20 706c 6169  self.vpath, plai
+0000a7c0: 6e29 290a 0a20 2020 2020 2020 2020 2020  n))..           
+0000a7d0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0000a7e0: 4578 6365 7074 696f 6e20 6173 2065 783a  Exception as ex:
+0000a7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a800: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0000a810: 6728 7265 7072 2865 7829 290a 0a20 2020  g(repr(ex))..   
+0000a820: 2020 2020 2020 2020 2069 6620 2267 6574           if "get
+0000a830: 2220 696e 206f 7074 3a0a 2020 2020 2020  " in opt:.      
+0000a840: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000a850: 2073 656c 662e 6861 6e64 6c65 5f67 6574   self.handle_get
+0000a860: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+0000a870: 7261 6973 6520 5065 626b 6163 2834 3035  raise Pebkac(405
+0000a880: 2c20 2250 4f53 5428 7b7d 2920 6973 2064  , "POST({}) is d
+0000a890: 6973 6162 6c65 6420 696e 2073 6572 7665  isabled in serve
+0000a8a0: 7220 636f 6e66 6967 222e 666f 726d 6174  r config".format
+0000a8b0: 2863 7479 7065 2929 0a0a 2020 2020 2020  (ctype))..      
+0000a8c0: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+0000a8d0: 3035 2c20 2264 6f6e 2774 206b 6e6f 7720  05, "don't know 
+0000a8e0: 686f 7720 746f 2068 616e 646c 6520 504f  how to handle PO
+0000a8f0: 5354 287b 7d29 222e 666f 726d 6174 2863  ST({})".format(c
+0000a900: 7479 7065 2929 0a0a 2020 2020 6465 6620  type))..    def 
+0000a910: 6765 745f 786d 6c5f 656e 6328 7365 6c66  get_xml_enc(self
+0000a920: 2c20 7478 7420 2920 203a 0a20 2020 2020  , txt )  :.     
+0000a930: 2020 206f 6673 203d 2074 7874 5b3a 3531     ofs = txt[:51
+0000a940: 325d 2e66 696e 6428 2720 656e 636f 6469  2].find(' encodi
+0000a950: 6e67 3d22 2729 0a20 2020 2020 2020 2065  ng="').        e
+0000a960: 6e63 203d 2022 220a 2020 2020 2020 2020  nc = "".        
+0000a970: 6966 206f 6673 202b 2031 3a0a 2020 2020  if ofs + 1:.    
+0000a980: 2020 2020 2020 2020 656e 6320 3d20 7478          enc = tx
+0000a990: 745b 6f66 7320 2b20 3620 3a5d 2e73 706c  t[ofs + 6 :].spl
+0000a9a0: 6974 2827 2227 295b 315d 0a20 2020 2020  it('"')[1].     
+0000a9b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a9c0: 2020 2020 2065 6e63 203d 2073 656c 662e       enc = self.
+0000a9d0: 6865 6164 6572 732e 6765 7428 2263 6f6e  headers.get("con
+0000a9e0: 7465 6e74 2d74 7970 6522 2c20 2222 292e  tent-type", "").
+0000a9f0: 6c6f 7765 7228 290a 2020 2020 2020 2020  lower().        
+0000aa00: 2020 2020 6f66 7320 3d20 656e 632e 6669      ofs = enc.fi
+0000aa10: 6e64 2822 6368 6172 7365 743d 2229 0a20  nd("charset="). 
+0000aa20: 2020 2020 2020 2020 2020 2069 6620 6f66             if of
+0000aa30: 7320 2b20 313a 0a20 2020 2020 2020 2020  s + 1:.         
+0000aa40: 2020 2020 2020 2065 6e63 203d 2065 6e63         enc = enc
+0000aa50: 5b6f 6673 202b 2034 5d2e 7370 6c69 7428  [ofs + 4].split(
+0000aa60: 223d 2229 5b31 5d2e 7370 6c69 7428 223b  "=")[1].split(";
+0000aa70: 2229 5b30 5d2e 7374 7269 7028 225c 2227  ")[0].strip("\"'
+0000aa80: 2229 0a20 2020 2020 2020 2020 2020 2065  ").            e
+0000aa90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0000aaa0: 2020 2020 2065 6e63 203d 2022 220a 0a20       enc = "".. 
+0000aab0: 2020 2020 2020 2072 6574 7572 6e20 656e         return en
+0000aac0: 6320 6f72 2022 7574 662d 3822 0a0a 2020  c or "utf-8"..  
+0000aad0: 2020 6465 6620 6765 745f 626f 6479 5f72    def get_body_r
+0000aae0: 6561 6465 7228 7365 6c66 2920 2020 2020  eader(self)     
+0000aaf0: 3a0a 2020 2020 2020 2020 6966 2022 6368  :.        if "ch
+0000ab00: 756e 6b65 6422 2069 6e20 7365 6c66 2e68  unked" in self.h
+0000ab10: 6561 6465 7273 2e67 6574 2822 7472 616e  eaders.get("tran
+0000ab20: 7366 6572 2d65 6e63 6f64 696e 6722 2c20  sfer-encoding", 
+0000ab30: 2222 292e 6c6f 7765 7228 293a 0a20 2020  "").lower():.   
+0000ab40: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000ab50: 7265 6164 5f73 6f63 6b65 745f 6368 756e  read_socket_chun
+0000ab60: 6b65 6428 7365 6c66 2e73 7229 2c20 2d31  ked(self.sr), -1
+0000ab70: 0a0a 2020 2020 2020 2020 7265 6d61 696e  ..        remain
+0000ab80: 7320 3d20 696e 7428 7365 6c66 2e68 6561  s = int(self.hea
+0000ab90: 6465 7273 2e67 6574 2822 636f 6e74 656e  ders.get("conten
+0000aba0: 742d 6c65 6e67 7468 222c 202d 3129 290a  t-length", -1)).
+0000abb0: 2020 2020 2020 2020 6966 2072 656d 6169          if remai
+0000abc0: 6e73 203d 3d20 2d31 3a0a 2020 2020 2020  ns == -1:.      
+0000abd0: 2020 2020 2020 7365 6c66 2e6b 6565 7061        self.keepa
+0000abe0: 6c69 7665 203d 2046 616c 7365 0a20 2020  live = False.   
+0000abf0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000ac00: 7265 6164 5f73 6f63 6b65 745f 756e 626f  read_socket_unbo
+0000ac10: 756e 6465 6428 7365 6c66 2e73 7229 2c20  unded(self.sr), 
+0000ac20: 7265 6d61 696e 730a 2020 2020 2020 2020  remains.        
+0000ac30: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000ac40: 2020 7265 7475 726e 2072 6561 645f 736f    return read_so
+0000ac50: 636b 6574 2873 656c 662e 7372 2c20 7265  cket(self.sr, re
+0000ac60: 6d61 696e 7329 2c20 7265 6d61 696e 730a  mains), remains.
+0000ac70: 0a20 2020 2064 6566 2064 756d 705f 746f  .    def dump_to
+0000ac80: 5f66 696c 6528 7365 6c66 2c20 6973 5f70  _file(self, is_p
+0000ac90: 7574 2029 2020 2020 2020 203a 0a20 2020  ut )       :.   
+0000aca0: 2020 2020 2023 2070 6f73 745f 737a 2c20       # post_sz, 
+0000acb0: 7368 615f 6865 782c 2073 6861 5f62 3634  sha_hex, sha_b64
+0000acc0: 2c20 7265 6d61 696e 732c 2070 6174 682c  , remains, path,
+0000acd0: 2075 726c 0a20 2020 2020 2020 2072 6561   url.        rea
+0000ace0: 6465 722c 2072 656d 6169 6e73 203d 2073  der, remains = s
+0000acf0: 656c 662e 6765 745f 626f 6479 5f72 6561  elf.get_body_rea
+0000ad00: 6465 7228 290a 2020 2020 2020 2020 7666  der().        vf
+0000ad10: 732c 2072 656d 203d 2073 656c 662e 6173  s, rem = self.as
+0000ad20: 7276 2e76 6673 2e67 6574 2873 656c 662e  rv.vfs.get(self.
+0000ad30: 7670 6174 682c 2073 656c 662e 756e 616d  vpath, self.unam
+0000ad40: 652c 2046 616c 7365 2c20 5472 7565 290a  e, False, True).
+0000ad50: 2020 2020 2020 2020 726e 642c 205f 2c20          rnd, _, 
+0000ad60: 6c69 6665 7469 6d65 2c20 7862 752c 2078  lifetime, xbu, x
+0000ad70: 6175 203d 2073 656c 662e 7570 6c6f 6164  au = self.upload
+0000ad80: 5f66 6c61 6773 2876 6673 290a 2020 2020  _flags(vfs).    
+0000ad90: 2020 2020 6c69 6d20 3d20 7666 732e 6765      lim = vfs.ge
+0000ada0: 745f 6462 7628 7265 6d29 5b30 5d2e 6c69  t_dbv(rem)[0].li
+0000adb0: 6d0a 2020 2020 2020 2020 6664 6972 203d  m.        fdir =
+0000adc0: 2076 6673 2e63 616e 6f6e 6963 616c 2872   vfs.canonical(r
+0000add0: 656d 290a 2020 2020 2020 2020 6966 206c  em).        if l
+0000ade0: 696d 3a0a 2020 2020 2020 2020 2020 2020  im:.            
+0000adf0: 6664 6972 2c20 7265 6d20 3d20 6c69 6d2e  fdir, rem = lim.
+0000ae00: 616c 6c28 7365 6c66 2e69 702c 2072 656d  all(self.ip, rem
+0000ae10: 2c20 7265 6d61 696e 732c 2066 6469 7229  , remains, fdir)
+0000ae20: 0a0a 2020 2020 2020 2020 666e 203d 204e  ..        fn = N
+0000ae30: 6f6e 650a 2020 2020 2020 2020 6966 2072  one.        if r
+0000ae40: 656d 2061 6e64 206e 6f74 2073 656c 662e  em and not self.
+0000ae50: 7472 6169 6c69 6e67 5f73 6c61 7368 2061  trailing_slash a
+0000ae60: 6e64 206e 6f74 2062 6f73 2e70 6174 682e  nd not bos.path.
+0000ae70: 6973 6469 7228 6664 6972 293a 0a20 2020  isdir(fdir):.   
+0000ae80: 2020 2020 2020 2020 2066 6469 722c 2066           fdir, f
+0000ae90: 6e20 3d20 6f73 2e70 6174 682e 7370 6c69  n = os.path.spli
+0000aea0: 7428 6664 6972 290a 2020 2020 2020 2020  t(fdir).        
+0000aeb0: 2020 2020 7265 6d2c 205f 203d 2076 7370      rem, _ = vsp
+0000aec0: 6c69 7428 7265 6d29 0a0a 2020 2020 2020  lit(rem)..      
+0000aed0: 2020 626f 732e 6d61 6b65 6469 7273 2866    bos.makedirs(f
+0000aee0: 6469 7229 0a0a 2020 2020 2020 2020 6f70  dir)..        op
+0000aef0: 656e 5f6b 6120 2020 3d20 7b22 6675 6e22  en_ka   = {"fun"
+0000af00: 3a20 6f70 656e 7d0a 2020 2020 2020 2020  : open}.        
+0000af10: 6f70 656e 5f61 203d 205b 2277 6222 2c20  open_a = ["wb", 
+0000af20: 3531 3220 2a20 3130 3234 5d0a 0a20 2020  512 * 1024]..   
+0000af30: 2020 2020 2023 2075 7365 722d 7265 7175       # user-requ
+0000af40: 6573 7420 7c7c 2063 6f6e 6669 672d 666f  est || config-fo
+0000af50: 7263 650a 2020 2020 2020 2020 6966 2028  rce.        if (
+0000af60: 2267 7a22 2069 6e20 7666 732e 666c 6167  "gz" in vfs.flag
+0000af70: 7320 6f72 2022 787a 2220 696e 2076 6673  s or "xz" in vfs
+0000af80: 2e66 6c61 6773 2920 616e 6420 280a 2020  .flags) and (.  
+0000af90: 2020 2020 2020 2020 2020 2270 6b22 2069            "pk" i
+0000afa0: 6e20 7666 732e 666c 6167 730a 2020 2020  n vfs.flags.    
+0000afb0: 2020 2020 2020 2020 6f72 2022 706b 2220          or "pk" 
+0000afc0: 696e 2073 656c 662e 7570 6172 616d 0a20  in self.uparam. 
+0000afd0: 2020 2020 2020 2020 2020 206f 7220 2267             or "g
+0000afe0: 7a22 2069 6e20 7365 6c66 2e75 7061 7261  z" in self.upara
+0000aff0: 6d0a 2020 2020 2020 2020 2020 2020 6f72  m.            or
+0000b000: 2022 787a 2220 696e 2073 656c 662e 7570   "xz" in self.up
+0000b010: 6172 616d 0a20 2020 2020 2020 2029 3a0a  aram.        ):.
+0000b020: 2020 2020 2020 2020 2020 2020 6662 203d              fb =
+0000b030: 207b 2267 7a22 3a20 392c 2022 787a 223a   {"gz": 9, "xz":
+0000b040: 2030 7d20 2023 2064 6566 6175 6c74 2f66   0}  # default/f
+0000b050: 616c 6c62 6163 6b20 6c65 7665 6c0a 2020  allback level.  
+0000b060: 2020 2020 2020 2020 2020 6c76 203d 207b            lv = {
+0000b070: 7d20 2023 2073 656c 6563 7465 6420 6c65  }  # selected le
+0000b080: 7665 6c0a 2020 2020 2020 2020 2020 2020  vel.            
+0000b090: 616c 6720 3d20 2222 2020 2320 7365 6c65  alg = ""  # sele
+0000b0a0: 6374 6564 2061 6c67 6f20 2867 7a3d 7072  cted algo (gz=pr
+0000b0b0: 6566 6572 7265 6429 0a0a 2020 2020 2020  eferred)..      
+0000b0c0: 2020 2020 2020 2320 7573 6572 2d70 7265        # user-pre
+0000b0d0: 6673 2066 6972 7374 0a20 2020 2020 2020  fs first.       
+0000b0e0: 2020 2020 2069 6620 2267 7a22 2069 6e20       if "gz" in 
+0000b0f0: 7365 6c66 2e75 7061 7261 6d20 6f72 2022  self.uparam or "
+0000b100: 706b 2220 696e 2073 656c 662e 7570 6172  pk" in self.upar
+0000b110: 616d 3a20 2023 2064 6566 2e70 6b0a 2020  am:  # def.pk.  
+0000b120: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0000b130: 6720 3d20 2267 7a22 0a20 2020 2020 2020  g = "gz".       
+0000b140: 2020 2020 2069 6620 2278 7a22 2069 6e20       if "xz" in 
+0000b150: 7365 6c66 2e75 7061 7261 6d3a 0a20 2020  self.uparam:.   
+0000b160: 2020 2020 2020 2020 2020 2020 2061 6c67               alg
+0000b170: 203d 2022 787a 220a 2020 2020 2020 2020   = "xz".        
+0000b180: 2020 2020 6966 2061 6c67 3a0a 2020 2020      if alg:.    
+0000b190: 2020 2020 2020 2020 2020 2020 7a73 6f20              zso 
+0000b1a0: 3d20 7365 6c66 2e75 7061 7261 6d2e 6765  = self.uparam.ge
+0000b1b0: 7428 616c 6729 0a20 2020 2020 2020 2020  t(alg).         
+0000b1c0: 2020 2020 2020 206c 765b 616c 675d 203d         lv[alg] =
+0000b1d0: 2066 625b 616c 675d 2069 6620 7a73 6f20   fb[alg] if zso 
+0000b1e0: 6973 204e 6f6e 6520 656c 7365 2069 6e74  is None else int
+0000b1f0: 287a 736f 290a 0a20 2020 2020 2020 2020  (zso)..         
+0000b200: 2020 2069 6620 616c 6720 6e6f 7420 696e     if alg not in
+0000b210: 2076 6673 2e66 6c61 6773 3a0a 2020 2020   vfs.flags:.    
+0000b220: 2020 2020 2020 2020 2020 2020 616c 6720              alg 
+0000b230: 3d20 2267 7a22 2069 6620 2267 7a22 2069  = "gz" if "gz" i
+0000b240: 6e20 7666 732e 666c 6167 7320 656c 7365  n vfs.flags else
+0000b250: 2022 787a 220a 0a20 2020 2020 2020 2020   "xz"..         
+0000b260: 2020 2023 2074 6865 6e20 7365 7276 6572     # then server
+0000b270: 206f 7665 7272 6964 6573 0a20 2020 2020   overrides.     
+0000b280: 2020 2020 2020 2070 6b20 3d20 7666 732e         pk = vfs.
+0000b290: 666c 6167 732e 6765 7428 2270 6b22 290a  flags.get("pk").
+0000b2a0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+0000b2b0: 6b20 6973 206e 6f74 204e 6f6e 653a 0a20  k is not None:. 
+0000b2c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000b2d0: 2063 6f6e 6669 672d 666f 7263 6564 206f   config-forced o
+0000b2e0: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+0000b2f0: 2020 616c 6720 3d20 616c 6720 6f72 2022    alg = alg or "
+0000b300: 677a 2220 2023 2064 6566 2e70 6b0a 2020  gz"  # def.pk.  
+0000b310: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+0000b320: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0000b330: 2020 2020 2020 2023 2063 6f6e 6669 672d         # config-
+0000b340: 666f 7263 6564 206f 7074 730a 2020 2020  forced opts.    
+0000b350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b360: 616c 672c 206e 6c76 203d 2070 6b2e 7370  alg, nlv = pk.sp
+0000b370: 6c69 7428 222c 2229 0a20 2020 2020 2020  lit(",").       
+0000b380: 2020 2020 2020 2020 2020 2020 206c 765b               lv[
+0000b390: 616c 675d 203d 2069 6e74 286e 6c76 290a  alg] = int(nlv).
+0000b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b3b0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+0000b3c0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+0000b3d0: 0a0a 2020 2020 2020 2020 2020 2020 6c76  ..            lv
+0000b3e0: 5b61 6c67 5d20 3d20 6c76 2e67 6574 2861  [alg] = lv.get(a
+0000b3f0: 6c67 2920 6f72 2066 622e 6765 7428 616c  lg) or fb.get(al
+0000b400: 6729 206f 7220 300a 0a20 2020 2020 2020  g) or 0..       
+0000b410: 2020 2020 2073 656c 662e 6c6f 6728 2263       self.log("c
+0000b420: 6f6d 7072 6573 7369 6e67 2077 6974 6820  ompressing with 
+0000b430: 7b7d 206c 6576 656c 207b 7d22 2e66 6f72  {} level {}".for
+0000b440: 6d61 7428 616c 672c 206c 762e 6765 7428  mat(alg, lv.get(
+0000b450: 616c 6729 2929 0a20 2020 2020 2020 2020  alg))).         
+0000b460: 2020 2069 6620 616c 6720 3d3d 2022 677a     if alg == "gz
+0000b470: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+0000b480: 2020 206f 7065 6e5f 6b61 5b22 6675 6e22     open_ka["fun"
+0000b490: 5d20 3d20 677a 6970 2e47 7a69 7046 696c  ] = gzip.GzipFil
+0000b4a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000b4b0: 2020 6f70 656e 5f61 203d 205b 2277 6222    open_a = ["wb"
+0000b4c0: 2c20 6c76 5b61 6c67 5d2c 204e 6f6e 652c  , lv[alg], None,
+0000b4d0: 2030 7835 4645 4536 3630 305d 2020 2320   0x5FEE6600]  # 
+0000b4e0: 3230 3231 2d30 312d 3031 0a20 2020 2020  2021-01-01.     
+0000b4f0: 2020 2020 2020 2065 6c69 6620 616c 6720         elif alg 
+0000b500: 3d3d 2022 787a 223a 0a20 2020 2020 2020  == "xz":.       
+0000b510: 2020 2020 2020 2020 206f 7065 6e5f 6b61           open_ka
+0000b520: 203d 207b 2266 756e 223a 206c 7a6d 612e   = {"fun": lzma.
+0000b530: 6f70 656e 2c20 2270 7265 7365 7422 3a20  open, "preset": 
+0000b540: 6c76 5b61 6c67 5d7d 0a20 2020 2020 2020  lv[alg]}.       
+0000b550: 2020 2020 2020 2020 206f 7065 6e5f 6120           open_a 
+0000b560: 3d20 5b22 7762 225d 0a20 2020 2020 2020  = ["wb"].       
+0000b570: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000b580: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000b590: 6c6f 6728 2266 616c 6c74 6872 6f75 6768  log("fallthrough
+0000b5a0: 3f20 7468 6174 7320 6120 6275 6722 2c20  ? thats a bug", 
+0000b5b0: 3129 0a0a 2020 2020 2020 2020 7375 6666  1)..        suff
+0000b5c0: 6978 203d 2022 2d7b 3a2e 3666 7d2d 7b7d  ix = "-{:.6f}-{}
+0000b5d0: 222e 666f 726d 6174 2874 696d 652e 7469  ".format(time.ti
+0000b5e0: 6d65 2829 2c20 7365 6c66 2e64 6970 2829  me(), self.dip()
+0000b5f0: 290a 2020 2020 2020 2020 6e61 6d65 6c65  ).        namele
+0000b600: 7373 203d 206e 6f74 2066 6e0a 2020 2020  ss = not fn.    
+0000b610: 2020 2020 6966 206e 616d 656c 6573 733a      if nameless:
+0000b620: 0a20 2020 2020 2020 2020 2020 2073 7566  .            suf
+0000b630: 6669 7820 2b3d 2022 2e62 696e 220a 2020  fix += ".bin".  
+0000b640: 2020 2020 2020 2020 2020 666e 203d 2022            fn = "
+0000b650: 7075 7422 202b 2073 7566 6669 780a 0a20  put" + suffix.. 
+0000b660: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0000b670: 7b22 7375 6666 6978 223a 2073 7566 6669  {"suffix": suffi
+0000b680: 782c 2022 6664 6972 223a 2066 6469 727d  x, "fdir": fdir}
+0000b690: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000b6a0: 2e61 7267 732e 6e77 3a0a 2020 2020 2020  .args.nw:.      
+0000b6b0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+0000b6c0: 7d0a 2020 2020 2020 2020 2020 2020 666e  }.            fn
+0000b6d0: 203d 206f 732e 6465 766e 756c 6c0a 0a20   = os.devnull.. 
+0000b6e0: 2020 2020 2020 2070 6172 616d 732e 7570         params.up
+0000b6f0: 6461 7465 286f 7065 6e5f 6b61 290a 2020  date(open_ka).  
+0000b700: 2020 2020 2020 6173 7365 7274 2066 6e0a        assert fn.
+0000b710: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0000b720: 7365 6c66 2e61 7267 732e 6e77 3a0a 2020  self.args.nw:.  
+0000b730: 2020 2020 2020 2020 2020 6966 2072 6e64            if rnd
+0000b740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000b750: 2020 666e 203d 2072 616e 645f 6e61 6d65    fn = rand_name
+0000b760: 2866 6469 722c 2066 6e2c 2072 6e64 290a  (fdir, fn, rnd).
+0000b770: 0a20 2020 2020 2020 2020 2020 2066 6e20  .            fn 
+0000b780: 3d20 7361 6e69 7469 7a65 5f66 6e28 666e  = sanitize_fn(fn
+0000b790: 206f 7220 2222 2c20 2222 2c20 5b22 2e70   or "", "", [".p
+0000b7a0: 726f 6c6f 6775 652e 6874 6d6c 222c 2022  rologue.html", "
+0000b7b0: 2e65 7069 6c6f 6775 652e 6874 6d6c 225d  .epilogue.html"]
+0000b7c0: 290a 0a20 2020 2020 2020 2070 6174 6820  )..        path 
+0000b7d0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2866  = os.path.join(f
+0000b7e0: 6469 722c 2066 6e29 0a0a 2020 2020 2020  dir, fn)..      
+0000b7f0: 2020 6966 2078 6275 3a0a 2020 2020 2020    if xbu:.      
+0000b800: 2020 2020 2020 6174 203d 2074 696d 652e        at = time.
+0000b810: 7469 6d65 2829 202d 206c 6966 6574 696d  time() - lifetim
+0000b820: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+0000b830: 206e 6f74 2072 756e 686f 6f6b 280a 2020   not runhook(.  
+0000b840: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000b850: 6c66 2e6c 6f67 2c0a 2020 2020 2020 2020  lf.log,.        
+0000b860: 2020 2020 2020 2020 7862 752c 0a20 2020          xbu,.   
+0000b870: 2020 2020 2020 2020 2020 2020 2070 6174               pat
+0000b880: 682c 0a20 2020 2020 2020 2020 2020 2020  h,.             
+0000b890: 2020 2073 656c 662e 7670 6174 682c 0a20     self.vpath,. 
+0000b8a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000b8b0: 656c 662e 686f 7374 2c0a 2020 2020 2020  elf.host,.      
+0000b8c0: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+0000b8d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0000b8e0: 2020 2020 2020 6174 2c0a 2020 2020 2020        at,.      
+0000b8f0: 2020 2020 2020 2020 2020 7265 6d61 696e            remain
+0000b900: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000b910: 2020 2073 656c 662e 6970 2c0a 2020 2020     self.ip,.    
+0000b920: 2020 2020 2020 2020 2020 2020 6174 2c0a              at,.
+0000b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b940: 2222 2c0a 2020 2020 2020 2020 2020 2020  "",.            
+0000b950: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000b960: 2020 2074 203d 2022 7570 6c6f 6164 2062     t = "upload b
+0000b970: 6c6f 636b 6564 2062 7920 7862 7520 7365  locked by xbu se
+0000b980: 7276 6572 2063 6f6e 6669 6722 0a20 2020  rver config".   
+0000b990: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000b9a0: 662e 6c6f 6728 742c 2031 290a 2020 2020  f.log(t, 1).    
+0000b9b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000b9c0: 6520 5065 626b 6163 2834 3033 2c20 7429  e Pebkac(403, t)
+0000b9d0: 0a0a 2020 2020 2020 2020 6966 2069 735f  ..        if is_
+0000b9e0: 7075 7420 616e 6420 6e6f 7420 2873 656c  put and not (sel
+0000b9f0: 662e 6172 6773 2e6e 6f5f 6461 7620 6f72  f.args.no_dav or
+0000ba00: 2073 656c 662e 6172 6773 2e6e 7729 2061   self.args.nw) a
+0000ba10: 6e64 2062 6f73 2e70 6174 682e 6578 6973  nd bos.path.exis
+0000ba20: 7473 2870 6174 6829 3a0a 2020 2020 2020  ts(path):.      
+0000ba30: 2020 2020 2020 2320 616c 6c6f 7720 6f76        # allow ov
+0000ba40: 6572 7772 6974 6520 6966 2e2e 2e0a 2020  erwrite if....  
+0000ba50: 2020 2020 2020 2020 2020 2320 202a 2076            #  * v
+0000ba60: 6f6c 666c 6167 2027 6461 7727 2069 7320  olflag 'daw' is 
+0000ba70: 7365 742c 206f 7220 636c 6965 6e74 2069  set, or client i
+0000ba80: 7320 6465 6669 6e69 7465 6c79 2077 6562  s definitely web
+0000ba90: 6461 760a 2020 2020 2020 2020 2020 2020  dav.            
+0000baa0: 2320 202a 2061 6e64 2061 6363 6f75 6e74  #  * and account
+0000bab0: 2068 6173 2064 656c 6574 652d 6163 6365   has delete-acce
+0000bac0: 7373 0a20 2020 2020 2020 2020 2020 2023  ss.            #
+0000bad0: 206f 722e 2e2e 0a20 2020 2020 2020 2020   or....         
+0000bae0: 2020 2023 2020 2a20 6669 6c65 2065 7869     #  * file exi
+0000baf0: 7374 732c 2069 7320 656d 7074 792c 2073  sts, is empty, s
+0000bb00: 7566 6669 6369 656e 746c 7920 6e65 770a  ufficiently new.
+0000bb10: 2020 2020 2020 2020 2020 2020 2320 202a              #  *
+0000bb20: 2061 6e64 2074 6865 7265 2069 7320 6e6f   and there is no
+0000bb30: 202e 5041 5254 4941 4c0a 0a20 2020 2020   .PARTIAL..     
+0000bb40: 2020 2020 2020 2074 6e61 6d20 3d20 666e         tnam = fn
+0000bb50: 202b 2022 2e50 4152 5449 414c 220a 2020   + ".PARTIAL".  
+0000bb60: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0000bb70: 662e 6172 6773 2e64 6f74 7061 7274 3a0a  f.args.dotpart:.
+0000bb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bb90: 746e 616d 203d 2022 2e22 202b 2074 6e61  tnam = "." + tna
+0000bba0: 6d0a 0a20 2020 2020 2020 2020 2020 2069  m..            i
+0000bbb0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0000bbc0: 2020 2020 7365 6c66 2e63 616e 5f64 656c      self.can_del
+0000bbd0: 6574 650a 2020 2020 2020 2020 2020 2020  ete.            
+0000bbe0: 2020 2020 616e 6420 2876 6673 2e66 6c61      and (vfs.fla
+0000bbf0: 6773 2e67 6574 2822 6461 7722 2920 6f72  gs.get("daw") or
+0000bc00: 2022 782d 6f63 2d6d 7469 6d65 2220 696e   "x-oc-mtime" in
+0000bc10: 2073 656c 662e 6865 6164 6572 7329 0a20   self.headers). 
+0000bc20: 2020 2020 2020 2020 2020 2029 206f 7220             ) or 
+0000bc30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000bc40: 2020 6e6f 7420 626f 732e 7061 7468 2e65    not bos.path.e
+0000bc50: 7869 7374 7328 6f73 2e70 6174 682e 6a6f  xists(os.path.jo
+0000bc60: 696e 2866 6469 722c 2074 6e61 6d29 290a  in(fdir, tnam)).
+0000bc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc80: 616e 6420 6e6f 7420 626f 732e 7061 7468  and not bos.path
+0000bc90: 2e67 6574 7369 7a65 2870 6174 6829 0a20  .getsize(path). 
+0000bca0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000bcb0: 6e64 2062 6f73 2e70 6174 682e 6765 746d  nd bos.path.getm
+0000bcc0: 7469 6d65 2870 6174 6829 203e 3d20 7469  time(path) >= ti
+0000bcd0: 6d65 2e74 696d 6528 2920 2d20 7365 6c66  me.time() - self
+0000bce0: 2e61 7267 732e 626c 616e 6b5f 7774 0a20  .args.blank_wt. 
+0000bcf0: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+0000bd00: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0000bd10: 736d 616c 6c20 746f 6374 6f75 2c20 6275  small toctou, bu
+0000bd20: 7420 6265 7474 6572 2074 6861 6e20 636c  t better than cl
+0000bd30: 6f62 6265 7269 6e67 2061 2068 6172 646c  obbering a hardl
+0000bd40: 696e 6b0a 2020 2020 2020 2020 2020 2020  ink.            
+0000bd50: 2020 2020 626f 732e 756e 6c69 6e6b 2870      bos.unlink(p
+0000bd60: 6174 6829 0a0a 2020 2020 2020 2020 7769  ath)..        wi
+0000bd70: 7468 2072 656e 5f6f 7065 6e28 666e 2c20  th ren_open(fn, 
+0000bd80: 2a6f 7065 6e5f 612c 202a 2a70 6172 616d  *open_a, **param
+0000bd90: 7329 2061 7320 7a66 773a 0a20 2020 2020  s) as zfw:.     
+0000bda0: 2020 2020 2020 2066 2c20 666e 203d 207a         f, fn = z
+0000bdb0: 6677 5b22 6f72 7a22 5d0a 2020 2020 2020  fw["orz"].      
+0000bdc0: 2020 2020 2020 7061 7468 203d 206f 732e        path = os.
+0000bdd0: 7061 7468 2e6a 6f69 6e28 6664 6972 2c20  path.join(fdir, 
+0000bde0: 666e 290a 2020 2020 2020 2020 2020 2020  fn).            
+0000bdf0: 706f 7374 5f73 7a2c 2073 6861 5f68 6578  post_sz, sha_hex
+0000be00: 2c20 7368 615f 6236 3420 3d20 6861 7368  , sha_b64 = hash
+0000be10: 636f 7079 2872 6561 6465 722c 2066 2c20  copy(reader, f, 
+0000be20: 7365 6c66 2e61 7267 732e 735f 7772 5f73  self.args.s_wr_s
+0000be30: 6c70 290a 0a20 2020 2020 2020 2069 6620  lp)..        if 
+0000be40: 6c69 6d3a 0a20 2020 2020 2020 2020 2020  lim:.           
+0000be50: 206c 696d 2e6e 7570 2873 656c 662e 6970   lim.nup(self.ip
+0000be60: 290a 2020 2020 2020 2020 2020 2020 6c69  ).            li
+0000be70: 6d2e 6275 7028 7365 6c66 2e69 702c 2070  m.bup(self.ip, p
+0000be80: 6f73 745f 737a 290a 2020 2020 2020 2020  ost_sz).        
+0000be90: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000bea0: 2020 2020 2020 2020 206c 696d 2e63 686b           lim.chk
+0000beb0: 5f73 7a28 706f 7374 5f73 7a29 0a20 2020  _sz(post_sz).   
+0000bec0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+0000bed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000bee0: 2062 6f73 2e75 6e6c 696e 6b28 7061 7468   bos.unlink(path
+0000bef0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000bf00: 2020 7261 6973 650a 0a20 2020 2020 2020    raise..       
+0000bf10: 2069 6620 7365 6c66 2e61 7267 732e 6e77   if self.args.nw
+0000bf20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000bf30: 7475 726e 2070 6f73 745f 737a 2c20 7368  turn post_sz, sh
+0000bf40: 615f 6865 782c 2073 6861 5f62 3634 2c20  a_hex, sha_b64, 
+0000bf50: 7265 6d61 696e 732c 2070 6174 682c 2022  remains, path, "
+0000bf60: 220a 0a20 2020 2020 2020 2061 7420 3d20  "..        at = 
+0000bf70: 6d74 203d 2074 696d 652e 7469 6d65 2829  mt = time.time()
+0000bf80: 202d 206c 6966 6574 696d 650a 2020 2020   - lifetime.    
+0000bf90: 2020 2020 636c 695f 6d74 203d 2073 656c      cli_mt = sel
+0000bfa0: 662e 6865 6164 6572 732e 6765 7428 2278  f.headers.get("x
+0000bfb0: 2d6f 632d 6d74 696d 6522 290a 2020 2020  -oc-mtime").    
+0000bfc0: 2020 2020 6966 2063 6c69 5f6d 743a 0a20      if cli_mt:. 
+0000bfd0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+0000bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bff0: 6d74 203d 2069 6e74 2863 6c69 5f6d 7429  mt = int(cli_mt)
+0000c000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c010: 2074 696d 6573 203d 2028 696e 7428 7469   times = (int(ti
+0000c020: 6d65 2e74 696d 6528 2929 2c20 6d74 290a  me.time()), mt).
+0000c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c040: 626f 732e 7574 696d 6528 7061 7468 2c20  bos.utime(path, 
+0000c050: 7469 6d65 732c 2046 616c 7365 290a 2020  times, False).  
+0000c060: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0000c070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c080: 2020 7061 7373 0a0a 2020 2020 2020 2020    pass..        
+0000c090: 6966 206e 616d 656c 6573 7320 616e 6420  if nameless and 
+0000c0a0: 226d 6167 6963 2220 696e 2076 6673 2e66  "magic" in vfs.f
+0000c0b0: 6c61 6773 3a0a 2020 2020 2020 2020 2020  lags:.          
+0000c0c0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0000c0d0: 2020 2020 2020 2065 7874 203d 2073 656c         ext = sel
+0000c0e0: 662e 636f 6e6e 2e68 7372 762e 6d61 6769  f.conn.hsrv.magi
+0000c0f0: 6369 616e 2e65 7874 2870 6174 6829 0a20  cian.ext(path). 
+0000c100: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0000c110: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+0000c120: 783a 0a20 2020 2020 2020 2020 2020 2020  x:.             
+0000c130: 2020 2073 656c 662e 6c6f 6728 2266 696c     self.log("fil
+0000c140: 6574 7970 6520 6465 7465 6374 696f 6e20  etype detection 
+0000c150: 6661 696c 6564 2066 6f72 205b 7b7d 5d3a  failed for [{}]:
+0000c160: 207b 7d22 2e66 6f72 6d61 7428 7061 7468   {}".format(path
+0000c170: 2c20 6578 292c 2036 290a 2020 2020 2020  , ex), 6).      
+0000c180: 2020 2020 2020 2020 2020 6578 7420 3d20            ext = 
+0000c190: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
+0000c1a0: 2020 6966 2065 7874 3a0a 2020 2020 2020    if ext:.      
+0000c1b0: 2020 2020 2020 2020 2020 6966 2072 6e64            if rnd
+0000c1c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c1d0: 2020 2020 2020 666e 3220 3d20 7261 6e64        fn2 = rand
+0000c1e0: 5f6e 616d 6528 6664 6972 2c20 2261 2e22  _name(fdir, "a."
+0000c1f0: 202b 2065 7874 2c20 726e 6429 0a20 2020   + ext, rnd).   
+0000c200: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0000c210: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000c220: 2020 2020 2020 2066 6e32 203d 2066 6e2e         fn2 = fn.
+0000c230: 7273 706c 6974 2822 2e22 2c20 3129 5b30  rsplit(".", 1)[0
+0000c240: 5d20 2b20 222e 2220 2b20 6578 740a 0a20  ] + "." + ext.. 
+0000c250: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000c260: 6172 616d 735b 2273 7566 6669 7822 5d20  arams["suffix"] 
+0000c270: 3d20 7375 6666 6978 5b3a 2d34 5d0a 2020  = suffix[:-4].  
+0000c280: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+0000c290: 7468 2072 656e 5f6f 7065 6e28 666e 2c20  th ren_open(fn, 
+0000c2a0: 2a6f 7065 6e5f 612c 202a 2a70 6172 616d  *open_a, **param
+0000c2b0: 7329 2061 7320 7a66 773a 0a20 2020 2020  s) as zfw:.     
+0000c2c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000c2d0: 2c20 666e 203d 207a 6677 5b22 6f72 7a22  , fn = zfw["orz"
+0000c2e0: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+0000c2f0: 2020 2070 6174 6832 203d 206f 732e 7061     path2 = os.pa
+0000c300: 7468 2e6a 6f69 6e28 6664 6972 2c20 666e  th.join(fdir, fn
+0000c310: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+0000c320: 2020 2061 746f 6d69 635f 6d6f 7665 2870     atomic_move(p
+0000c330: 6174 682c 2070 6174 6832 290a 2020 2020  ath, path2).    
+0000c340: 2020 2020 2020 2020 2020 2020 666e 203d              fn =
+0000c350: 2066 6e32 0a20 2020 2020 2020 2020 2020   fn2.           
+0000c360: 2020 2020 2070 6174 6820 3d20 7061 7468       path = path
+0000c370: 320a 0a20 2020 2020 2020 2069 6620 7861  2..        if xa
+0000c380: 7520 616e 6420 6e6f 7420 7275 6e68 6f6f  u and not runhoo
+0000c390: 6b28 0a20 2020 2020 2020 2020 2020 2073  k(.            s
+0000c3a0: 656c 662e 6c6f 672c 0a20 2020 2020 2020  elf.log,.       
+0000c3b0: 2020 2020 2078 6175 2c0a 2020 2020 2020       xau,.      
+0000c3c0: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
+0000c3d0: 2020 2020 2020 2020 7365 6c66 2e76 7061          self.vpa
+0000c3e0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+0000c3f0: 7365 6c66 2e68 6f73 742c 0a20 2020 2020  self.host,.     
+0000c400: 2020 2020 2020 2073 656c 662e 756e 616d         self.unam
+0000c410: 652c 0a20 2020 2020 2020 2020 2020 206d  e,.            m
+0000c420: 742c 0a20 2020 2020 2020 2020 2020 2070  t,.            p
+0000c430: 6f73 745f 737a 2c0a 2020 2020 2020 2020  ost_sz,.        
+0000c440: 2020 2020 7365 6c66 2e69 702c 0a20 2020      self.ip,.   
+0000c450: 2020 2020 2020 2020 2061 742c 0a20 2020           at,.   
+0000c460: 2020 2020 2020 2020 2022 222c 0a20 2020           "",.   
+0000c470: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0000c480: 2020 2020 7420 3d20 2275 706c 6f61 6420      t = "upload 
+0000c490: 626c 6f63 6b65 6420 6279 2078 6175 2073  blocked by xau s
+0000c4a0: 6572 7665 7220 636f 6e66 6967 220a 2020  erver config".  
+0000c4b0: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+0000c4c0: 6f67 2874 2c20 3129 0a20 2020 2020 2020  og(t, 1).       
+0000c4d0: 2020 2020 206f 732e 756e 6c69 6e6b 2870       os.unlink(p
+0000c4e0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
+0000c4f0: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
+0000c500: 332c 2074 290a 0a20 2020 2020 2020 2076  3, t)..        v
+0000c510: 6673 2c20 7265 6d20 3d20 7666 732e 6765  fs, rem = vfs.ge
+0000c520: 745f 6462 7628 7265 6d29 0a20 2020 2020  t_dbv(rem).     
+0000c530: 2020 2073 656c 662e 636f 6e6e 2e68 7372     self.conn.hsr
+0000c540: 762e 6272 6f6b 6572 2e73 6179 280a 2020  v.broker.say(.  
+0000c550: 2020 2020 2020 2020 2020 2275 7032 6b2e            "up2k.
+0000c560: 6861 7368 5f66 696c 6522 2c0a 2020 2020  hash_file",.    
+0000c570: 2020 2020 2020 2020 7666 732e 7265 616c          vfs.real
+0000c580: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0000c590: 2020 7666 732e 7670 6174 682c 0a20 2020    vfs.vpath,.   
+0000c5a0: 2020 2020 2020 2020 2076 6673 2e66 6c61           vfs.fla
+0000c5b0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+0000c5c0: 7265 6d2c 0a20 2020 2020 2020 2020 2020  rem,.           
+0000c5d0: 2066 6e2c 0a20 2020 2020 2020 2020 2020   fn,.           
+0000c5e0: 2073 656c 662e 6970 2c0a 2020 2020 2020   self.ip,.      
+0000c5f0: 2020 2020 2020 6174 2c0a 2020 2020 2020        at,.      
+0000c600: 2020 2020 2020 7365 6c66 2e75 6e61 6d65        self.uname
+0000c610: 2c0a 2020 2020 2020 2020 2020 2020 5472  ,.            Tr
+0000c620: 7565 2c0a 2020 2020 2020 2020 290a 0a20  ue,.        ).. 
+0000c630: 2020 2020 2020 2076 7375 6620 3d20 2222         vsuf = ""
+0000c640: 0a20 2020 2020 2020 2069 6620 2873 656c  .        if (sel
+0000c650: 662e 6361 6e5f 7265 6164 206f 7220 7365  f.can_read or se
+0000c660: 6c66 2e63 616e 5f75 7067 6574 2920 616e  lf.can_upget) an
+0000c670: 6420 2266 6b22 2069 6e20 7666 732e 666c  d "fk" in vfs.fl
+0000c680: 6167 733a 0a20 2020 2020 2020 2020 2020  ags:.           
+0000c690: 2076 7375 6620 3d20 223f 6b3d 2220 2b20   vsuf = "?k=" + 
+0000c6a0: 7365 6c66 2e67 656e 5f66 6b28 0a20 2020  self.gen_fk(.   
+0000c6b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000c6c0: 662e 6172 6773 2e66 6b5f 7361 6c74 2c0a  f.args.fk_salt,.
+0000c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c6e0: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+0000c6f0: 2020 2020 2020 706f 7374 5f73 7a2c 0a20        post_sz,. 
+0000c700: 2020 2020 2020 2020 2020 2020 2020 2030                 0
+0000c710: 2069 6620 414e 5957 494e 2065 6c73 6520   if ANYWIN else 
+0000c720: 626f 732e 7374 6174 2870 6174 6829 2e73  bos.stat(path).s
+0000c730: 745f 696e 6f2c 0a20 2020 2020 2020 2020  t_ino,.         
+0000c740: 2020 2029 5b3a 2076 6673 2e66 6c61 6773     )[: vfs.flags
+0000c750: 5b22 666b 225d 5d0a 0a20 2020 2020 2020  ["fk"]]..       
+0000c760: 2076 7061 7468 203d 2022 2f22 2e6a 6f69   vpath = "/".joi
+0000c770: 6e28 5b78 2066 6f72 2078 2069 6e20 5b76  n([x for x in [v
+0000c780: 6673 2e76 7061 7468 2c20 7265 6d2c 2066  fs.vpath, rem, f
+0000c790: 6e5d 2069 6620 785d 290a 2020 2020 2020  n] if x]).      
+0000c7a0: 2020 7670 6174 6820 3d20 7175 6f74 6570    vpath = quotep
+0000c7b0: 2876 7061 7468 290a 0a20 2020 2020 2020  (vpath)..       
+0000c7c0: 2075 726c 203d 2022 7b7d 3a2f 2f7b 7d2f   url = "{}://{}/
+0000c7d0: 7b7d 222e 666f 726d 6174 280a 2020 2020  {}".format(.    
+0000c7e0: 2020 2020 2020 2020 2268 7474 7073 2220          "https" 
+0000c7f0: 6966 2073 656c 662e 6973 5f68 7474 7073  if self.is_https
+0000c800: 2065 6c73 6520 2268 7474 7022 2c0a 2020   else "http",.  
+0000c810: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+0000c820: 6f73 742c 0a20 2020 2020 2020 2020 2020  ost,.           
+0000c830: 2073 656c 662e 6172 6773 2e52 5320 2b20   self.args.RS + 
+0000c840: 7670 6174 6820 2b20 7673 7566 2c0a 2020  vpath + vsuf,.  
+0000c850: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0000c860: 2072 6574 7572 6e20 706f 7374 5f73 7a2c   return post_sz,
+0000c870: 2073 6861 5f68 6578 2c20 7368 615f 6236   sha_hex, sha_b6
+0000c880: 342c 2072 656d 6169 6e73 2c20 7061 7468  4, remains, path
+0000c890: 2c20 7572 6c0a 0a20 2020 2064 6566 2068  , url..    def h
+0000c8a0: 616e 646c 655f 7374 6173 6828 7365 6c66  andle_stash(self
+0000c8b0: 2c20 6973 5f70 7574 2029 2020 3a0a 2020  , is_put )  :.  
+0000c8c0: 2020 2020 2020 706f 7374 5f73 7a2c 2073        post_sz, s
+0000c8d0: 6861 5f68 6578 2c20 7368 615f 6236 342c  ha_hex, sha_b64,
+0000c8e0: 2072 656d 6169 6e73 2c20 7061 7468 2c20   remains, path, 
+0000c8f0: 7572 6c20 3d20 7365 6c66 2e64 756d 705f  url = self.dump_
+0000c900: 746f 5f66 696c 6528 6973 5f70 7574 290a  to_file(is_put).
+0000c910: 2020 2020 2020 2020 7370 6420 3d20 7365          spd = se
+0000c920: 6c66 2e5f 7370 6428 706f 7374 5f73 7a29  lf._spd(post_sz)
+0000c930: 0a20 2020 2020 2020 2074 203d 2022 7b7d  .        t = "{}
+0000c940: 2077 726f 7465 207b 7d2f 7b7d 2062 7974   wrote {}/{} byt
+0000c950: 6573 2074 6f20 7b7d 2020 2320 7b7d 220a  es to {}  # {}".
+0000c960: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000c970: 2874 2e66 6f72 6d61 7428 7370 642c 2070  (t.format(spd, p
+0000c980: 6f73 745f 737a 2c20 7265 6d61 696e 732c  ost_sz, remains,
+0000c990: 2070 6174 682c 2073 6861 5f62 3634 5b3a   path, sha_b64[:
+0000c9a0: 3238 5d29 2920 2023 2032 310a 0a20 2020  28]))  # 21..   
+0000c9b0: 2020 2020 2061 6320 3d20 7365 6c66 2e75       ac = self.u
+0000c9c0: 7061 7261 6d2e 6765 7428 0a20 2020 2020  param.get(.     
+0000c9d0: 2020 2020 2020 2022 7761 6e74 222c 2073         "want", s
+0000c9e0: 656c 662e 6865 6164 6572 732e 6765 7428  elf.headers.get(
+0000c9f0: 2261 6363 6570 7422 2c20 2222 292e 6c6f  "accept", "").lo
+0000ca00: 7765 7228 292e 7370 6c69 7428 223b 2229  wer().split(";")
+0000ca10: 5b2d 315d 0a20 2020 2020 2020 2029 0a20  [-1].        ). 
+0000ca20: 2020 2020 2020 2069 6620 6163 203d 3d20         if ac == 
+0000ca30: 2275 726c 223a 0a20 2020 2020 2020 2020  "url":.         
+0000ca40: 2020 2074 203d 2075 726c 0a20 2020 2020     t = url.     
+0000ca50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000ca60: 2020 2020 2074 203d 2022 7b7d 5c6e 7b7d       t = "{}\n{}
+0000ca70: 5c6e 7b7d 5c6e 7b7d 5c6e 222e 666f 726d  \n{}\n{}\n".form
+0000ca80: 6174 2870 6f73 745f 737a 2c20 7368 615f  at(post_sz, sha_
+0000ca90: 6236 342c 2073 6861 5f68 6578 5b3a 3536  b64, sha_hex[:56
+0000caa0: 5d2c 2075 726c 290a 0a20 2020 2020 2020  ], url)..       
+0000cab0: 2068 203d 207b 224c 6f63 6174 696f 6e22   h = {"Location"
+0000cac0: 3a20 7572 6c7d 2069 6620 6973 5f70 7574  : url} if is_put
+0000cad0: 2061 6e64 2075 726c 2065 6c73 6520 7b7d   and url else {}
+0000cae0: 0a0a 2020 2020 2020 2020 6966 2022 782d  ..        if "x-
+0000caf0: 6f63 2d6d 7469 6d65 2220 696e 2073 656c  oc-mtime" in sel
+0000cb00: 662e 6865 6164 6572 733a 0a20 2020 2020  f.headers:.     
+0000cb10: 2020 2020 2020 2068 5b22 582d 4f43 2d4d         h["X-OC-M
+0000cb20: 5469 6d65 225d 203d 2022 6163 6365 7074  Time"] = "accept
+0000cb30: 6564 220a 2020 2020 2020 2020 2020 2020  ed".            
+0000cb40: 7420 3d20 2222 2020 2320 736f 6d65 2077  t = ""  # some w
+0000cb50: 6562 6461 7620 636c 6965 6e74 7320 6578  ebdav clients ex
+0000cb60: 7065 6374 2f70 7265 6665 7220 7468 6973  pect/prefer this
+0000cb70: 0a0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
+0000cb80: 6570 6c79 2874 2e65 6e63 6f64 6528 2275  eply(t.encode("u
+0000cb90: 7466 2d38 2229 2c20 3230 312c 2068 6561  tf-8"), 201, hea
+0000cba0: 6465 7273 3d68 290a 2020 2020 2020 2020  ders=h).        
+0000cbb0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+0000cbc0: 2064 6566 2062 616b 666c 6970 2873 656c   def bakflip(sel
+0000cbd0: 662c 2066 202c 206f 6673 202c 2073 7a20  f, f , ofs , sz 
+0000cbe0: 2c20 7368 6120 2920 203a 0a20 2020 2020  , sha )  :.     
+0000cbf0: 2020 2069 6620 6e6f 7420 7365 6c66 2e61     if not self.a
+0000cc00: 7267 732e 6261 6b5f 666c 6970 7320 6f72  rgs.bak_flips or
+0000cc10: 2073 656c 662e 6172 6773 2e6e 773a 0a20   self.args.nw:. 
+0000cc20: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000cc30: 6e0a 0a20 2020 2020 2020 2073 6469 7220  n..        sdir 
+0000cc40: 3d20 7365 6c66 2e61 7267 732e 6266 5f64  = self.args.bf_d
+0000cc50: 6972 0a20 2020 2020 2020 2066 7020 3d20  ir.        fp = 
+0000cc60: 6f73 2e70 6174 682e 6a6f 696e 2873 6469  os.path.join(sdi
+0000cc70: 722c 2073 6861 290a 2020 2020 2020 2020  r, sha).        
+0000cc80: 6966 2062 6f73 2e70 6174 682e 6578 6973  if bos.path.exis
+0000cc90: 7473 2866 7029 3a0a 2020 2020 2020 2020  ts(fp):.        
+0000cca0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000ccb0: 6c6f 6728 226e 6f20 6261 6b66 6c69 703b  log("no bakflip;
+0000ccc0: 2068 6176 6520 6974 222c 2036 290a 0a20   have it", 6).. 
+0000ccd0: 2020 2020 2020 2069 6620 6e6f 7420 626f         if not bo
+0000cce0: 732e 7061 7468 2e69 7364 6972 2873 6469  s.path.isdir(sdi
+0000ccf0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0000cd00: 626f 732e 6d61 6b65 6469 7273 2873 6469  bos.makedirs(sdi
+0000cd10: 7229 0a0a 2020 2020 2020 2020 6966 206c  r)..        if l
+0000cd20: 656e 2862 6f73 2e6c 6973 7464 6972 2873  en(bos.listdir(s
+0000cd30: 6469 7229 2920 3e3d 2073 656c 662e 6172  dir)) >= self.ar
+0000cd40: 6773 2e62 665f 6e63 3a0a 2020 2020 2020  gs.bf_nc:.      
+0000cd50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000cd60: 662e 6c6f 6728 226e 6f20 6261 6b66 6c69  f.log("no bakfli
+0000cd70: 703b 2074 6f6f 206d 616e 7922 2c20 3329  p; too many", 3)
+0000cd80: 0a0a 2020 2020 2020 2020 6e72 656d 203d  ..        nrem =
+0000cd90: 2073 7a0a 2020 2020 2020 2020 662e 7365   sz.        f.se
+0000cda0: 656b 286f 6673 290a 2020 2020 2020 2020  ek(ofs).        
+0000cdb0: 7769 7468 206f 7065 6e28 6670 2c20 2277  with open(fp, "w
+0000cdc0: 6222 2920 6173 2066 6f3a 0a20 2020 2020  b") as fo:.     
+0000cdd0: 2020 2020 2020 2077 6869 6c65 206e 7265         while nre
+0000cde0: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+0000cdf0: 2020 2062 7566 203d 2066 2e72 6561 6428     buf = f.read(
+0000ce00: 6d69 6e28 6e72 656d 2c20 3531 3220 2a20  min(nrem, 512 * 
+0000ce10: 3130 3234 2929 0a20 2020 2020 2020 2020  1024)).         
+0000ce20: 2020 2020 2020 2069 6620 6e6f 7420 6275         if not bu
+0000ce30: 663a 0a20 2020 2020 2020 2020 2020 2020  f:.             
+0000ce40: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
+0000ce50: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
+0000ce60: 656d 202d 3d20 6c65 6e28 6275 6629 0a20  em -= len(buf). 
+0000ce70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000ce80: 6f2e 7772 6974 6528 6275 6629 0a0a 2020  o.write(buf)..  
+0000ce90: 2020 2020 2020 6966 206e 7265 6d3a 0a20        if nrem:. 
+0000cea0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ceb0: 6c6f 6728 2262 616b 666c 6970 2074 7275  log("bakflip tru
+0000cec0: 6e63 6174 6564 3b20 7b7d 2072 656d 6169  ncated; {} remai
+0000ced0: 6e73 222e 666f 726d 6174 286e 7265 6d29  ns".format(nrem)
+0000cee0: 2c20 3129 0a20 2020 2020 2020 2020 2020  , 1).           
+0000cef0: 2061 746f 6d69 635f 6d6f 7665 2866 702c   atomic_move(fp,
+0000cf00: 2066 7020 2b20 222e 7472 756e 6322 290a   fp + ".trunc").
+0000cf10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000cf20: 2020 2020 2020 2020 2020 7365 6c66 2e6c            self.l
+0000cf30: 6f67 2822 6261 6b66 6c69 7020 6f6b 222c  og("bakflip ok",
+0000cf40: 2032 290a 0a20 2020 2064 6566 205f 7370   2)..    def _sp
+0000cf50: 6428 7365 6c66 2c20 6e62 7974 6573 202c  d(self, nbytes ,
+0000cf60: 2061 6464 2020 3d20 5472 7565 2920 203a   add  = True)  :
+0000cf70: 0a20 2020 2020 2020 2069 6620 6164 643a  .        if add:
+0000cf80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000cf90: 662e 636f 6e6e 2e6e 6279 7465 202b 3d20  f.conn.nbyte += 
+0000cfa0: 6e62 7974 6573 0a0a 2020 2020 2020 2020  nbytes..        
+0000cfb0: 7370 6431 203d 2067 6574 5f73 7064 286e  spd1 = get_spd(n
+0000cfc0: 6279 7465 732c 2073 656c 662e 7430 290a  bytes, self.t0).
+0000cfd0: 2020 2020 2020 2020 7370 6432 203d 2067          spd2 = g
+0000cfe0: 6574 5f73 7064 2873 656c 662e 636f 6e6e  et_spd(self.conn
+0000cff0: 2e6e 6279 7465 2c20 7365 6c66 2e63 6f6e  .nbyte, self.con
+0000d000: 6e2e 7430 290a 2020 2020 2020 2020 7265  n.t0).        re
+0000d010: 7475 726e 2022 2573 2025 7320 6e25 7322  turn "%s %s n%s"
+0000d020: 2025 2028 7370 6431 2c20 7370 6432 2c20   % (spd1, spd2, 
+0000d030: 7365 6c66 2e63 6f6e 6e2e 6e72 6571 290a  self.conn.nreq).
+0000d040: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
+0000d050: 706f 7374 5f6d 756c 7469 7061 7274 2873  post_multipart(s
+0000d060: 656c 6629 2020 3a0a 2020 2020 2020 2020  elf)  :.        
+0000d070: 7365 6c66 2e70 6172 7365 7220 3d20 4d75  self.parser = Mu
+0000d080: 6c74 6970 6172 7450 6172 7365 7228 7365  ltipartParser(se
+0000d090: 6c66 2e6c 6f67 2c20 7365 6c66 2e73 722c  lf.log, self.sr,
+0000d0a0: 2073 656c 662e 6865 6164 6572 7329 0a20   self.headers). 
+0000d0b0: 2020 2020 2020 2073 656c 662e 7061 7273         self.pars
+0000d0c0: 6572 2e70 6172 7365 2829 0a0a 2020 2020  er.parse()..    
+0000d0d0: 2020 2020 6163 7420 3d20 7365 6c66 2e70      act = self.p
+0000d0e0: 6172 7365 722e 7265 7175 6972 6528 2261  arser.require("a
+0000d0f0: 6374 222c 2036 3429 0a0a 2020 2020 2020  ct", 64)..      
+0000d100: 2020 6966 2061 6374 203d 3d20 226c 6f67    if act == "log
+0000d110: 696e 223a 0a20 2020 2020 2020 2020 2020  in":.           
+0000d120: 2072 6574 7572 6e20 7365 6c66 2e68 616e   return self.han
+0000d130: 646c 655f 6c6f 6769 6e28 290a 0a20 2020  dle_login()..   
+0000d140: 2020 2020 2069 6620 6163 7420 3d3d 2022       if act == "
+0000d150: 6d6b 6469 7222 3a0a 2020 2020 2020 2020  mkdir":.        
+0000d160: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d170: 6861 6e64 6c65 5f6d 6b64 6972 2829 0a0a  handle_mkdir()..
+0000d180: 2020 2020 2020 2020 6966 2061 6374 203d          if act =
+0000d190: 3d20 226e 6577 5f6d 6422 3a0a 2020 2020  = "new_md":.    
+0000d1a0: 2020 2020 2020 2020 2320 6b69 6e64 6120          # kinda 
+0000d1b0: 7369 6c6c 7920 6275 7420 6861 7320 7468  silly but has th
+0000d1c0: 6520 6c65 6173 7420 7369 6465 2065 6666  e least side eff
+0000d1d0: 6563 7473 0a20 2020 2020 2020 2020 2020  ects.           
+0000d1e0: 2072 6574 7572 6e20 7365 6c66 2e68 616e   return self.han
+0000d1f0: 646c 655f 6e65 775f 6d64 2829 0a0a 2020  dle_new_md()..  
+0000d200: 2020 2020 2020 6966 2061 6374 203d 3d20        if act == 
+0000d210: 2262 7075 7422 3a0a 2020 2020 2020 2020  "bput":.        
+0000d220: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d230: 6861 6e64 6c65 5f70 6c61 696e 5f75 706c  handle_plain_upl
+0000d240: 6f61 6428 290a 0a20 2020 2020 2020 2069  oad()..        i
+0000d250: 6620 6163 7420 3d3d 2022 7470 7574 223a  f act == "tput":
+0000d260: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000d270: 7572 6e20 7365 6c66 2e68 616e 646c 655f  urn self.handle_
+0000d280: 7465 7874 5f75 706c 6f61 6428 290a 0a20  text_upload().. 
+0000d290: 2020 2020 2020 2069 6620 6163 7420 3d3d         if act ==
+0000d2a0: 2022 7a69 7022 3a0a 2020 2020 2020 2020   "zip":.        
+0000d2b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d2c0: 6861 6e64 6c65 5f7a 6970 5f70 6f73 7428  handle_zip_post(
+0000d2d0: 290a 0a20 2020 2020 2020 2072 6169 7365  )..        raise
+0000d2e0: 2050 6562 6b61 6328 3432 322c 2027 696e   Pebkac(422, 'in
+0000d2f0: 7661 6c69 6420 6163 7469 6f6e 2022 7b7d  valid action "{}
+0000d300: 2227 2e66 6f72 6d61 7428 6163 7429 290a  "'.format(act)).
+0000d310: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
+0000d320: 7a69 705f 706f 7374 2873 656c 6629 2020  zip_post(self)  
+0000d330: 3a0a 2020 2020 2020 2020 6173 7365 7274  :.        assert
+0000d340: 2073 656c 662e 7061 7273 6572 0a20 2020   self.parser.   
+0000d350: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0000d360: 2020 2020 2020 6b20 3d20 6e65 7874 2878        k = next(x
+0000d370: 2066 6f72 2078 2069 6e20 7365 6c66 2e75   for x in self.u
+0000d380: 7061 7261 6d20 6966 2078 2069 6e20 2822  param if x in ("
+0000d390: 7a69 7022 2c20 2274 6172 2229 290a 2020  zip", "tar")).  
+0000d3a0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+0000d3b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000d3c0: 5065 626b 6163 2834 3232 2c20 226e 6565  Pebkac(422, "nee
+0000d3d0: 6420 7a69 7020 6f72 2074 6172 206b 6579  d zip or tar key
+0000d3e0: 776f 7264 2229 0a0a 2020 2020 2020 2020  word")..        
+0000d3f0: 7620 3d20 7365 6c66 2e75 7061 7261 6d5b  v = self.uparam[
+0000d400: 6b5d 0a0a 2020 2020 2020 2020 766e 2c20  k]..        vn, 
+0000d410: 7265 6d20 3d20 7365 6c66 2e61 7372 762e  rem = self.asrv.
+0000d420: 7666 732e 6765 7428 7365 6c66 2e76 7061  vfs.get(self.vpa
+0000d430: 7468 2c20 7365 6c66 2e75 6e61 6d65 2c20  th, self.uname, 
+0000d440: 5472 7565 2c20 4661 6c73 6529 0a20 2020  True, False).   
+0000d450: 2020 2020 207a 7320 3d20 7365 6c66 2e70       zs = self.p
+0000d460: 6172 7365 722e 7265 7175 6972 6528 2266  arser.require("f
+0000d470: 696c 6573 222c 2031 3032 3420 2a20 3130  iles", 1024 * 10
+0000d480: 3234 290a 2020 2020 2020 2020 6966 206e  24).        if n
+0000d490: 6f74 207a 733a 0a20 2020 2020 2020 2020  ot zs:.         
+0000d4a0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
+0000d4b0: 3432 322c 2022 6e65 6564 2066 696c 6573  422, "need files
+0000d4c0: 206c 6973 7422 290a 0a20 2020 2020 2020   list")..       
+0000d4d0: 2069 7465 6d73 203d 207a 732e 7265 706c   items = zs.repl
+0000d4e0: 6163 6528 225c 7222 2c20 2222 292e 7370  ace("\r", "").sp
+0000d4f0: 6c69 7428 225c 6e22 290a 2020 2020 2020  lit("\n").      
+0000d500: 2020 6974 656d 7320 3d20 5b75 6e71 756f    items = [unquo
+0000d510: 7465 7028 7829 2066 6f72 2078 2069 6e20  tep(x) for x in 
+0000d520: 6974 656d 7320 6966 2069 7465 6d73 5d0a  items if items].
+0000d530: 0a20 2020 2020 2020 2073 656c 662e 7061  .        self.pa
+0000d540: 7273 6572 2e64 726f 7028 290a 2020 2020  rser.drop().    
+0000d550: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000d560: 7478 5f7a 6970 286b 2c20 762c 2022 222c  tx_zip(k, v, "",
+0000d570: 2076 6e2c 2072 656d 2c20 6974 656d 732c   vn, rem, items,
+0000d580: 2073 656c 662e 6172 6773 2e65 6429 0a0a   self.args.ed)..
+0000d590: 2020 2020 6465 6620 6861 6e64 6c65 5f70      def handle_p
+0000d5a0: 6f73 745f 6a73 6f6e 2873 656c 6629 2020  ost_json(self)  
+0000d5b0: 3a0a 2020 2020 2020 2020 7472 793a 0a20  :.        try:. 
+0000d5c0: 2020 2020 2020 2020 2020 2072 656d 6169             remai
+0000d5d0: 6e73 203d 2069 6e74 2873 656c 662e 6865  ns = int(self.he
+0000d5e0: 6164 6572 735b 2263 6f6e 7465 6e74 2d6c  aders["content-l
+0000d5f0: 656e 6774 6822 5d29 0a20 2020 2020 2020  ength"]).       
+0000d600: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0000d610: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
+0000d620: 6328 3431 3129 0a0a 2020 2020 2020 2020  c(411)..        
+0000d630: 6966 2072 656d 6169 6e73 203e 2031 3032  if remains > 102
+0000d640: 3420 2a20 3130 3234 3a0a 2020 2020 2020  4 * 1024:.      
+0000d650: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+0000d660: 6163 2834 3133 2c20 226a 736f 6e20 3262  ac(413, "json 2b
+0000d670: 6967 2229 0a0a 2020 2020 2020 2020 656e  ig")..        en
+0000d680: 6320 3d20 2275 7466 2d38 220a 2020 2020  c = "utf-8".    
+0000d690: 2020 2020 6374 7970 6520 3d20 7365 6c66      ctype = self
+0000d6a0: 2e68 6561 6465 7273 2e67 6574 2822 636f  .headers.get("co
+0000d6b0: 6e74 656e 742d 7479 7065 222c 2022 2229  ntent-type", "")
+0000d6c0: 2e6c 6f77 6572 2829 0a20 2020 2020 2020  .lower().       
+0000d6d0: 2069 6620 2263 6861 7273 6574 2220 696e   if "charset" in
+0000d6e0: 2063 7479 7065 3a0a 2020 2020 2020 2020   ctype:.        
+0000d6f0: 2020 2020 656e 6320 3d20 6374 7970 652e      enc = ctype.
+0000d700: 7370 6c69 7428 2263 6861 7273 6574 2229  split("charset")
+0000d710: 5b31 5d2e 7374 7269 7028 2220 3d22 292e  [1].strip(" =").
+0000d720: 7370 6c69 7428 223b 2229 5b30 5d2e 7374  split(";")[0].st
+0000d730: 7269 7028 290a 0a20 2020 2020 2020 2074  rip()..        t
+0000d740: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0000d750: 6a73 6f6e 5f62 7566 203d 2073 656c 662e  json_buf = self.
+0000d760: 7372 2e72 6563 765f 6578 2872 656d 6169  sr.recv_ex(remai
+0000d770: 6e73 290a 2020 2020 2020 2020 6578 6365  ns).        exce
+0000d780: 7074 2055 6e72 6563 7645 4f46 3a0a 2020  pt UnrecvEOF:.  
+0000d790: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000d7a0: 5065 626b 6163 2834 3232 2c20 2263 6c69  Pebkac(422, "cli
+0000d7b0: 656e 7420 6469 7363 6f6e 6e65 6374 6564  ent disconnected
+0000d7c0: 2077 6869 6c65 2070 6f73 7469 6e67 204a   while posting J
+0000d7d0: 534f 4e22 290a 0a20 2020 2020 2020 2073  SON")..        s
+0000d7e0: 656c 662e 6c6f 6728 2264 6563 6f64 696e  elf.log("decodin
+0000d7f0: 6720 7b7d 2062 7974 6573 206f 6620 7b7d  g {} bytes of {}
+0000d800: 206a 736f 6e22 2e66 6f72 6d61 7428 6c65   json".format(le
+0000d810: 6e28 6a73 6f6e 5f62 7566 292c 2065 6e63  n(json_buf), enc
+0000d820: 2929 0a20 2020 2020 2020 2074 7279 3a0a  )).        try:.
+0000d830: 2020 2020 2020 2020 2020 2020 626f 6479              body
+0000d840: 203d 206a 736f 6e2e 6c6f 6164 7328 6a73   = json.loads(js
+0000d850: 6f6e 5f62 7566 2e64 6563 6f64 6528 656e  on_buf.decode(en
+0000d860: 632c 2022 7265 706c 6163 6522 2929 0a20  c, "replace")). 
+0000d870: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
+0000d880: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000d890: 2050 6562 6b61 6328 3432 322c 2022 796f   Pebkac(422, "yo
+0000d8a0: 7520 504f 5354 6564 2069 6e76 616c 6964  u POSTed invalid
+0000d8b0: 206a 736f 6e22 290a 0a20 2020 2020 2020   json")..       
+0000d8c0: 2023 2073 656c 662e 7265 706c 7928 6222   # self.reply(b"
+0000d8d0: 636c 6f75 6466 6c61 7265 222c 2035 3033  cloudflare", 503
+0000d8e0: 290a 2020 2020 2020 2020 2320 7265 7475  ).        # retu
+0000d8f0: 726e 2054 7275 650a 0a20 2020 2020 2020  rn True..       
+0000d900: 2069 6620 2273 7263 6822 2069 6e20 7365   if "srch" in se
+0000d910: 6c66 2e75 7061 7261 6d20 6f72 2022 7372  lf.uparam or "sr
+0000d920: 6368 2220 696e 2062 6f64 793a 0a20 2020  ch" in body:.   
+0000d930: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000d940: 7365 6c66 2e68 616e 646c 655f 7365 6172  self.handle_sear
+0000d950: 6368 2862 6f64 7929 0a0a 2020 2020 2020  ch(body)..      
+0000d960: 2020 6966 2022 6465 6c65 7465 2220 696e    if "delete" in
+0000d970: 2073 656c 662e 7570 6172 616d 3a0a 2020   self.uparam:.  
+0000d980: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000d990: 2073 656c 662e 6861 6e64 6c65 5f72 6d28   self.handle_rm(
+0000d9a0: 626f 6479 290a 0a20 2020 2020 2020 206e  body)..        n
+0000d9b0: 616d 6520 3d20 756e 646f 7428 626f 6479  ame = undot(body
+0000d9c0: 5b22 6e61 6d65 225d 290a 2020 2020 2020  ["name"]).      
+0000d9d0: 2020 6966 2022 2f22 2069 6e20 6e61 6d65    if "/" in name
+0000d9e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000d9f0: 6973 6520 5065 626b 6163 2834 3030 2c20  ise Pebkac(400, 
+0000da00: 2279 6f75 7220 636c 6965 6e74 2069 7320  "your client is 
+0000da10: 6f6c 643b 2070 7265 7373 2043 5452 4c2d  old; press CTRL-
+0000da20: 5348 4946 542d 5220 616e 6420 7472 7920  SHIFT-R and try 
+0000da30: 6167 6169 6e22 290a 0a20 2020 2020 2020  again")..       
+0000da40: 2076 6673 2c20 7265 6d20 3d20 7365 6c66   vfs, rem = self
+0000da50: 2e61 7372 762e 7666 732e 6765 7428 7365  .asrv.vfs.get(se
+0000da60: 6c66 2e76 7061 7468 2c20 7365 6c66 2e75  lf.vpath, self.u
+0000da70: 6e61 6d65 2c20 4661 6c73 652c 2054 7275  name, False, Tru
+0000da80: 6529 0a20 2020 2020 2020 2064 6276 2c20  e).        dbv, 
+0000da90: 7672 656d 203d 2076 6673 2e67 6574 5f64  vrem = vfs.get_d
+0000daa0: 6276 2872 656d 290a 0a20 2020 2020 2020  bv(rem)..       
+0000dab0: 2062 6f64 795b 2276 746f 7022 5d20 3d20   body["vtop"] = 
+0000dac0: 6462 762e 7670 6174 680a 2020 2020 2020  dbv.vpath.      
+0000dad0: 2020 626f 6479 5b22 7074 6f70 225d 203d    body["ptop"] =
+0000dae0: 2064 6276 2e72 6561 6c70 6174 680a 2020   dbv.realpath.  
+0000daf0: 2020 2020 2020 626f 6479 5b22 7072 656c        body["prel
+0000db00: 225d 203d 2076 7265 6d0a 2020 2020 2020  "] = vrem.      
+0000db10: 2020 626f 6479 5b22 686f 7374 225d 203d    body["host"] =
+0000db20: 2073 656c 662e 686f 7374 0a20 2020 2020   self.host.     
+0000db30: 2020 2062 6f64 795b 2275 7365 7222 5d20     body["user"] 
+0000db40: 3d20 7365 6c66 2e75 6e61 6d65 0a20 2020  = self.uname.   
+0000db50: 2020 2020 2062 6f64 795b 2261 6464 7222       body["addr"
+0000db60: 5d20 3d20 7365 6c66 2e69 700a 2020 2020  ] = self.ip.    
+0000db70: 2020 2020 626f 6479 5b22 7663 6667 225d      body["vcfg"]
+0000db80: 203d 2064 6276 2e66 6c61 6773 0a0a 2020   = dbv.flags..  
+0000db90: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0000dba0: 662e 6361 6e5f 6465 6c65 7465 3a0a 2020  f.can_delete:.  
+0000dbb0: 2020 2020 2020 2020 2020 626f 6479 2e70            body.p
+0000dbc0: 6f70 2822 7265 706c 6163 6522 2c20 4e6f  op("replace", No
+0000dbd0: 6e65 290a 0a20 2020 2020 2020 2069 6620  ne)..        if 
+0000dbe0: 7265 6d3a 0a20 2020 2020 2020 2020 2020  rem:.           
+0000dbf0: 2064 7374 203d 2076 6673 2e63 616e 6f6e   dst = vfs.canon
+0000dc00: 6963 616c 2872 656d 290a 2020 2020 2020  ical(rem).      
+0000dc10: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+0000dc20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0000dc30: 7420 626f 732e 7061 7468 2e69 7364 6972  t bos.path.isdir
+0000dc40: 2864 7374 293a 0a20 2020 2020 2020 2020  (dst):.         
+0000dc50: 2020 2020 2020 2020 2020 2062 6f73 2e6d             bos.m
+0000dc60: 616b 6564 6972 7328 6473 7429 0a20 2020  akedirs(dst).   
+0000dc70: 2020 2020 2020 2020 2065 7863 6570 7420           except 
+0000dc80: 4f53 4572 726f 7220 6173 2065 783a 0a20  OSError as ex:. 
+0000dc90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000dca0: 656c 662e 6c6f 6728 226d 616b 6564 6972  elf.log("makedir
+0000dcb0: 7320 6661 696c 6564 205b 7b7d 5d22 2e66  s failed [{}]".f
+0000dcc0: 6f72 6d61 7428 6473 7429 290a 2020 2020  ormat(dst)).    
+0000dcd0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0000dce0: 6f74 2062 6f73 2e70 6174 682e 6973 6469  ot bos.path.isdi
+0000dcf0: 7228 6473 7429 3a0a 2020 2020 2020 2020  r(dst):.        
+0000dd00: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+0000dd10: 782e 6572 726e 6f20 3d3d 2065 7272 6e6f  x.errno == errno
+0000dd20: 2e45 4143 4345 533a 0a20 2020 2020 2020  .EACCES:.       
+0000dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dd40: 2072 6169 7365 2050 6562 6b61 6328 3530   raise Pebkac(50
+0000dd50: 302c 2022 7468 6520 7365 7276 6572 204f  0, "the server O
+0000dd60: 5320 6465 6e69 6564 2077 7269 7465 2d61  S denied write-a
+0000dd70: 6363 6573 7322 290a 0a20 2020 2020 2020  ccess")..       
+0000dd80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000dd90: 6578 2e65 7272 6e6f 203d 3d20 6572 726e  ex.errno == errn
+0000dda0: 6f2e 4545 5849 5354 3a0a 2020 2020 2020  o.EEXIST:.      
+0000ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ddc0: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+0000ddd0: 3030 2c20 2273 6f6d 6520 6669 6c65 2067  00, "some file g
+0000dde0: 6f74 2079 6f75 7220 666f 6c64 6572 206e  ot your folder n
+0000ddf0: 616d 6522 290a 0a20 2020 2020 2020 2020  ame")..         
+0000de00: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000de10: 2050 6562 6b61 6328 3530 302c 206d 696e   Pebkac(500, min
+0000de20: 5f65 7828 2929 0a20 2020 2020 2020 2020  _ex()).         
+0000de30: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+0000de40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000de50: 2050 6562 6b61 6328 3530 302c 206d 696e   Pebkac(500, min
+0000de60: 5f65 7828 2929 0a0a 2020 2020 2020 2020  _ex())..        
+0000de70: 7820 3d20 7365 6c66 2e63 6f6e 6e2e 6873  x = self.conn.hs
+0000de80: 7276 2e62 726f 6b65 722e 6173 6b28 2275  rv.broker.ask("u
+0000de90: 7032 6b2e 6861 6e64 6c65 5f6a 736f 6e22  p2k.handle_json"
+0000dea0: 2c20 626f 6479 2c20 7365 6c66 2e75 3266  , body, self.u2f
+0000deb0: 682e 6170 7329 0a20 2020 2020 2020 2072  h.aps).        r
+0000dec0: 6574 203d 2078 2e67 6574 2829 0a20 2020  et = x.get().   
+0000ded0: 2020 2020 2069 6620 7365 6c66 2e69 735f       if self.is_
+0000dee0: 7670 726f 7869 6564 3a0a 2020 2020 2020  vproxied:.      
+0000def0: 2020 2020 2020 6966 2022 7075 726c 2220        if "purl" 
+0000df00: 696e 2072 6574 3a0a 2020 2020 2020 2020  in ret:.        
+0000df10: 2020 2020 2020 2020 7265 745b 2270 7572          ret["pur
+0000df20: 6c22 5d20 3d20 7365 6c66 2e61 7267 732e  l"] = self.args.
+0000df30: 5352 202b 2072 6574 5b22 7075 726c 225d  SR + ret["purl"]
+0000df40: 0a0a 2020 2020 2020 2020 7265 7420 3d20  ..        ret = 
+0000df50: 6a73 6f6e 2e64 756d 7073 2872 6574 290a  json.dumps(ret).
+0000df60: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000df70: 2872 6574 290a 2020 2020 2020 2020 7365  (ret).        se
+0000df80: 6c66 2e72 6570 6c79 2872 6574 2e65 6e63  lf.reply(ret.enc
+0000df90: 6f64 6528 2275 7466 2d38 2229 2c20 6d69  ode("utf-8"), mi
+0000dfa0: 6d65 3d22 6170 706c 6963 6174 696f 6e2f  me="application/
+0000dfb0: 6a73 6f6e 2229 0a20 2020 2020 2020 2072  json").        r
+0000dfc0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+0000dfd0: 6465 6620 6861 6e64 6c65 5f73 6561 7263  def handle_searc
+0000dfe0: 6828 7365 6c66 2c20 626f 6479 2020 2920  h(self, body  ) 
+0000dff0: 203a 0a20 2020 2020 2020 2069 6478 203d   :.        idx =
+0000e000: 2073 656c 662e 636f 6e6e 2e67 6574 5f75   self.conn.get_u
+0000e010: 3269 6478 2829 0a20 2020 2020 2020 2069  2idx().        i
+0000e020: 6620 6e6f 7420 6964 7820 6f72 206e 6f74  f not idx or not
+0000e030: 2068 6173 6174 7472 2869 6478 2c20 2270   hasattr(idx, "p
+0000e040: 5f65 6e64 2229 3a0a 2020 2020 2020 2020  _end"):.        
+0000e050: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+0000e060: 2835 3030 2c20 2273 716c 6974 6533 2069  (500, "sqlite3 i
+0000e070: 7320 6e6f 7420 6176 6169 6c61 626c 6520  s not available 
+0000e080: 6f6e 2074 6865 2073 6572 7665 723b 2063  on the server; c
+0000e090: 616e 6e6f 7420 7365 6172 6368 2229 0a0a  annot search")..
+0000e0a0: 2020 2020 2020 2020 766f 6c73 203d 205b          vols = [
+0000e0b0: 5d0a 2020 2020 2020 2020 7365 656e 203d  ].        seen =
+0000e0c0: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
+0000e0d0: 7674 6f70 2069 6e20 7365 6c66 2e72 766f  vtop in self.rvo
+0000e0e0: 6c3a 0a20 2020 2020 2020 2020 2020 2076  l:.            v
+0000e0f0: 6673 2c20 5f20 3d20 7365 6c66 2e61 7372  fs, _ = self.asr
+0000e100: 762e 7666 732e 6765 7428 7674 6f70 2c20  v.vfs.get(vtop, 
+0000e110: 7365 6c66 2e75 6e61 6d65 2c20 5472 7565  self.uname, True
+0000e120: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+0000e130: 2020 2020 2076 6673 203d 2076 6673 2e64       vfs = vfs.d
+0000e140: 6276 206f 7220 7666 730a 2020 2020 2020  bv or vfs.      
+0000e150: 2020 2020 2020 6966 2076 6673 2069 6e20        if vfs in 
+0000e160: 7365 656e 3a0a 2020 2020 2020 2020 2020  seen:.          
+0000e170: 2020 2020 2020 636f 6e74 696e 7565 0a0a        continue..
+0000e180: 2020 2020 2020 2020 2020 2020 7365 656e              seen
+0000e190: 5b76 6673 5d20 3d20 5472 7565 0a20 2020  [vfs] = True.   
+0000e1a0: 2020 2020 2020 2020 2076 6f6c 732e 6170           vols.ap
+0000e1b0: 7065 6e64 2828 7666 732e 7670 6174 682c  pend((vfs.vpath,
+0000e1c0: 2076 6673 2e72 6561 6c70 6174 682c 2076   vfs.realpath, v
+0000e1d0: 6673 2e66 6c61 6773 2929 0a0a 2020 2020  fs.flags))..    
+0000e1e0: 2020 2020 7430 203d 2074 696d 652e 7469      t0 = time.ti
+0000e1f0: 6d65 2829 0a20 2020 2020 2020 2069 6620  me().        if 
+0000e200: 6964 782e 705f 656e 643a 0a20 2020 2020  idx.p_end:.     
+0000e210: 2020 2020 2020 2070 656e 616c 7479 203d         penalty =
+0000e220: 2030 2e37 0a20 2020 2020 2020 2020 2020   0.7.           
+0000e230: 2074 5f69 646c 6520 3d20 7430 202d 2069   t_idle = t0 - i
+0000e240: 6478 2e70 5f65 6e64 0a20 2020 2020 2020  dx.p_end.       
+0000e250: 2020 2020 2069 6620 6964 782e 705f 6475       if idx.p_du
+0000e260: 7220 3e20 302e 3720 616e 6420 745f 6964  r > 0.7 and t_id
+0000e270: 6c65 203c 2070 656e 616c 7479 3a0a 2020  le < penalty:.  
+0000e280: 2020 2020 2020 2020 2020 2020 2020 7420                t 
+0000e290: 3d20 2272 6174 652d 6c69 6d69 7420 7b3a  = "rate-limit {:
+0000e2a0: 2e31 667d 2073 6563 2c20 636f 7374 207b  .1f} sec, cost {
+0000e2b0: 3a2e 3266 7d2c 2069 646c 6520 7b3a 2e32  :.2f}, idle {:.2
+0000e2c0: 667d 220a 2020 2020 2020 2020 2020 2020  f}".            
+0000e2d0: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+0000e2e0: 2834 3239 2c20 742e 666f 726d 6174 2870  (429, t.format(p
+0000e2f0: 656e 616c 7479 2c20 6964 782e 705f 6475  enalty, idx.p_du
+0000e300: 722c 2074 5f69 646c 6529 290a 0a20 2020  r, t_idle))..   
+0000e310: 2020 2020 2069 6620 2273 7263 6822 2069       if "srch" i
+0000e320: 6e20 626f 6479 3a0a 2020 2020 2020 2020  n body:.        
+0000e330: 2020 2020 2320 7365 6172 6368 2062 7920      # search by 
+0000e340: 7570 326b 2068 6173 686c 6973 740a 2020  up2k hashlist.  
+0000e350: 2020 2020 2020 2020 2020 7662 6f64 7920            vbody 
+0000e360: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0000e370: 626f 6479 290a 2020 2020 2020 2020 2020  body).          
+0000e380: 2020 7662 6f64 795b 2268 6173 6822 5d20    vbody["hash"] 
+0000e390: 3d20 6c65 6e28 7662 6f64 795b 2268 6173  = len(vbody["has
+0000e3a0: 6822 5d29 0a20 2020 2020 2020 2020 2020  h"]).           
+0000e3b0: 2073 656c 662e 6c6f 6728 2271 6a3a 2022   self.log("qj: "
+0000e3c0: 202b 2072 6570 7228 7662 6f64 7929 290a   + repr(vbody)).
+0000e3d0: 2020 2020 2020 2020 2020 2020 6869 7473              hits
+0000e3e0: 203d 2069 6478 2e66 7365 6172 6368 2876   = idx.fsearch(v
+0000e3f0: 6f6c 732c 2062 6f64 7929 0a20 2020 2020  ols, body).     
+0000e400: 2020 2020 2020 206d 7367 2020 3d20 7265         msg  = re
+0000e410: 7072 2868 6974 7329 0a20 2020 2020 2020  pr(hits).       
+0000e420: 2020 2020 2074 6167 6c69 7374 2020 3d20       taglist  = 
+0000e430: 5b5d 0a20 2020 2020 2020 2020 2020 2074  [].            t
+0000e440: 7275 6e63 203d 2046 616c 7365 0a20 2020  runc = False.   
+0000e450: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000e460: 2020 2020 2020 2023 2073 6561 7263 6820         # search 
+0000e470: 6279 2071 7565 7279 2070 6172 616d 730a  by query params.
+0000e480: 2020 2020 2020 2020 2020 2020 7120 3d20              q = 
+0000e490: 626f 6479 5b22 7122 5d0a 2020 2020 2020  body["q"].      
+0000e4a0: 2020 2020 2020 6e20 3d20 626f 6479 2e67        n = body.g
+0000e4b0: 6574 2822 6e22 2c20 7365 6c66 2e61 7267  et("n", self.arg
+0000e4c0: 732e 7372 6368 5f68 6974 7329 0a20 2020  s.srch_hits).   
+0000e4d0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0000e4e0: 6728 2271 6a3a 207b 7d20 7c7b 7d7c 222e  g("qj: {} |{}|".
+0000e4f0: 666f 726d 6174 2871 2c20 6e29 290a 2020  format(q, n)).  
+0000e500: 2020 2020 2020 2020 2020 6869 7473 2c20            hits, 
+0000e510: 7461 676c 6973 742c 2074 7275 6e63 203d  taglist, trunc =
+0000e520: 2069 6478 2e73 6561 7263 6828 766f 6c73   idx.search(vols
+0000e530: 2c20 712c 206e 290a 2020 2020 2020 2020  , q, n).        
+0000e540: 2020 2020 6d73 6720 3d20 6c65 6e28 6869      msg = len(hi
+0000e550: 7473 290a 0a20 2020 2020 2020 2069 6478  ts)..        idx
+0000e560: 2e70 5f65 6e64 203d 2074 696d 652e 7469  .p_end = time.ti
+0000e570: 6d65 2829 0a20 2020 2020 2020 2069 6478  me().        idx
+0000e580: 2e70 5f64 7572 203d 2069 6478 2e70 5f65  .p_dur = idx.p_e
+0000e590: 6e64 202d 2074 300a 2020 2020 2020 2020  nd - t0.        
+0000e5a0: 7365 6c66 2e6c 6f67 2822 7123 3a20 7b7d  self.log("q#: {}
+0000e5b0: 2028 7b3a 2e32 667d 7329 222e 666f 726d   ({:.2f}s)".form
+0000e5c0: 6174 286d 7367 2c20 6964 782e 705f 6475  at(msg, idx.p_du
+0000e5d0: 7229 290a 0a20 2020 2020 2020 206f 7264  r))..        ord
+0000e5e0: 6572 203d 205b 5d0a 2020 2020 2020 2020  er = [].        
+0000e5f0: 6366 6720 3d20 7365 6c66 2e61 7267 732e  cfg = self.args.
+0000e600: 6d74 652e 7370 6c69 7428 222c 2229 0a20  mte.split(","). 
+0000e610: 2020 2020 2020 2066 6f72 2074 2069 6e20         for t in 
+0000e620: 6366 673a 0a20 2020 2020 2020 2020 2020  cfg:.           
+0000e630: 2069 6620 7420 696e 2074 6167 6c69 7374   if t in taglist
+0000e640: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000e650: 2020 6f72 6465 722e 6170 7065 6e64 2874    order.append(t
+0000e660: 290a 2020 2020 2020 2020 666f 7220 7420  ).        for t 
+0000e670: 696e 2074 6167 6c69 7374 3a0a 2020 2020  in taglist:.    
+0000e680: 2020 2020 2020 2020 6966 2074 206e 6f74          if t not
+0000e690: 2069 6e20 6f72 6465 723a 0a20 2020 2020   in order:.     
+0000e6a0: 2020 2020 2020 2020 2020 206f 7264 6572             order
+0000e6b0: 2e61 7070 656e 6428 7429 0a0a 2020 2020  .append(t)..    
+0000e6c0: 2020 2020 6966 2073 656c 662e 6973 5f76      if self.is_v
+0000e6d0: 7072 6f78 6965 643a 0a20 2020 2020 2020  proxied:.       
+0000e6e0: 2020 2020 2066 6f72 2068 6974 2069 6e20       for hit in 
+0000e6f0: 6869 7473 3a0a 2020 2020 2020 2020 2020  hits:.          
+0000e700: 2020 2020 2020 6869 745b 2272 7022 5d20        hit["rp"] 
+0000e710: 3d20 7365 6c66 2e61 7267 732e 5253 202b  = self.args.RS +
+0000e720: 2068 6974 5b22 7270 225d 0a0a 2020 2020   hit["rp"]..    
+0000e730: 2020 2020 726a 203d 207b 2268 6974 7322      rj = {"hits"
+0000e740: 3a20 6869 7473 2c20 2274 6167 5f6f 7264  : hits, "tag_ord
+0000e750: 6572 223a 206f 7264 6572 2c20 2274 7275  er": order, "tru
+0000e760: 6e63 223a 2074 7275 6e63 7d0a 2020 2020  nc": trunc}.    
+0000e770: 2020 2020 7220 3d20 6a73 6f6e 2e64 756d      r = json.dum
+0000e780: 7073 2872 6a29 2e65 6e63 6f64 6528 2275  ps(rj).encode("u
+0000e790: 7466 2d38 2229 0a20 2020 2020 2020 2073  tf-8").        s
+0000e7a0: 656c 662e 7265 706c 7928 722c 206d 696d  elf.reply(r, mim
+0000e7b0: 653d 2261 7070 6c69 6361 7469 6f6e 2f6a  e="application/j
+0000e7c0: 736f 6e22 290a 2020 2020 2020 2020 7265  son").        re
+0000e7d0: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
+0000e7e0: 6566 2068 616e 646c 655f 706f 7374 5f62  ef handle_post_b
+0000e7f0: 696e 6172 7928 7365 6c66 2920 203a 0a20  inary(self)  :. 
+0000e800: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0000e810: 2020 2020 2020 2020 7265 6d61 696e 7320          remains 
+0000e820: 3d20 696e 7428 7365 6c66 2e68 6561 6465  = int(self.heade
+0000e830: 7273 5b22 636f 6e74 656e 742d 6c65 6e67  rs["content-leng
+0000e840: 7468 225d 290a 2020 2020 2020 2020 6578  th"]).        ex
+0000e850: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
+0000e860: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+0000e870: 3030 2c20 2279 6f75 206d 7573 7420 7375  00, "you must su
+0000e880: 7070 6c79 2061 2063 6f6e 7465 6e74 2d6c  pply a content-l
+0000e890: 656e 6774 6820 666f 7220 6269 6e61 7279  ength for binary
+0000e8a0: 2050 4f53 5422 290a 0a20 2020 2020 2020   POST")..       
+0000e8b0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000e8c0: 2020 6368 6173 6820 3d20 7365 6c66 2e68    chash = self.h
+0000e8d0: 6561 6465 7273 5b22 782d 7570 326b 2d68  eaders["x-up2k-h
+0000e8e0: 6173 6822 5d0a 2020 2020 2020 2020 2020  ash"].          
+0000e8f0: 2020 7761 726b 203d 2073 656c 662e 6865    wark = self.he
+0000e900: 6164 6572 735b 2278 2d75 7032 6b2d 7761  aders["x-up2k-wa
+0000e910: 726b 225d 0a20 2020 2020 2020 2065 7863  rk"].        exc
+0000e920: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
+0000e930: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000e940: 5065 626b 6163 2834 3030 2c20 226e 6565  Pebkac(400, "nee
+0000e950: 6420 6861 7368 2061 6e64 2077 6172 6b20  d hash and wark 
+0000e960: 6865 6164 6572 7320 666f 7220 6269 6e61  headers for bina
+0000e970: 7279 2050 4f53 5422 290a 0a20 2020 2020  ry POST")..     
+0000e980: 2020 2076 6673 2c20 5f20 3d20 7365 6c66     vfs, _ = self
+0000e990: 2e61 7372 762e 7666 732e 6765 7428 7365  .asrv.vfs.get(se
+0000e9a0: 6c66 2e76 7061 7468 2c20 7365 6c66 2e75  lf.vpath, self.u
+0000e9b0: 6e61 6d65 2c20 4661 6c73 652c 2054 7275  name, False, Tru
+0000e9c0: 6529 0a20 2020 2020 2020 2070 746f 7020  e).        ptop 
+0000e9d0: 3d20 2876 6673 2e64 6276 206f 7220 7666  = (vfs.dbv or vf
+0000e9e0: 7329 2e72 6561 6c70 6174 680a 0a20 2020  s).realpath..   
+0000e9f0: 2020 2020 2078 203d 2073 656c 662e 636f       x = self.co
+0000ea00: 6e6e 2e68 7372 762e 6272 6f6b 6572 2e61  nn.hsrv.broker.a
+0000ea10: 736b 2822 7570 326b 2e68 616e 646c 655f  sk("up2k.handle_
+0000ea20: 6368 756e 6b22 2c20 7074 6f70 2c20 7761  chunk", ptop, wa
+0000ea30: 726b 2c20 6368 6173 6829 0a20 2020 2020  rk, chash).     
+0000ea40: 2020 2072 6573 706f 6e73 6520 3d20 782e     response = x.
+0000ea50: 6765 7428 290a 2020 2020 2020 2020 6368  get().        ch
+0000ea60: 756e 6b73 697a 652c 2063 7374 6172 742c  unksize, cstart,
+0000ea70: 2070 6174 682c 206c 6173 746d 6f64 2c20   path, lastmod, 
+0000ea80: 7370 7273 203d 2072 6573 706f 6e73 650a  sprs = response.
+0000ea90: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0000eaa0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+0000eab0: 662e 6172 6773 2e6e 773a 0a20 2020 2020  f.args.nw:.     
+0000eac0: 2020 2020 2020 2020 2020 2070 6174 6820             path 
+0000ead0: 3d20 6f73 2e64 6576 6e75 6c6c 0a0a 2020  = os.devnull..  
+0000eae0: 2020 2020 2020 2020 2020 6966 2072 656d            if rem
+0000eaf0: 6169 6e73 203e 2063 6875 6e6b 7369 7a65  ains > chunksize
+0000eb00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000eb10: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+0000eb20: 3030 2c20 2279 6f75 7220 6368 756e 6b20  00, "your chunk 
+0000eb30: 6973 2074 6f6f 2062 6967 2074 6f20 6669  is too big to fi
+0000eb40: 7422 290a 0a20 2020 2020 2020 2020 2020  t")..           
+0000eb50: 2073 656c 662e 6c6f 6728 2277 7269 7469   self.log("writi
+0000eb60: 6e67 207b 7d20 237b 7d20 407b 7d20 6c65  ng {} #{} @{} le
+0000eb70: 6e20 7b7d 222e 666f 726d 6174 2870 6174  n {}".format(pat
+0000eb80: 682c 2063 6861 7368 2c20 6373 7461 7274  h, chash, cstart
+0000eb90: 2c20 7265 6d61 696e 7329 290a 0a20 2020  , remains))..   
+0000eba0: 2020 2020 2020 2020 2072 6561 6465 7220           reader 
+0000ebb0: 3d20 7265 6164 5f73 6f63 6b65 7428 7365  = read_socket(se
+0000ebc0: 6c66 2e73 722c 2072 656d 6169 6e73 290a  lf.sr, remains).
+0000ebd0: 0a20 2020 2020 2020 2020 2020 2066 203d  .            f =
+0000ebe0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+0000ebf0: 2020 6670 6f6f 6c20 3d20 6e6f 7420 7365    fpool = not se
+0000ec00: 6c66 2e61 7267 732e 6e6f 5f66 706f 6f6c  lf.args.no_fpool
+0000ec10: 2061 6e64 2073 7072 730a 2020 2020 2020   and sprs.      
+0000ec20: 2020 2020 2020 6966 2066 706f 6f6c 3a0a        if fpool:.
+0000ec30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec40: 7769 7468 2073 656c 662e 6d75 7465 783a  with self.mutex:
+0000ec50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ec60: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+0000ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec80: 2020 6620 3d20 7365 6c66 2e75 3266 682e    f = self.u2fh.
+0000ec90: 706f 7028 7061 7468 290a 2020 2020 2020  pop(path).      
+0000eca0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+0000ecb0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
+0000ecc0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0000ecd0: 7373 0a0a 2020 2020 2020 2020 2020 2020  ss..            
+0000ece0: 6620 3d20 6620 6f72 206f 7065 6e28 6673  f = f or open(fs
+0000ecf0: 656e 6328 7061 7468 292c 2022 7262 2b22  enc(path), "rb+"
+0000ed00: 2c20 3531 3220 2a20 3130 3234 290a 0a20  , 512 * 1024).. 
+0000ed10: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+0000ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed30: 662e 7365 656b 2863 7374 6172 745b 305d  f.seek(cstart[0]
+0000ed40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000ed50: 2020 706f 7374 5f73 7a2c 205f 2c20 7368    post_sz, _, sh
+0000ed60: 615f 6236 3420 3d20 6861 7368 636f 7079  a_b64 = hashcopy
+0000ed70: 2872 6561 6465 722c 2066 2c20 7365 6c66  (reader, f, self
+0000ed80: 2e61 7267 732e 735f 7772 5f73 6c70 290a  .args.s_wr_slp).
+0000ed90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eda0: 2069 6620 7368 615f 6236 3420 213d 2063   if sha_b64 != c
+0000edb0: 6861 7368 3a0a 2020 2020 2020 2020 2020  hash:.          
+0000edc0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0000edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ede0: 2020 2020 2020 2073 656c 662e 6261 6b66         self.bakf
+0000edf0: 6c69 7028 662c 2063 7374 6172 745b 305d  lip(f, cstart[0]
+0000ee00: 2c20 706f 7374 5f73 7a2c 2073 6861 5f62  , post_sz, sha_b
+0000ee10: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
+0000ee20: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+0000ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ee40: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0000ee50: 2822 6261 6b66 6c69 7020 6661 696c 6564  ("bakflip failed
+0000ee60: 3a20 2220 2b20 6d69 6e5f 6578 2829 290a  : " + min_ex()).
+0000ee70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ee80: 2020 2020 2074 203d 2022 796f 7572 2063       t = "your c
+0000ee90: 6875 6e6b 2067 6f74 2063 6f72 7275 7074  hunk got corrupt
+0000eea0: 6564 2073 6f6d 6568 6f77 2028 7265 6365  ed somehow (rece
+0000eeb0: 6976 6564 207b 7d20 6279 7465 7329 3b20  ived {} bytes); 
+0000eec0: 6578 7065 6374 6564 2076 7320 7265 6365  expected vs rece
+0000eed0: 6976 6564 2068 6173 683a 5c6e 7b7d 5c6e  ived hash:\n{}\n
+0000eee0: 7b7d 220a 2020 2020 2020 2020 2020 2020  {}".            
+0000eef0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
+0000ef00: 626b 6163 2834 3030 2c20 742e 666f 726d  bkac(400, t.form
+0000ef10: 6174 2870 6f73 745f 737a 2c20 6368 6173  at(post_sz, chas
+0000ef20: 682c 2073 6861 5f62 3634 2929 0a0a 2020  h, sha_b64))..  
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000ef40: 206c 656e 2863 7374 6172 7429 203e 2031   len(cstart) > 1
+0000ef50: 2061 6e64 2070 6174 6820 213d 206f 732e   and path != os.
+0000ef60: 6465 766e 756c 6c3a 0a20 2020 2020 2020  devnull:.       
+0000ef70: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000ef80: 662e 6c6f 6728 0a20 2020 2020 2020 2020  f.log(.         
+0000ef90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000efa0: 636c 6f6e 6520 7b7d 2074 6f20 7b7d 222e  clone {} to {}".
+0000efb0: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+0000efc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efd0: 2020 2020 6373 7461 7274 5b30 5d2c 2022      cstart[0], "
+0000efe0: 2026 2022 2e6a 6f69 6e28 756e 6963 6f64   & ".join(unicod
+0000eff0: 6528 7829 2066 6f72 2078 2069 6e20 6373  e(x) for x in cs
+0000f000: 7461 7274 5b31 3a5d 290a 2020 2020 2020  tart[1:]).      
+0000f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f020: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000f030: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000f040: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+0000f050: 7320 3d20 300a 2020 2020 2020 2020 2020  s = 0.          
+0000f060: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+0000f070: 6f66 7320 3c20 6368 756e 6b73 697a 653a  ofs < chunksize:
+0000f080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f090: 2020 2020 2020 2020 2062 7566 737a 203d           bufsz =
+0000f0a0: 206d 696e 2863 6875 6e6b 7369 7a65 202d   min(chunksize -
+0000f0b0: 206f 6673 2c20 3420 2a20 3130 3234 202a   ofs, 4 * 1024 *
+0000f0c0: 2031 3032 3429 0a20 2020 2020 2020 2020   1024).         
+0000f0d0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f0e0: 2e73 6565 6b28 6373 7461 7274 5b30 5d20  .seek(cstart[0] 
+0000f0f0: 2b20 6f66 7329 0a20 2020 2020 2020 2020  + ofs).         
+0000f100: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000f110: 7566 203d 2066 2e72 6561 6428 6275 6673  uf = f.read(bufs
+0000f120: 7a29 0a20 2020 2020 2020 2020 2020 2020  z).             
+0000f130: 2020 2020 2020 2020 2020 2066 6f72 2077             for w
+0000f140: 6f66 7320 696e 2063 7374 6172 745b 313a  ofs in cstart[1:
+0000f150: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0000f160: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f170: 2e73 6565 6b28 776f 6673 202b 206f 6673  .seek(wofs + ofs
+0000f180: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000f190: 2020 2020 2020 2020 2020 2020 2020 662e                f.
+0000f1a0: 7772 6974 6528 6275 6629 0a0a 2020 2020  write(buf)..    
+0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f1c0: 2020 2020 6f66 7320 2b3d 206c 656e 2862      ofs += len(b
+0000f1d0: 7566 290a 0a20 2020 2020 2020 2020 2020  uf)..           
+0000f1e0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+0000f1f0: 6728 2263 6c6f 6e65 207b 7d20 646f 6e65  g("clone {} done
+0000f200: 222e 666f 726d 6174 2863 7374 6172 745b  ".format(cstart[
+0000f210: 305d 2929 0a0a 2020 2020 2020 2020 2020  0]))..          
+0000f220: 2020 2020 2020 6966 206e 6f74 2066 706f        if not fpo
+0000f230: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
+0000f240: 2020 2020 2020 2020 662e 636c 6f73 6528          f.close(
+0000f250: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000f260: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000f270: 2020 2020 2020 2020 2020 2020 7769 7468              with
+0000f280: 2073 656c 662e 6d75 7465 783a 0a20 2020   self.mutex:.   
+0000f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2a0: 2020 2020 2073 656c 662e 7532 6668 2e70       self.u2fh.p
+0000f2b0: 7574 2870 6174 682c 2066 290a 2020 2020  ut(path, f).    
+0000f2c0: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+0000f2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f2e0: 2320 6d61 7962 6520 6275 7374 6564 2068  # maybe busted h
+0000f2f0: 616e 646c 6520 2865 672e 2064 6973 6b20  andle (eg. disk 
+0000f300: 7765 6e74 2066 756c 6c29 0a20 2020 2020  went full).     
+0000f310: 2020 2020 2020 2020 2020 2066 2e63 6c6f             f.clo
+0000f320: 7365 2829 0a20 2020 2020 2020 2020 2020  se().           
+0000f330: 2020 2020 2072 6169 7365 0a20 2020 2020       raise.     
+0000f340: 2020 2066 696e 616c 6c79 3a0a 2020 2020     finally:.    
+0000f350: 2020 2020 2020 2020 7820 3d20 7365 6c66          x = self
+0000f360: 2e63 6f6e 6e2e 6873 7276 2e62 726f 6b65  .conn.hsrv.broke
+0000f370: 722e 6173 6b28 2275 7032 6b2e 7265 6c65  r.ask("up2k.rele
+0000f380: 6173 655f 6368 756e 6b22 2c20 7074 6f70  ase_chunk", ptop
+0000f390: 2c20 7761 726b 2c20 6368 6173 6829 0a20  , wark, chash). 
+0000f3a0: 2020 2020 2020 2020 2020 2078 2e67 6574             x.get
+0000f3b0: 2829 2020 2320 626c 6f63 6b20 636c 6965  ()  # block clie
+0000f3c0: 6e74 2075 6e74 696c 2072 656c 6561 7365  nt until release
+0000f3d0: 640a 0a20 2020 2020 2020 2078 203d 2073  d..        x = s
+0000f3e0: 656c 662e 636f 6e6e 2e68 7372 762e 6272  elf.conn.hsrv.br
+0000f3f0: 6f6b 6572 2e61 736b 2822 7570 326b 2e63  oker.ask("up2k.c
+0000f400: 6f6e 6669 726d 5f63 6875 6e6b 222c 2070  onfirm_chunk", p
+0000f410: 746f 702c 2077 6172 6b2c 2063 6861 7368  top, wark, chash
+0000f420: 290a 2020 2020 2020 2020 7a74 6973 203d  ).        ztis =
+0000f430: 2078 2e67 6574 2829 0a20 2020 2020 2020   x.get().       
+0000f440: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000f450: 2020 6e75 6d5f 6c65 6674 2c20 6669 6e5f    num_left, fin_
+0000f460: 7061 7468 203d 207a 7469 730a 2020 2020  path = ztis.    
+0000f470: 2020 2020 6578 6365 7074 3a0a 2020 2020      except:.    
+0000f480: 2020 2020 2020 2020 7365 6c66 2e6c 6f75          self.lou
+0000f490: 645f 7265 706c 7928 7a74 6973 2c20 7374  d_reply(ztis, st
+0000f4a0: 6174 7573 3d35 3030 290a 2020 2020 2020  atus=500).      
+0000f4b0: 2020 2020 2020 7265 7475 726e 2046 616c        return Fal
+0000f4c0: 7365 0a0a 2020 2020 2020 2020 6966 206e  se..        if n
+0000f4d0: 6f74 206e 756d 5f6c 6566 7420 616e 6420  ot num_left and 
+0000f4e0: 6670 6f6f 6c3a 0a20 2020 2020 2020 2020  fpool:.         
+0000f4f0: 2020 2077 6974 6820 7365 6c66 2e6d 7574     with self.mut
+0000f500: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
+0000f510: 2020 2020 7365 6c66 2e75 3266 682e 636c      self.u2fh.cl
+0000f520: 6f73 6528 7061 7468 290a 0a20 2020 2020  ose(path)..     
+0000f530: 2020 2069 6620 6e6f 7420 6e75 6d5f 6c65     if not num_le
+0000f540: 6674 2061 6e64 206e 6f74 2073 656c 662e  ft and not self.
+0000f550: 6172 6773 2e6e 773a 0a20 2020 2020 2020  args.nw:.       
+0000f560: 2020 2020 2073 656c 662e 636f 6e6e 2e68       self.conn.h
+0000f570: 7372 762e 6272 6f6b 6572 2e61 736b 280a  srv.broker.ask(.
+0000f580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f590: 2275 7032 6b2e 6669 6e69 7368 5f75 706c  "up2k.finish_upl
+0000f5a0: 6f61 6422 2c20 7074 6f70 2c20 7761 726b  oad", ptop, wark
+0000f5b0: 2c20 7365 6c66 2e75 3266 682e 6170 730a  , self.u2fh.aps.
+0000f5c0: 2020 2020 2020 2020 2020 2020 292e 6765              ).ge
+0000f5d0: 7428 290a 0a20 2020 2020 2020 2063 696e  t()..        cin
+0000f5e0: 6620 3d20 7365 6c66 2e68 6561 6465 7273  f = self.headers
+0000f5f0: 2e67 6574 2822 782d 7570 326b 2d73 7461  .get("x-up2k-sta
+0000f600: 7422 2c20 2222 290a 0a20 2020 2020 2020  t", "")..       
+0000f610: 2073 7064 203d 2073 656c 662e 5f73 7064   spd = self._spd
+0000f620: 2870 6f73 745f 737a 290a 2020 2020 2020  (post_sz).      
+0000f630: 2020 7365 6c66 2e6c 6f67 2822 7b3a 3730    self.log("{:70
+0000f640: 7d20 7468 616e 6b20 7b7d 222e 666f 726d  } thank {}".form
+0000f650: 6174 2873 7064 2c20 6369 6e66 2929 0a20  at(spd, cinf)). 
+0000f660: 2020 2020 2020 2073 656c 662e 7265 706c         self.repl
+0000f670: 7928 6222 7468 616e 6b22 290a 2020 2020  y(b"thank").    
+0000f680: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0000f690: 0a20 2020 2064 6566 2068 616e 646c 655f  .    def handle_
+0000f6a0: 6c6f 6769 6e28 7365 6c66 2920 203a 0a20  login(self)  :. 
+0000f6b0: 2020 2020 2020 2061 7373 6572 7420 7365         assert se
+0000f6c0: 6c66 2e70 6172 7365 720a 2020 2020 2020  lf.parser.      
+0000f6d0: 2020 7077 6420 3d20 7365 6c66 2e70 6172    pwd = self.par
+0000f6e0: 7365 722e 7265 7175 6972 6528 2263 7070  ser.require("cpp
+0000f6f0: 7764 222c 2036 3429 0a20 2020 2020 2020  wd", 64).       
+0000f700: 2073 656c 662e 7061 7273 6572 2e64 726f   self.parser.dro
+0000f710: 7028 290a 0a20 2020 2020 2020 2073 656c  p()..        sel
+0000f720: 662e 6f75 745f 6865 6164 6572 6c69 7374  f.out_headerlist
+0000f730: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0000f740: 2078 2066 6f72 2078 2069 6e20 7365 6c66   x for x in self
+0000f750: 2e6f 7574 5f68 6561 6465 726c 6973 7420  .out_headerlist 
+0000f760: 6966 2078 5b30 5d20 213d 2022 5365 742d  if x[0] != "Set-
+0000f770: 436f 6f6b 6965 2220 6f72 2022 6370 7077  Cookie" or "cppw
+0000f780: 2220 213d 2078 5b31 5d5b 3a34 5d0a 2020  " != x[1][:4].  
+0000f790: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
+0000f7a0: 2064 7374 203d 2073 656c 662e 6172 6773   dst = self.args
+0000f7b0: 2e53 5253 0a20 2020 2020 2020 2069 6620  .SRS.        if 
+0000f7c0: 7365 6c66 2e76 7061 7468 3a0a 2020 2020  self.vpath:.    
+0000f7d0: 2020 2020 2020 2020 6473 7420 2b3d 2071          dst += q
+0000f7e0: 756f 7465 7028 7365 6c66 2e76 7061 7468  uotep(self.vpath
+0000f7f0: 290a 0a20 2020 2020 2020 206d 7367 203d  )..        msg =
+0000f800: 2073 656c 662e 6765 745f 7077 645f 636f   self.get_pwd_co
+0000f810: 6f6b 6965 2870 7764 290a 2020 2020 2020  okie(pwd).      
+0000f820: 2020 6874 6d6c 203d 2073 656c 662e 6a32    html = self.j2
+0000f830: 7328 226d 7367 222c 2068 313d 6d73 672c  s("msg", h1=msg,
+0000f840: 2068 323d 273c 6120 6872 6566 3d22 2720   h2='<a href="' 
+0000f850: 2b20 6473 7420 2b20 2722 3e61 636b 3c2f  + dst + '">ack</
+0000f860: 613e 272c 2072 6564 6972 3d64 7374 290a  a>', redir=dst).
+0000f870: 2020 2020 2020 2020 7365 6c66 2e72 6570          self.rep
+0000f880: 6c79 2868 746d 6c2e 656e 636f 6465 2822  ly(html.encode("
+0000f890: 7574 662d 3822 2929 0a20 2020 2020 2020  utf-8")).       
+0000f8a0: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+0000f8b0: 2020 6465 6620 6765 745f 7077 645f 636f    def get_pwd_co
+0000f8c0: 6f6b 6965 2873 656c 662c 2070 7764 2029  okie(self, pwd )
+0000f8d0: 2020 3a0a 2020 2020 2020 2020 6966 2070    :.        if p
+0000f8e0: 7764 2069 6e20 7365 6c66 2e61 7372 762e  wd in self.asrv.
+0000f8f0: 6961 6363 743a 0a20 2020 2020 2020 2020  iacct:.         
+0000f900: 2020 206d 7367 203d 2022 6c6f 6769 6e20     msg = "login 
+0000f910: 6f6b 220a 2020 2020 2020 2020 2020 2020  ok".            
+0000f920: 6475 7220 3d20 696e 7428 3630 202a 2036  dur = int(60 * 6
+0000f930: 3020 2a20 7365 6c66 2e61 7267 732e 6c6f  0 * self.args.lo
+0000f940: 676f 7574 290a 2020 2020 2020 2020 656c  gout).        el
+0000f950: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000f960: 7365 6c66 2e6c 6f67 2822 696e 7661 6c69  self.log("invali
+0000f970: 6420 7061 7373 776f 7264 3a20 7b7d 222e  d password: {}".
+0000f980: 666f 726d 6174 2870 7764 292c 2033 290a  format(pwd), 3).
+0000f990: 2020 2020 2020 2020 2020 2020 6720 3d20              g = 
+0000f9a0: 7365 6c66 2e63 6f6e 6e2e 6873 7276 2e67  self.conn.hsrv.g
+0000f9b0: 7077 640a 2020 2020 2020 2020 2020 2020  pwd.            
+0000f9c0: 6966 2067 2e6c 696d 3a0a 2020 2020 2020  if g.lim:.      
+0000f9d0: 2020 2020 2020 2020 2020 626f 6e6b 2c20            bonk, 
+0000f9e0: 6970 203d 2067 2e62 6f6e 6b28 7365 6c66  ip = g.bonk(self
+0000f9f0: 2e69 702c 2070 7764 290a 2020 2020 2020  .ip, pwd).      
+0000fa00: 2020 2020 2020 2020 2020 6966 2062 6f6e            if bon
+0000fa10: 6b3a 0a20 2020 2020 2020 2020 2020 2020  k:.             
+0000fa20: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
+0000fa30: 2263 6c69 656e 7420 6261 6e6e 6564 3a20  "client banned: 
+0000fa40: 696e 7661 6c69 6420 7061 7373 776f 7264  invalid password
+0000fa50: 7322 2c20 3129 0a20 2020 2020 2020 2020  s", 1).         
+0000fa60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000fa70: 636f 6e6e 2e68 7372 762e 6261 6e73 5b69  conn.hsrv.bans[i
+0000fa80: 705d 203d 2062 6f6e 6b0a 0a20 2020 2020  p] = bonk..     
+0000fa90: 2020 2020 2020 206d 7367 203d 2022 6e61         msg = "na
+0000faa0: 7720 6475 6465 220a 2020 2020 2020 2020  w dude".        
+0000fab0: 2020 2020 7077 6420 3d20 2278 2220 2023      pwd = "x"  #
+0000fac0: 206e 6f73 6563 0a20 2020 2020 2020 2020   nosec.         
+0000fad0: 2020 2064 7572 203d 204e 6f6e 650a 0a20     dur = None.. 
+0000fae0: 2020 2020 2020 2069 6620 7077 6420 3d3d         if pwd ==
+0000faf0: 2022 7822 3a0a 2020 2020 2020 2020 2020   "x":.          
+0000fb00: 2020 2320 7265 7365 7420 626f 7468 2070    # reset both p
+0000fb10: 6c61 696e 7465 7874 2061 6e64 2074 6c73  laintext and tls
+0000fb20: 0a20 2020 2020 2020 2020 2020 2023 2028  .            # (
+0000fb30: 6f6e 6c79 2061 6666 6563 7473 2061 6374  only affects act
+0000fb40: 6976 6520 746c 7320 636f 6f6b 6965 7320  ive tls cookies 
+0000fb50: 7768 656e 2074 6c73 290a 2020 2020 2020  when tls).      
+0000fb60: 2020 2020 2020 666f 7220 6b20 696e 2028        for k in (
+0000fb70: 2263 7070 7764 222c 2022 6370 7077 7322  "cppwd", "cppws"
+0000fb80: 2920 6966 2073 656c 662e 6973 5f68 7474  ) if self.is_htt
+0000fb90: 7073 2065 6c73 6520 2822 6370 7077 6422  ps else ("cppwd"
+0000fba0: 2c29 3a0a 2020 2020 2020 2020 2020 2020  ,):.            
+0000fbb0: 2020 2020 636b 203d 2067 656e 636f 6f6b      ck = gencook
+0000fbc0: 6965 286b 2c20 7077 642c 2073 656c 662e  ie(k, pwd, self.
+0000fbd0: 6172 6773 2e52 2c20 4661 6c73 652c 2064  args.R, False, d
+0000fbe0: 7572 290a 2020 2020 2020 2020 2020 2020  ur).            
+0000fbf0: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
+0000fc00: 6465 726c 6973 742e 6170 7065 6e64 2828  derlist.append((
+0000fc10: 2253 6574 2d43 6f6f 6b69 6522 2c20 636b  "Set-Cookie", ck
+0000fc20: 2929 0a20 2020 2020 2020 2065 6c73 653a  )).        else:
+0000fc30: 0a20 2020 2020 2020 2020 2020 206b 203d  .            k =
+0000fc40: 2022 6370 7077 7322 2069 6620 7365 6c66   "cppws" if self
+0000fc50: 2e69 735f 6874 7470 7320 656c 7365 2022  .is_https else "
+0000fc60: 6370 7077 6422 0a20 2020 2020 2020 2020  cppwd".         
+0000fc70: 2020 2063 6b20 3d20 6765 6e63 6f6f 6b69     ck = gencooki
+0000fc80: 6528 6b2c 2070 7764 2c20 7365 6c66 2e61  e(k, pwd, self.a
+0000fc90: 7267 732e 522c 2073 656c 662e 6973 5f68  rgs.R, self.is_h
+0000fca0: 7474 7073 2c20 6475 7229 0a20 2020 2020  ttps, dur).     
+0000fcb0: 2020 2020 2020 2073 656c 662e 6f75 745f         self.out_
+0000fcc0: 6865 6164 6572 6c69 7374 2e61 7070 656e  headerlist.appen
+0000fcd0: 6428 2822 5365 742d 436f 6f6b 6965 222c  d(("Set-Cookie",
+0000fce0: 2063 6b29 290a 0a20 2020 2020 2020 2072   ck))..        r
+0000fcf0: 6574 7572 6e20 6d73 670a 0a20 2020 2064  eturn msg..    d
+0000fd00: 6566 2068 616e 646c 655f 6d6b 6469 7228  ef handle_mkdir(
+0000fd10: 7365 6c66 2920 203a 0a20 2020 2020 2020  self)  :.       
+0000fd20: 2061 7373 6572 7420 7365 6c66 2e70 6172   assert self.par
+0000fd30: 7365 720a 2020 2020 2020 2020 6e65 775f  ser.        new_
+0000fd40: 6469 7220 3d20 7365 6c66 2e70 6172 7365  dir = self.parse
+0000fd50: 722e 7265 7175 6972 6528 226e 616d 6522  r.require("name"
+0000fd60: 2c20 3531 3229 0a20 2020 2020 2020 2073  , 512).        s
+0000fd70: 656c 662e 7061 7273 6572 2e64 726f 7028  elf.parser.drop(
+0000fd80: 290a 0a20 2020 2020 2020 2073 616e 6974  )..        sanit
+0000fd90: 697a 6564 203d 2073 616e 6974 697a 655f  ized = sanitize_
+0000fda0: 666e 286e 6577 5f64 6972 2c20 2222 2c20  fn(new_dir, "", 
+0000fdb0: 5b5d 290a 2020 2020 2020 2020 7265 7475  []).        retu
+0000fdc0: 726e 2073 656c 662e 5f6d 6b64 6972 2876  rn self._mkdir(v
+0000fdd0: 6a6f 696e 2873 656c 662e 7670 6174 682c  join(self.vpath,
+0000fde0: 2073 616e 6974 697a 6564 2929 0a0a 2020   sanitized))..  
+0000fdf0: 2020 6465 6620 5f6d 6b64 6972 2873 656c    def _mkdir(sel
+0000fe00: 662c 2076 7061 7468 202c 2064 6176 2020  f, vpath , dav  
+0000fe10: 3d20 4661 6c73 6529 2020 3a0a 2020 2020  = False)  :.    
+0000fe20: 2020 2020 6e75 6c6c 7772 6974 6520 3d20      nullwrite = 
+0000fe30: 7365 6c66 2e61 7267 732e 6e77 0a20 2020  self.args.nw.   
+0000fe40: 2020 2020 2076 6673 2c20 7265 6d20 3d20       vfs, rem = 
+0000fe50: 7365 6c66 2e61 7372 762e 7666 732e 6765  self.asrv.vfs.ge
+0000fe60: 7428 7670 6174 682c 2073 656c 662e 756e  t(vpath, self.un
+0000fe70: 616d 652c 2046 616c 7365 2c20 5472 7565  ame, False, True
+0000fe80: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+0000fe90: 6173 7365 7274 5f73 6166 655f 7265 6d28  assert_safe_rem(
+0000fea0: 7265 6d29 0a20 2020 2020 2020 2066 6e20  rem).        fn 
+0000feb0: 3d20 7666 732e 6361 6e6f 6e69 6361 6c28  = vfs.canonical(
+0000fec0: 7265 6d29 0a0a 2020 2020 2020 2020 6966  rem)..        if
+0000fed0: 206e 6f74 206e 756c 6c77 7269 7465 3a0a   not nullwrite:.
+0000fee0: 2020 2020 2020 2020 2020 2020 6664 6972              fdir
+0000fef0: 203d 206f 732e 7061 7468 2e64 6972 6e61   = os.path.dirna
+0000ff00: 6d65 2866 6e29 0a0a 2020 2020 2020 2020  me(fn)..        
+0000ff10: 2020 2020 6966 206e 6f74 2062 6f73 2e70      if not bos.p
+0000ff20: 6174 682e 6973 6469 7228 6664 6972 293a  ath.isdir(fdir):
+0000ff30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ff40: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
+0000ff50: 392c 2022 7061 7265 6e74 2066 6f6c 6465  9, "parent folde
+0000ff60: 7220 646f 6573 206e 6f74 2065 7869 7374  r does not exist
+0000ff70: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+0000ff80: 6966 2062 6f73 2e70 6174 682e 6973 6469  if bos.path.isdi
+0000ff90: 7228 666e 293a 0a20 2020 2020 2020 2020  r(fn):.         
+0000ffa0: 2020 2020 2020 2072 6169 7365 2050 6562         raise Peb
+0000ffb0: 6b61 6328 3430 352c 2022 7468 6174 2066  kac(405, "that f
+0000ffc0: 6f6c 6465 7220 6578 6973 7473 2061 6c72  older exists alr
+0000ffd0: 6561 6479 2229 0a0a 2020 2020 2020 2020  eady")..        
+0000ffe0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000fff0: 2020 2020 2020 2020 2062 6f73 2e6d 6b64           bos.mkd
+00010000: 6972 2866 6e29 0a20 2020 2020 2020 2020  ir(fn).         
+00010010: 2020 2065 7863 6570 7420 4f53 4572 726f     except OSErro
+00010020: 7220 6173 2065 783a 0a20 2020 2020 2020  r as ex:.       
+00010030: 2020 2020 2020 2020 2069 6620 6578 2e65           if ex.e
+00010040: 7272 6e6f 203d 3d20 6572 726e 6f2e 4541  rrno == errno.EA
+00010050: 4343 4553 3a0a 2020 2020 2020 2020 2020  CCES:.          
+00010060: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00010070: 5065 626b 6163 2835 3030 2c20 2274 6865  Pebkac(500, "the
+00010080: 2073 6572 7665 7220 4f53 2064 656e 6965   server OS denie
+00010090: 6420 7772 6974 652d 6163 6365 7373 2229  d write-access")
+000100a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000100b0: 2020 7261 6973 6520 5065 626b 6163 2835    raise Pebkac(5
+000100c0: 3030 2c20 226d 6b64 6972 2066 6169 6c65  00, "mkdir faile
+000100d0: 643a 5c6e 2220 2b20 6d69 6e5f 6578 2829  d:\n" + min_ex()
+000100e0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
+000100f0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
+00010100: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+00010110: 6163 2835 3030 2c20 6d69 6e5f 6578 2829  ac(500, min_ex()
+00010120: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00010130: 6f75 745f 6865 6164 6572 735b 2258 2d4e  out_headers["X-N
+00010140: 6577 2d44 6972 225d 203d 2071 756f 7465  ew-Dir"] = quote
+00010150: 7028 7670 6174 682e 7370 6c69 7428 222f  p(vpath.split("/
+00010160: 2229 5b2d 315d 290a 0a20 2020 2020 2020  ")[-1])..       
+00010170: 2069 6620 6461 763a 0a20 2020 2020 2020   if dav:.       
+00010180: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
+00010190: 6222 222c 2032 3031 290a 2020 2020 2020  b"", 201).      
+000101a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000101b0: 2020 2020 7365 6c66 2e72 6564 6972 6563      self.redirec
+000101c0: 7428 7670 6174 682c 2073 7461 7475 733d  t(vpath, status=
+000101d0: 3230 3129 0a0a 2020 2020 2020 2020 7265  201)..        re
+000101e0: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
+000101f0: 6566 2068 616e 646c 655f 6e65 775f 6d64  ef handle_new_md
+00010200: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
+00010210: 2020 6173 7365 7274 2073 656c 662e 7061    assert self.pa
+00010220: 7273 6572 0a20 2020 2020 2020 206e 6577  rser.        new
+00010230: 5f66 696c 6520 3d20 7365 6c66 2e70 6172  _file = self.par
+00010240: 7365 722e 7265 7175 6972 6528 226e 616d  ser.require("nam
+00010250: 6522 2c20 3531 3229 0a20 2020 2020 2020  e", 512).       
+00010260: 2073 656c 662e 7061 7273 6572 2e64 726f   self.parser.dro
+00010270: 7028 290a 0a20 2020 2020 2020 206e 756c  p()..        nul
+00010280: 6c77 7269 7465 203d 2073 656c 662e 6172  lwrite = self.ar
+00010290: 6773 2e6e 770a 2020 2020 2020 2020 7666  gs.nw.        vf
+000102a0: 732c 2072 656d 203d 2073 656c 662e 6173  s, rem = self.as
+000102b0: 7276 2e76 6673 2e67 6574 2873 656c 662e  rv.vfs.get(self.
+000102c0: 7670 6174 682c 2073 656c 662e 756e 616d  vpath, self.unam
+000102d0: 652c 2046 616c 7365 2c20 5472 7565 290a  e, False, True).
+000102e0: 2020 2020 2020 2020 7365 6c66 2e5f 6173          self._as
+000102f0: 7365 7274 5f73 6166 655f 7265 6d28 7265  sert_safe_rem(re
+00010300: 6d29 0a0a 2020 2020 2020 2020 6966 206e  m)..        if n
+00010310: 6f74 206e 6577 5f66 696c 652e 656e 6473  ot new_file.ends
+00010320: 7769 7468 2822 2e6d 6422 293a 0a20 2020  with(".md"):.   
+00010330: 2020 2020 2020 2020 206e 6577 5f66 696c           new_fil
+00010340: 6520 2b3d 2022 2e6d 6422 0a0a 2020 2020  e += ".md"..    
+00010350: 2020 2020 7361 6e69 7469 7a65 6420 3d20      sanitized = 
+00010360: 7361 6e69 7469 7a65 5f66 6e28 6e65 775f  sanitize_fn(new_
+00010370: 6669 6c65 2c20 2222 2c20 5b5d 290a 0a20  file, "", []).. 
+00010380: 2020 2020 2020 2069 6620 6e6f 7420 6e75         if not nu
+00010390: 6c6c 7772 6974 653a 0a20 2020 2020 2020  llwrite:.       
+000103a0: 2020 2020 2066 6469 7220 3d20 7666 732e       fdir = vfs.
+000103b0: 6361 6e6f 6e69 6361 6c28 7265 6d29 0a20  canonical(rem). 
+000103c0: 2020 2020 2020 2020 2020 2066 6e20 3d20             fn = 
+000103d0: 6f73 2e70 6174 682e 6a6f 696e 2866 6469  os.path.join(fdi
+000103e0: 722c 2073 616e 6974 697a 6564 290a 0a20  r, sanitized).. 
+000103f0: 2020 2020 2020 2020 2020 2069 6620 626f             if bo
+00010400: 732e 7061 7468 2e65 7869 7374 7328 666e  s.path.exists(fn
+00010410: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00010420: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
+00010430: 3530 302c 2022 7468 6174 2066 696c 6520  500, "that file 
+00010440: 6578 6973 7473 2061 6c72 6561 6479 2229  exists already")
+00010450: 0a0a 2020 2020 2020 2020 2020 2020 7769  ..            wi
+00010460: 7468 206f 7065 6e28 6673 656e 6328 666e  th open(fsenc(fn
+00010470: 292c 2022 7762 2229 2061 7320 663a 0a20  ), "wb") as f:. 
+00010480: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010490: 2e77 7269 7465 2862 2260 4752 554e 4e55  .write(b"`GRUNNU
+000104a0: 5260 5c6e 2229 0a0a 2020 2020 2020 2020  R`\n")..        
+000104b0: 7670 6174 6820 3d20 227b 7d2f 7b7d 222e  vpath = "{}/{}".
+000104c0: 666f 726d 6174 2873 656c 662e 7670 6174  format(self.vpat
+000104d0: 682c 2073 616e 6974 697a 6564 292e 6c73  h, sanitized).ls
+000104e0: 7472 6970 2822 2f22 290a 2020 2020 2020  trip("/").      
+000104f0: 2020 7365 6c66 2e72 6564 6972 6563 7428    self.redirect(
+00010500: 7670 6174 682c 2022 3f65 6469 7422 290a  vpath, "?edit").
+00010510: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00010520: 7275 650a 0a20 2020 2064 6566 2075 706c  rue..    def upl
+00010530: 6f61 645f 666c 6167 7328 7365 6c66 2c20  oad_flags(self, 
+00010540: 7666 7320 2920 2020 2020 203a 0a20 2020  vfs )      :.   
+00010550: 2020 2020 2069 6620 7365 6c66 2e61 7267       if self.arg
+00010560: 732e 6e77 3a0a 2020 2020 2020 2020 2020  s.nw:.          
+00010570: 2020 726e 6420 3d20 300a 2020 2020 2020    rnd = 0.      
+00010580: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00010590: 2020 2020 726e 6420 3d20 696e 7428 7365      rnd = int(se
+000105a0: 6c66 2e75 7061 7261 6d2e 6765 7428 2272  lf.uparam.get("r
+000105b0: 616e 6422 2920 6f72 2073 656c 662e 6865  and") or self.he
+000105c0: 6164 6572 732e 6765 7428 2272 616e 6422  aders.get("rand"
+000105d0: 2920 6f72 2030 290a 2020 2020 2020 2020  ) or 0).        
+000105e0: 2020 2020 6966 2076 6673 2e66 6c61 6773      if vfs.flags
+000105f0: 2e67 6574 2822 7261 6e64 2229 3a20 2023  .get("rand"):  #
+00010600: 2066 6f72 6365 2d65 6e61 626c 650a 2020   force-enable.  
+00010610: 2020 2020 2020 2020 2020 2020 2020 726e                rn
+00010620: 6420 3d20 6d61 7828 726e 642c 2076 6673  d = max(rnd, vfs
+00010630: 2e66 6c61 6773 5b22 6e72 616e 6422 5d29  .flags["nrand"])
+00010640: 0a0a 2020 2020 2020 2020 6163 203d 2073  ..        ac = s
+00010650: 656c 662e 7570 6172 616d 2e67 6574 280a  elf.uparam.get(.
+00010660: 2020 2020 2020 2020 2020 2020 2277 616e              "wan
+00010670: 7422 2c20 7365 6c66 2e68 6561 6465 7273  t", self.headers
+00010680: 2e67 6574 2822 6163 6365 7074 222c 2022  .get("accept", "
+00010690: 2229 2e6c 6f77 6572 2829 2e73 706c 6974  ").lower().split
+000106a0: 2822 3b22 295b 2d31 5d0a 2020 2020 2020  (";")[-1].      
+000106b0: 2020 290a 2020 2020 2020 2020 7761 6e74    ).        want
+000106c0: 5f75 726c 203d 2061 6320 3d3d 2022 7572  _url = ac == "ur
+000106d0: 6c22 0a20 2020 2020 2020 207a 7320 3d20  l".        zs = 
+000106e0: 7365 6c66 2e75 7061 7261 6d2e 6765 7428  self.uparam.get(
+000106f0: 226c 6966 6522 2c20 7365 6c66 2e68 6561  "life", self.hea
+00010700: 6465 7273 2e67 6574 2822 6c69 6665 222c  ders.get("life",
+00010710: 2022 2229 290a 2020 2020 2020 2020 6966   "")).        if
+00010720: 207a 733a 0a20 2020 2020 2020 2020 2020   zs:.           
+00010730: 2076 6c69 6665 203d 2076 6673 2e66 6c61   vlife = vfs.fla
+00010740: 6773 2e67 6574 2822 6c69 6665 7469 6d65  gs.get("lifetime
+00010750: 2229 206f 7220 300a 2020 2020 2020 2020  ") or 0.        
+00010760: 2020 2020 6c69 6665 7469 6d65 203d 206d      lifetime = m
+00010770: 6178 2830 2c20 696e 7428 766c 6966 6520  ax(0, int(vlife 
+00010780: 2d20 696e 7428 7a73 2929 290a 2020 2020  - int(zs))).    
+00010790: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000107a0: 2020 2020 2020 6c69 6665 7469 6d65 203d        lifetime =
+000107b0: 2030 0a0a 2020 2020 2020 2020 7265 7475   0..        retu
+000107c0: 726e 2028 0a20 2020 2020 2020 2020 2020  rn (.           
+000107d0: 2072 6e64 2c0a 2020 2020 2020 2020 2020   rnd,.          
+000107e0: 2020 7761 6e74 5f75 726c 2c0a 2020 2020    want_url,.    
+000107f0: 2020 2020 2020 2020 6c69 6665 7469 6d65          lifetime
+00010800: 2c0a 2020 2020 2020 2020 2020 2020 7666  ,.            vf
+00010810: 732e 666c 6167 732e 6765 7428 2278 6275  s.flags.get("xbu
+00010820: 2229 206f 7220 5b5d 2c0a 2020 2020 2020  ") or [],.      
+00010830: 2020 2020 2020 7666 732e 666c 6167 732e        vfs.flags.
+00010840: 6765 7428 2278 6175 2229 206f 7220 5b5d  get("xau") or []
+00010850: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00010860: 2064 6566 2068 616e 646c 655f 706c 6169   def handle_plai
+00010870: 6e5f 7570 6c6f 6164 2873 656c 6629 2020  n_upload(self)  
+00010880: 3a0a 2020 2020 2020 2020 6173 7365 7274  :.        assert
+00010890: 2073 656c 662e 7061 7273 6572 0a20 2020   self.parser.   
+000108a0: 2020 2020 206e 756c 6c77 7269 7465 203d       nullwrite =
+000108b0: 2073 656c 662e 6172 6773 2e6e 770a 2020   self.args.nw.  
+000108c0: 2020 2020 2020 7666 732c 2072 656d 203d        vfs, rem =
+000108d0: 2073 656c 662e 6173 7276 2e76 6673 2e67   self.asrv.vfs.g
+000108e0: 6574 2873 656c 662e 7670 6174 682c 2073  et(self.vpath, s
+000108f0: 656c 662e 756e 616d 652c 2046 616c 7365  elf.uname, False
+00010900: 2c20 5472 7565 290a 2020 2020 2020 2020  , True).        
+00010910: 7365 6c66 2e5f 6173 7365 7274 5f73 6166  self._assert_saf
+00010920: 655f 7265 6d28 7265 6d29 0a0a 2020 2020  e_rem(rem)..    
+00010930: 2020 2020 7570 6c6f 6164 5f76 7061 7468      upload_vpath
+00010940: 203d 2073 656c 662e 7670 6174 680a 2020   = self.vpath.  
+00010950: 2020 2020 2020 6c69 6d20 3d20 7666 732e        lim = vfs.
+00010960: 6765 745f 6462 7628 7265 6d29 5b30 5d2e  get_dbv(rem)[0].
+00010970: 6c69 6d0a 2020 2020 2020 2020 6664 6972  lim.        fdir
+00010980: 5f62 6173 6520 3d20 7666 732e 6361 6e6f  _base = vfs.cano
+00010990: 6e69 6361 6c28 7265 6d29 0a20 2020 2020  nical(rem).     
+000109a0: 2020 2069 6620 6c69 6d3a 0a20 2020 2020     if lim:.     
+000109b0: 2020 2020 2020 2066 6469 725f 6261 7365         fdir_base
+000109c0: 2c20 7265 6d20 3d20 6c69 6d2e 616c 6c28  , rem = lim.all(
+000109d0: 7365 6c66 2e69 702c 2072 656d 2c20 2d31  self.ip, rem, -1
+000109e0: 2c20 6664 6972 5f62 6173 6529 0a20 2020  , fdir_base).   
+000109f0: 2020 2020 2020 2020 2075 706c 6f61 645f           upload_
+00010a00: 7670 6174 6820 3d20 227b 7d2f 7b7d 222e  vpath = "{}/{}".
+00010a10: 666f 726d 6174 2876 6673 2e76 7061 7468  format(vfs.vpath
+00010a20: 2c20 7265 6d29 2e73 7472 6970 2822 2f22  , rem).strip("/"
+00010a30: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00010a40: 206e 6f74 206e 756c 6c77 7269 7465 3a0a   not nullwrite:.
+00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a60: 626f 732e 6d61 6b65 6469 7273 2866 6469  bos.makedirs(fdi
+00010a70: 725f 6261 7365 290a 0a20 2020 2020 2020  r_base)..       
+00010a80: 2072 6e64 2c20 7761 6e74 5f75 726c 2c20   rnd, want_url, 
+00010a90: 6c69 6665 7469 6d65 2c20 7862 752c 2078  lifetime, xbu, x
+00010aa0: 6175 203d 2073 656c 662e 7570 6c6f 6164  au = self.upload
+00010ab0: 5f66 6c61 6773 2876 6673 290a 0a20 2020  _flags(vfs)..   
+00010ac0: 2020 2020 2066 696c 6573 2020 2020 2020       files      
+00010ad0: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
+00010ae0: 737a 2c20 7368 615f 6865 782c 2073 6861  sz, sha_hex, sha
+00010af0: 5f62 3634 2c20 705f 6669 6c65 2c20 666e  _b64, p_file, fn
+00010b00: 616d 652c 2061 6273 7061 7468 0a20 2020  ame, abspath.   
+00010b10: 2020 2020 2065 7272 6d73 6720 3d20 2222       errmsg = ""
+00010b20: 0a20 2020 2020 2020 2064 6970 203d 2073  .        dip = s
+00010b30: 656c 662e 6469 7028 290a 2020 2020 2020  elf.dip().      
+00010b40: 2020 7430 203d 2074 696d 652e 7469 6d65    t0 = time.time
+00010b50: 2829 0a20 2020 2020 2020 2074 7279 3a0a  ().        try:.
+00010b60: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00010b70: 7274 2073 656c 662e 7061 7273 6572 2e67  rt self.parser.g
+00010b80: 656e 0a20 2020 2020 2020 2020 2020 2066  en.            f
+00010b90: 6f72 206e 6669 6c65 2c20 2870 5f66 6965  or nfile, (p_fie
+00010ba0: 6c64 2c20 705f 6669 6c65 2c20 705f 6461  ld, p_file, p_da
+00010bb0: 7461 2920 696e 2065 6e75 6d65 7261 7465  ta) in enumerate
+00010bc0: 2873 656c 662e 7061 7273 6572 2e67 656e  (self.parser.gen
+00010bd0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00010be0: 2020 2069 6620 6e6f 7420 705f 6669 6c65     if not p_file
+00010bf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010c00: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
+00010c10: 6469 7363 6172 6469 6e67 2069 6e63 6f6d  discarding incom
+00010c20: 696e 6720 6669 6c65 2077 6974 686f 7574  ing file without
+00010c30: 2066 696c 656e 616d 6522 290a 2020 2020   filename").    
+00010c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c50: 2320 6661 6c6c 7468 726f 7567 680a 0a20  # fallthrough.. 
+00010c60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010c70: 6469 7220 3d20 6664 6972 5f62 6173 650a  dir = fdir_base.
+00010c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c90: 666e 616d 6520 3d20 7361 6e69 7469 7a65  fname = sanitize
+00010ca0: 5f66 6e28 0a20 2020 2020 2020 2020 2020  _fn(.           
+00010cb0: 2020 2020 2020 2020 2070 5f66 696c 6520           p_file 
+00010cc0: 6f72 2022 222c 2022 222c 205b 222e 7072  or "", "", [".pr
+00010cd0: 6f6c 6f67 7565 2e68 746d 6c22 2c20 222e  ologue.html", ".
+00010ce0: 6570 696c 6f67 7565 2e68 746d 6c22 5d0a  epilogue.html"].
 00010cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d00: 2020 2020 2020 7632 203d 206c 696d 2e64        v2 = lim.d
-00010d10: 6676 202d 206c 696d 2e64 666c 0a20 2020  fv - lim.dfl.   
-00010d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d30: 2020 2020 206d 6178 5f73 7a20 3d20 6d69       max_sz = mi
-00010d40: 6e28 7631 2c20 7632 2920 6966 2076 3120  n(v1, v2) if v1 
-00010d50: 616e 6420 7632 2065 6c73 6520 7631 206f  and v2 else v1 o
-00010d60: 7220 7632 0a0a 2020 2020 2020 2020 2020  r v2..          
-00010d70: 2020 2020 2020 2020 2020 7769 7468 2072            with r
-00010d80: 656e 5f6f 7065 6e28 746e 616d 2c20 2277  en_open(tnam, "w
-00010d90: 6222 2c20 3531 3220 2a20 3130 3234 2c20  b", 512 * 1024, 
-00010da0: 2a2a 6f70 656e 5f61 7267 7329 2061 7320  **open_args) as 
-00010db0: 7a66 773a 0a20 2020 2020 2020 2020 2020  zfw:.           
-00010dc0: 2020 2020 2020 2020 2020 2020 2066 2c20               f, 
-00010dd0: 746e 616d 203d 207a 6677 5b22 6f72 7a22  tnam = zfw["orz"
-00010de0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00010df0: 2020 2020 2020 2020 2020 7461 6273 7061            tabspa
-00010e00: 7468 203d 206f 732e 7061 7468 2e6a 6f69  th = os.path.joi
-00010e10: 6e28 6664 6972 2c20 746e 616d 290a 2020  n(fdir, tnam).  
-00010e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e30: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
-00010e40: 7772 6974 696e 6720 746f 207b 7d22 2e66  writing to {}".f
-00010e50: 6f72 6d61 7428 7461 6273 7061 7468 2929  ormat(tabspath))
-00010e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010e70: 2020 2020 2020 2020 2073 7a2c 2073 6861           sz, sha
-00010e80: 5f68 6578 2c20 7368 615f 6236 3420 3d20  _hex, sha_b64 = 
-00010e90: 6861 7368 636f 7079 280a 2020 2020 2020  hashcopy(.      
-00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010eb0: 2020 2020 2020 705f 6461 7461 2c20 662c        p_data, f,
-00010ec0: 2073 656c 662e 6172 6773 2e73 5f77 725f   self.args.s_wr_
-00010ed0: 736c 702c 206d 6178 5f73 7a0a 2020 2020  slp, max_sz.    
-00010ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ef0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00010f00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00010f10: 2073 7a20 3d3d 2030 3a0a 2020 2020 2020   sz == 0:.      
-00010f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f30: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
-00010f40: 6163 2834 3030 2c20 2265 6d70 7479 2066  ac(400, "empty f
-00010f50: 696c 6573 2069 6e20 706f 7374 2229 0a0a  iles in post")..
-00010f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f70: 2020 2020 6966 206c 696d 3a0a 2020 2020      if lim:.    
-00010f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f90: 2020 2020 6c69 6d2e 6e75 7028 7365 6c66      lim.nup(self
-00010fa0: 2e69 7029 0a20 2020 2020 2020 2020 2020  .ip).           
-00010fb0: 2020 2020 2020 2020 2020 2020 206c 696d               lim
-00010fc0: 2e62 7570 2873 656c 662e 6970 2c20 737a  .bup(self.ip, sz
-00010fd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00010fe0: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-00010ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011000: 2020 2020 2020 2020 2020 206c 696d 2e63             lim.c
-00011010: 686b 5f64 6628 7461 6273 7061 7468 2c20  hk_df(tabspath, 
-00011020: 737a 2c20 5472 7565 290a 2020 2020 2020  sz, True).      
+00010d00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00010d10: 2020 6966 2070 5f66 696c 6520 616e 6420    if p_file and 
+00010d20: 6e6f 7420 6e75 6c6c 7772 6974 653a 0a20  not nullwrite:. 
+00010d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d40: 2020 2069 6620 726e 643a 0a20 2020 2020     if rnd:.     
+00010d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d60: 2020 2066 6e61 6d65 203d 2072 616e 645f     fname = rand_
+00010d70: 6e61 6d65 2866 6469 722c 2066 6e61 6d65  name(fdir, fname
+00010d80: 2c20 726e 6429 0a0a 2020 2020 2020 2020  , rnd)..        
+00010d90: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00010da0: 6f74 2062 6f73 2e70 6174 682e 6973 6469  ot bos.path.isdi
+00010db0: 7228 6664 6972 293a 0a20 2020 2020 2020  r(fdir):.       
+00010dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010dd0: 2072 6169 7365 2050 6562 6b61 6328 3430   raise Pebkac(40
+00010de0: 342c 2022 7468 6174 2066 6f6c 6465 7220  4, "that folder 
+00010df0: 646f 6573 206e 6f74 2065 7869 7374 2229  does not exist")
+00010e00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010e10: 2020 2020 2020 7375 6666 6978 203d 2022        suffix = "
+00010e20: 2d7b 3a2e 3666 7d2d 7b7d 222e 666f 726d  -{:.6f}-{}".form
+00010e30: 6174 2874 696d 652e 7469 6d65 2829 2c20  at(time.time(), 
+00010e40: 6469 7029 0a20 2020 2020 2020 2020 2020  dip).           
+00010e50: 2020 2020 2020 2020 206f 7065 6e5f 6172           open_ar
+00010e60: 6773 203d 207b 2266 6469 7222 3a20 6664  gs = {"fdir": fd
+00010e70: 6972 2c20 2273 7566 6669 7822 3a20 7375  ir, "suffix": su
+00010e80: 6666 6978 7d0a 0a20 2020 2020 2020 2020  ffix}..         
+00010e90: 2020 2020 2020 2020 2020 2023 2072 6573             # res
+00010ea0: 6572 7665 2064 6573 7469 6e61 7469 6f6e  erve destination
+00010eb0: 2066 696c 656e 616d 650a 2020 2020 2020   filename.      
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00010ed0: 7468 2072 656e 5f6f 7065 6e28 666e 616d  th ren_open(fnam
+00010ee0: 652c 2022 7762 222c 2066 6469 723d 6664  e, "wb", fdir=fd
+00010ef0: 6972 2c20 7375 6666 6978 3d73 7566 6669  ir, suffix=suffi
+00010f00: 7829 2061 7320 7a66 773a 0a20 2020 2020  x) as zfw:.     
+00010f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f20: 2020 2066 6e61 6d65 203d 207a 6677 5b22     fname = zfw["
+00010f30: 6f72 7a22 5d5b 315d 0a0a 2020 2020 2020  orz"][1]..      
+00010f40: 2020 2020 2020 2020 2020 2020 2020 746e                tn
+00010f50: 616d 203d 2066 6e61 6d65 202b 2022 2e50  am = fname + ".P
+00010f60: 4152 5449 414c 220a 2020 2020 2020 2020  ARTIAL".        
+00010f70: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00010f80: 656c 662e 6172 6773 2e64 6f74 7061 7274  elf.args.dotpart
+00010f90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010fa0: 2020 2020 2020 2020 2020 746e 616d 203d            tnam =
+00010fb0: 2022 2e22 202b 2074 6e61 6d0a 0a20 2020   "." + tnam..   
+00010fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010fd0: 2061 6273 7061 7468 203d 206f 732e 7061   abspath = os.pa
+00010fe0: 7468 2e6a 6f69 6e28 6664 6972 2c20 666e  th.join(fdir, fn
+00010ff0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+00011000: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00011010: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00011020: 7065 6e5f 6172 6773 203d 207b 7d0a 2020  pen_args = {}.  
 00011030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011040: 2020 2020 2020 6c69 6d2e 6368 6b5f 737a        lim.chk_sz
-00011050: 2873 7a29 0a20 2020 2020 2020 2020 2020  (sz).           
+00011040: 2020 746e 616d 203d 2066 6e61 6d65 203d    tnam = fname =
+00011050: 206f 732e 6465 766e 756c 6c0a 2020 2020   os.devnull.    
 00011060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011070: 206c 696d 2e63 686b 5f62 7570 2873 656c   lim.chk_bup(sel
-00011080: 662e 6970 290a 2020 2020 2020 2020 2020  f.ip).          
-00011090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000110a0: 2020 6c69 6d2e 6368 6b5f 6e75 7028 7365    lim.chk_nup(se
-000110b0: 6c66 2e69 7029 0a20 2020 2020 2020 2020  lf.ip).         
-000110c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000110d0: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-000110e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000110f0: 2020 2069 6620 6e6f 7420 6e75 6c6c 7772     if not nullwr
-00011100: 6974 653a 0a20 2020 2020 2020 2020 2020  ite:.           
-00011110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011120: 2020 2020 2062 6f73 2e75 6e6c 696e 6b28       bos.unlink(
-00011130: 7461 6273 7061 7468 290a 2020 2020 2020  tabspath).      
-00011140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011150: 2020 2020 2020 2020 2020 626f 732e 756e            bos.un
-00011160: 6c69 6e6b 2861 6273 7061 7468 290a 2020  link(abspath).  
-00011170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011180: 2020 2020 2020 2020 2020 666e 616d 6520            fname 
-00011190: 3d20 6f73 2e64 6576 6e75 6c6c 0a20 2020  = os.devnull.   
+00011070: 6664 6972 203d 2061 6273 7061 7468 203d  fdir = abspath =
+00011080: 2022 220a 0a20 2020 2020 2020 2020 2020   ""..           
+00011090: 2020 2020 2069 6620 7862 753a 0a20 2020       if xbu:.   
+000110a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110b0: 2061 7420 3d20 7469 6d65 2e74 696d 6528   at = time.time(
+000110c0: 2920 2d20 6c69 6665 7469 6d65 0a20 2020  ) - lifetime.   
+000110d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000110e0: 2069 6620 6e6f 7420 7275 6e68 6f6f 6b28   if not runhook(
+000110f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011100: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00011110: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00011120: 2020 2020 2020 2020 2020 2078 6275 2c0a             xbu,.
+00011130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011140: 2020 2020 2020 2020 6162 7370 6174 682c          abspath,
+00011150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011160: 2020 2020 2020 2020 2073 656c 662e 7670           self.vp
+00011170: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+00011180: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00011190: 662e 686f 7374 2c0a 2020 2020 2020 2020  f.host,.        
 000111a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000111b0: 2020 2020 2020 2020 2072 6169 7365 0a0a           raise..
+000111b0: 7365 6c66 2e75 6e61 6d65 2c0a 2020 2020  self.uname,.    
 000111c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000111d0: 2020 2020 6966 206e 6f74 206e 756c 6c77      if not nullw
-000111e0: 7269 7465 3a0a 2020 2020 2020 2020 2020  rite:.          
-000111f0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-00011200: 6f6d 6963 5f6d 6f76 6528 7461 6273 7061  omic_move(tabspa
-00011210: 7468 2c20 6162 7370 6174 6829 0a0a 2020  th, abspath)..  
-00011220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011230: 2020 6669 6c65 732e 6170 7065 6e64 280a    files.append(.
-00011240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011250: 2020 2020 2020 2020 2873 7a2c 2073 6861          (sz, sha
-00011260: 5f68 6578 2c20 7368 615f 6236 342c 2070  _hex, sha_b64, p
-00011270: 5f66 696c 6520 6f72 2022 2864 6973 6361  _file or "(disca
-00011280: 7264 6564 2922 2c20 666e 616d 652c 2061  rded)", fname, a
-00011290: 6273 7061 7468 290a 2020 2020 2020 2020  bspath).        
-000112a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000112b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112c0: 2020 6174 203d 2074 696d 652e 7469 6d65    at = time.time
-000112d0: 2829 202d 206c 6966 6574 696d 650a 2020  () - lifetime.  
-000112e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112f0: 2020 6966 2078 6175 2061 6e64 206e 6f74    if xau and not
-00011300: 2072 756e 686f 6f6b 280a 2020 2020 2020   runhook(.      
-00011310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011320: 2020 7365 6c66 2e6c 6f67 2c0a 2020 2020    self.log,.    
-00011330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011340: 2020 2020 7861 752c 0a20 2020 2020 2020      xau,.       
-00011350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011360: 2061 6273 7061 7468 2c0a 2020 2020 2020   abspath,.      
-00011370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011380: 2020 7365 6c66 2e76 7061 7468 2c0a 2020    self.vpath,.  
-00011390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000113a0: 2020 2020 2020 7365 6c66 2e68 6f73 742c        self.host,
-000113b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000113c0: 2020 2020 2020 2020 2073 656c 662e 756e           self.un
-000113d0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-000113e0: 2020 2020 2020 2020 2020 2020 2061 742c               at,
-000113f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011400: 2020 2020 2020 2020 2073 7a2c 0a20 2020           sz,.   
+000111d0: 2020 2020 6174 2c0a 2020 2020 2020 2020      at,.        
+000111e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000111f0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
+00011200: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011210: 6970 2c0a 2020 2020 2020 2020 2020 2020  ip,.            
+00011220: 2020 2020 2020 2020 2020 2020 6174 2c0a              at,.
+00011230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011240: 2020 2020 2020 2020 2222 2c0a 2020 2020          "",.    
+00011250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011260: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00011270: 2020 2020 2020 2020 2020 2074 203d 2022             t = "
+00011280: 7570 6c6f 6164 2062 6c6f 636b 6564 2062  upload blocked b
+00011290: 7920 7862 7520 7365 7276 6572 2063 6f6e  y xbu server con
+000112a0: 6669 6722 0a20 2020 2020 2020 2020 2020  fig".           
+000112b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000112c0: 662e 6c6f 6728 742c 2031 290a 2020 2020  f.log(t, 1).    
+000112d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112e0: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+000112f0: 2834 3033 2c20 7429 0a0a 2020 2020 2020  (403, t)..      
+00011300: 2020 2020 2020 2020 2020 6966 206c 696d            if lim
+00011310: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011320: 2020 2020 2020 6c69 6d2e 6368 6b5f 6275        lim.chk_bu
+00011330: 7028 7365 6c66 2e69 7029 0a20 2020 2020  p(self.ip).     
+00011340: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00011350: 696d 2e63 686b 5f6e 7570 2873 656c 662e  im.chk_nup(self.
+00011360: 6970 290a 0a20 2020 2020 2020 2020 2020  ip)..           
+00011370: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+00011380: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00011390: 785f 737a 203d 2030 0a20 2020 2020 2020  x_sz = 0.       
+000113a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000113b0: 6c69 6d3a 0a20 2020 2020 2020 2020 2020  lim:.           
+000113c0: 2020 2020 2020 2020 2020 2020 2076 3120               v1 
+000113d0: 3d20 6c69 6d2e 736d 6178 0a20 2020 2020  = lim.smax.     
+000113e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000113f0: 2020 2076 3220 3d20 6c69 6d2e 6466 7620     v2 = lim.dfv 
+00011400: 2d20 6c69 6d2e 6466 6c0a 2020 2020 2020  - lim.dfl.      
 00011410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011420: 2020 2020 2073 656c 662e 6970 2c0a 2020       self.ip,.  
-00011430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011440: 2020 2020 2020 6174 2c0a 2020 2020 2020        at,.      
-00011450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011460: 2020 2222 2c0a 2020 2020 2020 2020 2020    "",.          
-00011470: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
-00011480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011490: 2020 2020 2074 203d 2022 7570 6c6f 6164       t = "upload
-000114a0: 2062 6c6f 636b 6564 2062 7920 7861 7520   blocked by xau 
-000114b0: 7365 7276 6572 2063 6f6e 6669 6722 0a20  server config". 
-000114c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114d0: 2020 2020 2020 2073 656c 662e 6c6f 6728         self.log(
-000114e0: 742c 2031 290a 2020 2020 2020 2020 2020  t, 1).          
-000114f0: 2020 2020 2020 2020 2020 2020 2020 6f73                os
-00011500: 2e75 6e6c 696e 6b28 6162 7370 6174 6829  .unlink(abspath)
-00011510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011520: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-00011530: 6562 6b61 6328 3430 332c 2074 290a 0a20  ebkac(403, t).. 
-00011540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011550: 2020 2064 6276 2c20 7672 656d 203d 2076     dbv, vrem = v
-00011560: 6673 2e67 6574 5f64 6276 2872 656d 290a  fs.get_dbv(rem).
-00011570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011580: 2020 2020 7365 6c66 2e63 6f6e 6e2e 6873      self.conn.hs
-00011590: 7276 2e62 726f 6b65 722e 7361 7928 0a20  rv.broker.say(. 
-000115a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115b0: 2020 2020 2020 2022 7570 326b 2e68 6173         "up2k.has
-000115c0: 685f 6669 6c65 222c 0a20 2020 2020 2020  h_file",.       
+00011420: 2020 6d61 785f 737a 203d 206d 696e 2876    max_sz = min(v
+00011430: 312c 2076 3229 2069 6620 7631 2061 6e64  1, v2) if v1 and
+00011440: 2076 3220 656c 7365 2076 3120 6f72 2076   v2 else v1 or v
+00011450: 320a 0a20 2020 2020 2020 2020 2020 2020  2..             
+00011460: 2020 2020 2020 2077 6974 6820 7265 6e5f         with ren_
+00011470: 6f70 656e 2874 6e61 6d2c 2022 7762 222c  open(tnam, "wb",
+00011480: 2035 3132 202a 2031 3032 342c 202a 2a6f   512 * 1024, **o
+00011490: 7065 6e5f 6172 6773 2920 6173 207a 6677  pen_args) as zfw
+000114a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000114b0: 2020 2020 2020 2020 2020 662c 2074 6e61            f, tna
+000114c0: 6d20 3d20 7a66 775b 226f 727a 225d 0a20  m = zfw["orz"]. 
+000114d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114e0: 2020 2020 2020 2074 6162 7370 6174 6820         tabspath 
+000114f0: 3d20 6f73 2e70 6174 682e 6a6f 696e 2866  = os.path.join(f
+00011500: 6469 722c 2074 6e61 6d29 0a20 2020 2020  dir, tnam).     
+00011510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011520: 2020 2073 656c 662e 6c6f 6728 2277 7269     self.log("wri
+00011530: 7469 6e67 2074 6f20 7b7d 222e 666f 726d  ting to {}".form
+00011540: 6174 2874 6162 7370 6174 6829 290a 2020  at(tabspath)).  
+00011550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011560: 2020 2020 2020 737a 2c20 7368 615f 6865        sz, sha_he
+00011570: 782c 2073 6861 5f62 3634 203d 2068 6173  x, sha_b64 = has
+00011580: 6863 6f70 7928 0a20 2020 2020 2020 2020  hcopy(.         
+00011590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115a0: 2020 2070 5f64 6174 612c 2066 2c20 7365     p_data, f, se
+000115b0: 6c66 2e61 7267 732e 735f 7772 5f73 6c70  lf.args.s_wr_slp
+000115c0: 2c20 6d61 785f 737a 0a20 2020 2020 2020  , max_sz.       
 000115d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000115e0: 2064 6276 2e72 6561 6c70 6174 682c 0a20   dbv.realpath,. 
-000115f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011600: 2020 2020 2020 2076 6673 2e76 7061 7468         vfs.vpath
-00011610: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011620: 2020 2020 2020 2020 2020 6462 762e 666c            dbv.fl
-00011630: 6167 732c 0a20 2020 2020 2020 2020 2020  ags,.           
-00011640: 2020 2020 2020 2020 2020 2020 2076 7265               vre
-00011650: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-00011660: 2020 2020 2020 2020 2020 2066 6e61 6d65             fname
-00011670: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011680: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-00011690: 702c 0a20 2020 2020 2020 2020 2020 2020  p,.             
-000116a0: 2020 2020 2020 2020 2020 2061 742c 0a20             at,. 
-000116b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116c0: 2020 2020 2020 2073 656c 662e 756e 616d         self.unam
-000116d0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-000116e0: 2020 2020 2020 2020 2020 2054 7275 652c             True,
-000116f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011700: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00011710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011720: 636f 6e6e 2e6e 6279 7465 202b 3d20 737a  conn.nbyte += sz
-00011730: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011740: 2020 6578 6365 7074 2050 6562 6b61 633a    except Pebkac:
-00011750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011760: 2020 2020 2073 656c 662e 7061 7273 6572       self.parser
-00011770: 2e64 726f 7028 290a 2020 2020 2020 2020  .drop().        
-00011780: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00011790: 650a 0a20 2020 2020 2020 2065 7863 6570  e..        excep
-000117a0: 7420 5065 626b 6163 2061 7320 6578 3a0a  t Pebkac as ex:.
-000117b0: 2020 2020 2020 2020 2020 2020 6572 726d              errm
-000117c0: 7367 203d 2076 6f6c 5f73 616e 280a 2020  sg = vol_san(.  
-000117d0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-000117e0: 7374 2873 656c 662e 6173 7276 2e76 6673  st(self.asrv.vfs
-000117f0: 2e61 6c6c 5f76 6f6c 732e 7661 6c75 6573  .all_vols.values
-00011800: 2829 292c 2075 6e69 636f 6465 2865 7829  ()), unicode(ex)
-00011810: 2e65 6e63 6f64 6528 2275 7466 2d38 2229  .encode("utf-8")
-00011820: 0a20 2020 2020 2020 2020 2020 2029 2e64  .            ).d
-00011830: 6563 6f64 6528 2275 7466 2d38 2229 0a0a  ecode("utf-8")..
-00011840: 2020 2020 2020 2020 7464 203d 206d 6178          td = max
-00011850: 2830 2e31 2c20 7469 6d65 2e74 696d 6528  (0.1, time.time(
-00011860: 2920 2d20 7430 290a 2020 2020 2020 2020  ) - t0).        
-00011870: 737a 5f74 6f74 616c 203d 2073 756d 2878  sz_total = sum(x
-00011880: 5b30 5d20 666f 7220 7820 696e 2066 696c  [0] for x in fil
-00011890: 6573 290a 2020 2020 2020 2020 7370 6420  es).        spd 
-000118a0: 3d20 2873 7a5f 746f 7461 6c20 2f20 7464  = (sz_total / td
-000118b0: 2920 2f20 2831 3032 3420 2a20 3130 3234  ) / (1024 * 1024
-000118c0: 290a 0a20 2020 2020 2020 2073 7461 7475  )..        statu
-000118d0: 7320 3d20 224f 4b22 0a20 2020 2020 2020  s = "OK".       
-000118e0: 2069 6620 6572 726d 7367 3a0a 2020 2020   if errmsg:.    
-000118f0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00011900: 2865 7272 6d73 672c 2033 290a 2020 2020  (errmsg, 3).    
-00011910: 2020 2020 2020 2020 7374 6174 7573 203d          status =
-00011920: 2022 4552 524f 5222 0a0a 2020 2020 2020   "ERROR"..      
-00011930: 2020 6d73 6720 3d20 227b 7d20 2f2f 207b    msg = "{} // {
-00011940: 7d20 6279 7465 7320 2f2f 207b 3a2e 3366  } bytes // {:.3f
-00011950: 7d20 4d69 422f 735c 6e22 2e66 6f72 6d61  } MiB/s\n".forma
-00011960: 7428 7374 6174 7573 2c20 737a 5f74 6f74  t(status, sz_tot
-00011970: 616c 2c20 7370 6429 0a20 2020 2020 2020  al, spd).       
-00011980: 206a 6d73 6720 2020 3d20 7b0a 2020 2020   jmsg   = {.    
-00011990: 2020 2020 2020 2020 2273 7461 7475 7322          "status"
-000119a0: 3a20 7374 6174 7573 2c0a 2020 2020 2020  : status,.      
-000119b0: 2020 2020 2020 2273 7a22 3a20 737a 5f74        "sz": sz_t
-000119c0: 6f74 616c 2c0a 2020 2020 2020 2020 2020  otal,.          
-000119d0: 2020 226d 6270 7322 3a20 726f 756e 6428    "mbps": round(
-000119e0: 7370 642c 2033 292c 0a20 2020 2020 2020  spd, 3),.       
-000119f0: 2020 2020 2022 6669 6c65 7322 3a20 5b5d       "files": []
-00011a00: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-00011a10: 2020 2020 2069 6620 6572 726d 7367 3a0a       if errmsg:.
-00011a20: 2020 2020 2020 2020 2020 2020 6d73 6720              msg 
-00011a30: 2b3d 2065 7272 6d73 6720 2b20 225c 6e22  += errmsg + "\n"
-00011a40: 0a20 2020 2020 2020 2020 2020 206a 6d73  .            jms
-00011a50: 675b 2265 7272 6f72 225d 203d 2065 7272  g["error"] = err
-00011a60: 6d73 670a 2020 2020 2020 2020 2020 2020  msg.            
-00011a70: 6572 726d 7367 203d 2022 4552 524f 523a  errmsg = "ERROR:
-00011a80: 2022 202b 2065 7272 6d73 670a 0a20 2020   " + errmsg..   
-00011a90: 2020 2020 2066 6f72 2073 7a2c 2073 6861       for sz, sha
-00011aa0: 5f68 6578 2c20 7368 615f 6236 342c 206f  _hex, sha_b64, o
-00011ab0: 666e 2c20 6c66 6e2c 2061 7020 696e 2066  fn, lfn, ap in f
-00011ac0: 696c 6573 3a0a 2020 2020 2020 2020 2020  iles:.          
-00011ad0: 2020 7673 7566 203d 2022 220a 2020 2020    vsuf = "".    
-00011ae0: 2020 2020 2020 2020 6966 2028 7365 6c66          if (self
-00011af0: 2e63 616e 5f72 6561 6420 6f72 2073 656c  .can_read or sel
-00011b00: 662e 6361 6e5f 7570 6765 7429 2061 6e64  f.can_upget) and
-00011b10: 2022 666b 2220 696e 2076 6673 2e66 6c61   "fk" in vfs.fla
-00011b20: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00011b30: 2020 2020 7673 7566 203d 2022 3f6b 3d22      vsuf = "?k="
-00011b40: 202b 2073 656c 662e 6765 6e5f 666b 280a   + self.gen_fk(.
-00011b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011b60: 2020 2020 7365 6c66 2e61 7267 732e 666b      self.args.fk
-00011b70: 5f73 616c 742c 0a20 2020 2020 2020 2020  _salt,.         
-00011b80: 2020 2020 2020 2020 2020 2061 702c 0a20             ap,. 
-00011b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ba0: 2020 2073 7a2c 0a20 2020 2020 2020 2020     sz,.         
-00011bb0: 2020 2020 2020 2020 2020 2030 2069 6620             0 if 
-00011bc0: 414e 5957 494e 206f 7220 6e6f 7420 6170  ANYWIN or not ap
-00011bd0: 2065 6c73 6520 626f 732e 7374 6174 2861   else bos.stat(a
-00011be0: 7029 2e73 745f 696e 6f2c 0a20 2020 2020  p).st_ino,.     
-00011bf0: 2020 2020 2020 2020 2020 2029 5b3a 2076             )[: v
-00011c00: 6673 2e66 6c61 6773 5b22 666b 225d 5d0a  fs.flags["fk"]].
-00011c10: 0a20 2020 2020 2020 2020 2020 2076 7061  .            vpa
-00011c20: 7468 203d 2022 7b7d 2f7b 7d22 2e66 6f72  th = "{}/{}".for
-00011c30: 6d61 7428 7570 6c6f 6164 5f76 7061 7468  mat(upload_vpath
-00011c40: 2c20 6c66 6e29 2e73 7472 6970 2822 2f22  , lfn).strip("/"
-00011c50: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00011c60: 6c5f 7572 6c20 3d20 7175 6f74 6570 2873  l_url = quotep(s
-00011c70: 656c 662e 6172 6773 2e52 5320 2b20 7670  elf.args.RS + vp
-00011c80: 6174 6829 202b 2076 7375 660a 2020 2020  ath) + vsuf.    
-00011c90: 2020 2020 2020 2020 6d73 6720 2b3d 2027          msg += '
-00011ca0: 7368 6135 3132 3a20 7b7d 202f 2f20 7b7d  sha512: {} // {}
-00011cb0: 202f 2f20 7b7d 2062 7974 6573 202f 2f20   // {} bytes // 
-00011cc0: 3c61 2068 7265 663d 222f 7b7d 223e 7b7d  <a href="/{}">{}
-00011cd0: 3c2f 613e 207b 7d5c 6e27 2e66 6f72 6d61  </a> {}\n'.forma
-00011ce0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00011cf0: 2020 2073 6861 5f68 6578 5b3a 3536 5d2c     sha_hex[:56],
-00011d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011d10: 2073 6861 5f62 3634 2c0a 2020 2020 2020   sha_b64,.      
-00011d20: 2020 2020 2020 2020 2020 737a 2c0a 2020            sz,.  
-00011d30: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00011d40: 6c5f 7572 6c2c 0a20 2020 2020 2020 2020  l_url,.         
-00011d50: 2020 2020 2020 2068 746d 6c5f 6573 6361         html_esca
-00011d60: 7065 286f 666e 2c20 6372 6c66 3d54 7275  pe(ofn, crlf=Tru
-00011d70: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
-00011d80: 2020 2020 7673 7566 2c0a 2020 2020 2020      vsuf,.      
-00011d90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00011da0: 2020 2020 2320 7472 756e 6361 7465 6420      # truncated 
-00011db0: 5348 412d 3531 3220 7072 6576 656e 7473  SHA-512 prevents
-00011dc0: 206c 656e 6774 6820 6578 7465 6e73 696f   length extensio
-00011dd0: 6e20 6174 7461 636b 733b 0a20 2020 2020  n attacks;.     
-00011de0: 2020 2020 2020 2023 2075 7369 6e67 2053         # using S
-00011df0: 4841 2d35 3132 2f32 3234 2c20 6f70 7469  HA-512/224, opti
-00011e00: 6f6e 616c 6c79 2053 4841 2d35 3132 2f32  onally SHA-512/2
-00011e10: 3536 203d 203a 3634 0a20 2020 2020 2020  56 = :64.       
-00011e20: 2020 2020 206a 7061 7274 203d 207b 0a20       jpart = {. 
-00011e30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011e40: 7572 6c22 3a20 227b 7d3a 2f2f 7b7d 2f7b  url": "{}://{}/{
-00011e50: 7d22 2e66 6f72 6d61 7428 0a20 2020 2020  }".format(.     
-00011e60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00011e70: 6874 7470 7322 2069 6620 7365 6c66 2e69  https" if self.i
-00011e80: 735f 6874 7470 7320 656c 7365 2022 6874  s_https else "ht
-00011e90: 7470 222c 0a20 2020 2020 2020 2020 2020  tp",.           
-00011ea0: 2020 2020 2020 2020 2073 656c 662e 686f           self.ho
-00011eb0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00011ec0: 2020 2020 2020 2020 7265 6c5f 7572 6c2c          rel_url,
-00011ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011ee0: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00011ef0: 2020 2020 2273 6861 3531 3222 3a20 7368      "sha512": sh
-00011f00: 615f 6865 785b 3a35 365d 2c0a 2020 2020  a_hex[:56],.    
-00011f10: 2020 2020 2020 2020 2020 2020 2273 6861              "sha
-00011f20: 5f62 3634 223a 2073 6861 5f62 3634 2c0a  _b64": sha_b64,.
-00011f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f40: 2273 7a22 3a20 737a 2c0a 2020 2020 2020  "sz": sz,.      
-00011f50: 2020 2020 2020 2020 2020 2266 6e22 3a20            "fn": 
-00011f60: 6c66 6e2c 0a20 2020 2020 2020 2020 2020  lfn,.           
-00011f70: 2020 2020 2022 666e 5f6f 7269 6722 3a20       "fn_orig": 
-00011f80: 6f66 6e2c 0a20 2020 2020 2020 2020 2020  ofn,.           
-00011f90: 2020 2020 2022 7061 7468 223a 2072 656c       "path": rel
-00011fa0: 5f75 726c 2c0a 2020 2020 2020 2020 2020  _url,.          
-00011fb0: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00011fc0: 6a6d 7367 5b22 6669 6c65 7322 5d2e 6170  jmsg["files"].ap
-00011fd0: 7065 6e64 286a 7061 7274 290a 0a20 2020  pend(jpart)..   
-00011fe0: 2020 2020 2076 7370 6420 3d20 7365 6c66       vspd = self
-00011ff0: 2e5f 7370 6428 737a 5f74 6f74 616c 2c20  ._spd(sz_total, 
-00012000: 4661 6c73 6529 0a20 2020 2020 2020 2073  False).        s
-00012010: 656c 662e 6c6f 6728 227b 7d20 7b7d 222e  elf.log("{} {}".
-00012020: 666f 726d 6174 2876 7370 642c 206d 7367  format(vspd, msg
-00012030: 2929 0a0a 2020 2020 2020 2020 7375 6620  ))..        suf 
-00012040: 3d20 2222 0a20 2020 2020 2020 2069 6620  = "".        if 
-00012050: 6e6f 7420 6e75 6c6c 7772 6974 6520 616e  not nullwrite an
-00012060: 6420 7365 6c66 2e61 7267 732e 7772 6974  d self.args.writ
-00012070: 655f 7570 6c6f 673a 0a20 2020 2020 2020  e_uplog:.       
-00012080: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00012090: 2020 2020 2020 2020 2020 6c6f 675f 666e            log_fn
-000120a0: 203d 2022 7570 2e7b 3a2e 3666 7d2e 7478   = "up.{:.6f}.tx
-000120b0: 7422 2e66 6f72 6d61 7428 7430 290a 2020  t".format(t0).  
-000120c0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-000120d0: 7468 206f 7065 6e28 6c6f 675f 666e 2c20  th open(log_fn, 
-000120e0: 2277 6222 2920 6173 2066 3a0a 2020 2020  "wb") as f:.    
-000120f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012100: 6674 203d 2022 7b7d 3a7b 7d22 2e66 6f72  ft = "{}:{}".for
-00012110: 6d61 7428 7365 6c66 2e69 702c 2073 656c  mat(self.ip, sel
-00012120: 662e 6164 6472 5b31 5d29 0a20 2020 2020  f.addr[1]).     
-00012130: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00012140: 7420 3d20 227b 7d5c 6e7b 7d5c 6e7b 7d5c  t = "{}\n{}\n{}\
-00012150: 6e22 2e66 6f72 6d61 7428 6674 2c20 6d73  n".format(ft, ms
-00012160: 672e 7273 7472 6970 2829 2c20 6572 726d  g.rstrip(), errm
-00012170: 7367 290a 2020 2020 2020 2020 2020 2020  sg).            
-00012180: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
-00012190: 6674 2e65 6e63 6f64 6528 2275 7466 2d38  ft.encode("utf-8
-000121a0: 2229 290a 2020 2020 2020 2020 2020 2020  ")).            
-000121b0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-000121c0: 2061 7320 6578 3a0a 2020 2020 2020 2020   as ex:.        
-000121d0: 2020 2020 2020 2020 7375 6620 3d20 225c          suf = "\
-000121e0: 6e66 6169 6c65 6420 746f 2077 7269 7465  nfailed to write
-000121f0: 2074 6865 2075 706c 6f61 6420 7265 706f   the upload repo
-00012200: 7274 3a20 7b7d 222e 666f 726d 6174 2865  rt: {}".format(e
-00012210: 7829 0a0a 2020 2020 2020 2020 7363 203d  x)..        sc =
-00012220: 2034 3030 2069 6620 6572 726d 7367 2065   400 if errmsg e
-00012230: 6c73 6520 3230 310a 2020 2020 2020 2020  lse 201.        
-00012240: 6966 2077 616e 745f 7572 6c3a 0a20 2020  if want_url:.   
-00012250: 2020 2020 2020 2020 206d 7367 203d 2022           msg = "
-00012260: 5c6e 222e 6a6f 696e 285b 785b 2275 726c  \n".join([x["url
-00012270: 225d 2066 6f72 2078 2069 6e20 6a6d 7367  "] for x in jmsg
-00012280: 5b22 6669 6c65 7322 5d5d 290a 2020 2020  ["files"]]).    
-00012290: 2020 2020 2020 2020 6966 2065 7272 6d73          if errms
-000122a0: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-000122b0: 2020 206d 7367 202b 3d20 225c 6e22 202b     msg += "\n" +
-000122c0: 2065 7272 6d73 670a 0a20 2020 2020 2020   errmsg..       
-000122d0: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
-000122e0: 6d73 672e 656e 636f 6465 2822 7574 662d  msg.encode("utf-
-000122f0: 3822 2c20 2272 6570 6c61 6365 2229 2c20  8", "replace"), 
-00012300: 7374 6174 7573 3d73 6329 0a20 2020 2020  status=sc).     
-00012310: 2020 2065 6c69 6620 226a 2220 696e 2073     elif "j" in s
-00012320: 656c 662e 7570 6172 616d 3a0a 2020 2020  elf.uparam:.    
-00012330: 2020 2020 2020 2020 6a74 7874 203d 206a          jtxt = j
-00012340: 736f 6e2e 6475 6d70 7328 6a6d 7367 2c20  son.dumps(jmsg, 
-00012350: 696e 6465 6e74 3d32 2c20 736f 7274 5f6b  indent=2, sort_k
-00012360: 6579 733d 5472 7565 292e 656e 636f 6465  eys=True).encode
-00012370: 2822 7574 662d 3822 2c20 2272 6570 6c61  ("utf-8", "repla
-00012380: 6365 2229 0a20 2020 2020 2020 2020 2020  ce").           
-00012390: 2073 656c 662e 7265 706c 7928 6a74 7874   self.reply(jtxt
-000123a0: 2c20 6d69 6d65 3d22 6170 706c 6963 6174  , mime="applicat
-000123b0: 696f 6e2f 6a73 6f6e 222c 2073 7461 7475  ion/json", statu
-000123c0: 733d 7363 290a 2020 2020 2020 2020 656c  s=sc).        el
-000123d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000123e0: 7365 6c66 2e72 6564 6972 6563 7428 0a20  self.redirect(. 
-000123f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012400: 656c 662e 7670 6174 682c 0a20 2020 2020  elf.vpath,.     
-00012410: 2020 2020 2020 2020 2020 206d 7367 3d6d             msg=m
-00012420: 7367 202b 2073 7566 2c0a 2020 2020 2020  sg + suf,.      
-00012430: 2020 2020 2020 2020 2020 666c 6176 6f72            flavor
-00012440: 3d22 7265 7475 726e 2074 6f22 2c0a 2020  ="return to",.  
-00012450: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00012460: 6963 6b3d 4661 6c73 652c 0a20 2020 2020  ick=False,.     
-00012470: 2020 2020 2020 2020 2020 2073 7461 7475             statu
-00012480: 733d 7363 2c0a 2020 2020 2020 2020 2020  s=sc,.          
-00012490: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-000124a0: 6572 726d 7367 3a0a 2020 2020 2020 2020  errmsg:.        
-000124b0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-000124c0: 0a0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
-000124d0: 6172 7365 722e 6472 6f70 2829 0a20 2020  arser.drop().   
-000124e0: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
-000124f0: 0a0a 2020 2020 6465 6620 6861 6e64 6c65  ..    def handle
-00012500: 5f74 6578 745f 7570 6c6f 6164 2873 656c  _text_upload(sel
-00012510: 6629 2020 3a0a 2020 2020 2020 2020 6173  f)  :.        as
-00012520: 7365 7274 2073 656c 662e 7061 7273 6572  sert self.parser
-00012530: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-00012540: 2020 2020 2020 2020 2020 636c 695f 6c61            cli_la
-00012550: 7374 6d6f 6433 203d 2069 6e74 2873 656c  stmod3 = int(sel
-00012560: 662e 7061 7273 6572 2e72 6571 7569 7265  f.parser.require
-00012570: 2822 6c61 7374 6d6f 6422 2c20 3136 2929  ("lastmod", 16))
-00012580: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00012590: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000125a0: 7365 2050 6562 6b61 6328 3430 302c 2022  se Pebkac(400, "
-000125b0: 636f 756c 6420 6e6f 7420 7265 6164 206c  could not read l
-000125c0: 6173 746d 6f64 2066 726f 6d20 7265 7175  astmod from requ
-000125d0: 6573 7422 290a 0a20 2020 2020 2020 206e  est")..        n
-000125e0: 756c 6c77 7269 7465 203d 2073 656c 662e  ullwrite = self.
-000125f0: 6172 6773 2e6e 770a 2020 2020 2020 2020  args.nw.        
-00012600: 7666 732c 2072 656d 203d 2073 656c 662e  vfs, rem = self.
-00012610: 6173 7276 2e76 6673 2e67 6574 2873 656c  asrv.vfs.get(sel
-00012620: 662e 7670 6174 682c 2073 656c 662e 756e  f.vpath, self.un
-00012630: 616d 652c 2054 7275 652c 2054 7275 6529  ame, True, True)
-00012640: 0a20 2020 2020 2020 2073 656c 662e 5f61  .        self._a
-00012650: 7373 6572 745f 7361 6665 5f72 656d 2872  ssert_safe_rem(r
-00012660: 656d 290a 0a20 2020 2020 2020 2063 6c65  em)..        cle
-00012670: 6e20 3d20 696e 7428 7365 6c66 2e68 6561  n = int(self.hea
-00012680: 6465 7273 2e67 6574 2822 636f 6e74 656e  ders.get("conten
-00012690: 742d 6c65 6e67 7468 222c 202d 3129 290a  t-length", -1)).
-000126a0: 2020 2020 2020 2020 6966 2063 6c65 6e20          if clen 
-000126b0: 3d3d 202d 313a 0a20 2020 2020 2020 2020  == -1:.         
-000126c0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
-000126d0: 3431 3129 0a0a 2020 2020 2020 2020 7270  411)..        rp
-000126e0: 2c20 666e 203d 2076 7370 6c69 7428 7265  , fn = vsplit(re
-000126f0: 6d29 0a20 2020 2020 2020 2066 7020 3d20  m).        fp = 
-00012700: 7666 732e 6361 6e6f 6e69 6361 6c28 7270  vfs.canonical(rp
-00012710: 290a 2020 2020 2020 2020 6c69 6d20 3d20  ).        lim = 
-00012720: 7666 732e 6765 745f 6462 7628 7265 6d29  vfs.get_dbv(rem)
-00012730: 5b30 5d2e 6c69 6d0a 2020 2020 2020 2020  [0].lim.        
-00012740: 6966 206c 696d 3a0a 2020 2020 2020 2020  if lim:.        
-00012750: 2020 2020 6670 2c20 7270 203d 206c 696d      fp, rp = lim
-00012760: 2e61 6c6c 2873 656c 662e 6970 2c20 7270  .all(self.ip, rp
-00012770: 2c20 636c 656e 2c20 6670 290a 2020 2020  , clen, fp).    
-00012780: 2020 2020 2020 2020 626f 732e 6d61 6b65          bos.make
-00012790: 6469 7273 2866 7029 0a0a 2020 2020 2020  dirs(fp)..      
-000127a0: 2020 6670 203d 206f 732e 7061 7468 2e6a    fp = os.path.j
-000127b0: 6f69 6e28 6670 2c20 666e 290a 2020 2020  oin(fp, fn).    
-000127c0: 2020 2020 7265 6d20 3d20 227b 7d2f 7b7d      rem = "{}/{}
-000127d0: 222e 666f 726d 6174 2872 702c 2066 6e29  ".format(rp, fn)
-000127e0: 2e73 7472 6970 2822 2f22 290a 0a20 2020  .strip("/")..   
-000127f0: 2020 2020 2069 6620 6e6f 7420 7265 6d2e       if not rem.
-00012800: 656e 6473 7769 7468 2822 2e6d 6422 293a  endswith(".md"):
-00012810: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00012820: 7365 2050 6562 6b61 6328 3430 302c 2022  se Pebkac(400, "
-00012830: 6f6e 6c79 206d 6172 6b64 6f77 6e20 706c  only markdown pl
-00012840: 7322 290a 0a20 2020 2020 2020 2069 6620  s")..        if 
-00012850: 6e75 6c6c 7772 6974 653a 0a20 2020 2020  nullwrite:.     
-00012860: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00012870: 3d20 6a73 6f6e 2e64 756d 7073 287b 226f  = json.dumps({"o
-00012880: 6b22 3a20 5472 7565 2c20 226c 6173 746d  k": True, "lastm
-00012890: 6f64 223a 2030 7d29 0a20 2020 2020 2020  od": 0}).       
-000128a0: 2020 2020 2073 656c 662e 6c6f 6728 7265       self.log(re
-000128b0: 7370 6f6e 7365 290a 2020 2020 2020 2020  sponse).        
-000128c0: 2020 2020 2320 544f 444f 2072 6570 6c79      # TODO reply
-000128d0: 2073 686f 756c 6420 7061 7273 6572 2e64   should parser.d
-000128e0: 726f 7028 290a 2020 2020 2020 2020 2020  rop().          
-000128f0: 2020 7365 6c66 2e70 6172 7365 722e 6472    self.parser.dr
-00012900: 6f70 2829 0a20 2020 2020 2020 2020 2020  op().           
-00012910: 2073 656c 662e 7265 706c 7928 7265 7370   self.reply(resp
-00012920: 6f6e 7365 2e65 6e63 6f64 6528 2275 7466  onse.encode("utf
-00012930: 2d38 2229 290a 2020 2020 2020 2020 2020  -8")).          
-00012940: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00012950: 2020 2020 2020 2073 7276 5f6c 6173 746d         srv_lastm
-00012960: 6f64 203d 202d 312e 300a 2020 2020 2020  od = -1.0.      
-00012970: 2020 7372 765f 6c61 7374 6d6f 6433 203d    srv_lastmod3 =
-00012980: 202d 310a 2020 2020 2020 2020 7472 793a   -1.        try:
-00012990: 0a20 2020 2020 2020 2020 2020 2073 7420  .            st 
-000129a0: 3d20 626f 732e 7374 6174 2866 7029 0a20  = bos.stat(fp). 
-000129b0: 2020 2020 2020 2020 2020 2073 7276 5f6c             srv_l
-000129c0: 6173 746d 6f64 203d 2073 742e 7374 5f6d  astmod = st.st_m
-000129d0: 7469 6d65 0a20 2020 2020 2020 2020 2020  time.           
-000129e0: 2073 7276 5f6c 6173 746d 6f64 3320 3d20   srv_lastmod3 = 
-000129f0: 696e 7428 7372 765f 6c61 7374 6d6f 6420  int(srv_lastmod 
-00012a00: 2a20 3130 3030 290a 2020 2020 2020 2020  * 1000).        
-00012a10: 6578 6365 7074 204f 5345 7272 6f72 2061  except OSError a
-00012a20: 7320 6578 3a0a 2020 2020 2020 2020 2020  s ex:.          
-00012a30: 2020 6966 2065 782e 6572 726e 6f20 213d    if ex.errno !=
-00012a40: 2065 7272 6e6f 2e45 4e4f 454e 543a 0a20   errno.ENOENT:. 
-00012a50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00012a60: 6169 7365 0a0a 2020 2020 2020 2020 2320  aise..        # 
-00012a70: 6966 2066 696c 6520 6578 6973 7473 2c20  if file exists, 
-00012a80: 6368 656b 6320 7468 6174 2074 696d 6573  chekc that times
-00012a90: 7461 6d70 206d 6174 6368 6573 2074 6865  tamp matches the
-00012aa0: 2063 6c69 656e 7427 730a 2020 2020 2020   client's.      
-00012ab0: 2020 6966 2073 7276 5f6c 6173 746d 6f64    if srv_lastmod
-00012ac0: 203e 3d20 303a 0a20 2020 2020 2020 2020   >= 0:.         
-00012ad0: 2020 2073 616d 655f 6c61 7374 6d6f 6420     same_lastmod 
-00012ae0: 3d20 636c 695f 6c61 7374 6d6f 6433 2069  = cli_lastmod3 i
-00012af0: 6e20 5b2d 312c 2073 7276 5f6c 6173 746d  n [-1, srv_lastm
-00012b00: 6f64 335d 0a20 2020 2020 2020 2020 2020  od3].           
-00012b10: 2069 6620 6e6f 7420 7361 6d65 5f6c 6173   if not same_las
-00012b20: 746d 6f64 3a0a 2020 2020 2020 2020 2020  tmod:.          
-00012b30: 2020 2020 2020 2320 736f 6d65 2066 696c        # some fil
-00012b40: 6573 7973 7465 6d73 2f74 7261 6e73 706f  esystems/transpo
-00012b50: 7274 7320 6c69 6d69 7420 7072 6563 6973  rts limit precis
-00012b60: 696f 6e20 746f 2031 7365 632c 2068 6f70  ion to 1sec, hop
-00012b70: 6566 756c 6c79 2066 6c6f 6f72 6564 0a20  efully floored. 
-00012b80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012b90: 616d 655f 6c61 7374 6d6f 6420 3d20 280a  ame_lastmod = (.
-00012ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012bb0: 2020 2020 7372 765f 6c61 7374 6d6f 6420      srv_lastmod 
-00012bc0: 3d3d 2069 6e74 2863 6c69 5f6c 6173 746d  == int(cli_lastm
-00012bd0: 6f64 3320 2f20 3130 3030 290a 2020 2020  od3 / 1000).    
-00012be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012bf0: 616e 6420 636c 695f 6c61 7374 6d6f 6433  and cli_lastmod3
-00012c00: 203e 2073 7276 5f6c 6173 746d 6f64 330a   > srv_lastmod3.
-00012c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012c20: 2020 2020 616e 6420 636c 695f 6c61 7374      and cli_last
-00012c30: 6d6f 6433 202d 2073 7276 5f6c 6173 746d  mod3 - srv_lastm
-00012c40: 6f64 3320 3c20 3130 3030 0a20 2020 2020  od3 < 1000.     
-00012c50: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00012c60: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00012c70: 2073 616d 655f 6c61 7374 6d6f 643a 0a20   same_lastmod:. 
-00012c80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00012c90: 6573 706f 6e73 6520 3d20 6a73 6f6e 2e64  esponse = json.d
-00012ca0: 756d 7073 280a 2020 2020 2020 2020 2020  umps(.          
-00012cb0: 2020 2020 2020 2020 2020 7b0a 2020 2020            {.    
-00012cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012cd0: 2020 2020 226f 6b22 3a20 4661 6c73 652c      "ok": False,
-00012ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012cf0: 2020 2020 2020 2020 2022 6c61 7374 6d6f           "lastmo
-00012d00: 6422 3a20 7372 765f 6c61 7374 6d6f 6433  d": srv_lastmod3
-00012d10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00012d20: 2020 2020 2020 2020 2020 226e 6f77 223a            "now":
-00012d30: 2069 6e74 2874 696d 652e 7469 6d65 2829   int(time.time()
-00012d40: 202a 2031 3030 3029 2c0a 2020 2020 2020   * 1000),.      
-00012d50: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00012d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00012d80: 2020 7365 6c66 2e6c 6f67 280a 2020 2020    self.log(.    
-00012d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012da0: 227b 7d20 2d20 7b7d 203d 207b 7d22 2e66  "{} - {} = {}".f
-00012db0: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
-00012dc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012dd0: 7276 5f6c 6173 746d 6f64 332c 2063 6c69  rv_lastmod3, cli
-00012de0: 5f6c 6173 746d 6f64 332c 2073 7276 5f6c  _lastmod3, srv_l
-00012df0: 6173 746d 6f64 3320 2d20 636c 695f 6c61  astmod3 - cli_la
-00012e00: 7374 6d6f 6433 0a20 2020 2020 2020 2020  stmod3.         
-00012e10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00012e20: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00012e30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012e40: 656c 662e 6c6f 6728 7265 7370 6f6e 7365  elf.log(response
-00012e50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00012e60: 2020 7365 6c66 2e70 6172 7365 722e 6472    self.parser.dr
-00012e70: 6f70 2829 0a20 2020 2020 2020 2020 2020  op().           
-00012e80: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
-00012e90: 7265 7370 6f6e 7365 2e65 6e63 6f64 6528  response.encode(
-00012ea0: 2275 7466 2d38 2229 290a 2020 2020 2020  "utf-8")).      
-00012eb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00012ec0: 2054 7275 650a 0a20 2020 2020 2020 2020   True..         
-00012ed0: 2020 206d 6469 722c 206d 6669 6c65 203d     mdir, mfile =
-00012ee0: 206f 732e 7061 7468 2e73 706c 6974 2866   os.path.split(f
-00012ef0: 7029 0a20 2020 2020 2020 2020 2020 206d  p).            m
-00012f00: 6669 6c65 3220 3d20 227b 7d2e 7b3a 2e33  file2 = "{}.{:.3
-00012f10: 667d 2e6d 6422 2e66 6f72 6d61 7428 6d66  f}.md".format(mf
-00012f20: 696c 655b 3a2d 335d 2c20 7372 765f 6c61  ile[:-3], srv_la
-00012f30: 7374 6d6f 6429 0a20 2020 2020 2020 2020  stmod).         
-00012f40: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00012f50: 2020 2020 2020 2020 6470 203d 206f 732e          dp = os.
-00012f60: 7061 7468 2e6a 6f69 6e28 6d64 6972 2c20  path.join(mdir, 
-00012f70: 222e 6869 7374 2229 0a20 2020 2020 2020  ".hist").       
-00012f80: 2020 2020 2020 2020 2062 6f73 2e6d 6b64           bos.mkd
-00012f90: 6972 2864 7029 0a20 2020 2020 2020 2020  ir(dp).         
-00012fa0: 2020 2020 2020 2068 6964 6564 6972 2864         hidedir(d
-00012fb0: 7029 0a20 2020 2020 2020 2020 2020 2065  p).            e
-00012fc0: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-00012fd0: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-00012fe0: 2020 2020 2020 2020 626f 732e 7265 6e61          bos.rena
-00012ff0: 6d65 2866 702c 206f 732e 7061 7468 2e6a  me(fp, os.path.j
-00013000: 6f69 6e28 6d64 6972 2c20 222e 6869 7374  oin(mdir, ".hist
-00013010: 222c 206d 6669 6c65 3229 290a 0a20 2020  ", mfile2))..   
-00013020: 2020 2020 2061 7373 6572 7420 7365 6c66       assert self
-00013030: 2e70 6172 7365 722e 6765 6e0a 2020 2020  .parser.gen.    
-00013040: 2020 2020 705f 6669 656c 642c 205f 2c20      p_field, _, 
-00013050: 705f 6461 7461 203d 206e 6578 7428 7365  p_data = next(se
-00013060: 6c66 2e70 6172 7365 722e 6765 6e29 0a20  lf.parser.gen). 
-00013070: 2020 2020 2020 2069 6620 705f 6669 656c         if p_fiel
-00013080: 6420 213d 2022 626f 6479 223a 0a20 2020  d != "body":.   
-00013090: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-000130a0: 6562 6b61 6328 3430 302c 2022 6578 7065  ebkac(400, "expe
-000130b0: 6374 6564 2062 6f64 792c 2067 6f74 207b  cted body, got {
-000130c0: 7d22 2e66 6f72 6d61 7428 705f 6669 656c  }".format(p_fiel
-000130d0: 6429 290a 0a20 2020 2020 2020 2069 6620  d))..        if 
-000130e0: 626f 732e 7061 7468 2e65 7869 7374 7328  bos.path.exists(
-000130f0: 6670 293a 0a20 2020 2020 2020 2020 2020  fp):.           
-00013100: 2062 6f73 2e75 6e6c 696e 6b28 6670 290a   bos.unlink(fp).
-00013110: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
-00013120: 656e 2866 7365 6e63 2866 7029 2c20 2277  en(fsenc(fp), "w
-00013130: 6222 2c20 3531 3220 2a20 3130 3234 2920  b", 512 * 1024) 
-00013140: 6173 2066 3a0a 2020 2020 2020 2020 2020  as f:.          
-00013150: 2020 737a 2c20 7368 6135 3132 2c20 5f20    sz, sha512, _ 
-00013160: 3d20 6861 7368 636f 7079 2870 5f64 6174  = hashcopy(p_dat
-00013170: 612c 2066 2c20 7365 6c66 2e61 7267 732e  a, f, self.args.
-00013180: 735f 7772 5f73 6c70 290a 0a20 2020 2020  s_wr_slp)..     
-00013190: 2020 2069 6620 6c69 6d3a 0a20 2020 2020     if lim:.     
-000131a0: 2020 2020 2020 206c 696d 2e6e 7570 2873         lim.nup(s
-000131b0: 656c 662e 6970 290a 2020 2020 2020 2020  elf.ip).        
-000131c0: 2020 2020 6c69 6d2e 6275 7028 7365 6c66      lim.bup(self
-000131d0: 2e69 702c 2073 7a29 0a20 2020 2020 2020  .ip, sz).       
-000131e0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-000131f0: 2020 2020 2020 2020 2020 6c69 6d2e 6368            lim.ch
-00013200: 6b5f 737a 2873 7a29 0a20 2020 2020 2020  k_sz(sz).       
-00013210: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00013220: 2020 2020 2020 2020 2020 2020 2062 6f73               bos
-00013230: 2e75 6e6c 696e 6b28 6670 290a 2020 2020  .unlink(fp).    
-00013240: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00013250: 650a 0a20 2020 2020 2020 206e 6577 5f6c  e..        new_l
-00013260: 6173 746d 6f64 203d 2062 6f73 2e73 7461  astmod = bos.sta
-00013270: 7428 6670 292e 7374 5f6d 7469 6d65 0a20  t(fp).st_mtime. 
-00013280: 2020 2020 2020 206e 6577 5f6c 6173 746d         new_lastm
-00013290: 6f64 3320 3d20 696e 7428 6e65 775f 6c61  od3 = int(new_la
-000132a0: 7374 6d6f 6420 2a20 3130 3030 290a 2020  stmod * 1000).  
-000132b0: 2020 2020 2020 7368 6135 3132 203d 2073        sha512 = s
-000132c0: 6861 3531 325b 3a35 365d 0a0a 2020 2020  ha512[:56]..    
-000132d0: 2020 2020 7265 7370 6f6e 7365 203d 206a      response = j
-000132e0: 736f 6e2e 6475 6d70 7328 0a20 2020 2020  son.dumps(.     
-000132f0: 2020 2020 2020 207b 226f 6b22 3a20 5472         {"ok": Tr
-00013300: 7565 2c20 226c 6173 746d 6f64 223a 206e  ue, "lastmod": n
-00013310: 6577 5f6c 6173 746d 6f64 332c 2022 7369  ew_lastmod3, "si
-00013320: 7a65 223a 2073 7a2c 2022 7368 6135 3132  ze": sz, "sha512
-00013330: 223a 2073 6861 3531 327d 0a20 2020 2020  ": sha512}.     
-00013340: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
-00013350: 662e 6c6f 6728 7265 7370 6f6e 7365 290a  f.log(response).
-00013360: 2020 2020 2020 2020 7365 6c66 2e70 6172          self.par
-00013370: 7365 722e 6472 6f70 2829 0a20 2020 2020  ser.drop().     
-00013380: 2020 2073 656c 662e 7265 706c 7928 7265     self.reply(re
-00013390: 7370 6f6e 7365 2e65 6e63 6f64 6528 2275  sponse.encode("u
-000133a0: 7466 2d38 2229 290a 2020 2020 2020 2020  tf-8")).        
-000133b0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-000133c0: 2064 6566 205f 6368 6b5f 6c61 7374 6d6f   def _chk_lastmo
-000133d0: 6428 7365 6c66 2c20 6669 6c65 5f74 7320  d(self, file_ts 
-000133e0: 2920 2020 3a0a 2020 2020 2020 2020 6669  )   :.        fi
-000133f0: 6c65 5f6c 6173 746d 6f64 203d 2066 6f72  le_lastmod = for
-00013400: 6d61 7464 6174 6528 6669 6c65 5f74 732c  matdate(file_ts,
-00013410: 2075 7365 676d 743d 5472 7565 290a 2020   usegmt=True).  
-00013420: 2020 2020 2020 636c 695f 6c61 7374 6d6f        cli_lastmo
-00013430: 6420 3d20 7365 6c66 2e68 6561 6465 7273  d = self.headers
-00013440: 2e67 6574 2822 6966 2d6d 6f64 6966 6965  .get("if-modifie
-00013450: 642d 7369 6e63 6522 290a 2020 2020 2020  d-since").      
-00013460: 2020 6966 2063 6c69 5f6c 6173 746d 6f64    if cli_lastmod
-00013470: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
-00013480: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00013490: 2020 2023 2073 6f6d 6520 6272 6f77 7365     # some browse
-000134a0: 7220 6170 7065 6e64 2022 3b20 6c65 6e67  r append "; leng
-000134b0: 7468 3d35 3733 220a 2020 2020 2020 2020  th=573".        
-000134c0: 2020 2020 2020 2020 636c 695f 6c61 7374          cli_last
-000134d0: 6d6f 6420 3d20 636c 695f 6c61 7374 6d6f  mod = cli_lastmo
-000134e0: 642e 7370 6c69 7428 223b 2229 5b30 5d2e  d.split(";")[0].
-000134f0: 7374 7269 7028 290a 2020 2020 2020 2020  strip().        
-00013500: 2020 2020 2020 2020 636c 695f 6474 203d          cli_dt =
-00013510: 2070 6172 7365 6461 7465 2863 6c69 5f6c   parsedate(cli_l
-00013520: 6173 746d 6f64 290a 2020 2020 2020 2020  astmod).        
-00013530: 2020 2020 2020 2020 6173 7365 7274 2063          assert c
-00013540: 6c69 5f64 740a 2020 2020 2020 2020 2020  li_dt.          
-00013550: 2020 2020 2020 636c 695f 7473 203d 2063        cli_ts = c
-00013560: 616c 656e 6461 722e 7469 6d65 676d 2863  alendar.timegm(c
-00013570: 6c69 5f64 7429 0a20 2020 2020 2020 2020  li_dt).         
-00013580: 2020 2020 2020 2072 6574 7572 6e20 6669         return fi
-00013590: 6c65 5f6c 6173 746d 6f64 2c20 696e 7428  le_lastmod, int(
-000135a0: 6669 6c65 5f74 7329 203e 2069 6e74 2863  file_ts) > int(c
-000135b0: 6c69 5f74 7329 0a20 2020 2020 2020 2020  li_ts).         
-000135c0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-000135d0: 696f 6e20 6173 2065 783a 0a20 2020 2020  ion as ex:.     
-000135e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000135f0: 6c6f 6728 0a20 2020 2020 2020 2020 2020  log(.           
-00013600: 2020 2020 2020 2020 2022 6c61 7374 6d6f           "lastmo
-00013610: 6420 7b7d 5c6e 7265 6d6f 7465 3a20 5b7b  d {}\nremote: [{
-00013620: 7d5d 5c6e 206c 6f63 616c 3a20 5b7b 7d5d  }]\n local: [{}]
-00013630: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
-00013640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013650: 2020 7265 7072 2865 7829 2c20 636c 695f    repr(ex), cli_
-00013660: 6c61 7374 6d6f 642c 2066 696c 655f 6c61  lastmod, file_la
-00013670: 7374 6d6f 640a 2020 2020 2020 2020 2020  stmod.          
-00013680: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00013690: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000136a0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-000136b0: 7475 726e 2066 696c 655f 6c61 7374 6d6f  turn file_lastmo
-000136c0: 642c 2066 696c 655f 6c61 7374 6d6f 6420  d, file_lastmod 
-000136d0: 213d 2063 6c69 5f6c 6173 746d 6f64 0a0a  != cli_lastmod..
-000136e0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-000136f0: 696c 655f 6c61 7374 6d6f 642c 2054 7275  ile_lastmod, Tru
-00013700: 650a 0a20 2020 2064 6566 2074 785f 6669  e..    def tx_fi
-00013710: 6c65 2873 656c 662c 2072 6571 5f70 6174  le(self, req_pat
-00013720: 6820 2920 203a 0a20 2020 2020 2020 2073  h )  :.        s
-00013730: 7461 7475 7320 3d20 3230 300a 2020 2020  tatus = 200.    
-00013740: 2020 2020 6c6f 676d 7367 203d 2022 7b3a      logmsg = "{:
-00013750: 347d 207b 7d20 222e 666f 726d 6174 2822  4} {} ".format("
-00013760: 222c 2073 656c 662e 7265 7129 0a20 2020  ", self.req).   
-00013770: 2020 2020 206c 6f67 7461 696c 203d 2022       logtail = "
-00013780: 220a 0a20 2020 2020 2020 2023 0a20 2020  "..        #.   
-00013790: 2020 2020 2023 2069 6620 7265 7175 6573       # if reques
-000137a0: 7420 6973 2066 6f72 2066 6f6f 2e6a 732c  t is for foo.js,
-000137b0: 2063 6865 636b 2069 6620 7765 2068 6176   check if we hav
-000137c0: 6520 666f 6f2e 6a73 2e7b 677a 2c62 727d  e foo.js.{gz,br}
-000137d0: 0a0a 2020 2020 2020 2020 6669 6c65 5f74  ..        file_t
-000137e0: 7320 3d20 300a 2020 2020 2020 2020 6564  s = 0.        ed
-000137f0: 6974 696f 6e73 2020 2020 3d20 7b7d 0a20  itions    = {}. 
-00013800: 2020 2020 2020 2066 6f72 2065 7874 2069         for ext i
-00013810: 6e20 5b22 222c 2022 2e67 7a22 2c20 222e  n ["", ".gz", ".
-00013820: 6272 225d 3a0a 2020 2020 2020 2020 2020  br"]:.          
-00013830: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00013840: 2020 2020 2020 2066 735f 7061 7468 203d         fs_path =
-00013850: 2072 6571 5f70 6174 6820 2b20 6578 740a   req_path + ext.
-00013860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013870: 7374 203d 2062 6f73 2e73 7461 7428 6673  st = bos.stat(fs
-00013880: 5f70 6174 6829 0a20 2020 2020 2020 2020  _path).         
-00013890: 2020 2020 2020 2069 6620 7374 6174 2e53         if stat.S
-000138a0: 5f49 5344 4952 2873 742e 7374 5f6d 6f64  _ISDIR(st.st_mod
-000138b0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-000138c0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-000138d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000138e0: 2020 6966 2073 7461 742e 535f 4953 424c    if stat.S_ISBL
-000138f0: 4b28 7374 2e73 745f 6d6f 6465 293a 0a20  K(st.st_mode):. 
-00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013910: 2020 2066 6420 3d20 626f 732e 6f70 656e     fd = bos.open
-00013920: 2866 735f 7061 7468 2c20 6f73 2e4f 5f52  (fs_path, os.O_R
-00013930: 444f 4e4c 5929 0a20 2020 2020 2020 2020  DONLY).         
-00013940: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00013950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013960: 2020 2020 2020 2020 737a 203d 206f 732e          sz = os.
-00013970: 6c73 6565 6b28 6664 2c20 302c 206f 732e  lseek(fd, 0, os.
-00013980: 5345 454b 5f45 4e44 290a 2020 2020 2020  SEEK_END).      
-00013990: 2020 2020 2020 2020 2020 2020 2020 6669                fi
-000139a0: 6e61 6c6c 793a 0a20 2020 2020 2020 2020  nally:.         
-000139b0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000139c0: 732e 636c 6f73 6528 6664 290a 2020 2020  s.close(fd).    
-000139d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000139e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000139f0: 2020 2020 2020 737a 203d 2073 742e 7374        sz = st.st
-00013a00: 5f73 697a 650a 0a20 2020 2020 2020 2020  _size..         
-00013a10: 2020 2020 2020 2066 696c 655f 7473 203d         file_ts =
-00013a20: 206d 6178 2866 696c 655f 7473 2c20 696e   max(file_ts, in
-00013a30: 7428 7374 2e73 745f 6d74 696d 6529 290a  t(st.st_mtime)).
-00013a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013a50: 6564 6974 696f 6e73 5b65 7874 206f 7220  editions[ext or 
-00013a60: 2270 6c61 696e 225d 203d 2028 6673 5f70  "plain"] = (fs_p
-00013a70: 6174 682c 2073 7a29 0a20 2020 2020 2020  ath, sz).       
-00013a80: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00013a90: 2020 2020 2020 2020 2020 2020 2070 6173               pas
-00013aa0: 730a 2020 2020 2020 2020 2020 2020 6966  s.            if
-00013ab0: 206e 6f74 2073 656c 662e 7670 6174 682e   not self.vpath.
-00013ac0: 7374 6172 7473 7769 7468 2822 2e63 7072  startswith(".cpr
-00013ad0: 2f22 293a 0a20 2020 2020 2020 2020 2020  /"):.           
-00013ae0: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
-00013af0: 2020 2020 6966 206e 6f74 2065 6469 7469      if not editi
-00013b00: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-00013b10: 2072 6574 7572 6e20 7365 6c66 2e74 785f   return self.tx_
-00013b20: 3430 3428 290a 0a20 2020 2020 2020 2023  404()..        #
-00013b30: 0a20 2020 2020 2020 2023 2069 662d 6d6f  .        # if-mo
-00013b40: 6469 6669 6564 0a0a 2020 2020 2020 2020  dified..        
-00013b50: 6669 6c65 5f6c 6173 746d 6f64 2c20 646f  file_lastmod, do
-00013b60: 5f73 656e 6420 3d20 7365 6c66 2e5f 6368  _send = self._ch
-00013b70: 6b5f 6c61 7374 6d6f 6428 6669 6c65 5f74  k_lastmod(file_t
-00013b80: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-00013b90: 6f75 745f 6865 6164 6572 735b 224c 6173  out_headers["Las
-00013ba0: 742d 4d6f 6469 6669 6564 225d 203d 2066  t-Modified"] = f
-00013bb0: 696c 655f 6c61 7374 6d6f 640a 2020 2020  ile_lastmod.    
-00013bc0: 2020 2020 6966 206e 6f74 2064 6f5f 7365      if not do_se
-00013bd0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
-00013be0: 7374 6174 7573 203d 2033 3034 0a0a 2020  status = 304..  
-00013bf0: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
-00013c00: 2320 4163 6365 7074 2d45 6e63 6f64 696e  # Accept-Encodin
-00013c10: 6720 616e 6420 5541 2064 6563 6964 6573  g and UA decides
-00013c20: 2077 6869 6368 2065 6469 7469 6f6e 2074   which edition t
-00013c30: 6f20 7365 6e64 0a0a 2020 2020 2020 2020  o send..        
-00013c40: 6465 636f 6d70 7265 7373 203d 2046 616c  decompress = Fal
-00013c50: 7365 0a20 2020 2020 2020 2073 7570 706f  se.        suppo
-00013c60: 7274 6564 5f65 6469 7469 6f6e 7320 3d20  rted_editions = 
-00013c70: 5b0a 2020 2020 2020 2020 2020 2020 782e  [.            x.
-00013c80: 7374 7269 7028 290a 2020 2020 2020 2020  strip().        
-00013c90: 2020 2020 666f 7220 7820 696e 2073 656c      for x in sel
-00013ca0: 662e 6865 6164 6572 732e 6765 7428 2261  f.headers.get("a
-00013cb0: 6363 6570 742d 656e 636f 6469 6e67 222c  ccept-encoding",
-00013cc0: 2022 2229 2e6c 6f77 6572 2829 2e73 706c   "").lower().spl
-00013cd0: 6974 2822 2c22 290a 2020 2020 2020 2020  it(",").        
-00013ce0: 5d0a 2020 2020 2020 2020 6966 2022 2e62  ].        if ".b
-00013cf0: 7222 2069 6e20 6564 6974 696f 6e73 2061  r" in editions a
-00013d00: 6e64 2022 6272 2220 696e 2073 7570 706f  nd "br" in suppo
-00013d10: 7274 6564 5f65 6469 7469 6f6e 733a 0a20  rted_editions:. 
-00013d20: 2020 2020 2020 2020 2020 2069 735f 636f             is_co
-00013d30: 6d70 7265 7373 6564 203d 2054 7275 650a  mpressed = True.
-00013d40: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
-00013d50: 6374 6564 5f65 6469 7469 6f6e 203d 2022  cted_edition = "
-00013d60: 2e62 7222 0a20 2020 2020 2020 2020 2020  .br".           
-00013d70: 2066 735f 7061 7468 2c20 6669 6c65 5f73   fs_path, file_s
-00013d80: 7a20 3d20 6564 6974 696f 6e73 5b22 2e62  z = editions[".b
-00013d90: 7222 5d0a 2020 2020 2020 2020 2020 2020  r"].            
-00013da0: 7365 6c66 2e6f 7574 5f68 6561 6465 7273  self.out_headers
-00013db0: 5b22 436f 6e74 656e 742d 456e 636f 6469  ["Content-Encodi
-00013dc0: 6e67 225d 203d 2022 6272 220a 2020 2020  ng"] = "br".    
-00013dd0: 2020 2020 656c 6966 2022 2e67 7a22 2069      elif ".gz" i
-00013de0: 6e20 6564 6974 696f 6e73 3a0a 2020 2020  n editions:.    
-00013df0: 2020 2020 2020 2020 6973 5f63 6f6d 7072          is_compr
-00013e00: 6573 7365 6420 3d20 5472 7565 0a20 2020  essed = True.   
-00013e10: 2020 2020 2020 2020 2073 656c 6563 7465           selecte
-00013e20: 645f 6564 6974 696f 6e20 3d20 222e 677a  d_edition = ".gz
-00013e30: 220a 2020 2020 2020 2020 2020 2020 6673  ".            fs
-00013e40: 5f70 6174 682c 2066 696c 655f 737a 203d  _path, file_sz =
-00013e50: 2065 6469 7469 6f6e 735b 222e 677a 225d   editions[".gz"]
-00013e60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00013e70: 2267 7a69 7022 206e 6f74 2069 6e20 7375  "gzip" not in su
-00013e80: 7070 6f72 7465 645f 6564 6974 696f 6e73  pported_editions
-00013e90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013ea0: 2020 6465 636f 6d70 7265 7373 203d 2054    decompress = T
-00013eb0: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
-00013ec0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00013ed0: 2020 2020 2020 6966 2072 652e 6d61 7463        if re.matc
-00013ee0: 6828 7222 4d53 4945 205b 342d 365d 5c2e  h(r"MSIE [4-6]\.
-00013ef0: 222c 2073 656c 662e 7561 2920 616e 6420  ", self.ua) and 
-00013f00: 2220 5356 3122 206e 6f74 2069 6e20 7365  " SV1" not in se
-00013f10: 6c66 2e75 613a 0a20 2020 2020 2020 2020  lf.ua:.         
-00013f20: 2020 2020 2020 2020 2020 2064 6563 6f6d             decom
-00013f30: 7072 6573 7320 3d20 5472 7565 0a0a 2020  press = True..  
-00013f40: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00013f50: 2064 6563 6f6d 7072 6573 733a 0a20 2020   decompress:.   
-00013f60: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00013f70: 662e 6f75 745f 6865 6164 6572 735b 2243  f.out_headers["C
-00013f80: 6f6e 7465 6e74 2d45 6e63 6f64 696e 6722  ontent-Encoding"
-00013f90: 5d20 3d20 2267 7a69 7022 0a20 2020 2020  ] = "gzip".     
-00013fa0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013fb0: 2020 2020 2069 735f 636f 6d70 7265 7373       is_compress
-00013fc0: 6564 203d 2046 616c 7365 0a20 2020 2020  ed = False.     
-00013fd0: 2020 2020 2020 2073 656c 6563 7465 645f         selected_
-00013fe0: 6564 6974 696f 6e20 3d20 2270 6c61 696e  edition = "plain
-00013ff0: 220a 0a20 2020 2020 2020 2074 7279 3a0a  "..        try:.
-00014000: 2020 2020 2020 2020 2020 2020 6673 5f70              fs_p
-00014010: 6174 682c 2066 696c 655f 737a 203d 2065  ath, file_sz = e
-00014020: 6469 7469 6f6e 735b 7365 6c65 6374 6564  ditions[selected
-00014030: 5f65 6469 7469 6f6e 5d0a 2020 2020 2020  _edition].      
-00014040: 2020 2020 2020 6c6f 676d 7367 202b 3d20        logmsg += 
-00014050: 227b 7d20 222e 666f 726d 6174 2873 656c  "{} ".format(sel
-00014060: 6563 7465 645f 6564 6974 696f 6e2e 6c73  ected_edition.ls
-00014070: 7472 6970 2822 2e22 2929 0a20 2020 2020  trip(".")).     
-00014080: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
-00014090: 2020 2020 2020 2023 2063 6c69 656e 7420         # client 
-000140a0: 6973 206f 6c64 2061 6e64 2077 6520 6f6e  is old and we on
-000140b0: 6c79 2068 6176 6520 2e62 720a 2020 2020  ly have .br.    
-000140c0: 2020 2020 2020 2020 2320 2863 6f75 6c64          # (could
-000140d0: 206d 616b 6520 6272 6f74 6c69 2061 2064   make brotli a d
-000140e0: 6570 2074 6f20 6669 7820 7468 6973 2062  ep to fix this b
-000140f0: 7574 2069 7427 7320 6e6f 7420 776f 7274  ut it's not wort
-00014100: 6829 0a20 2020 2020 2020 2020 2020 2072  h).            r
-00014110: 6169 7365 2050 6562 6b61 6328 3430 3429  aise Pebkac(404)
-00014120: 0a0a 2020 2020 2020 2020 230a 2020 2020  ..        #.    
-00014130: 2020 2020 2320 7061 7274 6961 6c0a 0a20      # partial.. 
-00014140: 2020 2020 2020 206c 6f77 6572 203d 2030         lower = 0
-00014150: 0a20 2020 2020 2020 2075 7070 6572 203d  .        upper =
-00014160: 2066 696c 655f 737a 0a20 2020 2020 2020   file_sz.       
-00014170: 2068 7261 6e67 6520 3d20 7365 6c66 2e68   hrange = self.h
-00014180: 6561 6465 7273 2e67 6574 2822 7261 6e67  eaders.get("rang
-00014190: 6522 290a 0a20 2020 2020 2020 2023 206c  e")..        # l
-000141a0: 6574 2773 206e 6f74 2073 7570 706f 7274  et's not support
-000141b0: 2032 3036 2077 6974 6820 636f 6d70 7265   206 with compre
-000141c0: 7373 696f 6e0a 2020 2020 2020 2020 6966  ssion.        if
-000141d0: 2064 6f5f 7365 6e64 2061 6e64 206e 6f74   do_send and not
-000141e0: 2069 735f 636f 6d70 7265 7373 6564 2061   is_compressed a
-000141f0: 6e64 2068 7261 6e67 6520 616e 6420 6669  nd hrange and fi
-00014200: 6c65 5f73 7a3a 0a20 2020 2020 2020 2020  le_sz:.         
-00014210: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00014220: 2020 2020 2020 2020 612c 2062 203d 2068          a, b = h
-00014230: 7261 6e67 652e 7370 6c69 7428 223d 222c  range.split("=",
-00014240: 2031 295b 315d 2e73 706c 6974 2822 2d22   1)[1].split("-"
-00014250: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00014260: 2020 2069 6620 612e 7374 7269 7028 293a     if a.strip():
-00014270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014280: 2020 2020 206c 6f77 6572 203d 2069 6e74       lower = int
-00014290: 2861 2e73 7472 6970 2829 290a 2020 2020  (a.strip()).    
-000142a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000142b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000142c0: 2020 2020 2020 6c6f 7765 7220 3d20 300a        lower = 0.
-000142d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000142e0: 2069 6620 622e 7374 7269 7028 293a 0a20   if b.strip():. 
-000142f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014300: 2020 2075 7070 6572 203d 2069 6e74 2862     upper = int(b
-00014310: 2e73 7472 6970 2829 2920 2b20 310a 2020  .strip()) + 1.  
-00014320: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00014330: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00014340: 2020 2020 2020 2020 7570 7065 7220 3d20          upper = 
-00014350: 6669 6c65 5f73 7a0a 0a20 2020 2020 2020  file_sz..       
-00014360: 2020 2020 2020 2020 2069 6620 7570 7065           if uppe
-00014370: 7220 3e20 6669 6c65 5f73 7a3a 0a20 2020  r > file_sz:.   
-00014380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014390: 2075 7070 6572 203d 2066 696c 655f 737a   upper = file_sz
-000143a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000143b0: 2020 6966 206c 6f77 6572 203c 2030 206f    if lower < 0 o
-000143c0: 7220 6c6f 7765 7220 3e3d 2075 7070 6572  r lower >= upper
-000143d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000143e0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
-000143f0: 7074 696f 6e28 290a 0a20 2020 2020 2020  ption()..       
-00014400: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00014410: 2020 2020 2020 2020 2020 2020 2065 7272               err
-00014420: 203d 2022 696e 7661 6c69 6420 7261 6e67   = "invalid rang
-00014430: 6520 287b 7d29 2c20 7369 7a65 3d7b 7d22  e ({}), size={}"
-00014440: 2e66 6f72 6d61 7428 6872 616e 6765 2c20  .format(hrange, 
-00014450: 6669 6c65 5f73 7a29 0a20 2020 2020 2020  file_sz).       
-00014460: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00014470: 7564 5f72 6570 6c79 280a 2020 2020 2020  ud_reply(.      
-00014480: 2020 2020 2020 2020 2020 2020 2020 6572                er
-00014490: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-000144a0: 2020 2020 2020 2073 7461 7475 733d 3431         status=41
-000144b0: 362c 0a20 2020 2020 2020 2020 2020 2020  6,.             
-000144c0: 2020 2020 2020 2068 6561 6465 7273 3d7b         headers={
-000144d0: 2243 6f6e 7465 6e74 2d52 616e 6765 223a  "Content-Range":
-000144e0: 2022 6279 7465 7320 2a2f 7b7d 222e 666f   "bytes */{}".fo
-000144f0: 726d 6174 2866 696c 655f 737a 297d 2c0a  rmat(file_sz)},.
-00014500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014510: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00014520: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
-00014530: 2020 2020 2020 2020 2020 2073 7461 7475             statu
-00014540: 7320 3d20 3230 360a 2020 2020 2020 2020  s = 206.        
-00014550: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
-00014560: 6465 7273 5b22 436f 6e74 656e 742d 5261  ders["Content-Ra
-00014570: 6e67 6522 5d20 3d20 2262 7974 6573 207b  nge"] = "bytes {
-00014580: 7d2d 7b7d 2f7b 7d22 2e66 6f72 6d61 7428  }-{}/{}".format(
-00014590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000145a0: 206c 6f77 6572 2c20 7570 7065 7220 2d20   lower, upper - 
-000145b0: 312c 2066 696c 655f 737a 0a20 2020 2020  1, file_sz.     
-000145c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000145d0: 2020 2020 2020 6c6f 6774 6169 6c20 2b3d        logtail +=
-000145e0: 2022 205b 5c30 3333 5b33 366d 7b7d 2d7b   " [\033[36m{}-{
-000145f0: 7d5c 3033 335b 306d 5d22 2e66 6f72 6d61  }\033[0m]".forma
-00014600: 7428 6c6f 7765 722c 2075 7070 6572 290a  t(lower, upper).
-00014610: 0a20 2020 2020 2020 2075 7365 5f73 656e  .        use_sen
-00014620: 6466 696c 6520 3d20 4661 6c73 650a 2020  dfile = False.  
-00014630: 2020 2020 2020 6966 2064 6563 6f6d 7072        if decompr
-00014640: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
-00014650: 206f 7065 6e5f 6675 6e63 2020 3d20 677a   open_func  = gz
-00014660: 6970 2e6f 7065 6e0a 2020 2020 2020 2020  ip.open.        
-00014670: 2020 2020 6f70 656e 5f61 7267 7320 203d      open_args  =
-00014680: 205b 6673 656e 6328 6673 5f70 6174 6829   [fsenc(fs_path)
-00014690: 2c20 2272 6222 5d0a 2020 2020 2020 2020  , "rb"].        
-000146a0: 2020 2020 2320 436f 6e74 656e 742d 4c65      # Content-Le
-000146b0: 6e67 7468 203a 3d20 6f72 6967 696e 616c  ngth := original
-000146c0: 2066 696c 6520 7369 7a65 0a20 2020 2020   file size.     
-000146d0: 2020 2020 2020 2075 7070 6572 203d 2067         upper = g
-000146e0: 7a69 705f 6f72 6967 5f73 7a28 6673 5f70  zip_orig_sz(fs_p
-000146f0: 6174 6829 0a20 2020 2020 2020 2065 6c73  ath).        els
-00014700: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
-00014710: 7065 6e5f 6675 6e63 203d 206f 7065 6e0a  pen_func = open.
-00014720: 2020 2020 2020 2020 2020 2020 2320 3531              # 51
-00014730: 3220 6b42 2069 7320 6f70 7469 6d61 6c20  2 kB is optimal 
-00014740: 666f 7220 6875 6765 2066 696c 6573 2c20  for huge files, 
-00014750: 7573 6520 3634 6b0a 2020 2020 2020 2020  use 64k.        
-00014760: 2020 2020 6f70 656e 5f61 7267 7320 3d20      open_args = 
-00014770: 5b66 7365 6e63 2866 735f 7061 7468 292c  [fsenc(fs_path),
-00014780: 2022 7262 222c 2036 3420 2a20 3130 3234   "rb", 64 * 1024
-00014790: 5d0a 2020 2020 2020 2020 2020 2020 7573  ].            us
-000147a0: 655f 7365 6e64 6669 6c65 203d 2028 0a20  e_sendfile = (. 
-000147b0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000147c0: 6f74 2073 656c 662e 746c 7320 2023 0a20  ot self.tls  #. 
-000147d0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000147e0: 6e64 206e 6f74 2073 656c 662e 6172 6773  nd not self.args
-000147f0: 2e6e 6f5f 7365 6e64 6669 6c65 0a20 2020  .no_sendfile.   
-00014800: 2020 2020 2020 2020 2020 2020 2061 6e64               and
-00014810: 2068 6173 6174 7472 286f 732c 2022 7365   hasattr(os, "se
-00014820: 6e64 6669 6c65 2229 0a20 2020 2020 2020  ndfile").       
-00014830: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00014840: 230a 2020 2020 2020 2020 2320 7365 6e64  #.        # send
-00014850: 2072 6570 6c79 0a0a 2020 2020 2020 2020   reply..        
-00014860: 6966 2069 735f 636f 6d70 7265 7373 6564  if is_compressed
-00014870: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00014880: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
-00014890: 4361 6368 652d 436f 6e74 726f 6c22 5d20  Cache-Control"] 
-000148a0: 3d20 226d 6178 2d61 6765 3d36 3034 3836  = "max-age=60486
-000148b0: 3922 0a20 2020 2020 2020 2065 6c73 653a  9".        else:
-000148c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000148d0: 662e 7065 726d 6974 5f63 6163 6869 6e67  f.permit_caching
-000148e0: 2829 0a0a 2020 2020 2020 2020 6966 2022  ()..        if "
-000148f0: 7478 7422 2069 6e20 7365 6c66 2e75 7061  txt" in self.upa
-00014900: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
-00014910: 206d 696d 6520 3d20 2274 6578 742f 706c   mime = "text/pl
-00014920: 6169 6e3b 2063 6861 7273 6574 3d7b 7d22  ain; charset={}"
-00014930: 2e66 6f72 6d61 7428 7365 6c66 2e75 7061  .format(self.upa
-00014940: 7261 6d5b 2274 7874 225d 206f 7220 2275  ram["txt"] or "u
-00014950: 7466 2d38 2229 0a20 2020 2020 2020 2065  tf-8").        e
-00014960: 6c69 6620 226d 696d 6522 2069 6e20 7365  lif "mime" in se
-00014970: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
-00014980: 2020 2020 2020 206d 696d 6520 3d20 7374         mime = st
-00014990: 7228 7365 6c66 2e75 7061 7261 6d2e 6765  r(self.uparam.ge
-000149a0: 7428 226d 696d 6522 2929 0a20 2020 2020  t("mime")).     
-000149b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000149c0: 2020 2020 206d 696d 6520 3d20 6775 6573       mime = gues
-000149d0: 735f 6d69 6d65 2872 6571 5f70 6174 6829  s_mime(req_path)
-000149e0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
-000149f0: 7574 5f68 6561 6465 7273 5b22 4163 6365  ut_headers["Acce
-00014a00: 7074 2d52 616e 6765 7322 5d20 3d20 2262  pt-Ranges"] = "b
-00014a10: 7974 6573 220a 2020 2020 2020 2020 7365  ytes".        se
-00014a20: 6c66 2e73 656e 645f 6865 6164 6572 7328  lf.send_headers(
-00014a30: 6c65 6e67 7468 3d75 7070 6572 202d 206c  length=upper - l
-00014a40: 6f77 6572 2c20 7374 6174 7573 3d73 7461  ower, status=sta
-00014a50: 7475 732c 206d 696d 653d 6d69 6d65 290a  tus, mime=mime).
-00014a60: 0a20 2020 2020 2020 206c 6f67 6d73 6720  .        logmsg 
-00014a70: 2b3d 2075 6e69 636f 6465 2873 7461 7475  += unicode(statu
-00014a80: 7329 202b 206c 6f67 7461 696c 0a0a 2020  s) + logtail..  
-00014a90: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
-00014aa0: 6465 203d 3d20 2248 4541 4422 206f 7220  de == "HEAD" or 
-00014ab0: 6e6f 7420 646f 5f73 656e 643a 0a20 2020  not do_send:.   
-00014ac0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00014ad0: 2e64 6f5f 6c6f 673a 0a20 2020 2020 2020  .do_log:.       
-00014ae0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-00014af0: 6728 6c6f 676d 7367 290a 0a20 2020 2020  g(logmsg)..     
-00014b00: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00014b10: 7565 0a0a 2020 2020 2020 2020 7265 7420  ue..        ret 
-00014b20: 3d20 5472 7565 0a20 2020 2020 2020 2077  = True.        w
-00014b30: 6974 6820 6f70 656e 5f66 756e 6328 2a6f  ith open_func(*o
-00014b40: 7065 6e5f 6172 6773 2920 6173 2066 3a0a  pen_args) as f:.
-00014b50: 2020 2020 2020 2020 2020 2020 7365 6e64              send
-00014b60: 6675 6e20 3d20 7365 6e64 6669 6c65 5f6b  fun = sendfile_k
-00014b70: 6572 6e20 6966 2075 7365 5f73 656e 6466  ern if use_sendf
-00014b80: 696c 6520 656c 7365 2073 656e 6466 696c  ile else sendfil
-00014b90: 655f 7079 0a20 2020 2020 2020 2020 2020  e_py.           
-00014ba0: 2072 656d 6169 6e73 203d 2073 656e 6466   remains = sendf
-00014bb0: 756e 280a 2020 2020 2020 2020 2020 2020  un(.            
-00014bc0: 2020 2020 7365 6c66 2e6c 6f67 2c20 6c6f      self.log, lo
-00014bd0: 7765 722c 2075 7070 6572 2c20 662c 2073  wer, upper, f, s
-00014be0: 656c 662e 732c 2073 656c 662e 6172 6773  elf.s, self.args
-00014bf0: 2e73 5f77 725f 737a 2c20 7365 6c66 2e61  .s_wr_sz, self.a
-00014c00: 7267 732e 735f 7772 5f73 6c70 0a20 2020  rgs.s_wr_slp.   
-00014c10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00014c20: 2020 2020 6966 2072 656d 6169 6e73 203e      if remains >
-00014c30: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-00014c40: 6c6f 676d 7367 202b 3d20 2220 5c30 3333  logmsg += " \033
-00014c50: 5b33 316d 2220 2b20 756e 6963 6f64 6528  [31m" + unicode(
-00014c60: 7570 7065 7220 2d20 7265 6d61 696e 7329  upper - remains)
-00014c70: 202b 2022 5c30 3333 5b30 6d22 0a20 2020   + "\033[0m".   
-00014c80: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
-00014c90: 6570 616c 6976 6520 3d20 4661 6c73 650a  epalive = False.
-00014ca0: 0a20 2020 2020 2020 2073 7064 203d 2073  .        spd = s
-00014cb0: 656c 662e 5f73 7064 2828 7570 7065 7220  elf._spd((upper 
-00014cc0: 2d20 6c6f 7765 7229 202d 2072 656d 6169  - lower) - remai
-00014cd0: 6e73 290a 2020 2020 2020 2020 6966 2073  ns).        if s
-00014ce0: 656c 662e 646f 5f6c 6f67 3a0a 2020 2020  elf.do_log:.    
-00014cf0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00014d00: 2822 7b7d 2c20 207b 7d22 2e66 6f72 6d61  ("{},  {}".forma
-00014d10: 7428 6c6f 676d 7367 2c20 7370 6429 290a  t(logmsg, spd)).
-00014d20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00014d30: 7265 740a 0a20 2020 2064 6566 2074 785f  ret..    def tx_
-00014d40: 7a69 7028 0a20 2020 2020 2020 2073 656c  zip(.        sel
-00014d50: 662c 2066 6d74 202c 2075 6172 6720 2c20  f, fmt , uarg , 
-00014d60: 766e 202c 2072 656d 202c 2069 7465 6d73  vn , rem , items
-00014d70: 202c 2064 6f74 7320 0a20 2020 2029 2020   , dots .    )  
-00014d80: 3a0a 2020 2020 2020 2020 6966 2073 656c  :.        if sel
-00014d90: 662e 6172 6773 2e6e 6f5f 7a69 703a 0a20  f.args.no_zip:. 
-00014da0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00014db0: 2050 6562 6b61 6328 3430 302c 2022 6e6f   Pebkac(400, "no
-00014dc0: 7420 656e 6162 6c65 6422 290a 0a20 2020  t enabled")..   
-00014dd0: 2020 2020 206c 6f67 6d73 6720 3d20 227b       logmsg = "{
-00014de0: 3a34 7d20 7b7d 2022 2e66 6f72 6d61 7428  :4} {} ".format(
-00014df0: 2222 2c20 7365 6c66 2e72 6571 290a 2020  "", self.req).  
-00014e00: 2020 2020 2020 7365 6c66 2e6b 6565 7061        self.keepa
-00014e10: 6c69 7665 203d 2046 616c 7365 0a0a 2020  live = False..  
-00014e20: 2020 2020 2020 6966 2066 6d74 203d 3d20        if fmt == 
-00014e30: 2274 6172 223a 0a20 2020 2020 2020 2020  "tar":.         
-00014e40: 2020 206d 696d 6520 3d20 2261 7070 6c69     mime = "appli
-00014e50: 6361 7469 6f6e 2f78 2d74 6172 220a 2020  cation/x-tar".  
-00014e60: 2020 2020 2020 2020 2020 7061 636b 6572            packer
-00014e70: 2020 3d20 5374 7265 616d 5461 720a 2020    = StreamTar.  
-00014e80: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014e90: 2020 2020 2020 2020 6d69 6d65 203d 2022          mime = "
-00014ea0: 6170 706c 6963 6174 696f 6e2f 7a69 7022  application/zip"
-00014eb0: 0a20 2020 2020 2020 2020 2020 2070 6163  .            pac
-00014ec0: 6b65 7220 3d20 5374 7265 616d 5a69 700a  ker = StreamZip.
-00014ed0: 0a20 2020 2020 2020 2066 6e20 3d20 6974  .        fn = it
-00014ee0: 656d 735b 305d 2069 6620 6974 656d 7320  ems[0] if items 
-00014ef0: 616e 6420 6974 656d 735b 305d 2065 6c73  and items[0] els
-00014f00: 6520 7365 6c66 2e76 7061 7468 0a20 2020  e self.vpath.   
-00014f10: 2020 2020 2069 6620 666e 3a0a 2020 2020       if fn:.    
-00014f20: 2020 2020 2020 2020 666e 203d 2066 6e2e          fn = fn.
-00014f30: 7273 7472 6970 2822 2f22 292e 7370 6c69  rstrip("/").spli
-00014f40: 7428 222f 2229 5b2d 315d 0a20 2020 2020  t("/")[-1].     
-00014f50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00014f60: 2020 2020 2066 6e20 3d20 7365 6c66 2e68       fn = self.h
-00014f70: 6f73 742e 7370 6c69 7428 223a 2229 5b30  ost.split(":")[0
-00014f80: 5d0a 0a20 2020 2020 2020 2073 6166 6520  ]..        safe 
-00014f90: 3d20 2873 7472 696e 672e 6173 6369 695f  = (string.ascii_
-00014fa0: 6c65 7474 6572 7320 2b20 7374 7269 6e67  letters + string
-00014fb0: 2e64 6967 6974 7329 2e72 6570 6c61 6365  .digits).replace
-00014fc0: 2822 2522 2c20 2222 290a 2020 2020 2020  ("%", "").      
-00014fd0: 2020 6166 6e20 3d20 2222 2e6a 6f69 6e28    afn = "".join(
-00014fe0: 5b78 2069 6620 7820 696e 2073 6166 652e  [x if x in safe.
-00014ff0: 7265 706c 6163 6528 2722 272c 2022 2229  replace('"', "")
-00015000: 2065 6c73 6520 225f 2220 666f 7220 7820   else "_" for x 
-00015010: 696e 2066 6e5d 290a 2020 2020 2020 2020  in fn]).        
-00015020: 6261 7363 6969 203d 2075 6e69 636f 6465  bascii = unicode
-00015030: 2873 6166 6529 2e65 6e63 6f64 6528 2275  (safe).encode("u
-00015040: 7466 2d38 2229 0a20 2020 2020 2020 207a  tf-8").        z
-00015050: 6220 3d20 666e 2e65 6e63 6f64 6528 2275  b = fn.encode("u
-00015060: 7466 2d38 222c 2022 786d 6c63 6861 7272  tf-8", "xmlcharr
-00015070: 6566 7265 706c 6163 6522 290a 2020 2020  efreplace").    
-00015080: 2020 2020 6966 206e 6f74 2050 5932 3a0a      if not PY2:.
-00015090: 2020 2020 2020 2020 2020 2020 7a62 6c20              zbl 
-000150a0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-000150b0: 2020 2020 6368 7228 7829 2e65 6e63 6f64      chr(x).encod
-000150c0: 6528 2275 7466 2d38 2229 0a20 2020 2020  e("utf-8").     
-000150d0: 2020 2020 2020 2020 2020 2069 6620 7820             if x 
-000150e0: 696e 2062 6173 6369 690a 2020 2020 2020  in bascii.      
-000150f0: 2020 2020 2020 2020 2020 656c 7365 2022            else "
-00015100: 257b 3a30 3278 7d22 2e66 6f72 6d61 7428  %{:02x}".format(
-00015110: 7829 2e65 6e63 6f64 6528 2261 7363 6969  x).encode("ascii
-00015120: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00015130: 2020 2066 6f72 2078 2069 6e20 7a62 0a20     for x in zb. 
-00015140: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00015150: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00015160: 2020 2020 2020 207a 626c 203d 205b 756e         zbl = [un
-00015170: 6963 6f64 6528 7829 2069 6620 7820 696e  icode(x) if x in
-00015180: 2062 6173 6369 6920 656c 7365 2022 257b   bascii else "%{
-00015190: 3a30 3278 7d22 2e66 6f72 6d61 7428 6f72  :02x}".format(or
-000151a0: 6428 7829 2920 666f 7220 7820 696e 207a  d(x)) for x in z
-000151b0: 625d 0a0a 2020 2020 2020 2020 7566 6e20  b]..        ufn 
-000151c0: 3d20 6222 222e 6a6f 696e 287a 626c 292e  = b"".join(zbl).
-000151d0: 6465 636f 6465 2822 6173 6369 6922 290a  decode("ascii").
-000151e0: 0a20 2020 2020 2020 2063 6469 7320 3d20  .        cdis = 
-000151f0: 2261 7474 6163 686d 656e 743b 2066 696c  "attachment; fil
-00015200: 656e 616d 653d 5c22 7b7d 2e7b 7d5c 223b  ename=\"{}.{}\";
-00015210: 2066 696c 656e 616d 652a 3d55 5446 2d38   filename*=UTF-8
-00015220: 2727 7b7d 2e7b 7d22 0a20 2020 2020 2020  ''{}.{}".       
-00015230: 2063 6469 7320 3d20 6364 6973 2e66 6f72   cdis = cdis.for
-00015240: 6d61 7428 6166 6e2c 2066 6d74 2c20 7566  mat(afn, fmt, uf
-00015250: 6e2c 2066 6d74 290a 2020 2020 2020 2020  n, fmt).        
-00015260: 7365 6c66 2e6c 6f67 2863 6469 7329 0a20  self.log(cdis). 
-00015270: 2020 2020 2020 2073 656c 662e 7365 6e64         self.send
-00015280: 5f68 6561 6465 7273 284e 6f6e 652c 206d  _headers(None, m
-00015290: 696d 653d 6d69 6d65 2c20 6865 6164 6572  ime=mime, header
-000152a0: 733d 7b22 436f 6e74 656e 742d 4469 7370  s={"Content-Disp
-000152b0: 6f73 6974 696f 6e22 3a20 6364 6973 7d29  osition": cdis})
-000152c0: 0a0a 2020 2020 2020 2020 6667 656e 203d  ..        fgen =
-000152d0: 2076 6e2e 7a69 7067 656e 280a 2020 2020   vn.zipgen(.    
-000152e0: 2020 2020 2020 2020 7265 6d2c 2073 6574          rem, set
-000152f0: 2869 7465 6d73 292c 2073 656c 662e 756e  (items), self.un
-00015300: 616d 652c 2046 616c 7365 2c20 646f 7473  ame, False, dots
-00015310: 2c20 6e6f 7420 7365 6c66 2e61 7267 732e  , not self.args.
-00015320: 6e6f 5f73 6361 6e64 6972 0a20 2020 2020  no_scandir.     
-00015330: 2020 2029 0a20 2020 2020 2020 2023 2066     ).        # f
-00015340: 6f72 2066 2069 6e20 6667 656e 3a20 7072  or f in fgen: pr
-00015350: 696e 7428 7265 7072 287b 6b3a 2066 5b6b  int(repr({k: f[k
-00015360: 5d20 666f 7220 6b20 696e 205b 2276 7022  ] for k in ["vp"
-00015370: 2c20 2261 7022 5d7d 2929 0a20 2020 2020  , "ap"]})).     
-00015380: 2020 2062 6765 6e20 3d20 7061 636b 6572     bgen = packer
-00015390: 2873 656c 662e 6c6f 672c 2066 6765 6e2c  (self.log, fgen,
-000153a0: 2075 7466 383d 2275 7466 2220 696e 2075   utf8="utf" in u
-000153b0: 6172 672c 2070 7265 5f63 7263 3d22 6372  arg, pre_crc="cr
-000153c0: 6322 2069 6e20 7561 7267 290a 2020 2020  c" in uarg).    
-000153d0: 2020 2020 6273 656e 7420 3d20 300a 2020      bsent = 0.  
-000153e0: 2020 2020 2020 666f 7220 6275 6620 696e        for buf in
-000153f0: 2062 6765 6e2e 6765 6e28 293a 0a20 2020   bgen.gen():.   
-00015400: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00015410: 6275 663a 0a20 2020 2020 2020 2020 2020  buf:.           
-00015420: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
-00015430: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00015440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00015450: 662e 732e 7365 6e64 616c 6c28 6275 6629  f.s.sendall(buf)
-00015460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015470: 2062 7365 6e74 202b 3d20 6c65 6e28 6275   bsent += len(bu
-00015480: 6629 0a20 2020 2020 2020 2020 2020 2065  f).            e
-00015490: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
-000154a0: 2020 2020 2020 206c 6f67 6d73 6720 2b3d         logmsg +=
-000154b0: 2022 205c 3033 335b 3331 6d22 202b 2075   " \033[31m" + u
-000154c0: 6e69 636f 6465 2862 7365 6e74 2920 2b20  nicode(bsent) + 
-000154d0: 225c 3033 335b 306d 220a 2020 2020 2020  "\033[0m".      
-000154e0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-000154f0: 0a20 2020 2020 2020 2073 7064 203d 2073  .        spd = s
-00015500: 656c 662e 5f73 7064 2862 7365 6e74 290a  elf._spd(bsent).
-00015510: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-00015520: 2822 7b7d 2c20 207b 7d22 2e66 6f72 6d61  ("{},  {}".forma
-00015530: 7428 6c6f 676d 7367 2c20 7370 6429 290a  t(logmsg, spd)).
-00015540: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00015550: 7275 650a 0a20 2020 2064 6566 2074 785f  rue..    def tx_
-00015560: 6963 6f28 7365 6c66 2c20 6578 7420 2c20  ico(self, ext , 
-00015570: 6578 6163 7420 203d 2046 616c 7365 2920  exact  = False) 
-00015580: 203a 0a20 2020 2020 2020 2073 656c 662e   :.        self.
-00015590: 7065 726d 6974 5f63 6163 6869 6e67 2829  permit_caching()
-000155a0: 0a20 2020 2020 2020 2069 6620 6578 742e  .        if ext.
-000155b0: 656e 6473 7769 7468 2822 2f22 293a 0a20  endswith("/"):. 
-000155c0: 2020 2020 2020 2020 2020 2065 7874 203d             ext =
-000155d0: 2022 666f 6c64 6572 220a 2020 2020 2020   "folder".      
-000155e0: 2020 2020 2020 6578 6163 7420 3d20 5472        exact = Tr
-000155f0: 7565 0a0a 2020 2020 2020 2020 6261 6420  ue..        bad 
-00015600: 3d20 7265 2e63 6f6d 7069 6c65 2872 225b  = re.compile(r"[
-00015610: 5d28 297b 7d2f 205b 5d7c 5e5b 302d 395f  ](){}/ []|^[0-9_
-00015620: 2d5d 2a24 2229 0a20 2020 2020 2020 206e  -]*$").        n
-00015630: 203d 2065 7874 2e73 706c 6974 2822 2e22   = ext.split("."
-00015640: 295b 3a3a 2d31 5d0a 2020 2020 2020 2020  )[::-1].        
-00015650: 6966 206e 6f74 2065 7861 6374 3a0a 2020  if not exact:.  
-00015660: 2020 2020 2020 2020 2020 6e20 3d20 6e5b            n = n[
-00015670: 3a2d 315d 0a0a 2020 2020 2020 2020 6578  :-1]..        ex
-00015680: 7420 3d20 2222 0a20 2020 2020 2020 2066  t = "".        f
-00015690: 6f72 2076 2069 6e20 6e3a 0a20 2020 2020  or v in n:.     
-000156a0: 2020 2020 2020 2069 6620 6c65 6e28 7629         if len(v)
-000156b0: 203e 2037 206f 7220 6261 642e 7365 6172   > 7 or bad.sear
-000156c0: 6368 2876 293a 0a20 2020 2020 2020 2020  ch(v):.         
-000156d0: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
-000156e0: 2020 2020 2020 2020 2020 6578 7420 3d20            ext = 
-000156f0: 227b 7d2e 7b7d 222e 666f 726d 6174 2876  "{}.{}".format(v
-00015700: 2c20 6578 7429 0a0a 2020 2020 2020 2020  , ext)..        
-00015710: 6578 7420 3d20 6578 742e 7273 7472 6970  ext = ext.rstrip
-00015720: 2822 2e22 2920 6f72 2022 756e 6b22 0a20  (".") or "unk". 
-00015730: 2020 2020 2020 2069 6620 6c65 6e28 6578         if len(ex
-00015740: 7429 203e 2031 313a 0a20 2020 2020 2020  t) > 11:.       
-00015750: 2020 2020 2065 7874 203d 2022 e28b af22       ext = "..."
-00015760: 202b 2065 7874 5b2d 393a 5d0a 0a20 2020   + ext[-9:]..   
-00015770: 2020 2020 2023 2063 6872 6f6d 6520 6361       # chrome ca
-00015780: 6e6e 6f74 2068 616e 646c 6520 6d6f 7265  nnot handle more
-00015790: 2074 6861 6e20 7e32 3030 3020 756e 6971   than ~2000 uniq
-000157a0: 7565 2053 5647 730a 2020 2020 2020 2020  ue SVGs.        
-000157b0: 6368 726f 6d65 203d 2022 2072 763a 2220  chrome = " rv:" 
-000157c0: 6e6f 7420 696e 2073 656c 662e 7561 0a20  not in self.ua. 
-000157d0: 2020 2020 2020 206d 696d 652c 2069 636f         mime, ico
-000157e0: 203d 2073 656c 662e 6963 6f2e 6765 7428   = self.ico.get(
-000157f0: 6578 742c 206e 6f74 2065 7861 6374 2c20  ext, not exact, 
-00015800: 6368 726f 6d65 290a 0a20 2020 2020 2020  chrome)..       
-00015810: 206c 6d20 3d20 666f 726d 6174 6461 7465   lm = formatdate
-00015820: 2873 656c 662e 452e 7430 2c20 7573 6567  (self.E.t0, useg
-00015830: 6d74 3d54 7275 6529 0a20 2020 2020 2020  mt=True).       
-00015840: 2073 656c 662e 7265 706c 7928 6963 6f2c   self.reply(ico,
-00015850: 206d 696d 653d 6d69 6d65 2c20 6865 6164   mime=mime, head
-00015860: 6572 733d 7b22 4c61 7374 2d4d 6f64 6966  ers={"Last-Modif
-00015870: 6965 6422 3a20 6c6d 7d29 0a20 2020 2020  ied": lm}).     
-00015880: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-00015890: 2020 2020 6465 6620 7478 5f6d 6428 7365      def tx_md(se
-000158a0: 6c66 2c20 6673 5f70 6174 6820 2920 203a  lf, fs_path )  :
-000158b0: 0a20 2020 2020 2020 206c 6f67 6d73 6720  .        logmsg 
-000158c0: 3d20 227b 3a34 7d20 7b7d 2022 2e66 6f72  = "{:4} {} ".for
-000158d0: 6d61 7428 2222 2c20 7365 6c66 2e72 6571  mat("", self.req
-000158e0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-000158f0: 7420 7365 6c66 2e63 616e 5f77 7269 7465  t self.can_write
-00015900: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00015910: 2022 6564 6974 2220 696e 2073 656c 662e   "edit" in self.
-00015920: 7570 6172 616d 206f 7220 2265 6469 7432  uparam or "edit2
-00015930: 2220 696e 2073 656c 662e 7570 6172 616d  " in self.uparam
-00015940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015950: 2020 7265 7475 726e 2073 656c 662e 7478    return self.tx
-00015960: 5f34 3034 2854 7275 6529 0a0a 2020 2020  _404(True)..    
-00015970: 2020 2020 7470 6c20 3d20 226d 6465 2220      tpl = "mde" 
-00015980: 6966 2022 6564 6974 3222 2069 6e20 7365  if "edit2" in se
-00015990: 6c66 2e75 7061 7261 6d20 656c 7365 2022  lf.uparam else "
-000159a0: 6d64 220a 2020 2020 2020 2020 6874 6d6c  md".        html
-000159b0: 5f70 6174 6820 3d20 6f73 2e70 6174 682e  _path = os.path.
-000159c0: 6a6f 696e 2873 656c 662e 452e 6d6f 642c  join(self.E.mod,
-000159d0: 2022 7765 6222 2c20 227b 7d2e 6874 6d6c   "web", "{}.html
-000159e0: 222e 666f 726d 6174 2874 706c 2929 0a20  ".format(tpl)). 
-000159f0: 2020 2020 2020 2074 656d 706c 6174 6520         template 
-00015a00: 3d20 7365 6c66 2e6a 326a 2874 706c 290a  = self.j2j(tpl).
-00015a10: 0a20 2020 2020 2020 2073 7420 3d20 626f  .        st = bo
-00015a20: 732e 7374 6174 2866 735f 7061 7468 290a  s.stat(fs_path).
-00015a30: 2020 2020 2020 2020 7473 5f6d 6420 3d20          ts_md = 
-00015a40: 7374 2e73 745f 6d74 696d 650a 0a20 2020  st.st_mtime..   
-00015a50: 2020 2020 2073 7420 3d20 626f 732e 7374       st = bos.st
-00015a60: 6174 2868 746d 6c5f 7061 7468 290a 2020  at(html_path).  
-00015a70: 2020 2020 2020 7473 5f68 746d 6c20 3d20        ts_html = 
-00015a80: 7374 2e73 745f 6d74 696d 650a 0a20 2020  st.st_mtime..   
-00015a90: 2020 2020 2073 7a5f 6d64 203d 2030 0a20       sz_md = 0. 
-00015aa0: 2020 2020 2020 2066 6f72 2062 7566 2069         for buf i
-00015ab0: 6e20 7969 656c 6466 696c 6528 6673 5f70  n yieldfile(fs_p
-00015ac0: 6174 6829 3a0a 2020 2020 2020 2020 2020  ath):.          
-00015ad0: 2020 737a 5f6d 6420 2b3d 206c 656e 2862    sz_md += len(b
-00015ae0: 7566 290a 2020 2020 2020 2020 2020 2020  uf).            
-00015af0: 666f 7220 632c 2076 2069 6e20 5b28 6222  for c, v in [(b"
-00015b00: 2622 2c20 3429 2c20 2862 223c 222c 2033  &", 4), (b"<", 3
-00015b10: 292c 2028 6222 3e22 2c20 3329 5d3a 0a20  ), (b">", 3)]:. 
-00015b20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00015b30: 7a5f 6d64 202b 3d20 286c 656e 2862 7566  z_md += (len(buf
-00015b40: 2920 2d20 6c65 6e28 6275 662e 7265 706c  ) - len(buf.repl
-00015b50: 6163 6528 632c 2062 2222 2929 2920 2a20  ace(c, b""))) * 
-00015b60: 760a 0a20 2020 2020 2020 2066 696c 655f  v..        file_
-00015b70: 7473 203d 2069 6e74 286d 6178 2874 735f  ts = int(max(ts_
-00015b80: 6d64 2c20 7473 5f68 746d 6c2c 2073 656c  md, ts_html, sel
-00015b90: 662e 452e 7430 2929 0a20 2020 2020 2020  f.E.t0)).       
-00015ba0: 2066 696c 655f 6c61 7374 6d6f 642c 2064   file_lastmod, d
-00015bb0: 6f5f 7365 6e64 203d 2073 656c 662e 5f63  o_send = self._c
-00015bc0: 686b 5f6c 6173 746d 6f64 2866 696c 655f  hk_lastmod(file_
-00015bd0: 7473 290a 2020 2020 2020 2020 7365 6c66  ts).        self
-00015be0: 2e6f 7574 5f68 6561 6465 7273 5b22 4c61  .out_headers["La
-00015bf0: 7374 2d4d 6f64 6966 6965 6422 5d20 3d20  st-Modified"] = 
-00015c00: 6669 6c65 5f6c 6173 746d 6f64 0a20 2020  file_lastmod.   
-00015c10: 2020 2020 2073 656c 662e 6f75 745f 6865       self.out_he
-00015c20: 6164 6572 732e 7570 6461 7465 284e 4f5f  aders.update(NO_
-00015c30: 4341 4348 4529 0a20 2020 2020 2020 2073  CACHE).        s
-00015c40: 7461 7475 7320 3d20 3230 3020 6966 2064  tatus = 200 if d
-00015c50: 6f5f 7365 6e64 2065 6c73 6520 3330 340a  o_send else 304.
-00015c60: 0a20 2020 2020 2020 2061 7267 5f62 6173  .        arg_bas
-00015c70: 6520 3d20 223f 220a 2020 2020 2020 2020  e = "?".        
-00015c80: 6966 2022 6b22 2069 6e20 7365 6c66 2e75  if "k" in self.u
-00015c90: 7061 7261 6d3a 0a20 2020 2020 2020 2020  param:.         
-00015ca0: 2020 2061 7267 5f62 6173 6520 3d20 223f     arg_base = "?
-00015cb0: 6b3d 7b7d 2622 2e66 6f72 6d61 7428 7365  k={}&".format(se
-00015cc0: 6c66 2e75 7061 7261 6d5b 226b 225d 290a  lf.uparam["k"]).
-00015cd0: 0a20 2020 2020 2020 2062 6f75 6e64 6172  .        boundar
-00015ce0: 7920 3d20 225c 726f 6c6c 5c74 6964 6522  y = "\roll\tide"
-00015cf0: 0a20 2020 2020 2020 2074 6172 6773 203d  .        targs =
-00015d00: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00015d10: 7222 3a20 7365 6c66 2e61 7267 732e 5352  r": self.args.SR
-00015d20: 2069 6620 7365 6c66 2e69 735f 7670 726f   if self.is_vpro
-00015d30: 7869 6564 2065 6c73 6520 2222 2c0a 2020  xied else "",.  
-00015d40: 2020 2020 2020 2020 2020 2274 7322 3a20            "ts": 
-00015d50: 7365 6c66 2e63 6f6e 6e2e 6873 7276 2e63  self.conn.hsrv.c
-00015d60: 6163 6865 6275 7374 6572 2829 2c0a 2020  achebuster(),.  
-00015d70: 2020 2020 2020 2020 2020 2273 7663 6e61            "svcna
-00015d80: 6d65 223a 2073 656c 662e 6172 6773 2e64  me": self.args.d
-00015d90: 6f63 7469 746c 652c 0a20 2020 2020 2020  octitle,.       
-00015da0: 2020 2020 2022 6874 6d6c 5f68 6561 6422       "html_head"
-00015db0: 3a20 7365 6c66 2e68 746d 6c5f 6865 6164  : self.html_head
-00015dc0: 2c0a 2020 2020 2020 2020 2020 2020 2265  ,.            "e
-00015dd0: 6469 7422 3a20 2265 6469 7422 2069 6e20  dit": "edit" in 
-00015de0: 7365 6c66 2e75 7061 7261 6d2c 0a20 2020  self.uparam,.   
-00015df0: 2020 2020 2020 2020 2022 7469 746c 6522           "title"
-00015e00: 3a20 6874 6d6c 5f65 7363 6170 6528 7365  : html_escape(se
-00015e10: 6c66 2e76 7061 7468 2c20 6372 6c66 3d54  lf.vpath, crlf=T
-00015e20: 7275 6529 2c0a 2020 2020 2020 2020 2020  rue),.          
-00015e30: 2020 226c 6173 746d 6f64 223a 2069 6e74    "lastmod": int
-00015e40: 2874 735f 6d64 202a 2031 3030 3029 2c0a  (ts_md * 1000),.
-00015e50: 2020 2020 2020 2020 2020 2020 226c 616e              "lan
-00015e60: 6722 3a20 7365 6c66 2e61 7267 732e 6c61  g": self.args.la
-00015e70: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-00015e80: 2266 6176 6963 6f22 3a20 7365 6c66 2e61  "favico": self.a
-00015e90: 7267 732e 6661 7669 636f 2c0a 2020 2020  rgs.favico,.    
-00015ea0: 2020 2020 2020 2020 2268 6176 655f 656d          "have_em
-00015eb0: 7022 3a20 7365 6c66 2e61 7267 732e 656d  p": self.args.em
-00015ec0: 702c 0a20 2020 2020 2020 2020 2020 2022  p,.            "
-00015ed0: 6d64 5f63 686b 5f72 6174 6522 3a20 7365  md_chk_rate": se
-00015ee0: 6c66 2e61 7267 732e 6d63 722c 0a20 2020  lf.args.mcr,.   
-00015ef0: 2020 2020 2020 2020 2022 6d64 223a 2062           "md": b
-00015f00: 6f75 6e64 6172 792c 0a20 2020 2020 2020  oundary,.       
-00015f10: 2020 2020 2022 6172 675f 6261 7365 223a       "arg_base":
-00015f20: 2061 7267 5f62 6173 652c 0a20 2020 2020   arg_base,.     
-00015f30: 2020 207d 0a20 2020 2020 2020 207a 7320     }.        zs 
-00015f40: 3d20 7465 6d70 6c61 7465 2e72 656e 6465  = template.rende
-00015f50: 7228 2a2a 7461 7267 7329 2e65 6e63 6f64  r(**targs).encod
-00015f60: 6528 2275 7466 2d38 222c 2022 7265 706c  e("utf-8", "repl
-00015f70: 6163 6522 290a 2020 2020 2020 2020 6874  ace").        ht
-00015f80: 6d6c 203d 207a 732e 7370 6c69 7428 626f  ml = zs.split(bo
-00015f90: 756e 6461 7279 2e65 6e63 6f64 6528 2275  undary.encode("u
-00015fa0: 7466 2d38 2229 290a 2020 2020 2020 2020  tf-8")).        
-00015fb0: 6966 206c 656e 2868 746d 6c29 2021 3d20  if len(html) != 
-00015fc0: 323a 0a20 2020 2020 2020 2020 2020 2072  2:.            r
-00015fd0: 6169 7365 2045 7863 6570 7469 6f6e 2822  aise Exception("
-00015fe0: 626f 756e 6461 7279 2061 7070 6561 7273  boundary appears
-00015ff0: 2069 6e20 2220 2b20 6874 6d6c 5f70 6174   in " + html_pat
-00016000: 6829 0a0a 2020 2020 2020 2020 7365 6c66  h)..        self
-00016010: 2e73 656e 645f 6865 6164 6572 7328 737a  .send_headers(sz
-00016020: 5f6d 6420 2b20 6c65 6e28 6874 6d6c 5b30  _md + len(html[0
-00016030: 5d29 202b 206c 656e 2868 746d 6c5b 315d  ]) + len(html[1]
-00016040: 292c 2073 7461 7475 7329 0a0a 2020 2020  ), status)..    
-00016050: 2020 2020 6c6f 676d 7367 202b 3d20 756e      logmsg += un
-00016060: 6963 6f64 6528 7374 6174 7573 290a 2020  icode(status).  
-00016070: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
-00016080: 6465 203d 3d20 2248 4541 4422 206f 7220  de == "HEAD" or 
-00016090: 6e6f 7420 646f 5f73 656e 643a 0a20 2020  not do_send:.   
-000160a0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000160b0: 2e64 6f5f 6c6f 673a 0a20 2020 2020 2020  .do_log:.       
-000160c0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-000160d0: 6728 6c6f 676d 7367 290a 0a20 2020 2020  g(logmsg)..     
-000160e0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-000160f0: 7565 0a0a 2020 2020 2020 2020 7472 793a  ue..        try:
-00016100: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00016110: 662e 732e 7365 6e64 616c 6c28 6874 6d6c  f.s.sendall(html
-00016120: 5b30 5d29 0a20 2020 2020 2020 2020 2020  [0]).           
-00016130: 2066 6f72 2062 7566 2069 6e20 7969 656c   for buf in yiel
-00016140: 6466 696c 6528 6673 5f70 6174 6829 3a0a  dfile(fs_path):.
-00016150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016160: 7365 6c66 2e73 2e73 656e 6461 6c6c 2868  self.s.sendall(h
-00016170: 746d 6c5f 6265 7363 6170 6528 6275 6629  tml_bescape(buf)
-00016180: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
-00016190: 656c 662e 732e 7365 6e64 616c 6c28 6874  elf.s.sendall(ht
-000161a0: 6d6c 5b31 5d29 0a0a 2020 2020 2020 2020  ml[1])..        
-000161b0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-000161c0: 2020 2020 7365 6c66 2e6c 6f67 286c 6f67      self.log(log
-000161d0: 6d73 6720 2b20 2220 5c30 3333 5b33 316d  msg + " \033[31m
-000161e0: 642f 635c 3033 335b 306d 2229 0a20 2020  d/c\033[0m").   
-000161f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00016200: 4661 6c73 650a 0a20 2020 2020 2020 2069  False..        i
-00016210: 6620 7365 6c66 2e64 6f5f 6c6f 673a 0a20  f self.do_log:. 
-00016220: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00016230: 6c6f 6728 6c6f 676d 7367 202b 2022 2022  log(logmsg + " "
-00016240: 202b 2075 6e69 636f 6465 286c 656e 2868   + unicode(len(h
-00016250: 746d 6c29 2929 0a0a 2020 2020 2020 2020  tml)))..        
-00016260: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00016270: 2064 6566 2074 785f 7376 6373 2873 656c   def tx_svcs(sel
-00016280: 6629 2020 3a0a 2020 2020 2020 2020 616e  f)  :.        an
-00016290: 616d 6520 3d20 7265 2e73 7562 2822 5b5e  ame = re.sub("[^
-000162a0: 302d 3961 2d7a 412d 5a5d 2b22 2c20 2222  0-9a-zA-Z]+", ""
-000162b0: 2c20 7365 6c66 2e61 7267 732e 6e61 6d65  , self.args.name
-000162c0: 2920 6f72 2022 6122 0a20 2020 2020 2020  ) or "a".       
-000162d0: 2065 7020 3d20 7365 6c66 2e68 6f73 740a   ep = self.host.
-000162e0: 2020 2020 2020 2020 686f 7374 203d 2065          host = e
-000162f0: 702e 7370 6c69 7428 223a 2229 5b30 5d0a  p.split(":")[0].
-00016300: 2020 2020 2020 2020 6870 6f72 7420 3d20          hport = 
-00016310: 6570 5b65 702e 6669 6e64 2822 3a22 2920  ep[ep.find(":") 
-00016320: 3a5d 2069 6620 223a 2220 696e 2065 7020  :] if ":" in ep 
-00016330: 656c 7365 2022 220a 2020 2020 2020 2020  else "".        
-00016340: 7269 7020 3d20 280a 2020 2020 2020 2020  rip = (.        
-00016350: 2020 2020 686f 7374 0a20 2020 2020 2020      host.       
-00016360: 2020 2020 2069 6620 7365 6c66 2e61 7267       if self.arg
-00016370: 732e 7263 6c6f 6e65 5f6d 646e 7320 6f72  s.rclone_mdns or
-00016380: 206e 6f74 2073 656c 662e 6172 6773 2e7a   not self.args.z
-00016390: 6d0a 2020 2020 2020 2020 2020 2020 656c  m.            el
-000163a0: 7365 2073 656c 662e 636f 6e6e 2e68 7372  se self.conn.hsr
-000163b0: 762e 6e6d 2e6d 6170 2873 656c 662e 6970  v.nm.map(self.ip
-000163c0: 2920 6f72 2068 6f73 740a 2020 2020 2020  ) or host.      
-000163d0: 2020 290a 2020 2020 2020 2020 7670 203d    ).        vp =
-000163e0: 2028 7365 6c66 2e75 7061 7261 6d5b 2268   (self.uparam["h
-000163f0: 6322 5d20 6f72 2022 2229 2e6c 7374 7269  c"] or "").lstri
-00016400: 7028 222f 2229 0a20 2020 2020 2020 2068  p("/").        h
-00016410: 746d 6c20 3d20 7365 6c66 2e6a 3273 280a  tml = self.j2s(.
-00016420: 2020 2020 2020 2020 2020 2020 2273 7663              "svc
-00016430: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
-00016440: 6172 6773 3d73 656c 662e 6172 6773 2c0a  args=self.args,.
-00016450: 2020 2020 2020 2020 2020 2020 6163 6373              accs
-00016460: 3d62 6f6f 6c28 7365 6c66 2e61 7372 762e  =bool(self.asrv.
-00016470: 6163 6374 292c 0a20 2020 2020 2020 2020  acct),.         
-00016480: 2020 2073 3d22 7322 2069 6620 7365 6c66     s="s" if self
-00016490: 2e69 735f 6874 7470 7320 656c 7365 2022  .is_https else "
-000164a0: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
-000164b0: 6970 3d72 6970 2c0a 2020 2020 2020 2020  ip=rip,.        
-000164c0: 2020 2020 6570 3d65 702c 0a20 2020 2020      ep=ep,.     
-000164d0: 2020 2020 2020 2076 703d 7670 2c0a 2020         vp=vp,.  
-000164e0: 2020 2020 2020 2020 2020 7276 703d 766a            rvp=vj
-000164f0: 6f69 6e28 7365 6c66 2e61 7267 732e 522c  oin(self.args.R,
-00016500: 2076 7029 2c0a 2020 2020 2020 2020 2020   vp),.          
-00016510: 2020 686f 7374 3d68 6f73 742c 0a20 2020    host=host,.   
-00016520: 2020 2020 2020 2020 2068 706f 7274 3d68           hport=h
-00016530: 706f 7274 2c0a 2020 2020 2020 2020 2020  port,.          
-00016540: 2020 616e 616d 653d 616e 616d 652c 0a20    aname=aname,. 
-00016550: 2020 2020 2020 2020 2020 2070 773d 7365             pw=se
-00016560: 6c66 2e70 7720 6f72 2022 7077 222c 0a20  lf.pw or "pw",. 
-00016570: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00016580: 2073 656c 662e 7265 706c 7928 6874 6d6c   self.reply(html
-00016590: 2e65 6e63 6f64 6528 2275 7466 2d38 2229  .encode("utf-8")
-000165a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000165b0: 2054 7275 650a 0a20 2020 2064 6566 2074   True..    def t
-000165c0: 785f 6d6f 756e 7473 2873 656c 6629 2020  x_mounts(self)  
-000165d0: 3a0a 2020 2020 2020 2020 7375 6620 3d20  :.        suf = 
-000165e0: 7365 6c66 2e75 726c 7128 7b7d 2c20 5b22  self.urlq({}, ["
-000165f0: 6822 5d29 0a20 2020 2020 2020 2061 766f  h"]).        avo
-00016600: 6c20 3d20 5b78 2066 6f72 2078 2069 6e20  l = [x for x in 
-00016610: 7365 6c66 2e77 766f 6c20 6966 2078 2069  self.wvol if x i
-00016620: 6e20 7365 6c66 2e72 766f 6c5d 0a20 2020  n self.rvol].   
-00016630: 2020 2020 2072 766f 6c2c 2077 766f 6c2c       rvol, wvol,
-00016640: 2061 766f 6c20 3d20 5b0a 2020 2020 2020   avol = [.      
-00016650: 2020 2020 2020 5b28 222f 2220 2b20 7829        [("/" + x)
-00016660: 2e72 7374 7269 7028 222f 2229 202b 2022  .rstrip("/") + "
-00016670: 2f22 2066 6f72 2078 2069 6e20 795d 0a20  /" for x in y]. 
-00016680: 2020 2020 2020 2020 2020 2066 6f72 2079             for y
-00016690: 2069 6e20 5b73 656c 662e 7276 6f6c 2c20   in [self.rvol, 
-000166a0: 7365 6c66 2e77 766f 6c2c 2061 766f 6c5d  self.wvol, avol]
-000166b0: 0a20 2020 2020 2020 205d 0a0a 2020 2020  .        ]..    
-000166c0: 2020 2020 6966 2061 766f 6c20 616e 6420      if avol and 
-000166d0: 6e6f 7420 7365 6c66 2e61 7267 732e 6e6f  not self.args.no
-000166e0: 5f72 6573 6361 6e3a 0a20 2020 2020 2020  _rescan:.       
-000166f0: 2020 2020 2078 203d 2073 656c 662e 636f       x = self.co
-00016700: 6e6e 2e68 7372 762e 6272 6f6b 6572 2e61  nn.hsrv.broker.a
-00016710: 736b 2822 7570 326b 2e67 6574 5f73 7461  sk("up2k.get_sta
-00016720: 7465 2229 0a20 2020 2020 2020 2020 2020  te").           
-00016730: 2076 7320 3d20 6a73 6f6e 2e6c 6f61 6473   vs = json.loads
-00016740: 2878 2e67 6574 2829 290a 2020 2020 2020  (x.get()).      
-00016750: 2020 2020 2020 7673 7461 7465 203d 207b        vstate = {
-00016760: 2822 2f22 202b 206b 292e 7273 7472 6970  ("/" + k).rstrip
-00016770: 2822 2f22 2920 2b20 222f 223a 2076 2066  ("/") + "/": v f
-00016780: 6f72 206b 2c20 7620 696e 2076 735b 2276  or k, v in vs["v
-00016790: 6f6c 7374 6174 6522 5d2e 6974 656d 7328  olstate"].items(
-000167a0: 297d 0a20 2020 2020 2020 2065 6c73 653a  )}.        else:
-000167b0: 0a20 2020 2020 2020 2020 2020 2076 7374  .            vst
-000167c0: 6174 6520 3d20 7b7d 0a20 2020 2020 2020  ate = {}.       
-000167d0: 2020 2020 2076 7320 3d20 7b0a 2020 2020       vs = {.    
-000167e0: 2020 2020 2020 2020 2020 2020 2273 6361              "sca
-000167f0: 6e6e 696e 6722 3a20 4e6f 6e65 2c0a 2020  nning": None,.  
-00016800: 2020 2020 2020 2020 2020 2020 2020 2268                "h
-00016810: 6173 6871 223a 204e 6f6e 652c 0a20 2020  ashq": None,.   
-00016820: 2020 2020 2020 2020 2020 2020 2022 7461               "ta
-00016830: 6771 223a 204e 6f6e 652c 0a20 2020 2020  gq": None,.     
-00016840: 2020 2020 2020 2020 2020 2022 6d74 7071             "mtpq
-00016850: 223a 204e 6f6e 652c 0a20 2020 2020 2020  ": None,.       
-00016860: 2020 2020 2020 2020 2022 6462 7774 223a           "dbwt":
-00016870: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-00016880: 2020 207d 0a0a 2020 2020 2020 2020 666d     }..        fm
-00016890: 7420 3d20 7365 6c66 2e75 7061 7261 6d2e  t = self.uparam.
-000168a0: 6765 7428 226c 7322 2c20 2222 290a 2020  get("ls", "").  
-000168b0: 2020 2020 2020 6966 206e 6f74 2066 6d74        if not fmt
-000168c0: 2061 6e64 2028 7365 6c66 2e75 612e 7374   and (self.ua.st
-000168d0: 6172 7473 7769 7468 2822 6375 726c 2f22  artswith("curl/"
-000168e0: 2920 6f72 2073 656c 662e 7561 2e73 7461  ) or self.ua.sta
-000168f0: 7274 7377 6974 6828 2266 6574 6368 2229  rtswith("fetch")
-00016900: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-00016910: 6d74 203d 2022 7622 0a0a 2020 2020 2020  mt = "v"..      
-00016920: 2020 6966 2066 6d74 2069 6e20 5b22 7622    if fmt in ["v"
-00016930: 2c20 2274 222c 2022 7478 7422 5d3a 0a20  , "t", "txt"]:. 
-00016940: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00016950: 6c66 2e75 6e61 6d65 203d 3d20 222a 223a  lf.uname == "*":
-00016960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016970: 2074 7874 203d 2022 686f 7764 7920 7374   txt = "howdy st
-00016980: 7261 6e67 6572 2028 796f 7527 7265 206e  ranger (you're n
-00016990: 6f74 206c 6f67 6765 6420 696e 2922 0a20  ot logged in)". 
-000169a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000169b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000169c0: 2074 7874 203d 2022 7765 6c63 6f6d 6520   txt = "welcome 
-000169d0: 6261 636b 207b 7d22 2e66 6f72 6d61 7428  back {}".format(
-000169e0: 7365 6c66 2e75 6e61 6d65 290a 0a20 2020  self.uname)..   
-000169f0: 2020 2020 2020 2020 2069 6620 7673 7461           if vsta
-00016a00: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-00016a10: 2020 2020 7478 7420 2b3d 2022 5c6e 7374      txt += "\nst
-00016a20: 6174 7573 3a22 0a20 2020 2020 2020 2020  atus:".         
-00016a30: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-00016a40: 5b22 7363 616e 6e69 6e67 222c 2022 6861  ["scanning", "ha
-00016a50: 7368 7122 2c20 2274 6167 7122 2c20 226d  shq", "tagq", "m
-00016a60: 7470 7122 2c20 2264 6277 7422 5d3a 0a20  tpq", "dbwt"]:. 
-00016a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a80: 2020 2074 7874 202b 3d20 2220 7b7d 287b     txt += " {}({
-00016a90: 7d29 222e 666f 726d 6174 286b 2c20 7673  })".format(k, vs
-00016aa0: 5b6b 5d29 0a0a 2020 2020 2020 2020 2020  [k])..          
-00016ab0: 2020 6966 2072 766f 6c3a 0a20 2020 2020    if rvol:.     
-00016ac0: 2020 2020 2020 2020 2020 2074 7874 202b             txt +
-00016ad0: 3d20 225c 6e79 6f75 2063 616e 2062 726f  = "\nyou can bro
-00016ae0: 7773 653a 220a 2020 2020 2020 2020 2020  wse:".          
-00016af0: 2020 2020 2020 666f 7220 7620 696e 2072        for v in r
-00016b00: 766f 6c3a 0a20 2020 2020 2020 2020 2020  vol:.           
-00016b10: 2020 2020 2020 2020 2074 7874 202b 3d20           txt += 
-00016b20: 225c 6e20 2022 202b 2076 0a0a 2020 2020  "\n  " + v..    
-00016b30: 2020 2020 2020 2020 6966 2077 766f 6c3a          if wvol:
-00016b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016b50: 2074 7874 202b 3d20 225c 6e79 6f75 2063   txt += "\nyou c
-00016b60: 616e 2075 706c 6f61 6420 746f 3a22 0a20  an upload to:". 
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00016b80: 6f72 2076 2069 6e20 7776 6f6c 3a0a 2020  or v in wvol:.  
-00016b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ba0: 2020 7478 7420 2b3d 2022 5c6e 2020 2220    txt += "\n  " 
-00016bb0: 2b20 760a 0a20 2020 2020 2020 2020 2020  + v..           
-00016bc0: 207a 6220 3d20 7478 742e 656e 636f 6465   zb = txt.encode
-00016bd0: 2822 7574 662d 3822 2c20 2272 6570 6c61  ("utf-8", "repla
-00016be0: 6365 2229 202b 2062 225c 6e22 0a20 2020  ce") + b"\n".   
-00016bf0: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
-00016c00: 706c 7928 7a62 2c20 6d69 6d65 3d22 7465  ply(zb, mime="te
-00016c10: 7874 2f70 6c61 696e 3b20 6368 6172 7365  xt/plain; charse
-00016c20: 743d 7574 662d 3822 290a 2020 2020 2020  t=utf-8").      
-00016c30: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-00016c40: 650a 0a20 2020 2020 2020 2068 746d 6c20  e..        html 
-00016c50: 3d20 7365 6c66 2e6a 3273 280a 2020 2020  = self.j2s(.    
-00016c60: 2020 2020 2020 2020 2273 706c 6173 6822          "splash"
-00016c70: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
-00016c80: 6973 3d73 656c 662c 0a20 2020 2020 2020  is=self,.       
-00016c90: 2020 2020 2071 7670 6174 683d 7175 6f74       qvpath=quot
-00016ca0: 6570 2873 656c 662e 7670 6174 6829 2c0a  ep(self.vpath),.
-00016cb0: 2020 2020 2020 2020 2020 2020 7276 6f6c              rvol
-00016cc0: 3d72 766f 6c2c 0a20 2020 2020 2020 2020  =rvol,.         
-00016cd0: 2020 2077 766f 6c3d 7776 6f6c 2c0a 2020     wvol=wvol,.  
-00016ce0: 2020 2020 2020 2020 2020 6176 6f6c 3d61            avol=a
-00016cf0: 766f 6c2c 0a20 2020 2020 2020 2020 2020  vol,.           
-00016d00: 2076 7374 6174 653d 7673 7461 7465 2c0a   vstate=vstate,.
-00016d10: 2020 2020 2020 2020 2020 2020 7363 616e              scan
-00016d20: 6e69 6e67 3d76 735b 2273 6361 6e6e 696e  ning=vs["scannin
-00016d30: 6722 5d2c 0a20 2020 2020 2020 2020 2020  g"],.           
-00016d40: 2068 6173 6871 3d76 735b 2268 6173 6871   hashq=vs["hashq
-00016d50: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-00016d60: 7461 6771 3d76 735b 2274 6167 7122 5d2c  tagq=vs["tagq"],
-00016d70: 0a20 2020 2020 2020 2020 2020 206d 7470  .            mtp
-00016d80: 713d 7673 5b22 6d74 7071 225d 2c0a 2020  q=vs["mtpq"],.  
-00016d90: 2020 2020 2020 2020 2020 6462 7774 3d76            dbwt=v
-00016da0: 735b 2264 6277 7422 5d2c 0a20 2020 2020  s["dbwt"],.     
-00016db0: 2020 2020 2020 2075 726c 5f73 7566 3d73         url_suf=s
-00016dc0: 7566 2c0a 2020 2020 2020 2020 2020 2020  uf,.            
-00016dd0: 6b33 3034 3d73 656c 662e 6b33 3034 2829  k304=self.k304()
-00016de0: 2c0a 2020 2020 2020 2020 2020 2020 7665  ,.            ve
-00016df0: 723d 535f 5645 5253 494f 4e20 6966 2073  r=S_VERSION if s
-00016e00: 656c 662e 6172 6773 2e76 6572 2065 6c73  elf.args.ver els
-00016e10: 6520 2222 2c0a 2020 2020 2020 2020 2020  e "",.          
-00016e20: 2020 6168 7474 7073 3d22 2220 6966 2073    ahttps="" if s
-00016e30: 656c 662e 6973 5f68 7474 7073 2065 6c73  elf.is_https els
-00016e40: 6520 2268 7474 7073 3a2f 2f22 202b 2073  e "https://" + s
-00016e50: 656c 662e 686f 7374 202b 2073 656c 662e  elf.host + self.
-00016e60: 7265 712c 0a20 2020 2020 2020 2029 0a20  req,.        ). 
-00016e70: 2020 2020 2020 2073 656c 662e 7265 706c         self.repl
-00016e80: 7928 6874 6d6c 2e65 6e63 6f64 6528 2275  y(html.encode("u
-00016e90: 7466 2d38 2229 290a 2020 2020 2020 2020  tf-8")).        
-00016ea0: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00016eb0: 2064 6566 2073 6574 5f6b 3330 3428 7365   def set_k304(se
-00016ec0: 6c66 2920 203a 0a20 2020 2020 2020 2063  lf)  :.        c
-00016ed0: 6b20 3d20 6765 6e63 6f6f 6b69 6528 226b  k = gencookie("k
-00016ee0: 3330 3422 2c20 7365 6c66 2e75 7061 7261  304", self.upara
-00016ef0: 6d5b 226b 3330 3422 5d2c 2073 656c 662e  m["k304"], self.
-00016f00: 6172 6773 2e52 2c20 4661 6c73 652c 2038  args.R, False, 8
-00016f10: 3634 3030 202a 2032 3939 290a 2020 2020  6400 * 299).    
-00016f20: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
-00016f30: 6465 726c 6973 742e 6170 7065 6e64 2828  derlist.append((
-00016f40: 2253 6574 2d43 6f6f 6b69 6522 2c20 636b  "Set-Cookie", ck
-00016f50: 2929 0a20 2020 2020 2020 2073 656c 662e  )).        self.
-00016f60: 7265 6469 7265 6374 2822 222c 2022 3f68  redirect("", "?h
-00016f70: 2363 6322 290a 2020 2020 2020 2020 7265  #cc").        re
-00016f80: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
-00016f90: 6566 2073 6574 636b 2873 656c 6629 2020  ef setck(self)  
-00016fa0: 3a0a 2020 2020 2020 2020 6b2c 2076 203d  :.        k, v =
-00016fb0: 2073 656c 662e 7570 6172 616d 5b22 7365   self.uparam["se
-00016fc0: 7463 6b22 5d2e 7370 6c69 7428 223d 222c  tck"].split("=",
-00016fd0: 2031 290a 2020 2020 2020 2020 7420 3d20   1).        t = 
-00016fe0: 4e6f 6e65 2069 6620 7620 3d3d 2022 2220  None if v == "" 
-00016ff0: 656c 7365 2038 3634 3030 202a 2032 3939  else 86400 * 299
-00017000: 0a20 2020 2020 2020 2063 6b20 3d20 6765  .        ck = ge
-00017010: 6e63 6f6f 6b69 6528 6b2c 2076 2c20 7365  ncookie(k, v, se
-00017020: 6c66 2e61 7267 732e 522c 2046 616c 7365  lf.args.R, False
-00017030: 2c20 7429 0a20 2020 2020 2020 2073 656c  , t).        sel
-00017040: 662e 6f75 745f 6865 6164 6572 6c69 7374  f.out_headerlist
-00017050: 2e61 7070 656e 6428 2822 5365 742d 436f  .append(("Set-Co
-00017060: 6f6b 6965 222c 2063 6b29 290a 2020 2020  okie", ck)).    
-00017070: 2020 2020 7365 6c66 2e72 6570 6c79 2862      self.reply(b
-00017080: 226f 375c 6e22 290a 2020 2020 2020 2020  "o7\n").        
-00017090: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-000170a0: 2064 6566 2073 6574 5f63 6667 5f72 6573   def set_cfg_res
-000170b0: 6574 2873 656c 6629 2020 3a0a 2020 2020  et(self)  :.    
-000170c0: 2020 2020 666f 7220 6b20 696e 2028 226b      for k in ("k
-000170d0: 3330 3422 2c20 226a 7322 2c20 2269 6478  304", "js", "idx
-000170e0: 6822 2c20 2263 7070 7764 222c 2022 6370  h", "cppwd", "cp
-000170f0: 7077 7322 293a 0a20 2020 2020 2020 2020  pws"):.         
-00017100: 2020 2063 6f6f 6b69 6520 3d20 6765 6e63     cookie = genc
-00017110: 6f6f 6b69 6528 6b2c 2022 7822 2c20 7365  ookie(k, "x", se
-00017120: 6c66 2e61 7267 732e 522c 2046 616c 7365  lf.args.R, False
-00017130: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00017140: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
-00017150: 6465 726c 6973 742e 6170 7065 6e64 2828  derlist.append((
-00017160: 2253 6574 2d43 6f6f 6b69 6522 2c20 636f  "Set-Cookie", co
-00017170: 6f6b 6965 2929 0a0a 2020 2020 2020 2020  okie))..        
-00017180: 7365 6c66 2e72 6564 6972 6563 7428 2222  self.redirect(""
-00017190: 2c20 223f 6823 6363 2229 0a20 2020 2020  , "?h#cc").     
-000171a0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-000171b0: 2020 2020 6465 6620 7478 5f34 3034 2873      def tx_404(s
-000171c0: 656c 662c 2069 735f 3430 3320 203d 2046  elf, is_403  = F
-000171d0: 616c 7365 2920 203a 0a20 2020 2020 2020  alse)  :.       
-000171e0: 2072 6320 3d20 3430 340a 2020 2020 2020   rc = 404.      
-000171f0: 2020 6966 2073 656c 662e 6172 6773 2e76    if self.args.v
-00017200: 6167 7565 5f34 3033 3a0a 2020 2020 2020  ague_403:.      
-00017210: 2020 2020 2020 7420 3d20 273c 6831 2069        t = '<h1 i
-00017220: 643d 226e 223e 3430 3420 6e6f 7420 666f  d="n">404 not fo
-00017230: 756e 6420 266e 6273 703b e294 9028 20c2  und &nbsp;...( .
-00017240: b420 2d60 29e2 948c 3c2f 6831 3e3c 7020  . -`)...</h1><p 
-00017250: 6964 3d22 6f22 3e6f 7220 6d61 7962 6520  id="o">or maybe 
-00017260: 796f 7520 646f 6e5c 2774 2068 6176 6520  you don\'t have 
-00017270: 6163 6365 7373 202d 2d20 7472 7920 6c6f  access -- try lo
-00017280: 6767 696e 6720 696e 206f 7220 3c61 2068  gging in or <a h
-00017290: 7265 663d 227b 7d2f 3f68 223e 676f 2068  ref="{}/?h">go h
-000172a0: 6f6d 653c 2f61 3e3c 2f70 3e27 0a20 2020  ome</a></p>'.   
-000172b0: 2020 2020 2065 6c69 6620 6973 5f34 3033       elif is_403
-000172c0: 3a0a 2020 2020 2020 2020 2020 2020 7420  :.            t 
-000172d0: 3d20 273c 6831 2069 643d 2270 223e 3430  = '<h1 id="p">40
-000172e0: 3320 666f 7262 6964 6465 6e61 2026 6e62  3 forbiddena &nb
-000172f0: 7370 3b7e e294 bbe2 9481 e294 bb3c 2f68  sp;~.........</h
-00017300: 313e 3c70 2069 643d 2271 223e 796f 755c  1><p id="q">you\
-00017310: 276c 6c20 6861 7665 2074 6f20 6c6f 6720  'll have to log 
-00017320: 696e 206f 7220 3c61 2068 7265 663d 227b  in or <a href="{
-00017330: 7d2f 3f68 223e 676f 2068 6f6d 653c 2f61  }/?h">go home</a
-00017340: 3e3c 2f70 3e27 0a20 2020 2020 2020 2020  ></p>'.         
-00017350: 2020 2072 6320 3d20 3430 330a 2020 2020     rc = 403.    
-00017360: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00017370: 2020 2020 2020 7420 3d20 273c 6831 2069        t = '<h1 i
-00017380: 643d 226e 223e 3430 3420 6e6f 7420 666f  d="n">404 not fo
-00017390: 756e 6420 266e 6273 703b e294 9028 20c2  und &nbsp;...( .
-000173a0: b420 2d60 29e2 948c 3c2f 6831 3e3c 703e  . -`)...</h1><p>
-000173b0: 3c61 2069 643d 2272 2220 6872 6566 3d22  <a id="r" href="
-000173c0: 7b7d 2f3f 6822 3e67 6f20 686f 6d65 3c2f  {}/?h">go home</
-000173d0: 613e 3c2f 703e 270a 0a20 2020 2020 2020  a></p>'..       
-000173e0: 2074 203d 2074 2e66 6f72 6d61 7428 7365   t = t.format(se
-000173f0: 6c66 2e61 7267 732e 5352 290a 2020 2020  lf.args.SR).    
-00017400: 2020 2020 6874 6d6c 203d 2073 656c 662e      html = self.
-00017410: 6a32 7328 2273 706c 6173 6822 2c20 7468  j2s("splash", th
-00017420: 6973 3d73 656c 662c 2071 7670 6174 683d  is=self, qvpath=
-00017430: 7175 6f74 6570 2873 656c 662e 7670 6174  quotep(self.vpat
-00017440: 6829 2c20 6d73 673d 7429 0a20 2020 2020  h), msg=t).     
-00017450: 2020 2073 656c 662e 7265 706c 7928 6874     self.reply(ht
-00017460: 6d6c 2e65 6e63 6f64 6528 2275 7466 2d38  ml.encode("utf-8
-00017470: 2229 2c20 7374 6174 7573 3d72 6329 0a20  "), status=rc). 
-00017480: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00017490: 7565 0a0a 2020 2020 6465 6620 7363 616e  ue..    def scan
-000174a0: 766f 6c28 7365 6c66 2920 203a 0a20 2020  vol(self)  :.   
-000174b0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-000174c0: 2e63 616e 5f72 6561 6420 6f72 206e 6f74  .can_read or not
-000174d0: 2073 656c 662e 6361 6e5f 7772 6974 653a   self.can_write:
-000174e0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-000174f0: 7365 2050 6562 6b61 6328 3430 332c 2022  se Pebkac(403, "
-00017500: 6e6f 7420 616c 6c6f 7765 6420 666f 7220  not allowed for 
-00017510: 7573 6572 2022 202b 2073 656c 662e 756e  user " + self.un
-00017520: 616d 6529 0a0a 2020 2020 2020 2020 6966  ame)..        if
-00017530: 2073 656c 662e 6172 6773 2e6e 6f5f 7265   self.args.no_re
-00017540: 7363 616e 3a0a 2020 2020 2020 2020 2020  scan:.          
-00017550: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
-00017560: 3033 2c20 2274 6865 2072 6573 6361 6e20  03, "the rescan 
-00017570: 6665 6174 7572 6520 6973 2064 6973 6162  feature is disab
-00017580: 6c65 6420 696e 2073 6572 7665 7220 636f  led in server co
-00017590: 6e66 6967 2229 0a0a 2020 2020 2020 2020  nfig")..        
-000175a0: 766e 2c20 5f20 3d20 7365 6c66 2e61 7372  vn, _ = self.asr
-000175b0: 762e 7666 732e 6765 7428 7365 6c66 2e76  v.vfs.get(self.v
-000175c0: 7061 7468 2c20 7365 6c66 2e75 6e61 6d65  path, self.uname
-000175d0: 2c20 5472 7565 2c20 5472 7565 290a 0a20  , True, True).. 
-000175e0: 2020 2020 2020 2061 7267 7320 3d20 5b73         args = [s
-000175f0: 656c 662e 6173 7276 2e76 6673 2e61 6c6c  elf.asrv.vfs.all
-00017600: 5f76 6f6c 732c 205b 766e 2e76 7061 7468  _vols, [vn.vpath
-00017610: 5d2c 2046 616c 7365 2c20 5472 7565 5d0a  ], False, True].
-00017620: 0a20 2020 2020 2020 2078 203d 2073 656c  .        x = sel
-00017630: 662e 636f 6e6e 2e68 7372 762e 6272 6f6b  f.conn.hsrv.brok
-00017640: 6572 2e61 736b 2822 7570 326b 2e72 6573  er.ask("up2k.res
-00017650: 6361 6e22 2c20 2a61 7267 7329 0a20 2020  can", *args).   
-00017660: 2020 2020 2065 7272 203d 2078 2e67 6574       err = x.get
-00017670: 2829 0a20 2020 2020 2020 2069 6620 6e6f  ().        if no
-00017680: 7420 6572 723a 0a20 2020 2020 2020 2020  t err:.         
-00017690: 2020 2073 656c 662e 7265 6469 7265 6374     self.redirect
-000176a0: 2822 222c 2022 3f68 2229 0a20 2020 2020  ("", "?h").     
-000176b0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-000176c0: 7565 0a0a 2020 2020 2020 2020 7261 6973  ue..        rais
-000176d0: 6520 5065 626b 6163 2835 3030 2c20 6572  e Pebkac(500, er
-000176e0: 7229 0a0a 2020 2020 6465 6620 6861 6e64  r)..    def hand
-000176f0: 6c65 5f72 656c 6f61 6428 7365 6c66 2920  le_reload(self) 
-00017700: 203a 0a20 2020 2020 2020 2061 6374 203d   :.        act =
-00017710: 2073 656c 662e 7570 6172 616d 2e67 6574   self.uparam.get
-00017720: 2822 7265 6c6f 6164 2229 0a20 2020 2020  ("reload").     
-00017730: 2020 2069 6620 6163 7420 213d 2022 6366     if act != "cf
-00017740: 6722 3a0a 2020 2020 2020 2020 2020 2020  g":.            
-00017750: 7261 6973 6520 5065 626b 6163 2834 3030  raise Pebkac(400
-00017760: 2c20 226f 6e6c 7920 636f 6e66 6967 2066  , "only config f
-00017770: 696c 6573 2028 2763 6667 2729 2063 616e  iles ('cfg') can
-00017780: 2062 6520 7265 6c6f 6164 6564 2072 6e22   be reloaded rn"
-00017790: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-000177a0: 7420 5b78 2066 6f72 2078 2069 6e20 7365  t [x for x in se
-000177b0: 6c66 2e77 766f 6c20 6966 2078 2069 6e20  lf.wvol if x in 
-000177c0: 7365 6c66 2e72 766f 6c5d 3a0a 2020 2020  self.rvol]:.    
-000177d0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
-000177e0: 626b 6163 2834 3033 2c20 226e 6f74 2061  bkac(403, "not a
-000177f0: 6c6c 6f77 6564 2066 6f72 2075 7365 7220  llowed for user 
-00017800: 2220 2b20 7365 6c66 2e75 6e61 6d65 290a  " + self.uname).
-00017810: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00017820: 2e61 7267 732e 6e6f 5f72 656c 6f61 643a  .args.no_reload:
-00017830: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00017840: 7365 2050 6562 6b61 6328 3430 332c 2022  se Pebkac(403, "
-00017850: 7468 6520 7265 6c6f 6164 2066 6561 7475  the reload featu
-00017860: 7265 2069 7320 6469 7361 626c 6564 2069  re is disabled i
-00017870: 6e20 7365 7276 6572 2063 6f6e 6669 6722  n server config"
-00017880: 290a 0a20 2020 2020 2020 2078 203d 2073  )..        x = s
-00017890: 656c 662e 636f 6e6e 2e68 7372 762e 6272  elf.conn.hsrv.br
-000178a0: 6f6b 6572 2e61 736b 2822 7265 6c6f 6164  oker.ask("reload
-000178b0: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
-000178c0: 6e20 7365 6c66 2e72 6564 6972 6563 7428  n self.redirect(
-000178d0: 2222 2c20 223f 6822 2c20 782e 6765 7428  "", "?h", x.get(
-000178e0: 292c 2022 7265 7475 726e 2074 6f22 2c20  ), "return to", 
-000178f0: 4661 6c73 6529 0a0a 2020 2020 6465 6620  False)..    def 
-00017900: 7478 5f73 7461 636b 2873 656c 6629 2020  tx_stack(self)  
-00017910: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
-00017920: 205b 7820 666f 7220 7820 696e 2073 656c   [x for x in sel
-00017930: 662e 7776 6f6c 2069 6620 7820 696e 2073  f.wvol if x in s
-00017940: 656c 662e 7276 6f6c 5d3a 0a20 2020 2020  elf.rvol]:.     
-00017950: 2020 2020 2020 2072 6169 7365 2050 6562         raise Peb
-00017960: 6b61 6328 3430 332c 2022 6e6f 7420 616c  kac(403, "not al
-00017970: 6c6f 7765 6420 666f 7220 7573 6572 2022  lowed for user "
-00017980: 202b 2073 656c 662e 756e 616d 6529 0a0a   + self.uname)..
-00017990: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000179a0: 6172 6773 2e6e 6f5f 7374 6163 6b3a 0a20  args.no_stack:. 
-000179b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000179c0: 2050 6562 6b61 6328 3430 332c 2022 7468   Pebkac(403, "th
-000179d0: 6520 7374 6163 6b64 756d 7020 6665 6174  e stackdump feat
-000179e0: 7572 6520 6973 2064 6973 6162 6c65 6420  ure is disabled 
-000179f0: 696e 2073 6572 7665 7220 636f 6e66 6967  in server config
-00017a00: 2229 0a0a 2020 2020 2020 2020 7265 7420  ")..        ret 
-00017a10: 3d20 223c 7072 653e 7b7d 5c6e 7b7d 222e  = "<pre>{}\n{}".
-00017a20: 666f 726d 6174 2874 696d 652e 7469 6d65  format(time.time
-00017a30: 2829 2c20 6874 6d6c 5f65 7363 6170 6528  (), html_escape(
-00017a40: 616c 6c74 7261 6365 2829 2929 0a20 2020  alltrace())).   
-00017a50: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
-00017a60: 7265 742e 656e 636f 6465 2822 7574 662d  ret.encode("utf-
-00017a70: 3822 2929 0a20 2020 2020 2020 2072 6574  8")).        ret
-00017a80: 7572 6e20 5472 7565 0a0a 2020 2020 6465  urn True..    de
-00017a90: 6620 7478 5f74 7265 6528 7365 6c66 2920  f tx_tree(self) 
-00017aa0: 203a 0a20 2020 2020 2020 2074 6f70 203d   :.        top =
-00017ab0: 2073 656c 662e 7570 6172 616d 5b22 7472   self.uparam["tr
-00017ac0: 6565 225d 206f 7220 2222 0a20 2020 2020  ee"] or "".     
-00017ad0: 2020 2064 7374 203d 2073 656c 662e 7670     dst = self.vp
-00017ae0: 6174 680a 2020 2020 2020 2020 6966 2074  ath.        if t
-00017af0: 6f70 2069 6e20 5b22 2e22 2c20 222e 2e22  op in [".", ".."
-00017b00: 5d3a 0a20 2020 2020 2020 2020 2020 2074  ]:.            t
-00017b10: 6f70 203d 2075 6e64 6f74 2873 656c 662e  op = undot(self.
-00017b20: 7670 6174 6820 2b20 222f 2220 2b20 746f  vpath + "/" + to
-00017b30: 7029 0a0a 2020 2020 2020 2020 6966 2074  p)..        if t
-00017b40: 6f70 203d 3d20 6473 743a 0a20 2020 2020  op == dst:.     
-00017b50: 2020 2020 2020 2064 7374 203d 2022 220a         dst = "".
-00017b60: 2020 2020 2020 2020 656c 6966 2074 6f70          elif top
-00017b70: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00017b80: 206e 6f74 2064 7374 2e73 7461 7274 7377   not dst.startsw
-00017b90: 6974 6828 746f 7020 2b20 222f 2229 3a0a  ith(top + "/"):.
-00017ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017bb0: 7261 6973 6520 5065 626b 6163 2834 3030  raise Pebkac(400
-00017bc0: 2c20 2261 7267 2066 756e 6b22 290a 0a20  , "arg funk").. 
-00017bd0: 2020 2020 2020 2020 2020 2064 7374 203d             dst =
-00017be0: 2064 7374 5b6c 656e 2874 6f70 2920 2b20   dst[len(top) + 
-00017bf0: 3120 3a5d 0a0a 2020 2020 2020 2020 7265  1 :]..        re
-00017c00: 7420 3d20 7365 6c66 2e67 656e 5f74 7265  t = self.gen_tre
-00017c10: 6528 746f 702c 2064 7374 290a 2020 2020  e(top, dst).    
-00017c20: 2020 2020 6966 2073 656c 662e 6973 5f76      if self.is_v
-00017c30: 7072 6f78 6965 643a 0a20 2020 2020 2020  proxied:.       
-00017c40: 2020 2020 2070 6172 656e 7473 203d 2073       parents = s
-00017c50: 656c 662e 6172 6773 2e52 2e73 706c 6974  elf.args.R.split
-00017c60: 2822 2f22 290a 2020 2020 2020 2020 2020  ("/").          
-00017c70: 2020 666f 7220 7061 7265 6e74 2069 6e20    for parent in 
-00017c80: 7061 7265 6e74 735b 3a3a 2d31 5d3a 0a20  parents[::-1]:. 
-00017c90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017ca0: 6574 203d 207b 226b 7b7d 222e 666f 726d  et = {"k{}".form
-00017cb0: 6174 2870 6172 656e 7429 3a20 7265 742c  at(parent): ret,
-00017cc0: 2022 6122 3a20 5b5d 7d0a 0a20 2020 2020   "a": []}..     
-00017cd0: 2020 207a 7320 3d20 6a73 6f6e 2e64 756d     zs = json.dum
-00017ce0: 7073 2872 6574 290a 2020 2020 2020 2020  ps(ret).        
-00017cf0: 7365 6c66 2e72 6570 6c79 287a 732e 656e  self.reply(zs.en
-00017d00: 636f 6465 2822 7574 662d 3822 292c 206d  code("utf-8"), m
-00017d10: 696d 653d 2261 7070 6c69 6361 7469 6f6e  ime="application
-00017d20: 2f6a 736f 6e22 290a 2020 2020 2020 2020  /json").        
-00017d30: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-00017d40: 2064 6566 2067 656e 5f74 7265 6528 7365   def gen_tree(se
-00017d50: 6c66 2c20 746f 7020 2c20 7461 7267 6574  lf, top , target
-00017d60: 2029 2020 203a 0a20 2020 2020 2020 2072   )   :.        r
-00017d70: 6574 2020 203d 207b 7d0a 2020 2020 2020  et   = {}.      
-00017d80: 2020 6578 636c 203d 204e 6f6e 650a 2020    excl = None.  
-00017d90: 2020 2020 2020 6966 2074 6172 6765 743a        if target:
-00017da0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-00017db0: 6c2c 2074 6172 6765 7420 3d20 2874 6172  l, target = (tar
-00017dc0: 6765 742e 7370 6c69 7428 222f 222c 2031  get.split("/", 1
-00017dd0: 2920 2b20 5b22 225d 295b 3a32 5d0a 2020  ) + [""])[:2].  
-00017de0: 2020 2020 2020 2020 2020 7375 6220 3d20            sub = 
-00017df0: 7365 6c66 2e67 656e 5f74 7265 6528 222f  self.gen_tree("/
-00017e00: 222e 6a6f 696e 285b 746f 702c 2065 7863  ".join([top, exc
-00017e10: 6c5d 292e 7374 7269 7028 222f 2229 2c20  l]).strip("/"), 
-00017e20: 7461 7267 6574 290a 2020 2020 2020 2020  target).        
-00017e30: 2020 2020 7265 745b 226b 2220 2b20 7175      ret["k" + qu
-00017e40: 6f74 6570 2865 7863 6c29 5d20 3d20 7375  otep(excl)] = su
-00017e50: 620a 0a20 2020 2020 2020 2074 7279 3a0a  b..        try:.
-00017e60: 2020 2020 2020 2020 2020 2020 766e 2c20              vn, 
-00017e70: 7265 6d20 3d20 7365 6c66 2e61 7372 762e  rem = self.asrv.
-00017e80: 7666 732e 6765 7428 746f 702c 2073 656c  vfs.get(top, sel
-00017e90: 662e 756e 616d 652c 2054 7275 652c 2046  f.uname, True, F
-00017ea0: 616c 7365 290a 2020 2020 2020 2020 2020  alse).          
-00017eb0: 2020 6673 726f 6f74 2c20 7666 735f 6c73    fsroot, vfs_ls
-00017ec0: 2c20 7666 735f 7669 7274 203d 2076 6e2e  , vfs_virt = vn.
-00017ed0: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
-00017ee0: 2020 2020 7265 6d2c 0a20 2020 2020 2020      rem,.       
-00017ef0: 2020 2020 2020 2020 2073 656c 662e 756e           self.un
-00017f00: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00017f10: 2020 2020 206e 6f74 2073 656c 662e 6172       not self.ar
-00017f20: 6773 2e6e 6f5f 7363 616e 6469 722c 0a20  gs.no_scandir,. 
-00017f30: 2020 2020 2020 2020 2020 2020 2020 205b                 [
-00017f40: 5b54 7275 652c 2046 616c 7365 5d2c 205b  [True, False], [
-00017f50: 4661 6c73 652c 2054 7275 655d 5d2c 0a20  False, True]],. 
-00017f60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00017f70: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00017f80: 2020 2020 2020 2020 2076 6673 5f6c 7320           vfs_ls 
-00017f90: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-00017fa0: 2076 6673 5f76 6972 7420 3d20 7b7d 0a20   vfs_virt = {}. 
-00017fb0: 2020 2020 2020 2020 2020 2066 6f72 2076             for v
-00017fc0: 2069 6e20 7365 6c66 2e72 766f 6c3a 0a20   in self.rvol:. 
-00017fd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00017fe0: 312c 2064 3220 3d20 762e 7273 706c 6974  1, d2 = v.rsplit
-00017ff0: 2822 2f22 2c20 3129 2069 6620 222f 2220  ("/", 1) if "/" 
-00018000: 696e 2076 2065 6c73 6520 5b22 222c 2076  in v else ["", v
-00018010: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00018020: 2020 6966 2064 3120 3d3d 2074 6f70 3a0a    if d1 == top:.
-00018030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018040: 2020 2020 7666 735f 7669 7274 5b64 325d      vfs_virt[d2]
-00018050: 203d 2073 656c 662e 6173 7276 2e76 6673   = self.asrv.vfs
-00018060: 2020 2320 7479 7065 6368 6b2c 2076 616c    # typechk, val
-00018070: 7565 206e 6576 6572 2072 6561 640a 0a20  ue never read.. 
-00018080: 2020 2020 2020 2064 6972 7320 3d20 5b5d         dirs = []
-00018090: 0a0a 2020 2020 2020 2020 6469 726e 616d  ..        dirnam
-000180a0: 6573 203d 205b 785b 305d 2066 6f72 2078  es = [x[0] for x
-000180b0: 2069 6e20 7666 735f 6c73 2069 6620 7374   in vfs_ls if st
-000180c0: 6174 2e53 5f49 5344 4952 2878 5b31 5d2e  at.S_ISDIR(x[1].
-000180d0: 7374 5f6d 6f64 6529 5d0a 0a20 2020 2020  st_mode)]..     
-000180e0: 2020 2069 6620 6e6f 7420 7365 6c66 2e61     if not self.a
-000180f0: 7267 732e 6564 206f 7220 2264 6f74 7322  rgs.ed or "dots"
-00018100: 206e 6f74 2069 6e20 7365 6c66 2e75 7061   not in self.upa
-00018110: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
-00018120: 2064 6972 6e61 6d65 7320 3d20 6578 636c   dirnames = excl
-00018130: 7564 655f 646f 7466 696c 6573 2864 6972  ude_dotfiles(dir
-00018140: 6e61 6d65 7329 0a0a 2020 2020 2020 2020  names)..        
-00018150: 666f 7220 666e 2069 6e20 5b78 2066 6f72  for fn in [x for
-00018160: 2078 2069 6e20 6469 726e 616d 6573 2069   x in dirnames i
-00018170: 6620 7820 213d 2065 7863 6c5d 3a0a 2020  f x != excl]:.  
-00018180: 2020 2020 2020 2020 2020 6469 7273 2e61            dirs.a
-00018190: 7070 656e 6428 7175 6f74 6570 2866 6e29  ppend(quotep(fn)
-000181a0: 290a 0a20 2020 2020 2020 2066 6f72 2078  )..        for x
-000181b0: 2069 6e20 7666 735f 7669 7274 3a0a 2020   in vfs_virt:.  
-000181c0: 2020 2020 2020 2020 2020 6966 2078 2021            if x !
-000181d0: 3d20 6578 636c 3a0a 2020 2020 2020 2020  = excl:.        
-000181e0: 2020 2020 2020 2020 6469 7273 2e61 7070          dirs.app
-000181f0: 656e 6428 7829 0a0a 2020 2020 2020 2020  end(x)..        
-00018200: 7265 745b 2261 225d 203d 2064 6972 730a  ret["a"] = dirs.
-00018210: 2020 2020 2020 2020 7265 7475 726e 2072          return r
-00018220: 6574 0a0a 2020 2020 6465 6620 7478 5f75  et..    def tx_u
-00018230: 7073 2873 656c 6629 2020 3a0a 2020 2020  ps(self)  :.    
-00018240: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00018250: 6172 6773 2e75 6e70 6f73 743a 0a20 2020  args.unpost:.   
-00018260: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
-00018270: 6562 6b61 6328 3430 332c 2022 7468 6520  ebkac(403, "the 
-00018280: 756e 706f 7374 2066 6561 7475 7265 2069  unpost feature i
-00018290: 7320 6469 7361 626c 6564 2069 6e20 7365  s disabled in se
-000182a0: 7276 6572 2063 6f6e 6669 6722 290a 0a20  rver config").. 
-000182b0: 2020 2020 2020 2069 6478 203d 2073 656c         idx = sel
-000182c0: 662e 636f 6e6e 2e67 6574 5f75 3269 6478  f.conn.get_u2idx
-000182d0: 2829 0a20 2020 2020 2020 2069 6620 6e6f  ().        if no
-000182e0: 7420 6861 7361 7474 7228 6964 782c 2022  t hasattr(idx, "
-000182f0: 705f 656e 6422 293a 0a20 2020 2020 2020  p_end"):.       
-00018300: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-00018310: 6328 3530 302c 2022 7371 6c69 7465 3320  c(500, "sqlite3 
-00018320: 6973 206e 6f74 2061 7661 696c 6162 6c65  is not available
-00018330: 206f 6e20 7468 6520 7365 7276 6572 3b20   on the server; 
-00018340: 6361 6e6e 6f74 2075 6e70 6f73 7422 290a  cannot unpost").
-00018350: 0a20 2020 2020 2020 2066 696c 7420 3d20  .        filt = 
-00018360: 7365 6c66 2e75 7061 7261 6d2e 6765 7428  self.uparam.get(
-00018370: 2266 696c 7465 7222 290a 2020 2020 2020  "filter").      
-00018380: 2020 6669 6c74 203d 2075 6e71 756f 7465    filt = unquote
-00018390: 7028 6669 6c74 206f 7220 2222 290a 2020  p(filt or "").  
-000183a0: 2020 2020 2020 6c6d 203d 2022 7570 7320        lm = "ups 
-000183b0: 5b7b 7d5d 222e 666f 726d 6174 2866 696c  [{}]".format(fil
-000183c0: 7429 0a20 2020 2020 2020 2073 656c 662e  t).        self.
-000183d0: 6c6f 6728 6c6d 290a 0a20 2020 2020 2020  log(lm)..       
-000183e0: 2072 6574 2020 203d 205b 5d0a 2020 2020   ret   = [].    
-000183f0: 2020 2020 7430 203d 2074 696d 652e 7469      t0 = time.ti
-00018400: 6d65 2829 0a20 2020 2020 2020 206c 696d  me().        lim
-00018410: 203d 2074 696d 652e 7469 6d65 2829 202d   = time.time() -
-00018420: 2073 656c 662e 6172 6773 2e75 6e70 6f73   self.args.unpos
-00018430: 740a 2020 2020 2020 2020 666b 5f76 6f6c  t.        fk_vol
-00018440: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00018450: 2020 766f 6c3a 2076 6f6c 2e66 6c61 6773    vol: vol.flags
-00018460: 5b22 666b 225d 0a20 2020 2020 2020 2020  ["fk"].         
-00018470: 2020 2066 6f72 2076 702c 2076 6f6c 2069     for vp, vol i
-00018480: 6e20 7365 6c66 2e61 7372 762e 7666 732e  n self.asrv.vfs.
-00018490: 616c 6c5f 766f 6c73 2e69 7465 6d73 2829  all_vols.items()
-000184a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000184b0: 2266 6b22 2069 6e20 766f 6c2e 666c 6167  "fk" in vol.flag
-000184c0: 7320 616e 6420 2876 7020 696e 2073 656c  s and (vp in sel
-000184d0: 662e 7276 6f6c 206f 7220 7670 2069 6e20  f.rvol or vp in 
-000184e0: 7365 6c66 2e75 7076 6f6c 290a 2020 2020  self.upvol).    
-000184f0: 2020 2020 7d0a 2020 2020 2020 2020 666f      }.        fo
-00018500: 7220 766f 6c20 696e 2073 656c 662e 6173  r vol in self.as
-00018510: 7276 2e76 6673 2e61 6c6c 5f76 6f6c 732e  rv.vfs.all_vols.
-00018520: 7661 6c75 6573 2829 3a0a 2020 2020 2020  values():.      
-00018530: 2020 2020 2020 6375 7220 3d20 6964 782e        cur = idx.
-00018540: 6765 745f 6375 7228 766f 6c2e 7265 616c  get_cur(vol.real
-00018550: 7061 7468 290a 2020 2020 2020 2020 2020  path).          
-00018560: 2020 6966 206e 6f74 2063 7572 3a0a 2020    if not cur:.  
-00018570: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00018580: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
-00018590: 2020 2020 6e66 6b20 3d20 666b 5f76 6f6c      nfk = fk_vol
-000185a0: 732e 6765 7428 766f 6c2c 2030 290a 0a20  s.get(vol, 0).. 
-000185b0: 2020 2020 2020 2020 2020 2071 203d 2022             q = "
-000185c0: 7365 6c65 6374 2073 7a2c 2072 642c 2066  select sz, rd, f
-000185d0: 6e2c 2061 7420 6672 6f6d 2075 7020 7768  n, at from up wh
-000185e0: 6572 6520 6970 3d3f 2061 6e64 2061 743e  ere ip=? and at>
-000185f0: 3f22 0a20 2020 2020 2020 2020 2020 2066  ?".            f
-00018600: 6f72 2073 7a2c 2072 642c 2066 6e2c 2061  or sz, rd, fn, a
-00018610: 7420 696e 2063 7572 2e65 7865 6375 7465  t in cur.execute
-00018620: 2871 2c20 2873 656c 662e 6970 2c20 6c69  (q, (self.ip, li
-00018630: 6d29 293a 0a20 2020 2020 2020 2020 2020  m)):.           
-00018640: 2020 2020 2076 7020 3d20 222f 2220 2b20       vp = "/" + 
-00018650: 222f 222e 6a6f 696e 2878 2066 6f72 2078  "/".join(x for x
-00018660: 2069 6e20 5b76 6f6c 2e76 7061 7468 2c20   in [vol.vpath, 
-00018670: 7264 2c20 666e 5d20 6966 2078 290a 2020  rd, fn] if x).  
-00018680: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00018690: 2066 696c 7420 616e 6420 6669 6c74 206e   filt and filt n
-000186a0: 6f74 2069 6e20 7670 3a0a 2020 2020 2020  ot in vp:.      
-000186b0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-000186c0: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
-000186d0: 2020 2020 2020 2020 7276 203d 207b 2276          rv = {"v
-000186e0: 7022 3a20 7175 6f74 6570 2876 7029 2c20  p": quotep(vp), 
-000186f0: 2273 7a22 3a20 737a 2c20 2261 7422 3a20  "sz": sz, "at": 
-00018700: 6174 2c20 226e 666b 223a 206e 666b 7d0a  at, "nfk": nfk}.
-00018710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018720: 6966 206e 666b 3a0a 2020 2020 2020 2020  if nfk:.        
-00018730: 2020 2020 2020 2020 2020 2020 7276 5b22              rv["
-00018740: 6170 225d 203d 2076 6f6c 2e63 616e 6f6e  ap"] = vol.canon
-00018750: 6963 616c 2876 6a6f 696e 2872 642c 2066  ical(vjoin(rd, f
-00018760: 6e29 290a 0a20 2020 2020 2020 2020 2020  n))..           
-00018770: 2020 2020 2072 6574 2e61 7070 656e 6428       ret.append(
-00018780: 7276 290a 2020 2020 2020 2020 2020 2020  rv).            
-00018790: 2020 2020 6966 206c 656e 2872 6574 2920      if len(ret) 
-000187a0: 3e20 3330 3030 3a0a 2020 2020 2020 2020  > 3000:.        
-000187b0: 2020 2020 2020 2020 2020 2020 7265 742e              ret.
-000187c0: 736f 7274 286b 6579 3d6c 616d 6264 6120  sort(key=lambda 
-000187d0: 783a 2078 5b22 6174 225d 2c20 7265 7665  x: x["at"], reve
-000187e0: 7273 653d 5472 7565 2920 2023 2074 7970  rse=True)  # typ
-000187f0: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
-00018800: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00018810: 7420 3d20 7265 745b 3a32 3030 305d 0a0a  t = ret[:2000]..
-00018820: 2020 2020 2020 2020 7265 742e 736f 7274          ret.sort
-00018830: 286b 6579 3d6c 616d 6264 6120 783a 2078  (key=lambda x: x
-00018840: 5b22 6174 225d 2c20 7265 7665 7273 653d  ["at"], reverse=
-00018850: 5472 7565 2920 2023 2074 7970 653a 2069  True)  # type: i
-00018860: 676e 6f72 650a 2020 2020 2020 2020 6e20  gnore.        n 
-00018870: 3d20 300a 2020 2020 2020 2020 666f 7220  = 0.        for 
-00018880: 7276 2069 6e20 7265 745b 3a31 3130 3030  rv in ret[:11000
-00018890: 5d3a 0a20 2020 2020 2020 2020 2020 206e  ]:.            n
-000188a0: 666b 203d 2072 762e 706f 7028 226e 666b  fk = rv.pop("nfk
-000188b0: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
-000188c0: 6620 6e6f 7420 6e66 6b3a 0a20 2020 2020  f not nfk:.     
-000188d0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-000188e0: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
-000188f0: 2061 7020 3d20 7276 2e70 6f70 2822 6170   ap = rv.pop("ap
-00018900: 2229 0a20 2020 2020 2020 2020 2020 2074  ").            t
-00018910: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00018920: 2020 2020 7374 203d 2062 6f73 2e73 7461      st = bos.sta
-00018930: 7428 6170 290a 2020 2020 2020 2020 2020  t(ap).          
-00018940: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
-00018950: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00018960: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-00018970: 666b 203d 2073 656c 662e 6765 6e5f 666b  fk = self.gen_fk
-00018980: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00018990: 2020 7365 6c66 2e61 7267 732e 666b 5f73    self.args.fk_s
-000189a0: 616c 742c 2061 702c 2073 742e 7374 5f73  alt, ap, st.st_s
-000189b0: 697a 652c 2030 2069 6620 414e 5957 494e  ize, 0 if ANYWIN
-000189c0: 2065 6c73 6520 7374 2e73 745f 696e 6f0a   else st.st_ino.
-000189d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000189e0: 2020 2020 2020 2020 2020 7276 5b22 7670            rv["vp
-000189f0: 225d 202b 3d20 223f 6b3d 2220 2b20 666b  "] += "?k=" + fk
-00018a00: 5b3a 6e66 6b5d 0a0a 2020 2020 2020 2020  [:nfk]..        
-00018a10: 2020 2020 6e20 2b3d 2031 0a20 2020 2020      n += 1.     
-00018a20: 2020 2020 2020 2069 6620 6e20 3e20 3230         if n > 20
-00018a30: 3030 3a0a 2020 2020 2020 2020 2020 2020  00:.            
-00018a40: 2020 2020 6272 6561 6b0a 0a20 2020 2020      break..     
-00018a50: 2020 2072 6574 203d 2072 6574 5b3a 3230     ret = ret[:20
-00018a60: 3030 5d0a 0a20 2020 2020 2020 2069 6620  00]..        if 
-00018a70: 7365 6c66 2e69 735f 7670 726f 7869 6564  self.is_vproxied
-00018a80: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-00018a90: 7220 7620 696e 2072 6574 3a0a 2020 2020  r v in ret:.    
-00018aa0: 2020 2020 2020 2020 2020 2020 765b 2276              v["v
-00018ab0: 7022 5d20 3d20 7365 6c66 2e61 7267 732e  p"] = self.args.
-00018ac0: 5352 202b 2076 5b22 7670 225d 0a0a 2020  SR + v["vp"]..  
-00018ad0: 2020 2020 2020 6a74 7874 203d 206a 736f        jtxt = jso
-00018ae0: 6e2e 6475 6d70 7328 7265 742c 2069 6e64  n.dumps(ret, ind
-00018af0: 656e 743d 322c 2073 6f72 745f 6b65 7973  ent=2, sort_keys
-00018b00: 3d54 7275 6529 2e65 6e63 6f64 6528 2275  =True).encode("u
-00018b10: 7466 2d38 222c 2022 7265 706c 6163 6522  tf-8", "replace"
-00018b20: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
-00018b30: 6f67 2822 7b7d 2023 7b7d 207b 3a2e 3266  og("{} #{} {:.2f
-00018b40: 7d73 6563 222e 666f 726d 6174 286c 6d2c  }sec".format(lm,
-00018b50: 206c 656e 2872 6574 292c 2074 696d 652e   len(ret), time.
-00018b60: 7469 6d65 2829 202d 2074 3029 290a 2020  time() - t0)).  
-00018b70: 2020 2020 2020 7365 6c66 2e72 6570 6c79        self.reply
-00018b80: 286a 7478 742c 206d 696d 653d 2261 7070  (jtxt, mime="app
-00018b90: 6c69 6361 7469 6f6e 2f6a 736f 6e22 290a  lication/json").
-00018ba0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-00018bb0: 7275 650a 0a20 2020 2064 6566 2068 616e  rue..    def han
-00018bc0: 646c 655f 726d 2873 656c 662c 2072 6571  dle_rm(self, req
-00018bd0: 2029 2020 3a0a 2020 2020 2020 2020 6966   )  :.        if
-00018be0: 206e 6f74 2072 6571 2061 6e64 206e 6f74   not req and not
-00018bf0: 2073 656c 662e 6361 6e5f 6465 6c65 7465   self.can_delete
-00018c00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00018c10: 6973 6520 5065 626b 6163 2834 3033 2c20  ise Pebkac(403, 
-00018c20: 226e 6f74 2061 6c6c 6f77 6564 2066 6f72  "not allowed for
-00018c30: 2075 7365 7220 2220 2b20 7365 6c66 2e75   user " + self.u
-00018c40: 6e61 6d65 290a 0a20 2020 2020 2020 2069  name)..        i
-00018c50: 6620 7365 6c66 2e61 7267 732e 6e6f 5f64  f self.args.no_d
-00018c60: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
-00018c70: 7261 6973 6520 5065 626b 6163 2834 3033  raise Pebkac(403
-00018c80: 2c20 2274 6865 2064 656c 6574 6520 6665  , "the delete fe
-00018c90: 6174 7572 6520 6973 2064 6973 6162 6c65  ature is disable
-00018ca0: 6420 696e 2073 6572 7665 7220 636f 6e66  d in server conf
-00018cb0: 6967 2229 0a0a 2020 2020 2020 2020 6966  ig")..        if
-00018cc0: 206e 6f74 2072 6571 3a0a 2020 2020 2020   not req:.      
-00018cd0: 2020 2020 2020 7265 7120 3d20 5b73 656c        req = [sel
-00018ce0: 662e 7670 6174 685d 0a20 2020 2020 2020  f.vpath].       
-00018cf0: 2065 6c69 6620 7365 6c66 2e69 735f 7670   elif self.is_vp
-00018d00: 726f 7869 6564 3a0a 2020 2020 2020 2020  roxied:.        
-00018d10: 2020 2020 7265 7120 3d20 5b78 5b6c 656e      req = [x[len
-00018d20: 2873 656c 662e 6172 6773 2e53 5229 203a  (self.args.SR) :
-00018d30: 5d20 666f 7220 7820 696e 2072 6571 5d0a  ] for x in req].
-00018d40: 0a20 2020 2020 2020 206e 6c69 6d20 3d20  .        nlim = 
-00018d50: 696e 7428 7365 6c66 2e75 7061 7261 6d2e  int(self.uparam.
-00018d60: 6765 7428 226c 696d 2229 206f 7220 3029  get("lim") or 0)
-00018d70: 0a20 2020 2020 2020 206c 696d 203d 205b  .        lim = [
-00018d80: 6e6c 696d 2c20 6e6c 696d 5d20 6966 206e  nlim, nlim] if n
-00018d90: 6c69 6d20 656c 7365 205b 5d0a 0a20 2020  lim else []..   
-00018da0: 2020 2020 2078 203d 2073 656c 662e 636f       x = self.co
-00018db0: 6e6e 2e68 7372 762e 6272 6f6b 6572 2e61  nn.hsrv.broker.a
-00018dc0: 736b 2822 7570 326b 2e68 616e 646c 655f  sk("up2k.handle_
-00018dd0: 726d 222c 2073 656c 662e 756e 616d 652c  rm", self.uname,
-00018de0: 2073 656c 662e 6970 2c20 7265 712c 206c   self.ip, req, l
-00018df0: 696d 290a 2020 2020 2020 2020 7365 6c66  im).        self
-00018e00: 2e6c 6f75 645f 7265 706c 7928 782e 6765  .loud_reply(x.ge
-00018e10: 7428 2929 0a20 2020 2020 2020 2072 6574  t()).        ret
-00018e20: 7572 6e20 5472 7565 0a0a 2020 2020 6465  urn True..    de
-00018e30: 6620 6861 6e64 6c65 5f6d 7628 7365 6c66  f handle_mv(self
-00018e40: 2920 203a 0a20 2020 2020 2020 2023 2066  )  :.        # f
-00018e50: 756c 6c20 7061 7468 206f 6620 6e65 7720  ull path of new 
-00018e60: 6c6f 6320 2869 6e63 6c20 6669 6c65 6e61  loc (incl filena
-00018e70: 6d65 290a 2020 2020 2020 2020 6473 7420  me).        dst 
-00018e80: 3d20 7365 6c66 2e75 7061 7261 6d2e 6765  = self.uparam.ge
-00018e90: 7428 226d 6f76 6522 290a 0a20 2020 2020  t("move")..     
-00018ea0: 2020 2069 6620 7365 6c66 2e69 735f 7670     if self.is_vp
-00018eb0: 726f 7869 6564 2061 6e64 2064 7374 2061  roxied and dst a
-00018ec0: 6e64 2064 7374 2e73 7461 7274 7377 6974  nd dst.startswit
-00018ed0: 6828 7365 6c66 2e61 7267 732e 5352 293a  h(self.args.SR):
-00018ee0: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-00018ef0: 203d 2064 7374 5b6c 656e 2873 656c 662e   = dst[len(self.
-00018f00: 6172 6773 2e52 5329 203a 5d0a 0a20 2020  args.RS) :]..   
-00018f10: 2020 2020 2069 6620 6e6f 7420 6473 743a       if not dst:
-00018f20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00018f30: 7365 2050 6562 6b61 6328 3430 302c 2022  se Pebkac(400, "
-00018f40: 6e65 6564 2064 7374 2076 7061 7468 2229  need dst vpath")
-00018f50: 0a0a 2020 2020 2020 2020 2320 782d 7777  ..        # x-ww
-00018f60: 772d 666f 726d 2d75 726c 656e 636f 6465  w-form-urlencode
-00018f70: 6420 2875 726c 2071 7565 7279 2070 6172  d (url query par
-00018f80: 7429 2075 7365 730a 2020 2020 2020 2020  t) uses.        
-00018f90: 2320 6569 7468 6572 202b 206f 7220 2532  # either + or %2
-00018fa0: 3020 666f 7220 3078 3230 2073 6f20 6861  0 for 0x20 so ha
-00018fb0: 6e64 6c65 2062 6f74 680a 2020 2020 2020  ndle both.      
-00018fc0: 2020 6473 7420 3d20 756e 7175 6f74 6570    dst = unquotep
-00018fd0: 2864 7374 2e72 6570 6c61 6365 2822 2b22  (dst.replace("+"
-00018fe0: 2c20 2220 2229 290a 2020 2020 2020 2020  , " ")).        
-00018ff0: 7265 7475 726e 2073 656c 662e 5f6d 7628  return self._mv(
-00019000: 7365 6c66 2e76 7061 7468 2c20 6473 7429  self.vpath, dst)
-00019010: 0a0a 2020 2020 6465 6620 5f6d 7628 7365  ..    def _mv(se
-00019020: 6c66 2c20 7673 7263 202c 2076 6473 7420  lf, vsrc , vdst 
-00019030: 2920 203a 0a20 2020 2020 2020 2069 6620  )  :.        if 
-00019040: 6e6f 7420 7365 6c66 2e63 616e 5f6d 6f76  not self.can_mov
-00019050: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00019060: 6169 7365 2050 6562 6b61 6328 3430 332c  aise Pebkac(403,
-00019070: 2022 6e6f 7420 616c 6c6f 7765 6420 666f   "not allowed fo
-00019080: 7220 7573 6572 2022 202b 2073 656c 662e  r user " + self.
-00019090: 756e 616d 6529 0a0a 2020 2020 2020 2020  uname)..        
-000190a0: 6966 2073 656c 662e 6172 6773 2e6e 6f5f  if self.args.no_
-000190b0: 6d76 3a0a 2020 2020 2020 2020 2020 2020  mv:.            
-000190c0: 7261 6973 6520 5065 626b 6163 2834 3033  raise Pebkac(403
-000190d0: 2c20 2274 6865 2072 656e 616d 652f 6d6f  , "the rename/mo
-000190e0: 7665 2066 6561 7475 7265 2069 7320 6469  ve feature is di
-000190f0: 7361 626c 6564 2069 6e20 7365 7276 6572  sabled in server
-00019100: 2063 6f6e 6669 6722 290a 0a20 2020 2020   config")..     
-00019110: 2020 2078 203d 2073 656c 662e 636f 6e6e     x = self.conn
-00019120: 2e68 7372 762e 6272 6f6b 6572 2e61 736b  .hsrv.broker.ask
-00019130: 2822 7570 326b 2e68 616e 646c 655f 6d76  ("up2k.handle_mv
-00019140: 222c 2073 656c 662e 756e 616d 652c 2076  ", self.uname, v
-00019150: 7372 632c 2076 6473 7429 0a20 2020 2020  src, vdst).     
-00019160: 2020 2073 656c 662e 6c6f 7564 5f72 6570     self.loud_rep
-00019170: 6c79 2878 2e67 6574 2829 2c20 7374 6174  ly(x.get(), stat
-00019180: 7573 3d32 3031 290a 2020 2020 2020 2020  us=201).        
-00019190: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
-000191a0: 2064 6566 2074 785f 6c73 2873 656c 662c   def tx_ls(self,
-000191b0: 206c 7320 2029 2020 3a0a 2020 2020 2020   ls  )  :.      
-000191c0: 2020 6469 7273 203d 206c 735b 2264 6972    dirs = ls["dir
-000191d0: 7322 5d0a 2020 2020 2020 2020 6669 6c65  s"].        file
-000191e0: 7320 3d20 6c73 5b22 6669 6c65 7322 5d0a  s = ls["files"].
-000191f0: 2020 2020 2020 2020 6172 6720 3d20 7365          arg = se
-00019200: 6c66 2e75 7061 7261 6d5b 226c 7322 5d0a  lf.uparam["ls"].
-00019210: 2020 2020 2020 2020 6966 2061 7267 2069          if arg i
-00019220: 6e20 5b22 7622 2c20 2274 222c 2022 7478  n ["v", "t", "tx
-00019230: 7422 5d3a 0a20 2020 2020 2020 2020 2020  t"]:.           
-00019240: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00019250: 2020 2020 2020 6269 6767 6573 7420 3d20        biggest = 
-00019260: 6d61 7828 6c73 5b22 6669 6c65 7322 5d20  max(ls["files"] 
-00019270: 2b20 6c73 5b22 6469 7273 225d 2c20 6b65  + ls["dirs"], ke
-00019280: 793d 6974 656d 6765 7474 6572 2822 737a  y=itemgetter("sz
-00019290: 2229 295b 2273 7a22 5d0a 2020 2020 2020  "))["sz"].      
-000192a0: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
-000192b0: 2020 2020 2020 2020 2020 2020 2020 6269                bi
-000192c0: 6767 6573 7420 3d20 300a 0a20 2020 2020  ggest = 0..     
-000192d0: 2020 2020 2020 2069 6620 6172 6720 3d3d         if arg ==
-000192e0: 2022 7622 3a0a 2020 2020 2020 2020 2020   "v":.          
-000192f0: 2020 2020 2020 666d 7420 3d20 225c 3033        fmt = "\03
-00019300: 335b 303b 373b 3336 6d7b 7b7d 7d7b 7b3a  3[0;7;36m{{}}{{:
-00019310: 3e7b 7d7d 7d5c 3033 335b 306d 207b 7b7d  >{}}}\033[0m {{}
-00019320: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00019330: 2020 206e 666d 7420 3d20 227b 7d22 0a20     nfmt = "{}". 
-00019340: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00019350: 6967 6765 7374 203d 2030 0a20 2020 2020  iggest = 0.     
-00019360: 2020 2020 2020 2020 2020 2066 3220 3d20             f2 = 
-00019370: 2222 2e6a 6f69 6e28 0a20 2020 2020 2020  "".join(.       
-00019380: 2020 2020 2020 2020 2020 2020 2022 7b7d               "{}
-00019390: 7b7b 7d7d 222e 666f 726d 6174 2878 290a  {{}}".format(x).
-000193a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193b0: 2020 2020 666f 7220 7820 696e 205b 0a20      for x in [. 
-000193c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000193d0: 2020 2020 2020 2022 5c30 3333 5b37 6d22         "\033[7m"
-000193e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000193f0: 2020 2020 2020 2020 2020 225c 3033 335b            "\033[
-00019400: 3237 6d22 2c0a 2020 2020 2020 2020 2020  27m",.          
-00019410: 2020 2020 2020 2020 2020 2020 2020 2222                ""
-00019420: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00019430: 2020 2020 2020 2020 2020 225c 3033 335b            "\033[
-00019440: 303b 316d 222c 0a20 2020 2020 2020 2020  0;1m",.         
-00019450: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00019460: 5c30 3333 5b30 3b33 366d 222c 0a20 2020  \033[0;36m",.   
-00019470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019480: 2020 2020 2022 5c30 3333 5b30 6d22 2c0a       "\033[0m",.
-00019490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194a0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-000194b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000194c0: 2020 2020 2020 2020 6374 6162 203d 207b          ctab = {
-000194d0: 2242 223a 2036 2c20 224b 223a 2035 2c20  "B": 6, "K": 5, 
-000194e0: 224d 223a 2031 2c20 2247 223a 2033 7d0a  "M": 1, "G": 3}.
-000194f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019500: 666f 7220 6c73 7420 696e 205b 6469 7273  for lst in [dirs
-00019510: 2c20 6669 6c65 735d 3a0a 2020 2020 2020  , files]:.      
-00019520: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00019530: 7220 7820 696e 206c 7374 3a0a 2020 2020  r x in lst:.    
-00019540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019550: 2020 2020 6120 3d20 785b 2264 7422 5d2e      a = x["dt"].
-00019560: 7265 706c 6163 6528 222d 222c 2022 2022  replace("-", " "
-00019570: 292e 7265 706c 6163 6528 223a 222c 2022  ).replace(":", "
-00019580: 2022 292e 7370 6c69 7428 2220 2229 0a20   ").split(" "). 
-00019590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195a0: 2020 2020 2020 2078 5b22 6474 225d 203d         x["dt"] =
-000195b0: 2066 322e 666f 726d 6174 282a 6c69 7374   f2.format(*list
-000195c0: 2861 2929 0a20 2020 2020 2020 2020 2020  (a)).           
-000195d0: 2020 2020 2020 2020 2020 2020 2073 7a20               sz 
-000195e0: 3d20 6875 6d61 6e73 697a 6528 785b 2273  = humansize(x["s
-000195f0: 7a22 5d2c 2054 7275 6529 0a20 2020 2020  z"], True).     
-00019600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019610: 2020 2078 5b22 737a 225d 203d 2022 5c30     x["sz"] = "\0
-00019620: 3333 5b30 3b33 7b7d 6d20 7b3a 3e35 7d22  33[0;3{}m {:>5}"
-00019630: 2e66 6f72 6d61 7428 6374 6162 2e67 6574  .format(ctab.get
-00019640: 2873 7a5b 2d31 3a5d 2c20 3029 2c20 737a  (sz[-1:], 0), sz
-00019650: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00019660: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00019670: 2020 2020 666d 7420 3d20 227b 7b7d 7d20      fmt = "{{}} 
-00019680: 207b 7b3a 7b7d 2c7d 7d20 207b 7b7d 7d22   {{:{},}}  {{}}"
-00019690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000196a0: 206e 666d 7420 3d20 227b 3a2c 7d22 0a0a   nfmt = "{:,}"..
-000196b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000196c0: 7820 696e 2064 6972 733a 0a20 2020 2020  x in dirs:.     
-000196d0: 2020 2020 2020 2020 2020 206e 203d 2078             n = x
-000196e0: 5b22 6e61 6d65 225d 202b 2022 2f22 0a20  ["name"] + "/". 
-000196f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00019700: 6620 6172 6720 3d3d 2022 7622 3a0a 2020  f arg == "v":.  
-00019710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019720: 2020 6e20 3d20 225c 3033 335b 3934 6d22    n = "\033[94m"
-00019730: 202b 206e 0a0a 2020 2020 2020 2020 2020   + n..          
-00019740: 2020 2020 2020 785b 226e 616d 6522 5d20        x["name"] 
-00019750: 3d20 6e0a 0a20 2020 2020 2020 2020 2020  = n..           
-00019760: 2066 6d74 203d 2066 6d74 2e66 6f72 6d61   fmt = fmt.forma
-00019770: 7428 6c65 6e28 6e66 6d74 2e66 6f72 6d61  t(len(nfmt.forma
-00019780: 7428 6269 6767 6573 7429 2929 0a20 2020  t(biggest))).   
-00019790: 2020 2020 2020 2020 2072 6574 6c20 3d20           retl = 
-000197a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000197b0: 2020 2223 207b 7d3a 207b 7d22 2e66 6f72    "# {}: {}".for
-000197c0: 6d61 7428 782c 206c 735b 785d 290a 2020  mat(x, ls[x]).  
-000197d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000197e0: 7220 7820 696e 205b 2261 6363 7422 2c20  r x in ["acct", 
-000197f0: 2270 6572 6d73 222c 2022 7372 7669 6e66  "perms", "srvinf
-00019800: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00019810: 2020 2069 6620 7820 696e 206c 730a 2020     if x in ls.  
-00019820: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
-00019830: 2020 2020 2020 2020 7265 746c 202b 3d20          retl += 
-00019840: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00019850: 2020 666d 742e 666f 726d 6174 2878 5b22    fmt.format(x["
-00019860: 6474 225d 2c20 785b 2273 7a22 5d2c 2078  dt"], x["sz"], x
-00019870: 5b22 6e61 6d65 225d 290a 2020 2020 2020  ["name"]).      
-00019880: 2020 2020 2020 2020 2020 666f 7220 7920            for y 
-00019890: 696e 205b 6469 7273 2c20 6669 6c65 735d  in [dirs, files]
-000198a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000198b0: 2066 6f72 2078 2069 6e20 790a 2020 2020   for x in y.    
-000198c0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-000198d0: 2020 2020 2020 7265 7420 3d20 225c 6e22        ret = "\n"
-000198e0: 2e6a 6f69 6e28 7265 746c 290a 2020 2020  .join(retl).    
-000198f0: 2020 2020 2020 2020 6d69 6d65 203d 2022          mime = "
-00019900: 7465 7874 2f70 6c61 696e 3b20 6368 6172  text/plain; char
-00019910: 7365 743d 7574 662d 3822 0a20 2020 2020  set=utf-8".     
-00019920: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00019930: 2020 2020 205b 782e 706f 7028 6b29 2066       [x.pop(k) f
-00019940: 6f72 206b 2069 6e20 5b22 6e61 6d65 222c  or k in ["name",
-00019950: 2022 6474 225d 2066 6f72 2079 2069 6e20   "dt"] for y in 
-00019960: 5b64 6972 732c 2066 696c 6573 5d20 666f  [dirs, files] fo
-00019970: 7220 7820 696e 2079 5d0a 0a20 2020 2020  r x in y]..     
-00019980: 2020 2020 2020 2072 6574 203d 206a 736f         ret = jso
-00019990: 6e2e 6475 6d70 7328 6c73 290a 2020 2020  n.dumps(ls).    
-000199a0: 2020 2020 2020 2020 6d69 6d65 203d 2022          mime = "
-000199b0: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
-000199c0: 220a 0a20 2020 2020 2020 2072 6574 202b  "..        ret +
-000199d0: 3d20 225c 6e5c 3033 335b 306d 2220 6966  = "\n\033[0m" if
-000199e0: 2061 7267 203d 3d20 2276 2220 656c 7365   arg == "v" else
-000199f0: 2022 5c6e 220a 2020 2020 2020 2020 7365   "\n".        se
-00019a00: 6c66 2e72 6570 6c79 2872 6574 2e65 6e63  lf.reply(ret.enc
-00019a10: 6f64 6528 2275 7466 2d38 222c 2022 7265  ode("utf-8", "re
-00019a20: 706c 6163 6522 292c 206d 696d 653d 6d69  place"), mime=mi
-00019a30: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
-00019a40: 726e 2054 7275 650a 0a20 2020 2064 6566  rn True..    def
-00019a50: 2074 785f 6272 6f77 7365 7228 7365 6c66   tx_browser(self
-00019a60: 2920 203a 0a20 2020 2020 2020 2076 7061  )  :.        vpa
-00019a70: 7468 203d 2022 220a 2020 2020 2020 2020  th = "".        
-00019a80: 7670 6e6f 6465 7320 3d20 5b5b 2222 2c20  vpnodes = [["", 
-00019a90: 222f 225d 5d0a 2020 2020 2020 2020 6966  "/"]].        if
-00019aa0: 2073 656c 662e 7670 6174 683a 0a20 2020   self.vpath:.   
-00019ab0: 2020 2020 2020 2020 2066 6f72 206e 6f64           for nod
-00019ac0: 6520 696e 2073 656c 662e 7670 6174 682e  e in self.vpath.
-00019ad0: 7370 6c69 7428 222f 2229 3a0a 2020 2020  split("/"):.    
-00019ae0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00019af0: 6f74 2076 7061 7468 3a0a 2020 2020 2020  ot vpath:.      
-00019b00: 2020 2020 2020 2020 2020 2020 2020 7670                vp
-00019b10: 6174 6820 3d20 6e6f 6465 0a20 2020 2020  ath = node.     
-00019b20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00019b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019b40: 2020 2020 2076 7061 7468 202b 3d20 222f       vpath += "/
-00019b50: 2220 2b20 6e6f 6465 0a0a 2020 2020 2020  " + node..      
-00019b60: 2020 2020 2020 2020 2020 7670 6e6f 6465            vpnode
-00019b70: 732e 6170 7065 6e64 285b 7175 6f74 6570  s.append([quotep
-00019b80: 2876 7061 7468 2920 2b20 222f 222c 2068  (vpath) + "/", h
-00019b90: 746d 6c5f 6573 6361 7065 286e 6f64 652c  tml_escape(node,
-00019ba0: 2063 726c 663d 5472 7565 295d 290a 0a20   crlf=True)]).. 
-00019bb0: 2020 2020 2020 2076 6e2c 2072 656d 203d         vn, rem =
-00019bc0: 2073 656c 662e 6173 7276 2e76 6673 2e67   self.asrv.vfs.g
-00019bd0: 6574 2873 656c 662e 7670 6174 682c 2073  et(self.vpath, s
-00019be0: 656c 662e 756e 616d 652c 2046 616c 7365  elf.uname, False
-00019bf0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
-00019c00: 2061 6273 7061 7468 203d 2076 6e2e 6463   abspath = vn.dc
-00019c10: 616e 6f6e 6963 616c 2872 656d 290a 2020  anonical(rem).  
-00019c20: 2020 2020 2020 6462 762c 2076 7265 6d20        dbv, vrem 
-00019c30: 3d20 766e 2e67 6574 5f64 6276 2872 656d  = vn.get_dbv(rem
-00019c40: 290a 0a20 2020 2020 2020 2074 7279 3a0a  )..        try:.
-00019c50: 2020 2020 2020 2020 2020 2020 7374 203d              st =
-00019c60: 2062 6f73 2e73 7461 7428 6162 7370 6174   bos.stat(abspat
-00019c70: 6829 0a20 2020 2020 2020 2065 7863 6570  h).        excep
-00019c80: 743a 0a20 2020 2020 2020 2020 2020 2072  t:.            r
-00019c90: 6574 7572 6e20 7365 6c66 2e74 785f 3430  eturn self.tx_40
-00019ca0: 3428 290a 0a20 2020 2020 2020 2069 6620  4()..        if 
-00019cb0: 7265 6d2e 7374 6172 7473 7769 7468 2822  rem.startswith("
-00019cc0: 2e68 6973 742f 7570 326b 2e22 2920 6f72  .hist/up2k.") or
-00019cd0: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
-00019ce0: 656d 2e65 6e64 7377 6974 6828 222f 6469  em.endswith("/di
-00019cf0: 722e 7478 7422 2920 616e 6420 7265 6d2e  r.txt") and rem.
-00019d00: 7374 6172 7473 7769 7468 2822 2e68 6973  startswith(".his
-00019d10: 742f 7468 2f22 290a 2020 2020 2020 2020  t/th/").        
-00019d20: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00019d30: 6169 7365 2050 6562 6b61 6328 3430 3329  aise Pebkac(403)
-00019d40: 0a0a 2020 2020 2020 2020 6532 6420 3d20  ..        e2d = 
-00019d50: 2265 3264 2220 696e 2076 6e2e 666c 6167  "e2d" in vn.flag
-00019d60: 730a 2020 2020 2020 2020 6532 7420 3d20  s.        e2t = 
-00019d70: 2265 3274 2220 696e 2076 6e2e 666c 6167  "e2t" in vn.flag
-00019d80: 730a 0a20 2020 2020 2020 2073 656c 662e  s..        self.
-00019d90: 6874 6d6c 5f68 6561 6420 3d20 766e 2e66  html_head = vn.f
-00019da0: 6c61 6773 2e67 6574 2822 6874 6d6c 5f68  lags.get("html_h
-00019db0: 6561 6422 2c20 2222 290a 2020 2020 2020  ead", "").      
-00019dc0: 2020 6966 2076 6e2e 666c 6167 732e 6765    if vn.flags.ge
-00019dd0: 7428 226e 6f72 6f62 6f74 7322 2920 6f72  t("norobots") or
-00019de0: 2022 6222 2069 6e20 7365 6c66 2e75 7061   "b" in self.upa
-00019df0: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
-00019e00: 2073 656c 662e 6f75 745f 6865 6164 6572   self.out_header
-00019e10: 735b 2258 2d52 6f62 6f74 732d 5461 6722  s["X-Robots-Tag"
-00019e20: 5d20 3d20 226e 6f69 6e64 6578 2c20 6e6f  ] = "noindex, no
-00019e30: 666f 6c6c 6f77 220a 2020 2020 2020 2020  follow".        
-00019e40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00019e50: 2020 7365 6c66 2e6f 7574 5f68 6561 6465    self.out_heade
-00019e60: 7273 2e70 6f70 2822 582d 526f 626f 7473  rs.pop("X-Robots
-00019e70: 2d54 6167 222c 204e 6f6e 6529 0a0a 2020  -Tag", None)..  
-00019e80: 2020 2020 2020 6973 5f64 6972 203d 2073        is_dir = s
-00019e90: 7461 742e 535f 4953 4449 5228 7374 2e73  tat.S_ISDIR(st.s
-00019ea0: 745f 6d6f 6465 290a 2020 2020 2020 2020  t_mode).        
-00019eb0: 6963 7572 203d 204e 6f6e 650a 2020 2020  icur = None.    
-00019ec0: 2020 2020 6966 2065 3274 206f 7220 2865      if e2t or (e
-00019ed0: 3264 2061 6e64 2069 735f 6469 7229 3a0a  2d and is_dir):.
-00019ee0: 2020 2020 2020 2020 2020 2020 6964 7820              idx 
-00019ef0: 3d20 7365 6c66 2e63 6f6e 6e2e 6765 745f  = self.conn.get_
-00019f00: 7532 6964 7828 290a 2020 2020 2020 2020  u2idx().        
-00019f10: 2020 2020 6963 7572 203d 2069 6478 2e67      icur = idx.g
-00019f20: 6574 5f63 7572 2864 6276 2e72 6561 6c70  et_cur(dbv.realp
-00019f30: 6174 6829 0a0a 2020 2020 2020 2020 6966  ath)..        if
-00019f40: 2073 656c 662e 6361 6e5f 7265 6164 3a0a   self.can_read:.
-00019f50: 2020 2020 2020 2020 2020 2020 7468 5f66              th_f
-00019f60: 6d74 203d 2073 656c 662e 7570 6172 616d  mt = self.uparam
-00019f70: 2e67 6574 2822 7468 2229 0a20 2020 2020  .get("th").     
-00019f80: 2020 2020 2020 2069 6620 7468 5f66 6d74         if th_fmt
-00019f90: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00019fa0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00019fb0: 2069 735f 6469 723a 0a20 2020 2020 2020   is_dir:.       
-00019fc0: 2020 2020 2020 2020 2020 2020 2076 7265               vre
-00019fd0: 6d20 3d20 7672 656d 2e72 7374 7269 7028  m = vrem.rstrip(
-00019fe0: 222f 2229 0a20 2020 2020 2020 2020 2020  "/").           
-00019ff0: 2020 2020 2020 2020 2069 6620 6963 7572           if icur
-0001a000: 2061 6e64 2076 7265 6d3a 0a20 2020 2020   and vrem:.     
-0001a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a020: 2020 2071 203d 2022 7365 6c65 6374 2066     q = "select f
-0001a030: 6e20 6672 6f6d 2063 7620 7768 6572 6520  n from cv where 
-0001a040: 7264 3d3f 2061 6e64 2064 6e3d 3f22 0a20  rd=? and dn=?". 
+000115e0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+000115f0: 2020 2020 2020 2020 2020 2069 6620 737a             if sz
+00011600: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00011610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011620: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
+00011630: 3430 302c 2022 656d 7074 7920 6669 6c65  400, "empty file
+00011640: 7320 696e 2070 6f73 7422 290a 0a20 2020  s in post")..   
+00011650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011660: 2069 6620 6c69 6d3a 0a20 2020 2020 2020   if lim:.       
+00011670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011680: 206c 696d 2e6e 7570 2873 656c 662e 6970   lim.nup(self.ip
+00011690: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000116a0: 2020 2020 2020 2020 2020 6c69 6d2e 6275            lim.bu
+000116b0: 7028 7365 6c66 2e69 702c 2073 7a29 0a20  p(self.ip, sz). 
+000116c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116d0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+000116e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116f0: 2020 2020 2020 2020 6c69 6d2e 6368 6b5f          lim.chk_
+00011700: 6466 2874 6162 7370 6174 682c 2073 7a2c  df(tabspath, sz,
+00011710: 2054 7275 6529 0a20 2020 2020 2020 2020   True).         
+00011720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011730: 2020 206c 696d 2e63 686b 5f73 7a28 737a     lim.chk_sz(sz
+00011740: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00011750: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00011760: 6d2e 6368 6b5f 6275 7028 7365 6c66 2e69  m.chk_bup(self.i
+00011770: 7029 0a20 2020 2020 2020 2020 2020 2020  p).             
+00011780: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00011790: 696d 2e63 686b 5f6e 7570 2873 656c 662e  im.chk_nup(self.
+000117a0: 6970 290a 2020 2020 2020 2020 2020 2020  ip).            
+000117b0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+000117c0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+000117d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000117e0: 6966 206e 6f74 206e 756c 6c77 7269 7465  if not nullwrite
+000117f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011810: 2020 626f 732e 756e 6c69 6e6b 2874 6162    bos.unlink(tab
+00011820: 7370 6174 6829 0a20 2020 2020 2020 2020  spath).         
+00011830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011840: 2020 2020 2020 2062 6f73 2e75 6e6c 696e         bos.unlin
+00011850: 6b28 6162 7370 6174 6829 0a20 2020 2020  k(abspath).     
+00011860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011870: 2020 2020 2020 2066 6e61 6d65 203d 206f         fname = o
+00011880: 732e 6465 766e 756c 6c0a 2020 2020 2020  s.devnull.      
+00011890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118a0: 2020 2020 2020 7261 6973 650a 0a20 2020        raise..   
+000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118c0: 2069 6620 6e6f 7420 6e75 6c6c 7772 6974   if not nullwrit
+000118d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000118e0: 2020 2020 2020 2020 2020 2061 746f 6d69             atomi
+000118f0: 635f 6d6f 7665 2874 6162 7370 6174 682c  c_move(tabspath,
+00011900: 2061 6273 7061 7468 290a 0a20 2020 2020   abspath)..     
+00011910: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00011920: 696c 6573 2e61 7070 656e 6428 0a20 2020  iles.append(.   
+00011930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011940: 2020 2020 2028 737a 2c20 7368 615f 6865       (sz, sha_he
+00011950: 782c 2073 6861 5f62 3634 2c20 705f 6669  x, sha_b64, p_fi
+00011960: 6c65 206f 7220 2228 6469 7363 6172 6465  le or "(discarde
+00011970: 6429 222c 2066 6e61 6d65 2c20 6162 7370  d)", fname, absp
+00011980: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
+00011990: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000119a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000119b0: 7420 3d20 7469 6d65 2e74 696d 6528 2920  t = time.time() 
+000119c0: 2d20 6c69 6665 7469 6d65 0a20 2020 2020  - lifetime.     
+000119d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000119e0: 6620 7861 7520 616e 6420 6e6f 7420 7275  f xau and not ru
+000119f0: 6e68 6f6f 6b28 0a20 2020 2020 2020 2020  nhook(.         
+00011a00: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011a10: 656c 662e 6c6f 672c 0a20 2020 2020 2020  elf.log,.       
+00011a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a30: 2078 6175 2c0a 2020 2020 2020 2020 2020   xau,.          
+00011a40: 2020 2020 2020 2020 2020 2020 2020 6162                ab
+00011a50: 7370 6174 682c 0a20 2020 2020 2020 2020  spath,.         
+00011a60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00011a70: 656c 662e 7670 6174 682c 0a20 2020 2020  elf.vpath,.     
+00011a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a90: 2020 2073 656c 662e 686f 7374 2c0a 2020     self.host,.  
+00011aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ab0: 2020 2020 2020 7365 6c66 2e75 6e61 6d65        self.uname
+00011ac0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011ad0: 2020 2020 2020 2020 2020 6174 2c0a 2020            at,.  
+00011ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011af0: 2020 2020 2020 737a 2c0a 2020 2020 2020        sz,.      
+00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b10: 2020 7365 6c66 2e69 702c 0a20 2020 2020    self.ip,.     
+00011b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b30: 2020 2061 742c 0a20 2020 2020 2020 2020     at,.         
+00011b40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00011b50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00011b60: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00011b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b80: 2020 7420 3d20 2275 706c 6f61 6420 626c    t = "upload bl
+00011b90: 6f63 6b65 6420 6279 2078 6175 2073 6572  ocked by xau ser
+00011ba0: 7665 7220 636f 6e66 6967 220a 2020 2020  ver config".    
+00011bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011bc0: 2020 2020 7365 6c66 2e6c 6f67 2874 2c20      self.log(t, 
+00011bd0: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
+00011be0: 2020 2020 2020 2020 2020 206f 732e 756e             os.un
+00011bf0: 6c69 6e6b 2861 6273 7061 7468 290a 2020  link(abspath).  
+00011c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c10: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+00011c20: 6163 2834 3033 2c20 7429 0a0a 2020 2020  ac(403, t)..    
+00011c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c40: 6462 762c 2076 7265 6d20 3d20 7666 732e  dbv, vrem = vfs.
+00011c50: 6765 745f 6462 7628 7265 6d29 0a20 2020  get_dbv(rem).   
+00011c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c70: 2073 656c 662e 636f 6e6e 2e68 7372 762e   self.conn.hsrv.
+00011c80: 6272 6f6b 6572 2e73 6179 280a 2020 2020  broker.say(.    
+00011c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ca0: 2020 2020 2275 7032 6b2e 6861 7368 5f66      "up2k.hash_f
+00011cb0: 696c 6522 2c0a 2020 2020 2020 2020 2020  ile",.          
+00011cc0: 2020 2020 2020 2020 2020 2020 2020 6462                db
+00011cd0: 762e 7265 616c 7061 7468 2c0a 2020 2020  v.realpath,.    
+00011ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cf0: 2020 2020 7666 732e 7670 6174 682c 0a20      vfs.vpath,. 
+00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d10: 2020 2020 2020 2064 6276 2e66 6c61 6773         dbv.flags
+00011d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011d30: 2020 2020 2020 2020 2020 7672 656d 2c0a            vrem,.
+00011d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d50: 2020 2020 2020 2020 666e 616d 652c 0a20          fname,. 
+00011d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d70: 2020 2020 2020 2073 656c 662e 6970 2c0a         self.ip,.
+00011d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d90: 2020 2020 2020 2020 6174 2c0a 2020 2020          at,.    
+00011da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011db0: 2020 2020 7365 6c66 2e75 6e61 6d65 2c0a      self.uname,.
+00011dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011dd0: 2020 2020 2020 2020 5472 7565 2c0a 2020          True,.  
+00011de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011df0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00011e00: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00011e10: 6e2e 6e62 7974 6520 2b3d 2073 7a0a 0a20  n.nbyte += sz.. 
+00011e20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00011e30: 7863 6570 7420 5065 626b 6163 3a0a 2020  xcept Pebkac:.  
+00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e50: 2020 7365 6c66 2e70 6172 7365 722e 6472    self.parser.dr
+00011e60: 6f70 2829 0a20 2020 2020 2020 2020 2020  op().           
+00011e70: 2020 2020 2020 2020 2072 6169 7365 0a0a           raise..
+00011e80: 2020 2020 2020 2020 6578 6365 7074 2050          except P
+00011e90: 6562 6b61 6320 6173 2065 783a 0a20 2020  ebkac as ex:.   
+00011ea0: 2020 2020 2020 2020 2065 7272 6d73 6720           errmsg 
+00011eb0: 3d20 766f 6c5f 7361 6e28 0a20 2020 2020  = vol_san(.     
+00011ec0: 2020 2020 2020 2020 2020 206c 6973 7428             list(
+00011ed0: 7365 6c66 2e61 7372 762e 7666 732e 616c  self.asrv.vfs.al
+00011ee0: 6c5f 766f 6c73 2e76 616c 7565 7328 2929  l_vols.values())
+00011ef0: 2c20 756e 6963 6f64 6528 6578 292e 656e  , unicode(ex).en
+00011f00: 636f 6465 2822 7574 662d 3822 290a 2020  code("utf-8").  
+00011f10: 2020 2020 2020 2020 2020 292e 6465 636f            ).deco
+00011f20: 6465 2822 7574 662d 3822 290a 0a20 2020  de("utf-8")..   
+00011f30: 2020 2020 2074 6420 3d20 6d61 7828 302e       td = max(0.
+00011f40: 312c 2074 696d 652e 7469 6d65 2829 202d  1, time.time() -
+00011f50: 2074 3029 0a20 2020 2020 2020 2073 7a5f   t0).        sz_
+00011f60: 746f 7461 6c20 3d20 7375 6d28 785b 305d  total = sum(x[0]
+00011f70: 2066 6f72 2078 2069 6e20 6669 6c65 7329   for x in files)
+00011f80: 0a20 2020 2020 2020 2073 7064 203d 2028  .        spd = (
+00011f90: 737a 5f74 6f74 616c 202f 2074 6429 202f  sz_total / td) /
+00011fa0: 2028 3130 3234 202a 2031 3032 3429 0a0a   (1024 * 1024)..
+00011fb0: 2020 2020 2020 2020 7374 6174 7573 203d          status =
+00011fc0: 2022 4f4b 220a 2020 2020 2020 2020 6966   "OK".        if
+00011fd0: 2065 7272 6d73 673a 0a20 2020 2020 2020   errmsg:.       
+00011fe0: 2020 2020 2073 656c 662e 6c6f 6728 6572       self.log(er
+00011ff0: 726d 7367 2c20 3329 0a20 2020 2020 2020  rmsg, 3).       
+00012000: 2020 2020 2073 7461 7475 7320 3d20 2245       status = "E
+00012010: 5252 4f52 220a 0a20 2020 2020 2020 206d  RROR"..        m
+00012020: 7367 203d 2022 7b7d 202f 2f20 7b7d 2062  sg = "{} // {} b
+00012030: 7974 6573 202f 2f20 7b3a 2e33 667d 204d  ytes // {:.3f} M
+00012040: 6942 2f73 5c6e 222e 666f 726d 6174 2873  iB/s\n".format(s
+00012050: 7461 7475 732c 2073 7a5f 746f 7461 6c2c  tatus, sz_total,
+00012060: 2073 7064 290a 2020 2020 2020 2020 6a6d   spd).        jm
+00012070: 7367 2020 203d 207b 0a20 2020 2020 2020  sg   = {.       
+00012080: 2020 2020 2022 7374 6174 7573 223a 2073       "status": s
+00012090: 7461 7475 732c 0a20 2020 2020 2020 2020  tatus,.         
+000120a0: 2020 2022 737a 223a 2073 7a5f 746f 7461     "sz": sz_tota
+000120b0: 6c2c 0a20 2020 2020 2020 2020 2020 2022  l,.            "
+000120c0: 6d62 7073 223a 2072 6f75 6e64 2873 7064  mbps": round(spd
+000120d0: 2c20 3329 2c0a 2020 2020 2020 2020 2020  , 3),.          
+000120e0: 2020 2266 696c 6573 223a 205b 5d2c 0a20    "files": [],. 
+000120f0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+00012100: 2020 6966 2065 7272 6d73 673a 0a20 2020    if errmsg:.   
+00012110: 2020 2020 2020 2020 206d 7367 202b 3d20           msg += 
+00012120: 6572 726d 7367 202b 2022 5c6e 220a 2020  errmsg + "\n".  
+00012130: 2020 2020 2020 2020 2020 6a6d 7367 5b22            jmsg["
+00012140: 6572 726f 7222 5d20 3d20 6572 726d 7367  error"] = errmsg
+00012150: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+00012160: 6d73 6720 3d20 2245 5252 4f52 3a20 2220  msg = "ERROR: " 
+00012170: 2b20 6572 726d 7367 0a0a 2020 2020 2020  + errmsg..      
+00012180: 2020 666f 7220 737a 2c20 7368 615f 6865    for sz, sha_he
+00012190: 782c 2073 6861 5f62 3634 2c20 6f66 6e2c  x, sha_b64, ofn,
+000121a0: 206c 666e 2c20 6170 2069 6e20 6669 6c65   lfn, ap in file
+000121b0: 733a 0a20 2020 2020 2020 2020 2020 2076  s:.            v
+000121c0: 7375 6620 3d20 2222 0a20 2020 2020 2020  suf = "".       
+000121d0: 2020 2020 2069 6620 2873 656c 662e 6361       if (self.ca
+000121e0: 6e5f 7265 6164 206f 7220 7365 6c66 2e63  n_read or self.c
+000121f0: 616e 5f75 7067 6574 2920 616e 6420 2266  an_upget) and "f
+00012200: 6b22 2069 6e20 7666 732e 666c 6167 733a  k" in vfs.flags:
+00012210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012220: 2076 7375 6620 3d20 223f 6b3d 2220 2b20   vsuf = "?k=" + 
+00012230: 7365 6c66 2e67 656e 5f66 6b28 0a20 2020  self.gen_fk(.   
+00012240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012250: 2073 656c 662e 6172 6773 2e66 6b5f 7361   self.args.fk_sa
+00012260: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
+00012270: 2020 2020 2020 2020 6170 2c0a 2020 2020          ap,.    
+00012280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012290: 737a 2c0a 2020 2020 2020 2020 2020 2020  sz,.            
+000122a0: 2020 2020 2020 2020 3020 6966 2041 4e59          0 if ANY
+000122b0: 5749 4e20 6f72 206e 6f74 2061 7020 656c  WIN or not ap el
+000122c0: 7365 2062 6f73 2e73 7461 7428 6170 292e  se bos.stat(ap).
+000122d0: 7374 5f69 6e6f 2c0a 2020 2020 2020 2020  st_ino,.        
+000122e0: 2020 2020 2020 2020 295b 3a20 7666 732e          )[: vfs.
+000122f0: 666c 6167 735b 2266 6b22 5d5d 0a0a 2020  flags["fk"]]..  
+00012300: 2020 2020 2020 2020 2020 7670 6174 6820            vpath 
+00012310: 3d20 227b 7d2f 7b7d 222e 666f 726d 6174  = "{}/{}".format
+00012320: 2875 706c 6f61 645f 7670 6174 682c 206c  (upload_vpath, l
+00012330: 666e 292e 7374 7269 7028 222f 2229 0a20  fn).strip("/"). 
+00012340: 2020 2020 2020 2020 2020 2072 656c 5f75             rel_u
+00012350: 726c 203d 2071 756f 7465 7028 7365 6c66  rl = quotep(self
+00012360: 2e61 7267 732e 5253 202b 2076 7061 7468  .args.RS + vpath
+00012370: 2920 2b20 7673 7566 0a20 2020 2020 2020  ) + vsuf.       
+00012380: 2020 2020 206d 7367 202b 3d20 2773 6861       msg += 'sha
+00012390: 3531 323a 207b 7d20 2f2f 207b 7d20 2f2f  512: {} // {} //
+000123a0: 207b 7d20 6279 7465 7320 2f2f 203c 6120   {} bytes // <a 
+000123b0: 6872 6566 3d22 2f7b 7d22 3e7b 7d3c 2f61  href="/{}">{}</a
+000123c0: 3e20 7b7d 5c6e 272e 666f 726d 6174 280a  > {}\n'.format(.
+000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123e0: 7368 615f 6865 785b 3a35 365d 2c0a 2020  sha_hex[:56],.  
+000123f0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+00012400: 615f 6236 342c 0a20 2020 2020 2020 2020  a_b64,.         
+00012410: 2020 2020 2020 2073 7a2c 0a20 2020 2020         sz,.     
+00012420: 2020 2020 2020 2020 2020 2072 656c 5f75             rel_u
+00012430: 726c 2c0a 2020 2020 2020 2020 2020 2020  rl,.            
+00012440: 2020 2020 6874 6d6c 5f65 7363 6170 6528      html_escape(
+00012450: 6f66 6e2c 2063 726c 663d 5472 7565 292c  ofn, crlf=True),
+00012460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012470: 2076 7375 662c 0a20 2020 2020 2020 2020   vsuf,.         
+00012480: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00012490: 2023 2074 7275 6e63 6174 6564 2053 4841   # truncated SHA
+000124a0: 2d35 3132 2070 7265 7665 6e74 7320 6c65  -512 prevents le
+000124b0: 6e67 7468 2065 7874 656e 7369 6f6e 2061  ngth extension a
+000124c0: 7474 6163 6b73 3b0a 2020 2020 2020 2020  ttacks;.        
+000124d0: 2020 2020 2320 7573 696e 6720 5348 412d      # using SHA-
+000124e0: 3531 322f 3232 342c 206f 7074 696f 6e61  512/224, optiona
+000124f0: 6c6c 7920 5348 412d 3531 322f 3235 3620  lly SHA-512/256 
+00012500: 3d20 3a36 340a 2020 2020 2020 2020 2020  = :64.          
+00012510: 2020 6a70 6172 7420 3d20 7b0a 2020 2020    jpart = {.    
+00012520: 2020 2020 2020 2020 2020 2020 2275 726c              "url
+00012530: 223a 2022 7b7d 3a2f 2f7b 7d2f 7b7d 222e  ": "{}://{}/{}".
+00012540: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+00012550: 2020 2020 2020 2020 2020 2020 2268 7474              "htt
+00012560: 7073 2220 6966 2073 656c 662e 6973 5f68  ps" if self.is_h
+00012570: 7474 7073 2065 6c73 6520 2268 7474 7022  ttps else "http"
+00012580: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012590: 2020 2020 2020 7365 6c66 2e68 6f73 742c        self.host,
+000125a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000125b0: 2020 2020 2072 656c 5f75 726c 2c0a 2020       rel_url,.  
+000125c0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
+000125d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000125e0: 2022 7368 6135 3132 223a 2073 6861 5f68   "sha512": sha_h
+000125f0: 6578 5b3a 3536 5d2c 0a20 2020 2020 2020  ex[:56],.       
+00012600: 2020 2020 2020 2020 2022 7368 615f 6236           "sha_b6
+00012610: 3422 3a20 7368 615f 6236 342c 0a20 2020  4": sha_b64,.   
+00012620: 2020 2020 2020 2020 2020 2020 2022 737a               "sz
+00012630: 223a 2073 7a2c 0a20 2020 2020 2020 2020  ": sz,.         
+00012640: 2020 2020 2020 2022 666e 223a 206c 666e         "fn": lfn
+00012650: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012660: 2020 2266 6e5f 6f72 6967 223a 206f 666e    "fn_orig": ofn
+00012670: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00012680: 2020 2270 6174 6822 3a20 7265 6c5f 7572    "path": rel_ur
+00012690: 6c2c 0a20 2020 2020 2020 2020 2020 207d  l,.            }
+000126a0: 0a20 2020 2020 2020 2020 2020 206a 6d73  .            jms
+000126b0: 675b 2266 696c 6573 225d 2e61 7070 656e  g["files"].appen
+000126c0: 6428 6a70 6172 7429 0a0a 2020 2020 2020  d(jpart)..      
+000126d0: 2020 7673 7064 203d 2073 656c 662e 5f73    vspd = self._s
+000126e0: 7064 2873 7a5f 746f 7461 6c2c 2046 616c  pd(sz_total, Fal
+000126f0: 7365 290a 2020 2020 2020 2020 7365 6c66  se).        self
+00012700: 2e6c 6f67 2822 7b7d 207b 7d22 2e66 6f72  .log("{} {}".for
+00012710: 6d61 7428 7673 7064 2c20 6d73 6729 290a  mat(vspd, msg)).
+00012720: 0a20 2020 2020 2020 2073 7566 203d 2022  .        suf = "
+00012730: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+00012740: 206e 756c 6c77 7269 7465 2061 6e64 2073   nullwrite and s
+00012750: 656c 662e 6172 6773 2e77 7269 7465 5f75  elf.args.write_u
+00012760: 706c 6f67 3a0a 2020 2020 2020 2020 2020  plog:.          
+00012770: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00012780: 2020 2020 2020 206c 6f67 5f66 6e20 3d20         log_fn = 
+00012790: 2275 702e 7b3a 2e36 667d 2e74 7874 222e  "up.{:.6f}.txt".
+000127a0: 666f 726d 6174 2874 3029 0a20 2020 2020  format(t0).     
+000127b0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+000127c0: 6f70 656e 286c 6f67 5f66 6e2c 2022 7762  open(log_fn, "wb
+000127d0: 2229 2061 7320 663a 0a20 2020 2020 2020  ") as f:.       
+000127e0: 2020 2020 2020 2020 2020 2020 2066 7420               ft 
+000127f0: 3d20 227b 7d3a 7b7d 222e 666f 726d 6174  = "{}:{}".format
+00012800: 2873 656c 662e 6970 2c20 7365 6c66 2e61  (self.ip, self.a
+00012810: 6464 725b 315d 290a 2020 2020 2020 2020  ddr[1]).        
+00012820: 2020 2020 2020 2020 2020 2020 6674 203d              ft =
+00012830: 2022 7b7d 5c6e 7b7d 5c6e 7b7d 5c6e 222e   "{}\n{}\n{}\n".
+00012840: 666f 726d 6174 2866 742c 206d 7367 2e72  format(ft, msg.r
+00012850: 7374 7269 7028 292c 2065 7272 6d73 6729  strip(), errmsg)
+00012860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012870: 2020 2020 2066 2e77 7269 7465 2866 742e       f.write(ft.
+00012880: 656e 636f 6465 2822 7574 662d 3822 2929  encode("utf-8"))
+00012890: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+000128a0: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+000128b0: 2065 783a 0a20 2020 2020 2020 2020 2020   ex:.           
+000128c0: 2020 2020 2073 7566 203d 2022 5c6e 6661       suf = "\nfa
+000128d0: 696c 6564 2074 6f20 7772 6974 6520 7468  iled to write th
+000128e0: 6520 7570 6c6f 6164 2072 6570 6f72 743a  e upload report:
+000128f0: 207b 7d22 2e66 6f72 6d61 7428 6578 290a   {}".format(ex).
+00012900: 0a20 2020 2020 2020 2073 6320 3d20 3430  .        sc = 40
+00012910: 3020 6966 2065 7272 6d73 6720 656c 7365  0 if errmsg else
+00012920: 2032 3031 0a20 2020 2020 2020 2069 6620   201.        if 
+00012930: 7761 6e74 5f75 726c 3a0a 2020 2020 2020  want_url:.      
+00012940: 2020 2020 2020 6d73 6720 3d20 225c 6e22        msg = "\n"
+00012950: 2e6a 6f69 6e28 5b78 5b22 7572 6c22 5d20  .join([x["url"] 
+00012960: 666f 7220 7820 696e 206a 6d73 675b 2266  for x in jmsg["f
+00012970: 696c 6573 225d 5d29 0a20 2020 2020 2020  iles"]]).       
+00012980: 2020 2020 2069 6620 6572 726d 7367 3a0a       if errmsg:.
+00012990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000129a0: 6d73 6720 2b3d 2022 5c6e 2220 2b20 6572  msg += "\n" + er
+000129b0: 726d 7367 0a0a 2020 2020 2020 2020 2020  rmsg..          
+000129c0: 2020 7365 6c66 2e72 6570 6c79 286d 7367    self.reply(msg
+000129d0: 2e65 6e63 6f64 6528 2275 7466 2d38 222c  .encode("utf-8",
+000129e0: 2022 7265 706c 6163 6522 292c 2073 7461   "replace"), sta
+000129f0: 7475 733d 7363 290a 2020 2020 2020 2020  tus=sc).        
+00012a00: 656c 6966 2022 6a22 2069 6e20 7365 6c66  elif "j" in self
+00012a10: 2e75 7061 7261 6d3a 0a20 2020 2020 2020  .uparam:.       
+00012a20: 2020 2020 206a 7478 7420 3d20 6a73 6f6e       jtxt = json
+00012a30: 2e64 756d 7073 286a 6d73 672c 2069 6e64  .dumps(jmsg, ind
+00012a40: 656e 743d 322c 2073 6f72 745f 6b65 7973  ent=2, sort_keys
+00012a50: 3d54 7275 6529 2e65 6e63 6f64 6528 2275  =True).encode("u
+00012a60: 7466 2d38 222c 2022 7265 706c 6163 6522  tf-8", "replace"
+00012a70: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00012a80: 6c66 2e72 6570 6c79 286a 7478 742c 206d  lf.reply(jtxt, m
+00012a90: 696d 653d 2261 7070 6c69 6361 7469 6f6e  ime="application
+00012aa0: 2f6a 736f 6e22 2c20 7374 6174 7573 3d73  /json", status=s
+00012ab0: 6329 0a20 2020 2020 2020 2065 6c73 653a  c).        else:
+00012ac0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012ad0: 662e 7265 6469 7265 6374 280a 2020 2020  f.redirect(.    
+00012ae0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012af0: 2e76 7061 7468 2c0a 2020 2020 2020 2020  .vpath,.        
+00012b00: 2020 2020 2020 2020 6d73 673d 6d73 6720          msg=msg 
+00012b10: 2b20 7375 662c 0a20 2020 2020 2020 2020  + suf,.         
+00012b20: 2020 2020 2020 2066 6c61 766f 723d 2272         flavor="r
+00012b30: 6574 7572 6e20 746f 222c 0a20 2020 2020  eturn to",.     
+00012b40: 2020 2020 2020 2020 2020 2063 6c69 636b             click
+00012b50: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00012b60: 2020 2020 2020 2020 7374 6174 7573 3d73          status=s
+00012b70: 632c 0a20 2020 2020 2020 2020 2020 2029  c,.            )
+00012b80: 0a0a 2020 2020 2020 2020 6966 2065 7272  ..        if err
+00012b90: 6d73 673a 0a20 2020 2020 2020 2020 2020  msg:.           
+00012ba0: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00012bb0: 2020 2020 2020 2073 656c 662e 7061 7273         self.pars
+00012bc0: 6572 2e64 726f 7028 290a 2020 2020 2020  er.drop().      
+00012bd0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00012be0: 2020 2064 6566 2068 616e 646c 655f 7465     def handle_te
+00012bf0: 7874 5f75 706c 6f61 6428 7365 6c66 2920  xt_upload(self) 
+00012c00: 203a 0a20 2020 2020 2020 2061 7373 6572   :.        asser
+00012c10: 7420 7365 6c66 2e70 6172 7365 720a 2020  t self.parser.  
+00012c20: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00012c30: 2020 2020 2020 2063 6c69 5f6c 6173 746d         cli_lastm
+00012c40: 6f64 3320 3d20 696e 7428 7365 6c66 2e70  od3 = int(self.p
+00012c50: 6172 7365 722e 7265 7175 6972 6528 226c  arser.require("l
+00012c60: 6173 746d 6f64 222c 2031 3629 290a 2020  astmod", 16)).  
+00012c70: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+00012c80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00012c90: 5065 626b 6163 2834 3030 2c20 2263 6f75  Pebkac(400, "cou
+00012ca0: 6c64 206e 6f74 2072 6561 6420 6c61 7374  ld not read last
+00012cb0: 6d6f 6420 6672 6f6d 2072 6571 7565 7374  mod from request
+00012cc0: 2229 0a0a 2020 2020 2020 2020 6e75 6c6c  ")..        null
+00012cd0: 7772 6974 6520 3d20 7365 6c66 2e61 7267  write = self.arg
+00012ce0: 732e 6e77 0a20 2020 2020 2020 2076 6673  s.nw.        vfs
+00012cf0: 2c20 7265 6d20 3d20 7365 6c66 2e61 7372  , rem = self.asr
+00012d00: 762e 7666 732e 6765 7428 7365 6c66 2e76  v.vfs.get(self.v
+00012d10: 7061 7468 2c20 7365 6c66 2e75 6e61 6d65  path, self.uname
+00012d20: 2c20 5472 7565 2c20 5472 7565 290a 2020  , True, True).  
+00012d30: 2020 2020 2020 7365 6c66 2e5f 6173 7365        self._asse
+00012d40: 7274 5f73 6166 655f 7265 6d28 7265 6d29  rt_safe_rem(rem)
+00012d50: 0a0a 2020 2020 2020 2020 636c 656e 203d  ..        clen =
+00012d60: 2069 6e74 2873 656c 662e 6865 6164 6572   int(self.header
+00012d70: 732e 6765 7428 2263 6f6e 7465 6e74 2d6c  s.get("content-l
+00012d80: 656e 6774 6822 2c20 2d31 2929 0a20 2020  ength", -1)).   
+00012d90: 2020 2020 2069 6620 636c 656e 203d 3d20       if clen == 
+00012da0: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+00012db0: 7261 6973 6520 5065 626b 6163 2834 3131  raise Pebkac(411
+00012dc0: 290a 0a20 2020 2020 2020 2072 702c 2066  )..        rp, f
+00012dd0: 6e20 3d20 7673 706c 6974 2872 656d 290a  n = vsplit(rem).
+00012de0: 2020 2020 2020 2020 6670 203d 2076 6673          fp = vfs
+00012df0: 2e63 616e 6f6e 6963 616c 2872 7029 0a20  .canonical(rp). 
+00012e00: 2020 2020 2020 206c 696d 203d 2076 6673         lim = vfs
+00012e10: 2e67 6574 5f64 6276 2872 656d 295b 305d  .get_dbv(rem)[0]
+00012e20: 2e6c 696d 0a20 2020 2020 2020 2069 6620  .lim.        if 
+00012e30: 6c69 6d3a 0a20 2020 2020 2020 2020 2020  lim:.           
+00012e40: 2066 702c 2072 7020 3d20 6c69 6d2e 616c   fp, rp = lim.al
+00012e50: 6c28 7365 6c66 2e69 702c 2072 702c 2063  l(self.ip, rp, c
+00012e60: 6c65 6e2c 2066 7029 0a20 2020 2020 2020  len, fp).       
+00012e70: 2020 2020 2062 6f73 2e6d 616b 6564 6972       bos.makedir
+00012e80: 7328 6670 290a 0a20 2020 2020 2020 2066  s(fp)..        f
+00012e90: 7020 3d20 6f73 2e70 6174 682e 6a6f 696e  p = os.path.join
+00012ea0: 2866 702c 2066 6e29 0a20 2020 2020 2020  (fp, fn).       
+00012eb0: 2072 656d 203d 2022 7b7d 2f7b 7d22 2e66   rem = "{}/{}".f
+00012ec0: 6f72 6d61 7428 7270 2c20 666e 292e 7374  ormat(rp, fn).st
+00012ed0: 7269 7028 222f 2229 0a0a 2020 2020 2020  rip("/")..      
+00012ee0: 2020 6966 206e 6f74 2072 656d 2e65 6e64    if not rem.end
+00012ef0: 7377 6974 6828 222e 6d64 2229 3a0a 2020  swith(".md"):.  
+00012f00: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00012f10: 5065 626b 6163 2834 3030 2c20 226f 6e6c  Pebkac(400, "onl
+00012f20: 7920 6d61 726b 646f 776e 2070 6c73 2229  y markdown pls")
+00012f30: 0a0a 2020 2020 2020 2020 6966 206e 756c  ..        if nul
+00012f40: 6c77 7269 7465 3a0a 2020 2020 2020 2020  lwrite:.        
+00012f50: 2020 2020 7265 7370 6f6e 7365 203d 206a      response = j
+00012f60: 736f 6e2e 6475 6d70 7328 7b22 6f6b 223a  son.dumps({"ok":
+00012f70: 2054 7275 652c 2022 6c61 7374 6d6f 6422   True, "lastmod"
+00012f80: 3a20 307d 290a 2020 2020 2020 2020 2020  : 0}).          
+00012f90: 2020 7365 6c66 2e6c 6f67 2872 6573 706f    self.log(respo
+00012fa0: 6e73 6529 0a20 2020 2020 2020 2020 2020  nse).           
+00012fb0: 2023 2054 4f44 4f20 7265 706c 7920 7368   # TODO reply sh
+00012fc0: 6f75 6c64 2070 6172 7365 722e 6472 6f70  ould parser.drop
+00012fd0: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00012fe0: 656c 662e 7061 7273 6572 2e64 726f 7028  elf.parser.drop(
+00012ff0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00013000: 6c66 2e72 6570 6c79 2872 6573 706f 6e73  lf.reply(respons
+00013010: 652e 656e 636f 6465 2822 7574 662d 3822  e.encode("utf-8"
+00013020: 2929 0a20 2020 2020 2020 2020 2020 2072  )).            r
+00013030: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00013040: 2020 2020 7372 765f 6c61 7374 6d6f 6420      srv_lastmod 
+00013050: 3d20 2d31 2e30 0a20 2020 2020 2020 2073  = -1.0.        s
+00013060: 7276 5f6c 6173 746d 6f64 3320 3d20 2d31  rv_lastmod3 = -1
+00013070: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+00013080: 2020 2020 2020 2020 2020 7374 203d 2062            st = b
+00013090: 6f73 2e73 7461 7428 6670 290a 2020 2020  os.stat(fp).    
+000130a0: 2020 2020 2020 2020 7372 765f 6c61 7374          srv_last
+000130b0: 6d6f 6420 3d20 7374 2e73 745f 6d74 696d  mod = st.st_mtim
+000130c0: 650a 2020 2020 2020 2020 2020 2020 7372  e.            sr
+000130d0: 765f 6c61 7374 6d6f 6433 203d 2069 6e74  v_lastmod3 = int
+000130e0: 2873 7276 5f6c 6173 746d 6f64 202a 2031  (srv_lastmod * 1
+000130f0: 3030 3029 0a20 2020 2020 2020 2065 7863  000).        exc
+00013100: 6570 7420 4f53 4572 726f 7220 6173 2065  ept OSError as e
+00013110: 783a 0a20 2020 2020 2020 2020 2020 2069  x:.            i
+00013120: 6620 6578 2e65 7272 6e6f 2021 3d20 6572  f ex.errno != er
+00013130: 726e 6f2e 454e 4f45 4e54 3a0a 2020 2020  rno.ENOENT:.    
+00013140: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00013150: 650a 0a20 2020 2020 2020 2023 2069 6620  e..        # if 
+00013160: 6669 6c65 2065 7869 7374 732c 2063 6865  file exists, che
+00013170: 6b63 2074 6861 7420 7469 6d65 7374 616d  kc that timestam
+00013180: 7020 6d61 7463 6865 7320 7468 6520 636c  p matches the cl
+00013190: 6965 6e74 2773 0a20 2020 2020 2020 2069  ient's.        i
+000131a0: 6620 7372 765f 6c61 7374 6d6f 6420 3e3d  f srv_lastmod >=
+000131b0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000131c0: 7361 6d65 5f6c 6173 746d 6f64 203d 2063  same_lastmod = c
+000131d0: 6c69 5f6c 6173 746d 6f64 3320 696e 205b  li_lastmod3 in [
+000131e0: 2d31 2c20 7372 765f 6c61 7374 6d6f 6433  -1, srv_lastmod3
+000131f0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00013200: 206e 6f74 2073 616d 655f 6c61 7374 6d6f   not same_lastmo
+00013210: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00013220: 2020 2023 2073 6f6d 6520 6669 6c65 7379     # some filesy
+00013230: 7374 656d 732f 7472 616e 7370 6f72 7473  stems/transports
+00013240: 206c 696d 6974 2070 7265 6369 7369 6f6e   limit precision
+00013250: 2074 6f20 3173 6563 2c20 686f 7065 6675   to 1sec, hopefu
+00013260: 6c6c 7920 666c 6f6f 7265 640a 2020 2020  lly floored.    
+00013270: 2020 2020 2020 2020 2020 2020 7361 6d65              same
+00013280: 5f6c 6173 746d 6f64 203d 2028 0a20 2020  _lastmod = (.   
+00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132a0: 2073 7276 5f6c 6173 746d 6f64 203d 3d20   srv_lastmod == 
+000132b0: 696e 7428 636c 695f 6c61 7374 6d6f 6433  int(cli_lastmod3
+000132c0: 202f 2031 3030 3029 0a20 2020 2020 2020   / 1000).       
+000132d0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+000132e0: 2063 6c69 5f6c 6173 746d 6f64 3320 3e20   cli_lastmod3 > 
+000132f0: 7372 765f 6c61 7374 6d6f 6433 0a20 2020  srv_lastmod3.   
+00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013310: 2061 6e64 2063 6c69 5f6c 6173 746d 6f64   and cli_lastmod
+00013320: 3320 2d20 7372 765f 6c61 7374 6d6f 6433  3 - srv_lastmod3
+00013330: 203c 2031 3030 300a 2020 2020 2020 2020   < 1000.        
+00013340: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00013350: 2020 2020 2020 2069 6620 6e6f 7420 7361         if not sa
+00013360: 6d65 5f6c 6173 746d 6f64 3a0a 2020 2020  me_lastmod:.    
+00013370: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+00013380: 6f6e 7365 203d 206a 736f 6e2e 6475 6d70  onse = json.dump
+00013390: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+000133a0: 2020 2020 2020 207b 0a20 2020 2020 2020         {.       
+000133b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133c0: 2022 6f6b 223a 2046 616c 7365 2c0a 2020   "ok": False,.  
+000133d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000133e0: 2020 2020 2020 226c 6173 746d 6f64 223a        "lastmod":
+000133f0: 2073 7276 5f6c 6173 746d 6f64 332c 0a20   srv_lastmod3,. 
+00013400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013410: 2020 2020 2020 2022 6e6f 7722 3a20 696e         "now": in
+00013420: 7428 7469 6d65 2e74 696d 6528 2920 2a20  t(time.time() * 
+00013430: 3130 3030 292c 0a20 2020 2020 2020 2020  1000),.         
+00013440: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+00013450: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00013460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013470: 656c 662e 6c6f 6728 0a20 2020 2020 2020  elf.log(.       
+00013480: 2020 2020 2020 2020 2020 2020 2022 7b7d               "{}
+00013490: 202d 207b 7d20 3d20 7b7d 222e 666f 726d   - {} = {}".form
+000134a0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+000134b0: 2020 2020 2020 2020 2020 2020 7372 765f              srv_
+000134c0: 6c61 7374 6d6f 6433 2c20 636c 695f 6c61  lastmod3, cli_la
+000134d0: 7374 6d6f 6433 2c20 7372 765f 6c61 7374  stmod3, srv_last
+000134e0: 6d6f 6433 202d 2063 6c69 5f6c 6173 746d  mod3 - cli_lastm
+000134f0: 6f64 330a 2020 2020 2020 2020 2020 2020  od3.            
+00013500: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00013510: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00013520: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00013530: 2e6c 6f67 2872 6573 706f 6e73 6529 0a20  .log(response). 
+00013540: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00013550: 656c 662e 7061 7273 6572 2e64 726f 7028  elf.parser.drop(
+00013560: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00013570: 2020 7365 6c66 2e72 6570 6c79 2872 6573    self.reply(res
+00013580: 706f 6e73 652e 656e 636f 6465 2822 7574  ponse.encode("ut
+00013590: 662d 3822 2929 0a20 2020 2020 2020 2020  f-8")).         
+000135a0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+000135b0: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
+000135c0: 6d64 6972 2c20 6d66 696c 6520 3d20 6f73  mdir, mfile = os
+000135d0: 2e70 6174 682e 7370 6c69 7428 6670 290a  .path.split(fp).
+000135e0: 2020 2020 2020 2020 2020 2020 6d66 696c              mfil
+000135f0: 6532 203d 2022 7b7d 2e7b 3a2e 3366 7d2e  e2 = "{}.{:.3f}.
+00013600: 6d64 222e 666f 726d 6174 286d 6669 6c65  md".format(mfile
+00013610: 5b3a 2d33 5d2c 2073 7276 5f6c 6173 746d  [:-3], srv_lastm
+00013620: 6f64 290a 2020 2020 2020 2020 2020 2020  od).            
+00013630: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00013640: 2020 2020 2064 7020 3d20 6f73 2e70 6174       dp = os.pat
+00013650: 682e 6a6f 696e 286d 6469 722c 2022 2e68  h.join(mdir, ".h
+00013660: 6973 7422 290a 2020 2020 2020 2020 2020  ist").          
+00013670: 2020 2020 2020 626f 732e 6d6b 6469 7228        bos.mkdir(
+00013680: 6470 290a 2020 2020 2020 2020 2020 2020  dp).            
+00013690: 2020 2020 6869 6465 6469 7228 6470 290a      hidedir(dp).
+000136a0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+000136b0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+000136c0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+000136d0: 2020 2020 2062 6f73 2e72 656e 616d 6528       bos.rename(
+000136e0: 6670 2c20 6f73 2e70 6174 682e 6a6f 696e  fp, os.path.join
+000136f0: 286d 6469 722c 2022 2e68 6973 7422 2c20  (mdir, ".hist", 
+00013700: 6d66 696c 6532 2929 0a0a 2020 2020 2020  mfile2))..      
+00013710: 2020 6173 7365 7274 2073 656c 662e 7061    assert self.pa
+00013720: 7273 6572 2e67 656e 0a20 2020 2020 2020  rser.gen.       
+00013730: 2070 5f66 6965 6c64 2c20 5f2c 2070 5f64   p_field, _, p_d
+00013740: 6174 6120 3d20 6e65 7874 2873 656c 662e  ata = next(self.
+00013750: 7061 7273 6572 2e67 656e 290a 2020 2020  parser.gen).    
+00013760: 2020 2020 6966 2070 5f66 6965 6c64 2021      if p_field !
+00013770: 3d20 2262 6f64 7922 3a0a 2020 2020 2020  = "body":.      
+00013780: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+00013790: 6163 2834 3030 2c20 2265 7870 6563 7465  ac(400, "expecte
+000137a0: 6420 626f 6479 2c20 676f 7420 7b7d 222e  d body, got {}".
+000137b0: 666f 726d 6174 2870 5f66 6965 6c64 2929  format(p_field))
+000137c0: 0a0a 2020 2020 2020 2020 6966 2062 6f73  ..        if bos
+000137d0: 2e70 6174 682e 6578 6973 7473 2866 7029  .path.exists(fp)
+000137e0: 3a0a 2020 2020 2020 2020 2020 2020 626f  :.            bo
+000137f0: 732e 756e 6c69 6e6b 2866 7029 0a0a 2020  s.unlink(fp)..  
+00013800: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+00013810: 6673 656e 6328 6670 292c 2022 7762 222c  fsenc(fp), "wb",
+00013820: 2035 3132 202a 2031 3032 3429 2061 7320   512 * 1024) as 
+00013830: 663a 0a20 2020 2020 2020 2020 2020 2073  f:.            s
+00013840: 7a2c 2073 6861 3531 322c 205f 203d 2068  z, sha512, _ = h
+00013850: 6173 6863 6f70 7928 705f 6461 7461 2c20  ashcopy(p_data, 
+00013860: 662c 2073 656c 662e 6172 6773 2e73 5f77  f, self.args.s_w
+00013870: 725f 736c 7029 0a0a 2020 2020 2020 2020  r_slp)..        
+00013880: 6966 206c 696d 3a0a 2020 2020 2020 2020  if lim:.        
+00013890: 2020 2020 6c69 6d2e 6e75 7028 7365 6c66      lim.nup(self
+000138a0: 2e69 7029 0a20 2020 2020 2020 2020 2020  .ip).           
+000138b0: 206c 696d 2e62 7570 2873 656c 662e 6970   lim.bup(self.ip
+000138c0: 2c20 737a 290a 2020 2020 2020 2020 2020  , sz).          
+000138d0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000138e0: 2020 2020 2020 206c 696d 2e63 686b 5f73         lim.chk_s
+000138f0: 7a28 737a 290a 2020 2020 2020 2020 2020  z(sz).          
+00013900: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00013910: 2020 2020 2020 2020 2020 626f 732e 756e            bos.un
+00013920: 6c69 6e6b 2866 7029 0a20 2020 2020 2020  link(fp).       
+00013930: 2020 2020 2020 2020 2072 6169 7365 0a0a           raise..
+00013940: 2020 2020 2020 2020 6e65 775f 6c61 7374          new_last
+00013950: 6d6f 6420 3d20 626f 732e 7374 6174 2866  mod = bos.stat(f
+00013960: 7029 2e73 745f 6d74 696d 650a 2020 2020  p).st_mtime.    
+00013970: 2020 2020 6e65 775f 6c61 7374 6d6f 6433      new_lastmod3
+00013980: 203d 2069 6e74 286e 6577 5f6c 6173 746d   = int(new_lastm
+00013990: 6f64 202a 2031 3030 3029 0a20 2020 2020  od * 1000).     
+000139a0: 2020 2073 6861 3531 3220 3d20 7368 6135     sha512 = sha5
+000139b0: 3132 5b3a 3536 5d0a 0a20 2020 2020 2020  12[:56]..       
+000139c0: 2072 6573 706f 6e73 6520 3d20 6a73 6f6e   response = json
+000139d0: 2e64 756d 7073 280a 2020 2020 2020 2020  .dumps(.        
+000139e0: 2020 2020 7b22 6f6b 223a 2054 7275 652c      {"ok": True,
+000139f0: 2022 6c61 7374 6d6f 6422 3a20 6e65 775f   "lastmod": new_
+00013a00: 6c61 7374 6d6f 6433 2c20 2273 697a 6522  lastmod3, "size"
+00013a10: 3a20 737a 2c20 2273 6861 3531 3222 3a20  : sz, "sha512": 
+00013a20: 7368 6135 3132 7d0a 2020 2020 2020 2020  sha512}.        
+00013a30: 290a 2020 2020 2020 2020 7365 6c66 2e6c  ).        self.l
+00013a40: 6f67 2872 6573 706f 6e73 6529 0a20 2020  og(response).   
+00013a50: 2020 2020 2073 656c 662e 7061 7273 6572       self.parser
+00013a60: 2e64 726f 7028 290a 2020 2020 2020 2020  .drop().        
+00013a70: 7365 6c66 2e72 6570 6c79 2872 6573 706f  self.reply(respo
+00013a80: 6e73 652e 656e 636f 6465 2822 7574 662d  nse.encode("utf-
+00013a90: 3822 2929 0a20 2020 2020 2020 2072 6574  8")).        ret
+00013aa0: 7572 6e20 5472 7565 0a0a 2020 2020 6465  urn True..    de
+00013ab0: 6620 5f63 686b 5f6c 6173 746d 6f64 2873  f _chk_lastmod(s
+00013ac0: 656c 662c 2066 696c 655f 7473 2029 2020  elf, file_ts )  
+00013ad0: 203a 0a20 2020 2020 2020 2066 696c 655f   :.        file_
+00013ae0: 6c61 7374 6d6f 6420 3d20 666f 726d 6174  lastmod = format
+00013af0: 6461 7465 2866 696c 655f 7473 2c20 7573  date(file_ts, us
+00013b00: 6567 6d74 3d54 7275 6529 0a20 2020 2020  egmt=True).     
+00013b10: 2020 2063 6c69 5f6c 6173 746d 6f64 203d     cli_lastmod =
+00013b20: 2073 656c 662e 6865 6164 6572 732e 6765   self.headers.ge
+00013b30: 7428 2269 662d 6d6f 6469 6669 6564 2d73  t("if-modified-s
+00013b40: 696e 6365 2229 0a20 2020 2020 2020 2069  ince").        i
+00013b50: 6620 636c 695f 6c61 7374 6d6f 643a 0a20  f cli_lastmod:. 
+00013b60: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00013b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013b80: 2320 736f 6d65 2062 726f 7773 6572 2061  # some browser a
+00013b90: 7070 656e 6420 223b 206c 656e 6774 683d  ppend "; length=
+00013ba0: 3537 3322 0a20 2020 2020 2020 2020 2020  573".           
+00013bb0: 2020 2020 2063 6c69 5f6c 6173 746d 6f64       cli_lastmod
+00013bc0: 203d 2063 6c69 5f6c 6173 746d 6f64 2e73   = cli_lastmod.s
+00013bd0: 706c 6974 2822 3b22 295b 305d 2e73 7472  plit(";")[0].str
+00013be0: 6970 2829 0a20 2020 2020 2020 2020 2020  ip().           
+00013bf0: 2020 2020 2063 6c69 5f64 7420 3d20 7061       cli_dt = pa
+00013c00: 7273 6564 6174 6528 636c 695f 6c61 7374  rsedate(cli_last
+00013c10: 6d6f 6429 0a20 2020 2020 2020 2020 2020  mod).           
+00013c20: 2020 2020 2061 7373 6572 7420 636c 695f       assert cli_
+00013c30: 6474 0a20 2020 2020 2020 2020 2020 2020  dt.             
+00013c40: 2020 2063 6c69 5f74 7320 3d20 6361 6c65     cli_ts = cale
+00013c50: 6e64 6172 2e74 696d 6567 6d28 636c 695f  ndar.timegm(cli_
+00013c60: 6474 290a 2020 2020 2020 2020 2020 2020  dt).            
+00013c70: 2020 2020 7265 7475 726e 2066 696c 655f      return file_
+00013c80: 6c61 7374 6d6f 642c 2069 6e74 2866 696c  lastmod, int(fil
+00013c90: 655f 7473 2920 3e20 696e 7428 636c 695f  e_ts) > int(cli_
+00013ca0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+00013cb0: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00013cc0: 2061 7320 6578 3a0a 2020 2020 2020 2020   as ex:.        
+00013cd0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+00013ce0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00013cf0: 2020 2020 2020 226c 6173 746d 6f64 207b        "lastmod {
+00013d00: 7d5c 6e72 656d 6f74 653a 205b 7b7d 5d5c  }\nremote: [{}]\
+00013d10: 6e20 6c6f 6361 6c3a 205b 7b7d 5d22 2e66  n local: [{}]".f
+00013d20: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+00013d30: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00013d40: 6570 7228 6578 292c 2063 6c69 5f6c 6173  epr(ex), cli_las
+00013d50: 746d 6f64 2c20 6669 6c65 5f6c 6173 746d  tmod, file_lastm
+00013d60: 6f64 0a20 2020 2020 2020 2020 2020 2020  od.             
+00013d70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00013d80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00013d90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00013da0: 6e20 6669 6c65 5f6c 6173 746d 6f64 2c20  n file_lastmod, 
+00013db0: 6669 6c65 5f6c 6173 746d 6f64 2021 3d20  file_lastmod != 
+00013dc0: 636c 695f 6c61 7374 6d6f 640a 0a20 2020  cli_lastmod..   
+00013dd0: 2020 2020 2072 6574 7572 6e20 6669 6c65       return file
+00013de0: 5f6c 6173 746d 6f64 2c20 5472 7565 0a0a  _lastmod, True..
+00013df0: 2020 2020 6465 6620 7478 5f66 696c 6528      def tx_file(
+00013e00: 7365 6c66 2c20 7265 715f 7061 7468 2029  self, req_path )
+00013e10: 2020 3a0a 2020 2020 2020 2020 7374 6174    :.        stat
+00013e20: 7573 203d 2032 3030 0a20 2020 2020 2020  us = 200.       
+00013e30: 206c 6f67 6d73 6720 3d20 227b 3a34 7d20   logmsg = "{:4} 
+00013e40: 7b7d 2022 2e66 6f72 6d61 7428 2222 2c20  {} ".format("", 
+00013e50: 7365 6c66 2e72 6571 290a 2020 2020 2020  self.req).      
+00013e60: 2020 6c6f 6774 6169 6c20 3d20 2222 0a0a    logtail = ""..
+00013e70: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
+00013e80: 2020 2320 6966 2072 6571 7565 7374 2069    # if request i
+00013e90: 7320 666f 7220 666f 6f2e 6a73 2c20 6368  s for foo.js, ch
+00013ea0: 6563 6b20 6966 2077 6520 6861 7665 2066  eck if we have f
+00013eb0: 6f6f 2e6a 732e 7b67 7a2c 6272 7d0a 0a20  oo.js.{gz,br}.. 
+00013ec0: 2020 2020 2020 2066 696c 655f 7473 203d         file_ts =
+00013ed0: 2030 0a20 2020 2020 2020 2065 6469 7469   0.        editi
+00013ee0: 6f6e 7320 2020 203d 207b 7d0a 2020 2020  ons    = {}.    
+00013ef0: 2020 2020 666f 7220 6578 7420 696e 205b      for ext in [
+00013f00: 2222 2c20 222e 677a 222c 2022 2e62 7222  "", ".gz", ".br"
+00013f10: 5d3a 0a20 2020 2020 2020 2020 2020 2074  ]:.            t
+00013f20: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+00013f30: 2020 2020 6673 5f70 6174 6820 3d20 7265      fs_path = re
+00013f40: 715f 7061 7468 202b 2065 7874 0a20 2020  q_path + ext.   
+00013f50: 2020 2020 2020 2020 2020 2020 2073 7420               st 
+00013f60: 3d20 626f 732e 7374 6174 2866 735f 7061  = bos.stat(fs_pa
+00013f70: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
+00013f80: 2020 2020 6966 2073 7461 742e 535f 4953      if stat.S_IS
+00013f90: 4449 5228 7374 2e73 745f 6d6f 6465 293a  DIR(st.st_mode):
+00013fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013fb0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+00013fc0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00013fd0: 6620 7374 6174 2e53 5f49 5342 4c4b 2873  f stat.S_ISBLK(s
+00013fe0: 742e 7374 5f6d 6f64 6529 3a0a 2020 2020  t.st_mode):.    
+00013ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014000: 6664 203d 2062 6f73 2e6f 7065 6e28 6673  fd = bos.open(fs
+00014010: 5f70 6174 682c 206f 732e 4f5f 5244 4f4e  _path, os.O_RDON
+00014020: 4c59 290a 2020 2020 2020 2020 2020 2020  LY).            
+00014030: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00014040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014050: 2020 2020 2073 7a20 3d20 6f73 2e6c 7365       sz = os.lse
+00014060: 656b 2866 642c 2030 2c20 6f73 2e53 4545  ek(fd, 0, os.SEE
+00014070: 4b5f 454e 4429 0a20 2020 2020 2020 2020  K_END).         
+00014080: 2020 2020 2020 2020 2020 2066 696e 616c             final
+00014090: 6c79 3a0a 2020 2020 2020 2020 2020 2020  ly:.            
+000140a0: 2020 2020 2020 2020 2020 2020 6f73 2e63              os.c
+000140b0: 6c6f 7365 2866 6429 0a20 2020 2020 2020  lose(fd).       
+000140c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000140d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000140e0: 2020 2073 7a20 3d20 7374 2e73 745f 7369     sz = st.st_si
+000140f0: 7a65 0a0a 2020 2020 2020 2020 2020 2020  ze..            
+00014100: 2020 2020 6669 6c65 5f74 7320 3d20 6d61      file_ts = ma
+00014110: 7828 6669 6c65 5f74 732c 2069 6e74 2873  x(file_ts, int(s
+00014120: 742e 7374 5f6d 7469 6d65 2929 0a20 2020  t.st_mtime)).   
+00014130: 2020 2020 2020 2020 2020 2020 2065 6469               edi
+00014140: 7469 6f6e 735b 6578 7420 6f72 2022 706c  tions[ext or "pl
+00014150: 6169 6e22 5d20 3d20 2866 735f 7061 7468  ain"] = (fs_path
+00014160: 2c20 737a 290a 2020 2020 2020 2020 2020  , sz).          
+00014170: 2020 6578 6365 7074 3a0a 2020 2020 2020    except:.      
+00014180: 2020 2020 2020 2020 2020 7061 7373 0a20            pass. 
+00014190: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+000141a0: 7420 7365 6c66 2e76 7061 7468 2e73 7461  t self.vpath.sta
+000141b0: 7274 7377 6974 6828 222e 6370 722f 2229  rtswith(".cpr/")
+000141c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000141d0: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
+000141e0: 2069 6620 6e6f 7420 6564 6974 696f 6e73   if not editions
+000141f0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00014200: 7475 726e 2073 656c 662e 7478 5f34 3034  turn self.tx_404
+00014210: 2829 0a0a 2020 2020 2020 2020 230a 2020  ()..        #.  
+00014220: 2020 2020 2020 2320 6966 2d6d 6f64 6966        # if-modif
+00014230: 6965 640a 0a20 2020 2020 2020 2066 696c  ied..        fil
+00014240: 655f 6c61 7374 6d6f 642c 2064 6f5f 7365  e_lastmod, do_se
+00014250: 6e64 203d 2073 656c 662e 5f63 686b 5f6c  nd = self._chk_l
+00014260: 6173 746d 6f64 2866 696c 655f 7473 290a  astmod(file_ts).
+00014270: 2020 2020 2020 2020 7365 6c66 2e6f 7574          self.out
+00014280: 5f68 6561 6465 7273 5b22 4c61 7374 2d4d  _headers["Last-M
+00014290: 6f64 6966 6965 6422 5d20 3d20 6669 6c65  odified"] = file
+000142a0: 5f6c 6173 746d 6f64 0a20 2020 2020 2020  _lastmod.       
+000142b0: 2069 6620 6e6f 7420 646f 5f73 656e 643a   if not do_send:
+000142c0: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+000142d0: 7475 7320 3d20 3330 340a 0a20 2020 2020  tus = 304..     
+000142e0: 2020 2023 0a20 2020 2020 2020 2023 2041     #.        # A
+000142f0: 6363 6570 742d 456e 636f 6469 6e67 2061  ccept-Encoding a
+00014300: 6e64 2055 4120 6465 6369 6465 7320 7768  nd UA decides wh
+00014310: 6963 6820 6564 6974 696f 6e20 746f 2073  ich edition to s
+00014320: 656e 640a 0a20 2020 2020 2020 2064 6563  end..        dec
+00014330: 6f6d 7072 6573 7320 3d20 4661 6c73 650a  ompress = False.
+00014340: 2020 2020 2020 2020 7375 7070 6f72 7465          supporte
+00014350: 645f 6564 6974 696f 6e73 203d 205b 0a20  d_editions = [. 
+00014360: 2020 2020 2020 2020 2020 2078 2e73 7472             x.str
+00014370: 6970 2829 0a20 2020 2020 2020 2020 2020  ip().           
+00014380: 2066 6f72 2078 2069 6e20 7365 6c66 2e68   for x in self.h
+00014390: 6561 6465 7273 2e67 6574 2822 6163 6365  eaders.get("acce
+000143a0: 7074 2d65 6e63 6f64 696e 6722 2c20 2222  pt-encoding", ""
+000143b0: 292e 6c6f 7765 7228 292e 7370 6c69 7428  ).lower().split(
+000143c0: 222c 2229 0a20 2020 2020 2020 205d 0a20  ",").        ]. 
+000143d0: 2020 2020 2020 2069 6620 222e 6272 2220         if ".br" 
+000143e0: 696e 2065 6469 7469 6f6e 7320 616e 6420  in editions and 
+000143f0: 2262 7222 2069 6e20 7375 7070 6f72 7465  "br" in supporte
+00014400: 645f 6564 6974 696f 6e73 3a0a 2020 2020  d_editions:.    
+00014410: 2020 2020 2020 2020 6973 5f63 6f6d 7072          is_compr
+00014420: 6573 7365 6420 3d20 5472 7565 0a20 2020  essed = True.   
+00014430: 2020 2020 2020 2020 2073 656c 6563 7465           selecte
+00014440: 645f 6564 6974 696f 6e20 3d20 222e 6272  d_edition = ".br
+00014450: 220a 2020 2020 2020 2020 2020 2020 6673  ".            fs
+00014460: 5f70 6174 682c 2066 696c 655f 737a 203d  _path, file_sz =
+00014470: 2065 6469 7469 6f6e 735b 222e 6272 225d   editions[".br"]
+00014480: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00014490: 662e 6f75 745f 6865 6164 6572 735b 2243  f.out_headers["C
+000144a0: 6f6e 7465 6e74 2d45 6e63 6f64 696e 6722  ontent-Encoding"
+000144b0: 5d20 3d20 2262 7222 0a20 2020 2020 2020  ] = "br".       
+000144c0: 2065 6c69 6620 222e 677a 2220 696e 2065   elif ".gz" in e
+000144d0: 6469 7469 6f6e 733a 0a20 2020 2020 2020  ditions:.       
+000144e0: 2020 2020 2069 735f 636f 6d70 7265 7373       is_compress
+000144f0: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+00014500: 2020 2020 2020 7365 6c65 6374 6564 5f65        selected_e
+00014510: 6469 7469 6f6e 203d 2022 2e67 7a22 0a20  dition = ".gz". 
+00014520: 2020 2020 2020 2020 2020 2066 735f 7061             fs_pa
+00014530: 7468 2c20 6669 6c65 5f73 7a20 3d20 6564  th, file_sz = ed
+00014540: 6974 696f 6e73 5b22 2e67 7a22 5d0a 2020  itions[".gz"].  
+00014550: 2020 2020 2020 2020 2020 6966 2022 677a            if "gz
+00014560: 6970 2220 6e6f 7420 696e 2073 7570 706f  ip" not in suppo
+00014570: 7274 6564 5f65 6469 7469 6f6e 733a 0a20  rted_editions:. 
+00014580: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00014590: 6563 6f6d 7072 6573 7320 3d20 5472 7565  ecompress = True
+000145a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+000145b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000145c0: 2020 2069 6620 7265 2e6d 6174 6368 2872     if re.match(r
+000145d0: 224d 5349 4520 5b34 2d36 5d5c 2e22 2c20  "MSIE [4-6]\.", 
+000145e0: 7365 6c66 2e75 6129 2061 6e64 2022 2053  self.ua) and " S
+000145f0: 5631 2220 6e6f 7420 696e 2073 656c 662e  V1" not in self.
+00014600: 7561 3a0a 2020 2020 2020 2020 2020 2020  ua:.            
+00014610: 2020 2020 2020 2020 6465 636f 6d70 7265          decompre
+00014620: 7373 203d 2054 7275 650a 0a20 2020 2020  ss = True..     
+00014630: 2020 2020 2020 2069 6620 6e6f 7420 6465         if not de
+00014640: 636f 6d70 7265 7373 3a0a 2020 2020 2020  compress:.      
+00014650: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
+00014660: 7574 5f68 6561 6465 7273 5b22 436f 6e74  ut_headers["Cont
+00014670: 656e 742d 456e 636f 6469 6e67 225d 203d  ent-Encoding"] =
+00014680: 2022 677a 6970 220a 2020 2020 2020 2020   "gzip".        
+00014690: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000146a0: 2020 6973 5f63 6f6d 7072 6573 7365 6420    is_compressed 
+000146b0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+000146c0: 2020 2020 7365 6c65 6374 6564 5f65 6469      selected_edi
+000146d0: 7469 6f6e 203d 2022 706c 6169 6e22 0a0a  tion = "plain"..
+000146e0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+000146f0: 2020 2020 2020 2020 2066 735f 7061 7468           fs_path
+00014700: 2c20 6669 6c65 5f73 7a20 3d20 6564 6974  , file_sz = edit
+00014710: 696f 6e73 5b73 656c 6563 7465 645f 6564  ions[selected_ed
+00014720: 6974 696f 6e5d 0a20 2020 2020 2020 2020  ition].         
+00014730: 2020 206c 6f67 6d73 6720 2b3d 2022 7b7d     logmsg += "{}
+00014740: 2022 2e66 6f72 6d61 7428 7365 6c65 6374   ".format(select
+00014750: 6564 5f65 6469 7469 6f6e 2e6c 7374 7269  ed_edition.lstri
+00014760: 7028 222e 2229 290a 2020 2020 2020 2020  p(".")).        
+00014770: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+00014780: 2020 2020 2320 636c 6965 6e74 2069 7320      # client is 
+00014790: 6f6c 6420 616e 6420 7765 206f 6e6c 7920  old and we only 
+000147a0: 6861 7665 202e 6272 0a20 2020 2020 2020  have .br.       
+000147b0: 2020 2020 2023 2028 636f 756c 6420 6d61       # (could ma
+000147c0: 6b65 2062 726f 746c 6920 6120 6465 7020  ke brotli a dep 
+000147d0: 746f 2066 6978 2074 6869 7320 6275 7420  to fix this but 
+000147e0: 6974 2773 206e 6f74 2077 6f72 7468 290a  it's not worth).
+000147f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00014800: 6520 5065 626b 6163 2834 3034 290a 0a20  e Pebkac(404).. 
+00014810: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
+00014820: 2023 2070 6172 7469 616c 0a0a 2020 2020   # partial..    
+00014830: 2020 2020 6c6f 7765 7220 3d20 300a 2020      lower = 0.  
+00014840: 2020 2020 2020 7570 7065 7220 3d20 6669        upper = fi
+00014850: 6c65 5f73 7a0a 2020 2020 2020 2020 6872  le_sz.        hr
+00014860: 616e 6765 203d 2073 656c 662e 6865 6164  ange = self.head
+00014870: 6572 732e 6765 7428 2272 616e 6765 2229  ers.get("range")
+00014880: 0a0a 2020 2020 2020 2020 2320 6c65 7427  ..        # let'
+00014890: 7320 6e6f 7420 7375 7070 6f72 7420 3230  s not support 20
+000148a0: 3620 7769 7468 2063 6f6d 7072 6573 7369  6 with compressi
+000148b0: 6f6e 0a20 2020 2020 2020 2023 2061 6e64  on.        # and
+000148c0: 206d 756c 7469 7261 6e67 6520 2f20 6d75   multirange / mu
+000148d0: 6c74 6970 6172 7420 6973 2061 6c73 6f20  ltipart is also 
+000148e0: 6e6f 742d 696d 706c 2028 6d6f 7374 6c79  not-impl (mostly
+000148f0: 2062 6563 6175 7365 2063 616c 6375 6c61   because calcula
+00014900: 7469 6e67 2063 6f6e 7465 6e74 6c65 6e67  ting contentleng
+00014910: 7468 2069 7320 6120 7061 696e 290a 2020  th is a pain).  
+00014920: 2020 2020 2020 6966 2064 6f5f 7365 6e64        if do_send
+00014930: 2061 6e64 206e 6f74 2069 735f 636f 6d70   and not is_comp
+00014940: 7265 7373 6564 2061 6e64 2068 7261 6e67  ressed and hrang
+00014950: 6520 616e 6420 6669 6c65 5f73 7a20 616e  e and file_sz an
+00014960: 6420 222c 2220 6e6f 7420 696e 2068 7261  d "," not in hra
+00014970: 6e67 653a 0a20 2020 2020 2020 2020 2020  nge:.           
+00014980: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00014990: 2020 2020 2020 6966 206e 6f74 2068 7261        if not hra
+000149a0: 6e67 652e 6c6f 7765 7228 292e 7374 6172  nge.lower().star
+000149b0: 7473 7769 7468 2822 6279 7465 7322 293a  tswith("bytes"):
+000149c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000149d0: 2020 2020 2072 6169 7365 2045 7863 6570       raise Excep
+000149e0: 7469 6f6e 2829 0a0a 2020 2020 2020 2020  tion()..        
+000149f0: 2020 2020 2020 2020 612c 2062 203d 2068          a, b = h
+00014a00: 7261 6e67 652e 7370 6c69 7428 223d 222c  range.split("=",
+00014a10: 2031 295b 315d 2e73 706c 6974 2822 2d22   1)[1].split("-"
+00014a20: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00014a30: 2020 2069 6620 612e 7374 7269 7028 293a     if a.strip():
+00014a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014a50: 2020 2020 206c 6f77 6572 203d 2069 6e74       lower = int
+00014a60: 2861 2e73 7472 6970 2829 290a 2020 2020  (a.strip()).    
+00014a70: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00014a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014a90: 2020 2020 2020 6c6f 7765 7220 3d20 300a        lower = 0.
+00014aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014ab0: 2069 6620 622e 7374 7269 7028 293a 0a20   if b.strip():. 
+00014ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ad0: 2020 2075 7070 6572 203d 2069 6e74 2862     upper = int(b
+00014ae0: 2e73 7472 6970 2829 2920 2b20 310a 2020  .strip()) + 1.  
+00014af0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00014b00: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00014b10: 2020 2020 2020 2020 7570 7065 7220 3d20          upper = 
+00014b20: 6669 6c65 5f73 7a0a 0a20 2020 2020 2020  file_sz..       
+00014b30: 2020 2020 2020 2020 2069 6620 7570 7065           if uppe
+00014b40: 7220 3e20 6669 6c65 5f73 7a3a 0a20 2020  r > file_sz:.   
+00014b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014b60: 2075 7070 6572 203d 2066 696c 655f 737a   upper = file_sz
+00014b70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014b80: 2020 6966 206c 6f77 6572 203c 2030 206f    if lower < 0 o
+00014b90: 7220 6c6f 7765 7220 3e3d 2075 7070 6572  r lower >= upper
+00014ba0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014bb0: 2020 2020 2020 7261 6973 6520 4578 6365        raise Exce
+00014bc0: 7074 696f 6e28 290a 0a20 2020 2020 2020  ption()..       
+00014bd0: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
+00014be0: 2020 2020 2020 2020 2020 2020 2065 7272               err
+00014bf0: 203d 2022 696e 7661 6c69 6420 7261 6e67   = "invalid rang
+00014c00: 6520 287b 7d29 2c20 7369 7a65 3d7b 7d22  e ({}), size={}"
+00014c10: 2e66 6f72 6d61 7428 6872 616e 6765 2c20  .format(hrange, 
+00014c20: 6669 6c65 5f73 7a29 0a20 2020 2020 2020  file_sz).       
+00014c30: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+00014c40: 7564 5f72 6570 6c79 280a 2020 2020 2020  ud_reply(.      
+00014c50: 2020 2020 2020 2020 2020 2020 2020 6572                er
+00014c60: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00014c70: 2020 2020 2020 2073 7461 7475 733d 3431         status=41
+00014c80: 362c 0a20 2020 2020 2020 2020 2020 2020  6,.             
+00014c90: 2020 2020 2020 2068 6561 6465 7273 3d7b         headers={
+00014ca0: 2243 6f6e 7465 6e74 2d52 616e 6765 223a  "Content-Range":
+00014cb0: 2022 6279 7465 7320 2a2f 7b7d 222e 666f   "bytes */{}".fo
+00014cc0: 726d 6174 2866 696c 655f 737a 297d 2c0a  rmat(file_sz)},.
+00014cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ce0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00014cf0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00014d00: 2020 2020 2020 2020 2020 2073 7461 7475             statu
+00014d10: 7320 3d20 3230 360a 2020 2020 2020 2020  s = 206.        
+00014d20: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
+00014d30: 6465 7273 5b22 436f 6e74 656e 742d 5261  ders["Content-Ra
+00014d40: 6e67 6522 5d20 3d20 2262 7974 6573 207b  nge"] = "bytes {
+00014d50: 7d2d 7b7d 2f7b 7d22 2e66 6f72 6d61 7428  }-{}/{}".format(
+00014d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014d70: 206c 6f77 6572 2c20 7570 7065 7220 2d20   lower, upper - 
+00014d80: 312c 2066 696c 655f 737a 0a20 2020 2020  1, file_sz.     
+00014d90: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00014da0: 2020 2020 2020 6c6f 6774 6169 6c20 2b3d        logtail +=
+00014db0: 2022 205b 5c30 3333 5b33 366d 7b7d 2d7b   " [\033[36m{}-{
+00014dc0: 7d5c 3033 335b 306d 5d22 2e66 6f72 6d61  }\033[0m]".forma
+00014dd0: 7428 6c6f 7765 722c 2075 7070 6572 290a  t(lower, upper).
+00014de0: 0a20 2020 2020 2020 2075 7365 5f73 656e  .        use_sen
+00014df0: 6466 696c 6520 3d20 4661 6c73 650a 2020  dfile = False.  
+00014e00: 2020 2020 2020 6966 2064 6563 6f6d 7072        if decompr
+00014e10: 6573 733a 0a20 2020 2020 2020 2020 2020  ess:.           
+00014e20: 206f 7065 6e5f 6675 6e63 2020 3d20 677a   open_func  = gz
+00014e30: 6970 2e6f 7065 6e0a 2020 2020 2020 2020  ip.open.        
+00014e40: 2020 2020 6f70 656e 5f61 7267 7320 203d      open_args  =
+00014e50: 205b 6673 656e 6328 6673 5f70 6174 6829   [fsenc(fs_path)
+00014e60: 2c20 2272 6222 5d0a 2020 2020 2020 2020  , "rb"].        
+00014e70: 2020 2020 2320 436f 6e74 656e 742d 4c65      # Content-Le
+00014e80: 6e67 7468 203a 3d20 6f72 6967 696e 616c  ngth := original
+00014e90: 2066 696c 6520 7369 7a65 0a20 2020 2020   file size.     
+00014ea0: 2020 2020 2020 2075 7070 6572 203d 2067         upper = g
+00014eb0: 7a69 705f 6f72 6967 5f73 7a28 6673 5f70  zip_orig_sz(fs_p
+00014ec0: 6174 6829 0a20 2020 2020 2020 2065 6c73  ath).        els
+00014ed0: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
+00014ee0: 7065 6e5f 6675 6e63 203d 206f 7065 6e0a  pen_func = open.
+00014ef0: 2020 2020 2020 2020 2020 2020 2320 3531              # 51
+00014f00: 3220 6b42 2069 7320 6f70 7469 6d61 6c20  2 kB is optimal 
+00014f10: 666f 7220 6875 6765 2066 696c 6573 2c20  for huge files, 
+00014f20: 7573 6520 3634 6b0a 2020 2020 2020 2020  use 64k.        
+00014f30: 2020 2020 6f70 656e 5f61 7267 7320 3d20      open_args = 
+00014f40: 5b66 7365 6e63 2866 735f 7061 7468 292c  [fsenc(fs_path),
+00014f50: 2022 7262 222c 2036 3420 2a20 3130 3234   "rb", 64 * 1024
+00014f60: 5d0a 2020 2020 2020 2020 2020 2020 7573  ].            us
+00014f70: 655f 7365 6e64 6669 6c65 203d 2028 0a20  e_sendfile = (. 
+00014f80: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00014f90: 6f74 2073 656c 662e 746c 7320 2023 0a20  ot self.tls  #. 
+00014fa0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00014fb0: 6e64 206e 6f74 2073 656c 662e 6172 6773  nd not self.args
+00014fc0: 2e6e 6f5f 7365 6e64 6669 6c65 0a20 2020  .no_sendfile.   
+00014fd0: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+00014fe0: 2068 6173 6174 7472 286f 732c 2022 7365   hasattr(os, "se
+00014ff0: 6e64 6669 6c65 2229 0a20 2020 2020 2020  ndfile").       
+00015000: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00015010: 230a 2020 2020 2020 2020 2320 7365 6e64  #.        # send
+00015020: 2072 6570 6c79 0a0a 2020 2020 2020 2020   reply..        
+00015030: 6966 2069 735f 636f 6d70 7265 7373 6564  if is_compressed
+00015040: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00015050: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
+00015060: 4361 6368 652d 436f 6e74 726f 6c22 5d20  Cache-Control"] 
+00015070: 3d20 226d 6178 2d61 6765 3d36 3034 3836  = "max-age=60486
+00015080: 3922 0a20 2020 2020 2020 2065 6c73 653a  9".        else:
+00015090: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000150a0: 662e 7065 726d 6974 5f63 6163 6869 6e67  f.permit_caching
+000150b0: 2829 0a0a 2020 2020 2020 2020 6966 2022  ()..        if "
+000150c0: 7478 7422 2069 6e20 7365 6c66 2e75 7061  txt" in self.upa
+000150d0: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
+000150e0: 206d 696d 6520 3d20 2274 6578 742f 706c   mime = "text/pl
+000150f0: 6169 6e3b 2063 6861 7273 6574 3d7b 7d22  ain; charset={}"
+00015100: 2e66 6f72 6d61 7428 7365 6c66 2e75 7061  .format(self.upa
+00015110: 7261 6d5b 2274 7874 225d 206f 7220 2275  ram["txt"] or "u
+00015120: 7466 2d38 2229 0a20 2020 2020 2020 2065  tf-8").        e
+00015130: 6c69 6620 226d 696d 6522 2069 6e20 7365  lif "mime" in se
+00015140: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
+00015150: 2020 2020 2020 206d 696d 6520 3d20 7374         mime = st
+00015160: 7228 7365 6c66 2e75 7061 7261 6d2e 6765  r(self.uparam.ge
+00015170: 7428 226d 696d 6522 2929 0a20 2020 2020  t("mime")).     
+00015180: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00015190: 2020 2020 206d 696d 6520 3d20 6775 6573       mime = gues
+000151a0: 735f 6d69 6d65 2872 6571 5f70 6174 6829  s_mime(req_path)
+000151b0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6f  ..        self.o
+000151c0: 7574 5f68 6561 6465 7273 5b22 4163 6365  ut_headers["Acce
+000151d0: 7074 2d52 616e 6765 7322 5d20 3d20 2262  pt-Ranges"] = "b
+000151e0: 7974 6573 220a 2020 2020 2020 2020 7365  ytes".        se
+000151f0: 6c66 2e73 656e 645f 6865 6164 6572 7328  lf.send_headers(
+00015200: 6c65 6e67 7468 3d75 7070 6572 202d 206c  length=upper - l
+00015210: 6f77 6572 2c20 7374 6174 7573 3d73 7461  ower, status=sta
+00015220: 7475 732c 206d 696d 653d 6d69 6d65 290a  tus, mime=mime).
+00015230: 0a20 2020 2020 2020 206c 6f67 6d73 6720  .        logmsg 
+00015240: 2b3d 2075 6e69 636f 6465 2873 7461 7475  += unicode(statu
+00015250: 7329 202b 206c 6f67 7461 696c 0a0a 2020  s) + logtail..  
+00015260: 2020 2020 2020 6966 2073 656c 662e 6d6f        if self.mo
+00015270: 6465 203d 3d20 2248 4541 4422 206f 7220  de == "HEAD" or 
+00015280: 6e6f 7420 646f 5f73 656e 643a 0a20 2020  not do_send:.   
+00015290: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000152a0: 2e64 6f5f 6c6f 673a 0a20 2020 2020 2020  .do_log:.       
+000152b0: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
+000152c0: 6728 6c6f 676d 7367 290a 0a20 2020 2020  g(logmsg)..     
+000152d0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+000152e0: 7565 0a0a 2020 2020 2020 2020 7265 7420  ue..        ret 
+000152f0: 3d20 5472 7565 0a20 2020 2020 2020 2077  = True.        w
+00015300: 6974 6820 6f70 656e 5f66 756e 6328 2a6f  ith open_func(*o
+00015310: 7065 6e5f 6172 6773 2920 6173 2066 3a0a  pen_args) as f:.
+00015320: 2020 2020 2020 2020 2020 2020 7365 6e64              send
+00015330: 6675 6e20 3d20 7365 6e64 6669 6c65 5f6b  fun = sendfile_k
+00015340: 6572 6e20 6966 2075 7365 5f73 656e 6466  ern if use_sendf
+00015350: 696c 6520 656c 7365 2073 656e 6466 696c  ile else sendfil
+00015360: 655f 7079 0a20 2020 2020 2020 2020 2020  e_py.           
+00015370: 2072 656d 6169 6e73 203d 2073 656e 6466   remains = sendf
+00015380: 756e 280a 2020 2020 2020 2020 2020 2020  un(.            
+00015390: 2020 2020 7365 6c66 2e6c 6f67 2c20 6c6f      self.log, lo
+000153a0: 7765 722c 2075 7070 6572 2c20 662c 2073  wer, upper, f, s
+000153b0: 656c 662e 732c 2073 656c 662e 6172 6773  elf.s, self.args
+000153c0: 2e73 5f77 725f 737a 2c20 7365 6c66 2e61  .s_wr_sz, self.a
+000153d0: 7267 732e 735f 7772 5f73 6c70 0a20 2020  rgs.s_wr_slp.   
+000153e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000153f0: 2020 2020 6966 2072 656d 6169 6e73 203e      if remains >
+00015400: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00015410: 6c6f 676d 7367 202b 3d20 2220 5c30 3333  logmsg += " \033
+00015420: 5b33 316d 2220 2b20 756e 6963 6f64 6528  [31m" + unicode(
+00015430: 7570 7065 7220 2d20 7265 6d61 696e 7329  upper - remains)
+00015440: 202b 2022 5c30 3333 5b30 6d22 0a20 2020   + "\033[0m".   
+00015450: 2020 2020 2020 2020 2073 656c 662e 6b65           self.ke
+00015460: 6570 616c 6976 6520 3d20 4661 6c73 650a  epalive = False.
+00015470: 0a20 2020 2020 2020 2073 7064 203d 2073  .        spd = s
+00015480: 656c 662e 5f73 7064 2828 7570 7065 7220  elf._spd((upper 
+00015490: 2d20 6c6f 7765 7229 202d 2072 656d 6169  - lower) - remai
+000154a0: 6e73 290a 2020 2020 2020 2020 6966 2073  ns).        if s
+000154b0: 656c 662e 646f 5f6c 6f67 3a0a 2020 2020  elf.do_log:.    
+000154c0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+000154d0: 2822 7b7d 2c20 207b 7d22 2e66 6f72 6d61  ("{},  {}".forma
+000154e0: 7428 6c6f 676d 7367 2c20 7370 6429 290a  t(logmsg, spd)).
+000154f0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015500: 7265 740a 0a20 2020 2064 6566 2074 785f  ret..    def tx_
+00015510: 7a69 7028 0a20 2020 2020 2020 2073 656c  zip(.        sel
+00015520: 662c 0a20 2020 2020 2020 2066 6d74 202c  f,.        fmt ,
+00015530: 0a20 2020 2020 2020 2075 6172 6720 2c0a  .        uarg ,.
+00015540: 2020 2020 2020 2020 7670 6174 6820 2c0a          vpath ,.
+00015550: 2020 2020 2020 2020 766e 202c 0a20 2020          vn ,.   
+00015560: 2020 2020 2072 656d 202c 0a20 2020 2020       rem ,.     
+00015570: 2020 2069 7465 6d73 202c 0a20 2020 2020     items ,.     
+00015580: 2020 2064 6f74 7320 2c0a 2020 2020 2920     dots ,.    ) 
+00015590: 203a 0a20 2020 2020 2020 2069 6620 7365   :.        if se
+000155a0: 6c66 2e61 7267 732e 6e6f 5f7a 6970 3a0a  lf.args.no_zip:.
+000155b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000155c0: 6520 5065 626b 6163 2834 3030 2c20 226e  e Pebkac(400, "n
+000155d0: 6f74 2065 6e61 626c 6564 2229 0a0a 2020  ot enabled")..  
+000155e0: 2020 2020 2020 6c6f 676d 7367 203d 2022        logmsg = "
+000155f0: 7b3a 347d 207b 7d20 222e 666f 726d 6174  {:4} {} ".format
+00015600: 2822 222c 2073 656c 662e 7265 7129 0a20  ("", self.req). 
+00015610: 2020 2020 2020 2073 656c 662e 6b65 6570         self.keep
+00015620: 616c 6976 6520 3d20 4661 6c73 650a 0a20  alive = False.. 
+00015630: 2020 2020 2020 2069 6620 666d 7420 3d3d         if fmt ==
+00015640: 2022 7461 7222 3a0a 2020 2020 2020 2020   "tar":.        
+00015650: 2020 2020 6d69 6d65 203d 2022 6170 706c      mime = "appl
+00015660: 6963 6174 696f 6e2f 782d 7461 7222 0a20  ication/x-tar". 
+00015670: 2020 2020 2020 2020 2020 2070 6163 6b65             packe
+00015680: 7220 203d 2053 7472 6561 6d54 6172 0a20  r  = StreamTar. 
+00015690: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000156a0: 2020 2020 2020 2020 206d 696d 6520 3d20           mime = 
+000156b0: 2261 7070 6c69 6361 7469 6f6e 2f7a 6970  "application/zip
+000156c0: 220a 2020 2020 2020 2020 2020 2020 7061  ".            pa
+000156d0: 636b 6572 203d 2053 7472 6561 6d5a 6970  cker = StreamZip
+000156e0: 0a0a 2020 2020 2020 2020 666e 203d 2069  ..        fn = i
+000156f0: 7465 6d73 5b30 5d20 6966 2069 7465 6d73  tems[0] if items
+00015700: 2061 6e64 2069 7465 6d73 5b30 5d20 656c   and items[0] el
+00015710: 7365 2073 656c 662e 7670 6174 680a 2020  se self.vpath.  
+00015720: 2020 2020 2020 6966 2066 6e3a 0a20 2020        if fn:.   
+00015730: 2020 2020 2020 2020 2066 6e20 3d20 666e           fn = fn
+00015740: 2e72 7374 7269 7028 222f 2229 2e73 706c  .rstrip("/").spl
+00015750: 6974 2822 2f22 295b 2d31 5d0a 2020 2020  it("/")[-1].    
+00015760: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00015770: 2020 2020 2020 666e 203d 2073 656c 662e        fn = self.
+00015780: 686f 7374 2e73 706c 6974 2822 3a22 295b  host.split(":")[
+00015790: 305d 0a0a 2020 2020 2020 2020 7361 6665  0]..        safe
+000157a0: 203d 2028 7374 7269 6e67 2e61 7363 6969   = (string.ascii
+000157b0: 5f6c 6574 7465 7273 202b 2073 7472 696e  _letters + strin
+000157c0: 672e 6469 6769 7473 292e 7265 706c 6163  g.digits).replac
+000157d0: 6528 2225 222c 2022 2229 0a20 2020 2020  e("%", "").     
+000157e0: 2020 2061 666e 203d 2022 222e 6a6f 696e     afn = "".join
+000157f0: 285b 7820 6966 2078 2069 6e20 7361 6665  ([x if x in safe
+00015800: 2e72 6570 6c61 6365 2827 2227 2c20 2222  .replace('"', ""
+00015810: 2920 656c 7365 2022 5f22 2066 6f72 2078  ) else "_" for x
+00015820: 2069 6e20 666e 5d29 0a20 2020 2020 2020   in fn]).       
+00015830: 2062 6173 6369 6920 3d20 756e 6963 6f64   bascii = unicod
+00015840: 6528 7361 6665 292e 656e 636f 6465 2822  e(safe).encode("
+00015850: 7574 662d 3822 290a 2020 2020 2020 2020  utf-8").        
+00015860: 7a62 203d 2066 6e2e 656e 636f 6465 2822  zb = fn.encode("
+00015870: 7574 662d 3822 2c20 2278 6d6c 6368 6172  utf-8", "xmlchar
+00015880: 7265 6672 6570 6c61 6365 2229 0a20 2020  refreplace").   
+00015890: 2020 2020 2069 6620 6e6f 7420 5059 323a       if not PY2:
+000158a0: 0a20 2020 2020 2020 2020 2020 207a 626c  .            zbl
+000158b0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000158c0: 2020 2020 2063 6872 2878 292e 656e 636f       chr(x).enco
+000158d0: 6465 2822 7574 662d 3822 290a 2020 2020  de("utf-8").    
+000158e0: 2020 2020 2020 2020 2020 2020 6966 2078              if x
+000158f0: 2069 6e20 6261 7363 6969 0a20 2020 2020   in bascii.     
+00015900: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+00015910: 2225 7b3a 3032 787d 222e 666f 726d 6174  "%{:02x}".format
+00015920: 2878 292e 656e 636f 6465 2822 6173 6369  (x).encode("asci
+00015930: 6922 290a 2020 2020 2020 2020 2020 2020  i").            
+00015940: 2020 2020 666f 7220 7820 696e 207a 620a      for x in zb.
+00015950: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00015960: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00015970: 2020 2020 2020 2020 7a62 6c20 3d20 5b75          zbl = [u
+00015980: 6e69 636f 6465 2878 2920 6966 2078 2069  nicode(x) if x i
+00015990: 6e20 6261 7363 6969 2065 6c73 6520 2225  n bascii else "%
+000159a0: 7b3a 3032 787d 222e 666f 726d 6174 286f  {:02x}".format(o
+000159b0: 7264 2878 2929 2066 6f72 2078 2069 6e20  rd(x)) for x in 
+000159c0: 7a62 5d0a 0a20 2020 2020 2020 2075 666e  zb]..        ufn
+000159d0: 203d 2062 2222 2e6a 6f69 6e28 7a62 6c29   = b"".join(zbl)
+000159e0: 2e64 6563 6f64 6528 2261 7363 6969 2229  .decode("ascii")
+000159f0: 0a0a 2020 2020 2020 2020 6364 6973 203d  ..        cdis =
+00015a00: 2022 6174 7461 6368 6d65 6e74 3b20 6669   "attachment; fi
+00015a10: 6c65 6e61 6d65 3d5c 227b 7d2e 7b7d 5c22  lename=\"{}.{}\"
+00015a20: 3b20 6669 6c65 6e61 6d65 2a3d 5554 462d  ; filename*=UTF-
+00015a30: 3827 277b 7d2e 7b7d 220a 2020 2020 2020  8''{}.{}".      
+00015a40: 2020 6364 6973 203d 2063 6469 732e 666f    cdis = cdis.fo
+00015a50: 726d 6174 2861 666e 2c20 666d 742c 2075  rmat(afn, fmt, u
+00015a60: 666e 2c20 666d 7429 0a20 2020 2020 2020  fn, fmt).       
+00015a70: 2073 656c 662e 6c6f 6728 6364 6973 290a   self.log(cdis).
+00015a80: 2020 2020 2020 2020 7365 6c66 2e73 656e          self.sen
+00015a90: 645f 6865 6164 6572 7328 4e6f 6e65 2c20  d_headers(None, 
+00015aa0: 6d69 6d65 3d6d 696d 652c 2068 6561 6465  mime=mime, heade
+00015ab0: 7273 3d7b 2243 6f6e 7465 6e74 2d44 6973  rs={"Content-Dis
+00015ac0: 706f 7369 7469 6f6e 223a 2063 6469 737d  position": cdis}
+00015ad0: 290a 0a20 2020 2020 2020 2066 6765 6e20  )..        fgen 
+00015ae0: 3d20 766e 2e7a 6970 6765 6e28 0a20 2020  = vn.zipgen(.   
+00015af0: 2020 2020 2020 2020 2076 7061 7468 2c20           vpath, 
+00015b00: 7265 6d2c 2073 6574 2869 7465 6d73 292c  rem, set(items),
+00015b10: 2073 656c 662e 756e 616d 652c 2064 6f74   self.uname, dot
+00015b20: 732c 2046 616c 7365 2c20 6e6f 7420 7365  s, False, not se
+00015b30: 6c66 2e61 7267 732e 6e6f 5f73 6361 6e64  lf.args.no_scand
+00015b40: 6972 0a20 2020 2020 2020 2029 0a20 2020  ir.        ).   
+00015b50: 2020 2020 2023 2066 6f72 2066 2069 6e20       # for f in 
+00015b60: 6667 656e 3a20 7072 696e 7428 7265 7072  fgen: print(repr
+00015b70: 287b 6b3a 2066 5b6b 5d20 666f 7220 6b20  ({k: f[k] for k 
+00015b80: 696e 205b 2276 7022 2c20 2261 7022 5d7d  in ["vp", "ap"]}
+00015b90: 2929 0a20 2020 2020 2020 2062 6765 6e20  )).        bgen 
+00015ba0: 3d20 7061 636b 6572 2873 656c 662e 6c6f  = packer(self.lo
+00015bb0: 672c 2066 6765 6e2c 2075 7466 383d 2275  g, fgen, utf8="u
+00015bc0: 7466 2220 696e 2075 6172 672c 2070 7265  tf" in uarg, pre
+00015bd0: 5f63 7263 3d22 6372 6322 2069 6e20 7561  _crc="crc" in ua
+00015be0: 7267 290a 2020 2020 2020 2020 6273 656e  rg).        bsen
+00015bf0: 7420 3d20 300a 2020 2020 2020 2020 666f  t = 0.        fo
+00015c00: 7220 6275 6620 696e 2062 6765 6e2e 6765  r buf in bgen.ge
+00015c10: 6e28 293a 0a20 2020 2020 2020 2020 2020  n():.           
+00015c20: 2069 6620 6e6f 7420 6275 663a 0a20 2020   if not buf:.   
+00015c30: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+00015c40: 616b 0a0a 2020 2020 2020 2020 2020 2020  ak..            
+00015c50: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00015c60: 2020 2020 2073 656c 662e 732e 7365 6e64       self.s.send
+00015c70: 616c 6c28 6275 6629 0a20 2020 2020 2020  all(buf).       
+00015c80: 2020 2020 2020 2020 2062 7365 6e74 202b           bsent +
+00015c90: 3d20 6c65 6e28 6275 6629 0a20 2020 2020  = len(buf).     
+00015ca0: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
+00015cb0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00015cc0: 6f67 6d73 6720 2b3d 2022 205c 3033 335b  ogmsg += " \033[
+00015cd0: 3331 6d22 202b 2075 6e69 636f 6465 2862  31m" + unicode(b
+00015ce0: 7365 6e74 2920 2b20 225c 3033 335b 306d  sent) + "\033[0m
+00015cf0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00015d00: 2020 6272 6561 6b0a 0a20 2020 2020 2020    break..       
+00015d10: 2073 7064 203d 2073 656c 662e 5f73 7064   spd = self._spd
+00015d20: 2862 7365 6e74 290a 2020 2020 2020 2020  (bsent).        
+00015d30: 7365 6c66 2e6c 6f67 2822 7b7d 2c20 207b  self.log("{},  {
+00015d40: 7d22 2e66 6f72 6d61 7428 6c6f 676d 7367  }".format(logmsg
+00015d50: 2c20 7370 6429 290a 2020 2020 2020 2020  , spd)).        
+00015d60: 7265 7475 726e 2054 7275 650a 0a20 2020  return True..   
+00015d70: 2064 6566 2074 785f 6963 6f28 7365 6c66   def tx_ico(self
+00015d80: 2c20 6578 7420 2c20 6578 6163 7420 203d  , ext , exact  =
+00015d90: 2046 616c 7365 2920 203a 0a20 2020 2020   False)  :.     
+00015da0: 2020 2073 656c 662e 7065 726d 6974 5f63     self.permit_c
+00015db0: 6163 6869 6e67 2829 0a20 2020 2020 2020  aching().       
+00015dc0: 2069 6620 6578 742e 656e 6473 7769 7468   if ext.endswith
+00015dd0: 2822 2f22 293a 0a20 2020 2020 2020 2020  ("/"):.         
+00015de0: 2020 2065 7874 203d 2022 666f 6c64 6572     ext = "folder
+00015df0: 220a 2020 2020 2020 2020 2020 2020 6578  ".            ex
+00015e00: 6163 7420 3d20 5472 7565 0a0a 2020 2020  act = True..    
+00015e10: 2020 2020 6261 6420 3d20 7265 2e63 6f6d      bad = re.com
+00015e20: 7069 6c65 2872 225b 5d28 297b 7d2f 205b  pile(r"[](){}/ [
+00015e30: 5d7c 5e5b 302d 395f 2d5d 2a24 2229 0a20  ]|^[0-9_-]*$"). 
+00015e40: 2020 2020 2020 206e 203d 2065 7874 2e73         n = ext.s
+00015e50: 706c 6974 2822 2e22 295b 3a3a 2d31 5d0a  plit(".")[::-1].
+00015e60: 2020 2020 2020 2020 6966 206e 6f74 2065          if not e
+00015e70: 7861 6374 3a0a 2020 2020 2020 2020 2020  xact:.          
+00015e80: 2020 6e20 3d20 6e5b 3a2d 315d 0a0a 2020    n = n[:-1]..  
+00015e90: 2020 2020 2020 6578 7420 3d20 2222 0a20        ext = "". 
+00015ea0: 2020 2020 2020 2066 6f72 2076 2069 6e20         for v in 
+00015eb0: 6e3a 0a20 2020 2020 2020 2020 2020 2069  n:.            i
+00015ec0: 6620 6c65 6e28 7629 203e 2037 206f 7220  f len(v) > 7 or 
+00015ed0: 6261 642e 7365 6172 6368 2876 293a 0a20  bad.search(v):. 
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00015ef0: 7265 616b 0a0a 2020 2020 2020 2020 2020  reak..          
+00015f00: 2020 6578 7420 3d20 227b 7d2e 7b7d 222e    ext = "{}.{}".
+00015f10: 666f 726d 6174 2876 2c20 6578 7429 0a0a  format(v, ext)..
+00015f20: 2020 2020 2020 2020 6578 7420 3d20 6578          ext = ex
+00015f30: 742e 7273 7472 6970 2822 2e22 2920 6f72  t.rstrip(".") or
+00015f40: 2022 756e 6b22 0a20 2020 2020 2020 2069   "unk".        i
+00015f50: 6620 6c65 6e28 6578 7429 203e 2031 313a  f len(ext) > 11:
+00015f60: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
+00015f70: 203d 2022 e28b af22 202b 2065 7874 5b2d   = "..." + ext[-
+00015f80: 393a 5d0a 0a20 2020 2020 2020 2023 2063  9:]..        # c
+00015f90: 6872 6f6d 6520 6361 6e6e 6f74 2068 616e  hrome cannot han
+00015fa0: 646c 6520 6d6f 7265 2074 6861 6e20 7e32  dle more than ~2
+00015fb0: 3030 3020 756e 6971 7565 2053 5647 730a  000 unique SVGs.
+00015fc0: 2020 2020 2020 2020 6368 726f 6d65 203d          chrome =
+00015fd0: 2022 2072 763a 2220 6e6f 7420 696e 2073   " rv:" not in s
+00015fe0: 656c 662e 7561 0a20 2020 2020 2020 206d  elf.ua.        m
+00015ff0: 696d 652c 2069 636f 203d 2073 656c 662e  ime, ico = self.
+00016000: 6963 6f2e 6765 7428 6578 742c 206e 6f74  ico.get(ext, not
+00016010: 2065 7861 6374 2c20 6368 726f 6d65 290a   exact, chrome).
+00016020: 0a20 2020 2020 2020 206c 6d20 3d20 666f  .        lm = fo
+00016030: 726d 6174 6461 7465 2873 656c 662e 452e  rmatdate(self.E.
+00016040: 7430 2c20 7573 6567 6d74 3d54 7275 6529  t0, usegmt=True)
+00016050: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
+00016060: 706c 7928 6963 6f2c 206d 696d 653d 6d69  ply(ico, mime=mi
+00016070: 6d65 2c20 6865 6164 6572 733d 7b22 4c61  me, headers={"La
+00016080: 7374 2d4d 6f64 6966 6965 6422 3a20 6c6d  st-Modified": lm
+00016090: 7d29 0a20 2020 2020 2020 2072 6574 7572  }).        retur
+000160a0: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
+000160b0: 7478 5f6d 6428 7365 6c66 2c20 6673 5f70  tx_md(self, fs_p
+000160c0: 6174 6820 2920 203a 0a20 2020 2020 2020  ath )  :.       
+000160d0: 206c 6f67 6d73 6720 3d20 227b 3a34 7d20   logmsg = "{:4} 
+000160e0: 7b7d 2022 2e66 6f72 6d61 7428 2222 2c20  {} ".format("", 
+000160f0: 7365 6c66 2e72 6571 290a 0a20 2020 2020  self.req)..     
+00016100: 2020 2069 6620 6e6f 7420 7365 6c66 2e63     if not self.c
+00016110: 616e 5f77 7269 7465 3a0a 2020 2020 2020  an_write:.      
+00016120: 2020 2020 2020 6966 2022 6564 6974 2220        if "edit" 
+00016130: 696e 2073 656c 662e 7570 6172 616d 206f  in self.uparam o
+00016140: 7220 2265 6469 7432 2220 696e 2073 656c  r "edit2" in sel
+00016150: 662e 7570 6172 616d 3a0a 2020 2020 2020  f.uparam:.      
+00016160: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00016170: 2073 656c 662e 7478 5f34 3034 2854 7275   self.tx_404(Tru
+00016180: 6529 0a0a 2020 2020 2020 2020 7470 6c20  e)..        tpl 
+00016190: 3d20 226d 6465 2220 6966 2022 6564 6974  = "mde" if "edit
+000161a0: 3222 2069 6e20 7365 6c66 2e75 7061 7261  2" in self.upara
+000161b0: 6d20 656c 7365 2022 6d64 220a 2020 2020  m else "md".    
+000161c0: 2020 2020 6874 6d6c 5f70 6174 6820 3d20      html_path = 
+000161d0: 6f73 2e70 6174 682e 6a6f 696e 2873 656c  os.path.join(sel
+000161e0: 662e 452e 6d6f 642c 2022 7765 6222 2c20  f.E.mod, "web", 
+000161f0: 227b 7d2e 6874 6d6c 222e 666f 726d 6174  "{}.html".format
+00016200: 2874 706c 2929 0a20 2020 2020 2020 2074  (tpl)).        t
+00016210: 656d 706c 6174 6520 3d20 7365 6c66 2e6a  emplate = self.j
+00016220: 326a 2874 706c 290a 0a20 2020 2020 2020  2j(tpl)..       
+00016230: 2073 7420 3d20 626f 732e 7374 6174 2866   st = bos.stat(f
+00016240: 735f 7061 7468 290a 2020 2020 2020 2020  s_path).        
+00016250: 7473 5f6d 6420 3d20 7374 2e73 745f 6d74  ts_md = st.st_mt
+00016260: 696d 650a 0a20 2020 2020 2020 2073 7420  ime..        st 
+00016270: 3d20 626f 732e 7374 6174 2868 746d 6c5f  = bos.stat(html_
+00016280: 7061 7468 290a 2020 2020 2020 2020 7473  path).        ts
+00016290: 5f68 746d 6c20 3d20 7374 2e73 745f 6d74  _html = st.st_mt
+000162a0: 696d 650a 0a20 2020 2020 2020 2073 7a5f  ime..        sz_
+000162b0: 6d64 203d 2030 0a20 2020 2020 2020 2066  md = 0.        f
+000162c0: 6f72 2062 7566 2069 6e20 7969 656c 6466  or buf in yieldf
+000162d0: 696c 6528 6673 5f70 6174 6829 3a0a 2020  ile(fs_path):.  
+000162e0: 2020 2020 2020 2020 2020 737a 5f6d 6420            sz_md 
+000162f0: 2b3d 206c 656e 2862 7566 290a 2020 2020  += len(buf).    
+00016300: 2020 2020 2020 2020 666f 7220 632c 2076          for c, v
+00016310: 2069 6e20 5b28 6222 2622 2c20 3429 2c20   in [(b"&", 4), 
+00016320: 2862 223c 222c 2033 292c 2028 6222 3e22  (b"<", 3), (b">"
+00016330: 2c20 3329 5d3a 0a20 2020 2020 2020 2020  , 3)]:.         
+00016340: 2020 2020 2020 2073 7a5f 6d64 202b 3d20         sz_md += 
+00016350: 286c 656e 2862 7566 2920 2d20 6c65 6e28  (len(buf) - len(
+00016360: 6275 662e 7265 706c 6163 6528 632c 2062  buf.replace(c, b
+00016370: 2222 2929 2920 2a20 760a 0a20 2020 2020  ""))) * v..     
+00016380: 2020 2066 696c 655f 7473 203d 2069 6e74     file_ts = int
+00016390: 286d 6178 2874 735f 6d64 2c20 7473 5f68  (max(ts_md, ts_h
+000163a0: 746d 6c2c 2073 656c 662e 452e 7430 2929  tml, self.E.t0))
+000163b0: 0a20 2020 2020 2020 2066 696c 655f 6c61  .        file_la
+000163c0: 7374 6d6f 642c 2064 6f5f 7365 6e64 203d  stmod, do_send =
+000163d0: 2073 656c 662e 5f63 686b 5f6c 6173 746d   self._chk_lastm
+000163e0: 6f64 2866 696c 655f 7473 290a 2020 2020  od(file_ts).    
+000163f0: 2020 2020 7365 6c66 2e6f 7574 5f68 6561      self.out_hea
+00016400: 6465 7273 5b22 4c61 7374 2d4d 6f64 6966  ders["Last-Modif
+00016410: 6965 6422 5d20 3d20 6669 6c65 5f6c 6173  ied"] = file_las
+00016420: 746d 6f64 0a20 2020 2020 2020 2073 656c  tmod.        sel
+00016430: 662e 6f75 745f 6865 6164 6572 732e 7570  f.out_headers.up
+00016440: 6461 7465 284e 4f5f 4341 4348 4529 0a20  date(NO_CACHE). 
+00016450: 2020 2020 2020 2073 7461 7475 7320 3d20         status = 
+00016460: 3230 3020 6966 2064 6f5f 7365 6e64 2065  200 if do_send e
+00016470: 6c73 6520 3330 340a 0a20 2020 2020 2020  lse 304..       
+00016480: 2061 7267 5f62 6173 6520 3d20 223f 220a   arg_base = "?".
+00016490: 2020 2020 2020 2020 6966 2022 6b22 2069          if "k" i
+000164a0: 6e20 7365 6c66 2e75 7061 7261 6d3a 0a20  n self.uparam:. 
+000164b0: 2020 2020 2020 2020 2020 2061 7267 5f62             arg_b
+000164c0: 6173 6520 3d20 223f 6b3d 7b7d 2622 2e66  ase = "?k={}&".f
+000164d0: 6f72 6d61 7428 7365 6c66 2e75 7061 7261  ormat(self.upara
+000164e0: 6d5b 226b 225d 290a 0a20 2020 2020 2020  m["k"])..       
+000164f0: 2062 6f75 6e64 6172 7920 3d20 225c 726f   boundary = "\ro
+00016500: 6c6c 5c74 6964 6522 0a20 2020 2020 2020  ll\tide".       
+00016510: 2074 6172 6773 203d 207b 0a20 2020 2020   targs = {.     
+00016520: 2020 2020 2020 2022 7222 3a20 7365 6c66         "r": self
+00016530: 2e61 7267 732e 5352 2069 6620 7365 6c66  .args.SR if self
+00016540: 2e69 735f 7670 726f 7869 6564 2065 6c73  .is_vproxied els
+00016550: 6520 2222 2c0a 2020 2020 2020 2020 2020  e "",.          
+00016560: 2020 2274 7322 3a20 7365 6c66 2e63 6f6e    "ts": self.con
+00016570: 6e2e 6873 7276 2e63 6163 6865 6275 7374  n.hsrv.cachebust
+00016580: 6572 2829 2c0a 2020 2020 2020 2020 2020  er(),.          
+00016590: 2020 2273 7663 6e61 6d65 223a 2073 656c    "svcname": sel
+000165a0: 662e 6172 6773 2e64 6f63 7469 746c 652c  f.args.doctitle,
+000165b0: 0a20 2020 2020 2020 2020 2020 2022 6874  .            "ht
+000165c0: 6d6c 5f68 6561 6422 3a20 7365 6c66 2e68  ml_head": self.h
+000165d0: 746d 6c5f 6865 6164 2c0a 2020 2020 2020  tml_head,.      
+000165e0: 2020 2020 2020 2265 6469 7422 3a20 2265        "edit": "e
+000165f0: 6469 7422 2069 6e20 7365 6c66 2e75 7061  dit" in self.upa
+00016600: 7261 6d2c 0a20 2020 2020 2020 2020 2020  ram,.           
+00016610: 2022 7469 746c 6522 3a20 6874 6d6c 5f65   "title": html_e
+00016620: 7363 6170 6528 7365 6c66 2e76 7061 7468  scape(self.vpath
+00016630: 2c20 6372 6c66 3d54 7275 6529 2c0a 2020  , crlf=True),.  
+00016640: 2020 2020 2020 2020 2020 226c 6173 746d            "lastm
+00016650: 6f64 223a 2069 6e74 2874 735f 6d64 202a  od": int(ts_md *
+00016660: 2031 3030 3029 2c0a 2020 2020 2020 2020   1000),.        
+00016670: 2020 2020 226c 616e 6722 3a20 7365 6c66      "lang": self
+00016680: 2e61 7267 732e 6c61 6e67 2c0a 2020 2020  .args.lang,.    
+00016690: 2020 2020 2020 2020 2266 6176 6963 6f22          "favico"
+000166a0: 3a20 7365 6c66 2e61 7267 732e 6661 7669  : self.args.favi
+000166b0: 636f 2c0a 2020 2020 2020 2020 2020 2020  co,.            
+000166c0: 2268 6176 655f 656d 7022 3a20 7365 6c66  "have_emp": self
+000166d0: 2e61 7267 732e 656d 702c 0a20 2020 2020  .args.emp,.     
+000166e0: 2020 2020 2020 2022 6d64 5f63 686b 5f72         "md_chk_r
+000166f0: 6174 6522 3a20 7365 6c66 2e61 7267 732e  ate": self.args.
+00016700: 6d63 722c 0a20 2020 2020 2020 2020 2020  mcr,.           
+00016710: 2022 6d64 223a 2062 6f75 6e64 6172 792c   "md": boundary,
+00016720: 0a20 2020 2020 2020 2020 2020 2022 6172  .            "ar
+00016730: 675f 6261 7365 223a 2061 7267 5f62 6173  g_base": arg_bas
+00016740: 652c 0a20 2020 2020 2020 207d 0a20 2020  e,.        }.   
+00016750: 2020 2020 207a 7320 3d20 7465 6d70 6c61       zs = templa
+00016760: 7465 2e72 656e 6465 7228 2a2a 7461 7267  te.render(**targ
+00016770: 7329 2e65 6e63 6f64 6528 2275 7466 2d38  s).encode("utf-8
+00016780: 222c 2022 7265 706c 6163 6522 290a 2020  ", "replace").  
+00016790: 2020 2020 2020 6874 6d6c 203d 207a 732e        html = zs.
+000167a0: 7370 6c69 7428 626f 756e 6461 7279 2e65  split(boundary.e
+000167b0: 6e63 6f64 6528 2275 7466 2d38 2229 290a  ncode("utf-8")).
+000167c0: 2020 2020 2020 2020 6966 206c 656e 2868          if len(h
+000167d0: 746d 6c29 2021 3d20 323a 0a20 2020 2020  tml) != 2:.     
+000167e0: 2020 2020 2020 2072 6169 7365 2045 7863         raise Exc
+000167f0: 6570 7469 6f6e 2822 626f 756e 6461 7279  eption("boundary
+00016800: 2061 7070 6561 7273 2069 6e20 2220 2b20   appears in " + 
+00016810: 6874 6d6c 5f70 6174 6829 0a0a 2020 2020  html_path)..    
+00016820: 2020 2020 7365 6c66 2e73 656e 645f 6865      self.send_he
+00016830: 6164 6572 7328 737a 5f6d 6420 2b20 6c65  aders(sz_md + le
+00016840: 6e28 6874 6d6c 5b30 5d29 202b 206c 656e  n(html[0]) + len
+00016850: 2868 746d 6c5b 315d 292c 2073 7461 7475  (html[1]), statu
+00016860: 7329 0a0a 2020 2020 2020 2020 6c6f 676d  s)..        logm
+00016870: 7367 202b 3d20 756e 6963 6f64 6528 7374  sg += unicode(st
+00016880: 6174 7573 290a 2020 2020 2020 2020 6966  atus).        if
+00016890: 2073 656c 662e 6d6f 6465 203d 3d20 2248   self.mode == "H
+000168a0: 4541 4422 206f 7220 6e6f 7420 646f 5f73  EAD" or not do_s
+000168b0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
+000168c0: 2069 6620 7365 6c66 2e64 6f5f 6c6f 673a   if self.do_log:
+000168d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000168e0: 2073 656c 662e 6c6f 6728 6c6f 676d 7367   self.log(logmsg
+000168f0: 290a 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00016900: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00016910: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00016920: 2020 2020 2073 656c 662e 732e 7365 6e64       self.s.send
+00016930: 616c 6c28 6874 6d6c 5b30 5d29 0a20 2020  all(html[0]).   
+00016940: 2020 2020 2020 2020 2066 6f72 2062 7566           for buf
+00016950: 2069 6e20 7969 656c 6466 696c 6528 6673   in yieldfile(fs
+00016960: 5f70 6174 6829 3a0a 2020 2020 2020 2020  _path):.        
+00016970: 2020 2020 2020 2020 7365 6c66 2e73 2e73          self.s.s
+00016980: 656e 6461 6c6c 2868 746d 6c5f 6265 7363  endall(html_besc
+00016990: 6170 6528 6275 6629 290a 0a20 2020 2020  ape(buf))..     
+000169a0: 2020 2020 2020 2073 656c 662e 732e 7365         self.s.se
+000169b0: 6e64 616c 6c28 6874 6d6c 5b31 5d29 0a0a  ndall(html[1])..
+000169c0: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+000169d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000169e0: 2e6c 6f67 286c 6f67 6d73 6720 2b20 2220  .log(logmsg + " 
+000169f0: 5c30 3333 5b33 316d 642f 635c 3033 335b  \033[31md/c\033[
+00016a00: 306d 2229 0a20 2020 2020 2020 2020 2020  0m").           
+00016a10: 2072 6574 7572 6e20 4661 6c73 650a 0a20   return False.. 
+00016a20: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00016a30: 6f5f 6c6f 673a 0a20 2020 2020 2020 2020  o_log:.         
+00016a40: 2020 2073 656c 662e 6c6f 6728 6c6f 676d     self.log(logm
+00016a50: 7367 202b 2022 2022 202b 2075 6e69 636f  sg + " " + unico
+00016a60: 6465 286c 656e 2868 746d 6c29 2929 0a0a  de(len(html)))..
+00016a70: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+00016a80: 7275 650a 0a20 2020 2064 6566 2074 785f  rue..    def tx_
+00016a90: 7376 6373 2873 656c 6629 2020 3a0a 2020  svcs(self)  :.  
+00016aa0: 2020 2020 2020 616e 616d 6520 3d20 7265        aname = re
+00016ab0: 2e73 7562 2822 5b5e 302d 3961 2d7a 412d  .sub("[^0-9a-zA-
+00016ac0: 5a5d 2b22 2c20 2222 2c20 7365 6c66 2e61  Z]+", "", self.a
+00016ad0: 7267 732e 6e61 6d65 2920 6f72 2022 6122  rgs.name) or "a"
+00016ae0: 0a20 2020 2020 2020 2065 7020 3d20 7365  .        ep = se
+00016af0: 6c66 2e68 6f73 740a 2020 2020 2020 2020  lf.host.        
+00016b00: 686f 7374 203d 2065 702e 7370 6c69 7428  host = ep.split(
+00016b10: 223a 2229 5b30 5d0a 2020 2020 2020 2020  ":")[0].        
+00016b20: 6870 6f72 7420 3d20 6570 5b65 702e 6669  hport = ep[ep.fi
+00016b30: 6e64 2822 3a22 2920 3a5d 2069 6620 223a  nd(":") :] if ":
+00016b40: 2220 696e 2065 7020 656c 7365 2022 220a  " in ep else "".
+00016b50: 2020 2020 2020 2020 7269 7020 3d20 280a          rip = (.
+00016b60: 2020 2020 2020 2020 2020 2020 686f 7374              host
+00016b70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016b80: 7365 6c66 2e61 7267 732e 7263 6c6f 6e65  self.args.rclone
+00016b90: 5f6d 646e 7320 6f72 206e 6f74 2073 656c  _mdns or not sel
+00016ba0: 662e 6172 6773 2e7a 6d0a 2020 2020 2020  f.args.zm.      
+00016bb0: 2020 2020 2020 656c 7365 2073 656c 662e        else self.
+00016bc0: 636f 6e6e 2e68 7372 762e 6e6d 2e6d 6170  conn.hsrv.nm.map
+00016bd0: 2873 656c 662e 6970 2920 6f72 2068 6f73  (self.ip) or hos
+00016be0: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
+00016bf0: 2020 2020 7670 203d 2028 7365 6c66 2e75      vp = (self.u
+00016c00: 7061 7261 6d5b 2268 6322 5d20 6f72 2022  param["hc"] or "
+00016c10: 2229 2e6c 7374 7269 7028 222f 2229 0a20  ").lstrip("/"). 
+00016c20: 2020 2020 2020 2068 746d 6c20 3d20 7365         html = se
+00016c30: 6c66 2e6a 3273 280a 2020 2020 2020 2020  lf.j2s(.        
+00016c40: 2020 2020 2273 7663 7322 2c0a 2020 2020      "svcs",.    
+00016c50: 2020 2020 2020 2020 6172 6773 3d73 656c          args=sel
+00016c60: 662e 6172 6773 2c0a 2020 2020 2020 2020  f.args,.        
+00016c70: 2020 2020 6163 6373 3d62 6f6f 6c28 7365      accs=bool(se
+00016c80: 6c66 2e61 7372 762e 6163 6374 292c 0a20  lf.asrv.acct),. 
+00016c90: 2020 2020 2020 2020 2020 2073 3d22 7322             s="s"
+00016ca0: 2069 6620 7365 6c66 2e69 735f 6874 7470   if self.is_http
+00016cb0: 7320 656c 7365 2022 222c 0a20 2020 2020  s else "",.     
+00016cc0: 2020 2020 2020 2072 6970 3d72 6970 2c0a         rip=rip,.
+00016cd0: 2020 2020 2020 2020 2020 2020 6570 3d65              ep=e
+00016ce0: 702c 0a20 2020 2020 2020 2020 2020 2076  p,.            v
+00016cf0: 703d 7670 2c0a 2020 2020 2020 2020 2020  p=vp,.          
+00016d00: 2020 7276 703d 766a 6f69 6e28 7365 6c66    rvp=vjoin(self
+00016d10: 2e61 7267 732e 522c 2076 7029 2c0a 2020  .args.R, vp),.  
+00016d20: 2020 2020 2020 2020 2020 686f 7374 3d68            host=h
+00016d30: 6f73 742c 0a20 2020 2020 2020 2020 2020  ost,.           
+00016d40: 2068 706f 7274 3d68 706f 7274 2c0a 2020   hport=hport,.  
+00016d50: 2020 2020 2020 2020 2020 616e 616d 653d            aname=
+00016d60: 616e 616d 652c 0a20 2020 2020 2020 2020  aname,.         
+00016d70: 2020 2070 773d 7365 6c66 2e70 7720 6f72     pw=self.pw or
+00016d80: 2022 7077 222c 0a20 2020 2020 2020 2029   "pw",.        )
+00016d90: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
+00016da0: 706c 7928 6874 6d6c 2e65 6e63 6f64 6528  ply(html.encode(
+00016db0: 2275 7466 2d38 2229 290a 2020 2020 2020  "utf-8")).      
+00016dc0: 2020 7265 7475 726e 2054 7275 650a 0a20    return True.. 
+00016dd0: 2020 2064 6566 2074 785f 6d6f 756e 7473     def tx_mounts
+00016de0: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
+00016df0: 2020 7375 6620 3d20 7365 6c66 2e75 726c    suf = self.url
+00016e00: 7128 7b7d 2c20 5b22 6822 5d29 0a20 2020  q({}, ["h"]).   
+00016e10: 2020 2020 2061 766f 6c20 3d20 5b78 2066       avol = [x f
+00016e20: 6f72 2078 2069 6e20 7365 6c66 2e77 766f  or x in self.wvo
+00016e30: 6c20 6966 2078 2069 6e20 7365 6c66 2e72  l if x in self.r
+00016e40: 766f 6c5d 0a20 2020 2020 2020 2072 766f  vol].        rvo
+00016e50: 6c2c 2077 766f 6c2c 2061 766f 6c20 3d20  l, wvol, avol = 
+00016e60: 5b0a 2020 2020 2020 2020 2020 2020 5b28  [.            [(
+00016e70: 222f 2220 2b20 7829 2e72 7374 7269 7028  "/" + x).rstrip(
+00016e80: 222f 2229 202b 2022 2f22 2066 6f72 2078  "/") + "/" for x
+00016e90: 2069 6e20 795d 0a20 2020 2020 2020 2020   in y].         
+00016ea0: 2020 2066 6f72 2079 2069 6e20 5b73 656c     for y in [sel
+00016eb0: 662e 7276 6f6c 2c20 7365 6c66 2e77 766f  f.rvol, self.wvo
+00016ec0: 6c2c 2061 766f 6c5d 0a20 2020 2020 2020  l, avol].       
+00016ed0: 205d 0a0a 2020 2020 2020 2020 6966 2061   ]..        if a
+00016ee0: 766f 6c20 616e 6420 6e6f 7420 7365 6c66  vol and not self
+00016ef0: 2e61 7267 732e 6e6f 5f72 6573 6361 6e3a  .args.no_rescan:
+00016f00: 0a20 2020 2020 2020 2020 2020 2078 203d  .            x =
+00016f10: 2073 656c 662e 636f 6e6e 2e68 7372 762e   self.conn.hsrv.
+00016f20: 6272 6f6b 6572 2e61 736b 2822 7570 326b  broker.ask("up2k
+00016f30: 2e67 6574 5f73 7461 7465 2229 0a20 2020  .get_state").   
+00016f40: 2020 2020 2020 2020 2076 7320 3d20 6a73           vs = js
+00016f50: 6f6e 2e6c 6f61 6473 2878 2e67 6574 2829  on.loads(x.get()
+00016f60: 290a 2020 2020 2020 2020 2020 2020 7673  ).            vs
+00016f70: 7461 7465 203d 207b 2822 2f22 202b 206b  tate = {("/" + k
+00016f80: 292e 7273 7472 6970 2822 2f22 2920 2b20  ).rstrip("/") + 
+00016f90: 222f 223a 2076 2066 6f72 206b 2c20 7620  "/": v for k, v 
+00016fa0: 696e 2076 735b 2276 6f6c 7374 6174 6522  in vs["volstate"
+00016fb0: 5d2e 6974 656d 7328 297d 0a20 2020 2020  ].items()}.     
+00016fc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00016fd0: 2020 2020 2076 7374 6174 6520 3d20 7b7d       vstate = {}
+00016fe0: 0a20 2020 2020 2020 2020 2020 2076 7320  .            vs 
+00016ff0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00017000: 2020 2020 2273 6361 6e6e 696e 6722 3a20      "scanning": 
+00017010: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00017020: 2020 2020 2020 2268 6173 6871 223a 204e        "hashq": N
+00017030: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+00017040: 2020 2020 2022 7461 6771 223a 204e 6f6e       "tagq": Non
+00017050: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00017060: 2020 2022 6d74 7071 223a 204e 6f6e 652c     "mtpq": None,
+00017070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017080: 2022 6462 7774 223a 204e 6f6e 652c 0a20   "dbwt": None,. 
+00017090: 2020 2020 2020 2020 2020 207d 0a0a 2020             }..  
+000170a0: 2020 2020 2020 666d 7420 3d20 7365 6c66        fmt = self
+000170b0: 2e75 7061 7261 6d2e 6765 7428 226c 7322  .uparam.get("ls"
+000170c0: 2c20 2222 290a 2020 2020 2020 2020 6966  , "").        if
+000170d0: 206e 6f74 2066 6d74 2061 6e64 2028 7365   not fmt and (se
+000170e0: 6c66 2e75 612e 7374 6172 7473 7769 7468  lf.ua.startswith
+000170f0: 2822 6375 726c 2f22 2920 6f72 2073 656c  ("curl/") or sel
+00017100: 662e 7561 2e73 7461 7274 7377 6974 6828  f.ua.startswith(
+00017110: 2266 6574 6368 2229 293a 0a20 2020 2020  "fetch")):.     
+00017120: 2020 2020 2020 2066 6d74 203d 2022 7622         fmt = "v"
+00017130: 0a0a 2020 2020 2020 2020 6966 2066 6d74  ..        if fmt
+00017140: 2069 6e20 5b22 7622 2c20 2274 222c 2022   in ["v", "t", "
+00017150: 7478 7422 5d3a 0a20 2020 2020 2020 2020  txt"]:.         
+00017160: 2020 2069 6620 7365 6c66 2e75 6e61 6d65     if self.uname
+00017170: 203d 3d20 222a 223a 0a20 2020 2020 2020   == "*":.       
+00017180: 2020 2020 2020 2020 2074 7874 203d 2022           txt = "
+00017190: 686f 7764 7920 7374 7261 6e67 6572 2028  howdy stranger (
+000171a0: 796f 7527 7265 206e 6f74 206c 6f67 6765  you're not logge
+000171b0: 6420 696e 2922 0a20 2020 2020 2020 2020  d in)".         
+000171c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000171d0: 2020 2020 2020 2020 2074 7874 203d 2022           txt = "
+000171e0: 7765 6c63 6f6d 6520 6261 636b 207b 7d22  welcome back {}"
+000171f0: 2e66 6f72 6d61 7428 7365 6c66 2e75 6e61  .format(self.una
+00017200: 6d65 290a 0a20 2020 2020 2020 2020 2020  me)..           
+00017210: 2069 6620 7673 7461 7465 3a0a 2020 2020   if vstate:.    
+00017220: 2020 2020 2020 2020 2020 2020 7478 7420              txt 
+00017230: 2b3d 2022 5c6e 7374 6174 7573 3a22 0a20  += "\nstatus:". 
+00017240: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00017250: 6f72 206b 2069 6e20 5b22 7363 616e 6e69  or k in ["scanni
+00017260: 6e67 222c 2022 6861 7368 7122 2c20 2274  ng", "hashq", "t
+00017270: 6167 7122 2c20 226d 7470 7122 2c20 2264  agq", "mtpq", "d
+00017280: 6277 7422 5d3a 0a20 2020 2020 2020 2020  bwt"]:.         
+00017290: 2020 2020 2020 2020 2020 2074 7874 202b             txt +
+000172a0: 3d20 2220 7b7d 287b 7d29 222e 666f 726d  = " {}({})".form
+000172b0: 6174 286b 2c20 7673 5b6b 5d29 0a0a 2020  at(k, vs[k])..  
+000172c0: 2020 2020 2020 2020 2020 6966 2072 766f            if rvo
+000172d0: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
+000172e0: 2020 2074 7874 202b 3d20 225c 6e79 6f75     txt += "\nyou
+000172f0: 2063 616e 2062 726f 7773 653a 220a 2020   can browse:".  
+00017300: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00017310: 7220 7620 696e 2072 766f 6c3a 0a20 2020  r v in rvol:.   
+00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017330: 2074 7874 202b 3d20 225c 6e20 2022 202b   txt += "\n  " +
+00017340: 2076 0a0a 2020 2020 2020 2020 2020 2020   v..            
+00017350: 6966 2077 766f 6c3a 0a20 2020 2020 2020  if wvol:.       
+00017360: 2020 2020 2020 2020 2074 7874 202b 3d20           txt += 
+00017370: 225c 6e79 6f75 2063 616e 2075 706c 6f61  "\nyou can uploa
+00017380: 6420 746f 3a22 0a20 2020 2020 2020 2020  d to:".         
+00017390: 2020 2020 2020 2066 6f72 2076 2069 6e20         for v in 
+000173a0: 7776 6f6c 3a0a 2020 2020 2020 2020 2020  wvol:.          
+000173b0: 2020 2020 2020 2020 2020 7478 7420 2b3d            txt +=
+000173c0: 2022 5c6e 2020 2220 2b20 760a 0a20 2020   "\n  " + v..   
+000173d0: 2020 2020 2020 2020 207a 6220 3d20 7478           zb = tx
+000173e0: 742e 656e 636f 6465 2822 7574 662d 3822  t.encode("utf-8"
+000173f0: 2c20 2272 6570 6c61 6365 2229 202b 2062  , "replace") + b
+00017400: 225c 6e22 0a20 2020 2020 2020 2020 2020  "\n".           
+00017410: 2073 656c 662e 7265 706c 7928 7a62 2c20   self.reply(zb, 
+00017420: 6d69 6d65 3d22 7465 7874 2f70 6c61 696e  mime="text/plain
+00017430: 3b20 6368 6172 7365 743d 7574 662d 3822  ; charset=utf-8"
+00017440: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00017450: 7475 726e 2054 7275 650a 0a20 2020 2020  turn True..     
+00017460: 2020 2068 746d 6c20 3d20 7365 6c66 2e6a     html = self.j
+00017470: 3273 280a 2020 2020 2020 2020 2020 2020  2s(.            
+00017480: 2273 706c 6173 6822 2c0a 2020 2020 2020  "splash",.      
+00017490: 2020 2020 2020 7468 6973 3d73 656c 662c        this=self,
+000174a0: 0a20 2020 2020 2020 2020 2020 2071 7670  .            qvp
+000174b0: 6174 683d 7175 6f74 6570 2873 656c 662e  ath=quotep(self.
+000174c0: 7670 6174 6829 2c0a 2020 2020 2020 2020  vpath),.        
+000174d0: 2020 2020 7276 6f6c 3d72 766f 6c2c 0a20      rvol=rvol,. 
+000174e0: 2020 2020 2020 2020 2020 2077 766f 6c3d             wvol=
+000174f0: 7776 6f6c 2c0a 2020 2020 2020 2020 2020  wvol,.          
+00017500: 2020 6176 6f6c 3d61 766f 6c2c 0a20 2020    avol=avol,.   
+00017510: 2020 2020 2020 2020 2076 7374 6174 653d           vstate=
+00017520: 7673 7461 7465 2c0a 2020 2020 2020 2020  vstate,.        
+00017530: 2020 2020 7363 616e 6e69 6e67 3d76 735b      scanning=vs[
+00017540: 2273 6361 6e6e 696e 6722 5d2c 0a20 2020  "scanning"],.   
+00017550: 2020 2020 2020 2020 2068 6173 6871 3d76           hashq=v
+00017560: 735b 2268 6173 6871 225d 2c0a 2020 2020  s["hashq"],.    
+00017570: 2020 2020 2020 2020 7461 6771 3d76 735b          tagq=vs[
+00017580: 2274 6167 7122 5d2c 0a20 2020 2020 2020  "tagq"],.       
+00017590: 2020 2020 206d 7470 713d 7673 5b22 6d74       mtpq=vs["mt
+000175a0: 7071 225d 2c0a 2020 2020 2020 2020 2020  pq"],.          
+000175b0: 2020 6462 7774 3d76 735b 2264 6277 7422    dbwt=vs["dbwt"
+000175c0: 5d2c 0a20 2020 2020 2020 2020 2020 2075  ],.            u
+000175d0: 726c 5f73 7566 3d73 7566 2c0a 2020 2020  rl_suf=suf,.    
+000175e0: 2020 2020 2020 2020 6b33 3034 3d73 656c          k304=sel
+000175f0: 662e 6b33 3034 2829 2c0a 2020 2020 2020  f.k304(),.      
+00017600: 2020 2020 2020 7665 723d 535f 5645 5253        ver=S_VERS
+00017610: 494f 4e20 6966 2073 656c 662e 6172 6773  ION if self.args
+00017620: 2e76 6572 2065 6c73 6520 2222 2c0a 2020  .ver else "",.  
+00017630: 2020 2020 2020 2020 2020 6168 7474 7073            ahttps
+00017640: 3d22 2220 6966 2073 656c 662e 6973 5f68  ="" if self.is_h
+00017650: 7474 7073 2065 6c73 6520 2268 7474 7073  ttps else "https
+00017660: 3a2f 2f22 202b 2073 656c 662e 686f 7374  ://" + self.host
+00017670: 202b 2073 656c 662e 7265 712c 0a20 2020   + self.req,.   
+00017680: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00017690: 656c 662e 7265 706c 7928 6874 6d6c 2e65  elf.reply(html.e
+000176a0: 6e63 6f64 6528 2275 7466 2d38 2229 290a  ncode("utf-8")).
+000176b0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+000176c0: 7275 650a 0a20 2020 2064 6566 2073 6574  rue..    def set
+000176d0: 5f6b 3330 3428 7365 6c66 2920 203a 0a20  _k304(self)  :. 
+000176e0: 2020 2020 2020 2063 6b20 3d20 6765 6e63         ck = genc
+000176f0: 6f6f 6b69 6528 226b 3330 3422 2c20 7365  ookie("k304", se
+00017700: 6c66 2e75 7061 7261 6d5b 226b 3330 3422  lf.uparam["k304"
+00017710: 5d2c 2073 656c 662e 6172 6773 2e52 2c20  ], self.args.R, 
+00017720: 4661 6c73 652c 2038 3634 3030 202a 2032  False, 86400 * 2
+00017730: 3939 290a 2020 2020 2020 2020 7365 6c66  99).        self
+00017740: 2e6f 7574 5f68 6561 6465 726c 6973 742e  .out_headerlist.
+00017750: 6170 7065 6e64 2828 2253 6574 2d43 6f6f  append(("Set-Coo
+00017760: 6b69 6522 2c20 636b 2929 0a20 2020 2020  kie", ck)).     
+00017770: 2020 2073 656c 662e 7265 6469 7265 6374     self.redirect
+00017780: 2822 222c 2022 3f68 2363 6322 290a 2020  ("", "?h#cc").  
+00017790: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
+000177a0: 650a 0a20 2020 2064 6566 2073 6574 636b  e..    def setck
+000177b0: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
+000177c0: 2020 6b2c 2076 203d 2073 656c 662e 7570    k, v = self.up
+000177d0: 6172 616d 5b22 7365 7463 6b22 5d2e 7370  aram["setck"].sp
+000177e0: 6c69 7428 223d 222c 2031 290a 2020 2020  lit("=", 1).    
+000177f0: 2020 2020 7420 3d20 4e6f 6e65 2069 6620      t = None if 
+00017800: 7620 3d3d 2022 2220 656c 7365 2038 3634  v == "" else 864
+00017810: 3030 202a 2032 3939 0a20 2020 2020 2020  00 * 299.       
+00017820: 2063 6b20 3d20 6765 6e63 6f6f 6b69 6528   ck = gencookie(
+00017830: 6b2c 2076 2c20 7365 6c66 2e61 7267 732e  k, v, self.args.
+00017840: 522c 2046 616c 7365 2c20 7429 0a20 2020  R, False, t).   
+00017850: 2020 2020 2073 656c 662e 6f75 745f 6865       self.out_he
+00017860: 6164 6572 6c69 7374 2e61 7070 656e 6428  aderlist.append(
+00017870: 2822 5365 742d 436f 6f6b 6965 222c 2063  ("Set-Cookie", c
+00017880: 6b29 290a 2020 2020 2020 2020 7365 6c66  k)).        self
+00017890: 2e72 6570 6c79 2862 226f 375c 6e22 290a  .reply(b"o7\n").
+000178a0: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+000178b0: 7275 650a 0a20 2020 2064 6566 2073 6574  rue..    def set
+000178c0: 5f63 6667 5f72 6573 6574 2873 656c 6629  _cfg_reset(self)
+000178d0: 2020 3a0a 2020 2020 2020 2020 666f 7220    :.        for 
+000178e0: 6b20 696e 2028 226b 3330 3422 2c20 226a  k in ("k304", "j
+000178f0: 7322 2c20 2269 6478 6822 2c20 2263 7070  s", "idxh", "cpp
+00017900: 7764 222c 2022 6370 7077 7322 293a 0a20  wd", "cppws"):. 
+00017910: 2020 2020 2020 2020 2020 2063 6f6f 6b69             cooki
+00017920: 6520 3d20 6765 6e63 6f6f 6b69 6528 6b2c  e = gencookie(k,
+00017930: 2022 7822 2c20 7365 6c66 2e61 7267 732e   "x", self.args.
+00017940: 522c 2046 616c 7365 2c20 4e6f 6e65 290a  R, False, None).
+00017950: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00017960: 2e6f 7574 5f68 6561 6465 726c 6973 742e  .out_headerlist.
+00017970: 6170 7065 6e64 2828 2253 6574 2d43 6f6f  append(("Set-Coo
+00017980: 6b69 6522 2c20 636f 6f6b 6965 2929 0a0a  kie", cookie))..
+00017990: 2020 2020 2020 2020 7365 6c66 2e72 6564          self.red
+000179a0: 6972 6563 7428 2222 2c20 223f 6823 6363  irect("", "?h#cc
+000179b0: 2229 0a20 2020 2020 2020 2072 6574 7572  ").        retur
+000179c0: 6e20 5472 7565 0a0a 2020 2020 6465 6620  n True..    def 
+000179d0: 7478 5f34 3034 2873 656c 662c 2069 735f  tx_404(self, is_
+000179e0: 3430 3320 203d 2046 616c 7365 2920 203a  403  = False)  :
+000179f0: 0a20 2020 2020 2020 2072 6320 3d20 3430  .        rc = 40
+00017a00: 340a 2020 2020 2020 2020 6966 2073 656c  4.        if sel
+00017a10: 662e 6172 6773 2e76 6167 7565 5f34 3033  f.args.vague_403
+00017a20: 3a0a 2020 2020 2020 2020 2020 2020 7420  :.            t 
+00017a30: 3d20 273c 6831 2069 643d 226e 223e 3430  = '<h1 id="n">40
+00017a40: 3420 6e6f 7420 666f 756e 6420 266e 6273  4 not found &nbs
+00017a50: 703b e294 9028 20c2 b420 2d60 29e2 948c  p;...( .. -`)...
+00017a60: 3c2f 6831 3e3c 7020 6964 3d22 6f22 3e6f  </h1><p id="o">o
+00017a70: 7220 6d61 7962 6520 796f 7520 646f 6e5c  r maybe you don\
+00017a80: 2774 2068 6176 6520 6163 6365 7373 202d  't have access -
+00017a90: 2d20 7472 7920 6c6f 6767 696e 6720 696e  - try logging in
+00017aa0: 206f 7220 3c61 2068 7265 663d 227b 7d2f   or <a href="{}/
+00017ab0: 3f68 223e 676f 2068 6f6d 653c 2f61 3e3c  ?h">go home</a><
+00017ac0: 2f70 3e27 0a20 2020 2020 2020 2065 6c69  /p>'.        eli
+00017ad0: 6620 6973 5f34 3033 3a0a 2020 2020 2020  f is_403:.      
+00017ae0: 2020 2020 2020 7420 3d20 273c 6831 2069        t = '<h1 i
+00017af0: 643d 2270 223e 3430 3320 666f 7262 6964  d="p">403 forbid
+00017b00: 6465 6e61 2026 6e62 7370 3b7e e294 bbe2  dena &nbsp;~....
+00017b10: 9481 e294 bb3c 2f68 313e 3c70 2069 643d  .....</h1><p id=
+00017b20: 2271 223e 796f 755c 276c 6c20 6861 7665  "q">you\'ll have
+00017b30: 2074 6f20 6c6f 6720 696e 206f 7220 3c61   to log in or <a
+00017b40: 2068 7265 663d 227b 7d2f 3f68 223e 676f   href="{}/?h">go
+00017b50: 2068 6f6d 653c 2f61 3e3c 2f70 3e27 0a20   home</a></p>'. 
+00017b60: 2020 2020 2020 2020 2020 2072 6320 3d20             rc = 
+00017b70: 3430 330a 2020 2020 2020 2020 656c 7365  403.        else
+00017b80: 3a0a 2020 2020 2020 2020 2020 2020 7420  :.            t 
+00017b90: 3d20 273c 6831 2069 643d 226e 223e 3430  = '<h1 id="n">40
+00017ba0: 3420 6e6f 7420 666f 756e 6420 266e 6273  4 not found &nbs
+00017bb0: 703b e294 9028 20c2 b420 2d60 29e2 948c  p;...( .. -`)...
+00017bc0: 3c2f 6831 3e3c 703e 3c61 2069 643d 2272  </h1><p><a id="r
+00017bd0: 2220 6872 6566 3d22 7b7d 2f3f 6822 3e67  " href="{}/?h">g
+00017be0: 6f20 686f 6d65 3c2f 613e 3c2f 703e 270a  o home</a></p>'.
+00017bf0: 0a20 2020 2020 2020 2074 203d 2074 2e66  .        t = t.f
+00017c00: 6f72 6d61 7428 7365 6c66 2e61 7267 732e  ormat(self.args.
+00017c10: 5352 290a 2020 2020 2020 2020 6874 6d6c  SR).        html
+00017c20: 203d 2073 656c 662e 6a32 7328 2273 706c   = self.j2s("spl
+00017c30: 6173 6822 2c20 7468 6973 3d73 656c 662c  ash", this=self,
+00017c40: 2071 7670 6174 683d 7175 6f74 6570 2873   qvpath=quotep(s
+00017c50: 656c 662e 7670 6174 6829 2c20 6d73 673d  elf.vpath), msg=
+00017c60: 7429 0a20 2020 2020 2020 2073 656c 662e  t).        self.
+00017c70: 7265 706c 7928 6874 6d6c 2e65 6e63 6f64  reply(html.encod
+00017c80: 6528 2275 7466 2d38 2229 2c20 7374 6174  e("utf-8"), stat
+00017c90: 7573 3d72 6329 0a20 2020 2020 2020 2072  us=rc).        r
+00017ca0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00017cb0: 6465 6620 7363 616e 766f 6c28 7365 6c66  def scanvol(self
+00017cc0: 2920 203a 0a20 2020 2020 2020 2069 6620  )  :.        if 
+00017cd0: 6e6f 7420 7365 6c66 2e63 616e 5f72 6561  not self.can_rea
+00017ce0: 6420 6f72 206e 6f74 2073 656c 662e 6361  d or not self.ca
+00017cf0: 6e5f 7772 6974 653a 0a20 2020 2020 2020  n_write:.       
+00017d00: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
+00017d10: 6328 3430 332c 2022 6e6f 7420 616c 6c6f  c(403, "not allo
+00017d20: 7765 6420 666f 7220 7573 6572 2022 202b  wed for user " +
+00017d30: 2073 656c 662e 756e 616d 6529 0a0a 2020   self.uname)..  
+00017d40: 2020 2020 2020 6966 2073 656c 662e 6172        if self.ar
+00017d50: 6773 2e6e 6f5f 7265 7363 616e 3a0a 2020  gs.no_rescan:.  
+00017d60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00017d70: 5065 626b 6163 2834 3033 2c20 2274 6865  Pebkac(403, "the
+00017d80: 2072 6573 6361 6e20 6665 6174 7572 6520   rescan feature 
+00017d90: 6973 2064 6973 6162 6c65 6420 696e 2073  is disabled in s
+00017da0: 6572 7665 7220 636f 6e66 6967 2229 0a0a  erver config")..
+00017db0: 2020 2020 2020 2020 766e 2c20 5f20 3d20          vn, _ = 
+00017dc0: 7365 6c66 2e61 7372 762e 7666 732e 6765  self.asrv.vfs.ge
+00017dd0: 7428 7365 6c66 2e76 7061 7468 2c20 7365  t(self.vpath, se
+00017de0: 6c66 2e75 6e61 6d65 2c20 5472 7565 2c20  lf.uname, True, 
+00017df0: 5472 7565 290a 0a20 2020 2020 2020 2061  True)..        a
+00017e00: 7267 7320 3d20 5b73 656c 662e 6173 7276  rgs = [self.asrv
+00017e10: 2e76 6673 2e61 6c6c 5f76 6f6c 732c 205b  .vfs.all_vols, [
+00017e20: 766e 2e76 7061 7468 5d2c 2046 616c 7365  vn.vpath], False
+00017e30: 2c20 5472 7565 5d0a 0a20 2020 2020 2020  , True]..       
+00017e40: 2078 203d 2073 656c 662e 636f 6e6e 2e68   x = self.conn.h
+00017e50: 7372 762e 6272 6f6b 6572 2e61 736b 2822  srv.broker.ask("
+00017e60: 7570 326b 2e72 6573 6361 6e22 2c20 2a61  up2k.rescan", *a
+00017e70: 7267 7329 0a20 2020 2020 2020 2065 7272  rgs).        err
+00017e80: 203d 2078 2e67 6574 2829 0a20 2020 2020   = x.get().     
+00017e90: 2020 2069 6620 6e6f 7420 6572 723a 0a20     if not err:. 
+00017ea0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00017eb0: 7265 6469 7265 6374 2822 222c 2022 3f68  redirect("", "?h
+00017ec0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00017ed0: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00017ee0: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+00017ef0: 2835 3030 2c20 6572 7229 0a0a 2020 2020  (500, err)..    
+00017f00: 6465 6620 6861 6e64 6c65 5f72 656c 6f61  def handle_reloa
+00017f10: 6428 7365 6c66 2920 203a 0a20 2020 2020  d(self)  :.     
+00017f20: 2020 2061 6374 203d 2073 656c 662e 7570     act = self.up
+00017f30: 6172 616d 2e67 6574 2822 7265 6c6f 6164  aram.get("reload
+00017f40: 2229 0a20 2020 2020 2020 2069 6620 6163  ").        if ac
+00017f50: 7420 213d 2022 6366 6722 3a0a 2020 2020  t != "cfg":.    
+00017f60: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
+00017f70: 626b 6163 2834 3030 2c20 226f 6e6c 7920  bkac(400, "only 
+00017f80: 636f 6e66 6967 2066 696c 6573 2028 2763  config files ('c
+00017f90: 6667 2729 2063 616e 2062 6520 7265 6c6f  fg') can be relo
+00017fa0: 6164 6564 2072 6e22 290a 0a20 2020 2020  aded rn")..     
+00017fb0: 2020 2069 6620 6e6f 7420 5b78 2066 6f72     if not [x for
+00017fc0: 2078 2069 6e20 7365 6c66 2e77 766f 6c20   x in self.wvol 
+00017fd0: 6966 2078 2069 6e20 7365 6c66 2e72 766f  if x in self.rvo
+00017fe0: 6c5d 3a0a 2020 2020 2020 2020 2020 2020  l]:.            
+00017ff0: 7261 6973 6520 5065 626b 6163 2834 3033  raise Pebkac(403
+00018000: 2c20 226e 6f74 2061 6c6c 6f77 6564 2066  , "not allowed f
+00018010: 6f72 2075 7365 7220 2220 2b20 7365 6c66  or user " + self
+00018020: 2e75 6e61 6d65 290a 0a20 2020 2020 2020  .uname)..       
+00018030: 2069 6620 7365 6c66 2e61 7267 732e 6e6f   if self.args.no
+00018040: 5f72 656c 6f61 643a 0a20 2020 2020 2020  _reload:.       
+00018050: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
+00018060: 6328 3430 332c 2022 7468 6520 7265 6c6f  c(403, "the relo
+00018070: 6164 2066 6561 7475 7265 2069 7320 6469  ad feature is di
+00018080: 7361 626c 6564 2069 6e20 7365 7276 6572  sabled in server
+00018090: 2063 6f6e 6669 6722 290a 0a20 2020 2020   config")..     
+000180a0: 2020 2078 203d 2073 656c 662e 636f 6e6e     x = self.conn
+000180b0: 2e68 7372 762e 6272 6f6b 6572 2e61 736b  .hsrv.broker.ask
+000180c0: 2822 7265 6c6f 6164 2229 0a20 2020 2020  ("reload").     
+000180d0: 2020 2072 6574 7572 6e20 7365 6c66 2e72     return self.r
+000180e0: 6564 6972 6563 7428 2222 2c20 223f 6822  edirect("", "?h"
+000180f0: 2c20 782e 6765 7428 292c 2022 7265 7475  , x.get(), "retu
+00018100: 726e 2074 6f22 2c20 4661 6c73 6529 0a0a  rn to", False)..
+00018110: 2020 2020 6465 6620 7478 5f73 7461 636b      def tx_stack
+00018120: 2873 656c 6629 2020 3a0a 2020 2020 2020  (self)  :.      
+00018130: 2020 6966 206e 6f74 205b 7820 666f 7220    if not [x for 
+00018140: 7820 696e 2073 656c 662e 7776 6f6c 2069  x in self.wvol i
+00018150: 6620 7820 696e 2073 656c 662e 7276 6f6c  f x in self.rvol
+00018160: 5d3a 0a20 2020 2020 2020 2020 2020 2072  ]:.            r
+00018170: 6169 7365 2050 6562 6b61 6328 3430 332c  aise Pebkac(403,
+00018180: 2022 6e6f 7420 616c 6c6f 7765 6420 666f   "not allowed fo
+00018190: 7220 7573 6572 2022 202b 2073 656c 662e  r user " + self.
+000181a0: 756e 616d 6529 0a0a 2020 2020 2020 2020  uname)..        
+000181b0: 6966 2073 656c 662e 6172 6773 2e6e 6f5f  if self.args.no_
+000181c0: 7374 6163 6b3a 0a20 2020 2020 2020 2020  stack:.         
+000181d0: 2020 2072 6169 7365 2050 6562 6b61 6328     raise Pebkac(
+000181e0: 3430 332c 2022 7468 6520 7374 6163 6b64  403, "the stackd
+000181f0: 756d 7020 6665 6174 7572 6520 6973 2064  ump feature is d
+00018200: 6973 6162 6c65 6420 696e 2073 6572 7665  isabled in serve
+00018210: 7220 636f 6e66 6967 2229 0a0a 2020 2020  r config")..    
+00018220: 2020 2020 7265 7420 3d20 223c 7072 653e      ret = "<pre>
+00018230: 7b7d 5c6e 7b7d 222e 666f 726d 6174 2874  {}\n{}".format(t
+00018240: 696d 652e 7469 6d65 2829 2c20 6874 6d6c  ime.time(), html
+00018250: 5f65 7363 6170 6528 616c 6c74 7261 6365  _escape(alltrace
+00018260: 2829 2929 0a20 2020 2020 2020 2073 656c  ())).        sel
+00018270: 662e 7265 706c 7928 7265 742e 656e 636f  f.reply(ret.enco
+00018280: 6465 2822 7574 662d 3822 2929 0a20 2020  de("utf-8")).   
+00018290: 2020 2020 2072 6574 7572 6e20 5472 7565       return True
+000182a0: 0a0a 2020 2020 6465 6620 7478 5f74 7265  ..    def tx_tre
+000182b0: 6528 7365 6c66 2920 203a 0a20 2020 2020  e(self)  :.     
+000182c0: 2020 2074 6f70 203d 2073 656c 662e 7570     top = self.up
+000182d0: 6172 616d 5b22 7472 6565 225d 206f 7220  aram["tree"] or 
+000182e0: 2222 0a20 2020 2020 2020 2064 7374 203d  "".        dst =
+000182f0: 2073 656c 662e 7670 6174 680a 2020 2020   self.vpath.    
+00018300: 2020 2020 6966 2074 6f70 2069 6e20 5b22      if top in ["
+00018310: 2e22 2c20 222e 2e22 5d3a 0a20 2020 2020  .", ".."]:.     
+00018320: 2020 2020 2020 2074 6f70 203d 2075 6e64         top = und
+00018330: 6f74 2873 656c 662e 7670 6174 6820 2b20  ot(self.vpath + 
+00018340: 222f 2220 2b20 746f 7029 0a0a 2020 2020  "/" + top)..    
+00018350: 2020 2020 6966 2074 6f70 203d 3d20 6473      if top == ds
+00018360: 743a 0a20 2020 2020 2020 2020 2020 2064  t:.            d
+00018370: 7374 203d 2022 220a 2020 2020 2020 2020  st = "".        
+00018380: 656c 6966 2074 6f70 3a0a 2020 2020 2020  elif top:.      
+00018390: 2020 2020 2020 6966 206e 6f74 2064 7374        if not dst
+000183a0: 2e73 7461 7274 7377 6974 6828 746f 7020  .startswith(top 
+000183b0: 2b20 222f 2229 3a0a 2020 2020 2020 2020  + "/"):.        
+000183c0: 2020 2020 2020 2020 7261 6973 6520 5065          raise Pe
+000183d0: 626b 6163 2834 3030 2c20 2261 7267 2066  bkac(400, "arg f
+000183e0: 756e 6b22 290a 0a20 2020 2020 2020 2020  unk")..         
+000183f0: 2020 2064 7374 203d 2064 7374 5b6c 656e     dst = dst[len
+00018400: 2874 6f70 2920 2b20 3120 3a5d 0a0a 2020  (top) + 1 :]..  
+00018410: 2020 2020 2020 7265 7420 3d20 7365 6c66        ret = self
+00018420: 2e67 656e 5f74 7265 6528 746f 702c 2064  .gen_tree(top, d
+00018430: 7374 290a 2020 2020 2020 2020 6966 2073  st).        if s
+00018440: 656c 662e 6973 5f76 7072 6f78 6965 643a  elf.is_vproxied:
+00018450: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00018460: 656e 7473 203d 2073 656c 662e 6172 6773  ents = self.args
+00018470: 2e52 2e73 706c 6974 2822 2f22 290a 2020  .R.split("/").  
+00018480: 2020 2020 2020 2020 2020 666f 7220 7061            for pa
+00018490: 7265 6e74 2069 6e20 7265 7665 7273 6564  rent in reversed
+000184a0: 2870 6172 656e 7473 293a 0a20 2020 2020  (parents):.     
+000184b0: 2020 2020 2020 2020 2020 2072 6574 203d             ret =
+000184c0: 207b 226b 2573 2220 2520 2870 6172 656e   {"k%s" % (paren
+000184d0: 742c 293a 2072 6574 2c20 2261 223a 205b  t,): ret, "a": [
+000184e0: 5d7d 0a0a 2020 2020 2020 2020 7a73 203d  ]}..        zs =
+000184f0: 206a 736f 6e2e 6475 6d70 7328 7265 7429   json.dumps(ret)
+00018500: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
+00018510: 706c 7928 7a73 2e65 6e63 6f64 6528 2275  ply(zs.encode("u
+00018520: 7466 2d38 2229 2c20 6d69 6d65 3d22 6170  tf-8"), mime="ap
+00018530: 706c 6963 6174 696f 6e2f 6a73 6f6e 2229  plication/json")
+00018540: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018550: 5472 7565 0a0a 2020 2020 6465 6620 6765  True..    def ge
+00018560: 6e5f 7472 6565 2873 656c 662c 2074 6f70  n_tree(self, top
+00018570: 202c 2074 6172 6765 7420 2920 2020 3a0a   , target )   :.
+00018580: 2020 2020 2020 2020 7265 7420 2020 3d20          ret   = 
+00018590: 7b7d 0a20 2020 2020 2020 2065 7863 6c20  {}.        excl 
+000185a0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2069  = None.        i
+000185b0: 6620 7461 7267 6574 3a0a 2020 2020 2020  f target:.      
+000185c0: 2020 2020 2020 6578 636c 2c20 7461 7267        excl, targ
+000185d0: 6574 203d 2028 7461 7267 6574 2e73 706c  et = (target.spl
+000185e0: 6974 2822 2f22 2c20 3129 202b 205b 2222  it("/", 1) + [""
+000185f0: 5d29 5b3a 325d 0a20 2020 2020 2020 2020  ])[:2].         
+00018600: 2020 2073 7562 203d 2073 656c 662e 6765     sub = self.ge
+00018610: 6e5f 7472 6565 2822 2f22 2e6a 6f69 6e28  n_tree("/".join(
+00018620: 5b74 6f70 2c20 6578 636c 5d29 2e73 7472  [top, excl]).str
+00018630: 6970 2822 2f22 292c 2074 6172 6765 7429  ip("/"), target)
+00018640: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00018650: 5b22 6b22 202b 2071 756f 7465 7028 6578  ["k" + quotep(ex
+00018660: 636c 295d 203d 2073 7562 0a0a 2020 2020  cl)] = sub..    
+00018670: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00018680: 2020 2020 2076 6e2c 2072 656d 203d 2073       vn, rem = s
+00018690: 656c 662e 6173 7276 2e76 6673 2e67 6574  elf.asrv.vfs.get
+000186a0: 2874 6f70 2c20 7365 6c66 2e75 6e61 6d65  (top, self.uname
+000186b0: 2c20 5472 7565 2c20 4661 6c73 6529 0a20  , True, False). 
+000186c0: 2020 2020 2020 2020 2020 2066 7372 6f6f             fsroo
+000186d0: 742c 2076 6673 5f6c 732c 2076 6673 5f76  t, vfs_ls, vfs_v
+000186e0: 6972 7420 3d20 766e 2e6c 7328 0a20 2020  irt = vn.ls(.   
+000186f0: 2020 2020 2020 2020 2020 2020 2072 656d               rem
+00018700: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018710: 2020 7365 6c66 2e75 6e61 6d65 2c0a 2020    self.uname,.  
+00018720: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00018730: 7420 7365 6c66 2e61 7267 732e 6e6f 5f73  t self.args.no_s
+00018740: 6361 6e64 6972 2c0a 2020 2020 2020 2020  candir,.        
+00018750: 2020 2020 2020 2020 5b5b 5472 7565 2c20          [[True, 
+00018760: 4661 6c73 655d 2c20 5b46 616c 7365 2c20  False], [False, 
+00018770: 5472 7565 5d5d 2c0a 2020 2020 2020 2020  True]],.        
+00018780: 2020 2020 290a 2020 2020 2020 2020 6578      ).        ex
+00018790: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
+000187a0: 2020 7666 735f 6c73 203d 205b 5d0a 2020    vfs_ls = [].  
+000187b0: 2020 2020 2020 2020 2020 7666 735f 7669            vfs_vi
+000187c0: 7274 203d 207b 7d0a 2020 2020 2020 2020  rt = {}.        
+000187d0: 2020 2020 666f 7220 7620 696e 2073 656c      for v in sel
+000187e0: 662e 7276 6f6c 3a0a 2020 2020 2020 2020  f.rvol:.        
+000187f0: 2020 2020 2020 2020 6431 2c20 6432 203d          d1, d2 =
+00018800: 2076 2e72 7370 6c69 7428 222f 222c 2031   v.rsplit("/", 1
+00018810: 2920 6966 2022 2f22 2069 6e20 7620 656c  ) if "/" in v el
+00018820: 7365 205b 2222 2c20 765d 0a20 2020 2020  se ["", v].     
+00018830: 2020 2020 2020 2020 2020 2069 6620 6431             if d1
+00018840: 203d 3d20 746f 703a 0a20 2020 2020 2020   == top:.       
+00018850: 2020 2020 2020 2020 2020 2020 2076 6673               vfs
+00018860: 5f76 6972 745b 6432 5d20 3d20 7365 6c66  _virt[d2] = self
+00018870: 2e61 7372 762e 7666 7320 2023 2074 7970  .asrv.vfs  # typ
+00018880: 6563 686b 2c20 7661 6c75 6520 6e65 7665  echk, value neve
+00018890: 7220 7265 6164 0a0a 2020 2020 2020 2020  r read..        
+000188a0: 6469 7273 203d 205b 5d0a 0a20 2020 2020  dirs = []..     
+000188b0: 2020 2064 6972 6e61 6d65 7320 3d20 5b78     dirnames = [x
+000188c0: 5b30 5d20 666f 7220 7820 696e 2076 6673  [0] for x in vfs
+000188d0: 5f6c 7320 6966 2073 7461 742e 535f 4953  _ls if stat.S_IS
+000188e0: 4449 5228 785b 315d 2e73 745f 6d6f 6465  DIR(x[1].st_mode
+000188f0: 295d 0a0a 2020 2020 2020 2020 6966 206e  )]..        if n
+00018900: 6f74 2073 656c 662e 6172 6773 2e65 6420  ot self.args.ed 
+00018910: 6f72 2022 646f 7473 2220 6e6f 7420 696e  or "dots" not in
+00018920: 2073 656c 662e 7570 6172 616d 3a0a 2020   self.uparam:.  
+00018930: 2020 2020 2020 2020 2020 6469 726e 616d            dirnam
+00018940: 6573 203d 2065 7863 6c75 6465 5f64 6f74  es = exclude_dot
+00018950: 6669 6c65 7328 6469 726e 616d 6573 290a  files(dirnames).
+00018960: 0a20 2020 2020 2020 2066 6f72 2066 6e20  .        for fn 
+00018970: 696e 205b 7820 666f 7220 7820 696e 2064  in [x for x in d
+00018980: 6972 6e61 6d65 7320 6966 2078 2021 3d20  irnames if x != 
+00018990: 6578 636c 5d3a 0a20 2020 2020 2020 2020  excl]:.         
+000189a0: 2020 2064 6972 732e 6170 7065 6e64 2871     dirs.append(q
+000189b0: 756f 7465 7028 666e 2929 0a0a 2020 2020  uotep(fn))..    
+000189c0: 2020 2020 666f 7220 7820 696e 2076 6673      for x in vfs
+000189d0: 5f76 6972 743a 0a20 2020 2020 2020 2020  _virt:.         
+000189e0: 2020 2069 6620 7820 213d 2065 7863 6c3a     if x != excl:
+000189f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018a00: 2064 6972 732e 6170 7065 6e64 2878 290a   dirs.append(x).
+00018a10: 0a20 2020 2020 2020 2072 6574 5b22 6122  .        ret["a"
+00018a20: 5d20 3d20 6469 7273 0a20 2020 2020 2020  ] = dirs.       
+00018a30: 2072 6574 7572 6e20 7265 740a 0a20 2020   return ret..   
+00018a40: 2064 6566 2074 785f 7570 7328 7365 6c66   def tx_ups(self
+00018a50: 2920 203a 0a20 2020 2020 2020 2069 6620  )  :.        if 
+00018a60: 6e6f 7420 7365 6c66 2e61 7267 732e 756e  not self.args.un
+00018a70: 706f 7374 3a0a 2020 2020 2020 2020 2020  post:.          
+00018a80: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+00018a90: 3033 2c20 2274 6865 2075 6e70 6f73 7420  03, "the unpost 
+00018aa0: 6665 6174 7572 6520 6973 2064 6973 6162  feature is disab
+00018ab0: 6c65 6420 696e 2073 6572 7665 7220 636f  led in server co
+00018ac0: 6e66 6967 2229 0a0a 2020 2020 2020 2020  nfig")..        
+00018ad0: 6964 7820 3d20 7365 6c66 2e63 6f6e 6e2e  idx = self.conn.
+00018ae0: 6765 745f 7532 6964 7828 290a 2020 2020  get_u2idx().    
+00018af0: 2020 2020 6966 206e 6f74 2069 6478 206f      if not idx o
+00018b00: 7220 6e6f 7420 6861 7361 7474 7228 6964  r not hasattr(id
+00018b10: 782c 2022 705f 656e 6422 293a 0a20 2020  x, "p_end"):.   
+00018b20: 2020 2020 2020 2020 2072 6169 7365 2050           raise P
+00018b30: 6562 6b61 6328 3530 302c 2022 7371 6c69  ebkac(500, "sqli
+00018b40: 7465 3320 6973 206e 6f74 2061 7661 696c  te3 is not avail
+00018b50: 6162 6c65 206f 6e20 7468 6520 7365 7276  able on the serv
+00018b60: 6572 3b20 6361 6e6e 6f74 2075 6e70 6f73  er; cannot unpos
+00018b70: 7422 290a 0a20 2020 2020 2020 2066 696c  t")..        fil
+00018b80: 7420 3d20 7365 6c66 2e75 7061 7261 6d2e  t = self.uparam.
+00018b90: 6765 7428 2266 696c 7465 7222 290a 2020  get("filter").  
+00018ba0: 2020 2020 2020 6669 6c74 203d 2075 6e71        filt = unq
+00018bb0: 756f 7465 7028 6669 6c74 206f 7220 2222  uotep(filt or ""
+00018bc0: 290a 2020 2020 2020 2020 6c6d 203d 2022  ).        lm = "
+00018bd0: 7570 7320 5b7b 7d5d 222e 666f 726d 6174  ups [{}]".format
+00018be0: 2866 696c 7429 0a20 2020 2020 2020 2073  (filt).        s
+00018bf0: 656c 662e 6c6f 6728 6c6d 290a 0a20 2020  elf.log(lm)..   
+00018c00: 2020 2020 2072 6574 2020 203d 205b 5d0a       ret   = [].
+00018c10: 2020 2020 2020 2020 7430 203d 2074 696d          t0 = tim
+00018c20: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+00018c30: 206c 696d 203d 2074 696d 652e 7469 6d65   lim = time.time
+00018c40: 2829 202d 2073 656c 662e 6172 6773 2e75  () - self.args.u
+00018c50: 6e70 6f73 740a 2020 2020 2020 2020 666b  npost.        fk
+00018c60: 5f76 6f6c 7320 3d20 7b0a 2020 2020 2020  _vols = {.      
+00018c70: 2020 2020 2020 766f 6c3a 2076 6f6c 2e66        vol: vol.f
+00018c80: 6c61 6773 5b22 666b 225d 0a20 2020 2020  lags["fk"].     
+00018c90: 2020 2020 2020 2066 6f72 2076 702c 2076         for vp, v
+00018ca0: 6f6c 2069 6e20 7365 6c66 2e61 7372 762e  ol in self.asrv.
+00018cb0: 7666 732e 616c 6c5f 766f 6c73 2e69 7465  vfs.all_vols.ite
+00018cc0: 6d73 2829 0a20 2020 2020 2020 2020 2020  ms().           
+00018cd0: 2069 6620 2266 6b22 2069 6e20 766f 6c2e   if "fk" in vol.
+00018ce0: 666c 6167 7320 616e 6420 2876 7020 696e  flags and (vp in
+00018cf0: 2073 656c 662e 7276 6f6c 206f 7220 7670   self.rvol or vp
+00018d00: 2069 6e20 7365 6c66 2e75 7076 6f6c 290a   in self.upvol).
+00018d10: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00018d20: 2020 666f 7220 766f 6c20 696e 2073 656c    for vol in sel
+00018d30: 662e 6173 7276 2e76 6673 2e61 6c6c 5f76  f.asrv.vfs.all_v
+00018d40: 6f6c 732e 7661 6c75 6573 2829 3a0a 2020  ols.values():.  
+00018d50: 2020 2020 2020 2020 2020 6375 7220 3d20            cur = 
+00018d60: 6964 782e 6765 745f 6375 7228 766f 6c2e  idx.get_cur(vol.
+00018d70: 7265 616c 7061 7468 290a 2020 2020 2020  realpath).      
+00018d80: 2020 2020 2020 6966 206e 6f74 2063 7572        if not cur
+00018d90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00018da0: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
+00018db0: 2020 2020 2020 2020 6e66 6b20 3d20 666b          nfk = fk
+00018dc0: 5f76 6f6c 732e 6765 7428 766f 6c2c 2030  _vols.get(vol, 0
+00018dd0: 290a 0a20 2020 2020 2020 2020 2020 2071  )..            q
+00018de0: 203d 2022 7365 6c65 6374 2073 7a2c 2072   = "select sz, r
+00018df0: 642c 2066 6e2c 2061 7420 6672 6f6d 2075  d, fn, at from u
+00018e00: 7020 7768 6572 6520 6970 3d3f 2061 6e64  p where ip=? and
+00018e10: 2061 743e 3f22 0a20 2020 2020 2020 2020   at>?".         
+00018e20: 2020 2066 6f72 2073 7a2c 2072 642c 2066     for sz, rd, f
+00018e30: 6e2c 2061 7420 696e 2063 7572 2e65 7865  n, at in cur.exe
+00018e40: 6375 7465 2871 2c20 2873 656c 662e 6970  cute(q, (self.ip
+00018e50: 2c20 6c69 6d29 293a 0a20 2020 2020 2020  , lim)):.       
+00018e60: 2020 2020 2020 2020 2076 7020 3d20 222f           vp = "/
+00018e70: 2220 2b20 222f 222e 6a6f 696e 2878 2066  " + "/".join(x f
+00018e80: 6f72 2078 2069 6e20 5b76 6f6c 2e76 7061  or x in [vol.vpa
+00018e90: 7468 2c20 7264 2c20 666e 5d20 6966 2078  th, rd, fn] if x
+00018ea0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00018eb0: 2020 6966 2066 696c 7420 616e 6420 6669    if filt and fi
+00018ec0: 6c74 206e 6f74 2069 6e20 7670 3a0a 2020  lt not in vp:.  
+00018ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018ee0: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
+00018ef0: 2020 2020 2020 2020 2020 2020 7276 203d              rv =
+00018f00: 207b 2276 7022 3a20 7175 6f74 6570 2876   {"vp": quotep(v
+00018f10: 7029 2c20 2273 7a22 3a20 737a 2c20 2261  p), "sz": sz, "a
+00018f20: 7422 3a20 6174 2c20 226e 666b 223a 206e  t": at, "nfk": n
+00018f30: 666b 7d0a 2020 2020 2020 2020 2020 2020  fk}.            
+00018f40: 2020 2020 6966 206e 666b 3a0a 2020 2020      if nfk:.    
+00018f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f60: 7276 5b22 6170 225d 203d 2076 6f6c 2e63  rv["ap"] = vol.c
+00018f70: 616e 6f6e 6963 616c 2876 6a6f 696e 2872  anonical(vjoin(r
+00018f80: 642c 2066 6e29 290a 0a20 2020 2020 2020  d, fn))..       
+00018f90: 2020 2020 2020 2020 2072 6574 2e61 7070           ret.app
+00018fa0: 656e 6428 7276 290a 2020 2020 2020 2020  end(rv).        
+00018fb0: 2020 2020 2020 2020 6966 206c 656e 2872          if len(r
+00018fc0: 6574 2920 3e20 3330 3030 3a0a 2020 2020  et) > 3000:.    
+00018fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018fe0: 7265 742e 736f 7274 286b 6579 3d6c 616d  ret.sort(key=lam
+00018ff0: 6264 6120 783a 2078 5b22 6174 225d 2c20  bda x: x["at"], 
+00019000: 7265 7665 7273 653d 5472 7565 2920 2023  reverse=True)  #
+00019010: 2074 7970 653a 2069 676e 6f72 650a 2020   type: ignore.  
+00019020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019030: 2020 7265 7420 3d20 7265 745b 3a32 3030    ret = ret[:200
+00019040: 305d 0a0a 2020 2020 2020 2020 7265 742e  0]..        ret.
+00019050: 736f 7274 286b 6579 3d6c 616d 6264 6120  sort(key=lambda 
+00019060: 783a 2078 5b22 6174 225d 2c20 7265 7665  x: x["at"], reve
+00019070: 7273 653d 5472 7565 2920 2023 2074 7970  rse=True)  # typ
+00019080: 653a 2069 676e 6f72 650a 2020 2020 2020  e: ignore.      
+00019090: 2020 6e20 3d20 300a 2020 2020 2020 2020    n = 0.        
+000190a0: 666f 7220 7276 2069 6e20 7265 745b 3a31  for rv in ret[:1
+000190b0: 3130 3030 5d3a 0a20 2020 2020 2020 2020  1000]:.         
+000190c0: 2020 206e 666b 203d 2072 762e 706f 7028     nfk = rv.pop(
+000190d0: 226e 666b 2229 0a20 2020 2020 2020 2020  "nfk").         
+000190e0: 2020 2069 6620 6e6f 7420 6e66 6b3a 0a20     if not nfk:. 
+000190f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00019100: 6f6e 7469 6e75 650a 0a20 2020 2020 2020  ontinue..       
+00019110: 2020 2020 2061 7020 3d20 7276 2e70 6f70       ap = rv.pop
+00019120: 2822 6170 2229 0a20 2020 2020 2020 2020  ("ap").         
+00019130: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00019140: 2020 2020 2020 2020 7374 203d 2062 6f73          st = bos
+00019150: 2e73 7461 7428 6170 290a 2020 2020 2020  .stat(ap).      
+00019160: 2020 2020 2020 6578 6365 7074 3a0a 2020        except:.  
+00019170: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00019180: 6e74 696e 7565 0a0a 2020 2020 2020 2020  ntinue..        
+00019190: 2020 2020 666b 203d 2073 656c 662e 6765      fk = self.ge
+000191a0: 6e5f 666b 280a 2020 2020 2020 2020 2020  n_fk(.          
+000191b0: 2020 2020 2020 7365 6c66 2e61 7267 732e        self.args.
+000191c0: 666b 5f73 616c 742c 2061 702c 2073 742e  fk_salt, ap, st.
+000191d0: 7374 5f73 697a 652c 2030 2069 6620 414e  st_size, 0 if AN
+000191e0: 5957 494e 2065 6c73 6520 7374 2e73 745f  YWIN else st.st_
+000191f0: 696e 6f0a 2020 2020 2020 2020 2020 2020  ino.            
+00019200: 290a 2020 2020 2020 2020 2020 2020 7276  ).            rv
+00019210: 5b22 7670 225d 202b 3d20 223f 6b3d 2220  ["vp"] += "?k=" 
+00019220: 2b20 666b 5b3a 6e66 6b5d 0a0a 2020 2020  + fk[:nfk]..    
+00019230: 2020 2020 2020 2020 6e20 2b3d 2031 0a20          n += 1. 
+00019240: 2020 2020 2020 2020 2020 2069 6620 6e20             if n 
+00019250: 3e20 3230 3030 3a0a 2020 2020 2020 2020  > 2000:.        
+00019260: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+00019270: 2020 2020 2020 2072 6574 203d 2072 6574         ret = ret
+00019280: 5b3a 3230 3030 5d0a 0a20 2020 2020 2020  [:2000]..       
+00019290: 2069 6620 7365 6c66 2e69 735f 7670 726f   if self.is_vpro
+000192a0: 7869 6564 3a0a 2020 2020 2020 2020 2020  xied:.          
+000192b0: 2020 666f 7220 7620 696e 2072 6574 3a0a    for v in ret:.
+000192c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192d0: 765b 2276 7022 5d20 3d20 7365 6c66 2e61  v["vp"] = self.a
+000192e0: 7267 732e 5352 202b 2076 5b22 7670 225d  rgs.SR + v["vp"]
+000192f0: 0a0a 2020 2020 2020 2020 6a74 7874 203d  ..        jtxt =
+00019300: 206a 736f 6e2e 6475 6d70 7328 7265 742c   json.dumps(ret,
+00019310: 2069 6e64 656e 743d 322c 2073 6f72 745f   indent=2, sort_
+00019320: 6b65 7973 3d54 7275 6529 2e65 6e63 6f64  keys=True).encod
+00019330: 6528 2275 7466 2d38 222c 2022 7265 706c  e("utf-8", "repl
+00019340: 6163 6522 290a 2020 2020 2020 2020 7365  ace").        se
+00019350: 6c66 2e6c 6f67 2822 7b7d 2023 7b7d 207b  lf.log("{} #{} {
+00019360: 3a2e 3266 7d73 6563 222e 666f 726d 6174  :.2f}sec".format
+00019370: 286c 6d2c 206c 656e 2872 6574 292c 2074  (lm, len(ret), t
+00019380: 696d 652e 7469 6d65 2829 202d 2074 3029  ime.time() - t0)
+00019390: 290a 2020 2020 2020 2020 7365 6c66 2e72  ).        self.r
+000193a0: 6570 6c79 286a 7478 742c 206d 696d 653d  eply(jtxt, mime=
+000193b0: 2261 7070 6c69 6361 7469 6f6e 2f6a 736f  "application/jso
+000193c0: 6e22 290a 2020 2020 2020 2020 7265 7475  n").        retu
+000193d0: 726e 2054 7275 650a 0a20 2020 2064 6566  rn True..    def
+000193e0: 2068 616e 646c 655f 726d 2873 656c 662c   handle_rm(self,
+000193f0: 2072 6571 2029 2020 3a0a 2020 2020 2020   req )  :.      
+00019400: 2020 6966 206e 6f74 2072 6571 2061 6e64    if not req and
+00019410: 206e 6f74 2073 656c 662e 6361 6e5f 6465   not self.can_de
+00019420: 6c65 7465 3a0a 2020 2020 2020 2020 2020  lete:.          
+00019430: 2020 7261 6973 6520 5065 626b 6163 2834    raise Pebkac(4
+00019440: 3033 2c20 226e 6f74 2061 6c6c 6f77 6564  03, "not allowed
+00019450: 2066 6f72 2075 7365 7220 2220 2b20 7365   for user " + se
+00019460: 6c66 2e75 6e61 6d65 290a 0a20 2020 2020  lf.uname)..     
+00019470: 2020 2069 6620 7365 6c66 2e61 7267 732e     if self.args.
+00019480: 6e6f 5f64 656c 3a0a 2020 2020 2020 2020  no_del:.        
+00019490: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+000194a0: 2834 3033 2c20 2274 6865 2064 656c 6574  (403, "the delet
+000194b0: 6520 6665 6174 7572 6520 6973 2064 6973  e feature is dis
+000194c0: 6162 6c65 6420 696e 2073 6572 7665 7220  abled in server 
+000194d0: 636f 6e66 6967 2229 0a0a 2020 2020 2020  config")..      
+000194e0: 2020 6966 206e 6f74 2072 6571 3a0a 2020    if not req:.  
+000194f0: 2020 2020 2020 2020 2020 7265 7120 3d20            req = 
+00019500: 5b73 656c 662e 7670 6174 685d 0a20 2020  [self.vpath].   
+00019510: 2020 2020 2065 6c69 6620 7365 6c66 2e69       elif self.i
+00019520: 735f 7670 726f 7869 6564 3a0a 2020 2020  s_vproxied:.    
+00019530: 2020 2020 2020 2020 7265 7120 3d20 5b78          req = [x
+00019540: 5b6c 656e 2873 656c 662e 6172 6773 2e53  [len(self.args.S
+00019550: 5229 203a 5d20 666f 7220 7820 696e 2072  R) :] for x in r
+00019560: 6571 5d0a 0a20 2020 2020 2020 206e 6c69  eq]..        nli
+00019570: 6d20 3d20 696e 7428 7365 6c66 2e75 7061  m = int(self.upa
+00019580: 7261 6d2e 6765 7428 226c 696d 2229 206f  ram.get("lim") o
+00019590: 7220 3029 0a20 2020 2020 2020 206c 696d  r 0).        lim
+000195a0: 203d 205b 6e6c 696d 2c20 6e6c 696d 5d20   = [nlim, nlim] 
+000195b0: 6966 206e 6c69 6d20 656c 7365 205b 5d0a  if nlim else [].
+000195c0: 0a20 2020 2020 2020 2078 203d 2073 656c  .        x = sel
+000195d0: 662e 636f 6e6e 2e68 7372 762e 6272 6f6b  f.conn.hsrv.brok
+000195e0: 6572 2e61 736b 280a 2020 2020 2020 2020  er.ask(.        
+000195f0: 2020 2020 2275 7032 6b2e 6861 6e64 6c65      "up2k.handle
+00019600: 5f72 6d22 2c20 7365 6c66 2e75 6e61 6d65  _rm", self.uname
+00019610: 2c20 7365 6c66 2e69 702c 2072 6571 2c20  , self.ip, req, 
+00019620: 6c69 6d2c 2046 616c 7365 0a20 2020 2020  lim, False.     
+00019630: 2020 2029 0a20 2020 2020 2020 2073 656c     ).        sel
+00019640: 662e 6c6f 7564 5f72 6570 6c79 2878 2e67  f.loud_reply(x.g
+00019650: 6574 2829 290a 2020 2020 2020 2020 7265  et()).        re
+00019660: 7475 726e 2054 7275 650a 0a20 2020 2064  turn True..    d
+00019670: 6566 2068 616e 646c 655f 6d76 2873 656c  ef handle_mv(sel
+00019680: 6629 2020 3a0a 2020 2020 2020 2020 2320  f)  :.        # 
+00019690: 6675 6c6c 2070 6174 6820 6f66 206e 6577  full path of new
+000196a0: 206c 6f63 2028 696e 636c 2066 696c 656e   loc (incl filen
+000196b0: 616d 6529 0a20 2020 2020 2020 2064 7374  ame).        dst
+000196c0: 203d 2073 656c 662e 7570 6172 616d 2e67   = self.uparam.g
+000196d0: 6574 2822 6d6f 7665 2229 0a0a 2020 2020  et("move")..    
+000196e0: 2020 2020 6966 2073 656c 662e 6973 5f76      if self.is_v
+000196f0: 7072 6f78 6965 6420 616e 6420 6473 7420  proxied and dst 
+00019700: 616e 6420 6473 742e 7374 6172 7473 7769  and dst.startswi
+00019710: 7468 2873 656c 662e 6172 6773 2e53 5229  th(self.args.SR)
+00019720: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
+00019730: 7420 3d20 6473 745b 6c65 6e28 7365 6c66  t = dst[len(self
+00019740: 2e61 7267 732e 5253 2920 3a5d 0a0a 2020  .args.RS) :]..  
+00019750: 2020 2020 2020 6966 206e 6f74 2064 7374        if not dst
+00019760: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00019770: 6973 6520 5065 626b 6163 2834 3030 2c20  ise Pebkac(400, 
+00019780: 226e 6565 6420 6473 7420 7670 6174 6822  "need dst vpath"
+00019790: 290a 0a20 2020 2020 2020 2023 2078 2d77  )..        # x-w
+000197a0: 7777 2d66 6f72 6d2d 7572 6c65 6e63 6f64  ww-form-urlencod
+000197b0: 6564 2028 7572 6c20 7175 6572 7920 7061  ed (url query pa
+000197c0: 7274 2920 7573 6573 0a20 2020 2020 2020  rt) uses.       
+000197d0: 2023 2065 6974 6865 7220 2b20 6f72 2025   # either + or %
+000197e0: 3230 2066 6f72 2030 7832 3020 736f 2068  20 for 0x20 so h
+000197f0: 616e 646c 6520 626f 7468 0a20 2020 2020  andle both.     
+00019800: 2020 2064 7374 203d 2075 6e71 756f 7465     dst = unquote
+00019810: 7028 6473 742e 7265 706c 6163 6528 222b  p(dst.replace("+
+00019820: 222c 2022 2022 2929 0a20 2020 2020 2020  ", " ")).       
+00019830: 2072 6574 7572 6e20 7365 6c66 2e5f 6d76   return self._mv
+00019840: 2873 656c 662e 7670 6174 682c 2064 7374  (self.vpath, dst
+00019850: 2e6c 7374 7269 7028 222f 2229 290a 0a20  .lstrip("/")).. 
+00019860: 2020 2064 6566 205f 6d76 2873 656c 662c     def _mv(self,
+00019870: 2076 7372 6320 2c20 7664 7374 2029 2020   vsrc , vdst )  
+00019880: 3a0a 2020 2020 2020 2020 6966 206e 6f74  :.        if not
+00019890: 2073 656c 662e 6361 6e5f 6d6f 7665 3a0a   self.can_move:.
+000198a0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000198b0: 6520 5065 626b 6163 2834 3033 2c20 226e  e Pebkac(403, "n
+000198c0: 6f74 2061 6c6c 6f77 6564 2066 6f72 2075  ot allowed for u
+000198d0: 7365 7220 2220 2b20 7365 6c66 2e75 6e61  ser " + self.una
+000198e0: 6d65 290a 0a20 2020 2020 2020 2069 6620  me)..        if 
+000198f0: 7365 6c66 2e61 7267 732e 6e6f 5f6d 763a  self.args.no_mv:
+00019900: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00019910: 7365 2050 6562 6b61 6328 3430 332c 2022  se Pebkac(403, "
+00019920: 7468 6520 7265 6e61 6d65 2f6d 6f76 6520  the rename/move 
+00019930: 6665 6174 7572 6520 6973 2064 6973 6162  feature is disab
+00019940: 6c65 6420 696e 2073 6572 7665 7220 636f  led in server co
+00019950: 6e66 6967 2229 0a0a 2020 2020 2020 2020  nfig")..        
+00019960: 7820 3d20 7365 6c66 2e63 6f6e 6e2e 6873  x = self.conn.hs
+00019970: 7276 2e62 726f 6b65 722e 6173 6b28 2275  rv.broker.ask("u
+00019980: 7032 6b2e 6861 6e64 6c65 5f6d 7622 2c20  p2k.handle_mv", 
+00019990: 7365 6c66 2e75 6e61 6d65 2c20 7673 7263  self.uname, vsrc
+000199a0: 2c20 7664 7374 290a 2020 2020 2020 2020  , vdst).        
+000199b0: 7365 6c66 2e6c 6f75 645f 7265 706c 7928  self.loud_reply(
+000199c0: 782e 6765 7428 292c 2073 7461 7475 733d  x.get(), status=
+000199d0: 3230 3129 0a20 2020 2020 2020 2072 6574  201).        ret
+000199e0: 7572 6e20 5472 7565 0a0a 2020 2020 6465  urn True..    de
+000199f0: 6620 7478 5f6c 7328 7365 6c66 2c20 6c73  f tx_ls(self, ls
+00019a00: 2020 2920 203a 0a20 2020 2020 2020 2064    )  :.        d
+00019a10: 6972 7320 3d20 6c73 5b22 6469 7273 225d  irs = ls["dirs"]
+00019a20: 0a20 2020 2020 2020 2066 696c 6573 203d  .        files =
+00019a30: 206c 735b 2266 696c 6573 225d 0a20 2020   ls["files"].   
+00019a40: 2020 2020 2061 7267 203d 2073 656c 662e       arg = self.
+00019a50: 7570 6172 616d 5b22 6c73 225d 0a20 2020  uparam["ls"].   
+00019a60: 2020 2020 2069 6620 6172 6720 696e 205b       if arg in [
+00019a70: 2276 222c 2022 7422 2c20 2274 7874 225d  "v", "t", "txt"]
+00019a80: 3a0a 2020 2020 2020 2020 2020 2020 7472  :.            tr
+00019a90: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00019aa0: 2020 2062 6967 6765 7374 203d 206d 6178     biggest = max
+00019ab0: 286c 735b 2266 696c 6573 225d 202b 206c  (ls["files"] + l
+00019ac0: 735b 2264 6972 7322 5d2c 206b 6579 3d69  s["dirs"], key=i
+00019ad0: 7465 6d67 6574 7465 7228 2273 7a22 2929  temgetter("sz"))
+00019ae0: 5b22 737a 225d 0a20 2020 2020 2020 2020  ["sz"].         
+00019af0: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00019b00: 2020 2020 2020 2020 2020 2062 6967 6765             bigge
+00019b10: 7374 203d 2030 0a0a 2020 2020 2020 2020  st = 0..        
+00019b20: 2020 2020 6966 2061 7267 203d 3d20 2276      if arg == "v
+00019b30: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00019b40: 2020 2066 6d74 203d 2022 5c30 3333 5b30     fmt = "\033[0
+00019b50: 3b37 3b33 366d 7b7b 7d7d 7b7b 3a3e 7b7d  ;7;36m{{}}{{:>{}
+00019b60: 7d7d 5c30 3333 5b30 6d20 7b7b 7d7d 220a  }}\033[0m {{}}".
+00019b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019b80: 6e66 6d74 203d 2022 7b7d 220a 2020 2020  nfmt = "{}".    
+00019b90: 2020 2020 2020 2020 2020 2020 6269 6767              bigg
+00019ba0: 6573 7420 3d20 300a 2020 2020 2020 2020  est = 0.        
+00019bb0: 2020 2020 2020 2020 6632 203d 2022 222e          f2 = "".
+00019bc0: 6a6f 696e 280a 2020 2020 2020 2020 2020  join(.          
+00019bd0: 2020 2020 2020 2020 2020 227b 7d7b 7b7d            "{}{{}
+00019be0: 7d22 2e66 6f72 6d61 7428 7829 0a20 2020  }".format(x).   
+00019bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c00: 2066 6f72 2078 2069 6e20 5b0a 2020 2020   for x in [.    
+00019c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c20: 2020 2020 225c 3033 335b 376d 222c 0a20      "\033[7m",. 
+00019c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c40: 2020 2020 2020 2022 5c30 3333 5b32 376d         "\033[27m
+00019c50: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00019c60: 2020 2020 2020 2020 2020 2022 222c 0a20             "",. 
+00019c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c80: 2020 2020 2020 2022 5c30 3333 5b30 3b31         "\033[0;1
+00019c90: 6d22 2c0a 2020 2020 2020 2020 2020 2020  m",.            
+00019ca0: 2020 2020 2020 2020 2020 2020 225c 3033              "\03
+00019cb0: 335b 303b 3336 6d22 2c0a 2020 2020 2020  3[0;36m",.      
+00019cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cd0: 2020 225c 3033 335b 306d 222c 0a20 2020    "\033[0m",.   
+00019ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cf0: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00019d00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00019d10: 2020 2020 2063 7461 6220 3d20 7b22 4222       ctab = {"B"
+00019d20: 3a20 362c 2022 4b22 3a20 352c 2022 4d22  : 6, "K": 5, "M"
+00019d30: 3a20 312c 2022 4722 3a20 337d 0a20 2020  : 1, "G": 3}.   
+00019d40: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00019d50: 206c 7374 2069 6e20 5b64 6972 732c 2066   lst in [dirs, f
+00019d60: 696c 6573 5d3a 0a20 2020 2020 2020 2020  iles]:.         
+00019d70: 2020 2020 2020 2020 2020 2066 6f72 2078             for x
+00019d80: 2069 6e20 6c73 743a 0a20 2020 2020 2020   in lst:.       
+00019d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019da0: 2061 203d 2078 5b22 6474 225d 2e72 6570   a = x["dt"].rep
+00019db0: 6c61 6365 2822 2d22 2c20 2220 2229 2e72  lace("-", " ").r
+00019dc0: 6570 6c61 6365 2822 3a22 2c20 2220 2229  eplace(":", " ")
+00019dd0: 2e73 706c 6974 2822 2022 290a 2020 2020  .split(" ").    
+00019de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019df0: 2020 2020 785b 2264 7422 5d20 3d20 6632      x["dt"] = f2
+00019e00: 2e66 6f72 6d61 7428 2a6c 6973 7428 6129  .format(*list(a)
+00019e10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00019e20: 2020 2020 2020 2020 2020 737a 203d 2068            sz = h
+00019e30: 756d 616e 7369 7a65 2878 5b22 737a 225d  umansize(x["sz"]
+00019e40: 2c20 5472 7565 290a 2020 2020 2020 2020  , True).        
+00019e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e60: 785b 2273 7a22 5d20 3d20 225c 3033 335b  x["sz"] = "\033[
+00019e70: 303b 337b 7d6d 207b 3a3e 357d 222e 666f  0;3{}m {:>5}".fo
+00019e80: 726d 6174 2863 7461 622e 6765 7428 737a  rmat(ctab.get(sz
+00019e90: 5b2d 313a 5d2c 2030 292c 2073 7a29 0a20  [-1:], 0), sz). 
+00019ea0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00019eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019ec0: 2066 6d74 203d 2022 7b7b 7d7d 2020 7b7b   fmt = "{{}}  {{
+00019ed0: 3a7b 7d2c 7d7d 2020 7b7b 7d7d 220a 2020  :{},}}  {{}}".  
+00019ee0: 2020 2020 2020 2020 2020 2020 2020 6e66                nf
+00019ef0: 6d74 203d 2022 7b3a 2c7d 220a 0a20 2020  mt = "{:,}"..   
+00019f00: 2020 2020 2020 2020 2066 6f72 2078 2069           for x i
+00019f10: 6e20 6469 7273 3a0a 2020 2020 2020 2020  n dirs:.        
+00019f20: 2020 2020 2020 2020 6e20 3d20 785b 226e          n = x["n
+00019f30: 616d 6522 5d20 2b20 222f 220a 2020 2020  ame"] + "/".    
+00019f40: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00019f50: 7267 203d 3d20 2276 223a 0a20 2020 2020  rg == "v":.     
+00019f60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00019f70: 203d 2022 5c30 3333 5b39 346d 2220 2b20   = "\033[94m" + 
+00019f80: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
+00019f90: 2020 2078 5b22 6e61 6d65 225d 203d 206e     x["name"] = n
+00019fa0: 0a0a 2020 2020 2020 2020 2020 2020 666d  ..            fm
+00019fb0: 7420 3d20 666d 742e 666f 726d 6174 286c  t = fmt.format(l
+00019fc0: 656e 286e 666d 742e 666f 726d 6174 2862  en(nfmt.format(b
+00019fd0: 6967 6765 7374 2929 290a 2020 2020 2020  iggest))).      
+00019fe0: 2020 2020 2020 7265 746c 203d 205b 0a20        retl = [. 
+00019ff0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001a000: 2320 7b7d 3a20 7b7d 222e 666f 726d 6174  # {}: {}".format
+0001a010: 2878 2c20 6c73 5b78 5d29 0a20 2020 2020  (x, ls[x]).     
+0001a020: 2020 2020 2020 2020 2020 2066 6f72 2078             for x
+0001a030: 2069 6e20 5b22 6163 6374 222c 2022 7065   in ["acct", "pe
+0001a040: 726d 7322 2c20 2273 7276 696e 6622 5d0a  rms", "srvinf"].
 0001a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a060: 2020 2020 2020 2063 7264 2c20 6364 6e20         crd, cdn 
-0001a070: 3d20 7672 656d 2e72 7370 6c69 7428 222f  = vrem.rsplit("/
-0001a080: 222c 2031 2920 6966 2022 2f22 2069 6e20  ", 1) if "/" in 
-0001a090: 7672 656d 2065 6c73 6520 2822 222c 2076  vrem else ("", v
-0001a0a0: 7265 6d29 0a20 2020 2020 2020 2020 2020  rem).           
-0001a0b0: 2020 2020 2020 2020 2020 2020 2023 206e               # n
-0001a0c0: 6f20 6d6f 6a69 6261 6b65 2073 7570 706f  o mojibake suppo
-0001a0d0: 7274 3a0a 2020 2020 2020 2020 2020 2020  rt:.            
-0001a0e0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0001a0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a100: 2020 2020 2020 2020 2020 2020 2063 666e               cfn
-0001a110: 203d 2069 6375 722e 6578 6563 7574 6528   = icur.execute(
-0001a120: 712c 2028 6372 642c 2063 646e 2929 2e66  q, (crd, cdn)).f
-0001a130: 6574 6368 6f6e 6528 290a 2020 2020 2020  etchone().      
-0001a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a150: 2020 2020 2020 6966 2063 666e 3a0a 2020        if cfn:.  
-0001a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a170: 2020 2020 2020 2020 2020 2020 2020 666e                fn
-0001a180: 203d 2063 666e 5b30 5d0a 2020 2020 2020   = cfn[0].      
-0001a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1a0: 2020 2020 2020 2020 2020 6670 203d 206f            fp = o
-0001a1b0: 732e 7061 7468 2e6a 6f69 6e28 6162 7370  s.path.join(absp
-0001a1c0: 6174 682c 2066 6e29 0a20 2020 2020 2020  ath, fn).       
-0001a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a1e0: 2020 2020 2020 2020 2069 6620 626f 732e           if bos.
-0001a1f0: 7061 7468 2e65 7869 7374 7328 6670 293a  path.exists(fp):
-0001a200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a220: 2020 2020 2076 7265 6d20 3d20 227b 7d2f       vrem = "{}/
-0001a230: 7b7d 222e 666f 726d 6174 2876 7265 6d2c  {}".format(vrem,
-0001a240: 2066 6e29 2e73 7472 6970 2822 2f22 290a   fn).strip("/").
-0001a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a270: 2020 2020 6973 5f64 6972 203d 2046 616c      is_dir = Fal
-0001a280: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-0001a290: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-0001a2a0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-0001a2b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001a2c0: 6173 730a 2020 2020 2020 2020 2020 2020  ass.            
-0001a2d0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0001a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a2f0: 2020 2020 2020 666f 7220 666e 2069 6e20        for fn in 
-0001a300: 7365 6c66 2e61 7267 732e 7468 5f63 6f76  self.args.th_cov
-0001a310: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
-0001a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a330: 2066 7020 3d20 6f73 2e70 6174 682e 6a6f   fp = os.path.jo
-0001a340: 696e 2861 6273 7061 7468 2c20 666e 290a  in(abspath, fn).
-0001a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a360: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-0001a370: 6f73 2e70 6174 682e 6578 6973 7473 2866  os.path.exists(f
-0001a380: 7029 3a0a 2020 2020 2020 2020 2020 2020  p):.            
-0001a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3a0: 2020 2020 7672 656d 203d 2022 7b7d 2f7b      vrem = "{}/{
-0001a3b0: 7d22 2e66 6f72 6d61 7428 7672 656d 2c20  }".format(vrem, 
-0001a3c0: 666e 292e 7374 7269 7028 222f 2229 0a20  fn).strip("/"). 
-0001a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001a3f0: 735f 6469 7220 3d20 4661 6c73 650a 2020  s_dir = False.  
-0001a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a410: 2020 2020 2020 2020 2020 2020 2020 6272                br
-0001a420: 6561 6b0a 0a20 2020 2020 2020 2020 2020  eak..           
-0001a430: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
-0001a440: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
-0001a450: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001a460: 726e 2073 656c 662e 7478 5f69 636f 2822  rn self.tx_ico("
-0001a470: 612e 666f 6c64 6572 2229 0a0a 2020 2020  a.folder")..    
-0001a480: 2020 2020 2020 2020 2020 2020 7468 7020              thp 
-0001a490: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-0001a4a0: 2020 2020 2020 2069 6620 7365 6c66 2e74         if self.t
-0001a4b0: 6875 6d62 636c 693a 0a20 2020 2020 2020  humbcli:.       
-0001a4c0: 2020 2020 2020 2020 2020 2020 2074 6870               thp
-0001a4d0: 203d 2073 656c 662e 7468 756d 6263 6c69   = self.thumbcli
-0001a4e0: 2e67 6574 2864 6276 2c20 7672 656d 2c20  .get(dbv, vrem, 
-0001a4f0: 696e 7428 7374 2e73 745f 6d74 696d 6529  int(st.st_mtime)
-0001a500: 2c20 7468 5f66 6d74 290a 0a20 2020 2020  , th_fmt)..     
-0001a510: 2020 2020 2020 2020 2020 2069 6620 7468             if th
-0001a520: 703a 0a20 2020 2020 2020 2020 2020 2020  p:.             
-0001a530: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001a540: 6c66 2e74 785f 6669 6c65 2874 6870 290a  lf.tx_file(thp).
-0001a550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a560: 2069 6620 7468 5f66 6d74 203d 3d20 2270   if th_fmt == "p
-0001a570: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-0001a580: 2020 2020 2020 2072 6169 7365 2050 6562         raise Peb
-0001a590: 6b61 6328 3430 3429 0a0a 2020 2020 2020  kac(404)..      
-0001a5a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001a5b0: 2073 656c 662e 7478 5f69 636f 2872 656d   self.tx_ico(rem
-0001a5c0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0001a5d0: 7420 6973 5f64 6972 2061 6e64 2028 7365  t is_dir and (se
-0001a5e0: 6c66 2e63 616e 5f72 6561 6420 6f72 2073  lf.can_read or s
-0001a5f0: 656c 662e 6361 6e5f 6765 7429 3a0a 2020  elf.can_get):.  
-0001a600: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001a610: 2073 656c 662e 6361 6e5f 7265 6164 2061   self.can_read a
-0001a620: 6e64 2022 666b 2220 696e 2076 6e2e 666c  nd "fk" in vn.fl
-0001a630: 6167 733a 0a20 2020 2020 2020 2020 2020  ags:.           
-0001a640: 2020 2020 2063 6f72 7265 6374 203d 2073       correct = s
-0001a650: 656c 662e 6765 6e5f 666b 280a 2020 2020  elf.gen_fk(.    
-0001a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a670: 7365 6c66 2e61 7267 732e 666b 5f73 616c  self.args.fk_sal
-0001a680: 742c 2061 6273 7061 7468 2c20 7374 2e73  t, abspath, st.s
-0001a690: 745f 7369 7a65 2c20 3020 6966 2041 4e59  t_size, 0 if ANY
-0001a6a0: 5749 4e20 656c 7365 2073 742e 7374 5f69  WIN else st.st_i
-0001a6b0: 6e6f 0a20 2020 2020 2020 2020 2020 2020  no.             
-0001a6c0: 2020 2029 5b3a 2076 6e2e 666c 6167 735b     )[: vn.flags[
-0001a6d0: 2266 6b22 5d5d 0a20 2020 2020 2020 2020  "fk"]].         
-0001a6e0: 2020 2020 2020 2067 6f74 203d 2073 656c         got = sel
-0001a6f0: 662e 7570 6172 616d 2e67 6574 2822 6b22  f.uparam.get("k"
-0001a700: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001a710: 2020 6966 2067 6f74 2021 3d20 636f 7272    if got != corr
-0001a720: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-0001a730: 2020 2020 2020 2020 2073 656c 662e 6c6f           self.lo
-0001a740: 6728 2277 726f 6e67 2066 696c 656b 6579  g("wrong filekey
-0001a750: 2c20 7761 6e74 207b 7d2c 2067 6f74 207b  , want {}, got {
-0001a760: 7d22 2e66 6f72 6d61 7428 636f 7272 6563  }".format(correc
-0001a770: 742c 2067 6f74 2929 0a20 2020 2020 2020  t, got)).       
-0001a780: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0001a790: 7572 6e20 7365 6c66 2e74 785f 3430 3428  urn self.tx_404(
-0001a7a0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-0001a7b0: 6620 6162 7370 6174 682e 656e 6473 7769  f abspath.endswi
-0001a7c0: 7468 2822 2e6d 6422 2920 616e 6420 280a  th(".md") and (.
-0001a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a7e0: 2276 2220 696e 2073 656c 662e 7570 6172  "v" in self.upar
-0001a7f0: 616d 206f 7220 2265 6469 7422 2069 6e20  am or "edit" in 
-0001a800: 7365 6c66 2e75 7061 7261 6d20 6f72 2022  self.uparam or "
-0001a810: 6564 6974 3222 2069 6e20 7365 6c66 2e75  edit2" in self.u
-0001a820: 7061 7261 6d0a 2020 2020 2020 2020 2020  param.          
-0001a830: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0001a840: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001a850: 2e74 785f 6d64 2861 6273 7061 7468 290a  .tx_md(abspath).
-0001a860: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0001a870: 7572 6e20 7365 6c66 2e74 785f 6669 6c65  urn self.tx_file
-0001a880: 2861 6273 7061 7468 290a 0a20 2020 2020  (abspath)..     
-0001a890: 2020 2065 6c69 6620 6973 5f64 6972 2061     elif is_dir a
-0001a8a0: 6e64 206e 6f74 2073 656c 662e 6361 6e5f  nd not self.can_
-0001a8b0: 7265 6164 2061 6e64 206e 6f74 2073 656c  read and not sel
-0001a8c0: 662e 6361 6e5f 7772 6974 653a 0a20 2020  f.can_write:.   
-0001a8d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0001a8e0: 7365 6c66 2e74 785f 3430 3428 5472 7565  self.tx_404(True
-0001a8f0: 290a 0a20 2020 2020 2020 2073 7276 5f69  )..        srv_i
-0001a900: 6e66 6f20 3d20 5b5d 0a0a 2020 2020 2020  nfo = []..      
-0001a910: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0001a920: 2020 2069 6620 6e6f 7420 7365 6c66 2e61     if not self.a
-0001a930: 7267 732e 6e69 683a 0a20 2020 2020 2020  rgs.nih:.       
-0001a940: 2020 2020 2020 2020 2073 7276 5f69 6e66           srv_inf
-0001a950: 6f2e 6170 7065 6e64 2873 656c 662e 6172  o.append(self.ar
-0001a960: 6773 2e6e 616d 6529 0a20 2020 2020 2020  gs.name).       
-0001a970: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
-0001a980: 2020 2020 2073 656c 662e 6c6f 6728 2223       self.log("#
-0001a990: 776f 7720 2377 686f 6122 290a 0a20 2020  wow #whoa")..   
-0001a9a0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0001a9b0: 2e61 7267 732e 6e69 643a 0a20 2020 2020  .args.nid:.     
-0001a9c0: 2020 2020 2020 2066 7265 652c 2074 6f74         free, tot
-0001a9d0: 616c 203d 2067 6574 5f64 6628 6162 7370  al = get_df(absp
-0001a9e0: 6174 6829 0a20 2020 2020 2020 2020 2020  ath).           
-0001a9f0: 2069 6620 746f 7461 6c20 6973 206e 6f74   if total is not
-0001aa00: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001aa10: 2020 2020 2020 2068 3120 3d20 6875 6d61         h1 = huma
-0001aa20: 6e73 697a 6528 6672 6565 206f 7220 3029  nsize(free or 0)
-0001aa30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001aa40: 2068 3220 3d20 6875 6d61 6e73 697a 6528   h2 = humansize(
-0001aa50: 746f 7461 6c29 0a20 2020 2020 2020 2020  total).         
-0001aa60: 2020 2020 2020 2073 7276 5f69 6e66 6f2e         srv_info.
-0001aa70: 6170 7065 6e64 2822 7b7d 2066 7265 6520  append("{} free 
-0001aa80: 6f66 207b 7d22 2e66 6f72 6d61 7428 6831  of {}".format(h1
-0001aa90: 2c20 6832 2929 0a20 2020 2020 2020 2020  , h2)).         
-0001aaa0: 2020 2065 6c69 6620 6672 6565 2069 7320     elif free is 
-0001aab0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0001aac0: 2020 2020 2020 2020 2020 7372 765f 696e            srv_in
-0001aad0: 666f 2e61 7070 656e 6428 6875 6d61 6e73  fo.append(humans
-0001aae0: 697a 6528 6672 6565 2c20 5472 7565 2920  ize(free, True) 
-0001aaf0: 2b20 2220 6672 6565 2229 0a0a 2020 2020  + " free")..    
-0001ab00: 2020 2020 7372 765f 696e 666f 7420 3d20      srv_infot = 
-0001ab10: 223c 2f73 7061 6e3e 202f 2f20 3c73 7061  "</span> // <spa
-0001ab20: 6e3e 222e 6a6f 696e 2873 7276 5f69 6e66  n>".join(srv_inf
-0001ab30: 6f29 0a0a 2020 2020 2020 2020 7065 726d  o)..        perm
-0001ab40: 7320 3d20 5b5d 0a20 2020 2020 2020 2069  s = [].        i
-0001ab50: 6620 7365 6c66 2e63 616e 5f72 6561 643a  f self.can_read:
-0001ab60: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
-0001ab70: 6d73 2e61 7070 656e 6428 2272 6561 6422  ms.append("read"
-0001ab80: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-0001ab90: 662e 6361 6e5f 7772 6974 653a 0a20 2020  f.can_write:.   
-0001aba0: 2020 2020 2020 2020 2070 6572 6d73 2e61           perms.a
-0001abb0: 7070 656e 6428 2277 7269 7465 2229 0a20  ppend("write"). 
-0001abc0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-0001abd0: 616e 5f6d 6f76 653a 0a20 2020 2020 2020  an_move:.       
-0001abe0: 2020 2020 2070 6572 6d73 2e61 7070 656e       perms.appen
-0001abf0: 6428 226d 6f76 6522 290a 2020 2020 2020  d("move").      
-0001ac00: 2020 6966 2073 656c 662e 6361 6e5f 6465    if self.can_de
-0001ac10: 6c65 7465 3a0a 2020 2020 2020 2020 2020  lete:.          
-0001ac20: 2020 7065 726d 732e 6170 7065 6e64 2822    perms.append("
-0001ac30: 6465 6c65 7465 2229 0a20 2020 2020 2020  delete").       
-0001ac40: 2069 6620 7365 6c66 2e63 616e 5f67 6574   if self.can_get
-0001ac50: 3a0a 2020 2020 2020 2020 2020 2020 7065  :.            pe
-0001ac60: 726d 732e 6170 7065 6e64 2822 6765 7422  rms.append("get"
-0001ac70: 290a 2020 2020 2020 2020 6966 2073 656c  ).        if sel
-0001ac80: 662e 6361 6e5f 7570 6765 743a 0a20 2020  f.can_upget:.   
-0001ac90: 2020 2020 2020 2020 2070 6572 6d73 2e61           perms.a
-0001aca0: 7070 656e 6428 2275 7067 6574 2229 0a0a  ppend("upget")..
-0001acb0: 2020 2020 2020 2020 7572 6c5f 7375 6620          url_suf 
-0001acc0: 3d20 7365 6c66 2e75 726c 7128 7b7d 2c20  = self.urlq({}, 
-0001acd0: 5b22 6b22 5d29 0a20 2020 2020 2020 2069  ["k"]).        i
-0001ace0: 735f 6c73 203d 2022 6c73 2220 696e 2073  s_ls = "ls" in s
-0001acf0: 656c 662e 7570 6172 616d 0a20 2020 2020  elf.uparam.     
-0001ad00: 2020 2069 735f 6a73 203d 2073 656c 662e     is_js = self.
-0001ad10: 6172 6773 2e66 6f72 6365 5f6a 7320 6f72  args.force_js or
-0001ad20: 2073 656c 662e 636f 6f6b 6965 732e 6765   self.cookies.ge
-0001ad30: 7428 226a 7322 2920 3d3d 2022 7922 0a0a  t("js") == "y"..
-0001ad40: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0001ad50: 735f 6c73 2061 6e64 2028 7365 6c66 2e75  s_ls and (self.u
-0001ad60: 612e 7374 6172 7473 7769 7468 2822 6375  a.startswith("cu
-0001ad70: 726c 2f22 2920 6f72 2073 656c 662e 7561  rl/") or self.ua
-0001ad80: 2e73 7461 7274 7377 6974 6828 2266 6574  .startswith("fet
-0001ad90: 6368 2229 293a 0a20 2020 2020 2020 2020  ch")):.         
-0001ada0: 2020 2073 656c 662e 7570 6172 616d 5b22     self.uparam["
-0001adb0: 6c73 225d 203d 2022 7622 0a20 2020 2020  ls"] = "v".     
-0001adc0: 2020 2020 2020 2069 735f 6c73 203d 2054         is_ls = T
-0001add0: 7275 650a 0a20 2020 2020 2020 2074 706c  rue..        tpl
-0001ade0: 203d 2022 6272 6f77 7365 7222 0a20 2020   = "browser".   
-0001adf0: 2020 2020 2069 6620 2262 2220 696e 2073       if "b" in s
-0001ae00: 656c 662e 7570 6172 616d 3a0a 2020 2020  elf.uparam:.    
-0001ae10: 2020 2020 2020 2020 7470 6c20 3d20 2262          tpl = "b
-0001ae20: 726f 7773 6572 3222 0a20 2020 2020 2020  rowser2".       
-0001ae30: 2020 2020 2069 735f 6a73 203d 2046 616c       is_js = Fal
-0001ae40: 7365 0a0a 2020 2020 2020 2020 6c6f 6775  se..        logu
-0001ae50: 6573 203d 205b 2222 2c20 2222 5d0a 2020  es = ["", ""].  
-0001ae60: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-0001ae70: 662e 6172 6773 2e6e 6f5f 6c6f 6775 6573  f.args.no_logues
-0001ae80: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
-0001ae90: 7220 6e2c 2066 6e20 696e 2065 6e75 6d65  r n, fn in enume
-0001aea0: 7261 7465 285b 222e 7072 6f6c 6f67 7565  rate([".prologue
-0001aeb0: 2e68 746d 6c22 2c20 222e 6570 696c 6f67  .html", ".epilog
-0001aec0: 7565 2e68 746d 6c22 5d29 3a0a 2020 2020  ue.html"]):.    
-0001aed0: 2020 2020 2020 2020 2020 2020 666e 203d              fn =
-0001aee0: 206f 732e 7061 7468 2e6a 6f69 6e28 6162   os.path.join(ab
-0001aef0: 7370 6174 682c 2066 6e29 0a20 2020 2020  spath, fn).     
-0001af00: 2020 2020 2020 2020 2020 2069 6620 626f             if bo
-0001af10: 732e 7061 7468 2e65 7869 7374 7328 666e  s.path.exists(fn
-0001af20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001af30: 2020 2020 2020 2077 6974 6820 6f70 656e         with open
-0001af40: 2866 7365 6e63 2866 6e29 2c20 2272 6222  (fsenc(fn), "rb"
-0001af50: 2920 6173 2066 3a0a 2020 2020 2020 2020  ) as f:.        
-0001af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001af70: 6c6f 6775 6573 5b6e 5d20 3d20 662e 7265  logues[n] = f.re
-0001af80: 6164 2829 2e64 6563 6f64 6528 2275 7466  ad().decode("utf
-0001af90: 2d38 2229 0a0a 2020 2020 2020 2020 7265  -8")..        re
-0001afa0: 6164 6d65 203d 2022 220a 2020 2020 2020  adme = "".      
-0001afb0: 2020 6966 206e 6f74 2073 656c 662e 6172    if not self.ar
-0001afc0: 6773 2e6e 6f5f 7265 6164 6d65 2061 6e64  gs.no_readme and
-0001afd0: 206e 6f74 206c 6f67 7565 735b 315d 3a0a   not logues[1]:.
-0001afe0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0001aff0: 666e 2069 6e20 5b22 5245 4144 4d45 2e6d  fn in ["README.m
-0001b000: 6422 2c20 2272 6561 646d 652e 6d64 225d  d", "readme.md"]
-0001b010: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001b020: 2020 666e 203d 206f 732e 7061 7468 2e6a    fn = os.path.j
-0001b030: 6f69 6e28 6162 7370 6174 682c 2066 6e29  oin(abspath, fn)
-0001b040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b050: 2069 6620 626f 732e 7061 7468 2e69 7366   if bos.path.isf
-0001b060: 696c 6528 666e 293a 0a20 2020 2020 2020  ile(fn):.       
-0001b070: 2020 2020 2020 2020 2020 2020 2077 6974               wit
-0001b080: 6820 6f70 656e 2866 7365 6e63 2866 6e29  h open(fsenc(fn)
-0001b090: 2c20 2272 6222 2920 6173 2066 3a0a 2020  , "rb") as f:.  
-0001b0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0b0: 2020 2020 2020 7265 6164 6d65 203d 2066        readme = f
-0001b0c0: 2e72 6561 6428 292e 6465 636f 6465 2822  .read().decode("
-0001b0d0: 7574 662d 3822 290a 2020 2020 2020 2020  utf-8").        
-0001b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b0f0: 6272 6561 6b0a 0a20 2020 2020 2020 2076  break..        v
-0001b100: 6620 3d20 766e 2e66 6c61 6773 0a20 2020  f = vn.flags.   
-0001b110: 2020 2020 206c 735f 7265 7420 3d20 7b0a       ls_ret = {.
-0001b120: 2020 2020 2020 2020 2020 2020 2264 6972              "dir
-0001b130: 7322 3a20 5b5d 2c0a 2020 2020 2020 2020  s": [],.        
-0001b140: 2020 2020 2266 696c 6573 223a 205b 5d2c      "files": [],
-0001b150: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
-0001b160: 676c 6973 7422 3a20 5b5d 2c0a 2020 2020  glist": [],.    
-0001b170: 2020 2020 2020 2020 2273 7276 696e 6622          "srvinf"
-0001b180: 3a20 7372 765f 696e 666f 742c 0a20 2020  : srv_infot,.   
-0001b190: 2020 2020 2020 2020 2022 6163 6374 223a           "acct":
-0001b1a0: 2073 656c 662e 756e 616d 652c 0a20 2020   self.uname,.   
-0001b1b0: 2020 2020 2020 2020 2022 6964 7822 3a20           "idx": 
-0001b1c0: 6532 642c 0a20 2020 2020 2020 2020 2020  e2d,.           
-0001b1d0: 2022 6974 6167 223a 2065 3274 2c0a 2020   "itag": e2t,.  
-0001b1e0: 2020 2020 2020 2020 2020 226c 6966 6574            "lifet
-0001b1f0: 696d 6522 3a20 766e 2e66 6c61 6773 2e67  ime": vn.flags.g
-0001b200: 6574 2822 6c69 6665 7469 6d65 2229 206f  et("lifetime") o
-0001b210: 7220 302c 0a20 2020 2020 2020 2020 2020  r 0,.           
-0001b220: 2022 6672 616e 6422 3a20 626f 6f6c 2876   "frand": bool(v
-0001b230: 6e2e 666c 6167 732e 6765 7428 2272 616e  n.flags.get("ran
-0001b240: 6422 2929 2c0a 2020 2020 2020 2020 2020  d")),.          
-0001b250: 2020 2270 6572 6d73 223a 2070 6572 6d73    "perms": perms
-0001b260: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-0001b270: 6f67 7565 7322 3a20 6c6f 6775 6573 2c0a  ogues": logues,.
-0001b280: 2020 2020 2020 2020 2020 2020 2272 6561              "rea
-0001b290: 646d 6522 3a20 7265 6164 6d65 2c0a 2020  dme": readme,.  
-0001b2a0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001b2b0: 6a32 6120 3d20 7b0a 2020 2020 2020 2020  j2a = {.        
-0001b2c0: 2020 2020 2276 6469 7222 3a20 7175 6f74      "vdir": quot
-0001b2d0: 6570 2873 656c 662e 7670 6174 6829 2c0a  ep(self.vpath),.
-0001b2e0: 2020 2020 2020 2020 2020 2020 2276 706e              "vpn
-0001b2f0: 6f64 6573 223a 2076 706e 6f64 6573 2c0a  odes": vpnodes,.
-0001b300: 2020 2020 2020 2020 2020 2020 2266 696c              "fil
-0001b310: 6573 223a 205b 5d2c 0a20 2020 2020 2020  es": [],.       
-0001b320: 2020 2020 2022 6c73 3022 3a20 4e6f 6e65       "ls0": None
-0001b330: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
-0001b340: 6363 7422 3a20 7365 6c66 2e75 6e61 6d65  cct": self.uname
-0001b350: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
-0001b360: 6572 6d73 223a 206a 736f 6e2e 6475 6d70  erms": json.dump
-0001b370: 7328 7065 726d 7329 2c0a 2020 2020 2020  s(perms),.      
-0001b380: 2020 2020 2020 226c 6966 6574 696d 6522        "lifetime"
-0001b390: 3a20 6c73 5f72 6574 5b22 6c69 6665 7469  : ls_ret["lifeti
-0001b3a0: 6d65 225d 2c0a 2020 2020 2020 2020 2020  me"],.          
-0001b3b0: 2020 2266 7261 6e64 223a 2062 6f6f 6c28    "frand": bool(
-0001b3c0: 766e 2e66 6c61 6773 2e67 6574 2822 7261  vn.flags.get("ra
-0001b3d0: 6e64 2229 292c 0a20 2020 2020 2020 2020  nd")),.         
-0001b3e0: 2020 2022 7461 676c 6973 7422 3a20 5b5d     "taglist": []
-0001b3f0: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-0001b400: 6566 5f68 636f 6c73 223a 205b 5d2c 0a20  ef_hcols": [],. 
-0001b410: 2020 2020 2020 2020 2020 2022 6861 7665             "have
-0001b420: 5f65 6d70 223a 2073 656c 662e 6172 6773  _emp": self.args
-0001b430: 2e65 6d70 2c0a 2020 2020 2020 2020 2020  .emp,.          
-0001b440: 2020 2268 6176 655f 7570 326b 5f69 6478    "have_up2k_idx
-0001b450: 223a 2065 3264 2c0a 2020 2020 2020 2020  ": e2d,.        
-0001b460: 2020 2020 2268 6176 655f 7461 6773 5f69      "have_tags_i
-0001b470: 6478 223a 2065 3274 2c0a 2020 2020 2020  dx": e2t,.      
-0001b480: 2020 2020 2020 2268 6176 655f 6163 6f64        "have_acod
-0001b490: 6522 3a20 286e 6f74 2073 656c 662e 6172  e": (not self.ar
-0001b4a0: 6773 2e6e 6f5f 6163 6f64 6529 2c0a 2020  gs.no_acode),.  
-0001b4b0: 2020 2020 2020 2020 2020 2268 6176 655f            "have_
-0001b4c0: 6d76 223a 2028 6e6f 7420 7365 6c66 2e61  mv": (not self.a
-0001b4d0: 7267 732e 6e6f 5f6d 7629 2c0a 2020 2020  rgs.no_mv),.    
-0001b4e0: 2020 2020 2020 2020 2268 6176 655f 6465          "have_de
-0001b4f0: 6c22 3a20 286e 6f74 2073 656c 662e 6172  l": (not self.ar
-0001b500: 6773 2e6e 6f5f 6465 6c29 2c0a 2020 2020  gs.no_del),.    
-0001b510: 2020 2020 2020 2020 2268 6176 655f 7a69          "have_zi
-0001b520: 7022 3a20 286e 6f74 2073 656c 662e 6172  p": (not self.ar
-0001b530: 6773 2e6e 6f5f 7a69 7029 2c0a 2020 2020  gs.no_zip),.    
-0001b540: 2020 2020 2020 2020 2268 6176 655f 756e          "have_un
-0001b550: 706f 7374 223a 2069 6e74 2873 656c 662e  post": int(self.
-0001b560: 6172 6773 2e75 6e70 6f73 7429 2c0a 2020  args.unpost),.  
-0001b570: 2020 2020 2020 2020 2020 2268 6176 655f            "have_
-0001b580: 625f 7522 3a20 2873 656c 662e 6361 6e5f  b_u": (self.can_
-0001b590: 7772 6974 6520 616e 6420 7365 6c66 2e75  write and self.u
-0001b5a0: 7061 7261 6d2e 6765 7428 2262 2229 203d  param.get("b") =
-0001b5b0: 3d20 2275 2229 2c0a 2020 2020 2020 2020  = "u"),.        
-0001b5c0: 2020 2020 2273 625f 6d64 223a 2022 2220      "sb_md": "" 
-0001b5d0: 6966 2022 6e6f 5f73 625f 6d64 2220 696e  if "no_sb_md" in
-0001b5e0: 2076 6620 656c 7365 2028 7666 2e67 6574   vf else (vf.get
-0001b5f0: 2822 6d64 5f73 6266 2229 206f 7220 2279  ("md_sbf") or "y
-0001b600: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-0001b610: 2273 625f 6c67 223a 2022 2220 6966 2022  "sb_lg": "" if "
-0001b620: 6e6f 5f73 625f 6c67 2220 696e 2076 6620  no_sb_lg" in vf 
-0001b630: 656c 7365 2028 7666 2e67 6574 2822 6c67  else (vf.get("lg
-0001b640: 5f73 6266 2229 206f 7220 2279 2229 2c0a  _sbf") or "y"),.
-0001b650: 2020 2020 2020 2020 2020 2020 2275 726c              "url
-0001b660: 5f73 7566 223a 2075 726c 5f73 7566 2c0a  _suf": url_suf,.
-0001b670: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0001b680: 7565 7322 3a20 6c6f 6775 6573 2c0a 2020  ues": logues,.  
-0001b690: 2020 2020 2020 2020 2020 2272 6561 646d            "readm
-0001b6a0: 6522 3a20 7265 6164 6d65 2c0a 2020 2020  e": readme,.    
-0001b6b0: 2020 2020 2020 2020 2274 6974 6c65 223a          "title":
-0001b6c0: 2068 746d 6c5f 6573 6361 7065 2873 656c   html_escape(sel
-0001b6d0: 662e 7670 6174 682c 2063 726c 663d 5472  f.vpath, crlf=Tr
-0001b6e0: 7565 2920 6f72 2022 f09f 92be f09f 8e89  ue) or "........
-0001b6f0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001b700: 7372 765f 696e 666f 223a 2073 7276 5f69  srv_info": srv_i
-0001b710: 6e66 6f74 2c0a 2020 2020 2020 2020 2020  nfot,.          
-0001b720: 2020 2264 7468 656d 6522 3a20 7365 6c66    "dtheme": self
-0001b730: 2e61 7267 732e 7468 656d 652c 0a20 2020  .args.theme,.   
-0001b740: 2020 2020 2020 2020 2022 7468 656d 6573           "themes
-0001b750: 223a 2073 656c 662e 6172 6773 2e74 6865  ": self.args.the
-0001b760: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
-0001b770: 2022 7475 7262 6f6c 766c 223a 2073 656c   "turbolvl": sel
-0001b780: 662e 6172 6773 2e74 7572 626f 2c0a 2020  f.args.turbo,.  
-0001b790: 2020 2020 2020 2020 2020 2269 6478 6822            "idxh"
-0001b7a0: 3a20 696e 7428 7365 6c66 2e61 7267 732e  : int(self.args.
-0001b7b0: 6968 292c 0a20 2020 2020 2020 2020 2020  ih),.           
-0001b7c0: 2022 7532 736f 7274 223a 2073 656c 662e   "u2sort": self.
-0001b7d0: 6172 6773 2e75 3273 6f72 742c 0a20 2020  args.u2sort,.   
-0001b7e0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-0001b7f0: 6966 2073 656c 662e 6172 6773 2e6a 735f  if self.args.js_
-0001b800: 6272 6f77 7365 723a 0a20 2020 2020 2020  browser:.       
-0001b810: 2020 2020 206a 3261 5b22 6a73 225d 203d       j2a["js"] =
-0001b820: 2073 656c 662e 6172 6773 2e6a 735f 6272   self.args.js_br
-0001b830: 6f77 7365 720a 0a20 2020 2020 2020 2069  owser..        i
-0001b840: 6620 7365 6c66 2e61 7267 732e 6373 735f  f self.args.css_
-0001b850: 6272 6f77 7365 723a 0a20 2020 2020 2020  browser:.       
-0001b860: 2020 2020 206a 3261 5b22 6373 7322 5d20       j2a["css"] 
-0001b870: 3d20 7365 6c66 2e61 7267 732e 6373 735f  = self.args.css_
-0001b880: 6272 6f77 7365 720a 0a20 2020 2020 2020  browser..       
-0001b890: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6e   if not self.con
-0001b8a0: 6e2e 6873 7276 2e70 7269 736d 3a0a 2020  n.hsrv.prism:.  
-0001b8b0: 2020 2020 2020 2020 2020 6a32 615b 226e            j2a["n
-0001b8c0: 6f5f 7072 6973 6d22 5d20 3d20 5472 7565  o_prism"] = True
-0001b8d0: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001b8e0: 2073 656c 662e 6361 6e5f 7265 6164 3a0a   self.can_read:.
-0001b8f0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0001b900: 735f 6c73 3a0a 2020 2020 2020 2020 2020  s_ls:.          
-0001b910: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0001b920: 662e 7478 5f6c 7328 6c73 5f72 6574 290a  f.tx_ls(ls_ret).
-0001b930: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001b940: 6e6f 7420 7374 6174 2e53 5f49 5344 4952  not stat.S_ISDIR
-0001b950: 2873 742e 7374 5f6d 6f64 6529 3a0a 2020  (st.st_mode):.  
-0001b960: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001b970: 7475 726e 2073 656c 662e 7478 5f34 3034  turn self.tx_404
-0001b980: 2854 7275 6529 0a0a 2020 2020 2020 2020  (True)..        
-0001b990: 2020 2020 6966 2022 7a69 7022 2069 6e20      if "zip" in 
-0001b9a0: 7365 6c66 2e75 7061 7261 6d20 6f72 2022  self.uparam or "
-0001b9b0: 7461 7222 2069 6e20 7365 6c66 2e75 7061  tar" in self.upa
-0001b9c0: 7261 6d3a 0a20 2020 2020 2020 2020 2020  ram:.           
-0001b9d0: 2020 2020 2072 6169 7365 2050 6562 6b61       raise Pebka
-0001b9e0: 6328 3430 3329 0a0a 2020 2020 2020 2020  c(403)..        
-0001b9f0: 2020 2020 6874 6d6c 203d 2073 656c 662e      html = self.
-0001ba00: 6a32 7328 7470 6c2c 202a 2a6a 3261 290a  j2s(tpl, **j2a).
-0001ba10: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ba20: 2e72 6570 6c79 2868 746d 6c2e 656e 636f  .reply(html.enco
-0001ba30: 6465 2822 7574 662d 3822 2c20 2272 6570  de("utf-8", "rep
-0001ba40: 6c61 6365 2229 290a 2020 2020 2020 2020  lace")).        
-0001ba50: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
-0001ba60: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
-0001ba70: 6e20 5b22 7a69 7022 2c20 2274 6172 225d  n ["zip", "tar"]
-0001ba80: 3a0a 2020 2020 2020 2020 2020 2020 7620  :.            v 
-0001ba90: 3d20 7365 6c66 2e75 7061 7261 6d2e 6765  = self.uparam.ge
-0001baa0: 7428 6b29 0a20 2020 2020 2020 2020 2020  t(k).           
-0001bab0: 2069 6620 7620 6973 206e 6f74 204e 6f6e   if v is not Non
-0001bac0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001bad0: 2020 2072 6574 7572 6e20 7365 6c66 2e74     return self.t
-0001bae0: 785f 7a69 7028 6b2c 2076 2c20 766e 2c20  x_zip(k, v, vn, 
-0001baf0: 7265 6d2c 205b 5d2c 2073 656c 662e 6172  rem, [], self.ar
-0001bb00: 6773 2e65 6429 0a0a 2020 2020 2020 2020  gs.ed)..        
-0001bb10: 6673 726f 6f74 2c20 7666 735f 6c73 2c20  fsroot, vfs_ls, 
-0001bb20: 7666 735f 7669 7274 203d 2076 6e2e 6c73  vfs_virt = vn.ls
-0001bb30: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
-0001bb40: 6d2c 2073 656c 662e 756e 616d 652c 206e  m, self.uname, n
-0001bb50: 6f74 2073 656c 662e 6172 6773 2e6e 6f5f  ot self.args.no_
-0001bb60: 7363 616e 6469 722c 205b 5b54 7275 652c  scandir, [[True,
-0001bb70: 2046 616c 7365 5d2c 205b 4661 6c73 652c   False], [False,
-0001bb80: 2054 7275 655d 5d0a 2020 2020 2020 2020   True]].        
-0001bb90: 290a 2020 2020 2020 2020 7374 6174 7320  ).        stats 
-0001bba0: 3d20 7b6b 3a20 7620 666f 7220 6b2c 2076  = {k: v for k, v
-0001bbb0: 2069 6e20 7666 735f 6c73 7d0a 2020 2020   in vfs_ls}.    
-0001bbc0: 2020 2020 6c73 5f6e 616d 6573 203d 205b      ls_names = [
-0001bbd0: 785b 305d 2066 6f72 2078 2069 6e20 7666  x[0] for x in vf
-0001bbe0: 735f 6c73 5d0a 2020 2020 2020 2020 6c73  s_ls].        ls
-0001bbf0: 5f6e 616d 6573 2e65 7874 656e 6428 6c69  _names.extend(li
-0001bc00: 7374 2876 6673 5f76 6972 742e 6b65 7973  st(vfs_virt.keys
-0001bc10: 2829 2929 0a0a 2020 2020 2020 2020 2320  ()))..        # 
-0001bc20: 6368 6563 6b20 666f 7220 6f6c 6420 7665  check for old ve
-0001bc30: 7273 696f 6e73 206f 6620 6669 6c65 732c  rsions of files,
-0001bc40: 0a20 2020 2020 2020 2023 205b 6e75 6d2d  .        # [num-
-0001bc50: 6261 636b 7570 732c 206d 6f73 742d 7265  backups, most-re
-0001bc60: 6365 6e74 2c20 6869 7374 2d70 6174 685d  cent, hist-path]
-0001bc70: 0a20 2020 2020 2020 2068 6973 7420 2020  .        hist   
-0001bc80: 2020 3d20 7b7d 0a20 2020 2020 2020 2068    = {}.        h
-0001bc90: 6973 7464 6972 203d 206f 732e 7061 7468  istdir = os.path
-0001bca0: 2e6a 6f69 6e28 6673 726f 6f74 2c20 222e  .join(fsroot, ".
-0001bcb0: 6869 7374 2229 0a20 2020 2020 2020 2070  hist").        p
-0001bcc0: 746e 203d 2072 652e 636f 6d70 696c 6528  tn = re.compile(
-0001bcd0: 7222 282e 2a29 5c2e 285b 302d 395d 2b5c  r"(.*)\.([0-9]+\
-0001bce0: 2e5b 302d 395d 7b33 7d29 285c 2e5b 5e5c  .[0-9]{3})(\.[^\
-0001bcf0: 2e5d 2b29 2422 290a 2020 2020 2020 2020  .]+)$").        
-0001bd00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0001bd10: 2066 6f72 2068 666e 2069 6e20 626f 732e   for hfn in bos.
-0001bd20: 6c69 7374 6469 7228 6869 7374 6469 7229  listdir(histdir)
-0001bd30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001bd40: 2020 6d20 3d20 7074 6e2e 6d61 7463 6828    m = ptn.match(
-0001bd50: 6866 6e29 0a20 2020 2020 2020 2020 2020  hfn).           
-0001bd60: 2020 2020 2069 6620 6e6f 7420 6d3a 0a20       if not m:. 
-0001bd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bd80: 2020 2063 6f6e 7469 6e75 650a 0a20 2020     continue..   
-0001bd90: 2020 2020 2020 2020 2020 2020 2066 6e20               fn 
-0001bda0: 3d20 6d2e 6772 6f75 7028 3129 202b 206d  = m.group(1) + m
-0001bdb0: 2e67 726f 7570 2833 290a 2020 2020 2020  .group(3).      
-0001bdc0: 2020 2020 2020 2020 2020 6e2c 2074 732c            n, ts,
-0001bdd0: 205f 203d 2068 6973 742e 6765 7428 666e   _ = hist.get(fn
-0001bde0: 2c20 2830 2c20 302c 2022 2229 290a 2020  , (0, 0, "")).  
-0001bdf0: 2020 2020 2020 2020 2020 2020 2020 6869                hi
-0001be00: 7374 5b66 6e5d 203d 2028 6e20 2b20 312c  st[fn] = (n + 1,
-0001be10: 206d 6178 2874 732c 2066 6c6f 6174 286d   max(ts, float(m
-0001be20: 2e67 726f 7570 2832 2929 292c 2068 666e  .group(2))), hfn
-0001be30: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-0001be40: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-0001be50: 7373 0a0a 2020 2020 2020 2020 2320 7368  ss..        # sh
-0001be60: 6f77 2064 6f74 6669 6c65 7320 6966 2070  ow dotfiles if p
-0001be70: 6572 6d69 7474 6564 2061 6e64 2072 6571  ermitted and req
-0001be80: 7565 7374 6564 0a20 2020 2020 2020 2069  uested.        i
-0001be90: 6620 6e6f 7420 7365 6c66 2e61 7267 732e  f not self.args.
-0001bea0: 6564 206f 7220 2264 6f74 7322 206e 6f74  ed or "dots" not
-0001beb0: 2069 6e20 7365 6c66 2e75 7061 7261 6d3a   in self.uparam:
-0001bec0: 0a20 2020 2020 2020 2020 2020 206c 735f  .            ls_
-0001bed0: 6e61 6d65 7320 3d20 6578 636c 7564 655f  names = exclude_
-0001bee0: 646f 7466 696c 6573 286c 735f 6e61 6d65  dotfiles(ls_name
-0001bef0: 7329 0a0a 2020 2020 2020 2020 6164 645f  s)..        add_
-0001bf00: 666b 203d 2076 6e2e 666c 6167 732e 6765  fk = vn.flags.ge
-0001bf10: 7428 2266 6b22 290a 0a20 2020 2020 2020  t("fk")..       
-0001bf20: 2064 6972 7320 3d20 5b5d 0a20 2020 2020   dirs = [].     
-0001bf30: 2020 2066 696c 6573 203d 205b 5d0a 2020     files = [].  
-0001bf40: 2020 2020 2020 666f 7220 666e 2069 6e20        for fn in 
-0001bf50: 6c73 5f6e 616d 6573 3a0a 2020 2020 2020  ls_names:.      
-0001bf60: 2020 2020 2020 6261 7365 203d 2022 220a        base = "".
-0001bf70: 2020 2020 2020 2020 2020 2020 6872 6566              href
-0001bf80: 203d 2066 6e0a 2020 2020 2020 2020 2020   = fn.          
-0001bf90: 2020 6966 206e 6f74 2069 735f 6c73 2061    if not is_ls a
-0001bfa0: 6e64 206e 6f74 2069 735f 6a73 2061 6e64  nd not is_js and
-0001bfb0: 206e 6f74 2073 656c 662e 7472 6169 6c69   not self.traili
-0001bfc0: 6e67 5f73 6c61 7368 2061 6e64 2076 7061  ng_slash and vpa
-0001bfd0: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
-0001bfe0: 2020 2020 6261 7365 203d 2022 2f22 202b      base = "/" +
-0001bff0: 2076 7061 7468 202b 2022 2f22 0a20 2020   vpath + "/".   
-0001c000: 2020 2020 2020 2020 2020 2020 2068 7265               hre
-0001c010: 6620 3d20 6261 7365 202b 2066 6e0a 0a20  f = base + fn.. 
-0001c020: 2020 2020 2020 2020 2020 2069 6620 666e             if fn
-0001c030: 2069 6e20 7666 735f 7669 7274 3a0a 2020   in vfs_virt:.  
-0001c040: 2020 2020 2020 2020 2020 2020 2020 6673                fs
-0001c050: 7061 7468 203d 2076 6673 5f76 6972 745b  path = vfs_virt[
-0001c060: 666e 5d2e 7265 616c 7061 7468 0a20 2020  fn].realpath.   
-0001c070: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0001c080: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001c090: 7370 6174 6820 3d20 6673 726f 6f74 202b  spath = fsroot +
-0001c0a0: 2022 2f22 202b 2066 6e0a 0a20 2020 2020   "/" + fn..     
-0001c0b0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0001c0c0: 2020 2020 2020 2020 2020 2020 696e 6620              inf 
-0001c0d0: 3d20 7374 6174 732e 6765 7428 666e 2920  = stats.get(fn) 
-0001c0e0: 6f72 2062 6f73 2e73 7461 7428 6673 7061  or bos.stat(fspa
-0001c0f0: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
-0001c100: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-0001c110: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
-0001c120: 2822 6272 6f6b 656e 2073 796d 6c69 6e6b  ("broken symlink
-0001c130: 3a20 7b7d 222e 666f 726d 6174 2872 6570  : {}".format(rep
-0001c140: 7228 6673 7061 7468 2929 290a 2020 2020  r(fspath))).    
-0001c150: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0001c160: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
-0001c170: 2020 6973 5f64 6972 203d 2073 7461 742e    is_dir = stat.
-0001c180: 535f 4953 4449 5228 696e 662e 7374 5f6d  S_ISDIR(inf.st_m
-0001c190: 6f64 6529 0a20 2020 2020 2020 2020 2020  ode).           
-0001c1a0: 2069 6620 6973 5f64 6972 3a0a 2020 2020   if is_dir:.    
-0001c1b0: 2020 2020 2020 2020 2020 2020 6872 6566              href
-0001c1c0: 202b 3d20 222f 220a 2020 2020 2020 2020   += "/".        
-0001c1d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001c1e0: 6172 6773 2e6e 6f5f 7a69 703a 0a20 2020  args.no_zip:.   
-0001c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c200: 206d 6172 6769 6e20 3d20 2244 4952 220a   margin = "DIR".
-0001c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c220: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001c230: 2020 2020 2020 2020 2020 6d61 7267 696e            margin
-0001c240: 203d 2027 3c61 2068 7265 663d 227b 7d3f   = '<a href="{}?
-0001c250: 7a69 7022 2072 656c 3d22 6e6f 666f 6c6c  zip" rel="nofoll
-0001c260: 6f77 223e 7a69 703c 2f61 3e27 2e66 6f72  ow">zip</a>'.for
-0001c270: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-0001c280: 2020 2020 2020 2020 2020 2020 2071 756f               quo
-0001c290: 7465 7028 6872 6566 290a 2020 2020 2020  tep(href).      
-0001c2a0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001c2b0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0001c2c0: 2066 6e20 696e 2068 6973 743a 0a20 2020   fn in hist:.   
-0001c2d0: 2020 2020 2020 2020 2020 2020 206d 6172               mar
-0001c2e0: 6769 6e20 3d20 273c 6120 6872 6566 3d22  gin = '<a href="
-0001c2f0: 7b7d 2e68 6973 742f 7b7d 223e 237b 7d3c  {}.hist/{}">#{}<
-0001c300: 2f61 3e27 2e66 6f72 6d61 7428 0a20 2020  /a>'.format(.   
-0001c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c320: 2062 6173 652c 2068 746d 6c5f 6573 6361   base, html_esca
-0001c330: 7065 2868 6973 745b 666e 5d5b 325d 2c20  pe(hist[fn][2], 
-0001c340: 7175 6f74 3d54 7275 652c 2063 726c 663d  quot=True, crlf=
-0001c350: 5472 7565 292c 2068 6973 745b 666e 5d5b  True), hist[fn][
-0001c360: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-0001c370: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001c380: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001c390: 2020 2020 2020 206d 6172 6769 6e20 3d20         margin = 
-0001c3a0: 222d 220a 0a20 2020 2020 2020 2020 2020  "-"..           
-0001c3b0: 2073 7a20 3d20 696e 662e 7374 5f73 697a   sz = inf.st_siz
-0001c3c0: 650a 2020 2020 2020 2020 2020 2020 7a64  e.            zd
-0001c3d0: 203d 2064 6174 6574 696d 652e 7574 6366   = datetime.utcf
-0001c3e0: 726f 6d74 696d 6573 7461 6d70 2869 6e66  romtimestamp(inf
-0001c3f0: 2e73 745f 6d74 696d 6529 0a20 2020 2020  .st_mtime).     
-0001c400: 2020 2020 2020 2064 7420 3d20 7a64 2e73         dt = zd.s
-0001c410: 7472 6674 696d 6528 2225 592d 256d 2d25  trftime("%Y-%m-%
-0001c420: 6420 2548 3a25 4d3a 2553 2229 0a0a 2020  d %H:%M:%S")..  
-0001c430: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
-0001c440: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0001c450: 7874 203d 2022 2d2d 2d22 2069 6620 6973  xt = "---" if is
-0001c460: 5f64 6972 2065 6c73 6520 666e 2e72 7370  _dir else fn.rsp
-0001c470: 6c69 7428 222e 222c 2031 295b 315d 0a20  lit(".", 1)[1]. 
-0001c480: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001c490: 6620 6c65 6e28 6578 7429 203e 2031 363a  f len(ext) > 16:
-0001c4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c4b0: 2020 2020 2065 7874 203d 2065 7874 5b3a       ext = ext[:
-0001c4c0: 3136 5d0a 2020 2020 2020 2020 2020 2020  16].            
-0001c4d0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
-0001c4e0: 2020 2020 2020 2020 6578 7420 3d20 2225          ext = "%
-0001c4f0: 220a 0a20 2020 2020 2020 2020 2020 2069  "..            i
-0001c500: 6620 6164 645f 666b 3a0a 2020 2020 2020  f add_fk:.      
-0001c510: 2020 2020 2020 2020 2020 6872 6566 203d            href =
-0001c520: 2022 7b7d 3f6b 3d7b 7d22 2e66 6f72 6d61   "{}?k={}".forma
-0001c530: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0001c540: 2020 2020 2020 2071 756f 7465 7028 6872         quotep(hr
-0001c550: 6566 292c 0a20 2020 2020 2020 2020 2020  ef),.           
-0001c560: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
-0001c570: 6e5f 666b 280a 2020 2020 2020 2020 2020  n_fk(.          
-0001c580: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001c590: 6c66 2e61 7267 732e 666b 5f73 616c 742c  lf.args.fk_salt,
-0001c5a0: 2066 7370 6174 682c 2073 7a2c 2030 2069   fspath, sz, 0 i
-0001c5b0: 6620 414e 5957 494e 2065 6c73 6520 696e  f ANYWIN else in
-0001c5c0: 662e 7374 5f69 6e6f 0a20 2020 2020 2020  f.st_ino.       
-0001c5d0: 2020 2020 2020 2020 2020 2020 2029 5b3a               )[:
-0001c5e0: 6164 645f 666b 5d2c 0a20 2020 2020 2020  add_fk],.       
-0001c5f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001c600: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001c610: 2020 2020 2020 2020 2020 2020 2068 7265               hre
-0001c620: 6620 3d20 7175 6f74 6570 2868 7265 6629  f = quotep(href)
-0001c630: 0a0a 2020 2020 2020 2020 2020 2020 6974  ..            it
-0001c640: 656d 203d 207b 0a20 2020 2020 2020 2020  em = {.         
-0001c650: 2020 2020 2020 2022 6c65 6164 223a 206d         "lead": m
-0001c660: 6172 6769 6e2c 0a20 2020 2020 2020 2020  argin,.         
-0001c670: 2020 2020 2020 2022 6872 6566 223a 2068         "href": h
-0001c680: 7265 662c 0a20 2020 2020 2020 2020 2020  ref,.           
-0001c690: 2020 2020 2022 6e61 6d65 223a 2066 6e2c       "name": fn,
-0001c6a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c6b0: 2022 737a 223a 2073 7a2c 0a20 2020 2020   "sz": sz,.     
-0001c6c0: 2020 2020 2020 2020 2020 2022 6578 7422             "ext"
-0001c6d0: 3a20 6578 742c 0a20 2020 2020 2020 2020  : ext,.         
-0001c6e0: 2020 2020 2020 2022 6474 223a 2064 742c         "dt": dt,
-0001c6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c700: 2022 7473 223a 2069 6e74 2869 6e66 2e73   "ts": int(inf.s
-0001c710: 745f 6d74 696d 6529 2c0a 2020 2020 2020  t_mtime),.      
-0001c720: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001c730: 2020 2020 6966 2069 735f 6469 723a 0a20      if is_dir:. 
-0001c740: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0001c750: 6972 732e 6170 7065 6e64 2869 7465 6d29  irs.append(item)
-0001c760: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0001c770: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001c780: 2020 2066 696c 6573 2e61 7070 656e 6428     files.append(
-0001c790: 6974 656d 290a 2020 2020 2020 2020 2020  item).          
-0001c7a0: 2020 2020 2020 6974 656d 5b22 7264 225d        item["rd"]
-0001c7b0: 203d 2072 656d 0a0a 2020 2020 2020 2020   = rem..        
-0001c7c0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-0001c7d0: 2073 656c 662e 636f 6f6b 6965 732e 6765   self.cookies.ge
-0001c7e0: 7428 2269 6478 6822 2920 3d3d 2022 7922  t("idxh") == "y"
-0001c7f0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-0001c800: 2022 6c73 2220 6e6f 7420 696e 2073 656c   "ls" not in sel
-0001c810: 662e 7570 6172 616d 0a20 2020 2020 2020  f.uparam.       
-0001c820: 2020 2020 2061 6e64 2022 7622 206e 6f74       and "v" not
-0001c830: 2069 6e20 7365 6c66 2e75 7061 7261 6d0a   in self.uparam.
-0001c840: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
-0001c850: 2020 2020 2020 2069 6478 5f68 746d 6c20         idx_html 
-0001c860: 3d20 7365 7428 5b22 696e 6465 782e 6874  = set(["index.ht
-0001c870: 6d22 2c20 2269 6e64 6578 2e68 746d 6c22  m", "index.html"
-0001c880: 5d29 0a20 2020 2020 2020 2020 2020 2066  ]).            f
-0001c890: 6f72 2069 7465 6d20 696e 2066 696c 6573  or item in files
-0001c8a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001c8b0: 2020 6966 2069 7465 6d5b 226e 616d 6522    if item["name"
-0001c8c0: 5d20 696e 2069 6478 5f68 746d 6c3a 0a20  ] in idx_html:. 
-0001c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8e0: 2020 2023 2064 6f20 6675 6c6c 2072 6573     # do full res
-0001c8f0: 6f6c 7665 2069 6e20 6361 7365 206f 6620  olve in case of 
-0001c900: 7368 6164 6f77 6564 2066 696c 650a 2020  shadowed file.  
-0001c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c920: 2020 7670 203d 2076 6a6f 696e 2873 656c    vp = vjoin(sel
-0001c930: 662e 7670 6174 682e 7370 6c69 7428 223f  f.vpath.split("?
-0001c940: 2229 5b30 5d2c 2069 7465 6d5b 226e 616d  ")[0], item["nam
-0001c950: 6522 5d29 0a20 2020 2020 2020 2020 2020  e"]).           
-0001c960: 2020 2020 2020 2020 2076 6e2c 2072 656d           vn, rem
-0001c970: 203d 2073 656c 662e 6173 7276 2e76 6673   = self.asrv.vfs
-0001c980: 2e67 6574 2876 702c 2073 656c 662e 756e  .get(vp, self.un
-0001c990: 616d 652c 2054 7275 652c 2046 616c 7365  ame, True, False
-0001c9a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001c9b0: 2020 2020 2020 6170 203d 2076 6e2e 6361        ap = vn.ca
-0001c9c0: 6e6f 6e69 6361 6c28 7265 6d29 0a20 2020  nonical(rem).   
-0001c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c9e0: 2072 6574 7572 6e20 7365 6c66 2e74 785f   return self.tx_
-0001c9f0: 6669 6c65 2861 7029 2020 2320 6973 206e  file(ap)  # is n
-0001ca00: 6f2d 6361 6368 650a 0a20 2020 2020 2020  o-cache..       
-0001ca10: 2074 6167 7365 7420 203d 2073 6574 2829   tagset  = set()
-0001ca20: 0a20 2020 2020 2020 2066 6f72 2066 6520  .        for fe 
-0001ca30: 696e 2066 696c 6573 3a0a 2020 2020 2020  in files:.      
-0001ca40: 2020 2020 2020 666e 203d 2066 655b 226e        fn = fe["n
-0001ca50: 616d 6522 5d0a 2020 2020 2020 2020 2020  ame"].          
-0001ca60: 2020 7264 203d 2066 655b 2272 6422 5d0a    rd = fe["rd"].
-0001ca70: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0001ca80: 6665 5b22 7264 225d 0a20 2020 2020 2020  fe["rd"].       
-0001ca90: 2020 2020 2069 6620 6e6f 7420 6963 7572       if not icur
-0001caa0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001cab0: 2020 636f 6e74 696e 7565 0a0a 2020 2020    continue..    
-0001cac0: 2020 2020 2020 2020 6966 2076 6e20 213d          if vn !=
-0001cad0: 2064 6276 3a0a 2020 2020 2020 2020 2020   dbv:.          
-0001cae0: 2020 2020 2020 5f2c 2072 6420 3d20 766e        _, rd = vn
-0001caf0: 2e67 6574 5f64 6276 2872 6429 0a0a 2020  .get_dbv(rd)..  
-0001cb00: 2020 2020 2020 2020 2020 7120 3d20 2273            q = "s
-0001cb10: 656c 6563 7420 6d74 2e6b 2c20 6d74 2e76  elect mt.k, mt.v
-0001cb20: 2066 726f 6d20 7570 2069 6e6e 6572 206a   from up inner j
-0001cb30: 6f69 6e20 6d74 206f 6e20 6d74 2e77 203d  oin mt on mt.w =
-0001cb40: 2073 7562 7374 7228 7570 2e77 2c31 2c31   substr(up.w,1,1
-0001cb50: 3629 2077 6865 7265 2075 702e 7264 203d  6) where up.rd =
-0001cb60: 203f 2061 6e64 2075 702e 666e 203d 203f   ? and up.fn = ?
-0001cb70: 2061 6e64 202b 6d74 2e6b 2021 3d20 2778   and +mt.k != 'x
-0001cb80: 2722 0a20 2020 2020 2020 2020 2020 2074  '".            t
-0001cb90: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0001cba0: 2020 2020 7220 3d20 6963 7572 2e65 7865      r = icur.exe
-0001cbb0: 6375 7465 2871 2c20 2872 642c 2066 6e29  cute(q, (rd, fn)
-0001cbc0: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-0001cbd0: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
-0001cbe0: 7320 6578 3a0a 2020 2020 2020 2020 2020  s ex:.          
-0001cbf0: 2020 2020 2020 6966 2022 6461 7461 6261        if "databa
-0001cc00: 7365 2069 7320 6c6f 636b 6564 2220 696e  se is locked" in
-0001cc10: 2073 7472 2865 7829 3a0a 2020 2020 2020   str(ex):.      
-0001cc20: 2020 2020 2020 2020 2020 2020 2020 6272                br
-0001cc30: 6561 6b0a 0a20 2020 2020 2020 2020 2020  eak..           
-0001cc40: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0001cc50: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-0001cc60: 6773 203d 2073 3365 6e63 2869 6478 2e6d  gs = s3enc(idx.m
-0001cc70: 656d 5f63 7572 2c20 7264 2c20 666e 290a  em_cur, rd, fn).
-0001cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cc90: 2020 2020 7220 3d20 6963 7572 2e65 7865      r = icur.exe
-0001cca0: 6375 7465 2871 2c20 6172 6773 290a 2020  cute(q, args).  
-0001ccb0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0001ccc0: 6365 7074 3a0a 2020 2020 2020 2020 2020  cept:.          
-0001ccd0: 2020 2020 2020 2020 2020 7420 3d20 2274            t = "t
-0001cce0: 6167 2072 6561 6420 6572 726f 722c 207b  ag read error, {
-0001ccf0: 7d2f 7b7d 5c6e 7b7d 220a 2020 2020 2020  }/{}\n{}".      
-0001cd00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001cd10: 6c66 2e6c 6f67 2874 2e66 6f72 6d61 7428  lf.log(t.format(
-0001cd20: 7264 2c20 666e 2c20 6d69 6e5f 6578 2829  rd, fn, min_ex()
-0001cd30: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001cd40: 2020 2020 2020 2062 7265 616b 0a0a 2020         break..  
-0001cd50: 2020 2020 2020 2020 2020 6665 5b22 7461            fe["ta
-0001cd60: 6773 225d 203d 207b 6b3a 2076 2066 6f72  gs"] = {k: v for
-0001cd70: 206b 2c20 7620 696e 2072 7d0a 2020 2020   k, v in r}.    
-0001cd80: 2020 2020 2020 2020 5f20 3d20 5b74 6167          _ = [tag
-0001cd90: 7365 742e 6164 6428 6b29 2066 6f72 206b  set.add(k) for k
-0001cda0: 2069 6e20 6665 5b22 7461 6773 225d 5d0a   in fe["tags"]].
-0001cdb0: 0a20 2020 2020 2020 2069 6620 6963 7572  .        if icur
-0001cdc0: 3a0a 2020 2020 2020 2020 2020 2020 7461  :.            ta
-0001cdd0: 676c 6973 7420 3d20 5b6b 2066 6f72 206b  glist = [k for k
-0001cde0: 2069 6e20 766e 2e66 6c61 6773 2e67 6574   in vn.flags.get
-0001cdf0: 2822 6d74 6522 2c20 2222 292e 7370 6c69  ("mte", "").spli
-0001ce00: 7428 222c 2229 2069 6620 6b20 696e 2074  t(",") if k in t
-0001ce10: 6167 7365 745d 0a20 2020 2020 2020 2020  agset].         
-0001ce20: 2020 2066 6f72 2066 6520 696e 2064 6972     for fe in dir
-0001ce30: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0001ce40: 2020 2066 655b 2274 6167 7322 5d20 3d20     fe["tags"] = 
-0001ce50: 7b7d 0a20 2020 2020 2020 2065 6c73 653a  {}.        else:
-0001ce60: 0a20 2020 2020 2020 2020 2020 2074 6167  .            tag
-0001ce70: 6c69 7374 203d 206c 6973 7428 7461 6773  list = list(tags
-0001ce80: 6574 290a 0a20 2020 2020 2020 2069 6620  et)..        if 
-0001ce90: 6973 5f6c 733a 0a20 2020 2020 2020 2020  is_ls:.         
-0001cea0: 2020 206c 735f 7265 745b 2264 6972 7322     ls_ret["dirs"
-0001ceb0: 5d20 3d20 6469 7273 0a20 2020 2020 2020  ] = dirs.       
-0001cec0: 2020 2020 206c 735f 7265 745b 2266 696c       ls_ret["fil
-0001ced0: 6573 225d 203d 2066 696c 6573 0a20 2020  es"] = files.   
-0001cee0: 2020 2020 2020 2020 206c 735f 7265 745b           ls_ret[
-0001cef0: 2274 6167 6c69 7374 225d 203d 2074 6167  "taglist"] = tag
-0001cf00: 6c69 7374 0a20 2020 2020 2020 2020 2020  list.           
-0001cf10: 2072 6574 7572 6e20 7365 6c66 2e74 785f   return self.tx_
-0001cf20: 6c73 286c 735f 7265 7429 0a0a 2020 2020  ls(ls_ret)..    
-0001cf30: 2020 2020 646f 6320 3d20 7365 6c66 2e75      doc = self.u
-0001cf40: 7061 7261 6d2e 6765 7428 2264 6f63 2229  param.get("doc")
-0001cf50: 2069 6620 7365 6c66 2e63 616e 5f72 6561   if self.can_rea
-0001cf60: 6420 656c 7365 204e 6f6e 650a 2020 2020  d else None.    
-0001cf70: 2020 2020 6966 2064 6f63 3a0a 2020 2020      if doc:.    
-0001cf80: 2020 2020 2020 2020 646f 6320 3d20 756e          doc = un
-0001cf90: 7175 6f74 6570 2864 6f63 2e72 6570 6c61  quotep(doc.repla
-0001cfa0: 6365 2822 2b22 2c20 2220 2229 2e73 706c  ce("+", " ").spl
-0001cfb0: 6974 2822 3f22 295b 305d 290a 2020 2020  it("?")[0]).    
-0001cfc0: 2020 2020 2020 2020 6a32 615b 2264 6f63          j2a["doc
-0001cfd0: 6e61 6d65 225d 203d 2064 6f63 0a20 2020  name"] = doc.   
-0001cfe0: 2020 2020 2020 2020 2064 6f63 7478 7420           doctxt 
-0001cff0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-0001d000: 2020 2069 6620 6e65 7874 2828 7820 666f     if next((x fo
-0001d010: 7220 7820 696e 2066 696c 6573 2069 6620  r x in files if 
-0001d020: 785b 226e 616d 6522 5d20 3d3d 2064 6f63  x["name"] == doc
-0001d030: 292c 204e 6f6e 6529 3a0a 2020 2020 2020  ), None):.      
-0001d040: 2020 2020 2020 2020 2020 646f 6370 6174            docpat
-0001d050: 6820 3d20 6f73 2e70 6174 682e 6a6f 696e  h = os.path.join
-0001d060: 2861 6273 7061 7468 2c20 646f 6329 0a20  (abspath, doc). 
-0001d070: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001d080: 7a20 3d20 626f 732e 7061 7468 2e67 6574  z = bos.path.get
-0001d090: 7369 7a65 2864 6f63 7061 7468 290a 2020  size(docpath).  
-0001d0a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001d0b0: 2073 7a20 3c20 3130 3234 202a 2073 656c   sz < 1024 * sel
-0001d0c0: 662e 6172 6773 2e74 7874 5f6d 6178 3a0a  f.args.txt_max:.
-0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d0e0: 2020 2020 7769 7468 206f 7065 6e28 6673      with open(fs
-0001d0f0: 656e 6328 646f 6370 6174 6829 2c20 2272  enc(docpath), "r
-0001d100: 6222 2920 6173 2066 3a0a 2020 2020 2020  b") as f:.      
-0001d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d120: 2020 646f 6374 7874 203d 2066 2e72 6561    doctxt = f.rea
-0001d130: 6428 292e 6465 636f 6465 2822 7574 662d  d().decode("utf-
-0001d140: 3822 2c20 2272 6570 6c61 6365 2229 0a20  8", "replace"). 
-0001d150: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001d160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d170: 2073 656c 662e 6c6f 6728 2264 6f63 2034   self.log("doc 4
-0001d180: 3034 3a20 5b7b 7d5d 222e 666f 726d 6174  04: [{}]".format
-0001d190: 2864 6f63 292c 2063 3d36 290a 2020 2020  (doc), c=6).    
-0001d1a0: 2020 2020 2020 2020 2020 2020 646f 6374              doct
-0001d1b0: 7874 203d 2022 2820 7465 7874 6669 6c65  xt = "( textfile
-0001d1c0: 206e 6f74 2066 6f75 6e64 2029 220a 0a20   not found )".. 
-0001d1d0: 2020 2020 2020 2020 2020 2069 6620 646f             if do
-0001d1e0: 6374 7874 2069 7320 6e6f 7420 4e6f 6e65  ctxt is not None
-0001d1f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001d200: 2020 6a32 615b 2264 6f63 225d 203d 2064    j2a["doc"] = d
-0001d210: 6f63 7478 740a 0a20 2020 2020 2020 2066  octxt..        f
-0001d220: 6f72 2064 2069 6e20 6469 7273 3a0a 2020  or d in dirs:.  
-0001d230: 2020 2020 2020 2020 2020 645b 226e 616d            d["nam
-0001d240: 6522 5d20 2b3d 2022 2f22 0a0a 2020 2020  e"] += "/"..    
-0001d250: 2020 2020 6469 7273 2e73 6f72 7428 6b65      dirs.sort(ke
-0001d260: 793d 6974 656d 6765 7474 6572 2822 6e61  y=itemgetter("na
-0001d270: 6d65 2229 290a 0a20 2020 2020 2020 2069  me"))..        i
-0001d280: 6620 6973 5f6a 733a 0a20 2020 2020 2020  f is_js:.       
-0001d290: 2020 2020 206a 3261 5b22 6c73 3022 5d20       j2a["ls0"] 
-0001d2a0: 3d20 7b22 6469 7273 223a 2064 6972 732c  = {"dirs": dirs,
-0001d2b0: 2022 6669 6c65 7322 3a20 6669 6c65 732c   "files": files,
-0001d2c0: 2022 7461 676c 6973 7422 3a20 7461 676c   "taglist": tagl
-0001d2d0: 6973 747d 0a20 2020 2020 2020 2020 2020  ist}.           
-0001d2e0: 206a 3261 5b22 6669 6c65 7322 5d20 3d20   j2a["files"] = 
-0001d2f0: 5b5d 0a20 2020 2020 2020 2065 6c73 653a  [].        else:
-0001d300: 0a20 2020 2020 2020 2020 2020 206a 3261  .            j2a
-0001d310: 5b22 6669 6c65 7322 5d20 3d20 6469 7273  ["files"] = dirs
-0001d320: 202b 2066 696c 6573 0a0a 2020 2020 2020   + files..      
-0001d330: 2020 6a32 615b 2274 6167 6c69 7374 225d    j2a["taglist"]
-0001d340: 203d 2074 6167 6c69 7374 0a20 2020 2020   = taglist.     
-0001d350: 2020 206a 3261 5b22 7478 745f 6578 7422     j2a["txt_ext"
-0001d360: 5d20 3d20 7365 6c66 2e61 7267 732e 7465  ] = self.args.te
-0001d370: 7874 6669 6c65 732e 7265 706c 6163 6528  xtfiles.replace(
-0001d380: 222c 222c 2022 2022 290a 0a20 2020 2020  ",", " ")..     
-0001d390: 2020 2069 6620 226d 7468 2220 696e 2076     if "mth" in v
-0001d3a0: 6e2e 666c 6167 733a 0a20 2020 2020 2020  n.flags:.       
-0001d3b0: 2020 2020 206a 3261 5b22 6465 665f 6863       j2a["def_hc
-0001d3c0: 6f6c 7322 5d20 3d20 766e 2e66 6c61 6773  ols"] = vn.flags
-0001d3d0: 5b22 6d74 6822 5d2e 7370 6c69 7428 222c  ["mth"].split(",
-0001d3e0: 2229 0a0a 2020 2020 2020 2020 6874 6d6c  ")..        html
-0001d3f0: 203d 2073 656c 662e 6a32 7328 7470 6c2c   = self.j2s(tpl,
-0001d400: 202a 2a6a 3261 290a 2020 2020 2020 2020   **j2a).        
-0001d410: 7365 6c66 2e72 6570 6c79 2868 746d 6c2e  self.reply(html.
-0001d420: 656e 636f 6465 2822 7574 662d 3822 2c20  encode("utf-8", 
-0001d430: 2272 6570 6c61 6365 2229 290a 2020 2020  "replace")).    
-0001d440: 2020 2020 7265 7475 726e 2054 7275 650a      return True.
+0001a060: 6966 2078 2069 6e20 6c73 0a20 2020 2020  if x in ls.     
+0001a070: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
+0001a080: 2020 2020 2072 6574 6c20 2b3d 205b 0a20       retl += [. 
+0001a090: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001a0a0: 6d74 2e66 6f72 6d61 7428 785b 2264 7422  mt.format(x["dt"
+0001a0b0: 5d2c 2078 5b22 737a 225d 2c20 785b 226e  ], x["sz"], x["n
+0001a0c0: 616d 6522 5d29 0a20 2020 2020 2020 2020  ame"]).         
+0001a0d0: 2020 2020 2020 2066 6f72 2079 2069 6e20         for y in 
+0001a0e0: 5b64 6972 732c 2066 696c 6573 5d0a 2020  [dirs, files].  
+0001a0f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001a100: 7220 7820 696e 2079 0a20 2020 2020 2020  r x in y.       
+0001a110: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+0001a120: 2020 2072 6574 203d 2022 5c6e 222e 6a6f     ret = "\n".jo
+0001a130: 696e 2872 6574 6c29 0a20 2020 2020 2020  in(retl).       
+0001a140: 2020 2020 206d 696d 6520 3d20 2274 6578       mime = "tex
+0001a150: 742f 706c 6169 6e3b 2063 6861 7273 6574  t/plain; charset
+0001a160: 3d75 7466 2d38 220a 2020 2020 2020 2020  =utf-8".        
+0001a170: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001a180: 2020 5b78 2e70 6f70 286b 2920 666f 7220    [x.pop(k) for 
+0001a190: 6b20 696e 205b 226e 616d 6522 2c20 2264  k in ["name", "d
+0001a1a0: 7422 5d20 666f 7220 7920 696e 205b 6469  t"] for y in [di
+0001a1b0: 7273 2c20 6669 6c65 735d 2066 6f72 2078  rs, files] for x
+0001a1c0: 2069 6e20 795d 0a0a 2020 2020 2020 2020   in y]..        
+0001a1d0: 2020 2020 7265 7420 3d20 6a73 6f6e 2e64      ret = json.d
+0001a1e0: 756d 7073 286c 7329 0a20 2020 2020 2020  umps(ls).       
+0001a1f0: 2020 2020 206d 696d 6520 3d20 2261 7070       mime = "app
+0001a200: 6c69 6361 7469 6f6e 2f6a 736f 6e22 0a0a  lication/json"..
+0001a210: 2020 2020 2020 2020 7265 7420 2b3d 2022          ret += "
+0001a220: 5c6e 5c30 3333 5b30 6d22 2069 6620 6172  \n\033[0m" if ar
+0001a230: 6720 3d3d 2022 7622 2065 6c73 6520 225c  g == "v" else "\
+0001a240: 6e22 0a20 2020 2020 2020 2073 656c 662e  n".        self.
+0001a250: 7265 706c 7928 7265 742e 656e 636f 6465  reply(ret.encode
+0001a260: 2822 7574 662d 3822 2c20 2272 6570 6c61  ("utf-8", "repla
+0001a270: 6365 2229 2c20 6d69 6d65 3d6d 696d 6529  ce"), mime=mime)
+0001a280: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001a290: 5472 7565 0a0a 2020 2020 6465 6620 7478  True..    def tx
+0001a2a0: 5f62 726f 7773 6572 2873 656c 6629 2020  _browser(self)  
+0001a2b0: 3a0a 2020 2020 2020 2020 7670 6174 6820  :.        vpath 
+0001a2c0: 3d20 2222 0a20 2020 2020 2020 2076 706e  = "".        vpn
+0001a2d0: 6f64 6573 203d 205b 5b22 222c 2022 2f22  odes = [["", "/"
+0001a2e0: 5d5d 0a20 2020 2020 2020 2069 6620 7365  ]].        if se
+0001a2f0: 6c66 2e76 7061 7468 3a0a 2020 2020 2020  lf.vpath:.      
+0001a300: 2020 2020 2020 666f 7220 6e6f 6465 2069        for node i
+0001a310: 6e20 7365 6c66 2e76 7061 7468 2e73 706c  n self.vpath.spl
+0001a320: 6974 2822 2f22 293a 0a20 2020 2020 2020  it("/"):.       
+0001a330: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001a340: 7670 6174 683a 0a20 2020 2020 2020 2020  vpath:.         
+0001a350: 2020 2020 2020 2020 2020 2076 7061 7468             vpath
+0001a360: 203d 206e 6f64 650a 2020 2020 2020 2020   = node.        
+0001a370: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001a380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a390: 2020 7670 6174 6820 2b3d 2022 2f22 202b    vpath += "/" +
+0001a3a0: 206e 6f64 650a 0a20 2020 2020 2020 2020   node..         
+0001a3b0: 2020 2020 2020 2076 706e 6f64 6573 2e61         vpnodes.a
+0001a3c0: 7070 656e 6428 5b71 756f 7465 7028 7670  ppend([quotep(vp
+0001a3d0: 6174 6829 202b 2022 2f22 2c20 6874 6d6c  ath) + "/", html
+0001a3e0: 5f65 7363 6170 6528 6e6f 6465 2c20 6372  _escape(node, cr
+0001a3f0: 6c66 3d54 7275 6529 5d29 0a0a 2020 2020  lf=True)])..    
+0001a400: 2020 2020 766e 2c20 7265 6d20 3d20 7365      vn, rem = se
+0001a410: 6c66 2e61 7372 762e 7666 732e 6765 7428  lf.asrv.vfs.get(
+0001a420: 7365 6c66 2e76 7061 7468 2c20 7365 6c66  self.vpath, self
+0001a430: 2e75 6e61 6d65 2c20 4661 6c73 652c 2046  .uname, False, F
+0001a440: 616c 7365 290a 2020 2020 2020 2020 6162  alse).        ab
+0001a450: 7370 6174 6820 3d20 766e 2e64 6361 6e6f  spath = vn.dcano
+0001a460: 6e69 6361 6c28 7265 6d29 0a20 2020 2020  nical(rem).     
+0001a470: 2020 2064 6276 2c20 7672 656d 203d 2076     dbv, vrem = v
+0001a480: 6e2e 6765 745f 6462 7628 7265 6d29 0a0a  n.get_dbv(rem)..
+0001a490: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0001a4a0: 2020 2020 2020 2020 2073 7420 3d20 626f           st = bo
+0001a4b0: 732e 7374 6174 2861 6273 7061 7468 290a  s.stat(abspath).
+0001a4c0: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+0001a4d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001a4e0: 726e 2073 656c 662e 7478 5f34 3034 2829  rn self.tx_404()
+0001a4f0: 0a0a 2020 2020 2020 2020 6966 2072 656d  ..        if rem
+0001a500: 2e73 7461 7274 7377 6974 6828 222e 6869  .startswith(".hi
+0001a510: 7374 2f75 7032 6b2e 2229 206f 7220 280a  st/up2k.") or (.
+0001a520: 2020 2020 2020 2020 2020 2020 7265 6d2e              rem.
+0001a530: 656e 6473 7769 7468 2822 2f64 6972 2e74  endswith("/dir.t
+0001a540: 7874 2229 2061 6e64 2072 656d 2e73 7461  xt") and rem.sta
+0001a550: 7274 7377 6974 6828 222e 6869 7374 2f74  rtswith(".hist/t
+0001a560: 682f 2229 0a20 2020 2020 2020 2029 3a0a  h/").        ):.
+0001a570: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001a580: 6520 5065 626b 6163 2834 3033 290a 0a20  e Pebkac(403).. 
+0001a590: 2020 2020 2020 2065 3264 203d 2022 6532         e2d = "e2
+0001a5a0: 6422 2069 6e20 766e 2e66 6c61 6773 0a20  d" in vn.flags. 
+0001a5b0: 2020 2020 2020 2065 3274 203d 2022 6532         e2t = "e2
+0001a5c0: 7422 2069 6e20 766e 2e66 6c61 6773 0a0a  t" in vn.flags..
+0001a5d0: 2020 2020 2020 2020 7365 6c66 2e68 746d          self.htm
+0001a5e0: 6c5f 6865 6164 203d 2076 6e2e 666c 6167  l_head = vn.flag
+0001a5f0: 732e 6765 7428 2268 746d 6c5f 6865 6164  s.get("html_head
+0001a600: 222c 2022 2229 0a20 2020 2020 2020 2069  ", "").        i
+0001a610: 6620 766e 2e66 6c61 6773 2e67 6574 2822  f vn.flags.get("
+0001a620: 6e6f 726f 626f 7473 2229 206f 7220 2262  norobots") or "b
+0001a630: 2220 696e 2073 656c 662e 7570 6172 616d  " in self.uparam
+0001a640: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0001a650: 6c66 2e6f 7574 5f68 6561 6465 7273 5b22  lf.out_headers["
+0001a660: 582d 526f 626f 7473 2d54 6167 225d 203d  X-Robots-Tag"] =
+0001a670: 2022 6e6f 696e 6465 782c 206e 6f66 6f6c   "noindex, nofol
+0001a680: 6c6f 7722 0a20 2020 2020 2020 2065 6c73  low".        els
+0001a690: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0001a6a0: 656c 662e 6f75 745f 6865 6164 6572 732e  elf.out_headers.
+0001a6b0: 706f 7028 2258 2d52 6f62 6f74 732d 5461  pop("X-Robots-Ta
+0001a6c0: 6722 2c20 4e6f 6e65 290a 0a20 2020 2020  g", None)..     
+0001a6d0: 2020 2069 735f 6469 7220 3d20 7374 6174     is_dir = stat
+0001a6e0: 2e53 5f49 5344 4952 2873 742e 7374 5f6d  .S_ISDIR(st.st_m
+0001a6f0: 6f64 6529 0a20 2020 2020 2020 2069 6375  ode).        icu
+0001a700: 7220 3d20 4e6f 6e65 0a20 2020 2020 2020  r = None.       
+0001a710: 2069 6620 6973 5f64 6972 2061 6e64 2028   if is_dir and (
+0001a720: 6532 7420 6f72 2065 3264 293a 0a20 2020  e2t or e2d):.   
+0001a730: 2020 2020 2020 2020 2069 6478 203d 2073           idx = s
+0001a740: 656c 662e 636f 6e6e 2e67 6574 5f75 3269  elf.conn.get_u2i
+0001a750: 6478 2829 0a20 2020 2020 2020 2020 2020  dx().           
+0001a760: 2069 6620 6964 7820 616e 6420 6861 7361   if idx and hasa
+0001a770: 7474 7228 6964 782c 2022 705f 656e 6422  ttr(idx, "p_end"
+0001a780: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001a790: 2020 2069 6375 7220 3d20 6964 782e 6765     icur = idx.ge
+0001a7a0: 745f 6375 7228 6462 762e 7265 616c 7061  t_cur(dbv.realpa
+0001a7b0: 7468 290a 0a20 2020 2020 2020 2069 6620  th)..        if 
+0001a7c0: 7365 6c66 2e63 616e 5f72 6561 643a 0a20  self.can_read:. 
+0001a7d0: 2020 2020 2020 2020 2020 2074 685f 666d             th_fm
+0001a7e0: 7420 3d20 7365 6c66 2e75 7061 7261 6d2e  t = self.uparam.
+0001a7f0: 6765 7428 2274 6822 290a 2020 2020 2020  get("th").      
+0001a800: 2020 2020 2020 6966 2074 685f 666d 7420        if th_fmt 
+0001a810: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001a820: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001a830: 6973 5f64 6972 3a0a 2020 2020 2020 2020  is_dir:.        
+0001a840: 2020 2020 2020 2020 2020 2020 7672 656d              vrem
+0001a850: 203d 2076 7265 6d2e 7273 7472 6970 2822   = vrem.rstrip("
+0001a860: 2f22 290a 2020 2020 2020 2020 2020 2020  /").            
+0001a870: 2020 2020 2020 2020 6966 2069 6375 7220          if icur 
+0001a880: 616e 6420 7672 656d 3a0a 2020 2020 2020  and vrem:.      
+0001a890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a8a0: 2020 7120 3d20 2273 656c 6563 7420 666e    q = "select fn
+0001a8b0: 2066 726f 6d20 6376 2077 6865 7265 2072   from cv where r
+0001a8c0: 643d 3f20 616e 6420 646e 3d3f 220a 2020  d=? and dn=?".  
+0001a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a8e0: 2020 2020 2020 6372 642c 2063 646e 203d        crd, cdn =
+0001a8f0: 2076 7265 6d2e 7273 706c 6974 2822 2f22   vrem.rsplit("/"
+0001a900: 2c20 3129 2069 6620 222f 2220 696e 2076  , 1) if "/" in v
+0001a910: 7265 6d20 656c 7365 2028 2222 2c20 7672  rem else ("", vr
+0001a920: 656d 290a 2020 2020 2020 2020 2020 2020  em).            
+0001a930: 2020 2020 2020 2020 2020 2020 2320 6e6f              # no
+0001a940: 206d 6f6a 6962 616b 6520 7375 7070 6f72   mojibake suppor
+0001a950: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0001a960: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+0001a970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a980: 2020 2020 2020 2020 2020 2020 6366 6e20              cfn 
+0001a990: 3d20 6963 7572 2e65 7865 6375 7465 2871  = icur.execute(q
+0001a9a0: 2c20 2863 7264 2c20 6364 6e29 292e 6665  , (crd, cdn)).fe
+0001a9b0: 7463 686f 6e65 2829 0a20 2020 2020 2020  tchone().       
+0001a9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a9d0: 2020 2020 2069 6620 6366 6e3a 0a20 2020       if cfn:.   
+0001a9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a9f0: 2020 2020 2020 2020 2020 2020 2066 6e20               fn 
+0001aa00: 3d20 6366 6e5b 305d 0a20 2020 2020 2020  = cfn[0].       
+0001aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aa20: 2020 2020 2020 2020 2066 7020 3d20 6f73           fp = os
+0001aa30: 2e70 6174 682e 6a6f 696e 2861 6273 7061  .path.join(abspa
+0001aa40: 7468 2c20 666e 290a 2020 2020 2020 2020  th, fn).        
+0001aa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aa60: 2020 2020 2020 2020 6966 2062 6f73 2e70          if bos.p
+0001aa70: 6174 682e 6578 6973 7473 2866 7029 3a0a  ath.exists(fp):.
+0001aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aaa0: 2020 2020 7672 656d 203d 2022 7b7d 2f7b      vrem = "{}/{
+0001aab0: 7d22 2e66 6f72 6d61 7428 7672 656d 2c20  }".format(vrem, 
+0001aac0: 666e 292e 7374 7269 7028 222f 2229 0a20  fn).strip("/"). 
+0001aad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001aaf0: 2020 2069 735f 6469 7220 3d20 4661 6c73     is_dir = Fals
+0001ab00: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001ab10: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0001ab20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001ab30: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0001ab40: 7373 0a20 2020 2020 2020 2020 2020 2020  ss.             
+0001ab50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ab70: 2020 2020 2066 6f72 2066 6e20 696e 2073       for fn in s
+0001ab80: 656c 662e 6172 6773 2e74 685f 636f 7665  elf.args.th_cove
+0001ab90: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+0001aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001abb0: 6670 203d 206f 732e 7061 7468 2e6a 6f69  fp = os.path.joi
+0001abc0: 6e28 6162 7370 6174 682c 2066 6e29 0a20  n(abspath, fn). 
+0001abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001abe0: 2020 2020 2020 2020 2020 2069 6620 626f             if bo
+0001abf0: 732e 7061 7468 2e65 7869 7374 7328 6670  s.path.exists(fp
+0001ac00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac20: 2020 2076 7265 6d20 3d20 227b 7d2f 7b7d     vrem = "{}/{}
+0001ac30: 222e 666f 726d 6174 2876 7265 6d2c 2066  ".format(vrem, f
+0001ac40: 6e29 2e73 7472 6970 2822 2f22 290a 2020  n).strip("/").  
+0001ac50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac60: 2020 2020 2020 2020 2020 2020 2020 6973                is
+0001ac70: 5f64 6972 203d 2046 616c 7365 0a20 2020  _dir = False.   
+0001ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ac90: 2020 2020 2020 2020 2020 2020 2062 7265               bre
+0001aca0: 616b 0a0a 2020 2020 2020 2020 2020 2020  ak..            
+0001acb0: 2020 2020 2020 2020 6966 2069 735f 6469          if is_di
+0001acc0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+0001acd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001ace0: 6e20 7365 6c66 2e74 785f 6963 6f28 2261  n self.tx_ico("a
+0001acf0: 2e66 6f6c 6465 7222 290a 0a20 2020 2020  .folder")..     
+0001ad00: 2020 2020 2020 2020 2020 2074 6870 203d             thp =
+0001ad10: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+0001ad20: 2020 2020 2020 6966 2073 656c 662e 7468        if self.th
+0001ad30: 756d 6263 6c69 3a0a 2020 2020 2020 2020  umbcli:.        
+0001ad40: 2020 2020 2020 2020 2020 2020 7468 7020              thp 
+0001ad50: 3d20 7365 6c66 2e74 6875 6d62 636c 692e  = self.thumbcli.
+0001ad60: 6765 7428 6462 762c 2076 7265 6d2c 2069  get(dbv, vrem, i
+0001ad70: 6e74 2873 742e 7374 5f6d 7469 6d65 292c  nt(st.st_mtime),
+0001ad80: 2074 685f 666d 7429 0a0a 2020 2020 2020   th_fmt)..      
+0001ad90: 2020 2020 2020 2020 2020 6966 2074 6870            if thp
+0001ada0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001adb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001adc0: 662e 7478 5f66 696c 6528 7468 7029 0a0a  f.tx_file(thp)..
+0001add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ade0: 6966 2074 685f 666d 7420 3d3d 2022 7022  if th_fmt == "p"
+0001adf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001ae00: 2020 2020 2020 7261 6973 6520 5065 626b        raise Pebk
+0001ae10: 6163 2834 3034 290a 0a20 2020 2020 2020  ac(404)..       
+0001ae20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001ae30: 7365 6c66 2e74 785f 6963 6f28 7265 6d29  self.tx_ico(rem)
+0001ae40: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0001ae50: 2069 735f 6469 7220 616e 6420 2873 656c   is_dir and (sel
+0001ae60: 662e 6361 6e5f 7265 6164 206f 7220 7365  f.can_read or se
+0001ae70: 6c66 2e63 616e 5f67 6574 293a 0a20 2020  lf.can_get):.   
+0001ae80: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001ae90: 7365 6c66 2e63 616e 5f72 6561 6420 616e  self.can_read an
+0001aea0: 6420 2266 6b22 2069 6e20 766e 2e66 6c61  d "fk" in vn.fla
+0001aeb0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+0001aec0: 2020 2020 636f 7272 6563 7420 3d20 7365      correct = se
+0001aed0: 6c66 2e67 656e 5f66 6b28 0a20 2020 2020  lf.gen_fk(.     
+0001aee0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001aef0: 656c 662e 6172 6773 2e66 6b5f 7361 6c74  elf.args.fk_salt
+0001af00: 2c20 6162 7370 6174 682c 2073 742e 7374  , abspath, st.st
+0001af10: 5f73 697a 652c 2030 2069 6620 414e 5957  _size, 0 if ANYW
+0001af20: 494e 2065 6c73 6520 7374 2e73 745f 696e  IN else st.st_in
+0001af30: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
+0001af40: 2020 295b 3a20 766e 2e66 6c61 6773 5b22    )[: vn.flags["
+0001af50: 666b 225d 5d0a 2020 2020 2020 2020 2020  fk"]].          
+0001af60: 2020 2020 2020 676f 7420 3d20 7365 6c66        got = self
+0001af70: 2e75 7061 7261 6d2e 6765 7428 226b 2229  .uparam.get("k")
+0001af80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001af90: 2069 6620 676f 7420 213d 2063 6f72 7265   if got != corre
+0001afa0: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0001afb0: 2020 2020 2020 2020 7365 6c66 2e6c 6f67          self.log
+0001afc0: 2822 7772 6f6e 6720 6669 6c65 6b65 792c  ("wrong filekey,
+0001afd0: 2077 616e 7420 7b7d 2c20 676f 7420 7b7d   want {}, got {}
+0001afe0: 222e 666f 726d 6174 2863 6f72 7265 6374  ".format(correct
+0001aff0: 2c20 676f 7429 290a 2020 2020 2020 2020  , got)).        
+0001b000: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b010: 726e 2073 656c 662e 7478 5f34 3034 2829  rn self.tx_404()
+0001b020: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0001b030: 2061 6273 7061 7468 2e65 6e64 7377 6974   abspath.endswit
+0001b040: 6828 222e 6d64 2229 2061 6e64 2028 0a20  h(".md") and (. 
+0001b050: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001b060: 7622 2069 6e20 7365 6c66 2e75 7061 7261  v" in self.upara
+0001b070: 6d20 6f72 2022 6564 6974 2220 696e 2073  m or "edit" in s
+0001b080: 656c 662e 7570 6172 616d 206f 7220 2265  elf.uparam or "e
+0001b090: 6469 7432 2220 696e 2073 656c 662e 7570  dit2" in self.up
+0001b0a0: 6172 616d 0a20 2020 2020 2020 2020 2020  aram.           
+0001b0b0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0001b0c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001b0d0: 7478 5f6d 6428 6162 7370 6174 6829 0a0a  tx_md(abspath)..
+0001b0e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001b0f0: 726e 2073 656c 662e 7478 5f66 696c 6528  rn self.tx_file(
+0001b100: 6162 7370 6174 6829 0a0a 2020 2020 2020  abspath)..      
+0001b110: 2020 656c 6966 2069 735f 6469 7220 616e    elif is_dir an
+0001b120: 6420 6e6f 7420 7365 6c66 2e63 616e 5f72  d not self.can_r
+0001b130: 6561 6420 616e 6420 6e6f 7420 7365 6c66  ead and not self
+0001b140: 2e63 616e 5f77 7269 7465 3a0a 2020 2020  .can_write:.    
+0001b150: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001b160: 656c 662e 7478 5f34 3034 2854 7275 6529  elf.tx_404(True)
+0001b170: 0a0a 2020 2020 2020 2020 7372 765f 696e  ..        srv_in
+0001b180: 666f 203d 205b 5d0a 0a20 2020 2020 2020  fo = []..       
+0001b190: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0001b1a0: 2020 6966 206e 6f74 2073 656c 662e 6172    if not self.ar
+0001b1b0: 6773 2e6e 6968 3a0a 2020 2020 2020 2020  gs.nih:.        
+0001b1c0: 2020 2020 2020 2020 7372 765f 696e 666f          srv_info
+0001b1d0: 2e61 7070 656e 6428 7365 6c66 2e61 7267  .append(self.arg
+0001b1e0: 732e 6e61 6d65 290a 2020 2020 2020 2020  s.name).        
+0001b1f0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+0001b200: 2020 2020 7365 6c66 2e6c 6f67 2822 2377      self.log("#w
+0001b210: 6f77 2023 7768 6f61 2229 0a0a 2020 2020  ow #whoa")..    
+0001b220: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0001b230: 6172 6773 2e6e 6964 3a0a 2020 2020 2020  args.nid:.      
+0001b240: 2020 2020 2020 6672 6565 2c20 746f 7461        free, tota
+0001b250: 6c20 3d20 6765 745f 6466 2861 6273 7061  l = get_df(abspa
+0001b260: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
+0001b270: 6966 2074 6f74 616c 2069 7320 6e6f 7420  if total is not 
+0001b280: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0001b290: 2020 2020 2020 6831 203d 2068 756d 616e        h1 = human
+0001b2a0: 7369 7a65 2866 7265 6520 6f72 2030 290a  size(free or 0).
+0001b2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b2c0: 6832 203d 2068 756d 616e 7369 7a65 2874  h2 = humansize(t
+0001b2d0: 6f74 616c 290a 2020 2020 2020 2020 2020  otal).          
+0001b2e0: 2020 2020 2020 7372 765f 696e 666f 2e61        srv_info.a
+0001b2f0: 7070 656e 6428 227b 7d20 6672 6565 206f  ppend("{} free o
+0001b300: 6620 7b7d 222e 666f 726d 6174 2868 312c  f {}".format(h1,
+0001b310: 2068 3229 290a 2020 2020 2020 2020 2020   h2)).          
+0001b320: 2020 656c 6966 2066 7265 6520 6973 206e    elif free is n
+0001b330: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0001b340: 2020 2020 2020 2020 2073 7276 5f69 6e66           srv_inf
+0001b350: 6f2e 6170 7065 6e64 2868 756d 616e 7369  o.append(humansi
+0001b360: 7a65 2866 7265 652c 2054 7275 6529 202b  ze(free, True) +
+0001b370: 2022 2066 7265 6522 290a 0a20 2020 2020   " free")..     
+0001b380: 2020 2073 7276 5f69 6e66 6f74 203d 2022     srv_infot = "
+0001b390: 3c2f 7370 616e 3e20 2f2f 203c 7370 616e  </span> // <span
+0001b3a0: 3e22 2e6a 6f69 6e28 7372 765f 696e 666f  >".join(srv_info
+0001b3b0: 290a 0a20 2020 2020 2020 2070 6572 6d73  )..        perms
+0001b3c0: 203d 205b 5d0a 2020 2020 2020 2020 6966   = [].        if
+0001b3d0: 2073 656c 662e 6361 6e5f 7265 6164 3a0a   self.can_read:.
+0001b3e0: 2020 2020 2020 2020 2020 2020 7065 726d              perm
+0001b3f0: 732e 6170 7065 6e64 2822 7265 6164 2229  s.append("read")
+0001b400: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001b410: 2e63 616e 5f77 7269 7465 3a0a 2020 2020  .can_write:.    
+0001b420: 2020 2020 2020 2020 7065 726d 732e 6170          perms.ap
+0001b430: 7065 6e64 2822 7772 6974 6522 290a 2020  pend("write").  
+0001b440: 2020 2020 2020 6966 2073 656c 662e 6361        if self.ca
+0001b450: 6e5f 6d6f 7665 3a0a 2020 2020 2020 2020  n_move:.        
+0001b460: 2020 2020 7065 726d 732e 6170 7065 6e64      perms.append
+0001b470: 2822 6d6f 7665 2229 0a20 2020 2020 2020  ("move").       
+0001b480: 2069 6620 7365 6c66 2e63 616e 5f64 656c   if self.can_del
+0001b490: 6574 653a 0a20 2020 2020 2020 2020 2020  ete:.           
+0001b4a0: 2070 6572 6d73 2e61 7070 656e 6428 2264   perms.append("d
+0001b4b0: 656c 6574 6522 290a 2020 2020 2020 2020  elete").        
+0001b4c0: 6966 2073 656c 662e 6361 6e5f 6765 743a  if self.can_get:
+0001b4d0: 0a20 2020 2020 2020 2020 2020 2070 6572  .            per
+0001b4e0: 6d73 2e61 7070 656e 6428 2267 6574 2229  ms.append("get")
+0001b4f0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0001b500: 2e63 616e 5f75 7067 6574 3a0a 2020 2020  .can_upget:.    
+0001b510: 2020 2020 2020 2020 7065 726d 732e 6170          perms.ap
+0001b520: 7065 6e64 2822 7570 6765 7422 290a 0a20  pend("upget").. 
+0001b530: 2020 2020 2020 2075 726c 5f73 7566 203d         url_suf =
+0001b540: 2073 656c 662e 7572 6c71 287b 7d2c 205b   self.urlq({}, [
+0001b550: 226b 225d 290a 2020 2020 2020 2020 6973  "k"]).        is
+0001b560: 5f6c 7320 3d20 226c 7322 2069 6e20 7365  _ls = "ls" in se
+0001b570: 6c66 2e75 7061 7261 6d0a 2020 2020 2020  lf.uparam.      
+0001b580: 2020 6973 5f6a 7320 3d20 7365 6c66 2e61    is_js = self.a
+0001b590: 7267 732e 666f 7263 655f 6a73 206f 7220  rgs.force_js or 
+0001b5a0: 7365 6c66 2e63 6f6f 6b69 6573 2e67 6574  self.cookies.get
+0001b5b0: 2822 6a73 2229 203d 3d20 2279 220a 0a20  ("js") == "y".. 
+0001b5c0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+0001b5d0: 5f6c 7320 616e 6420 2873 656c 662e 7561  _ls and (self.ua
+0001b5e0: 2e73 7461 7274 7377 6974 6828 2263 7572  .startswith("cur
+0001b5f0: 6c2f 2229 206f 7220 7365 6c66 2e75 612e  l/") or self.ua.
+0001b600: 7374 6172 7473 7769 7468 2822 6665 7463  startswith("fetc
+0001b610: 6822 2929 3a0a 2020 2020 2020 2020 2020  h")):.          
+0001b620: 2020 7365 6c66 2e75 7061 7261 6d5b 226c    self.uparam["l
+0001b630: 7322 5d20 3d20 2276 220a 2020 2020 2020  s"] = "v".      
+0001b640: 2020 2020 2020 6973 5f6c 7320 3d20 5472        is_ls = Tr
+0001b650: 7565 0a0a 2020 2020 2020 2020 7470 6c20  ue..        tpl 
+0001b660: 3d20 2262 726f 7773 6572 220a 2020 2020  = "browser".    
+0001b670: 2020 2020 6966 2022 6222 2069 6e20 7365      if "b" in se
+0001b680: 6c66 2e75 7061 7261 6d3a 0a20 2020 2020  lf.uparam:.     
+0001b690: 2020 2020 2020 2074 706c 203d 2022 6272         tpl = "br
+0001b6a0: 6f77 7365 7232 220a 2020 2020 2020 2020  owser2".        
+0001b6b0: 2020 2020 6973 5f6a 7320 3d20 4661 6c73      is_js = Fals
+0001b6c0: 650a 0a20 2020 2020 2020 206c 6f67 7565  e..        logue
+0001b6d0: 7320 3d20 5b22 222c 2022 225d 0a20 2020  s = ["", ""].   
+0001b6e0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0001b6f0: 2e61 7267 732e 6e6f 5f6c 6f67 7565 733a  .args.no_logues:
+0001b700: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001b710: 206e 2c20 666e 2069 6e20 656e 756d 6572   n, fn in enumer
+0001b720: 6174 6528 5b22 2e70 726f 6c6f 6775 652e  ate([".prologue.
+0001b730: 6874 6d6c 222c 2022 2e65 7069 6c6f 6775  html", ".epilogu
+0001b740: 652e 6874 6d6c 225d 293a 0a20 2020 2020  e.html"]):.     
+0001b750: 2020 2020 2020 2020 2020 2066 6e20 3d20             fn = 
+0001b760: 6f73 2e70 6174 682e 6a6f 696e 2861 6273  os.path.join(abs
+0001b770: 7061 7468 2c20 666e 290a 2020 2020 2020  path, fn).      
+0001b780: 2020 2020 2020 2020 2020 6966 2062 6f73            if bos
+0001b790: 2e70 6174 682e 6578 6973 7473 2866 6e29  .path.exists(fn)
+0001b7a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b7b0: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+0001b7c0: 6673 656e 6328 666e 292c 2022 7262 2229  fsenc(fn), "rb")
+0001b7d0: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+0001b7e0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001b7f0: 6f67 7565 735b 6e5d 203d 2066 2e72 6561  ogues[n] = f.rea
+0001b800: 6428 292e 6465 636f 6465 2822 7574 662d  d().decode("utf-
+0001b810: 3822 290a 0a20 2020 2020 2020 2072 6561  8")..        rea
+0001b820: 646d 6520 3d20 2222 0a20 2020 2020 2020  dme = "".       
+0001b830: 2069 6620 6e6f 7420 7365 6c66 2e61 7267   if not self.arg
+0001b840: 732e 6e6f 5f72 6561 646d 6520 616e 6420  s.no_readme and 
+0001b850: 6e6f 7420 6c6f 6775 6573 5b31 5d3a 0a20  not logues[1]:. 
+0001b860: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
+0001b870: 6e20 696e 205b 2252 4541 444d 452e 6d64  n in ["README.md
+0001b880: 222c 2022 7265 6164 6d65 2e6d 6422 5d3a  ", "readme.md"]:
+0001b890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b8a0: 2066 6e20 3d20 6f73 2e70 6174 682e 6a6f   fn = os.path.jo
+0001b8b0: 696e 2861 6273 7061 7468 2c20 666e 290a  in(abspath, fn).
+0001b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8d0: 6966 2062 6f73 2e70 6174 682e 6973 6669  if bos.path.isfi
+0001b8e0: 6c65 2866 6e29 3a0a 2020 2020 2020 2020  le(fn):.        
+0001b8f0: 2020 2020 2020 2020 2020 2020 7769 7468              with
+0001b900: 206f 7065 6e28 6673 656e 6328 666e 292c   open(fsenc(fn),
+0001b910: 2022 7262 2229 2061 7320 663a 0a20 2020   "rb") as f:.   
+0001b920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b930: 2020 2020 2072 6561 646d 6520 3d20 662e       readme = f.
+0001b940: 7265 6164 2829 2e64 6563 6f64 6528 2275  read().decode("u
+0001b950: 7466 2d38 2229 0a20 2020 2020 2020 2020  tf-8").         
+0001b960: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001b970: 7265 616b 0a0a 2020 2020 2020 2020 7666  reak..        vf
+0001b980: 203d 2076 6e2e 666c 6167 730a 2020 2020   = vn.flags.    
+0001b990: 2020 2020 6c73 5f72 6574 203d 207b 0a20      ls_ret = {. 
+0001b9a0: 2020 2020 2020 2020 2020 2022 6469 7273             "dirs
+0001b9b0: 223a 205b 5d2c 0a20 2020 2020 2020 2020  ": [],.         
+0001b9c0: 2020 2022 6669 6c65 7322 3a20 5b5d 2c0a     "files": [],.
+0001b9d0: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+0001b9e0: 6c69 7374 223a 205b 5d2c 0a20 2020 2020  list": [],.     
+0001b9f0: 2020 2020 2020 2022 7372 7669 6e66 223a         "srvinf":
+0001ba00: 2073 7276 5f69 6e66 6f74 2c0a 2020 2020   srv_infot,.    
+0001ba10: 2020 2020 2020 2020 2261 6363 7422 3a20          "acct": 
+0001ba20: 7365 6c66 2e75 6e61 6d65 2c0a 2020 2020  self.uname,.    
+0001ba30: 2020 2020 2020 2020 2269 6478 223a 2065          "idx": e
+0001ba40: 3264 2c0a 2020 2020 2020 2020 2020 2020  2d,.            
+0001ba50: 2269 7461 6722 3a20 6532 742c 0a20 2020  "itag": e2t,.   
+0001ba60: 2020 2020 2020 2020 2022 6c69 6665 7469           "lifeti
+0001ba70: 6d65 223a 2076 6e2e 666c 6167 732e 6765  me": vn.flags.ge
+0001ba80: 7428 226c 6966 6574 696d 6522 2920 6f72  t("lifetime") or
+0001ba90: 2030 2c0a 2020 2020 2020 2020 2020 2020   0,.            
+0001baa0: 2266 7261 6e64 223a 2062 6f6f 6c28 766e  "frand": bool(vn
+0001bab0: 2e66 6c61 6773 2e67 6574 2822 7261 6e64  .flags.get("rand
+0001bac0: 2229 292c 0a20 2020 2020 2020 2020 2020  ")),.           
+0001bad0: 2022 7065 726d 7322 3a20 7065 726d 732c   "perms": perms,
+0001bae0: 0a20 2020 2020 2020 2020 2020 2022 6c6f  .            "lo
+0001baf0: 6775 6573 223a 206c 6f67 7565 732c 0a20  gues": logues,. 
+0001bb00: 2020 2020 2020 2020 2020 2022 7265 6164             "read
+0001bb10: 6d65 223a 2072 6561 646d 652c 0a20 2020  me": readme,.   
+0001bb20: 2020 2020 207d 0a20 2020 2020 2020 206a       }.        j
+0001bb30: 3261 203d 207b 0a20 2020 2020 2020 2020  2a = {.         
+0001bb40: 2020 2022 7664 6972 223a 2071 756f 7465     "vdir": quote
+0001bb50: 7028 7365 6c66 2e76 7061 7468 292c 0a20  p(self.vpath),. 
+0001bb60: 2020 2020 2020 2020 2020 2022 7670 6e6f             "vpno
+0001bb70: 6465 7322 3a20 7670 6e6f 6465 732c 0a20  des": vpnodes,. 
+0001bb80: 2020 2020 2020 2020 2020 2022 6669 6c65             "file
+0001bb90: 7322 3a20 5b5d 2c0a 2020 2020 2020 2020  s": [],.        
+0001bba0: 2020 2020 226c 7330 223a 204e 6f6e 652c      "ls0": None,
+0001bbb0: 0a20 2020 2020 2020 2020 2020 2022 6163  .            "ac
+0001bbc0: 6374 223a 2073 656c 662e 756e 616d 652c  ct": self.uname,
+0001bbd0: 0a20 2020 2020 2020 2020 2020 2022 7065  .            "pe
+0001bbe0: 726d 7322 3a20 6a73 6f6e 2e64 756d 7073  rms": json.dumps
+0001bbf0: 2870 6572 6d73 292c 0a20 2020 2020 2020  (perms),.       
+0001bc00: 2020 2020 2022 6c69 6665 7469 6d65 223a       "lifetime":
+0001bc10: 206c 735f 7265 745b 226c 6966 6574 696d   ls_ret["lifetim
+0001bc20: 6522 5d2c 0a20 2020 2020 2020 2020 2020  e"],.           
+0001bc30: 2022 6672 616e 6422 3a20 626f 6f6c 2876   "frand": bool(v
+0001bc40: 6e2e 666c 6167 732e 6765 7428 2272 616e  n.flags.get("ran
+0001bc50: 6422 2929 2c0a 2020 2020 2020 2020 2020  d")),.          
+0001bc60: 2020 2274 6167 6c69 7374 223a 205b 5d2c    "taglist": [],
+0001bc70: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
+0001bc80: 665f 6863 6f6c 7322 3a20 5b5d 2c0a 2020  f_hcols": [],.  
+0001bc90: 2020 2020 2020 2020 2020 2268 6176 655f            "have_
+0001bca0: 656d 7022 3a20 7365 6c66 2e61 7267 732e  emp": self.args.
+0001bcb0: 656d 702c 0a20 2020 2020 2020 2020 2020  emp,.           
+0001bcc0: 2022 6861 7665 5f75 7032 6b5f 6964 7822   "have_up2k_idx"
+0001bcd0: 3a20 6532 642c 0a20 2020 2020 2020 2020  : e2d,.         
+0001bce0: 2020 2022 6861 7665 5f74 6167 735f 6964     "have_tags_id
+0001bcf0: 7822 3a20 6532 742c 0a20 2020 2020 2020  x": e2t,.       
+0001bd00: 2020 2020 2022 6861 7665 5f61 636f 6465       "have_acode
+0001bd10: 223a 2028 6e6f 7420 7365 6c66 2e61 7267  ": (not self.arg
+0001bd20: 732e 6e6f 5f61 636f 6465 292c 0a20 2020  s.no_acode),.   
+0001bd30: 2020 2020 2020 2020 2022 6861 7665 5f6d           "have_m
+0001bd40: 7622 3a20 286e 6f74 2073 656c 662e 6172  v": (not self.ar
+0001bd50: 6773 2e6e 6f5f 6d76 292c 0a20 2020 2020  gs.no_mv),.     
+0001bd60: 2020 2020 2020 2022 6861 7665 5f64 656c         "have_del
+0001bd70: 223a 2028 6e6f 7420 7365 6c66 2e61 7267  ": (not self.arg
+0001bd80: 732e 6e6f 5f64 656c 292c 0a20 2020 2020  s.no_del),.     
+0001bd90: 2020 2020 2020 2022 6861 7665 5f7a 6970         "have_zip
+0001bda0: 223a 2028 6e6f 7420 7365 6c66 2e61 7267  ": (not self.arg
+0001bdb0: 732e 6e6f 5f7a 6970 292c 0a20 2020 2020  s.no_zip),.     
+0001bdc0: 2020 2020 2020 2022 6861 7665 5f75 6e70         "have_unp
+0001bdd0: 6f73 7422 3a20 696e 7428 7365 6c66 2e61  ost": int(self.a
+0001bde0: 7267 732e 756e 706f 7374 292c 0a20 2020  rgs.unpost),.   
+0001bdf0: 2020 2020 2020 2020 2022 6861 7665 5f62           "have_b
+0001be00: 5f75 223a 2028 7365 6c66 2e63 616e 5f77  _u": (self.can_w
+0001be10: 7269 7465 2061 6e64 2073 656c 662e 7570  rite and self.up
+0001be20: 6172 616d 2e67 6574 2822 6222 2920 3d3d  aram.get("b") ==
+0001be30: 2022 7522 292c 0a20 2020 2020 2020 2020   "u"),.         
+0001be40: 2020 2022 7362 5f6d 6422 3a20 2222 2069     "sb_md": "" i
+0001be50: 6620 226e 6f5f 7362 5f6d 6422 2069 6e20  f "no_sb_md" in 
+0001be60: 7666 2065 6c73 6520 2876 662e 6765 7428  vf else (vf.get(
+0001be70: 226d 645f 7362 6622 2920 6f72 2022 7922  "md_sbf") or "y"
+0001be80: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+0001be90: 7362 5f6c 6722 3a20 2222 2069 6620 226e  sb_lg": "" if "n
+0001bea0: 6f5f 7362 5f6c 6722 2069 6e20 7666 2065  o_sb_lg" in vf e
+0001beb0: 6c73 6520 2876 662e 6765 7428 226c 675f  lse (vf.get("lg_
+0001bec0: 7362 6622 2920 6f72 2022 7922 292c 0a20  sbf") or "y"),. 
+0001bed0: 2020 2020 2020 2020 2020 2022 7572 6c5f             "url_
+0001bee0: 7375 6622 3a20 7572 6c5f 7375 662c 0a20  suf": url_suf,. 
+0001bef0: 2020 2020 2020 2020 2020 2022 6c6f 6775             "logu
+0001bf00: 6573 223a 206c 6f67 7565 732c 0a20 2020  es": logues,.   
+0001bf10: 2020 2020 2020 2020 2022 7265 6164 6d65           "readme
+0001bf20: 223a 2072 6561 646d 652c 0a20 2020 2020  ": readme,.     
+0001bf30: 2020 2020 2020 2022 7469 746c 6522 3a20         "title": 
+0001bf40: 6874 6d6c 5f65 7363 6170 6528 7365 6c66  html_escape(self
+0001bf50: 2e76 7061 7468 2c20 6372 6c66 3d54 7275  .vpath, crlf=Tru
+0001bf60: 6529 206f 7220 22f0 9f92 bef0 9f8e 8922  e) or "........"
+0001bf70: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
+0001bf80: 7276 5f69 6e66 6f22 3a20 7372 765f 696e  rv_info": srv_in
+0001bf90: 666f 742c 0a20 2020 2020 2020 2020 2020  fot,.           
+0001bfa0: 2022 6474 6865 6d65 223a 2073 656c 662e   "dtheme": self.
+0001bfb0: 6172 6773 2e74 6865 6d65 2c0a 2020 2020  args.theme,.    
+0001bfc0: 2020 2020 2020 2020 2274 6865 6d65 7322          "themes"
+0001bfd0: 3a20 7365 6c66 2e61 7267 732e 7468 656d  : self.args.them
+0001bfe0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0001bff0: 2274 7572 626f 6c76 6c22 3a20 7365 6c66  "turbolvl": self
+0001c000: 2e61 7267 732e 7475 7262 6f2c 0a20 2020  .args.turbo,.   
+0001c010: 2020 2020 2020 2020 2022 6964 7868 223a           "idxh":
+0001c020: 2069 6e74 2873 656c 662e 6172 6773 2e69   int(self.args.i
+0001c030: 6829 2c0a 2020 2020 2020 2020 2020 2020  h),.            
+0001c040: 2275 3273 6f72 7422 3a20 7365 6c66 2e61  "u2sort": self.a
+0001c050: 7267 732e 7532 736f 7274 2c0a 2020 2020  rgs.u2sort,.    
+0001c060: 2020 2020 7d0a 0a20 2020 2020 2020 2069      }..        i
+0001c070: 6620 7365 6c66 2e61 7267 732e 6a73 5f62  f self.args.js_b
+0001c080: 726f 7773 6572 3a0a 2020 2020 2020 2020  rowser:.        
+0001c090: 2020 2020 6a32 615b 226a 7322 5d20 3d20      j2a["js"] = 
+0001c0a0: 7365 6c66 2e61 7267 732e 6a73 5f62 726f  self.args.js_bro
+0001c0b0: 7773 6572 0a0a 2020 2020 2020 2020 6966  wser..        if
+0001c0c0: 2073 656c 662e 6172 6773 2e63 7373 5f62   self.args.css_b
+0001c0d0: 726f 7773 6572 3a0a 2020 2020 2020 2020  rowser:.        
+0001c0e0: 2020 2020 6a32 615b 2263 7373 225d 203d      j2a["css"] =
+0001c0f0: 2073 656c 662e 6172 6773 2e63 7373 5f62   self.args.css_b
+0001c100: 726f 7773 6572 0a0a 2020 2020 2020 2020  rowser..        
+0001c110: 6966 206e 6f74 2073 656c 662e 636f 6e6e  if not self.conn
+0001c120: 2e68 7372 762e 7072 6973 6d3a 0a20 2020  .hsrv.prism:.   
+0001c130: 2020 2020 2020 2020 206a 3261 5b22 6e6f           j2a["no
+0001c140: 5f70 7269 736d 225d 203d 2054 7275 650a  _prism"] = True.
+0001c150: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0001c160: 7365 6c66 2e63 616e 5f72 6561 643a 0a20  self.can_read:. 
+0001c170: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0001c180: 5f6c 733a 0a20 2020 2020 2020 2020 2020  _ls:.           
+0001c190: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001c1a0: 2e74 785f 6c73 286c 735f 7265 7429 0a0a  .tx_ls(ls_ret)..
+0001c1b0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001c1c0: 6f74 2073 7461 742e 535f 4953 4449 5228  ot stat.S_ISDIR(
+0001c1d0: 7374 2e73 745f 6d6f 6465 293a 0a20 2020  st.st_mode):.   
+0001c1e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001c1f0: 7572 6e20 7365 6c66 2e74 785f 3430 3428  urn self.tx_404(
+0001c200: 5472 7565 290a 0a20 2020 2020 2020 2020  True)..         
+0001c210: 2020 2069 6620 227a 6970 2220 696e 2073     if "zip" in s
+0001c220: 656c 662e 7570 6172 616d 206f 7220 2274  elf.uparam or "t
+0001c230: 6172 2220 696e 2073 656c 662e 7570 6172  ar" in self.upar
+0001c240: 616d 3a0a 2020 2020 2020 2020 2020 2020  am:.            
+0001c250: 2020 2020 7261 6973 6520 5065 626b 6163      raise Pebkac
+0001c260: 2834 3033 290a 0a20 2020 2020 2020 2020  (403)..         
+0001c270: 2020 2068 746d 6c20 3d20 7365 6c66 2e6a     html = self.j
+0001c280: 3273 2874 706c 2c20 2a2a 6a32 6129 0a20  2s(tpl, **j2a). 
+0001c290: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0001c2a0: 7265 706c 7928 6874 6d6c 2e65 6e63 6f64  reply(html.encod
+0001c2b0: 6528 2275 7466 2d38 222c 2022 7265 706c  e("utf-8", "repl
+0001c2c0: 6163 6522 2929 0a20 2020 2020 2020 2020  ace")).         
+0001c2d0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
+0001c2e0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+0001c2f0: 205b 227a 6970 222c 2022 7461 7222 5d3a   ["zip", "tar"]:
+0001c300: 0a20 2020 2020 2020 2020 2020 2076 203d  .            v =
+0001c310: 2073 656c 662e 7570 6172 616d 2e67 6574   self.uparam.get
+0001c320: 286b 290a 2020 2020 2020 2020 2020 2020  (k).            
+0001c330: 6966 2076 2069 7320 6e6f 7420 4e6f 6e65  if v is not None
+0001c340: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001c350: 2020 7265 7475 726e 2073 656c 662e 7478    return self.tx
+0001c360: 5f7a 6970 286b 2c20 762c 2073 656c 662e  _zip(k, v, self.
+0001c370: 7670 6174 682c 2076 6e2c 2072 656d 2c20  vpath, vn, rem, 
+0001c380: 5b5d 2c20 7365 6c66 2e61 7267 732e 6564  [], self.args.ed
+0001c390: 290a 0a20 2020 2020 2020 2066 7372 6f6f  )..        fsroo
+0001c3a0: 742c 2076 6673 5f6c 732c 2076 6673 5f76  t, vfs_ls, vfs_v
+0001c3b0: 6972 7420 3d20 766e 2e6c 7328 0a20 2020  irt = vn.ls(.   
+0001c3c0: 2020 2020 2020 2020 2072 656d 2c0a 2020           rem,.  
+0001c3d0: 2020 2020 2020 2020 2020 7365 6c66 2e75            self.u
+0001c3e0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0001c3f0: 2020 6e6f 7420 7365 6c66 2e61 7267 732e    not self.args.
+0001c400: 6e6f 5f73 6361 6e64 6972 2c0a 2020 2020  no_scandir,.    
+0001c410: 2020 2020 2020 2020 5b5b 5472 7565 2c20          [[True, 
+0001c420: 4661 6c73 655d 2c20 5b46 616c 7365 2c20  False], [False, 
+0001c430: 5472 7565 5d5d 2c0a 2020 2020 2020 2020  True]],.        
+0001c440: 2020 2020 6c73 7461 743d 226c 7422 2069      lstat="lt" i
+0001c450: 6e20 7365 6c66 2e75 7061 7261 6d2c 0a20  n self.uparam,. 
+0001c460: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001c470: 2073 7461 7473 203d 207b 6b3a 2076 2066   stats = {k: v f
+0001c480: 6f72 206b 2c20 7620 696e 2076 6673 5f6c  or k, v in vfs_l
+0001c490: 737d 0a20 2020 2020 2020 206c 735f 6e61  s}.        ls_na
+0001c4a0: 6d65 7320 3d20 5b78 5b30 5d20 666f 7220  mes = [x[0] for 
+0001c4b0: 7820 696e 2076 6673 5f6c 735d 0a20 2020  x in vfs_ls].   
+0001c4c0: 2020 2020 206c 735f 6e61 6d65 732e 6578       ls_names.ex
+0001c4d0: 7465 6e64 286c 6973 7428 7666 735f 7669  tend(list(vfs_vi
+0001c4e0: 7274 2e6b 6579 7328 2929 290a 0a20 2020  rt.keys()))..   
+0001c4f0: 2020 2020 2023 2063 6865 636b 2066 6f72       # check for
+0001c500: 206f 6c64 2076 6572 7369 6f6e 7320 6f66   old versions of
+0001c510: 2066 696c 6573 2c0a 2020 2020 2020 2020   files,.        
+0001c520: 2320 5b6e 756d 2d62 6163 6b75 7073 2c20  # [num-backups, 
+0001c530: 6d6f 7374 2d72 6563 656e 742c 2068 6973  most-recent, his
+0001c540: 742d 7061 7468 5d0a 2020 2020 2020 2020  t-path].        
+0001c550: 6869 7374 2020 2020 203d 207b 7d0a 2020  hist     = {}.  
+0001c560: 2020 2020 2020 6869 7374 6469 7220 3d20        histdir = 
+0001c570: 6f73 2e70 6174 682e 6a6f 696e 2866 7372  os.path.join(fsr
+0001c580: 6f6f 742c 2022 2e68 6973 7422 290a 2020  oot, ".hist").  
+0001c590: 2020 2020 2020 7074 6e20 3d20 7265 2e63        ptn = re.c
+0001c5a0: 6f6d 7069 6c65 2872 2228 2e2a 295c 2e28  ompile(r"(.*)\.(
+0001c5b0: 5b30 2d39 5d2b 5c2e 5b30 2d39 5d7b 337d  [0-9]+\.[0-9]{3}
+0001c5c0: 2928 5c2e 5b5e 5c2e 5d2b 2924 2229 0a20  )(\.[^\.]+)$"). 
+0001c5d0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0001c5e0: 2020 2020 2020 2020 666f 7220 6866 6e20          for hfn 
+0001c5f0: 696e 2062 6f73 2e6c 6973 7464 6972 2868  in bos.listdir(h
+0001c600: 6973 7464 6972 293a 0a20 2020 2020 2020  istdir):.       
+0001c610: 2020 2020 2020 2020 206d 203d 2070 746e           m = ptn
+0001c620: 2e6d 6174 6368 2868 666e 290a 2020 2020  .match(hfn).    
+0001c630: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0001c640: 6f74 206d 3a0a 2020 2020 2020 2020 2020  ot m:.          
+0001c650: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+0001c660: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
+0001c670: 2020 2020 666e 203d 206d 2e67 726f 7570      fn = m.group
+0001c680: 2831 2920 2b20 6d2e 6772 6f75 7028 3329  (1) + m.group(3)
+0001c690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c6a0: 206e 2c20 7473 2c20 5f20 3d20 6869 7374   n, ts, _ = hist
+0001c6b0: 2e67 6574 2866 6e2c 2028 302c 2030 2c20  .get(fn, (0, 0, 
+0001c6c0: 2222 2929 0a20 2020 2020 2020 2020 2020  "")).           
+0001c6d0: 2020 2020 2068 6973 745b 666e 5d20 3d20       hist[fn] = 
+0001c6e0: 286e 202b 2031 2c20 6d61 7828 7473 2c20  (n + 1, max(ts, 
+0001c6f0: 666c 6f61 7428 6d2e 6772 6f75 7028 3229  float(m.group(2)
+0001c700: 2929 2c20 6866 6e29 0a20 2020 2020 2020  )), hfn).       
+0001c710: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0001c720: 2020 2020 2070 6173 730a 0a20 2020 2020       pass..     
+0001c730: 2020 2023 2073 686f 7720 646f 7466 696c     # show dotfil
+0001c740: 6573 2069 6620 7065 726d 6974 7465 6420  es if permitted 
+0001c750: 616e 6420 7265 7175 6573 7465 640a 2020  and requested.  
+0001c760: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+0001c770: 662e 6172 6773 2e65 6420 6f72 2022 646f  f.args.ed or "do
+0001c780: 7473 2220 6e6f 7420 696e 2073 656c 662e  ts" not in self.
+0001c790: 7570 6172 616d 3a0a 2020 2020 2020 2020  uparam:.        
+0001c7a0: 2020 2020 6c73 5f6e 616d 6573 203d 2065      ls_names = e
+0001c7b0: 7863 6c75 6465 5f64 6f74 6669 6c65 7328  xclude_dotfiles(
+0001c7c0: 6c73 5f6e 616d 6573 290a 0a20 2020 2020  ls_names)..     
+0001c7d0: 2020 2061 6464 5f66 6b20 3d20 766e 2e66     add_fk = vn.f
+0001c7e0: 6c61 6773 2e67 6574 2822 666b 2229 0a0a  lags.get("fk")..
+0001c7f0: 2020 2020 2020 2020 6469 7273 203d 205b          dirs = [
+0001c800: 5d0a 2020 2020 2020 2020 6669 6c65 7320  ].        files 
+0001c810: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
+0001c820: 2066 6e20 696e 206c 735f 6e61 6d65 733a   fn in ls_names:
+0001c830: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
+0001c840: 6520 3d20 2222 0a20 2020 2020 2020 2020  e = "".         
+0001c850: 2020 2068 7265 6620 3d20 666e 0a20 2020     href = fn.   
+0001c860: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+0001c870: 6973 5f6c 7320 616e 6420 6e6f 7420 6973  is_ls and not is
+0001c880: 5f6a 7320 616e 6420 6e6f 7420 7365 6c66  _js and not self
+0001c890: 2e74 7261 696c 696e 675f 736c 6173 6820  .trailing_slash 
+0001c8a0: 616e 6420 7670 6174 683a 0a20 2020 2020  and vpath:.     
+0001c8b0: 2020 2020 2020 2020 2020 2062 6173 6520             base 
+0001c8c0: 3d20 222f 2220 2b20 7670 6174 6820 2b20  = "/" + vpath + 
+0001c8d0: 222f 220a 2020 2020 2020 2020 2020 2020  "/".            
+0001c8e0: 2020 2020 6872 6566 203d 2062 6173 6520      href = base 
+0001c8f0: 2b20 666e 0a0a 2020 2020 2020 2020 2020  + fn..          
+0001c900: 2020 6966 2066 6e20 696e 2076 6673 5f76    if fn in vfs_v
+0001c910: 6972 743a 0a20 2020 2020 2020 2020 2020  irt:.           
+0001c920: 2020 2020 2066 7370 6174 6820 3d20 7666       fspath = vf
+0001c930: 735f 7669 7274 5b66 6e5d 2e72 6561 6c70  s_virt[fn].realp
+0001c940: 6174 680a 2020 2020 2020 2020 2020 2020  ath.            
+0001c950: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001c960: 2020 2020 2020 6673 7061 7468 203d 2066        fspath = f
+0001c970: 7372 6f6f 7420 2b20 222f 2220 2b20 666e  sroot + "/" + fn
+0001c980: 0a0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+0001c990: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0001c9a0: 2020 206c 696e 6620 3d20 7374 6174 732e     linf = stats.
+0001c9b0: 6765 7428 666e 2920 6f72 2062 6f73 2e6c  get(fn) or bos.l
+0001c9c0: 7374 6174 2866 7370 6174 6829 0a20 2020  stat(fspath).   
+0001c9d0: 2020 2020 2020 2020 2020 2020 2069 6e66               inf
+0001c9e0: 203d 2062 6f73 2e73 7461 7428 6673 7061   = bos.stat(fspa
+0001c9f0: 7468 2920 6966 2073 7461 742e 535f 4953  th) if stat.S_IS
+0001ca00: 4c4e 4b28 6c69 6e66 2e73 745f 6d6f 6465  LNK(linf.st_mode
+0001ca10: 2920 656c 7365 206c 696e 660a 2020 2020  ) else linf.    
+0001ca20: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+0001ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca40: 7365 6c66 2e6c 6f67 2822 6272 6f6b 656e  self.log("broken
+0001ca50: 2073 796d 6c69 6e6b 3a20 7b7d 222e 666f   symlink: {}".fo
+0001ca60: 726d 6174 2872 6570 7228 6673 7061 7468  rmat(repr(fspath
+0001ca70: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
+0001ca80: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
+0001ca90: 2020 2020 2020 2020 2020 6973 5f64 6972            is_dir
+0001caa0: 203d 2073 7461 742e 535f 4953 4449 5228   = stat.S_ISDIR(
+0001cab0: 696e 662e 7374 5f6d 6f64 6529 0a20 2020  inf.st_mode).   
+0001cac0: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
+0001cad0: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
+0001cae0: 2020 2020 6872 6566 202b 3d20 222f 220a      href += "/".
+0001caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb00: 6966 2073 656c 662e 6172 6773 2e6e 6f5f  if self.args.no_
+0001cb10: 7a69 703a 0a20 2020 2020 2020 2020 2020  zip:.           
+0001cb20: 2020 2020 2020 2020 206d 6172 6769 6e20           margin 
+0001cb30: 3d20 2244 4952 220a 2020 2020 2020 2020  = "DIR".        
+0001cb40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cb60: 2020 6d61 7267 696e 203d 2027 3c61 2068    margin = '<a h
+0001cb70: 7265 663d 2225 733f 7a69 7022 2072 656c  ref="%s?zip" rel
+0001cb80: 3d22 6e6f 666f 6c6c 6f77 223e 7a69 703c  ="nofollow">zip<
+0001cb90: 2f61 3e27 2025 2028 7175 6f74 6570 2868  /a>' % (quotep(h
+0001cba0: 7265 6629 2c29 0a20 2020 2020 2020 2020  ref),).         
+0001cbb0: 2020 2065 6c69 6620 666e 2069 6e20 6869     elif fn in hi
+0001cbc0: 7374 3a0a 2020 2020 2020 2020 2020 2020  st:.            
+0001cbd0: 2020 2020 6d61 7267 696e 203d 2027 3c61      margin = '<a
+0001cbe0: 2068 7265 663d 2225 732e 6869 7374 2f25   href="%s.hist/%
+0001cbf0: 7322 3e23 2573 3c2f 613e 2720 2520 280a  s">#%s</a>' % (.
+0001cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc10: 2020 2020 6261 7365 2c0a 2020 2020 2020      base,.      
+0001cc20: 2020 2020 2020 2020 2020 2020 2020 6874                ht
+0001cc30: 6d6c 5f65 7363 6170 6528 6869 7374 5b66  ml_escape(hist[f
+0001cc40: 6e5d 5b32 5d2c 2071 756f 743d 5472 7565  n][2], quot=True
+0001cc50: 2c20 6372 6c66 3d54 7275 6529 2c0a 2020  , crlf=True),.  
+0001cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc70: 2020 6869 7374 5b66 6e5d 5b30 5d2c 0a20    hist[fn][0],. 
+0001cc80: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001cc90: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001cca0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001ccb0: 2020 206d 6172 6769 6e20 3d20 222d 220a     margin = "-".
+0001ccc0: 0a20 2020 2020 2020 2020 2020 2073 7a20  .            sz 
+0001ccd0: 3d20 696e 662e 7374 5f73 697a 650a 2020  = inf.st_size.  
+0001cce0: 2020 2020 2020 2020 2020 7a64 203d 2064            zd = d
+0001ccf0: 6174 6574 696d 652e 7574 6366 726f 6d74  atetime.utcfromt
+0001cd00: 696d 6573 7461 6d70 286c 696e 662e 7374  imestamp(linf.st
+0001cd10: 5f6d 7469 6d65 290a 2020 2020 2020 2020  _mtime).        
+0001cd20: 2020 2020 6474 203d 2022 2530 3464 2d25      dt = "%04d-%
+0001cd30: 3032 642d 2530 3264 2025 3032 643a 2530  02d-%02d %02d:%0
+0001cd40: 3264 3a25 3032 6422 2025 2028 0a20 2020  2d:%02d" % (.   
+0001cd50: 2020 2020 2020 2020 2020 2020 207a 642e               zd.
+0001cd60: 7965 6172 2c0a 2020 2020 2020 2020 2020  year,.          
+0001cd70: 2020 2020 2020 7a64 2e6d 6f6e 7468 2c0a        zd.month,.
+0001cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd90: 7a64 2e64 6179 2c0a 2020 2020 2020 2020  zd.day,.        
+0001cda0: 2020 2020 2020 2020 7a64 2e68 6f75 722c          zd.hour,
+0001cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cdc0: 207a 642e 6d69 6e75 7465 2c0a 2020 2020   zd.minute,.    
+0001cdd0: 2020 2020 2020 2020 2020 2020 7a64 2e73              zd.s
+0001cde0: 6563 6f6e 642c 0a20 2020 2020 2020 2020  econd,.         
+0001cdf0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0001ce00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0001ce10: 2020 2020 2020 2065 7874 203d 2022 2d2d         ext = "--
+0001ce20: 2d22 2069 6620 6973 5f64 6972 2065 6c73  -" if is_dir els
+0001ce30: 6520 666e 2e72 7370 6c69 7428 222e 222c  e fn.rsplit(".",
+0001ce40: 2031 295b 315d 0a20 2020 2020 2020 2020   1)[1].         
+0001ce50: 2020 2020 2020 2069 6620 6c65 6e28 6578         if len(ex
+0001ce60: 7429 203e 2031 363a 0a20 2020 2020 2020  t) > 16:.       
+0001ce70: 2020 2020 2020 2020 2020 2020 2065 7874               ext
+0001ce80: 203d 2065 7874 5b3a 3136 5d0a 2020 2020   = ext[:16].    
+0001ce90: 2020 2020 2020 2020 6578 6365 7074 3a0a          except:.
+0001cea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ceb0: 6578 7420 3d20 2225 220a 0a20 2020 2020  ext = "%"..     
+0001cec0: 2020 2020 2020 2069 6620 6164 645f 666b         if add_fk
+0001ced0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001cee0: 2020 6872 6566 203d 2022 2573 3f6b 3d25    href = "%s?k=%
+0001cef0: 7322 2025 2028 0a20 2020 2020 2020 2020  s" % (.         
+0001cf00: 2020 2020 2020 2020 2020 2071 756f 7465             quote
+0001cf10: 7028 6872 6566 292c 0a20 2020 2020 2020  p(href),.       
+0001cf20: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0001cf30: 662e 6765 6e5f 666b 280a 2020 2020 2020  f.gen_fk(.      
+0001cf40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf50: 2020 7365 6c66 2e61 7267 732e 666b 5f73    self.args.fk_s
+0001cf60: 616c 742c 2066 7370 6174 682c 2073 7a2c  alt, fspath, sz,
+0001cf70: 2030 2069 6620 414e 5957 494e 2065 6c73   0 if ANYWIN els
+0001cf80: 6520 696e 662e 7374 5f69 6e6f 0a20 2020  e inf.st_ino.   
+0001cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cfa0: 2029 5b3a 6164 645f 666b 5d2c 0a20 2020   )[:add_fk],.   
+0001cfb0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0001cfc0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0001cfd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cfe0: 2068 7265 6620 3d20 7175 6f74 6570 2868   href = quotep(h
+0001cff0: 7265 6629 0a0a 2020 2020 2020 2020 2020  ref)..          
+0001d000: 2020 6974 656d 203d 207b 0a20 2020 2020    item = {.     
+0001d010: 2020 2020 2020 2020 2020 2022 6c65 6164             "lead
+0001d020: 223a 206d 6172 6769 6e2c 0a20 2020 2020  ": margin,.     
+0001d030: 2020 2020 2020 2020 2020 2022 6872 6566             "href
+0001d040: 223a 2068 7265 662c 0a20 2020 2020 2020  ": href,.       
+0001d050: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+0001d060: 2066 6e2c 0a20 2020 2020 2020 2020 2020   fn,.           
+0001d070: 2020 2020 2022 737a 223a 2073 7a2c 0a20       "sz": sz,. 
+0001d080: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001d090: 6578 7422 3a20 6578 742c 0a20 2020 2020  ext": ext,.     
+0001d0a0: 2020 2020 2020 2020 2020 2022 6474 223a             "dt":
+0001d0b0: 2064 742c 0a20 2020 2020 2020 2020 2020   dt,.           
+0001d0c0: 2020 2020 2022 7473 223a 2069 6e74 286c       "ts": int(l
+0001d0d0: 696e 662e 7374 5f6d 7469 6d65 292c 0a20  inf.st_mtime),. 
+0001d0e0: 2020 2020 2020 2020 2020 207d 0a20 2020             }.   
+0001d0f0: 2020 2020 2020 2020 2069 6620 6973 5f64           if is_d
+0001d100: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
+0001d110: 2020 2020 6469 7273 2e61 7070 656e 6428      dirs.append(
+0001d120: 6974 656d 290a 2020 2020 2020 2020 2020  item).          
+0001d130: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001d140: 2020 2020 2020 2020 6669 6c65 732e 6170          files.ap
+0001d150: 7065 6e64 2869 7465 6d29 0a20 2020 2020  pend(item).     
+0001d160: 2020 2020 2020 2020 2020 2069 7465 6d5b             item[
+0001d170: 2272 6422 5d20 3d20 7265 6d0a 0a20 2020  "rd"] = rem..   
+0001d180: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+0001d190: 2020 2020 2020 7365 6c66 2e63 6f6f 6b69        self.cooki
+0001d1a0: 6573 2e67 6574 2822 6964 7868 2229 203d  es.get("idxh") =
+0001d1b0: 3d20 2279 220a 2020 2020 2020 2020 2020  = "y".          
+0001d1c0: 2020 616e 6420 226c 7322 206e 6f74 2069    and "ls" not i
+0001d1d0: 6e20 7365 6c66 2e75 7061 7261 6d0a 2020  n self.uparam.  
+0001d1e0: 2020 2020 2020 2020 2020 616e 6420 2276            and "v
+0001d1f0: 2220 6e6f 7420 696e 2073 656c 662e 7570  " not in self.up
+0001d200: 6172 616d 0a20 2020 2020 2020 2029 3a0a  aram.        ):.
+0001d210: 2020 2020 2020 2020 2020 2020 6964 785f              idx_
+0001d220: 6874 6d6c 203d 2073 6574 285b 2269 6e64  html = set(["ind
+0001d230: 6578 2e68 746d 222c 2022 696e 6465 782e  ex.htm", "index.
+0001d240: 6874 6d6c 225d 290a 2020 2020 2020 2020  html"]).        
+0001d250: 2020 2020 666f 7220 6974 656d 2069 6e20      for item in 
+0001d260: 6669 6c65 733a 0a20 2020 2020 2020 2020  files:.         
+0001d270: 2020 2020 2020 2069 6620 6974 656d 5b22         if item["
+0001d280: 6e61 6d65 225d 2069 6e20 6964 785f 6874  name"] in idx_ht
+0001d290: 6d6c 3a0a 2020 2020 2020 2020 2020 2020  ml:.            
+0001d2a0: 2020 2020 2020 2020 2320 646f 2066 756c          # do ful
+0001d2b0: 6c20 7265 736f 6c76 6520 696e 2063 6173  l resolve in cas
+0001d2c0: 6520 6f66 2073 6861 646f 7765 6420 6669  e of shadowed fi
+0001d2d0: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
+0001d2e0: 2020 2020 2020 2076 7020 3d20 766a 6f69         vp = vjoi
+0001d2f0: 6e28 7365 6c66 2e76 7061 7468 2e73 706c  n(self.vpath.spl
+0001d300: 6974 2822 3f22 295b 305d 2c20 6974 656d  it("?")[0], item
+0001d310: 5b22 6e61 6d65 225d 290a 2020 2020 2020  ["name"]).      
+0001d320: 2020 2020 2020 2020 2020 2020 2020 766e                vn
+0001d330: 2c20 7265 6d20 3d20 7365 6c66 2e61 7372  , rem = self.asr
+0001d340: 762e 7666 732e 6765 7428 7670 2c20 7365  v.vfs.get(vp, se
+0001d350: 6c66 2e75 6e61 6d65 2c20 5472 7565 2c20  lf.uname, True, 
+0001d360: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+0001d370: 2020 2020 2020 2020 2020 2061 7020 3d20             ap = 
+0001d380: 766e 2e63 616e 6f6e 6963 616c 2872 656d  vn.canonical(rem
+0001d390: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001d3a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001d3b0: 662e 7478 5f66 696c 6528 6170 2920 2023  f.tx_file(ap)  #
+0001d3c0: 2069 7320 6e6f 2d63 6163 6865 0a0a 2020   is no-cache..  
+0001d3d0: 2020 2020 2020 7461 6773 6574 2020 3d20        tagset  = 
+0001d3e0: 7365 7428 290a 2020 2020 2020 2020 666f  set().        fo
+0001d3f0: 7220 6665 2069 6e20 6669 6c65 733a 0a20  r fe in files:. 
+0001d400: 2020 2020 2020 2020 2020 2066 6e20 3d20             fn = 
+0001d410: 6665 5b22 6e61 6d65 225d 0a20 2020 2020  fe["name"].     
+0001d420: 2020 2020 2020 2072 6420 3d20 6665 5b22         rd = fe["
+0001d430: 7264 225d 0a20 2020 2020 2020 2020 2020  rd"].           
+0001d440: 2064 656c 2066 655b 2272 6422 5d0a 2020   del fe["rd"].  
+0001d450: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001d460: 2069 6375 723a 0a20 2020 2020 2020 2020   icur:.         
+0001d470: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
+0001d480: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001d490: 766e 2021 3d20 6462 763a 0a20 2020 2020  vn != dbv:.     
+0001d4a0: 2020 2020 2020 2020 2020 205f 2c20 7264             _, rd
+0001d4b0: 203d 2076 6e2e 6765 745f 6462 7628 7264   = vn.get_dbv(rd
+0001d4c0: 290a 0a20 2020 2020 2020 2020 2020 2071  )..            q
+0001d4d0: 203d 2022 7365 6c65 6374 206d 742e 6b2c   = "select mt.k,
+0001d4e0: 206d 742e 7620 6672 6f6d 2075 7020 696e   mt.v from up in
+0001d4f0: 6e65 7220 6a6f 696e 206d 7420 6f6e 206d  ner join mt on m
+0001d500: 742e 7720 3d20 7375 6273 7472 2875 702e  t.w = substr(up.
+0001d510: 772c 312c 3136 2920 7768 6572 6520 7570  w,1,16) where up
+0001d520: 2e72 6420 3d20 3f20 616e 6420 7570 2e66  .rd = ? and up.f
+0001d530: 6e20 3d20 3f20 616e 6420 2b6d 742e 6b20  n = ? and +mt.k 
+0001d540: 213d 2027 7827 220a 2020 2020 2020 2020  != 'x'".        
+0001d550: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001d560: 2020 2020 2020 2020 2072 203d 2069 6375           r = icu
+0001d570: 722e 6578 6563 7574 6528 712c 2028 7264  r.execute(q, (rd
+0001d580: 2c20 666e 2929 0a20 2020 2020 2020 2020  , fn)).         
+0001d590: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+0001d5a0: 696f 6e20 6173 2065 783a 0a20 2020 2020  ion as ex:.     
+0001d5b0: 2020 2020 2020 2020 2020 2069 6620 2264             if "d
+0001d5c0: 6174 6162 6173 6520 6973 206c 6f63 6b65  atabase is locke
+0001d5d0: 6422 2069 6e20 7374 7228 6578 293a 0a20  d" in str(ex):. 
+0001d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5f0: 2020 2062 7265 616b 0a0a 2020 2020 2020     break..      
+0001d600: 2020 2020 2020 2020 2020 7472 793a 0a20            try:. 
+0001d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d620: 2020 2061 7267 7320 3d20 7333 656e 6328     args = s3enc(
+0001d630: 6964 782e 6d65 6d5f 6375 722c 2072 642c  idx.mem_cur, rd,
+0001d640: 2066 6e29 0a20 2020 2020 2020 2020 2020   fn).           
+0001d650: 2020 2020 2020 2020 2072 203d 2069 6375           r = icu
+0001d660: 722e 6578 6563 7574 6528 712c 2061 7267  r.execute(q, arg
+0001d670: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+0001d680: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+0001d690: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0001d6a0: 203d 2022 7461 6720 7265 6164 2065 7272   = "tag read err
+0001d6b0: 6f72 2c20 7b7d 2f7b 7d5c 6e7b 7d22 0a20  or, {}/{}\n{}". 
+0001d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6d0: 2020 2073 656c 662e 6c6f 6728 742e 666f     self.log(t.fo
+0001d6e0: 726d 6174 2872 642c 2066 6e2c 206d 696e  rmat(rd, fn, min
+0001d6f0: 5f65 7828 2929 290a 2020 2020 2020 2020  _ex())).        
+0001d700: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+0001d710: 6b0a 0a20 2020 2020 2020 2020 2020 2066  k..            f
+0001d720: 655b 2274 6167 7322 5d20 3d20 7b6b 3a20  e["tags"] = {k: 
+0001d730: 7620 666f 7220 6b2c 2076 2069 6e20 727d  v for k, v in r}
+0001d740: 0a20 2020 2020 2020 2020 2020 205f 203d  .            _ =
+0001d750: 205b 7461 6773 6574 2e61 6464 286b 2920   [tagset.add(k) 
+0001d760: 666f 7220 6b20 696e 2066 655b 2274 6167  for k in fe["tag
+0001d770: 7322 5d5d 0a0a 2020 2020 2020 2020 6966  s"]]..        if
+0001d780: 2069 6375 723a 0a20 2020 2020 2020 2020   icur:.         
+0001d790: 2020 2074 6167 6c69 7374 203d 205b 6b20     taglist = [k 
+0001d7a0: 666f 7220 6b20 696e 2076 6e2e 666c 6167  for k in vn.flag
+0001d7b0: 732e 6765 7428 226d 7465 222c 2022 2229  s.get("mte", "")
+0001d7c0: 2e73 706c 6974 2822 2c22 2920 6966 206b  .split(",") if k
+0001d7d0: 2069 6e20 7461 6773 6574 5d0a 2020 2020   in tagset].    
+0001d7e0: 2020 2020 2020 2020 666f 7220 6665 2069          for fe i
+0001d7f0: 6e20 6469 7273 3a0a 2020 2020 2020 2020  n dirs:.        
+0001d800: 2020 2020 2020 2020 6665 5b22 7461 6773          fe["tags
+0001d810: 225d 203d 207b 7d0a 2020 2020 2020 2020  "] = {}.        
+0001d820: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001d830: 2020 7461 676c 6973 7420 3d20 6c69 7374    taglist = list
+0001d840: 2874 6167 7365 7429 0a0a 2020 2020 2020  (tagset)..      
+0001d850: 2020 6966 2069 735f 6c73 3a0a 2020 2020    if is_ls:.    
+0001d860: 2020 2020 2020 2020 6c73 5f72 6574 5b22          ls_ret["
+0001d870: 6469 7273 225d 203d 2064 6972 730a 2020  dirs"] = dirs.  
+0001d880: 2020 2020 2020 2020 2020 6c73 5f72 6574            ls_ret
+0001d890: 5b22 6669 6c65 7322 5d20 3d20 6669 6c65  ["files"] = file
+0001d8a0: 730a 2020 2020 2020 2020 2020 2020 6c73  s.            ls
+0001d8b0: 5f72 6574 5b22 7461 676c 6973 7422 5d20  _ret["taglist"] 
+0001d8c0: 3d20 7461 676c 6973 740a 2020 2020 2020  = taglist.      
+0001d8d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001d8e0: 662e 7478 5f6c 7328 6c73 5f72 6574 290a  f.tx_ls(ls_ret).
+0001d8f0: 0a20 2020 2020 2020 2064 6f63 203d 2073  .        doc = s
+0001d900: 656c 662e 7570 6172 616d 2e67 6574 2822  elf.uparam.get("
+0001d910: 646f 6322 2920 6966 2073 656c 662e 6361  doc") if self.ca
+0001d920: 6e5f 7265 6164 2065 6c73 6520 4e6f 6e65  n_read else None
+0001d930: 0a20 2020 2020 2020 2069 6620 646f 633a  .        if doc:
+0001d940: 0a20 2020 2020 2020 2020 2020 2064 6f63  .            doc
+0001d950: 203d 2075 6e71 756f 7465 7028 646f 632e   = unquotep(doc.
+0001d960: 7265 706c 6163 6528 222b 222c 2022 2022  replace("+", " "
+0001d970: 292e 7370 6c69 7428 223f 2229 5b30 5d29  ).split("?")[0])
+0001d980: 0a20 2020 2020 2020 2020 2020 206a 3261  .            j2a
+0001d990: 5b22 646f 636e 616d 6522 5d20 3d20 646f  ["docname"] = do
+0001d9a0: 630a 2020 2020 2020 2020 2020 2020 646f  c.            do
+0001d9b0: 6374 7874 203d 204e 6f6e 650a 2020 2020  ctxt = None.    
+0001d9c0: 2020 2020 2020 2020 6966 206e 6578 7428          if next(
+0001d9d0: 2878 2066 6f72 2078 2069 6e20 6669 6c65  (x for x in file
+0001d9e0: 7320 6966 2078 5b22 6e61 6d65 225d 203d  s if x["name"] =
+0001d9f0: 3d20 646f 6329 2c20 4e6f 6e65 293a 0a20  = doc), None):. 
+0001da00: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001da10: 6f63 7061 7468 203d 206f 732e 7061 7468  ocpath = os.path
+0001da20: 2e6a 6f69 6e28 6162 7370 6174 682c 2064  .join(abspath, d
+0001da30: 6f63 290a 2020 2020 2020 2020 2020 2020  oc).            
+0001da40: 2020 2020 737a 203d 2062 6f73 2e70 6174      sz = bos.pat
+0001da50: 682e 6765 7473 697a 6528 646f 6370 6174  h.getsize(docpat
+0001da60: 6829 0a20 2020 2020 2020 2020 2020 2020  h).             
+0001da70: 2020 2069 6620 737a 203c 2031 3032 3420     if sz < 1024 
+0001da80: 2a20 7365 6c66 2e61 7267 732e 7478 745f  * self.args.txt_
+0001da90: 6d61 783a 0a20 2020 2020 2020 2020 2020  max:.           
+0001daa0: 2020 2020 2020 2020 2077 6974 6820 6f70           with op
+0001dab0: 656e 2866 7365 6e63 2864 6f63 7061 7468  en(fsenc(docpath
+0001dac0: 292c 2022 7262 2229 2061 7320 663a 0a20  ), "rb") as f:. 
+0001dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dae0: 2020 2020 2020 2064 6f63 7478 7420 3d20         doctxt = 
+0001daf0: 662e 7265 6164 2829 2e64 6563 6f64 6528  f.read().decode(
+0001db00: 2275 7466 2d38 222c 2022 7265 706c 6163  "utf-8", "replac
+0001db10: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+0001db20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001db30: 2020 2020 2020 7365 6c66 2e6c 6f67 2822        self.log("
+0001db40: 646f 6320 3430 343a 205b 7b7d 5d22 2e66  doc 404: [{}]".f
+0001db50: 6f72 6d61 7428 646f 6329 2c20 633d 3629  ormat(doc), c=6)
+0001db60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001db70: 2064 6f63 7478 7420 3d20 2228 2074 6578   doctxt = "( tex
+0001db80: 7466 696c 6520 6e6f 7420 666f 756e 6420  tfile not found 
+0001db90: 2922 0a0a 2020 2020 2020 2020 2020 2020  )"..            
+0001dba0: 6966 2064 6f63 7478 7420 6973 206e 6f74  if doctxt is not
+0001dbb0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001dbc0: 2020 2020 2020 206a 3261 5b22 646f 6322         j2a["doc"
+0001dbd0: 5d20 3d20 646f 6374 7874 0a0a 2020 2020  ] = doctxt..    
+0001dbe0: 2020 2020 666f 7220 6420 696e 2064 6972      for d in dir
+0001dbf0: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
+0001dc00: 5b22 6e61 6d65 225d 202b 3d20 222f 220a  ["name"] += "/".
+0001dc10: 0a20 2020 2020 2020 2064 6972 732e 736f  .        dirs.so
+0001dc20: 7274 286b 6579 3d69 7465 6d67 6574 7465  rt(key=itemgette
+0001dc30: 7228 226e 616d 6522 2929 0a0a 2020 2020  r("name"))..    
+0001dc40: 2020 2020 6966 2069 735f 6a73 3a0a 2020      if is_js:.  
+0001dc50: 2020 2020 2020 2020 2020 6a32 615b 226c            j2a["l
+0001dc60: 7330 225d 203d 207b 2264 6972 7322 3a20  s0"] = {"dirs": 
+0001dc70: 6469 7273 2c20 2266 696c 6573 223a 2066  dirs, "files": f
+0001dc80: 696c 6573 2c20 2274 6167 6c69 7374 223a  iles, "taglist":
+0001dc90: 2074 6167 6c69 7374 7d0a 2020 2020 2020   taglist}.      
+0001dca0: 2020 2020 2020 6a32 615b 2266 696c 6573        j2a["files
+0001dcb0: 225d 203d 205b 5d0a 2020 2020 2020 2020  "] = [].        
+0001dcc0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001dcd0: 2020 6a32 615b 2266 696c 6573 225d 203d    j2a["files"] =
+0001dce0: 2064 6972 7320 2b20 6669 6c65 730a 0a20   dirs + files.. 
+0001dcf0: 2020 2020 2020 206a 3261 5b22 7461 676c         j2a["tagl
+0001dd00: 6973 7422 5d20 3d20 7461 676c 6973 740a  ist"] = taglist.
+0001dd10: 2020 2020 2020 2020 6a32 615b 2274 7874          j2a["txt
+0001dd20: 5f65 7874 225d 203d 2073 656c 662e 6172  _ext"] = self.ar
+0001dd30: 6773 2e74 6578 7466 696c 6573 2e72 6570  gs.textfiles.rep
+0001dd40: 6c61 6365 2822 2c22 2c20 2220 2229 0a0a  lace(",", " ")..
+0001dd50: 2020 2020 2020 2020 6966 2022 6d74 6822          if "mth"
+0001dd60: 2069 6e20 766e 2e66 6c61 6773 3a0a 2020   in vn.flags:.  
+0001dd70: 2020 2020 2020 2020 2020 6a32 615b 2264            j2a["d
+0001dd80: 6566 5f68 636f 6c73 225d 203d 2076 6e2e  ef_hcols"] = vn.
+0001dd90: 666c 6167 735b 226d 7468 225d 2e73 706c  flags["mth"].spl
+0001dda0: 6974 2822 2c22 290a 0a20 2020 2020 2020  it(",")..       
+0001ddb0: 2068 746d 6c20 3d20 7365 6c66 2e6a 3273   html = self.j2s
+0001ddc0: 2874 706c 2c20 2a2a 6a32 6129 0a20 2020  (tpl, **j2a).   
+0001ddd0: 2020 2020 2073 656c 662e 7265 706c 7928       self.reply(
+0001dde0: 6874 6d6c 2e65 6e63 6f64 6528 2275 7466  html.encode("utf
+0001ddf0: 2d38 222c 2022 7265 706c 6163 6522 2929  -8", "replace"))
+0001de00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001de10: 5472 7565 0a                             True.
```

### Comparing `copyparty-1.6.9/copyparty/httpconn.py` & `copyparty-1.7.0/copyparty/httpconn.py`

 * *Files 11% similar despite different names*

```diff
@@ -97,18 +97,19 @@
     def respath(self, res_name )  :
         return os.path.join(self.E.mod, "web", res_name)
 
     def log(self, msg , c   = 0)  :
         self.log_func(self.log_src, msg, c)
 
     def get_u2idx(self)  :
-        # one u2idx per tcp connection;
+        # grab from a pool of u2idx instances;
         # sqlite3 fully parallelizes under python threads
+        # but avoid running out of FDs by creating too many
         if not self.u2idx:
-            self.u2idx = U2idx(self)
+            self.u2idx = self.hsrv.get_u2idx(str(self.addr))
 
         return self.u2idx
 
     def _detect_https(self)  :
         method = None
         if self.cert_path:
             try:
@@ -208,7 +209,11 @@
             self.sr = Util.Unrecv(self.s, self.log)
 
         while not self.stopping:
             self.nreq += 1
             self.cli = HttpCli(self)
             if not self.cli.run():
                 return
+
+            if self.u2idx:
+                self.hsrv.put_u2idx(str(self.addr), self.u2idx)
+                self.u2idx = None
```

### Comparing `copyparty-1.6.9/copyparty/httpsrv.py` & `copyparty-1.7.0/copyparty/httpsrv.py`

 * *Files 6% similar despite different names*

```diff
@@ -7,15 +7,15 @@
 import socket
 import sys
 import threading
 import time
 
 import queue
 
-from .__init__ import ANYWIN, EXE, MACOS, TYPE_CHECKING, EnvParams
+from .__init__ import ANYWIN, CORES, EXE, MACOS, TYPE_CHECKING, EnvParams
 
 try:
     MNFE = ModuleNotFoundError
 except:
     MNFE = ImportError
 
 try:
@@ -36,14 +36,15 @@
             os.path.basename(sys.executable)
         )
     )
     sys.exit(1)
 
 from .bos import bos
 from .httpconn import HttpConn
+from .u2idx import U2idx
 from .util import (
     E_SCK,
     FHC,
     Daemon,
     Garda,
     Magician,
     Netdev,
@@ -103,14 +104,17 @@
         self.srvs  = []
         self.ncli = 0  # exact
         self.clients  = set()  # laggy
         self.nclimax = 0
         self.cb_ts = 0.0
         self.cb_v = ""
 
+        self.u2idx_free   = {}
+        self.u2idx_n = 0
+
         env = jinja2.Environment()
         env.loader = jinja2.FileSystemLoader(os.path.join(self.E.mod, "web"))
         jn = ["splash", "svcs", "browser", "browser2", "msg", "md", "mde", "cf"]
         self.j2 = {x: env.get_template(x + ".html") for x in jn}
         zs = os.path.join(self.E.mod, "web", "deps", "prism.js.gz")
         self.prism = os.path.exists(zs)
 
@@ -120,15 +124,15 @@
             self.mallow += zs.split()
 
         if self.args.zs:
             from .ssdp import SSDPr
 
             self.ssdp = SSDPr(broker)
 
-        cert_path = os.path.join(self.E.cfg, "cert.pem")
+        cert_path = self.args.cert
         if bos.path.exists(cert_path):
             self.cert_path = cert_path
         else:
             self.cert_path = ""
 
         if self.tp_q:
             self.start_threads(4)
@@ -437,14 +441,17 @@
                 if ex.errno not in E_SCK:
                     raise
             finally:
                 with self.mutex:
                     self.clients.remove(cli)
                     self.ncli -= 1
 
+                if cli.u2idx:
+                    self.put_u2idx(str(addr), cli.u2idx)
+
     def cachebuster(self)  :
         if time.time() - self.cb_ts < 1:
             return self.cb_v
 
         with self.mutex:
             if time.time() - self.cb_ts < 1:
                 return self.cb_v
@@ -458,7 +465,35 @@
             except:
                 pass
 
             v = base64.urlsafe_b64encode(spack(b">xxL", int(v)))
             self.cb_v = v.decode("ascii")[-4:]
             self.cb_ts = time.time()
             return self.cb_v
+
+    def get_u2idx(self, ident )  :
+        utab = self.u2idx_free
+        for _ in range(100):  # 5/0.05 = 5sec
+            with self.mutex:
+                if utab:
+                    if ident in utab:
+                        return utab.pop(ident)
+
+                    return utab.pop(list(utab.keys())[0])
+
+                if self.u2idx_n < CORES:
+                    self.u2idx_n += 1
+                    return U2idx(self)
+
+            time.sleep(0.05)
+            # not using conditional waits, on a hunch that
+            # average performance will be faster like this
+            # since most servers won't be fully saturated
+
+        return None
+
+    def put_u2idx(self, ident , u2idx )  :
+        with self.mutex:
+            while ident in self.u2idx_free:
+                ident += "a"
+
+            self.u2idx_free[ident] = u2idx
```

### Comparing `copyparty-1.6.9/copyparty/ico.py` & `copyparty-1.7.0/copyparty/ico.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/mdns.py` & `copyparty-1.7.0/copyparty/mdns.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/mtag.py` & `copyparty-1.7.0/copyparty/mtag.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/multicast.py` & `copyparty-1.7.0/copyparty/multicast.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/res/COPYING.txt` & `copyparty-1.7.0/copyparty/res/COPYING.txt`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/res/insecure.pem` & `copyparty-1.7.0/copyparty/res/insecure.pem`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/smbd.py` & `copyparty-1.7.0/copyparty/smbd.py`

 * *Files 0% similar despite different names*

```diff
@@ -254,15 +254,15 @@
 
         # return bos.unlink(self._v2a("stat", vpath, *a)[1])
         vfs, ap = self._v2a("delete", vpath)
         if not vfs.axs.udel:
             yeet("blocked delete (no-del-acc): " + vpath)
 
         vpath = vpath.replace("\\", "/").lstrip("/")
-        self.hub.up2k.handle_rm(LEELOO_DALLAS, "1.7.6.2", [vpath], [])
+        self.hub.up2k.handle_rm(LEELOO_DALLAS, "1.7.6.2", [vpath], [], False)
 
     def _utime(self, vpath , times  )  :
         if not self.args.smbw:
             yeet("blocked utime (no --smbw): " + vpath)
 
         vfs, ap = self._v2a("utime", vpath)
         if not vfs.axs.uwrite:
```

### Comparing `copyparty-1.6.9/copyparty/ssdp.py` & `copyparty-1.7.0/copyparty/ssdp.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/star.py` & `copyparty-1.7.0/copyparty/star.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/bimap.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/bimap.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/buffer.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/buffer.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/dns.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/dns.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/label.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/label.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/lex.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/lex.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/dnslib/ranges.py` & `copyparty-1.7.0/copyparty/stolen/dnslib/ranges.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/ifaddr/_posix.py` & `copyparty-1.7.0/copyparty/stolen/ifaddr/_posix.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/ifaddr/_shared.py` & `copyparty-1.7.0/copyparty/stolen/ifaddr/_shared.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/ifaddr/_win32.py` & `copyparty-1.7.0/copyparty/stolen/ifaddr/_win32.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/qrcodegen.py` & `copyparty-1.7.0/copyparty/stolen/qrcodegen.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/stolen/surrogateescape.py` & `copyparty-1.7.0/copyparty/stolen/surrogateescape.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/sutil.py` & `copyparty-1.7.0/copyparty/sutil.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/svchub.py` & `copyparty-1.7.0/copyparty/svchub.py`

 * *Files 2% similar despite different names*

```diff
@@ -118,14 +118,17 @@
         if args.s:
             args.dotpart = True
             args.no_thumb = True
             args.no_mtag_ff = True
             args.no_robots = True
             args.force_js = True
 
+        if not self._process_config():
+            raise Exception("bad config")
+
         self.log = self._log_disabled if args.q else self._log_enabled
         if args.lo:
             self._setup_logfile(printed)
 
         lg = logging.getLogger()
         lh = HLog(self.log)
         lg.handlers = [lh]
@@ -167,17 +170,14 @@
             self.asrv.dbg_ls()
 
         if not ANYWIN:
             self._setlimits()
 
         self.log("root", "max clients: {}".format(self.args.nc))
 
-        if not self._process_config():
-            raise Exception("bad config")
-
         self.tcpsrv = TcpSrv(self)
         self.up2k = Up2k(self)
 
         decs = {k: 1 for k in self.args.th_dec.split(",")}
         if not HAVE_VIPS:
             decs.pop("vips", None)
         if not HAVE_PIL:
@@ -340,14 +340,27 @@
         al.SRS = "/" + R + "/" if R else "/"
 
         if al.rsp_jtr:
             al.rsp_slp = 0.000001
 
         al.th_covers = set(al.th_covers.split(","))
 
+        for k in "c".split(" "):
+            vl = getattr(al, k)
+            if not vl:
+                continue
+
+            vl = [os.path.expanduser(x) if x.startswith("~") else x for x in vl]
+            setattr(al, k, vl)
+
+        for k in "lo hist ssl_log".split(" "):
+            vs = getattr(al, k)
+            if vs and vs.startswith("~"):
+                setattr(al, k, os.path.expanduser(vs))
+
         return True
 
     def _setlimits(self)  :
         try:
             import resource
 
             soft, hard = [
@@ -624,16 +637,22 @@
             sys.exit(ret)
 
     def _log_disabled(self, src , msg , c   = 0)  :
         if not self.logf:
             return
 
         with self.log_mutex:
-            ts = datetime.utcnow().strftime("%Y-%m%d-%H%M%S.%f")[:-3]
-            self.logf.write("@{} [{}\033[0m] {}\n".format(ts, src, msg))
+            zd = datetime.utcnow()
+            ts = "%04d-%04d-%06d.%03d" % (
+                zd.year,
+                zd.month * 100 + zd.day,
+                (zd.hour * 100 + zd.minute) * 100 + zd.second,
+                zd.microsecond // 1000,
+            )
+            self.logf.write("@%s [%s\033[0m] %s\n" % (ts, src, msg))
 
             now = time.time()
             if now >= self.next_day:
                 self._set_next_day()
 
     def _set_next_day(self)  :
         if self.next_day and self.logf and self.logf_base_fn != self._logname():
@@ -655,31 +674,37 @@
         with self.log_mutex:
             now = time.time()
             if now >= self.next_day:
                 dt = datetime.utcfromtimestamp(now)
                 print("\033[36m{}\033[0m\n".format(dt.strftime("%Y-%m-%d")), end="")
                 self._set_next_day()
 
-            fmt = "\033[36m{} \033[33m{:21} \033[0m{}\n"
+            fmt = "\033[36m%s \033[33m%-21s \033[0m%s\n"
             if not VT100:
-                fmt = "{} {:21} {}\n"
+                fmt = "%s %-21s %s\n"
                 if "\033" in msg:
                     msg = ansi_re.sub("", msg)
                 if "\033" in src:
                     src = ansi_re.sub("", src)
             elif c:
                 if isinstance(c, int):
-                    msg = "\033[3{}m{}\033[0m".format(c, msg)
+                    msg = "\033[3%sm%s\033[0m" % (c, msg)
                 elif "\033" not in c:
-                    msg = "\033[{}m{}\033[0m".format(c, msg)
+                    msg = "\033[%sm%s\033[0m" % (c, msg)
                 else:
-                    msg = "{}{}\033[0m".format(c, msg)
+                    msg = "%s%s\033[0m" % (c, msg)
 
-            ts = datetime.utcfromtimestamp(now).strftime("%H:%M:%S.%f")[:-3]
-            msg = fmt.format(ts, src, msg)
+            zd = datetime.utcfromtimestamp(now)
+            ts = "%02d:%02d:%02d.%03d" % (
+                zd.hour,
+                zd.minute,
+                zd.second,
+                zd.microsecond // 1000,
+            )
+            msg = fmt % (ts, src, msg)
             try:
                 print(msg, end="")
             except UnicodeEncodeError:
                 try:
                     print(msg.encode("utf-8", "replace").decode(), end="")
                 except:
                     print(msg.encode("ascii", "replace").decode(), end="")
```

### Comparing `copyparty-1.6.9/copyparty/szip.py` & `copyparty-1.7.0/copyparty/szip.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/tcpsrv.py` & `copyparty-1.7.0/copyparty/tcpsrv.py`

 * *Files 0% similar despite different names*

```diff
@@ -315,15 +315,15 @@
             for k, v in netdevs.items():
                 if k not in self.netdevs:
                     added = "{} = {}".format(k, v)
             for k, v in self.netdevs.items():
                 if k not in netdevs:
                     removed = "{} = {}".format(k, v)
 
-            t = "network change detected:\n  added {}\nremoved {}"
+            t = "network change detected:\n  added {}\033[0;33m\nremoved {}"
             self.log("tcpsrv", t.format(added, removed), 3)
             self.netdevs = netdevs
             self._distribute_netdevs()
 
     def detect_interfaces(self, listen_ips )   :
         from .stolen.ifaddr import get_adapters
```

### Comparing `copyparty-1.6.9/copyparty/th_cli.py` & `copyparty-1.7.0/copyparty/th_cli.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/th_srv.py` & `copyparty-1.7.0/copyparty/th_srv.py`

 * *Files 2% similar despite different names*

```diff
@@ -12,18 +12,18 @@
 
 from queue import Queue
 
 from .__init__ import ANYWIN, TYPE_CHECKING
 from .bos import bos
 from .mtag import HAVE_FFMPEG, HAVE_FFPROBE, ffprobe
 from .util import (
+    FFMPEG_URL,
     BytesIO,
     Cooldown,
     Daemon,
-    FFMPEG_URL,
     Pebkac,
     afsenc,
     fsenc,
     min_ex,
     runcmd,
     statdir,
     vsplit,
@@ -267,14 +267,18 @@
                             funs.append(self.conv_spec)
 
             if not png_ok and tpath.endswith(".png"):
                 raise Pebkac(400, "png only allowed for waveforms")
 
             tdir, tfn = os.path.split(tpath)
             ttpath = os.path.join(tdir, "w", tfn)
+            try:
+                bos.unlink(ttpath)
+            except:
+                pass
 
             for fun in funs:
                 try:
                     fun(abspath, ttpath)
                     break
                 except Exception as ex:
                     msg = "{} could not create thumbnail of {}\n{}"
@@ -554,21 +558,32 @@
         if self.args.no_acode:
             raise Exception("disabled in server config")
 
         ret, _ = ffprobe(abspath, int(self.args.th_convt / 2))
         if "ac" not in ret:
             raise Exception("not audio")
 
+        try:
+            dur = ret[".dur"][1]
+        except:
+            dur = 0
+
         src_opus = abspath.lower().endswith(".opus") or ret["ac"][1] == "opus"
         want_caf = tpath.endswith(".caf")
         tmp_opus = tpath
         if want_caf:
-            tmp_opus = tpath.rsplit(".", 1)[0] + ".opus"
+            tmp_opus = tpath + ".opus"
+            try:
+                bos.unlink(tmp_opus)
+            except:
+                pass
 
-        if not want_caf or (not src_opus and not bos.path.isfile(tmp_opus)):
+        caf_src = abspath if src_opus else tmp_opus
+
+        if not want_caf or not src_opus:
             # fmt: off
             cmd = [
                 b"ffmpeg",
                 b"-nostdin",
                 b"-v", b"error",
                 b"-hide_banner",
                 b"-i", fsenc(abspath),
@@ -577,15 +592,40 @@
                 b"-c:a", b"libopus",
                 b"-b:a", b"128k",
                 fsenc(tmp_opus)
             ]
             # fmt: on
             self._run_ff(cmd)
 
-        if want_caf:
+        # iOS fails to play some "insufficiently complex" files
+        # (average file shorter than 8 seconds), so of course we
+        # fix that by mixing in some inaudible pink noise :^)
+        # 6.3 sec seems like the cutoff so lets do 7, and
+        # 7 sec of psyqui-musou.opus @ 3:50 is 174 KiB
+        if want_caf and (dur < 20 or bos.path.getsize(caf_src) < 256 * 1024):
+            # fmt: off
+            cmd = [
+                b"ffmpeg",
+                b"-nostdin",
+                b"-v", b"error",
+                b"-hide_banner",
+                b"-i", fsenc(abspath),
+                b"-filter_complex", b"anoisesrc=a=0.001:d=7:c=pink,asplit[l][r]; [l][r]amerge[s]; [0:a:0][s]amix",
+                b"-map_metadata", b"-1",
+                b"-ac", b"2",
+                b"-c:a", b"libopus",
+                b"-b:a", b"128k",
+                b"-f", b"caf",
+                fsenc(tpath)
+            ]
+            # fmt: on
+            self._run_ff(cmd)
+
+        elif want_caf:
+            # simple remux should be safe
             # fmt: off
             cmd = [
                 b"ffmpeg",
                 b"-nostdin",
                 b"-v", b"error",
                 b"-hide_banner",
                 b"-i", fsenc(abspath if src_opus else tmp_opus),
@@ -594,14 +634,20 @@
                 b"-c:a", b"copy",
                 b"-f", b"caf",
                 fsenc(tpath)
             ]
             # fmt: on
             self._run_ff(cmd)
 
+        if tmp_opus != tpath:
+            try:
+                bos.unlink(tmp_opus)
+            except:
+                pass
+
     def poke(self, tdir )  :
         if not self.poke_cd.poke(tdir):
             return
 
         ts = int(time.time())
         try:
             for _ in range(4):
```

### Comparing `copyparty-1.6.9/copyparty/u2idx.py` & `copyparty-1.7.0/copyparty/u2idx.py`

 * *Files 2% similar despite different names*

```diff
@@ -27,32 +27,32 @@
 
 try:
     from pathlib import Path
 except:
     pass
 
 if TYPE_CHECKING:
-    from .httpconn import HttpConn
+    from .httpsrv import HttpSrv
 
 
 class U2idx(object):
-    def __init__(self, conn )  :
-        self.log_func = conn.log_func
-        self.asrv = conn.asrv
-        self.args = conn.args
+    def __init__(self, hsrv )  :
+        self.log_func = hsrv.log
+        self.asrv = hsrv.asrv
+        self.args = hsrv.args
         self.timeout = self.args.srch_time
 
         if not HAVE_SQLITE3:
             self.log("your python does not have sqlite3; searching will be disabled")
             return
 
         self.active_id = ""
         self.active_cur  = None
         self.cur   = {}
-        self.mem_cur = sqlite3.connect(":memory:").cursor()
+        self.mem_cur = sqlite3.connect(":memory:", check_same_thread=False).cursor()
         self.mem_cur.execute(r"create table a (b text)")
 
         self.p_end = 0.0
         self.p_dur = 0.0
 
     def log(self, msg , c   = 0)  :
         self.log_func("u2idx", msg, c)
@@ -94,26 +94,27 @@
             return None
 
         cur = None
         if ANYWIN and not bos.path.exists(db_path + "-wal"):
             uri = ""
             try:
                 uri = "{}?mode=ro&nolock=1".format(Path(db_path).as_uri())
-                cur = sqlite3.connect(uri, 2, uri=True).cursor()
+                db = sqlite3.connect(uri, 2, uri=True, check_same_thread=False)
+                cur = db.cursor()
                 cur.execute('pragma table_info("up")').fetchone()
                 self.log("ro: {}".format(db_path))
             except:
                 self.log("could not open read-only: {}\n{}".format(uri, min_ex()))
                 # may not fail until the pragma so unset it
                 cur = None
 
         if not cur:
             # on windows, this steals the write-lock from up2k.deferred_init --
             # seen on win 10.0.17763.2686, py 3.10.4, sqlite 3.37.2
-            cur = sqlite3.connect(db_path, 2).cursor()
+            cur = sqlite3.connect(db_path, 2, check_same_thread=False).cursor()
             self.log("opened {}".format(db_path))
 
         self.cur[ptop] = cur
         return cur
 
     def search(
         self, vols    , uq , lim
```

### Comparing `copyparty-1.6.9/copyparty/up2k.py` & `copyparty-1.7.0/copyparty/up2k.py`

 * *Files 0% similar despite different names*

```diff
@@ -373,19 +373,19 @@
                     if not hits:
                         break
 
                     for rd, fn in hits:
                         if rd.startswith("//") or fn.startswith("//"):
                             rd, fn = s3dec(rd, fn)
 
-                        fvp = "{}/{}".format(rd, fn).strip("/")
+                        fvp = ("%s/%s" % (rd, fn)).strip("/")
                         if vp:
-                            fvp = "{}/{}".format(vp, fvp)
+                            fvp = "%s/%s" % (vp, fvp)
 
-                        self._handle_rm(LEELOO_DALLAS, "", fvp, [])
+                        self._handle_rm(LEELOO_DALLAS, "", fvp, [], True)
                         nrm += 1
 
                 if nrm:
                     self.log("{} files graduated in {}".format(nrm, vp))
 
                 if timeout < 10:
                     continue
@@ -1025,15 +1025,15 @@
             else:
                 zh = hashlib.sha1()
                 _ = [zh.update(str(x).encode("utf-8", "replace")) for x in files]
 
             zh.update(cv.encode("utf-8", "replace"))
             zh.update(spack(b"<d", cst.st_mtime))
             dhash = base64.urlsafe_b64encode(zh.digest()[:12]).decode("ascii")
-            sql = "select d from dh where d = ? and h = ?"
+            sql = "select d from dh where d=? and +h=?"
             try:
                 c = db.c.execute(sql, (rd, dhash))
                 drd = rd
             except:
                 drd = "//" + w8b64enc(rd)
                 c = db.c.execute(sql, (drd, dhash))
 
@@ -1309,17 +1309,17 @@
         with gzip.GzipFile(mode="rb", fileobj=tf) as gf:
             for zb in gf:
                 if self.stop:
                     return -1
 
                 w, drd, dfn = zb[:-1].decode("utf-8").split("\x00")
                 with self.mutex:
-                    q = "select mt, sz from up where w = ? and rd = ? and fn = ?"
+                    q = "select mt, sz from up where rd=? and fn=? and +w=?"
                     try:
-                        mt, sz = cur.execute(q, (w, drd, dfn)).fetchone()
+                        mt, sz = cur.execute(q, (drd, dfn, w)).fetchone()
                     except:
                         # file moved/deleted since spooling
                         continue
 
                 n_left -= 1
                 b_left -= sz
                 if drd.startswith("//") or dfn.startswith("//"):
@@ -2216,15 +2216,15 @@
                 cvfs = next((v for v in allv.values() if v.realpath == ptop), vfs)
                 vtop = cj["vtop"] if cur == jcur else cvfs.vpath
 
                 if self.no_expr_idx:
                     q = r"select * from up where w = ?"
                     argv = [wark]
                 else:
-                    q = r"select * from up where substr(w,1,16) = ? and w = ?"
+                    q = r"select * from up where substr(w,1,16)=? and +w=?"
                     argv = [wark[:16], wark]
 
                 c2 = cur.execute(q, tuple(argv))
                 for _, dtime, dsize, dp_dir, dp_fn, ip, at in c2:
                     if dp_dir.startswith("//") or dp_fn.startswith("//"):
                         dp_dir, dp_fn = s3dec(dp_dir, dp_fn)
 
@@ -2890,38 +2890,40 @@
             crd, cdn = rd.rsplit("/", 1) if "/" in rd else ("", rd)
             try:
                 db.execute("delete from cv where rd=? and dn=?", (crd, cdn))
                 db.execute("insert into cv values (?,?,?)", (crd, cdn, fn))
             except:
                 pass
 
-    def handle_rm(self, uname , ip , vpaths , lim )  :
+    def handle_rm(
+        self, uname , ip , vpaths , lim , rm_up 
+    )  :
         n_files = 0
         ok = {}
         ng = {}
         for vp in vpaths:
             if lim and lim[0] <= 0:
                 self.log("hit delete limit of {} files".format(lim[1]), 3)
                 break
 
-            a, b, c = self._handle_rm(uname, ip, vp, lim)
+            a, b, c = self._handle_rm(uname, ip, vp, lim, rm_up)
             n_files += a
             for k in b:
                 ok[k] = 1
             for k in c:
                 ng[k] = 1
 
         ng = {k: 1 for k in ng if k not in ok}
         iok = len(ok)
         ing = len(ng)
 
         return "deleted {} files (and {}/{} folders)".format(n_files, iok, iok + ing)
 
     def _handle_rm(
-        self, uname , ip , vpath , lim 
+        self, uname , ip , vpath , lim , rm_up 
     )    :
         self.db_act = time.time()
         try:
             permsets = [[True, False, False, True]]
             vn, rem = self.asrv.vfs.get(vpath, uname, *permsets[0])
             vn, rem = vn.get_dbv(rem)
             unpost = False
@@ -3020,24 +3022,30 @@
                         if cur:
                             cur.connection.commit()
 
                 bos.unlink(abspath)
                 if xad:
                     runhook(self.log, xad, abspath, vpath, "", uname, 0, 0, ip, 0, "")
 
-        ok  = []
-        ng  = []
         if is_dir:
             ok, ng = rmdirs(self.log_func, scandir, True, atop, 1)
+        else:
+            ok = ng = []
 
-        ok2, ng2 = rmdirs_up(os.path.dirname(atop), ptop)
+        if rm_up:
+            ok2, ng2 = rmdirs_up(os.path.dirname(atop), ptop)
+        else:
+            ok2 = ng2 = []
 
         return n_files, ok + ok2, ng + ng2
 
     def handle_mv(self, uname , svp , dvp )  :
+        if svp == dvp or dvp.startswith(svp + "/"):
+            raise Pebkac(400, "mv: cannot move parent into subfolder")
+
         svn, srem = self.asrv.vfs.get(svp, uname, True, False, True)
         svn, srem = svn.get_dbv(srem)
         sabs = svn.canonical(srem, False)
         curs  = set()
         self.db_act = self.vol_act[svn.realpath] = time.time()
 
         if not srem:
@@ -3083,16 +3091,29 @@
                         self._mv_file(uname, svpf, dvpf, curs)
                 finally:
                     for v in curs:
                         v.connection.commit()
 
             curs.clear()
 
-        rmdirs(self.log_func, scandir, True, sabs, 1)
-        rmdirs_up(os.path.dirname(sabs), svn.realpath)
+        rm_ok, rm_ng = rmdirs(self.log_func, scandir, True, sabs, 1)
+
+        for zsl in (rm_ok, rm_ng):
+            for ap in reversed(zsl):
+                if not ap.startswith(sabs):
+                    raise Pebkac(500, "mv_d: bug at {}, top {}".format(ap, sabs))
+
+                rem = ap[len(sabs) :].replace(os.sep, "/").lstrip("/")
+                vp = vjoin(dvp, rem)
+                try:
+                    dvn, drem = self.asrv.vfs.get(vp, uname, False, True)
+                    bos.mkdir(dvn.canonical(drem))
+                except:
+                    pass
+
         return "k"
 
     def _mv_file(
         self, uname , svp , dvp , curs 
     )  :
         svn, srem = self.asrv.vfs.get(svp, uname, True, False, True)
         svn, srem = svn.get_dbv(srem)
@@ -3293,17 +3314,24 @@
     def _relink(self, wark , sptop , srem , dabs )  :
         """
         update symlinks from file at svn/srem to dabs (rename),
         or to first remaining full if no dabs (delete)
         """
         dupes = []
         sabs = djoin(sptop, srem)
-        q = "select rd, fn from up where substr(w,1,16)=? and w=?"
+
+        if self.no_expr_idx:
+            q = r"select rd, fn from up where w = ?"
+            argv = (wark,)
+        else:
+            q = r"select rd, fn from up where substr(w,1,16)=? and +w=?"
+            argv = (wark[:16], wark)
+
         for ptop, cur in self.cur.items():
-            for rd, fn in cur.execute(q, (wark[:16], wark)):
+            for rd, fn in cur.execute(q, argv):
                 if rd.startswith("//") or fn.startswith("//"):
                     rd, fn = s3dec(rd, fn)
 
                 dvrem = vjoin(rd, fn).strip("/")
                 if ptop != sptop or srem != dvrem:
                     dupes.append([ptop, dvrem])
                     self.log("found {} dupe: [{}] {}".format(wark, ptop, dvrem))
```

### Comparing `copyparty-1.6.9/copyparty/util.py` & `copyparty-1.7.0/copyparty/util.py`

 * *Files 1% similar despite different names*

```diff
@@ -517,25 +517,29 @@
     """
 
     def __init__(self, s , log )  :
         self.s = s
         self.log = log
         self.buf  = b""
 
-    def recv(self, nbytes )  :
+    def recv(self, nbytes , spins  = 1)  :
         if self.buf:
             ret = self.buf[:nbytes]
             self.buf = self.buf[nbytes:]
             return ret
 
         while True:
             try:
                 ret = self.s.recv(nbytes)
                 break
             except socket.timeout:
+                spins -= 1
+                if spins <= 0:
+                    ret = b""
+                    break
                 continue
             except:
                 ret = b""
                 break
 
         if not ret:
             raise UnrecvEOF("client stopped sending data")
@@ -570,15 +574,15 @@
     """
 
     def __init__(self, s , log )  :
         self.s = s
         self.log = log
         self.buf = b""
 
-    def recv(self, nbytes )  :
+    def recv(self, nbytes , spins )  :
         if self.buf:
             ret = self.buf[:nbytes]
             self.buf = self.buf[nbytes:]
             t = "\033[0;7mur:pop:\033[0;1;32m {}\n\033[0;7mur:rem:\033[0;1;35m {}\033[0m"
             print(t.format(ret, self.buf))
             return ret
 
@@ -589,23 +593,23 @@
             raise UnrecvEOF("client stopped sending data")
 
         return ret
 
     def recv_ex(self, nbytes , raise_on_trunc  = True)  :
         """read an exact number of bytes"""
         try:
-            ret = self.recv(nbytes)
+            ret = self.recv(nbytes, 1)
             err = False
         except:
             ret = b""
             err = True
 
         while not err and len(ret) < nbytes:
             try:
-                ret += self.recv(nbytes - len(ret))
+                ret += self.recv(nbytes - len(ret), 1)
             except OSError:
                 err = True
 
         if err:
             t = "client only sent {} of {} expected bytes".format(len(ret), nbytes)
             if raise_on_trunc:
                 raise UnrecvEOF(t)
@@ -1272,15 +1276,15 @@
     def _read_header(self)   :
         """
         returns [fieldname, filename] after eating a block of multipart headers
         while doing a decent job at dealing with the absolute mess that is
         rfc1341/rfc1521/rfc2047/rfc2231/rfc2388/rfc6266/the-real-world
         (only the fallback non-js uploader relies on these filenames)
         """
-        for ln in read_header(self.sr):
+        for ln in read_header(self.sr, 2, 2592000):
             self.log(ln)
 
             m = self.re_ctype.match(ln)
             if m:
                 if m.group(1).lower() == "multipart/mixed":
                     # rfc-7578 overrides rfc-2388 so this is not-impl
                     # (opera >=9 <11.10 is the only thing i've ever seen use it)
@@ -1472,23 +1476,23 @@
     m = re.match(ptn, ct, re.IGNORECASE)
     if not m:
         raise Pebkac(400, "invalid content-type for a multipart post: {}".format(ct))
 
     return m.group(2)
 
 
-def read_header(sr )  :
+def read_header(sr , t_idle , t_tot )  :
     t0 = time.time()
     ret = b""
     while True:
-        if time.time() - t0 > 120:
+        if time.time() - t0 >= t_tot:
             return []
 
         try:
-            ret += sr.recv(1024)
+            ret += sr.recv(1024, t_idle // 2)
         except:
             if not ret:
                 return []
 
             raise Pebkac(
                 400,
                 "protocol error while reading headers:\n"
@@ -1529,15 +1533,15 @@
 
     return fn
 
 
 def gen_filekey(salt , fspath , fsize , inode )  :
     return base64.urlsafe_b64encode(
         hashlib.sha512(
-            "{} {} {} {}".format(salt, fspath, fsize, inode).encode("utf-8", "replace")
+            ("%s %s %s %s" % (salt, fspath, fsize, inode)).encode("utf-8", "replace")
         ).digest()
     ).decode("ascii")
 
 
 def gen_filekey_dbg(
     salt ,
     fspath ,
@@ -1638,15 +1642,15 @@
 def uncyg(path )  :
     if len(path) < 2 or not path.startswith("/"):
         return path
 
     if len(path) > 2 and path[2] != "/":
         return path
 
-    return "{}:\\{}".format(path[1], path[3:])
+    return "%s:\\%s" % (path[1], path[3:])
 
 
 def undot(path )  :
     ret  = []
     for node in path.split("/"):
         if node in ["", "."]:
             continue
@@ -1681,15 +1685,15 @@
             ["*", ""],
         ]
         for a, b in [x for x in remap if x[0] not in ok]:
             fn = fn.replace(a, b)
 
         bad = ["con", "prn", "aux", "nul"]
         for n in range(1, 10):
-            bad += "com{0} lpt{0}".format(n).split(" ")
+            bad += ("com%s lpt%s" % (n, n)).split(" ")
 
         if fn.lower().split(".")[0] in bad:
             fn = "_" + fn
 
     return fn.strip()
 
 
@@ -2246,15 +2250,15 @@
         depth -= 1
 
     stats = statdir(logger, scandir, lstat, top)
     dirs = [x[0] for x in stats if stat.S_ISDIR(x[1].st_mode)]
     dirs = [os.path.join(top, x) for x in dirs]
     ok = []
     ng = []
-    for d in dirs[::-1]:
+    for d in reversed(dirs):
         a, b = rmdirs(logger, scandir, lstat, d, depth + 1)
         ok += a
         ng += b
 
     if depth:
         try:
             os.rmdir(fsenc(top))
```

### Comparing `copyparty-1.6.9/copyparty/web/a/partyfuse.py` & `copyparty-1.7.0/copyparty/web/a/partyfuse.py`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/a/up2k.py` & `copyparty-1.7.0/copyparty/web/a/up2k.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 #!/usr/bin/env python3
 from __future__ import print_function, unicode_literals
 
-S_VERSION = "1.5"
-S_BUILD_DT = "2023-03-12"
+S_VERSION = "1.8"
+S_BUILD_DT = "2023-04-27"
 
 """
 up2k.py: upload to copyparty
 2021, ed <irc.rizon.net>, MIT-Licensed
 https://github.com/9001/copyparty/blob/hovudstraum/bin/up2k.py
 
 - dependencies: requests
@@ -17,14 +17,15 @@
 import os
 import sys
 import stat
 import math
 import time
 import atexit
 import signal
+import socket
 import base64
 import hashlib
 import platform
 import threading
 import datetime
 
 EXE = sys.executable.endswith("exe")
@@ -54,21 +55,23 @@
 
 
 # from copyparty/__init__.py
 PY2 = sys.version_info < (3,)
 if PY2:
     from Queue import Queue
     from urllib import quote, unquote
+    from urlparse import urlsplit, urlunsplit
 
     sys.dont_write_bytecode = True
     bytes = str
 else:
     from queue import Queue
     from urllib.parse import unquote_to_bytes as unquote
     from urllib.parse import quote_from_bytes as quote
+    from urllib.parse import urlsplit, urlunsplit
 
     unicode = str
 
 VT100 = platform.system() != "Windows"
 
 
 req_ses = requests.Session()
@@ -333,14 +336,40 @@
             t = "{0}\033[{1}A".format("\n" * margin, margin)
             eprint("{0}\033[s\033[1;{1}r\033[u".format(t, self.g - 1))
 
 
 ss = CTermsize()
 
 
+def undns(url):
+    usp = urlsplit(url)
+    hn = usp.hostname
+    gai = None
+    eprint("resolving host [{0}] ...".format(hn), end="")
+    try:
+        gai = socket.getaddrinfo(hn, None)
+        hn = gai[0][4][0]
+    except KeyboardInterrupt:
+        raise
+    except:
+        t = "\n\033[31mfailed to resolve upload destination host;\033[0m\ngai={0}\n"
+        eprint(t.format(repr(gai)))
+        raise
+
+    if usp.port:
+        hn = "{0}:{1}".format(hn, usp.port)
+    if usp.username or usp.password:
+        hn = "{0}:{1}@{2}".format(usp.username, usp.password, hn)
+
+    usp = usp._replace(netloc=hn)
+    url = urlunsplit(usp)
+    eprint(" {0}".format(url))
+    return url
+
+
 def _scd(err, top):
     """non-recursive listing of directory contents, along with stat() info"""
     with os.scandir(top) as dh:
         for fh in dh:
             abspath = os.path.join(top, fh.name)
             try:
                 yield [abspath, fh.stat()]
@@ -649,14 +678,15 @@
                 eprint("hint: aborting because --ok is not set\n")
                 return
 
         eprint("found {0} files, {1}\n\n".format(nfiles, humansize(nbytes)))
         return nfiles, nbytes
 
     def __init__(self, ar, stats=None):
+        self.ok = False
         self.ar = ar
         self.stats = stats or self._scan()
         if not self.stats:
             return
 
         self.nfiles, self.nbytes = self.stats
 
@@ -696,14 +726,16 @@
             self.st_hash = [None, "(idle, starting...)"]  # type: tuple[File, int]
             self.st_up = [None, "(idle, starting...)"]  # type: tuple[File, int]
 
             self.mth = MTHash(ar.J) if ar.J > 1 else None
 
             self._fancy()
 
+        self.ok = True
+
     def _safe(self):
         """minimal basic slow boring fallback codepath"""
         search = self.ar.s
         for nf, (top, rel, inf) in enumerate(self.filegen):
             if stat.S_ISDIR(inf.st_mode) or not rel:
                 continue
 
@@ -846,15 +878,15 @@
                         headers["Cookie"] = "=".join(["cppwd", self.ar.a])
 
                     ls = {}
                     try:
                         print("      ls ~{0}".format(srd))
                         zb = self.ar.url.encode("utf-8")
                         zb += quotep(rd.replace(b"\\", b"/"))
-                        r = req_ses.get(zb + b"?ls&dots", headers=headers)
+                        r = req_ses.get(zb + b"?ls&lt&dots", headers=headers)
                         if not r:
                             raise Exception("HTTP {0}".format(r.status_code))
 
                         j = r.json()
                         for f in j["dirs"] + j["files"]:
                             rfn = f["href"].split("?")[0].rstrip("/")
                             ls[unquote(rfn.encode("utf-8", "replace"))] = f
@@ -924,15 +956,15 @@
                 break
 
             with self.mutex:
                 self.handshaker_busy += 1
 
             upath = file.abs.decode("utf-8", "replace")
             if not VT100:
-                upath = upath[4:]
+                upath = upath.lstrip("\\?")
 
             hs, sprs = handshake(self.ar, file, search)
             if search:
                 if hs:
                     for hit in hs:
                         t = "found: {0}\n  {1}{2}\n"
                         print(t.format(upath, burl, hit["rp"]), end="")
@@ -1005,16 +1037,17 @@
                 int((self.nbytes - self.up_b) / (1024 * 1024)),
                 self.eta,
             )
 
             file, cid = task
             try:
                 upload(file, cid, self.ar.a, stats)
-            except:
-                eprint("upload failed, retrying: {0} #{1}\n".format(file.name, cid[:8]))
+            except Exception as ex:
+                t = "upload failed, retrying: {0} #{1} ({2})\n"
+                eprint(t.format(file.name, cid[:8], ex))
                 # handshake will fix it
 
             with self.mutex:
                 sz = file.kchunks[cid][1]
                 file.ucids = [x for x in file.ucids if x != cid]
                 if not file.ucids:
                     self.q_handshake.put(file)
@@ -1045,14 +1078,16 @@
     hcores = min(cores, 3)  # 4% faster than 4+ on py3.9 @ r5-4500U
 
     ver = "{0}, v{1}".format(S_BUILD_DT, S_VERSION)
     if "--version" in sys.argv:
         print(ver)
         return
 
+    sys.argv = [x for x in sys.argv if x != "--ws"]
+
     # fmt: off
     ap = app = argparse.ArgumentParser(formatter_class=APF, description="copyparty up2k uploader / filesearch tool, " + ver, epilog="""
 NOTE:
 source file/folder selection uses rsync syntax, meaning that:
   "foo" uploads the entire folder to URL/foo/
   "foo/" uploads the CONTENTS of the folder into URL/
 """)
@@ -1063,15 +1098,15 @@
     ap.add_argument("-a", metavar="PASSWORD", help="password or $filepath")
     ap.add_argument("-s", action="store_true", help="file-search (disables upload)")
     ap.add_argument("--ok", action="store_true", help="continue even if some local files are inaccessible")
     ap.add_argument("--version", action="store_true", help="show version and exit")
 
     ap = app.add_argument_group("compatibility")
     ap.add_argument("--cls", action="store_true", help="clear screen before start")
-    ap.add_argument("--ws", action="store_true", help="copyparty is running on windows; wait before deleting files after uploading")
+    ap.add_argument("--rh", type=int, metavar="TRIES", default=0, help="resolve server hostname before upload (good for buggy networks, but TLS certs will break)")
 
     ap = app.add_argument_group("folder sync")
     ap.add_argument("--dl", action="store_true", help="delete local files after uploading")
     ap.add_argument("--dr", action="store_true", help="delete remote files which don't exist locally")
     ap.add_argument("--drd", action="store_true", help="delete remote files during upload instead of afterwards; reduces peak disk space usage, but will reupload instead of detecting renames")
 
     ap = app.add_argument_group("performance tweaks")
@@ -1087,15 +1122,15 @@
     ap.add_argument("-td", action="store_true", help="disable certificate check")
     # fmt: on
 
     try:
         ar = app.parse_args()
     finally:
         if EXE and not sys.argv[1:]:
-            print("*** hit enter to exit ***")
+            eprint("*** hit enter to exit ***")
             try:
                 input()
             except:
                 pass
 
     if ar.drd:
         ar.dr = True
@@ -1120,25 +1155,33 @@
 
     if ar.a and ar.a.startswith("$"):
         fn = ar.a[1:]
         print("reading password from file [{0}]".format(fn))
         with open(fn, "rb") as f:
             ar.a = f.read().decode("utf-8").strip()
 
+    for n in range(ar.rh):
+        try:
+            ar.url = undns(ar.url)
+            break
+        except KeyboardInterrupt:
+            raise
+        except:
+            if n > ar.rh - 2:
+                raise
+
     if ar.cls:
-        print("\x1b\x5b\x48\x1b\x5b\x32\x4a\x1b\x5b\x33\x4a", end="")
+        eprint("\x1b\x5b\x48\x1b\x5b\x32\x4a\x1b\x5b\x33\x4a", end="")
 
     ctl = Ctl(ar)
 
-    if ar.dr and not ar.drd:
+    if ar.dr and not ar.drd and ctl.ok:
         print("\npass 2/2: delete")
-        if getattr(ctl, "up_br") and ar.ws:
-            # wait for up2k to mtime if there was uploads
-            time.sleep(4)
-
         ar.drd = True
         ar.z = True
-        Ctl(ar, ctl.stats)
+        ctl = Ctl(ar, ctl.stats)
+
+    sys.exit(0 if ctl.ok else 1)
 
 
 if __name__ == "__main__":
     main()
```

### Comparing `copyparty-1.6.9/copyparty/web/a/webdav-cfg.bat` & `copyparty-1.7.0/copyparty/web/a/webdav-cfg.bat`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/browser.html` & `copyparty-1.7.0/copyparty/web/browser.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/browser2.html` & `copyparty-1.7.0/copyparty/web/browser2.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/cf.html` & `copyparty-1.7.0/copyparty/web/cf.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/dbg-audio.js.gz` & `copyparty-1.7.0/copyparty/web/dbg-audio.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/easymde.css.gz` & `copyparty-1.7.0/copyparty/web/deps/easymde.css.gz`

 * *Files 5% similar despite different names*

#### filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "easymde.css", last modified: Tue Dec 20 10:12:25 2022, max compression, from Unix
+gzip compressed data, was "easymde.css", last modified: Mon Feb 20 10:55:39 2023, max compression, from Unix
```

### Comparing `copyparty-1.6.9/copyparty/web/deps/easymde.js.gz` & `copyparty-1.7.0/copyparty/web/deps/easymde.js.gz`

 * *Files 21% similar despite different names*

#### filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "easymde.js", last modified: Thu Dec 29 03:38:30 2022, max compression, from Unix
+gzip compressed data, was "easymde.js", last modified: Sat Apr  1 14:48:07 2023, max compression, from Unix
```

#### easymde.js

##### js-beautify {}

```diff
@@ -6675,15 +6675,15 @@
                         var l = va((function(t) {
                             return e.parentNode.insertBefore(t, e.nextSibling)
                         }), t);
                         return l
                     },
                     function(e) {
                         e.off = de, e.on = ue, e.wheelEventPixels = dr, e.Doc = Co, e.splitLines = Le, e.countColumn = j, e.findColumn = K, e.isWordChar = ne, e.Pass = q, e.signal = he, e.Line = _t, e.changeEnd = vr, e.scrollbarModel = Ni, e.Pos = Ye, e.cmpPos = Ze, e.modes = Ee, e.mimeModes = Oe, e.resolveMode = He, e.getMode = Ie, e.modeExtensions = We, e.extendMode = Be, e.copyState = Pe, e.startState = Re, e.innerMode = ze, e.commands = Go, e.keyMap = Ho, e.keyName = Ro, e.isModifierKey = Po, e.lookupKey = Bo, e.normalizeKeyMap = Wo, e.StringStream = je, e.SharedTextMarker = yo, e.TextMarker = mo, e.LineWidget = fo, e.e_preventDefault = ve, e.e_stopPropagation = ye, e.e_stop = xe, e.addClass = H, e.contains = O, e.rmClass = L, e.keyNames = Fo
-                    }(va), va.version = "5.65.11", va
+                    }(va), va.version = "5.65.12", va
             }))
         }, {}],
         9: [function(e, t, n) {
             var i;
             i = function(e) {
                 "use strict";
                 e.defineMode("gfm", (function(t, n) {
```

### Comparing `copyparty-1.6.9/copyparty/web/deps/mini-fa.woff` & `copyparty-1.7.0/copyparty/web/deps/mini-fa.woff`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/prism.css.gz` & `copyparty-1.7.0/copyparty/web/deps/prism.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/prism.js.gz` & `copyparty-1.7.0/copyparty/web/deps/prism.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/prismd.css.gz` & `copyparty-1.7.0/copyparty/web/deps/prismd.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/scp.woff2` & `copyparty-1.7.0/copyparty/web/deps/scp.woff2`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/deps/sha512.ac.js.gz` & `copyparty-1.7.0/copyparty/web/deps/sha512.ac.js.gz`

 * *Files 1% similar despite different names*

#### filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sha512.ac.js", last modified: Thu Dec 29 03:37:01 2022, max compression, from Unix
+gzip compressed data, was "sha512.ac.js", last modified: Sat Apr  1 14:23:12 2023, max compression, from Unix
```

### Comparing `copyparty-1.6.9/copyparty/web/deps/sha512.hw.js.gz` & `copyparty-1.7.0/copyparty/web/deps/sha512.hw.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/md.css.gz` & `copyparty-1.7.0/copyparty/web/md.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/md.html` & `copyparty-1.7.0/copyparty/web/md.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/md2.css.gz` & `copyparty-1.7.0/copyparty/web/md2.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/md2.js.gz` & `copyparty-1.7.0/copyparty/web/md2.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/mde.css.gz` & `copyparty-1.7.0/copyparty/web/mde.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/mde.html` & `copyparty-1.7.0/copyparty/web/mde.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/mde.js.gz` & `copyparty-1.7.0/copyparty/web/mde.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/msg.html` & `copyparty-1.7.0/copyparty/web/msg.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/splash.css.gz` & `copyparty-1.7.0/copyparty/web/splash.css.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/splash.html` & `copyparty-1.7.0/copyparty/web/splash.html`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/splash.js.gz` & `copyparty-1.7.0/copyparty/web/splash.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/svcs.html` & `copyparty-1.7.0/copyparty/web/svcs.html`

 * *Files 5% similar despite different names*

```diff
@@ -39,18 +39,17 @@
 
 
 
         {% if not args.no_dav %}
         <h1>WebDAV</h1>
 
         <div class="os win">
-            <p><em>note: rclone-FTP is a bit faster, so {% if args.ftp or args.ftps %}try that first{% else %}consider enabling FTP in server settings{% endif %}</em></p>
             <p>if you can, install <a href="https://winfsp.dev/rel/">winfsp</a>+<a href="https://downloads.rclone.org/rclone-current-windows-amd64.zip">rclone</a> and then paste this in cmd:</p>
             <pre>
-                rclone config create {{ aname }}-dav webdav url=http{{ s }}://{{ rip }}{{ hport }} vendor=other{% if accs %} user=k pass=<b>{{ pw }}</b>{% endif %}
+                rclone config create {{ aname }}-dav webdav url=http{{ s }}://{{ rip }}{{ hport }} vendor=owncloud pacer_min_sleep=0.01ms{% if accs %} user=k pass=<b>{{ pw }}</b>{% endif %}
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-dav:{{ rvp }} <b>W:</b>
             </pre>
             {% if s %}
             <p><em>note: if you are on LAN (or just dont have valid certificates), add <code>--no-check-certificate</code> to the mount command</em><br />---</p>
             {% endif %}
             
             <p>if you want to use the native WebDAV client in windows instead (slow and buggy), first run <a href="{{ r }}/.cpr/a/webdav-cfg.bat">webdav-cfg.bat</a> to remove the 47 MiB filesize limit (also fixes latency and password login), then connect:</p>
@@ -65,17 +64,17 @@
                 {% if accs %}printf '%s\n' <b>{{ pw }}</b> k | {% endif %}mount -t davfs -ouid=1000 http{{ s }}://{{ ep }}/{{ rvp }} <b>mp</b>
             </pre>
             <p>make it automount on boot:</p>
             <pre>
                 printf '%s\n' "http{{ s }}://{{ ep }}/{{ rvp }} <b>{{ pw }}</b> k" >> /etc/davfs2/secrets
                 printf '%s\n' "http{{ s }}://{{ ep }}/{{ rvp }} <b>mp</b> davfs rw,user,uid=1000,noauto 0 0" >> /etc/fstab
             </pre>
-            <p>or you can use rclone instead, which is much slower but doesn't require root:</p>
+            <p>or you can use rclone instead, which is much slower but doesn't require root (plus it keeps lastmodified on upload):</p>
             <pre>
-                rclone config create {{ aname }}-dav webdav url=http{{ s }}://{{ rip }}{{ hport }} vendor=other{% if accs %} user=k pass=<b>{{ pw }}</b>{% endif %}
+                rclone config create {{ aname }}-dav webdav url=http{{ s }}://{{ rip }}{{ hport }} vendor=owncloud pacer_min_sleep=0.01ms{% if accs %} user=k pass=<b>{{ pw }}</b>{% endif %}
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-dav:{{ rvp }} <b>mp</b>
             </pre>
             {% if s %}
             <p><em>note: if you are on LAN (or just dont have valid certificates), add <code>--no-check-certificate</code> to the mount command</em><br />---</p>
             {% endif %}
             
             <p>or the emergency alternative (gnome/gui-only):</p>
@@ -107,29 +106,51 @@
 
 
         {% if args.ftp or args.ftps %}
         <h1>FTP</h1>
 
         <div class="os win">
             <p>if you can, install <a href="https://winfsp.dev/rel/">winfsp</a>+<a href="https://downloads.rclone.org/rclone-current-windows-amd64.zip">rclone</a> and then paste this in cmd:</p>
+            {% if args.ftp %}
+            <p>connect with plaintext FTP:</p>
             <pre>
-                rclone config create {{ aname }}-ftp ftp host={{ rip }} port={{ args.ftp or args.ftps }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls={{ "false" if args.ftp else "true" }}
+                rclone config create {{ aname }}-ftp ftp host={{ rip }} port={{ args.ftp }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls=false
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-ftp:{{ rvp }} <b>W:</b>
             </pre>
+            {% endif %}
+            {% if args.ftps %}
+            <p>connect with TLS-encrypted FTPS:</p>
+            <pre>
+                rclone config create {{ aname }}-ftps ftp host={{ rip }} port={{ args.ftps }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls=false explicit_tls=true
+                rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-ftps:{{ rvp }} <b>W:</b>
+            </pre>
+            <p><em>note: if you are on LAN (or just dont have valid certificates), add <code>no_check_certificate=true</code> to the config command</em><br />---</p>
+            {% endif %}
             <p>if you want to use the native FTP client in windows instead (please dont), press <code>win+R</code> and run this command:</p>
             <pre>
                 explorer {{ "ftp" if args.ftp else "ftps" }}://{% if accs %}<b>{{ pw }}</b>:k@{% endif %}{{ host }}:{{ args.ftp or args.ftps }}/{{ rvp }}
             </pre>
         </div>
 
         <div class="os lin">
+            {% if args.ftp %}
+            <p>connect with plaintext FTP:</p>
             <pre>
-                rclone config create {{ aname }}-ftp ftp host={{ rip }} port={{ args.ftp or args.ftps }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls={{ "false" if args.ftp else "true" }}
+                rclone config create {{ aname }}-ftp ftp host={{ rip }} port={{ args.ftp }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls=false
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-ftp:{{ rvp }} <b>mp</b>
             </pre>
+            {% endif %}
+            {% if args.ftps %}
+            <p>connect with TLS-encrypted FTPS:</p>
+            <pre>
+                rclone config create {{ aname }}-ftps ftp host={{ rip }} port={{ args.ftps }} pass=k user={% if accs %}<b>{{ pw }}</b>{% else %}anonymous{% endif %} tls=false explicit_tls=true
+                rclone mount --vfs-cache-mode writes --dir-cache-time 5s {{ aname }}-ftps:{{ rvp }} <b>mp</b>
+            </pre>
+            <p><em>note: if you are on LAN (or just dont have valid certificates), add <code>no_check_certificate=true</code> to the config command</em><br />---</p>
+            {% endif %}
             <p>emergency alternative (gnome/gui-only):</p>
             <!-- gnome-bug: ignores vp -->
             <pre>
                 {%- if accs %}
                 echo <b>{{ pw }}</b> | gio mount ftp{{ "" if args.ftp else "s" }}://k@{{ host }}:{{ args.ftp or args.ftps }}/{{ rvp }}
                 {%- else %}
                 gio mount -a ftp{{ "" if args.ftp else "s" }}://{{ host }}:{{ args.ftp or args.ftps }}/{{ rvp }}
```

#### html2text {}

```diff
@@ -8,19 +8,18 @@
 make this server appear on your computer as a regular HDD!
 pick your favorite below (sorted by performance, best first) and lets 
 
 placeholders:  {% if accs %}{{ pw }}=password, {% endif %}W:=mountpoint   {% if
 accs %}{{ pw }}=password, {% endif %}mp=mountpoint
 {% if not args.no_dav %}
 ****** WebDAV ******
-note: rclone-FTP is a bit faster, so {% if args.ftp or args.ftps %}try that
-first{% else %}consider enabling FTP in server settings{% endif %}
 if you can, install winfsp+rclone and then paste this in cmd:
                 rclone config create {{ aname }}-dav webdav url=http{{ s }}://{
-{ rip }}{{ hport }} vendor=other{% if accs %} user=k pass={{ pw }}{% endif %}
+{ rip }}{{ hport }} vendor=owncloud pacer_min_sleep=0.01ms{% if accs %} user=k
+pass={{ pw }}{% endif %}
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
 { aname }}-dav:{{ rvp }} W:
 {% if s %}
 note: if you are on LAN (or just dont have valid certificates), add --no-check-
 certificate to the mount command
 ---
 {% endif %}
@@ -33,17 +32,19 @@
                 {% if accs %}printf '%s\n' {{ pw }} k | {% endif %}mount -
 t davfs -ouid=1000 http{{ s }}://{{ ep }}/{{ rvp }} mp
 make it automount on boot:
                 printf '%s\n' "http{{ s }}://{{ ep }}/{{ rvp }} {{ pw }} k" >>
 /etc/davfs2/secrets
                 printf '%s\n' "http{{ s }}://{{ ep }}/{{ rvp }} mp davfs
 rw,user,uid=1000,noauto 0 0" >> /etc/fstab
-or you can use rclone instead, which is much slower but doesn't require root:
+or you can use rclone instead, which is much slower but doesn't require root
+(plus it keeps lastmodified on upload):
                 rclone config create {{ aname }}-dav webdav url=http{{ s }}://{
-{ rip }}{{ hport }} vendor=other{% if accs %} user=k pass={{ pw }}{% endif %}
+{ rip }}{{ hport }} vendor=owncloud pacer_min_sleep=0.01ms{% if accs %} user=k
+pass={{ pw }}{% endif %}
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
 { aname }}-dav:{{ rvp }} mp
 {% if s %}
 note: if you are on LAN (or just dont have valid certificates), add --no-check-
 certificate to the mount command
 ---
 {% endif %}
@@ -59,28 +60,54 @@
                 http{{ s }}://k:{{ pw }}@{{ ep }}/{{ rvp }}
 {% if s %}
 replace https with http if it doesn't work
 {% endif %}
 {% endif %} {% if args.ftp or args.ftps %}
 ****** FTP ******
 if you can, install winfsp+rclone and then paste this in cmd:
+{% if args.ftp %}
+connect with plaintext FTP:
                 rclone config create {{ aname }}-ftp ftp host={{ rip }} port={
-{ args.ftp or args.ftps }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous
-{% endif %} tls={{ "false" if args.ftp else "true" }}
+{ args.ftp }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous{% endif %}
+tls=false
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
 { aname }}-ftp:{{ rvp }} W:
+{% endif %} {% if args.ftps %}
+connect with TLS-encrypted FTPS:
+                rclone config create {{ aname }}-ftps ftp host={{ rip }} port={
+{ args.ftps }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous{% endif %}
+tls=false explicit_tls=true
+                rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
+{ aname }}-ftps:{{ rvp }} W:
+note: if you are on LAN (or just dont have valid certificates), add
+no_check_certificate=true to the config command
+---
+{% endif %}
 if you want to use the native FTP client in windows instead (please dont),
 press win+R and run this command:
                 explorer {{ "ftp" if args.ftp else "ftps" }}://{% if accs %}{
 { pw }}:k@{% endif %}{{ host }}:{{ args.ftp or args.ftps }}/{{ rvp }}
+{% if args.ftp %}
+connect with plaintext FTP:
                 rclone config create {{ aname }}-ftp ftp host={{ rip }} port={
-{ args.ftp or args.ftps }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous
-{% endif %} tls={{ "false" if args.ftp else "true" }}
+{ args.ftp }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous{% endif %}
+tls=false
                 rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
 { aname }}-ftp:{{ rvp }} mp
+{% endif %} {% if args.ftps %}
+connect with TLS-encrypted FTPS:
+                rclone config create {{ aname }}-ftps ftp host={{ rip }} port={
+{ args.ftps }} pass=k user={% if accs %}{{ pw }}{% else %}anonymous{% endif %}
+tls=false explicit_tls=true
+                rclone mount --vfs-cache-mode writes --dir-cache-time 5s {
+{ aname }}-ftps:{{ rvp }} mp
+note: if you are on LAN (or just dont have valid certificates), add
+no_check_certificate=true to the config command
+---
+{% endif %}
 emergency alternative (gnome/gui-only):
                 {%- if accs %}
                 echo {{ pw }} | gio mount ftp{{ "" if args.ftp else "s" }}://k@
 {{ host }}:{{ args.ftp or args.ftps }}/{{ rvp }}
                 {%- else %}
                 gio mount -a ftp{{ "" if args.ftp else "s" }}://{{ host }}:{
 { args.ftp or args.ftps }}/{{ rvp }}
```

### Comparing `copyparty-1.6.9/copyparty/web/svcs.js.gz` & `copyparty-1.7.0/copyparty/web/svcs.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/up2k.js.gz` & `copyparty-1.7.0/copyparty/web/up2k.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty/web/w.hash.js.gz` & `copyparty-1.7.0/copyparty/web/w.hash.js.gz`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/copyparty.egg-info/PKG-INFO` & `copyparty-1.7.0/README.md`

 * *Files 10% similar despite different names*

```diff
@@ -1,5169 +1,5795 @@
-00000000: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
-00000010: 3a20 322e 310a 4e61 6d65 3a20 636f 7079  : 2.1.Name: copy
-00000020: 7061 7274 790a 5665 7273 696f 6e3a 2031  party.Version: 1
-00000030: 2e36 2e39 0a53 756d 6d61 7279 3a20 506f  .6.9.Summary: Po
-00000040: 7274 6162 6c65 2066 696c 6520 7365 7276  rtable file serv
-00000050: 6572 2077 6974 6820 6163 6365 6c65 7261  er with accelera
-00000060: 7465 6420 7265 7375 6d61 626c 6520 7570  ted resumable up
-00000070: 6c6f 6164 732c 2064 6564 7570 6c69 6361  loads, deduplica
-00000080: 7469 6f6e 2c20 5765 6244 4156 2c20 4654  tion, WebDAV, FT
-00000090: 502c 207a 6572 6f63 6f6e 662c 206d 6564  P, zeroconf, med
-000000a0: 6961 2069 6e64 6578 6572 2c20 7669 6465  ia indexer, vide
-000000b0: 6f20 7468 756d 626e 6169 6c73 2c20 6175  o thumbnails, au
-000000c0: 6469 6f20 7472 616e 7363 6f64 696e 672c  dio transcoding,
-000000d0: 2061 6e64 2077 7269 7465 2d6f 6e6c 7920   and write-only 
-000000e0: 666f 6c64 6572 730a 486f 6d65 2d70 6167  folders.Home-pag
-000000f0: 653a 2068 7474 7073 3a2f 2f67 6974 6875  e: https://githu
-00000100: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00000110: 6172 7479 0a41 7574 686f 723a 2065 640a  arty.Author: ed.
-00000120: 4175 7468 6f72 2d65 6d61 696c 3a20 636f  Author-email: co
-00000130: 7079 7061 7274 7940 6f63 762e 6d65 0a4c  pyparty@ocv.me.L
-00000140: 6963 656e 7365 3a20 4d49 540a 436c 6173  icense: MIT.Clas
-00000150: 7369 6669 6572 3a20 4465 7665 6c6f 706d  sifier: Developm
-00000160: 656e 7420 5374 6174 7573 203a 3a20 3520  ent Status :: 5 
-00000170: 2d20 5072 6f64 7563 7469 6f6e 2f53 7461  - Production/Sta
-00000180: 626c 650a 436c 6173 7369 6669 6572 3a20  ble.Classifier: 
-00000190: 4c69 6365 6e73 6520 3a3a 204f 5349 2041  License :: OSI A
-000001a0: 7070 726f 7665 6420 3a3a 204d 4954 204c  pproved :: MIT L
-000001b0: 6963 656e 7365 0a43 6c61 7373 6966 6965  icense.Classifie
-000001c0: 723a 2050 726f 6772 616d 6d69 6e67 204c  r: Programming L
-000001d0: 616e 6775 6167 6520 3a3a 2050 7974 686f  anguage :: Pytho
-000001e0: 6e0a 436c 6173 7369 6669 6572 3a20 5072  n.Classifier: Pr
-000001f0: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
-00000200: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
-00000210: 330a 436c 6173 7369 6669 6572 3a20 5072  3.Classifier: Pr
-00000220: 6f67 7261 6d6d 696e 6720 4c61 6e67 7561  ogramming Langua
-00000230: 6765 203a 3a20 5079 7468 6f6e 203a 3a20  ge :: Python :: 
-00000240: 332e 330a 436c 6173 7369 6669 6572 3a20  3.3.Classifier: 
-00000250: 5072 6f67 7261 6d6d 696e 6720 4c61 6e67  Programming Lang
-00000260: 7561 6765 203a 3a20 5079 7468 6f6e 203a  uage :: Python :
-00000270: 3a20 332e 340a 436c 6173 7369 6669 6572  : 3.4.Classifier
-00000280: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
-00000290: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
-000002a0: 203a 3a20 332e 350a 436c 6173 7369 6669   :: 3.5.Classifi
-000002b0: 6572 3a20 5072 6f67 7261 6d6d 696e 6720  er: Programming 
-000002c0: 4c61 6e67 7561 6765 203a 3a20 5079 7468  Language :: Pyth
-000002d0: 6f6e 203a 3a20 332e 360a 436c 6173 7369  on :: 3.6.Classi
-000002e0: 6669 6572 3a20 5072 6f67 7261 6d6d 696e  fier: Programmin
-000002f0: 6720 4c61 6e67 7561 6765 203a 3a20 5079  g Language :: Py
-00000300: 7468 6f6e 203a 3a20 332e 370a 436c 6173  thon :: 3.7.Clas
-00000310: 7369 6669 6572 3a20 5072 6f67 7261 6d6d  sifier: Programm
-00000320: 696e 6720 4c61 6e67 7561 6765 203a 3a20  ing Language :: 
-00000330: 5079 7468 6f6e 203a 3a20 332e 380a 436c  Python :: 3.8.Cl
-00000340: 6173 7369 6669 6572 3a20 5072 6f67 7261  assifier: Progra
-00000350: 6d6d 696e 6720 4c61 6e67 7561 6765 203a  mming Language :
-00000360: 3a20 5079 7468 6f6e 203a 3a20 332e 390a  : Python :: 3.9.
-00000370: 436c 6173 7369 6669 6572 3a20 5072 6f67  Classifier: Prog
-00000380: 7261 6d6d 696e 6720 4c61 6e67 7561 6765  ramming Language
-00000390: 203a 3a20 5079 7468 6f6e 203a 3a20 332e   :: Python :: 3.
-000003a0: 3130 0a43 6c61 7373 6966 6965 723a 2050  10.Classifier: P
-000003b0: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-000003c0: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-000003d0: 2033 2e31 310a 436c 6173 7369 6669 6572   3.11.Classifier
-000003e0: 3a20 5072 6f67 7261 6d6d 696e 6720 4c61  : Programming La
-000003f0: 6e67 7561 6765 203a 3a20 5079 7468 6f6e  nguage :: Python
-00000400: 203a 3a20 332e 3132 0a43 6c61 7373 6966   :: 3.12.Classif
-00000410: 6965 723a 2050 726f 6772 616d 6d69 6e67  ier: Programming
-00000420: 204c 616e 6775 6167 6520 3a3a 2050 7974   Language :: Pyt
-00000430: 686f 6e20 3a3a 2049 6d70 6c65 6d65 6e74  hon :: Implement
-00000440: 6174 696f 6e20 3a3a 2043 5079 7468 6f6e  ation :: CPython
-00000450: 0a43 6c61 7373 6966 6965 723a 2050 726f  .Classifier: Pro
-00000460: 6772 616d 6d69 6e67 204c 616e 6775 6167  gramming Languag
-00000470: 6520 3a3a 2050 7974 686f 6e20 3a3a 2049  e :: Python :: I
-00000480: 6d70 6c65 6d65 6e74 6174 696f 6e20 3a3a  mplementation ::
-00000490: 204a 7974 686f 6e0a 436c 6173 7369 6669   Jython.Classifi
-000004a0: 6572 3a20 5072 6f67 7261 6d6d 696e 6720  er: Programming 
-000004b0: 4c61 6e67 7561 6765 203a 3a20 5079 7468  Language :: Pyth
-000004c0: 6f6e 203a 3a20 496d 706c 656d 656e 7461  on :: Implementa
-000004d0: 7469 6f6e 203a 3a20 5079 5079 0a43 6c61  tion :: PyPy.Cla
-000004e0: 7373 6966 6965 723a 2045 6e76 6972 6f6e  ssifier: Environ
-000004f0: 6d65 6e74 203a 3a20 436f 6e73 6f6c 650a  ment :: Console.
-00000500: 436c 6173 7369 6669 6572 3a20 456e 7669  Classifier: Envi
-00000510: 726f 6e6d 656e 7420 3a3a 204e 6f20 496e  ronment :: No In
-00000520: 7075 742f 4f75 7470 7574 2028 4461 656d  put/Output (Daem
-00000530: 6f6e 290a 436c 6173 7369 6669 6572 3a20  on).Classifier: 
-00000540: 496e 7465 6e64 6564 2041 7564 6965 6e63  Intended Audienc
-00000550: 6520 3a3a 2045 6e64 2055 7365 7273 2f44  e :: End Users/D
-00000560: 6573 6b74 6f70 0a43 6c61 7373 6966 6965  esktop.Classifie
-00000570: 723a 2049 6e74 656e 6465 6420 4175 6469  r: Intended Audi
-00000580: 656e 6365 203a 3a20 5379 7374 656d 2041  ence :: System A
-00000590: 646d 696e 6973 7472 6174 6f72 730a 436c  dministrators.Cl
-000005a0: 6173 7369 6669 6572 3a20 546f 7069 6320  assifier: Topic 
-000005b0: 3a3a 2043 6f6d 6d75 6e69 6361 7469 6f6e  :: Communication
-000005c0: 7320 3a3a 2046 696c 6520 5368 6172 696e  s :: File Sharin
-000005d0: 670a 436c 6173 7369 6669 6572 3a20 546f  g.Classifier: To
-000005e0: 7069 6320 3a3a 2049 6e74 6572 6e65 7420  pic :: Internet 
-000005f0: 3a3a 2046 696c 6520 5472 616e 7366 6572  :: File Transfer
-00000600: 2050 726f 746f 636f 6c20 2846 5450 290a   Protocol (FTP).
-00000610: 436c 6173 7369 6669 6572 3a20 546f 7069  Classifier: Topi
-00000620: 6320 3a3a 2049 6e74 6572 6e65 7420 3a3a  c :: Internet ::
-00000630: 2057 5757 2f48 5454 5020 3a3a 2048 5454   WWW/HTTP :: HTT
-00000640: 5020 5365 7276 6572 730a 4465 7363 7269  P Servers.Descri
-00000650: 7074 696f 6e2d 436f 6e74 656e 742d 5479  ption-Content-Ty
-00000660: 7065 3a20 7465 7874 2f6d 6172 6b64 6f77  pe: text/markdow
-00000670: 6e0a 5072 6f76 6964 6573 2d45 7874 7261  n.Provides-Extra
-00000680: 3a20 7468 756d 626e 6169 6c73 0a50 726f  : thumbnails.Pro
-00000690: 7669 6465 732d 4578 7472 613a 2074 6875  vides-Extra: thu
-000006a0: 6d62 6e61 696c 7332 0a50 726f 7669 6465  mbnails2.Provide
-000006b0: 732d 4578 7472 613a 2061 7564 696f 7461  s-Extra: audiota
-000006c0: 6773 0a50 726f 7669 6465 732d 4578 7472  gs.Provides-Extr
-000006d0: 613a 2066 7470 640a 5072 6f76 6964 6573  a: ftpd.Provides
-000006e0: 2d45 7874 7261 3a20 6674 7073 0a4c 6963  -Extra: ftps.Lic
-000006f0: 656e 7365 2d46 696c 653a 204c 4943 454e  ense-File: LICEN
-00000700: 5345 0a0a 2320 f09f 92be f09f 8e89 2063  SE..# ........ c
-00000710: 6f70 7970 6172 7479 0a0a 2a20 706f 7274  opyparty..* port
-00000720: 6162 6c65 2066 696c 6520 7368 6172 696e  able file sharin
-00000730: 6720 6875 6220 2870 7932 2f70 7933 2920  g hub (py2/py3) 
-00000740: 5b28 6f6e 2050 7950 4929 5d28 6874 7470  [(on PyPI)](http
-00000750: 733a 2f2f 7079 7069 2e6f 7267 2f70 726f  s://pypi.org/pro
-00000760: 6a65 6374 2f63 6f70 7970 6172 7479 2f29  ject/copyparty/)
-00000770: 0a2a 204d 4954 2d4c 6963 656e 7365 642c  .* MIT-Licensed,
-00000780: 2032 3031 392d 3035 2d32 362c 2065 6420   2019-05-26, ed 
-00000790: 4020 6972 632e 7269 7a6f 6e2e 6e65 740a  @ irc.rizon.net.
-000007a0: 0a0a 2323 2073 756d 6d61 7279 0a0a 7475  ..## summary..tu
-000007b0: 726e 2079 6f75 7220 7068 6f6e 6520 6f72  rn your phone or
-000007c0: 2072 6173 7069 2069 6e74 6f20 6120 706f   raspi into a po
-000007d0: 7274 6162 6c65 2066 696c 6520 7365 7276  rtable file serv
-000007e0: 6572 2077 6974 6820 7265 7375 6d61 626c  er with resumabl
-000007f0: 6520 7570 6c6f 6164 732f 646f 776e 6c6f  e uploads/downlo
-00000800: 6164 7320 7573 696e 6720 2a61 6e79 2a20  ads using *any* 
-00000810: 7765 6220 6272 6f77 7365 720a 0a2a 2073  web browser..* s
-00000820: 6572 7665 7220 6f6e 6c79 206e 6565 6473  erver only needs
-00000830: 2050 7974 686f 6e20 2860 322e 3760 206f   Python (`2.7` o
-00000840: 7220 6033 2e33 2b60 292c 2061 6c6c 2064  r `3.3+`), all d
-00000850: 6570 656e 6465 6e63 6965 7320 6f70 7469  ependencies opti
-00000860: 6f6e 616c 0a2a 2062 726f 7773 652f 7570  onal.* browse/up
-00000870: 6c6f 6164 2077 6974 6820 5b49 4534 5d28  load with [IE4](
-00000880: 2362 726f 7773 6572 2d73 7570 706f 7274  #browser-support
-00000890: 2920 2f20 6e65 7473 6361 7065 342e 3020  ) / netscape4.0 
-000008a0: 6f6e 2077 696e 332e 3131 2028 6865 6829  on win3.11 (heh)
-000008b0: 0a2a 2070 726f 746f 636f 6c73 3a20 5b68  .* protocols: [h
-000008c0: 7474 705d 2823 7468 652d 6272 6f77 7365  ttp](#the-browse
-000008d0: 7229 202f 2f20 5b66 7470 5d28 2366 7470  r) // [ftp](#ftp
-000008e0: 2d73 6572 7665 7229 202f 2f20 5b77 6562  -server) // [web
-000008f0: 6461 765d 2823 7765 6264 6176 2d73 6572  dav](#webdav-ser
-00000900: 7665 7229 202f 2f20 5b73 6d62 2f63 6966  ver) // [smb/cif
-00000910: 735d 2823 736d 622d 7365 7276 6572 290a  s](#smb-server).
-00000920: 0a2a 2a5b 4765 7420 7374 6172 7465 645d  .**[Get started]
-00000930: 2823 7175 6963 6b73 7461 7274 2921 2a2a  (#quickstart)!**
-00000940: 206f 7220 7669 7369 7420 7468 6520 2a2a   or visit the **
-00000950: 5b72 6561 642d 6f6e 6c79 2064 656d 6f20  [read-only demo 
-00000960: 7365 7276 6572 5d28 6874 7470 733a 2f2f  server](https://
-00000970: 612e 6f63 762e 6d65 2f70 7562 2f64 656d  a.ocv.me/pub/dem
-00000980: 6f2f 292a 2a20 f09f 9180 2072 756e 6e69  o/)** .... runni
-00000990: 6e67 2066 726f 6d20 6120 6261 7365 6d65  ng from a baseme
-000009a0: 6e74 2069 6e20 6669 6e6c 616e 640a 0af0  nt in finland...
-000009b0: 9f93 b720 2a2a 7363 7265 656e 7368 6f74  ... **screenshot
-000009c0: 733a 2a2a 205b 6272 6f77 7365 725d 2823  s:** [browser](#
-000009d0: 7468 652d 6272 6f77 7365 7229 202f 2f20  the-browser) // 
-000009e0: 5b75 706c 6f61 645d 2823 7570 6c6f 6164  [upload](#upload
-000009f0: 696e 6729 202f 2f20 5b75 6e70 6f73 745d  ing) // [unpost]
-00000a00: 2823 756e 706f 7374 2920 2f2f 205b 7468  (#unpost) // [th
-00000a10: 756d 626e 6169 6c73 5d28 2374 6875 6d62  umbnails](#thumb
-00000a20: 6e61 696c 7329 202f 2f20 5b73 6561 7263  nails) // [searc
-00000a30: 685d 2823 7365 6172 6368 696e 6729 202f  h](#searching) /
-00000a40: 2f20 5b66 7365 6172 6368 5d28 2366 696c  / [fsearch](#fil
-00000a50: 652d 7365 6172 6368 2920 2f2f 205b 7a69  e-search) // [zi
-00000a60: 702d 444c 5d28 237a 6970 2d64 6f77 6e6c  p-DL](#zip-downl
-00000a70: 6f61 6473 2920 2f2f 205b 6d64 2d76 6965  oads) // [md-vie
-00000a80: 7765 725d 2823 6d61 726b 646f 776e 2d76  wer](#markdown-v
-00000a90: 6965 7765 7229 0a0a 0a23 2320 6765 7420  iewer)...## get 
-00000aa0: 7468 6520 6170 700a 0a3c 6120 6872 6566  the app..<a href
-00000ab0: 3d22 6874 7470 733a 2f2f 662d 6472 6f69  ="https://f-droi
-00000ac0: 642e 6f72 672f 7061 636b 6167 6573 2f6d  d.org/packages/m
-00000ad0: 652e 6f63 762e 7061 7274 7975 702f 223e  e.ocv.partyup/">
-00000ae0: 3c69 6d67 2073 7263 3d22 6874 7470 733a  <img src="https:
-00000af0: 2f2f 6f63 762e 6d65 2f66 6472 6f69 642e  //ocv.me/fdroid.
-00000b00: 706e 6722 2061 6c74 3d22 4765 7420 6974  png" alt="Get it
-00000b10: 206f 6e20 462d 4472 6f69 6422 2068 6569   on F-Droid" hei
-00000b20: 6768 743d 2235 3022 202f 3e20 2727 203c  ght="50" /> '' <
-00000b30: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
-00000b40: 2f69 6d67 2e73 6869 656c 6473 2e69 6f2f  /img.shields.io/
-00000b50: 662d 6472 6f69 642f 762f 6d65 2e6f 6376  f-droid/v/me.ocv
-00000b60: 2e70 6172 7479 7570 2e73 7667 2220 616c  .partyup.svg" al
-00000b70: 743d 2266 2d64 726f 6964 2076 6572 7369  t="f-droid versi
-00000b80: 6f6e 2069 6e66 6f22 202f 3e3c 2f61 3e20  on info" /></a> 
-00000b90: 2727 203c 6120 6872 6566 3d22 6874 7470  '' <a href="http
-00000ba0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
-00000bb0: 3030 312f 7061 7274 792d 7570 223e 3c69  001/party-up"><i
-00000bc0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-00000bd0: 696d 672e 7368 6965 6c64 732e 696f 2f67  img.shields.io/g
-00000be0: 6974 6875 622f 7265 6c65 6173 652f 3930  ithub/release/90
-00000bf0: 3031 2f70 6172 7479 2d75 702e 7376 673f  01/party-up.svg?
-00000c00: 6c6f 676f 3d67 6974 6875 6222 2061 6c74  logo=github" alt
-00000c10: 3d22 6769 7468 7562 2076 6572 7369 6f6e  ="github version
-00000c20: 2069 6e66 6f22 202f 3e3c 2f61 3e0a 0a28   info" /></a>..(
-00000c30: 7468 6520 6170 7020 6973 202a 2a4e 4f54  the app is **NOT
-00000c40: 2a2a 2074 6865 2066 756c 6c20 636f 7079  ** the full copy
-00000c50: 7061 7274 7920 7365 7276 6572 2120 6a75  party server! ju
-00000c60: 7374 2061 2062 6173 6963 2075 706c 6f61  st a basic uploa
-00000c70: 6420 636c 6965 6e74 2c20 6e6f 7468 696e  d client, nothin
-00000c80: 6720 6661 6e63 7920 7965 7429 0a0a 0a23  g fancy yet)...#
-00000c90: 2320 7265 6164 6d65 2074 6f63 0a0a 2a20  # readme toc..* 
-00000ca0: 746f 700a 2020 2020 2a20 5b71 7569 636b  top.    * [quick
-00000cb0: 7374 6172 745d 2823 7175 6963 6b73 7461  start](#quicksta
-00000cc0: 7274 2920 2d20 6a75 7374 2072 756e 202a  rt) - just run *
-00000cd0: 2a5b 636f 7079 7061 7274 792d 7366 782e  *[copyparty-sfx.
-00000ce0: 7079 5d28 6874 7470 733a 2f2f 6769 7468  py](https://gith
-00000cf0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00000d00: 7061 7274 792f 7265 6c65 6173 6573 2f6c  party/releases/l
-00000d10: 6174 6573 742f 646f 776e 6c6f 6164 2f63  atest/download/c
-00000d20: 6f70 7970 6172 7479 2d73 6678 2e70 7929  opyparty-sfx.py)
-00000d30: 2a2a 202d 2d20 7468 6174 2773 2069 7421  ** -- that's it!
-00000d40: 20f0 9f8e 890a 2020 2020 2020 2020 2a20   .....        * 
-00000d50: 5b6f 6e20 7365 7276 6572 735d 2823 6f6e  [on servers](#on
-00000d60: 2d73 6572 7665 7273 2920 2d20 796f 7520  -servers) - you 
-00000d70: 6d61 7920 616c 736f 2077 616e 7420 7468  may also want th
-00000d80: 6573 652c 2065 7370 6563 6961 6c6c 7920  ese, especially 
-00000d90: 6f6e 2073 6572 7665 7273 0a20 2020 202a  on servers.    *
-00000da0: 205b 6665 6174 7572 6573 5d28 2366 6561   [features](#fea
-00000db0: 7475 7265 7329 0a20 2020 202a 205b 7465  tures).    * [te
-00000dc0: 7374 696d 6f6e 6961 6c73 5d28 2374 6573  stimonials](#tes
-00000dd0: 7469 6d6f 6e69 616c 7329 202d 2073 6d61  timonials) - sma
-00000de0: 6c6c 2063 6f6c 6c65 6374 696f 6e20 6f66  ll collection of
-00000df0: 2075 7365 7220 6665 6564 6261 636b 0a2a   user feedback.*
-00000e00: 205b 6d6f 7469 7661 7469 6f6e 735d 2823   [motivations](#
-00000e10: 6d6f 7469 7661 7469 6f6e 7329 202d 2070  motivations) - p
-00000e20: 726f 6a65 6374 2067 6f61 6c73 202f 2070  roject goals / p
-00000e30: 6869 6c6f 736f 7068 790a 2020 2020 2a20  hilosophy.    * 
-00000e40: 5b6e 6f74 6573 5d28 236e 6f74 6573 2920  [notes](#notes) 
-00000e50: 2d20 6765 6e65 7261 6c20 6e6f 7465 730a  - general notes.
-00000e60: 2a20 5b62 7567 735d 2823 6275 6773 290a  * [bugs](#bugs).
-00000e70: 2020 2020 2a20 5b67 656e 6572 616c 2062      * [general b
-00000e80: 7567 735d 2823 6765 6e65 7261 6c2d 6275  ugs](#general-bu
-00000e90: 6773 290a 2020 2020 2a20 5b6e 6f74 206d  gs).    * [not m
-00000ea0: 7920 6275 6773 5d28 236e 6f74 2d6d 792d  y bugs](#not-my-
-00000eb0: 6275 6773 290a 2a20 5b62 7265 616b 696e  bugs).* [breakin
-00000ec0: 6720 6368 616e 6765 735d 2823 6272 6561  g changes](#brea
-00000ed0: 6b69 6e67 2d63 6861 6e67 6573 2920 2d20  king-changes) - 
-00000ee0: 7570 6772 6164 6520 6e6f 7465 730a 2a20  upgrade notes.* 
-00000ef0: 5b46 4151 5d28 2346 4151 2920 2d20 2266  [FAQ](#FAQ) - "f
-00000f00: 7265 7175 656e 746c 7922 2061 736b 6564  requently" asked
-00000f10: 2071 7565 7374 696f 6e73 0a2a 205b 6163   questions.* [ac
-00000f20: 636f 756e 7473 2061 6e64 2076 6f6c 756d  counts and volum
-00000f30: 6573 5d28 2361 6363 6f75 6e74 732d 616e  es](#accounts-an
-00000f40: 642d 766f 6c75 6d65 7329 202d 2070 6572  d-volumes) - per
-00000f50: 2d66 6f6c 6465 722c 2070 6572 2d75 7365  -folder, per-use
-00000f60: 7220 7065 726d 6973 7369 6f6e 730a 2020  r permissions.  
-00000f70: 2020 2a20 5b73 6861 646f 7769 6e67 5d28    * [shadowing](
-00000f80: 2373 6861 646f 7769 6e67 2920 2d20 6869  #shadowing) - hi
-00000f90: 6469 6e67 2073 7065 6369 6669 6320 7375  ding specific su
-00000fa0: 6266 6f6c 6465 7273 0a2a 205b 7468 6520  bfolders.* [the 
-00000fb0: 6272 6f77 7365 725d 2823 7468 652d 6272  browser](#the-br
-00000fc0: 6f77 7365 7229 202d 2061 6363 6573 7369  owser) - accessi
-00000fd0: 6e67 2061 2063 6f70 7970 6172 7479 2073  ng a copyparty s
-00000fe0: 6572 7665 7220 7573 696e 6720 6120 7765  erver using a we
-00000ff0: 622d 6272 6f77 7365 720a 2020 2020 2a20  b-browser.    * 
-00001000: 5b74 6162 735d 2823 7461 6273 2920 2d20  [tabs](#tabs) - 
-00001010: 7468 6520 6d61 696e 2074 6162 7320 696e  the main tabs in
-00001020: 2074 6865 2075 690a 2020 2020 2a20 5b68   the ui.    * [h
-00001030: 6f74 6b65 7973 5d28 2368 6f74 6b65 7973  otkeys](#hotkeys
-00001040: 2920 2d20 7468 6520 6272 6f77 7365 7220  ) - the browser 
-00001050: 6861 7320 7468 6520 666f 6c6c 6f77 696e  has the followin
-00001060: 6720 686f 746b 6579 730a 2020 2020 2a20  g hotkeys.    * 
-00001070: 5b6e 6176 7061 6e65 5d28 236e 6176 7061  [navpane](#navpa
-00001080: 6e65 2920 2d20 7377 6974 6368 696e 6720  ne) - switching 
-00001090: 6265 7477 6565 6e20 6272 6561 6463 7275  between breadcru
-000010a0: 6d62 7320 6f72 206e 6176 7061 6e65 0a20  mbs or navpane. 
-000010b0: 2020 202a 205b 7468 756d 626e 6169 6c73     * [thumbnails
-000010c0: 5d28 2374 6875 6d62 6e61 696c 7329 202d  ](#thumbnails) -
-000010d0: 2070 7265 7373 2060 6760 206f 7220 60e7   press `g` or `.
-000010e0: 94b0 6020 746f 2074 6f67 676c 6520 6772  ..` to toggle gr
-000010f0: 6964 2d76 6965 7720 696e 7374 6561 6420  id-view instead 
-00001100: 6f66 2074 6865 2066 696c 6520 6c69 7374  of the file list
-00001110: 696e 670a 2020 2020 2a20 5b7a 6970 2064  ing.    * [zip d
-00001120: 6f77 6e6c 6f61 6473 5d28 237a 6970 2d64  ownloads](#zip-d
-00001130: 6f77 6e6c 6f61 6473 2920 2d20 646f 776e  ownloads) - down
-00001140: 6c6f 6164 2066 6f6c 6465 7273 2028 6f72  load folders (or
-00001150: 2066 696c 6520 7365 6c65 6374 696f 6e73   file selections
-00001160: 2920 6173 2060 7a69 7060 206f 7220 6074  ) as `zip` or `t
-00001170: 6172 6020 6669 6c65 730a 2020 2020 2a20  ar` files.    * 
-00001180: 5b75 706c 6f61 6469 6e67 5d28 2375 706c  [uploading](#upl
-00001190: 6f61 6469 6e67 2920 2d20 6472 6167 2066  oading) - drag f
-000011a0: 696c 6573 2f66 6f6c 6465 7273 2069 6e74  iles/folders int
-000011b0: 6f20 7468 6520 7765 622d 6272 6f77 7365  o the web-browse
-000011c0: 7220 746f 2075 706c 6f61 640a 2020 2020  r to upload.    
-000011d0: 2020 2020 2a20 5b66 696c 652d 7365 6172      * [file-sear
-000011e0: 6368 5d28 2366 696c 652d 7365 6172 6368  ch](#file-search
-000011f0: 2920 2d20 6472 6f70 7069 6e67 2066 696c  ) - dropping fil
-00001200: 6573 2069 6e74 6f20 7468 6520 6272 6f77  es into the brow
-00001210: 7365 7220 616c 736f 206c 6574 7320 796f  ser also lets yo
-00001220: 7520 7365 6520 6966 2074 6865 7920 6578  u see if they ex
-00001230: 6973 7420 6f6e 2074 6865 2073 6572 7665  ist on the serve
-00001240: 720a 2020 2020 2020 2020 2a20 5b75 6e70  r.        * [unp
-00001250: 6f73 745d 2823 756e 706f 7374 2920 2d20  ost](#unpost) - 
-00001260: 756e 646f 2f64 656c 6574 6520 6163 6369  undo/delete acci
-00001270: 6465 6e74 616c 2075 706c 6f61 6473 0a20  dental uploads. 
-00001280: 2020 2020 2020 202a 205b 7365 6c66 2d64         * [self-d
-00001290: 6573 7472 7563 745d 2823 7365 6c66 2d64  estruct](#self-d
-000012a0: 6573 7472 7563 7429 202d 2075 706c 6f61  estruct) - uploa
-000012b0: 6473 2063 616e 2062 6520 6769 7665 6e20  ds can be given 
-000012c0: 6120 6c69 6665 7469 6d65 0a20 2020 202a  a lifetime.    *
-000012d0: 205b 6669 6c65 206d 616e 6167 6572 5d28   [file manager](
-000012e0: 2366 696c 652d 6d61 6e61 6765 7229 202d  #file-manager) -
-000012f0: 2063 7574 2f70 6173 7465 2c20 7265 6e61   cut/paste, rena
-00001300: 6d65 2c20 616e 6420 6465 6c65 7465 2066  me, and delete f
-00001310: 696c 6573 2f66 6f6c 6465 7273 2028 6966  iles/folders (if
-00001320: 2079 6f75 2068 6176 6520 7065 726d 6973   you have permis
-00001330: 7369 6f6e 290a 2020 2020 2a20 5b62 6174  sion).    * [bat
-00001340: 6368 2072 656e 616d 655d 2823 6261 7463  ch rename](#batc
-00001350: 682d 7265 6e61 6d65 2920 2d20 7365 6c65  h-rename) - sele
-00001360: 6374 2073 6f6d 6520 6669 6c65 7320 616e  ct some files an
-00001370: 6420 7072 6573 7320 6046 3260 2074 6f20  d press `F2` to 
-00001380: 6272 696e 6720 7570 2074 6865 2072 656e  bring up the ren
-00001390: 616d 6520 5549 0a20 2020 202a 205b 6d61  ame UI.    * [ma
-000013a0: 726b 646f 776e 2076 6965 7765 725d 2823  rkdown viewer](#
-000013b0: 6d61 726b 646f 776e 2d76 6965 7765 7229  markdown-viewer)
-000013c0: 202d 2061 6e64 2074 6865 7265 2061 7265   - and there are
-000013d0: 202a 7477 6f2a 2065 6469 746f 7273 0a20   *two* editors. 
-000013e0: 2020 202a 205b 6f74 6865 7220 7472 6963     * [other tric
-000013f0: 6b73 5d28 236f 7468 6572 2d74 7269 636b  ks](#other-trick
-00001400: 7329 0a20 2020 202a 205b 7365 6172 6368  s).    * [search
-00001410: 696e 675d 2823 7365 6172 6368 696e 6729  ing](#searching)
-00001420: 202d 2073 6561 7263 6820 6279 2073 697a   - search by siz
-00001430: 652c 2064 6174 652c 2070 6174 682f 6e61  e, date, path/na
-00001440: 6d65 2c20 6d70 332d 7461 6773 2c20 2e2e  me, mp3-tags, ..
-00001450: 2e0a 2a20 5b73 6572 7665 7220 636f 6e66  ..* [server conf
-00001460: 6967 5d28 2373 6572 7665 722d 636f 6e66  ig](#server-conf
-00001470: 6967 2920 2d20 7573 696e 6720 6172 6775  ig) - using argu
-00001480: 6d65 6e74 7320 6f72 2063 6f6e 6669 6720  ments or config 
-00001490: 6669 6c65 732c 206f 7220 6120 6d69 7820  files, or a mix 
-000014a0: 6f66 2062 6f74 680a 2020 2020 2a20 5b7a  of both.    * [z
-000014b0: 6572 6f63 6f6e 665d 2823 7a65 726f 636f  eroconf](#zeroco
-000014c0: 6e66 2920 2d20 616e 6e6f 756e 6365 2065  nf) - announce e
-000014d0: 6e61 626c 6564 2073 6572 7669 6365 7320  nabled services 
-000014e0: 6f6e 2074 6865 204c 414e 2028 5b70 6963  on the LAN ([pic
-000014f0: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
-00001500: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-00001510: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-00001520: 3332 2f32 3135 3334 3437 3337 2d30 6561  32/215344737-0ea
-00001530: 6538 6439 382d 3934 3936 2d34 3235 362d  e8d98-9496-4256-
-00001540: 3961 6138 2d63 6432 6636 3937 3138 3130  9aa8-cd2f6971810
-00001550: 642e 706e 6729 290a 2020 2020 2020 2020  d.png)).        
-00001560: 2a20 5b6d 646e 735d 2823 6d64 6e73 2920  * [mdns](#mdns) 
-00001570: 2d20 4c41 4e20 646f 6d61 696e 2d6e 616d  - LAN domain-nam
-00001580: 6520 616e 6420 6665 6174 7572 6520 616e  e and feature an
-00001590: 6e6f 756e 6365 720a 2020 2020 2020 2020  nouncer.        
-000015a0: 2a20 5b73 7364 705d 2823 7373 6470 2920  * [ssdp](#ssdp) 
-000015b0: 2d20 7769 6e64 6f77 732d 6578 706c 6f72  - windows-explor
-000015c0: 6572 2061 6e6e 6f75 6e63 6572 0a20 2020  er announcer.   
-000015d0: 202a 205b 7172 2d63 6f64 655d 2823 7172   * [qr-code](#qr
-000015e0: 2d63 6f64 6529 202d 2070 7269 6e74 2061  -code) - print a
-000015f0: 2071 722d 636f 6465 205b 2873 6372 6565   qr-code [(scree
-00001600: 6e73 686f 7429 5d28 6874 7470 733a 2f2f  nshot)](https://
-00001610: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
-00001620: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
-00001630: 6d2f 3234 3130 3332 2f31 3934 3732 3835  m/241032/1947285
-00001640: 3333 2d36 6630 3038 3439 622d 6336 6163  33-6f00849b-c6ac
-00001650: 2d34 3363 362d 3933 3539 2d38 3365 3435  -43c6-9359-83e45
-00001660: 3464 3131 6530 302e 706e 6729 2066 6f72  4d11e00.png) for
-00001670: 2071 7569 636b 2061 6363 6573 730a 2020   quick access.  
-00001680: 2020 2a20 5b66 7470 2073 6572 7665 725d    * [ftp server]
-00001690: 2823 6674 702d 7365 7276 6572 2920 2d20  (#ftp-server) - 
-000016a0: 616e 2046 5450 2073 6572 7665 7220 6361  an FTP server ca
-000016b0: 6e20 6265 2073 7461 7274 6564 2075 7369  n be started usi
-000016c0: 6e67 2060 2d2d 6674 7020 3339 3231 600a  ng `--ftp 3921`.
-000016d0: 2020 2020 2a20 5b77 6562 6461 7620 7365      * [webdav se
-000016e0: 7276 6572 5d28 2377 6562 6461 762d 7365  rver](#webdav-se
-000016f0: 7276 6572 2920 2d20 7769 7468 2072 6561  rver) - with rea
-00001700: 642d 7772 6974 6520 7375 7070 6f72 740a  d-write support.
-00001710: 2020 2020 2020 2020 2a20 5b63 6f6e 6e65          * [conne
-00001720: 6374 696e 6720 746f 2077 6562 6461 7620  cting to webdav 
-00001730: 6672 6f6d 2077 696e 646f 7773 5d28 2363  from windows](#c
-00001740: 6f6e 6e65 6374 696e 672d 746f 2d77 6562  onnecting-to-web
-00001750: 6461 762d 6672 6f6d 2d77 696e 646f 7773  dav-from-windows
-00001760: 2920 2d20 7573 696e 6720 7468 6520 4755  ) - using the GU
-00001770: 490a 2020 2020 2a20 5b73 6d62 2073 6572  I.    * [smb ser
-00001780: 7665 725d 2823 736d 622d 7365 7276 6572  ver](#smb-server
-00001790: 2920 2d20 756e 7361 6665 2c20 736c 6f77  ) - unsafe, slow
-000017a0: 2c20 6e6f 7420 7265 636f 6d6d 656e 6465  , not recommende
-000017b0: 6420 666f 7220 7761 6e0a 2020 2020 2a20  d for wan.    * 
-000017c0: 5b66 696c 6520 696e 6465 7869 6e67 5d28  [file indexing](
-000017d0: 2366 696c 652d 696e 6465 7869 6e67 2920  #file-indexing) 
-000017e0: 2d20 656e 6162 6c65 7320 6465 6475 7020  - enables dedup 
-000017f0: 616e 6420 6d75 7369 6320 7365 6172 6368  and music search
-00001800: 202b 2b0a 2020 2020 2020 2020 2a20 5b65   ++.        * [e
-00001810: 7863 6c75 6465 2d70 6174 7465 726e 735d  xclude-patterns]
-00001820: 2823 6578 636c 7564 652d 7061 7474 6572  (#exclude-patter
-00001830: 6e73 2920 2d20 746f 2073 6176 6520 736f  ns) - to save so
-00001840: 6d65 2074 696d 650a 2020 2020 2020 2020  me time.        
-00001850: 2a20 5b66 696c 6573 7973 7465 6d20 6775  * [filesystem gu
-00001860: 6172 6473 5d28 2366 696c 6573 7973 7465  ards](#filesyste
-00001870: 6d2d 6775 6172 6473 2920 2d20 6176 6f69  m-guards) - avoi
-00001880: 6420 7472 6176 6572 7369 6e67 2069 6e74  d traversing int
-00001890: 6f20 6f74 6865 7220 6669 6c65 7379 7374  o other filesyst
-000018a0: 656d 730a 2020 2020 2020 2020 2a20 5b70  ems.        * [p
-000018b0: 6572 696f 6469 6320 7265 7363 616e 5d28  eriodic rescan](
-000018c0: 2370 6572 696f 6469 632d 7265 7363 616e  #periodic-rescan
-000018d0: 2920 2d20 6669 6c65 7379 7374 656d 206d  ) - filesystem m
-000018e0: 6f6e 6974 6f72 696e 670a 2020 2020 2a20  onitoring.    * 
-000018f0: 5b75 706c 6f61 6420 7275 6c65 735d 2823  [upload rules](#
-00001900: 7570 6c6f 6164 2d72 756c 6573 2920 2d20  upload-rules) - 
-00001910: 7365 7420 7570 6c6f 6164 2072 756c 6573  set upload rules
-00001920: 2075 7369 6e67 2076 6f6c 666c 6167 730a   using volflags.
-00001930: 2020 2020 2a20 5b63 6f6d 7072 6573 7320      * [compress 
-00001940: 7570 6c6f 6164 735d 2823 636f 6d70 7265  uploads](#compre
-00001950: 7373 2d75 706c 6f61 6473 2920 2d20 6669  ss-uploads) - fi
-00001960: 6c65 7320 6361 6e20 6265 2061 7574 6f63  les can be autoc
-00001970: 6f6d 7072 6573 7365 6420 6f6e 2075 706c  ompressed on upl
-00001980: 6f61 640a 2020 2020 2a20 5b6f 7468 6572  oad.    * [other
-00001990: 2066 6c61 6773 5d28 236f 7468 6572 2d66   flags](#other-f
-000019a0: 6c61 6773 290a 2020 2020 2a20 5b64 6174  lags).    * [dat
-000019b0: 6162 6173 6520 6c6f 6361 7469 6f6e 5d28  abase location](
-000019c0: 2364 6174 6162 6173 652d 6c6f 6361 7469  #database-locati
-000019d0: 6f6e 2920 2d20 696e 2d76 6f6c 756d 6520  on) - in-volume 
-000019e0: 2860 2e68 6973 742f 7570 326b 2e64 6260  (`.hist/up2k.db`
-000019f0: 2c20 6465 6661 756c 7429 206f 7220 736f  , default) or so
-00001a00: 6d65 7768 6572 6520 656c 7365 0a20 2020  mewhere else.   
-00001a10: 202a 205b 6d65 7461 6461 7461 2066 726f   * [metadata fro
-00001a20: 6d20 6175 6469 6f20 6669 6c65 735d 2823  m audio files](#
-00001a30: 6d65 7461 6461 7461 2d66 726f 6d2d 6175  metadata-from-au
-00001a40: 6469 6f2d 6669 6c65 7329 202d 2073 6574  dio-files) - set
-00001a50: 2060 2d65 3274 6020 746f 2069 6e64 6578   `-e2t` to index
-00001a60: 2074 6167 7320 6f6e 2075 706c 6f61 640a   tags on upload.
-00001a70: 2020 2020 2a20 5b66 696c 6520 7061 7273      * [file pars
-00001a80: 6572 2070 6c75 6769 6e73 5d28 2366 696c  er plugins](#fil
-00001a90: 652d 7061 7273 6572 2d70 6c75 6769 6e73  e-parser-plugins
-00001aa0: 2920 2d20 7072 6f76 6964 6520 6375 7374  ) - provide cust
-00001ab0: 6f6d 2070 6172 7365 7273 2074 6f20 696e  om parsers to in
-00001ac0: 6465 7820 6164 6469 7469 6f6e 616c 2074  dex additional t
-00001ad0: 6167 730a 2020 2020 2a20 5b65 7665 6e74  ags.    * [event
-00001ae0: 2068 6f6f 6b73 5d28 2365 7665 6e74 2d68   hooks](#event-h
-00001af0: 6f6f 6b73 2920 2d20 7472 6967 6765 7220  ooks) - trigger 
-00001b00: 6120 7072 6f67 7261 6d20 6f6e 2075 706c  a program on upl
-00001b10: 6f61 6473 2c20 7265 6e61 6d65 7320 6574  oads, renames et
-00001b20: 6320 285b 6578 616d 706c 6573 5d28 2e2f  c ([examples](./
-00001b30: 6269 6e2f 686f 6f6b 732f 2929 0a20 2020  bin/hooks/)).   
-00001b40: 2020 2020 202a 205b 7570 6c6f 6164 2065       * [upload e
-00001b50: 7665 6e74 735d 2823 7570 6c6f 6164 2d65  vents](#upload-e
-00001b60: 7665 6e74 7329 202d 2074 6865 206f 6c64  vents) - the old
-00001b70: 6572 2c20 6d6f 7265 2070 6f77 6572 6675  er, more powerfu
-00001b80: 6c20 6170 7072 6f61 6368 2028 5b65 7861  l approach ([exa
-00001b90: 6d70 6c65 735d 282e 2f62 696e 2f6d 7461  mples](./bin/mta
-00001ba0: 672f 2929 0a20 2020 202a 205b 6869 6469  g/)).    * [hidi
-00001bb0: 6e67 2066 726f 6d20 676f 6f67 6c65 5d28  ng from google](
-00001bc0: 2368 6964 696e 672d 6672 6f6d 2d67 6f6f  #hiding-from-goo
-00001bd0: 676c 6529 202d 2074 656c 6c20 7365 6172  gle) - tell sear
-00001be0: 6368 2065 6e67 696e 6573 2079 6f75 2064  ch engines you d
-00001bf0: 6f6e 7420 7761 6e6e 6120 6265 2069 6e64  ont wanna be ind
-00001c00: 6578 6564 0a20 2020 202a 205b 7468 656d  exed.    * [them
-00001c10: 6573 5d28 2374 6865 6d65 7329 0a20 2020  es](#themes).   
-00001c20: 202a 205b 636f 6d70 6c65 7465 2065 7861   * [complete exa
-00001c30: 6d70 6c65 735d 2823 636f 6d70 6c65 7465  mples](#complete
-00001c40: 2d65 7861 6d70 6c65 7329 0a20 2020 202a  -examples).    *
-00001c50: 205b 7265 7665 7273 652d 7072 6f78 795d   [reverse-proxy]
-00001c60: 2823 7265 7665 7273 652d 7072 6f78 7929  (#reverse-proxy)
-00001c70: 202d 2072 756e 6e69 6e67 2063 6f70 7970   - running copyp
-00001c80: 6172 7479 206e 6578 7420 746f 206f 7468  arty next to oth
-00001c90: 6572 2077 6562 7369 7465 730a 2a20 5b62  er websites.* [b
-00001ca0: 726f 7773 6572 2073 7570 706f 7274 5d28  rowser support](
-00001cb0: 2362 726f 7773 6572 2d73 7570 706f 7274  #browser-support
-00001cc0: 2920 2d20 544c 4452 3a20 7965 730a 2a20  ) - TLDR: yes.* 
-00001cd0: 5b63 6c69 656e 7420 6578 616d 706c 6573  [client examples
-00001ce0: 5d28 2363 6c69 656e 742d 6578 616d 706c  ](#client-exampl
-00001cf0: 6573 2920 2d20 696e 7465 7261 6374 2077  es) - interact w
-00001d00: 6974 6820 636f 7079 7061 7274 7920 7573  ith copyparty us
-00001d10: 696e 6720 6e6f 6e2d 6272 6f77 7365 7220  ing non-browser 
-00001d20: 636c 6965 6e74 730a 2020 2020 2a20 5b6d  clients.    * [m
-00001d30: 6f75 6e74 2061 7320 6472 6976 655d 2823  ount as drive](#
-00001d40: 6d6f 756e 742d 6173 2d64 7269 7665 2920  mount-as-drive) 
-00001d50: 2d20 6120 7265 6d6f 7465 2063 6f70 7970  - a remote copyp
-00001d60: 6172 7479 2073 6572 7665 7220 6173 2061  arty server as a
-00001d70: 206c 6f63 616c 2066 696c 6573 7973 7465   local filesyste
-00001d80: 6d0a 2a20 5b70 6572 666f 726d 616e 6365  m.* [performance
-00001d90: 5d28 2370 6572 666f 726d 616e 6365 2920  ](#performance) 
-00001da0: 2d20 6465 6661 756c 7473 2061 7265 2075  - defaults are u
-00001db0: 7375 616c 6c79 2066 696e 6520 2d20 6578  sually fine - ex
-00001dc0: 7065 6374 2060 3820 4769 422f 7360 2064  pect `8 GiB/s` d
-00001dd0: 6f77 6e6c 6f61 642c 2060 3120 4769 422f  ownload, `1 GiB/
-00001de0: 7360 2075 706c 6f61 640a 2020 2020 2a20  s` upload.    * 
-00001df0: 5b63 6c69 656e 742d 7369 6465 5d28 2363  [client-side](#c
-00001e00: 6c69 656e 742d 7369 6465 2920 2d20 7768  lient-side) - wh
-00001e10: 656e 2075 706c 6f61 6469 6e67 2066 696c  en uploading fil
-00001e20: 6573 0a2a 205b 7365 6375 7269 7479 5d28  es.* [security](
-00001e30: 2373 6563 7572 6974 7929 202d 2073 6f6d  #security) - som
-00001e40: 6520 6e6f 7465 7320 6f6e 2068 6172 6465  e notes on harde
-00001e50: 6e69 6e67 0a20 2020 202a 205b 676f 7463  ning.    * [gotc
-00001e60: 6861 735d 2823 676f 7463 6861 7329 202d  has](#gotchas) -
-00001e70: 2062 6568 6176 696f 7220 7468 6174 206d   behavior that m
-00001e80: 6967 6874 2062 6520 756e 6578 7065 6374  ight be unexpect
-00001e90: 6564 0a20 2020 202a 205b 636f 7273 5d28  ed.    * [cors](
-00001ea0: 2363 6f72 7329 202d 2063 726f 7373 2d73  #cors) - cross-s
-00001eb0: 6974 6520 7265 7175 6573 7420 636f 6e66  ite request conf
-00001ec0: 6967 0a2a 205b 7265 636f 7665 7269 6e67  ig.* [recovering
-00001ed0: 2066 726f 6d20 6372 6173 6865 735d 2823   from crashes](#
-00001ee0: 7265 636f 7665 7269 6e67 2d66 726f 6d2d  recovering-from-
-00001ef0: 6372 6173 6865 7329 0a20 2020 202a 205b  crashes).    * [
-00001f00: 636c 6965 6e74 2063 7261 7368 6573 5d28  client crashes](
-00001f10: 2363 6c69 656e 742d 6372 6173 6865 7329  #client-crashes)
-00001f20: 0a20 2020 2020 2020 202a 205b 6672 6566  .        * [fref
-00001f30: 6f78 2077 736f 645d 2823 6672 6566 6f78  ox wsod](#frefox
-00001f40: 2d77 736f 6429 202d 2066 6972 6566 6f78  -wsod) - firefox
-00001f50: 2038 3720 6361 6e20 6372 6173 6820 6475   87 can crash du
-00001f60: 7269 6e67 2075 706c 6f61 6473 0a2a 205b  ring uploads.* [
-00001f70: 4854 5450 2041 5049 5d28 2348 5454 502d  HTTP API](#HTTP-
-00001f80: 4150 4929 202d 2073 6565 205b 6465 766e  API) - see [devn
-00001f90: 6f74 6573 5d28 232e 2f64 6f63 732f 6465  otes](#./docs/de
-00001fa0: 766e 6f74 6573 2e6d 6423 6874 7470 2d61  vnotes.md#http-a
-00001fb0: 7069 290a 2a20 5b64 6570 656e 6465 6e63  pi).* [dependenc
-00001fc0: 6965 735d 2823 6465 7065 6e64 656e 6369  ies](#dependenci
-00001fd0: 6573 2920 2d20 6d61 6e64 6174 6f72 7920  es) - mandatory 
-00001fe0: 6465 7073 0a20 2020 202a 205b 6f70 7469  deps.    * [opti
-00001ff0: 6f6e 616c 2064 6570 656e 6465 6e63 6965  onal dependencie
-00002000: 735d 2823 6f70 7469 6f6e 616c 2d64 6570  s](#optional-dep
-00002010: 656e 6465 6e63 6965 7329 202d 2069 6e73  endencies) - ins
-00002020: 7461 6c6c 2074 6865 7365 2074 6f20 656e  tall these to en
-00002030: 6162 6c65 2062 6f6e 7573 2066 6561 7475  able bonus featu
-00002040: 7265 730a 2020 2020 2a20 5b6f 7074 696f  res.    * [optio
-00002050: 6e61 6c20 6770 6c20 7374 7566 665d 2823  nal gpl stuff](#
-00002060: 6f70 7469 6f6e 616c 2d67 706c 2d73 7475  optional-gpl-stu
-00002070: 6666 290a 2a20 5b73 6678 5d28 2373 6678  ff).* [sfx](#sfx
-00002080: 2920 2d20 7468 6520 7365 6c66 2d63 6f6e  ) - the self-con
-00002090: 7461 696e 6564 2022 6269 6e61 7279 220a  tained "binary".
-000020a0: 2020 2020 2a20 5b63 6f70 7970 6172 7479      * [copyparty
-000020b0: 2e65 7865 5d28 2363 6f70 7970 6172 7479  .exe](#copyparty
-000020c0: 6578 6529 202d 2064 6f77 6e6c 6f61 6420  exe) - download 
-000020d0: 5b63 6f70 7970 6172 7479 2e65 7865 5d28  [copyparty.exe](
-000020e0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-000020f0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
-00002100: 792f 7265 6c65 6173 6573 2f6c 6174 6573  y/releases/lates
-00002110: 742f 646f 776e 6c6f 6164 2f63 6f70 7970  t/download/copyp
-00002120: 6172 7479 2e65 7865 2920 2877 696e 382b  arty.exe) (win8+
-00002130: 2920 6f72 205b 636f 7079 7061 7274 7933  ) or [copyparty3
-00002140: 322e 6578 655d 2868 7474 7073 3a2f 2f67  2.exe](https://g
-00002150: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
-00002160: 6f70 7970 6172 7479 2f72 656c 6561 7365  opyparty/release
-00002170: 732f 6c61 7465 7374 2f64 6f77 6e6c 6f61  s/latest/downloa
-00002180: 642f 636f 7079 7061 7274 7933 322e 6578  d/copyparty32.ex
-00002190: 6529 2028 7769 6e37 2b29 0a2a 205b 696e  e) (win7+).* [in
-000021a0: 7374 616c 6c20 6f6e 2061 6e64 726f 6964  stall on android
-000021b0: 5d28 2369 6e73 7461 6c6c 2d6f 6e2d 616e  ](#install-on-an
-000021c0: 6472 6f69 6429 0a2a 205b 7265 706f 7274  droid).* [report
-000021d0: 696e 6720 6275 6773 5d28 2372 6570 6f72  ing bugs](#repor
-000021e0: 7469 6e67 2d62 7567 7329 202d 2069 6465  ting-bugs) - ide
-000021f0: 6173 2066 6f72 2063 6f6e 7465 7874 2074  as for context t
-00002200: 6f20 696e 636c 7564 6520 696e 2062 7567  o include in bug
-00002210: 2072 6570 6f72 7473 0a2a 205b 6465 766e   reports.* [devn
-00002220: 6f74 6573 5d28 2364 6576 6e6f 7465 7329  otes](#devnotes)
-00002230: 202d 2066 6f72 2062 7569 6c64 2069 6e73   - for build ins
-00002240: 7472 7563 7469 6f6e 7320 6574 632c 2073  tructions etc, s
-00002250: 6565 205b 2e2f 646f 6373 2f64 6576 6e6f  ee [./docs/devno
-00002260: 7465 732e 6d64 5d28 2e2f 646f 6373 2f64  tes.md](./docs/d
-00002270: 6576 6e6f 7465 732e 6d64 290a 0a0a 2323  evnotes.md)...##
-00002280: 2071 7569 636b 7374 6172 740a 0a6a 7573   quickstart..jus
-00002290: 7420 7275 6e20 2a2a 5b63 6f70 7970 6172  t run **[copypar
-000022a0: 7479 2d73 6678 2e70 795d 2868 7474 7073  ty-sfx.py](https
-000022b0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
-000022c0: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
-000022d0: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
-000022e0: 6e6c 6f61 642f 636f 7079 7061 7274 792d  nload/copyparty-
-000022f0: 7366 782e 7079 292a 2a20 2d2d 2074 6861  sfx.py)** -- tha
-00002300: 7427 7320 6974 2120 f09f 8e89 0a0a 2a20  t's it! ......* 
-00002310: 6f72 2069 6e73 7461 6c6c 2074 6872 6f75  or install throu
-00002320: 6768 2070 7970 6920 2870 7974 686f 6e33  gh pypi (python3
-00002330: 206f 6e6c 7929 3a20 6070 7974 686f 6e33   only): `python3
-00002340: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
-00002350: 2d2d 7573 6572 202d 5520 636f 7079 7061  --user -U copypa
-00002360: 7274 7960 0a2a 206f 7220 6966 2079 6f75  rty`.* or if you
-00002370: 2063 616e 6e6f 7420 696e 7374 616c 6c20   cannot install 
-00002380: 7079 7468 6f6e 2c20 796f 7520 6361 6e20  python, you can 
-00002390: 7573 6520 5b63 6f70 7970 6172 7479 2e65  use [copyparty.e
-000023a0: 7865 5d28 2363 6f70 7970 6172 7479 6578  xe](#copypartyex
-000023b0: 6529 2069 6e73 7465 6164 0a2a 206f 7220  e) instead.* or 
-000023c0: 6966 2079 6f75 2061 7265 206f 6e20 616e  if you are on an
-000023d0: 6472 6f69 642c 205b 696e 7374 616c 6c20  droid, [install 
-000023e0: 636f 7079 7061 7274 7920 696e 2074 6572  copyparty in ter
-000023f0: 6d75 785d 2823 696e 7374 616c 6c2d 6f6e  mux](#install-on
-00002400: 2d61 6e64 726f 6964 290a 2a20 6f72 2069  -android).* or i
-00002410: 6620 796f 7520 7072 6566 6572 2074 6f20  f you prefer to 
-00002420: 5b75 7365 2064 6f63 6b65 725d 282e 2f73  [use docker](./s
-00002430: 6372 6970 7473 2f64 6f63 6b65 722f 2920  cripts/docker/) 
-00002440: f09f 908b 2079 6f75 2063 616e 2064 6f20  .... you can do 
-00002450: 7468 6174 2074 6f6f 0a20 202a 2064 6f63  that too.  * doc
-00002460: 6b65 7220 6861 7320 616c 6c20 6465 7073  ker has all deps
-00002470: 2062 7569 6c74 2d69 6e2c 2073 6f20 736b   built-in, so sk
-00002480: 6970 2074 6869 7320 7374 6570 3a0a 0a65  ip this step:..e
-00002490: 6e61 626c 6520 7468 756d 626e 6169 6c73  nable thumbnails
-000024a0: 2028 696d 6167 6573 2f61 7564 696f 2f76   (images/audio/v
-000024b0: 6964 656f 292c 206d 6564 6961 2069 6e64  ideo), media ind
-000024c0: 6578 696e 672c 2061 6e64 2061 7564 696f  exing, and audio
-000024d0: 2074 7261 6e73 636f 6469 6e67 2062 7920   transcoding by 
-000024e0: 696e 7374 616c 6c69 6e67 2073 6f6d 6520  installing some 
-000024f0: 7265 636f 6d6d 656e 6465 6420 6465 7073  recommended deps
-00002500: 3a0a 0a2a 202a 2a41 6c70 696e 653a 2a2a  :..* **Alpine:**
-00002510: 2060 6170 6b20 6164 6420 7079 332d 7069   `apk add py3-pi
-00002520: 6c6c 6f77 2066 666d 7065 6760 0a2a 202a  llow ffmpeg`.* *
-00002530: 2a44 6562 6961 6e3a 2a2a 2060 6170 7420  *Debian:** `apt 
-00002540: 696e 7374 616c 6c20 7079 7468 6f6e 332d  install python3-
-00002550: 7069 6c20 6666 6d70 6567 600a 2a20 2a2a  pil ffmpeg`.* **
-00002560: 4665 646f 7261 3a2a 2a20 6064 6e66 2069  Fedora:** `dnf i
-00002570: 6e73 7461 6c6c 2070 7974 686f 6e33 2d70  nstall python3-p
-00002580: 696c 6c6f 7720 6666 6d70 6567 600a 2a20  illow ffmpeg`.* 
-00002590: 2a2a 4672 6565 4253 443a 2a2a 2060 706b  **FreeBSD:** `pk
-000025a0: 6720 696e 7374 616c 6c20 7079 3339 2d73  g install py39-s
-000025b0: 716c 6974 6533 2070 7933 392d 7069 6c6c  qlite3 py39-pill
-000025c0: 6f77 2066 666d 7065 6760 0a2a 202a 2a4d  ow ffmpeg`.* **M
-000025d0: 6163 4f53 3a2a 2a20 6070 6f72 7420 696e  acOS:** `port in
-000025e0: 7374 616c 6c20 7079 2d50 696c 6c6f 7720  stall py-Pillow 
-000025f0: 6666 6d70 6567 600a 2a20 2a2a 4d61 634f  ffmpeg`.* **MacO
-00002600: 532a 2a20 2861 6c74 6572 6e61 7469 7665  S** (alternative
-00002610: 293a 2060 6272 6577 2069 6e73 7461 6c6c  ): `brew install
-00002620: 2070 696c 6c6f 7720 6666 6d70 6567 600a   pillow ffmpeg`.
-00002630: 2a20 2a2a 5769 6e64 6f77 733a 2a2a 2060  * **Windows:** `
-00002640: 7079 7468 6f6e 202d 6d20 7069 7020 696e  python -m pip in
-00002650: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
-00002660: 5069 6c6c 6f77 600a 2020 2a20 696e 7374  Pillow`.  * inst
-00002670: 616c 6c20 7079 7468 6f6e 2061 6e64 2066  all python and f
-00002680: 666d 7065 6720 6d61 6e75 616c 6c79 3b20  fmpeg manually; 
-00002690: 646f 206e 6f74 2075 7365 2060 7769 6e67  do not use `wing
-000026a0: 6574 6020 6f72 2060 4d69 6372 6f73 6f66  et` or `Microsof
-000026b0: 7420 5374 6f72 6560 2028 6974 2062 7265  t Store` (it bre
-000026c0: 616b 7320 2450 4154 4829 0a20 202a 2063  aks $PATH).  * c
-000026d0: 6f70 7970 6172 7479 2e65 7865 2063 6f6d  opyparty.exe com
-000026e0: 6573 2077 6974 6820 6050 696c 6c6f 7760  es with `Pillow`
-000026f0: 2061 6e64 206f 6e6c 7920 6e65 6564 7320   and only needs 
-00002700: 6066 666d 7065 6760 0a2a 2073 6565 205b  `ffmpeg`.* see [
-00002710: 6f70 7469 6f6e 616c 2064 6570 656e 6465  optional depende
-00002720: 6e63 6965 735d 2823 6f70 7469 6f6e 616c  ncies](#optional
-00002730: 2d64 6570 656e 6465 6e63 6965 7329 2074  -dependencies) t
-00002740: 6f20 656e 6162 6c65 2065 7665 6e20 6d6f  o enable even mo
-00002750: 7265 2066 6561 7475 7265 730a 0a72 756e  re features..run
-00002760: 6e69 6e67 2063 6f70 7970 6172 7479 2077  ning copyparty w
-00002770: 6974 686f 7574 2061 7267 756d 656e 7473  ithout arguments
-00002780: 2028 666f 7220 6578 616d 706c 6520 646f   (for example do
-00002790: 7562 6c65 636c 6963 6b69 6e67 2069 7420  ubleclicking it 
-000027a0: 6f6e 2057 696e 646f 7773 2920 7769 6c6c  on Windows) will
-000027b0: 2067 6976 6520 6576 6572 796f 6e65 2072   give everyone r
-000027c0: 6561 642f 7772 6974 6520 6163 6365 7373  ead/write access
-000027d0: 2074 6f20 7468 6520 6375 7272 656e 7420   to the current 
-000027e0: 666f 6c64 6572 3b20 796f 7520 6d61 7920  folder; you may 
-000027f0: 7761 6e74 205b 6163 636f 756e 7473 2061  want [accounts a
-00002800: 6e64 2076 6f6c 756d 6573 5d28 2361 6363  nd volumes](#acc
-00002810: 6f75 6e74 732d 616e 642d 766f 6c75 6d65  ounts-and-volume
-00002820: 7329 0a0a 736f 6d65 2072 6563 6f6d 6d65  s)..some recomme
-00002830: 6e64 6564 206f 7074 696f 6e73 3a0a 2a20  nded options:.* 
-00002840: 602d 6532 6473 6160 2065 6e61 626c 6573  `-e2dsa` enables
-00002850: 2067 656e 6572 616c 205b 6669 6c65 2069   general [file i
-00002860: 6e64 6578 696e 675d 2823 6669 6c65 2d69  ndexing](#file-i
-00002870: 6e64 6578 696e 6729 0a2a 2060 2d65 3274  ndexing).* `-e2t
-00002880: 7360 2065 6e61 626c 6573 2061 7564 696f  s` enables audio
-00002890: 206d 6574 6164 6174 6120 696e 6465 7869   metadata indexi
-000028a0: 6e67 2028 6e65 6564 7320 6569 7468 6572  ng (needs either
-000028b0: 2046 4670 726f 6265 206f 7220 4d75 7461   FFprobe or Muta
-000028c0: 6765 6e29 0a2a 2060 2d76 202f 6d6e 742f  gen).* `-v /mnt/
-000028d0: 6d75 7369 633a 2f6d 7573 6963 3a72 3a72  music:/music:r:r
-000028e0: 772c 666f 6f20 2d61 2066 6f6f 3a62 6172  w,foo -a foo:bar
-000028f0: 6020 7368 6172 6573 2060 2f6d 6e74 2f6d  ` shares `/mnt/m
-00002900: 7573 6963 6020 6173 2060 2f6d 7573 6963  usic` as `/music
-00002910: 602c 2060 7260 6561 6461 626c 6520 6279  `, `r`eadable by
-00002920: 2061 6e79 6f6e 652c 2061 6e64 2072 6561   anyone, and rea
-00002930: 642d 7772 6974 6520 666f 7220 7573 6572  d-write for user
-00002940: 2060 666f 6f60 2c20 7061 7373 776f 7264   `foo`, password
-00002950: 2060 6261 7260 0a20 202a 2072 6570 6c61   `bar`.  * repla
-00002960: 6365 2060 3a72 3a72 772c 666f 6f60 2077  ce `:r:rw,foo` w
-00002970: 6974 6820 603a 722c 666f 6f60 2074 6f20  ith `:r,foo` to 
-00002980: 6f6e 6c79 206d 616b 6520 7468 6520 666f  only make the fo
-00002990: 6c64 6572 2072 6561 6461 626c 6520 6279  lder readable by
-000029a0: 2060 666f 6f60 2061 6e64 206e 6f62 6f64   `foo` and nobod
-000029b0: 7920 656c 7365 0a20 202a 2073 6565 205b  y else.  * see [
-000029c0: 6163 636f 756e 7473 2061 6e64 2076 6f6c  accounts and vol
-000029d0: 756d 6573 5d28 2361 6363 6f75 6e74 732d  umes](#accounts-
-000029e0: 616e 642d 766f 6c75 6d65 7329 2028 6f72  and-volumes) (or
-000029f0: 2060 2d2d 6865 6c70 2d61 6363 6f75 6e74   `--help-account
-00002a00: 7360 2920 666f 7220 7468 6520 7379 6e74  s`) for the synt
-00002a10: 6178 2061 6e64 206f 7468 6572 2070 6572  ax and other per
-00002a20: 6d69 7373 696f 6e73 0a0a 0a23 2323 206f  missions...### o
-00002a30: 6e20 7365 7276 6572 730a 0a79 6f75 206d  n servers..you m
-00002a40: 6179 2061 6c73 6f20 7761 6e74 2074 6865  ay also want the
-00002a50: 7365 2c20 6573 7065 6369 616c 6c79 206f  se, especially o
-00002a60: 6e20 7365 7276 6572 733a 0a0a 2a20 5b63  n servers:..* [c
-00002a70: 6f6e 7472 6962 2f73 7973 7465 6d64 2f63  ontrib/systemd/c
-00002a80: 6f70 7970 6172 7479 2e73 6572 7669 6365  opyparty.service
-00002a90: 5d28 636f 6e74 7269 622f 7379 7374 656d  ](contrib/system
-00002aa0: 642f 636f 7079 7061 7274 792e 7365 7276  d/copyparty.serv
-00002ab0: 6963 6529 2074 6f20 7275 6e20 636f 7079  ice) to run copy
-00002ac0: 7061 7274 7920 6173 2061 2073 7973 7465  party as a syste
-00002ad0: 6d64 2073 6572 7669 6365 0a2a 205b 636f  md service.* [co
-00002ae0: 6e74 7269 622f 7379 7374 656d 642f 7072  ntrib/systemd/pr
-00002af0: 6973 6f6e 7061 7274 792e 7365 7276 6963  isonparty.servic
-00002b00: 655d 2863 6f6e 7472 6962 2f73 7973 7465  e](contrib/syste
-00002b10: 6d64 2f70 7269 736f 6e70 6172 7479 2e73  md/prisonparty.s
-00002b20: 6572 7669 6365 2920 746f 2072 756e 2069  ervice) to run i
-00002b30: 7420 696e 2061 2063 6872 6f6f 7420 2866  t in a chroot (f
-00002b40: 6f72 2065 7874 7261 2073 6563 7572 6974  or extra securit
-00002b50: 7929 0a2a 205b 636f 6e74 7269 622f 7263  y).* [contrib/rc
-00002b60: 2f63 6f70 7970 6172 7479 5d28 636f 6e74  /copyparty](cont
-00002b70: 7269 622f 7263 2f63 6f70 7970 6172 7479  rib/rc/copyparty
-00002b80: 2920 746f 2072 756e 2063 6f70 7970 6172  ) to run copypar
-00002b90: 7479 206f 6e20 4672 6565 4253 440a 2a20  ty on FreeBSD.* 
-00002ba0: 5b63 6f6e 7472 6962 2f6e 6769 6e78 2f63  [contrib/nginx/c
-00002bb0: 6f70 7970 6172 7479 2e63 6f6e 665d 2863  opyparty.conf](c
-00002bc0: 6f6e 7472 6962 2f6e 6769 6e78 2f63 6f70  ontrib/nginx/cop
-00002bd0: 7970 6172 7479 2e63 6f6e 6629 2074 6f20  yparty.conf) to 
-00002be0: 5b72 6576 6572 7365 2d70 726f 7879 5d28  [reverse-proxy](
-00002bf0: 2372 6576 6572 7365 2d70 726f 7879 2920  #reverse-proxy) 
-00002c00: 6265 6869 6e64 206e 6769 6e78 2028 666f  behind nginx (fo
-00002c10: 7220 6265 7474 6572 2068 7474 7073 290a  r better https).
-00002c20: 0a61 6e64 2072 656d 656d 6265 7220 746f  .and remember to
-00002c30: 206f 7065 6e20 7468 6520 706f 7274 7320   open the ports 
-00002c40: 796f 7520 7761 6e74 3b20 6865 7265 2773  you want; here's
-00002c50: 2061 2063 6f6d 706c 6574 6520 6578 616d   a complete exam
-00002c60: 706c 6520 696e 636c 7564 696e 6720 6576  ple including ev
-00002c70: 6572 7920 6665 6174 7572 6520 636f 7079  ery feature copy
-00002c80: 7061 7274 7920 6861 7320 746f 206f 6666  party has to off
-00002c90: 6572 3a0a 6060 600a 6669 7265 7761 6c6c  er:.```.firewall
-00002ca0: 2d63 6d64 202d 2d70 6572 6d61 6e65 6e74  -cmd --permanent
-00002cb0: 202d 2d61 6464 2d70 6f72 743d 7b38 302c   --add-port={80,
-00002cc0: 3434 332c 3339 3231 2c33 3932 332c 3339  443,3921,3923,39
-00002cd0: 3435 2c33 3939 307d 2f74 6370 2020 2320  45,3990}/tcp  # 
-00002ce0: 2d2d 7a6f 6e65 3d6c 6962 7669 7274 0a66  --zone=libvirt.f
-00002cf0: 6972 6577 616c 6c2d 636d 6420 2d2d 7065  irewall-cmd --pe
-00002d00: 726d 616e 656e 7420 2d2d 6164 642d 706f  rmanent --add-po
-00002d10: 7274 3d31 3230 3030 2d31 3230 3939 2f74  rt=12000-12099/t
-00002d20: 6370 202d 2d70 6572 6d61 6e65 6e74 2020  cp --permanent  
-00002d30: 2320 2d2d 7a6f 6e65 3d6c 6962 7669 7274  # --zone=libvirt
-00002d40: 0a66 6972 6577 616c 6c2d 636d 6420 2d2d  .firewall-cmd --
-00002d50: 7065 726d 616e 656e 7420 2d2d 6164 642d  permanent --add-
-00002d60: 706f 7274 3d7b 3139 3030 2c35 3335 337d  port={1900,5353}
-00002d70: 2f75 6470 2020 2320 2d2d 7a6f 6e65 3d6c  /udp  # --zone=l
-00002d80: 6962 7669 7274 0a66 6972 6577 616c 6c2d  ibvirt.firewall-
-00002d90: 636d 6420 2d2d 7265 6c6f 6164 0a60 6060  cmd --reload.```
-00002da0: 0a28 3139 3030 3a73 7364 702c 2033 3932  .(1900:ssdp, 392
-00002db0: 313a 6674 702c 2033 3932 333a 6874 7470  1:ftp, 3923:http
-00002dc0: 2f68 7474 7073 2c20 3339 3435 3a73 6d62  /https, 3945:smb
-00002dd0: 2c20 3339 3930 3a66 7470 732c 2035 3335  , 3990:ftps, 535
-00002de0: 333a 6d64 6e73 2c20 3132 3030 303a 7061  3:mdns, 12000:pa
-00002df0: 7373 6976 652d 6674 7029 0a0a 0a23 2320  ssive-ftp)...## 
-00002e00: 6665 6174 7572 6573 0a0a 2a20 6261 636b  features..* back
-00002e10: 656e 6420 7374 7566 660a 2020 2a20 e298  end stuff.  * ..
-00002e20: 9120 4950 7636 0a20 202a 20e2 9891 205b  . IPv6.  * ... [
-00002e30: 6d75 6c74 6970 726f 6365 7373 696e 675d  multiprocessing]
-00002e40: 2823 7065 7266 6f72 6d61 6e63 6529 2028  (#performance) (
-00002e50: 6163 7475 616c 206d 756c 7469 7468 7265  actual multithre
-00002e60: 6164 696e 6729 0a20 202a 20e2 9891 2076  ading).  * ... v
-00002e70: 6f6c 756d 6573 2028 6d6f 756e 7470 6f69  olumes (mountpoi
-00002e80: 6e74 7329 0a20 202a 20e2 9891 205b 6163  nts).  * ... [ac
-00002e90: 636f 756e 7473 5d28 2361 6363 6f75 6e74  counts](#account
-00002ea0: 732d 616e 642d 766f 6c75 6d65 7329 0a20  s-and-volumes). 
-00002eb0: 202a 20e2 9891 205b 6674 7020 7365 7276   * ... [ftp serv
-00002ec0: 6572 5d28 2366 7470 2d73 6572 7665 7229  er](#ftp-server)
-00002ed0: 0a20 202a 20e2 9891 205b 7765 6264 6176  .  * ... [webdav
-00002ee0: 2073 6572 7665 725d 2823 7765 6264 6176   server](#webdav
-00002ef0: 2d73 6572 7665 7229 0a20 202a 20e2 9891  -server).  * ...
-00002f00: 205b 736d 622f 6369 6673 2073 6572 7665   [smb/cifs serve
-00002f10: 725d 2823 736d 622d 7365 7276 6572 290a  r](#smb-server).
-00002f20: 2020 2a20 e298 9120 5b71 722d 636f 6465    * ... [qr-code
-00002f30: 5d28 2371 722d 636f 6465 2920 666f 7220  ](#qr-code) for 
-00002f40: 7175 6963 6b20 6163 6365 7373 0a20 202a  quick access.  *
-00002f50: 20e2 9891 205b 7570 6e70 202f 207a 6572   ... [upnp / zer
-00002f60: 6f63 6f6e 6620 2f20 6d64 6e73 202f 2073  oconf / mdns / s
-00002f70: 7364 705d 2823 7a65 726f 636f 6e66 290a  sdp](#zeroconf).
-00002f80: 2020 2a20 e298 9120 5b65 7665 6e74 2068    * ... [event h
-00002f90: 6f6f 6b73 5d28 2365 7665 6e74 2d68 6f6f  ooks](#event-hoo
-00002fa0: 6b73 2920 2f20 7363 7269 7074 2072 756e  ks) / script run
-00002fb0: 6e65 720a 2020 2a20 e298 9120 5b72 6576  ner.  * ... [rev
-00002fc0: 6572 7365 2d70 726f 7879 2073 7570 706f  erse-proxy suppo
-00002fd0: 7274 5d28 6874 7470 733a 2f2f 6769 7468  rt](https://gith
-00002fe0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00002ff0: 7061 7274 7923 7265 7665 7273 652d 7072  party#reverse-pr
-00003000: 6f78 7929 0a2a 2075 706c 6f61 640a 2020  oxy).* upload.  
-00003010: 2a20 e298 9120 6261 7369 633a 2070 6c61  * ... basic: pla
-00003020: 696e 206d 756c 7469 7061 7274 2c20 6965  in multipart, ie
-00003030: 3620 7375 7070 6f72 740a 2020 2a20 e298  6 support.  * ..
-00003040: 9120 5b75 7032 6b5d 2823 7570 6c6f 6164  . [up2k](#upload
-00003050: 696e 6729 3a20 6a73 2c20 7265 7375 6d61  ing): js, resuma
-00003060: 626c 652c 206d 756c 7469 7468 7265 6164  ble, multithread
-00003070: 6564 0a20 2020 202a 2075 6e61 6666 6563  ed.    * unaffec
-00003080: 7465 6420 6279 2063 6c6f 7564 666c 6172  ted by cloudflar
-00003090: 6527 7320 6d61 782d 7570 6c6f 6164 2d73  e's max-upload-s
-000030a0: 697a 6520 2831 3030 204d 6942 290a 2020  ize (100 MiB).  
-000030b0: 2a20 e298 9120 7374 6173 683a 2073 696d  * ... stash: sim
-000030c0: 706c 6520 5055 5420 6669 6c65 6472 6f70  ple PUT filedrop
-000030d0: 7065 720a 2020 2a20 e298 9120 6669 6c65  per.  * ... file
-000030e0: 6e61 6d65 2072 616e 646f 6d69 7a65 720a  name randomizer.
-000030f0: 2020 2a20 e298 9120 7772 6974 652d 6f6e    * ... write-on
-00003100: 6c79 2066 6f6c 6465 7273 0a20 202a 20e2  ly folders.  * .
-00003110: 9891 205b 756e 706f 7374 5d28 2375 6e70  .. [unpost](#unp
-00003120: 6f73 7429 3a20 756e 646f 2f64 656c 6574  ost): undo/delet
-00003130: 6520 6163 6369 6465 6e74 616c 2075 706c  e accidental upl
-00003140: 6f61 6473 0a20 202a 20e2 9891 205b 7365  oads.  * ... [se
-00003150: 6c66 2d64 6573 7472 7563 745d 2823 7365  lf-destruct](#se
-00003160: 6c66 2d64 6573 7472 7563 7429 2028 7370  lf-destruct) (sp
-00003170: 6563 6966 6965 6420 7365 7276 6572 2d73  ecified server-s
-00003180: 6964 6520 6f72 2063 6c69 656e 742d 7369  ide or client-si
-00003190: 6465 290a 2020 2a20 e298 9120 7379 6d6c  de).  * ... syml
-000031a0: 696e 6b2f 6469 7363 6172 6420 6578 6973  ink/discard exis
-000031b0: 7469 6e67 2066 696c 6573 2028 636f 6e74  ting files (cont
-000031c0: 656e 742d 6d61 7463 6869 6e67 290a 2a20  ent-matching).* 
-000031d0: 646f 776e 6c6f 6164 0a20 202a 20e2 9891  download.  * ...
-000031e0: 2073 696e 676c 6520 6669 6c65 7320 696e   single files in
-000031f0: 2062 726f 7773 6572 0a20 202a 20e2 9891   browser.  * ...
-00003200: 205b 666f 6c64 6572 7320 6173 207a 6970   [folders as zip
-00003210: 202f 2074 6172 2066 696c 6573 5d28 237a   / tar files](#z
-00003220: 6970 2d64 6f77 6e6c 6f61 6473 290a 2020  ip-downloads).  
-00003230: 2a20 e298 9120 5b46 5553 4520 636c 6965  * ... [FUSE clie
-00003240: 6e74 5d28 6874 7470 733a 2f2f 6769 7468  nt](https://gith
-00003250: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00003260: 7061 7274 792f 7472 6565 2f68 6f76 7564  party/tree/hovud
-00003270: 7374 7261 756d 2f62 696e 2370 6172 7479  straum/bin#party
-00003280: 6675 7365 7079 2920 2872 6561 642d 6f6e  fusepy) (read-on
-00003290: 6c79 290a 2a20 6272 6f77 7365 720a 2020  ly).* browser.  
-000032a0: 2a20 e298 9120 5b6e 6176 7061 6e65 5d28  * ... [navpane](
-000032b0: 236e 6176 7061 6e65 2920 2864 6972 6563  #navpane) (direc
-000032c0: 746f 7279 2074 7265 6520 7369 6465 6261  tory tree sideba
-000032d0: 7229 0a20 202a 20e2 9891 2066 696c 6520  r).  * ... file 
-000032e0: 6d61 6e61 6765 7220 2863 7574 2f70 6173  manager (cut/pas
-000032f0: 7465 2c20 6465 6c65 7465 2c20 5b62 6174  te, delete, [bat
-00003300: 6368 2d72 656e 616d 655d 2823 6261 7463  ch-rename](#batc
-00003310: 682d 7265 6e61 6d65 2929 0a20 202a 20e2  h-rename)).  * .
-00003320: 9891 2061 7564 696f 2070 6c61 7965 7220  .. audio player 
-00003330: 2877 6974 6820 5b4f 5320 6d65 6469 6120  (with [OS media 
-00003340: 636f 6e74 726f 6c73 5d28 6874 7470 733a  controls](https:
-00003350: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-00003360: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-00003370: 636f 6d2f 3234 3130 3332 2f32 3135 3334  com/241032/21534
-00003380: 3734 3932 2d62 3432 3530 3739 372d 3663  7492-b4250797-6c
-00003390: 3930 2d34 6530 392d 3961 3463 2d37 3231  90-4e09-9a4c-721
-000033a0: 6564 6632 6662 3135 632e 706e 6729 2061  edf2fb15c.png) a
-000033b0: 6e64 206f 7075 7320 7472 616e 7363 6f64  nd opus transcod
-000033c0: 696e 6729 0a20 202a 20e2 9891 2069 6d61  ing).  * ... ima
-000033d0: 6765 2067 616c 6c65 7279 2077 6974 6820  ge gallery with 
-000033e0: 7765 626d 2070 6c61 7965 720a 2020 2a20  webm player.  * 
-000033f0: e298 9120 7465 7874 6669 6c65 2062 726f  ... textfile bro
-00003400: 7773 6572 2077 6974 6820 7379 6e74 6178  wser with syntax
-00003410: 2068 696c 6967 6874 696e 670a 2020 2a20   hilighting.  * 
-00003420: e298 9120 5b74 6875 6d62 6e61 696c 735d  ... [thumbnails]
-00003430: 2823 7468 756d 626e 6169 6c73 290a 2020  (#thumbnails).  
-00003440: 2020 2a20 e298 9120 2e2e 2e6f 6620 696d    * ... ...of im
-00003450: 6167 6573 2075 7369 6e67 2050 696c 6c6f  ages using Pillo
-00003460: 772c 2070 7976 6970 732c 206f 7220 4646  w, pyvips, or FF
-00003470: 6d70 6567 0a20 2020 202a 20e2 9891 202e  mpeg.    * ... .
-00003480: 2e2e 6f66 2076 6964 656f 7320 7573 696e  ..of videos usin
-00003490: 6720 4646 6d70 6567 0a20 2020 202a 20e2  g FFmpeg.    * .
-000034a0: 9891 202e 2e2e 6f66 2061 7564 696f 2028  .. ...of audio (
-000034b0: 7370 6563 7472 6f67 7261 6d73 2920 7573  spectrograms) us
-000034c0: 696e 6720 4646 6d70 6567 0a20 2020 202a  ing FFmpeg.    *
-000034d0: 20e2 9891 2063 6163 6865 2065 7669 6374   ... cache evict
-000034e0: 696f 6e20 286d 6178 2d61 6765 3b20 6d61  ion (max-age; ma
-000034f0: 7962 6520 6d61 782d 7369 7a65 2065 7665  ybe max-size eve
-00003500: 6e74 7561 6c6c 7929 0a20 202a 20e2 9891  ntually).  * ...
-00003510: 2053 5041 2028 6272 6f77 7365 2077 6869   SPA (browse whi
-00003520: 6c65 2075 706c 6f61 6469 6e67 290a 2a20  le uploading).* 
-00003530: 7365 7276 6572 2069 6e64 6578 696e 670a  server indexing.
-00003540: 2020 2a20 e298 9120 5b6c 6f63 6174 6520    * ... [locate 
-00003550: 6669 6c65 7320 6279 2063 6f6e 7465 6e74  files by content
-00003560: 735d 2823 6669 6c65 2d73 6561 7263 6829  s](#file-search)
-00003570: 0a20 202a 20e2 9891 2073 6561 7263 6820  .  * ... search 
-00003580: 6279 206e 616d 652f 7061 7468 2f64 6174  by name/path/dat
-00003590: 652f 7369 7a65 0a20 202a 20e2 9891 205b  e/size.  * ... [
-000035a0: 7365 6172 6368 2062 7920 4944 332d 7461  search by ID3-ta
-000035b0: 6773 2065 7463 2e5d 2823 7365 6172 6368  gs etc.](#search
-000035c0: 696e 6729 0a2a 2063 6c69 656e 7420 7375  ing).* client su
-000035d0: 7070 6f72 740a 2020 2a20 e298 9120 5b73  pport.  * ... [s
-000035e0: 796e 6320 666f 6c64 6572 2074 6f20 7365  ync folder to se
-000035f0: 7276 6572 5d28 6874 7470 733a 2f2f 6769  rver](https://gi
-00003600: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
-00003610: 7079 7061 7274 792f 7472 6565 2f68 6f76  pyparty/tree/hov
-00003620: 7564 7374 7261 756d 2f62 696e 2375 7032  udstraum/bin#up2
-00003630: 6b70 7929 0a20 202a 20e2 9891 205b 6375  kpy).  * ... [cu
-00003640: 726c 2d66 7269 656e 646c 795d 2868 7474  rl-friendly](htt
-00003650: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-00003660: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-00003670: 6e74 2e63 6f6d 2f32 3431 3033 322f 3231  nt.com/241032/21
-00003680: 3533 3232 3631 392d 6561 3566 6436 3036  5322619-ea5fd606
-00003690: 2d33 3635 342d 3430 6164 2d39 3465 652d  -3654-40ad-94ee-
-000036a0: 3262 6330 3538 3634 3762 6232 2e70 6e67  2bc058647bb2.png
-000036b0: 290a 2a20 6d61 726b 646f 776e 0a20 202a  ).* markdown.  *
-000036c0: 20e2 9891 205b 7669 6577 6572 5d28 236d   ... [viewer](#m
-000036d0: 6172 6b64 6f77 6e2d 7669 6577 6572 290a  arkdown-viewer).
-000036e0: 2020 2a20 e298 9120 6564 6974 6f72 2028    * ... editor (
-000036f0: 7375 7265 2077 6879 206e 6f74 290a 0a50  sure why not)..P
-00003700: 533a 2073 6f6d 6574 6869 6e67 206d 6973  S: something mis
-00003710: 7369 6e67 3f20 706f 7374 2061 6e79 2063  sing? post any c
-00003720: 7261 7a79 2069 6465 6173 2079 6f75 2776  razy ideas you'v
-00003730: 6520 676f 7420 6173 2061 205b 6665 6174  e got as a [feat
-00003740: 7572 6520 7265 7175 6573 745d 2868 7474  ure request](htt
-00003750: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-00003760: 3930 3031 2f63 6f70 7970 6172 7479 2f69  9001/copyparty/i
-00003770: 7373 7565 732f 6e65 773f 6173 7369 676e  ssues/new?assign
-00003780: 6565 733d 3930 3031 266c 6162 656c 733d  ees=9001&labels=
-00003790: 656e 6861 6e63 656d 656e 7426 7465 6d70  enhancement&temp
-000037a0: 6c61 7465 3d66 6561 7475 7265 5f72 6571  late=feature_req
-000037b0: 7565 7374 2e6d 6429 206f 7220 5b64 6973  uest.md) or [dis
-000037c0: 6375 7373 696f 6e5d 2868 7474 7073 3a2f  cussion](https:/
-000037d0: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
-000037e0: 2f63 6f70 7970 6172 7479 2f64 6973 6375  /copyparty/discu
-000037f0: 7373 696f 6e73 2f6e 6577 3f63 6174 6567  ssions/new?categ
-00003800: 6f72 793d 6964 6561 7329 20f0 9fa4 990a  ory=ideas) .....
-00003810: 0a0a 2323 2074 6573 7469 6d6f 6e69 616c  ..## testimonial
-00003820: 730a 0a73 6d61 6c6c 2063 6f6c 6c65 6374  s..small collect
-00003830: 696f 6e20 6f66 2075 7365 7220 6665 6564  ion of user feed
-00003840: 6261 636b 0a0a 6067 6f6f 6420 656e 6f75  back..`good enou
-00003850: 6768 602c 2060 7375 7270 7269 7369 6e67  gh`, `surprising
-00003860: 6c79 2063 6f72 7265 6374 602c 2060 6365  ly correct`, `ce
-00003870: 7274 6966 6965 6420 676f 6f64 2073 6f66  rtified good sof
-00003880: 7477 6172 6560 2c20 606a 7573 7420 776f  tware`, `just wo
-00003890: 726b 7360 2c20 6077 6879 602c 2060 776f  rks`, `why`, `wo
-000038a0: 7720 7468 6973 2069 7320 6265 7474 6572  w this is better
-000038b0: 2074 6861 6e20 6e65 7874 636c 6f75 6460   than nextcloud`
-000038c0: 0a0a 0a23 206d 6f74 6976 6174 696f 6e73  ...# motivations
-000038d0: 0a0a 7072 6f6a 6563 7420 676f 616c 7320  ..project goals 
-000038e0: 2f20 7068 696c 6f73 6f70 6879 0a0a 2a20  / philosophy..* 
-000038f0: 696e 7665 7273 6520 6c69 6e75 7820 7068  inverse linux ph
-00003900: 696c 6f73 6f70 6879 202d 2d20 646f 2061  ilosophy -- do a
-00003910: 6c6c 2074 6865 2074 6869 6e67 732c 2061  ll the things, a
-00003920: 6e64 2064 6f20 616e 202a 6f6b 6179 2a20  nd do an *okay* 
-00003930: 6a6f 620a 2020 2a20 7175 6963 6b20 6472  job.  * quick dr
-00003940: 6f70 2d69 6e20 7365 7276 6963 6520 746f  op-in service to
-00003950: 2067 6574 2061 206c 6f74 206f 6620 6665   get a lot of fe
-00003960: 6174 7572 6573 2069 6e20 6120 7069 6e63  atures in a pinc
-00003970: 680a 2020 2a20 736f 6d65 206f 6620 5b74  h.  * some of [t
-00003980: 6865 2061 6c74 6572 6e61 7469 7665 735d  he alternatives]
-00003990: 282e 2f64 6f63 732f 7665 7273 7573 2e6d  (./docs/versus.m
-000039a0: 6429 206d 6967 6874 2062 6520 6120 6265  d) might be a be
-000039b0: 7474 6572 2066 6974 2066 6f72 2079 6f75  tter fit for you
-000039c0: 0a2a 2072 756e 2061 6e79 7768 6572 652c  .* run anywhere,
-000039d0: 2073 7570 706f 7274 2065 7665 7279 7468   support everyth
-000039e0: 696e 670a 2020 2a20 6173 206d 616e 7920  ing.  * as many 
-000039f0: 7765 622d 6272 6f77 7365 7273 2061 6e64  web-browsers and
-00003a00: 2070 7974 686f 6e20 7665 7273 696f 6e73   python versions
-00003a10: 2061 7320 706f 7373 6962 6c65 0a20 2020   as possible.   
-00003a20: 202a 2065 7665 7279 2062 726f 7773 6572   * every browser
-00003a30: 2073 686f 756c 6420 6174 206c 6561 7374   should at least
-00003a40: 2062 6520 6162 6c65 2074 6f20 6272 6f77   be able to brow
-00003a50: 7365 2c20 646f 776e 6c6f 6164 2c20 7570  se, download, up
-00003a60: 6c6f 6164 2066 696c 6573 0a20 2020 202a  load files.    *
-00003a70: 2062 6520 6120 676f 6f64 2065 6d65 7267   be a good emerg
-00003a80: 656e 6379 2073 6f6c 7574 696f 6e20 666f  ency solution fo
-00003a90: 7220 7472 616e 7366 6572 7269 6e67 2073  r transferring s
-00003aa0: 7475 6666 2062 6574 7765 656e 2061 6e63  tuff between anc
-00003ab0: 6965 6e74 2062 6f78 6573 0a20 202a 206d  ient boxes.  * m
-00003ac0: 696e 696d 616c 2064 6570 656e 6465 6e63  inimal dependenc
-00003ad0: 6965 730a 2020 2020 2a20 6275 7420 6f70  ies.    * but op
-00003ae0: 7469 6f6e 616c 2064 6570 656e 6465 6e63  tional dependenc
-00003af0: 6965 7320 6164 6469 6e67 2062 6f6e 7573  ies adding bonus
-00003b00: 2d66 6561 7475 7265 7320 6172 6520 6f6b  -features are ok
-00003b10: 0a20 2020 202a 2065 7665 7279 7468 696e  .    * everythin
-00003b20: 6720 6265 696e 6720 706c 6169 6e74 6578  g being plaintex
-00003b30: 7420 6d61 6b65 7320 6974 2070 6f73 7369  t makes it possi
-00003b40: 626c 6520 746f 2070 726f 6f66 7265 6164  ble to proofread
-00003b50: 2066 6f72 206d 616c 6963 696f 7573 2063   for malicious c
-00003b60: 6f64 650a 2020 2a20 6e6f 2070 7265 7061  ode.  * no prepa
-00003b70: 7261 7469 6f6e 7320 2f20 7365 7475 7020  rations / setup 
-00003b80: 6e65 6365 7373 6172 792c 206a 7573 7420  necessary, just 
-00003b90: 7275 6e20 7468 6520 7366 7820 2877 6869  run the sfx (whi
-00003ba0: 6368 2069 7320 616c 736f 2070 6c61 696e  ch is also plain
-00003bb0: 7465 7874 290a 2a20 6164 6170 7461 626c  text).* adaptabl
-00003bc0: 652c 206d 616c 6c65 6162 6c65 2c20 6861  e, malleable, ha
-00003bd0: 636b 6162 6c65 0a20 202a 206e 6f20 6275  ckable.  * no bu
-00003be0: 696c 6420 7374 6570 733b 206d 6f64 6966  ild steps; modif
-00003bf0: 7920 7468 6520 6a73 2f70 7974 686f 6e20  y the js/python 
-00003c00: 7769 7468 6f75 7420 6e65 6564 696e 6720  without needing 
-00003c10: 6e6f 6465 2e6a 7320 6f72 2061 6e79 7468  node.js or anyth
-00003c20: 696e 6720 6c69 6b65 2074 6861 740a 0a0a  ing like that...
-00003c30: 2323 206e 6f74 6573 0a0a 6765 6e65 7261  ## notes..genera
-00003c40: 6c20 6e6f 7465 733a 0a2a 2070 6170 6572  l notes:.* paper
-00003c50: 2d70 7269 6e74 696e 6720 6973 2061 6666  -printing is aff
-00003c60: 6563 7465 6420 6279 2064 6172 6b2f 6c69  ected by dark/li
-00003c70: 6768 742d 6d6f 6465 2120 7573 6520 6c69  ght-mode! use li
-00003c80: 6768 746d 6f64 6520 666f 7220 636f 6c6f  ghtmode for colo
-00003c90: 722c 2064 6172 6b6d 6f64 6520 666f 7220  r, darkmode for 
-00003ca0: 6772 6179 7363 616c 650a 2020 2a20 6265  grayscale.  * be
-00003cb0: 6361 7573 6520 6e6f 2062 726f 7773 6572  cause no browser
-00003cc0: 7320 6375 7272 656e 746c 7920 696d 706c  s currently impl
-00003cd0: 656d 656e 7420 7468 6520 6d65 6469 612d  ement the media-
-00003ce0: 7175 6572 7920 746f 2064 6f20 7468 6973  query to do this
-00003cf0: 2070 726f 7065 726c 7920 6f72 7a0a 0a62   properly orz..b
-00003d00: 726f 7773 6572 2d73 7065 6369 6669 633a  rowser-specific:
-00003d10: 0a2a 2069 5068 6f6e 652f 6950 6164 3a20  .* iPhone/iPad: 
-00003d20: 7573 6520 4669 7265 666f 7820 746f 2064  use Firefox to d
-00003d30: 6f77 6e6c 6f61 6420 6669 6c65 730a 2a20  ownload files.* 
-00003d40: 416e 6472 6f69 642d 4368 726f 6d65 3a20  Android-Chrome: 
-00003d50: 696e 6372 6561 7365 2022 7061 7261 6c6c  increase "parall
-00003d60: 656c 2075 706c 6f61 6473 2220 666f 7220  el uploads" for 
-00003d70: 6869 6768 6572 2073 7065 6564 2028 616e  higher speed (an
-00003d80: 6472 6f69 6420 6275 6729 0a2a 2041 6e64  droid bug).* And
-00003d90: 726f 6964 2d46 6972 6566 6f78 3a20 7461  roid-Firefox: ta
-00003da0: 6b65 7320 6120 7768 696c 6520 746f 2073  kes a while to s
-00003db0: 656c 6563 7420 6669 6c65 7320 2874 6865  elect files (the
-00003dc0: 6972 2066 6978 2066 6f72 20e2 989d efb8  ir fix for .....
-00003dd0: 8f29 0a2a 2044 6573 6b74 6f70 2d46 6972  .).* Desktop-Fir
-00003de0: 6566 6f78 3a20 7e7e 6d61 7920 7573 6520  efox: ~~may use 
-00003df0: 6769 6761 6279 7465 7320 6f66 2052 414d  gigabytes of RAM
-00003e00: 2069 6620 796f 7572 2066 696c 6573 2061   if your files a
-00003e10: 7265 206d 6173 7369 7665 7e7e 202a 7365  re massive~~ *se
-00003e20: 656d 7320 746f 2062 6520 4f4b 206e 6f77  ems to be OK now
-00003e30: 2a0a 2a20 4465 736b 746f 702d 4669 7265  *.* Desktop-Fire
-00003e40: 666f 783a 205b 6d61 7920 7374 6f70 2079  fox: [may stop y
-00003e50: 6f75 2066 726f 6d20 756e 706c 7567 6769  ou from unpluggi
-00003e60: 6e67 2055 5342 2066 6c61 7368 6472 6976  ng USB flashdriv
-00003e70: 6573 5d28 6874 7470 733a 2f2f 6275 677a  es](https://bugz
-00003e80: 696c 6c61 2e6d 6f7a 696c 6c61 2e6f 7267  illa.mozilla.org
-00003e90: 2f73 686f 775f 6275 672e 6367 693f 6964  /show_bug.cgi?id
-00003ea0: 3d31 3739 3235 3938 2920 756e 7469 6c20  =1792598) until 
-00003eb0: 796f 7520 7669 7369 7420 6061 626f 7574  you visit `about
-00003ec0: 3a6d 656d 6f72 7960 2061 6e64 2063 6c69  :memory` and cli
-00003ed0: 636b 2060 4d69 6e69 6d69 7a65 206d 656d  ck `Minimize mem
-00003ee0: 6f72 7920 7573 6167 6560 0a0a 7365 7276  ory usage`..serv
-00003ef0: 6572 2d6f 732d 7370 6563 6966 6963 3a0a  er-os-specific:.
-00003f00: 2a20 5248 454c 3820 2f20 526f 636b 7938  * RHEL8 / Rocky8
-00003f10: 3a20 796f 7520 6361 6e20 7275 6e20 636f  : you can run co
-00003f20: 7079 7061 7274 7920 7573 696e 6720 602f  pyparty using `/
-00003f30: 7573 722f 6c69 6265 7865 632f 706c 6174  usr/libexec/plat
-00003f40: 666f 726d 2d70 7974 686f 6e60 0a0a 7365  form-python`..se
-00003f50: 7276 6572 206e 6f74 6573 3a0a 2a20 7079  rver notes:.* py
-00003f60: 7079 2069 7320 7375 7070 6f72 7465 6420  py is supported 
-00003f70: 6275 7420 7265 6775 6c61 7220 6370 7974  but regular cpyt
-00003f80: 686f 6e20 6973 2066 6173 7465 7220 6966  hon is faster if
-00003f90: 2079 6f75 2065 6e61 626c 6520 7468 6520   you enable the 
-00003fa0: 6461 7461 6261 7365 0a0a 0a23 2062 7567  database...# bug
-00003fb0: 730a 0a2a 2057 696e 646f 7773 3a20 7079  s..* Windows: py
-00003fc0: 7468 6f6e 2032 2e37 2063 616e 6e6f 7420  thon 2.7 cannot 
-00003fd0: 696e 6465 7820 6e6f 6e2d 6173 6369 6920  index non-ascii 
-00003fe0: 6669 6c65 6e61 6d65 7320 7769 7468 2060  filenames with `
-00003ff0: 2d65 3264 600a 2a20 5769 6e64 6f77 733a  -e2d`.* Windows:
-00004000: 2070 7974 686f 6e20 322e 3720 6361 6e6e   python 2.7 cann
-00004010: 6f74 2068 616e 646c 6520 6669 6c65 6e61  ot handle filena
-00004020: 6d65 7320 7769 7468 206d 6f6a 6962 616b  mes with mojibak
-00004030: 650a 2a20 602d 2d74 682d 6666 2d6a 7067  e.* `--th-ff-jpg
-00004040: 6020 6d61 7920 6669 7820 7669 6465 6f20  ` may fix video 
-00004050: 7468 756d 626e 6169 6c73 206f 6e20 736f  thumbnails on so
-00004060: 6d65 2046 466d 7065 6720 7665 7273 696f  me FFmpeg versio
-00004070: 6e73 2028 6d61 636f 732c 2073 6f6d 6520  ns (macos, some 
-00004080: 6c69 6e75 7829 0a2a 2060 2d2d 7468 2d66  linux).* `--th-f
-00004090: 662d 7377 7260 206d 6179 2066 6978 2061  f-swr` may fix a
-000040a0: 7564 696f 2074 6875 6d62 6e61 696c 7320  udio thumbnails 
-000040b0: 6f6e 2073 6f6d 6520 4646 6d70 6567 2076  on some FFmpeg v
-000040c0: 6572 7369 6f6e 730a 0a23 2320 6765 6e65  ersions..## gene
-000040d0: 7261 6c20 6275 6773 0a0a 2a20 5769 6e64  ral bugs..* Wind
-000040e0: 6f77 733a 2069 6620 7468 6520 6075 7032  ows: if the `up2
-000040f0: 6b2e 6462 6020 2866 696c 6573 7973 7465  k.db` (filesyste
-00004100: 6d20 696e 6465 7829 2069 7320 6f6e 2061  m index) is on a
-00004110: 2073 616d 6261 2d73 6861 7265 206f 7220   samba-share or 
-00004120: 6e65 7477 6f72 6b20 6469 736b 2c20 796f  network disk, yo
-00004130: 7527 6c6c 2067 6574 2075 6e70 7265 6469  u'll get unpredi
-00004140: 6374 6162 6c65 2062 6568 6176 696f 7220  ctable behavior 
-00004150: 6966 2074 6865 2073 6861 7265 2069 7320  if the share is 
-00004160: 6469 7363 6f6e 6e65 6374 6564 2066 6f72  disconnected for
-00004170: 2061 2062 6974 0a20 202a 2075 7365 2060   a bit.  * use `
-00004180: 2d2d 6869 7374 6020 6f72 2074 6865 2060  --hist` or the `
-00004190: 6869 7374 6020 766f 6c66 6c61 6720 2860  hist` volflag (`
-000041a0: 2d76 205b 2e2e 2e5d 3a63 2c68 6973 743d  -v [...]:c,hist=
-000041b0: 2f74 6d70 2f66 6f6f 6029 2074 6f20 706c  /tmp/foo`) to pl
-000041c0: 6163 6520 7468 6520 6462 206f 6e20 6120  ace the db on a 
-000041d0: 6c6f 6361 6c20 6469 736b 2069 6e73 7465  local disk inste
-000041e0: 6164 0a2a 2061 6c6c 2076 6f6c 756d 6573  ad.* all volumes
-000041f0: 206d 7573 7420 6578 6973 7420 2f20 6265   must exist / be
-00004200: 2061 7661 696c 6162 6c65 206f 6e20 7374   available on st
-00004210: 6172 7475 703b 2075 7032 6b20 286d 7470  artup; up2k (mtp
-00004220: 2065 7370 6563 6961 6c6c 7929 2067 6574   especially) get
-00004230: 7320 6675 6e6b 7920 6f74 6865 7277 6973  s funky otherwis
-00004240: 650a 2a20 7072 6f62 6162 6c79 206d 6f72  e.* probably mor
-00004250: 652c 2070 6c73 206c 6574 206d 6520 6b6e  e, pls let me kn
-00004260: 6f77 0a0a 2323 206e 6f74 206d 7920 6275  ow..## not my bu
-00004270: 6773 0a0a 2a20 5b43 6872 6f6d 6520 6973  gs..* [Chrome is
-00004280: 7375 6520 3133 3137 3036 395d 2868 7474  sue 1317069](htt
-00004290: 7073 3a2f 2f62 7567 732e 6368 726f 6d69  ps://bugs.chromi
-000042a0: 756d 2e6f 7267 2f70 2f63 6872 6f6d 6975  um.org/p/chromiu
-000042b0: 6d2f 6973 7375 6573 2f64 6574 6169 6c3f  m/issues/detail?
-000042c0: 6964 3d31 3331 3730 3639 2920 2d2d 2069  id=1317069) -- i
-000042d0: 6620 796f 7520 7472 7920 746f 2075 706c  f you try to upl
-000042e0: 6f61 6420 6120 666f 6c64 6572 2077 6869  oad a folder whi
-000042f0: 6368 2063 6f6e 7461 696e 7320 7379 6d6c  ch contains syml
-00004300: 696e 6b73 2062 7920 6472 6167 6769 6e67  inks by dragging
-00004310: 2069 7420 696e 746f 2074 6865 2062 726f   it into the bro
-00004320: 7773 6572 2c20 7468 6520 7379 6d6c 696e  wser, the symlin
-00004330: 6b65 6420 6669 6c65 7320 7769 6c6c 206e  ked files will n
-00004340: 6f74 2067 6574 2075 706c 6f61 6465 640a  ot get uploaded.
-00004350: 0a2a 205b 4368 726f 6d65 2069 7373 7565  .* [Chrome issue
-00004360: 2031 3335 3232 3130 5d28 6874 7470 733a   1352210](https:
-00004370: 2f2f 6275 6773 2e63 6872 6f6d 6975 6d2e  //bugs.chromium.
-00004380: 6f72 672f 702f 6368 726f 6d69 756d 2f69  org/p/chromium/i
-00004390: 7373 7565 732f 6465 7461 696c 3f69 643d  ssues/detail?id=
-000043a0: 3133 3532 3231 3029 202d 2d20 706c 6169  1352210) -- plai
-000043b0: 6e74 6578 7420 6874 7470 206d 6179 2062  ntext http may b
-000043c0: 6520 6661 7374 6572 2061 7420 6669 6c65  e faster at file
-000043d0: 6861 7368 696e 6720 7468 616e 2068 7474  hashing than htt
-000043e0: 7073 2028 6275 7420 616c 736f 2065 7874  ps (but also ext
-000043f0: 7265 6d65 6c79 2043 5055 2d69 6e74 656e  remely CPU-inten
-00004400: 7369 7665 290a 0a2a 205b 4669 7265 666f  sive)..* [Firefo
-00004410: 7820 6973 7375 6520 3137 3930 3530 305d  x issue 1790500]
-00004420: 2868 7474 7073 3a2f 2f62 7567 7a69 6c6c  (https://bugzill
-00004430: 612e 6d6f 7a69 6c6c 612e 6f72 672f 7368  a.mozilla.org/sh
-00004440: 6f77 5f62 7567 2e63 6769 3f69 643d 3137  ow_bug.cgi?id=17
-00004450: 3930 3530 3029 202d 2d20 656e 7469 7265  90500) -- entire
-00004460: 2062 726f 7773 6572 2063 616e 2063 7261   browser can cra
-00004470: 7368 2061 6674 6572 2075 706c 6f61 6469  sh after uploadi
-00004480: 6e67 207e 3430 3030 2073 6d61 6c6c 2066  ng ~4000 small f
-00004490: 696c 6573 0a0a 2a20 6950 686f 6e65 733a  iles..* iPhones:
-000044a0: 2074 6865 2076 6f6c 756d 6520 636f 6e74   the volume cont
-000044b0: 726f 6c20 646f 6573 6e27 7420 776f 726b  rol doesn't work
-000044c0: 2062 6563 6175 7365 205b 6170 706c 6520   because [apple 
-000044d0: 646f 6573 6e27 7420 7761 6e74 2069 7420  doesn't want it 
-000044e0: 746f 5d28 6874 7470 733a 2f2f 6465 7665  to](https://deve
-000044f0: 6c6f 7065 722e 6170 706c 652e 636f 6d2f  loper.apple.com/
-00004500: 6c69 6272 6172 792f 6172 6368 6976 652f  library/archive/
-00004510: 646f 6375 6d65 6e74 6174 696f 6e2f 4175  documentation/Au
-00004520: 6469 6f56 6964 656f 2f43 6f6e 6365 7074  dioVideo/Concept
-00004530: 7561 6c2f 5573 696e 675f 4854 4d4c 355f  ual/Using_HTML5_
-00004540: 4175 6469 6f5f 5669 6465 6f2f 4465 7669  Audio_Video/Devi
-00004550: 6365 2d53 7065 6369 6669 6343 6f6e 7369  ce-SpecificConsi
-00004560: 6465 7261 7469 6f6e 732f 4465 7669 6365  derations/Device
-00004570: 2d53 7065 6369 6669 6343 6f6e 7369 6465  -SpecificConside
-00004580: 7261 7469 6f6e 732e 6874 6d6c 232f 2f61  rations.html#//a
-00004590: 7070 6c65 5f72 6566 2f64 6f63 2f75 6964  pple_ref/doc/uid
-000045a0: 2f54 5034 3030 3039 3532 332d 4348 352d  /TP40009523-CH5-
-000045b0: 5357 3131 290a 2020 2a20 2a66 7574 7572  SW11).  * *futur
-000045c0: 6520 776f 726b 6172 6f75 6e64 3a2a 2065  e workaround:* e
-000045d0: 6e61 626c 6520 7468 6520 6571 7561 6c69  nable the equali
-000045e0: 7a65 722c 206d 616b 6520 6974 2061 6c6c  zer, make it all
-000045f0: 2d7a 6572 6f2c 2061 6e64 2073 6574 2061  -zero, and set a
-00004600: 206e 6567 6174 6976 6520 626f 6f73 7420   negative boost 
-00004610: 746f 2072 6564 7563 6520 7468 6520 766f  to reduce the vo
-00004620: 6c75 6d65 0a20 2020 202a 2022 6675 7475  lume.    * "futu
-00004630: 7265 2220 6265 6361 7573 6520 6041 7564  re" because `Aud
-00004640: 696f 436f 6e74 6578 7460 2069 7320 6272  ioContext` is br
-00004650: 6f6b 656e 2069 6e20 7468 6520 6375 7272  oken in the curr
-00004660: 656e 7420 694f 5320 7665 7273 696f 6e20  ent iOS version 
-00004670: 2831 352e 3129 2c20 6d61 7962 6520 6f6e  (15.1), maybe on
-00004680: 6520 6461 792e 2e2e 0a0a 2a20 5769 6e64  e day.....* Wind
-00004690: 6f77 733a 2066 6f6c 6465 7273 2063 616e  ows: folders can
-000046a0: 6e6f 7420 6265 2061 6363 6573 7365 6420  not be accessed 
-000046b0: 6966 2074 6865 206e 616d 6520 656e 6473  if the name ends
-000046c0: 2077 6974 6820 602e 600a 2020 2a20 7079   with `.`.  * py
-000046d0: 7468 6f6e 206f 7220 7769 6e64 6f77 7320  thon or windows 
-000046e0: 6275 670a 0a2a 2057 696e 646f 7773 3a20  bug..* Windows: 
-000046f0: 6d73 7973 322d 7079 7468 6f6e 2033 2e38  msys2-python 3.8
-00004700: 2e36 206f 6363 6173 696f 6e61 6c6c 7920  .6 occasionally 
-00004710: 7468 726f 7773 2060 5275 6e74 696d 6545  throws `RuntimeE
-00004720: 7272 6f72 3a20 7265 6c65 6173 6520 756e  rror: release un
-00004730: 6c6f 636b 6564 206c 6f63 6b60 2077 6865  locked lock` whe
-00004740: 6e20 6c65 6176 696e 6720 6120 7363 6f70  n leaving a scop
-00004750: 6564 206d 7574 6578 2069 6e20 7570 326b  ed mutex in up2k
-00004760: 0a20 202a 2074 6869 7320 6973 2061 6e20  .  * this is an 
-00004770: 6d73 7973 3220 6275 672c 2074 6865 2072  msys2 bug, the r
-00004780: 6567 756c 6172 2077 696e 646f 7773 2065  egular windows e
-00004790: 6469 7469 6f6e 206f 6620 7079 7468 6f6e  dition of python
-000047a0: 2069 7320 6669 6e65 0a0a 2a20 5669 7274   is fine..* Virt
-000047b0: 7561 6c42 6f78 3a20 7371 6c69 7465 2074  ualBox: sqlite t
-000047c0: 6872 6f77 7320 6044 6973 6b20 492f 4f20  hrows `Disk I/O 
-000047d0: 4572 726f 7260 2077 6865 6e20 7275 6e6e  Error` when runn
-000047e0: 696e 6720 696e 2061 2056 4d20 616e 6420  ing in a VM and 
-000047f0: 7468 6520 7570 326b 2064 6174 6162 6173  the up2k databas
-00004800: 6520 6973 2069 6e20 6120 7662 6f78 7366  e is in a vboxsf
-00004810: 0a20 202a 2075 7365 2060 2d2d 6869 7374  .  * use `--hist
-00004820: 6020 6f72 2074 6865 2060 6869 7374 6020  ` or the `hist` 
-00004830: 766f 6c66 6c61 6720 2860 2d76 205b 2e2e  volflag (`-v [..
-00004840: 2e5d 3a63 2c68 6973 743d 2f74 6d70 2f66  .]:c,hist=/tmp/f
-00004850: 6f6f 6029 2074 6f20 706c 6163 6520 7468  oo`) to place th
-00004860: 6520 6462 2069 6e73 6964 6520 7468 6520  e db inside the 
-00004870: 766d 2069 6e73 7465 6164 0a0a 2a20 5562  vm instead..* Ub
-00004880: 756e 7475 3a20 6472 6167 6769 6e67 2066  untu: dragging f
-00004890: 696c 6573 2066 726f 6d20 6365 7274 6169  iles from certai
-000048a0: 6e20 666f 6c64 6572 7320 696e 746f 2066  n folders into f
-000048b0: 6972 6566 6f78 206f 7220 6368 726f 6d65  irefox or chrome
-000048c0: 2069 7320 696d 706f 7373 6962 6c65 0a20   is impossible. 
-000048d0: 202a 2064 7565 2074 6f20 736e 6170 2073   * due to snap s
-000048e0: 6563 7572 6974 7920 706f 6c69 6369 6573  ecurity policies
-000048f0: 202d 2d20 7365 6520 6073 6e61 7020 636f   -- see `snap co
-00004900: 6e6e 6563 7469 6f6e 7320 6669 7265 666f  nnections firefo
-00004910: 7860 2066 6f72 2074 6865 2061 6c6c 6f77  x` for the allow
-00004920: 6c69 7374 2c20 6072 656d 6f76 6162 6c65  list, `removable
-00004930: 2d6d 6564 6961 6020 7065 726d 6974 7320  -media` permits 
-00004940: 616c 6c20 6f66 2060 2f6d 6e74 6020 616e  all of `/mnt` an
-00004950: 6420 602f 6d65 6469 6160 2061 7070 6172  d `/media` appar
-00004960: 656e 746c 790a 0a0a 2320 6272 6561 6b69  ently...# breaki
-00004970: 6e67 2063 6861 6e67 6573 0a0a 7570 6772  ng changes..upgr
-00004980: 6164 6520 6e6f 7465 730a 0a2a 2060 312e  ade notes..* `1.
-00004990: 362e 3060 2028 3230 3233 2d30 312d 3239  6.0` (2023-01-29
-000049a0: 293a 0a20 202a 2068 7474 702d 6170 693a  ):.  * http-api:
-000049b0: 2064 656c 6574 652f 6d6f 7665 2069 7320   delete/move is 
-000049c0: 6e6f 7720 6050 4f53 5460 2069 6e73 7465  now `POST` inste
-000049d0: 6164 206f 6620 6047 4554 600a 2020 2a20  ad of `GET`.  * 
-000049e0: 6576 6572 7974 6869 6e67 206f 7468 6572  everything other
-000049f0: 2074 6861 6e20 6047 4554 6020 616e 6420   than `GET` and 
-00004a00: 6048 4541 4460 206d 7573 7420 7061 7373  `HEAD` must pass
-00004a10: 205b 636f 7273 2076 616c 6964 6174 696f   [cors validatio
-00004a20: 6e5d 2823 636f 7273 290a 2a20 6031 2e35  n](#cors).* `1.5
-00004a30: 2e30 6020 2832 3032 322d 3132 2d30 3329  .0` (2022-12-03)
-00004a40: 3a20 5b6e 6577 2063 6875 6e6b 7369 7a65  : [new chunksize
-00004a50: 2066 6f72 6d75 6c61 5d28 6874 7470 733a   formula](https:
-00004a60: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
-00004a70: 312f 636f 7079 7061 7274 792f 636f 6d6d  1/copyparty/comm
-00004a80: 6974 2f35 3465 3163 3864 3236 3164 6629  it/54e1c8d261df)
-00004a90: 2066 6f72 2066 696c 6573 206c 6172 6765   for files large
-00004aa0: 7220 7468 616e 2031 3238 2047 6942 0a20  r than 128 GiB. 
-00004ab0: 202a 202a 2a75 7365 7273 3a2a 2a20 7570   * **users:** up
-00004ac0: 6772 6164 6520 746f 2074 6865 206c 6174  grade to the lat
-00004ad0: 6573 7420 5b63 6c69 2075 706c 6f61 6465  est [cli uploade
-00004ae0: 725d 2868 7474 7073 3a2f 2f67 6974 6875  r](https://githu
-00004af0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00004b00: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-00004b10: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00004b20: 7929 2069 6620 796f 7520 7573 6520 7468  y) if you use th
-00004b30: 6174 0a20 202a 202a 2a64 6576 733a 2a2a  at.  * **devs:**
-00004b40: 2075 7064 6174 6520 7468 6972 642d 7061   update third-pa
-00004b50: 7274 7920 7570 326b 2063 6c69 656e 7473  rty up2k clients
-00004b60: 2028 6966 2074 686f 7365 2065 7665 6e20   (if those even 
-00004b70: 6578 6973 7429 0a0a 0a23 2046 4151 0a0a  exist)...# FAQ..
-00004b80: 2266 7265 7175 656e 746c 7922 2061 736b  "frequently" ask
-00004b90: 6564 2071 7565 7374 696f 6e73 0a0a 2a20  ed questions..* 
-00004ba0: 6973 2069 7420 706f 7373 6962 6c65 2074  is it possible t
-00004bb0: 6f20 626c 6f63 6b20 7265 6164 2d61 6363  o block read-acc
-00004bc0: 6573 7320 746f 2066 6f6c 6465 7273 2075  ess to folders u
-00004bd0: 6e6c 6573 7320 796f 7520 6b6e 6f77 2074  nless you know t
-00004be0: 6865 2065 7861 6374 2055 524c 2066 6f72  he exact URL for
-00004bf0: 2061 2070 6172 7469 6375 6c61 7220 6669   a particular fi
-00004c00: 6c65 2069 6e73 6964 653f 0a20 202a 2079  le inside?.  * y
-00004c10: 6573 2c20 7573 696e 6720 7468 6520 5b60  es, using the [`
-00004c20: 6760 2070 6572 6d69 7373 696f 6e5d 2823  g` permission](#
-00004c30: 6163 636f 756e 7473 2d61 6e64 2d76 6f6c  accounts-and-vol
-00004c40: 756d 6573 292c 2073 6565 2074 6865 2065  umes), see the e
-00004c50: 7861 6d70 6c65 7320 7468 6572 650a 2020  xamples there.  
-00004c60: 2a20 796f 7520 6361 6e20 616c 736f 2064  * you can also d
-00004c70: 6f20 7468 6973 2077 6974 6820 6c69 6e75  o this with linu
-00004c80: 7820 6669 6c65 7379 7374 656d 2070 6572  x filesystem per
-00004c90: 6d69 7373 696f 6e73 3b20 6063 686d 6f64  missions; `chmod
-00004ca0: 2031 3131 206d 7573 6963 6020 7769 6c6c   111 music` will
-00004cb0: 206d 616b 6520 6974 2070 6f73 7369 626c   make it possibl
-00004cc0: 6520 746f 2061 6363 6573 7320 6669 6c65  e to access file
-00004cd0: 7320 616e 6420 666f 6c64 6572 7320 696e  s and folders in
-00004ce0: 7369 6465 2074 6865 2060 6d75 7369 6360  side the `music`
-00004cf0: 2066 6f6c 6465 7220 6275 7420 6e6f 7420   folder but not 
-00004d00: 6c69 7374 2074 6865 2069 6d6d 6564 6961  list the immedia
-00004d10: 7465 2063 6f6e 7465 6e74 7320 2d2d 2061  te contents -- a
-00004d20: 6c73 6f20 776f 726b 7320 7769 7468 206f  lso works with o
-00004d30: 7468 6572 2073 6f66 7477 6172 652c 206e  ther software, n
-00004d40: 6f74 206a 7573 7420 636f 7079 7061 7274  ot just copypart
-00004d50: 790a 0a2a 2063 616e 2049 206d 616b 6520  y..* can I make 
-00004d60: 636f 7079 7061 7274 7920 646f 776e 6c6f  copyparty downlo
-00004d70: 6164 2061 2066 696c 6520 746f 206d 7920  ad a file to my 
-00004d80: 7365 7276 6572 2069 6620 4920 6769 7665  server if I give
-00004d90: 2069 7420 6120 5552 4c3f 0a20 202a 2079   it a URL?.  * y
-00004da0: 6573 2c20 7573 696e 6720 5b68 6f6f 6b73  es, using [hooks
-00004db0: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-00004dc0: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
-00004dd0: 7274 792f 626c 6f62 2f68 6f76 7564 7374  rty/blob/hovudst
-00004de0: 7261 756d 2f62 696e 2f68 6f6f 6b73 2f77  raum/bin/hooks/w
-00004df0: 6765 742e 7079 290a 0a0a 2320 6163 636f  get.py)...# acco
-00004e00: 756e 7473 2061 6e64 2076 6f6c 756d 6573  unts and volumes
-00004e10: 0a0a 7065 722d 666f 6c64 6572 2c20 7065  ..per-folder, pe
-00004e20: 722d 7573 6572 2070 6572 6d69 7373 696f  r-user permissio
-00004e30: 6e73 2020 2d20 6966 2079 6f75 7220 7365  ns  - if your se
-00004e40: 7475 7020 6973 2067 6574 7469 6e67 2063  tup is getting c
-00004e50: 6f6d 706c 6578 2c20 636f 6e73 6964 6572  omplex, consider
-00004e60: 206d 616b 696e 6720 6120 5b63 6f6e 6669   making a [confi
-00004e70: 6720 6669 6c65 5d28 2e2f 646f 6373 2f65  g file](./docs/e
-00004e80: 7861 6d70 6c65 2e63 6f6e 6629 2069 6e73  xample.conf) ins
-00004e90: 7465 6164 206f 6620 7573 696e 6720 6172  tead of using ar
-00004ea0: 6775 6d65 6e74 730a 2a20 6d75 6368 2065  guments.* much e
-00004eb0: 6173 6965 7220 746f 206d 616e 6167 652c  asier to manage,
-00004ec0: 2061 6e64 2079 6f75 2063 616e 206d 6f64   and you can mod
-00004ed0: 6966 7920 7468 6520 636f 6e66 6967 2061  ify the config a
-00004ee0: 7420 7275 6e74 696d 6520 7769 7468 2060  t runtime with `
-00004ef0: 7379 7374 656d 6374 6c20 7265 6c6f 6164  systemctl reload
-00004f00: 2063 6f70 7970 6172 7479 6020 6f72 206d   copyparty` or m
-00004f10: 6f72 6520 636f 6e76 656e 6965 6e74 6c79  ore conveniently
-00004f20: 2075 7369 6e67 2074 6865 2060 5b72 656c   using the `[rel
-00004f30: 6f61 6420 6366 675d 6020 6275 7474 6f6e  oad cfg]` button
-00004f40: 2069 6e20 7468 6520 636f 6e74 726f 6c2d   in the control-
-00004f50: 7061 6e65 6c20 2869 6620 6c6f 6767 6564  panel (if logged
-00004f60: 2069 6e20 6173 2061 646d 696e 290a 2020   in as admin).  
-00004f70: 2a20 6368 616e 6765 7320 746f 2074 6865  * changes to the
-00004f80: 2060 5b67 6c6f 6261 6c5d 6020 636f 6e66   `[global]` conf
-00004f90: 6967 2073 6563 7469 6f6e 2072 6571 7569  ig section requi
-00004fa0: 7265 7320 6120 7265 7374 6172 7420 746f  res a restart to
-00004fb0: 2074 616b 6520 6566 6665 6374 0a0a 6120   take effect..a 
-00004fc0: 7175 6963 6b20 7375 6d6d 6172 7920 6361  quick summary ca
-00004fd0: 6e20 6265 2073 6565 6e20 7573 696e 6720  n be seen using 
-00004fe0: 602d 2d68 656c 702d 6163 636f 756e 7473  `--help-accounts
-00004ff0: 600a 0a63 6f6e 6669 6775 7269 6e67 2061  `..configuring a
-00005000: 6363 6f75 6e74 732f 766f 6c75 6d65 7320  ccounts/volumes 
-00005010: 7769 7468 2061 7267 756d 656e 7473 3a0a  with arguments:.
-00005020: 2a20 602d 6120 7573 723a 7077 6460 2061  * `-a usr:pwd` a
-00005030: 6464 7320 6163 636f 756e 7420 6075 7372  dds account `usr
-00005040: 6020 7769 7468 2070 6173 7377 6f72 6420  ` with password 
-00005050: 6070 7764 600a 2a20 602d 7620 2e3a 3a72  `pwd`.* `-v .::r
-00005060: 6020 6164 6473 2063 7572 7265 6e74 2d66  ` adds current-f
-00005070: 6f6c 6465 7220 602e 6020 6173 2074 6865  older `.` as the
-00005080: 2077 6562 726f 6f74 2c20 6072 6065 6164   webroot, `r`ead
-00005090: 6162 6c65 2062 7920 616e 796f 6e65 0a20  able by anyone. 
-000050a0: 202a 2074 6865 2073 796e 7461 7820 6973   * the syntax is
-000050b0: 2060 2d76 2073 7263 3a64 7374 3a70 6572   `-v src:dst:per
-000050c0: 6d3a 7065 726d 3a2e 2e2e 6020 736f 206c  m:perm:...` so l
-000050d0: 6f63 616c 2d70 6174 682c 2075 726c 2d70  ocal-path, url-p
-000050e0: 6174 682c 2061 6e64 206f 6e65 206f 7220  ath, and one or 
-000050f0: 6d6f 7265 2070 6572 6d69 7373 696f 6e73  more permissions
-00005100: 2074 6f20 7365 740a 2020 2a20 6772 616e   to set.  * gran
-00005110: 7469 6e67 2074 6865 2073 616d 6520 7065  ting the same pe
-00005120: 726d 6973 7369 6f6e 7320 746f 206d 756c  rmissions to mul
-00005130: 7469 706c 6520 6163 636f 756e 7473 3a20  tiple accounts: 
-00005140: 200a 2020 2020 602d 7620 2e3a 3a72 2c75   .    `-v .::r,u
-00005150: 7372 312c 7573 7232 3a72 772c 7573 7233  sr1,usr2:rw,usr3
-00005160: 2c75 7372 3460 203d 2075 7372 312f 3220  ,usr4` = usr1/2 
-00005170: 7265 6164 2d6f 6e6c 792c 2033 2f34 2072  read-only, 3/4 r
-00005180: 6561 642d 7772 6974 650a 0a70 6572 6d69  ead-write..permi
-00005190: 7373 696f 6e73 3a0a 2a20 6072 6020 2872  ssions:.* `r` (r
-000051a0: 6561 6429 3a20 6272 6f77 7365 2066 6f6c  ead): browse fol
-000051b0: 6465 7220 636f 6e74 656e 7473 2c20 646f  der contents, do
-000051c0: 776e 6c6f 6164 2066 696c 6573 2c20 646f  wnload files, do
-000051d0: 776e 6c6f 6164 2061 7320 7a69 702f 7461  wnload as zip/ta
-000051e0: 720a 2a20 6077 6020 2877 7269 7465 293a  r.* `w` (write):
-000051f0: 2075 706c 6f61 6420 6669 6c65 732c 206d   upload files, m
-00005200: 6f76 6520 6669 6c65 7320 2a69 6e74 6f2a  ove files *into*
-00005210: 2074 6869 7320 666f 6c64 6572 0a2a 2060   this folder.* `
-00005220: 6d60 2028 6d6f 7665 293a 206d 6f76 6520  m` (move): move 
-00005230: 6669 6c65 732f 666f 6c64 6572 7320 2a66  files/folders *f
-00005240: 726f 6d2a 2074 6869 7320 666f 6c64 6572  rom* this folder
-00005250: 0a2a 2060 6460 2028 6465 6c65 7465 293a  .* `d` (delete):
-00005260: 2064 656c 6574 6520 6669 6c65 732f 666f   delete files/fo
-00005270: 6c64 6572 730a 2a20 6067 6020 2867 6574  lders.* `g` (get
-00005280: 293a 206f 6e6c 7920 646f 776e 6c6f 6164  ): only download
-00005290: 2066 696c 6573 2c20 6361 6e6e 6f74 2073   files, cannot s
-000052a0: 6565 2066 6f6c 6465 7220 636f 6e74 656e  ee folder conten
-000052b0: 7473 206f 7220 7a69 702f 7461 720a 2a20  ts or zip/tar.* 
-000052c0: 6047 6020 2875 7067 6574 293a 2073 616d  `G` (upget): sam
-000052d0: 6520 6173 2060 6760 2065 7863 6570 7420  e as `g` except 
-000052e0: 7570 6c6f 6164 6572 7320 6765 7420 746f  uploaders get to
-000052f0: 2073 6565 2074 6865 6972 206f 776e 2066   see their own f
-00005300: 696c 656b 6579 7320 2873 6565 2060 666b  ilekeys (see `fk
-00005310: 6020 696e 2065 7861 6d70 6c65 7320 6265  ` in examples be
-00005320: 6c6f 7729 0a0a 6578 616d 706c 6573 3a0a  low)..examples:.
-00005330: 2a20 6164 6420 6163 636f 756e 7473 206e  * add accounts n
-00005340: 616d 6564 2075 312c 2075 322c 2075 3320  amed u1, u2, u3 
-00005350: 7769 7468 2070 6173 7377 6f72 6473 2070  with passwords p
-00005360: 312c 2070 322c 2070 333a 2060 2d61 2075  1, p2, p3: `-a u
-00005370: 313a 7031 202d 6120 7532 3a70 3220 2d61  1:p1 -a u2:p2 -a
-00005380: 2075 333a 7033 600a 2a20 6d61 6b65 2066   u3:p3`.* make f
-00005390: 6f6c 6465 7220 602f 7372 7660 2074 6865  older `/srv` the
-000053a0: 2072 6f6f 7420 6f66 2074 6865 2066 696c   root of the fil
-000053b0: 6573 7973 7465 6d2c 2072 6561 642d 6f6e  esystem, read-on
-000053c0: 6c79 2062 7920 616e 796f 6e65 3a20 602d  ly by anyone: `-
-000053d0: 7620 2f73 7276 3a3a 7260 0a2a 206d 616b  v /srv::r`.* mak
-000053e0: 6520 666f 6c64 6572 2060 2f6d 6e74 2f6d  e folder `/mnt/m
-000053f0: 7573 6963 6020 6176 6169 6c61 626c 6520  usic` available 
-00005400: 6174 2060 2f6d 7573 6963 602c 2072 6561  at `/music`, rea
-00005410: 642d 6f6e 6c79 2066 6f72 2075 3120 616e  d-only for u1 an
-00005420: 6420 7532 2c20 7265 6164 2d77 7269 7465  d u2, read-write
-00005430: 2066 6f72 2075 333a 2060 2d76 202f 6d6e   for u3: `-v /mn
-00005440: 742f 6d75 7369 633a 6d75 7369 633a 722c  t/music:music:r,
-00005450: 7531 2c75 323a 7277 2c75 3360 0a20 202a  u1,u2:rw,u3`.  *
-00005460: 2075 6e61 7574 686f 7269 7a65 6420 7573   unauthorized us
-00005470: 6572 7320 6163 6365 7373 696e 6720 7468  ers accessing th
-00005480: 6520 7765 6272 6f6f 7420 6361 6e20 7365  e webroot can se
-00005490: 6520 7468 6174 2074 6865 2060 6d75 7369  e that the `musi
-000054a0: 6360 2066 6f6c 6465 7220 6578 6973 7473  c` folder exists
-000054b0: 2c20 6275 7420 6361 6e6e 6f74 206f 7065  , but cannot ope
-000054c0: 6e20 6974 0a2a 206d 616b 6520 666f 6c64  n it.* make fold
-000054d0: 6572 2060 2f6d 6e74 2f69 6e63 6f6d 696e  er `/mnt/incomin
-000054e0: 6760 2061 7661 696c 6162 6c65 2061 7420  g` available at 
-000054f0: 602f 696e 6360 2c20 7772 6974 652d 6f6e  `/inc`, write-on
-00005500: 6c79 2066 6f72 2075 312c 2072 6561 642d  ly for u1, read-
-00005510: 6d6f 7665 2066 6f72 2075 323a 2060 2d76  move for u2: `-v
-00005520: 202f 6d6e 742f 696e 636f 6d69 6e67 3a69   /mnt/incoming:i
-00005530: 6e63 3a77 2c75 313a 726d 2c75 3260 0a20  nc:w,u1:rm,u2`. 
-00005540: 202a 2075 6e61 7574 686f 7269 7a65 6420   * unauthorized 
-00005550: 7573 6572 7320 6163 6365 7373 696e 6720  users accessing 
-00005560: 7468 6520 7765 6272 6f6f 7420 6361 6e20  the webroot can 
-00005570: 7365 6520 7468 6174 2074 6865 2060 696e  see that the `in
-00005580: 6360 2066 6f6c 6465 7220 6578 6973 7473  c` folder exists
-00005590: 2c20 6275 7420 6361 6e6e 6f74 206f 7065  , but cannot ope
-000055a0: 6e20 6974 0a20 202a 2060 7531 6020 6361  n it.  * `u1` ca
-000055b0: 6e20 6f70 656e 2074 6865 2060 696e 6360  n open the `inc`
-000055c0: 2066 6f6c 6465 722c 2062 7574 2063 616e   folder, but can
-000055d0: 6e6f 7420 7365 6520 7468 6520 636f 6e74  not see the cont
-000055e0: 656e 7473 2c20 6f6e 6c79 2075 706c 6f61  ents, only uploa
-000055f0: 6420 6e65 7720 6669 6c65 7320 746f 2069  d new files to i
-00005600: 740a 2020 2a20 6075 3260 2063 616e 2062  t.  * `u2` can b
-00005610: 726f 7773 6520 6974 2061 6e64 206d 6f76  rowse it and mov
-00005620: 6520 6669 6c65 7320 2a66 726f 6d2a 2060  e files *from* `
-00005630: 2f69 6e63 6020 696e 746f 2061 6e79 2066  /inc` into any f
-00005640: 6f6c 6465 7220 7768 6572 6520 6075 3260  older where `u2`
-00005650: 2068 6173 2077 7269 7465 2d61 6363 6573   has write-acces
-00005660: 730a 2a20 6d61 6b65 2066 6f6c 6465 7220  s.* make folder 
-00005670: 602f 6d6e 742f 7373 6020 6176 6169 6c61  `/mnt/ss` availa
-00005680: 626c 6520 6174 2060 2f69 602c 2072 6561  ble at `/i`, rea
-00005690: 642d 7772 6974 6520 666f 7220 7531 2c20  d-write for u1, 
-000056a0: 6765 742d 6f6e 6c79 2066 6f72 2065 7665  get-only for eve
-000056b0: 7279 6f6e 6520 656c 7365 2c20 616e 6420  ryone else, and 
-000056c0: 656e 6162 6c65 2066 696c 656b 6579 733a  enable filekeys:
-000056d0: 2060 2d76 202f 6d6e 742f 7373 3a69 3a72   `-v /mnt/ss:i:r
-000056e0: 772c 7531 3a67 3a63 2c66 6b3d 3460 0a20  w,u1:g:c,fk=4`. 
-000056f0: 202a 2060 632c 666b 3d34 6020 7365 7473   * `c,fk=4` sets
-00005700: 2074 6865 2060 666b 6020 2866 696c 656b   the `fk` (filek
-00005710: 6579 2920 766f 6c66 6c61 6720 746f 2034  ey) volflag to 4
-00005720: 2c20 6d65 616e 696e 6720 6561 6368 2066  , meaning each f
-00005730: 696c 6520 6765 7473 2061 2034 2d63 6861  ile gets a 4-cha
-00005740: 7261 6374 6572 2061 6363 6573 736b 6579  racter accesskey
-00005750: 0a20 202a 2060 7531 6020 6361 6e20 7570  .  * `u1` can up
-00005760: 6c6f 6164 2066 696c 6573 2c20 6272 6f77  load files, brow
-00005770: 7365 2074 6865 2066 6f6c 6465 722c 2061  se the folder, a
-00005780: 6e64 2073 6565 2074 6865 2067 656e 6572  nd see the gener
-00005790: 6174 6564 2066 696c 656b 6579 730a 2020  ated filekeys.  
-000057a0: 2a20 6f74 6865 7220 7573 6572 7320 6361  * other users ca
-000057b0: 6e6e 6f74 2062 726f 7773 6520 7468 6520  nnot browse the 
-000057c0: 666f 6c64 6572 2c20 6275 7420 6361 6e20  folder, but can 
-000057d0: 6163 6365 7373 2074 6865 2066 696c 6573  access the files
-000057e0: 2069 6620 7468 6579 2068 6176 6520 7468   if they have th
-000057f0: 6520 6675 6c6c 2066 696c 6520 5552 4c20  e full file URL 
-00005800: 7769 7468 2074 6865 2066 696c 656b 6579  with the filekey
-00005810: 0a20 202a 2072 6570 6c61 6369 6e67 2074  .  * replacing t
-00005820: 6865 2060 6760 2070 6572 6d69 7373 696f  he `g` permissio
-00005830: 6e20 7769 7468 2060 7767 6020 776f 756c  n with `wg` woul
-00005840: 6420 6c65 7420 616e 6f6e 796d 6f75 7320  d let anonymous 
-00005850: 7573 6572 7320 7570 6c6f 6164 2066 696c  users upload fil
-00005860: 6573 2c20 6275 7420 6e6f 7420 7365 6520  es, but not see 
-00005870: 7468 6520 7265 7175 6972 6564 2066 696c  the required fil
-00005880: 656b 6579 2074 6f20 6163 6365 7373 2069  ekey to access i
-00005890: 740a 2020 2a20 7265 706c 6163 696e 6720  t.  * replacing 
-000058a0: 7468 6520 6067 6020 7065 726d 6973 7369  the `g` permissi
-000058b0: 6f6e 2077 6974 6820 6077 4760 2077 6f75  on with `wG` wou
-000058c0: 6c64 206c 6574 2061 6e6f 6e79 6d6f 7573  ld let anonymous
-000058d0: 2075 7365 7273 2075 706c 6f61 6420 6669   users upload fi
-000058e0: 6c65 732c 2072 6563 6569 7669 6e67 2061  les, receiving a
-000058f0: 2077 6f72 6b69 6e67 2064 6972 6563 7420   working direct 
-00005900: 6c69 6e6b 2069 6e20 7265 7475 726e 0a0a  link in return..
-00005910: 616e 796f 6e65 2074 7279 696e 6720 746f  anyone trying to
-00005920: 2062 7275 7465 666f 7263 6520 6120 7061   bruteforce a pa
-00005930: 7373 776f 7264 2067 6574 7320 6261 6e6e  ssword gets bann
-00005940: 6564 2061 6363 6f72 6469 6e67 2074 6f20  ed according to 
-00005950: 602d 2d62 616e 2d70 7760 3b20 6465 6661  `--ban-pw`; defa
-00005960: 756c 7420 6973 2032 3468 2062 616e 2066  ult is 24h ban f
-00005970: 6f72 2039 2066 6169 6c65 6420 6174 7465  or 9 failed atte
-00005980: 6d70 7473 2069 6e20 3120 686f 7572 0a0a  mpts in 1 hour..
-00005990: 0a23 2320 7368 6164 6f77 696e 670a 0a68  .## shadowing..h
-000059a0: 6964 696e 6720 7370 6563 6966 6963 2073  iding specific s
-000059b0: 7562 666f 6c64 6572 7320 2062 7920 6d6f  ubfolders  by mo
-000059c0: 756e 7469 6e67 2061 6e6f 7468 6572 2076  unting another v
-000059d0: 6f6c 756d 6520 6f6e 2074 6f70 206f 6620  olume on top of 
-000059e0: 7468 656d 0a0a 666f 7220 6578 616d 706c  them..for exampl
-000059f0: 6520 602d 7620 2f6d 6e74 3a3a 7220 2d76  e `-v /mnt::r -v
-00005a00: 202f 7661 722f 656d 7074 793a 7765 622f   /var/empty:web/
-00005a10: 6365 7274 733a 7260 206d 6f75 6e74 7320  certs:r` mounts 
-00005a20: 7468 6520 7365 7276 6572 2066 6f6c 6465  the server folde
-00005a30: 7220 602f 6d6e 7460 2061 7320 7468 6520  r `/mnt` as the 
-00005a40: 7765 6272 6f6f 742c 2062 7574 2061 6e6f  webroot, but ano
-00005a50: 7468 6572 2076 6f6c 756d 6520 6973 206d  ther volume is m
-00005a60: 6f75 6e74 6564 2061 7420 602f 7765 622f  ounted at `/web/
-00005a70: 6365 7274 7360 202d 2d20 736f 2076 6973  certs` -- so vis
-00005a80: 6974 6f72 7320 6361 6e20 6f6e 6c79 2073  itors can only s
-00005a90: 6565 2074 6865 2063 6f6e 7465 6e74 7320  ee the contents 
-00005aa0: 6f66 2060 2f6d 6e74 6020 616e 6420 602f  of `/mnt` and `/
-00005ab0: 6d6e 742f 7765 6260 2028 6174 2055 524c  mnt/web` (at URL
-00005ac0: 7320 602f 6020 616e 6420 602f 7765 6260  s `/` and `/web`
-00005ad0: 292c 2062 7574 206e 6f74 2060 2f6d 6e74  ), but not `/mnt
-00005ae0: 2f77 6562 2f63 6572 7473 6020 6265 6361  /web/certs` beca
-00005af0: 7573 6520 5552 4c20 602f 7765 622f 6365  use URL `/web/ce
-00005b00: 7274 7360 2069 7320 6d61 7070 6564 2074  rts` is mapped t
-00005b10: 6f20 602f 7661 722f 656d 7074 7960 0a0a  o `/var/empty`..
-00005b20: 0a23 2074 6865 2062 726f 7773 6572 0a0a  .# the browser..
-00005b30: 6163 6365 7373 696e 6720 6120 636f 7079  accessing a copy
-00005b40: 7061 7274 7920 7365 7276 6572 2075 7369  party server usi
-00005b50: 6e67 2061 2077 6562 2d62 726f 7773 6572  ng a web-browser
-00005b60: 0a0a 215b 636f 7079 7061 7274 792d 6272  ..![copyparty-br
-00005b70: 6f77 7365 722d 6673 385d 2868 7474 7073  owser-fs8](https
-00005b80: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-00005b90: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-00005ba0: 2e63 6f6d 2f32 3431 3033 322f 3139 3230  .com/241032/1920
-00005bb0: 3432 3639 352d 3532 3262 3365 6337 2d36  42695-522b3ec7-6
-00005bc0: 3834 352d 3439 3461 2d61 6264 622d 6431  845-494a-abdb-d1
-00005bd0: 6330 6430 6532 3338 3031 2e70 6e67 290a  c0d0e23801.png).
-00005be0: 0a0a 2323 2074 6162 730a 0a74 6865 206d  ..## tabs..the m
-00005bf0: 6169 6e20 7461 6273 2069 6e20 7468 6520  ain tabs in the 
-00005c00: 7569 0a2a 2060 5bf0 9f94 8e5d 6020 5b73  ui.* `[....]` [s
-00005c10: 6561 7263 685d 2823 7365 6172 6368 696e  earch](#searchin
-00005c20: 6729 2062 7920 7369 7a65 2c20 6461 7465  g) by size, date
-00005c30: 2c20 7061 7468 2f6e 616d 652c 206d 7033  , path/name, mp3
-00005c40: 2d74 6167 7320 2e2e 2e0a 2a20 605b f09f  -tags ....* `[..
-00005c50: a7af 5d60 205b 756e 706f 7374 5d28 2375  ..]` [unpost](#u
-00005c60: 6e70 6f73 7429 3a20 756e 646f 2f64 656c  npost): undo/del
-00005c70: 6574 6520 6163 6369 6465 6e74 616c 2075  ete accidental u
-00005c80: 706c 6f61 6473 0a2a 2060 5bf0 9f9a 805d  ploads.* `[....]
-00005c90: 6020 616e 6420 605b f09f 8e88 5d60 2061  ` and `[....]` a
-00005ca0: 7265 2074 6865 205b 7570 6c6f 6164 6572  re the [uploader
-00005cb0: 735d 2823 7570 6c6f 6164 696e 6729 0a2a  s](#uploading).*
-00005cc0: 2060 5bf0 9f93 825d 6020 6d6b 6469 723a   `[....]` mkdir:
-00005cd0: 2063 7265 6174 6520 6469 7265 6374 6f72   create director
-00005ce0: 6965 730a 2a20 605b f09f 939d 5d60 206e  ies.* `[....]` n
-00005cf0: 6577 2d6d 643a 2063 7265 6174 6520 6120  ew-md: create a 
-00005d00: 6e65 7720 6d61 726b 646f 776e 2064 6f63  new markdown doc
-00005d10: 756d 656e 740a 2a20 605b f09f 939f 5d60  ument.* `[....]`
-00005d20: 2073 656e 642d 6d73 673a 2065 6974 6865   send-msg: eithe
-00005d30: 7220 746f 2073 6572 7665 722d 6c6f 6720  r to server-log 
-00005d40: 6f72 2069 6e74 6f20 7465 7874 6669 6c65  or into textfile
-00005d50: 7320 6966 2060 2d2d 7572 6c66 6f72 6d20  s if `--urlform 
-00005d60: 7361 7665 600a 2a20 605b f09f 8eba 5d60  save`.* `[....]`
-00005d70: 2061 7564 696f 2d70 6c61 7965 7220 636f   audio-player co
-00005d80: 6e66 6967 206f 7074 696f 6e73 0a2a 2060  nfig options.* `
-00005d90: 5be2 9a99 efb8 8f5d 6020 6765 6e65 7261  [......]` genera
-00005da0: 6c20 636c 6965 6e74 2063 6f6e 6669 6720  l client config 
-00005db0: 6f70 7469 6f6e 730a 0a0a 2323 2068 6f74  options...## hot
-00005dc0: 6b65 7973 0a0a 7468 6520 6272 6f77 7365  keys..the browse
-00005dd0: 7220 6861 7320 7468 6520 666f 6c6c 6f77  r has the follow
-00005de0: 696e 6720 686f 746b 6579 7320 2028 616c  ing hotkeys  (al
-00005df0: 7761 7973 2071 7765 7274 7929 0a2a 2060  ways qwerty).* `
-00005e00: 3f60 2073 686f 7720 686f 746b 6579 7320  ?` show hotkeys 
-00005e10: 6865 6c70 0a2a 2060 4260 2074 6f67 676c  help.* `B` toggl
-00005e20: 6520 6272 6561 6463 7275 6d62 7320 2f20  e breadcrumbs / 
-00005e30: 5b6e 6176 7061 6e65 5d28 236e 6176 7061  [navpane](#navpa
-00005e40: 6e65 290a 2a20 6049 2f4b 6020 7072 6576  ne).* `I/K` prev
-00005e50: 2f6e 6578 7420 666f 6c64 6572 0a2a 2060  /next folder.* `
-00005e60: 4d60 2070 6172 656e 7420 666f 6c64 6572  M` parent folder
-00005e70: 2028 6f72 2075 6e65 7870 616e 6420 6375   (or unexpand cu
-00005e80: 7272 656e 7429 0a2a 2060 5660 2074 6f67  rrent).* `V` tog
-00005e90: 676c 6520 666f 6c64 6572 7320 2f20 7465  gle folders / te
-00005ea0: 7874 6669 6c65 7320 696e 2074 6865 206e  xtfiles in the n
-00005eb0: 6176 7061 6e65 0a2a 2060 4760 2074 6f67  avpane.* `G` tog
-00005ec0: 676c 6520 6c69 7374 202f 205b 6772 6964  gle list / [grid
-00005ed0: 2076 6965 775d 2823 7468 756d 626e 6169   view](#thumbnai
-00005ee0: 6c73 2920 2d2d 2073 616d 6520 6173 2060  ls) -- same as `
-00005ef0: e794 b060 2062 6f74 746f 6d2d 7269 6768  ...` bottom-righ
-00005f00: 740a 2a20 6054 6020 746f 6767 6c65 2074  t.* `T` toggle t
-00005f10: 6875 6d62 6e61 696c 7320 2f20 6963 6f6e  humbnails / icon
-00005f20: 730a 2a20 6045 5343 6020 636c 6f73 6520  s.* `ESC` close 
-00005f30: 7661 7269 6f75 7320 7468 696e 6773 0a2a  various things.*
-00005f40: 2060 6374 726c 2d4b 6020 6465 6c65 7465   `ctrl-K` delete
-00005f50: 2073 656c 6563 7465 6420 6669 6c65 732f   selected files/
-00005f60: 666f 6c64 6572 730a 2a20 6063 7472 6c2d  folders.* `ctrl-
-00005f70: 5860 2063 7574 2073 656c 6563 7465 6420  X` cut selected 
-00005f80: 6669 6c65 732f 666f 6c64 6572 730a 2a20  files/folders.* 
-00005f90: 6063 7472 6c2d 5660 2070 6173 7465 0a2a  `ctrl-V` paste.*
-00005fa0: 2060 5960 2064 6f77 6e6c 6f61 6420 7365   `Y` download se
-00005fb0: 6c65 6374 6564 2066 696c 6573 0a2a 2060  lected files.* `
-00005fc0: 4632 6020 5b72 656e 616d 655d 2823 6261  F2` [rename](#ba
-00005fd0: 7463 682d 7265 6e61 6d65 2920 7365 6c65  tch-rename) sele
-00005fe0: 6374 6564 2066 696c 652f 666f 6c64 6572  cted file/folder
-00005ff0: 0a2a 2077 6865 6e20 6120 6669 6c65 2f66  .* when a file/f
-00006000: 6f6c 6465 7220 6973 2073 656c 6563 7465  older is selecte
-00006010: 6420 2869 6e20 6e6f 742d 6772 6964 2d76  d (in not-grid-v
-00006020: 6965 7729 3a0a 2020 2a20 6055 702f 446f  iew):.  * `Up/Do
-00006030: 776e 6020 6d6f 7665 2063 7572 736f 720a  wn` move cursor.
-00006040: 2020 2a20 7368 6966 742b 6055 702f 446f    * shift+`Up/Do
-00006050: 776e 6020 7365 6c65 6374 2061 6e64 206d  wn` select and m
-00006060: 6f76 6520 6375 7273 6f72 0a20 202a 2063  ove cursor.  * c
-00006070: 7472 6c2b 6055 702f 446f 776e 6020 6d6f  trl+`Up/Down` mo
-00006080: 7665 2063 7572 736f 7220 616e 6420 7363  ve cursor and sc
-00006090: 726f 6c6c 2076 6965 7770 6f72 740a 2020  roll viewport.  
-000060a0: 2a20 6053 7061 6365 6020 746f 6767 6c65  * `Space` toggle
-000060b0: 2066 696c 6520 7365 6c65 6374 696f 6e0a   file selection.
-000060c0: 2020 2a20 6043 7472 6c2d 4160 2074 6f67    * `Ctrl-A` tog
-000060d0: 676c 6520 7365 6c65 6374 2061 6c6c 0a2a  gle select all.*
-000060e0: 2077 6865 6e20 6120 7465 7874 6669 6c65   when a textfile
-000060f0: 2069 7320 6f70 656e 3a0a 2020 2a20 6049   is open:.  * `I
-00006100: 2f4b 6020 7072 6576 2f6e 6578 7420 7465  /K` prev/next te
-00006110: 7874 6669 6c65 0a20 202a 2060 5360 2074  xtfile.  * `S` t
-00006120: 6f67 676c 6520 7365 6c65 6374 696f 6e20  oggle selection 
-00006130: 6f66 206f 7065 6e20 6669 6c65 0a20 202a  of open file.  *
-00006140: 2060 4d60 2063 6c6f 7365 2074 6578 7466   `M` close textf
-00006150: 696c 650a 2a20 7768 656e 2070 6c61 7969  ile.* when playi
-00006160: 6e67 2061 7564 696f 3a0a 2020 2a20 604a  ng audio:.  * `J
-00006170: 2f4c 6020 7072 6576 2f6e 6578 7420 736f  /L` prev/next so
-00006180: 6e67 0a20 202a 2060 552f 4f60 2073 6b69  ng.  * `U/O` ski
-00006190: 7020 3130 7365 6320 6261 636b 2f66 6f72  p 10sec back/for
-000061a0: 7761 7264 0a20 202a 2060 302e 2e39 6020  ward.  * `0..9` 
-000061b0: 6a75 6d70 2074 6f20 3025 2e2e 3930 250a  jump to 0%..90%.
-000061c0: 2020 2a20 6050 6020 706c 6179 2f70 6175    * `P` play/pau
-000061d0: 7365 2028 616c 736f 2073 7461 7274 7320  se (also starts 
-000061e0: 706c 6179 696e 6720 7468 6520 666f 6c64  playing the fold
-000061f0: 6572 290a 2020 2a20 6059 6020 646f 776e  er).  * `Y` down
-00006200: 6c6f 6164 2066 696c 650a 2a20 7768 656e  load file.* when
-00006210: 2076 6965 7769 6e67 2069 6d61 6765 7320   viewing images 
-00006220: 2f20 706c 6179 696e 6720 7669 6465 6f73  / playing videos
-00006230: 3a0a 2020 2a20 604a 2f4c 2c20 4c65 6674  :.  * `J/L, Left
-00006240: 2f52 6967 6874 6020 7072 6576 2f6e 6578  /Right` prev/nex
-00006250: 7420 6669 6c65 0a20 202a 2060 486f 6d65  t file.  * `Home
-00006260: 2f45 6e64 6020 6669 7273 742f 6c61 7374  /End` first/last
-00006270: 2066 696c 650a 2020 2a20 6046 6020 746f   file.  * `F` to
-00006280: 6767 6c65 2066 756c 6c73 6372 6565 6e0a  ggle fullscreen.
-00006290: 2020 2a20 6053 6020 746f 6767 6c65 2073    * `S` toggle s
-000062a0: 656c 6563 7469 6f6e 0a20 202a 2060 5260  election.  * `R`
-000062b0: 2072 6f74 6174 6520 636c 6f63 6b77 6973   rotate clockwis
-000062c0: 6520 2873 6869 6674 3d63 6377 290a 2020  e (shift=ccw).  
-000062d0: 2a20 6059 6020 646f 776e 6c6f 6164 2066  * `Y` download f
-000062e0: 696c 650a 2020 2a20 6045 7363 6020 636c  ile.  * `Esc` cl
-000062f0: 6f73 6520 7669 6577 6572 0a20 202a 2076  ose viewer.  * v
-00006300: 6964 656f 733a 0a20 2020 202a 2060 552f  ideos:.    * `U/
-00006310: 4f60 2073 6b69 7020 3130 7365 6320 6261  O` skip 10sec ba
-00006320: 636b 2f66 6f72 7761 7264 0a20 2020 202a  ck/forward.    *
-00006330: 2060 302e 2e39 6020 6a75 6d70 2074 6f20   `0..9` jump to 
-00006340: 3025 2e2e 3930 250a 2020 2020 2a20 6050  0%..90%.    * `P
-00006350: 2f4b 2f53 7061 6365 6020 706c 6179 2f70  /K/Space` play/p
-00006360: 6175 7365 0a20 2020 202a 2060 4d60 206d  ause.    * `M` m
-00006370: 7574 650a 2020 2020 2a20 6043 6020 636f  ute.    * `C` co
-00006380: 6e74 696e 7565 2070 6c61 7969 6e67 206e  ntinue playing n
-00006390: 6578 7420 7669 6465 6f0a 2020 2020 2a20  ext video.    * 
-000063a0: 6056 6020 6c6f 6f70 2065 6e74 6972 6520  `V` loop entire 
-000063b0: 6669 6c65 0a20 2020 202a 2060 5b60 206c  file.    * `[` l
-000063c0: 6f6f 7020 7261 6e67 6520 2873 7461 7274  oop range (start
-000063d0: 290a 2020 2020 2a20 605d 6020 6c6f 6f70  ).    * `]` loop
-000063e0: 2072 616e 6765 2028 656e 6429 0a2a 2077   range (end).* w
-000063f0: 6865 6e20 7468 6520 6e61 7670 616e 6520  hen the navpane 
-00006400: 6973 206f 7065 6e3a 0a20 202a 2060 412f  is open:.  * `A/
-00006410: 4460 2061 646a 7573 7420 7472 6565 2077  D` adjust tree w
-00006420: 6964 7468 0a2a 2069 6e20 7468 6520 5b67  idth.* in the [g
-00006430: 7269 6420 7669 6577 5d28 2374 6875 6d62  rid view](#thumb
-00006440: 6e61 696c 7329 3a0a 2020 2a20 6053 6020  nails):.  * `S` 
-00006450: 746f 6767 6c65 206d 756c 7469 7365 6c65  toggle multisele
-00006460: 6374 0a20 202a 2073 6869 6674 2b60 412f  ct.  * shift+`A/
-00006470: 4460 207a 6f6f 6d0a 2a20 696e 2074 6865  D` zoom.* in the
-00006480: 206d 6172 6b64 6f77 6e20 6564 6974 6f72   markdown editor
-00006490: 3a0a 2020 2a20 605e 7360 2073 6176 650a  :.  * `^s` save.
-000064a0: 2020 2a20 605e 6860 2068 6561 6465 720a    * `^h` header.
-000064b0: 2020 2a20 605e 6b60 2061 7574 6f66 6f72    * `^k` autofor
-000064c0: 6d61 7420 7461 626c 650a 2020 2a20 605e  mat table.  * `^
-000064d0: 7560 206a 756d 7020 746f 206e 6578 7420  u` jump to next 
-000064e0: 756e 6963 6f64 6520 6368 6172 6163 7465  unicode characte
-000064f0: 720a 2020 2a20 605e 6560 2074 6f67 676c  r.  * `^e` toggl
-00006500: 6520 6564 6974 6f72 202f 2070 7265 7669  e editor / previ
-00006510: 6577 0a20 202a 2060 5e75 702c 205e 646f  ew.  * `^up, ^do
-00006520: 776e 6020 6a75 6d70 2070 6172 6167 7261  wn` jump paragra
-00006530: 7068 730a 0a0a 2323 206e 6176 7061 6e65  phs...## navpane
-00006540: 0a0a 7377 6974 6368 696e 6720 6265 7477  ..switching betw
-00006550: 6565 6e20 6272 6561 6463 7275 6d62 7320  een breadcrumbs 
-00006560: 6f72 206e 6176 7061 6e65 0a0a 636c 6963  or navpane..clic
-00006570: 6b20 7468 6520 60f0 9f8c b260 206f 7220  k the `....` or 
-00006580: 7072 6573 7369 6e67 2074 6865 2060 4260  pressing the `B`
-00006590: 2068 6f74 6b65 7920 746f 2074 6f67 676c   hotkey to toggl
-000065a0: 6520 6265 7477 6565 6e20 6272 6561 6463  e between breadc
-000065b0: 7275 6d62 7320 7061 7468 2028 6465 6661  rumbs path (defa
-000065c0: 756c 7429 2c20 6f72 2061 206e 6176 7061  ult), or a navpa
-000065d0: 6e65 2028 7472 6565 2d62 726f 7773 6572  ne (tree-browser
-000065e0: 2073 6964 6562 6172 2074 6869 6e67 290a   sidebar thing).
-000065f0: 0a2a 2060 5b2b 5d60 2061 6e64 2060 5b2d  .* `[+]` and `[-
-00006600: 5d60 2028 6f72 2068 6f74 6b65 7973 2060  ]` (or hotkeys `
-00006610: 4160 2f60 4460 2920 6164 6a75 7374 2074  A`/`D`) adjust t
-00006620: 6865 2073 697a 650a 2a20 605b f09f 8eaf  he size.* `[....
-00006630: 5d60 206a 756d 7073 2074 6f20 7468 6520  ]` jumps to the 
-00006640: 6375 7272 656e 746c 7920 6f70 656e 2066  currently open f
-00006650: 6f6c 6465 720a 2a20 605b f09f 9383 5d60  older.* `[....]`
-00006660: 2074 6f67 676c 6573 2062 6574 7765 656e   toggles between
-00006670: 2073 686f 7769 6e67 2066 6f6c 6465 7273   showing folders
-00006680: 2061 6e64 2074 6578 7466 696c 6573 0a2a   and textfiles.*
-00006690: 2060 5bf0 9f93 8c5d 6020 7368 6f77 7320   `[....]` shows 
-000066a0: 7468 6520 6e61 6d65 206f 6620 616c 6c20  the name of all 
-000066b0: 7061 7265 6e74 2066 6f6c 6465 7273 2069  parent folders i
-000066c0: 6e20 6120 646f 636b 6564 2070 616e 656c  n a docked panel
-000066d0: 0a2a 2060 5b61 5d60 2074 6f67 676c 6573  .* `[a]` toggles
-000066e0: 2061 7574 6f6d 6174 6963 2077 6964 656e   automatic widen
-000066f0: 696e 6720 6173 2079 6f75 2067 6f20 6465  ing as you go de
-00006700: 6570 6572 0a2a 2060 5be2 86b5 5d60 2074  eper.* `[...]` t
-00006710: 6f67 676c 6573 2077 6f72 6477 7261 700a  oggles wordwrap.
-00006720: 2a20 605b f09f 9180 5d60 2073 686f 7720  * `[....]` show 
-00006730: 6675 6c6c 206e 616d 6520 6f6e 2068 6f76  full name on hov
-00006740: 6572 2028 6966 2077 6f72 6477 7261 7020  er (if wordwrap 
-00006750: 6973 206f 6666 290a 0a0a 2323 2074 6875  is off)...## thu
-00006760: 6d62 6e61 696c 730a 0a70 7265 7373 2060  mbnails..press `
-00006770: 6760 206f 7220 60e7 94b0 6020 746f 2074  g` or `...` to t
-00006780: 6f67 676c 6520 6772 6964 2d76 6965 7720  oggle grid-view 
-00006790: 696e 7374 6561 6420 6f66 2074 6865 2066  instead of the f
-000067a0: 696c 6520 6c69 7374 696e 6720 2061 6e64  ile listing  and
-000067b0: 2060 7460 2074 6f67 676c 6573 2069 636f   `t` toggles ico
-000067c0: 6e73 202f 2074 6875 6d62 6e61 696c 730a  ns / thumbnails.
-000067d0: 0a21 5b63 6f70 7970 6172 7479 2d74 6875  .![copyparty-thu
-000067e0: 6d62 732d 6673 385d 2868 7474 7073 3a2f  mbs-fs8](https:/
-000067f0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-00006800: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-00006810: 6f6d 2f32 3431 3033 322f 3132 3936 3336  om/241032/129636
-00006820: 3231 312d 6162 6432 3066 6132 2d61 3935  211-abd20fa2-a95
-00006830: 332d 3433 3636 2d39 3432 332d 3163 3838  3-4366-9423-1c88
-00006840: 6562 6239 3662 6139 2e70 6e67 290a 0a69  ebb96ba9.png)..i
-00006850: 7420 646f 6573 2073 7461 7469 6320 696d  t does static im
-00006860: 6167 6573 2077 6974 6820 5069 6c6c 6f77  ages with Pillow
-00006870: 202f 2070 7976 6970 7320 2f20 4646 6d70   / pyvips / FFmp
-00006880: 6567 2c20 616e 6420 7573 6573 2046 466d  eg, and uses FFm
-00006890: 7065 6720 666f 7220 7669 6465 6f20 6669  peg for video fi
-000068a0: 6c65 732c 2073 6f20 796f 7520 6d61 7920  les, so you may 
-000068b0: 7761 6e74 2074 6f20 602d 2d6e 6f2d 7468  want to `--no-th
-000068c0: 756d 6260 206f 7220 6d61 7962 6520 6a75  umb` or maybe ju
-000068d0: 7374 2060 2d2d 6e6f 2d76 7468 756d 6260  st `--no-vthumb`
-000068e0: 2064 6570 656e 6469 6e67 206f 6e20 686f   depending on ho
-000068f0: 7720 6461 6e67 6572 6f75 7320 796f 7572  w dangerous your
-00006900: 2075 7365 7273 2061 7265 0a2a 2070 7976   users are.* pyv
-00006910: 6970 7320 6973 2033 7820 6661 7374 6572  ips is 3x faster
-00006920: 2074 6861 6e20 5069 6c6c 6f77 2c20 5069   than Pillow, Pi
-00006930: 6c6c 6f77 2069 7320 3378 2066 6173 7465  llow is 3x faste
-00006940: 7220 7468 616e 2046 466d 7065 670a 2a20  r than FFmpeg.* 
-00006950: 6469 7361 626c 6520 7468 756d 626e 6169  disable thumbnai
-00006960: 6c73 2066 6f72 2073 7065 6369 6669 6320  ls for specific 
-00006970: 766f 6c75 6d65 7320 7769 7468 2076 6f6c  volumes with vol
-00006980: 666c 6167 2060 6474 6875 6d62 6020 666f  flag `dthumb` fo
-00006990: 7220 616c 6c2c 206f 7220 6064 7674 6875  r all, or `dvthu
-000069a0: 6d62 6020 2f20 6064 6174 6875 6d62 6020  mb` / `dathumb` 
-000069b0: 2f20 6064 6974 6875 6d62 6020 666f 7220  / `dithumb` for 
-000069c0: 7669 6465 6f2f 6175 6469 6f2f 696d 6167  video/audio/imag
-000069d0: 6573 206f 6e6c 790a 0a61 7564 696f 2066  es only..audio f
-000069e0: 696c 6573 2061 7265 2063 6f76 6e65 7274  iles are covnert
-000069f0: 6564 2069 6e74 6f20 7370 6563 7472 6f67  ed into spectrog
-00006a00: 7261 6d73 2075 7369 6e67 2046 466d 7065  rams using FFmpe
-00006a10: 6720 756e 6c65 7373 2079 6f75 2060 2d2d  g unless you `--
-00006a20: 6e6f 2d61 7468 756d 6260 2028 616e 6420  no-athumb` (and 
-00006a30: 736f 6d65 2046 466d 7065 6720 6275 696c  some FFmpeg buil
-00006a40: 6473 206d 6179 206e 6565 6420 602d 2d74  ds may need `--t
-00006a50: 682d 6666 2d73 7772 6029 0a0a 696d 6167  h-ff-swr`)..imag
-00006a60: 6573 2077 6974 6820 7468 6520 666f 6c6c  es with the foll
-00006a70: 6f77 696e 6720 6e61 6d65 7320 2873 6565  owing names (see
-00006a80: 2060 2d2d 7468 2d63 6f76 6572 7360 2920   `--th-covers`) 
-00006a90: 6265 636f 6d65 2074 6865 2074 6875 6d62  become the thumb
-00006aa0: 6e61 696c 206f 6620 7468 6520 666f 6c64  nail of the fold
-00006ab0: 6572 2074 6865 7927 7265 2069 6e3a 2060  er they're in: `
-00006ac0: 666f 6c64 6572 2e70 6e67 602c 2060 666f  folder.png`, `fo
-00006ad0: 6c64 6572 2e6a 7067 602c 2060 636f 7665  lder.jpg`, `cove
-00006ae0: 722e 706e 6760 2c20 6063 6f76 6572 2e6a  r.png`, `cover.j
-00006af0: 7067 600a 0a69 6e20 7468 6520 6772 6964  pg`..in the grid
-00006b00: 2f74 6875 6d62 6e61 696c 2076 6965 772c  /thumbnail view,
-00006b10: 2069 6620 7468 6520 6175 6469 6f20 706c   if the audio pl
-00006b20: 6179 6572 2070 616e 656c 2069 7320 6f70  ayer panel is op
-00006b30: 656e 2c20 736f 6e67 7320 7769 6c6c 2073  en, songs will s
-00006b40: 7461 7274 2070 6c61 7969 6e67 2077 6865  tart playing whe
-00006b50: 6e20 636c 6963 6b65 640a 2a20 696e 6469  n clicked.* indi
-00006b60: 6361 7465 6420 6279 2074 6865 2061 7564  cated by the aud
-00006b70: 696f 2066 696c 6573 2068 6176 696e 6720  io files having 
-00006b80: 7468 6520 e296 b620 6963 6f6e 2069 6e73  the ... icon ins
-00006b90: 7465 6164 206f 6620 f09f 92be 0a0a 0a23  tead of .......#
-00006ba0: 2320 7a69 7020 646f 776e 6c6f 6164 730a  # zip downloads.
-00006bb0: 0a64 6f77 6e6c 6f61 6420 666f 6c64 6572  .download folder
-00006bc0: 7320 286f 7220 6669 6c65 2073 656c 6563  s (or file selec
-00006bd0: 7469 6f6e 7329 2061 7320 607a 6970 6020  tions) as `zip` 
-00006be0: 6f72 2060 7461 7260 2066 696c 6573 0a0a  or `tar` files..
-00006bf0: 7365 6c65 6374 2077 6869 6368 2074 7970  select which typ
-00006c00: 6520 6f66 2061 7263 6869 7665 2079 6f75  e of archive you
-00006c10: 2077 616e 7420 696e 2074 6865 2060 5be2   want in the `[.
-00006c20: 9a99 efb8 8f5d 2063 6f6e 6669 6760 2074  .....] config` t
-00006c30: 6162 3a0a 0a7c 206e 616d 6520 7c20 7572  ab:..| name | ur
-00006c40: 6c2d 7375 6666 6978 207c 2064 6573 6372  l-suffix | descr
-00006c50: 6970 7469 6f6e 207c 0a7c 2d2d 7c2d 2d7c  iption |.|--|--|
-00006c60: 2d2d 7c0a 7c20 6074 6172 6020 7c20 603f  --|.| `tar` | `?
-00006c70: 7461 7260 207c 2070 6c61 696e 2067 6e75  tar` | plain gnu
-00006c80: 7461 722c 2077 6f72 6b73 2067 7265 6174  tar, works great
-00006c90: 2077 6974 6820 6063 7572 6c20 5c7c 2074   with `curl \| t
-00006ca0: 6172 202d 7876 6020 7c0a 7c20 607a 6970  ar -xv` |.| `zip
-00006cb0: 6020 7c20 603f 7a69 703d 7574 6638 6020  ` | `?zip=utf8` 
-00006cc0: 7c20 776f 726b 7320 6576 6572 7977 6865  | works everywhe
-00006cd0: 7265 2c20 676c 6974 6368 7920 6669 6c65  re, glitchy file
-00006ce0: 6e61 6d65 7320 6f6e 2077 696e 3720 616e  names on win7 an
-00006cf0: 6420 6f6c 6465 7220 7c0a 7c20 607a 6970  d older |.| `zip
-00006d00: 5f64 6f73 6020 7c20 603f 7a69 7060 207c  _dos` | `?zip` |
-00006d10: 2074 7261 6469 7469 6f6e 616c 2063 7034   traditional cp4
-00006d20: 3337 2028 6e6f 2075 6e69 636f 6465 2920  37 (no unicode) 
-00006d30: 746f 2066 6978 2067 6c69 7463 6879 2066  to fix glitchy f
-00006d40: 696c 656e 616d 6573 207c 0a7c 2060 7a69  ilenames |.| `zi
-00006d50: 705f 6372 6360 207c 2060 3f7a 6970 3d63  p_crc` | `?zip=c
-00006d60: 7263 6020 7c20 6370 3433 3720 7769 7468  rc` | cp437 with
-00006d70: 2063 7263 3332 2063 6f6d 7075 7465 6420   crc32 computed 
-00006d80: 6561 726c 7920 666f 7220 7472 756c 7920  early for truly 
-00006d90: 616e 6369 656e 7420 736f 6674 7761 7265  ancient software
-00006da0: 207c 0a0a 2a20 6869 6464 656e 2066 696c   |..* hidden fil
-00006db0: 6573 2028 646f 7466 696c 6573 2920 6172  es (dotfiles) ar
-00006dc0: 6520 6578 636c 7564 6564 2075 6e6c 6573  e excluded unles
-00006dd0: 7320 602d 6564 600a 2020 2a20 6075 7032  s `-ed`.  * `up2
-00006de0: 6b2e 6462 6020 616e 6420 6064 6972 2e74  k.db` and `dir.t
-00006df0: 7874 6020 6973 2061 6c77 6179 7320 6578  xt` is always ex
-00006e00: 636c 7564 6564 0a2a 2060 7a69 705f 6372  cluded.* `zip_cr
-00006e10: 6360 2077 696c 6c20 7461 6b65 206c 6f6e  c` will take lon
-00006e20: 6765 7220 746f 2064 6f77 6e6c 6f61 6420  ger to download 
-00006e30: 7369 6e63 6520 7468 6520 7365 7276 6572  since the server
-00006e40: 2068 6173 2074 6f20 7265 6164 2065 6163   has to read eac
-00006e50: 6820 6669 6c65 2074 7769 6365 0a20 202a  h file twice.  *
-00006e60: 2074 6869 7320 6973 206f 6e6c 7920 746f   this is only to
-00006e70: 2073 7570 706f 7274 204d 532d 444f 5320   support MS-DOS 
-00006e80: 504b 5a49 5020 7632 2e30 3467 2028 6f63  PKZIP v2.04g (oc
-00006e90: 746f 6265 7220 3139 3933 2920 616e 6420  tober 1993) and 
-00006ea0: 6f6c 6465 720a 2020 2020 2a20 686f 7720  older.    * how 
-00006eb0: 6172 6520 796f 7520 6163 6365 7373 696e  are you accessin
-00006ec0: 6720 636f 7079 7061 7274 7920 6163 7475  g copyparty actu
-00006ed0: 616c 6c79 0a0a 796f 7520 6361 6e20 616c  ally..you can al
-00006ee0: 736f 207a 6970 2061 2073 656c 6563 7469  so zip a selecti
-00006ef0: 6f6e 206f 6620 6669 6c65 7320 6f72 2066  on of files or f
-00006f00: 6f6c 6465 7273 2062 7920 636c 6963 6b69  olders by clicki
-00006f10: 6e67 2074 6865 6d20 696e 2074 6865 2062  ng them in the b
-00006f20: 726f 7773 6572 2c20 7468 6174 2062 7269  rowser, that bri
-00006f30: 6e67 7320 7570 2061 2073 656c 6563 7469  ngs up a selecti
-00006f40: 6f6e 2065 6469 746f 7220 616e 6420 7a69  on editor and zi
-00006f50: 7020 6275 7474 6f6e 2069 6e20 7468 6520  p button in the 
-00006f60: 626f 7474 6f6d 2072 6967 6874 0a0a 215b  bottom right..![
-00006f70: 636f 7079 7061 7274 792d 7a69 7073 656c  copyparty-zipsel
-00006f80: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
-00006f90: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-00006fa0: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-00006fb0: 3234 3130 3332 2f31 3239 3633 3533 3734  241032/129635374
-00006fc0: 2d65 3531 3336 6530 312d 3437 3061 2d34  -e5136e01-470a-4
-00006fd0: 3962 312d 6137 3632 2d38 3438 6538 6134  9b1-a762-848e8a4
-00006fe0: 6339 6364 632e 706e 6729 0a0a 0a23 2320  c9cdc.png)...## 
-00006ff0: 7570 6c6f 6164 696e 670a 0a64 7261 6720  uploading..drag 
-00007000: 6669 6c65 732f 666f 6c64 6572 7320 696e  files/folders in
-00007010: 746f 2074 6865 2077 6562 2d62 726f 7773  to the web-brows
-00007020: 6572 2074 6f20 7570 6c6f 6164 2020 286f  er to upload  (o
-00007030: 7220 7573 6520 7468 6520 5b63 6f6d 6d61  r use the [comma
-00007040: 6e64 2d6c 696e 6520 7570 6c6f 6164 6572  nd-line uploader
-00007050: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
-00007060: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
-00007070: 7274 792f 7472 6565 2f68 6f76 7564 7374  rty/tree/hovudst
-00007080: 7261 756d 2f62 696e 2375 7032 6b70 7929  raum/bin#up2kpy)
-00007090: 290a 0a74 6869 7320 696e 6974 6961 7465  )..this initiate
-000070a0: 7320 616e 2075 706c 6f61 6420 7573 696e  s an upload usin
-000070b0: 6720 6075 7032 6b60 3b20 7468 6572 6520  g `up2k`; there 
-000070c0: 6172 6520 7477 6f20 7570 6c6f 6164 6572  are two uploader
-000070d0: 7320 6176 6169 6c61 626c 653a 0a2a 2060  s available:.* `
-000070e0: 5bf0 9f8e 885d 2062 7570 602c 2074 6865  [....] bup`, the
-000070f0: 2062 6173 6963 2075 706c 6f61 6465 722c   basic uploader,
-00007100: 2073 7570 706f 7274 7320 616c 6d6f 7374   supports almost
-00007110: 2065 7665 7279 2062 726f 7773 6572 2073   every browser s
-00007120: 696e 6365 206e 6574 7363 6170 6520 342e  ince netscape 4.
-00007130: 300a 2a20 605b f09f 9a80 5d20 7570 326b  0.* `[....] up2k
-00007140: 602c 2074 6865 2067 6f6f 6420 2f20 6661  `, the good / fa
-00007150: 6e63 7920 6f6e 650a 0a4e 423a 2079 6f75  ncy one..NB: you
-00007160: 2063 616e 2075 6e64 6f2f 6465 6c65 7465   can undo/delete
-00007170: 2079 6f75 7220 6f77 6e20 7570 6c6f 6164   your own upload
-00007180: 7320 7769 7468 2060 5bf0 9fa7 af5d 6020  s with `[....]` 
-00007190: 5b75 6e70 6f73 745d 2823 756e 706f 7374  [unpost](#unpost
-000071a0: 290a 0a75 7032 6b20 6861 7320 7365 7665  )..up2k has seve
-000071b0: 7261 6c20 6164 7661 6e74 6167 6573 3a0a  ral advantages:.
-000071c0: 2a20 796f 7520 6361 6e20 6472 6f70 2066  * you can drop f
-000071d0: 6f6c 6465 7273 2069 6e74 6f20 7468 6520  olders into the 
-000071e0: 6272 6f77 7365 7220 2866 696c 6573 2061  browser (files a
-000071f0: 7265 2061 6464 6564 2072 6563 7572 7369  re added recursi
-00007200: 7665 6c79 290a 2a20 6669 6c65 7320 6172  vely).* files ar
-00007210: 6520 7072 6f63 6573 7365 6420 696e 2063  e processed in c
-00007220: 6875 6e6b 732c 2061 6e64 2065 6163 6820  hunks, and each 
-00007230: 6368 756e 6b20 6973 2063 6865 636b 7375  chunk is checksu
-00007240: 6d6d 6564 0a20 202a 2075 706c 6f61 6473  mmed.  * uploads
-00007250: 2061 7574 6f72 6573 756d 6520 6966 2074   autoresume if t
-00007260: 6865 7920 6172 6520 696e 7465 7272 7570  hey are interrup
-00007270: 7465 6420 6279 206e 6574 776f 726b 2069  ted by network i
-00007280: 7373 7565 730a 2020 2a20 7570 6c6f 6164  ssues.  * upload
-00007290: 7320 7265 7375 6d65 2069 6620 796f 7520  s resume if you 
-000072a0: 7265 626f 6f74 2079 6f75 7220 6272 6f77  reboot your brow
-000072b0: 7365 7220 6f72 2070 632c 206a 7573 7420  ser or pc, just 
-000072c0: 7570 6c6f 6164 2074 6865 2073 616d 6520  upload the same 
-000072d0: 6669 6c65 7320 6167 6169 6e0a 2020 2a20  files again.  * 
-000072e0: 7365 7276 6572 2064 6574 6563 7473 2061  server detects a
-000072f0: 6e79 2063 6f72 7275 7074 696f 6e3b 2074  ny corruption; t
-00007300: 6865 2063 6c69 656e 7420 7265 7570 6c6f  he client reuplo
-00007310: 6164 7320 6166 6665 6374 6564 2063 6875  ads affected chu
-00007320: 6e6b 730a 2020 2a20 7468 6520 636c 6965  nks.  * the clie
-00007330: 6e74 2064 6f65 736e 2774 2075 706c 6f61  nt doesn't uploa
-00007340: 6420 616e 7974 6869 6e67 2074 6861 7420  d anything that 
-00007350: 616c 7265 6164 7920 6578 6973 7473 206f  already exists o
-00007360: 6e20 7468 6520 7365 7276 6572 0a2a 206d  n the server.* m
-00007370: 7563 6820 6869 6768 6572 2073 7065 6564  uch higher speed
-00007380: 7320 7468 616e 2066 7470 2f73 6370 2f74  s than ftp/scp/t
-00007390: 6172 7069 7065 206f 6e20 736f 6d65 2069  arpipe on some i
-000073a0: 6e74 6572 6e65 7420 636f 6e6e 6563 7469  nternet connecti
-000073b0: 6f6e 7320 286d 6169 6e6c 7920 616d 6572  ons (mainly amer
-000073c0: 6963 616e 206f 6e65 7329 2074 6861 6e6b  ican ones) thank
-000073d0: 7320 746f 2070 6172 616c 6c65 6c20 636f  s to parallel co
-000073e0: 6e6e 6563 7469 6f6e 730a 2a20 7468 6520  nnections.* the 
-000073f0: 6c61 7374 2d6d 6f64 6966 6965 6420 7469  last-modified ti
-00007400: 6d65 7374 616d 7020 6f66 2074 6865 2066  mestamp of the f
-00007410: 696c 6520 6973 2070 7265 7365 7276 6564  ile is preserved
-00007420: 0a0a 3e20 6974 2069 7320 7065 7266 6563  ..> it is perfec
-00007430: 746c 7920 7361 6665 2074 6f20 7265 7374  tly safe to rest
-00007440: 6172 7420 2f20 7570 6772 6164 6520 636f  art / upgrade co
-00007450: 7079 7061 7274 7920 7768 696c 6520 736f  pyparty while so
-00007460: 6d65 6f6e 6520 6973 2075 706c 6f61 6469  meone is uploadi
-00007470: 6e67 2074 6f20 6974 2120 200a 3e20 616c  ng to it!  .> al
-00007480: 6c20 6b6e 6f77 6e20 7570 326b 2063 6c69  l known up2k cli
-00007490: 656e 7473 2077 696c 6c20 7265 7375 6d65  ents will resume
-000074a0: 206a 7573 7420 6669 6e65 20f0 9f92 aa0a   just fine .....
-000074b0: 0a73 6565 205b 7570 326b 5d28 2375 7032  .see [up2k](#up2
-000074c0: 6b29 2066 6f72 2064 6574 6169 6c73 206f  k) for details o
-000074d0: 6e20 686f 7720 6974 2077 6f72 6b73 2c20  n how it works, 
-000074e0: 6f72 2077 6174 6368 2061 205b 6465 6d6f  or watch a [demo
-000074f0: 2076 6964 656f 5d28 6874 7470 733a 2f2f   video](https://
-00007500: 612e 6f63 762e 6d65 2f70 7562 2f64 656d  a.ocv.me/pub/dem
-00007510: 6f2f 7069 6373 2d76 6964 732f 2367 662d  o/pics-vids/#gf-
-00007520: 3066 3666 3563 3064 290a 0a21 5b63 6f70  0f6f5c0d)..![cop
-00007530: 7970 6172 7479 2d75 706c 6f61 642d 6673  yparty-upload-fs
-00007540: 385d 2868 7474 7073 3a2f 2f75 7365 722d  8](https://user-
-00007550: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00007560: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-00007570: 3033 322f 3132 3936 3335 3337 312d 3438  032/129635371-48
-00007580: 6663 3534 6361 2d66 6139 312d 3438 6533  fc54ca-fa91-48e3
-00007590: 2d39 6231 642d 6261 3431 3365 3462 3638  -9b1d-ba413e4b68
-000075a0: 6362 2e70 6e67 290a 0a2a 2a70 726f 7469  cb.png)..**proti
-000075b0: 703a 2a2a 2079 6f75 2063 616e 2061 766f  p:** you can avo
-000075c0: 6964 2073 6361 7269 6e67 2061 7761 7920  id scaring away 
-000075d0: 7573 6572 7320 7769 7468 205b 636f 6e74  users with [cont
-000075e0: 7269 622f 706c 7567 696e 732f 6d69 6e69  rib/plugins/mini
-000075f0: 6d61 6c2d 7570 326b 2e6a 735d 2863 6f6e  mal-up2k.js](con
-00007600: 7472 6962 2f70 6c75 6769 6e73 2f6d 696e  trib/plugins/min
-00007610: 696d 616c 2d75 7032 6b2e 6a73 2920 7768  imal-up2k.js) wh
-00007620: 6963 6820 6d61 6b65 7320 6974 206c 6f6f  ich makes it loo
-00007630: 6b20 5b6d 7563 6820 7369 6d70 6c65 725d  k [much simpler]
-00007640: 2868 7474 7073 3a2f 2f75 7365 722d 696d  (https://user-im
-00007650: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-00007660: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-00007670: 322f 3131 3833 3131 3139 352d 6464 3663  2/118311195-dd6c
-00007680: 6133 3830 2d62 3465 662d 3131 6562 2d38  a380-b4ef-11eb-8
-00007690: 3666 332d 3735 6133 6666 3265 3133 3332  6f3-75a3ff2e1332
-000076a0: 2e70 6e67 290a 0a2a 2a70 726f 7469 703a  .png)..**protip:
-000076b0: 2a2a 2069 6620 796f 7520 656e 6162 6c65  ** if you enable
-000076c0: 2060 6661 7669 636f 6e60 2069 6e20 7468   `favicon` in th
-000076d0: 6520 605b e29a 99ef b88f 5d20 7365 7474  e `[......] sett
-000076e0: 696e 6773 6020 7461 6220 2862 7920 7479  ings` tab (by ty
-000076f0: 7069 6e67 2073 6f6d 6574 6869 6e67 2069  ping something i
-00007700: 6e74 6f20 7468 6520 7465 7874 626f 7829  nto the textbox)
-00007710: 2c20 7468 6520 6963 6f6e 2069 6e20 7468  , the icon in th
-00007720: 6520 6272 6f77 7365 7220 7461 6220 7769  e browser tab wi
-00007730: 6c6c 2069 6e64 6963 6174 6520 7570 6c6f  ll indicate uplo
-00007740: 6164 2070 726f 6772 6573 7320 2d2d 2061  ad progress -- a
-00007750: 6c73 6f2c 2074 6865 2060 5bf0 9f94 945d  lso, the `[....]
-00007760: 6020 616e 642f 6f72 2060 5bf0 9f94 8a5d  ` and/or `[....]
-00007770: 6020 7377 6974 6368 6573 2065 6e61 626c  ` switches enabl
-00007780: 6520 7669 7369 626c 6520 616e 642f 6f72  e visible and/or
-00007790: 2061 7564 6962 6c65 206e 6f74 6966 6963   audible notific
-000077a0: 6174 696f 6e73 206f 6e20 7570 6c6f 6164  ations on upload
-000077b0: 2063 6f6d 706c 6574 696f 6e0a 0a74 6865   completion..the
-000077c0: 2075 7032 6b20 5549 2069 7320 7468 6520   up2k UI is the 
-000077d0: 6570 6974 6f6d 6520 6f66 2070 6f6c 6973  epitome of polis
-000077e0: 6865 6420 696e 7574 6974 6976 6520 6578  hed inutitive ex
-000077f0: 7065 7269 656e 6365 733a 0a2a 2022 7061  periences:.* "pa
-00007800: 7261 6c6c 656c 2075 706c 6f61 6473 2220  rallel uploads" 
-00007810: 7370 6563 6966 6965 7320 686f 7720 6d61  specifies how ma
-00007820: 6e79 2063 6875 6e6b 7320 746f 2075 706c  ny chunks to upl
-00007830: 6f61 6420 6174 2074 6865 2073 616d 6520  oad at the same 
-00007840: 7469 6d65 0a2a 2060 5bf0 9f8f 835d 6020  time.* `[....]` 
-00007850: 616e 616c 7973 6973 206f 6620 6f74 6865  analysis of othe
-00007860: 7220 6669 6c65 7320 7368 6f75 6c64 2063  r files should c
-00007870: 6f6e 7469 6e75 6520 7768 696c 6520 6f6e  ontinue while on
-00007880: 6520 6973 2075 706c 6f61 6469 6e67 0a2a  e is uploading.*
-00007890: 2060 5bf0 9fa5 945d 6020 7368 6f77 7320   `[....]` shows 
-000078a0: 6120 7369 6d70 6c65 7220 5549 2066 6f72  a simpler UI for
-000078b0: 2066 6173 7465 7220 7570 6c6f 6164 7320   faster uploads 
-000078c0: 6672 6f6d 2073 6c6f 7720 6465 7669 6365  from slow device
-000078d0: 730a 2a20 605b f09f 92ad 5d60 2061 736b  s.* `[....]` ask
-000078e0: 2066 6f72 2063 6f6e 6669 726d 6174 696f   for confirmatio
-000078f0: 6e20 6265 666f 7265 2066 696c 6573 2061  n before files a
-00007900: 7265 2061 6464 6564 2074 6f20 7468 6520  re added to the 
-00007910: 7175 6575 650a 2a20 605b f09f 948e 5d60  queue.* `[....]`
-00007920: 2073 7769 7463 6820 6265 7477 6565 6e20   switch between 
-00007930: 7570 6c6f 6164 2061 6e64 205b 6669 6c65  upload and [file
-00007940: 2d73 6561 7263 685d 2823 6669 6c65 2d73  -search](#file-s
-00007950: 6561 7263 6829 206d 6f64 650a 2020 2a20  earch) mode.  * 
-00007960: 6967 6e6f 7265 2060 5bf0 9f94 8e5d 6020  ignore `[....]` 
-00007970: 6966 2079 6f75 2061 6464 2066 696c 6573  if you add files
-00007980: 2062 7920 6472 6167 6769 6e67 2074 6865   by dragging the
-00007990: 6d20 696e 746f 2074 6865 2062 726f 7773  m into the brows
-000079a0: 6572 0a0a 616e 6420 7468 656e 2074 6865  er..and then the
-000079b0: 7265 7320 7468 6520 7461 6273 2062 656c  res the tabs bel
-000079c0: 6f77 2069 742c 0a2a 2060 5b6f 6b5d 6020  ow it,.* `[ok]` 
-000079d0: 6973 2074 6865 2066 696c 6573 2077 6869  is the files whi
-000079e0: 6368 2063 6f6d 706c 6574 6564 2073 7563  ch completed suc
-000079f0: 6365 7373 6675 6c6c 790a 2a20 605b 6e67  cessfully.* `[ng
-00007a00: 5d60 2069 7320 7468 6520 6f6e 6573 2074  ]` is the ones t
-00007a10: 6861 7420 6661 696c 6564 202f 2067 6f74  hat failed / got
-00007a20: 2072 656a 6563 7465 6420 2861 6c72 6561   rejected (alrea
-00007a30: 6479 2065 7869 7374 732c 202e 2e2e 290a  dy exists, ...).
-00007a40: 2a20 605b 646f 6e65 5d60 2073 686f 7773  * `[done]` shows
-00007a50: 2061 2063 6f6d 6269 6e65 6420 6c69 7374   a combined list
-00007a60: 206f 6620 605b 6f6b 5d60 2061 6e64 2060   of `[ok]` and `
-00007a70: 5b6e 675d 602c 2063 6872 6f6e 6f6c 6f67  [ng]`, chronolog
-00007a80: 6963 616c 206f 7264 6572 0a2a 2060 5b62  ical order.* `[b
-00007a90: 7573 795d 6020 6669 6c65 7320 7768 6963  usy]` files whic
-00007aa0: 6820 6172 6520 6375 7272 656e 746c 7920  h are currently 
-00007ab0: 6861 7368 696e 672c 2070 656e 6469 6e67  hashing, pending
-00007ac0: 2d75 706c 6f61 642c 206f 7220 7570 6c6f  -upload, or uplo
-00007ad0: 6164 696e 670a 2020 2a20 706c 7573 2075  ading.  * plus u
-00007ae0: 7020 746f 2033 2065 6e74 7269 6573 2065  p to 3 entries e
-00007af0: 6163 6820 6672 6f6d 2060 5b64 6f6e 655d  ach from `[done]
-00007b00: 6020 616e 6420 605b 7175 655d 6020 666f  ` and `[que]` fo
-00007b10: 7220 636f 6e74 6578 740a 2a20 605b 7175  r context.* `[qu
-00007b20: 655d 6020 6973 2061 6c6c 2074 6865 2066  e]` is all the f
-00007b30: 696c 6573 2074 6861 7420 6172 6520 7374  iles that are st
-00007b40: 696c 6c20 7175 6575 6564 0a0a 6e6f 7465  ill queued..note
-00007b50: 2074 6861 7420 7369 6e63 6520 7570 326b   that since up2k
-00007b60: 2068 6173 2074 6f20 7265 6164 2065 6163   has to read eac
-00007b70: 6820 6669 6c65 2074 7769 6365 2c20 605b  h file twice, `[
-00007b80: f09f 8e88 5d20 6275 7060 2063 616e 202a  ....] bup` can *
-00007b90: 7468 656f 7265 7469 6361 6c6c 792a 2062  theoretically* b
-00007ba0: 6520 7570 2074 6f20 3278 2066 6173 7465  e up to 2x faste
-00007bb0: 7220 696e 2073 6f6d 6520 6578 7472 656d  r in some extrem
-00007bc0: 6520 6361 7365 7320 2866 696c 6573 2062  e cases (files b
-00007bd0: 6967 6765 7220 7468 616e 2079 6f75 7220  igger than your 
-00007be0: 7261 6d2c 2063 6f6d 6269 6e65 6420 7769  ram, combined wi
-00007bf0: 7468 2061 6e20 696e 7465 726e 6574 2063  th an internet c
-00007c00: 6f6e 6e65 6374 696f 6e20 6661 7374 6572  onnection faster
-00007c10: 2074 6861 6e20 7468 6520 7265 6164 2d73   than the read-s
-00007c20: 7065 6564 206f 6620 796f 7572 2048 4444  peed of your HDD
-00007c30: 2c20 6f72 2069 6620 796f 7527 7265 2075  , or if you're u
-00007c40: 706c 6f61 6469 6e67 2066 726f 6d20 6120  ploading from a 
-00007c50: 6375 6f32 6475 6f29 0a0a 6966 2079 6f75  cuo2duo)..if you
-00007c60: 2061 7265 2072 6573 756d 696e 6720 6120   are resuming a 
-00007c70: 6d61 7373 6976 6520 7570 6c6f 6164 2061  massive upload a
-00007c80: 6e64 2077 616e 7420 746f 2073 6b69 7020  nd want to skip 
-00007c90: 6861 7368 696e 6720 7468 6520 6669 6c65  hashing the file
-00007ca0: 7320 7768 6963 6820 616c 7265 6164 7920  s which already 
-00007cb0: 6669 6e69 7368 6564 2c20 796f 7520 6361  finished, you ca
-00007cc0: 6e20 656e 6162 6c65 2060 7475 7262 6f60  n enable `turbo`
-00007cd0: 2069 6e20 7468 6520 605b e29a 99ef b88f   in the `[......
-00007ce0: 5d20 636f 6e66 6967 6020 7461 622c 2062  ] config` tab, b
-00007cf0: 7574 2070 6c65 6173 6520 7265 6164 2074  ut please read t
-00007d00: 6865 2074 6f6f 6c74 6970 206f 6e20 7468  he tooltip on th
-00007d10: 6174 2062 7574 746f 6e0a 0a0a 2323 2320  at button...### 
-00007d20: 6669 6c65 2d73 6561 7263 680a 0a64 726f  file-search..dro
-00007d30: 7070 696e 6720 6669 6c65 7320 696e 746f  pping files into
-00007d40: 2074 6865 2062 726f 7773 6572 2061 6c73   the browser als
-00007d50: 6f20 6c65 7473 2079 6f75 2073 6565 2069  o lets you see i
-00007d60: 6620 7468 6579 2065 7869 7374 206f 6e20  f they exist on 
-00007d70: 7468 6520 7365 7276 6572 0a0a 215b 636f  the server..![co
-00007d80: 7079 7061 7274 792d 6673 6561 7263 682d  pyparty-fsearch-
-00007d90: 6673 385d 2868 7474 7073 3a2f 2f75 7365  fs8](https://use
-00007da0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00007db0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-00007dc0: 3431 3033 322f 3132 3936 3335 3336 312d  41032/129635361-
-00007dd0: 6337 3932 3836 6630 2d62 3866 312d 3434  c79286f0-b8f1-44
-00007de0: 3065 2d61 6166 342d 3665 3932 3934 3238  0e-aaf4-6e929428
-00007df0: 6661 6339 2e70 6e67 290a 0a77 6865 6e20  fac9.png)..when 
-00007e00: 796f 7520 6472 6167 2f64 726f 7020 6669  you drag/drop fi
-00007e10: 6c65 7320 696e 746f 2074 6865 2062 726f  les into the bro
-00007e20: 7773 6572 2c20 796f 7520 7769 6c6c 2073  wser, you will s
-00007e30: 6565 2074 776f 2064 726f 707a 6f6e 6573  ee two dropzones
-00007e40: 3a20 6055 706c 6f61 6460 2061 6e64 2060  : `Upload` and `
-00007e50: 5365 6172 6368 600a 0a3e 206f 6e20 6120  Search`..> on a 
-00007e60: 7068 6f6e 653f 2074 6f67 676c 6520 7468  phone? toggle th
-00007e70: 6520 605b f09f 948e 5d60 2073 7769 7463  e `[....]` switc
-00007e80: 6820 6772 6565 6e20 6265 666f 7265 2074  h green before t
-00007e90: 6170 7069 6e67 2074 6865 2062 6967 2079  apping the big y
-00007ea0: 656c 6c6f 7720 5365 6172 6368 2062 7574  ellow Search but
-00007eb0: 746f 6e20 746f 2073 656c 6563 7420 796f  ton to select yo
-00007ec0: 7572 2066 696c 6573 0a0a 7468 6520 6669  ur files..the fi
-00007ed0: 6c65 7320 7769 6c6c 2062 6520 6861 7368  les will be hash
-00007ee0: 6564 206f 6e20 7468 6520 636c 6965 6e74  ed on the client
-00007ef0: 2d73 6964 652c 2061 6e64 2065 6163 6820  -side, and each 
-00007f00: 6861 7368 2069 7320 7365 6e74 2074 6f20  hash is sent to 
-00007f10: 7468 6520 7365 7276 6572 2c20 7768 6963  the server, whic
-00007f20: 6820 6368 6563 6b73 2069 6620 7468 6174  h checks if that
-00007f30: 2066 696c 6520 6578 6973 7473 2073 6f6d   file exists som
-00007f40: 6577 6865 7265 0a0a 6669 6c65 7320 676f  ewhere..files go
-00007f50: 2069 6e74 6f20 605b 6f6b 5d60 2069 6620   into `[ok]` if 
-00007f60: 7468 6579 2065 7869 7374 2028 616e 6420  they exist (and 
-00007f70: 796f 7520 6765 7420 6120 6c69 6e6b 2074  you get a link t
-00007f80: 6f20 7768 6572 6520 6974 2069 7329 2c20  o where it is), 
-00007f90: 6f74 6865 7277 6973 6520 7468 6579 206c  otherwise they l
-00007fa0: 616e 6420 696e 2060 5b6e 675d 600a 2a20  and in `[ng]`.* 
-00007fb0: 7468 6520 6d61 696e 2072 6561 736f 6e20  the main reason 
-00007fc0: 6669 6c65 7365 6172 6368 2069 7320 636f  filesearch is co
-00007fd0: 6d62 696e 6564 2077 6974 6820 7468 6520  mbined with the 
-00007fe0: 7570 6c6f 6164 6572 2069 7320 6361 7573  uploader is caus
-00007ff0: 6520 7468 6520 636f 6465 2077 6173 2074  e the code was t
-00008000: 6f6f 2073 7061 6768 6574 7469 2074 6f20  oo spaghetti to 
-00008010: 7365 7061 7261 7465 2069 7420 6f75 7420  separate it out 
-00008020: 736f 6d65 7768 6572 6520 656c 7365 2c20  somewhere else, 
-00008030: 7468 6973 2069 7320 6e6f 206c 6f6e 6765  this is no longe
-00008040: 7220 7468 6520 6361 7365 2062 7574 206e  r the case but n
-00008050: 6f77 2069 2776 6520 7761 726d 6564 2075  ow i've warmed u
-00008060: 7020 746f 2074 6865 2069 6465 6120 746f  p to the idea to
-00008070: 6f20 6d75 6368 0a0a 0a23 2323 2075 6e70  o much...### unp
-00008080: 6f73 740a 0a75 6e64 6f2f 6465 6c65 7465  ost..undo/delete
-00008090: 2061 6363 6964 656e 7461 6c20 7570 6c6f   accidental uplo
-000080a0: 6164 730a 0a21 5b63 6f70 7970 6172 7479  ads..![copyparty
-000080b0: 2d75 6e70 6f73 742d 6673 385d 2868 7474  -unpost-fs8](htt
-000080c0: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-000080d0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-000080e0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3132  nt.com/241032/12
-000080f0: 3936 3335 3336 382d 3361 6661 3636 3334  9635368-3afa6634
-00008100: 2d63 3230 662d 3431 3863 2d39 3064 632d  -c20f-418c-90dc-
-00008110: 6563 3431 3166 3362 3338 3937 2e70 6e67  ec411f3b3897.png
-00008120: 290a 0a79 6f75 2063 616e 2075 6e70 6f73  )..you can unpos
-00008130: 7420 6576 656e 2069 6620 796f 7520 646f  t even if you do
-00008140: 6e27 7420 6861 7665 2072 6567 756c 6172  n't have regular
-00008150: 206d 6f76 652f 6465 6c65 7465 2061 6363   move/delete acc
-00008160: 6573 732c 2068 6f77 6576 6572 206f 6e6c  ess, however onl
-00008170: 7920 666f 7220 6669 6c65 7320 7570 6c6f  y for files uplo
-00008180: 6164 6564 2077 6974 6869 6e20 7468 6520  aded within the 
-00008190: 7061 7374 2060 2d2d 756e 706f 7374 6020  past `--unpost` 
-000081a0: 7365 636f 6e64 7320 2864 6566 6175 6c74  seconds (default
-000081b0: 2031 3220 686f 7572 7329 2061 6e64 2074   12 hours) and t
-000081c0: 6865 2073 6572 7665 7220 6d75 7374 2062  he server must b
-000081d0: 6520 7275 6e6e 696e 6720 7769 7468 2060  e running with `
-000081e0: 2d65 3264 600a 0a0a 2323 2320 7365 6c66  -e2d`...### self
-000081f0: 2d64 6573 7472 7563 740a 0a75 706c 6f61  -destruct..uploa
-00008200: 6473 2063 616e 2062 6520 6769 7665 6e20  ds can be given 
-00008210: 6120 6c69 6665 7469 6d65 2c20 2061 6665  a lifetime,  afe
-00008220: 7220 7768 6963 6820 7468 6579 2065 7870  r which they exp
-00008230: 6972 6520 2f20 7365 6c66 2d64 6573 7472  ire / self-destr
-00008240: 7563 740a 0a74 6865 2066 6561 7475 7265  uct..the feature
-00008250: 206d 7573 7420 6265 2065 6e61 626c 6564   must be enabled
-00008260: 2070 6572 2d76 6f6c 756d 6520 7769 7468   per-volume with
-00008270: 2074 6865 2060 6c69 6665 7469 6d65 6020   the `lifetime` 
-00008280: 5b75 706c 6f61 6420 7275 6c65 5d28 2375  [upload rule](#u
-00008290: 706c 6f61 642d 7275 6c65 7329 2077 6869  pload-rules) whi
-000082a0: 6368 2073 6574 7320 7468 6520 7570 7065  ch sets the uppe
-000082b0: 7220 6c69 6d69 7420 666f 7220 686f 7720  r limit for how 
-000082c0: 6c6f 6e67 2061 2066 696c 6520 6765 7473  long a file gets
-000082d0: 2074 6f20 7374 6179 206f 6e20 7468 6520   to stay on the 
-000082e0: 7365 7276 6572 0a0a 636c 6965 6e74 7320  server..clients 
-000082f0: 6361 6e20 7370 6563 6966 7920 6120 7368  can specify a sh
-00008300: 6f72 7465 7220 6578 7069 7261 7469 6f6e  orter expiration
-00008310: 2074 696d 6520 7573 696e 6720 7468 6520   time using the 
-00008320: 5b75 7032 6b20 7569 5d28 2375 706c 6f61  [up2k ui](#uploa
-00008330: 6469 6e67 2920 2d2d 2074 6865 2072 656c  ding) -- the rel
-00008340: 6576 616e 7420 6f70 7469 6f6e 7320 6265  evant options be
-00008350: 636f 6d65 2076 6973 6962 6c65 2075 706f  come visible upo
-00008360: 6e20 6e61 7669 6761 7469 6e67 2069 6e74  n navigating int
-00008370: 6f20 6120 666f 6c64 6572 2077 6974 6820  o a folder with 
-00008380: 606c 6966 6574 696d 6573 6020 656e 6162  `lifetimes` enab
-00008390: 6c65 6420 2d2d 206f 7220 6279 2075 7369  led -- or by usi
-000083a0: 6e67 2074 6865 2060 6c69 6665 6020 5b75  ng the `life` [u
-000083b0: 706c 6f61 6420 6d6f 6469 6669 6572 5d28  pload modifier](
-000083c0: 2377 7269 7465 290a 0a73 7065 6369 6679  #write)..specify
-000083d0: 696e 6720 6120 6375 7374 6f6d 2065 7870  ing a custom exp
-000083e0: 6972 6174 696f 6e20 7469 6d65 2063 6c69  iration time cli
-000083f0: 656e 742d 7369 6465 2077 696c 6c20 6166  ent-side will af
-00008400: 6665 6374 2074 6865 2074 696d 6573 7061  fect the timespa
-00008410: 6e20 696e 2077 6869 6368 2075 6e70 6f73  n in which unpos
-00008420: 7473 2061 7265 2070 6572 6d69 7474 6564  ts are permitted
-00008430: 2c20 736f 206b 6565 7020 616e 2065 7965  , so keep an eye
-00008440: 206f 6e20 7468 6520 6573 7469 6d61 7465   on the estimate
-00008450: 7320 696e 2074 6865 2075 7032 6b20 7569  s in the up2k ui
-00008460: 0a0a 0a23 2320 6669 6c65 206d 616e 6167  ...## file manag
-00008470: 6572 0a0a 6375 742f 7061 7374 652c 2072  er..cut/paste, r
-00008480: 656e 616d 652c 2061 6e64 2064 656c 6574  ename, and delet
-00008490: 6520 6669 6c65 732f 666f 6c64 6572 7320  e files/folders 
-000084a0: 2869 6620 796f 7520 6861 7665 2070 6572  (if you have per
-000084b0: 6d69 7373 696f 6e29 0a0a 6669 6c65 2073  mission)..file s
-000084c0: 656c 6563 7469 6f6e 3a20 636c 6963 6b20  election: click 
-000084d0: 736f 6d65 7768 6572 6520 6f6e 2074 6865  somewhere on the
-000084e0: 206c 696e 6520 286e 6f74 2074 6865 206c   line (not the l
-000084f0: 696e 6b20 6974 7365 6629 2c20 7468 656e  ink itsef), then
-00008500: 3a0a 2a20 6073 7061 6365 6020 746f 2074  :.* `space` to t
-00008510: 6f67 676c 650a 2a20 6075 702f 646f 776e  oggle.* `up/down
-00008520: 6020 746f 206d 6f76 650a 2a20 6073 6869  ` to move.* `shi
-00008530: 6674 2d75 702f 646f 776e 6020 746f 206d  ft-up/down` to m
-00008540: 6f76 652d 616e 642d 7365 6c65 6374 0a2a  ove-and-select.*
-00008550: 2060 6374 726c 2d73 6869 6674 2d75 702f   `ctrl-shift-up/
-00008560: 646f 776e 6020 746f 2061 6c73 6f20 7363  down` to also sc
-00008570: 726f 6c6c 0a0a 2a20 6375 743a 2073 656c  roll..* cut: sel
-00008580: 6563 7420 736f 6d65 2066 696c 6573 2061  ect some files a
-00008590: 6e64 2060 6374 726c 2d78 600a 2a20 7061  nd `ctrl-x`.* pa
-000085a0: 7374 653a 2060 6374 726c 2d76 6020 696e  ste: `ctrl-v` in
-000085b0: 2061 6e6f 7468 6572 2066 6f6c 6465 720a   another folder.
-000085c0: 2a20 7265 6e61 6d65 3a20 6046 3260 0a0a  * rename: `F2`..
-000085d0: 796f 7520 6361 6e20 6d6f 7665 2066 696c  you can move fil
-000085e0: 6573 2061 6372 6f73 7320 6272 6f77 7365  es across browse
-000085f0: 7220 7461 6273 2028 6375 7420 696e 206f  r tabs (cut in o
-00008600: 6e65 2074 6162 2c20 7061 7374 6520 696e  ne tab, paste in
-00008610: 2061 6e6f 7468 6572 290a 0a0a 2323 2062   another)...## b
-00008620: 6174 6368 2072 656e 616d 650a 0a73 656c  atch rename..sel
-00008630: 6563 7420 736f 6d65 2066 696c 6573 2061  ect some files a
-00008640: 6e64 2070 7265 7373 2060 4632 6020 746f  nd press `F2` to
-00008650: 2062 7269 6e67 2075 7020 7468 6520 7265   bring up the re
-00008660: 6e61 6d65 2055 490a 0a21 5b62 6174 6368  name UI..![batch
-00008670: 2d72 656e 616d 652d 6673 385d 2868 7474  -rename-fs8](htt
-00008680: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-00008690: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-000086a0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3132  nt.com/241032/12
-000086b0: 3834 3334 3230 342d 6562 3133 3636 3830  8434204-eb136680
-000086c0: 2d33 6330 372d 3465 6337 2d39 3265 302d  -3c07-4ec7-92e0-
-000086d0: 6165 3836 6166 3230 6332 3431 2e70 6e67  ae86af20c241.png
-000086e0: 290a 0a71 7569 636b 2065 7870 6c61 6e61  )..quick explana
-000086f0: 7469 6f6e 206f 6620 7468 6520 6275 7474  tion of the butt
-00008700: 6f6e 732c 2020 0a2a 2060 5be2 9c85 2061  ons,  .* `[... a
-00008710: 7070 6c79 2072 656e 616d 655d 6020 636f  pply rename]` co
-00008720: 6e66 6972 6d73 2061 6e64 2062 6567 696e  nfirms and begin
-00008730: 7320 7265 6e61 6d69 6e67 0a2a 2060 5be2  s renaming.* `[.
-00008740: 9d8c 2063 616e 6365 6c5d 6020 6162 6f72  .. cancel]` abor
-00008750: 7473 2061 6e64 2063 6c6f 7365 7320 7468  ts and closes th
-00008760: 6520 7265 6e61 6d65 2077 696e 646f 770a  e rename window.
-00008770: 2a20 605b e286 ba20 7265 7365 745d 6020  * `[... reset]` 
-00008780: 7265 7665 7274 7320 616e 7920 6669 6c65  reverts any file
-00008790: 6e61 6d65 2063 6861 6e67 6573 2062 6163  name changes bac
-000087a0: 6b20 746f 2074 6865 206f 7269 6769 6e61  k to the origina
-000087b0: 6c20 6e61 6d65 0a2a 2060 5b64 6563 6f64  l name.* `[decod
-000087c0: 655d 6020 646f 6573 2061 2055 524c 2d64  e]` does a URL-d
-000087d0: 6563 6f64 6520 6f6e 2074 6865 2066 696c  ecode on the fil
-000087e0: 656e 616d 652c 2066 6978 696e 6720 7374  ename, fixing st
-000087f0: 7566 6620 6c69 6b65 2060 2661 6d70 3b60  uff like `&amp;`
-00008800: 2061 6e64 2060 2532 3060 0a2a 2060 5b61   and `%20`.* `[a
-00008810: 6476 616e 6365 645d 6020 746f 6767 6c65  dvanced]` toggle
-00008820: 7320 6164 7661 6e63 6564 206d 6f64 650a  s advanced mode.
-00008830: 0a61 6476 616e 6365 6420 6d6f 6465 3a20  .advanced mode: 
-00008840: 7265 6e61 6d65 2066 696c 6573 2062 6173  rename files bas
-00008850: 6564 206f 6e20 7275 6c65 7320 746f 2064  ed on rules to d
-00008860: 6563 6964 6520 7468 6520 6e65 7720 6e61  ecide the new na
-00008870: 6d65 732c 2062 6173 6564 206f 6e20 7468  mes, based on th
-00008880: 6520 6f72 6967 696e 616c 206e 616d 6520  e original name 
-00008890: 2872 6567 6578 292c 206f 7220 6261 7365  (regex), or base
-000088a0: 6420 6f6e 2074 6865 2074 6167 7320 636f  d on the tags co
-000088b0: 6c6c 6563 7465 6420 6672 6f6d 2074 6865  llected from the
-000088c0: 2066 696c 6520 2861 7274 6973 742f 7469   file (artist/ti
-000088d0: 746c 652f 2e2e 2e29 2c20 6f72 2061 206d  tle/...), or a m
-000088e0: 6978 206f 6620 626f 7468 0a0a 696e 2061  ix of both..in a
-000088f0: 6476 616e 6365 6420 6d6f 6465 2c20 200a  dvanced mode,  .
-00008900: 2a20 605b 6361 7365 5d60 2074 6f67 676c  * `[case]` toggl
-00008910: 6573 2063 6173 652d 7365 6e73 6974 6976  es case-sensitiv
-00008920: 6520 7265 6765 780a 2a20 6072 6567 6578  e regex.* `regex
-00008930: 6020 6973 2074 6865 2072 6567 6578 2070  ` is the regex p
-00008940: 6174 7465 726e 2074 6f20 6170 706c 7920  attern to apply 
-00008950: 746f 2074 6865 206f 7269 6769 6e61 6c20  to the original 
-00008960: 6669 6c65 6e61 6d65 3b20 616e 7920 6669  filename; any fi
-00008970: 6c65 7320 7768 6963 6820 646f 6e27 7420  les which don't 
-00008980: 6d61 7463 6820 7769 6c6c 2062 6520 736b  match will be sk
-00008990: 6970 7065 640a 2a20 6066 6f72 6d61 7460  ipped.* `format`
-000089a0: 2069 7320 7468 6520 6e65 7720 6669 6c65   is the new file
-000089b0: 6e61 6d65 2c20 7461 6b69 6e67 2076 616c  name, taking val
-000089c0: 7565 7320 6672 6f6d 2072 6567 6578 2063  ues from regex c
-000089d0: 6170 7475 7269 6e67 2067 726f 7570 7320  apturing groups 
-000089e0: 616e 642f 6f72 2066 726f 6d20 6669 6c65  and/or from file
-000089f0: 2074 6167 730a 2020 2a20 7665 7279 206c   tags.  * very l
-00008a00: 6f6f 7365 6c79 2062 6173 6564 206f 6e20  oosely based on 
-00008a10: 666f 6f62 6172 3230 3030 2073 796e 7461  foobar2000 synta
-00008a20: 780a 2a20 6070 7265 7365 7473 6020 6c65  x.* `presets` le
-00008a30: 7473 2079 6f75 2073 6176 6520 7265 6e61  ts you save rena
-00008a40: 6d65 2072 756c 6573 2066 6f72 206c 6174  me rules for lat
-00008a50: 6572 0a0a 6176 6169 6c61 626c 6520 6675  er..available fu
-00008a60: 6e63 7469 6f6e 733a 0a2a 2060 246c 7061  nctions:.* `$lpa
-00008a70: 6428 7465 7874 2c20 6c65 6e67 7468 2c20  d(text, length, 
-00008a80: 7061 645f 6368 6172 2960 0a2a 2060 2472  pad_char)`.* `$r
-00008a90: 7061 6428 7465 7874 2c20 6c65 6e67 7468  pad(text, length
-00008aa0: 2c20 7061 645f 6368 6172 2960 0a0a 736f  , pad_char)`..so
-00008ab0: 2c0a 0a73 6179 2079 6f75 2068 6176 6520  ,..say you have 
-00008ac0: 6120 6669 6c65 206e 616d 6564 205b 606d  a file named [`m
-00008ad0: 6567 616e 656b 6f20 2d20 4563 6c69 7073  eganeko - Eclips
-00008ae0: 6520 2d20 3037 2053 6972 6975 7320 412e  e - 07 Sirius A.
-00008af0: 6d70 3360 5d28 6874 7470 733a 2f2f 7777  mp3`](https://ww
-00008b00: 772e 796f 7574 7562 652e 636f 6d2f 7761  w.youtube.com/wa
-00008b10: 7463 683f 763d 2d64 7462 3076 4450 7275  tch?v=-dtb0vDPru
-00008b20: 4929 2028 6162 736f 6c75 7465 6c79 2066  I) (absolutely f
-00008b30: 616e 7461 7374 6963 2061 6c62 756d 2062  antastic album b
-00008b40: 7477 2920 616e 6420 7468 6520 7461 6773  tw) and the tags
-00008b50: 2061 7265 3a20 6041 6c62 756d 3a45 636c   are: `Album:Ecl
-00008b60: 6970 7365 602c 2060 4172 7469 7374 3a6d  ipse`, `Artist:m
-00008b70: 6567 616e 656b 6f60 2c20 6054 6974 6c65  eganeko`, `Title
-00008b80: 3a53 6972 6975 7320 4160 2c20 6074 6e3a  :Sirius A`, `tn:
-00008b90: 3760 0a0a 796f 7520 636f 756c 6420 7573  7`..you could us
-00008ba0: 6520 6a75 7374 2072 6567 6578 2074 6f20  e just regex to 
-00008bb0: 7265 6e61 6d65 2069 743a 0a2a 2060 7265  rename it:.* `re
-00008bc0: 6765 7860 203d 2060 282e 2a29 202d 2028  gex` = `(.*) - (
-00008bd0: 2e2a 2920 2d20 285b 302d 395d 7b32 7d29  .*) - ([0-9]{2})
-00008be0: 2028 2e2a 2960 0a2a 2060 666f 726d 6174   (.*)`.* `format
-00008bf0: 6020 3d20 6028 3329 2e20 2831 2920 2d20  ` = `(3). (1) - 
-00008c00: 2834 2960 0a2a 2060 6f75 7470 7574 6020  (4)`.* `output` 
-00008c10: 3d20 6030 372e 206d 6567 616e 656b 6f20  = `07. meganeko 
-00008c20: 2d20 5369 7269 7573 2041 2e6d 7033 600a  - Sirius A.mp3`.
-00008c30: 0a6f 7220 796f 7520 636f 756c 6420 7573  .or you could us
-00008c40: 6520 6a75 7374 2074 6167 733a 0a2a 2060  e just tags:.* `
-00008c50: 666f 726d 6174 6020 3d20 6024 6c70 6164  format` = `$lpad
-00008c60: 2828 746e 292c 322c 3029 2e20 2861 7274  ((tn),2,0). (art
-00008c70: 6973 7429 202d 2028 7469 746c 6529 2e28  ist) - (title).(
-00008c80: 6578 7429 600a 2a20 606f 7574 7075 7460  ext)`.* `output`
-00008c90: 203d 2060 372e 206d 6567 616e 656b 6f20   = `7. meganeko 
-00008ca0: 2d20 5369 7269 7573 2041 2e6d 7033 600a  - Sirius A.mp3`.
-00008cb0: 0a6f 7220 6120 6d69 7820 6f66 2062 6f74  .or a mix of bot
-00008cc0: 683a 0a2a 2060 7265 6765 7860 203d 2060  h:.* `regex` = `
-00008cd0: 202d 2028 5b30 2d39 5d7b 327d 2920 600a   - ([0-9]{2}) `.
-00008ce0: 2a20 6066 6f72 6d61 7460 203d 2060 2831  * `format` = `(1
-00008cf0: 292e 2028 6172 7469 7374 2920 2d20 2874  ). (artist) - (t
-00008d00: 6974 6c65 292e 2865 7874 2960 0a2a 2060  itle).(ext)`.* `
-00008d10: 6f75 7470 7574 6020 3d20 6030 372e 206d  output` = `07. m
-00008d20: 6567 616e 656b 6f20 2d20 5369 7269 7573  eganeko - Sirius
-00008d30: 2041 2e6d 7033 600a 0a74 6865 206d 6574   A.mp3`..the met
-00008d40: 6164 6174 6120 6b65 7973 2079 6f75 2063  adata keys you c
-00008d50: 616e 2075 7365 2069 6e20 7468 6520 666f  an use in the fo
-00008d60: 726d 6174 2066 6965 6c64 2061 7265 2074  rmat field are t
-00008d70: 6865 206f 6e65 7320 696e 2074 6865 2066  he ones in the f
-00008d80: 696c 652d 6272 6f77 7365 7220 7461 626c  ile-browser tabl
-00008d90: 6520 6865 6164 6572 2028 7768 6174 6576  e header (whatev
-00008da0: 6572 2069 7320 636f 6c6c 6563 7465 6420  er is collected 
-00008db0: 7769 7468 2060 2d6d 7465 6020 616e 6420  with `-mte` and 
-00008dc0: 602d 6d74 7060 290a 0a0a 2323 206d 6172  `-mtp`)...## mar
-00008dd0: 6b64 6f77 6e20 7669 6577 6572 0a0a 616e  kdown viewer..an
-00008de0: 6420 7468 6572 6520 6172 6520 2a74 776f  d there are *two
-00008df0: 2a20 6564 6974 6f72 730a 0a21 5b63 6f70  * editors..![cop
-00008e00: 7970 6172 7479 2d6d 642d 7265 6164 2d66  yparty-md-read-f
-00008e10: 7338 5d28 6874 7470 733a 2f2f 7573 6572  s8](https://user
-00008e20: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00008e30: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-00008e40: 3130 3332 2f31 3135 3937 3830 3537 2d36  1032/115978057-6
-00008e50: 3634 3139 3038 302d 6135 3764 2d31 3165  6419080-a57d-11e
-00008e60: 622d 3835 3339 2d64 3262 6538 3433 3939  b-8539-d2be84399
-00008e70: 3161 612e 706e 6729 0a0a 2a20 7468 6520  1aa.png)..* the 
-00008e80: 646f 6375 6d65 6e74 2070 7265 7669 6577  document preview
-00008e90: 2068 6173 2061 206d 6178 2d77 6964 7468   has a max-width
-00008ea0: 2077 6869 6368 2069 7320 7468 6520 7361   which is the sa
-00008eb0: 6d65 2061 7320 616e 2041 3420 7061 7065  me as an A4 pape
-00008ec0: 7220 7768 656e 2070 7269 6e74 6564 0a0a  r when printed..
-00008ed0: 0a23 2320 6f74 6865 7220 7472 6963 6b73  .## other tricks
-00008ee0: 0a0a 2a20 796f 7520 6361 6e20 6c69 6e6b  ..* you can link
-00008ef0: 2061 2070 6172 7469 6375 6c61 7220 7469   a particular ti
-00008f00: 6d65 7374 616d 7020 696e 2061 6e20 6175  mestamp in an au
-00008f10: 6469 6f20 6669 6c65 2062 7920 6164 6469  dio file by addi
-00008f20: 6e67 2069 7420 746f 2074 6865 2055 524c  ng it to the URL
-00008f30: 2c20 7375 6368 2061 7320 6026 3230 6020  , such as `&20` 
-00008f40: 2f20 6026 3230 7360 202f 2060 2631 6d32  / `&20s` / `&1m2
-00008f50: 3060 202f 2060 2674 3d31 3a32 3060 2061  0` / `&t=1:20` a
-00008f60: 6674 6572 2074 6865 2060 2e2e 2e2f 2361  fter the `.../#a
-00008f70: 662d 6338 3936 3064 6162 600a 0a2a 2065  f-c8960dab`..* e
-00008f80: 6e61 626c 696e 6720 7468 6520 6175 6469  nabling the audi
-00008f90: 6f20 6571 7561 6c69 7a65 7220 6361 6e20  o equalizer can 
-00008fa0: 6865 6c70 206d 616b 6520 6761 706c 6573  help make gaples
-00008fb0: 7320 616c 6275 6d73 2066 756c 6c79 2067  s albums fully g
-00008fc0: 6170 6c65 7373 2069 6e20 736f 6d65 2062  apless in some b
-00008fd0: 726f 7773 6572 7320 2863 6872 6f6d 6529  rowsers (chrome)
-00008fe0: 2c20 736f 2063 6f6e 7369 6465 7220 6c65  , so consider le
-00008ff0: 6176 696e 6720 6974 206f 6e20 7769 7468  aving it on with
-00009000: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
-00009010: 6174 207a 6572 6f0a 0a2a 2067 6574 2061  at zero..* get a
-00009020: 2070 6c61 696e 7465 7874 2066 696c 6520   plaintext file 
-00009030: 6c69 7374 696e 6720 6279 2061 6464 696e  listing by addin
-00009040: 6720 603f 6c73 3d74 6020 746f 2061 2055  g `?ls=t` to a U
-00009050: 524c 2c20 6f72 2061 2063 6f6d 7061 6374  RL, or a compact
-00009060: 2063 6f6c 6f72 6564 206f 6e65 2077 6974   colored one wit
-00009070: 6820 603f 6c73 3d76 6020 2866 6f72 2075  h `?ls=v` (for u
-00009080: 6e69 7820 7465 726d 696e 616c 7329 0a0a  nix terminals)..
-00009090: 2a20 6966 2079 6f75 2061 7265 2075 7369  * if you are usi
-000090a0: 6e67 206d 6564 6961 2068 6f74 6b65 7973  ng media hotkeys
-000090b0: 2074 6f20 7377 6974 6368 2073 6f6e 6773   to switch songs
-000090c0: 2061 6e64 2061 7265 2067 6574 7469 6e67   and are getting
-000090d0: 2074 6972 6564 206f 6620 7365 6569 6e67   tired of seeing
-000090e0: 2074 6865 204f 5344 2070 6f70 7570 2077   the OSD popup w
-000090f0: 6869 6368 2057 696e 646f 7773 2064 6f65  hich Windows doe
-00009100: 736e 2774 206c 6574 2079 6f75 2064 6973  sn't let you dis
-00009110: 6162 6c65 2c20 636f 6e73 6964 6572 205b  able, consider [
-00009120: 2e2f 636f 6e74 7269 622f 6d65 6469 612d  ./contrib/media-
-00009130: 6f73 642d 6267 6f6e 652e 7073 315d 2863  osd-bgone.ps1](c
-00009140: 6f6e 7472 6962 2f23 6d65 6469 612d 6f73  ontrib/#media-os
-00009150: 642d 6267 6f6e 6570 7331 290a 0a2a 2063  d-bgoneps1)..* c
-00009160: 6c69 636b 2074 6865 2062 6f74 746f 6d2d  lick the bottom-
-00009170: 6c65 6674 2060 cf80 6020 746f 206f 7065  left `..` to ope
-00009180: 6e20 6120 6a61 7661 7363 7269 7074 2070  n a javascript p
-00009190: 726f 6d70 7420 666f 7220 6465 6275 6767  rompt for debugg
-000091a0: 696e 670a 0a2a 2066 696c 6573 206e 616d  ing..* files nam
-000091b0: 6564 2060 2e70 726f 6c6f 6775 652e 6874  ed `.prologue.ht
-000091c0: 6d6c 6020 2f20 602e 6570 696c 6f67 7565  ml` / `.epilogue
-000091d0: 2e68 746d 6c60 2077 696c 6c20 6265 2072  .html` will be r
-000091e0: 656e 6465 7265 6420 6265 666f 7265 2f61  endered before/a
-000091f0: 6674 6572 2064 6972 6563 746f 7279 206c  fter directory l
-00009200: 6973 7469 6e67 7320 756e 6c65 7373 2060  istings unless `
-00009210: 2d2d 6e6f 2d6c 6f67 7565 7360 0a0a 2a20  --no-logues`..* 
-00009220: 6669 6c65 7320 6e61 6d65 6420 6052 4541  files named `REA
-00009230: 444d 452e 6d64 6020 2f20 6072 6561 646d  DME.md` / `readm
-00009240: 652e 6d64 6020 7769 6c6c 2062 6520 7265  e.md` will be re
-00009250: 6e64 6572 6564 2061 6674 6572 2064 6972  ndered after dir
-00009260: 6563 746f 7279 206c 6973 7469 6e67 7320  ectory listings 
-00009270: 756e 6c65 7373 2060 2d2d 6e6f 2d72 6561  unless `--no-rea
-00009280: 646d 6560 2028 6275 7420 602e 6570 696c  dme` (but `.epil
-00009290: 6f67 7565 2e68 746d 6c60 2074 616b 6573  ogue.html` takes
-000092a0: 2070 7265 6365 6465 6e63 6529 0a0a 0a23   precedence)...#
-000092b0: 2320 7365 6172 6368 696e 670a 0a73 6561  # searching..sea
-000092c0: 7263 6820 6279 2073 697a 652c 2064 6174  rch by size, dat
-000092d0: 652c 2070 6174 682f 6e61 6d65 2c20 6d70  e, path/name, mp
-000092e0: 332d 7461 6773 2c20 2e2e 2e0a 0a21 5b63  3-tags, .....![c
-000092f0: 6f70 7970 6172 7479 2d73 6561 7263 682d  opyparty-search-
-00009300: 6673 385d 2868 7474 7073 3a2f 2f75 7365  fs8](https://use
-00009310: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-00009320: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-00009330: 3431 3033 322f 3132 3936 3335 3336 352d  41032/129635365-
-00009340: 6330 6666 3261 3966 2d30 6565 352d 3466  c0ff2a9f-0ee5-4f
-00009350: 6333 2d38 6262 362d 3030 3630 3333 6366  c3-8bb6-006033cf
-00009360: 3637 6238 2e70 6e67 290a 0a77 6865 6e20  67b8.png)..when 
-00009370: 7374 6172 7465 6420 7769 7468 2060 2d65  started with `-e
-00009380: 3264 7361 6020 636f 7079 7061 7274 7920  2dsa` copyparty 
-00009390: 7769 6c6c 2073 6361 6e2f 696e 6465 7820  will scan/index 
-000093a0: 616c 6c20 796f 7572 2066 696c 6573 2e20  all your files. 
-000093b0: 5468 6973 2061 766f 6964 7320 6475 706c  This avoids dupl
-000093c0: 6963 6174 6573 206f 6e20 7570 6c6f 6164  icates on upload
-000093d0: 2c20 616e 6420 616c 736f 206d 616b 6573  , and also makes
-000093e0: 2074 6865 2076 6f6c 756d 6573 2073 6561   the volumes sea
-000093f0: 7263 6861 626c 6520 7468 726f 7567 6820  rchable through 
-00009400: 7468 6520 7765 622d 7569 3a0a 2a20 6d61  the web-ui:.* ma
-00009410: 6b65 2073 6561 7263 6820 7175 6572 6965  ke search querie
-00009420: 7320 6279 2060 7369 7a65 602f 6064 6174  s by `size`/`dat
-00009430: 6560 2f60 6469 7265 6374 6f72 792d 7061  e`/`directory-pa
-00009440: 7468 602f 6066 696c 656e 616d 6560 2c20  th`/`filename`, 
-00009450: 6f72 2e2e 2e0a 2a20 6472 6167 2f64 726f  or....* drag/dro
-00009460: 7020 6120 6c6f 6361 6c20 6669 6c65 2074  p a local file t
-00009470: 6f20 7365 6520 6966 2074 6865 2073 616d  o see if the sam
-00009480: 6520 636f 6e74 656e 7473 2065 7869 7374  e contents exist
-00009490: 2073 6f6d 6577 6865 7265 206f 6e20 7468   somewhere on th
-000094a0: 6520 7365 7276 6572 2c20 7365 6520 5b66  e server, see [f
-000094b0: 696c 652d 7365 6172 6368 5d28 2366 696c  ile-search](#fil
-000094c0: 652d 7365 6172 6368 290a 0a70 6174 682f  e-search)..path/
-000094d0: 6e61 6d65 2071 7565 7269 6573 2061 7265  name queries are
-000094e0: 2073 7061 6365 2d73 6570 6172 6174 6564   space-separated
-000094f0: 2c20 414e 4427 6564 2074 6f67 6574 6865  , AND'ed togethe
-00009500: 722c 2061 6e64 2077 6f72 6473 2061 7265  r, and words are
-00009510: 206e 6567 6174 6564 2077 6974 6820 6120   negated with a 
-00009520: 602d 6020 7072 6566 6978 2c20 736f 2066  `-` prefix, so f
-00009530: 6f72 2065 7861 6d70 6c65 3a0a 2a20 7061  or example:.* pa
-00009540: 7468 3a20 6073 6869 6261 7961 6e20 2d62  th: `shibayan -b
-00009550: 6f73 7361 6020 6669 6e64 7320 616c 6c20  ossa` finds all 
-00009560: 6669 6c65 7320 7768 6572 6520 6f6e 6520  files where one 
-00009570: 6f66 2074 6865 2066 6f6c 6465 7273 2063  of the folders c
-00009580: 6f6e 7461 696e 2060 7368 6962 6179 616e  ontain `shibayan
-00009590: 6020 6275 7420 6669 6c74 6572 7320 6f75  ` but filters ou
-000095a0: 7420 616e 7920 7265 7375 6c74 7320 7768  t any results wh
-000095b0: 6572 6520 6062 6f73 7361 6020 6578 6973  ere `bossa` exis
-000095c0: 7473 2073 6f6d 6577 6865 7265 2069 6e20  ts somewhere in 
-000095d0: 7468 6520 7061 7468 0a2a 206e 616d 653a  the path.* name:
-000095e0: 2060 6465 6d65 746f 7269 2073 7479 7860   `demetori styx`
-000095f0: 2067 6976 6573 2079 6f75 205b 676f 6f64   gives you [good
-00009600: 2073 7475 6666 5d28 6874 7470 733a 2f2f   stuff](https://
-00009610: 7777 772e 796f 7574 7562 652e 636f 6d2f  www.youtube.com/
-00009620: 7761 7463 683f 763d 7a47 6830 6731 345a  watch?v=zGh0g14Z
-00009630: 4a38 4926 6c69 7374 3d50 4c33 4131 3437  J8I&list=PL3A147
-00009640: 4244 3135 3145 4535 3231 3826 696e 6465  BD151EE5218&inde
-00009650: 783d 3929 0a0a 7468 6520 6072 6177 6020  x=9)..the `raw` 
-00009660: 6669 656c 6420 616c 6c6f 7773 2066 6f72  field allows for
-00009670: 206d 6f72 6520 636f 6d70 6c65 7820 7374   more complex st
-00009680: 7566 6620 7375 6368 2061 7320 6028 2074  uff such as `( t
-00009690: 6167 7320 6c69 6b65 202a 6e68 6174 6f2a  ags like *nhato*
-000096a0: 206f 7220 7461 6773 206c 696b 6520 2a74   or tags like *t
-000096b0: 6169 7368 692a 2029 2061 6e64 2028 206e  aishi* ) and ( n
-000096c0: 6f74 2074 6167 7320 6c69 6b65 202a 6e68  ot tags like *nh
-000096d0: 6174 6f2a 206f 7220 6e6f 7420 7461 6773  ato* or not tags
-000096e0: 206c 696b 6520 2a74 6169 7368 692a 2029   like *taishi* )
-000096f0: 6020 7768 6963 6820 6669 6e64 7320 616c  ` which finds al
-00009700: 6c20 736f 6e67 7320 6279 2065 6974 6865  l songs by eithe
-00009710: 7220 6e68 6174 6f20 6f72 2074 6169 7368  r nhato or taish
-00009720: 692c 2065 7863 6c75 6469 6e67 2063 6f6c  i, excluding col
-00009730: 6c61 6273 2028 7465 7272 6962 6c65 2065  labs (terrible e
-00009740: 7861 6d70 6c65 2c20 7768 7920 776f 756c  xample, why woul
-00009750: 6420 796f 7520 646f 2074 6861 7429 0a0a  d you do that)..
-00009760: 666f 7220 7468 6520 6162 6f76 6520 6578  for the above ex
-00009770: 616d 706c 6520 746f 2077 6f72 6b2c 2061  ample to work, a
-00009780: 6464 2074 6865 2063 6f6d 6d61 6e64 6c69  dd the commandli
-00009790: 6e65 2061 7267 756d 656e 7420 602d 6532  ne argument `-e2
-000097a0: 7473 6020 746f 2061 6c73 6f20 7363 616e  ts` to also scan
-000097b0: 2f69 6e64 6578 2074 6167 7320 6672 6f6d  /index tags from
-000097c0: 206d 7573 6963 2066 696c 6573 2c20 7768   music files, wh
-000097d0: 6963 6820 6272 696e 6773 2075 7320 6f76  ich brings us ov
-000097e0: 6572 2074 6f3a 0a0a 0a23 2073 6572 7665  er to:...# serve
-000097f0: 7220 636f 6e66 6967 0a0a 7573 696e 6720  r config..using 
-00009800: 6172 6775 6d65 6e74 7320 6f72 2063 6f6e  arguments or con
-00009810: 6669 6720 6669 6c65 732c 206f 7220 6120  fig files, or a 
-00009820: 6d69 7820 6f66 2062 6f74 683a 0a2a 2063  mix of both:.* c
-00009830: 6f6e 6669 6720 6669 6c65 7320 2860 2d63  onfig files (`-c
-00009840: 2073 6f6d 652e 636f 6e66 6029 2063 616e   some.conf`) can
-00009850: 2073 6574 2061 6464 6974 696f 6e61 6c20   set additional 
-00009860: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
-00009870: 6d65 6e74 733b 2073 6565 205b 2e2f 646f  ments; see [./do
-00009880: 6373 2f65 7861 6d70 6c65 2e63 6f6e 665d  cs/example.conf]
-00009890: 2864 6f63 732f 6578 616d 706c 652e 636f  (docs/example.co
-000098a0: 6e66 2920 616e 6420 5b2e 2f64 6f63 732f  nf) and [./docs/
-000098b0: 6578 616d 706c 6532 2e63 6f6e 665d 2864  example2.conf](d
-000098c0: 6f63 732f 6578 616d 706c 6532 2e63 6f6e  ocs/example2.con
-000098d0: 6629 0a2a 2060 6b69 6c6c 202d 7320 5553  f).* `kill -s US
-000098e0: 5231 6020 2873 616d 6520 6173 2060 7379  R1` (same as `sy
-000098f0: 7374 656d 6374 6c20 7265 6c6f 6164 2063  stemctl reload c
-00009900: 6f70 7970 6172 7479 6029 2074 6f20 7265  opyparty`) to re
-00009910: 6c6f 6164 2061 6363 6f75 6e74 7320 616e  load accounts an
-00009920: 6420 766f 6c75 6d65 7320 6672 6f6d 2063  d volumes from c
-00009930: 6f6e 6669 6720 6669 6c65 7320 7769 7468  onfig files with
-00009940: 6f75 7420 7265 7374 6172 7469 6e67 0a20  out restarting. 
-00009950: 202a 206f 7220 636c 6963 6b20 7468 6520   * or click the 
-00009960: 605b 7265 6c6f 6164 2063 6667 5d60 2062  `[reload cfg]` b
-00009970: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
-00009980: 7472 6f6c 2d70 616e 656c 2077 6865 6e20  trol-panel when 
-00009990: 6c6f 6767 6564 2069 6e20 6173 2061 646d  logged in as adm
-000099a0: 696e 200a 2020 2a20 6368 616e 6765 7320  in .  * changes 
-000099b0: 746f 2074 6865 2060 5b67 6c6f 6261 6c5d  to the `[global]
-000099c0: 6020 636f 6e66 6967 2073 6563 7469 6f6e  ` config section
-000099d0: 2072 6571 7569 7265 7320 6120 7265 7374   requires a rest
-000099e0: 6172 7420 746f 2074 616b 6520 6566 6665  art to take effe
-000099f0: 6374 0a0a 0a23 2320 7a65 726f 636f 6e66  ct...## zeroconf
-00009a00: 0a0a 616e 6e6f 756e 6365 2065 6e61 626c  ..announce enabl
-00009a10: 6564 2073 6572 7669 6365 7320 6f6e 2074  ed services on t
-00009a20: 6865 204c 414e 2028 5b70 6963 5d28 6874  he LAN ([pic](ht
-00009a30: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-00009a40: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-00009a50: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
-00009a60: 3135 3334 3437 3337 2d30 6561 6538 6439  15344737-0eae8d9
-00009a70: 382d 3934 3936 2d34 3235 362d 3961 6138  8-9496-4256-9aa8
-00009a80: 2d63 6432 6636 3937 3138 3130 642e 706e  -cd2f6971810d.pn
-00009a90: 6729 2920 202d 2d20 602d 7a60 2065 6e61  g))  -- `-z` ena
-00009aa0: 626c 6573 2062 6f74 6820 5b6d 646e 735d  bles both [mdns]
-00009ab0: 2823 6d64 6e73 2920 616e 6420 5b73 7364  (#mdns) and [ssd
-00009ac0: 705d 2823 7373 6470 290a 0a2a 2060 2d2d  p](#ssdp)..* `--
-00009ad0: 7a2d 6f6e 6020 2f20 602d 2d7a 2d6f 6666  z-on` / `--z-off
-00009ae0: 6027 206c 696d 6974 7320 7468 6520 6665  `' limits the fe
-00009af0: 6174 7572 6520 746f 2063 6572 7461 696e  ature to certain
-00009b00: 206e 6574 776f 726b 730a 0a0a 2323 2320   networks...### 
-00009b10: 6d64 6e73 0a0a 4c41 4e20 646f 6d61 696e  mdns..LAN domain
-00009b20: 2d6e 616d 6520 616e 6420 6665 6174 7572  -name and featur
-00009b30: 6520 616e 6e6f 756e 6365 720a 0a75 7365  e announcer..use
-00009b40: 7320 5b6d 756c 7469 6361 7374 2064 6e73  s [multicast dns
-00009b50: 5d28 6874 7470 733a 2f2f 656e 2e77 696b  ](https://en.wik
-00009b60: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00009b70: 4d75 6c74 6963 6173 745f 444e 5329 2074  Multicast_DNS) t
-00009b80: 6f20 6769 7665 2063 6f70 7970 6172 7479  o give copyparty
-00009b90: 2061 2064 6f6d 6169 6e20 7768 6963 6820   a domain which 
-00009ba0: 616e 7920 6d61 6368 696e 6520 6f6e 2074  any machine on t
-00009bb0: 6865 204c 414e 2063 616e 2075 7365 2074  he LAN can use t
-00009bc0: 6f20 6163 6365 7373 2069 740a 0a61 6c6c  o access it..all
-00009bd0: 2065 6e61 626c 6564 2073 6572 7669 6365   enabled service
-00009be0: 7320 285b 7765 6264 6176 5d28 2377 6562  s ([webdav](#web
-00009bf0: 6461 762d 7365 7276 6572 292c 205b 6674  dav-server), [ft
-00009c00: 705d 2823 6674 702d 7365 7276 6572 292c  p](#ftp-server),
-00009c10: 205b 736d 625d 2823 736d 622d 7365 7276   [smb](#smb-serv
-00009c20: 6572 2929 2077 696c 6c20 6170 7065 6172  er)) will appear
-00009c30: 2069 6e20 6d44 4e53 2d61 7761 7265 2066   in mDNS-aware f
-00009c40: 696c 6520 6d61 6e61 6765 7273 2028 4b44  ile managers (KD
-00009c50: 452c 2067 6e6f 6d65 2c20 6d61 634f 532c  E, gnome, macOS,
-00009c60: 202e 2e2e 290a 0a74 6865 2064 6f6d 6169   ...)..the domai
-00009c70: 6e20 7769 6c6c 2062 6520 6874 7470 3a2f  n will be http:/
-00009c80: 2f70 6172 7479 626f 782e 6c6f 6361 6c20  /partybox.local 
-00009c90: 6966 2074 6865 206d 6163 6869 6e65 2773  if the machine's
-00009ca0: 2068 6f73 746e 616d 6520 6973 2060 7061   hostname is `pa
-00009cb0: 7274 7962 6f78 6020 756e 6c65 7373 2060  rtybox` unless `
-00009cc0: 2d2d 6e61 6d65 6020 7370 6563 6966 6965  --name` specifie
-00009cd0: 7320 736f 656d 7468 696e 6720 656c 7365  s soemthing else
-00009ce0: 0a0a 0a23 2323 2073 7364 700a 0a77 696e  ...### ssdp..win
-00009cf0: 646f 7773 2d65 7870 6c6f 7265 7220 616e  dows-explorer an
-00009d00: 6e6f 756e 6365 720a 0a75 7365 7320 5b73  nouncer..uses [s
-00009d10: 7364 705d 2868 7474 7073 3a2f 2f65 6e2e  sdp](https://en.
-00009d20: 7769 6b69 7065 6469 612e 6f72 672f 7769  wikipedia.org/wi
-00009d30: 6b69 2f53 696d 706c 655f 5365 7276 6963  ki/Simple_Servic
-00009d40: 655f 4469 7363 6f76 6572 795f 5072 6f74  e_Discovery_Prot
-00009d50: 6f63 6f6c 2920 746f 206d 616b 6520 636f  ocol) to make co
-00009d60: 7079 7061 7274 7920 6170 7065 6172 2069  pyparty appear i
-00009d70: 6e20 7468 6520 7769 6e64 6f77 7320 6669  n the windows fi
-00009d80: 6c65 2065 7870 6c6f 7265 7220 6f6e 2061  le explorer on a
-00009d90: 6c6c 206d 6163 6869 6e65 7320 6f6e 2074  ll machines on t
-00009da0: 6865 204c 414e 0a0a 646f 7562 6c65 636c  he LAN..doublecl
-00009db0: 6963 6b69 6e67 2074 6865 2069 636f 6e20  icking the icon 
-00009dc0: 6f70 656e 7320 7468 6520 2263 6f6e 6e65  opens the "conne
-00009dd0: 6374 2220 7061 6765 2077 6869 6368 2065  ct" page which e
-00009de0: 7870 6c61 696e 7320 686f 7720 746f 206d  xplains how to m
-00009df0: 6f75 6e74 2063 6f70 7970 6172 7479 2061  ount copyparty a
-00009e00: 7320 6120 6c6f 6361 6c20 6669 6c65 7379  s a local filesy
-00009e10: 7374 656d 0a0a 6966 2063 6f70 7970 6172  stem..if copypar
-00009e20: 7479 2064 6f65 7320 6e6f 7420 6170 7065  ty does not appe
-00009e30: 6172 2069 6e20 7769 6e64 6f77 7320 6578  ar in windows ex
-00009e40: 706c 6f72 6572 2c20 7573 6520 602d 2d7a  plorer, use `--z
-00009e50: 7376 6020 746f 2073 6565 2077 6879 3a0a  sv` to see why:.
-00009e60: 0a2a 206d 6179 6265 2074 6865 2064 6973  .* maybe the dis
-00009e70: 636f 7665 7279 206d 756c 7469 6361 7374  covery multicast
-00009e80: 2077 6173 2073 656e 7420 6672 6f6d 2061   was sent from a
-00009e90: 6e20 4950 2077 6869 6368 2064 6f65 7320  n IP which does 
-00009ea0: 6e6f 7420 696e 7465 7273 6563 7420 7769  not intersect wi
-00009eb0: 7468 2074 6865 2073 6572 7665 7220 7375  th the server su
-00009ec0: 626e 6574 730a 0a0a 2323 2071 722d 636f  bnets...## qr-co
-00009ed0: 6465 0a0a 7072 696e 7420 6120 7172 2d63  de..print a qr-c
-00009ee0: 6f64 6520 5b28 7363 7265 656e 7368 6f74  ode [(screenshot
-00009ef0: 295d 2868 7474 7073 3a2f 2f75 7365 722d  )](https://user-
-00009f00: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
-00009f10: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
-00009f20: 3033 322f 3139 3437 3238 3533 332d 3666  032/194728533-6f
-00009f30: 3030 3834 3962 2d63 3661 632d 3433 6336  00849b-c6ac-43c6
-00009f40: 2d39 3335 392d 3833 6534 3534 6431 3165  -9359-83e454d11e
-00009f50: 3030 2e70 6e67 2920 666f 7220 7175 6963  00.png) for quic
-00009f60: 6b20 6163 6365 7373 2c20 2067 7265 6174  k access,  great
-00009f70: 2062 6574 7765 656e 2070 686f 6e65 7320   between phones 
-00009f80: 6f6e 2061 6e64 726f 6964 2068 6f74 7370  on android hotsp
-00009f90: 6f74 7320 7768 6963 6820 6b65 6570 2063  ots which keep c
-00009fa0: 6861 6e67 696e 6720 7468 6520 7375 626e  hanging the subn
-00009fb0: 6574 0a0a 2a20 602d 2d71 7260 2065 6e61  et..* `--qr` ena
-00009fc0: 626c 6573 2069 740a 2a20 602d 2d71 7273  bles it.* `--qrs
-00009fd0: 6020 646f 6573 2068 7474 7073 2069 6e73  ` does https ins
-00009fe0: 7465 6164 206f 6620 6874 7470 0a2a 2060  tead of http.* `
-00009ff0: 2d2d 7172 6c20 6c6f 6f74 626f 782f 3f70  --qrl lootbox/?p
-0000a000: 773d 6875 6e74 6572 3260 2061 7070 656e  w=hunter2` appen
-0000a010: 6473 2074 6f20 7468 6520 7572 6c2c 206c  ds to the url, l
-0000a020: 696e 6b69 6e67 2074 6f20 7468 6520 606c  inking to the `l
-0000a030: 6f6f 7462 6f78 6020 666f 6c64 6572 2077  ootbox` folder w
-0000a040: 6974 6820 7061 7373 776f 7264 2060 6875  ith password `hu
-0000a050: 6e74 6572 3260 0a2a 2060 2d2d 7172 7a20  nter2`.* `--qrz 
-0000a060: 3160 2066 6f72 6365 7320 3178 207a 6f6f  1` forces 1x zoo
-0000a070: 6d20 696e 7374 6561 6420 6f66 2061 7574  m instead of aut
-0000a080: 6f73 6361 6c69 6e67 2074 6f20 6669 7420  oscaling to fit 
-0000a090: 7468 6520 7465 726d 696e 616c 2073 697a  the terminal siz
-0000a0a0: 650a 2020 2a20 3178 206d 6179 2072 656e  e.  * 1x may ren
-0000a0b0: 6465 7220 696e 636f 7272 6563 746c 7920  der incorrectly 
-0000a0c0: 6f6e 2073 6f6d 6520 7465 726d 696e 616c  on some terminal
-0000a0d0: 732f 666f 6e74 732c 2062 7574 2032 7820  s/fonts, but 2x 
-0000a0e0: 7368 6f75 6c64 2061 6c77 6179 7320 776f  should always wo
-0000a0f0: 726b 0a0a 6974 2075 7365 7320 7468 6520  rk..it uses the 
-0000a100: 7365 7276 6572 2068 6f73 746e 616d 6520  server hostname 
-0000a110: 6966 205b 6d64 6e73 5d28 236d 646e 7329  if [mdns](#mdns)
-0000a120: 2069 7320 656e 626c 6564 2c20 6f74 6865   is enbled, othe
-0000a130: 7277 6973 6520 6974 276c 6c20 7573 6520  rwise it'll use 
-0000a140: 796f 7572 2065 7874 6572 6e61 6c20 6970  your external ip
-0000a150: 2028 6465 6661 756c 7420 726f 7574 6529   (default route)
-0000a160: 2075 6e6c 6573 7320 602d 2d71 7269 6020   unless `--qri` 
-0000a170: 7370 6563 6966 6965 7320 6120 7370 6563  specifies a spec
-0000a180: 6966 6963 2069 702d 7072 6566 6978 206f  ific ip-prefix o
-0000a190: 7220 646f 6d61 696e 0a0a 0a23 2320 6674  r domain...## ft
-0000a1a0: 7020 7365 7276 6572 0a0a 616e 2046 5450  p server..an FTP
-0000a1b0: 2073 6572 7665 7220 6361 6e20 6265 2073   server can be s
-0000a1c0: 7461 7274 6564 2075 7369 6e67 2060 2d2d  tarted using `--
-0000a1d0: 6674 7020 3339 3231 602c 2020 616e 642f  ftp 3921`,  and/
-0000a1e0: 6f72 2060 2d2d 6674 7073 6020 666f 7220  or `--ftps` for 
-0000a1f0: 6578 706c 6963 6974 2054 4c53 2028 6674  explicit TLS (ft
-0000a200: 7065 7329 0a0a 2a20 6261 7365 6420 6f6e  pes)..* based on
-0000a210: 205b 7079 6674 7064 6c69 625d 2868 7474   [pyftpdlib](htt
-0000a220: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0000a230: 6769 616d 7061 6f6c 6f2f 7079 6674 7064  giampaolo/pyftpd
-0000a240: 6c69 6229 0a2a 206e 6565 6473 2061 2064  lib).* needs a d
-0000a250: 6564 6963 6174 6564 2070 6f72 7420 2863  edicated port (c
-0000a260: 616e 6e6f 7420 7368 6172 6520 7769 7468  annot share with
-0000a270: 2074 6865 2048 5454 502f 4854 5450 5320   the HTTP/HTTPS 
-0000a280: 4150 4929 0a2a 2075 706c 6f61 6473 2061  API).* uploads a
-0000a290: 7265 206e 6f74 2072 6573 756d 6162 6c65  re not resumable
-0000a2a0: 202d 2d20 6465 6c65 7465 2061 6e64 2072   -- delete and r
-0000a2b0: 6573 7461 7274 2069 6620 6e65 6365 7373  estart if necess
-0000a2c0: 6172 790a 2a20 7275 6e73 2069 6e20 6163  ary.* runs in ac
-0000a2d0: 7469 7665 206d 6f64 6520 6279 2064 6566  tive mode by def
-0000a2e0: 6175 6c74 2c20 796f 7520 7072 6f62 6162  ault, you probab
-0000a2f0: 6c79 2077 616e 7420 602d 2d66 7470 2d70  ly want `--ftp-p
-0000a300: 7220 3132 3030 302d 3133 3030 3060 0a20  r 12000-13000`. 
-0000a310: 202a 2069 6620 796f 7520 656e 6162 6c65   * if you enable
-0000a320: 2062 6f74 6820 6066 7470 6020 616e 6420   both `ftp` and 
-0000a330: 6066 7470 7360 2c20 7468 6520 706f 7274  `ftps`, the port
-0000a340: 2d72 616e 6765 2077 696c 6c20 6265 2064  -range will be d
-0000a350: 6976 6964 6564 2069 6e20 6861 6c66 0a20  ivided in half. 
-0000a360: 202a 2073 6f6d 6520 6f6c 6465 7220 736f   * some older so
-0000a370: 6674 7761 7265 2028 6669 6c65 7a69 6c6c  ftware (filezill
-0000a380: 6120 6f6e 2064 6562 6961 6e2d 7374 6162  a on debian-stab
-0000a390: 6c65 2920 6361 6e6e 6f74 2070 6173 7369  le) cannot passi
-0000a3a0: 7665 2d6d 6f64 6520 7769 7468 2054 4c53  ve-mode with TLS
-0000a3b0: 0a2a 206c 6f67 696e 2077 6974 6820 616e  .* login with an
-0000a3c0: 7920 7573 6572 6e61 6d65 202b 2079 6f75  y username + you
-0000a3d0: 7220 7061 7373 776f 7264 2c20 6f72 2070  r password, or p
-0000a3e0: 7574 2079 6f75 7220 7061 7373 776f 7264  ut your password
-0000a3f0: 2069 6e20 7468 6520 7573 6572 6e61 6d65   in the username
-0000a400: 2066 6965 6c64 0a0a 0a23 2320 7765 6264   field...## webd
-0000a410: 6176 2073 6572 7665 720a 0a77 6974 6820  av server..with 
-0000a420: 7265 6164 2d77 7269 7465 2073 7570 706f  read-write suppo
-0000a430: 7274 2c20 2073 7570 706f 7274 7320 7769  rt,  supports wi
-0000a440: 6e58 5020 616e 6420 6c61 7465 722c 206d  nXP and later, m
-0000a450: 6163 6f73 2c20 6e61 7574 696c 7573 2f67  acos, nautilus/g
-0000a460: 7666 730a 0a63 6c69 636b 2074 6865 205b  vfs..click the [
-0000a470: 636f 6e6e 6563 745d 2868 7474 703a 2f2f  connect](http://
-0000a480: 3132 372e 302e 302e 313a 3339 3233 2f3f  127.0.0.1:3923/?
-0000a490: 6863 2920 6275 7474 6f6e 2069 6e20 7468  hc) button in th
-0000a4a0: 6520 636f 6e74 726f 6c2d 7061 6e65 6c20  e control-panel 
-0000a4b0: 746f 2073 6565 2063 6f6e 6e65 6374 696f  to see connectio
-0000a4c0: 6e20 696e 7374 7275 6374 696f 6e73 2066  n instructions f
-0000a4d0: 6f72 2077 696e 646f 7773 2c20 6c69 6e75  or windows, linu
-0000a4e0: 782c 206d 6163 6f73 0a0a 6765 6e65 7261  x, macos..genera
-0000a4f0: 6c20 7573 6167 653a 0a2a 206c 6f67 696e  l usage:.* login
-0000a500: 2077 6974 6820 616e 7920 7573 6572 6e61   with any userna
-0000a510: 6d65 202b 2079 6f75 7220 7061 7373 776f  me + your passwo
-0000a520: 7264 2c20 6f72 2070 7574 2079 6f75 7220  rd, or put your 
-0000a530: 7061 7373 776f 7264 2069 6e20 7468 6520  password in the 
-0000a540: 7573 6572 6e61 6d65 2066 6965 6c64 2028  username field (
-0000a550: 7061 7373 776f 7264 2066 6965 6c64 2063  password field c
-0000a560: 616e 2062 6520 656d 7074 792f 7768 6174  an be empty/what
-0000a570: 6576 6572 290a 0a6f 6e20 6d61 636f 732c  ever)..on macos,
-0000a580: 2063 6f6e 6e65 6374 2066 726f 6d20 6669   connect from fi
-0000a590: 6e64 6572 3a0a 2a20 5b47 6f5d 202d 3e20  nder:.* [Go] -> 
-0000a5a0: 5b43 6f6e 6e65 6374 2074 6f20 5365 7276  [Connect to Serv
-0000a5b0: 6572 2e2e 2e5d 202d 3e20 6874 7470 3a2f  er...] -> http:/
-0000a5c0: 2f31 3932 2e31 3638 2e31 3233 2e31 3a33  /192.168.123.1:3
-0000a5d0: 3932 332f 0a0a 696e 206f 7264 6572 2074  923/..in order t
-0000a5e0: 6f20 6772 616e 7420 6675 6c6c 2077 7269  o grant full wri
-0000a5f0: 7465 2d61 6363 6573 7320 746f 2077 6562  te-access to web
-0000a600: 6461 7620 636c 6965 6e74 732c 2074 6865  dav clients, the
-0000a610: 2076 6f6c 666c 6167 2060 6461 7760 206d   volflag `daw` m
-0000a620: 7573 7420 6265 2073 6574 2061 6e64 2074  ust be set and t
-0000a630: 6865 2061 6363 6f75 6e74 206d 7573 7420  he account must 
-0000a640: 616c 736f 2068 6176 6520 6465 6c65 7465  also have delete
-0000a650: 2d61 6363 6573 7320 286f 7468 6572 7769  -access (otherwi
-0000a660: 7365 2074 6865 2063 6c69 656e 7420 776f  se the client wo
-0000a670: 6e27 7420 6265 2061 6c6c 6f77 6564 2074  n't be allowed t
-0000a680: 6f20 7265 706c 6163 6520 7468 6520 636f  o replace the co
-0000a690: 6e74 656e 7473 206f 6620 6578 6973 7469  ntents of existi
-0000a6a0: 6e67 2066 696c 6573 2c20 7768 6963 6820  ng files, which 
-0000a6b0: 6973 2068 6f77 2077 6562 6461 7620 776f  is how webdav wo
-0000a6c0: 726b 7329 0a0a 0a23 2323 2063 6f6e 6e65  rks)...### conne
-0000a6d0: 6374 696e 6720 746f 2077 6562 6461 7620  cting to webdav 
-0000a6e0: 6672 6f6d 2077 696e 646f 7773 0a0a 7573  from windows..us
-0000a6f0: 696e 6720 7468 6520 4755 4920 2028 7769  ing the GUI  (wi
-0000a700: 6e58 5020 6f72 206c 6174 6572 293a 0a2a  nXP or later):.*
-0000a710: 2072 6967 6874 636c 6963 6b20 5b6d 7920   rightclick [my 
-0000a720: 636f 6d70 7574 6572 5d20 2d3e 205b 6d61  computer] -> [ma
-0000a730: 7020 6e65 7477 6f72 6b20 6472 6976 655d  p network drive]
-0000a740: 202d 3e20 466f 6c64 6572 3a20 6068 7474   -> Folder: `htt
-0000a750: 703a 2f2f 3139 322e 3136 382e 3132 332e  p://192.168.123.
-0000a760: 313a 3339 3233 2f60 0a20 202a 206f 6e20  1:3923/`.  * on 
-0000a770: 7769 6e58 5020 6f6e 6c79 2c20 636c 6963  winXP only, clic
-0000a780: 6b20 7468 6520 6053 6967 6e20 7570 2066  k the `Sign up f
-0000a790: 6f72 206f 6e6c 696e 6520 7374 6f72 6167  or online storag
-0000a7a0: 6560 2068 7970 6572 6c69 6e6b 2069 6e73  e` hyperlink ins
-0000a7b0: 7465 6164 2061 6e64 2070 7574 2074 6865  tead and put the
-0000a7c0: 2055 524c 2074 6865 7265 0a20 202a 2070   URL there.  * p
-0000a7d0: 726f 7669 6469 6e67 2079 6f75 7220 7061  roviding your pa
-0000a7e0: 7373 776f 7264 2061 7320 7468 6520 7573  ssword as the us
-0000a7f0: 6572 6e61 6d65 2069 7320 7265 636f 6d6d  ername is recomm
-0000a800: 656e 6465 643b 2074 6865 2070 6173 7377  ended; the passw
-0000a810: 6f72 6420 6669 656c 6420 6361 6e20 6265  ord field can be
-0000a820: 2061 6e79 7468 696e 6720 6f72 2065 6d70   anything or emp
-0000a830: 7479 0a0a 6b6e 6f77 6e20 636c 6965 6e74  ty..known client
-0000a840: 2062 7567 733a 0a2a 2077 696e 372b 2064   bugs:.* win7+ d
-0000a850: 6f65 736e 2774 2061 6374 7561 6c6c 7920  oesn't actually 
-0000a860: 7365 6e64 2074 6865 2070 6173 7377 6f72  send the passwor
-0000a870: 6420 746f 2074 6865 2073 6572 7665 7220  d to the server 
-0000a880: 7768 656e 2072 6561 7574 6865 6e74 6963  when reauthentic
-0000a890: 6174 696e 6720 6166 7465 7220 6120 7265  ating after a re
-0000a8a0: 626f 6f74 2075 6e6c 6573 7320 796f 7520  boot unless you 
-0000a8b0: 6669 7273 7420 7472 7920 746f 206c 6f67  first try to log
-0000a8c0: 696e 2077 6974 6820 616e 2069 6e63 6f72  in with an incor
-0000a8d0: 7265 6374 2070 6173 7377 6f72 6420 616e  rect password an
-0000a8e0: 6420 7468 656e 2073 7769 7463 6820 746f  d then switch to
-0000a8f0: 2074 6865 2063 6f72 7265 6374 2070 6173   the correct pas
-0000a900: 7377 6f72 640a 2020 2a20 6f72 206a 7573  sword.  * or jus
-0000a910: 7420 7479 7065 2079 6f75 7220 7061 7373  t type your pass
-0000a920: 776f 7264 2069 6e74 6f20 7468 6520 7573  word into the us
-0000a930: 6572 6e61 6d65 2066 6965 6c64 2069 6e73  ername field ins
-0000a940: 7465 6164 2074 6f20 6765 7420 6172 6f75  tead to get arou
-0000a950: 6e64 2069 7420 656e 7469 7265 6c79 0a2a  nd it entirely.*
-0000a960: 2063 6f6e 6e65 6374 696e 6720 746f 2061   connecting to a
-0000a970: 2066 6f6c 6465 7220 7768 6963 6820 616c   folder which al
-0000a980: 6c6f 7773 2061 6e6f 6e79 6d6f 7573 2072  lows anonymous r
-0000a990: 6561 6420 7769 6c6c 206d 616b 6520 7772  ead will make wr
-0000a9a0: 6974 696e 6720 696d 706f 7373 6962 6c65  iting impossible
-0000a9b0: 2c20 6173 2077 696e 646f 7773 2068 6173  , as windows has
-0000a9c0: 2064 6563 6964 6564 2069 7420 646f 6573   decided it does
-0000a9d0: 6e27 7420 6e65 6564 2074 6f20 6c6f 6769  n't need to logi
-0000a9e0: 6e0a 2020 2a20 776f 726b 6172 6f75 6e64  n.  * workaround
-0000a9f0: 3a20 636f 6e6e 6563 7420 7477 6963 653b  : connect twice;
-0000aa00: 2066 6972 7374 2074 6f20 6120 666f 6c64   first to a fold
-0000aa10: 6572 2077 6869 6368 2072 6571 7569 7265  er which require
-0000aa20: 7320 6175 7468 2c20 7468 656e 2074 6f20  s auth, then to 
-0000aa30: 7468 6520 666f 6c64 6572 2079 6f75 2061  the folder you a
-0000aa40: 6374 7561 6c6c 7920 7761 6e74 2c20 616e  ctually want, an
-0000aa50: 6420 6c65 6176 6520 626f 7468 206f 6620  d leave both of 
-0000aa60: 7468 6f73 6520 6d6f 756e 7465 640a 2a20  those mounted.* 
-0000aa70: 7769 6e37 2b20 6d61 7920 6f70 656e 2061  win7+ may open a
-0000aa80: 206e 6577 2074 6370 2063 6f6e 6e65 6374   new tcp connect
-0000aa90: 696f 6e20 666f 7220 6576 6572 7920 6669  ion for every fi
-0000aaa0: 6c65 2061 6e64 2073 6f6d 6574 696d 6573  le and sometimes
-0000aab0: 2066 6f72 6765 7473 2074 6f20 636c 6f73   forgets to clos
-0000aac0: 6520 7468 656d 2c20 6576 656e 7475 616c  e them, eventual
-0000aad0: 6c79 206e 6565 6469 6e67 2061 2072 6562  ly needing a reb
-0000aae0: 6f6f 740a 2020 2a20 6d61 7962 6520 4e49  oot.  * maybe NI
-0000aaf0: 432d 7265 6c61 7465 6420 283f 3f29 2c20  C-related (??), 
-0000ab00: 6861 7070 656e 7320 7769 7468 2077 696e  happens with win
-0000ab10: 3130 2d6c 7473 6320 6f6e 2065 3130 3030  10-ltsc on e1000
-0000ab20: 6520 6275 7420 6e6f 7420 7669 7274 696f  e but not virtio
-0000ab30: 0a2a 2077 696e 646f 7773 2063 616e 6e6f  .* windows canno
-0000ab40: 7420 6163 6365 7373 2066 6f6c 6465 7273  t access folders
-0000ab50: 2077 6869 6368 2063 6f6e 7461 696e 2066   which contain f
-0000ab60: 696c 656e 616d 6573 2077 6974 6820 696e  ilenames with in
-0000ab70: 7661 6c69 6420 756e 6963 6f64 6520 6f72  valid unicode or
-0000ab80: 2066 6f72 6269 6464 656e 2063 6861 7261   forbidden chara
-0000ab90: 6374 6572 7320 2860 3c3e 3a22 2f5c 7c3f  cters (`<>:"/\|?
-0000aba0: 2a60 292c 206f 7220 6e61 6d65 7320 656e  *`), or names en
-0000abb0: 6469 6e67 2077 6974 6820 602e 600a 2a20  ding with `.`.* 
-0000abc0: 7769 6e78 7020 6361 6e6e 6f74 2073 686f  winxp cannot sho
-0000abd0: 7720 756e 6963 6f64 6520 6368 6172 6163  w unicode charac
-0000abe0: 7465 7273 206f 7574 7369 6465 206f 6620  ters outside of 
-0000abf0: 2a73 6f6d 6520 7261 6e67 652a 0a20 202a  *some range*.  *
-0000ac00: 206c 6174 696e 2d31 2069 7320 6669 6e65   latin-1 is fine
-0000ac10: 2c20 6869 7261 6761 6e61 2069 7320 6e6f  , hiragana is no
-0000ac20: 7420 286e 6f74 2065 7665 6e20 6173 2073  t (not even as s
-0000ac30: 6869 6674 2d6a 6973 206f 6e20 6a61 7061  hift-jis on japa
-0000ac40: 6e65 7365 2078 7029 0a0a 0a23 2320 736d  nese xp)...## sm
-0000ac50: 6220 7365 7276 6572 0a0a 756e 7361 6665  b server..unsafe
-0000ac60: 2c20 736c 6f77 2c20 6e6f 7420 7265 636f  , slow, not reco
-0000ac70: 6d6d 656e 6465 6420 666f 7220 7761 6e2c  mmended for wan,
-0000ac80: 2020 656e 6162 6c65 2077 6974 6820 602d    enable with `-
-0000ac90: 2d73 6d62 6020 666f 7220 7265 6164 2d6f  -smb` for read-o
-0000aca0: 6e6c 7920 6f72 2060 2d2d 736d 6277 6020  nly or `--smbw` 
-0000acb0: 666f 7220 7265 6164 2d77 7269 7465 0a0a  for read-write..
-0000acc0: 636c 6963 6b20 7468 6520 5b63 6f6e 6e65  click the [conne
-0000acd0: 6374 5d28 6874 7470 3a2f 2f31 3237 2e30  ct](http://127.0
-0000ace0: 2e30 2e31 3a33 3932 332f 3f68 6329 2062  .0.1:3923/?hc) b
-0000acf0: 7574 746f 6e20 696e 2074 6865 2063 6f6e  utton in the con
-0000ad00: 7472 6f6c 2d70 616e 656c 2074 6f20 7365  trol-panel to se
-0000ad10: 6520 636f 6e6e 6563 7469 6f6e 2069 6e73  e connection ins
-0000ad20: 7472 7563 7469 6f6e 7320 666f 7220 7769  tructions for wi
-0000ad30: 6e64 6f77 732c 206c 696e 7578 2c20 6d61  ndows, linux, ma
-0000ad40: 636f 730a 0a64 6570 656e 6465 6e63 6965  cos..dependencie
-0000ad50: 733a 2060 7079 7468 6f6e 3320 2d6d 2070  s: `python3 -m p
-0000ad60: 6970 2069 6e73 7461 6c6c 202d 2d75 7365  ip install --use
-0000ad70: 7220 2d55 2069 6d70 6163 6b65 743d 3d30  r -U impacket==0
-0000ad80: 2e31 302e 3060 0a2a 206e 6577 6572 2076  .10.0`.* newer v
-0000ad90: 6572 7369 6f6e 7320 6f66 2069 6d70 6163  ersions of impac
-0000ada0: 6b65 7420 7769 6c6c 2068 6f70 6566 756c  ket will hopeful
-0000adb0: 6c79 2077 6f72 6b20 6a75 7374 2066 696e  ly work just fin
-0000adc0: 6520 6275 7420 7468 6572 6520 6973 206d  e but there is m
-0000add0: 6f6e 6b65 7970 6174 6368 696e 6720 736f  onkeypatching so
-0000ade0: 206d 6179 6265 206e 6f74 0a0a 736f 6d65   maybe not..some
-0000adf0: 202a 2a42 4947 2057 4152 4e49 4e47 532a   **BIG WARNINGS*
-0000ae00: 2a20 7370 6563 6966 6963 2074 6f20 534d  * specific to SM
-0000ae10: 422f 4349 4653 2c20 696e 2064 6563 7265  B/CIFS, in decre
-0000ae20: 6173 696e 6720 696d 706f 7274 616e 6365  asing importance
-0000ae30: 3a0a 2a20 6e6f 7420 656e 7469 7265 6c79  :.* not entirely
-0000ae40: 2063 6f6e 6669 6465 6e74 2074 6861 7420   confident that 
-0000ae50: 7265 6164 2d6f 6e6c 7920 6973 2072 6561  read-only is rea
-0000ae60: 642d 6f6e 6c79 0a2a 2074 6865 2073 6d62  d-only.* the smb
-0000ae70: 2062 6163 6b65 6e64 2069 7320 6e6f 7420   backend is not 
-0000ae80: 6675 6c6c 7920 696e 7465 6772 6174 6564  fully integrated
-0000ae90: 2077 6974 6820 7666 732c 206d 6561 6e69   with vfs, meani
-0000aea0: 6e67 2074 6865 7265 2063 6f75 6c64 2062  ng there could b
-0000aeb0: 6520 7365 6375 7269 7479 2069 7373 7565  e security issue
-0000aec0: 7320 2870 6174 6820 7472 6176 6572 7361  s (path traversa
-0000aed0: 6c29 2e20 506c 6561 7365 2075 7365 2060  l). Please use `
-0000aee0: 2d2d 736d 622d 706f 7274 6020 2873 6565  --smb-port` (see
-0000aef0: 2062 656c 6f77 2920 616e 6420 5b70 7269   below) and [pri
-0000af00: 736f 6e70 6172 7479 5d28 2e2f 6269 6e2f  sonparty](./bin/
-0000af10: 7072 6973 6f6e 7061 7274 792e 7368 290a  prisonparty.sh).
-0000af20: 2020 2a20 6163 636f 756e 7420 7061 7373    * account pass
-0000af30: 776f 7264 7320 776f 726b 2070 6572 2d76  words work per-v
-0000af40: 6f6c 756d 6520 6173 2065 7870 6563 7465  olume as expecte
-0000af50: 642c 2062 7574 2061 6363 6f75 6e74 2070  d, but account p
-0000af60: 6572 6d69 7373 696f 6e73 2061 7265 2063  ermissions are c
-0000af70: 6f61 6c65 7363 6564 3b20 616c 6c20 6163  oalesced; all ac
-0000af80: 636f 756e 7473 2068 6176 6520 7265 6164  counts have read
-0000af90: 2d61 6363 6573 7320 746f 2061 6c6c 2076  -access to all v
-0000afa0: 6f6c 756d 6573 2c20 616e 6420 6966 2061  olumes, and if a
-0000afb0: 2073 696e 676c 6520 6163 636f 756e 7420   single account 
-0000afc0: 6861 7320 7772 6974 652d 6163 6365 7373  has write-access
-0000afd0: 2074 6f20 736f 6d65 2076 6f6c 756d 6520   to some volume 
-0000afe0: 7468 656e 2061 6c6c 206f 7468 6572 2061  then all other a
-0000aff0: 6363 6f75 6e74 7320 616c 736f 2064 6f0a  ccounts also do.
-0000b000: 2020 2020 2a20 6966 206e 6f20 6163 636f      * if no acco
-0000b010: 756e 7473 2068 6176 6520 7772 6974 652d  unts have write-
-0000b020: 6163 6365 7373 2074 6f20 6120 7370 6563  access to a spec
-0000b030: 6966 6963 2076 6f6c 756d 652c 206f 7220  ific volume, or 
-0000b040: 6966 2060 2d2d 736d 6277 6020 6973 206e  if `--smbw` is n
-0000b050: 6f74 2073 6574 2c20 7468 656e 2077 7269  ot set, then wri
-0000b060: 7469 6e67 2074 6f20 7468 6174 2076 6f6c  ting to that vol
-0000b070: 756d 6520 6672 6f6d 2073 6d62 202a 7368  ume from smb *sh
-0000b080: 6f75 6c64 2a20 6265 2069 6d70 6f73 7369  ould* be impossi
-0000b090: 626c 650a 2020 2020 2a20 7769 6c6c 2062  ble.    * will b
-0000b0a0: 6520 6669 7865 6420 6f6e 6365 205b 696d  e fixed once [im
-0000b0b0: 7061 636b 6574 2076 302e 3131 2e30 5d28  packet v0.11.0](
-0000b0c0: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
-0000b0d0: 6f6d 2f53 6563 7572 6541 7574 6843 6f72  om/SecureAuthCor
-0000b0e0: 702f 696d 7061 636b 6574 2f63 6f6d 6d69  p/impacket/commi
-0000b0f0: 742f 6439 3233 6330 3066 3735 6435 3462  t/d923c00f75d54b
-0000b100: 3937 3262 6361 3537 3361 3231 3161 3832  972bca573a211a82
-0000b110: 6630 3962 3535 3236 3161 2920 6973 2072  f09b55261a) is r
-0000b120: 656c 6561 7365 640a 2020 2a20 5b73 6861  eleased.  * [sha
-0000b130: 646f 7769 6e67 5d28 2373 6861 646f 7769  dowing](#shadowi
-0000b140: 6e67 2920 7072 6f62 6162 6c79 2077 6f72  ng) probably wor
-0000b150: 6b73 2061 7320 6578 7065 6374 6564 2062  ks as expected b
-0000b160: 7574 206e 6f20 6775 6172 616e 7465 6573  ut no guarantees
-0000b170: 0a0a 616e 6420 736f 6d65 206d 696e 6f72  ..and some minor
-0000b180: 2069 7373 7565 732c 0a2a 2063 6c69 656e   issues,.* clien
-0000b190: 7473 206f 6e6c 7920 7365 6520 7468 6520  ts only see the 
-0000b1a0: 6669 7273 7420 7e34 3030 2066 696c 6573  first ~400 files
-0000b1b0: 2069 6e20 6269 6720 666f 6c64 6572 733b   in big folders;
-0000b1c0: 205b 696d 7061 636b 6574 2331 3433 335d   [impacket#1433]
-0000b1d0: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
-0000b1e0: 636f 6d2f 5365 6375 7265 4175 7468 436f  com/SecureAuthCo
-0000b1f0: 7270 2f69 6d70 6163 6b65 742f 6973 7375  rp/impacket/issu
-0000b200: 6573 2f31 3433 3329 0a2a 2068 6f74 2d72  es/1433).* hot-r
-0000b210: 656c 6f61 6420 6f66 2073 6572 7665 7220  eload of server 
-0000b220: 636f 6e66 6967 2028 602f 3f72 656c 6f61  config (`/?reloa
-0000b230: 643d 6366 6760 2920 646f 6573 206e 6f74  d=cfg`) does not
-0000b240: 2069 6e63 6c75 6465 2074 6865 2060 5b67   include the `[g
-0000b250: 6c6f 6261 6c5d 6020 7365 6374 696f 6e20  lobal]` section 
-0000b260: 2863 6f6d 6d61 6e64 6c69 6e65 2061 7267  (commandline arg
-0000b270: 7329 0a2a 206c 6973 7465 6e73 206f 6e20  s).* listens on 
-0000b280: 7468 6520 6669 7273 7420 4950 7634 2060  the first IPv4 `
-0000b290: 2d69 6020 696e 7465 7266 6163 6520 6f6e  -i` interface on
-0000b2a0: 6c79 2028 6465 6661 756c 7420 3d20 3a3a  ly (default = ::
-0000b2b0: 203d 2030 2e30 2e30 2e30 203d 2061 6c6c   = 0.0.0.0 = all
-0000b2c0: 290a 2a20 6c6f 6769 6e20 646f 6573 6e27  ).* login doesn'
-0000b2d0: 7420 776f 726b 206f 6e20 7769 6e78 702c  t work on winxp,
-0000b2e0: 2062 7574 2061 6e6f 6e79 6d6f 7573 2061   but anonymous a
-0000b2f0: 6363 6573 7320 6973 206f 6b20 2d2d 2072  ccess is ok -- r
-0000b300: 656d 6f76 6520 616c 6c20 6163 636f 756e  emove all accoun
-0000b310: 7473 2066 726f 6d20 636f 7079 7061 7274  ts from copypart
-0000b320: 7920 636f 6e66 6967 2066 6f72 2074 6861  y config for tha
-0000b330: 7420 746f 2077 6f72 6b0a 2020 2a20 7769  t to work.  * wi
-0000b340: 6e31 3020 6f6e 7761 7264 7320 646f 6573  n10 onwards does
-0000b350: 206e 6f74 2061 6c6c 6f77 2063 6f6e 6e65   not allow conne
-0000b360: 6374 696e 6720 616e 6f6e 796d 6f75 736c  cting anonymousl
-0000b370: 7920 2f20 7769 7468 6f75 7420 6163 636f  y / without acco
-0000b380: 756e 7473 0a2a 206f 6e20 7769 6e64 6f77  unts.* on window
-0000b390: 732c 2063 7265 6174 696e 6720 6120 6e65  s, creating a ne
-0000b3a0: 7720 6669 6c65 2074 6872 6f75 6768 2072  w file through r
-0000b3b0: 6967 6874 636c 6963 6b20 2d2d 3e20 6e65  ightclick --> ne
-0000b3c0: 7720 2d2d 3e20 7465 7874 6669 6c65 2074  w --> textfile t
-0000b3d0: 6872 6f77 7320 616e 2065 7272 6f72 2064  hrows an error d
-0000b3e0: 7565 2074 6f20 696d 7061 636b 6574 206c  ue to impacket l
-0000b3f0: 696d 6974 6174 696f 6e73 202d 2d20 6869  imitations -- hi
-0000b400: 7420 4f4b 2061 6e64 2046 3520 746f 2067  t OK and F5 to g
-0000b410: 6574 2079 6f75 7220 6669 6c65 0a2a 2070  et your file.* p
-0000b420: 7974 686f 6e33 206f 6e6c 790a 2a20 736c  ython3 only.* sl
-0000b430: 6f77 0a0a 6b6e 6f77 6e20 636c 6965 6e74  ow..known client
-0000b440: 2062 7567 733a 0a2a 206f 6e20 7769 6e37   bugs:.* on win7
-0000b450: 206f 6e6c 792c 2060 2d2d 736d 6231 6020   only, `--smb1` 
-0000b460: 6973 206d 7563 6820 6661 7374 6572 2074  is much faster t
-0000b470: 6861 6e20 736d 6232 2028 6465 6661 756c  han smb2 (defaul
-0000b480: 7429 2062 6563 6175 7365 2069 7420 6b65  t) because it ke
-0000b490: 6570 7320 7265 7363 616e 6e69 6e67 2066  eps rescanning f
-0000b4a0: 6f6c 6465 7273 206f 6e20 736d 6232 0a20  olders on smb2. 
-0000b4b0: 202a 2068 6f77 6576 6572 2073 6d62 3120   * however smb1 
-0000b4c0: 6973 2062 7567 6779 2061 6e64 2069 7320  is buggy and is 
-0000b4d0: 6e6f 7420 656e 6162 6c65 6420 6279 2064  not enabled by d
-0000b4e0: 6566 6175 6c74 206f 6e20 7769 6e31 3020  efault on win10 
-0000b4f0: 6f6e 7761 7264 730a 2a20 7769 6e64 6f77  onwards.* window
-0000b500: 7320 6361 6e6e 6f74 2061 6363 6573 7320  s cannot access 
-0000b510: 666f 6c64 6572 7320 7768 6963 6820 636f  folders which co
-0000b520: 6e74 6169 6e20 6669 6c65 6e61 6d65 7320  ntain filenames 
-0000b530: 7769 7468 2069 6e76 616c 6964 2075 6e69  with invalid uni
-0000b540: 636f 6465 206f 7220 666f 7262 6964 6465  code or forbidde
-0000b550: 6e20 6368 6172 6163 7465 7273 2028 603c  n characters (`<
-0000b560: 3e3a 222f 5c7c 3f2a 6029 2c20 6f72 206e  >:"/\|?*`), or n
-0000b570: 616d 6573 2065 6e64 696e 6720 7769 7468  ames ending with
-0000b580: 2060 2e60 0a0a 7468 6520 736d 6220 7072   `.`..the smb pr
-0000b590: 6f74 6f63 6f6c 206c 6973 7465 6e73 206f  otocol listens o
-0000b5a0: 6e20 5443 5020 706f 7274 2034 3435 2c20  n TCP port 445, 
-0000b5b0: 7768 6963 6820 6973 2061 2070 7269 7669  which is a privi
-0000b5c0: 6c65 6765 6420 706f 7274 206f 6e20 6c69  leged port on li
-0000b5d0: 6e75 7820 616e 6420 6d61 636f 732c 2077  nux and macos, w
-0000b5e0: 6869 6368 2077 6f75 6c64 2072 6571 7569  hich would requi
-0000b5f0: 7265 2072 756e 6e69 6e67 2063 6f70 7970  re running copyp
-0000b600: 6172 7479 2061 7320 726f 6f74 2e20 486f  arty as root. Ho
-0000b610: 7765 7665 722c 2074 6869 7320 6361 6e20  wever, this can 
-0000b620: 6265 2061 766f 6964 6564 2062 7920 6c69  be avoided by li
-0000b630: 7374 656e 696e 6720 6f6e 2061 6e6f 7468  stening on anoth
-0000b640: 6572 2070 6f72 7420 7573 696e 6720 602d  er port using `-
-0000b650: 2d73 6d62 2d70 6f72 7420 3339 3435 6020  -smb-port 3945` 
-0000b660: 616e 6420 7468 656e 2075 7369 6e67 204e  and then using N
-0000b670: 4154 2074 6f20 666f 7277 6172 6420 7468  AT to forward th
-0000b680: 6520 7472 6166 6669 6320 6672 6f6d 2034  e traffic from 4
-0000b690: 3435 2074 6f20 7468 6572 653b 0a2a 206f  45 to there;.* o
-0000b6a0: 6e20 6c69 6e75 783a 2060 6970 7461 626c  n linux: `iptabl
-0000b6b0: 6573 202d 7420 6e61 7420 2d41 2050 5245  es -t nat -A PRE
-0000b6c0: 524f 5554 494e 4720 2d69 2065 7468 3020  ROUTING -i eth0 
-0000b6d0: 2d70 2074 6370 202d 2d64 706f 7274 2034  -p tcp --dport 4
-0000b6e0: 3435 202d 6a20 5245 4449 5245 4354 202d  45 -j REDIRECT -
-0000b6f0: 2d74 6f2d 706f 7274 2033 3934 3560 0a0a  -to-port 3945`..
-0000b700: 6175 7468 656e 7469 6361 7465 2077 6974  authenticate wit
-0000b710: 6820 6f6e 6520 6f66 2074 6865 2066 6f6c  h one of the fol
-0000b720: 6c6f 7769 6e67 3a0a 2a20 7573 6572 6e61  lowing:.* userna
-0000b730: 6d65 2060 2475 7365 726e 616d 6560 2c20  me `$username`, 
-0000b740: 7061 7373 776f 7264 2060 2470 6173 7377  password `$passw
-0000b750: 6f72 6460 0a2a 2075 7365 726e 616d 6520  ord`.* username 
-0000b760: 6024 7061 7373 776f 7264 602c 2070 6173  `$password`, pas
-0000b770: 7377 6f72 6420 606b 600a 0a0a 2323 2066  sword `k`...## f
-0000b780: 696c 6520 696e 6465 7869 6e67 0a0a 656e  ile indexing..en
-0000b790: 6162 6c65 7320 6465 6475 7020 616e 6420  ables dedup and 
-0000b7a0: 6d75 7369 6320 7365 6172 6368 202b 2b0a  music search ++.
-0000b7b0: 0a66 696c 6520 696e 6465 7869 6e67 2072  .file indexing r
-0000b7c0: 656c 6965 7320 6f6e 2074 776f 2064 6174  elies on two dat
-0000b7d0: 6162 6173 6520 7461 626c 6573 2c20 7468  abase tables, th
-0000b7e0: 6520 7570 326b 2066 696c 6574 7265 6520  e up2k filetree 
-0000b7f0: 2860 2d65 3264 6029 2061 6e64 2074 6865  (`-e2d`) and the
-0000b800: 206d 6574 6164 6174 6120 7461 6773 2028   metadata tags (
-0000b810: 602d 6532 7460 292c 2073 746f 7265 6420  `-e2t`), stored 
-0000b820: 696e 2060 2e68 6973 742f 7570 326b 2e64  in `.hist/up2k.d
-0000b830: 6260 2e20 436f 6e66 6967 7572 6174 696f  b`. Configuratio
-0000b840: 6e20 6361 6e20 6265 2064 6f6e 6520 7468  n can be done th
-0000b850: 726f 7567 6820 6172 6775 6d65 6e74 732c  rough arguments,
-0000b860: 2076 6f6c 666c 6167 732c 206f 7220 6120   volflags, or a 
-0000b870: 6d69 7820 6f66 2062 6f74 682e 0a0a 7468  mix of both...th
-0000b880: 726f 7567 6820 6172 6775 6d65 6e74 733a  rough arguments:
-0000b890: 0a2a 2060 2d65 3264 6020 656e 6162 6c65  .* `-e2d` enable
-0000b8a0: 7320 6669 6c65 2069 6e64 6578 696e 6720  s file indexing 
-0000b8b0: 6f6e 2075 706c 6f61 640a 2a20 602d 6532  on upload.* `-e2
-0000b8c0: 6473 6020 616c 736f 2073 6361 6e73 2077  ds` also scans w
-0000b8d0: 7269 7461 626c 6520 666f 6c64 6572 7320  ritable folders 
-0000b8e0: 666f 7220 6e65 7720 6669 6c65 7320 6f6e  for new files on
-0000b8f0: 2073 7461 7274 7570 0a2a 2060 2d65 3264   startup.* `-e2d
-0000b900: 7361 6020 616c 736f 2073 6361 6e73 2061  sa` also scans a
-0000b910: 6c6c 206d 6f75 6e74 6564 2076 6f6c 756d  ll mounted volum
-0000b920: 6573 2028 696e 636c 7564 696e 6720 7265  es (including re
-0000b930: 6164 6f6e 6c79 206f 6e65 7329 0a2a 2060  adonly ones).* `
-0000b940: 2d65 3274 6020 656e 6162 6c65 7320 6d65  -e2t` enables me
-0000b950: 7461 6461 7461 2069 6e64 6578 696e 6720  tadata indexing 
-0000b960: 6f6e 2075 706c 6f61 640a 2a20 602d 6532  on upload.* `-e2
-0000b970: 7473 6020 616c 736f 2073 6361 6e73 2066  ts` also scans f
-0000b980: 6f72 2074 6167 7320 696e 2061 6c6c 2066  or tags in all f
-0000b990: 696c 6573 2074 6861 7420 646f 6e27 7420  iles that don't 
-0000b9a0: 6861 7665 2074 6167 7320 7965 740a 2a20  have tags yet.* 
-0000b9b0: 602d 6532 7473 7260 2061 6c73 6f20 6465  `-e2tsr` also de
-0000b9c0: 6c65 7465 7320 616c 6c20 6578 6973 7469  letes all existi
-0000b9d0: 6e67 2074 6167 732c 2064 6f69 6e67 2061  ng tags, doing a
-0000b9e0: 2066 756c 6c20 7265 696e 6465 780a 2a20   full reindex.* 
-0000b9f0: 602d 6532 7660 2076 6572 6669 6573 2066  `-e2v` verfies f
-0000ba00: 696c 6520 696e 7465 6772 6974 7920 6174  ile integrity at
-0000ba10: 2073 7461 7274 7570 2c20 636f 6d70 6172   startup, compar
-0000ba20: 696e 6720 6861 7368 6573 2066 726f 6d20  ing hashes from 
-0000ba30: 7468 6520 6462 0a2a 2060 2d65 3276 7560  the db.* `-e2vu`
-0000ba40: 2070 6174 6368 6573 2074 6865 2064 6174   patches the dat
-0000ba50: 6162 6173 6520 7769 7468 2074 6865 206e  abase with the n
-0000ba60: 6577 2068 6173 6865 7320 6672 6f6d 2074  ew hashes from t
-0000ba70: 6865 2066 696c 6573 7973 7465 6d0a 2a20  he filesystem.* 
-0000ba80: 602d 6532 7670 6020 7061 6e69 6373 2061  `-e2vp` panics a
-0000ba90: 6e64 206b 696c 6c73 2063 6f70 7970 6172  nd kills copypar
-0000baa0: 7479 2069 6e73 7465 6164 0a2a 2060 2d2d  ty instead.* `--
-0000bab0: 786c 696e 6b60 2065 6e61 626c 6573 2064  xlink` enables d
-0000bac0: 6564 7570 6c69 6361 7469 6f6e 2061 6372  eduplication acr
-0000bad0: 6f73 7320 766f 6c75 6d65 730a 0a74 6865  oss volumes..the
-0000bae0: 2073 616d 6520 6172 6775 6d65 6e74 7320   same arguments 
-0000baf0: 6361 6e20 6265 2073 6574 2061 7320 766f  can be set as vo
-0000bb00: 6c66 6c61 6773 2c20 696e 2061 6464 6974  lflags, in addit
-0000bb10: 696f 6e20 746f 2060 6432 6460 2c20 6064  ion to `d2d`, `d
-0000bb20: 3264 7360 2c20 6064 3274 602c 2060 6432  2ds`, `d2t`, `d2
-0000bb30: 7473 602c 2060 6432 7660 2066 6f72 2064  ts`, `d2v` for d
-0000bb40: 6973 6162 6c69 6e67 3a0a 2a20 602d 7620  isabling:.* `-v 
-0000bb50: 7e2f 6d75 7369 633a 3a72 3a63 2c65 3264  ~/music::r:c,e2d
-0000bb60: 7361 2c65 3274 7372 6020 646f 6573 2061  sa,e2tsr` does a
-0000bb70: 2066 756c 6c20 7265 696e 6465 7820 6f66   full reindex of
-0000bb80: 2065 7665 7279 7468 696e 6720 6f6e 2073   everything on s
-0000bb90: 7461 7274 7570 0a2a 2060 2d76 207e 2f6d  tartup.* `-v ~/m
-0000bba0: 7573 6963 3a3a 723a 632c 6432 6460 2064  usic::r:c,d2d` d
-0000bbb0: 6973 6162 6c65 7320 2a2a 616c 6c2a 2a20  isables **all** 
-0000bbc0: 696e 6465 7869 6e67 2c20 6576 656e 2069  indexing, even i
-0000bbd0: 6620 616e 7920 602d 6532 2a60 2061 7265  f any `-e2*` are
-0000bbe0: 206f 6e0a 2a20 602d 7620 7e2f 6d75 7369   on.* `-v ~/musi
-0000bbf0: 633a 3a72 3a63 2c64 3274 6020 6469 7361  c::r:c,d2t` disa
-0000bc00: 626c 6573 2061 6c6c 2060 2d65 3274 2a60  bles all `-e2t*`
-0000bc10: 2028 7461 6773 292c 2064 6f65 7320 6e6f   (tags), does no
-0000bc20: 7420 6166 6665 6374 2060 2d65 3264 2a60  t affect `-e2d*`
-0000bc30: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
-0000bc40: 723a 632c 6432 6473 6020 6469 7361 626c  r:c,d2ds` disabl
-0000bc50: 6573 206f 6e2d 626f 6f74 2073 6361 6e73  es on-boot scans
-0000bc60: 3b20 6f6e 6c79 2069 6e64 6578 206e 6577  ; only index new
-0000bc70: 2075 706c 6f61 6473 0a2a 2060 2d76 207e   uploads.* `-v ~
-0000bc80: 2f6d 7573 6963 3a3a 723a 632c 6432 7473  /music::r:c,d2ts
-0000bc90: 6020 7361 6d65 2065 7863 6570 7420 6f6e  ` same except on
-0000bca0: 6c79 2061 6666 6563 7469 6e67 2074 6167  ly affecting tag
-0000bcb0: 730a 0a6e 6f74 653a 0a2a 2074 6865 2070  s..note:.* the p
-0000bcc0: 6172 7365 7220 6361 6e20 6669 6e61 6c6c  arser can finall
-0000bcd0: 7920 6861 6e64 6c65 2060 632c 6532 6473  y handle `c,e2ds
-0000bce0: 612c 6532 7473 7260 2073 6f20 796f 7520  a,e2tsr` so you 
-0000bcf0: 6e6f 206c 6f6e 6765 7220 6861 7665 2074  no longer have t
-0000bd00: 6f20 6063 2c65 3264 7361 3a63 2c65 3274  o `c,e2dsa:c,e2t
-0000bd10: 7372 600a 2a20 6065 3274 7372 6020 6973  sr`.* `e2tsr` is
-0000bd20: 2070 726f 6261 626c 7920 616c 7761 7973   probably always
-0000bd30: 206f 7665 726b 696c 6c2c 2073 696e 6365   overkill, since
-0000bd40: 2060 6532 6473 602f 6065 3264 7361 6020   `e2ds`/`e2dsa` 
-0000bd50: 776f 756c 6420 7069 636b 2075 7020 616e  would pick up an
-0000bd60: 7920 6669 6c65 206d 6f64 6966 6963 6174  y file modificat
-0000bd70: 696f 6e73 2061 6e64 2060 6532 7473 6020  ions and `e2ts` 
-0000bd80: 776f 756c 6420 7468 656e 2072 6569 6e64  would then reind
-0000bd90: 6578 2074 686f 7365 2c20 756e 6c65 7373  ex those, unless
-0000bda0: 2074 6865 7265 2069 7320 6120 6e65 7720   there is a new 
-0000bdb0: 636f 7079 7061 7274 7920 7665 7273 696f  copyparty versio
-0000bdc0: 6e20 7769 7468 206e 6577 2070 6172 7365  n with new parse
-0000bdd0: 7273 2061 6e64 2074 6865 2072 656c 6561  rs and the relea
-0000bde0: 7365 206e 6f74 6520 7361 7973 206f 7468  se note says oth
-0000bdf0: 6572 7769 7365 0a2a 2074 6865 2072 6573  erwise.* the res
-0000be00: 6361 6e20 6275 7474 6f6e 2069 6e20 7468  can button in th
-0000be10: 6520 6164 6d69 6e20 7061 6e65 6c20 6861  e admin panel ha
-0000be20: 7320 6e6f 2065 6666 6563 7420 756e 6c65  s no effect unle
-0000be30: 7373 2074 6865 2076 6f6c 756d 6520 6861  ss the volume ha
-0000be40: 7320 602d 6532 6473 6020 6f72 2068 6967  s `-e2ds` or hig
-0000be50: 6865 720a 2a20 6465 6475 706c 6963 6174  her.* deduplicat
-0000be60: 696f 6e20 6973 2070 6f73 7369 626c 6520  ion is possible 
-0000be70: 6f6e 2077 696e 646f 7773 2069 6620 796f  on windows if yo
-0000be80: 7520 7275 6e20 636f 7079 7061 7274 7920  u run copyparty 
-0000be90: 6173 2061 646d 696e 6973 7472 6174 6f72  as administrator
-0000bea0: 2028 6e6f 7420 7361 7969 6e67 2079 6f75   (not saying you
-0000beb0: 2073 686f 756c 6421 290a 0a23 2323 2065   should!)..### e
-0000bec0: 7863 6c75 6465 2d70 6174 7465 726e 730a  xclude-patterns.
-0000bed0: 0a74 6f20 7361 7665 2073 6f6d 6520 7469  .to save some ti
-0000bee0: 6d65 2c20 2079 6f75 2063 616e 2070 726f  me,  you can pro
-0000bef0: 7669 6465 2061 2072 6567 6578 2070 6174  vide a regex pat
-0000bf00: 7465 726e 2066 6f72 2066 696c 6570 6174  tern for filepat
-0000bf10: 6873 2074 6f20 6f6e 6c79 2069 6e64 6578  hs to only index
-0000bf20: 2062 7920 6669 6c65 6e61 6d65 2f70 6174   by filename/pat
-0000bf30: 682f 7369 7a65 2f6c 6173 742d 6d6f 6469  h/size/last-modi
-0000bf40: 6669 6564 2028 616e 6420 6e6f 7420 7468  fied (and not th
-0000bf50: 6520 6861 7368 206f 6620 7468 6520 6669  e hash of the fi
-0000bf60: 6c65 2063 6f6e 7465 6e74 7329 2062 7920  le contents) by 
-0000bf70: 7365 7474 696e 6720 602d 2d6e 6f2d 6861  setting `--no-ha
-0000bf80: 7368 205c 2e69 736f 2460 206f 7220 7468  sh \.iso$` or th
-0000bf90: 6520 766f 6c66 6c61 6720 603a 632c 6e6f  e volflag `:c,no
-0000bfa0: 6861 7368 3d5c 2e69 736f 2460 2c20 7468  hash=\.iso$`, th
-0000bfb0: 6973 2068 6173 2074 6865 2066 6f6c 6c6f  is has the follo
-0000bfc0: 7769 6e67 2063 6f6e 7365 7175 656e 6365  wing consequence
-0000bfd0: 733a 0a2a 2069 6e69 7469 616c 2069 6e64  s:.* initial ind
-0000bfe0: 6578 696e 6720 6973 2077 6179 2066 6173  exing is way fas
-0000bff0: 7465 722c 2065 7370 6563 6961 6c6c 7920  ter, especially 
-0000c000: 7768 656e 2074 6865 2076 6f6c 756d 6520  when the volume 
-0000c010: 6973 206f 6e20 6120 6e65 7477 6f72 6b20  is on a network 
-0000c020: 6469 736b 0a2a 206d 616b 6573 2069 7420  disk.* makes it 
-0000c030: 696d 706f 7373 6962 6c65 2074 6f20 5b66  impossible to [f
-0000c040: 696c 652d 7365 6172 6368 5d28 2366 696c  ile-search](#fil
-0000c050: 652d 7365 6172 6368 290a 2a20 6966 2073  e-search).* if s
-0000c060: 6f6d 656f 6e65 2075 706c 6f61 6473 2074  omeone uploads t
-0000c070: 6865 2073 616d 6520 6669 6c65 2063 6f6e  he same file con
-0000c080: 7465 6e74 732c 2074 6865 2075 706c 6f61  tents, the uploa
-0000c090: 6420 7769 6c6c 206e 6f74 2062 6520 6465  d will not be de
-0000c0a0: 7465 6374 6564 2061 7320 6120 6475 7065  tected as a dupe
-0000c0b0: 2c20 736f 2069 7420 7769 6c6c 206e 6f74  , so it will not
-0000c0c0: 2067 6574 2073 796d 6c69 6e6b 6564 206f   get symlinked o
-0000c0d0: 7220 7265 6a65 6374 6564 0a0a 7369 6d69  r rejected..simi
-0000c0e0: 6c61 726c 792c 2079 6f75 2063 616e 2066  larly, you can f
-0000c0f0: 756c 6c79 2069 676e 6f72 6520 6669 6c65  ully ignore file
-0000c100: 732f 666f 6c64 6572 7320 7573 696e 6720  s/folders using 
-0000c110: 602d 2d6e 6f2d 6964 7820 5b2e 2e2e 5d60  `--no-idx [...]`
-0000c120: 2061 6e64 2060 3a63 2c6e 6f69 6478 3d5c   and `:c,noidx=\
-0000c130: 2e69 736f 2460 0a0a 6966 2079 6f75 2073  .iso$`..if you s
-0000c140: 6574 2060 2d2d 6e6f 2d68 6173 6820 5b2e  et `--no-hash [.
-0000c150: 2e2e 5d60 2067 6c6f 6261 6c6c 792c 2079  ..]` globally, y
-0000c160: 6f75 2063 616e 2065 6e61 626c 6520 6861  ou can enable ha
-0000c170: 7368 696e 6720 666f 7220 7370 6563 6966  shing for specif
-0000c180: 6963 2076 6f6c 756d 6573 2075 7369 6e67  ic volumes using
-0000c190: 2066 6c61 6720 603a 632c 6e6f 6861 7368   flag `:c,nohash
-0000c1a0: 3d60 0a0a 2323 2320 6669 6c65 7379 7374  =`..### filesyst
-0000c1b0: 656d 2067 7561 7264 730a 0a61 766f 6964  em guards..avoid
-0000c1c0: 2074 7261 7665 7273 696e 6720 696e 746f   traversing into
-0000c1d0: 206f 7468 6572 2066 696c 6573 7973 7465   other filesyste
-0000c1e0: 6d73 2020 7573 696e 6720 602d 2d78 6465  ms  using `--xde
-0000c1f0: 7660 202f 2076 6f6c 666c 6167 2060 3a63  v` / volflag `:c
-0000c200: 2c78 6465 7660 2c20 736b 6970 7069 6e67  ,xdev`, skipping
-0000c210: 2061 6e79 2073 796d 6c69 6e6b 7320 6f72   any symlinks or
-0000c220: 2062 696e 642d 6d6f 756e 7473 2074 6f20   bind-mounts to 
-0000c230: 616e 6f74 6865 7220 4844 4420 666f 7220  another HDD for 
-0000c240: 6578 616d 706c 650a 0a61 6e64 2f6f 7220  example..and/or 
-0000c250: 796f 7520 6361 6e20 602d 2d78 766f 6c60  you can `--xvol`
-0000c260: 202f 2060 3a63 2c78 766f 6c60 2074 6f20   / `:c,xvol` to 
-0000c270: 6967 6e6f 7265 2061 6c6c 2073 796d 6c69  ignore all symli
-0000c280: 6e6b 7320 6c65 6176 696e 6720 7468 6520  nks leaving the 
-0000c290: 766f 6c75 6d65 2773 2074 6f70 2064 6972  volume's top dir
-0000c2a0: 6563 746f 7279 2c20 6275 7420 7374 696c  ectory, but stil
-0000c2b0: 6c20 616c 6c6f 7720 6269 6e64 2d6d 6f75  l allow bind-mou
-0000c2c0: 6e74 7320 706f 696e 7469 6e67 2065 6c73  nts pointing els
-0000c2d0: 6577 6865 7265 0a0a 2a2a 4e42 3a20 6f6e  ewhere..**NB: on
-0000c2e0: 6c79 2061 6666 6563 7473 2074 6865 2069  ly affects the i
-0000c2f0: 6e64 6578 6572 2a2a 202d 2d20 7573 6572  ndexer** -- user
-0000c300: 7320 6361 6e20 7374 696c 6c20 6163 6365  s can still acce
-0000c310: 7373 2061 6e79 7468 696e 6720 696e 7369  ss anything insi
-0000c320: 6465 2061 2076 6f6c 756d 652c 2075 6e6c  de a volume, unl
-0000c330: 6573 7320 7368 6164 6f77 6564 2062 7920  ess shadowed by 
-0000c340: 616e 6f74 6865 7220 766f 6c75 6d65 0a0a  another volume..
-0000c350: 2323 2320 7065 7269 6f64 6963 2072 6573  ### periodic res
-0000c360: 6361 6e0a 0a66 696c 6573 7973 7465 6d20  can..filesystem 
-0000c370: 6d6f 6e69 746f 7269 6e67 3b20 2069 6620  monitoring;  if 
-0000c380: 636f 7079 7061 7274 7920 6973 206e 6f74  copyparty is not
-0000c390: 2074 6865 206f 6e6c 7920 736f 6674 7761   the only softwa
-0000c3a0: 7265 2064 6f69 6e67 2073 7475 6666 206f  re doing stuff o
-0000c3b0: 6e20 796f 7572 2066 696c 6573 7973 7465  n your filesyste
-0000c3c0: 6d2c 2079 6f75 206d 6179 2077 616e 7420  m, you may want 
-0000c3d0: 746f 2065 6e61 626c 6520 7065 7269 6f64  to enable period
-0000c3e0: 6963 2072 6573 6361 6e73 2074 6f20 6b65  ic rescans to ke
-0000c3f0: 6570 2074 6865 2069 6e64 6578 2075 7020  ep the index up 
-0000c400: 746f 2064 6174 650a 0a61 7267 756d 656e  to date..argumen
-0000c410: 7420 602d 2d72 652d 6d61 7861 6765 2036  t `--re-maxage 6
-0000c420: 3060 2077 696c 6c20 7265 7363 616e 2061  0` will rescan a
-0000c430: 6c6c 2076 6f6c 756d 6573 2065 7665 7279  ll volumes every
-0000c440: 2036 3020 7365 632c 2073 616d 6520 6173   60 sec, same as
-0000c450: 2076 6f6c 666c 6167 2060 3a63 2c73 6361   volflag `:c,sca
-0000c460: 6e3d 3630 6020 746f 2073 7065 6369 6679  n=60` to specify
-0000c470: 2069 7420 7065 722d 766f 6c75 6d65 0a0a   it per-volume..
-0000c480: 7570 6c6f 6164 7320 6172 6520 6469 7361  uploads are disa
-0000c490: 626c 6564 2077 6869 6c65 2061 2072 6573  bled while a res
-0000c4a0: 6361 6e20 6973 2068 6170 7065 6e69 6e67  can is happening
-0000c4b0: 2c20 736f 2072 6573 6361 6e73 2077 696c  , so rescans wil
-0000c4c0: 6c20 6265 2064 656c 6179 6564 2062 7920  l be delayed by 
-0000c4d0: 602d 2d64 622d 6163 7460 2028 6465 6661  `--db-act` (defa
-0000c4e0: 756c 7420 3130 2073 6563 2920 7768 656e  ult 10 sec) when
-0000c4f0: 2074 6865 7265 2069 7320 7772 6974 652d   there is write-
-0000c500: 6163 7469 7669 7479 2067 6f69 6e67 206f  activity going o
-0000c510: 6e20 2875 706c 6f61 6473 2c20 7265 6e61  n (uploads, rena
-0000c520: 6d65 732c 202e 2e2e 290a 0a0a 2323 2075  mes, ...)...## u
-0000c530: 706c 6f61 6420 7275 6c65 730a 0a73 6574  pload rules..set
-0000c540: 2075 706c 6f61 6420 7275 6c65 7320 7573   upload rules us
-0000c550: 696e 6720 766f 6c66 6c61 6773 2c20 2073  ing volflags,  s
-0000c560: 6f6d 6520 6578 616d 706c 6573 3a0a 0a2a  ome examples:..*
-0000c570: 2060 3a63 2c73 7a3d 316b 2d33 6d60 2073   `:c,sz=1k-3m` s
-0000c580: 6574 7320 616c 6c6f 7765 6420 6669 6c65  ets allowed file
-0000c590: 7369 7a65 2062 6574 7765 656e 2031 204b  size between 1 K
-0000c5a0: 6942 2061 6e64 2033 204d 6942 2069 6e63  iB and 3 MiB inc
-0000c5b0: 6c75 7369 7665 2028 7375 6666 6978 6573  lusive (suffixes
-0000c5c0: 3a20 6062 602c 2060 6b60 2c20 606d 602c  : `b`, `k`, `m`,
-0000c5d0: 2060 6760 290a 2a20 603a 632c 6466 3d34   `g`).* `:c,df=4
-0000c5e0: 6760 2062 6c6f 636b 2075 706c 6f61 6473  g` block uploads
-0000c5f0: 2069 6620 7468 6572 6520 776f 756c 6420   if there would 
-0000c600: 6265 206c 6573 7320 7468 616e 2034 2047  be less than 4 G
-0000c610: 6942 2066 7265 6520 6469 736b 2073 7061  iB free disk spa
-0000c620: 6365 2061 6674 6572 7761 7264 730a 2a20  ce afterwards.* 
-0000c630: 603a 632c 6e6f 7375 6260 2064 6973 616c  `:c,nosub` disal
-0000c640: 6c6f 7720 7570 6c6f 6164 696e 6720 696e  low uploading in
-0000c650: 746f 2073 7562 6469 7265 6374 6f72 6965  to subdirectorie
-0000c660: 733b 2067 6f65 7320 7765 6c6c 2077 6974  s; goes well wit
-0000c670: 6820 6072 6f74 6e60 2061 6e64 2060 726f  h `rotn` and `ro
-0000c680: 7466 603a 0a2a 2060 3a63 2c72 6f74 6e3d  tf`:.* `:c,rotn=
-0000c690: 3130 3030 2c32 6020 6d6f 7665 7320 7570  1000,2` moves up
-0000c6a0: 6c6f 6164 7320 696e 746f 2073 7562 666f  loads into subfo
-0000c6b0: 6c64 6572 732c 2075 7020 746f 2031 3030  lders, up to 100
-0000c6c0: 3020 6669 6c65 7320 696e 2065 6163 6820  0 files in each 
-0000c6d0: 666f 6c64 6572 2062 6566 6f72 6520 6d61  folder before ma
-0000c6e0: 6b69 6e67 2061 206e 6577 206f 6e65 2c20  king a new one, 
-0000c6f0: 7477 6f20 6c65 7665 6c73 2064 6565 7020  two levels deep 
-0000c700: 286d 7573 7420 6265 2061 7420 6c65 6173  (must be at leas
-0000c710: 7420 3129 0a2a 2060 3a63 2c72 6f74 663d  t 1).* `:c,rotf=
-0000c720: 2559 2f25 6d2f 2564 2f25 4860 2065 6e66  %Y/%m/%d/%H` enf
-0000c730: 6f72 6365 7320 6669 6c65 7320 746f 2062  orces files to b
-0000c740: 6520 7570 6c6f 6164 6564 2069 6e74 6f20  e uploaded into 
-0000c750: 6120 7374 7275 6374 7572 6520 6f66 2073  a structure of s
-0000c760: 7562 666f 6c64 6572 7320 6163 636f 7264  ubfolders accord
-0000c770: 696e 6720 746f 2074 6861 7420 6461 7465  ing to that date
-0000c780: 2066 6f72 6d61 740a 2020 2a20 6966 2073   format.  * if s
-0000c790: 6f6d 656f 6e65 2075 706c 6f61 6473 2074  omeone uploads t
-0000c7a0: 6f20 602f 666f 6f2f 6261 7260 2074 6865  o `/foo/bar` the
-0000c7b0: 2070 6174 6820 776f 756c 6420 6265 2072   path would be r
-0000c7c0: 6577 7269 7474 656e 2074 6f20 602f 666f  ewritten to `/fo
-0000c7d0: 6f2f 6261 722f 3230 3231 2f30 382f 3036  o/bar/2021/08/06
-0000c7e0: 2f32 3360 2066 6f72 2065 7861 6d70 6c65  /23` for example
-0000c7f0: 0a20 202a 2062 7574 2074 6865 2061 6374  .  * but the act
-0000c800: 7561 6c20 7661 6c75 6520 6973 206e 6f74  ual value is not
-0000c810: 2076 6572 6966 6965 642c 206a 7573 7420   verified, just 
-0000c820: 7468 6520 7374 7275 6374 7572 652c 2073  the structure, s
-0000c830: 6f20 7468 6520 7570 6c6f 6164 6572 2063  o the uploader c
-0000c840: 616e 2063 686f 6f73 6520 616e 7920 7661  an choose any va
-0000c850: 6c75 6573 2077 6869 6368 2063 6f6e 666f  lues which confo
-0000c860: 726d 2074 6f20 7468 6520 666f 726d 6174  rm to the format
-0000c870: 2073 7472 696e 670a 2020 2020 2a20 6a75   string.    * ju
-0000c880: 7374 2074 6f20 6176 6f69 6420 6164 6469  st to avoid addi
-0000c890: 7469 6f6e 616c 2063 6f6d 706c 6578 6974  tional complexit
-0000c8a0: 7920 696e 2075 7032 6b20 7768 6963 6820  y in up2k which 
-0000c8b0: 6973 2065 6e6f 7567 6820 6f66 2061 206d  is enough of a m
-0000c8c0: 6573 7320 616c 7265 6164 790a 2a20 603a  ess already.* `:
-0000c8d0: 632c 6c69 6665 7469 6d65 3d33 3030 6020  c,lifetime=300` 
-0000c8e0: 6465 6c65 7465 2075 706c 6f61 6465 6420  delete uploaded 
-0000c8f0: 6669 6c65 7320 7768 656e 2074 6865 7920  files when they 
-0000c900: 6265 636f 6d65 2035 206d 696e 7574 6573  become 5 minutes
-0000c910: 206f 6c64 0a0a 796f 7520 6361 6e20 616c   old..you can al
-0000c920: 736f 2073 6574 2074 7261 6e73 6163 7469  so set transacti
-0000c930: 6f6e 206c 696d 6974 7320 7768 6963 6820  on limits which 
-0000c940: 6170 706c 7920 7065 722d 4950 2061 6e64  apply per-IP and
-0000c950: 2070 6572 2d76 6f6c 756d 652c 2062 7574   per-volume, but
-0000c960: 2074 6865 7365 2061 7373 756d 6520 602d   these assume `-
-0000c970: 6a20 3160 2028 6465 6661 756c 7429 206f  j 1` (default) o
-0000c980: 7468 6572 7769 7365 2074 6865 206c 696d  therwise the lim
-0000c990: 6974 7320 7769 6c6c 2062 6520 6f66 662c  its will be off,
-0000c9a0: 2066 6f72 2065 7861 6d70 6c65 2060 2d6a   for example `-j
-0000c9b0: 2034 6020 776f 756c 6420 616c 6c6f 7720   4` would allow 
-0000c9c0: 616e 7977 6865 7265 2062 6574 7765 656e  anywhere between
-0000c9d0: 2031 7820 616e 6420 3478 2074 6865 206c   1x and 4x the l
-0000c9e0: 696d 6974 7320 796f 7520 7365 7420 6465  imits you set de
-0000c9f0: 7065 6e64 696e 6720 6f6e 2077 6869 6368  pending on which
-0000ca00: 2070 726f 6365 7373 696e 6720 6e6f 6465   processing node
-0000ca10: 2074 6865 2063 6c69 656e 7420 6765 7473   the client gets
-0000ca20: 2072 6f75 7465 6420 746f 0a0a 2a20 603a   routed to..* `:
-0000ca30: 632c 6d61 786e 3d32 3530 2c33 3630 3060  c,maxn=250,3600`
-0000ca40: 2061 6c6c 6f77 7320 3235 3020 6669 6c65   allows 250 file
-0000ca50: 7320 6f76 6572 2031 2068 6f75 7220 6672  s over 1 hour fr
-0000ca60: 6f6d 2065 6163 6820 4950 2028 7472 6163  om each IP (trac
-0000ca70: 6b65 6420 7065 722d 766f 6c75 6d65 290a  ked per-volume).
-0000ca80: 2a20 603a 632c 6d61 7862 3d31 672c 3330  * `:c,maxb=1g,30
-0000ca90: 3060 2061 6c6c 6f77 7320 3120 4769 4220  0` allows 1 GiB 
-0000caa0: 746f 7461 6c20 6f76 6572 2035 206d 696e  total over 5 min
-0000cab0: 7574 6573 2066 726f 6d20 6561 6368 2049  utes from each I
-0000cac0: 5020 2874 7261 636b 6564 2070 6572 2d76  P (tracked per-v
-0000cad0: 6f6c 756d 6529 0a0a 0a23 2320 636f 6d70  olume)...## comp
-0000cae0: 7265 7373 2075 706c 6f61 6473 0a0a 6669  ress uploads..fi
-0000caf0: 6c65 7320 6361 6e20 6265 2061 7574 6f63  les can be autoc
-0000cb00: 6f6d 7072 6573 7365 6420 6f6e 2075 706c  ompressed on upl
-0000cb10: 6f61 642c 2020 6569 7468 6572 206f 6e20  oad,  either on 
-0000cb20: 7573 6572 2d72 6571 7565 7374 2028 6966  user-request (if
-0000cb30: 2063 6f6e 6669 6720 616c 6c6f 7773 2920   config allows) 
-0000cb40: 6f72 2066 6f72 6365 6420 6279 2073 6572  or forced by ser
-0000cb50: 7665 722d 636f 6e66 6967 0a0a 2a20 766f  ver-config..* vo
-0000cb60: 6c66 6c61 6720 6067 7a60 2061 6c6c 6f77  lflag `gz` allow
-0000cb70: 7320 677a 2063 6f6d 7072 6573 7369 6f6e  s gz compression
-0000cb80: 0a2a 2076 6f6c 666c 6167 2060 787a 6020  .* volflag `xz` 
-0000cb90: 616c 6c6f 7773 206c 7a6d 6120 636f 6d70  allows lzma comp
-0000cba0: 7265 7373 696f 6e0a 2a20 766f 6c66 6c61  ression.* volfla
-0000cbb0: 6720 6070 6b60 202a 2a66 6f72 6365 732a  g `pk` **forces*
-0000cbc0: 2a20 636f 6d70 7265 7373 696f 6e20 6f6e  * compression on
-0000cbd0: 2061 6c6c 2066 696c 6573 0a2a 2075 726c   all files.* url
-0000cbe0: 2070 6172 616d 6574 6572 2060 706b 6020   parameter `pk` 
-0000cbf0: 7265 7175 6573 7473 2063 6f6d 7072 6573  requests compres
-0000cc00: 7369 6f6e 2077 6974 6820 7365 7276 6572  sion with server
-0000cc10: 2d64 6566 6175 6c74 2061 6c67 6f72 6974  -default algorit
-0000cc20: 686d 0a2a 2075 726c 2070 6172 616d 6574  hm.* url paramet
-0000cc30: 6572 2060 677a 6020 6f72 2060 787a 6020  er `gz` or `xz` 
-0000cc40: 7265 7175 6573 7473 2063 6f6d 7072 6573  requests compres
-0000cc50: 7369 6f6e 2077 6974 6820 6120 7370 6563  sion with a spec
-0000cc60: 6966 6963 2061 6c67 6f72 6974 686d 0a2a  ific algorithm.*
-0000cc70: 2075 726c 2070 6172 616d 6574 6572 2060   url parameter `
-0000cc80: 787a 6020 7265 7175 6573 7473 2078 7a20  xz` requests xz 
-0000cc90: 636f 6d70 7265 7373 696f 6e0a 0a74 6869  compression..thi
-0000cca0: 6e67 7320 746f 206e 6f74 652c 0a2a 2074  ngs to note,.* t
-0000ccb0: 6865 2060 677a 6020 616e 6420 6078 7a60  he `gz` and `xz`
-0000ccc0: 2061 7267 756d 656e 7473 2074 616b 6520   arguments take 
-0000ccd0: 6120 7369 6e67 6c65 206f 7074 696f 6e61  a single optiona
-0000cce0: 6c20 6172 6775 6d65 6e74 2c20 7468 6520  l argument, the 
-0000ccf0: 636f 6d70 7265 7373 696f 6e20 6c65 7665  compression leve
-0000cd00: 6c20 2872 616e 6765 2030 2074 6f20 3929  l (range 0 to 9)
-0000cd10: 0a2a 2074 6865 2060 706b 6020 766f 6c66  .* the `pk` volf
-0000cd20: 6c61 6720 7461 6b65 7320 7468 6520 6f70  lag takes the op
-0000cd30: 7469 6f6e 616c 2061 7267 756d 656e 7420  tional argument 
-0000cd40: 6041 4c47 4f52 4954 484d 2c4c 4556 454c  `ALGORITHM,LEVEL
-0000cd50: 6020 7768 6963 6820 7769 6c6c 2074 6865  ` which will the
-0000cd60: 6e20 6265 2066 6f72 6365 6420 666f 7220  n be forced for 
-0000cd70: 616c 6c20 7570 6c6f 6164 732c 2066 6f72  all uploads, for
-0000cd80: 2065 7861 6d70 6c65 2060 677a 2c39 6020   example `gz,9` 
-0000cd90: 6f72 2060 787a 2c30 600a 2a20 6465 6661  or `xz,0`.* defa
-0000cda0: 756c 7420 636f 6d70 7265 7373 696f 6e20  ult compression 
-0000cdb0: 6973 2067 7a69 7020 6c65 7665 6c20 390a  is gzip level 9.
-0000cdc0: 2a20 616c 6c20 7570 6c6f 6164 206d 6574  * all upload met
-0000cdd0: 686f 6473 2065 7863 6570 7420 7570 326b  hods except up2k
-0000cde0: 2061 7265 2073 7570 706f 7274 6564 0a2a   are supported.*
-0000cdf0: 2074 6865 2066 696c 6573 2077 696c 6c20   the files will 
-0000ce00: 6265 2069 6e64 6578 6564 2061 6674 6572  be indexed after
-0000ce10: 2063 6f6d 7072 6573 7369 6f6e 2c20 736f   compression, so
-0000ce20: 2064 7570 652d 6465 7465 6374 696f 6e20   dupe-detection 
-0000ce30: 616e 6420 6669 6c65 2d73 6561 7263 6820  and file-search 
-0000ce40: 7769 6c6c 206e 6f74 2077 6f72 6b20 6173  will not work as
-0000ce50: 2065 7870 6563 7465 640a 0a73 6f6d 6520   expected..some 
-0000ce60: 6578 616d 706c 6573 2c0a 2a20 602d 7620  examples,.* `-v 
-0000ce70: 696e 633a 696e 633a 773a 632c 706b 3d78  inc:inc:w:c,pk=x
-0000ce80: 7a2c 3060 2020 0a20 2066 6f6c 6465 7220  z,0`  .  folder 
-0000ce90: 6e61 6d65 6420 696e 632c 2073 6861 7265  named inc, share
-0000cea0: 6420 6174 2069 6e63 2c20 7772 6974 652d  d at inc, write-
-0000ceb0: 6f6e 6c79 2066 6f72 2065 7665 7279 6f6e  only for everyon
-0000cec0: 652c 2066 6f72 6365 7320 787a 2063 6f6d  e, forces xz com
-0000ced0: 7072 6573 7369 6f6e 2061 7420 6c65 7665  pression at leve
-0000cee0: 6c20 300a 2a20 602d 7620 696e 633a 696e  l 0.* `-v inc:in
-0000cef0: 633a 773a 632c 706b 6020 200a 2020 7361  c:w:c,pk`  .  sa
-0000cf00: 6d65 2077 7269 7465 2d6f 6e6c 7920 696e  me write-only in
-0000cf10: 632c 2062 7574 2066 6f72 6365 7320 677a  c, but forces gz
-0000cf20: 2063 6f6d 7072 6573 7369 6f6e 2028 6465   compression (de
-0000cf30: 6661 756c 7429 2069 6e73 7465 6164 206f  fault) instead o
-0000cf40: 6620 787a 0a2a 2060 2d76 2069 6e63 3a69  f xz.* `-v inc:i
-0000cf50: 6e63 3a77 3a63 2c67 7a60 2020 0a20 2061  nc:w:c,gz`  .  a
-0000cf60: 6c6c 6f77 7320 2862 7574 2064 6f65 7320  llows (but does 
-0000cf70: 6e6f 7420 666f 7263 6529 2067 7a20 636f  not force) gz co
-0000cf80: 6d70 7265 7373 696f 6e20 6966 2063 6c69  mpression if cli
-0000cf90: 656e 7420 7570 6c6f 6164 7320 746f 2060  ent uploads to `
-0000cfa0: 2f69 6e63 3f70 6b60 206f 7220 602f 696e  /inc?pk` or `/in
-0000cfb0: 633f 677a 6020 6f72 2060 2f69 6e63 3f67  c?gz` or `/inc?g
-0000cfc0: 7a3d 3460 0a0a 0a23 2320 6f74 6865 7220  z=4`...## other 
-0000cfd0: 666c 6167 730a 0a2a 2060 3a63 2c6d 6167  flags..* `:c,mag
-0000cfe0: 6963 6020 656e 6162 6c65 7320 6669 6c65  ic` enables file
-0000cff0: 7479 7065 2064 6574 6563 7469 6f6e 2066  type detection f
-0000d000: 6f72 206e 616d 656c 6573 7320 7570 6c6f  or nameless uplo
-0000d010: 6164 732c 2073 616d 6520 6173 2060 2d2d  ads, same as `--
-0000d020: 6d61 6769 6360 0a20 202a 206e 6565 6473  magic`.  * needs
-0000d030: 2068 7474 7073 3a2f 2f70 7970 692e 6f72   https://pypi.or
-0000d040: 672f 7072 6f6a 6563 742f 7079 7468 6f6e  g/project/python
-0000d050: 2d6d 6167 6963 2f20 6070 7974 686f 6e33  -magic/ `python3
-0000d060: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
-0000d070: 2d2d 7573 6572 202d 5520 7079 7468 6f6e  --user -U python
-0000d080: 2d6d 6167 6963 600a 2020 2a20 6f6e 2077  -magic`.  * on w
-0000d090: 696e 646f 7773 2067 7261 6220 7468 6973  indows grab this
-0000d0a0: 2069 6e73 7465 6164 2060 7079 7468 6f6e   instead `python
-0000d0b0: 3320 2d6d 2070 6970 2069 6e73 7461 6c6c  3 -m pip install
-0000d0c0: 202d 2d75 7365 7220 2d55 2070 7974 686f   --user -U pytho
-0000d0d0: 6e2d 6d61 6769 632d 6269 6e60 0a0a 0a23  n-magic-bin`...#
-0000d0e0: 2320 6461 7461 6261 7365 206c 6f63 6174  # database locat
-0000d0f0: 696f 6e0a 0a69 6e2d 766f 6c75 6d65 2028  ion..in-volume (
-0000d100: 602e 6869 7374 2f75 7032 6b2e 6462 602c  `.hist/up2k.db`,
-0000d110: 2064 6566 6175 6c74 2920 6f72 2073 6f6d   default) or som
-0000d120: 6577 6865 7265 2065 6c73 650a 0a63 6f70  ewhere else..cop
-0000d130: 7970 6172 7479 2063 7265 6174 6573 2061  yparty creates a
-0000d140: 2073 7562 666f 6c64 6572 206e 616d 6564   subfolder named
-0000d150: 2060 2e68 6973 7460 2069 6e73 6964 6520   `.hist` inside 
-0000d160: 6561 6368 2076 6f6c 756d 6520 7768 6572  each volume wher
-0000d170: 6520 6974 2073 746f 7265 7320 7468 6520  e it stores the 
-0000d180: 6461 7461 6261 7365 2c20 7468 756d 626e  database, thumbn
-0000d190: 6169 6c73 2c20 616e 6420 736f 6d65 206f  ails, and some o
-0000d1a0: 7468 6572 2073 7475 6666 0a0a 7468 6973  ther stuff..this
-0000d1b0: 2063 616e 2069 6e73 7465 6164 2062 6520   can instead be 
-0000d1c0: 6b65 7074 2069 6e20 6120 7369 6e67 6c65  kept in a single
-0000d1d0: 2070 6c61 6365 2075 7369 6e67 2074 6865   place using the
-0000d1e0: 2060 2d2d 6869 7374 6020 6172 6775 6d65   `--hist` argume
-0000d1f0: 6e74 2c20 6f72 2074 6865 2060 6869 7374  nt, or the `hist
-0000d200: 3d60 2076 6f6c 666c 6167 2c20 6f72 2061  =` volflag, or a
-0000d210: 206d 6978 206f 6620 626f 7468 3a0a 2a20   mix of both:.* 
-0000d220: 602d 2d68 6973 7420 7e2f 2e63 6163 6865  `--hist ~/.cache
-0000d230: 2f63 6f70 7970 6172 7479 202d 7620 7e2f  /copyparty -v ~/
-0000d240: 6d75 7369 633a 3a72 3a63 2c68 6973 743d  music::r:c,hist=
-0000d250: 2d60 2073 6574 7320 607e 2f2e 6361 6368  -` sets `~/.cach
-0000d260: 652f 636f 7079 7061 7274 7960 2061 7320  e/copyparty` as 
-0000d270: 7468 6520 6465 6661 756c 7420 706c 6163  the default plac
-0000d280: 6520 746f 2070 7574 2076 6f6c 756d 6520  e to put volume 
-0000d290: 696e 666f 2c20 6275 7420 607e 2f6d 7573  info, but `~/mus
-0000d2a0: 6963 6020 6765 7473 2074 6865 2072 6567  ic` gets the reg
-0000d2b0: 756c 6172 2060 2e68 6973 7460 2073 7562  ular `.hist` sub
-0000d2c0: 666f 6c64 6572 2028 602d 6020 7265 7374  folder (`-` rest
-0000d2d0: 6f72 6573 2064 6566 6175 6c74 2062 6568  ores default beh
-0000d2e0: 6176 696f 7229 0a0a 6e6f 7465 3a0a 2a20  avior)..note:.* 
-0000d2f0: 6d61 726b 646f 776e 2065 6469 7473 2061  markdown edits a
-0000d300: 7265 2061 6c77 6179 7320 7374 6f72 6564  re always stored
-0000d310: 2069 6e20 6120 6c6f 6361 6c20 602e 6869   in a local `.hi
-0000d320: 7374 6020 7375 6264 6972 6563 746f 7279  st` subdirectory
-0000d330: 0a2a 206f 6e20 7769 6e64 6f77 7320 7468  .* on windows th
-0000d340: 6520 766f 6c66 6c61 6720 7061 7468 2069  e volflag path i
-0000d350: 7320 6379 676c 696b 652c 2073 6f20 602f  s cyglike, so `/
-0000d360: 632f 7465 6d70 6020 6d65 616e 7320 6043  c/temp` means `C
-0000d370: 3a5c 7465 6d70 6020 6275 7420 7573 6520  :\temp` but use 
-0000d380: 7265 6775 6c61 7220 7061 7468 7320 666f  regular paths fo
-0000d390: 7220 602d 2d68 6973 7460 0a20 202a 2079  r `--hist`.  * y
-0000d3a0: 6f75 2063 616e 2075 7365 2063 7967 7061  ou can use cygpa
-0000d3b0: 7468 7320 666f 7220 766f 6c75 6d65 7320  ths for volumes 
-0000d3c0: 746f 6f2c 2060 2d76 2043 3a5c 5573 6572  too, `-v C:\User
-0000d3d0: 733a 3a72 6020 616e 6420 602d 7620 2f63  s::r` and `-v /c
-0000d3e0: 2f75 7365 7273 3a3a 7260 2062 6f74 6820  /users::r` both 
-0000d3f0: 776f 726b 0a0a 0a23 2320 6d65 7461 6461  work...## metada
-0000d400: 7461 2066 726f 6d20 6175 6469 6f20 6669  ta from audio fi
-0000d410: 6c65 730a 0a73 6574 2060 2d65 3274 6020  les..set `-e2t` 
-0000d420: 746f 2069 6e64 6578 2074 6167 7320 6f6e  to index tags on
-0000d430: 2075 706c 6f61 640a 0a60 2d6d 7465 6020   upload..`-mte` 
-0000d440: 6465 6369 6465 7320 7768 6963 6820 7461  decides which ta
-0000d450: 6773 2074 6f20 696e 6465 7820 616e 6420  gs to index and 
-0000d460: 6469 7370 6c61 7920 696e 2074 6865 2062  display in the b
-0000d470: 726f 7773 6572 2028 616e 6420 616c 736f  rowser (and also
-0000d480: 2074 6865 2064 6973 706c 6179 206f 7264   the display ord
-0000d490: 6572 292c 2074 6869 7320 6361 6e20 6265  er), this can be
-0000d4a0: 2063 6861 6e67 6564 2070 6572 2d76 6f6c   changed per-vol
-0000d4b0: 756d 653a 0a2a 2060 2d76 207e 2f6d 7573  ume:.* `-v ~/mus
-0000d4c0: 6963 3a3a 723a 632c 6d74 653d 7469 746c  ic::r:c,mte=titl
-0000d4d0: 652c 6172 7469 7374 6020 696e 6465 7865  e,artist` indexe
-0000d4e0: 7320 616e 6420 6469 7370 6c61 7973 202a  s and displays *
-0000d4f0: 7469 746c 652a 2066 6f6c 6c6f 7765 6420  title* followed 
-0000d500: 6279 202a 6172 7469 7374 2a0a 0a69 6620  by *artist*..if 
-0000d510: 796f 7520 6164 642f 7265 6d6f 7665 2061  you add/remove a
-0000d520: 2074 6167 2066 726f 6d20 606d 7465 6020   tag from `mte` 
-0000d530: 796f 7520 7769 6c6c 206e 6565 6420 746f  you will need to
-0000d540: 2072 756e 2077 6974 6820 602d 6532 7473   run with `-e2ts
-0000d550: 7260 206f 6e63 6520 746f 2072 6562 7569  r` once to rebui
-0000d560: 6c64 2074 6865 2064 6174 6162 6173 652c  ld the database,
-0000d570: 206f 7468 6572 7769 7365 206f 6e6c 7920   otherwise only 
-0000d580: 6e65 7720 6669 6c65 7320 7769 6c6c 2062  new files will b
-0000d590: 6520 6166 6665 6374 6564 0a0a 6275 7420  e affected..but 
-0000d5a0: 696e 7374 6561 6420 6f66 2075 7369 6e67  instead of using
-0000d5b0: 2060 2d6d 7465 602c 2060 2d6d 7468 6020   `-mte`, `-mth` 
-0000d5c0: 6973 2061 2062 6574 7465 7220 7761 7920  is a better way 
-0000d5d0: 746f 2068 6964 6520 7461 6773 2069 6e20  to hide tags in 
-0000d5e0: 7468 6520 6272 6f77 7365 723a 2074 6865  the browser: the
-0000d5f0: 7365 2074 6167 7320 7769 6c6c 206e 6f74  se tags will not
-0000d600: 2062 6520 6469 7370 6c61 7965 6420 6279   be displayed by
-0000d610: 2064 6566 6175 6c74 2c20 6275 7420 7468   default, but th
-0000d620: 6579 2073 7469 6c6c 2067 6574 2069 6e64  ey still get ind
-0000d630: 6578 6564 2061 6e64 2062 6563 6f6d 6520  exed and become 
-0000d640: 7365 6172 6368 6162 6c65 2c20 616e 6420  searchable, and 
-0000d650: 7573 6572 7320 6361 6e20 6368 6f6f 7365  users can choose
-0000d660: 2074 6f20 756e 6869 6465 2074 6865 6d20   to unhide them 
-0000d670: 696e 2074 6865 2060 5be2 9a99 efb8 8f5d  in the `[......]
-0000d680: 2063 6f6e 6669 6760 2070 616e 650a 0a60   config` pane..`
-0000d690: 2d6d 746d 6020 6361 6e20 6265 2075 7365  -mtm` can be use
-0000d6a0: 6420 746f 2061 6464 206f 7220 7265 6465  d to add or rede
-0000d6b0: 6669 6e65 2061 206d 6574 6164 6174 6120  fine a metadata 
-0000d6c0: 6d61 7070 696e 672c 2073 6179 2079 6f75  mapping, say you
-0000d6d0: 2068 6176 6520 6d65 6469 6120 6669 6c65   have media file
-0000d6e0: 7320 7769 7468 2060 666f 6f60 2061 6e64  s with `foo` and
-0000d6f0: 2060 6261 7260 2074 6167 7320 616e 6420   `bar` tags and 
-0000d700: 796f 7520 7761 6e74 2074 6865 6d20 746f  you want them to
-0000d710: 2064 6973 706c 6179 2061 7320 6071 7578   display as `qux
-0000d720: 6020 696e 2074 6865 2062 726f 7773 6572  ` in the browser
-0000d730: 2028 7072 6566 6572 7269 6e67 2060 666f   (preferring `fo
-0000d740: 6f60 2069 6620 626f 7468 2061 7265 2070  o` if both are p
-0000d750: 7265 7365 6e74 292c 2074 6865 6e20 646f  resent), then do
-0000d760: 2060 2d6d 746d 2071 7578 3d66 6f6f 2c62   `-mtm qux=foo,b
-0000d770: 6172 6020 616e 6420 6e6f 7720 796f 7520  ar` and now you 
-0000d780: 6361 6e20 602d 6d74 6520 6172 7469 7374  can `-mte artist
-0000d790: 2c74 6974 6c65 2c71 7578 600a 0a74 6167  ,title,qux`..tag
-0000d7a0: 7320 7468 6174 2073 7461 7274 2077 6974  s that start wit
-0000d7b0: 6820 6120 602e 6020 7375 6368 2061 7320  h a `.` such as 
-0000d7c0: 602e 6270 6d60 2061 6e64 2060 2e64 7572  `.bpm` and `.dur
-0000d7d0: 6028 6174 696f 6e29 2069 6e64 6963 6174  `(ation) indicat
-0000d7e0: 6520 6e75 6d65 7269 6320 7661 6c75 650a  e numeric value.
-0000d7f0: 0a73 6565 2074 6865 2062 6561 7574 6966  .see the beautif
-0000d800: 756c 206d 6573 7320 6f66 2061 2064 6963  ul mess of a dic
-0000d810: 7469 6f6e 6172 7920 696e 205b 6d74 6167  tionary in [mtag
-0000d820: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
-0000d830: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-0000d840: 7970 6172 7479 2f62 6c6f 622f 686f 7675  yparty/blob/hovu
-0000d850: 6473 7472 6175 6d2f 636f 7079 7061 7274  dstraum/copypart
-0000d860: 792f 6d74 6167 2e70 7929 2066 6f72 2074  y/mtag.py) for t
-0000d870: 6865 2064 6566 6175 6c74 206d 6170 7069  he default mappi
-0000d880: 6e67 7320 2873 686f 756c 6420 636f 7665  ngs (should cove
-0000d890: 7220 6d70 332c 6f70 7573 2c66 6c61 632c  r mp3,opus,flac,
-0000d8a0: 6d34 612c 7761 762c 6169 662c 290a 0a60  m4a,wav,aif,)..`
-0000d8b0: 2d2d 6e6f 2d6d 7574 6167 656e 6020 6469  --no-mutagen` di
-0000d8c0: 7361 626c 6573 204d 7574 6167 656e 2061  sables Mutagen a
-0000d8d0: 6e64 2075 7365 7320 4646 7072 6f62 6520  nd uses FFprobe 
-0000d8e0: 696e 7374 6561 642c 2077 6869 6368 2e2e  instead, which..
-0000d8f0: 2e0a 2a20 6973 2061 626f 7574 2032 3078  ..* is about 20x
-0000d900: 2073 6c6f 7765 7220 7468 616e 204d 7574   slower than Mut
-0000d910: 6167 656e 0a2a 2063 6174 6368 6573 2061  agen.* catches a
-0000d920: 2066 6577 2074 6167 7320 7468 6174 204d   few tags that M
-0000d930: 7574 6167 656e 2064 6f65 736e 2774 0a20  utagen doesn't. 
-0000d940: 202a 206d 656c 6f64 6963 206b 6579 2c20   * melodic key, 
-0000d950: 7669 6465 6f20 7265 736f 6c75 7469 6f6e  video resolution
-0000d960: 2c20 6672 616d 6572 6174 652c 2070 6978  , framerate, pix
-0000d970: 666d 740a 2a20 6176 6f69 6473 2070 756c  fmt.* avoids pul
-0000d980: 6c69 6e67 2061 6e79 2047 504c 2063 6f64  ling any GPL cod
-0000d990: 6520 696e 746f 2063 6f70 7970 6172 7479  e into copyparty
-0000d9a0: 0a2a 206d 6f72 6520 696d 706f 7274 616e  .* more importan
-0000d9b0: 746c 7920 7275 6e73 2046 4670 726f 6265  tly runs FFprobe
-0000d9c0: 206f 6e20 696e 636f 6d69 6e67 2066 696c   on incoming fil
-0000d9d0: 6573 2077 6869 6368 2069 7320 6261 6420  es which is bad 
-0000d9e0: 6966 2079 6f75 7220 4646 6d70 6567 2068  if your FFmpeg h
-0000d9f0: 6173 2061 2063 7665 0a0a 602d 2d6d 7461  as a cve..`--mta
-0000da00: 672d 746f 6020 7365 7473 2074 6865 2074  g-to` sets the t
-0000da10: 6167 2d73 6361 6e20 7469 6d65 6f75 743b  ag-scan timeout;
-0000da20: 2076 6572 7920 6869 6768 2064 6566 6175   very high defau
-0000da30: 6c74 2028 3630 2073 6563 2920 746f 2063  lt (60 sec) to c
-0000da40: 6174 6572 2066 6f72 207a 6673 2061 6e64  ater for zfs and
-0000da50: 206f 7468 6572 2072 616e 646f 6d6c 792d   other randomly-
-0000da60: 6672 6565 7a69 6e67 2066 696c 6573 7973  freezing filesys
-0000da70: 7465 6d73 2e20 4c6f 7765 7220 7661 6c75  tems. Lower valu
-0000da80: 6573 206c 696b 6520 3130 2061 7265 2075  es like 10 are u
-0000da90: 7375 616c 6c79 2073 6166 652c 2061 6c6c  sually safe, all
-0000daa0: 6f77 696e 6720 666f 7220 6661 7374 6572  owing for faster
-0000dab0: 2070 726f 6365 7373 696e 6720 6f66 2074   processing of t
-0000dac0: 7269 636b 7920 6669 6c65 730a 0a0a 2323  ricky files...##
-0000dad0: 2066 696c 6520 7061 7273 6572 2070 6c75   file parser plu
-0000dae0: 6769 6e73 0a0a 7072 6f76 6964 6520 6375  gins..provide cu
-0000daf0: 7374 6f6d 2070 6172 7365 7273 2074 6f20  stom parsers to 
-0000db00: 696e 6465 7820 6164 6469 7469 6f6e 616c  index additional
-0000db10: 2074 6167 732c 2020 616c 736f 2073 6565   tags,  also see
-0000db20: 205b 2e2f 6269 6e2f 6d74 6167 2f52 4541   [./bin/mtag/REA
-0000db30: 444d 452e 6d64 5d28 2e2f 6269 6e2f 6d74  DME.md](./bin/mt
-0000db40: 6167 2f52 4541 444d 452e 6d64 290a 0a63  ag/README.md)..c
-0000db50: 6f70 7970 6172 7479 2063 616e 2069 6e76  opyparty can inv
-0000db60: 6f6b 6520 6578 7465 726e 616c 2070 726f  oke external pro
-0000db70: 6772 616d 7320 746f 2063 6f6c 6c65 6374  grams to collect
-0000db80: 2061 6464 6974 696f 6e61 6c20 6d65 7461   additional meta
-0000db90: 6461 7461 2066 6f72 2066 696c 6573 2075  data for files u
-0000dba0: 7369 6e67 2060 6d74 7060 2028 6569 7468  sing `mtp` (eith
-0000dbb0: 6572 2061 7320 6172 6775 6d65 6e74 206f  er as argument o
-0000dbc0: 7220 766f 6c66 6c61 6729 2c20 7468 6572  r volflag), ther
-0000dbd0: 6520 6973 2061 2064 6566 6175 6c74 2074  e is a default t
-0000dbe0: 696d 656f 7574 206f 6620 3630 7365 632c  imeout of 60sec,
-0000dbf0: 2061 6e64 206f 6e6c 7920 6669 6c65 7320   and only files 
-0000dc00: 7768 6963 6820 636f 6e74 6169 6e20 6175  which contain au
-0000dc10: 6469 6f20 6765 7420 616e 616c 797a 6564  dio get analyzed
-0000dc20: 2062 7920 6465 6661 756c 7420 2873 6565   by default (see
-0000dc30: 2061 792f 616e 2f61 6420 6265 6c6f 7729   ay/an/ad below)
-0000dc40: 0a0a 2a20 602d 6d74 7020 2e62 706d 3d7e  ..* `-mtp .bpm=~
-0000dc50: 2f62 696e 2f61 7564 696f 2d62 706d 2e70  /bin/audio-bpm.p
-0000dc60: 7960 2077 696c 6c20 6578 6563 7574 6520  y` will execute 
-0000dc70: 607e 2f62 696e 2f61 7564 696f 2d62 706d  `~/bin/audio-bpm
-0000dc80: 2e70 7960 2077 6974 6820 7468 6520 6175  .py` with the au
-0000dc90: 6469 6f20 6669 6c65 2061 7320 6172 6775  dio file as argu
-0000dca0: 6d65 6e74 2031 2074 6f20 7072 6f76 6964  ment 1 to provid
-0000dcb0: 6520 7468 6520 602e 6270 6d60 2074 6167  e the `.bpm` tag
-0000dcc0: 2c20 6966 2074 6861 7420 646f 6573 206e  , if that does n
-0000dcd0: 6f74 2065 7869 7374 2069 6e20 7468 6520  ot exist in the 
-0000dce0: 6175 6469 6f20 6d65 7461 6461 7461 0a2a  audio metadata.*
-0000dcf0: 2060 2d6d 7470 206b 6579 3d66 2c74 352c   `-mtp key=f,t5,
-0000dd00: 7e2f 6269 6e2f 6175 6469 6f2d 6b65 792e  ~/bin/audio-key.
-0000dd10: 7079 6020 7573 6573 2060 7e2f 6269 6e2f  py` uses `~/bin/
-0000dd20: 6175 6469 6f2d 6b65 792e 7079 6020 746f  audio-key.py` to
-0000dd30: 2067 6574 2074 6865 2060 6b65 7960 2074   get the `key` t
-0000dd40: 6167 2c20 7265 706c 6163 696e 6720 616e  ag, replacing an
-0000dd50: 7920 6578 6973 7469 6e67 206d 6574 6164  y existing metad
-0000dd60: 6174 6120 7461 6720 2860 662c 6029 2c20  ata tag (`f,`), 
-0000dd70: 6162 6f72 7469 6e67 2069 6620 6974 2074  aborting if it t
-0000dd80: 616b 6573 206c 6f6e 6765 7220 7468 616e  akes longer than
-0000dd90: 2035 7365 6320 2860 7435 2c60 290a 2a20   5sec (`t5,`).* 
-0000dda0: 602d 7620 7e2f 6d75 7369 633a 3a72 3a63  `-v ~/music::r:c
-0000ddb0: 2c6d 7470 3d2e 6270 6d3d 7e2f 6269 6e2f  ,mtp=.bpm=~/bin/
-0000ddc0: 6175 6469 6f2d 6270 6d2e 7079 3a63 2c6d  audio-bpm.py:c,m
-0000ddd0: 7470 3d6b 6579 3d66 2c74 352c 7e2f 6269  tp=key=f,t5,~/bi
-0000dde0: 6e2f 6175 6469 6f2d 6b65 792e 7079 6020  n/audio-key.py` 
-0000ddf0: 626f 7468 2061 7320 6120 7065 722d 766f  both as a per-vo
-0000de00: 6c75 6d65 2063 6f6e 6669 6720 776f 7720  lume config wow 
-0000de10: 7468 6973 2069 7320 6765 7474 696e 6720  this is getting 
-0000de20: 7567 6c79 0a0a 2a62 7574 2077 6169 742c  ugly..*but wait,
-0000de30: 2074 6865 7265 2773 206d 6f72 6521 2a20   there's more!* 
-0000de40: 602d 6d74 7060 2063 616e 2062 6520 7573  `-mtp` can be us
-0000de50: 6564 2066 6f72 206e 6f6e 2d61 7564 696f  ed for non-audio
-0000de60: 2066 696c 6573 2061 7320 7765 6c6c 2075   files as well u
-0000de70: 7369 6e67 2074 6865 2060 6160 2066 6c61  sing the `a` fla
-0000de80: 673a 2060 6179 6020 6f6e 6c79 2064 6f20  g: `ay` only do 
-0000de90: 6175 6469 6f20 6669 6c65 7320 2864 6566  audio files (def
-0000dea0: 6175 6c74 292c 2060 616e 6020 6f6e 6c79  ault), `an` only
-0000deb0: 2064 6f20 6e6f 6e2d 6175 6469 6f20 6669   do non-audio fi
-0000dec0: 6c65 732c 206f 7220 6061 6460 2064 6f20  les, or `ad` do 
-0000ded0: 616c 6c20 6669 6c65 7320 2864 2061 7320  all files (d as 
-0000dee0: 696e 2064 6f6e 7463 6172 6529 0a0a 2a20  in dontcare)..* 
-0000def0: 2261 7564 696f 2066 696c 6522 2061 6c73  "audio file" als
-0000df00: 6f20 6d65 616e 7320 7669 6465 6f73 2062  o means videos b
-0000df10: 7477 2c20 6173 206c 6f6e 6720 6173 2074  tw, as long as t
-0000df20: 6865 7265 2069 7320 616e 2061 7564 696f  here is an audio
-0000df30: 2073 7472 6561 6d0a 2a20 602d 6d74 7020   stream.* `-mtp 
-0000df40: 6578 743d 616e 2c7e 2f62 696e 2f66 696c  ext=an,~/bin/fil
-0000df50: 652d 6578 742e 7079 6020 7275 6e73 2060  e-ext.py` runs `
-0000df60: 7e2f 6269 6e2f 6669 6c65 2d65 7874 2e70  ~/bin/file-ext.p
-0000df70: 7960 2074 6f20 6765 7420 7468 6520 6065  y` to get the `e
-0000df80: 7874 6020 7461 6720 6f6e 6c79 2069 6620  xt` tag only if 
-0000df90: 6669 6c65 2069 7320 6e6f 7420 6175 6469  file is not audi
-0000dfa0: 6f20 2860 616e 6029 0a2a 2060 2d6d 7470  o (`an`).* `-mtp
-0000dfb0: 2061 7263 682c 6275 696c 742c 7665 722c   arch,built,ver,
-0000dfc0: 6f72 6967 3d61 6e2c 6565 7865 2c65 646c  orig=an,eexe,edl
-0000dfd0: 6c2c 7e2f 6269 6e2f 6578 652e 7079 6020  l,~/bin/exe.py` 
-0000dfe0: 7275 6e73 2060 7e2f 6269 6e2f 6578 652e  runs `~/bin/exe.
-0000dff0: 7079 6020 746f 2067 6574 2070 726f 7065  py` to get prope
-0000e000: 7274 6965 7320 6162 6f75 7420 7769 6e64  rties about wind
-0000e010: 6f77 732d 6269 6e61 7269 6573 206f 6e6c  ows-binaries onl
-0000e020: 7920 6966 2066 696c 6520 6973 206e 6f74  y if file is not
-0000e030: 2061 7564 696f 2028 6061 6e60 2920 616e   audio (`an`) an
-0000e040: 6420 6669 6c65 2065 7874 656e 7369 6f6e  d file extension
-0000e050: 2069 7320 6578 6520 6f72 2064 6c6c 0a2a   is exe or dll.*
-0000e060: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-0000e070: 6461 6973 7963 6861 696e 2070 6172 7365  daisychain parse
-0000e080: 7273 2c20 7573 6520 7468 6520 6070 6020  rs, use the `p` 
-0000e090: 666c 6167 2074 6f20 7365 7420 7072 6f63  flag to set proc
-0000e0a0: 6573 7369 6e67 206f 7264 6572 0a20 202a  essing order.  *
-0000e0b0: 2060 2d6d 7470 2066 6f6f 3d70 312c 7e2f   `-mtp foo=p1,~/
-0000e0c0: 612e 7079 6020 7275 6e73 2062 6566 6f72  a.py` runs befor
-0000e0d0: 6520 602d 6d74 7020 666f 6f3d 7032 2c7e  e `-mtp foo=p2,~
-0000e0e0: 2f62 2e70 7960 2061 6e64 2077 696c 6c20  /b.py` and will 
-0000e0f0: 666f 7277 6172 6420 616c 6c20 7468 6520  forward all the 
-0000e100: 7461 6773 2064 6574 6563 7465 6420 736f  tags detected so
-0000e110: 2066 6172 2061 7320 6a73 6f6e 2074 6f20   far as json to 
-0000e120: 7468 6520 7374 6469 6e20 6f66 2062 2e70  the stdin of b.p
-0000e130: 790a 2a20 6f70 7469 6f6e 2060 6330 6020  y.* option `c0` 
-0000e140: 6469 7361 626c 6573 2063 6170 7475 7269  disables capturi
-0000e150: 6e67 206f 6620 7374 646f 7574 2f73 7464  ng of stdout/std
-0000e160: 6572 722c 2073 6f20 636f 7079 7061 7274  err, so copypart
-0000e170: 7920 7769 6c6c 206e 6f74 2072 6563 6569  y will not recei
-0000e180: 7665 2061 6e79 2074 6167 7320 6672 6f6d  ve any tags from
-0000e190: 2074 6865 2070 726f 6365 7373 2061 7420   the process at 
-0000e1a0: 616c 6c20 2d2d 2069 6e73 7465 6164 2074  all -- instead t
-0000e1b0: 6865 2069 6e76 6f6b 6564 2070 726f 6772  he invoked progr
-0000e1c0: 616d 2069 7320 6672 6565 2074 6f20 7072  am is free to pr
-0000e1d0: 696e 7420 7768 6174 6576 6572 2074 6f20  int whatever to 
-0000e1e0: 7468 6520 636f 6e73 6f6c 652c 206a 7573  the console, jus
-0000e1f0: 7420 7573 696e 6720 636f 7079 7061 7274  t using copypart
-0000e200: 7920 6173 2061 206c 6175 6e63 6865 720a  y as a launcher.
-0000e210: 2020 2a20 6063 3160 2063 6170 7475 7265    * `c1` capture
-0000e220: 7320 7374 646f 7574 206f 6e6c 792c 2060  s stdout only, `
-0000e230: 6332 6020 6f6e 6c79 2073 7464 6572 722c  c2` only stderr,
-0000e240: 2061 6e64 2060 6333 6020 2864 6566 6175   and `c3` (defau
-0000e250: 6c74 2920 6361 7074 7572 6573 2062 6f74  lt) captures bot
-0000e260: 680a 2a20 796f 7520 6361 6e20 636f 6e74  h.* you can cont
-0000e270: 726f 6c20 686f 7720 7468 6520 7061 7273  rol how the pars
-0000e280: 6572 2069 7320 6b69 6c6c 6564 2069 6620  er is killed if 
-0000e290: 6974 2074 696d 6573 206f 7574 2077 6974  it times out wit
-0000e2a0: 6820 6f70 7469 6f6e 2060 6b74 6020 6b69  h option `kt` ki
-0000e2b0: 6c6c 696e 6720 7468 6520 656e 7469 7265  lling the entire
-0000e2c0: 2070 726f 6365 7373 2074 7265 6520 2864   process tree (d
-0000e2d0: 6566 6175 6c74 292c 2060 6b6d 6020 6a75  efault), `km` ju
-0000e2e0: 7374 2074 6865 206d 6169 6e20 7072 6f63  st the main proc
-0000e2f0: 6573 732c 206f 7220 606b 6e60 206c 6574  ess, or `kn` let
-0000e300: 2069 7420 636f 6e74 696e 7565 2072 756e   it continue run
-0000e310: 6e69 6e67 2075 6e74 696c 2063 6f70 7970  ning until copyp
-0000e320: 6172 7479 2069 7320 7465 726d 696e 6174  arty is terminat
-0000e330: 6564 0a0a 6966 2073 6f6d 6574 6869 6e67  ed..if something
-0000e340: 2064 6f65 736e 2774 2077 6f72 6b2c 2074   doesn't work, t
-0000e350: 7279 2060 2d2d 6d74 6167 2d76 6020 666f  ry `--mtag-v` fo
-0000e360: 7220 7665 7262 6f73 6520 6572 726f 7220  r verbose error 
-0000e370: 6d65 7373 6167 6573 0a0a 0a23 2320 6576  messages...## ev
-0000e380: 656e 7420 686f 6f6b 730a 0a74 7269 6767  ent hooks..trigg
-0000e390: 6572 2061 2070 726f 6772 616d 206f 6e20  er a program on 
-0000e3a0: 7570 6c6f 6164 732c 2072 656e 616d 6573  uploads, renames
-0000e3b0: 2065 7463 2028 5b65 7861 6d70 6c65 735d   etc ([examples]
-0000e3c0: 282e 2f62 696e 2f68 6f6f 6b73 2f29 290a  (./bin/hooks/)).
-0000e3d0: 0a79 6f75 2063 616e 2073 6574 2068 6f6f  .you can set hoo
-0000e3e0: 6b73 2062 6566 6f72 6520 616e 642f 6f72  ks before and/or
-0000e3f0: 2061 6674 6572 2061 6e20 6576 656e 7420   after an event 
-0000e400: 6861 7070 656e 732c 2061 6e64 2063 7572  happens, and cur
-0000e410: 7265 6e74 6c79 2079 6f75 2063 616e 2068  rently you can h
-0000e420: 6f6f 6b20 7570 6c6f 6164 732c 206d 6f76  ook uploads, mov
-0000e430: 6573 2f72 656e 616d 6573 2c20 616e 6420  es/renames, and 
-0000e440: 6465 6c65 7465 730a 0a74 6865 7265 2773  deletes..there's
-0000e450: 2061 2062 756e 6368 206f 6620 666c 6167   a bunch of flag
-0000e460: 7320 616e 6420 7374 7566 662c 2073 6565  s and stuff, see
-0000e470: 2060 2d2d 6865 6c70 2d68 6f6f 6b73 600a   `--help-hooks`.
-0000e480: 0a0a 2323 2320 7570 6c6f 6164 2065 7665  ..### upload eve
-0000e490: 6e74 730a 0a74 6865 206f 6c64 6572 2c20  nts..the older, 
-0000e4a0: 6d6f 7265 2070 6f77 6572 6675 6c20 6170  more powerful ap
-0000e4b0: 7072 6f61 6368 2028 5b65 7861 6d70 6c65  proach ([example
-0000e4c0: 735d 282e 2f62 696e 2f6d 7461 672f 2929  s](./bin/mtag/))
-0000e4d0: 3a0a 0a60 6060 0a2d 7620 2f6d 6e74 2f69  :..```.-v /mnt/i
-0000e4e0: 6e63 3a69 6e63 3a77 3a63 2c6d 7465 3d2b  nc:inc:w:c,mte=+
-0000e4f0: 7831 3a63 2c6d 7470 3d78 313d 6164 2c6b  x1:c,mtp=x1=ad,k
-0000e500: 6e2c 2f75 7372 2f62 696e 2f6e 6f74 6966  n,/usr/bin/notif
-0000e510: 792d 7365 6e64 0a60 6060 0a0a 736f 2066  y-send.```..so f
-0000e520: 696c 6573 7973 7465 6d20 6c6f 6361 7469  ilesystem locati
-0000e530: 6f6e 2060 2f6d 6e74 2f69 6e63 6020 7368  on `/mnt/inc` sh
-0000e540: 6172 6564 2061 7420 602f 696e 6360 2c20  ared at `/inc`, 
-0000e550: 7772 6974 652d 6f6e 6c79 2066 6f72 2065  write-only for e
-0000e560: 7665 7279 6f6e 652c 2061 7070 656e 6469  veryone, appendi
-0000e570: 6e67 2060 7831 6020 746f 2074 6865 206c  ng `x1` to the l
-0000e580: 6973 7420 6f66 2074 6167 7320 746f 2069  ist of tags to i
-0000e590: 6e64 6578 2028 606d 7465 6029 2c20 616e  ndex (`mte`), an
-0000e5a0: 6420 7573 696e 6720 602f 7573 722f 6269  d using `/usr/bi
-0000e5b0: 6e2f 6e6f 7469 6679 2d73 656e 6460 2074  n/notify-send` t
-0000e5c0: 6f20 2270 726f 7669 6465 2220 7461 6720  o "provide" tag 
-0000e5d0: 6078 3160 2066 6f72 2061 6e79 2066 696c  `x1` for any fil
-0000e5e0: 6574 7970 6520 2860 6164 6029 2077 6974  etype (`ad`) wit
-0000e5f0: 6820 6b69 6c6c 2d6f 6e2d 7469 6d65 6f75  h kill-on-timeou
-0000e600: 7420 6469 7361 626c 6564 2028 606b 6e60  t disabled (`kn`
-0000e610: 290a 0a74 6861 7427 6c6c 2072 756e 2074  )..that'll run t
-0000e620: 6865 2063 6f6d 6d61 6e64 2060 6e6f 7469  he command `noti
-0000e630: 6679 2d73 656e 6460 2077 6974 6820 7468  fy-send` with th
-0000e640: 6520 7061 7468 2074 6f20 7468 6520 7570  e path to the up
-0000e650: 6c6f 6164 6564 2066 696c 6520 6173 2074  loaded file as t
-0000e660: 6865 2066 6972 7374 2061 6e64 206f 6e6c  he first and onl
-0000e670: 7920 6172 6775 6d65 6e74 2028 736f 206f  y argument (so o
-0000e680: 6e20 6c69 6e75 7820 6974 276c 6c20 7368  n linux it'll sh
-0000e690: 6f77 2061 206e 6f74 6966 6963 6174 696f  ow a notificatio
-0000e6a0: 6e20 6f6e 2d73 6372 6565 6e29 0a0a 6e6f  n on-screen)..no
-0000e6b0: 7465 2074 6861 7420 7468 6973 2069 7320  te that this is 
-0000e6c0: 7761 7920 6d6f 7265 2063 6f6d 706c 6963  way more complic
-0000e6d0: 6174 6564 2074 6861 6e20 7468 6520 6e65  ated than the ne
-0000e6e0: 7720 5b65 7665 6e74 2068 6f6f 6b73 5d28  w [event hooks](
-0000e6f0: 2365 7665 6e74 2d68 6f6f 6b73 2920 6275  #event-hooks) bu
-0000e700: 7420 7468 6973 2061 7070 726f 6163 6820  t this approach 
-0000e710: 6861 7320 7468 6520 666f 6c6c 6f77 696e  has the followin
-0000e720: 6720 6164 7661 6e74 6167 6573 3a0a 2a20  g advantages:.* 
-0000e730: 6e6f 6e2d 626c 6f63 6b69 6e67 2061 6e64  non-blocking and
-0000e740: 206d 756c 7469 7468 7265 6164 6564 3b20   multithreaded; 
-0000e750: 646f 6573 6e27 7420 686f 6c64 206f 7468  doesn't hold oth
-0000e760: 6572 2075 706c 6f61 6473 2062 6163 6b0a  er uploads back.
-0000e770: 2a20 796f 7520 6765 7420 6163 6365 7373  * you get access
-0000e780: 2074 6f20 7461 6773 2066 726f 6d20 4646   to tags from FF
-0000e790: 6d70 6567 2061 6e64 206f 7468 6572 206d  mpeg and other m
-0000e7a0: 7470 2070 6172 7365 7273 0a2a 206f 6e6c  tp parsers.* onl
-0000e7b0: 7920 7472 6967 6765 7220 6f6e 206e 6577  y trigger on new
-0000e7c0: 2075 6e69 7175 6520 6669 6c65 732c 206e   unique files, n
-0000e7d0: 6f74 2064 7570 6573 0a0a 6e6f 7465 2074  ot dupes..note t
-0000e7e0: 6861 7420 6974 2077 696c 6c20 6f63 6375  hat it will occu
-0000e7f0: 7079 2074 6865 2070 6172 7369 6e67 2074  py the parsing t
-0000e800: 6872 6561 6473 2c20 736f 2066 6f72 6b20  hreads, so fork 
-0000e810: 616e 7974 6869 6e67 2065 7870 656e 7369  anything expensi
-0000e820: 7665 2028 6f72 2073 6574 2060 6b6e 6020  ve (or set `kn` 
-0000e830: 746f 2068 6176 6520 636f 7079 7061 7274  to have copypart
-0000e840: 7920 666f 726b 2069 7420 666f 7220 796f  y fork it for yo
-0000e850: 7529 202d 2d20 6f74 6f68 2069 6620 796f  u) -- otoh if yo
-0000e860: 7520 7761 6e74 2074 6f20 696e 7465 6e74  u want to intent
-0000e870: 696f 6e61 6c6c 7920 7175 6575 652f 7369  ionally queue/si
-0000e880: 6e67 6c65 7468 7265 6164 2079 6f75 2063  nglethread you c
-0000e890: 616e 2063 6f6d 6269 6e65 2069 7420 7769  an combine it wi
-0000e8a0: 7468 2060 2d2d 6d74 6167 2d6d 7420 3160  th `--mtag-mt 1`
-0000e8b0: 0a0a 0a23 2320 6869 6469 6e67 2066 726f  ...## hiding fro
-0000e8c0: 6d20 676f 6f67 6c65 0a0a 7465 6c6c 2073  m google..tell s
-0000e8d0: 6561 7263 6820 656e 6769 6e65 7320 796f  earch engines yo
-0000e8e0: 7520 646f 6e74 2077 616e 6e61 2062 6520  u dont wanna be 
-0000e8f0: 696e 6465 7865 642c 2020 6569 7468 6572  indexed,  either
-0000e900: 2075 7369 6e67 2074 6865 2067 6f6f 6420   using the good 
-0000e910: 6f6c 6420 5b72 6f62 6f74 732e 7478 745d  old [robots.txt]
-0000e920: 2868 7474 7073 3a2f 2f77 7777 2e72 6f62  (https://www.rob
-0000e930: 6f74 7374 7874 2e6f 7267 2f72 6f62 6f74  otstxt.org/robot
-0000e940: 7374 7874 2e68 746d 6c29 206f 7220 7468  stxt.html) or th
-0000e950: 726f 7567 6820 636f 7079 7061 7274 7920  rough copyparty 
-0000e960: 7365 7474 696e 6773 3a0a 0a2a 2060 2d2d  settings:..* `--
-0000e970: 6e6f 2d72 6f62 6f74 7360 2061 6464 7320  no-robots` adds 
-0000e980: 4854 5450 2028 6058 2d52 6f62 6f74 732d  HTTP (`X-Robots-
-0000e990: 5461 6760 2920 616e 6420 4854 4d4c 2028  Tag`) and HTML (
-0000e9a0: 603c 6d65 7461 3e60 2920 6865 6164 6572  `<meta>`) header
-0000e9b0: 7320 7769 7468 2060 6e6f 696e 6465 782c  s with `noindex,
-0000e9c0: 206e 6f66 6f6c 6c6f 7760 2067 6c6f 6261   nofollow` globa
-0000e9d0: 6c6c 790a 2a20 766f 6c66 6c61 6720 605b  lly.* volflag `[
-0000e9e0: 2e2e 2e5d 3a63 2c6e 6f72 6f62 6f74 7360  ...]:c,norobots`
-0000e9f0: 2064 6f65 7320 7468 6520 7361 6d65 2074   does the same t
-0000ea00: 6869 6e67 2066 6f72 2074 6861 7420 7369  hing for that si
-0000ea10: 6e67 6c65 2076 6f6c 756d 650a 2a20 766f  ngle volume.* vo
-0000ea20: 6c66 6c61 6720 605b 2e2e 2e5d 3a63 2c72  lflag `[...]:c,r
-0000ea30: 6f62 6f74 7360 2041 4c4c 4f57 5320 7365  obots` ALLOWS se
-0000ea40: 6172 6368 2d65 6e67 696e 6520 6372 6177  arch-engine craw
-0000ea50: 6c69 6e67 2066 6f72 2074 6861 7420 766f  ling for that vo
-0000ea60: 6c75 6d65 2c20 6576 656e 2069 6620 602d  lume, even if `-
-0000ea70: 2d6e 6f2d 726f 626f 7473 6020 6973 2073  -no-robots` is s
-0000ea80: 6574 2067 6c6f 6261 6c6c 790a 0a61 6c73  et globally..als
-0000ea90: 6f2c 2060 2d2d 666f 7263 652d 6a73 6020  o, `--force-js` 
-0000eaa0: 6469 7361 626c 6573 2074 6865 2070 6c61  disables the pla
-0000eab0: 696e 2048 544d 4c20 666f 6c64 6572 206c  in HTML folder l
-0000eac0: 6973 7469 6e67 2c20 6d61 6b69 6e67 2074  isting, making t
-0000ead0: 6869 6e67 7320 6861 7264 6572 2074 6f20  hings harder to 
-0000eae0: 7061 7273 6520 666f 7220 7365 6172 6368  parse for search
-0000eaf0: 2065 6e67 696e 6573 0a0a 0a23 2320 7468   engines...## th
-0000eb00: 656d 6573 0a0a 796f 7520 6361 6e20 6368  emes..you can ch
-0000eb10: 616e 6765 2074 6865 2064 6566 6175 6c74  ange the default
-0000eb20: 2074 6865 6d65 2077 6974 6820 602d 2d74   theme with `--t
-0000eb30: 6865 6d65 2032 602c 2061 6e64 2061 6464  heme 2`, and add
-0000eb40: 2079 6f75 7220 6f77 6e20 7468 656d 6573   your own themes
-0000eb50: 2062 7920 6d6f 6469 6679 696e 6720 6062   by modifying `b
-0000eb60: 726f 7773 6572 2e63 7373 6020 6f72 2070  rowser.css` or p
-0000eb70: 726f 7669 6469 6e67 2079 6f75 7220 6f77  roviding your ow
-0000eb80: 6e20 6373 7320 746f 2060 2d2d 6373 732d  n css to `--css-
-0000eb90: 6272 6f77 7365 7260 2c20 7468 656e 2074  browser`, then t
-0000eba0: 656c 6c69 6e67 2063 6f70 7970 6172 7479  elling copyparty
-0000ebb0: 2074 6865 7920 6578 6973 7420 6279 2069   they exist by i
-0000ebc0: 6e63 7265 6173 696e 6720 602d 2d74 6865  ncreasing `--the
-0000ebd0: 6d65 7360 0a0a 3c74 6162 6c65 3e3c 7472  mes`..<table><tr
-0000ebe0: 3e3c 7464 2077 6964 7468 3d22 3333 2522  ><td width="33%"
-0000ebf0: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
-0000ec00: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
-0000ec10: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-0000ec20: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-0000ec30: 6f6d 2f32 3431 3033 322f 3136 3538 3634  om/241032/165864
-0000ec40: 3930 372d 3137 6532 6163 3764 2d33 3139  907-17e2ac7d-319
-0000ec50: 642d 3466 3235 2d38 3731 382d 3266 3337  d-4f25-8718-2f37
-0000ec60: 3666 3631 3462 3531 2e70 6e67 223e 3c69  6f614b51.png"><i
-0000ec70: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
-0000ec80: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
-0000ec90: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
-0000eca0: 6d2f 3234 3130 3332 2f31 3635 3836 3735  m/241032/1658675
-0000ecb0: 3531 2d66 6365 6233 3564 642d 3338 6630  51-fceb35dd-38f0
-0000ecc0: 2d34 3262 622d 6265 6633 2d32 3562 6136  -42bb-bef3-25ba6
-0000ecd0: 3531 6361 3639 622e 706e 6722 3e3c 2f61  51ca69b.png"></a
-0000ece0: 3e0a 302e 2063 6c61 7373 6963 2064 6172  >.0. classic dar
-0000ecf0: 6b3c 2f74 643e 3c74 6420 7769 6474 683d  k</td><td width=
-0000ed00: 2233 3325 2220 616c 6967 6e3d 2263 656e  "33%" align="cen
-0000ed10: 7465 7222 3e3c 6120 6872 6566 3d22 6874  ter"><a href="ht
-0000ed20: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
-0000ed30: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
-0000ed40: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
-0000ed50: 3638 3634 3433 3939 2d36 3839 3338 6465  68644399-68938de
-0000ed60: 352d 6461 3962 2d34 3435 662d 3864 3932  5-da9b-445f-8d92
-0000ed70: 2d62 3531 6337 3462 3566 3334 352e 706e  -b51c74b5f345.pn
-0000ed80: 6722 3e3c 696d 6720 7372 633d 2268 7474  g"><img src="htt
-0000ed90: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
-0000eda0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
-0000edb0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
-0000edc0: 3836 3434 3430 342d 3865 3161 3266 6463  8644404-8e1a2fdc
-0000edd0: 2d36 6535 392d 3463 3431 2d39 3035 652d  -6e59-4c41-905e-
-0000ede0: 6261 3533 3939 6564 3638 3666 2e70 6e67  ba5399ed686f.png
-0000edf0: 223e 3c2f 613e 0a32 2e20 666c 6174 2070  "></a>.2. flat p
-0000ee00: 6d2d 6d6f 6e6f 6b61 693c 2f74 643e 3c74  m-monokai</td><t
-0000ee10: 6420 7769 6474 683d 2233 3325 2220 616c  d width="33%" al
-0000ee20: 6967 6e3d 2263 656e 7465 7222 3e3c 6120  ign="center"><a 
-0000ee30: 6872 6566 3d22 6874 7470 733a 2f2f 7573  href="https://us
-0000ee40: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
-0000ee50: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
-0000ee60: 3234 3130 3332 2f31 3635 3836 3439 3031  241032/165864901
-0000ee70: 2d64 6231 3361 3432 392d 6135 6461 2d34  -db13a429-a5da-4
-0000ee80: 3936 642d 3862 6336 2d63 6538 3338 3534  96d-8bc6-ce83854
-0000ee90: 3766 3639 642e 706e 6722 3e3c 696d 6720  7f69d.png"><img 
-0000eea0: 7372 633d 2268 7474 7073 3a2f 2f75 7365  src="https://use
-0000eeb0: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
-0000eec0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
-0000eed0: 3431 3033 322f 3136 3538 3637 3536 302d  41032/165867560-
-0000eee0: 6161 3833 3461 6566 2d35 3864 632d 3461  aa834aef-58dc-4a
-0000eef0: 6265 2d62 6165 662d 3765 3536 3262 3634  be-baef-7e562b64
-0000ef00: 3739 3435 2e70 6e67 223e 3c2f 613e 0a34  7945.png"></a>.4
-0000ef10: 2e20 7669 6365 3c2f 7464 3e3c 2f74 723e  . vice</td></tr>
-0000ef20: 3c74 723e 3c74 6420 616c 6967 6e3d 2263  <tr><td align="c
-0000ef30: 656e 7465 7222 3e3c 6120 6872 6566 3d22  enter"><a href="
-0000ef40: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
-0000ef50: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
-0000ef60: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
-0000ef70: 2f31 3635 3836 3439 3035 2d36 3932 3638  /165864905-69268
-0000ef80: 3265 622d 3666 6234 2d34 6434 302d 6236  2eb-6fb4-4d40-b6
-0000ef90: 6665 2d32 3764 3263 3764 3365 3261 372e  fe-27d2c7d3e2a7.
-0000efa0: 706e 6722 3e3c 696d 6720 7372 633d 2268  png"><img src="h
-0000efb0: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-0000efc0: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-0000efd0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-0000efe0: 3136 3538 3637 3535 352d 3038 3062 3733  165867555-080b73
-0000eff0: 6236 2d36 6438 352d 3431 6262 2d61 3763  b6-6d85-41bb-a7c
-0000f000: 362d 6164 3237 3763 3630 3833 3635 2e70  6-ad277c608365.p
-0000f010: 6e67 223e 3c2f 613e 0a31 2e20 636c 6173  ng"></a>.1. clas
-0000f020: 7369 6320 6c69 6768 743c 2f74 643e 3c74  sic light</td><t
-0000f030: 6420 616c 6967 6e3d 2263 656e 7465 7222  d align="center"
-0000f040: 3e3c 6120 6872 6566 3d22 6874 7470 733a  ><a href="https:
-0000f050: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
-0000f060: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
-0000f070: 636f 6d2f 3234 3130 3332 2f31 3638 3634  com/241032/16864
-0000f080: 3532 3736 2d66 6230 3266 6431 392d 3139  5276-fb02fd19-19
-0000f090: 3061 2d34 3037 612d 6238 6433 2d64 3538  0a-407a-b8d3-d58
-0000f0a0: 6665 6532 3737 6530 322e 706e 6722 3e3c  fee277e02.png"><
-0000f0b0: 696d 6720 7372 633d 2268 7474 7073 3a2f  img src="https:/
-0000f0c0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-0000f0d0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-0000f0e0: 6f6d 2f32 3431 3033 322f 3136 3836 3435  om/241032/168645
-0000f0f0: 3238 302d 6630 3636 3262 3363 2d39 3736  280-f0662b3c-976
-0000f100: 342d 3438 3735 2d61 3265 322d 6439 3163  4-4875-a2e2-d91c
-0000f110: 6338 3139 3962 3233 2e70 6e67 223e 3c2f  c8199b23.png"></
-0000f120: 613e 0a33 2e20 666c 6174 206c 6967 6874  a>.3. flat light
-0000f130: 0a3c 2f74 643e 3c74 6420 616c 6967 6e3d  .</td><td align=
-0000f140: 2263 656e 7465 7222 3e3c 6120 6872 6566  "center"><a href
-0000f150: 3d22 6874 7470 733a 2f2f 7573 6572 2d69  ="https://user-i
-0000f160: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
-0000f170: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
-0000f180: 3332 2f31 3635 3836 3438 3938 2d31 3063  32/165864898-10c
-0000f190: 6537 3035 322d 6131 3137 2d34 6663 662d  e7052-a117-4fcf-
-0000f1a0: 3834 3562 2d62 3536 6339 3136 3837 3930  845b-b56c9168790
-0000f1b0: 382e 706e 6722 3e3c 696d 6720 7372 633d  8.png"><img src=
-0000f1c0: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
-0000f1d0: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
-0000f1e0: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
-0000f1f0: 322f 3136 3538 3637 3536 322d 6633 3030  2/165867562-f300
-0000f200: 3364 3435 2d64 6432 612d 3435 3634 2d38  3d45-dd2a-4564-8
-0000f210: 6161 652d 6665 6434 3463 3161 6530 3634  aae-fed44c1ae064
-0000f220: 2e70 6e67 223e 3c2f 613e 0a35 2e20 3c61  .png"></a>.5. <a
-0000f230: 2068 7265 663d 2268 7474 7073 3a2f 2f62   href="https://b
-0000f240: 6c6f 672e 636f 6469 6e67 686f 7272 6f72  log.codinghorror
-0000f250: 2e63 6f6d 2f61 2d74 7269 6275 7465 2d74  .com/a-tribute-t
-0000f260: 6f2d 7468 652d 7769 6e64 6f77 732d 3331  o-the-windows-31
-0000f270: 2d68 6f74 2d64 6f67 2d73 7461 6e64 2d63  -hot-dog-stand-c
-0000f280: 6f6c 6f72 2d73 6368 656d 652f 223e 686f  olor-scheme/">ho
-0000f290: 7464 6f67 2073 7461 6e64 3c2f 613e 3c2f  tdog stand</a></
-0000f2a0: 7464 3e3c 2f74 723e 3c2f 7461 626c 653e  td></tr></table>
-0000f2b0: 0a0a 7468 6520 636c 6173 736e 616d 6520  ..the classname 
-0000f2c0: 6f66 2074 6865 2048 544d 4c20 7461 6720  of the HTML tag 
-0000f2d0: 6973 2073 6574 2061 6363 6f72 6469 6e67  is set according
-0000f2e0: 2074 6f20 7468 6520 7365 6c65 6374 6564   to the selected
-0000f2f0: 2074 6865 6d65 2c20 7768 6963 6820 6973   theme, which is
-0000f300: 2075 7365 6420 746f 2073 6574 2063 6f6c   used to set col
-0000f310: 6f72 7320 6173 2063 7373 2076 6172 6961  ors as css varia
-0000f320: 626c 6573 202b 2b0a 0a2a 2065 6163 6820  bles ++..* each 
-0000f330: 7468 656d 6520 2a67 656e 6572 616c 6c79  theme *generally
-0000f340: 2a20 6861 7320 6120 6461 726b 2074 6865  * has a dark the
-0000f350: 6d65 2028 6576 656e 206e 756d 6265 7273  me (even numbers
-0000f360: 2920 616e 6420 6120 6c69 6768 7420 7468  ) and a light th
-0000f370: 656d 6520 286f 6464 206e 756d 6265 7273  eme (odd numbers
-0000f380: 292c 2073 686f 7769 6e67 2069 6e20 7061  ), showing in pa
-0000f390: 6972 730a 2a20 7468 6520 6669 7273 7420  irs.* the first 
-0000f3a0: 7468 656d 6520 2874 6865 6d65 2030 2061  theme (theme 0 a
-0000f3b0: 6e64 2031 2920 6973 2060 6874 6d6c 2e61  nd 1) is `html.a
-0000f3c0: 602c 2073 6563 6f6e 6420 7468 656d 6520  `, second theme 
-0000f3d0: 2832 2061 6e64 2033 2920 6973 2060 6874  (2 and 3) is `ht
-0000f3e0: 6d6c 2e62 600a 2a20 6966 2061 206c 6967  ml.b`.* if a lig
-0000f3f0: 6874 2074 6865 6d65 2069 7320 7365 6c65  ht theme is sele
-0000f400: 6374 6564 2c20 6068 746d 6c2e 7960 2069  cted, `html.y` i
-0000f410: 7320 7365 742c 206f 7468 6572 7769 7365  s set, otherwise
-0000f420: 2060 6874 6d6c 2e7a 6020 6973 0a2a 2073   `html.z` is.* s
-0000f430: 6f20 6966 2074 6865 2064 6172 6b20 6564  o if the dark ed
-0000f440: 6974 696f 6e20 6f66 2074 6865 2032 6e64  ition of the 2nd
-0000f450: 2074 6865 6d65 2069 7320 7365 6c65 6374   theme is select
-0000f460: 6564 2c20 796f 7520 7573 6520 616e 7920  ed, you use any 
-0000f470: 6f66 2060 6874 6d6c 2e62 602c 2060 6874  of `html.b`, `ht
-0000f480: 6d6c 2e7a 602c 2060 6874 6d6c 2e62 7a60  ml.z`, `html.bz`
-0000f490: 2074 6f20 7370 6563 6966 7920 7275 6c65   to specify rule
-0000f4a0: 730a 0a73 6565 2074 6865 2074 6f70 206f  s..see the top o
-0000f4b0: 6620 5b2e 2f63 6f70 7970 6172 7479 2f77  f [./copyparty/w
-0000f4c0: 6562 2f62 726f 7773 6572 2e63 7373 5d28  eb/browser.css](
-0000f4d0: 2e2f 636f 7079 7061 7274 792f 7765 622f  ./copyparty/web/
-0000f4e0: 6272 6f77 7365 722e 6373 7329 2077 6865  browser.css) whe
-0000f4f0: 7265 2074 6865 2063 6f6c 6f72 2076 6172  re the color var
-0000f500: 6961 626c 6573 2061 7265 2073 6574 2c20  iables are set, 
-0000f510: 616e 6420 7468 6572 6527 7320 6c61 796f  and there's layo
-0000f520: 7574 2d73 7065 6369 6669 6320 7374 7566  ut-specific stuf
-0000f530: 6620 6e65 6172 2074 6865 2062 6f74 746f  f near the botto
-0000f540: 6d0a 0a0a 2323 2063 6f6d 706c 6574 6520  m...## complete 
-0000f550: 6578 616d 706c 6573 0a0a 2a20 7265 6164  examples..* read
-0000f560: 2d6f 6e6c 7920 6d75 7369 6320 7365 7276  -only music serv
-0000f570: 6572 2020 0a20 2060 7079 7468 6f6e 2063  er  .  `python c
-0000f580: 6f70 7970 6172 7479 2d73 6678 2e70 7920  opyparty-sfx.py 
-0000f590: 2d76 202f 6d6e 742f 6e61 732f 6d75 7369  -v /mnt/nas/musi
-0000f5a0: 633a 2f6d 7573 6963 3a72 202d 6532 6473  c:/music:r -e2ds
-0000f5b0: 6120 2d65 3274 7320 2d2d 6e6f 2d72 6f62  a -e2ts --no-rob
-0000f5c0: 6f74 7320 2d2d 666f 7263 652d 6a73 202d  ots --force-js -
-0000f5d0: 2d74 6865 6d65 2032 600a 2020 0a20 202a  -theme 2`.  .  *
-0000f5e0: 202e 2e2e 7769 7468 2062 706d 2061 6e64   ...with bpm and
-0000f5f0: 206b 6579 2073 6361 6e6e 696e 6720 200a   key scanning  .
-0000f600: 2020 2020 602d 6d74 7020 2e62 706d 3d66      `-mtp .bpm=f
-0000f610: 2c61 7564 696f 2d62 706d 2e70 7920 2d6d  ,audio-bpm.py -m
-0000f620: 7470 206b 6579 3d66 2c61 7564 696f 2d6b  tp key=f,audio-k
-0000f630: 6579 2e70 7960 0a20 200a 2020 2a20 2e2e  ey.py`.  .  * ..
-0000f640: 2e77 6974 6820 6120 7265 6164 2d77 7269  .with a read-wri
-0000f650: 7465 2066 6f6c 6465 7220 666f 7220 606b  te folder for `k
-0000f660: 6576 696e 6020 7768 6f73 6520 7061 7373  evin` whose pass
-0000f670: 776f 7264 2069 7320 606f 6b67 6f60 2020  word is `okgo`  
-0000f680: 0a20 2020 2060 2d61 206b 6576 696e 3a6f  .    `-a kevin:o
-0000f690: 6b67 6f20 2d76 202f 6d6e 742f 6e61 732f  kgo -v /mnt/nas/
-0000f6a0: 696e 633a 2f69 6e63 3a72 772c 6b65 7669  inc:/inc:rw,kevi
-0000f6b0: 6e60 0a20 200a 2020 2a20 2e2e 2e77 6974  n`.  .  * ...wit
-0000f6c0: 6820 6c6f 6767 696e 6720 746f 2064 6973  h logging to dis
-0000f6d0: 6b20 200a 2020 2020 602d 6c6f 206c 6f67  k  .    `-lo log
-0000f6e0: 2f63 7070 2d25 592d 256d 2564 2d25 4825  /cpp-%Y-%m%d-%H%
-0000f6f0: 4d25 532e 7478 742e 787a 600a 0a0a 2323  M%S.txt.xz`...##
-0000f700: 2072 6576 6572 7365 2d70 726f 7879 0a0a   reverse-proxy..
-0000f710: 7275 6e6e 696e 6720 636f 7079 7061 7274  running copypart
-0000f720: 7920 6e65 7874 2074 6f20 6f74 6865 7220  y next to other 
-0000f730: 7765 6273 6974 6573 2020 686f 7374 6564  websites  hosted
-0000f740: 206f 6e20 616e 2065 7869 7374 696e 6720   on an existing 
-0000f750: 7765 6273 6572 7665 7220 7375 6368 2061  webserver such a
-0000f760: 7320 6e67 696e 7820 6f72 2061 7061 6368  s nginx or apach
-0000f770: 650a 0a79 6f75 2063 616e 2065 6974 6865  e..you can eithe
-0000f780: 723a 0a2a 2067 6976 6520 636f 7079 7061  r:.* give copypa
-0000f790: 7274 7920 6974 7320 6f77 6e20 646f 6d61  rty its own doma
-0000f7a0: 696e 206f 7220 7375 6264 6f6d 6169 6e20  in or subdomain 
-0000f7b0: 2872 6563 6f6d 6d65 6e64 6564 290a 2a20  (recommended).* 
-0000f7c0: 6f72 2064 6f20 6c6f 6361 7469 6f6e 2d62  or do location-b
-0000f7d0: 6173 6564 2070 726f 7879 696e 672c 2075  ased proxying, u
-0000f7e0: 7369 6e67 2060 2d2d 7270 2d6c 6f63 3d2f  sing `--rp-loc=/
-0000f7f0: 7374 7566 6660 2074 6f20 7465 6c6c 2063  stuff` to tell c
-0000f800: 6f70 7970 6172 7479 2077 6865 7265 2069  opyparty where i
-0000f810: 7420 6973 206d 6f75 6e74 6564 202d 2d20  t is mounted -- 
-0000f820: 6861 7320 6120 736c 6967 6874 2070 6572  has a slight per
-0000f830: 666f 726d 616e 6365 2063 6f73 7420 616e  formance cost an
-0000f840: 6420 6869 6768 6572 2063 6861 6e63 6520  d higher chance 
-0000f850: 6f66 2062 7567 730a 2020 2a20 6966 2063  of bugs.  * if c
-0000f860: 6f70 7970 6172 7479 2073 6179 7320 6069  opyparty says `i
-0000f870: 6e63 6f72 7265 6374 202d 2d72 702d 6c6f  ncorrect --rp-lo
-0000f880: 6320 6f72 2077 6562 7365 7276 6572 2063  c or webserver c
-0000f890: 6f6e 6669 673b 2065 7870 6563 7465 6420  onfig; expected 
-0000f8a0: 7670 6174 6820 7374 6172 7469 6e67 2077  vpath starting w
-0000f8b0: 6974 6820 5b2e 2e2e 5d60 2069 7427 7320  ith [...]` it's 
-0000f8c0: 6c69 6b65 6c79 2062 6563 6175 7365 2074  likely because t
-0000f8d0: 6865 2077 6562 7365 7276 6572 2069 7320  he webserver is 
-0000f8e0: 7374 7269 7070 696e 6720 6177 6179 2074  stripping away t
-0000f8f0: 6865 2070 726f 7879 206c 6f63 6174 696f  he proxy locatio
-0000f900: 6e20 6672 6f6d 2074 6865 2072 6571 7565  n from the reque
-0000f910: 7374 2055 524c 7320 2d2d 2073 6565 2074  st URLs -- see t
-0000f920: 6865 2060 5072 6f78 7950 6173 7360 2069  he `ProxyPass` i
-0000f930: 6e20 7468 6520 6170 6163 6865 2065 7861  n the apache exa
-0000f940: 6d70 6c65 2062 656c 6f77 0a0a 6578 616d  mple below..exam
-0000f950: 706c 6520 7765 6273 6572 7665 7220 636f  ple webserver co
-0000f960: 6e66 6967 733a 0a0a 2a20 5b6e 6769 6e78  nfigs:..* [nginx
-0000f970: 2063 6f6e 6669 675d 2863 6f6e 7472 6962   config](contrib
-0000f980: 2f6e 6769 6e78 2f63 6f70 7970 6172 7479  /nginx/copyparty
-0000f990: 2e63 6f6e 6629 202d 2d20 656e 7469 7265  .conf) -- entire
-0000f9a0: 2064 6f6d 6169 6e2f 7375 6264 6f6d 6169   domain/subdomai
-0000f9b0: 6e0a 2a20 5b61 7061 6368 6532 2063 6f6e  n.* [apache2 con
-0000f9c0: 6669 675d 2863 6f6e 7472 6962 2f61 7061  fig](contrib/apa
-0000f9d0: 6368 652f 636f 7079 7061 7274 792e 636f  che/copyparty.co
-0000f9e0: 6e66 2920 2d2d 206c 6f63 6174 696f 6e2d  nf) -- location-
-0000f9f0: 6261 7365 640a 0a0a 2320 6272 6f77 7365  based...# browse
-0000fa00: 7220 7375 7070 6f72 740a 0a54 4c44 523a  r support..TLDR:
-0000fa10: 2079 6573 0a0a 215b 636f 7079 7061 7274   yes..![copypart
-0000fa20: 792d 6965 342d 6673 385d 2868 7474 7073  y-ie4-fs8](https
-0000fa30: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
-0000fa40: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
-0000fa50: 2e63 6f6d 2f32 3431 3033 322f 3131 3831  .com/241032/1181
-0000fa60: 3932 3739 312d 6662 3331 6665 3030 2d62  92791-fb31fe00-b
-0000fa70: 3434 362d 3131 6562 2d39 3634 372d 3839  446-11eb-9647-89
-0000fa80: 3865 6138 6566 6331 6637 2e70 6e67 290a  8ea8efc1f7.png).
-0000fa90: 0a60 6965 6020 3d20 696e 7465 726e 6574  .`ie` = internet
-0000faa0: 2d65 7870 6c6f 7265 722c 2060 6666 6020  -explorer, `ff` 
-0000fab0: 3d20 6669 7265 666f 782c 2060 6360 203d  = firefox, `c` =
-0000fac0: 2063 6872 6f6d 652c 2060 694f 5360 203d   chrome, `iOS` =
-0000fad0: 2069 5068 6f6e 652f 6950 6164 2c20 6041   iPhone/iPad, `A
-0000fae0: 6e64 7260 203d 2041 6e64 726f 6964 0a0a  ndr` = Android..
-0000faf0: 7c20 6665 6174 7572 6520 2020 2020 2020  | feature       
-0000fb00: 2020 7c20 6965 3620 7c20 6965 3920 207c    | ie6 | ie9  |
-0000fb10: 2069 6531 3020 7c20 6965 3131 207c 2066   ie10 | ie11 | f
-0000fb20: 6620 3532 207c 2063 2034 3920 7c20 694f  f 52 | c 49 | iO
-0000fb30: 5320 7c20 416e 6472 207c 0a7c 202d 2d2d  S | Andr |.| ---
-0000fb40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 207c 202d  ------------ | -
-0000fb50: 2d2d 207c 202d 2d2d 2d20 7c20 2d2d 2d2d  -- | ---- | ----
-0000fb60: 207c 202d 2d2d 2d20 7c20 2d2d 2d2d 2d20   | ---- | ----- 
-0000fb70: 7c20 2d2d 2d2d 207c 202d 2d2d 207c 202d  | ---- | --- | -
-0000fb80: 2d2d 2d20 7c0a 7c20 6272 6f77 7365 2066  --- |.| browse f
-0000fb90: 696c 6573 2020 2020 7c20 7965 7020 7c20  iles    | yep | 
-0000fba0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000fbb0: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
-0000fbc0: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
-0000fbd0: 0a7c 2074 6875 6d62 6e61 696c 2076 6965  .| thumbnail vie
-0000fbe0: 7720 207c 2020 2d20 207c 2079 6570 2020  w  |  -  | yep  
-0000fbf0: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000fc00: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
-0000fc10: 6570 207c 2079 6570 2020 7c0a 7c20 6261  ep | yep  |.| ba
-0000fc20: 7369 6320 7570 6c6f 6164 6572 2020 7c20  sic uploader  | 
-0000fc30: 7965 7020 7c20 7965 7020 207c 2079 6570  yep | yep  | yep
-0000fc40: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
-0000fc50: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
-0000fc60: 7965 7020 207c 0a7c 2075 7032 6b20 2020  yep  |.| up2k   
-0000fc70: 2020 2020 2020 2020 207c 2020 2d20 207c           |  -  |
-0000fc80: 2020 2d20 2020 7c20 602a 3160 207c 2060    -   | `*1` | `
-0000fc90: 2a31 6020 7c20 2079 6570 2020 7c20 7965  *1` |  yep  | ye
-0000fca0: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
-0000fcb0: 7c0a 7c20 6d61 6b65 2064 6972 6563 746f  |.| make directo
-0000fcc0: 7279 2020 7c20 7965 7020 7c20 7965 7020  ry  | yep | yep 
-0000fcd0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000fce0: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
-0000fcf0: 7965 7020 7c20 7965 7020 207c 0a7c 2073  yep | yep  |.| s
-0000fd00: 656e 6420 6d65 7373 6167 6520 2020 207c  end message    |
-0000fd10: 2079 6570 207c 2079 6570 2020 7c20 7965   yep | yep  | ye
-0000fd20: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
-0000fd30: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
-0000fd40: 2079 6570 2020 7c0a 7c20 7365 7420 736f   yep  |.| set so
-0000fd50: 7274 206f 7264 6572 2020 7c20 202d 2020  rt order  |  -  
-0000fd60: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
-0000fd70: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
-0000fd80: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
-0000fd90: 207c 0a7c 207a 6970 2073 656c 6563 7469   |.| zip selecti
-0000fda0: 6f6e 2020 207c 2020 2d20 207c 2079 6570  on   |  -  | yep
-0000fdb0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
-0000fdc0: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
-0000fdd0: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
-0000fde0: 6669 6c65 2072 656e 616d 6520 2020 2020  file rename     
-0000fdf0: 7c20 202d 2020 7c20 7965 7020 207c 2079  |  -  | yep  | y
-0000fe00: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
-0000fe10: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000fe20: 7c20 7965 7020 207c 0a7c 2066 696c 6520  | yep  |.| file 
-0000fe30: 6375 742f 7061 7374 6520 207c 2020 2d20  cut/paste  |  - 
-0000fe40: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
-0000fe50: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
-0000fe60: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
-0000fe70: 2020 7c0a 7c20 6e61 7670 616e 6520 2020    |.| navpane   
-0000fe80: 2020 2020 2020 7c20 202d 2020 7c20 7965        |  -  | ye
-0000fe90: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
-0000fea0: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
-0000feb0: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
-0000fec0: 2069 6d61 6765 2076 6965 7765 7220 2020   image viewer   
-0000fed0: 207c 2020 2d20 207c 2079 6570 2020 7c20   |  -  | yep  | 
-0000fee0: 7965 7020 207c 2079 6570 2020 7c20 2079  yep  | yep  |  y
-0000fef0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
-0000ff00: 207c 2079 6570 2020 7c0a 7c20 7669 6465   | yep  |.| vide
-0000ff10: 6f20 706c 6179 6572 2020 2020 7c20 202d  o player    |  -
-0000ff20: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
-0000ff30: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
-0000ff40: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
-0000ff50: 7020 207c 0a7c 206d 6172 6b64 6f77 6e20  p  |.| markdown 
-0000ff60: 6564 6974 6f72 207c 2020 2d20 207c 2020  editor |  -  |  
-0000ff70: 2d20 2020 7c20 7965 7020 207c 2079 6570  -   | yep  | yep
-0000ff80: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
-0000ff90: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
-0000ffa0: 7c20 6d61 726b 646f 776e 2076 6965 7765  | markdown viewe
-0000ffb0: 7220 7c20 202d 2020 7c20 7965 7020 207c  r |  -  | yep  |
-0000ffc0: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
-0000ffd0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
-0000ffe0: 7020 7c20 7965 7020 207c 0a7c 2070 6c61  p | yep  |.| pla
-0000fff0: 7920 6d70 332f 6d34 6120 2020 207c 2020  y mp3/m4a    |  
-00010000: 2d20 207c 2079 6570 2020 7c20 7965 7020  -  | yep  | yep 
-00010010: 207c 2079 6570 2020 7c20 2079 6570 2020   | yep  |  yep  
-00010020: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
-00010030: 6570 2020 7c0a 7c20 706c 6179 206f 6767  ep  |.| play ogg
-00010040: 2f6f 7075 7320 2020 7c20 202d 2020 7c20  /opus   |  -  | 
-00010050: 202d 2020 207c 2020 2d20 2020 7c20 202d   -   |  -   |  -
-00010060: 2020 207c 2020 7965 7020 207c 2079 6570     |  yep  | yep
-00010070: 2020 7c20 602a 3360 207c 2079 6570 207c    | `*3` | yep |
-00010080: 0a7c 202a 2a3d 2066 6561 7475 7265 203d  .| **= feature =
-00010090: 2a2a 207c 2069 6536 207c 2069 6539 2020  ** | ie6 | ie9  
-000100a0: 7c20 6965 3130 207c 2069 6531 3120 7c20  | ie10 | ie11 | 
-000100b0: 6666 2035 3220 7c20 6320 3439 207c 2069  ff 52 | c 49 | i
-000100c0: 4f53 207c 2041 6e64 7220 7c0a 0a2a 2069  OS | Andr |..* i
-000100d0: 6e74 6572 6e65 7420 6578 706c 6f72 6572  nternet explorer
-000100e0: 2036 2074 6f20 3820 6265 6861 7665 2074   6 to 8 behave t
-000100f0: 6865 2073 616d 650a 2a20 6669 7265 666f  he same.* firefo
-00010100: 7820 3532 2061 6e64 2063 6872 6f6d 6520  x 52 and chrome 
-00010110: 3439 2061 7265 2074 6865 2066 696e 616c  49 are the final
-00010120: 2077 696e 7870 2076 6572 7369 6f6e 730a   winxp versions.
-00010130: 2a20 602a 3160 2079 6573 2c20 6275 7420  * `*1` yes, but 
-00010140: 6578 7472 656d 656c 7920 736c 6f77 2028  extremely slow (
-00010150: 6965 3130 3a20 6031 204d 6942 2f73 602c  ie10: `1 MiB/s`,
-00010160: 2069 6531 313a 2060 3237 3020 4b69 422f   ie11: `270 KiB/
-00010170: 7360 290a 2a20 602a 3360 2069 4f53 2031  s`).* `*3` iOS 1
-00010180: 3120 616e 6420 6e65 7765 722c 206f 7075  1 and newer, opu
-00010190: 7320 6f6e 6c79 2c20 616e 6420 7265 7175  s only, and requ
-000101a0: 6972 6573 2046 466d 7065 6720 6f6e 2074  ires FFmpeg on t
-000101b0: 6865 2073 6572 7665 720a 0a71 7569 636b  he server..quick
-000101c0: 2073 756d 6d61 7279 206f 6620 6d6f 7265   summary of more
-000101d0: 2065 6363 656e 7472 6963 2077 6562 2d62   eccentric web-b
-000101e0: 726f 7773 6572 7320 7472 7969 6e67 2074  rowsers trying t
-000101f0: 6f20 7669 6577 2061 2064 6972 6563 746f  o view a directo
-00010200: 7279 2069 6e64 6578 3a0a 0a7c 2062 726f  ry index:..| bro
-00010210: 7773 6572 207c 2077 696c 6c20 6974 2062  wser | will it b
-00010220: 6c65 6e64 207c 0a7c 202d 2d2d 2d2d 2d2d  lend |.| -------
-00010230: 207c 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   | -------------
-00010240: 207c 0a7c 202a 2a6c 696e 6b73 2a2a 2028   |.| **links** (
-00010250: 322e 3231 2f6d 6163 706f 7274 7329 207c  2.21/macports) |
-00010260: 2063 616e 2062 726f 7773 652c 206c 6f67   can browse, log
-00010270: 696e 2c20 7570 6c6f 6164 2f6d 6b64 6972  in, upload/mkdir
-00010280: 2f6d 7367 207c 0a7c 202a 2a6c 796e 782a  /msg |.| **lynx*
-00010290: 2a20 2832 2e38 2e39 2f6d 6163 706f 7274  * (2.8.9/macport
-000102a0: 7329 207c 2063 616e 2062 726f 7773 652c  s) | can browse,
-000102b0: 206c 6f67 696e 2c20 7570 6c6f 6164 2f6d   login, upload/m
-000102c0: 6b64 6972 2f6d 7367 207c 0a7c 202a 2a77  kdir/msg |.| **w
-000102d0: 336d 2a2a 2028 302e 352e 332f 6d61 6370  3m** (0.5.3/macp
-000102e0: 6f72 7473 2920 207c 2063 616e 2062 726f  orts)  | can bro
-000102f0: 7773 652c 206c 6f67 696e 2c20 7570 6c6f  wse, login, uplo
-00010300: 6164 2061 7420 3130 306b 422f 732c 206d  ad at 100kB/s, m
-00010310: 6b64 6972 2f6d 7367 207c 0a7c 202a 2a6e  kdir/msg |.| **n
-00010320: 6574 7375 7266 2a2a 2028 332e 3130 2f61  etsurf** (3.10/a
-00010330: 7263 6829 2020 207c 2069 7320 6261 7369  rch)   | is basi
-00010340: 6361 6c6c 7920 6965 3620 7769 7468 206d  cally ie6 with m
-00010350: 7563 6820 6265 7474 6572 2063 7373 2028  uch better css (
-00010360: 6a61 7661 7363 7269 7074 2068 6173 2061  javascript has a
-00010370: 6c6d 6f73 7420 6e6f 2065 6666 6563 7429  lmost no effect)
-00010380: 207c 200a 7c20 2a2a 6f70 6572 612a 2a20   | .| **opera** 
-00010390: 2831 312e 3630 2f77 696e 7870 2920 2020  (11.60/winxp)   
-000103a0: 7c20 4f4b 3a20 7468 756d 626e 6169 6c73  | OK: thumbnails
-000103b0: 2c20 696d 6167 652d 7669 6577 6572 2c20  , image-viewer, 
-000103c0: 7a69 702d 7365 6c65 6374 696f 6e2c 2072  zip-selection, r
-000103d0: 656e 616d 652f 6375 742f 7061 7374 652e  ename/cut/paste.
-000103e0: 204e 473a 2075 7032 6b2c 206e 6176 7061   NG: up2k, navpa
-000103f0: 6e65 2c20 6d61 726b 646f 776e 2c20 6175  ne, markdown, au
-00010400: 6469 6f20 7c0a 7c20 2a2a 6965 342a 2a20  dio |.| **ie4** 
-00010410: 616e 6420 2a2a 6e65 7473 6361 7065 2a2a  and **netscape**
-00010420: 2034 2e30 2020 7c20 6361 6e20 6272 6f77   4.0  | can brow
-00010430: 7365 2c20 7570 6c6f 6164 2077 6974 6820  se, upload with 
-00010440: 603f 623d 7560 2c20 6175 7468 2077 6974  `?b=u`, auth wit
-00010450: 6820 6026 7077 3d77 6172 6b60 207c 0a7c  h `&pw=wark` |.|
-00010460: 202a 2a6e 6373 6120 6d6f 7361 6963 2a2a   **ncsa mosaic**
-00010470: 2032 2e37 2020 2020 2020 207c 2064 6f65   2.7       | doe
-00010480: 7320 6e6f 7420 6765 7420 6120 7061 7373  s not get a pass
-00010490: 2c20 5b70 6963 315d 2868 7474 7073 3a2f  , [pic1](https:/
-000104a0: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
-000104b0: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
-000104c0: 6f6d 2f32 3431 3033 322f 3137 3431 3839  om/241032/174189
-000104d0: 3232 372d 6165 3831 3630 3236 2d63 6636  227-ae816026-cf6
-000104e0: 662d 3462 6535 2d61 3236 652d 3162 3362  f-4be5-a26e-1b3b
-000104f0: 3037 3263 3162 3266 2e70 6e67 2920 2d20  072c1b2f.png) - 
-00010500: 5b70 6963 325d 2868 7474 7073 3a2f 2f75  [pic2](https://u
-00010510: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00010520: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-00010530: 2f32 3431 3033 322f 3137 3431 3839 3232  /241032/17418922
-00010540: 352d 3536 3531 6330 3539 2d35 3135 322d  5-5651c059-5152-
-00010550: 3436 6539 2d61 6332 362d 3765 3938 6534  46e9-ac26-7e98e4
-00010560: 3937 3930 3162 2e70 6e67 2920 7c0a 7c20  97901b.png) |.| 
-00010570: 2a2a 5365 7265 6e69 7479 4f53 2a2a 2028  **SerenityOS** (
-00010580: 3765 3938 3435 3729 2020 7c20 6869 7473  7e98457)  | hits
-00010590: 2061 2070 6167 6520 6661 756c 742c 2077   a page fault, w
-000105a0: 6f72 6b73 2077 6974 6820 603f 623d 7560  orks with `?b=u`
-000105b0: 2c20 6669 6c65 2075 706c 6f61 6420 6e6f  , file upload no
-000105c0: 742d 696d 706c 207c 0a0a 0a23 2063 6c69  t-impl |...# cli
-000105d0: 656e 7420 6578 616d 706c 6573 0a0a 696e  ent examples..in
-000105e0: 7465 7261 6374 2077 6974 6820 636f 7079  teract with copy
-000105f0: 7061 7274 7920 7573 696e 6720 6e6f 6e2d  party using non-
-00010600: 6272 6f77 7365 7220 636c 6965 6e74 730a  browser clients.
-00010610: 0a2a 206a 6176 6173 6372 6970 743a 2064  .* javascript: d
-00010620: 756d 7020 736f 6d65 2073 7461 7465 2069  ump some state i
-00010630: 6e74 6f20 6120 6669 6c65 2028 7477 6f20  nto a file (two 
-00010640: 7365 7061 7261 7465 2065 7861 6d70 6c65  separate example
-00010650: 7329 0a20 202a 2060 6177 6169 7420 6665  s).  * `await fe
-00010660: 7463 6828 272f 2f31 3237 2e30 2e30 2e31  tch('//127.0.0.1
-00010670: 3a33 3932 332f 272c 207b 6d65 7468 6f64  :3923/', {method
-00010680: 3a22 5055 5422 2c20 626f 6479 3a20 4a53  :"PUT", body: JS
-00010690: 4f4e 2e73 7472 696e 6769 6679 2866 6f6f  ON.stringify(foo
-000106a0: 297d 293b 600a 2020 2a20 6076 6172 2078  )});`.  * `var x
-000106b0: 6872 203d 206e 6577 2058 4d4c 4874 7470  hr = new XMLHttp
-000106c0: 5265 7175 6573 7428 293b 2078 6872 2e6f  Request(); xhr.o
-000106d0: 7065 6e28 2750 4f53 5427 2c20 272f 2f31  pen('POST', '//1
-000106e0: 3237 2e30 2e30 2e31 3a33 3932 332f 6d73  27.0.0.1:3923/ms
-000106f0: 6773 3f72 6177 2729 3b20 7868 722e 7365  gs?raw'); xhr.se
-00010700: 6e64 2827 666f 6f27 293b 600a 0a2a 2063  nd('foo');`..* c
-00010710: 7572 6c2f 7767 6574 3a20 7570 6c6f 6164  url/wget: upload
-00010720: 2073 6f6d 6520 6669 6c65 7320 2870 6f73   some files (pos
-00010730: 743d 6669 6c65 2c20 6368 756e 6b3d 7374  t=file, chunk=st
-00010740: 6469 6e29 0a20 202a 2060 706f 7374 2829  din).  * `post()
-00010750: 7b20 6375 726c 202d 4620 6163 743d 6270  { curl -F act=bp
-00010760: 7574 202d 4620 663d 4022 2431 2220 6874  ut -F f=@"$1" ht
-00010770: 7470 3a2f 2f31 3237 2e30 2e30 2e31 3a33  tp://127.0.0.1:3
-00010780: 3932 332f 3f70 773d 7761 726b 3b7d 6020  923/?pw=wark;}` 
-00010790: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-000107a0: 652e 6d6b 7660 0a20 202a 2060 706f 7374  e.mkv`.  * `post
-000107b0: 2829 7b20 6375 726c 202d 4820 7077 3a77  (){ curl -H pw:w
-000107c0: 6172 6b20 2d48 2072 616e 643a 3820 2d54  ark -H rand:8 -T
-000107d0: 2022 2431 2220 6874 7470 3a2f 2f31 3237   "$1" http://127
-000107e0: 2e30 2e30 2e31 3a33 3932 332f 3b7d 6020  .0.0.1:3923/;}` 
-000107f0: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-00010800: 652e 6d6b 7660 0a20 202a 2060 706f 7374  e.mkv`.  * `post
-00010810: 2829 7b20 7767 6574 202d 2d68 6561 6465  (){ wget --heade
-00010820: 723d 2770 773a 2077 6172 6b27 202d 2d70  r='pw: wark' --p
-00010830: 6f73 742d 6669 6c65 3d22 2431 2220 2d4f  ost-file="$1" -O
-00010840: 2d20 6874 7470 3a2f 2f31 3237 2e30 2e30  - http://127.0.0
-00010850: 2e31 3a33 3932 332f 3f72 6177 3b7d 6020  .1:3923/?raw;}` 
-00010860: 200a 2020 2020 6070 6f73 7420 6d6f 7669   .    `post movi
-00010870: 652e 6d6b 7660 0a20 202a 2060 6368 756e  e.mkv`.  * `chun
-00010880: 6b28 297b 2063 7572 6c20 2d48 2070 773a  k(){ curl -H pw:
-00010890: 7761 726b 202d 542d 2068 7474 703a 2f2f  wark -T- http://
-000108a0: 3132 372e 302e 302e 313a 3339 3233 2f3b  127.0.0.1:3923/;
-000108b0: 7d60 2020 0a20 2020 2060 6368 756e 6b20  }`  .    `chunk 
-000108c0: 3c6d 6f76 6965 2e6d 6b76 600a 0a2a 2062  <movie.mkv`..* b
-000108d0: 6173 683a 2077 6865 6e20 6375 726c 2061  ash: when curl a
-000108e0: 6e64 2077 6765 7420 6973 206e 6f74 2061  nd wget is not a
-000108f0: 7661 696c 6162 6c65 206f 7220 746f 6f20  vailable or too 
-00010900: 626f 7269 6e67 0a20 202a 2060 2870 7269  boring.  * `(pri
-00010910: 6e74 6620 2750 5554 202f 6a75 6e6b 3f70  ntf 'PUT /junk?p
-00010920: 773d 7761 726b 2048 5454 502f 312e 315c  w=wark HTTP/1.1\
-00010930: 725c 6e5c 725c 6e27 3b20 6361 7420 6d6f  r\n\r\n'; cat mo
-00010940: 7669 652e 6d6b 7629 207c 206e 6320 3132  vie.mkv) | nc 12
-00010950: 372e 302e 302e 3120 3339 3233 600a 2020  7.0.0.1 3923`.  
-00010960: 2a20 6028 7072 696e 7466 2027 5055 5420  * `(printf 'PUT 
-00010970: 2f20 4854 5450 2f31 2e31 5c72 5c6e 5c72  / HTTP/1.1\r\n\r
-00010980: 5c6e 273b 2063 6174 206d 6f76 6965 2e6d  \n'; cat movie.m
-00010990: 6b76 2920 3e2f 6465 762f 7463 702f 3132  kv) >/dev/tcp/12
-000109a0: 372e 302e 302e 312f 3339 3233 600a 0a2a  7.0.0.1/3923`..*
-000109b0: 2070 7974 686f 6e3a 205b 7570 326b 2e70   python: [up2k.p
-000109c0: 795d 2868 7474 7073 3a2f 2f67 6974 6875  y](https://githu
-000109d0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-000109e0: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-000109f0: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00010a00: 7929 2069 7320 6120 636f 6d6d 616e 642d  y) is a command-
-00010a10: 6c69 6e65 2075 7032 6b20 636c 6965 6e74  line up2k client
-00010a20: 205b 2877 6562 6d29 5d28 6874 7470 733a   [(webm)](https:
-00010a30: 2f2f 6f63 762e 6d65 2f73 7475 6666 2f75  //ocv.me/stuff/u
-00010a40: 3263 6c69 2e77 6562 6d29 0a20 202a 2066  2cli.webm).  * f
-00010a50: 696c 6520 7570 6c6f 6164 732c 2066 696c  ile uploads, fil
-00010a60: 652d 7365 6172 6368 2c20 666f 6c64 6572  e-search, folder
-00010a70: 2073 796e 632c 2061 7574 6f72 6573 756d   sync, autoresum
-00010a80: 6520 6f66 2061 626f 7274 6564 2f62 726f  e of aborted/bro
-00010a90: 6b65 6e20 7570 6c6f 6164 730a 2020 2a20  ken uploads.  * 
-00010aa0: 6361 6e20 6265 2064 6f77 6e6c 6f61 6465  can be downloade
-00010ab0: 6420 6672 6f6d 2063 6f70 7970 6172 7479  d from copyparty
-00010ac0: 3a20 636f 6e74 726f 6c70 616e 656c 202d  : controlpanel -
-00010ad0: 3e20 636f 6e6e 6563 7420 2d3e 205b 7570  > connect -> [up
-00010ae0: 326b 2e70 795d 2868 7474 703a 2f2f 3132  2k.py](http://12
-00010af0: 372e 302e 302e 313a 3339 3233 2f2e 6370  7.0.0.1:3923/.cp
-00010b00: 722f 612f 7570 326b 2e70 7929 0a20 202a  r/a/up2k.py).  *
-00010b10: 2073 6565 205b 2e2f 6269 6e2f 5245 4144   see [./bin/READ
-00010b20: 4d45 2e6d 6423 7570 326b 7079 5d28 6269  ME.md#up2kpy](bi
-00010b30: 6e2f 5245 4144 4d45 2e6d 6423 7570 326b  n/README.md#up2k
-00010b40: 7079 290a 0a2a 2046 5553 453a 206d 6f75  py)..* FUSE: mou
-00010b50: 6e74 2061 2063 6f70 7970 6172 7479 2073  nt a copyparty s
-00010b60: 6572 7665 7220 6173 2061 206c 6f63 616c  erver as a local
-00010b70: 2066 696c 6573 7973 7465 6d0a 2020 2a20   filesystem.  * 
-00010b80: 6372 6f73 732d 706c 6174 666f 726d 2070  cross-platform p
-00010b90: 7974 686f 6e20 636c 6965 6e74 2061 7661  ython client ava
-00010ba0: 696c 6162 6c65 2069 6e20 5b2e 2f62 696e  ilable in [./bin
-00010bb0: 2f5d 2862 696e 2f29 0a20 202a 2063 616e  /](bin/).  * can
-00010bc0: 2062 6520 646f 776e 6c6f 6164 6564 2066   be downloaded f
-00010bd0: 726f 6d20 636f 7079 7061 7274 793a 2063  rom copyparty: c
-00010be0: 6f6e 7472 6f6c 7061 6e65 6c20 2d3e 2063  ontrolpanel -> c
-00010bf0: 6f6e 6e65 6374 202d 3e20 5b70 6172 7479  onnect -> [party
-00010c00: 6675 7365 2e70 795d 2868 7474 703a 2f2f  fuse.py](http://
-00010c10: 3132 372e 302e 302e 313a 3339 3233 2f2e  127.0.0.1:3923/.
-00010c20: 6370 722f 612f 7061 7274 7966 7573 652e  cpr/a/partyfuse.
-00010c30: 7079 290a 2020 2a20 5b72 636c 6f6e 655d  py).  * [rclone]
-00010c40: 2868 7474 7073 3a2f 2f72 636c 6f6e 652e  (https://rclone.
-00010c50: 6f72 672f 2920 6173 2063 6c69 656e 7420  org/) as client 
-00010c60: 6361 6e20 6769 7665 207e 3578 2070 6572  can give ~5x per
-00010c70: 666f 726d 616e 6365 2c20 7365 6520 5b2e  formance, see [.
-00010c80: 2f64 6f63 732f 7263 6c6f 6e65 2e6d 645d  /docs/rclone.md]
-00010c90: 2864 6f63 732f 7263 6c6f 6e65 2e6d 6429  (docs/rclone.md)
-00010ca0: 0a0a 2a20 7368 6172 6578 2028 7363 7265  ..* sharex (scre
-00010cb0: 656e 7368 6f74 2075 7469 6c69 7479 293a  enshot utility):
-00010cc0: 2073 6565 205b 2e2f 636f 6e74 7269 622f   see [./contrib/
-00010cd0: 7368 6172 6578 2e73 7863 755d 2863 6f6e  sharex.sxcu](con
-00010ce0: 7472 6962 2f23 7368 6172 6578 7378 6375  trib/#sharexsxcu
-00010cf0: 290a 0a63 6f70 7970 6172 7479 2072 6574  )..copyparty ret
-00010d00: 7572 6e73 2061 2074 7275 6e63 6174 6564  urns a truncated
-00010d10: 2073 6861 3531 3273 756d 206f 6620 796f   sha512sum of yo
-00010d20: 7572 2050 5554 2f50 4f53 5420 6173 2062  ur PUT/POST as b
-00010d30: 6173 6536 343b 2079 6f75 2063 616e 2067  ase64; you can g
-00010d40: 656e 6572 6174 6520 7468 6520 7361 6d65  enerate the same
-00010d50: 2063 6865 636b 7375 6d20 6c6f 6361 6c6c   checksum locall
-00010d60: 7920 746f 2076 6572 6966 7920 7570 6c61  y to verify upla
-00010d70: 6f64 733a 0a0a 2020 2020 6235 3132 2829  ods:..    b512()
-00010d80: 7b20 7072 696e 7466 2022 2428 2873 6861  { printf "$((sha
-00010d90: 3531 3273 756d 7c7c 7368 6173 756d 202d  512sum||shasum -
-00010da0: 6135 3132 297c 7365 6420 2d45 2027 732f  a512)|sed -E 's/
-00010db0: 202e 2a2f 2f3b 732f 282e 2e29 2f5c 5c78   .*//;s/(..)/\\x
-00010dc0: 5c31 2f67 2729 227c 6261 7365 3634 7c74  \1/g')"|base64|t
-00010dd0: 7220 272b 2f27 2027 2d5f 277c 6865 6164  r '+/' '-_'|head
-00010de0: 202d 6334 343b 7d0a 2020 2020 6235 3132   -c44;}.    b512
-00010df0: 203c 6d6f 7669 652e 6d6b 760a 0a79 6f75   <movie.mkv..you
-00010e00: 2063 616e 2070 726f 7669 6465 2070 6173   can provide pas
-00010e10: 7377 6f72 6473 2075 7369 6e67 2068 6561  swords using hea
-00010e20: 6465 7220 6050 573a 2068 756e 7465 7232  der `PW: hunter2
-00010e30: 602c 2063 6f6f 6b69 6520 6063 7070 7764  `, cookie `cppwd
-00010e40: 3d68 756e 7465 7232 602c 2075 726c 2d70  =hunter2`, url-p
-00010e50: 6172 616d 2060 3f70 773d 6875 6e74 6572  aram `?pw=hunter
-00010e60: 3260 2c20 6f72 2077 6974 6820 6261 7369  2`, or with basi
-00010e70: 632d 6175 7468 656e 7469 6361 7469 6f6e  c-authentication
-00010e80: 2028 6569 7468 6572 2061 7320 7468 6520   (either as the 
-00010e90: 7573 6572 6e61 6d65 206f 7220 7061 7373  username or pass
-00010ea0: 776f 7264 290a 0a4e 4f54 453a 2063 7572  word)..NOTE: cur
-00010eb0: 6c20 7769 6c6c 206e 6f74 2073 656e 6420  l will not send 
-00010ec0: 7468 6520 6f72 6967 696e 616c 2066 696c  the original fil
-00010ed0: 656e 616d 6520 6966 2079 6f75 2075 7365  ename if you use
-00010ee0: 2060 2d54 6020 636f 6d62 696e 6564 2077   `-T` combined w
-00010ef0: 6974 6820 7572 6c2d 7061 7261 6d73 2120  ith url-params! 
-00010f00: 416c 736f 2c20 6d61 6b65 2073 7572 6520  Also, make sure 
-00010f10: 746f 2061 6c77 6179 7320 6c65 6176 6520  to always leave 
-00010f20: 6120 7472 6169 6c69 6e67 2073 6c61 7368  a trailing slash
-00010f30: 2069 6e20 5552 4c73 2075 6e6c 6573 7320   in URLs unless 
-00010f40: 796f 7520 7761 6e74 2074 6f20 6f76 6572  you want to over
-00010f50: 7269 6465 2074 6865 2066 696c 656e 616d  ride the filenam
-00010f60: 650a 0a0a 2323 206d 6f75 6e74 2061 7320  e...## mount as 
-00010f70: 6472 6976 650a 0a61 2072 656d 6f74 6520  drive..a remote 
-00010f80: 636f 7079 7061 7274 7920 7365 7276 6572  copyparty server
-00010f90: 2061 7320 6120 6c6f 6361 6c20 6669 6c65   as a local file
-00010fa0: 7379 7374 656d 3b20 2067 6f20 746f 2074  system;  go to t
-00010fb0: 6865 2063 6f6e 7472 6f6c 2d70 616e 656c  he control-panel
-00010fc0: 2061 6e64 2063 6c69 636b 2060 636f 6e6e   and click `conn
-00010fd0: 6563 7460 2074 6f20 7365 6520 6120 6c69  ect` to see a li
-00010fe0: 7374 206f 6620 636f 6d6d 616e 6473 2074  st of commands t
-00010ff0: 6f20 646f 2074 6861 740a 0a61 6c74 6572  o do that..alter
-00011000: 6e61 7469 7665 6c79 2c20 736f 6d65 2061  natively, some a
-00011010: 6c74 6572 6e61 7469 7665 7320 726f 7567  lternatives roug
-00011020: 686c 7920 736f 7274 6564 2062 7920 7370  hly sorted by sp
-00011030: 6565 6420 2875 6e72 6570 726f 6475 6369  eed (unreproduci
-00011040: 626c 6520 6265 6e63 686d 6172 6b29 2c20  ble benchmark), 
-00011050: 6265 7374 2066 6972 7374 3a0a 0a2a 205b  best first:..* [
-00011060: 7263 6c6f 6e65 2d68 7474 705d 282e 2f64  rclone-http](./d
-00011070: 6f63 732f 7263 6c6f 6e65 2e6d 6429 2028  ocs/rclone.md) (
-00011080: 3235 7329 2c20 7265 6164 2d6f 6e6c 790a  25s), read-only.
-00011090: 2a20 5b72 636c 6f6e 652d 6674 705d 282e  * [rclone-ftp](.
-000110a0: 2f64 6f63 732f 7263 6c6f 6e65 2e6d 6429  /docs/rclone.md)
-000110b0: 2028 3437 7329 2c20 7265 6164 2f57 5249   (47s), read/WRI
-000110c0: 5445 0a2a 205b 7263 6c6f 6e65 2d77 6562  TE.* [rclone-web
-000110d0: 6461 765d 282e 2f64 6f63 732f 7263 6c6f  dav](./docs/rclo
-000110e0: 6e65 2e6d 6429 2028 3531 7329 2c20 7265  ne.md) (51s), re
-000110f0: 6164 2f57 5249 5445 0a20 202a 2063 6f70  ad/WRITE.  * cop
-00011100: 7970 6172 7479 2d31 2e35 2e30 2773 2077  yparty-1.5.0's w
-00011110: 6562 6461 7620 7365 7276 6572 2069 7320  ebdav server is 
-00011120: 6661 7374 6572 2074 6861 6e20 7263 6c6f  faster than rclo
-00011130: 6e65 2d31 2e36 302e 3020 2836 3973 290a  ne-1.60.0 (69s).
-00011140: 2a20 5b70 6172 7479 6675 7365 2e70 795d  * [partyfuse.py]
-00011150: 282e 2f62 696e 2f23 7061 7274 7966 7573  (./bin/#partyfus
-00011160: 6570 7929 2028 3731 7329 2c20 7265 6164  epy) (71s), read
-00011170: 2d6f 6e6c 790a 2a20 6461 7666 7332 2028  -only.* davfs2 (
-00011180: 3130 3373 292c 2072 6561 642f 5752 4954  103s), read/WRIT
-00011190: 452c 202a 7665 7279 2066 6173 742a 206f  E, *very fast* o
-000111a0: 6e20 736d 616c 6c20 6669 6c65 730a 2a20  n small files.* 
-000111b0: 5b77 696e 3130 2d77 6562 6461 765d 2823  [win10-webdav](#
-000111c0: 7765 6264 6176 2d73 6572 7665 7229 2028  webdav-server) (
-000111d0: 3133 3873 292c 2072 6561 642f 5752 4954  138s), read/WRIT
-000111e0: 450a 2a20 5b77 696e 3130 2d73 6d62 325d  E.* [win10-smb2]
-000111f0: 2823 736d 622d 7365 7276 6572 2920 2833  (#smb-server) (3
-00011200: 3837 7329 2c20 7265 6164 2f57 5249 5445  87s), read/WRITE
-00011210: 0a0a 6d6f 7374 2063 6c69 656e 7473 2077  ..most clients w
-00011220: 696c 6c20 6661 696c 2074 6f20 6d6f 756e  ill fail to moun
-00011230: 7420 7468 6520 726f 6f74 206f 6620 6120  t the root of a 
-00011240: 636f 7079 7061 7274 7920 7365 7276 6572  copyparty server
-00011250: 2075 6e6c 6573 7320 7468 6572 6520 6973   unless there is
-00011260: 2061 2072 6f6f 7420 766f 6c75 6d65 2028   a root volume (
-00011270: 736f 2079 6f75 2067 6574 2074 6865 2061  so you get the a
-00011280: 646d 696e 2d70 616e 656c 2069 6e73 7465  dmin-panel inste
-00011290: 6164 206f 6620 6120 6272 6f77 7365 7220  ad of a browser 
-000112a0: 7768 656e 2061 6363 6573 7369 6e67 2069  when accessing i
-000112b0: 7429 202d 2d20 696e 2074 6861 7420 6361  t) -- in that ca
-000112c0: 7365 2c20 6d6f 756e 7420 6120 7370 6563  se, mount a spec
-000112d0: 6966 6963 2076 6f6c 756d 6520 696e 7374  ific volume inst
-000112e0: 6561 640a 0a0a 2320 7065 7266 6f72 6d61  ead...# performa
-000112f0: 6e63 650a 0a64 6566 6175 6c74 7320 6172  nce..defaults ar
-00011300: 6520 7573 7561 6c6c 7920 6669 6e65 202d  e usually fine -
-00011310: 2065 7870 6563 7420 6038 2047 6942 2f73   expect `8 GiB/s
-00011320: 6020 646f 776e 6c6f 6164 2c20 6031 2047  ` download, `1 G
-00011330: 6942 2f73 6020 7570 6c6f 6164 0a0a 6265  iB/s` upload..be
-00011340: 6c6f 7720 6172 6520 736f 6d65 2074 7765  low are some twe
-00011350: 616b 7320 726f 7567 686c 7920 6f72 6465  aks roughly orde
-00011360: 7265 6420 6279 2075 7365 6675 6c6e 6573  red by usefulnes
-00011370: 733a 0a0a 2a20 602d 7160 2064 6973 6162  s:..* `-q` disab
-00011380: 6c65 7320 6c6f 6767 696e 6720 616e 6420  les logging and 
-00011390: 6361 6e20 6865 6c70 2061 2062 756e 6368  can help a bunch
-000113a0: 2c20 6576 656e 2077 6865 6e20 636f 6d62  , even when comb
-000113b0: 696e 6564 2077 6974 6820 602d 6c6f 6020  ined with `-lo` 
-000113c0: 746f 2072 6564 6972 6563 7420 6c6f 6773  to redirect logs
-000113d0: 2074 6f20 6669 6c65 0a2a 2060 2d2d 6874   to file.* `--ht
-000113e0: 7470 2d6f 6e6c 7960 206f 7220 602d 2d68  tp-only` or `--h
-000113f0: 7474 7073 2d6f 6e6c 7960 2028 756e 6c65  ttps-only` (unle
-00011400: 7373 2079 6f75 2077 616e 7420 746f 2073  ss you want to s
-00011410: 7570 706f 7274 2062 6f74 6820 7072 6f74  upport both prot
-00011420: 6f63 6f6c 7329 2077 696c 6c20 7265 6475  ocols) will redu
-00011430: 6365 2074 6865 2064 656c 6179 2062 6566  ce the delay bef
-00011440: 6f72 6520 6120 6e65 7720 636f 6e6e 6563  ore a new connec
-00011450: 7469 6f6e 2069 7320 6573 7461 626c 6973  tion is establis
-00011460: 6865 640a 2a20 602d 2d68 6973 7460 2070  hed.* `--hist` p
-00011470: 6f69 6e74 696e 6720 746f 2061 2066 6173  ointing to a fas
-00011480: 7420 6c6f 6361 7469 6f6e 2028 7373 6429  t location (ssd)
-00011490: 2077 696c 6c20 6d61 6b65 2064 6972 6563   will make direc
-000114a0: 746f 7279 206c 6973 7469 6e67 7320 616e  tory listings an
-000114b0: 6420 7365 6172 6368 6573 2066 6173 7465  d searches faste
-000114c0: 7220 7768 656e 2060 2d65 3264 6020 6f72  r when `-e2d` or
-000114d0: 2060 2d65 3274 6020 6973 2073 6574 0a2a   `-e2t` is set.*
-000114e0: 2060 2d2d 6e6f 2d68 6173 6820 2e60 2077   `--no-hash .` w
-000114f0: 6865 6e20 696e 6465 7869 6e67 2061 206e  hen indexing a n
-00011500: 6574 776f 726b 2d64 6973 6b20 6966 2079  etwork-disk if y
-00011510: 6f75 2064 6f6e 2774 2063 6172 6520 6162  ou don't care ab
-00011520: 6f75 7420 7468 6520 6163 7475 616c 2066  out the actual f
-00011530: 696c 6568 6173 6865 7320 616e 6420 6f6e  ilehashes and on
-00011540: 6c79 2077 616e 7420 7468 6520 6e61 6d65  ly want the name
-00011550: 732f 7461 6773 2073 6561 7263 6861 626c  s/tags searchabl
-00011560: 650a 2a20 602d 2d6e 6f2d 6874 7020 2d2d  e.* `--no-htp --
-00011570: 6861 7368 2d6d 743d 3020 2d2d 6d74 6167  hash-mt=0 --mtag
-00011580: 2d6d 743d 3120 2d2d 7468 2d6d 743d 3160  -mt=1 --th-mt=1`
-00011590: 206d 696e 696d 697a 6573 2074 6865 206e   minimizes the n
-000115a0: 756d 6265 7220 6f66 2074 6872 6561 6473  umber of threads
-000115b0: 3b20 6361 6e20 6865 6c70 2069 6e20 736f  ; can help in so
-000115c0: 6d65 2065 6363 656e 7472 6963 2065 6e76  me eccentric env
-000115d0: 6972 6f6e 6d65 6e74 7320 286c 696b 6520  ironments (like 
-000115e0: 7468 6520 7673 636f 6465 2064 6562 7567  the vscode debug
-000115f0: 6765 7229 0a2a 2060 2d6a 6020 656e 6162  ger).* `-j` enab
-00011600: 6c65 7320 6d75 6c74 6970 726f 6365 7373  les multiprocess
-00011610: 696e 6720 2861 6374 7561 6c20 6d75 6c74  ing (actual mult
-00011620: 6974 6872 6561 6469 6e67 2920 616e 6420  ithreading) and 
-00011630: 6361 6e20 6d61 6b65 2063 6f70 7970 6172  can make copypar
-00011640: 7479 2070 6572 666f 726d 2062 6574 7465  ty perform bette
-00011650: 7220 696e 2063 7075 2d69 6e74 656e 7369  r in cpu-intensi
-00011660: 7665 2077 6f72 6b6c 6f61 6473 2c20 666f  ve workloads, fo
-00011670: 7220 6578 616d 706c 653a 0a20 202a 2068  r example:.  * h
-00011680: 7567 6520 616d 6f75 6e74 206f 6620 7368  uge amount of sh
-00011690: 6f72 742d 6c69 7665 6420 636f 6e6e 6563  ort-lived connec
-000116a0: 7469 6f6e 730a 2020 2a20 7369 6d75 6c74  tions.  * simult
-000116b0: 616e 656f 7573 2064 6f77 6e6c 6f61 6473  aneous downloads
-000116c0: 2061 6e64 2075 706c 6f61 6473 2073 6174   and uploads sat
-000116d0: 7572 6174 696e 6720 6120 3230 6762 7073  urating a 20gbps
-000116e0: 2063 6f6e 6e65 6374 696f 6e0a 2020 0a20   connection.  . 
-000116f0: 202e 2e2e 686f 7765 7665 7220 6974 2061   ...however it a
-00011700: 6464 7320 616e 206f 7665 7268 6561 6420  dds an overhead 
-00011710: 746f 2069 6e74 6572 6e61 6c20 636f 6d6d  to internal comm
-00011720: 756e 6963 6174 696f 6e20 736f 2069 7420  unication so it 
-00011730: 6d69 6768 7420 6265 2061 206e 6574 206c  might be a net l
-00011740: 6f73 732c 2073 6565 2069 6620 6974 2077  oss, see if it w
-00011750: 6f72 6b73 2034 2075 0a0a 0a23 2320 636c  orks 4 u...## cl
-00011760: 6965 6e74 2d73 6964 650a 0a77 6865 6e20  ient-side..when 
-00011770: 7570 6c6f 6164 696e 6720 6669 6c65 732c  uploading files,
-00011780: 0a0a 2a20 6368 726f 6d65 2069 7320 7265  ..* chrome is re
-00011790: 636f 6d6d 656e 6465 642c 2061 7420 6c65  commended, at le
-000117a0: 6173 7420 636f 6d70 6172 6564 2074 6f20  ast compared to 
-000117b0: 6669 7265 666f 783a 0a20 202a 2075 7020  firefox:.  * up 
-000117c0: 746f 2039 3025 2066 6173 7465 7220 7768  to 90% faster wh
-000117d0: 656e 2068 6173 6869 6e67 2c20 6573 7065  en hashing, espe
-000117e0: 6369 616c 6c79 206f 6e20 5353 4473 0a20  cially on SSDs. 
-000117f0: 202a 2075 7020 746f 2034 3025 2066 6173   * up to 40% fas
-00011800: 7465 7220 7768 656e 2075 706c 6f61 6469  ter when uploadi
-00011810: 6e67 206f 7665 7220 6578 7472 656d 656c  ng over extremel
-00011820: 7920 6661 7374 2069 6e74 6572 6e65 7473  y fast internets
-00011830: 0a20 202a 2062 7574 205b 7570 326b 2e70  .  * but [up2k.p
-00011840: 795d 2868 7474 7073 3a2f 2f67 6974 6875  y](https://githu
-00011850: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00011860: 6172 7479 2f62 6c6f 622f 686f 7675 6473  arty/blob/hovuds
-00011870: 7472 6175 6d2f 6269 6e2f 7570 326b 2e70  traum/bin/up2k.p
-00011880: 7929 2063 616e 2062 6520 3430 2520 6661  y) can be 40% fa
-00011890: 7374 6572 2074 6861 6e20 6368 726f 6d65  ster than chrome
-000118a0: 2061 6761 696e 0a0a 2a20 6966 2079 6f75   again..* if you
-000118b0: 2772 6520 6370 752d 626f 7474 6c65 6e65  're cpu-bottlene
-000118c0: 636b 6564 2c20 6f72 2074 6865 2062 726f  cked, or the bro
-000118d0: 7773 6572 2069 7320 6d61 7869 6e67 2061  wser is maxing a
-000118e0: 2063 7075 2063 6f72 653a 0a20 202a 2075   cpu core:.  * u
-000118f0: 7020 746f 2033 3025 2066 6173 7465 7220  p to 30% faster 
-00011900: 7570 6c6f 6164 7320 6966 2079 6f75 2068  uploads if you h
-00011910: 6964 6520 7468 6520 7570 6c6f 6164 2073  ide the upload s
-00011920: 7461 7475 7320 6c69 7374 2062 7920 7377  tatus list by sw
-00011930: 6974 6368 696e 6720 6177 6179 2066 726f  itching away fro
-00011940: 6d20 7468 6520 605b f09f 9a80 5d60 2075  m the `[....]` u
-00011950: 7032 6b20 7569 2d74 6162 2028 6f72 2063  p2k ui-tab (or c
-00011960: 6c6f 7369 6e67 2069 7429 0a20 2020 202a  losing it).    *
-00011970: 206f 7074 696f 6e61 6c6c 7920 796f 7520   optionally you 
-00011980: 6361 6e20 7377 6974 6368 2074 6f20 7468  can switch to th
-00011990: 6520 6c69 6768 7477 6569 6768 7420 706f  e lightweight po
-000119a0: 7461 746f 2075 6920 6279 2063 6c69 636b  tato ui by click
-000119b0: 696e 6720 7468 6520 605b f09f a594 5d60  ing the `[....]`
-000119c0: 0a20 2020 202a 2073 7769 7463 6869 6e67  .    * switching
-000119d0: 2074 6f20 616e 6f74 6865 7220 6272 6f77   to another brow
-000119e0: 7365 722d 7461 6220 616c 736f 2077 6f72  ser-tab also wor
-000119f0: 6b73 2c20 7468 6520 6661 7669 636f 6e20  ks, the favicon 
-00011a00: 7769 6c6c 2075 7064 6174 6520 6576 6572  will update ever
-00011a10: 7920 3130 2073 6563 6f6e 6473 2069 6e20  y 10 seconds in 
-00011a20: 7468 6174 2063 6173 650a 2020 2a20 756e  that case.  * un
-00011a30: 6c69 6b65 6c79 2074 6f20 6265 2061 2070  likely to be a p
-00011a40: 726f 626c 656d 2c20 6275 7420 6361 6e20  roblem, but can 
-00011a50: 6861 7070 656e 2077 6865 6e20 7570 6c6f  happen when uplo
-00011a60: 6469 6e67 206d 616e 7920 736d 616c 6c20  ding many small 
-00011a70: 6669 6c65 732c 206f 7220 796f 7572 2069  files, or your i
-00011a80: 6e74 6572 6e65 7420 6973 2074 6f6f 2066  nternet is too f
-00011a90: 6173 742c 206f 7220 5043 2074 6f6f 2073  ast, or PC too s
-00011aa0: 6c6f 770a 0a0a 2320 7365 6375 7269 7479  low...# security
-00011ab0: 0a0a 736f 6d65 206e 6f74 6573 206f 6e20  ..some notes on 
-00011ac0: 6861 7264 656e 696e 670a 0a2a 2073 6574  hardening..* set
-00011ad0: 2060 2d2d 7270 726f 7879 2030 6020 6966   `--rproxy 0` if
-00011ae0: 2079 6f75 7220 636f 7079 7061 7274 7920   your copyparty 
-00011af0: 6973 2064 6972 6563 746c 7920 6661 6369  is directly faci
-00011b00: 6e67 2074 6865 2069 6e74 6572 6e65 7420  ng the internet 
-00011b10: 286e 6f74 2074 6872 6f75 6768 2061 2072  (not through a r
-00011b20: 6576 6572 7365 2d70 726f 7879 290a 2020  everse-proxy).  
-00011b30: 2a20 636f 7273 2064 6f65 736e 2774 2077  * cors doesn't w
-00011b40: 6f72 6b20 7269 6768 7420 6f74 6865 7277  ork right otherw
-00011b50: 6973 650a 0a73 6166 6574 7920 7072 6f66  ise..safety prof
-00011b60: 696c 6573 3a0a 0a2a 206f 7074 696f 6e20  iles:..* option 
-00011b70: 602d 7360 2069 7320 6120 7368 6f72 7463  `-s` is a shortc
-00011b80: 7574 2074 6f20 7365 7420 7468 6520 666f  ut to set the fo
-00011b90: 6c6c 6f77 696e 6720 6f70 7469 6f6e 733a  llowing options:
-00011ba0: 0a20 202a 2060 2d2d 6e6f 2d74 6875 6d62  .  * `--no-thumb
-00011bb0: 6020 6469 7361 626c 6573 2074 6875 6d62  ` disables thumb
-00011bc0: 6e61 696c 7320 616e 6420 6175 6469 6f20  nails and audio 
-00011bd0: 7472 616e 7363 6f64 696e 6720 746f 2073  transcoding to s
-00011be0: 746f 7020 636f 7079 7061 7274 7920 6672  top copyparty fr
-00011bf0: 6f6d 2072 756e 6e69 6e67 2060 4646 6d70  om running `FFmp
-00011c00: 6567 602f 6050 696c 6c6f 7760 2f60 5649  eg`/`Pillow`/`VI
-00011c10: 5053 6020 6f6e 2075 706c 6f61 6465 6420  PS` on uploaded 
-00011c20: 6669 6c65 732c 2077 6869 6368 2069 7320  files, which is 
-00011c30: 6120 5b67 6f6f 6420 6964 6561 5d28 6874  a [good idea](ht
-00011c40: 7470 733a 2f2f 7777 772e 6376 6564 6574  tps://www.cvedet
-00011c50: 6169 6c73 2e63 6f6d 2f76 756c 6e65 7261  ails.com/vulnera
-00011c60: 6269 6c69 7479 2d6c 6973 742e 7068 703f  bility-list.php?
-00011c70: 7665 6e64 6f72 5f69 643d 3336 3131 2920  vendor_id=3611) 
-00011c80: 6966 2061 6e6f 6e79 6d6f 7573 2075 706c  if anonymous upl
-00011c90: 6f61 6420 6973 2065 6e61 626c 6564 0a20  oad is enabled. 
-00011ca0: 202a 2060 2d2d 6e6f 2d6d 7461 672d 6666   * `--no-mtag-ff
-00011cb0: 6020 7573 6573 2060 6d75 7461 6765 6e60  ` uses `mutagen`
-00011cc0: 2074 6f20 6772 6162 206d 7573 6963 2074   to grab music t
-00011cd0: 6167 7320 696e 7374 6561 6420 6f66 2060  ags instead of `
-00011ce0: 4646 6d70 6567 602c 2077 6869 6368 2069  FFmpeg`, which i
-00011cf0: 7320 7361 6665 7220 616e 6420 6661 7374  s safer and fast
-00011d00: 6572 2062 7574 206c 6573 7320 6163 6375  er but less accu
-00011d10: 7261 7465 0a20 202a 2060 2d2d 646f 7470  rate.  * `--dotp
-00011d20: 6172 7460 2068 6964 6573 2075 706c 6f61  art` hides uploa
-00011d30: 6473 2066 726f 6d20 6469 7265 6374 6f72  ds from director
-00011d40: 7920 6c69 7374 696e 6773 2077 6869 6c65  y listings while
-00011d50: 2074 6865 7927 7265 2073 7469 6c6c 2069   they're still i
-00011d60: 6e63 6f6d 696e 670a 2020 2a20 602d 2d6e  ncoming.  * `--n
-00011d70: 6f2d 726f 626f 7473 6020 616e 6420 602d  o-robots` and `-
-00011d80: 2d66 6f72 6365 2d6a 7360 206d 616b 6573  -force-js` makes
-00011d90: 206c 6966 6520 6861 7264 6572 2066 6f72   life harder for
-00011da0: 2063 7261 776c 6572 732c 2073 6565 205b   crawlers, see [
-00011db0: 6869 6469 6e67 2066 726f 6d20 676f 6f67  hiding from goog
-00011dc0: 6c65 5d28 2368 6964 696e 672d 6672 6f6d  le](#hiding-from
-00011dd0: 2d67 6f6f 676c 6529 0a0a 2a20 6f70 7469  -google)..* opti
-00011de0: 6f6e 2060 2d73 7360 2069 7320 6120 7368  on `-ss` is a sh
-00011df0: 6f72 7463 7574 2066 6f72 2074 6865 2061  ortcut for the a
-00011e00: 626f 7665 2070 6c75 733a 0a20 202a 2060  bove plus:.  * `
-00011e10: 2d2d 756e 706f 7374 2030 602c 2060 2d2d  --unpost 0`, `--
-00011e20: 6e6f 2d64 656c 602c 2060 2d2d 6e6f 2d6d  no-del`, `--no-m
-00011e30: 7660 2064 6973 6162 6c65 7320 616c 6c20  v` disables all 
-00011e40: 6d6f 7665 2f64 656c 6574 6520 7375 7070  move/delete supp
-00011e50: 6f72 740a 2020 2a20 602d 2d68 6172 646c  ort.  * `--hardl
-00011e60: 696e 6b60 2063 7265 6174 6573 2068 6172  ink` creates har
-00011e70: 646c 696e 6b73 2069 6e73 7465 6164 206f  dlinks instead o
-00011e80: 6620 7379 6d6c 696e 6b73 2077 6865 6e20  f symlinks when 
-00011e90: 6465 6475 706c 6963 6174 696e 6720 7570  deduplicating up
-00011ea0: 6c6f 6164 732c 2077 6869 6368 2069 7320  loads, which is 
-00011eb0: 6c65 7373 206d 6169 6e74 656e 616e 6365  less maintenance
-00011ec0: 0a20 2020 202a 2068 6f77 6576 6572 206e  .    * however n
-00011ed0: 6f74 6520 6966 2079 6f75 2065 6469 7420  ote if you edit 
-00011ee0: 6f6e 6520 6669 6c65 2069 7420 7769 6c6c  one file it will
-00011ef0: 2061 6c73 6f20 6166 6665 6374 2074 6865   also affect the
-00011f00: 206f 7468 6572 2063 6f70 6965 730a 2020   other copies.  
-00011f10: 2a20 602d 2d76 6167 7565 2d34 3031 6020  * `--vague-401` 
-00011f20: 7265 7475 726e 7320 6120 2234 3034 206e  returns a "404 n
-00011f30: 6f74 2066 6f75 6e64 2220 696e 7374 6561  ot found" instea
-00011f40: 6420 6f66 2022 3430 3120 756e 6175 7468  d of "401 unauth
-00011f50: 6f72 697a 6564 2220 7768 6963 6820 6973  orized" which is
-00011f60: 2061 2063 6f6d 6d6f 6e20 656e 7465 7270   a common enterp
-00011f70: 7269 7365 206d 656d 650a 2020 2a20 602d  rise meme.  * `-
-00011f80: 2d62 616e 2d34 3034 3d35 302c 3630 2c31  -ban-404=50,60,1
-00011f90: 3434 3060 2062 616e 2063 6c69 656e 7420  440` ban client 
-00011fa0: 666f 7220 3134 3430 6d69 6e20 2832 3468  for 1440min (24h
-00011fb0: 2920 6966 2074 6865 7920 6869 7420 3530  ) if they hit 50
-00011fc0: 2034 3034 2773 2069 6e20 3630 6d69 6e0a   404's in 60min.
-00011fd0: 2020 2020 2a20 2a2a 4e42 3a2a 2a20 7769      * **NB:** wi
-00011fe0: 6c6c 2062 616e 2061 6e79 6f6e 6520 7768  ll ban anyone wh
-00011ff0: 6f20 656e 6162 6c65 7320 7570 326b 2074  o enables up2k t
-00012000: 7572 626f 0a20 202a 2060 2d2d 6e69 6860  urbo.  * `--nih`
-00012010: 2072 656d 6f76 6573 2074 6865 2073 6572   removes the ser
-00012020: 7665 7220 686f 7374 6e61 6d65 2066 726f  ver hostname fro
-00012030: 6d20 6469 7265 6374 6f72 7920 6c69 7374  m directory list
-00012040: 696e 6773 0a0a 2a20 6f70 7469 6f6e 2060  ings..* option `
-00012050: 2d73 7373 6020 6973 2061 2073 686f 7274  -sss` is a short
-00012060: 6375 7420 666f 7220 7468 6520 6162 6f76  cut for the abov
-00012070: 6520 706c 7573 3a0a 2020 2a20 602d 2d6e  e plus:.  * `--n
-00012080: 6f2d 6461 7660 2064 6973 6162 6c65 7320  o-dav` disables 
-00012090: 7765 6264 6176 2073 7570 706f 7274 0a20  webdav support. 
-000120a0: 202a 2060 2d2d 6e6f 2d6c 6f67 7565 7360   * `--no-logues`
-000120b0: 2061 6e64 2060 2d2d 6e6f 2d72 6561 646d   and `--no-readm
-000120c0: 6560 2064 6973 6162 6c65 7320 7375 7070  e` disables supp
-000120d0: 6f72 7420 666f 7220 7265 6164 6d65 2773  ort for readme's
-000120e0: 2061 6e64 2070 726f 6c6f 6775 6573 202f   and prologues /
-000120f0: 2065 7069 6c6f 6775 6573 2069 6e20 6469   epilogues in di
-00012100: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
-00012110: 2c20 7768 6963 6820 6f74 6865 7277 6973  , which otherwis
-00012120: 6520 6c65 7473 2070 656f 706c 6520 7570  e lets people up
-00012130: 6c6f 6164 2061 7262 6974 7261 7279 2028  load arbitrary (
-00012140: 6275 7420 7361 6e64 626f 7865 6429 2060  but sandboxed) `
-00012150: 3c73 6372 6970 743e 6020 7461 6773 0a20  <script>` tags. 
-00012160: 202a 2060 2d6c 6f20 6370 702d 2559 2d25   * `-lo cpp-%Y-%
-00012170: 6d25 642d 2548 254d 2553 2e74 7874 2e78  m%d-%H%M%S.txt.x
-00012180: 7a60 2065 6e61 626c 6573 206c 6f67 6769  z` enables loggi
-00012190: 6e67 2074 6f20 6469 736b 0a20 202a 2060  ng to disk.  * `
-000121a0: 2d6c 7320 2a2a 2c2a 2c6c 6e2c 702c 7260  -ls **,*,ln,p,r`
-000121b0: 2064 6f65 7320 6120 7363 616e 206f 6e20   does a scan on 
-000121c0: 7374 6172 7475 7020 666f 7220 616e 7920  startup for any 
-000121d0: 6461 6e67 6572 6f75 7320 7379 6d6c 696e  dangerous symlin
-000121e0: 6b73 0a0a 6f74 6865 7220 6d69 7363 206e  ks..other misc n
-000121f0: 6f74 6573 3a0a 0a2a 2079 6f75 2063 616e  otes:..* you can
-00012200: 2064 6973 6162 6c65 2064 6972 6563 746f   disable directo
-00012210: 7279 206c 6973 7469 6e67 7320 6279 2067  ry listings by g
-00012220: 6976 696e 6720 7065 726d 6973 7369 6f6e  iving permission
-00012230: 2060 6760 2069 6e73 7465 6164 206f 6620   `g` instead of 
-00012240: 6072 602c 206f 6e6c 7920 6163 6365 7074  `r`, only accept
-00012250: 696e 6720 6469 7265 6374 2055 524c 7320  ing direct URLs 
-00012260: 746f 2066 696c 6573 0a20 202a 2063 6f6d  to files.  * com
-00012270: 6269 6e65 2074 6869 7320 7769 7468 2076  bine this with v
-00012280: 6f6c 666c 6167 2060 632c 666b 6020 746f  olflag `c,fk` to
-00012290: 2067 656e 6572 6174 6520 6669 6c65 6b65   generate fileke
-000122a0: 7973 2028 7065 722d 6669 6c65 2061 6363  ys (per-file acc
-000122b0: 6573 736b 6579 7329 3b20 7573 6572 7320  esskeys); users 
-000122c0: 7768 6963 6820 6861 7665 2066 756c 6c20  which have full 
-000122d0: 7265 6164 2d61 6363 6573 7320 7769 6c6c  read-access will
-000122e0: 2074 6865 6e20 7365 6520 5552 4c73 2077   then see URLs w
-000122f0: 6974 6820 603f 6b3d 2e2e 2e60 2061 7070  ith `?k=...` app
-00012300: 656e 6465 6420 746f 2074 6865 2065 6e64  ended to the end
-00012310: 2c20 616e 6420 6067 6020 7573 6572 7320  , and `g` users 
-00012320: 6d75 7374 2070 726f 7669 6465 2074 6861  must provide tha
-00012330: 7420 5552 4c20 696e 636c 7564 696e 6720  t URL including 
-00012340: 7468 6520 636f 7272 6563 7420 6b65 7920  the correct key 
-00012350: 746f 2061 766f 6964 2061 2034 3034 0a20  to avoid a 404. 
-00012360: 2020 202a 2074 6865 2064 6566 6175 6c74     * the default
-00012370: 2066 696c 656b 6579 2065 6e74 726f 7079   filekey entropy
-00012380: 2069 7320 6661 6972 6c79 2073 6d61 6c6c   is fairly small
-00012390: 2073 6f20 6769 7665 2060 2d2d 666b 2d73   so give `--fk-s
-000123a0: 616c 7460 2061 726f 756e 6420 3330 2063  alt` around 30 c
-000123b0: 6861 7261 6374 6572 7320 6966 2079 6f75  haracters if you
-000123c0: 2077 616e 7420 6669 6c65 6b65 7973 206c   want filekeys l
-000123d0: 6f6e 6765 7220 7468 616e 2031 3620 6368  onger than 16 ch
-000123e0: 6172 730a 2020 2a20 7065 726d 6973 7369  ars.  * permissi
-000123f0: 6f6e 7320 6077 4760 206c 6574 7320 7573  ons `wG` lets us
-00012400: 6572 7320 7570 6c6f 6164 2066 696c 6573  ers upload files
-00012410: 2061 6e64 2072 6563 6569 7665 2074 6865   and receive the
-00012420: 6972 206f 776e 2066 696c 656b 6579 732c  ir own filekeys,
-00012430: 2073 7469 6c6c 2077 6974 686f 7574 2062   still without b
-00012440: 6569 6e67 2061 626c 6520 746f 2073 6565  eing able to see
-00012450: 206f 7468 6572 2075 706c 6f61 6473 0a0a   other uploads..
-00012460: 0a23 2320 676f 7463 6861 730a 0a62 6568  .## gotchas..beh
-00012470: 6176 696f 7220 7468 6174 206d 6967 6874  avior that might
-00012480: 2062 6520 756e 6578 7065 6374 6564 0a0a   be unexpected..
-00012490: 2a20 7573 6572 7320 7769 7468 6f75 7420  * users without 
-000124a0: 7265 6164 2d61 6363 6573 7320 746f 2061  read-access to a
-000124b0: 2066 6f6c 6465 7220 6361 6e20 7374 696c   folder can stil
-000124c0: 6c20 7365 6520 7468 6520 602e 7072 6f6c  l see the `.prol
-000124d0: 6f67 7565 2e68 746d 6c60 202f 2060 2e65  ogue.html` / `.e
-000124e0: 7069 6c6f 6775 652e 6874 6d6c 6020 2f20  pilogue.html` / 
-000124f0: 6052 4541 444d 452e 6d64 6020 636f 6e74  `README.md` cont
-00012500: 656e 7473 2c20 666f 7220 7468 6520 7075  ents, for the pu
-00012510: 7270 6f73 6520 6f66 2073 686f 7769 6e67  rpose of showing
-00012520: 2061 2064 6573 6372 6970 7469 6f6e 206f   a description o
-00012530: 6e20 686f 7720 746f 2075 7365 2074 6865  n how to use the
-00012540: 2075 706c 6f61 6465 7220 666f 7220 6578   uploader for ex
-00012550: 616d 706c 650a 2a20 7573 6572 7320 6361  ample.* users ca
-00012560: 6e20 7375 626d 6974 2060 3c73 6372 6970  n submit `<scrip
-00012570: 743e 6073 2077 6869 6368 2061 7574 6f72  t>`s which autor
-00012580: 756e 2066 6f72 206f 7468 6572 2076 6973  un for other vis
-00012590: 6974 6f72 7320 696e 2061 2066 6577 2077  itors in a few w
-000125a0: 6179 733b 0a20 202a 2075 706c 6f61 6469  ays;.  * uploadi
-000125b0: 6e67 2061 2060 5245 4144 4d45 2e6d 6460  ng a `README.md`
-000125c0: 202d 2d20 6176 6f69 6420 7769 7468 2060   -- avoid with `
-000125d0: 2d2d 6e6f 2d72 6561 646d 6560 0a20 202a  --no-readme`.  *
-000125e0: 2072 656e 616d 696e 6720 6073 6f6d 652e   renaming `some.
-000125f0: 6874 6d6c 6020 746f 2060 2e65 7069 6c6f  html` to `.epilo
-00012600: 6775 652e 6874 6d6c 6020 2d2d 2061 766f  gue.html` -- avo
-00012610: 6964 2077 6974 6820 6569 7468 6572 2060  id with either `
-00012620: 2d2d 6e6f 2d6c 6f67 7565 7360 206f 7220  --no-logues` or 
-00012630: 602d 2d6e 6f2d 646f 742d 7265 6e60 0a20  `--no-dot-ren`. 
-00012640: 202a 2074 6865 2064 6972 6563 746f 7279   * the directory
-00012650: 2d6c 6973 7469 6e67 2065 6d62 6564 2069  -listing embed i
-00012660: 7320 7361 6e64 626f 7865 6420 2873 6f20  s sandboxed (so 
-00012670: 616e 7920 6d61 6c69 6369 6f75 7320 7363  any malicious sc
-00012680: 7269 7074 7320 6361 6e27 7420 646f 2061  ripts can't do a
-00012690: 6e79 2064 616d 6167 6529 2062 7574 2074  ny damage) but t
-000126a0: 6865 206d 6172 6b64 6f77 6e20 6564 6974  he markdown edit
-000126b0: 6f72 2069 7320 6e6f 740a 0a0a 2323 2063  or is not...## c
-000126c0: 6f72 730a 0a63 726f 7373 2d73 6974 6520  ors..cross-site 
-000126d0: 7265 7175 6573 7420 636f 6e66 6967 0a0a  request config..
-000126e0: 6279 2064 6566 6175 6c74 2c20 6578 6365  by default, exce
-000126f0: 7074 2066 6f72 2060 4745 5460 2061 6e64  pt for `GET` and
-00012700: 2060 4845 4144 6020 6f70 6572 6174 696f   `HEAD` operatio
-00012710: 6e73 2c20 616c 6c20 7265 7175 6573 7473  ns, all requests
-00012720: 206d 7573 7420 6569 7468 6572 3a0a 2a20   must either:.* 
-00012730: 6e6f 7420 636f 6e74 6169 6e20 616e 2060  not contain an `
-00012740: 4f72 6967 696e 6020 6865 6164 6572 2061  Origin` header a
-00012750: 7420 616c 6c0a 2a20 6f72 2068 6176 6520  t all.* or have 
-00012760: 616e 2060 4f72 6967 696e 6020 6d61 7463  an `Origin` matc
-00012770: 6869 6e67 2074 6865 2073 6572 7665 7220  hing the server 
-00012780: 646f 6d61 696e 0a2a 206f 7220 7468 6520  domain.* or the 
-00012790: 6865 6164 6572 2060 5057 6020 7769 7468  header `PW` with
-000127a0: 2079 6f75 7220 7061 7373 776f 7264 2061   your password a
-000127b0: 7320 7661 6c75 650a 0a63 6f72 7320 6361  s value..cors ca
-000127c0: 6e20 6265 2063 6f6e 6669 6775 7265 6420  n be configured 
-000127d0: 7769 7468 2060 2d2d 6163 616f 6020 616e  with `--acao` an
-000127e0: 6420 602d 2d61 6361 6d60 2c20 6f72 2074  d `--acam`, or t
-000127f0: 6865 2070 726f 7465 6374 696f 6e73 2065  he protections e
-00012800: 6e74 6972 656c 7920 6469 7361 626c 6564  ntirely disabled
-00012810: 2077 6974 6820 602d 2d61 6c6c 6f77 2d63   with `--allow-c
-00012820: 7372 6660 0a0a 0a23 2072 6563 6f76 6572  srf`...# recover
-00012830: 696e 6720 6672 6f6d 2063 7261 7368 6573  ing from crashes
-00012840: 0a0a 2323 2063 6c69 656e 7420 6372 6173  ..## client cras
-00012850: 6865 730a 0a23 2323 2066 7265 666f 7820  hes..### frefox 
-00012860: 7773 6f64 0a0a 6669 7265 666f 7820 3837  wsod..firefox 87
-00012870: 2063 616e 2063 7261 7368 2064 7572 696e   can crash durin
-00012880: 6720 7570 6c6f 6164 7320 202d 2d20 7468  g uploads  -- th
-00012890: 6520 656e 7469 7265 2062 726f 7773 6572  e entire browser
-000128a0: 2067 6f65 732c 2069 6e63 6c75 6469 6e67   goes, including
-000128b0: 2061 6c6c 206f 7468 6572 2062 726f 7773   all other brows
-000128c0: 6572 2074 6162 732c 2065 7665 7279 7468  er tabs, everyth
-000128d0: 696e 6720 7475 726e 7320 7768 6974 650a  ing turns white.
-000128e0: 0a68 6f77 6576 6572 2079 6f75 2063 616e  .however you can
-000128f0: 2068 6974 2060 4631 3260 2069 6e20 7468   hit `F12` in th
-00012900: 6520 7570 326b 2074 6162 2061 6e64 2075  e up2k tab and u
-00012910: 7365 2074 6865 2064 6576 746f 6f6c 7320  se the devtools 
-00012920: 746f 2073 6565 2068 6f77 2066 6172 2079  to see how far y
-00012930: 6f75 2067 6f74 2069 6e20 7468 6520 7570  ou got in the up
-00012940: 6c6f 6164 733a 0a0a 2a20 6765 7420 6120  loads:..* get a 
-00012950: 636f 6d70 6c65 7465 206c 6973 7420 6f66  complete list of
-00012960: 2061 6c6c 2075 706c 6f61 6473 2c20 6f72   all uploads, or
-00012970: 6761 6e69 7a65 6420 6279 2073 7461 7475  ganized by statu
-00012980: 7473 2028 6f6b 202f 206e 6f2d 676f 6f64  ts (ok / no-good
-00012990: 202f 2062 7573 7920 2f20 7175 6575 6564   / busy / queued
-000129a0: 293a 2020 0a20 2060 7661 7220 7461 6273  ):  .  `var tabs
-000129b0: 203d 207b 206f 6b3a 5b5d 2c20 6e67 3a5b   = { ok:[], ng:[
-000129c0: 5d2c 2062 7a3a 5b5d 2c20 713a 5b5d 207d  ], bz:[], q:[] }
-000129d0: 3b20 666f 7220 2876 6172 2061 206f 6620  ; for (var a of 
-000129e0: 7570 326b 2e75 692e 7461 6229 2074 6162  up2k.ui.tab) tab
-000129f0: 735b 612e 696e 5d2e 7075 7368 2861 293b  s[a.in].push(a);
-00012a00: 2074 6162 7360 0a0a 2a20 6c69 7374 206f   tabs`..* list o
-00012a10: 6620 6669 6c65 6e61 6d65 7320 7768 6963  f filenames whic
-00012a20: 6820 6661 696c 6564 3a20 200a 2020 60e2  h failed:  .  `.
-00012a30: 808b 7661 7220 6e67 203d 205b 5d3b 2066  ..var ng = []; f
-00012a40: 6f72 2028 7661 7220 6120 6f66 2075 7032  or (var a of up2
-00012a50: 6b2e 7569 2e74 6162 2920 6966 2028 612e  k.ui.tab) if (a.
-00012a60: 696e 2021 3d20 276f 6b27 2920 6e67 2e70  in != 'ok') ng.p
-00012a70: 7573 6828 612e 686e 2e73 706c 6974 2827  ush(a.hn.split('
-00012a80: 3c61 2068 7265 663d 5c22 2729 2e73 6c69  <a href=\"').sli
-00012a90: 6365 282d 3129 5b30 5d2e 7370 6c69 7428  ce(-1)[0].split(
-00012aa0: 275c 223e 2729 5b30 5d29 3b20 6e67 600a  '\">')[0]); ng`.
-00012ab0: 0a2a 2073 656e 6420 7468 6520 6c69 7374  .* send the list
-00012ac0: 206f 6620 6669 6c65 6e61 6d65 7320 746f   of filenames to
-00012ad0: 2063 6f70 7970 6172 7479 2066 6f72 2073   copyparty for s
-00012ae0: 6166 656b 6565 7069 6e67 3a20 200a 2020  afekeeping:  .  
-00012af0: 6061 7761 6974 2066 6574 6368 2827 2f69  `await fetch('/i
-00012b00: 6e63 272c 207b 6d65 7468 6f64 3a27 5055  nc', {method:'PU
-00012b10: 5427 2c20 626f 6479 3a4a 534f 4e2e 7374  T', body:JSON.st
-00012b20: 7269 6e67 6966 7928 6e67 2c6e 756c 6c2c  ringify(ng,null,
-00012b30: 3129 7d29 600a 0a0a 2320 4854 5450 2041  1)})`...# HTTP A
-00012b40: 5049 0a0a 7365 6520 5b64 6576 6e6f 7465  PI..see [devnote
-00012b50: 735d 2823 2e2f 646f 6373 2f64 6576 6e6f  s](#./docs/devno
-00012b60: 7465 732e 6d64 2368 7474 702d 6170 6929  tes.md#http-api)
-00012b70: 0a0a 0a23 2064 6570 656e 6465 6e63 6965  ...# dependencie
-00012b80: 730a 0a6d 616e 6461 746f 7279 2064 6570  s..mandatory dep
-00012b90: 733a 0a2a 2060 6a69 6e6a 6132 6020 2869  s:.* `jinja2` (i
-00012ba0: 7320 6275 696c 7420 696e 746f 2074 6865  s built into the
-00012bb0: 2053 4658 290a 0a0a 2323 206f 7074 696f   SFX)...## optio
-00012bc0: 6e61 6c20 6465 7065 6e64 656e 6369 6573  nal dependencies
-00012bd0: 0a0a 696e 7374 616c 6c20 7468 6573 6520  ..install these 
-00012be0: 746f 2065 6e61 626c 6520 626f 6e75 7320  to enable bonus 
-00012bf0: 6665 6174 7572 6573 0a0a 656e 6162 6c65  features..enable
-00012c00: 2066 7470 2d73 6572 7665 723a 0a2a 2066   ftp-server:.* f
-00012c10: 6f72 206a 7573 7420 706c 6169 6e74 6578  or just plaintex
-00012c20: 7420 4654 502c 2060 7079 6674 7064 6c69  t FTP, `pyftpdli
-00012c30: 6260 2028 6973 2062 7569 6c74 2069 6e74  b` (is built int
-00012c40: 6f20 7468 6520 5346 5829 0a2a 2077 6974  o the SFX).* wit
-00012c50: 6820 544c 5320 656e 6372 7970 7469 6f6e  h TLS encryption
-00012c60: 2c20 6070 7966 7470 646c 6962 2070 796f  , `pyftpdlib pyo
-00012c70: 7065 6e73 736c 600a 0a65 6e61 626c 6520  penssl`..enable 
-00012c80: 6d75 7369 6320 7461 6773 3a0a 2a20 6569  music tags:.* ei
-00012c90: 7468 6572 2060 6d75 7461 6765 6e60 2028  ther `mutagen` (
-00012ca0: 6661 7374 2c20 7075 7265 2d70 7974 686f  fast, pure-pytho
-00012cb0: 6e2c 2073 6b69 7073 2061 2066 6577 2074  n, skips a few t
-00012cc0: 6167 732c 206d 616b 6573 2063 6f70 7970  ags, makes copyp
-00012cd0: 6172 7479 2047 504c 3f20 6964 6b29 0a2a  arty GPL? idk).*
-00012ce0: 206f 7220 6066 6670 726f 6265 6020 2832   or `ffprobe` (2
-00012cf0: 3078 2073 6c6f 7765 722c 206d 6f72 6520  0x slower, more 
-00012d00: 6163 6375 7261 7465 2c20 706f 7373 6962  accurate, possib
-00012d10: 6c79 2064 616e 6765 726f 7573 2064 6570  ly dangerous dep
-00012d20: 656e 6469 6e67 206f 6e20 796f 7572 2064  ending on your d
-00012d30: 6973 7472 6f20 616e 6420 7573 6572 7329  istro and users)
-00012d40: 0a0a 656e 6162 6c65 205b 7468 756d 626e  ..enable [thumbn
-00012d50: 6169 6c73 5d28 2374 6875 6d62 6e61 696c  ails](#thumbnail
-00012d60: 7329 206f 662e 2e2e 0a2a 202a 2a69 6d61  s) of....* **ima
-00012d70: 6765 733a 2a2a 2060 5069 6c6c 6f77 6020  ges:** `Pillow` 
-00012d80: 616e 642f 6f72 2060 7079 7669 7073 6020  and/or `pyvips` 
-00012d90: 616e 642f 6f72 2060 6666 6d70 6567 6020  and/or `ffmpeg` 
-00012da0: 2872 6571 7569 7265 7320 7079 322e 3720  (requires py2.7 
-00012db0: 6f72 2070 7933 2e35 2b29 0a2a 202a 2a76  or py3.5+).* **v
-00012dc0: 6964 656f 732f 6175 6469 6f3a 2a2a 2060  ideos/audio:** `
-00012dd0: 6666 6d70 6567 6020 616e 6420 6066 6670  ffmpeg` and `ffp
-00012de0: 726f 6265 6020 736f 6d65 7768 6572 6520  robe` somewhere 
-00012df0: 696e 2060 2450 4154 4860 0a2a 202a 2a48  in `$PATH`.* **H
-00012e00: 4549 4620 7069 6374 7572 6573 3a2a 2a20  EIF pictures:** 
-00012e10: 6070 7976 6970 7360 206f 7220 6066 666d  `pyvips` or `ffm
-00012e20: 7065 6760 206f 7220 6070 7968 6569 662d  peg` or `pyheif-
-00012e30: 7069 6c6c 6f77 2d6f 7065 6e65 7260 2028  pillow-opener` (
-00012e40: 7265 7175 6972 6573 204c 696e 7578 206f  requires Linux o
-00012e50: 7220 6120 4320 636f 6d70 696c 6572 290a  r a C compiler).
-00012e60: 2a20 2a2a 4156 4946 2070 6963 7475 7265  * **AVIF picture
-00012e70: 733a 2a2a 2060 7079 7669 7073 6020 6f72  s:** `pyvips` or
-00012e80: 2060 6666 6d70 6567 6020 6f72 2060 7069   `ffmpeg` or `pi
-00012e90: 6c6c 6f77 2d61 7669 662d 706c 7567 696e  llow-avif-plugin
-00012ea0: 600a 2a20 2a2a 4a50 4547 2058 4c20 7069  `.* **JPEG XL pi
-00012eb0: 6374 7572 6573 3a2a 2a20 6070 7976 6970  ctures:** `pyvip
-00012ec0: 7360 206f 7220 6066 666d 7065 6760 0a0a  s` or `ffmpeg`..
-00012ed0: 656e 6162 6c65 205b 736d 625d 2823 736d  enable [smb](#sm
-00012ee0: 622d 7365 7276 6572 2920 7375 7070 6f72  b-server) suppor
-00012ef0: 7420 282a 2a6e 6f74 2a2a 2072 6563 6f6d  t (**not** recom
-00012f00: 6d65 6e64 6564 293a 0a2a 2060 696d 7061  mended):.* `impa
-00012f10: 636b 6574 3d3d 302e 3130 2e30 600a 0a60  cket==0.10.0`..`
-00012f20: 7079 7669 7073 6020 6769 7665 7320 6869  pyvips` gives hi
-00012f30: 6768 6572 2071 7561 6c69 7479 2074 6875  gher quality thu
-00012f40: 6d62 6e61 696c 7320 7468 616e 2060 5069  mbnails than `Pi
-00012f50: 6c6c 6f77 6020 616e 6420 6973 2033 3230  llow` and is 320
-00012f60: 2520 6661 7374 6572 2c20 7573 696e 6720  % faster, using 
-00012f70: 3237 3025 206d 6f72 6520 7261 6d3a 2060  270% more ram: `
-00012f80: 7375 646f 2061 7074 2069 6e73 7461 6c6c  sudo apt install
-00012f90: 206c 6962 7669 7073 3432 2026 2620 7079   libvips42 && py
-00012fa0: 7468 6f6e 3320 2d6d 2070 6970 2069 6e73  thon3 -m pip ins
-00012fb0: 7461 6c6c 202d 2d75 7365 7220 2d55 2070  tall --user -U p
-00012fc0: 7976 6970 7360 0a0a 0a23 2320 6f70 7469  yvips`...## opti
-00012fd0: 6f6e 616c 2067 706c 2073 7475 6666 0a0a  onal gpl stuff..
-00012fe0: 736f 6d65 2062 756e 646c 6564 2074 6f6f  some bundled too
-00012ff0: 6c73 2068 6176 6520 636f 7079 6c65 6674  ls have copyleft
-00013000: 2064 6570 656e 6465 6e63 6965 732c 2073   dependencies, s
-00013010: 6565 205b 2e2f 6269 6e2f 236d 7461 675d  ee [./bin/#mtag]
-00013020: 2862 696e 2f23 6d74 6167 290a 0a74 6865  (bin/#mtag)..the
-00013030: 7365 2061 7265 2073 7461 6e64 616c 6f6e  se are standalon
-00013040: 6520 7072 6f67 7261 6d73 2061 6e64 2077  e programs and w
-00013050: 696c 6c20 6e65 7665 7220 6265 2069 6d70  ill never be imp
-00013060: 6f72 7465 6420 2f20 6576 616c 7561 7465  orted / evaluate
-00013070: 6420 6279 2063 6f70 7970 6172 7479 2c20  d by copyparty, 
-00013080: 616e 6420 6d75 7374 2062 6520 656e 6162  and must be enab
-00013090: 6c65 6420 7468 726f 7567 6820 602d 6d74  led through `-mt
-000130a0: 7060 2063 6f6e 6669 6773 0a0a 0a23 2073  p` configs...# s
-000130b0: 6678 0a0a 7468 6520 7365 6c66 2d63 6f6e  fx..the self-con
-000130c0: 7461 696e 6564 2022 6269 6e61 7279 2220  tained "binary" 
-000130d0: 205b 636f 7079 7061 7274 792d 7366 782e   [copyparty-sfx.
-000130e0: 7079 5d28 6874 7470 733a 2f2f 6769 7468  py](https://gith
-000130f0: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
-00013100: 7061 7274 792f 7265 6c65 6173 6573 2f6c  party/releases/l
-00013110: 6174 6573 742f 646f 776e 6c6f 6164 2f63  atest/download/c
-00013120: 6f70 7970 6172 7479 2d73 6678 2e70 7929  opyparty-sfx.py)
-00013130: 2077 696c 6c20 756e 7061 636b 2069 7473   will unpack its
-00013140: 656c 6620 616e 6420 7275 6e20 636f 7079  elf and run copy
-00013150: 7061 7274 792c 2061 7373 756d 696e 6720  party, assuming 
-00013160: 796f 7520 6861 7665 2070 7974 686f 6e20  you have python 
-00013170: 696e 7374 616c 6c65 6420 6f66 2063 6f75  installed of cou
-00013180: 7273 650a 0a79 6f75 2063 616e 2072 6564  rse..you can red
-00013190: 7563 6520 7468 6520 7366 7820 7369 7a65  uce the sfx size
-000131a0: 2062 7920 7265 7061 636b 696e 6720 6974   by repacking it
-000131b0: 3b20 7365 6520 5b2e 2f64 6f63 732f 6465  ; see [./docs/de
-000131c0: 766e 6f74 6573 2e6d 6423 7366 782d 7265  vnotes.md#sfx-re
-000131d0: 7061 636b 5d28 232e 2f64 6f63 732f 6465  pack](#./docs/de
-000131e0: 766e 6f74 6573 2e6d 6423 7366 782d 7265  vnotes.md#sfx-re
-000131f0: 7061 636b 290a 0a0a 2323 2063 6f70 7970  pack)...## copyp
-00013200: 6172 7479 2e65 7865 0a0a 646f 776e 6c6f  arty.exe..downlo
-00013210: 6164 205b 636f 7079 7061 7274 792e 6578  ad [copyparty.ex
-00013220: 655d 2868 7474 7073 3a2f 2f67 6974 6875  e](https://githu
-00013230: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-00013240: 6172 7479 2f72 656c 6561 7365 732f 6c61  arty/releases/la
-00013250: 7465 7374 2f64 6f77 6e6c 6f61 642f 636f  test/download/co
-00013260: 7079 7061 7274 792e 6578 6529 2028 7769  pyparty.exe) (wi
-00013270: 6e38 2b29 206f 7220 5b63 6f70 7970 6172  n8+) or [copypar
-00013280: 7479 3332 2e65 7865 5d28 6874 7470 733a  ty32.exe](https:
-00013290: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
-000132a0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
-000132b0: 6173 6573 2f6c 6174 6573 742f 646f 776e  ases/latest/down
-000132c0: 6c6f 6164 2f63 6f70 7970 6172 7479 3332  load/copyparty32
-000132d0: 2e65 7865 2920 2877 696e 372b 290a 0a21  .exe) (win7+)..!
-000132e0: 5b63 6f70 7970 6172 7479 2d65 7865 2d66  [copyparty-exe-f
-000132f0: 7338 5d28 6874 7470 733a 2f2f 7573 6572  s8](https://user
-00013300: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
-00013310: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
-00013320: 3130 3332 2f32 3231 3434 3539 3436 2d31  1032/221445946-1
-00013330: 6533 3238 6535 362d 3863 3562 2d34 3461  e328e56-8c5b-44a
-00013340: 392d 3862 3966 2d64 6565 3834 6439 3432  9-8b9f-dee84d942
-00013350: 3533 352e 706e 6729 0a0a 6361 6e20 6265  535.png)..can be
-00013360: 2063 6f6e 7665 6e69 656e 7420 6f6e 206d   convenient on m
-00013370: 6163 6869 6e65 7320 7768 6572 6520 696e  achines where in
-00013380: 7374 616c 6c69 6e67 2070 7974 686f 6e20  stalling python 
-00013390: 6973 2070 726f 626c 656d 6174 6963 2c20  is problematic, 
-000133a0: 686f 7765 7665 7220 6973 202a 2a6e 6f74  however is **not
-000133b0: 2072 6563 6f6d 6d65 6e64 6564 2a2a 202d   recommended** -
-000133c0: 2d20 6966 2070 6f73 7369 626c 652c 2070  - if possible, p
-000133d0: 6c65 6173 6520 7573 6520 2a2a 5b63 6f70  lease use **[cop
-000133e0: 7970 6172 7479 2d73 6678 2e70 795d 2868  yparty-sfx.py](h
-000133f0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-00013400: 6d2f 3930 3031 2f63 6f70 7970 6172 7479  m/9001/copyparty
-00013410: 2f72 656c 6561 7365 732f 6c61 7465 7374  /releases/latest
-00013420: 2f64 6f77 6e6c 6f61 642f 636f 7079 7061  /download/copypa
-00013430: 7274 792d 7366 782e 7079 292a 2a20 696e  rty-sfx.py)** in
-00013440: 7374 6561 640a 0a2a 205b 636f 7079 7061  stead..* [copypa
-00013450: 7274 792e 6578 655d 2868 7474 7073 3a2f  rty.exe](https:/
-00013460: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
-00013470: 2f63 6f70 7970 6172 7479 2f72 656c 6561  /copyparty/relea
-00013480: 7365 732f 6c61 7465 7374 2f64 6f77 6e6c  ses/latest/downl
-00013490: 6f61 642f 636f 7079 7061 7274 792e 6578  oad/copyparty.ex
-000134a0: 6529 2072 756e 7320 6f6e 2077 696e 3820  e) runs on win8 
-000134b0: 6f72 206e 6577 6572 2c20 7761 7320 636f  or newer, was co
-000134c0: 6d70 696c 6564 206f 6e20 7769 6e31 302c  mpiled on win10,
-000134d0: 2064 6f65 7320 7468 756d 626e 6169 6c73   does thumbnails
-000134e0: 202b 206d 6564 6961 2074 6167 732c 2061   + media tags, a
-000134f0: 6e64 2069 7320 2a63 7572 7265 6e74 6c79  nd is *currently
-00013500: 2a20 7361 6665 2074 6f20 7573 652c 2062  * safe to use, b
-00013510: 7574 2061 6e79 2066 7574 7572 6520 7079  ut any future py
-00013520: 7468 6f6e 2f65 7870 6174 2f70 696c 6c6f  thon/expat/pillo
-00013530: 7720 4356 4573 2063 616e 206f 6e6c 7920  w CVEs can only 
-00013540: 6265 2072 656d 6564 6965 6420 6279 2064  be remedied by d
-00013550: 6f77 6e6c 6f61 6469 6e67 2061 206e 6577  ownloading a new
-00013560: 6572 2076 6572 7369 6f6e 206f 6620 7468  er version of th
-00013570: 6520 6578 650a 0a20 202a 206f 6e20 7769  e exe..  * on wi
-00013580: 6e38 2069 7420 6e65 6564 7320 5b76 6320  n8 it needs [vc 
-00013590: 7265 6469 7374 2032 3031 355d 2868 7474  redist 2015](htt
-000135a0: 7073 3a2f 2f77 7777 2e6d 6963 726f 736f  ps://www.microso
-000135b0: 6674 2e63 6f6d 2f65 6e2d 7573 2f64 6f77  ft.com/en-us/dow
-000135c0: 6e6c 6f61 642f 6465 7461 696c 732e 6173  nload/details.as
-000135d0: 7078 3f69 643d 3438 3134 3529 2c20 6f6e  px?id=48145), on
-000135e0: 2077 696e 3130 2069 7420 6a75 7374 2077   win10 it just w
-000135f0: 6f72 6b73 0a0a 2a20 6461 6e67 6572 6f75  orks..* dangerou
-00013600: 733a 205b 636f 7079 7061 7274 7933 322e  s: [copyparty32.
-00013610: 6578 655d 2868 7474 7073 3a2f 2f67 6974  exe](https://git
-00013620: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
-00013630: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
-00013640: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
-00013650: 636f 7079 7061 7274 7933 322e 6578 6529  copyparty32.exe)
-00013660: 2069 7320 636f 6d70 6174 6962 6c65 2077   is compatible w
-00013670: 6974 6820 5b77 696e 646f 7773 375d 2868  ith [windows7](h
-00013680: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
-00013690: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
-000136a0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
-000136b0: 3232 3134 3435 3934 342d 6165 3835 6431  221445944-ae85d1
-000136c0: 6634 2d64 3335 312d 3438 3337 2d62 3133  f4-d351-4837-b13
-000136d0: 302d 3832 6361 6235 3764 3663 6361 2e70  0-82cab57d6cca.p
-000136e0: 6e67 292c 2077 6869 6368 206d 6561 6e73  ng), which means
-000136f0: 2069 7420 7573 6573 2061 6e20 616e 6369   it uses an anci
-00013700: 656e 7420 636f 7079 206f 6620 7079 7468  ent copy of pyth
-00013710: 6f6e 2028 332e 372e 3929 2077 6869 6368  on (3.7.9) which
-00013720: 2063 616e 6e6f 7420 6265 2075 7067 7261   cannot be upgra
-00013730: 6465 6420 616e 6420 7368 6f75 6c64 206e  ded and should n
-00013740: 6576 6572 2062 6520 6578 706f 7365 6420  ever be exposed 
-00013750: 746f 2074 6865 2069 6e74 6572 6e65 7420  to the internet 
-00013760: 284c 414e 2069 7320 6669 6e65 290a 0a2a  (LAN is fine)..*
-00013770: 2064 616e 6765 726f 7573 2061 6e64 2064   dangerous and d
-00013780: 6570 7265 6361 7465 643a 205b 636f 7079  eprecated: [copy
-00013790: 7061 7274 792d 7769 6e70 6536 342e 6578  party-winpe64.ex
-000137a0: 655d 2868 7474 7073 3a2f 2f67 6974 6875  e](https://githu
-000137b0: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
-000137c0: 6172 7479 2f72 656c 6561 7365 732f 646f  arty/releases/do
-000137d0: 776e 6c6f 6164 2f76 312e 362e 382f 636f  wnload/v1.6.8/co
-000137e0: 7079 7061 7274 792d 7769 6e70 6536 342e  pyparty-winpe64.
-000137f0: 6578 6529 206c 6574 7320 796f 7520 5b72  exe) lets you [r
-00013800: 756e 2063 6f70 7970 6172 7479 2069 6e20  un copyparty in 
-00013810: 5769 6e50 455d 2868 7474 7073 3a2f 2f75  WinPE](https://u
-00013820: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
-00013830: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
-00013840: 2f32 3431 3033 322f 3230 3534 3534 3938  /241032/20545498
-00013850: 342d 6536 6235 3530 6466 2d33 6334 392d  4-e6b550df-3c49-
-00013860: 3438 3664 2d39 3236 372d 3136 3134 3037  486d-9267-161407
-00013870: 3864 6430 6464 2e70 6e67 2920 616e 6420  8dd0dd.png) and 
-00013880: 6973 206f 7468 6572 7769 7365 2063 6f6d  is otherwise com
-00013890: 706c 6574 656c 7920 7573 656c 6573 730a  pletely useless.
-000138a0: 0a6d 6561 6e77 6869 6c65 205b 636f 7079  .meanwhile [copy
-000138b0: 7061 7274 792d 7366 782e 7079 5d28 6874  party-sfx.py](ht
-000138c0: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000138d0: 2f39 3030 312f 636f 7079 7061 7274 792f  /9001/copyparty/
-000138e0: 7265 6c65 6173 6573 2f6c 6174 6573 742f  releases/latest/
-000138f0: 646f 776e 6c6f 6164 2f63 6f70 7970 6172  download/copypar
-00013900: 7479 2d73 6678 2e70 7929 2069 6e73 7465  ty-sfx.py) inste
-00013910: 6164 2072 656c 6965 7320 6f6e 2079 6f75  ad relies on you
-00013920: 7220 7379 7374 656d 2070 7974 686f 6e20  r system python 
-00013930: 7768 6963 6820 6769 7665 7320 6265 7474  which gives bett
-00013940: 6572 2070 6572 666f 726d 616e 6365 2061  er performance a
-00013950: 6e64 2077 696c 6c20 7374 6179 2073 6166  nd will stay saf
-00013960: 6520 6173 206c 6f6e 6720 6173 2079 6f75  e as long as you
-00013970: 206b 6565 7020 796f 7572 2070 7974 686f   keep your pytho
-00013980: 6e20 696e 7374 616c 6c20 7570 2d74 6f2d  n install up-to-
-00013990: 6461 7465 0a0a 7468 656e 2061 6761 696e  date..then again
-000139a0: 2c20 6966 2079 6f75 2061 7265 2061 6c72  , if you are alr
-000139b0: 6561 6479 2069 6e74 6f20 646f 776e 6c6f  eady into downlo
-000139c0: 6164 696e 6720 7368 6164 7920 6269 6e61  ading shady bina
-000139d0: 7269 6573 2066 726f 6d20 7468 6520 696e  ries from the in
-000139e0: 7465 726e 6574 2c20 796f 7520 6d61 7920  ternet, you may 
-000139f0: 616c 736f 2077 616e 7420 6d79 205b 6d69  also want my [mi
-00013a00: 6e69 6d61 6c20 6275 696c 6473 5d28 2e2f  nimal builds](./
-00013a10: 7363 7269 7074 732f 7079 696e 7374 616c  scripts/pyinstal
-00013a20: 6c65 7223 6666 6d70 6567 2920 6f66 205b  ler#ffmpeg) of [
-00013a30: 6666 6d70 6567 5d28 6874 7470 733a 2f2f  ffmpeg](https://
-00013a40: 6f63 762e 6d65 2f73 7475 6666 2f62 696e  ocv.me/stuff/bin
-00013a50: 2f66 666d 7065 672e 6578 6529 2061 6e64  /ffmpeg.exe) and
-00013a60: 205b 6666 7072 6f62 655d 2868 7474 7073   [ffprobe](https
-00013a70: 3a2f 2f6f 6376 2e6d 652f 7374 7566 662f  ://ocv.me/stuff/
-00013a80: 6269 6e2f 6666 7072 6f62 652e 6578 6529  bin/ffprobe.exe)
-00013a90: 2077 6869 6368 2065 6e61 626c 6573 2063   which enables c
-00013aa0: 6f70 7970 6172 7479 2074 6f20 6578 7472  opyparty to extr
-00013ab0: 6163 7420 6d75 6c74 696d 6564 6961 2d69  act multimedia-i
-00013ac0: 6e66 6f2c 2064 6f20 6175 6469 6f2d 7472  nfo, do audio-tr
-00013ad0: 616e 7363 6f64 696e 672c 2061 6e64 2074  anscoding, and t
-00013ae0: 6875 6d62 6e61 696c 732f 7370 6563 7472  humbnails/spectr
-00013af0: 6f67 7261 6d73 2f77 6176 6566 6f72 6d73  ograms/waveforms
-00013b00: 2c20 686f 7765 7665 7220 6974 2773 206d  , however it's m
-00013b10: 7563 6820 6265 7474 6572 2074 6f20 696e  uch better to in
-00013b20: 7374 6561 6420 6772 6162 2061 205b 7265  stead grab a [re
-00013b30: 6365 6e74 206f 6666 6963 6961 6c20 6275  cent official bu
-00013b40: 696c 645d 2868 7474 7073 3a2f 2f67 6974  ild](https://git
-00013b50: 6875 622e 636f 6d2f 4274 624e 2f46 466d  hub.com/BtbN/FFm
-00013b60: 7065 672d 4275 696c 6473 2f72 656c 6561  peg-Builds/relea
-00013b70: 7365 732f 646f 776e 6c6f 6164 2f6c 6174  ses/download/lat
-00013b80: 6573 742f 6666 6d70 6567 2d6d 6173 7465  est/ffmpeg-maste
-00013b90: 722d 6c61 7465 7374 2d77 696e 3634 2d67  r-latest-win64-g
-00013ba0: 706c 2e7a 6970 2920 6576 6572 7920 6f6e  pl.zip) every on
-00013bb0: 6365 2069 6e61 2077 6869 6c65 2069 6620  ce ina while if 
-00013bc0: 796f 7520 6361 6e20 6166 666f 7264 2074  you can afford t
-00013bd0: 6865 2073 697a 650a 0a0a 2320 696e 7374  he size...# inst
-00013be0: 616c 6c20 6f6e 2061 6e64 726f 6964 0a0a  all on android..
-00013bf0: 696e 7374 616c 6c20 5b54 6572 6d75 785d  install [Termux]
-00013c00: 2868 7474 7073 3a2f 2f74 6572 6d75 782e  (https://termux.
-00013c10: 636f 6d2f 2920 2b20 6974 7320 636f 6d70  com/) + its comp
-00013c20: 616e 696f 6e20 6170 7020 6054 6572 6d75  anion app `Termu
-00013c30: 783a 4150 4960 2028 7365 6520 5b6f 6376  x:API` (see [ocv
-00013c40: 2e6d 652f 7465 726d 7578 5d28 6874 7470  .me/termux](http
-00013c50: 733a 2f2f 6f63 762e 6d65 2f74 6572 6d75  s://ocv.me/termu
-00013c60: 782f 2929 2061 6e64 2074 6865 6e20 636f  x/)) and then co
-00013c70: 7079 2d70 6173 7465 2074 6869 7320 696e  py-paste this in
-00013c80: 746f 2054 6572 6d75 7820 286c 6f6e 672d  to Termux (long-
-00013c90: 7461 7029 2061 6c6c 2061 7420 6f6e 6365  tap) all at once
-00013ca0: 3a0a 6060 6073 680a 7965 7320 7c20 706b  :.```sh.yes | pk
-00013cb0: 6720 7570 6772 6164 6520 2626 2074 6572  g upgrade && ter
-00013cc0: 6d75 782d 7365 7475 702d 7374 6f72 6167  mux-setup-storag
-00013cd0: 6520 2626 2079 6573 207c 2070 6b67 2069  e && yes | pkg i
-00013ce0: 6e73 7461 6c6c 2070 7974 686f 6e20 7465  nstall python te
-00013cf0: 726d 7578 2d61 7069 2026 2620 7079 7468  rmux-api && pyth
-00013d00: 6f6e 202d 6d20 656e 7375 7265 7069 7020  on -m ensurepip 
-00013d10: 2626 2070 7974 686f 6e20 2d6d 2070 6970  && python -m pip
-00013d20: 2069 6e73 7461 6c6c 202d 2d75 7365 7220   install --user 
-00013d30: 2d55 2063 6f70 7970 6172 7479 2026 2620  -U copyparty && 
-00013d40: 7b20 6772 6570 202d 7145 2027 5041 5448  { grep -qE 'PATH
-00013d50: 3d2e 2a5c 2e6c 6f63 616c 2f62 696e 2720  =.*\.local/bin' 
-00013d60: 7e2f 2e62 6173 6872 6320 323e 2f64 6576  ~/.bashrc 2>/dev
-00013d70: 2f6e 756c 6c20 7c7c 207b 2065 6368 6f20  /null || { echo 
-00013d80: 2750 4154 483d 2224 484f 4d45 2f2e 6c6f  'PATH="$HOME/.lo
-00013d90: 6361 6c2f 6269 6e3a 2450 4154 4822 2720  cal/bin:$PATH"' 
-00013da0: 3e3e 207e 2f2e 6261 7368 7263 2026 2620  >> ~/.bashrc && 
-00013db0: 2e20 7e2f 2e62 6173 6872 633b 207d 3b20  . ~/.bashrc; }; 
-00013dc0: 7d0a 6563 686f 2024 3f0a 6060 600a 0a61  }.echo $?.```..a
-00013dd0: 6674 6572 2074 6865 2069 6e69 7469 616c  fter the initial
-00013de0: 2073 6574 7570 2c20 796f 7520 6361 6e20   setup, you can 
-00013df0: 6c61 756e 6368 2063 6f70 7970 6172 7479  launch copyparty
-00013e00: 2061 7420 616e 7920 7469 6d65 2062 7920   at any time by 
-00013e10: 7275 6e6e 696e 6720 6063 6f70 7970 6172  running `copypar
-00013e20: 7479 6020 616e 7977 6865 7265 2069 6e20  ty` anywhere in 
-00013e30: 5465 726d 7578 202d 2d20 616e 6420 6966  Termux -- and if
-00013e40: 2079 6f75 2072 756e 2069 7420 7769 7468   you run it with
-00013e50: 2060 2d2d 7172 6020 796f 7527 6c6c 2067   `--qr` you'll g
-00013e60: 6574 2061 205b 6e65 6174 2071 722d 636f  et a [neat qr-co
-00013e70: 6465 5d28 2371 722d 636f 6465 2920 706f  de](#qr-code) po
-00013e80: 696e 7469 6e67 2074 6f20 796f 7572 2065  inting to your e
-00013e90: 7874 6572 6e61 6c20 6970 0a0a 6966 2079  xternal ip..if y
-00013ea0: 6f75 2077 616e 7420 7468 756d 626e 6169  ou want thumbnai
-00013eb0: 6c73 2028 7068 6f74 6f73 2b76 6964 656f  ls (photos+video
-00013ec0: 7329 2061 6e64 2079 6f75 2772 6520 6f6b  s) and you're ok
-00013ed0: 6179 2077 6974 6820 7370 656e 6469 6e67  ay with spending
-00013ee0: 2061 6e6f 7468 6572 2031 3332 204d 6942   another 132 MiB
-00013ef0: 206f 6620 7374 6f72 6167 652c 2060 706b   of storage, `pk
-00013f00: 6720 696e 7374 616c 6c20 6666 6d70 6567  g install ffmpeg
-00013f10: 2026 2620 7079 7468 6f6e 3320 2d6d 2070   && python3 -m p
-00013f20: 6970 2069 6e73 7461 6c6c 202d 2d75 7365  ip install --use
-00013f30: 7220 2d55 2070 696c 6c6f 7760 0a0a 2a20  r -U pillow`..* 
-00013f40: 6f72 2069 6620 796f 7520 7761 6e74 2074  or if you want t
-00013f50: 6f20 7573 6520 6076 6970 7360 2066 6f72  o use `vips` for
-00013f60: 2070 686f 746f 2d74 6875 6d62 7320 696e   photo-thumbs in
-00013f70: 7374 6561 642c 2060 706b 6720 696e 7374  stead, `pkg inst
-00013f80: 616c 6c20 6c69 6276 6970 7320 2626 2070  all libvips && p
-00013f90: 7974 686f 6e20 2d6d 2070 6970 2069 6e73  ython -m pip ins
-00013fa0: 7461 6c6c 202d 2d75 7365 7220 2d55 2077  tall --user -U w
-00013fb0: 6865 656c 2026 2620 7079 7468 6f6e 202d  heel && python -
-00013fc0: 6d20 7069 7020 696e 7374 616c 6c20 2d2d  m pip install --
-00013fd0: 7573 6572 202d 5520 7079 7669 7073 2026  user -U pyvips &
-00013fe0: 2620 2863 6420 2f64 6174 612f 6461 7461  & (cd /data/data
-00013ff0: 2f63 6f6d 2e74 6572 6d75 782f 6669 6c65  /com.termux/file
-00014000: 732f 7573 722f 6c69 622f 3b20 6c6e 202d  s/usr/lib/; ln -
-00014010: 7320 6c69 6267 6f62 6a65 6374 2d32 2e30  s libgobject-2.0
-00014020: 2e73 6f7b 2c2e 307d 3b20 6c6e 202d 7320  .so{,.0}; ln -s 
-00014030: 6c69 6276 6970 732e 736f 7b2c 2e34 327d  libvips.so{,.42}
-00014040: 2960 0a0a 0a23 2072 6570 6f72 7469 6e67  )`...# reporting
-00014050: 2062 7567 730a 0a69 6465 6173 2066 6f72   bugs..ideas for
-00014060: 2063 6f6e 7465 7874 2074 6f20 696e 636c   context to incl
-00014070: 7564 6520 696e 2062 7567 2072 6570 6f72  ude in bug repor
-00014080: 7473 0a0a 696e 2067 656e 6572 616c 2c20  ts..in general, 
-00014090: 636f 6d6d 616e 646c 696e 6520 6172 6775  commandline argu
-000140a0: 6d65 6e74 7320 2861 6e64 2063 6f6e 6669  ments (and confi
-000140b0: 6720 6669 6c65 2069 6620 616e 7929 0a0a  g file if any)..
-000140c0: 6966 2073 6f6d 6574 6869 6e67 2062 726f  if something bro
-000140d0: 6b65 2064 7572 696e 6720 616e 2075 706c  ke during an upl
-000140e0: 6f61 6420 2872 6570 6c61 6369 6e67 2046  oad (replacing F
-000140f0: 494c 454e 414d 4520 7769 7468 2061 2070  ILENAME with a p
-00014100: 6172 7420 6f66 2074 6865 2066 696c 656e  art of the filen
-00014110: 616d 6520 7468 6174 2062 726f 6b65 293a  ame that broke):
-00014120: 0a60 6060 0a6a 6f75 726e 616c 6374 6c20  .```.journalctl 
-00014130: 2d61 5320 2734 3820 686f 7572 2061 676f  -aS '48 hour ago
-00014140: 2720 2d75 2063 6f70 7970 6172 7479 207c  ' -u copyparty |
-00014150: 2067 7265 7020 2d43 3130 2046 494c 454e   grep -C10 FILEN
-00014160: 414d 4520 7c20 7465 6520 6275 672e 6c6f  AME | tee bug.lo
-00014170: 670a 6060 600a 0a69 6620 7468 6572 6527  g.```..if there'
-00014180: 7320 6120 7761 6c6c 206f 6620 6261 7365  s a wall of base
-00014190: 3634 2069 6e20 7468 6520 6c6f 6720 2874  64 in the log (t
-000141a0: 6872 6561 6420 7374 6163 6b73 2920 7468  hread stacks) th
-000141b0: 656e 2070 6c65 6173 6520 696e 636c 7564  en please includ
-000141c0: 6520 7468 6174 2c20 6573 7065 6369 616c  e that, especial
-000141d0: 6c79 2069 6620 796f 7520 7275 6e20 696e  ly if you run in
-000141e0: 746f 2073 6f6d 6574 6869 6e67 2066 7265  to something fre
-000141f0: 657a 696e 6720 7570 206f 7220 6765 7474  ezing up or gett
-00014200: 696e 6720 7374 7563 6b2c 2066 6f72 2065  ing stuck, for e
-00014210: 7861 6d70 6c65 2060 4f70 6572 6174 696f  xample `Operatio
-00014220: 6e61 6c45 7272 6f72 2827 6461 7461 6261  nalError('databa
-00014230: 7365 2069 7320 6c6f 636b 6564 2729 6020  se is locked')` 
-00014240: 2d2d 2061 6c74 6572 6e61 7469 7665 6c79  -- alternatively
-00014250: 2079 6f75 2063 616e 2076 6973 6974 2060   you can visit `
-00014260: 2f3f 7374 6163 6b60 2074 6f20 7365 6520  /?stack` to see 
-00014270: 7468 6520 7374 6163 6b73 206c 6976 652c  the stacks live,
-00014280: 2073 6f20 6874 7470 3a2f 2f31 3237 2e30   so http://127.0
-00014290: 2e30 2e31 3a33 3932 332f 3f73 7461 636b  .0.1:3923/?stack
-000142a0: 2066 6f72 2065 7861 6d70 6c65 0a0a 0a23   for example...#
-000142b0: 2064 6576 6e6f 7465 730a 0a66 6f72 2062   devnotes..for b
-000142c0: 7569 6c64 2069 6e73 7472 7563 7469 6f6e  uild instruction
-000142d0: 7320 6574 632c 2073 6565 205b 2e2f 646f  s etc, see [./do
-000142e0: 6373 2f64 6576 6e6f 7465 732e 6d64 5d28  cs/devnotes.md](
-000142f0: 2e2f 646f 6373 2f64 6576 6e6f 7465 732e  ./docs/devnotes.
-00014300: 6d64 290a                                md).
+00000000: 2320 f09f 92be f09f 8e89 2063 6f70 7970  # ........ copyp
+00000010: 6172 7479 0a0a 7475 726e 2061 6c6d 6f73  arty..turn almos
+00000020: 7420 616e 7920 6465 7669 6365 2069 6e74  t any device int
+00000030: 6f20 6120 6669 6c65 2073 6572 7665 7220  o a file server 
+00000040: 7769 7468 2072 6573 756d 6162 6c65 2075  with resumable u
+00000050: 706c 6f61 6473 2f64 6f77 6e6c 6f61 6473  ploads/downloads
+00000060: 2075 7369 6e67 205b 2a61 6e79 2a5d 2823   using [*any*](#
+00000070: 6272 6f77 7365 722d 7375 7070 6f72 7429  browser-support)
+00000080: 2077 6562 2062 726f 7773 6572 0a0a 2a20   web browser..* 
+00000090: 7365 7276 6572 206f 6e6c 7920 6e65 6564  server only need
+000000a0: 7320 5079 7468 6f6e 2028 3220 6f72 2033  s Python (2 or 3
+000000b0: 292c 2061 6c6c 2064 6570 656e 6465 6e63  ), all dependenc
+000000c0: 6965 7320 6f70 7469 6f6e 616c 0a2a 20f0  ies optional.* .
+000000d0: 9f94 8c20 7072 6f74 6f63 6f6c 733a 205b  ... protocols: [
+000000e0: 6874 7470 5d28 2374 6865 2d62 726f 7773  http](#the-brows
+000000f0: 6572 2920 2f2f 205b 6674 705d 2823 6674  er) // [ftp](#ft
+00000100: 702d 7365 7276 6572 2920 2f2f 205b 7765  p-server) // [we
+00000110: 6264 6176 5d28 2377 6562 6461 762d 7365  bdav](#webdav-se
+00000120: 7276 6572 2920 2f2f 205b 736d 622f 6369  rver) // [smb/ci
+00000130: 6673 5d28 2373 6d62 2d73 6572 7665 7229  fs](#smb-server)
+00000140: 0a2a 20f0 9f93 b120 5b61 6e64 726f 6964  .* .... [android
+00000150: 2061 7070 5d28 2361 6e64 726f 6964 2d61   app](#android-a
+00000160: 7070 2920 2f2f 205b 6950 686f 6e65 2073  pp) // [iPhone s
+00000170: 686f 7274 6375 7473 5d28 2369 6f73 2d73  hortcuts](#ios-s
+00000180: 686f 7274 6375 7473 290a 0af0 9f91 8920  hortcuts)...... 
+00000190: 2a2a 5b47 6574 2073 7461 7274 6564 5d28  **[Get started](
+000001a0: 2371 7569 636b 7374 6172 7429 212a 2a20  #quickstart)!** 
+000001b0: 6f72 2076 6973 6974 2074 6865 202a 2a5b  or visit the **[
+000001c0: 7265 6164 2d6f 6e6c 7920 6465 6d6f 2073  read-only demo s
+000001d0: 6572 7665 725d 2868 7474 7073 3a2f 2f61  erver](https://a
+000001e0: 2e6f 6376 2e6d 652f 7075 622f 6465 6d6f  .ocv.me/pub/demo
+000001f0: 2f29 2a2a 20f0 9f91 8020 7275 6e6e 696e  /)** .... runnin
+00000200: 6720 6672 6f6d 2061 2062 6173 656d 656e  g from a basemen
+00000210: 7420 696e 2066 696e 6c61 6e64 0a0a f09f  t in finland....
+00000220: 93b7 202a 2a73 6372 6565 6e73 686f 7473  .. **screenshots
+00000230: 3a2a 2a20 5b62 726f 7773 6572 5d28 2374  :** [browser](#t
+00000240: 6865 2d62 726f 7773 6572 2920 2f2f 205b  he-browser) // [
+00000250: 7570 6c6f 6164 5d28 2375 706c 6f61 6469  upload](#uploadi
+00000260: 6e67 2920 2f2f 205b 756e 706f 7374 5d28  ng) // [unpost](
+00000270: 2375 6e70 6f73 7429 202f 2f20 5b74 6875  #unpost) // [thu
+00000280: 6d62 6e61 696c 735d 2823 7468 756d 626e  mbnails](#thumbn
+00000290: 6169 6c73 2920 2f2f 205b 7365 6172 6368  ails) // [search
+000002a0: 5d28 2373 6561 7263 6869 6e67 2920 2f2f  ](#searching) //
+000002b0: 205b 6673 6561 7263 685d 2823 6669 6c65   [fsearch](#file
+000002c0: 2d73 6561 7263 6829 202f 2f20 5b7a 6970  -search) // [zip
+000002d0: 2d44 4c5d 2823 7a69 702d 646f 776e 6c6f  -DL](#zip-downlo
+000002e0: 6164 7329 202f 2f20 5b6d 642d 7669 6577  ads) // [md-view
+000002f0: 6572 5d28 236d 6172 6b64 6f77 6e2d 7669  er](#markdown-vi
+00000300: 6577 6572 290a 0a0a 2323 2072 6561 646d  ewer)...## readm
+00000310: 6520 746f 630a 0a2a 2074 6f70 0a20 2020  e toc..* top.   
+00000320: 202a 205b 7175 6963 6b73 7461 7274 5d28   * [quickstart](
+00000330: 2371 7569 636b 7374 6172 7429 202d 206a  #quickstart) - j
+00000340: 7573 7420 7275 6e20 2a2a 5b63 6f70 7970  ust run **[copyp
+00000350: 6172 7479 2d73 6678 2e70 795d 2868 7474  arty-sfx.py](htt
+00000360: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00000370: 3930 3031 2f63 6f70 7970 6172 7479 2f72  9001/copyparty/r
+00000380: 656c 6561 7365 732f 6c61 7465 7374 2f64  eleases/latest/d
+00000390: 6f77 6e6c 6f61 642f 636f 7079 7061 7274  ownload/copypart
+000003a0: 792d 7366 782e 7079 292a 2a20 2d2d 2074  y-sfx.py)** -- t
+000003b0: 6861 7427 7320 6974 2120 f09f 8e89 0a20  hat's it! ..... 
+000003c0: 2020 2020 2020 202a 205b 6f6e 2073 6572         * [on ser
+000003d0: 7665 7273 5d28 236f 6e2d 7365 7276 6572  vers](#on-server
+000003e0: 7329 202d 2079 6f75 206d 6179 2061 6c73  s) - you may als
+000003f0: 6f20 7761 6e74 2074 6865 7365 2c20 6573  o want these, es
+00000400: 7065 6369 616c 6c79 206f 6e20 7365 7276  pecially on serv
+00000410: 6572 730a 2020 2020 2a20 5b66 6561 7475  ers.    * [featu
+00000420: 7265 735d 2823 6665 6174 7572 6573 290a  res](#features).
+00000430: 2020 2020 2a20 5b74 6573 7469 6d6f 6e69      * [testimoni
+00000440: 616c 735d 2823 7465 7374 696d 6f6e 6961  als](#testimonia
+00000450: 6c73 2920 2d20 736d 616c 6c20 636f 6c6c  ls) - small coll
+00000460: 6563 7469 6f6e 206f 6620 7573 6572 2066  ection of user f
+00000470: 6565 6462 6163 6b0a 2a20 5b6d 6f74 6976  eedback.* [motiv
+00000480: 6174 696f 6e73 5d28 236d 6f74 6976 6174  ations](#motivat
+00000490: 696f 6e73 2920 2d20 7072 6f6a 6563 7420  ions) - project 
+000004a0: 676f 616c 7320 2f20 7068 696c 6f73 6f70  goals / philosop
+000004b0: 6879 0a20 2020 202a 205b 6e6f 7465 735d  hy.    * [notes]
+000004c0: 2823 6e6f 7465 7329 202d 2067 656e 6572  (#notes) - gener
+000004d0: 616c 206e 6f74 6573 0a2a 205b 6275 6773  al notes.* [bugs
+000004e0: 5d28 2362 7567 7329 0a20 2020 202a 205b  ](#bugs).    * [
+000004f0: 6765 6e65 7261 6c20 6275 6773 5d28 2367  general bugs](#g
+00000500: 656e 6572 616c 2d62 7567 7329 0a20 2020  eneral-bugs).   
+00000510: 202a 205b 6e6f 7420 6d79 2062 7567 735d   * [not my bugs]
+00000520: 2823 6e6f 742d 6d79 2d62 7567 7329 0a2a  (#not-my-bugs).*
+00000530: 205b 6272 6561 6b69 6e67 2063 6861 6e67   [breaking chang
+00000540: 6573 5d28 2362 7265 616b 696e 672d 6368  es](#breaking-ch
+00000550: 616e 6765 7329 202d 2075 7067 7261 6465  anges) - upgrade
+00000560: 206e 6f74 6573 0a2a 205b 4641 515d 2823   notes.* [FAQ](#
+00000570: 4641 5129 202d 2022 6672 6571 7565 6e74  FAQ) - "frequent
+00000580: 6c79 2220 6173 6b65 6420 7175 6573 7469  ly" asked questi
+00000590: 6f6e 730a 2a20 5b61 6363 6f75 6e74 7320  ons.* [accounts 
+000005a0: 616e 6420 766f 6c75 6d65 735d 2823 6163  and volumes](#ac
+000005b0: 636f 756e 7473 2d61 6e64 2d76 6f6c 756d  counts-and-volum
+000005c0: 6573 2920 2d20 7065 722d 666f 6c64 6572  es) - per-folder
+000005d0: 2c20 7065 722d 7573 6572 2070 6572 6d69  , per-user permi
+000005e0: 7373 696f 6e73 0a20 2020 202a 205b 7368  ssions.    * [sh
+000005f0: 6164 6f77 696e 675d 2823 7368 6164 6f77  adowing](#shadow
+00000600: 696e 6729 202d 2068 6964 696e 6720 7370  ing) - hiding sp
+00000610: 6563 6966 6963 2073 7562 666f 6c64 6572  ecific subfolder
+00000620: 730a 2a20 5b74 6865 2062 726f 7773 6572  s.* [the browser
+00000630: 5d28 2374 6865 2d62 726f 7773 6572 2920  ](#the-browser) 
+00000640: 2d20 6163 6365 7373 696e 6720 6120 636f  - accessing a co
+00000650: 7079 7061 7274 7920 7365 7276 6572 2075  pyparty server u
+00000660: 7369 6e67 2061 2077 6562 2d62 726f 7773  sing a web-brows
+00000670: 6572 0a20 2020 202a 205b 7461 6273 5d28  er.    * [tabs](
+00000680: 2374 6162 7329 202d 2074 6865 206d 6169  #tabs) - the mai
+00000690: 6e20 7461 6273 2069 6e20 7468 6520 7569  n tabs in the ui
+000006a0: 0a20 2020 202a 205b 686f 746b 6579 735d  .    * [hotkeys]
+000006b0: 2823 686f 746b 6579 7329 202d 2074 6865  (#hotkeys) - the
+000006c0: 2062 726f 7773 6572 2068 6173 2074 6865   browser has the
+000006d0: 2066 6f6c 6c6f 7769 6e67 2068 6f74 6b65   following hotke
+000006e0: 7973 0a20 2020 202a 205b 6e61 7670 616e  ys.    * [navpan
+000006f0: 655d 2823 6e61 7670 616e 6529 202d 2073  e](#navpane) - s
+00000700: 7769 7463 6869 6e67 2062 6574 7765 656e  witching between
+00000710: 2062 7265 6164 6372 756d 6273 206f 7220   breadcrumbs or 
+00000720: 6e61 7670 616e 650a 2020 2020 2a20 5b74  navpane.    * [t
+00000730: 6875 6d62 6e61 696c 735d 2823 7468 756d  humbnails](#thum
+00000740: 626e 6169 6c73 2920 2d20 7072 6573 7320  bnails) - press 
+00000750: 6067 6020 6f72 2060 e794 b060 2074 6f20  `g` or `...` to 
+00000760: 746f 6767 6c65 2067 7269 642d 7669 6577  toggle grid-view
+00000770: 2069 6e73 7465 6164 206f 6620 7468 6520   instead of the 
+00000780: 6669 6c65 206c 6973 7469 6e67 0a20 2020  file listing.   
+00000790: 202a 205b 7a69 7020 646f 776e 6c6f 6164   * [zip download
+000007a0: 735d 2823 7a69 702d 646f 776e 6c6f 6164  s](#zip-download
+000007b0: 7329 202d 2064 6f77 6e6c 6f61 6420 666f  s) - download fo
+000007c0: 6c64 6572 7320 286f 7220 6669 6c65 2073  lders (or file s
+000007d0: 656c 6563 7469 6f6e 7329 2061 7320 607a  elections) as `z
+000007e0: 6970 6020 6f72 2060 7461 7260 2066 696c  ip` or `tar` fil
+000007f0: 6573 0a20 2020 202a 205b 7570 6c6f 6164  es.    * [upload
+00000800: 696e 675d 2823 7570 6c6f 6164 696e 6729  ing](#uploading)
+00000810: 202d 2064 7261 6720 6669 6c65 732f 666f   - drag files/fo
+00000820: 6c64 6572 7320 696e 746f 2074 6865 2077  lders into the w
+00000830: 6562 2d62 726f 7773 6572 2074 6f20 7570  eb-browser to up
+00000840: 6c6f 6164 0a20 2020 2020 2020 202a 205b  load.        * [
+00000850: 6669 6c65 2d73 6561 7263 685d 2823 6669  file-search](#fi
+00000860: 6c65 2d73 6561 7263 6829 202d 2064 726f  le-search) - dro
+00000870: 7070 696e 6720 6669 6c65 7320 696e 746f  pping files into
+00000880: 2074 6865 2062 726f 7773 6572 2061 6c73   the browser als
+00000890: 6f20 6c65 7473 2079 6f75 2073 6565 2069  o lets you see i
+000008a0: 6620 7468 6579 2065 7869 7374 206f 6e20  f they exist on 
+000008b0: 7468 6520 7365 7276 6572 0a20 2020 2020  the server.     
+000008c0: 2020 202a 205b 756e 706f 7374 5d28 2375     * [unpost](#u
+000008d0: 6e70 6f73 7429 202d 2075 6e64 6f2f 6465  npost) - undo/de
+000008e0: 6c65 7465 2061 6363 6964 656e 7461 6c20  lete accidental 
+000008f0: 7570 6c6f 6164 730a 2020 2020 2020 2020  uploads.        
+00000900: 2a20 5b73 656c 662d 6465 7374 7275 6374  * [self-destruct
+00000910: 5d28 2373 656c 662d 6465 7374 7275 6374  ](#self-destruct
+00000920: 2920 2d20 7570 6c6f 6164 7320 6361 6e20  ) - uploads can 
+00000930: 6265 2067 6976 656e 2061 206c 6966 6574  be given a lifet
+00000940: 696d 650a 2020 2020 2a20 5b66 696c 6520  ime.    * [file 
+00000950: 6d61 6e61 6765 725d 2823 6669 6c65 2d6d  manager](#file-m
+00000960: 616e 6167 6572 2920 2d20 6375 742f 7061  anager) - cut/pa
+00000970: 7374 652c 2072 656e 616d 652c 2061 6e64  ste, rename, and
+00000980: 2064 656c 6574 6520 6669 6c65 732f 666f   delete files/fo
+00000990: 6c64 6572 7320 2869 6620 796f 7520 6861  lders (if you ha
+000009a0: 7665 2070 6572 6d69 7373 696f 6e29 0a20  ve permission). 
+000009b0: 2020 202a 205b 6261 7463 6820 7265 6e61     * [batch rena
+000009c0: 6d65 5d28 2362 6174 6368 2d72 656e 616d  me](#batch-renam
+000009d0: 6529 202d 2073 656c 6563 7420 736f 6d65  e) - select some
+000009e0: 2066 696c 6573 2061 6e64 2070 7265 7373   files and press
+000009f0: 2060 4632 6020 746f 2062 7269 6e67 2075   `F2` to bring u
+00000a00: 7020 7468 6520 7265 6e61 6d65 2055 490a  p the rename UI.
+00000a10: 2020 2020 2a20 5b6d 6564 6961 2070 6c61      * [media pla
+00000a20: 7965 725d 2823 6d65 6469 612d 706c 6179  yer](#media-play
+00000a30: 6572 2920 2d20 706c 6179 7320 616c 6d6f  er) - plays almo
+00000a40: 7374 2065 7665 7279 2061 7564 696f 2066  st every audio f
+00000a50: 6f72 6d61 7420 7468 6572 6520 6973 0a20  ormat there is. 
+00000a60: 2020 2020 2020 202a 205b 6175 6469 6f20         * [audio 
+00000a70: 6571 7561 6c69 7a65 725d 2823 6175 6469  equalizer](#audi
+00000a80: 6f2d 6571 7561 6c69 7a65 7229 202d 2062  o-equalizer) - b
+00000a90: 6173 7320 626f 6f73 7465 640a 2020 2020  ass boosted.    
+00000aa0: 2020 2020 2a20 5b66 6978 2075 6e72 656c      * [fix unrel
+00000ab0: 6961 626c 6520 706c 6179 6261 636b 206f  iable playback o
+00000ac0: 6e20 616e 6472 6f69 645d 2823 6669 782d  n android](#fix-
+00000ad0: 756e 7265 6c69 6162 6c65 2d70 6c61 7962  unreliable-playb
+00000ae0: 6163 6b2d 6f6e 2d61 6e64 726f 6964 2920  ack-on-android) 
+00000af0: 2d20 6475 6520 746f 2070 686f 6e65 202f  - due to phone /
+00000b00: 2061 7070 2073 6574 7469 6e67 730a 2020   app settings.  
+00000b10: 2020 2a20 5b6d 6172 6b64 6f77 6e20 7669    * [markdown vi
+00000b20: 6577 6572 5d28 236d 6172 6b64 6f77 6e2d  ewer](#markdown-
+00000b30: 7669 6577 6572 2920 2d20 616e 6420 7468  viewer) - and th
+00000b40: 6572 6520 6172 6520 2a74 776f 2a20 6564  ere are *two* ed
+00000b50: 6974 6f72 730a 2020 2020 2a20 5b6f 7468  itors.    * [oth
+00000b60: 6572 2074 7269 636b 735d 2823 6f74 6865  er tricks](#othe
+00000b70: 722d 7472 6963 6b73 290a 2020 2020 2a20  r-tricks).    * 
+00000b80: 5b73 6561 7263 6869 6e67 5d28 2373 6561  [searching](#sea
+00000b90: 7263 6869 6e67 2920 2d20 7365 6172 6368  rching) - search
+00000ba0: 2062 7920 7369 7a65 2c20 6461 7465 2c20   by size, date, 
+00000bb0: 7061 7468 2f6e 616d 652c 206d 7033 2d74  path/name, mp3-t
+00000bc0: 6167 732c 202e 2e2e 0a2a 205b 7365 7276  ags, ....* [serv
+00000bd0: 6572 2063 6f6e 6669 675d 2823 7365 7276  er config](#serv
+00000be0: 6572 2d63 6f6e 6669 6729 202d 2075 7369  er-config) - usi
+00000bf0: 6e67 2061 7267 756d 656e 7473 206f 7220  ng arguments or 
+00000c00: 636f 6e66 6967 2066 696c 6573 2c20 6f72  config files, or
+00000c10: 2061 206d 6978 206f 6620 626f 7468 0a20   a mix of both. 
+00000c20: 2020 202a 205b 7a65 726f 636f 6e66 5d28     * [zeroconf](
+00000c30: 237a 6572 6f63 6f6e 6629 202d 2061 6e6e  #zeroconf) - ann
+00000c40: 6f75 6e63 6520 656e 6162 6c65 6420 7365  ounce enabled se
+00000c50: 7276 6963 6573 206f 6e20 7468 6520 4c41  rvices on the LA
+00000c60: 4e20 285b 7069 635d 2868 7474 7073 3a2f  N ([pic](https:/
+00000c70: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+00000c80: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+00000c90: 6f6d 2f32 3431 3033 322f 3231 3533 3434  om/241032/215344
+00000ca0: 3733 372d 3065 6165 3864 3938 2d39 3439  737-0eae8d98-949
+00000cb0: 362d 3432 3536 2d39 6161 382d 6364 3266  6-4256-9aa8-cd2f
+00000cc0: 3639 3731 3831 3064 2e70 6e67 2929 0a20  6971810d.png)). 
+00000cd0: 2020 2020 2020 202a 205b 6d64 6e73 5d28         * [mdns](
+00000ce0: 236d 646e 7329 202d 204c 414e 2064 6f6d  #mdns) - LAN dom
+00000cf0: 6169 6e2d 6e61 6d65 2061 6e64 2066 6561  ain-name and fea
+00000d00: 7475 7265 2061 6e6e 6f75 6e63 6572 0a20  ture announcer. 
+00000d10: 2020 2020 2020 202a 205b 7373 6470 5d28         * [ssdp](
+00000d20: 2373 7364 7029 202d 2077 696e 646f 7773  #ssdp) - windows
+00000d30: 2d65 7870 6c6f 7265 7220 616e 6e6f 756e  -explorer announ
+00000d40: 6365 720a 2020 2020 2a20 5b71 722d 636f  cer.    * [qr-co
+00000d50: 6465 5d28 2371 722d 636f 6465 2920 2d20  de](#qr-code) - 
+00000d60: 7072 696e 7420 6120 7172 2d63 6f64 6520  print a qr-code 
+00000d70: 5b28 7363 7265 656e 7368 6f74 295d 2868  [(screenshot)](h
+00000d80: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+00000d90: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00000da0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00000db0: 3139 3437 3238 3533 332d 3666 3030 3834  194728533-6f0084
+00000dc0: 3962 2d63 3661 632d 3433 6336 2d39 3335  9b-c6ac-43c6-935
+00000dd0: 392d 3833 6534 3534 6431 3165 3030 2e70  9-83e454d11e00.p
+00000de0: 6e67 2920 666f 7220 7175 6963 6b20 6163  ng) for quick ac
+00000df0: 6365 7373 0a20 2020 202a 205b 6674 7020  cess.    * [ftp 
+00000e00: 7365 7276 6572 5d28 2366 7470 2d73 6572  server](#ftp-ser
+00000e10: 7665 7229 202d 2061 6e20 4654 5020 7365  ver) - an FTP se
+00000e20: 7276 6572 2063 616e 2062 6520 7374 6172  rver can be star
+00000e30: 7465 6420 7573 696e 6720 602d 2d66 7470  ted using `--ftp
+00000e40: 2033 3932 3160 0a20 2020 202a 205b 7765   3921`.    * [we
+00000e50: 6264 6176 2073 6572 7665 725d 2823 7765  bdav server](#we
+00000e60: 6264 6176 2d73 6572 7665 7229 202d 2077  bdav-server) - w
+00000e70: 6974 6820 7265 6164 2d77 7269 7465 2073  ith read-write s
+00000e80: 7570 706f 7274 0a20 2020 2020 2020 202a  upport.        *
+00000e90: 205b 636f 6e6e 6563 7469 6e67 2074 6f20   [connecting to 
+00000ea0: 7765 6264 6176 2066 726f 6d20 7769 6e64  webdav from wind
+00000eb0: 6f77 735d 2823 636f 6e6e 6563 7469 6e67  ows](#connecting
+00000ec0: 2d74 6f2d 7765 6264 6176 2d66 726f 6d2d  -to-webdav-from-
+00000ed0: 7769 6e64 6f77 7329 202d 2075 7369 6e67  windows) - using
+00000ee0: 2074 6865 2047 5549 0a20 2020 202a 205b   the GUI.    * [
+00000ef0: 736d 6220 7365 7276 6572 5d28 2373 6d62  smb server](#smb
+00000f00: 2d73 6572 7665 7229 202d 2075 6e73 6166  -server) - unsaf
+00000f10: 652c 2073 6c6f 772c 206e 6f74 2072 6563  e, slow, not rec
+00000f20: 6f6d 6d65 6e64 6564 2066 6f72 2077 616e  ommended for wan
+00000f30: 0a20 2020 202a 205b 6669 6c65 2069 6e64  .    * [file ind
+00000f40: 6578 696e 675d 2823 6669 6c65 2d69 6e64  exing](#file-ind
+00000f50: 6578 696e 6729 202d 2065 6e61 626c 6573  exing) - enables
+00000f60: 2064 6564 7570 2061 6e64 206d 7573 6963   dedup and music
+00000f70: 2073 6561 7263 6820 2b2b 0a20 2020 2020   search ++.     
+00000f80: 2020 202a 205b 6578 636c 7564 652d 7061     * [exclude-pa
+00000f90: 7474 6572 6e73 5d28 2365 7863 6c75 6465  tterns](#exclude
+00000fa0: 2d70 6174 7465 726e 7329 202d 2074 6f20  -patterns) - to 
+00000fb0: 7361 7665 2073 6f6d 6520 7469 6d65 0a20  save some time. 
+00000fc0: 2020 2020 2020 202a 205b 6669 6c65 7379         * [filesy
+00000fd0: 7374 656d 2067 7561 7264 735d 2823 6669  stem guards](#fi
+00000fe0: 6c65 7379 7374 656d 2d67 7561 7264 7329  lesystem-guards)
+00000ff0: 202d 2061 766f 6964 2074 7261 7665 7273   - avoid travers
+00001000: 696e 6720 696e 746f 206f 7468 6572 2066  ing into other f
+00001010: 696c 6573 7973 7465 6d73 0a20 2020 2020  ilesystems.     
+00001020: 2020 202a 205b 7065 7269 6f64 6963 2072     * [periodic r
+00001030: 6573 6361 6e5d 2823 7065 7269 6f64 6963  escan](#periodic
+00001040: 2d72 6573 6361 6e29 202d 2066 696c 6573  -rescan) - files
+00001050: 7973 7465 6d20 6d6f 6e69 746f 7269 6e67  ystem monitoring
+00001060: 0a20 2020 202a 205b 7570 6c6f 6164 2072  .    * [upload r
+00001070: 756c 6573 5d28 2375 706c 6f61 642d 7275  ules](#upload-ru
+00001080: 6c65 7329 202d 2073 6574 2075 706c 6f61  les) - set uploa
+00001090: 6420 7275 6c65 7320 7573 696e 6720 766f  d rules using vo
+000010a0: 6c66 6c61 6773 0a20 2020 202a 205b 636f  lflags.    * [co
+000010b0: 6d70 7265 7373 2075 706c 6f61 6473 5d28  mpress uploads](
+000010c0: 2363 6f6d 7072 6573 732d 7570 6c6f 6164  #compress-upload
+000010d0: 7329 202d 2066 696c 6573 2063 616e 2062  s) - files can b
+000010e0: 6520 6175 746f 636f 6d70 7265 7373 6564  e autocompressed
+000010f0: 206f 6e20 7570 6c6f 6164 0a20 2020 202a   on upload.    *
+00001100: 205b 6f74 6865 7220 666c 6167 735d 2823   [other flags](#
+00001110: 6f74 6865 722d 666c 6167 7329 0a20 2020  other-flags).   
+00001120: 202a 205b 6461 7461 6261 7365 206c 6f63   * [database loc
+00001130: 6174 696f 6e5d 2823 6461 7461 6261 7365  ation](#database
+00001140: 2d6c 6f63 6174 696f 6e29 202d 2069 6e2d  -location) - in-
+00001150: 766f 6c75 6d65 2028 602e 6869 7374 2f75  volume (`.hist/u
+00001160: 7032 6b2e 6462 602c 2064 6566 6175 6c74  p2k.db`, default
+00001170: 2920 6f72 2073 6f6d 6577 6865 7265 2065  ) or somewhere e
+00001180: 6c73 650a 2020 2020 2a20 5b6d 6574 6164  lse.    * [metad
+00001190: 6174 6120 6672 6f6d 2061 7564 696f 2066  ata from audio f
+000011a0: 696c 6573 5d28 236d 6574 6164 6174 612d  iles](#metadata-
+000011b0: 6672 6f6d 2d61 7564 696f 2d66 696c 6573  from-audio-files
+000011c0: 2920 2d20 7365 7420 602d 6532 7460 2074  ) - set `-e2t` t
+000011d0: 6f20 696e 6465 7820 7461 6773 206f 6e20  o index tags on 
+000011e0: 7570 6c6f 6164 0a20 2020 202a 205b 6669  upload.    * [fi
+000011f0: 6c65 2070 6172 7365 7220 706c 7567 696e  le parser plugin
+00001200: 735d 2823 6669 6c65 2d70 6172 7365 722d  s](#file-parser-
+00001210: 706c 7567 696e 7329 202d 2070 726f 7669  plugins) - provi
+00001220: 6465 2063 7573 746f 6d20 7061 7273 6572  de custom parser
+00001230: 7320 746f 2069 6e64 6578 2061 6464 6974  s to index addit
+00001240: 696f 6e61 6c20 7461 6773 0a20 2020 202a  ional tags.    *
+00001250: 205b 6576 656e 7420 686f 6f6b 735d 2823   [event hooks](#
+00001260: 6576 656e 742d 686f 6f6b 7329 202d 2074  event-hooks) - t
+00001270: 7269 6767 6572 2061 2070 726f 6772 616d  rigger a program
+00001280: 206f 6e20 7570 6c6f 6164 732c 2072 656e   on uploads, ren
+00001290: 616d 6573 2065 7463 2028 5b65 7861 6d70  ames etc ([examp
+000012a0: 6c65 735d 282e 2f62 696e 2f68 6f6f 6b73  les](./bin/hooks
+000012b0: 2f29 290a 2020 2020 2020 2020 2a20 5b75  /)).        * [u
+000012c0: 706c 6f61 6420 6576 656e 7473 5d28 2375  pload events](#u
+000012d0: 706c 6f61 642d 6576 656e 7473 2920 2d20  pload-events) - 
+000012e0: 7468 6520 6f6c 6465 722c 206d 6f72 6520  the older, more 
+000012f0: 706f 7765 7266 756c 2061 7070 726f 6163  powerful approac
+00001300: 6820 285b 6578 616d 706c 6573 5d28 2e2f  h ([examples](./
+00001310: 6269 6e2f 6d74 6167 2f29 290a 2020 2020  bin/mtag/)).    
+00001320: 2a20 5b68 6964 696e 6720 6672 6f6d 2067  * [hiding from g
+00001330: 6f6f 676c 655d 2823 6869 6469 6e67 2d66  oogle](#hiding-f
+00001340: 726f 6d2d 676f 6f67 6c65 2920 2d20 7465  rom-google) - te
+00001350: 6c6c 2073 6561 7263 6820 656e 6769 6e65  ll search engine
+00001360: 7320 796f 7520 646f 6e74 2077 616e 6e61  s you dont wanna
+00001370: 2062 6520 696e 6465 7865 640a 2020 2020   be indexed.    
+00001380: 2a20 5b74 6865 6d65 735d 2823 7468 656d  * [themes](#them
+00001390: 6573 290a 2020 2020 2a20 5b63 6f6d 706c  es).    * [compl
+000013a0: 6574 6520 6578 616d 706c 6573 5d28 2363  ete examples](#c
+000013b0: 6f6d 706c 6574 652d 6578 616d 706c 6573  omplete-examples
+000013c0: 290a 2020 2020 2a20 5b72 6576 6572 7365  ).    * [reverse
+000013d0: 2d70 726f 7879 5d28 2372 6576 6572 7365  -proxy](#reverse
+000013e0: 2d70 726f 7879 2920 2d20 7275 6e6e 696e  -proxy) - runnin
+000013f0: 6720 636f 7079 7061 7274 7920 6e65 7874  g copyparty next
+00001400: 2074 6f20 6f74 6865 7220 7765 6273 6974   to other websit
+00001410: 6573 0a2a 205b 7061 636b 6167 6573 5d28  es.* [packages](
+00001420: 2370 6163 6b61 6765 7329 202d 2074 6865  #packages) - the
+00001430: 2070 6172 7479 206d 6967 6874 2062 6520   party might be 
+00001440: 636c 6f73 6572 2074 6861 6e20 796f 7520  closer than you 
+00001450: 7468 696e 6b0a 2020 2020 2a20 5b61 7263  think.    * [arc
+00001460: 6820 7061 636b 6167 655d 2823 6172 6368  h package](#arch
+00001470: 2d70 6163 6b61 6765 2920 2d20 6e6f 7720  -package) - now 
+00001480: 5b61 7661 696c 6162 6c65 206f 6e20 6175  [available on au
+00001490: 725d 2868 7474 7073 3a2f 2f61 7572 2e61  r](https://aur.a
+000014a0: 7263 686c 696e 7578 2e6f 7267 2f70 6163  rchlinux.org/pac
+000014b0: 6b61 6765 732f 636f 7079 7061 7274 7929  kages/copyparty)
+000014c0: 206d 6169 6e74 6169 6e65 6420 6279 205b   maintained by [
+000014d0: 4069 6378 6573 5d28 6874 7470 733a 2f2f  @icxes](https://
+000014e0: 6769 7468 7562 2e63 6f6d 2f69 6378 6573  github.com/icxes
+000014f0: 290a 2020 2020 2a20 5b6e 6978 2070 6163  ).    * [nix pac
+00001500: 6b61 6765 5d28 236e 6978 2d70 6163 6b61  kage](#nix-packa
+00001510: 6765 2920 2d20 606e 6978 2070 726f 6669  ge) - `nix profi
+00001520: 6c65 2069 6e73 7461 6c6c 2067 6974 6875  le install githu
+00001530: 623a 3930 3031 2f63 6f70 7970 6172 7479  b:9001/copyparty
+00001540: 600a 2020 2020 2a20 5b6e 6978 6f73 206d  `.    * [nixos m
+00001550: 6f64 756c 655d 2823 6e69 786f 732d 6d6f  odule](#nixos-mo
+00001560: 6475 6c65 290a 2a20 5b62 726f 7773 6572  dule).* [browser
+00001570: 2073 7570 706f 7274 5d28 2362 726f 7773   support](#brows
+00001580: 6572 2d73 7570 706f 7274 2920 2d20 544c  er-support) - TL
+00001590: 4452 3a20 7965 730a 2a20 5b63 6c69 656e  DR: yes.* [clien
+000015a0: 7420 6578 616d 706c 6573 5d28 2363 6c69  t examples](#cli
+000015b0: 656e 742d 6578 616d 706c 6573 2920 2d20  ent-examples) - 
+000015c0: 696e 7465 7261 6374 2077 6974 6820 636f  interact with co
+000015d0: 7079 7061 7274 7920 7573 696e 6720 6e6f  pyparty using no
+000015e0: 6e2d 6272 6f77 7365 7220 636c 6965 6e74  n-browser client
+000015f0: 730a 2020 2020 2a20 5b66 6f6c 6465 7220  s.    * [folder 
+00001600: 7379 6e63 5d28 2366 6f6c 6465 722d 7379  sync](#folder-sy
+00001610: 6e63 2920 2d20 7379 6e63 2066 6f6c 6465  nc) - sync folde
+00001620: 7273 2074 6f2f 6672 6f6d 2063 6f70 7970  rs to/from copyp
+00001630: 6172 7479 0a20 2020 202a 205b 6d6f 756e  arty.    * [moun
+00001640: 7420 6173 2064 7269 7665 5d28 236d 6f75  t as drive](#mou
+00001650: 6e74 2d61 732d 6472 6976 6529 202d 2061  nt-as-drive) - a
+00001660: 2072 656d 6f74 6520 636f 7079 7061 7274   remote copypart
+00001670: 7920 7365 7276 6572 2061 7320 6120 6c6f  y server as a lo
+00001680: 6361 6c20 6669 6c65 7379 7374 656d 0a2a  cal filesystem.*
+00001690: 205b 616e 6472 6f69 6420 6170 705d 2823   [android app](#
+000016a0: 616e 6472 6f69 642d 6170 7029 202d 2075  android-app) - u
+000016b0: 706c 6f61 6420 746f 2063 6f70 7970 6172  pload to copypar
+000016c0: 7479 2077 6974 6820 6f6e 6520 7461 700a  ty with one tap.
+000016d0: 2a20 5b69 4f53 2073 686f 7274 6375 7473  * [iOS shortcuts
+000016e0: 5d28 2369 4f53 2d73 686f 7274 6375 7473  ](#iOS-shortcuts
+000016f0: 2920 2d20 7468 6572 6520 6973 206e 6f20  ) - there is no 
+00001700: 6950 686f 6e65 2061 7070 2c20 6275 740a  iPhone app, but.
+00001710: 2a20 5b70 6572 666f 726d 616e 6365 5d28  * [performance](
+00001720: 2370 6572 666f 726d 616e 6365 2920 2d20  #performance) - 
+00001730: 6465 6661 756c 7473 2061 7265 2075 7375  defaults are usu
+00001740: 616c 6c79 2066 696e 6520 2d20 6578 7065  ally fine - expe
+00001750: 6374 2060 3820 4769 422f 7360 2064 6f77  ct `8 GiB/s` dow
+00001760: 6e6c 6f61 642c 2060 3120 4769 422f 7360  nload, `1 GiB/s`
+00001770: 2075 706c 6f61 640a 2020 2020 2a20 5b63   upload.    * [c
+00001780: 6c69 656e 742d 7369 6465 5d28 2363 6c69  lient-side](#cli
+00001790: 656e 742d 7369 6465 2920 2d20 7768 656e  ent-side) - when
+000017a0: 2075 706c 6f61 6469 6e67 2066 696c 6573   uploading files
+000017b0: 0a2a 205b 7365 6375 7269 7479 5d28 2373  .* [security](#s
+000017c0: 6563 7572 6974 7929 202d 2073 6f6d 6520  ecurity) - some 
+000017d0: 6e6f 7465 7320 6f6e 2068 6172 6465 6e69  notes on hardeni
+000017e0: 6e67 0a20 2020 202a 205b 676f 7463 6861  ng.    * [gotcha
+000017f0: 735d 2823 676f 7463 6861 7329 202d 2062  s](#gotchas) - b
+00001800: 6568 6176 696f 7220 7468 6174 206d 6967  ehavior that mig
+00001810: 6874 2062 6520 756e 6578 7065 6374 6564  ht be unexpected
+00001820: 0a20 2020 202a 205b 636f 7273 5d28 2363  .    * [cors](#c
+00001830: 6f72 7329 202d 2063 726f 7373 2d73 6974  ors) - cross-sit
+00001840: 6520 7265 7175 6573 7420 636f 6e66 6967  e request config
+00001850: 0a20 2020 202a 205b 6874 7470 735d 2823  .    * [https](#
+00001860: 6874 7470 7329 202d 2062 6f74 6820 4854  https) - both HT
+00001870: 5450 2061 6e64 2048 5454 5053 2061 7265  TP and HTTPS are
+00001880: 2061 6363 6570 7465 640a 2a20 5b72 6563   accepted.* [rec
+00001890: 6f76 6572 696e 6720 6672 6f6d 2063 7261  overing from cra
+000018a0: 7368 6573 5d28 2372 6563 6f76 6572 696e  shes](#recoverin
+000018b0: 672d 6672 6f6d 2d63 7261 7368 6573 290a  g-from-crashes).
+000018c0: 2020 2020 2a20 5b63 6c69 656e 7420 6372      * [client cr
+000018d0: 6173 6865 735d 2823 636c 6965 6e74 2d63  ashes](#client-c
+000018e0: 7261 7368 6573 290a 2020 2020 2020 2020  rashes).        
+000018f0: 2a20 5b66 7265 666f 7820 7773 6f64 5d28  * [frefox wsod](
+00001900: 2366 7265 666f 782d 7773 6f64 2920 2d20  #frefox-wsod) - 
+00001910: 6669 7265 666f 7820 3837 2063 616e 2063  firefox 87 can c
+00001920: 7261 7368 2064 7572 696e 6720 7570 6c6f  rash during uplo
+00001930: 6164 730a 2a20 5b48 5454 5020 4150 495d  ads.* [HTTP API]
+00001940: 2823 4854 5450 2d41 5049 2920 2d20 7365  (#HTTP-API) - se
+00001950: 6520 5b64 6576 6e6f 7465 735d 282e 2f64  e [devnotes](./d
+00001960: 6f63 732f 6465 766e 6f74 6573 2e6d 6423  ocs/devnotes.md#
+00001970: 6874 7470 2d61 7069 290a 2a20 5b64 6570  http-api).* [dep
+00001980: 656e 6465 6e63 6965 735d 2823 6465 7065  endencies](#depe
+00001990: 6e64 656e 6369 6573 2920 2d20 6d61 6e64  ndencies) - mand
+000019a0: 6174 6f72 7920 6465 7073 0a20 2020 202a  atory deps.    *
+000019b0: 205b 6f70 7469 6f6e 616c 2064 6570 656e   [optional depen
+000019c0: 6465 6e63 6965 735d 2823 6f70 7469 6f6e  dencies](#option
+000019d0: 616c 2d64 6570 656e 6465 6e63 6965 7329  al-dependencies)
+000019e0: 202d 2069 6e73 7461 6c6c 2074 6865 7365   - install these
+000019f0: 2074 6f20 656e 6162 6c65 2062 6f6e 7573   to enable bonus
+00001a00: 2066 6561 7475 7265 730a 2020 2020 2a20   features.    * 
+00001a10: 5b6f 7074 696f 6e61 6c20 6770 6c20 7374  [optional gpl st
+00001a20: 7566 665d 2823 6f70 7469 6f6e 616c 2d67  uff](#optional-g
+00001a30: 706c 2d73 7475 6666 290a 2a20 5b73 6678  pl-stuff).* [sfx
+00001a40: 5d28 2373 6678 2920 2d20 7468 6520 7365  ](#sfx) - the se
+00001a50: 6c66 2d63 6f6e 7461 696e 6564 2022 6269  lf-contained "bi
+00001a60: 6e61 7279 220a 2020 2020 2a20 5b63 6f70  nary".    * [cop
+00001a70: 7970 6172 7479 2e65 7865 5d28 2363 6f70  yparty.exe](#cop
+00001a80: 7970 6172 7479 6578 6529 202d 2064 6f77  ypartyexe) - dow
+00001a90: 6e6c 6f61 6420 5b63 6f70 7970 6172 7479  nload [copyparty
+00001aa0: 2e65 7865 5d28 6874 7470 733a 2f2f 6769  .exe](https://gi
+00001ab0: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
+00001ac0: 7079 7061 7274 792f 7265 6c65 6173 6573  pyparty/releases
+00001ad0: 2f6c 6174 6573 742f 646f 776e 6c6f 6164  /latest/download
+00001ae0: 2f63 6f70 7970 6172 7479 2e65 7865 2920  /copyparty.exe) 
+00001af0: 2877 696e 382b 2920 6f72 205b 636f 7079  (win8+) or [copy
+00001b00: 7061 7274 7933 322e 6578 655d 2868 7474  party32.exe](htt
+00001b10: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+00001b20: 3930 3031 2f63 6f70 7970 6172 7479 2f72  9001/copyparty/r
+00001b30: 656c 6561 7365 732f 6c61 7465 7374 2f64  eleases/latest/d
+00001b40: 6f77 6e6c 6f61 642f 636f 7079 7061 7274  ownload/copypart
+00001b50: 7933 322e 6578 6529 2028 7769 6e37 2b29  y32.exe) (win7+)
+00001b60: 0a2a 205b 696e 7374 616c 6c20 6f6e 2061  .* [install on a
+00001b70: 6e64 726f 6964 5d28 2369 6e73 7461 6c6c  ndroid](#install
+00001b80: 2d6f 6e2d 616e 6472 6f69 6429 0a2a 205b  -on-android).* [
+00001b90: 7265 706f 7274 696e 6720 6275 6773 5d28  reporting bugs](
+00001ba0: 2372 6570 6f72 7469 6e67 2d62 7567 7329  #reporting-bugs)
+00001bb0: 202d 2069 6465 6173 2066 6f72 2063 6f6e   - ideas for con
+00001bc0: 7465 7874 2074 6f20 696e 636c 7564 6520  text to include 
+00001bd0: 696e 2062 7567 2072 6570 6f72 7473 0a2a  in bug reports.*
+00001be0: 205b 6465 766e 6f74 6573 5d28 2364 6576   [devnotes](#dev
+00001bf0: 6e6f 7465 7329 202d 2066 6f72 2062 7569  notes) - for bui
+00001c00: 6c64 2069 6e73 7472 7563 7469 6f6e 7320  ld instructions 
+00001c10: 6574 632c 2073 6565 205b 2e2f 646f 6373  etc, see [./docs
+00001c20: 2f64 6576 6e6f 7465 732e 6d64 5d28 2e2f  /devnotes.md](./
+00001c30: 646f 6373 2f64 6576 6e6f 7465 732e 6d64  docs/devnotes.md
+00001c40: 290a 0a0a 2323 2071 7569 636b 7374 6172  )...## quickstar
+00001c50: 740a 0a6a 7573 7420 7275 6e20 2a2a 5b63  t..just run **[c
+00001c60: 6f70 7970 6172 7479 2d73 6678 2e70 795d  opyparty-sfx.py]
+00001c70: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00001c80: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00001c90: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00001ca0: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00001cb0: 7061 7274 792d 7366 782e 7079 292a 2a20  party-sfx.py)** 
+00001cc0: 2d2d 2074 6861 7427 7320 6974 2120 f09f  -- that's it! ..
+00001cd0: 8e89 0a0a 2a20 6f72 2069 6e73 7461 6c6c  ....* or install
+00001ce0: 2074 6872 6f75 6768 2070 7970 6920 2870   through pypi (p
+00001cf0: 7974 686f 6e33 206f 6e6c 7929 3a20 6070  ython3 only): `p
+00001d00: 7974 686f 6e33 202d 6d20 7069 7020 696e  ython3 -m pip in
+00001d10: 7374 616c 6c20 2d2d 7573 6572 202d 5520  stall --user -U 
+00001d20: 636f 7079 7061 7274 7960 0a2a 206f 7220  copyparty`.* or 
+00001d30: 6966 2079 6f75 2063 616e 6e6f 7420 696e  if you cannot in
+00001d40: 7374 616c 6c20 7079 7468 6f6e 2c20 796f  stall python, yo
+00001d50: 7520 6361 6e20 7573 6520 5b63 6f70 7970  u can use [copyp
+00001d60: 6172 7479 2e65 7865 5d28 2363 6f70 7970  arty.exe](#copyp
+00001d70: 6172 7479 6578 6529 2069 6e73 7465 6164  artyexe) instead
+00001d80: 0a2a 206f 7220 5b69 6e73 7461 6c6c 2074  .* or [install t
+00001d90: 6872 6f75 6768 206e 6978 5d28 236e 6978  hrough nix](#nix
+00001da0: 2d70 6163 6b61 6765 292c 206f 7220 5b6f  -package), or [o
+00001db0: 6e20 4e69 784f 535d 2823 6e69 786f 732d  n NixOS](#nixos-
+00001dc0: 6d6f 6475 6c65 292c 206f 7220 5b6f 6e20  module), or [on 
+00001dd0: 6172 6368 5d28 2361 7263 682d 7061 636b  arch](#arch-pack
+00001de0: 6167 6529 0a2a 206f 7220 6966 2079 6f75  age).* or if you
+00001df0: 2061 7265 206f 6e20 616e 6472 6f69 642c   are on android,
+00001e00: 205b 696e 7374 616c 6c20 636f 7079 7061   [install copypa
+00001e10: 7274 7920 696e 2074 6572 6d75 785d 2823  rty in termux](#
+00001e20: 696e 7374 616c 6c2d 6f6e 2d61 6e64 726f  install-on-andro
+00001e30: 6964 290a 2a20 6f72 2069 6620 796f 7520  id).* or if you 
+00001e40: 7072 6566 6572 2074 6f20 5b75 7365 2064  prefer to [use d
+00001e50: 6f63 6b65 725d 282e 2f73 6372 6970 7473  ocker](./scripts
+00001e60: 2f64 6f63 6b65 722f 2920 f09f 908b 2079  /docker/) .... y
+00001e70: 6f75 2063 616e 2064 6f20 7468 6174 2074  ou can do that t
+00001e80: 6f6f 0a20 202a 2064 6f63 6b65 7220 6861  oo.  * docker ha
+00001e90: 7320 616c 6c20 6465 7073 2062 7569 6c74  s all deps built
+00001ea0: 2d69 6e2c 2073 6f20 736b 6970 2074 6869  -in, so skip thi
+00001eb0: 7320 7374 6570 3a0a 0a65 6e61 626c 6520  s step:..enable 
+00001ec0: 7468 756d 626e 6169 6c73 2028 696d 6167  thumbnails (imag
+00001ed0: 6573 2f61 7564 696f 2f76 6964 656f 292c  es/audio/video),
+00001ee0: 206d 6564 6961 2069 6e64 6578 696e 672c   media indexing,
+00001ef0: 2061 6e64 2061 7564 696f 2074 7261 6e73   and audio trans
+00001f00: 636f 6469 6e67 2062 7920 696e 7374 616c  coding by instal
+00001f10: 6c69 6e67 2073 6f6d 6520 7265 636f 6d6d  ling some recomm
+00001f20: 656e 6465 6420 6465 7073 3a0a 0a2a 202a  ended deps:..* *
+00001f30: 2a41 6c70 696e 653a 2a2a 2060 6170 6b20  *Alpine:** `apk 
+00001f40: 6164 6420 7079 332d 7069 6c6c 6f77 2066  add py3-pillow f
+00001f50: 666d 7065 6760 0a2a 202a 2a44 6562 6961  fmpeg`.* **Debia
+00001f60: 6e3a 2a2a 2060 6170 7420 696e 7374 616c  n:** `apt instal
+00001f70: 6c20 7079 7468 6f6e 332d 7069 6c20 6666  l python3-pil ff
+00001f80: 6d70 6567 600a 2a20 2a2a 4665 646f 7261  mpeg`.* **Fedora
+00001f90: 3a2a 2a20 6064 6e66 2069 6e73 7461 6c6c  :** `dnf install
+00001fa0: 2070 7974 686f 6e33 2d70 696c 6c6f 7720   python3-pillow 
+00001fb0: 6666 6d70 6567 600a 2a20 2a2a 4672 6565  ffmpeg`.* **Free
+00001fc0: 4253 443a 2a2a 2060 706b 6720 696e 7374  BSD:** `pkg inst
+00001fd0: 616c 6c20 7079 3339 2d73 716c 6974 6533  all py39-sqlite3
+00001fe0: 2070 7933 392d 7069 6c6c 6f77 2066 666d   py39-pillow ffm
+00001ff0: 7065 6760 0a2a 202a 2a4d 6163 4f53 3a2a  peg`.* **MacOS:*
+00002000: 2a20 6070 6f72 7420 696e 7374 616c 6c20  * `port install 
+00002010: 7079 2d50 696c 6c6f 7720 6666 6d70 6567  py-Pillow ffmpeg
+00002020: 600a 2a20 2a2a 4d61 634f 532a 2a20 2861  `.* **MacOS** (a
+00002030: 6c74 6572 6e61 7469 7665 293a 2060 6272  lternative): `br
+00002040: 6577 2069 6e73 7461 6c6c 2070 696c 6c6f  ew install pillo
+00002050: 7720 6666 6d70 6567 600a 2a20 2a2a 5769  w ffmpeg`.* **Wi
+00002060: 6e64 6f77 733a 2a2a 2060 7079 7468 6f6e  ndows:** `python
+00002070: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
+00002080: 2d2d 7573 6572 202d 5520 5069 6c6c 6f77  --user -U Pillow
+00002090: 600a 2020 2a20 696e 7374 616c 6c20 7079  `.  * install py
+000020a0: 7468 6f6e 2061 6e64 2066 666d 7065 6720  thon and ffmpeg 
+000020b0: 6d61 6e75 616c 6c79 3b20 646f 206e 6f74  manually; do not
+000020c0: 2075 7365 2060 7769 6e67 6574 6020 6f72   use `winget` or
+000020d0: 2060 4d69 6372 6f73 6f66 7420 5374 6f72   `Microsoft Stor
+000020e0: 6560 2028 6974 2062 7265 616b 7320 2450  e` (it breaks $P
+000020f0: 4154 4829 0a20 202a 2063 6f70 7970 6172  ATH).  * copypar
+00002100: 7479 2e65 7865 2063 6f6d 6573 2077 6974  ty.exe comes wit
+00002110: 6820 6050 696c 6c6f 7760 2061 6e64 206f  h `Pillow` and o
+00002120: 6e6c 7920 6e65 6564 7320 6066 666d 7065  nly needs `ffmpe
+00002130: 6760 0a2a 2073 6565 205b 6f70 7469 6f6e  g`.* see [option
+00002140: 616c 2064 6570 656e 6465 6e63 6965 735d  al dependencies]
+00002150: 2823 6f70 7469 6f6e 616c 2d64 6570 656e  (#optional-depen
+00002160: 6465 6e63 6965 7329 2074 6f20 656e 6162  dencies) to enab
+00002170: 6c65 2065 7665 6e20 6d6f 7265 2066 6561  le even more fea
+00002180: 7475 7265 730a 0a72 756e 6e69 6e67 2063  tures..running c
+00002190: 6f70 7970 6172 7479 2077 6974 686f 7574  opyparty without
+000021a0: 2061 7267 756d 656e 7473 2028 666f 7220   arguments (for 
+000021b0: 6578 616d 706c 6520 646f 7562 6c65 636c  example doublecl
+000021c0: 6963 6b69 6e67 2069 7420 6f6e 2057 696e  icking it on Win
+000021d0: 646f 7773 2920 7769 6c6c 2067 6976 6520  dows) will give 
+000021e0: 6576 6572 796f 6e65 2072 6561 642f 7772  everyone read/wr
+000021f0: 6974 6520 6163 6365 7373 2074 6f20 7468  ite access to th
+00002200: 6520 6375 7272 656e 7420 666f 6c64 6572  e current folder
+00002210: 3b20 796f 7520 6d61 7920 7761 6e74 205b  ; you may want [
+00002220: 6163 636f 756e 7473 2061 6e64 2076 6f6c  accounts and vol
+00002230: 756d 6573 5d28 2361 6363 6f75 6e74 732d  umes](#accounts-
+00002240: 616e 642d 766f 6c75 6d65 7329 0a0a 6f72  and-volumes)..or
+00002250: 2073 6565 205b 636f 6d70 6c65 7465 2077   see [complete w
+00002260: 696e 646f 7773 2065 7861 6d70 6c65 5d28  indows example](
+00002270: 2e2f 646f 6373 2f65 7861 6d70 6c65 732f  ./docs/examples/
+00002280: 7769 6e64 6f77 732e 6d64 290a 0a73 6f6d  windows.md)..som
+00002290: 6520 7265 636f 6d6d 656e 6465 6420 6f70  e recommended op
+000022a0: 7469 6f6e 733a 0a2a 2060 2d65 3264 7361  tions:.* `-e2dsa
+000022b0: 6020 656e 6162 6c65 7320 6765 6e65 7261  ` enables genera
+000022c0: 6c20 5b66 696c 6520 696e 6465 7869 6e67  l [file indexing
+000022d0: 5d28 2366 696c 652d 696e 6465 7869 6e67  ](#file-indexing
+000022e0: 290a 2a20 602d 6532 7473 6020 656e 6162  ).* `-e2ts` enab
+000022f0: 6c65 7320 6175 6469 6f20 6d65 7461 6461  les audio metada
+00002300: 7461 2069 6e64 6578 696e 6720 286e 6565  ta indexing (nee
+00002310: 6473 2065 6974 6865 7220 4646 7072 6f62  ds either FFprob
+00002320: 6520 6f72 204d 7574 6167 656e 290a 2a20  e or Mutagen).* 
+00002330: 602d 7620 2f6d 6e74 2f6d 7573 6963 3a2f  `-v /mnt/music:/
+00002340: 6d75 7369 633a 723a 7277 2c66 6f6f 202d  music:r:rw,foo -
+00002350: 6120 666f 6f3a 6261 7260 2073 6861 7265  a foo:bar` share
+00002360: 7320 602f 6d6e 742f 6d75 7369 6360 2061  s `/mnt/music` a
+00002370: 7320 602f 6d75 7369 6360 2c20 6072 6065  s `/music`, `r`e
+00002380: 6164 6162 6c65 2062 7920 616e 796f 6e65  adable by anyone
+00002390: 2c20 616e 6420 7265 6164 2d77 7269 7465  , and read-write
+000023a0: 2066 6f72 2075 7365 7220 6066 6f6f 602c   for user `foo`,
+000023b0: 2070 6173 7377 6f72 6420 6062 6172 600a   password `bar`.
+000023c0: 2020 2a20 7265 706c 6163 6520 603a 723a    * replace `:r:
+000023d0: 7277 2c66 6f6f 6020 7769 7468 2060 3a72  rw,foo` with `:r
+000023e0: 2c66 6f6f 6020 746f 206f 6e6c 7920 6d61  ,foo` to only ma
+000023f0: 6b65 2074 6865 2066 6f6c 6465 7220 7265  ke the folder re
+00002400: 6164 6162 6c65 2062 7920 6066 6f6f 6020  adable by `foo` 
+00002410: 616e 6420 6e6f 626f 6479 2065 6c73 650a  and nobody else.
+00002420: 2020 2a20 7365 6520 5b61 6363 6f75 6e74    * see [account
+00002430: 7320 616e 6420 766f 6c75 6d65 735d 2823  s and volumes](#
+00002440: 6163 636f 756e 7473 2d61 6e64 2d76 6f6c  accounts-and-vol
+00002450: 756d 6573 2920 286f 7220 602d 2d68 656c  umes) (or `--hel
+00002460: 702d 6163 636f 756e 7473 6029 2066 6f72  p-accounts`) for
+00002470: 2074 6865 2073 796e 7461 7820 616e 6420   the syntax and 
+00002480: 6f74 6865 7220 7065 726d 6973 7369 6f6e  other permission
+00002490: 730a 0a0a 2323 2320 6f6e 2073 6572 7665  s...### on serve
+000024a0: 7273 0a0a 796f 7520 6d61 7920 616c 736f  rs..you may also
+000024b0: 2077 616e 7420 7468 6573 652c 2065 7370   want these, esp
+000024c0: 6563 6961 6c6c 7920 6f6e 2073 6572 7665  ecially on serve
+000024d0: 7273 3a0a 0a2a 205b 636f 6e74 7269 622f  rs:..* [contrib/
+000024e0: 7379 7374 656d 642f 636f 7079 7061 7274  systemd/copypart
+000024f0: 792e 7365 7276 6963 655d 2863 6f6e 7472  y.service](contr
+00002500: 6962 2f73 7973 7465 6d64 2f63 6f70 7970  ib/systemd/copyp
+00002510: 6172 7479 2e73 6572 7669 6365 2920 746f  arty.service) to
+00002520: 2072 756e 2063 6f70 7970 6172 7479 2061   run copyparty a
+00002530: 7320 6120 7379 7374 656d 6420 7365 7276  s a systemd serv
+00002540: 6963 6520 2873 6565 2067 7569 6465 2069  ice (see guide i
+00002550: 6e73 6964 6529 0a2a 205b 636f 6e74 7269  nside).* [contri
+00002560: 622f 7379 7374 656d 642f 7072 6973 6f6e  b/systemd/prison
+00002570: 7061 7274 792e 7365 7276 6963 655d 2863  party.service](c
+00002580: 6f6e 7472 6962 2f73 7973 7465 6d64 2f70  ontrib/systemd/p
+00002590: 7269 736f 6e70 6172 7479 2e73 6572 7669  risonparty.servi
+000025a0: 6365 2920 746f 2072 756e 2069 7420 696e  ce) to run it in
+000025b0: 2061 2063 6872 6f6f 7420 2866 6f72 2065   a chroot (for e
+000025c0: 7874 7261 2073 6563 7572 6974 7929 0a2a  xtra security).*
+000025d0: 205b 636f 6e74 7269 622f 7263 2f63 6f70   [contrib/rc/cop
+000025e0: 7970 6172 7479 5d28 636f 6e74 7269 622f  yparty](contrib/
+000025f0: 7263 2f63 6f70 7970 6172 7479 2920 746f  rc/copyparty) to
+00002600: 2072 756e 2063 6f70 7970 6172 7479 206f   run copyparty o
+00002610: 6e20 4672 6565 4253 440a 2a20 5b63 6f6e  n FreeBSD.* [con
+00002620: 7472 6962 2f6e 6769 6e78 2f63 6f70 7970  trib/nginx/copyp
+00002630: 6172 7479 2e63 6f6e 665d 2863 6f6e 7472  arty.conf](contr
+00002640: 6962 2f6e 6769 6e78 2f63 6f70 7970 6172  ib/nginx/copypar
+00002650: 7479 2e63 6f6e 6629 2074 6f20 5b72 6576  ty.conf) to [rev
+00002660: 6572 7365 2d70 726f 7879 5d28 2372 6576  erse-proxy](#rev
+00002670: 6572 7365 2d70 726f 7879 2920 6265 6869  erse-proxy) behi
+00002680: 6e64 206e 6769 6e78 2028 666f 7220 6265  nd nginx (for be
+00002690: 7474 6572 2068 7474 7073 290a 2a20 5b6e  tter https).* [n
+000026a0: 6978 6f73 206d 6f64 756c 655d 2823 6e69  ixos module](#ni
+000026b0: 786f 732d 6d6f 6475 6c65 2920 746f 2072  xos-module) to r
+000026c0: 756e 2063 6f70 7970 6172 7479 206f 6e20  un copyparty on 
+000026d0: 4e69 784f 5320 686f 7374 730a 0a61 6e64  NixOS hosts..and
+000026e0: 2072 656d 656d 6265 7220 746f 206f 7065   remember to ope
+000026f0: 6e20 7468 6520 706f 7274 7320 796f 7520  n the ports you 
+00002700: 7761 6e74 3b20 6865 7265 2773 2061 2063  want; here's a c
+00002710: 6f6d 706c 6574 6520 6578 616d 706c 6520  omplete example 
+00002720: 696e 636c 7564 696e 6720 6576 6572 7920  including every 
+00002730: 6665 6174 7572 6520 636f 7079 7061 7274  feature copypart
+00002740: 7920 6861 7320 746f 206f 6666 6572 3a0a  y has to offer:.
+00002750: 6060 600a 6669 7265 7761 6c6c 2d63 6d64  ```.firewall-cmd
+00002760: 202d 2d70 6572 6d61 6e65 6e74 202d 2d61   --permanent --a
+00002770: 6464 2d70 6f72 743d 7b38 302c 3434 332c  dd-port={80,443,
+00002780: 3339 3231 2c33 3932 332c 3339 3435 2c33  3921,3923,3945,3
+00002790: 3939 307d 2f74 6370 2020 2320 2d2d 7a6f  990}/tcp  # --zo
+000027a0: 6e65 3d6c 6962 7669 7274 0a66 6972 6577  ne=libvirt.firew
+000027b0: 616c 6c2d 636d 6420 2d2d 7065 726d 616e  all-cmd --perman
+000027c0: 656e 7420 2d2d 6164 642d 706f 7274 3d31  ent --add-port=1
+000027d0: 3230 3030 2d31 3230 3939 2f74 6370 202d  2000-12099/tcp -
+000027e0: 2d70 6572 6d61 6e65 6e74 2020 2320 2d2d  -permanent  # --
+000027f0: 7a6f 6e65 3d6c 6962 7669 7274 0a66 6972  zone=libvirt.fir
+00002800: 6577 616c 6c2d 636d 6420 2d2d 7065 726d  ewall-cmd --perm
+00002810: 616e 656e 7420 2d2d 6164 642d 706f 7274  anent --add-port
+00002820: 3d7b 3139 3030 2c35 3335 337d 2f75 6470  ={1900,5353}/udp
+00002830: 2020 2320 2d2d 7a6f 6e65 3d6c 6962 7669    # --zone=libvi
+00002840: 7274 0a66 6972 6577 616c 6c2d 636d 6420  rt.firewall-cmd 
+00002850: 2d2d 7265 6c6f 6164 0a60 6060 0a28 3139  --reload.```.(19
+00002860: 3030 3a73 7364 702c 2033 3932 313a 6674  00:ssdp, 3921:ft
+00002870: 702c 2033 3932 333a 6874 7470 2f68 7474  p, 3923:http/htt
+00002880: 7073 2c20 3339 3435 3a73 6d62 2c20 3339  ps, 3945:smb, 39
+00002890: 3930 3a66 7470 732c 2035 3335 333a 6d64  90:ftps, 5353:md
+000028a0: 6e73 2c20 3132 3030 303a 7061 7373 6976  ns, 12000:passiv
+000028b0: 652d 6674 7029 0a0a 0a23 2320 6665 6174  e-ftp)...## feat
+000028c0: 7572 6573 0a0a 2a20 6261 636b 656e 6420  ures..* backend 
+000028d0: 7374 7566 660a 2020 2a20 e298 9120 4950  stuff.  * ... IP
+000028e0: 7636 0a20 202a 20e2 9891 205b 6d75 6c74  v6.  * ... [mult
+000028f0: 6970 726f 6365 7373 696e 675d 2823 7065  iprocessing](#pe
+00002900: 7266 6f72 6d61 6e63 6529 2028 6163 7475  rformance) (actu
+00002910: 616c 206d 756c 7469 7468 7265 6164 696e  al multithreadin
+00002920: 6729 0a20 202a 20e2 9891 2076 6f6c 756d  g).  * ... volum
+00002930: 6573 2028 6d6f 756e 7470 6f69 6e74 7329  es (mountpoints)
+00002940: 0a20 202a 20e2 9891 205b 6163 636f 756e  .  * ... [accoun
+00002950: 7473 5d28 2361 6363 6f75 6e74 732d 616e  ts](#accounts-an
+00002960: 642d 766f 6c75 6d65 7329 0a20 202a 20e2  d-volumes).  * .
+00002970: 9891 205b 6674 7020 7365 7276 6572 5d28  .. [ftp server](
+00002980: 2366 7470 2d73 6572 7665 7229 0a20 202a  #ftp-server).  *
+00002990: 20e2 9891 205b 7765 6264 6176 2073 6572   ... [webdav ser
+000029a0: 7665 725d 2823 7765 6264 6176 2d73 6572  ver](#webdav-ser
+000029b0: 7665 7229 0a20 202a 20e2 9891 205b 736d  ver).  * ... [sm
+000029c0: 622f 6369 6673 2073 6572 7665 725d 2823  b/cifs server](#
+000029d0: 736d 622d 7365 7276 6572 290a 2020 2a20  smb-server).  * 
+000029e0: e298 9120 5b71 722d 636f 6465 5d28 2371  ... [qr-code](#q
+000029f0: 722d 636f 6465 2920 666f 7220 7175 6963  r-code) for quic
+00002a00: 6b20 6163 6365 7373 0a20 202a 20e2 9891  k access.  * ...
+00002a10: 205b 7570 6e70 202f 207a 6572 6f63 6f6e   [upnp / zerocon
+00002a20: 6620 2f20 6d64 6e73 202f 2073 7364 705d  f / mdns / ssdp]
+00002a30: 2823 7a65 726f 636f 6e66 290a 2020 2a20  (#zeroconf).  * 
+00002a40: e298 9120 5b65 7665 6e74 2068 6f6f 6b73  ... [event hooks
+00002a50: 5d28 2365 7665 6e74 2d68 6f6f 6b73 2920  ](#event-hooks) 
+00002a60: 2f20 7363 7269 7074 2072 756e 6e65 720a  / script runner.
+00002a70: 2020 2a20 e298 9120 5b72 6576 6572 7365    * ... [reverse
+00002a80: 2d70 726f 7879 2073 7570 706f 7274 5d28  -proxy support](
+00002a90: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+00002aa0: 6f6d 2f39 3030 312f 636f 7079 7061 7274  om/9001/copypart
+00002ab0: 7923 7265 7665 7273 652d 7072 6f78 7929  y#reverse-proxy)
+00002ac0: 0a2a 2075 706c 6f61 640a 2020 2a20 e298  .* upload.  * ..
+00002ad0: 9120 6261 7369 633a 2070 6c61 696e 206d  . basic: plain m
+00002ae0: 756c 7469 7061 7274 2c20 6965 3620 7375  ultipart, ie6 su
+00002af0: 7070 6f72 740a 2020 2a20 e298 9120 5b75  pport.  * ... [u
+00002b00: 7032 6b5d 2823 7570 6c6f 6164 696e 6729  p2k](#uploading)
+00002b10: 3a20 6a73 2c20 7265 7375 6d61 626c 652c  : js, resumable,
+00002b20: 206d 756c 7469 7468 7265 6164 6564 0a20   multithreaded. 
+00002b30: 2020 202a 2075 6e61 6666 6563 7465 6420     * unaffected 
+00002b40: 6279 2063 6c6f 7564 666c 6172 6527 7320  by cloudflare's 
+00002b50: 6d61 782d 7570 6c6f 6164 2d73 697a 6520  max-upload-size 
+00002b60: 2831 3030 204d 6942 290a 2020 2a20 e298  (100 MiB).  * ..
+00002b70: 9120 7374 6173 683a 2073 696d 706c 6520  . stash: simple 
+00002b80: 5055 5420 6669 6c65 6472 6f70 7065 720a  PUT filedropper.
+00002b90: 2020 2a20 e298 9120 6669 6c65 6e61 6d65    * ... filename
+00002ba0: 2072 616e 646f 6d69 7a65 720a 2020 2a20   randomizer.  * 
+00002bb0: e298 9120 7772 6974 652d 6f6e 6c79 2066  ... write-only f
+00002bc0: 6f6c 6465 7273 0a20 202a 20e2 9891 205b  olders.  * ... [
+00002bd0: 756e 706f 7374 5d28 2375 6e70 6f73 7429  unpost](#unpost)
+00002be0: 3a20 756e 646f 2f64 656c 6574 6520 6163  : undo/delete ac
+00002bf0: 6369 6465 6e74 616c 2075 706c 6f61 6473  cidental uploads
+00002c00: 0a20 202a 20e2 9891 205b 7365 6c66 2d64  .  * ... [self-d
+00002c10: 6573 7472 7563 745d 2823 7365 6c66 2d64  estruct](#self-d
+00002c20: 6573 7472 7563 7429 2028 7370 6563 6966  estruct) (specif
+00002c30: 6965 6420 7365 7276 6572 2d73 6964 6520  ied server-side 
+00002c40: 6f72 2063 6c69 656e 742d 7369 6465 290a  or client-side).
+00002c50: 2020 2a20 e298 9120 7379 6d6c 696e 6b2f    * ... symlink/
+00002c60: 6469 7363 6172 6420 6475 706c 6963 6174  discard duplicat
+00002c70: 6573 2028 636f 6e74 656e 742d 6d61 7463  es (content-matc
+00002c80: 6869 6e67 290a 2a20 646f 776e 6c6f 6164  hing).* download
+00002c90: 0a20 202a 20e2 9891 2073 696e 676c 6520  .  * ... single 
+00002ca0: 6669 6c65 7320 696e 2062 726f 7773 6572  files in browser
+00002cb0: 0a20 202a 20e2 9891 205b 666f 6c64 6572  .  * ... [folder
+00002cc0: 7320 6173 207a 6970 202f 2074 6172 2066  s as zip / tar f
+00002cd0: 696c 6573 5d28 237a 6970 2d64 6f77 6e6c  iles](#zip-downl
+00002ce0: 6f61 6473 290a 2020 2a20 e298 9120 5b46  oads).  * ... [F
+00002cf0: 5553 4520 636c 6965 6e74 5d28 6874 7470  USE client](http
+00002d00: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00002d10: 3030 312f 636f 7079 7061 7274 792f 7472  001/copyparty/tr
+00002d20: 6565 2f68 6f76 7564 7374 7261 756d 2f62  ee/hovudstraum/b
+00002d30: 696e 2370 6172 7479 6675 7365 7079 2920  in#partyfusepy) 
+00002d40: 2872 6561 642d 6f6e 6c79 290a 2a20 6272  (read-only).* br
+00002d50: 6f77 7365 720a 2020 2a20 e298 9120 5b6e  owser.  * ... [n
+00002d60: 6176 7061 6e65 5d28 236e 6176 7061 6e65  avpane](#navpane
+00002d70: 2920 2864 6972 6563 746f 7279 2074 7265  ) (directory tre
+00002d80: 6520 7369 6465 6261 7229 0a20 202a 20e2  e sidebar).  * .
+00002d90: 9891 2066 696c 6520 6d61 6e61 6765 7220  .. file manager 
+00002da0: 2863 7574 2f70 6173 7465 2c20 6465 6c65  (cut/paste, dele
+00002db0: 7465 2c20 5b62 6174 6368 2d72 656e 616d  te, [batch-renam
+00002dc0: 655d 2823 6261 7463 682d 7265 6e61 6d65  e](#batch-rename
+00002dd0: 2929 0a20 202a 20e2 9891 2061 7564 696f  )).  * ... audio
+00002de0: 2070 6c61 7965 7220 2877 6974 6820 5b4f   player (with [O
+00002df0: 5320 6d65 6469 6120 636f 6e74 726f 6c73  S media controls
+00002e00: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00002e10: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00002e20: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00002e30: 3332 2f32 3135 3334 3734 3932 2d62 3432  32/215347492-b42
+00002e40: 3530 3739 372d 3663 3930 2d34 6530 392d  50797-6c90-4e09-
+00002e50: 3961 3463 2d37 3231 6564 6632 6662 3135  9a4c-721edf2fb15
+00002e60: 632e 706e 6729 2061 6e64 206f 7075 7320  c.png) and opus 
+00002e70: 7472 616e 7363 6f64 696e 6729 0a20 202a  transcoding).  *
+00002e80: 20e2 9891 2069 6d61 6765 2067 616c 6c65   ... image galle
+00002e90: 7279 2077 6974 6820 7765 626d 2070 6c61  ry with webm pla
+00002ea0: 7965 720a 2020 2a20 e298 9120 7465 7874  yer.  * ... text
+00002eb0: 6669 6c65 2062 726f 7773 6572 2077 6974  file browser wit
+00002ec0: 6820 7379 6e74 6178 2068 696c 6967 6874  h syntax hilight
+00002ed0: 696e 670a 2020 2a20 e298 9120 5b74 6875  ing.  * ... [thu
+00002ee0: 6d62 6e61 696c 735d 2823 7468 756d 626e  mbnails](#thumbn
+00002ef0: 6169 6c73 290a 2020 2020 2a20 e298 9120  ails).    * ... 
+00002f00: 2e2e 2e6f 6620 696d 6167 6573 2075 7369  ...of images usi
+00002f10: 6e67 2050 696c 6c6f 772c 2070 7976 6970  ng Pillow, pyvip
+00002f20: 732c 206f 7220 4646 6d70 6567 0a20 2020  s, or FFmpeg.   
+00002f30: 202a 20e2 9891 202e 2e2e 6f66 2076 6964   * ... ...of vid
+00002f40: 656f 7320 7573 696e 6720 4646 6d70 6567  eos using FFmpeg
+00002f50: 0a20 2020 202a 20e2 9891 202e 2e2e 6f66  .    * ... ...of
+00002f60: 2061 7564 696f 2028 7370 6563 7472 6f67   audio (spectrog
+00002f70: 7261 6d73 2920 7573 696e 6720 4646 6d70  rams) using FFmp
+00002f80: 6567 0a20 2020 202a 20e2 9891 2063 6163  eg.    * ... cac
+00002f90: 6865 2065 7669 6374 696f 6e20 286d 6178  he eviction (max
+00002fa0: 2d61 6765 3b20 6d61 7962 6520 6d61 782d  -age; maybe max-
+00002fb0: 7369 7a65 2065 7665 6e74 7561 6c6c 7929  size eventually)
+00002fc0: 0a20 202a 20e2 9891 2053 5041 2028 6272  .  * ... SPA (br
+00002fd0: 6f77 7365 2077 6869 6c65 2075 706c 6f61  owse while uploa
+00002fe0: 6469 6e67 290a 2a20 7365 7276 6572 2069  ding).* server i
+00002ff0: 6e64 6578 696e 670a 2020 2a20 e298 9120  ndexing.  * ... 
+00003000: 5b6c 6f63 6174 6520 6669 6c65 7320 6279  [locate files by
+00003010: 2063 6f6e 7465 6e74 735d 2823 6669 6c65   contents](#file
+00003020: 2d73 6561 7263 6829 0a20 202a 20e2 9891  -search).  * ...
+00003030: 2073 6561 7263 6820 6279 206e 616d 652f   search by name/
+00003040: 7061 7468 2f64 6174 652f 7369 7a65 0a20  path/date/size. 
+00003050: 202a 20e2 9891 205b 7365 6172 6368 2062   * ... [search b
+00003060: 7920 4944 332d 7461 6773 2065 7463 2e5d  y ID3-tags etc.]
+00003070: 2823 7365 6172 6368 696e 6729 0a2a 2063  (#searching).* c
+00003080: 6c69 656e 7420 7375 7070 6f72 740a 2020  lient support.  
+00003090: 2a20 e298 9120 5b66 6f6c 6465 7220 7379  * ... [folder sy
+000030a0: 6e63 5d28 2366 6f6c 6465 722d 7379 6e63  nc](#folder-sync
+000030b0: 290a 2020 2a20 e298 9120 5b63 7572 6c2d  ).  * ... [curl-
+000030c0: 6672 6965 6e64 6c79 5d28 6874 7470 733a  friendly](https:
+000030d0: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+000030e0: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+000030f0: 636f 6d2f 3234 3130 3332 2f32 3135 3332  com/241032/21532
+00003100: 3236 3139 2d65 6135 6664 3630 362d 3336  2619-ea5fd606-36
+00003110: 3534 2d34 3061 642d 3934 6565 2d32 6263  54-40ad-94ee-2bc
+00003120: 3035 3836 3437 6262 322e 706e 6729 0a2a  058647bb2.png).*
+00003130: 206d 6172 6b64 6f77 6e0a 2020 2a20 e298   markdown.  * ..
+00003140: 9120 5b76 6965 7765 725d 2823 6d61 726b  . [viewer](#mark
+00003150: 646f 776e 2d76 6965 7765 7229 0a20 202a  down-viewer).  *
+00003160: 20e2 9891 2065 6469 746f 7220 2873 7572   ... editor (sur
+00003170: 6520 7768 7920 6e6f 7429 0a0a 5053 3a20  e why not)..PS: 
+00003180: 736f 6d65 7468 696e 6720 6d69 7373 696e  something missin
+00003190: 673f 2070 6f73 7420 616e 7920 6372 617a  g? post any craz
+000031a0: 7920 6964 6561 7320 796f 7527 7665 2067  y ideas you've g
+000031b0: 6f74 2061 7320 6120 5b66 6561 7475 7265  ot as a [feature
+000031c0: 2072 6571 7565 7374 5d28 6874 7470 733a   request](https:
+000031d0: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+000031e0: 312f 636f 7079 7061 7274 792f 6973 7375  1/copyparty/issu
+000031f0: 6573 2f6e 6577 3f61 7373 6967 6e65 6573  es/new?assignees
+00003200: 3d39 3030 3126 6c61 6265 6c73 3d65 6e68  =9001&labels=enh
+00003210: 616e 6365 6d65 6e74 2674 656d 706c 6174  ancement&templat
+00003220: 653d 6665 6174 7572 655f 7265 7175 6573  e=feature_reques
+00003230: 742e 6d64 2920 6f72 205b 6469 7363 7573  t.md) or [discus
+00003240: 7369 6f6e 5d28 6874 7470 733a 2f2f 6769  sion](https://gi
+00003250: 7468 7562 2e63 6f6d 2f39 3030 312f 636f  thub.com/9001/co
+00003260: 7079 7061 7274 792f 6469 7363 7573 7369  pyparty/discussi
+00003270: 6f6e 732f 6e65 773f 6361 7465 676f 7279  ons/new?category
+00003280: 3d69 6465 6173 2920 f09f a499 0a0a 0a23  =ideas) .......#
+00003290: 2320 7465 7374 696d 6f6e 6961 6c73 0a0a  # testimonials..
+000032a0: 736d 616c 6c20 636f 6c6c 6563 7469 6f6e  small collection
+000032b0: 206f 6620 7573 6572 2066 6565 6462 6163   of user feedbac
+000032c0: 6b0a 0a60 676f 6f64 2065 6e6f 7567 6860  k..`good enough`
+000032d0: 2c20 6073 7572 7072 6973 696e 676c 7920  , `surprisingly 
+000032e0: 636f 7272 6563 7460 2c20 6063 6572 7469  correct`, `certi
+000032f0: 6669 6564 2067 6f6f 6420 736f 6674 7761  fied good softwa
+00003300: 7265 602c 2060 6a75 7374 2077 6f72 6b73  re`, `just works
+00003310: 602c 2060 7768 7960 2c20 6077 6f77 2074  `, `why`, `wow t
+00003320: 6869 7320 6973 2062 6574 7465 7220 7468  his is better th
+00003330: 616e 206e 6578 7463 6c6f 7564 600a 0a0a  an nextcloud`...
+00003340: 2320 6d6f 7469 7661 7469 6f6e 730a 0a70  # motivations..p
+00003350: 726f 6a65 6374 2067 6f61 6c73 202f 2070  roject goals / p
+00003360: 6869 6c6f 736f 7068 790a 0a2a 2069 6e76  hilosophy..* inv
+00003370: 6572 7365 206c 696e 7578 2070 6869 6c6f  erse linux philo
+00003380: 736f 7068 7920 2d2d 2064 6f20 616c 6c20  sophy -- do all 
+00003390: 7468 6520 7468 696e 6773 2c20 616e 6420  the things, and 
+000033a0: 646f 2061 6e20 2a6f 6b61 792a 206a 6f62  do an *okay* job
+000033b0: 0a20 202a 2071 7569 636b 2064 726f 702d  .  * quick drop-
+000033c0: 696e 2073 6572 7669 6365 2074 6f20 6765  in service to ge
+000033d0: 7420 6120 6c6f 7420 6f66 2066 6561 7475  t a lot of featu
+000033e0: 7265 7320 696e 2061 2070 696e 6368 0a20  res in a pinch. 
+000033f0: 202a 2073 6f6d 6520 6f66 205b 7468 6520   * some of [the 
+00003400: 616c 7465 726e 6174 6976 6573 5d28 2e2f  alternatives](./
+00003410: 646f 6373 2f76 6572 7375 732e 6d64 2920  docs/versus.md) 
+00003420: 6d69 6768 7420 6265 2061 2062 6574 7465  might be a bette
+00003430: 7220 6669 7420 666f 7220 796f 750a 2a20  r fit for you.* 
+00003440: 7275 6e20 616e 7977 6865 7265 2c20 7375  run anywhere, su
+00003450: 7070 6f72 7420 6576 6572 7974 6869 6e67  pport everything
+00003460: 0a20 202a 2061 7320 6d61 6e79 2077 6562  .  * as many web
+00003470: 2d62 726f 7773 6572 7320 616e 6420 7079  -browsers and py
+00003480: 7468 6f6e 2076 6572 7369 6f6e 7320 6173  thon versions as
+00003490: 2070 6f73 7369 626c 650a 2020 2020 2a20   possible.    * 
+000034a0: 6576 6572 7920 6272 6f77 7365 7220 7368  every browser sh
+000034b0: 6f75 6c64 2061 7420 6c65 6173 7420 6265  ould at least be
+000034c0: 2061 626c 6520 746f 2062 726f 7773 652c   able to browse,
+000034d0: 2064 6f77 6e6c 6f61 642c 2075 706c 6f61   download, uploa
+000034e0: 6420 6669 6c65 730a 2020 2020 2a20 6265  d files.    * be
+000034f0: 2061 2067 6f6f 6420 656d 6572 6765 6e63   a good emergenc
+00003500: 7920 736f 6c75 7469 6f6e 2066 6f72 2074  y solution for t
+00003510: 7261 6e73 6665 7272 696e 6720 7374 7566  ransferring stuf
+00003520: 6620 6265 7477 6565 6e20 616e 6369 656e  f between ancien
+00003530: 7420 626f 7865 730a 2020 2a20 6d69 6e69  t boxes.  * mini
+00003540: 6d61 6c20 6465 7065 6e64 656e 6369 6573  mal dependencies
+00003550: 0a20 2020 202a 2062 7574 206f 7074 696f  .    * but optio
+00003560: 6e61 6c20 6465 7065 6e64 656e 6369 6573  nal dependencies
+00003570: 2061 6464 696e 6720 626f 6e75 732d 6665   adding bonus-fe
+00003580: 6174 7572 6573 2061 7265 206f 6b0a 2020  atures are ok.  
+00003590: 2020 2a20 6576 6572 7974 6869 6e67 2062    * everything b
+000035a0: 6569 6e67 2070 6c61 696e 7465 7874 206d  eing plaintext m
+000035b0: 616b 6573 2069 7420 706f 7373 6962 6c65  akes it possible
+000035c0: 2074 6f20 7072 6f6f 6672 6561 6420 666f   to proofread fo
+000035d0: 7220 6d61 6c69 6369 6f75 7320 636f 6465  r malicious code
+000035e0: 0a20 202a 206e 6f20 7072 6570 6172 6174  .  * no preparat
+000035f0: 696f 6e73 202f 2073 6574 7570 206e 6563  ions / setup nec
+00003600: 6573 7361 7279 2c20 6a75 7374 2072 756e  essary, just run
+00003610: 2074 6865 2073 6678 2028 7768 6963 6820   the sfx (which 
+00003620: 6973 2061 6c73 6f20 706c 6169 6e74 6578  is also plaintex
+00003630: 7429 0a2a 2061 6461 7074 6162 6c65 2c20  t).* adaptable, 
+00003640: 6d61 6c6c 6561 626c 652c 2068 6163 6b61  malleable, hacka
+00003650: 626c 650a 2020 2a20 6e6f 2062 7569 6c64  ble.  * no build
+00003660: 2073 7465 7073 3b20 6d6f 6469 6679 2074   steps; modify t
+00003670: 6865 206a 732f 7079 7468 6f6e 2077 6974  he js/python wit
+00003680: 686f 7574 206e 6565 6469 6e67 206e 6f64  hout needing nod
+00003690: 652e 6a73 206f 7220 616e 7974 6869 6e67  e.js or anything
+000036a0: 206c 696b 6520 7468 6174 0a0a 0a23 2320   like that...## 
+000036b0: 6e6f 7465 730a 0a67 656e 6572 616c 206e  notes..general n
+000036c0: 6f74 6573 3a0a 2a20 7061 7065 722d 7072  otes:.* paper-pr
+000036d0: 696e 7469 6e67 2069 7320 6166 6665 6374  inting is affect
+000036e0: 6564 2062 7920 6461 726b 2f6c 6967 6874  ed by dark/light
+000036f0: 2d6d 6f64 6521 2075 7365 206c 6967 6874  -mode! use light
+00003700: 6d6f 6465 2066 6f72 2063 6f6c 6f72 2c20  mode for color, 
+00003710: 6461 726b 6d6f 6465 2066 6f72 2067 7261  darkmode for gra
+00003720: 7973 6361 6c65 0a20 202a 2062 6563 6175  yscale.  * becau
+00003730: 7365 206e 6f20 6272 6f77 7365 7273 2063  se no browsers c
+00003740: 7572 7265 6e74 6c79 2069 6d70 6c65 6d65  urrently impleme
+00003750: 6e74 2074 6865 206d 6564 6961 2d71 7565  nt the media-que
+00003760: 7279 2074 6f20 646f 2074 6869 7320 7072  ry to do this pr
+00003770: 6f70 6572 6c79 206f 727a 0a0a 6272 6f77  operly orz..brow
+00003780: 7365 722d 7370 6563 6966 6963 3a0a 2a20  ser-specific:.* 
+00003790: 6950 686f 6e65 2f69 5061 643a 2075 7365  iPhone/iPad: use
+000037a0: 2046 6972 6566 6f78 2074 6f20 646f 776e   Firefox to down
+000037b0: 6c6f 6164 2066 696c 6573 0a2a 2041 6e64  load files.* And
+000037c0: 726f 6964 2d43 6872 6f6d 653a 2069 6e63  roid-Chrome: inc
+000037d0: 7265 6173 6520 2270 6172 616c 6c65 6c20  rease "parallel 
+000037e0: 7570 6c6f 6164 7322 2066 6f72 2068 6967  uploads" for hig
+000037f0: 6865 7220 7370 6565 6420 2861 6e64 726f  her speed (andro
+00003800: 6964 2062 7567 290a 2a20 416e 6472 6f69  id bug).* Androi
+00003810: 642d 4669 7265 666f 783a 2074 616b 6573  d-Firefox: takes
+00003820: 2061 2077 6869 6c65 2074 6f20 7365 6c65   a while to sele
+00003830: 6374 2066 696c 6573 2028 7468 6569 7220  ct files (their 
+00003840: 6669 7820 666f 7220 e298 9def b88f 290a  fix for ......).
+00003850: 2a20 4465 736b 746f 702d 4669 7265 666f  * Desktop-Firefo
+00003860: 783a 207e 7e6d 6179 2075 7365 2067 6967  x: ~~may use gig
+00003870: 6162 7974 6573 206f 6620 5241 4d20 6966  abytes of RAM if
+00003880: 2079 6f75 7220 6669 6c65 7320 6172 6520   your files are 
+00003890: 6d61 7373 6976 657e 7e20 2a73 6565 6d73  massive~~ *seems
+000038a0: 2074 6f20 6265 204f 4b20 6e6f 772a 0a2a   to be OK now*.*
+000038b0: 2044 6573 6b74 6f70 2d46 6972 6566 6f78   Desktop-Firefox
+000038c0: 3a20 5b6d 6179 2073 746f 7020 796f 7520  : [may stop you 
+000038d0: 6672 6f6d 2075 6e70 6c75 6767 696e 6720  from unplugging 
+000038e0: 5553 4220 666c 6173 6864 7269 7665 735d  USB flashdrives]
+000038f0: 2868 7474 7073 3a2f 2f62 7567 7a69 6c6c  (https://bugzill
+00003900: 612e 6d6f 7a69 6c6c 612e 6f72 672f 7368  a.mozilla.org/sh
+00003910: 6f77 5f62 7567 2e63 6769 3f69 643d 3137  ow_bug.cgi?id=17
+00003920: 3932 3539 3829 2075 6e74 696c 2079 6f75  92598) until you
+00003930: 2076 6973 6974 2060 6162 6f75 743a 6d65   visit `about:me
+00003940: 6d6f 7279 6020 616e 6420 636c 6963 6b20  mory` and click 
+00003950: 604d 696e 696d 697a 6520 6d65 6d6f 7279  `Minimize memory
+00003960: 2075 7361 6765 600a 0a73 6572 7665 722d   usage`..server-
+00003970: 6f73 2d73 7065 6369 6669 633a 0a2a 2052  os-specific:.* R
+00003980: 4845 4c38 202f 2052 6f63 6b79 383a 2079  HEL8 / Rocky8: y
+00003990: 6f75 2063 616e 2072 756e 2063 6f70 7970  ou can run copyp
+000039a0: 6172 7479 2075 7369 6e67 2060 2f75 7372  arty using `/usr
+000039b0: 2f6c 6962 6578 6563 2f70 6c61 7466 6f72  /libexec/platfor
+000039c0: 6d2d 7079 7468 6f6e 600a 0a73 6572 7665  m-python`..serve
+000039d0: 7220 6e6f 7465 733a 0a2a 2070 7970 7920  r notes:.* pypy 
+000039e0: 6973 2073 7570 706f 7274 6564 2062 7574  is supported but
+000039f0: 2072 6567 756c 6172 2063 7079 7468 6f6e   regular cpython
+00003a00: 2069 7320 6661 7374 6572 2069 6620 796f   is faster if yo
+00003a10: 7520 656e 6162 6c65 2074 6865 2064 6174  u enable the dat
+00003a20: 6162 6173 650a 0a0a 2320 6275 6773 0a0a  abase...# bugs..
+00003a30: 2a20 5769 6e64 6f77 733a 2070 7974 686f  * Windows: pytho
+00003a40: 6e20 322e 3720 6361 6e6e 6f74 2069 6e64  n 2.7 cannot ind
+00003a50: 6578 206e 6f6e 2d61 7363 6969 2066 696c  ex non-ascii fil
+00003a60: 656e 616d 6573 2077 6974 6820 602d 6532  enames with `-e2
+00003a70: 6460 0a2a 2057 696e 646f 7773 3a20 7079  d`.* Windows: py
+00003a80: 7468 6f6e 2032 2e37 2063 616e 6e6f 7420  thon 2.7 cannot 
+00003a90: 6861 6e64 6c65 2066 696c 656e 616d 6573  handle filenames
+00003aa0: 2077 6974 6820 6d6f 6a69 6261 6b65 0a2a   with mojibake.*
+00003ab0: 2060 2d2d 7468 2d66 662d 6a70 6760 206d   `--th-ff-jpg` m
+00003ac0: 6179 2066 6978 2076 6964 656f 2074 6875  ay fix video thu
+00003ad0: 6d62 6e61 696c 7320 6f6e 2073 6f6d 6520  mbnails on some 
+00003ae0: 4646 6d70 6567 2076 6572 7369 6f6e 7320  FFmpeg versions 
+00003af0: 286d 6163 6f73 2c20 736f 6d65 206c 696e  (macos, some lin
+00003b00: 7578 290a 2a20 602d 2d74 682d 6666 2d73  ux).* `--th-ff-s
+00003b10: 7772 6020 6d61 7920 6669 7820 6175 6469  wr` may fix audi
+00003b20: 6f20 7468 756d 626e 6169 6c73 206f 6e20  o thumbnails on 
+00003b30: 736f 6d65 2046 466d 7065 6720 7665 7273  some FFmpeg vers
+00003b40: 696f 6e73 0a0a 2323 2067 656e 6572 616c  ions..## general
+00003b50: 2062 7567 730a 0a2a 2057 696e 646f 7773   bugs..* Windows
+00003b60: 3a20 6966 2074 6865 2060 7570 326b 2e64  : if the `up2k.d
+00003b70: 6260 2028 6669 6c65 7379 7374 656d 2069  b` (filesystem i
+00003b80: 6e64 6578 2920 6973 206f 6e20 6120 7361  ndex) is on a sa
+00003b90: 6d62 612d 7368 6172 6520 6f72 206e 6574  mba-share or net
+00003ba0: 776f 726b 2064 6973 6b2c 2079 6f75 276c  work disk, you'l
+00003bb0: 6c20 6765 7420 756e 7072 6564 6963 7461  l get unpredicta
+00003bc0: 626c 6520 6265 6861 7669 6f72 2069 6620  ble behavior if 
+00003bd0: 7468 6520 7368 6172 6520 6973 2064 6973  the share is dis
+00003be0: 636f 6e6e 6563 7465 6420 666f 7220 6120  connected for a 
+00003bf0: 6269 740a 2020 2a20 7573 6520 602d 2d68  bit.  * use `--h
+00003c00: 6973 7460 206f 7220 7468 6520 6068 6973  ist` or the `his
+00003c10: 7460 2076 6f6c 666c 6167 2028 602d 7620  t` volflag (`-v 
+00003c20: 5b2e 2e2e 5d3a 632c 6869 7374 3d2f 746d  [...]:c,hist=/tm
+00003c30: 702f 666f 6f60 2920 746f 2070 6c61 6365  p/foo`) to place
+00003c40: 2074 6865 2064 6220 6f6e 2061 206c 6f63   the db on a loc
+00003c50: 616c 2064 6973 6b20 696e 7374 6561 640a  al disk instead.
+00003c60: 2a20 616c 6c20 766f 6c75 6d65 7320 6d75  * all volumes mu
+00003c70: 7374 2065 7869 7374 202f 2062 6520 6176  st exist / be av
+00003c80: 6169 6c61 626c 6520 6f6e 2073 7461 7274  ailable on start
+00003c90: 7570 3b20 7570 326b 2028 6d74 7020 6573  up; up2k (mtp es
+00003ca0: 7065 6369 616c 6c79 2920 6765 7473 2066  pecially) gets f
+00003cb0: 756e 6b79 206f 7468 6572 7769 7365 0a2a  unky otherwise.*
+00003cc0: 2070 726f 6261 626c 7920 6d6f 7265 2c20   probably more, 
+00003cd0: 706c 7320 6c65 7420 6d65 206b 6e6f 770a  pls let me know.
+00003ce0: 0a23 2320 6e6f 7420 6d79 2062 7567 730a  .## not my bugs.
+00003cf0: 0a2a 205b 4368 726f 6d65 2069 7373 7565  .* [Chrome issue
+00003d00: 2031 3331 3730 3639 5d28 6874 7470 733a   1317069](https:
+00003d10: 2f2f 6275 6773 2e63 6872 6f6d 6975 6d2e  //bugs.chromium.
+00003d20: 6f72 672f 702f 6368 726f 6d69 756d 2f69  org/p/chromium/i
+00003d30: 7373 7565 732f 6465 7461 696c 3f69 643d  ssues/detail?id=
+00003d40: 3133 3137 3036 3929 202d 2d20 6966 2079  1317069) -- if y
+00003d50: 6f75 2074 7279 2074 6f20 7570 6c6f 6164  ou try to upload
+00003d60: 2061 2066 6f6c 6465 7220 7768 6963 6820   a folder which 
+00003d70: 636f 6e74 6169 6e73 2073 796d 6c69 6e6b  contains symlink
+00003d80: 7320 6279 2064 7261 6767 696e 6720 6974  s by dragging it
+00003d90: 2069 6e74 6f20 7468 6520 6272 6f77 7365   into the browse
+00003da0: 722c 2074 6865 2073 796d 6c69 6e6b 6564  r, the symlinked
+00003db0: 2066 696c 6573 2077 696c 6c20 6e6f 7420   files will not 
+00003dc0: 6765 7420 7570 6c6f 6164 6564 0a0a 2a20  get uploaded..* 
+00003dd0: 5b43 6872 6f6d 6520 6973 7375 6520 3133  [Chrome issue 13
+00003de0: 3532 3231 305d 2868 7474 7073 3a2f 2f62  52210](https://b
+00003df0: 7567 732e 6368 726f 6d69 756d 2e6f 7267  ugs.chromium.org
+00003e00: 2f70 2f63 6872 6f6d 6975 6d2f 6973 7375  /p/chromium/issu
+00003e10: 6573 2f64 6574 6169 6c3f 6964 3d31 3335  es/detail?id=135
+00003e20: 3232 3130 2920 2d2d 2070 6c61 696e 7465  2210) -- plainte
+00003e30: 7874 2068 7474 7020 6d61 7920 6265 2066  xt http may be f
+00003e40: 6173 7465 7220 6174 2066 696c 6568 6173  aster at filehas
+00003e50: 6869 6e67 2074 6861 6e20 6874 7470 7320  hing than https 
+00003e60: 2862 7574 2061 6c73 6f20 6578 7472 656d  (but also extrem
+00003e70: 656c 7920 4350 552d 696e 7465 6e73 6976  ely CPU-intensiv
+00003e80: 6529 0a0a 2a20 5b46 6972 6566 6f78 2069  e)..* [Firefox i
+00003e90: 7373 7565 2031 3739 3035 3030 5d28 6874  ssue 1790500](ht
+00003ea0: 7470 733a 2f2f 6275 677a 696c 6c61 2e6d  tps://bugzilla.m
+00003eb0: 6f7a 696c 6c61 2e6f 7267 2f73 686f 775f  ozilla.org/show_
+00003ec0: 6275 672e 6367 693f 6964 3d31 3739 3035  bug.cgi?id=17905
+00003ed0: 3030 2920 2d2d 2065 6e74 6972 6520 6272  00) -- entire br
+00003ee0: 6f77 7365 7220 6361 6e20 6372 6173 6820  owser can crash 
+00003ef0: 6166 7465 7220 7570 6c6f 6164 696e 6720  after uploading 
+00003f00: 7e34 3030 3020 736d 616c 6c20 6669 6c65  ~4000 small file
+00003f10: 730a 0a2a 2041 6e64 726f 6964 3a20 6d75  s..* Android: mu
+00003f20: 7369 6320 706c 6179 6261 636b 2072 616e  sic playback ran
+00003f30: 646f 6d6c 7920 7374 6f70 7320 6475 6520  domly stops due 
+00003f40: 746f 205b 6261 7474 6572 7920 7573 6167  to [battery usag
+00003f50: 6520 7365 7474 696e 6773 5d28 2366 6978  e settings](#fix
+00003f60: 2d75 6e72 656c 6961 626c 652d 706c 6179  -unreliable-play
+00003f70: 6261 636b 2d6f 6e2d 616e 6472 6f69 6429  back-on-android)
+00003f80: 0a0a 2a20 6950 686f 6e65 733a 2074 6865  ..* iPhones: the
+00003f90: 2076 6f6c 756d 6520 636f 6e74 726f 6c20   volume control 
+00003fa0: 646f 6573 6e27 7420 776f 726b 2062 6563  doesn't work bec
+00003fb0: 6175 7365 205b 6170 706c 6520 646f 6573  ause [apple does
+00003fc0: 6e27 7420 7761 6e74 2069 7420 746f 5d28  n't want it to](
+00003fd0: 6874 7470 733a 2f2f 6465 7665 6c6f 7065  https://develope
+00003fe0: 722e 6170 706c 652e 636f 6d2f 6c69 6272  r.apple.com/libr
+00003ff0: 6172 792f 6172 6368 6976 652f 646f 6375  ary/archive/docu
+00004000: 6d65 6e74 6174 696f 6e2f 4175 6469 6f56  mentation/AudioV
+00004010: 6964 656f 2f43 6f6e 6365 7074 7561 6c2f  ideo/Conceptual/
+00004020: 5573 696e 675f 4854 4d4c 355f 4175 6469  Using_HTML5_Audi
+00004030: 6f5f 5669 6465 6f2f 4465 7669 6365 2d53  o_Video/Device-S
+00004040: 7065 6369 6669 6343 6f6e 7369 6465 7261  pecificConsidera
+00004050: 7469 6f6e 732f 4465 7669 6365 2d53 7065  tions/Device-Spe
+00004060: 6369 6669 6343 6f6e 7369 6465 7261 7469  cificConsiderati
+00004070: 6f6e 732e 6874 6d6c 232f 2f61 7070 6c65  ons.html#//apple
+00004080: 5f72 6566 2f64 6f63 2f75 6964 2f54 5034  _ref/doc/uid/TP4
+00004090: 3030 3039 3532 332d 4348 352d 5357 3131  0009523-CH5-SW11
+000040a0: 290a 2020 2a20 2a66 7574 7572 6520 776f  ).  * *future wo
+000040b0: 726b 6172 6f75 6e64 3a2a 2065 6e61 626c  rkaround:* enabl
+000040c0: 6520 7468 6520 6571 7561 6c69 7a65 722c  e the equalizer,
+000040d0: 206d 616b 6520 6974 2061 6c6c 2d7a 6572   make it all-zer
+000040e0: 6f2c 2061 6e64 2073 6574 2061 206e 6567  o, and set a neg
+000040f0: 6174 6976 6520 626f 6f73 7420 746f 2072  ative boost to r
+00004100: 6564 7563 6520 7468 6520 766f 6c75 6d65  educe the volume
+00004110: 0a20 2020 202a 2022 6675 7475 7265 2220  .    * "future" 
+00004120: 6265 6361 7573 6520 6041 7564 696f 436f  because `AudioCo
+00004130: 6e74 6578 7460 2063 616e 2774 206d 6169  ntext` can't mai
+00004140: 6e74 6169 6e20 6120 7374 6162 6c65 2070  ntain a stable p
+00004150: 6c61 7962 6163 6b20 7370 6565 6420 696e  layback speed in
+00004160: 2074 6865 2063 7572 7265 6e74 2069 4f53   the current iOS
+00004170: 2076 6572 7369 6f6e 2028 3135 2e37 292c   version (15.7),
+00004180: 206d 6179 6265 206f 6e65 2064 6179 2e2e   maybe one day..
+00004190: 2e0a 0a2a 2057 696e 646f 7773 3a20 666f  ...* Windows: fo
+000041a0: 6c64 6572 7320 6361 6e6e 6f74 2062 6520  lders cannot be 
+000041b0: 6163 6365 7373 6564 2069 6620 7468 6520  accessed if the 
+000041c0: 6e61 6d65 2065 6e64 7320 7769 7468 2060  name ends with `
+000041d0: 2e60 0a20 202a 2070 7974 686f 6e20 6f72  .`.  * python or
+000041e0: 2077 696e 646f 7773 2062 7567 0a0a 2a20   windows bug..* 
+000041f0: 5769 6e64 6f77 733a 206d 7379 7332 2d70  Windows: msys2-p
+00004200: 7974 686f 6e20 332e 382e 3620 6f63 6361  ython 3.8.6 occa
+00004210: 7369 6f6e 616c 6c79 2074 6872 6f77 7320  sionally throws 
+00004220: 6052 756e 7469 6d65 4572 726f 723a 2072  `RuntimeError: r
+00004230: 656c 6561 7365 2075 6e6c 6f63 6b65 6420  elease unlocked 
+00004240: 6c6f 636b 6020 7768 656e 206c 6561 7669  lock` when leavi
+00004250: 6e67 2061 2073 636f 7065 6420 6d75 7465  ng a scoped mute
+00004260: 7820 696e 2075 7032 6b0a 2020 2a20 7468  x in up2k.  * th
+00004270: 6973 2069 7320 616e 206d 7379 7332 2062  is is an msys2 b
+00004280: 7567 2c20 7468 6520 7265 6775 6c61 7220  ug, the regular 
+00004290: 7769 6e64 6f77 7320 6564 6974 696f 6e20  windows edition 
+000042a0: 6f66 2070 7974 686f 6e20 6973 2066 696e  of python is fin
+000042b0: 650a 0a2a 2056 6972 7475 616c 426f 783a  e..* VirtualBox:
+000042c0: 2073 716c 6974 6520 7468 726f 7773 2060   sqlite throws `
+000042d0: 4469 736b 2049 2f4f 2045 7272 6f72 6020  Disk I/O Error` 
+000042e0: 7768 656e 2072 756e 6e69 6e67 2069 6e20  when running in 
+000042f0: 6120 564d 2061 6e64 2074 6865 2075 7032  a VM and the up2
+00004300: 6b20 6461 7461 6261 7365 2069 7320 696e  k database is in
+00004310: 2061 2076 626f 7873 660a 2020 2a20 7573   a vboxsf.  * us
+00004320: 6520 602d 2d68 6973 7460 206f 7220 7468  e `--hist` or th
+00004330: 6520 6068 6973 7460 2076 6f6c 666c 6167  e `hist` volflag
+00004340: 2028 602d 7620 5b2e 2e2e 5d3a 632c 6869   (`-v [...]:c,hi
+00004350: 7374 3d2f 746d 702f 666f 6f60 2920 746f  st=/tmp/foo`) to
+00004360: 2070 6c61 6365 2074 6865 2064 6220 696e   place the db in
+00004370: 7369 6465 2074 6865 2076 6d20 696e 7374  side the vm inst
+00004380: 6561 640a 0a2a 2055 6275 6e74 753a 2064  ead..* Ubuntu: d
+00004390: 7261 6767 696e 6720 6669 6c65 7320 6672  ragging files fr
+000043a0: 6f6d 2063 6572 7461 696e 2066 6f6c 6465  om certain folde
+000043b0: 7273 2069 6e74 6f20 6669 7265 666f 7820  rs into firefox 
+000043c0: 6f72 2063 6872 6f6d 6520 6973 2069 6d70  or chrome is imp
+000043d0: 6f73 7369 626c 650a 2020 2a20 6475 6520  ossible.  * due 
+000043e0: 746f 2073 6e61 7020 7365 6375 7269 7479  to snap security
+000043f0: 2070 6f6c 6963 6965 7320 2d2d 2073 6565   policies -- see
+00004400: 2060 736e 6170 2063 6f6e 6e65 6374 696f   `snap connectio
+00004410: 6e73 2066 6972 6566 6f78 6020 666f 7220  ns firefox` for 
+00004420: 7468 6520 616c 6c6f 776c 6973 742c 2060  the allowlist, `
+00004430: 7265 6d6f 7661 626c 652d 6d65 6469 6160  removable-media`
+00004440: 2070 6572 6d69 7473 2061 6c6c 206f 6620   permits all of 
+00004450: 602f 6d6e 7460 2061 6e64 2060 2f6d 6564  `/mnt` and `/med
+00004460: 6961 6020 6170 7061 7265 6e74 6c79 0a0a  ia` apparently..
+00004470: 0a23 2062 7265 616b 696e 6720 6368 616e  .# breaking chan
+00004480: 6765 730a 0a75 7067 7261 6465 206e 6f74  ges..upgrade not
+00004490: 6573 0a0a 2a20 6031 2e36 2e30 6020 2832  es..* `1.6.0` (2
+000044a0: 3032 332d 3031 2d32 3929 3a0a 2020 2a20  023-01-29):.  * 
+000044b0: 6874 7470 2d61 7069 3a20 6465 6c65 7465  http-api: delete
+000044c0: 2f6d 6f76 6520 6973 206e 6f77 2060 504f  /move is now `PO
+000044d0: 5354 6020 696e 7374 6561 6420 6f66 2060  ST` instead of `
+000044e0: 4745 5460 0a20 202a 2065 7665 7279 7468  GET`.  * everyth
+000044f0: 696e 6720 6f74 6865 7220 7468 616e 2060  ing other than `
+00004500: 4745 5460 2061 6e64 2060 4845 4144 6020  GET` and `HEAD` 
+00004510: 6d75 7374 2070 6173 7320 5b63 6f72 7320  must pass [cors 
+00004520: 7661 6c69 6461 7469 6f6e 5d28 2363 6f72  validation](#cor
+00004530: 7329 0a2a 2060 312e 352e 3060 2028 3230  s).* `1.5.0` (20
+00004540: 3232 2d31 322d 3033 293a 205b 6e65 7720  22-12-03): [new 
+00004550: 6368 756e 6b73 697a 6520 666f 726d 756c  chunksize formul
+00004560: 615d 2868 7474 7073 3a2f 2f67 6974 6875  a](https://githu
+00004570: 622e 636f 6d2f 3930 3031 2f63 6f70 7970  b.com/9001/copyp
+00004580: 6172 7479 2f63 6f6d 6d69 742f 3534 6531  arty/commit/54e1
+00004590: 6338 6432 3631 6466 2920 666f 7220 6669  c8d261df) for fi
+000045a0: 6c65 7320 6c61 7267 6572 2074 6861 6e20  les larger than 
+000045b0: 3132 3820 4769 420a 2020 2a20 2a2a 7573  128 GiB.  * **us
+000045c0: 6572 733a 2a2a 2075 7067 7261 6465 2074  ers:** upgrade t
+000045d0: 6f20 7468 6520 6c61 7465 7374 205b 636c  o the latest [cl
+000045e0: 6920 7570 6c6f 6164 6572 5d28 6874 7470  i uploader](http
+000045f0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00004600: 3030 312f 636f 7079 7061 7274 792f 626c  001/copyparty/bl
+00004610: 6f62 2f68 6f76 7564 7374 7261 756d 2f62  ob/hovudstraum/b
+00004620: 696e 2f75 7032 6b2e 7079 2920 6966 2079  in/up2k.py) if y
+00004630: 6f75 2075 7365 2074 6861 740a 2020 2a20  ou use that.  * 
+00004640: 2a2a 6465 7673 3a2a 2a20 7570 6461 7465  **devs:** update
+00004650: 2074 6869 7264 2d70 6172 7479 2075 7032   third-party up2
+00004660: 6b20 636c 6965 6e74 7320 2869 6620 7468  k clients (if th
+00004670: 6f73 6520 6576 656e 2065 7869 7374 290a  ose even exist).
+00004680: 0a0a 2320 4641 510a 0a22 6672 6571 7565  ..# FAQ.."freque
+00004690: 6e74 6c79 2220 6173 6b65 6420 7175 6573  ntly" asked ques
+000046a0: 7469 6f6e 730a 0a2a 2069 7320 6974 2070  tions..* is it p
+000046b0: 6f73 7369 626c 6520 746f 2062 6c6f 636b  ossible to block
+000046c0: 2072 6561 642d 6163 6365 7373 2074 6f20   read-access to 
+000046d0: 666f 6c64 6572 7320 756e 6c65 7373 2079  folders unless y
+000046e0: 6f75 206b 6e6f 7720 7468 6520 6578 6163  ou know the exac
+000046f0: 7420 5552 4c20 666f 7220 6120 7061 7274  t URL for a part
+00004700: 6963 756c 6172 2066 696c 6520 696e 7369  icular file insi
+00004710: 6465 3f0a 2020 2a20 7965 732c 2075 7369  de?.  * yes, usi
+00004720: 6e67 2074 6865 205b 6067 6020 7065 726d  ng the [`g` perm
+00004730: 6973 7369 6f6e 5d28 2361 6363 6f75 6e74  ission](#account
+00004740: 732d 616e 642d 766f 6c75 6d65 7329 2c20  s-and-volumes), 
+00004750: 7365 6520 7468 6520 6578 616d 706c 6573  see the examples
+00004760: 2074 6865 7265 0a20 202a 2079 6f75 2063   there.  * you c
+00004770: 616e 2061 6c73 6f20 646f 2074 6869 7320  an also do this 
+00004780: 7769 7468 206c 696e 7578 2066 696c 6573  with linux files
+00004790: 7973 7465 6d20 7065 726d 6973 7369 6f6e  ystem permission
+000047a0: 733b 2060 6368 6d6f 6420 3131 3120 6d75  s; `chmod 111 mu
+000047b0: 7369 6360 2077 696c 6c20 6d61 6b65 2069  sic` will make i
+000047c0: 7420 706f 7373 6962 6c65 2074 6f20 6163  t possible to ac
+000047d0: 6365 7373 2066 696c 6573 2061 6e64 2066  cess files and f
+000047e0: 6f6c 6465 7273 2069 6e73 6964 6520 7468  olders inside th
+000047f0: 6520 606d 7573 6963 6020 666f 6c64 6572  e `music` folder
+00004800: 2062 7574 206e 6f74 206c 6973 7420 7468   but not list th
+00004810: 6520 696d 6d65 6469 6174 6520 636f 6e74  e immediate cont
+00004820: 656e 7473 202d 2d20 616c 736f 2077 6f72  ents -- also wor
+00004830: 6b73 2077 6974 6820 6f74 6865 7220 736f  ks with other so
+00004840: 6674 7761 7265 2c20 6e6f 7420 6a75 7374  ftware, not just
+00004850: 2063 6f70 7970 6172 7479 0a0a 2a20 6361   copyparty..* ca
+00004860: 6e20 4920 6d61 6b65 2063 6f70 7970 6172  n I make copypar
+00004870: 7479 2064 6f77 6e6c 6f61 6420 6120 6669  ty download a fi
+00004880: 6c65 2074 6f20 6d79 2073 6572 7665 7220  le to my server 
+00004890: 6966 2049 2067 6976 6520 6974 2061 2055  if I give it a U
+000048a0: 524c 3f0a 2020 2a20 7965 732c 2075 7369  RL?.  * yes, usi
+000048b0: 6e67 205b 686f 6f6b 735d 2868 7474 7073  ng [hooks](https
+000048c0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+000048d0: 3031 2f63 6f70 7970 6172 7479 2f62 6c6f  01/copyparty/blo
+000048e0: 622f 686f 7675 6473 7472 6175 6d2f 6269  b/hovudstraum/bi
+000048f0: 6e2f 686f 6f6b 732f 7767 6574 2e70 7929  n/hooks/wget.py)
+00004900: 0a0a 0a23 2061 6363 6f75 6e74 7320 616e  ...# accounts an
+00004910: 6420 766f 6c75 6d65 730a 0a70 6572 2d66  d volumes..per-f
+00004920: 6f6c 6465 722c 2070 6572 2d75 7365 7220  older, per-user 
+00004930: 7065 726d 6973 7369 6f6e 7320 202d 2069  permissions  - i
+00004940: 6620 796f 7572 2073 6574 7570 2069 7320  f your setup is 
+00004950: 6765 7474 696e 6720 636f 6d70 6c65 782c  getting complex,
+00004960: 2063 6f6e 7369 6465 7220 6d61 6b69 6e67   consider making
+00004970: 2061 205b 636f 6e66 6967 2066 696c 655d   a [config file]
+00004980: 282e 2f64 6f63 732f 6578 616d 706c 652e  (./docs/example.
+00004990: 636f 6e66 2920 696e 7374 6561 6420 6f66  conf) instead of
+000049a0: 2075 7369 6e67 2061 7267 756d 656e 7473   using arguments
+000049b0: 0a2a 206d 7563 6820 6561 7369 6572 2074  .* much easier t
+000049c0: 6f20 6d61 6e61 6765 2c20 616e 6420 796f  o manage, and yo
+000049d0: 7520 6361 6e20 6d6f 6469 6679 2074 6865  u can modify the
+000049e0: 2063 6f6e 6669 6720 6174 2072 756e 7469   config at runti
+000049f0: 6d65 2077 6974 6820 6073 7973 7465 6d63  me with `systemc
+00004a00: 746c 2072 656c 6f61 6420 636f 7079 7061  tl reload copypa
+00004a10: 7274 7960 206f 7220 6d6f 7265 2063 6f6e  rty` or more con
+00004a20: 7665 6e69 656e 746c 7920 7573 696e 6720  veniently using 
+00004a30: 7468 6520 605b 7265 6c6f 6164 2063 6667  the `[reload cfg
+00004a40: 5d60 2062 7574 746f 6e20 696e 2074 6865  ]` button in the
+00004a50: 2063 6f6e 7472 6f6c 2d70 616e 656c 2028   control-panel (
+00004a60: 6966 206c 6f67 6765 6420 696e 2061 7320  if logged in as 
+00004a70: 6164 6d69 6e29 0a20 202a 2063 6861 6e67  admin).  * chang
+00004a80: 6573 2074 6f20 7468 6520 605b 676c 6f62  es to the `[glob
+00004a90: 616c 5d60 2063 6f6e 6669 6720 7365 6374  al]` config sect
+00004aa0: 696f 6e20 7265 7175 6972 6573 2061 2072  ion requires a r
+00004ab0: 6573 7461 7274 2074 6f20 7461 6b65 2065  estart to take e
+00004ac0: 6666 6563 740a 0a61 2071 7569 636b 2073  ffect..a quick s
+00004ad0: 756d 6d61 7279 2063 616e 2062 6520 7365  ummary can be se
+00004ae0: 656e 2075 7369 6e67 2060 2d2d 6865 6c70  en using `--help
+00004af0: 2d61 6363 6f75 6e74 7360 0a0a 636f 6e66  -accounts`..conf
+00004b00: 6967 7572 696e 6720 6163 636f 756e 7473  iguring accounts
+00004b10: 2f76 6f6c 756d 6573 2077 6974 6820 6172  /volumes with ar
+00004b20: 6775 6d65 6e74 733a 0a2a 2060 2d61 2075  guments:.* `-a u
+00004b30: 7372 3a70 7764 6020 6164 6473 2061 6363  sr:pwd` adds acc
+00004b40: 6f75 6e74 2060 7573 7260 2077 6974 6820  ount `usr` with 
+00004b50: 7061 7373 776f 7264 2060 7077 6460 0a2a  password `pwd`.*
+00004b60: 2060 2d76 202e 3a3a 7260 2061 6464 7320   `-v .::r` adds 
+00004b70: 6375 7272 656e 742d 666f 6c64 6572 2060  current-folder `
+00004b80: 2e60 2061 7320 7468 6520 7765 6272 6f6f  .` as the webroo
+00004b90: 742c 2060 7260 6561 6461 626c 6520 6279  t, `r`eadable by
+00004ba0: 2061 6e79 6f6e 650a 2020 2a20 7468 6520   anyone.  * the 
+00004bb0: 7379 6e74 6178 2069 7320 602d 7620 7372  syntax is `-v sr
+00004bc0: 633a 6473 743a 7065 726d 3a70 6572 6d3a  c:dst:perm:perm:
+00004bd0: 2e2e 2e60 2073 6f20 6c6f 6361 6c2d 7061  ...` so local-pa
+00004be0: 7468 2c20 7572 6c2d 7061 7468 2c20 616e  th, url-path, an
+00004bf0: 6420 6f6e 6520 6f72 206d 6f72 6520 7065  d one or more pe
+00004c00: 726d 6973 7369 6f6e 7320 746f 2073 6574  rmissions to set
+00004c10: 0a20 202a 2067 7261 6e74 696e 6720 7468  .  * granting th
+00004c20: 6520 7361 6d65 2070 6572 6d69 7373 696f  e same permissio
+00004c30: 6e73 2074 6f20 6d75 6c74 6970 6c65 2061  ns to multiple a
+00004c40: 6363 6f75 6e74 733a 2020 0a20 2020 2060  ccounts:  .    `
+00004c50: 2d76 202e 3a3a 722c 7573 7231 2c75 7372  -v .::r,usr1,usr
+00004c60: 323a 7277 2c75 7372 332c 7573 7234 6020  2:rw,usr3,usr4` 
+00004c70: 3d20 7573 7231 2f32 2072 6561 642d 6f6e  = usr1/2 read-on
+00004c80: 6c79 2c20 332f 3420 7265 6164 2d77 7269  ly, 3/4 read-wri
+00004c90: 7465 0a0a 7065 726d 6973 7369 6f6e 733a  te..permissions:
+00004ca0: 0a2a 2060 7260 2028 7265 6164 293a 2062  .* `r` (read): b
+00004cb0: 726f 7773 6520 666f 6c64 6572 2063 6f6e  rowse folder con
+00004cc0: 7465 6e74 732c 2064 6f77 6e6c 6f61 6420  tents, download 
+00004cd0: 6669 6c65 732c 2064 6f77 6e6c 6f61 6420  files, download 
+00004ce0: 6173 207a 6970 2f74 6172 0a2a 2060 7760  as zip/tar.* `w`
+00004cf0: 2028 7772 6974 6529 3a20 7570 6c6f 6164   (write): upload
+00004d00: 2066 696c 6573 2c20 6d6f 7665 2066 696c   files, move fil
+00004d10: 6573 202a 696e 746f 2a20 7468 6973 2066  es *into* this f
+00004d20: 6f6c 6465 720a 2a20 606d 6020 286d 6f76  older.* `m` (mov
+00004d30: 6529 3a20 6d6f 7665 2066 696c 6573 2f66  e): move files/f
+00004d40: 6f6c 6465 7273 202a 6672 6f6d 2a20 7468  olders *from* th
+00004d50: 6973 2066 6f6c 6465 720a 2a20 6064 6020  is folder.* `d` 
+00004d60: 2864 656c 6574 6529 3a20 6465 6c65 7465  (delete): delete
+00004d70: 2066 696c 6573 2f66 6f6c 6465 7273 0a2a   files/folders.*
+00004d80: 2060 6760 2028 6765 7429 3a20 6f6e 6c79   `g` (get): only
+00004d90: 2064 6f77 6e6c 6f61 6420 6669 6c65 732c   download files,
+00004da0: 2063 616e 6e6f 7420 7365 6520 666f 6c64   cannot see fold
+00004db0: 6572 2063 6f6e 7465 6e74 7320 6f72 207a  er contents or z
+00004dc0: 6970 2f74 6172 0a2a 2060 4760 2028 7570  ip/tar.* `G` (up
+00004dd0: 6765 7429 3a20 7361 6d65 2061 7320 6067  get): same as `g
+00004de0: 6020 6578 6365 7074 2075 706c 6f61 6465  ` except uploade
+00004df0: 7273 2067 6574 2074 6f20 7365 6520 7468  rs get to see th
+00004e00: 6569 7220 6f77 6e20 6669 6c65 6b65 7973  eir own filekeys
+00004e10: 2028 7365 6520 6066 6b60 2069 6e20 6578   (see `fk` in ex
+00004e20: 616d 706c 6573 2062 656c 6f77 290a 0a65  amples below)..e
+00004e30: 7861 6d70 6c65 733a 0a2a 2061 6464 2061  xamples:.* add a
+00004e40: 6363 6f75 6e74 7320 6e61 6d65 6420 7531  ccounts named u1
+00004e50: 2c20 7532 2c20 7533 2077 6974 6820 7061  , u2, u3 with pa
+00004e60: 7373 776f 7264 7320 7031 2c20 7032 2c20  sswords p1, p2, 
+00004e70: 7033 3a20 602d 6120 7531 3a70 3120 2d61  p3: `-a u1:p1 -a
+00004e80: 2075 323a 7032 202d 6120 7533 3a70 3360   u2:p2 -a u3:p3`
+00004e90: 0a2a 206d 616b 6520 666f 6c64 6572 2060  .* make folder `
+00004ea0: 2f73 7276 6020 7468 6520 726f 6f74 206f  /srv` the root o
+00004eb0: 6620 7468 6520 6669 6c65 7379 7374 656d  f the filesystem
+00004ec0: 2c20 7265 6164 2d6f 6e6c 7920 6279 2061  , read-only by a
+00004ed0: 6e79 6f6e 653a 2060 2d76 202f 7372 763a  nyone: `-v /srv:
+00004ee0: 3a72 600a 2a20 6d61 6b65 2066 6f6c 6465  :r`.* make folde
+00004ef0: 7220 602f 6d6e 742f 6d75 7369 6360 2061  r `/mnt/music` a
+00004f00: 7661 696c 6162 6c65 2061 7420 602f 6d75  vailable at `/mu
+00004f10: 7369 6360 2c20 7265 6164 2d6f 6e6c 7920  sic`, read-only 
+00004f20: 666f 7220 7531 2061 6e64 2075 322c 2072  for u1 and u2, r
+00004f30: 6561 642d 7772 6974 6520 666f 7220 7533  ead-write for u3
+00004f40: 3a20 602d 7620 2f6d 6e74 2f6d 7573 6963  : `-v /mnt/music
+00004f50: 3a6d 7573 6963 3a72 2c75 312c 7532 3a72  :music:r,u1,u2:r
+00004f60: 772c 7533 600a 2020 2a20 756e 6175 7468  w,u3`.  * unauth
+00004f70: 6f72 697a 6564 2075 7365 7273 2061 6363  orized users acc
+00004f80: 6573 7369 6e67 2074 6865 2077 6562 726f  essing the webro
+00004f90: 6f74 2063 616e 2073 6565 2074 6861 7420  ot can see that 
+00004fa0: 7468 6520 606d 7573 6963 6020 666f 6c64  the `music` fold
+00004fb0: 6572 2065 7869 7374 732c 2062 7574 2063  er exists, but c
+00004fc0: 616e 6e6f 7420 6f70 656e 2069 740a 2a20  annot open it.* 
+00004fd0: 6d61 6b65 2066 6f6c 6465 7220 602f 6d6e  make folder `/mn
+00004fe0: 742f 696e 636f 6d69 6e67 6020 6176 6169  t/incoming` avai
+00004ff0: 6c61 626c 6520 6174 2060 2f69 6e63 602c  lable at `/inc`,
+00005000: 2077 7269 7465 2d6f 6e6c 7920 666f 7220   write-only for 
+00005010: 7531 2c20 7265 6164 2d6d 6f76 6520 666f  u1, read-move fo
+00005020: 7220 7532 3a20 602d 7620 2f6d 6e74 2f69  r u2: `-v /mnt/i
+00005030: 6e63 6f6d 696e 673a 696e 633a 772c 7531  ncoming:inc:w,u1
+00005040: 3a72 6d2c 7532 600a 2020 2a20 756e 6175  :rm,u2`.  * unau
+00005050: 7468 6f72 697a 6564 2075 7365 7273 2061  thorized users a
+00005060: 6363 6573 7369 6e67 2074 6865 2077 6562  ccessing the web
+00005070: 726f 6f74 2063 616e 2073 6565 2074 6861  root can see tha
+00005080: 7420 7468 6520 6069 6e63 6020 666f 6c64  t the `inc` fold
+00005090: 6572 2065 7869 7374 732c 2062 7574 2063  er exists, but c
+000050a0: 616e 6e6f 7420 6f70 656e 2069 740a 2020  annot open it.  
+000050b0: 2a20 6075 3160 2063 616e 206f 7065 6e20  * `u1` can open 
+000050c0: 7468 6520 6069 6e63 6020 666f 6c64 6572  the `inc` folder
+000050d0: 2c20 6275 7420 6361 6e6e 6f74 2073 6565  , but cannot see
+000050e0: 2074 6865 2063 6f6e 7465 6e74 732c 206f   the contents, o
+000050f0: 6e6c 7920 7570 6c6f 6164 206e 6577 2066  nly upload new f
+00005100: 696c 6573 2074 6f20 6974 0a20 202a 2060  iles to it.  * `
+00005110: 7532 6020 6361 6e20 6272 6f77 7365 2069  u2` can browse i
+00005120: 7420 616e 6420 6d6f 7665 2066 696c 6573  t and move files
+00005130: 202a 6672 6f6d 2a20 602f 696e 6360 2069   *from* `/inc` i
+00005140: 6e74 6f20 616e 7920 666f 6c64 6572 2077  nto any folder w
+00005150: 6865 7265 2060 7532 6020 6861 7320 7772  here `u2` has wr
+00005160: 6974 652d 6163 6365 7373 0a2a 206d 616b  ite-access.* mak
+00005170: 6520 666f 6c64 6572 2060 2f6d 6e74 2f73  e folder `/mnt/s
+00005180: 7360 2061 7661 696c 6162 6c65 2061 7420  s` available at 
+00005190: 602f 6960 2c20 7265 6164 2d77 7269 7465  `/i`, read-write
+000051a0: 2066 6f72 2075 312c 2067 6574 2d6f 6e6c   for u1, get-onl
+000051b0: 7920 666f 7220 6576 6572 796f 6e65 2065  y for everyone e
+000051c0: 6c73 652c 2061 6e64 2065 6e61 626c 6520  lse, and enable 
+000051d0: 6669 6c65 6b65 7973 3a20 602d 7620 2f6d  filekeys: `-v /m
+000051e0: 6e74 2f73 733a 693a 7277 2c75 313a 673a  nt/ss:i:rw,u1:g:
+000051f0: 632c 666b 3d34 600a 2020 2a20 6063 2c66  c,fk=4`.  * `c,f
+00005200: 6b3d 3460 2073 6574 7320 7468 6520 6066  k=4` sets the `f
+00005210: 6b60 2028 6669 6c65 6b65 7929 2076 6f6c  k` (filekey) vol
+00005220: 666c 6167 2074 6f20 342c 206d 6561 6e69  flag to 4, meani
+00005230: 6e67 2065 6163 6820 6669 6c65 2067 6574  ng each file get
+00005240: 7320 6120 342d 6368 6172 6163 7465 7220  s a 4-character 
+00005250: 6163 6365 7373 6b65 790a 2020 2a20 6075  accesskey.  * `u
+00005260: 3160 2063 616e 2075 706c 6f61 6420 6669  1` can upload fi
+00005270: 6c65 732c 2062 726f 7773 6520 7468 6520  les, browse the 
+00005280: 666f 6c64 6572 2c20 616e 6420 7365 6520  folder, and see 
+00005290: 7468 6520 6765 6e65 7261 7465 6420 6669  the generated fi
+000052a0: 6c65 6b65 7973 0a20 202a 206f 7468 6572  lekeys.  * other
+000052b0: 2075 7365 7273 2063 616e 6e6f 7420 6272   users cannot br
+000052c0: 6f77 7365 2074 6865 2066 6f6c 6465 722c  owse the folder,
+000052d0: 2062 7574 2063 616e 2061 6363 6573 7320   but can access 
+000052e0: 7468 6520 6669 6c65 7320 6966 2074 6865  the files if the
+000052f0: 7920 6861 7665 2074 6865 2066 756c 6c20  y have the full 
+00005300: 6669 6c65 2055 524c 2077 6974 6820 7468  file URL with th
+00005310: 6520 6669 6c65 6b65 790a 2020 2a20 7265  e filekey.  * re
+00005320: 706c 6163 696e 6720 7468 6520 6067 6020  placing the `g` 
+00005330: 7065 726d 6973 7369 6f6e 2077 6974 6820  permission with 
+00005340: 6077 6760 2077 6f75 6c64 206c 6574 2061  `wg` would let a
+00005350: 6e6f 6e79 6d6f 7573 2075 7365 7273 2075  nonymous users u
+00005360: 706c 6f61 6420 6669 6c65 732c 2062 7574  pload files, but
+00005370: 206e 6f74 2073 6565 2074 6865 2072 6571   not see the req
+00005380: 7569 7265 6420 6669 6c65 6b65 7920 746f  uired filekey to
+00005390: 2061 6363 6573 7320 6974 0a20 202a 2072   access it.  * r
+000053a0: 6570 6c61 6369 6e67 2074 6865 2060 6760  eplacing the `g`
+000053b0: 2070 6572 6d69 7373 696f 6e20 7769 7468   permission with
+000053c0: 2060 7747 6020 776f 756c 6420 6c65 7420   `wG` would let 
+000053d0: 616e 6f6e 796d 6f75 7320 7573 6572 7320  anonymous users 
+000053e0: 7570 6c6f 6164 2066 696c 6573 2c20 7265  upload files, re
+000053f0: 6365 6976 696e 6720 6120 776f 726b 696e  ceiving a workin
+00005400: 6720 6469 7265 6374 206c 696e 6b20 696e  g direct link in
+00005410: 2072 6574 7572 6e0a 0a61 6e79 6f6e 6520   return..anyone 
+00005420: 7472 7969 6e67 2074 6f20 6272 7574 6566  trying to brutef
+00005430: 6f72 6365 2061 2070 6173 7377 6f72 6420  orce a password 
+00005440: 6765 7473 2062 616e 6e65 6420 6163 636f  gets banned acco
+00005450: 7264 696e 6720 746f 2060 2d2d 6261 6e2d  rding to `--ban-
+00005460: 7077 603b 2064 6566 6175 6c74 2069 7320  pw`; default is 
+00005470: 3234 6820 6261 6e20 666f 7220 3920 6661  24h ban for 9 fa
+00005480: 696c 6564 2061 7474 656d 7074 7320 696e  iled attempts in
+00005490: 2031 2068 6f75 720a 0a0a 2323 2073 6861   1 hour...## sha
+000054a0: 646f 7769 6e67 0a0a 6869 6469 6e67 2073  dowing..hiding s
+000054b0: 7065 6369 6669 6320 7375 6266 6f6c 6465  pecific subfolde
+000054c0: 7273 2020 6279 206d 6f75 6e74 696e 6720  rs  by mounting 
+000054d0: 616e 6f74 6865 7220 766f 6c75 6d65 206f  another volume o
+000054e0: 6e20 746f 7020 6f66 2074 6865 6d0a 0a66  n top of them..f
+000054f0: 6f72 2065 7861 6d70 6c65 2060 2d76 202f  or example `-v /
+00005500: 6d6e 743a 3a72 202d 7620 2f76 6172 2f65  mnt::r -v /var/e
+00005510: 6d70 7479 3a77 6562 2f63 6572 7473 3a72  mpty:web/certs:r
+00005520: 6020 6d6f 756e 7473 2074 6865 2073 6572  ` mounts the ser
+00005530: 7665 7220 666f 6c64 6572 2060 2f6d 6e74  ver folder `/mnt
+00005540: 6020 6173 2074 6865 2077 6562 726f 6f74  ` as the webroot
+00005550: 2c20 6275 7420 616e 6f74 6865 7220 766f  , but another vo
+00005560: 6c75 6d65 2069 7320 6d6f 756e 7465 6420  lume is mounted 
+00005570: 6174 2060 2f77 6562 2f63 6572 7473 6020  at `/web/certs` 
+00005580: 2d2d 2073 6f20 7669 7369 746f 7273 2063  -- so visitors c
+00005590: 616e 206f 6e6c 7920 7365 6520 7468 6520  an only see the 
+000055a0: 636f 6e74 656e 7473 206f 6620 602f 6d6e  contents of `/mn
+000055b0: 7460 2061 6e64 2060 2f6d 6e74 2f77 6562  t` and `/mnt/web
+000055c0: 6020 2861 7420 5552 4c73 2060 2f60 2061  ` (at URLs `/` a
+000055d0: 6e64 2060 2f77 6562 6029 2c20 6275 7420  nd `/web`), but 
+000055e0: 6e6f 7420 602f 6d6e 742f 7765 622f 6365  not `/mnt/web/ce
+000055f0: 7274 7360 2062 6563 6175 7365 2055 524c  rts` because URL
+00005600: 2060 2f77 6562 2f63 6572 7473 6020 6973   `/web/certs` is
+00005610: 206d 6170 7065 6420 746f 2060 2f76 6172   mapped to `/var
+00005620: 2f65 6d70 7479 600a 0a0a 2320 7468 6520  /empty`...# the 
+00005630: 6272 6f77 7365 720a 0a61 6363 6573 7369  browser..accessi
+00005640: 6e67 2061 2063 6f70 7970 6172 7479 2073  ng a copyparty s
+00005650: 6572 7665 7220 7573 696e 6720 6120 7765  erver using a we
+00005660: 622d 6272 6f77 7365 720a 0a21 5b63 6f70  b-browser..![cop
+00005670: 7970 6172 7479 2d62 726f 7773 6572 2d66  yparty-browser-f
+00005680: 7338 5d28 6874 7470 733a 2f2f 7573 6572  s8](https://user
+00005690: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
+000056a0: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
+000056b0: 3130 3332 2f31 3932 3034 3236 3935 2d35  1032/192042695-5
+000056c0: 3232 6233 6563 372d 3638 3435 2d34 3934  22b3ec7-6845-494
+000056d0: 612d 6162 6462 2d64 3163 3064 3065 3233  a-abdb-d1c0d0e23
+000056e0: 3830 312e 706e 6729 0a0a 0a23 2320 7461  801.png)...## ta
+000056f0: 6273 0a0a 7468 6520 6d61 696e 2074 6162  bs..the main tab
+00005700: 7320 696e 2074 6865 2075 690a 2a20 605b  s in the ui.* `[
+00005710: f09f 948e 5d60 205b 7365 6172 6368 5d28  ....]` [search](
+00005720: 2373 6561 7263 6869 6e67 2920 6279 2073  #searching) by s
+00005730: 697a 652c 2064 6174 652c 2070 6174 682f  ize, date, path/
+00005740: 6e61 6d65 2c20 6d70 332d 7461 6773 202e  name, mp3-tags .
+00005750: 2e2e 0a2a 2060 5bf0 9fa7 af5d 6020 5b75  ...* `[....]` [u
+00005760: 6e70 6f73 745d 2823 756e 706f 7374 293a  npost](#unpost):
+00005770: 2075 6e64 6f2f 6465 6c65 7465 2061 6363   undo/delete acc
+00005780: 6964 656e 7461 6c20 7570 6c6f 6164 730a  idental uploads.
+00005790: 2a20 605b f09f 9a80 5d60 2061 6e64 2060  * `[....]` and `
+000057a0: 5bf0 9f8e 885d 6020 6172 6520 7468 6520  [....]` are the 
+000057b0: 5b75 706c 6f61 6465 7273 5d28 2375 706c  [uploaders](#upl
+000057c0: 6f61 6469 6e67 290a 2a20 605b f09f 9382  oading).* `[....
+000057d0: 5d60 206d 6b64 6972 3a20 6372 6561 7465  ]` mkdir: create
+000057e0: 2064 6972 6563 746f 7269 6573 0a2a 2060   directories.* `
+000057f0: 5bf0 9f93 9d5d 6020 6e65 772d 6d64 3a20  [....]` new-md: 
+00005800: 6372 6561 7465 2061 206e 6577 206d 6172  create a new mar
+00005810: 6b64 6f77 6e20 646f 6375 6d65 6e74 0a2a  kdown document.*
+00005820: 2060 5bf0 9f93 9f5d 6020 7365 6e64 2d6d   `[....]` send-m
+00005830: 7367 3a20 6569 7468 6572 2074 6f20 7365  sg: either to se
+00005840: 7276 6572 2d6c 6f67 206f 7220 696e 746f  rver-log or into
+00005850: 2074 6578 7466 696c 6573 2069 6620 602d   textfiles if `-
+00005860: 2d75 726c 666f 726d 2073 6176 6560 0a2a  -urlform save`.*
+00005870: 2060 5bf0 9f8e ba5d 6020 6175 6469 6f2d   `[....]` audio-
+00005880: 706c 6179 6572 2063 6f6e 6669 6720 6f70  player config op
+00005890: 7469 6f6e 730a 2a20 605b e29a 99ef b88f  tions.* `[......
+000058a0: 5d60 2067 656e 6572 616c 2063 6c69 656e  ]` general clien
+000058b0: 7420 636f 6e66 6967 206f 7074 696f 6e73  t config options
+000058c0: 0a0a 0a23 2320 686f 746b 6579 730a 0a74  ...## hotkeys..t
+000058d0: 6865 2062 726f 7773 6572 2068 6173 2074  he browser has t
+000058e0: 6865 2066 6f6c 6c6f 7769 6e67 2068 6f74  he following hot
+000058f0: 6b65 7973 2020 2861 6c77 6179 7320 7177  keys  (always qw
+00005900: 6572 7479 290a 2a20 603f 6020 7368 6f77  erty).* `?` show
+00005910: 2068 6f74 6b65 7973 2068 656c 700a 2a20   hotkeys help.* 
+00005920: 6042 6020 746f 6767 6c65 2062 7265 6164  `B` toggle bread
+00005930: 6372 756d 6273 202f 205b 6e61 7670 616e  crumbs / [navpan
+00005940: 655d 2823 6e61 7670 616e 6529 0a2a 2060  e](#navpane).* `
+00005950: 492f 4b60 2070 7265 762f 6e65 7874 2066  I/K` prev/next f
+00005960: 6f6c 6465 720a 2a20 604d 6020 7061 7265  older.* `M` pare
+00005970: 6e74 2066 6f6c 6465 7220 286f 7220 756e  nt folder (or un
+00005980: 6578 7061 6e64 2063 7572 7265 6e74 290a  expand current).
+00005990: 2a20 6056 6020 746f 6767 6c65 2066 6f6c  * `V` toggle fol
+000059a0: 6465 7273 202f 2074 6578 7466 696c 6573  ders / textfiles
+000059b0: 2069 6e20 7468 6520 6e61 7670 616e 650a   in the navpane.
+000059c0: 2a20 6047 6020 746f 6767 6c65 206c 6973  * `G` toggle lis
+000059d0: 7420 2f20 5b67 7269 6420 7669 6577 5d28  t / [grid view](
+000059e0: 2374 6875 6d62 6e61 696c 7329 202d 2d20  #thumbnails) -- 
+000059f0: 7361 6d65 2061 7320 60e7 94b0 6020 626f  same as `...` bo
+00005a00: 7474 6f6d 2d72 6967 6874 0a2a 2060 5460  ttom-right.* `T`
+00005a10: 2074 6f67 676c 6520 7468 756d 626e 6169   toggle thumbnai
+00005a20: 6c73 202f 2069 636f 6e73 0a2a 2060 4553  ls / icons.* `ES
+00005a30: 4360 2063 6c6f 7365 2076 6172 696f 7573  C` close various
+00005a40: 2074 6869 6e67 730a 2a20 6063 7472 6c2d   things.* `ctrl-
+00005a50: 4b60 2064 656c 6574 6520 7365 6c65 6374  K` delete select
+00005a60: 6564 2066 696c 6573 2f66 6f6c 6465 7273  ed files/folders
+00005a70: 0a2a 2060 6374 726c 2d58 6020 6375 7420  .* `ctrl-X` cut 
+00005a80: 7365 6c65 6374 6564 2066 696c 6573 2f66  selected files/f
+00005a90: 6f6c 6465 7273 0a2a 2060 6374 726c 2d56  olders.* `ctrl-V
+00005aa0: 6020 7061 7374 650a 2a20 6059 6020 646f  ` paste.* `Y` do
+00005ab0: 776e 6c6f 6164 2073 656c 6563 7465 6420  wnload selected 
+00005ac0: 6669 6c65 730a 2a20 6046 3260 205b 7265  files.* `F2` [re
+00005ad0: 6e61 6d65 5d28 2362 6174 6368 2d72 656e  name](#batch-ren
+00005ae0: 616d 6529 2073 656c 6563 7465 6420 6669  ame) selected fi
+00005af0: 6c65 2f66 6f6c 6465 720a 2a20 7768 656e  le/folder.* when
+00005b00: 2061 2066 696c 652f 666f 6c64 6572 2069   a file/folder i
+00005b10: 7320 7365 6c65 6374 6564 2028 696e 206e  s selected (in n
+00005b20: 6f74 2d67 7269 642d 7669 6577 293a 0a20  ot-grid-view):. 
+00005b30: 202a 2060 5570 2f44 6f77 6e60 206d 6f76   * `Up/Down` mov
+00005b40: 6520 6375 7273 6f72 0a20 202a 2073 6869  e cursor.  * shi
+00005b50: 6674 2b60 5570 2f44 6f77 6e60 2073 656c  ft+`Up/Down` sel
+00005b60: 6563 7420 616e 6420 6d6f 7665 2063 7572  ect and move cur
+00005b70: 736f 720a 2020 2a20 6374 726c 2b60 5570  sor.  * ctrl+`Up
+00005b80: 2f44 6f77 6e60 206d 6f76 6520 6375 7273  /Down` move curs
+00005b90: 6f72 2061 6e64 2073 6372 6f6c 6c20 7669  or and scroll vi
+00005ba0: 6577 706f 7274 0a20 202a 2060 5370 6163  ewport.  * `Spac
+00005bb0: 6560 2074 6f67 676c 6520 6669 6c65 2073  e` toggle file s
+00005bc0: 656c 6563 7469 6f6e 0a20 202a 2060 4374  election.  * `Ct
+00005bd0: 726c 2d41 6020 746f 6767 6c65 2073 656c  rl-A` toggle sel
+00005be0: 6563 7420 616c 6c0a 2a20 7768 656e 2061  ect all.* when a
+00005bf0: 2074 6578 7466 696c 6520 6973 206f 7065   textfile is ope
+00005c00: 6e3a 0a20 202a 2060 492f 4b60 2070 7265  n:.  * `I/K` pre
+00005c10: 762f 6e65 7874 2074 6578 7466 696c 650a  v/next textfile.
+00005c20: 2020 2a20 6053 6020 746f 6767 6c65 2073    * `S` toggle s
+00005c30: 656c 6563 7469 6f6e 206f 6620 6f70 656e  election of open
+00005c40: 2066 696c 650a 2020 2a20 604d 6020 636c   file.  * `M` cl
+00005c50: 6f73 6520 7465 7874 6669 6c65 0a2a 2077  ose textfile.* w
+00005c60: 6865 6e20 706c 6179 696e 6720 6175 6469  hen playing audi
+00005c70: 6f3a 0a20 202a 2060 4a2f 4c60 2070 7265  o:.  * `J/L` pre
+00005c80: 762f 6e65 7874 2073 6f6e 670a 2020 2a20  v/next song.  * 
+00005c90: 6055 2f4f 6020 736b 6970 2031 3073 6563  `U/O` skip 10sec
+00005ca0: 2062 6163 6b2f 666f 7277 6172 640a 2020   back/forward.  
+00005cb0: 2a20 6030 2e2e 3960 206a 756d 7020 746f  * `0..9` jump to
+00005cc0: 2030 252e 2e39 3025 0a20 202a 2060 5060   0%..90%.  * `P`
+00005cd0: 2070 6c61 792f 7061 7573 6520 2861 6c73   play/pause (als
+00005ce0: 6f20 7374 6172 7473 2070 6c61 7969 6e67  o starts playing
+00005cf0: 2074 6865 2066 6f6c 6465 7229 0a20 202a   the folder).  *
+00005d00: 2060 5960 2064 6f77 6e6c 6f61 6420 6669   `Y` download fi
+00005d10: 6c65 0a2a 2077 6865 6e20 7669 6577 696e  le.* when viewin
+00005d20: 6720 696d 6167 6573 202f 2070 6c61 7969  g images / playi
+00005d30: 6e67 2076 6964 656f 733a 0a20 202a 2060  ng videos:.  * `
+00005d40: 4a2f 4c2c 204c 6566 742f 5269 6768 7460  J/L, Left/Right`
+00005d50: 2070 7265 762f 6e65 7874 2066 696c 650a   prev/next file.
+00005d60: 2020 2a20 6048 6f6d 652f 456e 6460 2066    * `Home/End` f
+00005d70: 6972 7374 2f6c 6173 7420 6669 6c65 0a20  irst/last file. 
+00005d80: 202a 2060 4660 2074 6f67 676c 6520 6675   * `F` toggle fu
+00005d90: 6c6c 7363 7265 656e 0a20 202a 2060 5360  llscreen.  * `S`
+00005da0: 2074 6f67 676c 6520 7365 6c65 6374 696f   toggle selectio
+00005db0: 6e0a 2020 2a20 6052 6020 726f 7461 7465  n.  * `R` rotate
+00005dc0: 2063 6c6f 636b 7769 7365 2028 7368 6966   clockwise (shif
+00005dd0: 743d 6363 7729 0a20 202a 2060 5960 2064  t=ccw).  * `Y` d
+00005de0: 6f77 6e6c 6f61 6420 6669 6c65 0a20 202a  ownload file.  *
+00005df0: 2060 4573 6360 2063 6c6f 7365 2076 6965   `Esc` close vie
+00005e00: 7765 720a 2020 2a20 7669 6465 6f73 3a0a  wer.  * videos:.
+00005e10: 2020 2020 2a20 6055 2f4f 6020 736b 6970      * `U/O` skip
+00005e20: 2031 3073 6563 2062 6163 6b2f 666f 7277   10sec back/forw
+00005e30: 6172 640a 2020 2020 2a20 6030 2e2e 3960  ard.    * `0..9`
+00005e40: 206a 756d 7020 746f 2030 252e 2e39 3025   jump to 0%..90%
+00005e50: 0a20 2020 202a 2060 502f 4b2f 5370 6163  .    * `P/K/Spac
+00005e60: 6560 2070 6c61 792f 7061 7573 650a 2020  e` play/pause.  
+00005e70: 2020 2a20 604d 6020 6d75 7465 0a20 2020    * `M` mute.   
+00005e80: 202a 2060 4360 2063 6f6e 7469 6e75 6520   * `C` continue 
+00005e90: 706c 6179 696e 6720 6e65 7874 2076 6964  playing next vid
+00005ea0: 656f 0a20 2020 202a 2060 5660 206c 6f6f  eo.    * `V` loo
+00005eb0: 7020 656e 7469 7265 2066 696c 650a 2020  p entire file.  
+00005ec0: 2020 2a20 605b 6020 6c6f 6f70 2072 616e    * `[` loop ran
+00005ed0: 6765 2028 7374 6172 7429 0a20 2020 202a  ge (start).    *
+00005ee0: 2060 5d60 206c 6f6f 7020 7261 6e67 6520   `]` loop range 
+00005ef0: 2865 6e64 290a 2a20 7768 656e 2074 6865  (end).* when the
+00005f00: 206e 6176 7061 6e65 2069 7320 6f70 656e   navpane is open
+00005f10: 3a0a 2020 2a20 6041 2f44 6020 6164 6a75  :.  * `A/D` adju
+00005f20: 7374 2074 7265 6520 7769 6474 680a 2a20  st tree width.* 
+00005f30: 696e 2074 6865 205b 6772 6964 2076 6965  in the [grid vie
+00005f40: 775d 2823 7468 756d 626e 6169 6c73 293a  w](#thumbnails):
+00005f50: 0a20 202a 2060 5360 2074 6f67 676c 6520  .  * `S` toggle 
+00005f60: 6d75 6c74 6973 656c 6563 740a 2020 2a20  multiselect.  * 
+00005f70: 7368 6966 742b 6041 2f44 6020 7a6f 6f6d  shift+`A/D` zoom
+00005f80: 0a2a 2069 6e20 7468 6520 6d61 726b 646f  .* in the markdo
+00005f90: 776e 2065 6469 746f 723a 0a20 202a 2060  wn editor:.  * `
+00005fa0: 5e73 6020 7361 7665 0a20 202a 2060 5e68  ^s` save.  * `^h
+00005fb0: 6020 6865 6164 6572 0a20 202a 2060 5e6b  ` header.  * `^k
+00005fc0: 6020 6175 746f 666f 726d 6174 2074 6162  ` autoformat tab
+00005fd0: 6c65 0a20 202a 2060 5e75 6020 6a75 6d70  le.  * `^u` jump
+00005fe0: 2074 6f20 6e65 7874 2075 6e69 636f 6465   to next unicode
+00005ff0: 2063 6861 7261 6374 6572 0a20 202a 2060   character.  * `
+00006000: 5e65 6020 746f 6767 6c65 2065 6469 746f  ^e` toggle edito
+00006010: 7220 2f20 7072 6576 6965 770a 2020 2a20  r / preview.  * 
+00006020: 605e 7570 2c20 5e64 6f77 6e60 206a 756d  `^up, ^down` jum
+00006030: 7020 7061 7261 6772 6170 6873 0a0a 0a23  p paragraphs...#
+00006040: 2320 6e61 7670 616e 650a 0a73 7769 7463  # navpane..switc
+00006050: 6869 6e67 2062 6574 7765 656e 2062 7265  hing between bre
+00006060: 6164 6372 756d 6273 206f 7220 6e61 7670  adcrumbs or navp
+00006070: 616e 650a 0a63 6c69 636b 2074 6865 2060  ane..click the `
+00006080: f09f 8cb2 6020 6f72 2070 7265 7373 696e  ....` or pressin
+00006090: 6720 7468 6520 6042 6020 686f 746b 6579  g the `B` hotkey
+000060a0: 2074 6f20 746f 6767 6c65 2062 6574 7765   to toggle betwe
+000060b0: 656e 2062 7265 6164 6372 756d 6273 2070  en breadcrumbs p
+000060c0: 6174 6820 2864 6566 6175 6c74 292c 206f  ath (default), o
+000060d0: 7220 6120 6e61 7670 616e 6520 2874 7265  r a navpane (tre
+000060e0: 652d 6272 6f77 7365 7220 7369 6465 6261  e-browser sideba
+000060f0: 7220 7468 696e 6729 0a0a 2a20 605b 2b5d  r thing)..* `[+]
+00006100: 6020 616e 6420 605b 2d5d 6020 286f 7220  ` and `[-]` (or 
+00006110: 686f 746b 6579 7320 6041 602f 6044 6029  hotkeys `A`/`D`)
+00006120: 2061 646a 7573 7420 7468 6520 7369 7a65   adjust the size
+00006130: 0a2a 2060 5bf0 9f8e af5d 6020 6a75 6d70  .* `[....]` jump
+00006140: 7320 746f 2074 6865 2063 7572 7265 6e74  s to the current
+00006150: 6c79 206f 7065 6e20 666f 6c64 6572 0a2a  ly open folder.*
+00006160: 2060 5bf0 9f93 835d 6020 746f 6767 6c65   `[....]` toggle
+00006170: 7320 6265 7477 6565 6e20 7368 6f77 696e  s between showin
+00006180: 6720 666f 6c64 6572 7320 616e 6420 7465  g folders and te
+00006190: 7874 6669 6c65 730a 2a20 605b f09f 938c  xtfiles.* `[....
+000061a0: 5d60 2073 686f 7773 2074 6865 206e 616d  ]` shows the nam
+000061b0: 6520 6f66 2061 6c6c 2070 6172 656e 7420  e of all parent 
+000061c0: 666f 6c64 6572 7320 696e 2061 2064 6f63  folders in a doc
+000061d0: 6b65 6420 7061 6e65 6c0a 2a20 605b 615d  ked panel.* `[a]
+000061e0: 6020 746f 6767 6c65 7320 6175 746f 6d61  ` toggles automa
+000061f0: 7469 6320 7769 6465 6e69 6e67 2061 7320  tic widening as 
+00006200: 796f 7520 676f 2064 6565 7065 720a 2a20  you go deeper.* 
+00006210: 605b e286 b55d 6020 746f 6767 6c65 7320  `[...]` toggles 
+00006220: 776f 7264 7772 6170 0a2a 2060 5bf0 9f91  wordwrap.* `[...
+00006230: 805d 6020 7368 6f77 2066 756c 6c20 6e61  .]` show full na
+00006240: 6d65 206f 6e20 686f 7665 7220 2869 6620  me on hover (if 
+00006250: 776f 7264 7772 6170 2069 7320 6f66 6629  wordwrap is off)
+00006260: 0a0a 0a23 2320 7468 756d 626e 6169 6c73  ...## thumbnails
+00006270: 0a0a 7072 6573 7320 6067 6020 6f72 2060  ..press `g` or `
+00006280: e794 b060 2074 6f20 746f 6767 6c65 2067  ...` to toggle g
+00006290: 7269 642d 7669 6577 2069 6e73 7465 6164  rid-view instead
+000062a0: 206f 6620 7468 6520 6669 6c65 206c 6973   of the file lis
+000062b0: 7469 6e67 2020 616e 6420 6074 6020 746f  ting  and `t` to
+000062c0: 6767 6c65 7320 6963 6f6e 7320 2f20 7468  ggles icons / th
+000062d0: 756d 626e 6169 6c73 0a0a 215b 636f 7079  umbnails..![copy
+000062e0: 7061 7274 792d 7468 756d 6273 2d66 7338  party-thumbs-fs8
+000062f0: 5d28 6874 7470 733a 2f2f 7573 6572 2d69  ](https://user-i
+00006300: 6d61 6765 732e 6769 7468 7562 7573 6572  mages.githubuser
+00006310: 636f 6e74 656e 742e 636f 6d2f 3234 3130  content.com/2410
+00006320: 3332 2f31 3239 3633 3632 3131 2d61 6264  32/129636211-abd
+00006330: 3230 6661 322d 6139 3533 2d34 3336 362d  20fa2-a953-4366-
+00006340: 3934 3233 2d31 6338 3865 6262 3936 6261  9423-1c88ebb96ba
+00006350: 392e 706e 6729 0a0a 6974 2064 6f65 7320  9.png)..it does 
+00006360: 7374 6174 6963 2069 6d61 6765 7320 7769  static images wi
+00006370: 7468 2050 696c 6c6f 7720 2f20 7079 7669  th Pillow / pyvi
+00006380: 7073 202f 2046 466d 7065 672c 2061 6e64  ps / FFmpeg, and
+00006390: 2075 7365 7320 4646 6d70 6567 2066 6f72   uses FFmpeg for
+000063a0: 2076 6964 656f 2066 696c 6573 2c20 736f   video files, so
+000063b0: 2079 6f75 206d 6179 2077 616e 7420 746f   you may want to
+000063c0: 2060 2d2d 6e6f 2d74 6875 6d62 6020 6f72   `--no-thumb` or
+000063d0: 206d 6179 6265 206a 7573 7420 602d 2d6e   maybe just `--n
+000063e0: 6f2d 7674 6875 6d62 6020 6465 7065 6e64  o-vthumb` depend
+000063f0: 696e 6720 6f6e 2068 6f77 2064 616e 6765  ing on how dange
+00006400: 726f 7573 2079 6f75 7220 7573 6572 7320  rous your users 
+00006410: 6172 650a 2a20 7079 7669 7073 2069 7320  are.* pyvips is 
+00006420: 3378 2066 6173 7465 7220 7468 616e 2050  3x faster than P
+00006430: 696c 6c6f 772c 2050 696c 6c6f 7720 6973  illow, Pillow is
+00006440: 2033 7820 6661 7374 6572 2074 6861 6e20   3x faster than 
+00006450: 4646 6d70 6567 0a2a 2064 6973 6162 6c65  FFmpeg.* disable
+00006460: 2074 6875 6d62 6e61 696c 7320 666f 7220   thumbnails for 
+00006470: 7370 6563 6966 6963 2076 6f6c 756d 6573  specific volumes
+00006480: 2077 6974 6820 766f 6c66 6c61 6720 6064   with volflag `d
+00006490: 7468 756d 6260 2066 6f72 2061 6c6c 2c20  thumb` for all, 
+000064a0: 6f72 2060 6476 7468 756d 6260 202f 2060  or `dvthumb` / `
+000064b0: 6461 7468 756d 6260 202f 2060 6469 7468  dathumb` / `dith
+000064c0: 756d 6260 2066 6f72 2076 6964 656f 2f61  umb` for video/a
+000064d0: 7564 696f 2f69 6d61 6765 7320 6f6e 6c79  udio/images only
+000064e0: 0a0a 6175 6469 6f20 6669 6c65 7320 6172  ..audio files ar
+000064f0: 6520 636f 766e 6572 7465 6420 696e 746f  e covnerted into
+00006500: 2073 7065 6374 726f 6772 616d 7320 7573   spectrograms us
+00006510: 696e 6720 4646 6d70 6567 2075 6e6c 6573  ing FFmpeg unles
+00006520: 7320 796f 7520 602d 2d6e 6f2d 6174 6875  s you `--no-athu
+00006530: 6d62 6020 2861 6e64 2073 6f6d 6520 4646  mb` (and some FF
+00006540: 6d70 6567 2062 7569 6c64 7320 6d61 7920  mpeg builds may 
+00006550: 6e65 6564 2060 2d2d 7468 2d66 662d 7377  need `--th-ff-sw
+00006560: 7260 290a 0a69 6d61 6765 7320 7769 7468  r`)..images with
+00006570: 2074 6865 2066 6f6c 6c6f 7769 6e67 206e   the following n
+00006580: 616d 6573 2028 7365 6520 602d 2d74 682d  ames (see `--th-
+00006590: 636f 7665 7273 6029 2062 6563 6f6d 6520  covers`) become 
+000065a0: 7468 6520 7468 756d 626e 6169 6c20 6f66  the thumbnail of
+000065b0: 2074 6865 2066 6f6c 6465 7220 7468 6579   the folder they
+000065c0: 2772 6520 696e 3a20 6066 6f6c 6465 722e  're in: `folder.
+000065d0: 706e 6760 2c20 6066 6f6c 6465 722e 6a70  png`, `folder.jp
+000065e0: 6760 2c20 6063 6f76 6572 2e70 6e67 602c  g`, `cover.png`,
+000065f0: 2060 636f 7665 722e 6a70 6760 0a0a 696e   `cover.jpg`..in
+00006600: 2074 6865 2067 7269 642f 7468 756d 626e   the grid/thumbn
+00006610: 6169 6c20 7669 6577 2c20 6966 2074 6865  ail view, if the
+00006620: 2061 7564 696f 2070 6c61 7965 7220 7061   audio player pa
+00006630: 6e65 6c20 6973 206f 7065 6e2c 2073 6f6e  nel is open, son
+00006640: 6773 2077 696c 6c20 7374 6172 7420 706c  gs will start pl
+00006650: 6179 696e 6720 7768 656e 2063 6c69 636b  aying when click
+00006660: 6564 0a2a 2069 6e64 6963 6174 6564 2062  ed.* indicated b
+00006670: 7920 7468 6520 6175 6469 6f20 6669 6c65  y the audio file
+00006680: 7320 6861 7669 6e67 2074 6865 20e2 96b6  s having the ...
+00006690: 2069 636f 6e20 696e 7374 6561 6420 6f66   icon instead of
+000066a0: 20f0 9f92 be0a 0a0a 2323 207a 6970 2064   .......## zip d
+000066b0: 6f77 6e6c 6f61 6473 0a0a 646f 776e 6c6f  ownloads..downlo
+000066c0: 6164 2066 6f6c 6465 7273 2028 6f72 2066  ad folders (or f
+000066d0: 696c 6520 7365 6c65 6374 696f 6e73 2920  ile selections) 
+000066e0: 6173 2060 7a69 7060 206f 7220 6074 6172  as `zip` or `tar
+000066f0: 6020 6669 6c65 730a 0a73 656c 6563 7420  ` files..select 
+00006700: 7768 6963 6820 7479 7065 206f 6620 6172  which type of ar
+00006710: 6368 6976 6520 796f 7520 7761 6e74 2069  chive you want i
+00006720: 6e20 7468 6520 605b e29a 99ef b88f 5d20  n the `[......] 
+00006730: 636f 6e66 6967 6020 7461 623a 0a0a 7c20  config` tab:..| 
+00006740: 6e61 6d65 207c 2075 726c 2d73 7566 6669  name | url-suffi
+00006750: 7820 7c20 6465 7363 7269 7074 696f 6e20  x | description 
+00006760: 7c0a 7c2d 2d7c 2d2d 7c2d 2d7c 0a7c 2060  |.|--|--|--|.| `
+00006770: 7461 7260 207c 2060 3f74 6172 6020 7c20  tar` | `?tar` | 
+00006780: 706c 6169 6e20 676e 7574 6172 2c20 776f  plain gnutar, wo
+00006790: 726b 7320 6772 6561 7420 7769 7468 2060  rks great with `
+000067a0: 6375 726c 205c 7c20 7461 7220 2d78 7660  curl \| tar -xv`
+000067b0: 207c 0a7c 2060 7a69 7060 207c 2060 3f7a   |.| `zip` | `?z
+000067c0: 6970 3d75 7466 3860 207c 2077 6f72 6b73  ip=utf8` | works
+000067d0: 2065 7665 7279 7768 6572 652c 2067 6c69   everywhere, gli
+000067e0: 7463 6879 2066 696c 656e 616d 6573 206f  tchy filenames o
+000067f0: 6e20 7769 6e37 2061 6e64 206f 6c64 6572  n win7 and older
+00006800: 207c 0a7c 2060 7a69 705f 646f 7360 207c   |.| `zip_dos` |
+00006810: 2060 3f7a 6970 6020 7c20 7472 6164 6974   `?zip` | tradit
+00006820: 696f 6e61 6c20 6370 3433 3720 286e 6f20  ional cp437 (no 
+00006830: 756e 6963 6f64 6529 2074 6f20 6669 7820  unicode) to fix 
+00006840: 676c 6974 6368 7920 6669 6c65 6e61 6d65  glitchy filename
+00006850: 7320 7c0a 7c20 607a 6970 5f63 7263 6020  s |.| `zip_crc` 
+00006860: 7c20 603f 7a69 703d 6372 6360 207c 2063  | `?zip=crc` | c
+00006870: 7034 3337 2077 6974 6820 6372 6333 3220  p437 with crc32 
+00006880: 636f 6d70 7574 6564 2065 6172 6c79 2066  computed early f
+00006890: 6f72 2074 7275 6c79 2061 6e63 6965 6e74  or truly ancient
+000068a0: 2073 6f66 7477 6172 6520 7c0a 0a2a 2068   software |..* h
+000068b0: 6964 6465 6e20 6669 6c65 7320 2864 6f74  idden files (dot
+000068c0: 6669 6c65 7329 2061 7265 2065 7863 6c75  files) are exclu
+000068d0: 6465 6420 756e 6c65 7373 2060 2d65 6460  ded unless `-ed`
+000068e0: 0a20 202a 2060 7570 326b 2e64 6260 2061  .  * `up2k.db` a
+000068f0: 6e64 2060 6469 722e 7478 7460 2069 7320  nd `dir.txt` is 
+00006900: 616c 7761 7973 2065 7863 6c75 6465 640a  always excluded.
+00006910: 2a20 607a 6970 5f63 7263 6020 7769 6c6c  * `zip_crc` will
+00006920: 2074 616b 6520 6c6f 6e67 6572 2074 6f20   take longer to 
+00006930: 646f 776e 6c6f 6164 2073 696e 6365 2074  download since t
+00006940: 6865 2073 6572 7665 7220 6861 7320 746f  he server has to
+00006950: 2072 6561 6420 6561 6368 2066 696c 6520   read each file 
+00006960: 7477 6963 650a 2020 2a20 7468 6973 2069  twice.  * this i
+00006970: 7320 6f6e 6c79 2074 6f20 7375 7070 6f72  s only to suppor
+00006980: 7420 4d53 2d44 4f53 2050 4b5a 4950 2076  t MS-DOS PKZIP v
+00006990: 322e 3034 6720 286f 6374 6f62 6572 2031  2.04g (october 1
+000069a0: 3939 3329 2061 6e64 206f 6c64 6572 0a20  993) and older. 
+000069b0: 2020 202a 2068 6f77 2061 7265 2079 6f75     * how are you
+000069c0: 2061 6363 6573 7369 6e67 2063 6f70 7970   accessing copyp
+000069d0: 6172 7479 2061 6374 7561 6c6c 790a 0a79  arty actually..y
+000069e0: 6f75 2063 616e 2061 6c73 6f20 7a69 7020  ou can also zip 
+000069f0: 6120 7365 6c65 6374 696f 6e20 6f66 2066  a selection of f
+00006a00: 696c 6573 206f 7220 666f 6c64 6572 7320  iles or folders 
+00006a10: 6279 2063 6c69 636b 696e 6720 7468 656d  by clicking them
+00006a20: 2069 6e20 7468 6520 6272 6f77 7365 722c   in the browser,
+00006a30: 2074 6861 7420 6272 696e 6773 2075 7020   that brings up 
+00006a40: 6120 7365 6c65 6374 696f 6e20 6564 6974  a selection edit
+00006a50: 6f72 2061 6e64 207a 6970 2062 7574 746f  or and zip butto
+00006a60: 6e20 696e 2074 6865 2062 6f74 746f 6d20  n in the bottom 
+00006a70: 7269 6768 740a 0a21 5b63 6f70 7970 6172  right..![copypar
+00006a80: 7479 2d7a 6970 7365 6c2d 6673 385d 2868  ty-zipsel-fs8](h
+00006a90: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+00006aa0: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00006ab0: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00006ac0: 3132 3936 3335 3337 342d 6535 3133 3665  129635374-e5136e
+00006ad0: 3031 2d34 3730 612d 3439 6231 2d61 3736  01-470a-49b1-a76
+00006ae0: 322d 3834 3865 3861 3463 3963 6463 2e70  2-848e8a4c9cdc.p
+00006af0: 6e67 290a 0a0a 2323 2075 706c 6f61 6469  ng)...## uploadi
+00006b00: 6e67 0a0a 6472 6167 2066 696c 6573 2f66  ng..drag files/f
+00006b10: 6f6c 6465 7273 2069 6e74 6f20 7468 6520  olders into the 
+00006b20: 7765 622d 6272 6f77 7365 7220 746f 2075  web-browser to u
+00006b30: 706c 6f61 6420 2028 6f72 2075 7365 2074  pload  (or use t
+00006b40: 6865 205b 636f 6d6d 616e 642d 6c69 6e65  he [command-line
+00006b50: 2075 706c 6f61 6465 725d 2868 7474 7073   uploader](https
+00006b60: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00006b70: 3031 2f63 6f70 7970 6172 7479 2f74 7265  01/copyparty/tre
+00006b80: 652f 686f 7675 6473 7472 6175 6d2f 6269  e/hovudstraum/bi
+00006b90: 6e23 7570 326b 7079 2929 0a0a 7468 6973  n#up2kpy))..this
+00006ba0: 2069 6e69 7469 6174 6573 2061 6e20 7570   initiates an up
+00006bb0: 6c6f 6164 2075 7369 6e67 2060 7570 326b  load using `up2k
+00006bc0: 603b 2074 6865 7265 2061 7265 2074 776f  `; there are two
+00006bd0: 2075 706c 6f61 6465 7273 2061 7661 696c   uploaders avail
+00006be0: 6162 6c65 3a0a 2a20 605b f09f 8e88 5d20  able:.* `[....] 
+00006bf0: 6275 7060 2c20 7468 6520 6261 7369 6320  bup`, the basic 
+00006c00: 7570 6c6f 6164 6572 2c20 7375 7070 6f72  uploader, suppor
+00006c10: 7473 2061 6c6d 6f73 7420 6576 6572 7920  ts almost every 
+00006c20: 6272 6f77 7365 7220 7369 6e63 6520 6e65  browser since ne
+00006c30: 7473 6361 7065 2034 2e30 0a2a 2060 5bf0  tscape 4.0.* `[.
+00006c40: 9f9a 805d 2075 7032 6b60 2c20 7468 6520  ...] up2k`, the 
+00006c50: 676f 6f64 202f 2066 616e 6379 206f 6e65  good / fancy one
+00006c60: 0a0a 4e42 3a20 796f 7520 6361 6e20 756e  ..NB: you can un
+00006c70: 646f 2f64 656c 6574 6520 796f 7572 206f  do/delete your o
+00006c80: 776e 2075 706c 6f61 6473 2077 6974 6820  wn uploads with 
+00006c90: 605b f09f a7af 5d60 205b 756e 706f 7374  `[....]` [unpost
+00006ca0: 5d28 2375 6e70 6f73 7429 0a0a 7570 326b  ](#unpost)..up2k
+00006cb0: 2068 6173 2073 6576 6572 616c 2061 6476   has several adv
+00006cc0: 616e 7461 6765 733a 0a2a 2079 6f75 2063  antages:.* you c
+00006cd0: 616e 2064 726f 7020 666f 6c64 6572 7320  an drop folders 
+00006ce0: 696e 746f 2074 6865 2062 726f 7773 6572  into the browser
+00006cf0: 2028 6669 6c65 7320 6172 6520 6164 6465   (files are adde
+00006d00: 6420 7265 6375 7273 6976 656c 7929 0a2a  d recursively).*
+00006d10: 2066 696c 6573 2061 7265 2070 726f 6365   files are proce
+00006d20: 7373 6564 2069 6e20 6368 756e 6b73 2c20  ssed in chunks, 
+00006d30: 616e 6420 6561 6368 2063 6875 6e6b 2069  and each chunk i
+00006d40: 7320 6368 6563 6b73 756d 6d65 640a 2020  s checksummed.  
+00006d50: 2a20 7570 6c6f 6164 7320 6175 746f 7265  * uploads autore
+00006d60: 7375 6d65 2069 6620 7468 6579 2061 7265  sume if they are
+00006d70: 2069 6e74 6572 7275 7074 6564 2062 7920   interrupted by 
+00006d80: 6e65 7477 6f72 6b20 6973 7375 6573 0a20  network issues. 
+00006d90: 202a 2075 706c 6f61 6473 2072 6573 756d   * uploads resum
+00006da0: 6520 6966 2079 6f75 2072 6562 6f6f 7420  e if you reboot 
+00006db0: 796f 7572 2062 726f 7773 6572 206f 7220  your browser or 
+00006dc0: 7063 2c20 6a75 7374 2075 706c 6f61 6420  pc, just upload 
+00006dd0: 7468 6520 7361 6d65 2066 696c 6573 2061  the same files a
+00006de0: 6761 696e 0a20 202a 2073 6572 7665 7220  gain.  * server 
+00006df0: 6465 7465 6374 7320 616e 7920 636f 7272  detects any corr
+00006e00: 7570 7469 6f6e 3b20 7468 6520 636c 6965  uption; the clie
+00006e10: 6e74 2072 6575 706c 6f61 6473 2061 6666  nt reuploads aff
+00006e20: 6563 7465 6420 6368 756e 6b73 0a20 202a  ected chunks.  *
+00006e30: 2074 6865 2063 6c69 656e 7420 646f 6573   the client does
+00006e40: 6e27 7420 7570 6c6f 6164 2061 6e79 7468  n't upload anyth
+00006e50: 696e 6720 7468 6174 2061 6c72 6561 6479  ing that already
+00006e60: 2065 7869 7374 7320 6f6e 2074 6865 2073   exists on the s
+00006e70: 6572 7665 720a 2a20 6d75 6368 2068 6967  erver.* much hig
+00006e80: 6865 7220 7370 6565 6473 2074 6861 6e20  her speeds than 
+00006e90: 6674 702f 7363 702f 7461 7270 6970 6520  ftp/scp/tarpipe 
+00006ea0: 6f6e 2073 6f6d 6520 696e 7465 726e 6574  on some internet
+00006eb0: 2063 6f6e 6e65 6374 696f 6e73 2028 6d61   connections (ma
+00006ec0: 696e 6c79 2061 6d65 7269 6361 6e20 6f6e  inly american on
+00006ed0: 6573 2920 7468 616e 6b73 2074 6f20 7061  es) thanks to pa
+00006ee0: 7261 6c6c 656c 2063 6f6e 6e65 6374 696f  rallel connectio
+00006ef0: 6e73 0a2a 2074 6865 206c 6173 742d 6d6f  ns.* the last-mo
+00006f00: 6469 6669 6564 2074 696d 6573 7461 6d70  dified timestamp
+00006f10: 206f 6620 7468 6520 6669 6c65 2069 7320   of the file is 
+00006f20: 7072 6573 6572 7665 640a 0a3e 2069 7420  preserved..> it 
+00006f30: 6973 2070 6572 6665 6374 6c79 2073 6166  is perfectly saf
+00006f40: 6520 746f 2072 6573 7461 7274 202f 2075  e to restart / u
+00006f50: 7067 7261 6465 2063 6f70 7970 6172 7479  pgrade copyparty
+00006f60: 2077 6869 6c65 2073 6f6d 656f 6e65 2069   while someone i
+00006f70: 7320 7570 6c6f 6164 696e 6720 746f 2069  s uploading to i
+00006f80: 7421 2020 0a3e 2061 6c6c 206b 6e6f 776e  t!  .> all known
+00006f90: 2075 7032 6b20 636c 6965 6e74 7320 7769   up2k clients wi
+00006fa0: 6c6c 2072 6573 756d 6520 6a75 7374 2066  ll resume just f
+00006fb0: 696e 6520 f09f 92aa 0a0a 7365 6520 5b75  ine ......see [u
+00006fc0: 7032 6b5d 2823 7570 326b 2920 666f 7220  p2k](#up2k) for 
+00006fd0: 6465 7461 696c 7320 6f6e 2068 6f77 2069  details on how i
+00006fe0: 7420 776f 726b 732c 206f 7220 7761 7463  t works, or watc
+00006ff0: 6820 6120 5b64 656d 6f20 7669 6465 6f5d  h a [demo video]
+00007000: 2868 7474 7073 3a2f 2f61 2e6f 6376 2e6d  (https://a.ocv.m
+00007010: 652f 7075 622f 6465 6d6f 2f70 6963 732d  e/pub/demo/pics-
+00007020: 7669 6473 2f23 6766 2d30 6636 6635 6330  vids/#gf-0f6f5c0
+00007030: 6429 0a0a 215b 636f 7079 7061 7274 792d  d)..![copyparty-
+00007040: 7570 6c6f 6164 2d66 7338 5d28 6874 7470  upload-fs8](http
+00007050: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+00007060: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+00007070: 742e 636f 6d2f 3234 3130 3332 2f31 3239  t.com/241032/129
+00007080: 3633 3533 3731 2d34 3866 6335 3463 612d  635371-48fc54ca-
+00007090: 6661 3931 2d34 3865 332d 3962 3164 2d62  fa91-48e3-9b1d-b
+000070a0: 6134 3133 6534 6236 3863 622e 706e 6729  a413e4b68cb.png)
+000070b0: 0a0a 2a2a 7072 6f74 6970 3a2a 2a20 796f  ..**protip:** yo
+000070c0: 7520 6361 6e20 6176 6f69 6420 7363 6172  u can avoid scar
+000070d0: 696e 6720 6177 6179 2075 7365 7273 2077  ing away users w
+000070e0: 6974 6820 5b63 6f6e 7472 6962 2f70 6c75  ith [contrib/plu
+000070f0: 6769 6e73 2f6d 696e 696d 616c 2d75 7032  gins/minimal-up2
+00007100: 6b2e 6a73 5d28 636f 6e74 7269 622f 706c  k.js](contrib/pl
+00007110: 7567 696e 732f 6d69 6e69 6d61 6c2d 7570  ugins/minimal-up
+00007120: 326b 2e6a 7329 2077 6869 6368 206d 616b  2k.js) which mak
+00007130: 6573 2069 7420 6c6f 6f6b 205b 6d75 6368  es it look [much
+00007140: 2073 696d 706c 6572 5d28 6874 7470 733a   simpler](https:
+00007150: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+00007160: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+00007170: 636f 6d2f 3234 3130 3332 2f31 3138 3331  com/241032/11831
+00007180: 3131 3935 2d64 6436 6361 3338 302d 6234  1195-dd6ca380-b4
+00007190: 6566 2d31 3165 622d 3836 6633 2d37 3561  ef-11eb-86f3-75a
+000071a0: 3366 6632 6531 3333 322e 706e 6729 0a0a  3ff2e1332.png)..
+000071b0: 2a2a 7072 6f74 6970 3a2a 2a20 6966 2079  **protip:** if y
+000071c0: 6f75 2065 6e61 626c 6520 6066 6176 6963  ou enable `favic
+000071d0: 6f6e 6020 696e 2074 6865 2060 5be2 9a99  on` in the `[...
+000071e0: efb8 8f5d 2073 6574 7469 6e67 7360 2074  ...] settings` t
+000071f0: 6162 2028 6279 2074 7970 696e 6720 736f  ab (by typing so
+00007200: 6d65 7468 696e 6720 696e 746f 2074 6865  mething into the
+00007210: 2074 6578 7462 6f78 292c 2074 6865 2069   textbox), the i
+00007220: 636f 6e20 696e 2074 6865 2062 726f 7773  con in the brows
+00007230: 6572 2074 6162 2077 696c 6c20 696e 6469  er tab will indi
+00007240: 6361 7465 2075 706c 6f61 6420 7072 6f67  cate upload prog
+00007250: 7265 7373 202d 2d20 616c 736f 2c20 7468  ress -- also, th
+00007260: 6520 605b f09f 9494 5d60 2061 6e64 2f6f  e `[....]` and/o
+00007270: 7220 605b f09f 948a 5d60 2073 7769 7463  r `[....]` switc
+00007280: 6865 7320 656e 6162 6c65 2076 6973 6962  hes enable visib
+00007290: 6c65 2061 6e64 2f6f 7220 6175 6469 626c  le and/or audibl
+000072a0: 6520 6e6f 7469 6669 6361 7469 6f6e 7320  e notifications 
+000072b0: 6f6e 2075 706c 6f61 6420 636f 6d70 6c65  on upload comple
+000072c0: 7469 6f6e 0a0a 7468 6520 7570 326b 2055  tion..the up2k U
+000072d0: 4920 6973 2074 6865 2065 7069 746f 6d65  I is the epitome
+000072e0: 206f 6620 706f 6c69 7368 6564 2069 6e75   of polished inu
+000072f0: 7469 7469 7665 2065 7870 6572 6965 6e63  titive experienc
+00007300: 6573 3a0a 2a20 2270 6172 616c 6c65 6c20  es:.* "parallel 
+00007310: 7570 6c6f 6164 7322 2073 7065 6369 6669  uploads" specifi
+00007320: 6573 2068 6f77 206d 616e 7920 6368 756e  es how many chun
+00007330: 6b73 2074 6f20 7570 6c6f 6164 2061 7420  ks to upload at 
+00007340: 7468 6520 7361 6d65 2074 696d 650a 2a20  the same time.* 
+00007350: 605b f09f 8f83 5d60 2061 6e61 6c79 7369  `[....]` analysi
+00007360: 7320 6f66 206f 7468 6572 2066 696c 6573  s of other files
+00007370: 2073 686f 756c 6420 636f 6e74 696e 7565   should continue
+00007380: 2077 6869 6c65 206f 6e65 2069 7320 7570   while one is up
+00007390: 6c6f 6164 696e 670a 2a20 605b f09f a594  loading.* `[....
+000073a0: 5d60 2073 686f 7773 2061 2073 696d 706c  ]` shows a simpl
+000073b0: 6572 2055 4920 666f 7220 6661 7374 6572  er UI for faster
+000073c0: 2075 706c 6f61 6473 2066 726f 6d20 736c   uploads from sl
+000073d0: 6f77 2064 6576 6963 6573 0a2a 2060 5bf0  ow devices.* `[.
+000073e0: 9f92 ad5d 6020 6173 6b20 666f 7220 636f  ...]` ask for co
+000073f0: 6e66 6972 6d61 7469 6f6e 2062 6566 6f72  nfirmation befor
+00007400: 6520 6669 6c65 7320 6172 6520 6164 6465  e files are adde
+00007410: 6420 746f 2074 6865 2071 7565 7565 0a2a  d to the queue.*
+00007420: 2060 5bf0 9f94 8e5d 6020 7377 6974 6368   `[....]` switch
+00007430: 2062 6574 7765 656e 2075 706c 6f61 6420   between upload 
+00007440: 616e 6420 5b66 696c 652d 7365 6172 6368  and [file-search
+00007450: 5d28 2366 696c 652d 7365 6172 6368 2920  ](#file-search) 
+00007460: 6d6f 6465 0a20 202a 2069 676e 6f72 6520  mode.  * ignore 
+00007470: 605b f09f 948e 5d60 2069 6620 796f 7520  `[....]` if you 
+00007480: 6164 6420 6669 6c65 7320 6279 2064 7261  add files by dra
+00007490: 6767 696e 6720 7468 656d 2069 6e74 6f20  gging them into 
+000074a0: 7468 6520 6272 6f77 7365 720a 0a61 6e64  the browser..and
+000074b0: 2074 6865 6e20 7468 6572 6573 2074 6865   then theres the
+000074c0: 2074 6162 7320 6265 6c6f 7720 6974 2c0a   tabs below it,.
+000074d0: 2a20 605b 6f6b 5d60 2069 7320 7468 6520  * `[ok]` is the 
+000074e0: 6669 6c65 7320 7768 6963 6820 636f 6d70  files which comp
+000074f0: 6c65 7465 6420 7375 6363 6573 7366 756c  leted successful
+00007500: 6c79 0a2a 2060 5b6e 675d 6020 6973 2074  ly.* `[ng]` is t
+00007510: 6865 206f 6e65 7320 7468 6174 2066 6169  he ones that fai
+00007520: 6c65 6420 2f20 676f 7420 7265 6a65 6374  led / got reject
+00007530: 6564 2028 616c 7265 6164 7920 6578 6973  ed (already exis
+00007540: 7473 2c20 2e2e 2e29 0a2a 2060 5b64 6f6e  ts, ...).* `[don
+00007550: 655d 6020 7368 6f77 7320 6120 636f 6d62  e]` shows a comb
+00007560: 696e 6564 206c 6973 7420 6f66 2060 5b6f  ined list of `[o
+00007570: 6b5d 6020 616e 6420 605b 6e67 5d60 2c20  k]` and `[ng]`, 
+00007580: 6368 726f 6e6f 6c6f 6769 6361 6c20 6f72  chronological or
+00007590: 6465 720a 2a20 605b 6275 7379 5d60 2066  der.* `[busy]` f
+000075a0: 696c 6573 2077 6869 6368 2061 7265 2063  iles which are c
+000075b0: 7572 7265 6e74 6c79 2068 6173 6869 6e67  urrently hashing
+000075c0: 2c20 7065 6e64 696e 672d 7570 6c6f 6164  , pending-upload
+000075d0: 2c20 6f72 2075 706c 6f61 6469 6e67 0a20  , or uploading. 
+000075e0: 202a 2070 6c75 7320 7570 2074 6f20 3320   * plus up to 3 
+000075f0: 656e 7472 6965 7320 6561 6368 2066 726f  entries each fro
+00007600: 6d20 605b 646f 6e65 5d60 2061 6e64 2060  m `[done]` and `
+00007610: 5b71 7565 5d60 2066 6f72 2063 6f6e 7465  [que]` for conte
+00007620: 7874 0a2a 2060 5b71 7565 5d60 2069 7320  xt.* `[que]` is 
+00007630: 616c 6c20 7468 6520 6669 6c65 7320 7468  all the files th
+00007640: 6174 2061 7265 2073 7469 6c6c 2071 7565  at are still que
+00007650: 7565 640a 0a6e 6f74 6520 7468 6174 2073  ued..note that s
+00007660: 696e 6365 2075 7032 6b20 6861 7320 746f  ince up2k has to
+00007670: 2072 6561 6420 6561 6368 2066 696c 6520   read each file 
+00007680: 7477 6963 652c 2060 5bf0 9f8e 885d 2062  twice, `[....] b
+00007690: 7570 6020 6361 6e20 2a74 6865 6f72 6574  up` can *theoret
+000076a0: 6963 616c 6c79 2a20 6265 2075 7020 746f  ically* be up to
+000076b0: 2032 7820 6661 7374 6572 2069 6e20 736f   2x faster in so
+000076c0: 6d65 2065 7874 7265 6d65 2063 6173 6573  me extreme cases
+000076d0: 2028 6669 6c65 7320 6269 6767 6572 2074   (files bigger t
+000076e0: 6861 6e20 796f 7572 2072 616d 2c20 636f  han your ram, co
+000076f0: 6d62 696e 6564 2077 6974 6820 616e 2069  mbined with an i
+00007700: 6e74 6572 6e65 7420 636f 6e6e 6563 7469  nternet connecti
+00007710: 6f6e 2066 6173 7465 7220 7468 616e 2074  on faster than t
+00007720: 6865 2072 6561 642d 7370 6565 6420 6f66  he read-speed of
+00007730: 2079 6f75 7220 4844 442c 206f 7220 6966   your HDD, or if
+00007740: 2079 6f75 2772 6520 7570 6c6f 6164 696e   you're uploadin
+00007750: 6720 6672 6f6d 2061 2063 756f 3264 756f  g from a cuo2duo
+00007760: 290a 0a69 6620 796f 7520 6172 6520 7265  )..if you are re
+00007770: 7375 6d69 6e67 2061 206d 6173 7369 7665  suming a massive
+00007780: 2075 706c 6f61 6420 616e 6420 7761 6e74   upload and want
+00007790: 2074 6f20 736b 6970 2068 6173 6869 6e67   to skip hashing
+000077a0: 2074 6865 2066 696c 6573 2077 6869 6368   the files which
+000077b0: 2061 6c72 6561 6479 2066 696e 6973 6865   already finishe
+000077c0: 642c 2079 6f75 2063 616e 2065 6e61 626c  d, you can enabl
+000077d0: 6520 6074 7572 626f 6020 696e 2074 6865  e `turbo` in the
+000077e0: 2060 5be2 9a99 efb8 8f5d 2063 6f6e 6669   `[......] confi
+000077f0: 6760 2074 6162 2c20 6275 7420 706c 6561  g` tab, but plea
+00007800: 7365 2072 6561 6420 7468 6520 746f 6f6c  se read the tool
+00007810: 7469 7020 6f6e 2074 6861 7420 6275 7474  tip on that butt
+00007820: 6f6e 0a0a 0a23 2323 2066 696c 652d 7365  on...### file-se
+00007830: 6172 6368 0a0a 6472 6f70 7069 6e67 2066  arch..dropping f
+00007840: 696c 6573 2069 6e74 6f20 7468 6520 6272  iles into the br
+00007850: 6f77 7365 7220 616c 736f 206c 6574 7320  owser also lets 
+00007860: 796f 7520 7365 6520 6966 2074 6865 7920  you see if they 
+00007870: 6578 6973 7420 6f6e 2074 6865 2073 6572  exist on the ser
+00007880: 7665 720a 0a21 5b63 6f70 7970 6172 7479  ver..![copyparty
+00007890: 2d66 7365 6172 6368 2d66 7338 5d28 6874  -fsearch-fs8](ht
+000078a0: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+000078b0: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+000078c0: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+000078d0: 3239 3633 3533 3631 2d63 3739 3238 3666  29635361-c79286f
+000078e0: 302d 6238 6631 2d34 3430 652d 6161 6634  0-b8f1-440e-aaf4
+000078f0: 2d36 6539 3239 3432 3866 6163 392e 706e  -6e929428fac9.pn
+00007900: 6729 0a0a 7768 656e 2079 6f75 2064 7261  g)..when you dra
+00007910: 672f 6472 6f70 2066 696c 6573 2069 6e74  g/drop files int
+00007920: 6f20 7468 6520 6272 6f77 7365 722c 2079  o the browser, y
+00007930: 6f75 2077 696c 6c20 7365 6520 7477 6f20  ou will see two 
+00007940: 6472 6f70 7a6f 6e65 733a 2060 5570 6c6f  dropzones: `Uplo
+00007950: 6164 6020 616e 6420 6053 6561 7263 6860  ad` and `Search`
+00007960: 0a0a 3e20 6f6e 2061 2070 686f 6e65 3f20  ..> on a phone? 
+00007970: 746f 6767 6c65 2074 6865 2060 5bf0 9f94  toggle the `[...
+00007980: 8e5d 6020 7377 6974 6368 2067 7265 656e  .]` switch green
+00007990: 2062 6566 6f72 6520 7461 7070 696e 6720   before tapping 
+000079a0: 7468 6520 6269 6720 7965 6c6c 6f77 2053  the big yellow S
+000079b0: 6561 7263 6820 6275 7474 6f6e 2074 6f20  earch button to 
+000079c0: 7365 6c65 6374 2079 6f75 7220 6669 6c65  select your file
+000079d0: 730a 0a74 6865 2066 696c 6573 2077 696c  s..the files wil
+000079e0: 6c20 6265 2068 6173 6865 6420 6f6e 2074  l be hashed on t
+000079f0: 6865 2063 6c69 656e 742d 7369 6465 2c20  he client-side, 
+00007a00: 616e 6420 6561 6368 2068 6173 6820 6973  and each hash is
+00007a10: 2073 656e 7420 746f 2074 6865 2073 6572   sent to the ser
+00007a20: 7665 722c 2077 6869 6368 2063 6865 636b  ver, which check
+00007a30: 7320 6966 2074 6861 7420 6669 6c65 2065  s if that file e
+00007a40: 7869 7374 7320 736f 6d65 7768 6572 650a  xists somewhere.
+00007a50: 0a66 696c 6573 2067 6f20 696e 746f 2060  .files go into `
+00007a60: 5b6f 6b5d 6020 6966 2074 6865 7920 6578  [ok]` if they ex
+00007a70: 6973 7420 2861 6e64 2079 6f75 2067 6574  ist (and you get
+00007a80: 2061 206c 696e 6b20 746f 2077 6865 7265   a link to where
+00007a90: 2069 7420 6973 292c 206f 7468 6572 7769   it is), otherwi
+00007aa0: 7365 2074 6865 7920 6c61 6e64 2069 6e20  se they land in 
+00007ab0: 605b 6e67 5d60 0a2a 2074 6865 206d 6169  `[ng]`.* the mai
+00007ac0: 6e20 7265 6173 6f6e 2066 696c 6573 6561  n reason filesea
+00007ad0: 7263 6820 6973 2063 6f6d 6269 6e65 6420  rch is combined 
+00007ae0: 7769 7468 2074 6865 2075 706c 6f61 6465  with the uploade
+00007af0: 7220 6973 2063 6175 7365 2074 6865 2063  r is cause the c
+00007b00: 6f64 6520 7761 7320 746f 6f20 7370 6167  ode was too spag
+00007b10: 6865 7474 6920 746f 2073 6570 6172 6174  hetti to separat
+00007b20: 6520 6974 206f 7574 2073 6f6d 6577 6865  e it out somewhe
+00007b30: 7265 2065 6c73 652c 2074 6869 7320 6973  re else, this is
+00007b40: 206e 6f20 6c6f 6e67 6572 2074 6865 2063   no longer the c
+00007b50: 6173 6520 6275 7420 6e6f 7720 6927 7665  ase but now i've
+00007b60: 2077 6172 6d65 6420 7570 2074 6f20 7468   warmed up to th
+00007b70: 6520 6964 6561 2074 6f6f 206d 7563 680a  e idea too much.
+00007b80: 0a0a 2323 2320 756e 706f 7374 0a0a 756e  ..### unpost..un
+00007b90: 646f 2f64 656c 6574 6520 6163 6369 6465  do/delete accide
+00007ba0: 6e74 616c 2075 706c 6f61 6473 0a0a 215b  ntal uploads..![
+00007bb0: 636f 7079 7061 7274 792d 756e 706f 7374  copyparty-unpost
+00007bc0: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
+00007bd0: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00007be0: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00007bf0: 3234 3130 3332 2f31 3239 3633 3533 3638  241032/129635368
+00007c00: 2d33 6166 6136 3633 342d 6332 3066 2d34  -3afa6634-c20f-4
+00007c10: 3138 632d 3930 6463 2d65 6334 3131 6633  18c-90dc-ec411f3
+00007c20: 6233 3839 372e 706e 6729 0a0a 796f 7520  b3897.png)..you 
+00007c30: 6361 6e20 756e 706f 7374 2065 7665 6e20  can unpost even 
+00007c40: 6966 2079 6f75 2064 6f6e 2774 2068 6176  if you don't hav
+00007c50: 6520 7265 6775 6c61 7220 6d6f 7665 2f64  e regular move/d
+00007c60: 656c 6574 6520 6163 6365 7373 2c20 686f  elete access, ho
+00007c70: 7765 7665 7220 6f6e 6c79 2066 6f72 2066  wever only for f
+00007c80: 696c 6573 2075 706c 6f61 6465 6420 7769  iles uploaded wi
+00007c90: 7468 696e 2074 6865 2070 6173 7420 602d  thin the past `-
+00007ca0: 2d75 6e70 6f73 7460 2073 6563 6f6e 6473  -unpost` seconds
+00007cb0: 2028 6465 6661 756c 7420 3132 2068 6f75   (default 12 hou
+00007cc0: 7273 2920 616e 6420 7468 6520 7365 7276  rs) and the serv
+00007cd0: 6572 206d 7573 7420 6265 2072 756e 6e69  er must be runni
+00007ce0: 6e67 2077 6974 6820 602d 6532 6460 0a0a  ng with `-e2d`..
+00007cf0: 0a23 2323 2073 656c 662d 6465 7374 7275  .### self-destru
+00007d00: 6374 0a0a 7570 6c6f 6164 7320 6361 6e20  ct..uploads can 
+00007d10: 6265 2067 6976 656e 2061 206c 6966 6574  be given a lifet
+00007d20: 696d 652c 2020 6166 6572 2077 6869 6368  ime,  afer which
+00007d30: 2074 6865 7920 6578 7069 7265 202f 2073   they expire / s
+00007d40: 656c 662d 6465 7374 7275 6374 0a0a 7468  elf-destruct..th
+00007d50: 6520 6665 6174 7572 6520 6d75 7374 2062  e feature must b
+00007d60: 6520 656e 6162 6c65 6420 7065 722d 766f  e enabled per-vo
+00007d70: 6c75 6d65 2077 6974 6820 7468 6520 606c  lume with the `l
+00007d80: 6966 6574 696d 6560 205b 7570 6c6f 6164  ifetime` [upload
+00007d90: 2072 756c 655d 2823 7570 6c6f 6164 2d72   rule](#upload-r
+00007da0: 756c 6573 2920 7768 6963 6820 7365 7473  ules) which sets
+00007db0: 2074 6865 2075 7070 6572 206c 696d 6974   the upper limit
+00007dc0: 2066 6f72 2068 6f77 206c 6f6e 6720 6120   for how long a 
+00007dd0: 6669 6c65 2067 6574 7320 746f 2073 7461  file gets to sta
+00007de0: 7920 6f6e 2074 6865 2073 6572 7665 720a  y on the server.
+00007df0: 0a63 6c69 656e 7473 2063 616e 2073 7065  .clients can spe
+00007e00: 6369 6679 2061 2073 686f 7274 6572 2065  cify a shorter e
+00007e10: 7870 6972 6174 696f 6e20 7469 6d65 2075  xpiration time u
+00007e20: 7369 6e67 2074 6865 205b 7570 326b 2075  sing the [up2k u
+00007e30: 695d 2823 7570 6c6f 6164 696e 6729 202d  i](#uploading) -
+00007e40: 2d20 7468 6520 7265 6c65 7661 6e74 206f  - the relevant o
+00007e50: 7074 696f 6e73 2062 6563 6f6d 6520 7669  ptions become vi
+00007e60: 7369 626c 6520 7570 6f6e 206e 6176 6967  sible upon navig
+00007e70: 6174 696e 6720 696e 746f 2061 2066 6f6c  ating into a fol
+00007e80: 6465 7220 7769 7468 2060 6c69 6665 7469  der with `lifeti
+00007e90: 6d65 7360 2065 6e61 626c 6564 202d 2d20  mes` enabled -- 
+00007ea0: 6f72 2062 7920 7573 696e 6720 7468 6520  or by using the 
+00007eb0: 606c 6966 6560 205b 7570 6c6f 6164 206d  `life` [upload m
+00007ec0: 6f64 6966 6965 725d 2823 7772 6974 6529  odifier](#write)
+00007ed0: 0a0a 7370 6563 6966 7969 6e67 2061 2063  ..specifying a c
+00007ee0: 7573 746f 6d20 6578 7069 7261 7469 6f6e  ustom expiration
+00007ef0: 2074 696d 6520 636c 6965 6e74 2d73 6964   time client-sid
+00007f00: 6520 7769 6c6c 2061 6666 6563 7420 7468  e will affect th
+00007f10: 6520 7469 6d65 7370 616e 2069 6e20 7768  e timespan in wh
+00007f20: 6963 6820 756e 706f 7374 7320 6172 6520  ich unposts are 
+00007f30: 7065 726d 6974 7465 642c 2073 6f20 6b65  permitted, so ke
+00007f40: 6570 2061 6e20 6579 6520 6f6e 2074 6865  ep an eye on the
+00007f50: 2065 7374 696d 6174 6573 2069 6e20 7468   estimates in th
+00007f60: 6520 7570 326b 2075 690a 0a0a 2323 2066  e up2k ui...## f
+00007f70: 696c 6520 6d61 6e61 6765 720a 0a63 7574  ile manager..cut
+00007f80: 2f70 6173 7465 2c20 7265 6e61 6d65 2c20  /paste, rename, 
+00007f90: 616e 6420 6465 6c65 7465 2066 696c 6573  and delete files
+00007fa0: 2f66 6f6c 6465 7273 2028 6966 2079 6f75  /folders (if you
+00007fb0: 2068 6176 6520 7065 726d 6973 7369 6f6e   have permission
+00007fc0: 290a 0a66 696c 6520 7365 6c65 6374 696f  )..file selectio
+00007fd0: 6e3a 2063 6c69 636b 2073 6f6d 6577 6865  n: click somewhe
+00007fe0: 7265 206f 6e20 7468 6520 6c69 6e65 2028  re on the line (
+00007ff0: 6e6f 7420 7468 6520 6c69 6e6b 2069 7473  not the link its
+00008000: 6566 292c 2074 6865 6e3a 0a2a 2060 7370  ef), then:.* `sp
+00008010: 6163 6560 2074 6f20 746f 6767 6c65 0a2a  ace` to toggle.*
+00008020: 2060 7570 2f64 6f77 6e60 2074 6f20 6d6f   `up/down` to mo
+00008030: 7665 0a2a 2060 7368 6966 742d 7570 2f64  ve.* `shift-up/d
+00008040: 6f77 6e60 2074 6f20 6d6f 7665 2d61 6e64  own` to move-and
+00008050: 2d73 656c 6563 740a 2a20 6063 7472 6c2d  -select.* `ctrl-
+00008060: 7368 6966 742d 7570 2f64 6f77 6e60 2074  shift-up/down` t
+00008070: 6f20 616c 736f 2073 6372 6f6c 6c0a 0a2a  o also scroll..*
+00008080: 2063 7574 3a20 7365 6c65 6374 2073 6f6d   cut: select som
+00008090: 6520 6669 6c65 7320 616e 6420 6063 7472  e files and `ctr
+000080a0: 6c2d 7860 0a2a 2070 6173 7465 3a20 6063  l-x`.* paste: `c
+000080b0: 7472 6c2d 7660 2069 6e20 616e 6f74 6865  trl-v` in anothe
+000080c0: 7220 666f 6c64 6572 0a2a 2072 656e 616d  r folder.* renam
+000080d0: 653a 2060 4632 600a 0a79 6f75 2063 616e  e: `F2`..you can
+000080e0: 206d 6f76 6520 6669 6c65 7320 6163 726f   move files acro
+000080f0: 7373 2062 726f 7773 6572 2074 6162 7320  ss browser tabs 
+00008100: 2863 7574 2069 6e20 6f6e 6520 7461 622c  (cut in one tab,
+00008110: 2070 6173 7465 2069 6e20 616e 6f74 6865   paste in anothe
+00008120: 7229 0a0a 0a23 2320 6261 7463 6820 7265  r)...## batch re
+00008130: 6e61 6d65 0a0a 7365 6c65 6374 2073 6f6d  name..select som
+00008140: 6520 6669 6c65 7320 616e 6420 7072 6573  e files and pres
+00008150: 7320 6046 3260 2074 6f20 6272 696e 6720  s `F2` to bring 
+00008160: 7570 2074 6865 2072 656e 616d 6520 5549  up the rename UI
+00008170: 0a0a 215b 6261 7463 682d 7265 6e61 6d65  ..![batch-rename
+00008180: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
+00008190: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+000081a0: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+000081b0: 3234 3130 3332 2f31 3238 3433 3432 3034  241032/128434204
+000081c0: 2d65 6231 3336 3638 302d 3363 3037 2d34  -eb136680-3c07-4
+000081d0: 6563 372d 3932 6530 2d61 6538 3661 6632  ec7-92e0-ae86af2
+000081e0: 3063 3234 312e 706e 6729 0a0a 7175 6963  0c241.png)..quic
+000081f0: 6b20 6578 706c 616e 6174 696f 6e20 6f66  k explanation of
+00008200: 2074 6865 2062 7574 746f 6e73 2c20 200a   the buttons,  .
+00008210: 2a20 605b e29c 8520 6170 706c 7920 7265  * `[... apply re
+00008220: 6e61 6d65 5d60 2063 6f6e 6669 726d 7320  name]` confirms 
+00008230: 616e 6420 6265 6769 6e73 2072 656e 616d  and begins renam
+00008240: 696e 670a 2a20 605b e29d 8c20 6361 6e63  ing.* `[... canc
+00008250: 656c 5d60 2061 626f 7274 7320 616e 6420  el]` aborts and 
+00008260: 636c 6f73 6573 2074 6865 2072 656e 616d  closes the renam
+00008270: 6520 7769 6e64 6f77 0a2a 2060 5be2 86ba  e window.* `[...
+00008280: 2072 6573 6574 5d60 2072 6576 6572 7473   reset]` reverts
+00008290: 2061 6e79 2066 696c 656e 616d 6520 6368   any filename ch
+000082a0: 616e 6765 7320 6261 636b 2074 6f20 7468  anges back to th
+000082b0: 6520 6f72 6967 696e 616c 206e 616d 650a  e original name.
+000082c0: 2a20 605b 6465 636f 6465 5d60 2064 6f65  * `[decode]` doe
+000082d0: 7320 6120 5552 4c2d 6465 636f 6465 206f  s a URL-decode o
+000082e0: 6e20 7468 6520 6669 6c65 6e61 6d65 2c20  n the filename, 
+000082f0: 6669 7869 6e67 2073 7475 6666 206c 696b  fixing stuff lik
+00008300: 6520 6026 616d 703b 6020 616e 6420 6025  e `&amp;` and `%
+00008310: 3230 600a 2a20 605b 6164 7661 6e63 6564  20`.* `[advanced
+00008320: 5d60 2074 6f67 676c 6573 2061 6476 616e  ]` toggles advan
+00008330: 6365 6420 6d6f 6465 0a0a 6164 7661 6e63  ced mode..advanc
+00008340: 6564 206d 6f64 653a 2072 656e 616d 6520  ed mode: rename 
+00008350: 6669 6c65 7320 6261 7365 6420 6f6e 2072  files based on r
+00008360: 756c 6573 2074 6f20 6465 6369 6465 2074  ules to decide t
+00008370: 6865 206e 6577 206e 616d 6573 2c20 6261  he new names, ba
+00008380: 7365 6420 6f6e 2074 6865 206f 7269 6769  sed on the origi
+00008390: 6e61 6c20 6e61 6d65 2028 7265 6765 7829  nal name (regex)
+000083a0: 2c20 6f72 2062 6173 6564 206f 6e20 7468  , or based on th
+000083b0: 6520 7461 6773 2063 6f6c 6c65 6374 6564  e tags collected
+000083c0: 2066 726f 6d20 7468 6520 6669 6c65 2028   from the file (
+000083d0: 6172 7469 7374 2f74 6974 6c65 2f2e 2e2e  artist/title/...
+000083e0: 292c 206f 7220 6120 6d69 7820 6f66 2062  ), or a mix of b
+000083f0: 6f74 680a 0a69 6e20 6164 7661 6e63 6564  oth..in advanced
+00008400: 206d 6f64 652c 2020 0a2a 2060 5b63 6173   mode,  .* `[cas
+00008410: 655d 6020 746f 6767 6c65 7320 6361 7365  e]` toggles case
+00008420: 2d73 656e 7369 7469 7665 2072 6567 6578  -sensitive regex
+00008430: 0a2a 2060 7265 6765 7860 2069 7320 7468  .* `regex` is th
+00008440: 6520 7265 6765 7820 7061 7474 6572 6e20  e regex pattern 
+00008450: 746f 2061 7070 6c79 2074 6f20 7468 6520  to apply to the 
+00008460: 6f72 6967 696e 616c 2066 696c 656e 616d  original filenam
+00008470: 653b 2061 6e79 2066 696c 6573 2077 6869  e; any files whi
+00008480: 6368 2064 6f6e 2774 206d 6174 6368 2077  ch don't match w
+00008490: 696c 6c20 6265 2073 6b69 7070 6564 0a2a  ill be skipped.*
+000084a0: 2060 666f 726d 6174 6020 6973 2074 6865   `format` is the
+000084b0: 206e 6577 2066 696c 656e 616d 652c 2074   new filename, t
+000084c0: 616b 696e 6720 7661 6c75 6573 2066 726f  aking values fro
+000084d0: 6d20 7265 6765 7820 6361 7074 7572 696e  m regex capturin
+000084e0: 6720 6772 6f75 7073 2061 6e64 2f6f 7220  g groups and/or 
+000084f0: 6672 6f6d 2066 696c 6520 7461 6773 0a20  from file tags. 
+00008500: 202a 2076 6572 7920 6c6f 6f73 656c 7920   * very loosely 
+00008510: 6261 7365 6420 6f6e 2066 6f6f 6261 7232  based on foobar2
+00008520: 3030 3020 7379 6e74 6178 0a2a 2060 7072  000 syntax.* `pr
+00008530: 6573 6574 7360 206c 6574 7320 796f 7520  esets` lets you 
+00008540: 7361 7665 2072 656e 616d 6520 7275 6c65  save rename rule
+00008550: 7320 666f 7220 6c61 7465 720a 0a61 7661  s for later..ava
+00008560: 696c 6162 6c65 2066 756e 6374 696f 6e73  ilable functions
+00008570: 3a0a 2a20 6024 6c70 6164 2874 6578 742c  :.* `$lpad(text,
+00008580: 206c 656e 6774 682c 2070 6164 5f63 6861   length, pad_cha
+00008590: 7229 600a 2a20 6024 7270 6164 2874 6578  r)`.* `$rpad(tex
+000085a0: 742c 206c 656e 6774 682c 2070 6164 5f63  t, length, pad_c
+000085b0: 6861 7229 600a 0a73 6f2c 0a0a 7361 7920  har)`..so,..say 
+000085c0: 796f 7520 6861 7665 2061 2066 696c 6520  you have a file 
+000085d0: 6e61 6d65 6420 5b60 6d65 6761 6e65 6b6f  named [`meganeko
+000085e0: 202d 2045 636c 6970 7365 202d 2030 3720   - Eclipse - 07 
+000085f0: 5369 7269 7573 2041 2e6d 7033 605d 2868  Sirius A.mp3`](h
+00008600: 7474 7073 3a2f 2f77 7777 2e79 6f75 7475  ttps://www.youtu
+00008610: 6265 2e63 6f6d 2f77 6174 6368 3f76 3d2d  be.com/watch?v=-
+00008620: 6474 6230 7644 5072 7549 2920 2861 6273  dtb0vDPruI) (abs
+00008630: 6f6c 7574 656c 7920 6661 6e74 6173 7469  olutely fantasti
+00008640: 6320 616c 6275 6d20 6274 7729 2061 6e64  c album btw) and
+00008650: 2074 6865 2074 6167 7320 6172 653a 2060   the tags are: `
+00008660: 416c 6275 6d3a 4563 6c69 7073 6560 2c20  Album:Eclipse`, 
+00008670: 6041 7274 6973 743a 6d65 6761 6e65 6b6f  `Artist:meganeko
+00008680: 602c 2060 5469 746c 653a 5369 7269 7573  `, `Title:Sirius
+00008690: 2041 602c 2060 746e 3a37 600a 0a79 6f75   A`, `tn:7`..you
+000086a0: 2063 6f75 6c64 2075 7365 206a 7573 7420   could use just 
+000086b0: 7265 6765 7820 746f 2072 656e 616d 6520  regex to rename 
+000086c0: 6974 3a0a 2a20 6072 6567 6578 6020 3d20  it:.* `regex` = 
+000086d0: 6028 2e2a 2920 2d20 282e 2a29 202d 2028  `(.*) - (.*) - (
+000086e0: 5b30 2d39 5d7b 327d 2920 282e 2a29 600a  [0-9]{2}) (.*)`.
+000086f0: 2a20 6066 6f72 6d61 7460 203d 2060 2833  * `format` = `(3
+00008700: 292e 2028 3129 202d 2028 3429 600a 2a20  ). (1) - (4)`.* 
+00008710: 606f 7574 7075 7460 203d 2060 3037 2e20  `output` = `07. 
+00008720: 6d65 6761 6e65 6b6f 202d 2053 6972 6975  meganeko - Siriu
+00008730: 7320 412e 6d70 3360 0a0a 6f72 2079 6f75  s A.mp3`..or you
+00008740: 2063 6f75 6c64 2075 7365 206a 7573 7420   could use just 
+00008750: 7461 6773 3a0a 2a20 6066 6f72 6d61 7460  tags:.* `format`
+00008760: 203d 2060 246c 7061 6428 2874 6e29 2c32   = `$lpad((tn),2
+00008770: 2c30 292e 2028 6172 7469 7374 2920 2d20  ,0). (artist) - 
+00008780: 2874 6974 6c65 292e 2865 7874 2960 0a2a  (title).(ext)`.*
+00008790: 2060 6f75 7470 7574 6020 3d20 6037 2e20   `output` = `7. 
+000087a0: 6d65 6761 6e65 6b6f 202d 2053 6972 6975  meganeko - Siriu
+000087b0: 7320 412e 6d70 3360 0a0a 6f72 2061 206d  s A.mp3`..or a m
+000087c0: 6978 206f 6620 626f 7468 3a0a 2a20 6072  ix of both:.* `r
+000087d0: 6567 6578 6020 3d20 6020 2d20 285b 302d  egex` = ` - ([0-
+000087e0: 395d 7b32 7d29 2060 0a2a 2060 666f 726d  9]{2}) `.* `form
+000087f0: 6174 6020 3d20 6028 3129 2e20 2861 7274  at` = `(1). (art
+00008800: 6973 7429 202d 2028 7469 746c 6529 2e28  ist) - (title).(
+00008810: 6578 7429 600a 2a20 606f 7574 7075 7460  ext)`.* `output`
+00008820: 203d 2060 3037 2e20 6d65 6761 6e65 6b6f   = `07. meganeko
+00008830: 202d 2053 6972 6975 7320 412e 6d70 3360   - Sirius A.mp3`
+00008840: 0a0a 7468 6520 6d65 7461 6461 7461 206b  ..the metadata k
+00008850: 6579 7320 796f 7520 6361 6e20 7573 6520  eys you can use 
+00008860: 696e 2074 6865 2066 6f72 6d61 7420 6669  in the format fi
+00008870: 656c 6420 6172 6520 7468 6520 6f6e 6573  eld are the ones
+00008880: 2069 6e20 7468 6520 6669 6c65 2d62 726f   in the file-bro
+00008890: 7773 6572 2074 6162 6c65 2068 6561 6465  wser table heade
+000088a0: 7220 2877 6861 7465 7665 7220 6973 2063  r (whatever is c
+000088b0: 6f6c 6c65 6374 6564 2077 6974 6820 602d  ollected with `-
+000088c0: 6d74 6560 2061 6e64 2060 2d6d 7470 6029  mte` and `-mtp`)
+000088d0: 0a0a 0a23 2320 6d65 6469 6120 706c 6179  ...## media play
+000088e0: 6572 0a0a 706c 6179 7320 616c 6d6f 7374  er..plays almost
+000088f0: 2065 7665 7279 2061 7564 696f 2066 6f72   every audio for
+00008900: 6d61 7420 7468 6572 6520 6973 2020 2869  mat there is  (i
+00008910: 6620 7468 6520 7365 7276 6572 2068 6173  f the server has
+00008920: 2046 466d 7065 6720 696e 7374 616c 6c65   FFmpeg installe
+00008930: 6420 666f 7220 6f6e 2d64 656d 616e 6420  d for on-demand 
+00008940: 7472 616e 7363 6f64 696e 6729 0a0a 7468  transcoding)..th
+00008950: 6520 666f 6c6c 6f77 696e 6720 6175 6469  e following audi
+00008960: 6f20 666f 726d 6174 7320 6172 6520 7573  o formats are us
+00008970: 7561 6c6c 7920 616c 7761 7973 2070 6c61  ually always pla
+00008980: 7961 626c 652c 2065 7665 6e20 7769 7468  yable, even with
+00008990: 6f75 7420 4646 6d70 6567 3a20 6061 6163  out FFmpeg: `aac
+000089a0: 7c66 6c61 637c 6d34 617c 6d70 337c 6f67  |flac|m4a|mp3|og
+000089b0: 677c 6f70 7573 7c77 6176 600a 0a73 6f6d  g|opus|wav`..som
+000089c0: 6520 6869 6c69 6768 7473 3a0a 2a20 4f53  e hilights:.* OS
+000089d0: 2069 6e74 6567 7261 7469 6f6e 3b20 636f   integration; co
+000089e0: 6e74 726f 6c20 706c 6179 6261 636b 2066  ntrol playback f
+000089f0: 726f 6d20 796f 7572 2070 686f 6e65 2773  rom your phone's
+00008a00: 206c 6f63 6b73 6372 6565 6e20 285b 7769   lockscreen ([wi
+00008a10: 6e64 6f77 735d 2868 7474 7073 3a2f 2f75  ndows](https://u
+00008a20: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
+00008a30: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
+00008a40: 2f32 3431 3033 322f 3233 3332 3133 3032  /241032/23321302
+00008a50: 322d 3239 3861 3938 6261 2d37 3231 612d  2-298a98ba-721a-
+00008a60: 3463 6631 2d61 3364 342d 6636 3236 3334  4cf1-a3d4-f62634
+00008a70: 6263 3533 6435 2e70 6e67 2920 2f2f 205b  bc53d5.png) // [
+00008a80: 694f 535d 2868 7474 7073 3a2f 2f75 7365  iOS](https://use
+00008a90: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
+00008aa0: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
+00008ab0: 3431 3033 322f 3134 3237 3131 3932 362d  41032/142711926-
+00008ac0: 3037 3030 6265 3663 2d33 6533 312d 3437  0700be6c-3e31-47
+00008ad0: 6233 2d39 3932 382d 3533 3732 3232 3231  b3-9928-53722221
+00008ae0: 6637 3232 2e70 6e67 2920 2f2f 205b 616e  f722.png) // [an
+00008af0: 6472 6f69 645d 2868 7474 7073 3a2f 2f75  droid](https://u
+00008b00: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
+00008b10: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
+00008b20: 2f32 3431 3033 322f 3233 3332 3132 3331  /241032/23321231
+00008b30: 312d 6137 3336 3835 3930 2d30 3863 372d  1-a7368590-08c7-
+00008b40: 3466 3966 2d61 3161 662d 3438 6363 6633  4f9f-a1af-48ccf3
+00008b50: 6633 3666 6164 2e70 6e67 2929 0a2a 2073  f36fad.png)).* s
+00008b60: 686f 7773 2074 6865 2061 7564 696f 2077  hows the audio w
+00008b70: 6176 6566 6f72 6d20 696e 2074 6865 2073  aveform in the s
+00008b80: 6565 6b62 6172 0a2a 206e 6f74 2070 6572  eekbar.* not per
+00008b90: 6665 6374 6c79 2067 6170 6c65 7373 2062  fectly gapless b
+00008ba0: 7574 2063 616e 2067 6574 2072 6561 6c6c  ut can get reall
+00008bb0: 7920 636c 6f73 6520 2873 6565 2073 6574  y close (see set
+00008bc0: 7469 6e67 7320 2b20 6571 2062 656c 6f77  tings + eq below
+00008bd0: 293b 2067 6f6f 6420 656e 6f75 6768 2074  ); good enough t
+00008be0: 6f20 656e 6a6f 7920 6761 706c 6573 7320  o enjoy gapless 
+00008bf0: 616c 6275 6d73 2061 7320 696e 7465 6e64  albums as intend
+00008c00: 6564 0a0a 636c 6963 6b20 7468 6520 6070  ed..click the `p
+00008c10: 6c61 7960 206c 696e 6b20 6e65 7874 2074  lay` link next t
+00008c20: 6f20 616e 2061 7564 696f 2066 696c 652c  o an audio file,
+00008c30: 206f 7220 636f 7079 2074 6865 206c 696e   or copy the lin
+00008c40: 6b20 7461 7267 6574 2074 6f20 5b73 6861  k target to [sha
+00008c50: 7265 2069 745d 2868 7474 7073 3a2f 2f61  re it](https://a
+00008c60: 2e6f 6376 2e6d 652f 7075 622f 6465 6d6f  .ocv.me/pub/demo
+00008c70: 2f6d 7573 6963 2f55 6269 6b74 756e 6525  /music/Ubiktune%
+00008c80: 3230 2d25 3230 534f 554e 4453 484f 434b  20-%20SOUNDSHOCK
+00008c90: 2532 3032 2532 302d 2532 3046 4d25 3230  %202%20-%20FM%20
+00008ca0: 4655 4e4b 2532 3054 4552 5252 4f52 2121  FUNK%20TERRROR!!
+00008cb0: 2f23 6166 2d31 6662 6662 6136 3126 743d  /#af-1fbfba61&t=
+00008cc0: 3138 2920 286f 7074 696f 6e61 6c6c 7920  18) (optionally 
+00008cd0: 7769 7468 2061 2074 696d 6573 7461 6d70  with a timestamp
+00008ce0: 2074 6f20 7374 6172 7420 706c 6179 696e   to start playin
+00008cf0: 6720 6672 6f6d 2c20 6c69 6b65 2074 6861  g from, like tha
+00008d00: 7420 6578 616d 706c 6520 646f 6573 290a  t example does).
+00008d10: 0a6f 7065 6e20 7468 6520 605b f09f 8eba  .open the `[....
+00008d20: 5d60 206d 6564 6961 2d70 6c61 7965 722d  ]` media-player-
+00008d30: 7365 7474 696e 6773 2074 6162 2074 6f20  settings tab to 
+00008d40: 636f 6e66 6967 7572 6520 6974 2c0a 2a20  configure it,.* 
+00008d50: 7377 6974 6368 6573 3a0a 2020 2a20 605b  switches:.  * `[
+00008d60: 7072 656c 6f61 645d 6020 7374 6172 7473  preload]` starts
+00008d70: 206c 6f61 6469 6e67 2074 6865 206e 6578   loading the nex
+00008d80: 7420 7472 6163 6b20 7768 656e 2069 7427  t track when it'
+00008d90: 7320 6162 6f75 7420 746f 2065 6e64 2c20  s about to end, 
+00008da0: 7265 6475 6365 7320 7468 6520 7369 6c65  reduces the sile
+00008db0: 6e63 6520 6265 7477 6565 6e20 736f 6e67  nce between song
+00008dc0: 730a 2020 2a20 605b 6675 6c6c 5d60 2064  s.  * `[full]` d
+00008dd0: 6f65 7320 6120 6675 6c6c 2070 7265 6c6f  oes a full prelo
+00008de0: 6164 2062 7920 646f 776e 6c6f 6164 696e  ad by downloadin
+00008df0: 6720 7468 6520 656e 7469 7265 206e 6578  g the entire nex
+00008e00: 7420 6669 6c65 3b20 676f 6f64 2066 6f72  t file; good for
+00008e10: 2075 6e72 656c 6961 626c 6520 636f 6e6e   unreliable conn
+00008e20: 6563 7469 6f6e 732c 2062 6164 2066 6f72  ections, bad for
+00008e30: 2073 6c6f 7720 636f 6e6e 6563 7469 6f6e   slow connection
+00008e40: 730a 2020 2a20 605b 7e73 5d60 2074 6f67  s.  * `[~s]` tog
+00008e50: 676c 6573 2074 6865 2073 6565 6b62 6172  gles the seekbar
+00008e60: 2077 6176 6566 6f72 6d20 6469 7370 6c61   waveform displa
+00008e70: 790a 2020 2a20 605b 2f6e 705d 6020 656e  y.  * `[/np]` en
+00008e80: 6162 6c65 7320 6275 7474 6f6e 7320 746f  ables buttons to
+00008e90: 2063 6f70 7920 7468 6520 6e6f 772d 706c   copy the now-pl
+00008ea0: 6179 696e 6720 696e 666f 2061 7320 616e  aying info as an
+00008eb0: 2069 7263 206d 6573 7361 6765 0a20 202a   irc message.  *
+00008ec0: 2060 5b6f 732d 6374 6c5d 6020 6d61 6b65   `[os-ctl]` make
+00008ed0: 7320 6974 2070 6f73 7369 626c 6520 746f  s it possible to
+00008ee0: 2063 6f6e 7472 6f6c 2061 7564 696f 2070   control audio p
+00008ef0: 6c61 7962 6163 6b20 6672 6f6d 2074 6865  layback from the
+00008f00: 206c 6f63 6b73 6372 6565 6e20 6f66 2079   lockscreen of y
+00008f10: 6f75 7220 6465 7669 6365 2028 656e 6162  our device (enab
+00008f20: 6c65 7320 5b6d 6564 6961 7365 7373 696f  les [mediasessio
+00008f30: 6e5d 2868 7474 7073 3a2f 2f64 6576 656c  n](https://devel
+00008f40: 6f70 6572 2e6d 6f7a 696c 6c61 2e6f 7267  oper.mozilla.org
+00008f50: 2f65 6e2d 5553 2f64 6f63 732f 5765 622f  /en-US/docs/Web/
+00008f60: 4150 492f 4d65 6469 6153 6573 7369 6f6e  API/MediaSession
+00008f70: 2929 0a20 202a 2060 5b73 6565 6b5d 6020  )).  * `[seek]` 
+00008f80: 616c 6c6f 7773 2073 6565 6b69 6e67 2077  allows seeking w
+00008f90: 6974 6820 6c6f 636b 7363 7265 656e 2063  ith lockscreen c
+00008fa0: 6f6e 7472 6f6c 7320 2862 7567 6779 206f  ontrols (buggy o
+00008fb0: 6e20 736f 6d65 2064 6576 6963 6573 290a  n some devices).
+00008fc0: 2020 2a20 605b 6172 745d 6020 7368 6f77    * `[art]` show
+00008fd0: 7320 616c 6275 6d20 6172 7420 6f6e 2074  s album art on t
+00008fe0: 6865 206c 6f63 6b73 6372 6565 6e0a 2020  he lockscreen.  
+00008ff0: 2a20 605b f09f 8eaf 5d60 206b 6565 7073  * `[....]` keeps
+00009000: 2074 6865 2070 6c61 7969 6e67 2073 6f6e   the playing son
+00009010: 6720 7363 726f 6c6c 6564 2069 6e74 6f20  g scrolled into 
+00009020: 7669 6577 2028 676f 6f64 2077 6865 6e20  view (good when 
+00009030: 7573 696e 6720 7468 6520 706c 6179 6572  using the player
+00009040: 2061 7320 6120 7461 736b 6261 7220 646f   as a taskbar do
+00009050: 636b 290a 2020 2a20 605b e29f 8e5d 6020  ck).  * `[...]` 
+00009060: 7368 7269 6e6b 7320 7468 6520 706c 6179  shrinks the play
+00009070: 6261 636b 2063 6f6e 7472 6f6c 730a 2a20  back controls.* 
+00009080: 706c 6179 6261 636b 206d 6f64 653a 0a20  playback mode:. 
+00009090: 202a 2060 5b6c 6f6f 705d 6020 6b65 6570   * `[loop]` keep
+000090a0: 7320 6c6f 6f70 696e 6720 7468 6520 666f  s looping the fo
+000090b0: 6c64 6572 0a20 202a 2060 5b6e 6578 745d  lder.  * `[next]
+000090c0: 6020 706c 6179 7320 696e 746f 2074 6865  ` plays into the
+000090d0: 206e 6578 7420 666f 6c64 6572 0a2a 2074   next folder.* t
+000090e0: 7261 6e73 636f 6465 3a0a 2020 2a20 605b  ranscode:.  * `[
+000090f0: 666c 6163 5d60 2063 6f6e 7665 7273 2060  flac]` convers `
+00009100: 666c 6163 6020 616e 6420 6077 6176 6020  flac` and `wav` 
+00009110: 6669 6c65 7320 696e 746f 206f 7075 730a  files into opus.
+00009120: 2020 2a20 605b 6161 635d 6020 636f 6e76    * `[aac]` conv
+00009130: 6572 7473 2060 6161 6360 2061 6e64 2060  erts `aac` and `
+00009140: 6d34 6160 2066 696c 6573 2069 6e74 6f20  m4a` files into 
+00009150: 6f70 7573 0a20 202a 2060 5b6f 7468 5d60  opus.  * `[oth]`
+00009160: 2063 6f6e 7665 7274 7320 616c 6c20 6f74   converts all ot
+00009170: 6865 7220 6b6e 6f77 6e20 666f 726d 6174  her known format
+00009180: 7320 696e 746f 206f 7075 730a 2020 2020  s into opus.    
+00009190: 2a20 6061 6163 7c61 6333 7c61 6966 7c61  * `aac|ac3|aif|a
+000091a0: 6966 667c 616c 6163 7c61 6c61 777c 616d  iff|alac|alaw|am
+000091b0: 727c 6170 657c 6175 7c64 6670 776d 7c64  r|ape|au|dfpwm|d
+000091c0: 7473 7c66 6c61 637c 6773 6d7c 6974 7c6d  ts|flac|gsm|it|m
+000091d0: 3461 7c6d 6f33 7c6d 6f64 7c6d 7032 7c6d  4a|mo3|mod|mp2|m
+000091e0: 7033 7c6d 7063 7c6d 7074 6d7c 6d74 327c  p3|mpc|mptm|mt2|
+000091f0: 6d75 6c61 777c 6f67 677c 6f6b 747c 6f70  mulaw|ogg|okt|op
+00009200: 7573 7c72 617c 7333 6d7c 7461 6b7c 7474  us|ra|s3m|tak|tt
+00009210: 617c 756c 6177 7c77 6176 7c77 6d61 7c77  a|ulaw|wav|wma|w
+00009220: 767c 786d 7c78 706b 600a 2a20 2274 696e  v|xm|xpk`.* "tin
+00009230: 7422 2072 6564 7563 6573 2074 6865 2063  t" reduces the c
+00009240: 6f6e 7472 6173 7420 6f66 2074 6865 2070  ontrast of the p
+00009250: 6c61 7962 6163 6b20 6261 720a 0a0a 2323  layback bar...##
+00009260: 2320 6175 6469 6f20 6571 7561 6c69 7a65  # audio equalize
+00009270: 720a 0a62 6173 7320 626f 6f73 7465 640a  r..bass boosted.
+00009280: 0a63 616e 2061 6c73 6f20 626f 6f73 7420  .can also boost 
+00009290: 7468 6520 766f 6c75 6d65 2069 6e20 6765  the volume in ge
+000092a0: 6e65 7261 6c2c 206f 7220 696e 6372 6561  neral, or increa
+000092b0: 7365 2f64 6563 7265 6173 6520 7374 6572  se/decrease ster
+000092c0: 656f 2077 6964 7468 2028 6c69 6b65 205b  eo width (like [
+000092d0: 6372 6f73 7366 6565 645d 2868 7474 7073  crossfeed](https
+000092e0: 3a2f 2f77 7777 2e66 6f6f 6261 7232 3030  ://www.foobar200
+000092f0: 302e 6f72 672f 636f 6d70 6f6e 656e 7473  0.org/components
+00009300: 2f76 6965 772f 666f 6f5f 6473 705f 6d65  /view/foo_dsp_me
+00009310: 6965 7263 6629 206a 7573 7420 776f 7273  iercf) just wors
+00009320: 6529 0a0a 6861 7320 7468 6520 636f 6e76  e)..has the conv
+00009330: 656e 6965 6e74 2073 6964 652d 6566 6665  enient side-effe
+00009340: 6374 206f 6620 7265 6475 6369 6e67 2074  ct of reducing t
+00009350: 6865 2070 6175 7365 2062 6574 7765 656e  he pause between
+00009360: 2073 6f6e 6773 2c20 736f 2067 6170 6c65   songs, so gaple
+00009370: 7373 2061 6c62 756d 7320 706c 6179 2062  ss albums play b
+00009380: 6574 7465 7220 7769 7468 2074 6865 2065  etter with the e
+00009390: 7120 656e 6162 6c65 6420 286a 7573 7420  q enabled (just 
+000093a0: 6d61 6b65 2069 7420 666c 6174 290a 0a0a  make it flat)...
+000093b0: 2323 2320 6669 7820 756e 7265 6c69 6162  ### fix unreliab
+000093c0: 6c65 2070 6c61 7962 6163 6b20 6f6e 2061  le playback on a
+000093d0: 6e64 726f 6964 0a0a 6475 6520 746f 2070  ndroid..due to p
+000093e0: 686f 6e65 202f 2061 7070 2073 6574 7469  hone / app setti
+000093f0: 6e67 732c 2020 616e 6472 6f69 6420 7068  ngs,  android ph
+00009400: 6f6e 6573 206d 6179 2072 616e 646f 6d6c  ones may randoml
+00009410: 7920 7374 6f70 2070 6c61 7969 6e67 206d  y stop playing m
+00009420: 7573 6963 2077 6865 6e20 7468 6520 706f  usic when the po
+00009430: 7765 7220 7361 7665 7220 6b69 636b 7320  wer saver kicks 
+00009440: 696e 2c20 6573 7065 6369 616c 6c79 2061  in, especially a
+00009450: 7420 7468 6520 656e 6420 6f66 2061 6e20  t the end of an 
+00009460: 616c 6275 6d20 2d2d 2079 6f75 2063 616e  album -- you can
+00009470: 2066 6978 2069 7420 6279 205b 6469 7361   fix it by [disa
+00009480: 626c 696e 6720 706f 7765 7220 7361 7669  bling power savi
+00009490: 6e67 5d28 6874 7470 733a 2f2f 7573 6572  ng](https://user
+000094a0: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
+000094b0: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
+000094c0: 3130 3332 2f32 3335 3236 3231 3233 2d63  1032/235262123-c
+000094d0: 3332 3863 6361 392d 3339 3330 2d34 3934  328cca9-3930-494
+000094e0: 382d 6264 3138 2d33 3934 3962 3966 6433  8-bd18-3949b9fd3
+000094f0: 6663 662e 706e 6729 2069 6e20 7468 6520  fcf.png) in the 
+00009500: 5b61 7070 2073 6574 7469 6e67 735d 2868  [app settings](h
+00009510: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+00009520: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00009530: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00009540: 3233 3532 3632 3132 312d 3266 6663 3531  235262121-2ffc51
+00009550: 6165 2d37 3832 312d 3433 3130 2d61 3332  ae-7821-4310-a32
+00009560: 322d 6333 6237 6135 3037 3839 3063 2e70  2-c3b7a507890c.p
+00009570: 6e67 2920 6f66 2074 6865 2062 726f 7773  ng) of the brows
+00009580: 6572 2079 6f75 2075 7365 2066 6f72 206d  er you use for m
+00009590: 7573 6963 2073 7472 6561 6d69 6e67 2028  usic streaming (
+000095a0: 7072 6566 6572 6162 6c79 2061 2064 6564  preferably a ded
+000095b0: 6963 6174 6564 206f 6e65 290a 0a0a 2323  icated one)...##
+000095c0: 206d 6172 6b64 6f77 6e20 7669 6577 6572   markdown viewer
+000095d0: 0a0a 616e 6420 7468 6572 6520 6172 6520  ..and there are 
+000095e0: 2a74 776f 2a20 6564 6974 6f72 730a 0a21  *two* editors..!
+000095f0: 5b63 6f70 7970 6172 7479 2d6d 642d 7265  [copyparty-md-re
+00009600: 6164 2d66 7338 5d28 6874 7470 733a 2f2f  ad-fs8](https://
+00009610: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+00009620: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+00009630: 6d2f 3234 3130 3332 2f31 3135 3937 3830  m/241032/1159780
+00009640: 3537 2d36 3634 3139 3038 302d 6135 3764  57-66419080-a57d
+00009650: 2d31 3165 622d 3835 3339 2d64 3262 6538  -11eb-8539-d2be8
+00009660: 3433 3939 3161 612e 706e 6729 0a0a 7468  43991aa.png)..th
+00009670: 6572 6520 6973 2061 2062 7569 6c74 2d69  ere is a built-i
+00009680: 6e20 6578 7465 6e73 696f 6e20 666f 7220  n extension for 
+00009690: 696e 6c69 6e65 2063 6c69 636b 6162 6c65  inline clickable
+000096a0: 2074 6875 6d62 6e61 696c 733b 0a2a 2065   thumbnails;.* e
+000096b0: 6e61 626c 6520 6974 2062 7920 6164 6469  nable it by addi
+000096c0: 6e67 2060 3c21 2d2d 2074 6820 2d2d 3e60  ng `<!-- th -->`
+000096d0: 2073 6f6d 6577 6865 7265 2069 6e20 7468   somewhere in th
+000096e0: 6520 646f 630a 2a20 6164 6420 7468 756d  e doc.* add thum
+000096f0: 626e 6169 6c73 2077 6974 6820 6021 7468  bnails with `!th
+00009700: 5b6c 5d28 796f 7572 2e6a 7067 2960 2077  [l](your.jpg)` w
+00009710: 6865 7265 2060 6c60 206d 6561 6e73 206c  here `l` means l
+00009720: 6566 742d 616c 6967 6e20 2860 7260 203d  eft-align (`r` =
+00009730: 2072 6967 6874 2d61 6c69 676e 290a 2a20   right-align).* 
+00009740: 6120 7369 6e67 6c65 206c 696e 6520 7769  a single line wi
+00009750: 7468 2060 2d2d 2d60 2063 6c65 6172 7320  th `---` clears 
+00009760: 7468 6520 666c 6f61 7420 2f20 696e 6c69  the float / inli
+00009770: 6e69 6e67 0a2a 2069 6e20 7468 6520 6361  ning.* in the ca
+00009780: 7365 206f 6620 5245 4144 4d45 2e6d 6420  se of README.md 
+00009790: 6265 696e 6720 6469 7370 6c61 7965 6420  being displayed 
+000097a0: 6265 6c6f 7720 6120 6669 6c65 206c 6973  below a file lis
+000097b0: 7469 6e67 2c20 7468 756d 626e 6169 6c73  ting, thumbnails
+000097c0: 2077 696c 6c20 6f70 656e 2069 6e20 7468   will open in th
+000097d0: 6520 6761 6c6c 6572 7920 7669 6577 6572  e gallery viewer
+000097e0: 0a0a 6f74 6865 7220 6e6f 7465 732c 0a2a  ..other notes,.*
+000097f0: 2074 6865 2064 6f63 756d 656e 7420 7072   the document pr
+00009800: 6576 6965 7720 6861 7320 6120 6d61 782d  eview has a max-
+00009810: 7769 6474 6820 7768 6963 6820 6973 2074  width which is t
+00009820: 6865 2073 616d 6520 6173 2061 6e20 4134  he same as an A4
+00009830: 2070 6170 6572 2077 6865 6e20 7072 696e   paper when prin
+00009840: 7465 640a 0a0a 2323 206f 7468 6572 2074  ted...## other t
+00009850: 7269 636b 730a 0a2a 2079 6f75 2063 616e  ricks..* you can
+00009860: 206c 696e 6b20 6120 7061 7274 6963 756c   link a particul
+00009870: 6172 2074 696d 6573 7461 6d70 2069 6e20  ar timestamp in 
+00009880: 616e 2061 7564 696f 2066 696c 6520 6279  an audio file by
+00009890: 2061 6464 696e 6720 6974 2074 6f20 7468   adding it to th
+000098a0: 6520 5552 4c2c 2073 7563 6820 6173 2060  e URL, such as `
+000098b0: 2632 3060 202f 2060 2632 3073 6020 2f20  &20` / `&20s` / 
+000098c0: 6026 316d 3230 6020 2f20 6026 743d 313a  `&1m20` / `&t=1:
+000098d0: 3230 6020 6166 7465 7220 7468 6520 602e  20` after the `.
+000098e0: 2e2e 2f23 6166 2d63 3839 3630 6461 6260  ../#af-c8960dab`
+000098f0: 0a0a 2a20 656e 6162 6c69 6e67 2074 6865  ..* enabling the
+00009900: 2061 7564 696f 2065 7175 616c 697a 6572   audio equalizer
+00009910: 2063 616e 2068 656c 7020 6d61 6b65 2067   can help make g
+00009920: 6170 6c65 7373 2061 6c62 756d 7320 6675  apless albums fu
+00009930: 6c6c 7920 6761 706c 6573 7320 696e 2073  lly gapless in s
+00009940: 6f6d 6520 6272 6f77 7365 7273 2028 6368  ome browsers (ch
+00009950: 726f 6d65 292c 2073 6f20 636f 6e73 6964  rome), so consid
+00009960: 6572 206c 6561 7669 6e67 2069 7420 6f6e  er leaving it on
+00009970: 2077 6974 6820 616c 6c20 7468 6520 7661   with all the va
+00009980: 6c75 6573 2061 7420 7a65 726f 0a0a 2a20  lues at zero..* 
+00009990: 6765 7420 6120 706c 6169 6e74 6578 7420  get a plaintext 
+000099a0: 6669 6c65 206c 6973 7469 6e67 2062 7920  file listing by 
+000099b0: 6164 6469 6e67 2060 3f6c 733d 7460 2074  adding `?ls=t` t
+000099c0: 6f20 6120 5552 4c2c 206f 7220 6120 636f  o a URL, or a co
+000099d0: 6d70 6163 7420 636f 6c6f 7265 6420 6f6e  mpact colored on
+000099e0: 6520 7769 7468 2060 3f6c 733d 7660 2028  e with `?ls=v` (
+000099f0: 666f 7220 756e 6978 2074 6572 6d69 6e61  for unix termina
+00009a00: 6c73 290a 0a2a 2069 6620 796f 7520 6172  ls)..* if you ar
+00009a10: 6520 7573 696e 6720 6d65 6469 6120 686f  e using media ho
+00009a20: 746b 6579 7320 746f 2073 7769 7463 6820  tkeys to switch 
+00009a30: 736f 6e67 7320 616e 6420 6172 6520 6765  songs and are ge
+00009a40: 7474 696e 6720 7469 7265 6420 6f66 2073  tting tired of s
+00009a50: 6565 696e 6720 7468 6520 4f53 4420 706f  eeing the OSD po
+00009a60: 7075 7020 7768 6963 6820 5769 6e64 6f77  pup which Window
+00009a70: 7320 646f 6573 6e27 7420 6c65 7420 796f  s doesn't let yo
+00009a80: 7520 6469 7361 626c 652c 2063 6f6e 7369  u disable, consi
+00009a90: 6465 7220 5b2e 2f63 6f6e 7472 6962 2f6d  der [./contrib/m
+00009aa0: 6564 6961 2d6f 7364 2d62 676f 6e65 2e70  edia-osd-bgone.p
+00009ab0: 7331 5d28 636f 6e74 7269 622f 236d 6564  s1](contrib/#med
+00009ac0: 6961 2d6f 7364 2d62 676f 6e65 7073 3129  ia-osd-bgoneps1)
+00009ad0: 0a0a 2a20 636c 6963 6b20 7468 6520 626f  ..* click the bo
+00009ae0: 7474 6f6d 2d6c 6566 7420 60cf 8060 2074  ttom-left `..` t
+00009af0: 6f20 6f70 656e 2061 206a 6176 6173 6372  o open a javascr
+00009b00: 6970 7420 7072 6f6d 7074 2066 6f72 2064  ipt prompt for d
+00009b10: 6562 7567 6769 6e67 0a0a 2a20 6669 6c65  ebugging..* file
+00009b20: 7320 6e61 6d65 6420 602e 7072 6f6c 6f67  s named `.prolog
+00009b30: 7565 2e68 746d 6c60 202f 2060 2e65 7069  ue.html` / `.epi
+00009b40: 6c6f 6775 652e 6874 6d6c 6020 7769 6c6c  logue.html` will
+00009b50: 2062 6520 7265 6e64 6572 6564 2062 6566   be rendered bef
+00009b60: 6f72 652f 6166 7465 7220 6469 7265 6374  ore/after direct
+00009b70: 6f72 7920 6c69 7374 696e 6773 2075 6e6c  ory listings unl
+00009b80: 6573 7320 602d 2d6e 6f2d 6c6f 6775 6573  ess `--no-logues
+00009b90: 600a 0a2a 2066 696c 6573 206e 616d 6564  `..* files named
+00009ba0: 2060 5245 4144 4d45 2e6d 6460 202f 2060   `README.md` / `
+00009bb0: 7265 6164 6d65 2e6d 6460 2077 696c 6c20  readme.md` will 
+00009bc0: 6265 2072 656e 6465 7265 6420 6166 7465  be rendered afte
+00009bd0: 7220 6469 7265 6374 6f72 7920 6c69 7374  r directory list
+00009be0: 696e 6773 2075 6e6c 6573 7320 602d 2d6e  ings unless `--n
+00009bf0: 6f2d 7265 6164 6d65 6020 2862 7574 2060  o-readme` (but `
+00009c00: 2e65 7069 6c6f 6775 652e 6874 6d6c 6020  .epilogue.html` 
+00009c10: 7461 6b65 7320 7072 6563 6564 656e 6365  takes precedence
+00009c20: 290a 0a0a 2323 2073 6561 7263 6869 6e67  )...## searching
+00009c30: 0a0a 7365 6172 6368 2062 7920 7369 7a65  ..search by size
+00009c40: 2c20 6461 7465 2c20 7061 7468 2f6e 616d  , date, path/nam
+00009c50: 652c 206d 7033 2d74 6167 732c 202e 2e2e  e, mp3-tags, ...
+00009c60: 0a0a 215b 636f 7079 7061 7274 792d 7365  ..![copyparty-se
+00009c70: 6172 6368 2d66 7338 5d28 6874 7470 733a  arch-fs8](https:
+00009c80: 2f2f 7573 6572 2d69 6d61 6765 732e 6769  //user-images.gi
+00009c90: 7468 7562 7573 6572 636f 6e74 656e 742e  thubusercontent.
+00009ca0: 636f 6d2f 3234 3130 3332 2f31 3239 3633  com/241032/12963
+00009cb0: 3533 3635 2d63 3066 6632 6139 662d 3065  5365-c0ff2a9f-0e
+00009cc0: 6535 2d34 6663 332d 3862 6236 2d30 3036  e5-4fc3-8bb6-006
+00009cd0: 3033 3363 6636 3762 382e 706e 6729 0a0a  033cf67b8.png)..
+00009ce0: 7768 656e 2073 7461 7274 6564 2077 6974  when started wit
+00009cf0: 6820 602d 6532 6473 6160 2063 6f70 7970  h `-e2dsa` copyp
+00009d00: 6172 7479 2077 696c 6c20 7363 616e 2f69  arty will scan/i
+00009d10: 6e64 6578 2061 6c6c 2079 6f75 7220 6669  ndex all your fi
+00009d20: 6c65 732e 2054 6869 7320 6176 6f69 6473  les. This avoids
+00009d30: 2064 7570 6c69 6361 7465 7320 6f6e 2075   duplicates on u
+00009d40: 706c 6f61 642c 2061 6e64 2061 6c73 6f20  pload, and also 
+00009d50: 6d61 6b65 7320 7468 6520 766f 6c75 6d65  makes the volume
+00009d60: 7320 7365 6172 6368 6162 6c65 2074 6872  s searchable thr
+00009d70: 6f75 6768 2074 6865 2077 6562 2d75 693a  ough the web-ui:
+00009d80: 0a2a 206d 616b 6520 7365 6172 6368 2071  .* make search q
+00009d90: 7565 7269 6573 2062 7920 6073 697a 6560  ueries by `size`
+00009da0: 2f60 6461 7465 602f 6064 6972 6563 746f  /`date`/`directo
+00009db0: 7279 2d70 6174 6860 2f60 6669 6c65 6e61  ry-path`/`filena
+00009dc0: 6d65 602c 206f 722e 2e2e 0a2a 2064 7261  me`, or....* dra
+00009dd0: 672f 6472 6f70 2061 206c 6f63 616c 2066  g/drop a local f
+00009de0: 696c 6520 746f 2073 6565 2069 6620 7468  ile to see if th
+00009df0: 6520 7361 6d65 2063 6f6e 7465 6e74 7320  e same contents 
+00009e00: 6578 6973 7420 736f 6d65 7768 6572 6520  exist somewhere 
+00009e10: 6f6e 2074 6865 2073 6572 7665 722c 2073  on the server, s
+00009e20: 6565 205b 6669 6c65 2d73 6561 7263 685d  ee [file-search]
+00009e30: 2823 6669 6c65 2d73 6561 7263 6829 0a0a  (#file-search)..
+00009e40: 7061 7468 2f6e 616d 6520 7175 6572 6965  path/name querie
+00009e50: 7320 6172 6520 7370 6163 652d 7365 7061  s are space-sepa
+00009e60: 7261 7465 642c 2041 4e44 2765 6420 746f  rated, AND'ed to
+00009e70: 6765 7468 6572 2c20 616e 6420 776f 7264  gether, and word
+00009e80: 7320 6172 6520 6e65 6761 7465 6420 7769  s are negated wi
+00009e90: 7468 2061 2060 2d60 2070 7265 6669 782c  th a `-` prefix,
+00009ea0: 2073 6f20 666f 7220 6578 616d 706c 653a   so for example:
+00009eb0: 0a2a 2070 6174 683a 2060 7368 6962 6179  .* path: `shibay
+00009ec0: 616e 202d 626f 7373 6160 2066 696e 6473  an -bossa` finds
+00009ed0: 2061 6c6c 2066 696c 6573 2077 6865 7265   all files where
+00009ee0: 206f 6e65 206f 6620 7468 6520 666f 6c64   one of the fold
+00009ef0: 6572 7320 636f 6e74 6169 6e20 6073 6869  ers contain `shi
+00009f00: 6261 7961 6e60 2062 7574 2066 696c 7465  bayan` but filte
+00009f10: 7273 206f 7574 2061 6e79 2072 6573 756c  rs out any resul
+00009f20: 7473 2077 6865 7265 2060 626f 7373 6160  ts where `bossa`
+00009f30: 2065 7869 7374 7320 736f 6d65 7768 6572   exists somewher
+00009f40: 6520 696e 2074 6865 2070 6174 680a 2a20  e in the path.* 
+00009f50: 6e61 6d65 3a20 6064 656d 6574 6f72 6920  name: `demetori 
+00009f60: 7374 7978 6020 6769 7665 7320 796f 7520  styx` gives you 
+00009f70: 5b67 6f6f 6420 7374 7566 665d 2868 7474  [good stuff](htt
+00009f80: 7073 3a2f 2f77 7777 2e79 6f75 7475 6265  ps://www.youtube
+00009f90: 2e63 6f6d 2f77 6174 6368 3f76 3d7a 4768  .com/watch?v=zGh
+00009fa0: 3067 3134 5a4a 3849 266c 6973 743d 504c  0g14ZJ8I&list=PL
+00009fb0: 3341 3134 3742 4431 3531 4545 3532 3138  3A147BD151EE5218
+00009fc0: 2669 6e64 6578 3d39 290a 0a74 6865 2060  &index=9)..the `
+00009fd0: 7261 7760 2066 6965 6c64 2061 6c6c 6f77  raw` field allow
+00009fe0: 7320 666f 7220 6d6f 7265 2063 6f6d 706c  s for more compl
+00009ff0: 6578 2073 7475 6666 2073 7563 6820 6173  ex stuff such as
+0000a000: 2060 2820 7461 6773 206c 696b 6520 2a6e   `( tags like *n
+0000a010: 6861 746f 2a20 6f72 2074 6167 7320 6c69  hato* or tags li
+0000a020: 6b65 202a 7461 6973 6869 2a20 2920 616e  ke *taishi* ) an
+0000a030: 6420 2820 6e6f 7420 7461 6773 206c 696b  d ( not tags lik
+0000a040: 6520 2a6e 6861 746f 2a20 6f72 206e 6f74  e *nhato* or not
+0000a050: 2074 6167 7320 6c69 6b65 202a 7461 6973   tags like *tais
+0000a060: 6869 2a20 2960 2077 6869 6368 2066 696e  hi* )` which fin
+0000a070: 6473 2061 6c6c 2073 6f6e 6773 2062 7920  ds all songs by 
+0000a080: 6569 7468 6572 206e 6861 746f 206f 7220  either nhato or 
+0000a090: 7461 6973 6869 2c20 6578 636c 7564 696e  taishi, excludin
+0000a0a0: 6720 636f 6c6c 6162 7320 2874 6572 7269  g collabs (terri
+0000a0b0: 626c 6520 6578 616d 706c 652c 2077 6879  ble example, why
+0000a0c0: 2077 6f75 6c64 2079 6f75 2064 6f20 7468   would you do th
+0000a0d0: 6174 290a 0a66 6f72 2074 6865 2061 626f  at)..for the abo
+0000a0e0: 7665 2065 7861 6d70 6c65 2074 6f20 776f  ve example to wo
+0000a0f0: 726b 2c20 6164 6420 7468 6520 636f 6d6d  rk, add the comm
+0000a100: 616e 646c 696e 6520 6172 6775 6d65 6e74  andline argument
+0000a110: 2060 2d65 3274 7360 2074 6f20 616c 736f   `-e2ts` to also
+0000a120: 2073 6361 6e2f 696e 6465 7820 7461 6773   scan/index tags
+0000a130: 2066 726f 6d20 6d75 7369 6320 6669 6c65   from music file
+0000a140: 732c 2077 6869 6368 2062 7269 6e67 7320  s, which brings 
+0000a150: 7573 206f 7665 7220 746f 3a0a 0a0a 2320  us over to:...# 
+0000a160: 7365 7276 6572 2063 6f6e 6669 670a 0a75  server config..u
+0000a170: 7369 6e67 2061 7267 756d 656e 7473 206f  sing arguments o
+0000a180: 7220 636f 6e66 6967 2066 696c 6573 2c20  r config files, 
+0000a190: 6f72 2061 206d 6978 206f 6620 626f 7468  or a mix of both
+0000a1a0: 3a0a 2a20 636f 6e66 6967 2066 696c 6573  :.* config files
+0000a1b0: 2028 602d 6320 736f 6d65 2e63 6f6e 6660   (`-c some.conf`
+0000a1c0: 2920 6361 6e20 7365 7420 6164 6469 7469  ) can set additi
+0000a1d0: 6f6e 616c 2063 6f6d 6d61 6e64 6c69 6e65  onal commandline
+0000a1e0: 2061 7267 756d 656e 7473 3b20 7365 6520   arguments; see 
+0000a1f0: 5b2e 2f64 6f63 732f 6578 616d 706c 652e  [./docs/example.
+0000a200: 636f 6e66 5d28 646f 6373 2f65 7861 6d70  conf](docs/examp
+0000a210: 6c65 2e63 6f6e 6629 2061 6e64 205b 2e2f  le.conf) and [./
+0000a220: 646f 6373 2f65 7861 6d70 6c65 322e 636f  docs/example2.co
+0000a230: 6e66 5d28 646f 6373 2f65 7861 6d70 6c65  nf](docs/example
+0000a240: 322e 636f 6e66 290a 2a20 606b 696c 6c20  2.conf).* `kill 
+0000a250: 2d73 2055 5352 3160 2028 7361 6d65 2061  -s USR1` (same a
+0000a260: 7320 6073 7973 7465 6d63 746c 2072 656c  s `systemctl rel
+0000a270: 6f61 6420 636f 7079 7061 7274 7960 2920  oad copyparty`) 
+0000a280: 746f 2072 656c 6f61 6420 6163 636f 756e  to reload accoun
+0000a290: 7473 2061 6e64 2076 6f6c 756d 6573 2066  ts and volumes f
+0000a2a0: 726f 6d20 636f 6e66 6967 2066 696c 6573  rom config files
+0000a2b0: 2077 6974 686f 7574 2072 6573 7461 7274   without restart
+0000a2c0: 696e 670a 2020 2a20 6f72 2063 6c69 636b  ing.  * or click
+0000a2d0: 2074 6865 2060 5b72 656c 6f61 6420 6366   the `[reload cf
+0000a2e0: 675d 6020 6275 7474 6f6e 2069 6e20 7468  g]` button in th
+0000a2f0: 6520 636f 6e74 726f 6c2d 7061 6e65 6c20  e control-panel 
+0000a300: 7768 656e 206c 6f67 6765 6420 696e 2061  when logged in a
+0000a310: 7320 6164 6d69 6e20 0a20 202a 2063 6861  s admin .  * cha
+0000a320: 6e67 6573 2074 6f20 7468 6520 605b 676c  nges to the `[gl
+0000a330: 6f62 616c 5d60 2063 6f6e 6669 6720 7365  obal]` config se
+0000a340: 6374 696f 6e20 7265 7175 6972 6573 2061  ction requires a
+0000a350: 2072 6573 7461 7274 2074 6f20 7461 6b65   restart to take
+0000a360: 2065 6666 6563 740a 0a0a 2323 207a 6572   effect...## zer
+0000a370: 6f63 6f6e 660a 0a61 6e6e 6f75 6e63 6520  oconf..announce 
+0000a380: 656e 6162 6c65 6420 7365 7276 6963 6573  enabled services
+0000a390: 206f 6e20 7468 6520 4c41 4e20 285b 7069   on the LAN ([pi
+0000a3a0: 635d 2868 7474 7073 3a2f 2f75 7365 722d  c](https://user-
+0000a3b0: 696d 6167 6573 2e67 6974 6875 6275 7365  images.githubuse
+0000a3c0: 7263 6f6e 7465 6e74 2e63 6f6d 2f32 3431  rcontent.com/241
+0000a3d0: 3033 322f 3231 3533 3434 3733 372d 3065  032/215344737-0e
+0000a3e0: 6165 3864 3938 2d39 3439 362d 3432 3536  ae8d98-9496-4256
+0000a3f0: 2d39 6161 382d 6364 3266 3639 3731 3831  -9aa8-cd2f697181
+0000a400: 3064 2e70 6e67 2929 2020 2d2d 2060 2d7a  0d.png))  -- `-z
+0000a410: 6020 656e 6162 6c65 7320 626f 7468 205b  ` enables both [
+0000a420: 6d64 6e73 5d28 236d 646e 7329 2061 6e64  mdns](#mdns) and
+0000a430: 205b 7373 6470 5d28 2373 7364 7029 0a0a   [ssdp](#ssdp)..
+0000a440: 2a20 602d 2d7a 2d6f 6e60 202f 2060 2d2d  * `--z-on` / `--
+0000a450: 7a2d 6f66 6660 2720 6c69 6d69 7473 2074  z-off`' limits t
+0000a460: 6865 2066 6561 7475 7265 2074 6f20 6365  he feature to ce
+0000a470: 7274 6169 6e20 6e65 7477 6f72 6b73 0a0a  rtain networks..
+0000a480: 0a23 2323 206d 646e 730a 0a4c 414e 2064  .### mdns..LAN d
+0000a490: 6f6d 6169 6e2d 6e61 6d65 2061 6e64 2066  omain-name and f
+0000a4a0: 6561 7475 7265 2061 6e6e 6f75 6e63 6572  eature announcer
+0000a4b0: 0a0a 7573 6573 205b 6d75 6c74 6963 6173  ..uses [multicas
+0000a4c0: 7420 646e 735d 2868 7474 7073 3a2f 2f65  t dns](https://e
+0000a4d0: 6e2e 7769 6b69 7065 6469 612e 6f72 672f  n.wikipedia.org/
+0000a4e0: 7769 6b69 2f4d 756c 7469 6361 7374 5f44  wiki/Multicast_D
+0000a4f0: 4e53 2920 746f 2067 6976 6520 636f 7079  NS) to give copy
+0000a500: 7061 7274 7920 6120 646f 6d61 696e 2077  party a domain w
+0000a510: 6869 6368 2061 6e79 206d 6163 6869 6e65  hich any machine
+0000a520: 206f 6e20 7468 6520 4c41 4e20 6361 6e20   on the LAN can 
+0000a530: 7573 6520 746f 2061 6363 6573 7320 6974  use to access it
+0000a540: 0a0a 616c 6c20 656e 6162 6c65 6420 7365  ..all enabled se
+0000a550: 7276 6963 6573 2028 5b77 6562 6461 765d  rvices ([webdav]
+0000a560: 2823 7765 6264 6176 2d73 6572 7665 7229  (#webdav-server)
+0000a570: 2c20 5b66 7470 5d28 2366 7470 2d73 6572  , [ftp](#ftp-ser
+0000a580: 7665 7229 2c20 5b73 6d62 5d28 2373 6d62  ver), [smb](#smb
+0000a590: 2d73 6572 7665 7229 2920 7769 6c6c 2061  -server)) will a
+0000a5a0: 7070 6561 7220 696e 206d 444e 532d 6177  ppear in mDNS-aw
+0000a5b0: 6172 6520 6669 6c65 206d 616e 6167 6572  are file manager
+0000a5c0: 7320 284b 4445 2c20 676e 6f6d 652c 206d  s (KDE, gnome, m
+0000a5d0: 6163 4f53 2c20 2e2e 2e29 0a0a 7468 6520  acOS, ...)..the 
+0000a5e0: 646f 6d61 696e 2077 696c 6c20 6265 2068  domain will be h
+0000a5f0: 7474 703a 2f2f 7061 7274 7962 6f78 2e6c  ttp://partybox.l
+0000a600: 6f63 616c 2069 6620 7468 6520 6d61 6368  ocal if the mach
+0000a610: 696e 6527 7320 686f 7374 6e61 6d65 2069  ine's hostname i
+0000a620: 7320 6070 6172 7479 626f 7860 2075 6e6c  s `partybox` unl
+0000a630: 6573 7320 602d 2d6e 616d 6560 2073 7065  ess `--name` spe
+0000a640: 6369 6669 6573 2073 6f65 6d74 6869 6e67  cifies soemthing
+0000a650: 2065 6c73 650a 0a0a 2323 2320 7373 6470   else...### ssdp
+0000a660: 0a0a 7769 6e64 6f77 732d 6578 706c 6f72  ..windows-explor
+0000a670: 6572 2061 6e6e 6f75 6e63 6572 0a0a 7573  er announcer..us
+0000a680: 6573 205b 7373 6470 5d28 6874 7470 733a  es [ssdp](https:
+0000a690: 2f2f 656e 2e77 696b 6970 6564 6961 2e6f  //en.wikipedia.o
+0000a6a0: 7267 2f77 696b 692f 5369 6d70 6c65 5f53  rg/wiki/Simple_S
+0000a6b0: 6572 7669 6365 5f44 6973 636f 7665 7279  ervice_Discovery
+0000a6c0: 5f50 726f 746f 636f 6c29 2074 6f20 6d61  _Protocol) to ma
+0000a6d0: 6b65 2063 6f70 7970 6172 7479 2061 7070  ke copyparty app
+0000a6e0: 6561 7220 696e 2074 6865 2077 696e 646f  ear in the windo
+0000a6f0: 7773 2066 696c 6520 6578 706c 6f72 6572  ws file explorer
+0000a700: 206f 6e20 616c 6c20 6d61 6368 696e 6573   on all machines
+0000a710: 206f 6e20 7468 6520 4c41 4e0a 0a64 6f75   on the LAN..dou
+0000a720: 626c 6563 6c69 636b 696e 6720 7468 6520  bleclicking the 
+0000a730: 6963 6f6e 206f 7065 6e73 2074 6865 2022  icon opens the "
+0000a740: 636f 6e6e 6563 7422 2070 6167 6520 7768  connect" page wh
+0000a750: 6963 6820 6578 706c 6169 6e73 2068 6f77  ich explains how
+0000a760: 2074 6f20 6d6f 756e 7420 636f 7079 7061   to mount copypa
+0000a770: 7274 7920 6173 2061 206c 6f63 616c 2066  rty as a local f
+0000a780: 696c 6573 7973 7465 6d0a 0a69 6620 636f  ilesystem..if co
+0000a790: 7079 7061 7274 7920 646f 6573 206e 6f74  pyparty does not
+0000a7a0: 2061 7070 6561 7220 696e 2077 696e 646f   appear in windo
+0000a7b0: 7773 2065 7870 6c6f 7265 722c 2075 7365  ws explorer, use
+0000a7c0: 2060 2d2d 7a73 7660 2074 6f20 7365 6520   `--zsv` to see 
+0000a7d0: 7768 793a 0a0a 2a20 6d61 7962 6520 7468  why:..* maybe th
+0000a7e0: 6520 6469 7363 6f76 6572 7920 6d75 6c74  e discovery mult
+0000a7f0: 6963 6173 7420 7761 7320 7365 6e74 2066  icast was sent f
+0000a800: 726f 6d20 616e 2049 5020 7768 6963 6820  rom an IP which 
+0000a810: 646f 6573 206e 6f74 2069 6e74 6572 7365  does not interse
+0000a820: 6374 2077 6974 6820 7468 6520 7365 7276  ct with the serv
+0000a830: 6572 2073 7562 6e65 7473 0a0a 0a23 2320  er subnets...## 
+0000a840: 7172 2d63 6f64 650a 0a70 7269 6e74 2061  qr-code..print a
+0000a850: 2071 722d 636f 6465 205b 2873 6372 6565   qr-code [(scree
+0000a860: 6e73 686f 7429 5d28 6874 7470 733a 2f2f  nshot)](https://
+0000a870: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+0000a880: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+0000a890: 6d2f 3234 3130 3332 2f31 3934 3732 3835  m/241032/1947285
+0000a8a0: 3333 2d36 6630 3038 3439 622d 6336 6163  33-6f00849b-c6ac
+0000a8b0: 2d34 3363 362d 3933 3539 2d38 3365 3435  -43c6-9359-83e45
+0000a8c0: 3464 3131 6530 302e 706e 6729 2066 6f72  4d11e00.png) for
+0000a8d0: 2071 7569 636b 2061 6363 6573 732c 2020   quick access,  
+0000a8e0: 6772 6561 7420 6265 7477 6565 6e20 7068  great between ph
+0000a8f0: 6f6e 6573 206f 6e20 616e 6472 6f69 6420  ones on android 
+0000a900: 686f 7473 706f 7473 2077 6869 6368 206b  hotspots which k
+0000a910: 6565 7020 6368 616e 6769 6e67 2074 6865  eep changing the
+0000a920: 2073 7562 6e65 740a 0a2a 2060 2d2d 7172   subnet..* `--qr
+0000a930: 6020 656e 6162 6c65 7320 6974 0a2a 2060  ` enables it.* `
+0000a940: 2d2d 7172 7360 2064 6f65 7320 6874 7470  --qrs` does http
+0000a950: 7320 696e 7374 6561 6420 6f66 2068 7474  s instead of htt
+0000a960: 700a 2a20 602d 2d71 726c 206c 6f6f 7462  p.* `--qrl lootb
+0000a970: 6f78 2f3f 7077 3d68 756e 7465 7232 6020  ox/?pw=hunter2` 
+0000a980: 6170 7065 6e64 7320 746f 2074 6865 2075  appends to the u
+0000a990: 726c 2c20 6c69 6e6b 696e 6720 746f 2074  rl, linking to t
+0000a9a0: 6865 2060 6c6f 6f74 626f 7860 2066 6f6c  he `lootbox` fol
+0000a9b0: 6465 7220 7769 7468 2070 6173 7377 6f72  der with passwor
+0000a9c0: 6420 6068 756e 7465 7232 600a 2a20 602d  d `hunter2`.* `-
+0000a9d0: 2d71 727a 2031 6020 666f 7263 6573 2031  -qrz 1` forces 1
+0000a9e0: 7820 7a6f 6f6d 2069 6e73 7465 6164 206f  x zoom instead o
+0000a9f0: 6620 6175 746f 7363 616c 696e 6720 746f  f autoscaling to
+0000aa00: 2066 6974 2074 6865 2074 6572 6d69 6e61   fit the termina
+0000aa10: 6c20 7369 7a65 0a20 202a 2031 7820 6d61  l size.  * 1x ma
+0000aa20: 7920 7265 6e64 6572 2069 6e63 6f72 7265  y render incorre
+0000aa30: 6374 6c79 206f 6e20 736f 6d65 2074 6572  ctly on some ter
+0000aa40: 6d69 6e61 6c73 2f66 6f6e 7473 2c20 6275  minals/fonts, bu
+0000aa50: 7420 3278 2073 686f 756c 6420 616c 7761  t 2x should alwa
+0000aa60: 7973 2077 6f72 6b0a 0a69 7420 7573 6573  ys work..it uses
+0000aa70: 2074 6865 2073 6572 7665 7220 686f 7374   the server host
+0000aa80: 6e61 6d65 2069 6620 5b6d 646e 735d 2823  name if [mdns](#
+0000aa90: 6d64 6e73 2920 6973 2065 6e62 6c65 642c  mdns) is enbled,
+0000aaa0: 206f 7468 6572 7769 7365 2069 7427 6c6c   otherwise it'll
+0000aab0: 2075 7365 2079 6f75 7220 6578 7465 726e   use your extern
+0000aac0: 616c 2069 7020 2864 6566 6175 6c74 2072  al ip (default r
+0000aad0: 6f75 7465 2920 756e 6c65 7373 2060 2d2d  oute) unless `--
+0000aae0: 7172 6960 2073 7065 6369 6669 6573 2061  qri` specifies a
+0000aaf0: 2073 7065 6369 6669 6320 6970 2d70 7265   specific ip-pre
+0000ab00: 6669 7820 6f72 2064 6f6d 6169 6e0a 0a0a  fix or domain...
+0000ab10: 2323 2066 7470 2073 6572 7665 720a 0a61  ## ftp server..a
+0000ab20: 6e20 4654 5020 7365 7276 6572 2063 616e  n FTP server can
+0000ab30: 2062 6520 7374 6172 7465 6420 7573 696e   be started usin
+0000ab40: 6720 602d 2d66 7470 2033 3932 3160 2c20  g `--ftp 3921`, 
+0000ab50: 2061 6e64 2f6f 7220 602d 2d66 7470 7360   and/or `--ftps`
+0000ab60: 2066 6f72 2065 7870 6c69 6369 7420 544c   for explicit TL
+0000ab70: 5320 2866 7470 6573 290a 0a2a 2062 6173  S (ftpes)..* bas
+0000ab80: 6564 206f 6e20 5b70 7966 7470 646c 6962  ed on [pyftpdlib
+0000ab90: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
+0000aba0: 2e63 6f6d 2f67 6961 6d70 616f 6c6f 2f70  .com/giampaolo/p
+0000abb0: 7966 7470 646c 6962 290a 2a20 6e65 6564  yftpdlib).* need
+0000abc0: 7320 6120 6465 6469 6361 7465 6420 706f  s a dedicated po
+0000abd0: 7274 2028 6361 6e6e 6f74 2073 6861 7265  rt (cannot share
+0000abe0: 2077 6974 6820 7468 6520 4854 5450 2f48   with the HTTP/H
+0000abf0: 5454 5053 2041 5049 290a 2a20 7570 6c6f  TTPS API).* uplo
+0000ac00: 6164 7320 6172 6520 6e6f 7420 7265 7375  ads are not resu
+0000ac10: 6d61 626c 6520 2d2d 2064 656c 6574 6520  mable -- delete 
+0000ac20: 616e 6420 7265 7374 6172 7420 6966 206e  and restart if n
+0000ac30: 6563 6573 7361 7279 0a2a 2072 756e 7320  ecessary.* runs 
+0000ac40: 696e 2061 6374 6976 6520 6d6f 6465 2062  in active mode b
+0000ac50: 7920 6465 6661 756c 742c 2079 6f75 2070  y default, you p
+0000ac60: 726f 6261 626c 7920 7761 6e74 2060 2d2d  robably want `--
+0000ac70: 6674 702d 7072 2031 3230 3030 2d31 3330  ftp-pr 12000-130
+0000ac80: 3030 600a 2020 2a20 6966 2079 6f75 2065  00`.  * if you e
+0000ac90: 6e61 626c 6520 626f 7468 2060 6674 7060  nable both `ftp`
+0000aca0: 2061 6e64 2060 6674 7073 602c 2074 6865   and `ftps`, the
+0000acb0: 2070 6f72 742d 7261 6e67 6520 7769 6c6c   port-range will
+0000acc0: 2062 6520 6469 7669 6465 6420 696e 2068   be divided in h
+0000acd0: 616c 660a 2020 2a20 736f 6d65 206f 6c64  alf.  * some old
+0000ace0: 6572 2073 6f66 7477 6172 6520 2866 696c  er software (fil
+0000acf0: 657a 696c 6c61 206f 6e20 6465 6269 616e  ezilla on debian
+0000ad00: 2d73 7461 626c 6529 2063 616e 6e6f 7420  -stable) cannot 
+0000ad10: 7061 7373 6976 652d 6d6f 6465 2077 6974  passive-mode wit
+0000ad20: 6820 544c 530a 2a20 6c6f 6769 6e20 7769  h TLS.* login wi
+0000ad30: 7468 2061 6e79 2075 7365 726e 616d 6520  th any username 
+0000ad40: 2b20 796f 7572 2070 6173 7377 6f72 642c  + your password,
+0000ad50: 206f 7220 7075 7420 796f 7572 2070 6173   or put your pas
+0000ad60: 7377 6f72 6420 696e 2074 6865 2075 7365  sword in the use
+0000ad70: 726e 616d 6520 6669 656c 640a 0a73 6f6d  rname field..som
+0000ad80: 6520 7265 636f 6d6d 656e 6465 6420 4654  e recommended FT
+0000ad90: 5020 2f20 4654 5053 2063 6c69 656e 7473  P / FTPS clients
+0000ada0: 3b20 6077 6172 6b60 203d 2065 7861 6d70  ; `wark` = examp
+0000adb0: 6c65 2070 6173 7377 6f72 643a 0a2a 2068  le password:.* h
+0000adc0: 7474 7073 3a2f 2f77 696e 7363 702e 6e65  ttps://winscp.ne
+0000add0: 742f 656e 672f 646f 776e 6c6f 6164 2e70  t/eng/download.p
+0000ade0: 6870 0a2a 2068 7474 7073 3a2f 2f66 696c  hp.* https://fil
+0000adf0: 657a 696c 6c61 2d70 726f 6a65 6374 2e6f  ezilla-project.o
+0000ae00: 7267 2f20 7374 7275 6767 6c65 7320 6120  rg/ struggles a 
+0000ae10: 6269 7420 7769 7468 2066 7470 7320 696e  bit with ftps in
+0000ae20: 2061 6374 6976 652d 6d6f 6465 2c20 6275   active-mode, bu
+0000ae30: 7420 6973 2066 696e 6520 6f74 6865 7277  t is fine otherw
+0000ae40: 6973 650a 2a20 6874 7470 733a 2f2f 7263  ise.* https://rc
+0000ae50: 6c6f 6e65 2e6f 7267 2f20 646f 6573 2046  lone.org/ does F
+0000ae60: 5450 5320 7769 7468 2060 746c 733d 6661  TPS with `tls=fa
+0000ae70: 6c73 6520 6578 706c 6963 6974 5f74 6c73  lse explicit_tls
+0000ae80: 3d74 7275 6560 0a2a 2060 6c66 7470 202d  =true`.* `lftp -
+0000ae90: 7520 6b2c 7761 726b 202d 7020 3339 3231  u k,wark -p 3921
+0000aea0: 2031 3237 2e30 2e30 2e31 202d 6520 6c73   127.0.0.1 -e ls
+0000aeb0: 600a 2a20 606c 6674 7020 2d75 206b 2c77  `.* `lftp -u k,w
+0000aec0: 6172 6b20 2d70 2033 3939 3020 3132 372e  ark -p 3990 127.
+0000aed0: 302e 302e 3120 2d65 2027 7365 7420 7373  0.0.1 -e 'set ss
+0000aee0: 6c3a 7665 7269 6679 2d63 6572 7469 6669  l:verify-certifi
+0000aef0: 6361 7465 206e 6f3b 206c 7327 600a 0a0a  cate no; ls'`...
+0000af00: 2323 2077 6562 6461 7620 7365 7276 6572  ## webdav server
+0000af10: 0a0a 7769 7468 2072 6561 642d 7772 6974  ..with read-writ
+0000af20: 6520 7375 7070 6f72 742c 2020 7375 7070  e support,  supp
+0000af30: 6f72 7473 2077 696e 5850 2061 6e64 206c  orts winXP and l
+0000af40: 6174 6572 2c20 6d61 636f 732c 206e 6175  ater, macos, nau
+0000af50: 7469 6c75 732f 6776 6673 0a0a 636c 6963  tilus/gvfs..clic
+0000af60: 6b20 7468 6520 5b63 6f6e 6e65 6374 5d28  k the [connect](
+0000af70: 6874 7470 3a2f 2f31 3237 2e30 2e30 2e31  http://127.0.0.1
+0000af80: 3a33 3932 332f 3f68 6329 2062 7574 746f  :3923/?hc) butto
+0000af90: 6e20 696e 2074 6865 2063 6f6e 7472 6f6c  n in the control
+0000afa0: 2d70 616e 656c 2074 6f20 7365 6520 636f  -panel to see co
+0000afb0: 6e6e 6563 7469 6f6e 2069 6e73 7472 7563  nnection instruc
+0000afc0: 7469 6f6e 7320 666f 7220 7769 6e64 6f77  tions for window
+0000afd0: 732c 206c 696e 7578 2c20 6d61 636f 730a  s, linux, macos.
+0000afe0: 0a67 656e 6572 616c 2075 7361 6765 3a0a  .general usage:.
+0000aff0: 2a20 6c6f 6769 6e20 7769 7468 2061 6e79  * login with any
+0000b000: 2075 7365 726e 616d 6520 2b20 796f 7572   username + your
+0000b010: 2070 6173 7377 6f72 642c 206f 7220 7075   password, or pu
+0000b020: 7420 796f 7572 2070 6173 7377 6f72 6420  t your password 
+0000b030: 696e 2074 6865 2075 7365 726e 616d 6520  in the username 
+0000b040: 6669 656c 6420 2870 6173 7377 6f72 6420  field (password 
+0000b050: 6669 656c 6420 6361 6e20 6265 2065 6d70  field can be emp
+0000b060: 7479 2f77 6861 7465 7665 7229 0a0a 6f6e  ty/whatever)..on
+0000b070: 206d 6163 6f73 2c20 636f 6e6e 6563 7420   macos, connect 
+0000b080: 6672 6f6d 2066 696e 6465 723a 0a2a 205b  from finder:.* [
+0000b090: 476f 5d20 2d3e 205b 436f 6e6e 6563 7420  Go] -> [Connect 
+0000b0a0: 746f 2053 6572 7665 722e 2e2e 5d20 2d3e  to Server...] ->
+0000b0b0: 2068 7474 703a 2f2f 3139 322e 3136 382e   http://192.168.
+0000b0c0: 3132 332e 313a 3339 3233 2f0a 0a69 6e20  123.1:3923/..in 
+0000b0d0: 6f72 6465 7220 746f 2067 7261 6e74 2066  order to grant f
+0000b0e0: 756c 6c20 7772 6974 652d 6163 6365 7373  ull write-access
+0000b0f0: 2074 6f20 7765 6264 6176 2063 6c69 656e   to webdav clien
+0000b100: 7473 2c20 7468 6520 766f 6c66 6c61 6720  ts, the volflag 
+0000b110: 6064 6177 6020 6d75 7374 2062 6520 7365  `daw` must be se
+0000b120: 7420 616e 6420 7468 6520 6163 636f 756e  t and the accoun
+0000b130: 7420 6d75 7374 2061 6c73 6f20 6861 7665  t must also have
+0000b140: 2064 656c 6574 652d 6163 6365 7373 2028   delete-access (
+0000b150: 6f74 6865 7277 6973 6520 7468 6520 636c  otherwise the cl
+0000b160: 6965 6e74 2077 6f6e 2774 2062 6520 616c  ient won't be al
+0000b170: 6c6f 7765 6420 746f 2072 6570 6c61 6365  lowed to replace
+0000b180: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
+0000b190: 2065 7869 7374 696e 6720 6669 6c65 732c   existing files,
+0000b1a0: 2077 6869 6368 2069 7320 686f 7720 7765   which is how we
+0000b1b0: 6264 6176 2077 6f72 6b73 290a 0a0a 2323  bdav works)...##
+0000b1c0: 2320 636f 6e6e 6563 7469 6e67 2074 6f20  # connecting to 
+0000b1d0: 7765 6264 6176 2066 726f 6d20 7769 6e64  webdav from wind
+0000b1e0: 6f77 730a 0a75 7369 6e67 2074 6865 2047  ows..using the G
+0000b1f0: 5549 2020 2877 696e 5850 206f 7220 6c61  UI  (winXP or la
+0000b200: 7465 7229 3a0a 2a20 7269 6768 7463 6c69  ter):.* rightcli
+0000b210: 636b 205b 6d79 2063 6f6d 7075 7465 725d  ck [my computer]
+0000b220: 202d 3e20 5b6d 6170 206e 6574 776f 726b   -> [map network
+0000b230: 2064 7269 7665 5d20 2d3e 2046 6f6c 6465   drive] -> Folde
+0000b240: 723a 2060 6874 7470 3a2f 2f31 3932 2e31  r: `http://192.1
+0000b250: 3638 2e31 3233 2e31 3a33 3932 332f 600a  68.123.1:3923/`.
+0000b260: 2020 2a20 6f6e 2077 696e 5850 206f 6e6c    * on winXP onl
+0000b270: 792c 2063 6c69 636b 2074 6865 2060 5369  y, click the `Si
+0000b280: 676e 2075 7020 666f 7220 6f6e 6c69 6e65  gn up for online
+0000b290: 2073 746f 7261 6765 6020 6879 7065 726c   storage` hyperl
+0000b2a0: 696e 6b20 696e 7374 6561 6420 616e 6420  ink instead and 
+0000b2b0: 7075 7420 7468 6520 5552 4c20 7468 6572  put the URL ther
+0000b2c0: 650a 2020 2a20 7072 6f76 6964 696e 6720  e.  * providing 
+0000b2d0: 796f 7572 2070 6173 7377 6f72 6420 6173  your password as
+0000b2e0: 2074 6865 2075 7365 726e 616d 6520 6973   the username is
+0000b2f0: 2072 6563 6f6d 6d65 6e64 6564 3b20 7468   recommended; th
+0000b300: 6520 7061 7373 776f 7264 2066 6965 6c64  e password field
+0000b310: 2063 616e 2062 6520 616e 7974 6869 6e67   can be anything
+0000b320: 206f 7220 656d 7074 790a 0a6b 6e6f 776e   or empty..known
+0000b330: 2063 6c69 656e 7420 6275 6773 3a0a 2a20   client bugs:.* 
+0000b340: 7769 6e37 2b20 646f 6573 6e27 7420 6163  win7+ doesn't ac
+0000b350: 7475 616c 6c79 2073 656e 6420 7468 6520  tually send the 
+0000b360: 7061 7373 776f 7264 2074 6f20 7468 6520  password to the 
+0000b370: 7365 7276 6572 2077 6865 6e20 7265 6175  server when reau
+0000b380: 7468 656e 7469 6361 7469 6e67 2061 6674  thenticating aft
+0000b390: 6572 2061 2072 6562 6f6f 7420 756e 6c65  er a reboot unle
+0000b3a0: 7373 2079 6f75 2066 6972 7374 2074 7279  ss you first try
+0000b3b0: 2074 6f20 6c6f 6769 6e20 7769 7468 2061   to login with a
+0000b3c0: 6e20 696e 636f 7272 6563 7420 7061 7373  n incorrect pass
+0000b3d0: 776f 7264 2061 6e64 2074 6865 6e20 7377  word and then sw
+0000b3e0: 6974 6368 2074 6f20 7468 6520 636f 7272  itch to the corr
+0000b3f0: 6563 7420 7061 7373 776f 7264 0a20 202a  ect password.  *
+0000b400: 206f 7220 6a75 7374 2074 7970 6520 796f   or just type yo
+0000b410: 7572 2070 6173 7377 6f72 6420 696e 746f  ur password into
+0000b420: 2074 6865 2075 7365 726e 616d 6520 6669   the username fi
+0000b430: 656c 6420 696e 7374 6561 6420 746f 2067  eld instead to g
+0000b440: 6574 2061 726f 756e 6420 6974 2065 6e74  et around it ent
+0000b450: 6972 656c 790a 2a20 636f 6e6e 6563 7469  irely.* connecti
+0000b460: 6e67 2074 6f20 6120 666f 6c64 6572 2077  ng to a folder w
+0000b470: 6869 6368 2061 6c6c 6f77 7320 616e 6f6e  hich allows anon
+0000b480: 796d 6f75 7320 7265 6164 2077 696c 6c20  ymous read will 
+0000b490: 6d61 6b65 2077 7269 7469 6e67 2069 6d70  make writing imp
+0000b4a0: 6f73 7369 626c 652c 2061 7320 7769 6e64  ossible, as wind
+0000b4b0: 6f77 7320 6861 7320 6465 6369 6465 6420  ows has decided 
+0000b4c0: 6974 2064 6f65 736e 2774 206e 6565 6420  it doesn't need 
+0000b4d0: 746f 206c 6f67 696e 0a20 202a 2077 6f72  to login.  * wor
+0000b4e0: 6b61 726f 756e 643a 2063 6f6e 6e65 6374  karound: connect
+0000b4f0: 2074 7769 6365 3b20 6669 7273 7420 746f   twice; first to
+0000b500: 2061 2066 6f6c 6465 7220 7768 6963 6820   a folder which 
+0000b510: 7265 7175 6972 6573 2061 7574 682c 2074  requires auth, t
+0000b520: 6865 6e20 746f 2074 6865 2066 6f6c 6465  hen to the folde
+0000b530: 7220 796f 7520 6163 7475 616c 6c79 2077  r you actually w
+0000b540: 616e 742c 2061 6e64 206c 6561 7665 2062  ant, and leave b
+0000b550: 6f74 6820 6f66 2074 686f 7365 206d 6f75  oth of those mou
+0000b560: 6e74 6564 0a2a 2077 696e 372b 206d 6179  nted.* win7+ may
+0000b570: 206f 7065 6e20 6120 6e65 7720 7463 7020   open a new tcp 
+0000b580: 636f 6e6e 6563 7469 6f6e 2066 6f72 2065  connection for e
+0000b590: 7665 7279 2066 696c 6520 616e 6420 736f  very file and so
+0000b5a0: 6d65 7469 6d65 7320 666f 7267 6574 7320  metimes forgets 
+0000b5b0: 746f 2063 6c6f 7365 2074 6865 6d2c 2065  to close them, e
+0000b5c0: 7665 6e74 7561 6c6c 7920 6e65 6564 696e  ventually needin
+0000b5d0: 6720 6120 7265 626f 6f74 0a20 202a 206d  g a reboot.  * m
+0000b5e0: 6179 6265 204e 4943 2d72 656c 6174 6564  aybe NIC-related
+0000b5f0: 2028 3f3f 292c 2068 6170 7065 6e73 2077   (??), happens w
+0000b600: 6974 6820 7769 6e31 302d 6c74 7363 206f  ith win10-ltsc o
+0000b610: 6e20 6531 3030 3065 2062 7574 206e 6f74  n e1000e but not
+0000b620: 2076 6972 7469 6f0a 2a20 7769 6e64 6f77   virtio.* window
+0000b630: 7320 6361 6e6e 6f74 2061 6363 6573 7320  s cannot access 
+0000b640: 666f 6c64 6572 7320 7768 6963 6820 636f  folders which co
+0000b650: 6e74 6169 6e20 6669 6c65 6e61 6d65 7320  ntain filenames 
+0000b660: 7769 7468 2069 6e76 616c 6964 2075 6e69  with invalid uni
+0000b670: 636f 6465 206f 7220 666f 7262 6964 6465  code or forbidde
+0000b680: 6e20 6368 6172 6163 7465 7273 2028 603c  n characters (`<
+0000b690: 3e3a 222f 5c7c 3f2a 6029 2c20 6f72 206e  >:"/\|?*`), or n
+0000b6a0: 616d 6573 2065 6e64 696e 6720 7769 7468  ames ending with
+0000b6b0: 2060 2e60 0a2a 2077 696e 7870 2063 616e   `.`.* winxp can
+0000b6c0: 6e6f 7420 7368 6f77 2075 6e69 636f 6465  not show unicode
+0000b6d0: 2063 6861 7261 6374 6572 7320 6f75 7473   characters outs
+0000b6e0: 6964 6520 6f66 202a 736f 6d65 2072 616e  ide of *some ran
+0000b6f0: 6765 2a0a 2020 2a20 6c61 7469 6e2d 3120  ge*.  * latin-1 
+0000b700: 6973 2066 696e 652c 2068 6972 6167 616e  is fine, hiragan
+0000b710: 6120 6973 206e 6f74 2028 6e6f 7420 6576  a is not (not ev
+0000b720: 656e 2061 7320 7368 6966 742d 6a69 7320  en as shift-jis 
+0000b730: 6f6e 206a 6170 616e 6573 6520 7870 290a  on japanese xp).
+0000b740: 0a0a 2323 2073 6d62 2073 6572 7665 720a  ..## smb server.
+0000b750: 0a75 6e73 6166 652c 2073 6c6f 772c 206e  .unsafe, slow, n
+0000b760: 6f74 2072 6563 6f6d 6d65 6e64 6564 2066  ot recommended f
+0000b770: 6f72 2077 616e 2c20 2065 6e61 626c 6520  or wan,  enable 
+0000b780: 7769 7468 2060 2d2d 736d 6260 2066 6f72  with `--smb` for
+0000b790: 2072 6561 642d 6f6e 6c79 206f 7220 602d   read-only or `-
+0000b7a0: 2d73 6d62 7760 2066 6f72 2072 6561 642d  -smbw` for read-
+0000b7b0: 7772 6974 650a 0a63 6c69 636b 2074 6865  write..click the
+0000b7c0: 205b 636f 6e6e 6563 745d 2868 7474 703a   [connect](http:
+0000b7d0: 2f2f 3132 372e 302e 302e 313a 3339 3233  //127.0.0.1:3923
+0000b7e0: 2f3f 6863 2920 6275 7474 6f6e 2069 6e20  /?hc) button in 
+0000b7f0: 7468 6520 636f 6e74 726f 6c2d 7061 6e65  the control-pane
+0000b800: 6c20 746f 2073 6565 2063 6f6e 6e65 6374  l to see connect
+0000b810: 696f 6e20 696e 7374 7275 6374 696f 6e73  ion instructions
+0000b820: 2066 6f72 2077 696e 646f 7773 2c20 6c69   for windows, li
+0000b830: 6e75 782c 206d 6163 6f73 0a0a 6465 7065  nux, macos..depe
+0000b840: 6e64 656e 6369 6573 3a20 6070 7974 686f  ndencies: `pytho
+0000b850: 6e33 202d 6d20 7069 7020 696e 7374 616c  n3 -m pip instal
+0000b860: 6c20 2d2d 7573 6572 202d 5520 696d 7061  l --user -U impa
+0000b870: 636b 6574 3d3d 302e 3130 2e30 600a 2a20  cket==0.10.0`.* 
+0000b880: 6e65 7765 7220 7665 7273 696f 6e73 206f  newer versions o
+0000b890: 6620 696d 7061 636b 6574 2077 696c 6c20  f impacket will 
+0000b8a0: 686f 7065 6675 6c6c 7920 776f 726b 206a  hopefully work j
+0000b8b0: 7573 7420 6669 6e65 2062 7574 2074 6865  ust fine but the
+0000b8c0: 7265 2069 7320 6d6f 6e6b 6579 7061 7463  re is monkeypatc
+0000b8d0: 6869 6e67 2073 6f20 6d61 7962 6520 6e6f  hing so maybe no
+0000b8e0: 740a 0a73 6f6d 6520 2a2a 4249 4720 5741  t..some **BIG WA
+0000b8f0: 524e 494e 4753 2a2a 2073 7065 6369 6669  RNINGS** specifi
+0000b900: 6320 746f 2053 4d42 2f43 4946 532c 2069  c to SMB/CIFS, i
+0000b910: 6e20 6465 6372 6561 7369 6e67 2069 6d70  n decreasing imp
+0000b920: 6f72 7461 6e63 653a 0a2a 206e 6f74 2065  ortance:.* not e
+0000b930: 6e74 6972 656c 7920 636f 6e66 6964 656e  ntirely confiden
+0000b940: 7420 7468 6174 2072 6561 642d 6f6e 6c79  t that read-only
+0000b950: 2069 7320 7265 6164 2d6f 6e6c 790a 2a20   is read-only.* 
+0000b960: 7468 6520 736d 6220 6261 636b 656e 6420  the smb backend 
+0000b970: 6973 206e 6f74 2066 756c 6c79 2069 6e74  is not fully int
+0000b980: 6567 7261 7465 6420 7769 7468 2076 6673  egrated with vfs
+0000b990: 2c20 6d65 616e 696e 6720 7468 6572 6520  , meaning there 
+0000b9a0: 636f 756c 6420 6265 2073 6563 7572 6974  could be securit
+0000b9b0: 7920 6973 7375 6573 2028 7061 7468 2074  y issues (path t
+0000b9c0: 7261 7665 7273 616c 292e 2050 6c65 6173  raversal). Pleas
+0000b9d0: 6520 7573 6520 602d 2d73 6d62 2d70 6f72  e use `--smb-por
+0000b9e0: 7460 2028 7365 6520 6265 6c6f 7729 2061  t` (see below) a
+0000b9f0: 6e64 205b 7072 6973 6f6e 7061 7274 795d  nd [prisonparty]
+0000ba00: 282e 2f62 696e 2f70 7269 736f 6e70 6172  (./bin/prisonpar
+0000ba10: 7479 2e73 6829 0a20 202a 2061 6363 6f75  ty.sh).  * accou
+0000ba20: 6e74 2070 6173 7377 6f72 6473 2077 6f72  nt passwords wor
+0000ba30: 6b20 7065 722d 766f 6c75 6d65 2061 7320  k per-volume as 
+0000ba40: 6578 7065 6374 6564 2c20 6275 7420 6163  expected, but ac
+0000ba50: 636f 756e 7420 7065 726d 6973 7369 6f6e  count permission
+0000ba60: 7320 6172 6520 636f 616c 6573 6365 643b  s are coalesced;
+0000ba70: 2061 6c6c 2061 6363 6f75 6e74 7320 6861   all accounts ha
+0000ba80: 7665 2072 6561 642d 6163 6365 7373 2074  ve read-access t
+0000ba90: 6f20 616c 6c20 766f 6c75 6d65 732c 2061  o all volumes, a
+0000baa0: 6e64 2069 6620 6120 7369 6e67 6c65 2061  nd if a single a
+0000bab0: 6363 6f75 6e74 2068 6173 2077 7269 7465  ccount has write
+0000bac0: 2d61 6363 6573 7320 746f 2073 6f6d 6520  -access to some 
+0000bad0: 766f 6c75 6d65 2074 6865 6e20 616c 6c20  volume then all 
+0000bae0: 6f74 6865 7220 6163 636f 756e 7473 2061  other accounts a
+0000baf0: 6c73 6f20 646f 0a20 2020 202a 2069 6620  lso do.    * if 
+0000bb00: 6e6f 2061 6363 6f75 6e74 7320 6861 7665  no accounts have
+0000bb10: 2077 7269 7465 2d61 6363 6573 7320 746f   write-access to
+0000bb20: 2061 2073 7065 6369 6669 6320 766f 6c75   a specific volu
+0000bb30: 6d65 2c20 6f72 2069 6620 602d 2d73 6d62  me, or if `--smb
+0000bb40: 7760 2069 7320 6e6f 7420 7365 742c 2074  w` is not set, t
+0000bb50: 6865 6e20 7772 6974 696e 6720 746f 2074  hen writing to t
+0000bb60: 6861 7420 766f 6c75 6d65 2066 726f 6d20  hat volume from 
+0000bb70: 736d 6220 2a73 686f 756c 642a 2062 6520  smb *should* be 
+0000bb80: 696d 706f 7373 6962 6c65 0a20 2020 202a  impossible.    *
+0000bb90: 2077 696c 6c20 6265 2066 6978 6564 206f   will be fixed o
+0000bba0: 6e63 6520 5b69 6d70 6163 6b65 7420 7630  nce [impacket v0
+0000bbb0: 2e31 312e 305d 2868 7474 7073 3a2f 2f67  .11.0](https://g
+0000bbc0: 6974 6875 622e 636f 6d2f 5365 6375 7265  ithub.com/Secure
+0000bbd0: 4175 7468 436f 7270 2f69 6d70 6163 6b65  AuthCorp/impacke
+0000bbe0: 742f 636f 6d6d 6974 2f64 3932 3363 3030  t/commit/d923c00
+0000bbf0: 6637 3564 3534 6239 3732 6263 6135 3733  f75d54b972bca573
+0000bc00: 6132 3131 6138 3266 3039 6235 3532 3631  a211a82f09b55261
+0000bc10: 6129 2069 7320 7265 6c65 6173 6564 0a20  a) is released. 
+0000bc20: 202a 205b 7368 6164 6f77 696e 675d 2823   * [shadowing](#
+0000bc30: 7368 6164 6f77 696e 6729 2070 726f 6261  shadowing) proba
+0000bc40: 626c 7920 776f 726b 7320 6173 2065 7870  bly works as exp
+0000bc50: 6563 7465 6420 6275 7420 6e6f 2067 7561  ected but no gua
+0000bc60: 7261 6e74 6565 730a 0a61 6e64 2073 6f6d  rantees..and som
+0000bc70: 6520 6d69 6e6f 7220 6973 7375 6573 2c0a  e minor issues,.
+0000bc80: 2a20 636c 6965 6e74 7320 6f6e 6c79 2073  * clients only s
+0000bc90: 6565 2074 6865 2066 6972 7374 207e 3430  ee the first ~40
+0000bca0: 3020 6669 6c65 7320 696e 2062 6967 2066  0 files in big f
+0000bcb0: 6f6c 6465 7273 3b20 5b69 6d70 6163 6b65  olders; [impacke
+0000bcc0: 7423 3134 3333 5d28 6874 7470 733a 2f2f  t#1433](https://
+0000bcd0: 6769 7468 7562 2e63 6f6d 2f53 6563 7572  github.com/Secur
+0000bce0: 6541 7574 6843 6f72 702f 696d 7061 636b  eAuthCorp/impack
+0000bcf0: 6574 2f69 7373 7565 732f 3134 3333 290a  et/issues/1433).
+0000bd00: 2a20 686f 742d 7265 6c6f 6164 206f 6620  * hot-reload of 
+0000bd10: 7365 7276 6572 2063 6f6e 6669 6720 2860  server config (`
+0000bd20: 2f3f 7265 6c6f 6164 3d63 6667 6029 2064  /?reload=cfg`) d
+0000bd30: 6f65 7320 6e6f 7420 696e 636c 7564 6520  oes not include 
+0000bd40: 7468 6520 605b 676c 6f62 616c 5d60 2073  the `[global]` s
+0000bd50: 6563 7469 6f6e 2028 636f 6d6d 616e 646c  ection (commandl
+0000bd60: 696e 6520 6172 6773 290a 2a20 6c69 7374  ine args).* list
+0000bd70: 656e 7320 6f6e 2074 6865 2066 6972 7374  ens on the first
+0000bd80: 2049 5076 3420 602d 6960 2069 6e74 6572   IPv4 `-i` inter
+0000bd90: 6661 6365 206f 6e6c 7920 2864 6566 6175  face only (defau
+0000bda0: 6c74 203d 203a 3a20 3d20 302e 302e 302e  lt = :: = 0.0.0.
+0000bdb0: 3020 3d20 616c 6c29 0a2a 206c 6f67 696e  0 = all).* login
+0000bdc0: 2064 6f65 736e 2774 2077 6f72 6b20 6f6e   doesn't work on
+0000bdd0: 2077 696e 7870 2c20 6275 7420 616e 6f6e   winxp, but anon
+0000bde0: 796d 6f75 7320 6163 6365 7373 2069 7320  ymous access is 
+0000bdf0: 6f6b 202d 2d20 7265 6d6f 7665 2061 6c6c  ok -- remove all
+0000be00: 2061 6363 6f75 6e74 7320 6672 6f6d 2063   accounts from c
+0000be10: 6f70 7970 6172 7479 2063 6f6e 6669 6720  opyparty config 
+0000be20: 666f 7220 7468 6174 2074 6f20 776f 726b  for that to work
+0000be30: 0a20 202a 2077 696e 3130 206f 6e77 6172  .  * win10 onwar
+0000be40: 6473 2064 6f65 7320 6e6f 7420 616c 6c6f  ds does not allo
+0000be50: 7720 636f 6e6e 6563 7469 6e67 2061 6e6f  w connecting ano
+0000be60: 6e79 6d6f 7573 6c79 202f 2077 6974 686f  nymously / witho
+0000be70: 7574 2061 6363 6f75 6e74 730a 2a20 6f6e  ut accounts.* on
+0000be80: 2077 696e 646f 7773 2c20 6372 6561 7469   windows, creati
+0000be90: 6e67 2061 206e 6577 2066 696c 6520 7468  ng a new file th
+0000bea0: 726f 7567 6820 7269 6768 7463 6c69 636b  rough rightclick
+0000beb0: 202d 2d3e 206e 6577 202d 2d3e 2074 6578   --> new --> tex
+0000bec0: 7466 696c 6520 7468 726f 7773 2061 6e20  tfile throws an 
+0000bed0: 6572 726f 7220 6475 6520 746f 2069 6d70  error due to imp
+0000bee0: 6163 6b65 7420 6c69 6d69 7461 7469 6f6e  acket limitation
+0000bef0: 7320 2d2d 2068 6974 204f 4b20 616e 6420  s -- hit OK and 
+0000bf00: 4635 2074 6f20 6765 7420 796f 7572 2066  F5 to get your f
+0000bf10: 696c 650a 2a20 7079 7468 6f6e 3320 6f6e  ile.* python3 on
+0000bf20: 6c79 0a2a 2073 6c6f 770a 0a6b 6e6f 776e  ly.* slow..known
+0000bf30: 2063 6c69 656e 7420 6275 6773 3a0a 2a20   client bugs:.* 
+0000bf40: 6f6e 2077 696e 3720 6f6e 6c79 2c20 602d  on win7 only, `-
+0000bf50: 2d73 6d62 3160 2069 7320 6d75 6368 2066  -smb1` is much f
+0000bf60: 6173 7465 7220 7468 616e 2073 6d62 3220  aster than smb2 
+0000bf70: 2864 6566 6175 6c74 2920 6265 6361 7573  (default) becaus
+0000bf80: 6520 6974 206b 6565 7073 2072 6573 6361  e it keeps resca
+0000bf90: 6e6e 696e 6720 666f 6c64 6572 7320 6f6e  nning folders on
+0000bfa0: 2073 6d62 320a 2020 2a20 686f 7765 7665   smb2.  * howeve
+0000bfb0: 7220 736d 6231 2069 7320 6275 6767 7920  r smb1 is buggy 
+0000bfc0: 616e 6420 6973 206e 6f74 2065 6e61 626c  and is not enabl
+0000bfd0: 6564 2062 7920 6465 6661 756c 7420 6f6e  ed by default on
+0000bfe0: 2077 696e 3130 206f 6e77 6172 6473 0a2a   win10 onwards.*
+0000bff0: 2077 696e 646f 7773 2063 616e 6e6f 7420   windows cannot 
+0000c000: 6163 6365 7373 2066 6f6c 6465 7273 2077  access folders w
+0000c010: 6869 6368 2063 6f6e 7461 696e 2066 696c  hich contain fil
+0000c020: 656e 616d 6573 2077 6974 6820 696e 7661  enames with inva
+0000c030: 6c69 6420 756e 6963 6f64 6520 6f72 2066  lid unicode or f
+0000c040: 6f72 6269 6464 656e 2063 6861 7261 6374  orbidden charact
+0000c050: 6572 7320 2860 3c3e 3a22 2f5c 7c3f 2a60  ers (`<>:"/\|?*`
+0000c060: 292c 206f 7220 6e61 6d65 7320 656e 6469  ), or names endi
+0000c070: 6e67 2077 6974 6820 602e 600a 0a74 6865  ng with `.`..the
+0000c080: 2073 6d62 2070 726f 746f 636f 6c20 6c69   smb protocol li
+0000c090: 7374 656e 7320 6f6e 2054 4350 2070 6f72  stens on TCP por
+0000c0a0: 7420 3434 352c 2077 6869 6368 2069 7320  t 445, which is 
+0000c0b0: 6120 7072 6976 696c 6567 6564 2070 6f72  a privileged por
+0000c0c0: 7420 6f6e 206c 696e 7578 2061 6e64 206d  t on linux and m
+0000c0d0: 6163 6f73 2c20 7768 6963 6820 776f 756c  acos, which woul
+0000c0e0: 6420 7265 7175 6972 6520 7275 6e6e 696e  d require runnin
+0000c0f0: 6720 636f 7079 7061 7274 7920 6173 2072  g copyparty as r
+0000c100: 6f6f 742e 2048 6f77 6576 6572 2c20 7468  oot. However, th
+0000c110: 6973 2063 616e 2062 6520 6176 6f69 6465  is can be avoide
+0000c120: 6420 6279 206c 6973 7465 6e69 6e67 206f  d by listening o
+0000c130: 6e20 616e 6f74 6865 7220 706f 7274 2075  n another port u
+0000c140: 7369 6e67 2060 2d2d 736d 622d 706f 7274  sing `--smb-port
+0000c150: 2033 3934 3560 2061 6e64 2074 6865 6e20   3945` and then 
+0000c160: 7573 696e 6720 4e41 5420 746f 2066 6f72  using NAT to for
+0000c170: 7761 7264 2074 6865 2074 7261 6666 6963  ward the traffic
+0000c180: 2066 726f 6d20 3434 3520 746f 2074 6865   from 445 to the
+0000c190: 7265 3b0a 2a20 6f6e 206c 696e 7578 3a20  re;.* on linux: 
+0000c1a0: 6069 7074 6162 6c65 7320 2d74 206e 6174  `iptables -t nat
+0000c1b0: 202d 4120 5052 4552 4f55 5449 4e47 202d   -A PREROUTING -
+0000c1c0: 6920 6574 6830 202d 7020 7463 7020 2d2d  i eth0 -p tcp --
+0000c1d0: 6470 6f72 7420 3434 3520 2d6a 2052 4544  dport 445 -j RED
+0000c1e0: 4952 4543 5420 2d2d 746f 2d70 6f72 7420  IRECT --to-port 
+0000c1f0: 3339 3435 600a 0a61 7574 6865 6e74 6963  3945`..authentic
+0000c200: 6174 6520 7769 7468 206f 6e65 206f 6620  ate with one of 
+0000c210: 7468 6520 666f 6c6c 6f77 696e 673a 0a2a  the following:.*
+0000c220: 2075 7365 726e 616d 6520 6024 7573 6572   username `$user
+0000c230: 6e61 6d65 602c 2070 6173 7377 6f72 6420  name`, password 
+0000c240: 6024 7061 7373 776f 7264 600a 2a20 7573  `$password`.* us
+0000c250: 6572 6e61 6d65 2060 2470 6173 7377 6f72  ername `$passwor
+0000c260: 6460 2c20 7061 7373 776f 7264 2060 6b60  d`, password `k`
+0000c270: 0a0a 0a23 2320 6669 6c65 2069 6e64 6578  ...## file index
+0000c280: 696e 670a 0a65 6e61 626c 6573 2064 6564  ing..enables ded
+0000c290: 7570 2061 6e64 206d 7573 6963 2073 6561  up and music sea
+0000c2a0: 7263 6820 2b2b 0a0a 6669 6c65 2069 6e64  rch ++..file ind
+0000c2b0: 6578 696e 6720 7265 6c69 6573 206f 6e20  exing relies on 
+0000c2c0: 7477 6f20 6461 7461 6261 7365 2074 6162  two database tab
+0000c2d0: 6c65 732c 2074 6865 2075 7032 6b20 6669  les, the up2k fi
+0000c2e0: 6c65 7472 6565 2028 602d 6532 6460 2920  letree (`-e2d`) 
+0000c2f0: 616e 6420 7468 6520 6d65 7461 6461 7461  and the metadata
+0000c300: 2074 6167 7320 2860 2d65 3274 6029 2c20   tags (`-e2t`), 
+0000c310: 7374 6f72 6564 2069 6e20 602e 6869 7374  stored in `.hist
+0000c320: 2f75 7032 6b2e 6462 602e 2043 6f6e 6669  /up2k.db`. Confi
+0000c330: 6775 7261 7469 6f6e 2063 616e 2062 6520  guration can be 
+0000c340: 646f 6e65 2074 6872 6f75 6768 2061 7267  done through arg
+0000c350: 756d 656e 7473 2c20 766f 6c66 6c61 6773  uments, volflags
+0000c360: 2c20 6f72 2061 206d 6978 206f 6620 626f  , or a mix of bo
+0000c370: 7468 2e0a 0a74 6872 6f75 6768 2061 7267  th...through arg
+0000c380: 756d 656e 7473 3a0a 2a20 602d 6532 6460  uments:.* `-e2d`
+0000c390: 2065 6e61 626c 6573 2066 696c 6520 696e   enables file in
+0000c3a0: 6465 7869 6e67 206f 6e20 7570 6c6f 6164  dexing on upload
+0000c3b0: 0a2a 2060 2d65 3264 7360 2061 6c73 6f20  .* `-e2ds` also 
+0000c3c0: 7363 616e 7320 7772 6974 6162 6c65 2066  scans writable f
+0000c3d0: 6f6c 6465 7273 2066 6f72 206e 6577 2066  olders for new f
+0000c3e0: 696c 6573 206f 6e20 7374 6172 7475 700a  iles on startup.
+0000c3f0: 2a20 602d 6532 6473 6160 2061 6c73 6f20  * `-e2dsa` also 
+0000c400: 7363 616e 7320 616c 6c20 6d6f 756e 7465  scans all mounte
+0000c410: 6420 766f 6c75 6d65 7320 2869 6e63 6c75  d volumes (inclu
+0000c420: 6469 6e67 2072 6561 646f 6e6c 7920 6f6e  ding readonly on
+0000c430: 6573 290a 2a20 602d 6532 7460 2065 6e61  es).* `-e2t` ena
+0000c440: 626c 6573 206d 6574 6164 6174 6120 696e  bles metadata in
+0000c450: 6465 7869 6e67 206f 6e20 7570 6c6f 6164  dexing on upload
+0000c460: 0a2a 2060 2d65 3274 7360 2061 6c73 6f20  .* `-e2ts` also 
+0000c470: 7363 616e 7320 666f 7220 7461 6773 2069  scans for tags i
+0000c480: 6e20 616c 6c20 6669 6c65 7320 7468 6174  n all files that
+0000c490: 2064 6f6e 2774 2068 6176 6520 7461 6773   don't have tags
+0000c4a0: 2079 6574 0a2a 2060 2d65 3274 7372 6020   yet.* `-e2tsr` 
+0000c4b0: 616c 736f 2064 656c 6574 6573 2061 6c6c  also deletes all
+0000c4c0: 2065 7869 7374 696e 6720 7461 6773 2c20   existing tags, 
+0000c4d0: 646f 696e 6720 6120 6675 6c6c 2072 6569  doing a full rei
+0000c4e0: 6e64 6578 0a2a 2060 2d65 3276 6020 7665  ndex.* `-e2v` ve
+0000c4f0: 7266 6965 7320 6669 6c65 2069 6e74 6567  rfies file integ
+0000c500: 7269 7479 2061 7420 7374 6172 7475 702c  rity at startup,
+0000c510: 2063 6f6d 7061 7269 6e67 2068 6173 6865   comparing hashe
+0000c520: 7320 6672 6f6d 2074 6865 2064 620a 2a20  s from the db.* 
+0000c530: 602d 6532 7675 6020 7061 7463 6865 7320  `-e2vu` patches 
+0000c540: 7468 6520 6461 7461 6261 7365 2077 6974  the database wit
+0000c550: 6820 7468 6520 6e65 7720 6861 7368 6573  h the new hashes
+0000c560: 2066 726f 6d20 7468 6520 6669 6c65 7379   from the filesy
+0000c570: 7374 656d 0a2a 2060 2d65 3276 7060 2070  stem.* `-e2vp` p
+0000c580: 616e 6963 7320 616e 6420 6b69 6c6c 7320  anics and kills 
+0000c590: 636f 7079 7061 7274 7920 696e 7374 6561  copyparty instea
+0000c5a0: 640a 2a20 602d 2d78 6c69 6e6b 6020 656e  d.* `--xlink` en
+0000c5b0: 6162 6c65 7320 6465 6475 706c 6963 6174  ables deduplicat
+0000c5c0: 696f 6e20 6163 726f 7373 2076 6f6c 756d  ion across volum
+0000c5d0: 6573 0a0a 7468 6520 7361 6d65 2061 7267  es..the same arg
+0000c5e0: 756d 656e 7473 2063 616e 2062 6520 7365  uments can be se
+0000c5f0: 7420 6173 2076 6f6c 666c 6167 732c 2069  t as volflags, i
+0000c600: 6e20 6164 6469 7469 6f6e 2074 6f20 6064  n addition to `d
+0000c610: 3264 602c 2060 6432 6473 602c 2060 6432  2d`, `d2ds`, `d2
+0000c620: 7460 2c20 6064 3274 7360 2c20 6064 3276  t`, `d2ts`, `d2v
+0000c630: 6020 666f 7220 6469 7361 626c 696e 673a  ` for disabling:
+0000c640: 0a2a 2060 2d76 207e 2f6d 7573 6963 3a3a  .* `-v ~/music::
+0000c650: 723a 632c 6532 6473 612c 6532 7473 7260  r:c,e2dsa,e2tsr`
+0000c660: 2064 6f65 7320 6120 6675 6c6c 2072 6569   does a full rei
+0000c670: 6e64 6578 206f 6620 6576 6572 7974 6869  ndex of everythi
+0000c680: 6e67 206f 6e20 7374 6172 7475 700a 2a20  ng on startup.* 
+0000c690: 602d 7620 7e2f 6d75 7369 633a 3a72 3a63  `-v ~/music::r:c
+0000c6a0: 2c64 3264 6020 6469 7361 626c 6573 202a  ,d2d` disables *
+0000c6b0: 2a61 6c6c 2a2a 2069 6e64 6578 696e 672c  *all** indexing,
+0000c6c0: 2065 7665 6e20 6966 2061 6e79 2060 2d65   even if any `-e
+0000c6d0: 322a 6020 6172 6520 6f6e 0a2a 2060 2d76  2*` are on.* `-v
+0000c6e0: 207e 2f6d 7573 6963 3a3a 723a 632c 6432   ~/music::r:c,d2
+0000c6f0: 7460 2064 6973 6162 6c65 7320 616c 6c20  t` disables all 
+0000c700: 602d 6532 742a 6020 2874 6167 7329 2c20  `-e2t*` (tags), 
+0000c710: 646f 6573 206e 6f74 2061 6666 6563 7420  does not affect 
+0000c720: 602d 6532 642a 600a 2a20 602d 7620 7e2f  `-e2d*`.* `-v ~/
+0000c730: 6d75 7369 633a 3a72 3a63 2c64 3264 7360  music::r:c,d2ds`
+0000c740: 2064 6973 6162 6c65 7320 6f6e 2d62 6f6f   disables on-boo
+0000c750: 7420 7363 616e 733b 206f 6e6c 7920 696e  t scans; only in
+0000c760: 6465 7820 6e65 7720 7570 6c6f 6164 730a  dex new uploads.
+0000c770: 2a20 602d 7620 7e2f 6d75 7369 633a 3a72  * `-v ~/music::r
+0000c780: 3a63 2c64 3274 7360 2073 616d 6520 6578  :c,d2ts` same ex
+0000c790: 6365 7074 206f 6e6c 7920 6166 6665 6374  cept only affect
+0000c7a0: 696e 6720 7461 6773 0a0a 6e6f 7465 3a0a  ing tags..note:.
+0000c7b0: 2a20 7468 6520 7061 7273 6572 2063 616e  * the parser can
+0000c7c0: 2066 696e 616c 6c79 2068 616e 646c 6520   finally handle 
+0000c7d0: 6063 2c65 3264 7361 2c65 3274 7372 6020  `c,e2dsa,e2tsr` 
+0000c7e0: 736f 2079 6f75 206e 6f20 6c6f 6e67 6572  so you no longer
+0000c7f0: 2068 6176 6520 746f 2060 632c 6532 6473   have to `c,e2ds
+0000c800: 613a 632c 6532 7473 7260 0a2a 2060 6532  a:c,e2tsr`.* `e2
+0000c810: 7473 7260 2069 7320 7072 6f62 6162 6c79  tsr` is probably
+0000c820: 2061 6c77 6179 7320 6f76 6572 6b69 6c6c   always overkill
+0000c830: 2c20 7369 6e63 6520 6065 3264 7360 2f60  , since `e2ds`/`
+0000c840: 6532 6473 6160 2077 6f75 6c64 2070 6963  e2dsa` would pic
+0000c850: 6b20 7570 2061 6e79 2066 696c 6520 6d6f  k up any file mo
+0000c860: 6469 6669 6361 7469 6f6e 7320 616e 6420  difications and 
+0000c870: 6065 3274 7360 2077 6f75 6c64 2074 6865  `e2ts` would the
+0000c880: 6e20 7265 696e 6465 7820 7468 6f73 652c  n reindex those,
+0000c890: 2075 6e6c 6573 7320 7468 6572 6520 6973   unless there is
+0000c8a0: 2061 206e 6577 2063 6f70 7970 6172 7479   a new copyparty
+0000c8b0: 2076 6572 7369 6f6e 2077 6974 6820 6e65   version with ne
+0000c8c0: 7720 7061 7273 6572 7320 616e 6420 7468  w parsers and th
+0000c8d0: 6520 7265 6c65 6173 6520 6e6f 7465 2073  e release note s
+0000c8e0: 6179 7320 6f74 6865 7277 6973 650a 2a20  ays otherwise.* 
+0000c8f0: 7468 6520 7265 7363 616e 2062 7574 746f  the rescan butto
+0000c900: 6e20 696e 2074 6865 2061 646d 696e 2070  n in the admin p
+0000c910: 616e 656c 2068 6173 206e 6f20 6566 6665  anel has no effe
+0000c920: 6374 2075 6e6c 6573 7320 7468 6520 766f  ct unless the vo
+0000c930: 6c75 6d65 2068 6173 2060 2d65 3264 7360  lume has `-e2ds`
+0000c940: 206f 7220 6869 6768 6572 0a2a 2064 6564   or higher.* ded
+0000c950: 7570 6c69 6361 7469 6f6e 2069 7320 706f  uplication is po
+0000c960: 7373 6962 6c65 206f 6e20 7769 6e64 6f77  ssible on window
+0000c970: 7320 6966 2079 6f75 2072 756e 2063 6f70  s if you run cop
+0000c980: 7970 6172 7479 2061 7320 6164 6d69 6e69  yparty as admini
+0000c990: 7374 7261 746f 7220 286e 6f74 2073 6179  strator (not say
+0000c9a0: 696e 6720 796f 7520 7368 6f75 6c64 2129  ing you should!)
+0000c9b0: 0a0a 2323 2320 6578 636c 7564 652d 7061  ..### exclude-pa
+0000c9c0: 7474 6572 6e73 0a0a 746f 2073 6176 6520  tterns..to save 
+0000c9d0: 736f 6d65 2074 696d 652c 2020 796f 7520  some time,  you 
+0000c9e0: 6361 6e20 7072 6f76 6964 6520 6120 7265  can provide a re
+0000c9f0: 6765 7820 7061 7474 6572 6e20 666f 7220  gex pattern for 
+0000ca00: 6669 6c65 7061 7468 7320 746f 206f 6e6c  filepaths to onl
+0000ca10: 7920 696e 6465 7820 6279 2066 696c 656e  y index by filen
+0000ca20: 616d 652f 7061 7468 2f73 697a 652f 6c61  ame/path/size/la
+0000ca30: 7374 2d6d 6f64 6966 6965 6420 2861 6e64  st-modified (and
+0000ca40: 206e 6f74 2074 6865 2068 6173 6820 6f66   not the hash of
+0000ca50: 2074 6865 2066 696c 6520 636f 6e74 656e   the file conten
+0000ca60: 7473 2920 6279 2073 6574 7469 6e67 2060  ts) by setting `
+0000ca70: 2d2d 6e6f 2d68 6173 6820 5c2e 6973 6f24  --no-hash \.iso$
+0000ca80: 6020 6f72 2074 6865 2076 6f6c 666c 6167  ` or the volflag
+0000ca90: 2060 3a63 2c6e 6f68 6173 683d 5c2e 6973   `:c,nohash=\.is
+0000caa0: 6f24 602c 2074 6869 7320 6861 7320 7468  o$`, this has th
+0000cab0: 6520 666f 6c6c 6f77 696e 6720 636f 6e73  e following cons
+0000cac0: 6571 7565 6e63 6573 3a0a 2a20 696e 6974  equences:.* init
+0000cad0: 6961 6c20 696e 6465 7869 6e67 2069 7320  ial indexing is 
+0000cae0: 7761 7920 6661 7374 6572 2c20 6573 7065  way faster, espe
+0000caf0: 6369 616c 6c79 2077 6865 6e20 7468 6520  cially when the 
+0000cb00: 766f 6c75 6d65 2069 7320 6f6e 2061 206e  volume is on a n
+0000cb10: 6574 776f 726b 2064 6973 6b0a 2a20 6d61  etwork disk.* ma
+0000cb20: 6b65 7320 6974 2069 6d70 6f73 7369 626c  kes it impossibl
+0000cb30: 6520 746f 205b 6669 6c65 2d73 6561 7263  e to [file-searc
+0000cb40: 685d 2823 6669 6c65 2d73 6561 7263 6829  h](#file-search)
+0000cb50: 0a2a 2069 6620 736f 6d65 6f6e 6520 7570  .* if someone up
+0000cb60: 6c6f 6164 7320 7468 6520 7361 6d65 2066  loads the same f
+0000cb70: 696c 6520 636f 6e74 656e 7473 2c20 7468  ile contents, th
+0000cb80: 6520 7570 6c6f 6164 2077 696c 6c20 6e6f  e upload will no
+0000cb90: 7420 6265 2064 6574 6563 7465 6420 6173  t be detected as
+0000cba0: 2061 2064 7570 652c 2073 6f20 6974 2077   a dupe, so it w
+0000cbb0: 696c 6c20 6e6f 7420 6765 7420 7379 6d6c  ill not get syml
+0000cbc0: 696e 6b65 6420 6f72 2072 656a 6563 7465  inked or rejecte
+0000cbd0: 640a 0a73 696d 696c 6172 6c79 2c20 796f  d..similarly, yo
+0000cbe0: 7520 6361 6e20 6675 6c6c 7920 6967 6e6f  u can fully igno
+0000cbf0: 7265 2066 696c 6573 2f66 6f6c 6465 7273  re files/folders
+0000cc00: 2075 7369 6e67 2060 2d2d 6e6f 2d69 6478   using `--no-idx
+0000cc10: 205b 2e2e 2e5d 6020 616e 6420 603a 632c   [...]` and `:c,
+0000cc20: 6e6f 6964 783d 5c2e 6973 6f24 600a 0a69  noidx=\.iso$`..i
+0000cc30: 6620 796f 7520 7365 7420 602d 2d6e 6f2d  f you set `--no-
+0000cc40: 6861 7368 205b 2e2e 2e5d 6020 676c 6f62  hash [...]` glob
+0000cc50: 616c 6c79 2c20 796f 7520 6361 6e20 656e  ally, you can en
+0000cc60: 6162 6c65 2068 6173 6869 6e67 2066 6f72  able hashing for
+0000cc70: 2073 7065 6369 6669 6320 766f 6c75 6d65   specific volume
+0000cc80: 7320 7573 696e 6720 666c 6167 2060 3a63  s using flag `:c
+0000cc90: 2c6e 6f68 6173 683d 600a 0a23 2323 2066  ,nohash=`..### f
+0000cca0: 696c 6573 7973 7465 6d20 6775 6172 6473  ilesystem guards
+0000ccb0: 0a0a 6176 6f69 6420 7472 6176 6572 7369  ..avoid traversi
+0000ccc0: 6e67 2069 6e74 6f20 6f74 6865 7220 6669  ng into other fi
+0000ccd0: 6c65 7379 7374 656d 7320 2075 7369 6e67  lesystems  using
+0000cce0: 2060 2d2d 7864 6576 6020 2f20 766f 6c66   `--xdev` / volf
+0000ccf0: 6c61 6720 603a 632c 7864 6576 602c 2073  lag `:c,xdev`, s
+0000cd00: 6b69 7070 696e 6720 616e 7920 7379 6d6c  kipping any syml
+0000cd10: 696e 6b73 206f 7220 6269 6e64 2d6d 6f75  inks or bind-mou
+0000cd20: 6e74 7320 746f 2061 6e6f 7468 6572 2048  nts to another H
+0000cd30: 4444 2066 6f72 2065 7861 6d70 6c65 0a0a  DD for example..
+0000cd40: 616e 642f 6f72 2079 6f75 2063 616e 2060  and/or you can `
+0000cd50: 2d2d 7876 6f6c 6020 2f20 603a 632c 7876  --xvol` / `:c,xv
+0000cd60: 6f6c 6020 746f 2069 676e 6f72 6520 616c  ol` to ignore al
+0000cd70: 6c20 7379 6d6c 696e 6b73 206c 6561 7669  l symlinks leavi
+0000cd80: 6e67 2074 6865 2076 6f6c 756d 6527 7320  ng the volume's 
+0000cd90: 746f 7020 6469 7265 6374 6f72 792c 2062  top directory, b
+0000cda0: 7574 2073 7469 6c6c 2061 6c6c 6f77 2062  ut still allow b
+0000cdb0: 696e 642d 6d6f 756e 7473 2070 6f69 6e74  ind-mounts point
+0000cdc0: 696e 6720 656c 7365 7768 6572 650a 0a2a  ing elsewhere..*
+0000cdd0: 2073 796d 6c69 6e6b 7320 6172 6520 7065   symlinks are pe
+0000cde0: 726d 6974 7465 6420 7769 7468 2060 7876  rmitted with `xv
+0000cdf0: 6f6c 6020 6966 2074 6865 7920 706f 696e  ol` if they poin
+0000ce00: 7420 696e 746f 2061 6e6f 7468 6572 2076  t into another v
+0000ce10: 6f6c 756d 6520 7768 6572 6520 7468 6520  olume where the 
+0000ce20: 7573 6572 2068 6173 2074 6865 2073 616d  user has the sam
+0000ce30: 6520 6c65 7665 6c20 6f66 2061 6363 6573  e level of acces
+0000ce40: 730a 0a74 6865 7365 206f 7074 696f 6e73  s..these options
+0000ce50: 2077 696c 6c20 7265 6475 6365 2070 6572   will reduce per
+0000ce60: 666f 726d 616e 6365 3b20 756e 6c69 6b65  formance; unlike
+0000ce70: 6c79 2077 6f72 7374 2d63 6173 6520 6573  ly worst-case es
+0000ce80: 7469 6d61 7465 7320 6172 6520 3134 2520  timates are 14% 
+0000ce90: 7265 6475 6374 696f 6e20 666f 7220 6469  reduction for di
+0000cea0: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
+0000ceb0: 2c20 3335 2520 666f 7220 646f 776e 6c6f  , 35% for downlo
+0000cec0: 6164 2d61 732d 7461 720a 0a61 7320 6f66  ad-as-tar..as of
+0000ced0: 2063 6f70 7970 6172 7479 2076 312e 372e   copyparty v1.7.
+0000cee0: 3020 7468 6573 6520 6f70 7469 6f6e 7320  0 these options 
+0000cef0: 616c 736f 2070 7265 7665 6e74 2066 696c  also prevent fil
+0000cf00: 6520 6163 6365 7373 2061 7420 7275 6e74  e access at runt
+0000cf10: 696d 6520 2d2d 2069 6e20 7072 6576 696f  ime -- in previo
+0000cf20: 7573 2076 6572 7369 6f6e 7320 6974 2077  us versions it w
+0000cf30: 6173 206a 7573 7420 6869 6e74 7320 666f  as just hints fo
+0000cf40: 7220 7468 6520 696e 6465 7865 720a 0a23  r the indexer..#
+0000cf50: 2323 2070 6572 696f 6469 6320 7265 7363  ## periodic resc
+0000cf60: 616e 0a0a 6669 6c65 7379 7374 656d 206d  an..filesystem m
+0000cf70: 6f6e 6974 6f72 696e 673b 2020 6966 2063  onitoring;  if c
+0000cf80: 6f70 7970 6172 7479 2069 7320 6e6f 7420  opyparty is not 
+0000cf90: 7468 6520 6f6e 6c79 2073 6f66 7477 6172  the only softwar
+0000cfa0: 6520 646f 696e 6720 7374 7566 6620 6f6e  e doing stuff on
+0000cfb0: 2079 6f75 7220 6669 6c65 7379 7374 656d   your filesystem
+0000cfc0: 2c20 796f 7520 6d61 7920 7761 6e74 2074  , you may want t
+0000cfd0: 6f20 656e 6162 6c65 2070 6572 696f 6469  o enable periodi
+0000cfe0: 6320 7265 7363 616e 7320 746f 206b 6565  c rescans to kee
+0000cff0: 7020 7468 6520 696e 6465 7820 7570 2074  p the index up t
+0000d000: 6f20 6461 7465 0a0a 6172 6775 6d65 6e74  o date..argument
+0000d010: 2060 2d2d 7265 2d6d 6178 6167 6520 3630   `--re-maxage 60
+0000d020: 6020 7769 6c6c 2072 6573 6361 6e20 616c  ` will rescan al
+0000d030: 6c20 766f 6c75 6d65 7320 6576 6572 7920  l volumes every 
+0000d040: 3630 2073 6563 2c20 7361 6d65 2061 7320  60 sec, same as 
+0000d050: 766f 6c66 6c61 6720 603a 632c 7363 616e  volflag `:c,scan
+0000d060: 3d36 3060 2074 6f20 7370 6563 6966 7920  =60` to specify 
+0000d070: 6974 2070 6572 2d76 6f6c 756d 650a 0a75  it per-volume..u
+0000d080: 706c 6f61 6473 2061 7265 2064 6973 6162  ploads are disab
+0000d090: 6c65 6420 7768 696c 6520 6120 7265 7363  led while a resc
+0000d0a0: 616e 2069 7320 6861 7070 656e 696e 672c  an is happening,
+0000d0b0: 2073 6f20 7265 7363 616e 7320 7769 6c6c   so rescans will
+0000d0c0: 2062 6520 6465 6c61 7965 6420 6279 2060   be delayed by `
+0000d0d0: 2d2d 6462 2d61 6374 6020 2864 6566 6175  --db-act` (defau
+0000d0e0: 6c74 2031 3020 7365 6329 2077 6865 6e20  lt 10 sec) when 
+0000d0f0: 7468 6572 6520 6973 2077 7269 7465 2d61  there is write-a
+0000d100: 6374 6976 6974 7920 676f 696e 6720 6f6e  ctivity going on
+0000d110: 2028 7570 6c6f 6164 732c 2072 656e 616d   (uploads, renam
+0000d120: 6573 2c20 2e2e 2e29 0a0a 0a23 2320 7570  es, ...)...## up
+0000d130: 6c6f 6164 2072 756c 6573 0a0a 7365 7420  load rules..set 
+0000d140: 7570 6c6f 6164 2072 756c 6573 2075 7369  upload rules usi
+0000d150: 6e67 2076 6f6c 666c 6167 732c 2020 736f  ng volflags,  so
+0000d160: 6d65 2065 7861 6d70 6c65 733a 0a0a 2a20  me examples:..* 
+0000d170: 603a 632c 737a 3d31 6b2d 336d 6020 7365  `:c,sz=1k-3m` se
+0000d180: 7473 2061 6c6c 6f77 6564 2066 696c 6573  ts allowed files
+0000d190: 697a 6520 6265 7477 6565 6e20 3120 4b69  ize between 1 Ki
+0000d1a0: 4220 616e 6420 3320 4d69 4220 696e 636c  B and 3 MiB incl
+0000d1b0: 7573 6976 6520 2873 7566 6669 7865 733a  usive (suffixes:
+0000d1c0: 2060 6260 2c20 606b 602c 2060 6d60 2c20   `b`, `k`, `m`, 
+0000d1d0: 6067 6029 0a2a 2060 3a63 2c64 663d 3467  `g`).* `:c,df=4g
+0000d1e0: 6020 626c 6f63 6b20 7570 6c6f 6164 7320  ` block uploads 
+0000d1f0: 6966 2074 6865 7265 2077 6f75 6c64 2062  if there would b
+0000d200: 6520 6c65 7373 2074 6861 6e20 3420 4769  e less than 4 Gi
+0000d210: 4220 6672 6565 2064 6973 6b20 7370 6163  B free disk spac
+0000d220: 6520 6166 7465 7277 6172 6473 0a2a 2060  e afterwards.* `
+0000d230: 3a63 2c6e 6f73 7562 6020 6469 7361 6c6c  :c,nosub` disall
+0000d240: 6f77 2075 706c 6f61 6469 6e67 2069 6e74  ow uploading int
+0000d250: 6f20 7375 6264 6972 6563 746f 7269 6573  o subdirectories
+0000d260: 3b20 676f 6573 2077 656c 6c20 7769 7468  ; goes well with
+0000d270: 2060 726f 746e 6020 616e 6420 6072 6f74   `rotn` and `rot
+0000d280: 6660 3a0a 2a20 603a 632c 726f 746e 3d31  f`:.* `:c,rotn=1
+0000d290: 3030 302c 3260 206d 6f76 6573 2075 706c  000,2` moves upl
+0000d2a0: 6f61 6473 2069 6e74 6f20 7375 6266 6f6c  oads into subfol
+0000d2b0: 6465 7273 2c20 7570 2074 6f20 3130 3030  ders, up to 1000
+0000d2c0: 2066 696c 6573 2069 6e20 6561 6368 2066   files in each f
+0000d2d0: 6f6c 6465 7220 6265 666f 7265 206d 616b  older before mak
+0000d2e0: 696e 6720 6120 6e65 7720 6f6e 652c 2074  ing a new one, t
+0000d2f0: 776f 206c 6576 656c 7320 6465 6570 2028  wo levels deep (
+0000d300: 6d75 7374 2062 6520 6174 206c 6561 7374  must be at least
+0000d310: 2031 290a 2a20 603a 632c 726f 7466 3d25   1).* `:c,rotf=%
+0000d320: 592f 256d 2f25 642f 2548 6020 656e 666f  Y/%m/%d/%H` enfo
+0000d330: 7263 6573 2066 696c 6573 2074 6f20 6265  rces files to be
+0000d340: 2075 706c 6f61 6465 6420 696e 746f 2061   uploaded into a
+0000d350: 2073 7472 7563 7475 7265 206f 6620 7375   structure of su
+0000d360: 6266 6f6c 6465 7273 2061 6363 6f72 6469  bfolders accordi
+0000d370: 6e67 2074 6f20 7468 6174 2064 6174 6520  ng to that date 
+0000d380: 666f 726d 6174 0a20 202a 2069 6620 736f  format.  * if so
+0000d390: 6d65 6f6e 6520 7570 6c6f 6164 7320 746f  meone uploads to
+0000d3a0: 2060 2f66 6f6f 2f62 6172 6020 7468 6520   `/foo/bar` the 
+0000d3b0: 7061 7468 2077 6f75 6c64 2062 6520 7265  path would be re
+0000d3c0: 7772 6974 7465 6e20 746f 2060 2f66 6f6f  written to `/foo
+0000d3d0: 2f62 6172 2f32 3032 312f 3038 2f30 362f  /bar/2021/08/06/
+0000d3e0: 3233 6020 666f 7220 6578 616d 706c 650a  23` for example.
+0000d3f0: 2020 2a20 6275 7420 7468 6520 6163 7475    * but the actu
+0000d400: 616c 2076 616c 7565 2069 7320 6e6f 7420  al value is not 
+0000d410: 7665 7269 6669 6564 2c20 6a75 7374 2074  verified, just t
+0000d420: 6865 2073 7472 7563 7475 7265 2c20 736f  he structure, so
+0000d430: 2074 6865 2075 706c 6f61 6465 7220 6361   the uploader ca
+0000d440: 6e20 6368 6f6f 7365 2061 6e79 2076 616c  n choose any val
+0000d450: 7565 7320 7768 6963 6820 636f 6e66 6f72  ues which confor
+0000d460: 6d20 746f 2074 6865 2066 6f72 6d61 7420  m to the format 
+0000d470: 7374 7269 6e67 0a20 2020 202a 206a 7573  string.    * jus
+0000d480: 7420 746f 2061 766f 6964 2061 6464 6974  t to avoid addit
+0000d490: 696f 6e61 6c20 636f 6d70 6c65 7869 7479  ional complexity
+0000d4a0: 2069 6e20 7570 326b 2077 6869 6368 2069   in up2k which i
+0000d4b0: 7320 656e 6f75 6768 206f 6620 6120 6d65  s enough of a me
+0000d4c0: 7373 2061 6c72 6561 6479 0a2a 2060 3a63  ss already.* `:c
+0000d4d0: 2c6c 6966 6574 696d 653d 3330 3060 2064  ,lifetime=300` d
+0000d4e0: 656c 6574 6520 7570 6c6f 6164 6564 2066  elete uploaded f
+0000d4f0: 696c 6573 2077 6865 6e20 7468 6579 2062  iles when they b
+0000d500: 6563 6f6d 6520 3520 6d69 6e75 7465 7320  ecome 5 minutes 
+0000d510: 6f6c 640a 0a79 6f75 2063 616e 2061 6c73  old..you can als
+0000d520: 6f20 7365 7420 7472 616e 7361 6374 696f  o set transactio
+0000d530: 6e20 6c69 6d69 7473 2077 6869 6368 2061  n limits which a
+0000d540: 7070 6c79 2070 6572 2d49 5020 616e 6420  pply per-IP and 
+0000d550: 7065 722d 766f 6c75 6d65 2c20 6275 7420  per-volume, but 
+0000d560: 7468 6573 6520 6173 7375 6d65 2060 2d6a  these assume `-j
+0000d570: 2031 6020 2864 6566 6175 6c74 2920 6f74   1` (default) ot
+0000d580: 6865 7277 6973 6520 7468 6520 6c69 6d69  herwise the limi
+0000d590: 7473 2077 696c 6c20 6265 206f 6666 2c20  ts will be off, 
+0000d5a0: 666f 7220 6578 616d 706c 6520 602d 6a20  for example `-j 
+0000d5b0: 3460 2077 6f75 6c64 2061 6c6c 6f77 2061  4` would allow a
+0000d5c0: 6e79 7768 6572 6520 6265 7477 6565 6e20  nywhere between 
+0000d5d0: 3178 2061 6e64 2034 7820 7468 6520 6c69  1x and 4x the li
+0000d5e0: 6d69 7473 2079 6f75 2073 6574 2064 6570  mits you set dep
+0000d5f0: 656e 6469 6e67 206f 6e20 7768 6963 6820  ending on which 
+0000d600: 7072 6f63 6573 7369 6e67 206e 6f64 6520  processing node 
+0000d610: 7468 6520 636c 6965 6e74 2067 6574 7320  the client gets 
+0000d620: 726f 7574 6564 2074 6f0a 0a2a 2060 3a63  routed to..* `:c
+0000d630: 2c6d 6178 6e3d 3235 302c 3336 3030 6020  ,maxn=250,3600` 
+0000d640: 616c 6c6f 7773 2032 3530 2066 696c 6573  allows 250 files
+0000d650: 206f 7665 7220 3120 686f 7572 2066 726f   over 1 hour fro
+0000d660: 6d20 6561 6368 2049 5020 2874 7261 636b  m each IP (track
+0000d670: 6564 2070 6572 2d76 6f6c 756d 6529 0a2a  ed per-volume).*
+0000d680: 2060 3a63 2c6d 6178 623d 3167 2c33 3030   `:c,maxb=1g,300
+0000d690: 6020 616c 6c6f 7773 2031 2047 6942 2074  ` allows 1 GiB t
+0000d6a0: 6f74 616c 206f 7665 7220 3520 6d69 6e75  otal over 5 minu
+0000d6b0: 7465 7320 6672 6f6d 2065 6163 6820 4950  tes from each IP
+0000d6c0: 2028 7472 6163 6b65 6420 7065 722d 766f   (tracked per-vo
+0000d6d0: 6c75 6d65 290a 0a0a 2323 2063 6f6d 7072  lume)...## compr
+0000d6e0: 6573 7320 7570 6c6f 6164 730a 0a66 696c  ess uploads..fil
+0000d6f0: 6573 2063 616e 2062 6520 6175 746f 636f  es can be autoco
+0000d700: 6d70 7265 7373 6564 206f 6e20 7570 6c6f  mpressed on uplo
+0000d710: 6164 2c20 2065 6974 6865 7220 6f6e 2075  ad,  either on u
+0000d720: 7365 722d 7265 7175 6573 7420 2869 6620  ser-request (if 
+0000d730: 636f 6e66 6967 2061 6c6c 6f77 7329 206f  config allows) o
+0000d740: 7220 666f 7263 6564 2062 7920 7365 7276  r forced by serv
+0000d750: 6572 2d63 6f6e 6669 670a 0a2a 2076 6f6c  er-config..* vol
+0000d760: 666c 6167 2060 677a 6020 616c 6c6f 7773  flag `gz` allows
+0000d770: 2067 7a20 636f 6d70 7265 7373 696f 6e0a   gz compression.
+0000d780: 2a20 766f 6c66 6c61 6720 6078 7a60 2061  * volflag `xz` a
+0000d790: 6c6c 6f77 7320 6c7a 6d61 2063 6f6d 7072  llows lzma compr
+0000d7a0: 6573 7369 6f6e 0a2a 2076 6f6c 666c 6167  ession.* volflag
+0000d7b0: 2060 706b 6020 2a2a 666f 7263 6573 2a2a   `pk` **forces**
+0000d7c0: 2063 6f6d 7072 6573 7369 6f6e 206f 6e20   compression on 
+0000d7d0: 616c 6c20 6669 6c65 730a 2a20 7572 6c20  all files.* url 
+0000d7e0: 7061 7261 6d65 7465 7220 6070 6b60 2072  parameter `pk` r
+0000d7f0: 6571 7565 7374 7320 636f 6d70 7265 7373  equests compress
+0000d800: 696f 6e20 7769 7468 2073 6572 7665 722d  ion with server-
+0000d810: 6465 6661 756c 7420 616c 676f 7269 7468  default algorith
+0000d820: 6d0a 2a20 7572 6c20 7061 7261 6d65 7465  m.* url paramete
+0000d830: 7220 6067 7a60 206f 7220 6078 7a60 2072  r `gz` or `xz` r
+0000d840: 6571 7565 7374 7320 636f 6d70 7265 7373  equests compress
+0000d850: 696f 6e20 7769 7468 2061 2073 7065 6369  ion with a speci
+0000d860: 6669 6320 616c 676f 7269 7468 6d0a 2a20  fic algorithm.* 
+0000d870: 7572 6c20 7061 7261 6d65 7465 7220 6078  url parameter `x
+0000d880: 7a60 2072 6571 7565 7374 7320 787a 2063  z` requests xz c
+0000d890: 6f6d 7072 6573 7369 6f6e 0a0a 7468 696e  ompression..thin
+0000d8a0: 6773 2074 6f20 6e6f 7465 2c0a 2a20 7468  gs to note,.* th
+0000d8b0: 6520 6067 7a60 2061 6e64 2060 787a 6020  e `gz` and `xz` 
+0000d8c0: 6172 6775 6d65 6e74 7320 7461 6b65 2061  arguments take a
+0000d8d0: 2073 696e 676c 6520 6f70 7469 6f6e 616c   single optional
+0000d8e0: 2061 7267 756d 656e 742c 2074 6865 2063   argument, the c
+0000d8f0: 6f6d 7072 6573 7369 6f6e 206c 6576 656c  ompression level
+0000d900: 2028 7261 6e67 6520 3020 746f 2039 290a   (range 0 to 9).
+0000d910: 2a20 7468 6520 6070 6b60 2076 6f6c 666c  * the `pk` volfl
+0000d920: 6167 2074 616b 6573 2074 6865 206f 7074  ag takes the opt
+0000d930: 696f 6e61 6c20 6172 6775 6d65 6e74 2060  ional argument `
+0000d940: 414c 474f 5249 5448 4d2c 4c45 5645 4c60  ALGORITHM,LEVEL`
+0000d950: 2077 6869 6368 2077 696c 6c20 7468 656e   which will then
+0000d960: 2062 6520 666f 7263 6564 2066 6f72 2061   be forced for a
+0000d970: 6c6c 2075 706c 6f61 6473 2c20 666f 7220  ll uploads, for 
+0000d980: 6578 616d 706c 6520 6067 7a2c 3960 206f  example `gz,9` o
+0000d990: 7220 6078 7a2c 3060 0a2a 2064 6566 6175  r `xz,0`.* defau
+0000d9a0: 6c74 2063 6f6d 7072 6573 7369 6f6e 2069  lt compression i
+0000d9b0: 7320 677a 6970 206c 6576 656c 2039 0a2a  s gzip level 9.*
+0000d9c0: 2061 6c6c 2075 706c 6f61 6420 6d65 7468   all upload meth
+0000d9d0: 6f64 7320 6578 6365 7074 2075 7032 6b20  ods except up2k 
+0000d9e0: 6172 6520 7375 7070 6f72 7465 640a 2a20  are supported.* 
+0000d9f0: 7468 6520 6669 6c65 7320 7769 6c6c 2062  the files will b
+0000da00: 6520 696e 6465 7865 6420 6166 7465 7220  e indexed after 
+0000da10: 636f 6d70 7265 7373 696f 6e2c 2073 6f20  compression, so 
+0000da20: 6475 7065 2d64 6574 6563 7469 6f6e 2061  dupe-detection a
+0000da30: 6e64 2066 696c 652d 7365 6172 6368 2077  nd file-search w
+0000da40: 696c 6c20 6e6f 7420 776f 726b 2061 7320  ill not work as 
+0000da50: 6578 7065 6374 6564 0a0a 736f 6d65 2065  expected..some e
+0000da60: 7861 6d70 6c65 732c 0a2a 2060 2d76 2069  xamples,.* `-v i
+0000da70: 6e63 3a69 6e63 3a77 3a63 2c70 6b3d 787a  nc:inc:w:c,pk=xz
+0000da80: 2c30 6020 200a 2020 666f 6c64 6572 206e  ,0`  .  folder n
+0000da90: 616d 6564 2069 6e63 2c20 7368 6172 6564  amed inc, shared
+0000daa0: 2061 7420 696e 632c 2077 7269 7465 2d6f   at inc, write-o
+0000dab0: 6e6c 7920 666f 7220 6576 6572 796f 6e65  nly for everyone
+0000dac0: 2c20 666f 7263 6573 2078 7a20 636f 6d70  , forces xz comp
+0000dad0: 7265 7373 696f 6e20 6174 206c 6576 656c  ression at level
+0000dae0: 2030 0a2a 2060 2d76 2069 6e63 3a69 6e63   0.* `-v inc:inc
+0000daf0: 3a77 3a63 2c70 6b60 2020 0a20 2073 616d  :w:c,pk`  .  sam
+0000db00: 6520 7772 6974 652d 6f6e 6c79 2069 6e63  e write-only inc
+0000db10: 2c20 6275 7420 666f 7263 6573 2067 7a20  , but forces gz 
+0000db20: 636f 6d70 7265 7373 696f 6e20 2864 6566  compression (def
+0000db30: 6175 6c74 2920 696e 7374 6561 6420 6f66  ault) instead of
+0000db40: 2078 7a0a 2a20 602d 7620 696e 633a 696e   xz.* `-v inc:in
+0000db50: 633a 773a 632c 677a 6020 200a 2020 616c  c:w:c,gz`  .  al
+0000db60: 6c6f 7773 2028 6275 7420 646f 6573 206e  lows (but does n
+0000db70: 6f74 2066 6f72 6365 2920 677a 2063 6f6d  ot force) gz com
+0000db80: 7072 6573 7369 6f6e 2069 6620 636c 6965  pression if clie
+0000db90: 6e74 2075 706c 6f61 6473 2074 6f20 602f  nt uploads to `/
+0000dba0: 696e 633f 706b 6020 6f72 2060 2f69 6e63  inc?pk` or `/inc
+0000dbb0: 3f67 7a60 206f 7220 602f 696e 633f 677a  ?gz` or `/inc?gz
+0000dbc0: 3d34 600a 0a0a 2323 206f 7468 6572 2066  =4`...## other f
+0000dbd0: 6c61 6773 0a0a 2a20 603a 632c 6d61 6769  lags..* `:c,magi
+0000dbe0: 6360 2065 6e61 626c 6573 2066 696c 6574  c` enables filet
+0000dbf0: 7970 6520 6465 7465 6374 696f 6e20 666f  ype detection fo
+0000dc00: 7220 6e61 6d65 6c65 7373 2075 706c 6f61  r nameless uploa
+0000dc10: 6473 2c20 7361 6d65 2061 7320 602d 2d6d  ds, same as `--m
+0000dc20: 6167 6963 600a 2020 2a20 6e65 6564 7320  agic`.  * needs 
+0000dc30: 6874 7470 733a 2f2f 7079 7069 2e6f 7267  https://pypi.org
+0000dc40: 2f70 726f 6a65 6374 2f70 7974 686f 6e2d  /project/python-
+0000dc50: 6d61 6769 632f 2060 7079 7468 6f6e 3320  magic/ `python3 
+0000dc60: 2d6d 2070 6970 2069 6e73 7461 6c6c 202d  -m pip install -
+0000dc70: 2d75 7365 7220 2d55 2070 7974 686f 6e2d  -user -U python-
+0000dc80: 6d61 6769 6360 0a20 202a 206f 6e20 7769  magic`.  * on wi
+0000dc90: 6e64 6f77 7320 6772 6162 2074 6869 7320  ndows grab this 
+0000dca0: 696e 7374 6561 6420 6070 7974 686f 6e33  instead `python3
+0000dcb0: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
+0000dcc0: 2d2d 7573 6572 202d 5520 7079 7468 6f6e  --user -U python
+0000dcd0: 2d6d 6167 6963 2d62 696e 600a 0a0a 2323  -magic-bin`...##
+0000dce0: 2064 6174 6162 6173 6520 6c6f 6361 7469   database locati
+0000dcf0: 6f6e 0a0a 696e 2d76 6f6c 756d 6520 2860  on..in-volume (`
+0000dd00: 2e68 6973 742f 7570 326b 2e64 6260 2c20  .hist/up2k.db`, 
+0000dd10: 6465 6661 756c 7429 206f 7220 736f 6d65  default) or some
+0000dd20: 7768 6572 6520 656c 7365 0a0a 636f 7079  where else..copy
+0000dd30: 7061 7274 7920 6372 6561 7465 7320 6120  party creates a 
+0000dd40: 7375 6266 6f6c 6465 7220 6e61 6d65 6420  subfolder named 
+0000dd50: 602e 6869 7374 6020 696e 7369 6465 2065  `.hist` inside e
+0000dd60: 6163 6820 766f 6c75 6d65 2077 6865 7265  ach volume where
+0000dd70: 2069 7420 7374 6f72 6573 2074 6865 2064   it stores the d
+0000dd80: 6174 6162 6173 652c 2074 6875 6d62 6e61  atabase, thumbna
+0000dd90: 696c 732c 2061 6e64 2073 6f6d 6520 6f74  ils, and some ot
+0000dda0: 6865 7220 7374 7566 660a 0a74 6869 7320  her stuff..this 
+0000ddb0: 6361 6e20 696e 7374 6561 6420 6265 206b  can instead be k
+0000ddc0: 6570 7420 696e 2061 2073 696e 676c 6520  ept in a single 
+0000ddd0: 706c 6163 6520 7573 696e 6720 7468 6520  place using the 
+0000dde0: 602d 2d68 6973 7460 2061 7267 756d 656e  `--hist` argumen
+0000ddf0: 742c 206f 7220 7468 6520 6068 6973 743d  t, or the `hist=
+0000de00: 6020 766f 6c66 6c61 672c 206f 7220 6120  ` volflag, or a 
+0000de10: 6d69 7820 6f66 2062 6f74 683a 0a2a 2060  mix of both:.* `
+0000de20: 2d2d 6869 7374 207e 2f2e 6361 6368 652f  --hist ~/.cache/
+0000de30: 636f 7079 7061 7274 7920 2d76 207e 2f6d  copyparty -v ~/m
+0000de40: 7573 6963 3a3a 723a 632c 6869 7374 3d2d  usic::r:c,hist=-
+0000de50: 6020 7365 7473 2060 7e2f 2e63 6163 6865  ` sets `~/.cache
+0000de60: 2f63 6f70 7970 6172 7479 6020 6173 2074  /copyparty` as t
+0000de70: 6865 2064 6566 6175 6c74 2070 6c61 6365  he default place
+0000de80: 2074 6f20 7075 7420 766f 6c75 6d65 2069   to put volume i
+0000de90: 6e66 6f2c 2062 7574 2060 7e2f 6d75 7369  nfo, but `~/musi
+0000dea0: 6360 2067 6574 7320 7468 6520 7265 6775  c` gets the regu
+0000deb0: 6c61 7220 602e 6869 7374 6020 7375 6266  lar `.hist` subf
+0000dec0: 6f6c 6465 7220 2860 2d60 2072 6573 746f  older (`-` resto
+0000ded0: 7265 7320 6465 6661 756c 7420 6265 6861  res default beha
+0000dee0: 7669 6f72 290a 0a6e 6f74 653a 0a2a 206d  vior)..note:.* m
+0000def0: 6172 6b64 6f77 6e20 6564 6974 7320 6172  arkdown edits ar
+0000df00: 6520 616c 7761 7973 2073 746f 7265 6420  e always stored 
+0000df10: 696e 2061 206c 6f63 616c 2060 2e68 6973  in a local `.his
+0000df20: 7460 2073 7562 6469 7265 6374 6f72 790a  t` subdirectory.
+0000df30: 2a20 6f6e 2077 696e 646f 7773 2074 6865  * on windows the
+0000df40: 2076 6f6c 666c 6167 2070 6174 6820 6973   volflag path is
+0000df50: 2063 7967 6c69 6b65 2c20 736f 2060 2f63   cyglike, so `/c
+0000df60: 2f74 656d 7060 206d 6561 6e73 2060 433a  /temp` means `C:
+0000df70: 5c74 656d 7060 2062 7574 2075 7365 2072  \temp` but use r
+0000df80: 6567 756c 6172 2070 6174 6873 2066 6f72  egular paths for
+0000df90: 2060 2d2d 6869 7374 600a 2020 2a20 796f   `--hist`.  * yo
+0000dfa0: 7520 6361 6e20 7573 6520 6379 6770 6174  u can use cygpat
+0000dfb0: 6873 2066 6f72 2076 6f6c 756d 6573 2074  hs for volumes t
+0000dfc0: 6f6f 2c20 602d 7620 433a 5c55 7365 7273  oo, `-v C:\Users
+0000dfd0: 3a3a 7260 2061 6e64 2060 2d76 202f 632f  ::r` and `-v /c/
+0000dfe0: 7573 6572 733a 3a72 6020 626f 7468 2077  users::r` both w
+0000dff0: 6f72 6b0a 0a0a 2323 206d 6574 6164 6174  ork...## metadat
+0000e000: 6120 6672 6f6d 2061 7564 696f 2066 696c  a from audio fil
+0000e010: 6573 0a0a 7365 7420 602d 6532 7460 2074  es..set `-e2t` t
+0000e020: 6f20 696e 6465 7820 7461 6773 206f 6e20  o index tags on 
+0000e030: 7570 6c6f 6164 0a0a 602d 6d74 6560 2064  upload..`-mte` d
+0000e040: 6563 6964 6573 2077 6869 6368 2074 6167  ecides which tag
+0000e050: 7320 746f 2069 6e64 6578 2061 6e64 2064  s to index and d
+0000e060: 6973 706c 6179 2069 6e20 7468 6520 6272  isplay in the br
+0000e070: 6f77 7365 7220 2861 6e64 2061 6c73 6f20  owser (and also 
+0000e080: 7468 6520 6469 7370 6c61 7920 6f72 6465  the display orde
+0000e090: 7229 2c20 7468 6973 2063 616e 2062 6520  r), this can be 
+0000e0a0: 6368 616e 6765 6420 7065 722d 766f 6c75  changed per-volu
+0000e0b0: 6d65 3a0a 2a20 602d 7620 7e2f 6d75 7369  me:.* `-v ~/musi
+0000e0c0: 633a 3a72 3a63 2c6d 7465 3d74 6974 6c65  c::r:c,mte=title
+0000e0d0: 2c61 7274 6973 7460 2069 6e64 6578 6573  ,artist` indexes
+0000e0e0: 2061 6e64 2064 6973 706c 6179 7320 2a74   and displays *t
+0000e0f0: 6974 6c65 2a20 666f 6c6c 6f77 6564 2062  itle* followed b
+0000e100: 7920 2a61 7274 6973 742a 0a0a 6966 2079  y *artist*..if y
+0000e110: 6f75 2061 6464 2f72 656d 6f76 6520 6120  ou add/remove a 
+0000e120: 7461 6720 6672 6f6d 2060 6d74 6560 2079  tag from `mte` y
+0000e130: 6f75 2077 696c 6c20 6e65 6564 2074 6f20  ou will need to 
+0000e140: 7275 6e20 7769 7468 2060 2d65 3274 7372  run with `-e2tsr
+0000e150: 6020 6f6e 6365 2074 6f20 7265 6275 696c  ` once to rebuil
+0000e160: 6420 7468 6520 6461 7461 6261 7365 2c20  d the database, 
+0000e170: 6f74 6865 7277 6973 6520 6f6e 6c79 206e  otherwise only n
+0000e180: 6577 2066 696c 6573 2077 696c 6c20 6265  ew files will be
+0000e190: 2061 6666 6563 7465 640a 0a62 7574 2069   affected..but i
+0000e1a0: 6e73 7465 6164 206f 6620 7573 696e 6720  nstead of using 
+0000e1b0: 602d 6d74 6560 2c20 602d 6d74 6860 2069  `-mte`, `-mth` i
+0000e1c0: 7320 6120 6265 7474 6572 2077 6179 2074  s a better way t
+0000e1d0: 6f20 6869 6465 2074 6167 7320 696e 2074  o hide tags in t
+0000e1e0: 6865 2062 726f 7773 6572 3a20 7468 6573  he browser: thes
+0000e1f0: 6520 7461 6773 2077 696c 6c20 6e6f 7420  e tags will not 
+0000e200: 6265 2064 6973 706c 6179 6564 2062 7920  be displayed by 
+0000e210: 6465 6661 756c 742c 2062 7574 2074 6865  default, but the
+0000e220: 7920 7374 696c 6c20 6765 7420 696e 6465  y still get inde
+0000e230: 7865 6420 616e 6420 6265 636f 6d65 2073  xed and become s
+0000e240: 6561 7263 6861 626c 652c 2061 6e64 2075  earchable, and u
+0000e250: 7365 7273 2063 616e 2063 686f 6f73 6520  sers can choose 
+0000e260: 746f 2075 6e68 6964 6520 7468 656d 2069  to unhide them i
+0000e270: 6e20 7468 6520 605b e29a 99ef b88f 5d20  n the `[......] 
+0000e280: 636f 6e66 6967 6020 7061 6e65 0a0a 602d  config` pane..`-
+0000e290: 6d74 6d60 2063 616e 2062 6520 7573 6564  mtm` can be used
+0000e2a0: 2074 6f20 6164 6420 6f72 2072 6564 6566   to add or redef
+0000e2b0: 696e 6520 6120 6d65 7461 6461 7461 206d  ine a metadata m
+0000e2c0: 6170 7069 6e67 2c20 7361 7920 796f 7520  apping, say you 
+0000e2d0: 6861 7665 206d 6564 6961 2066 696c 6573  have media files
+0000e2e0: 2077 6974 6820 6066 6f6f 6020 616e 6420   with `foo` and 
+0000e2f0: 6062 6172 6020 7461 6773 2061 6e64 2079  `bar` tags and y
+0000e300: 6f75 2077 616e 7420 7468 656d 2074 6f20  ou want them to 
+0000e310: 6469 7370 6c61 7920 6173 2060 7175 7860  display as `qux`
+0000e320: 2069 6e20 7468 6520 6272 6f77 7365 7220   in the browser 
+0000e330: 2870 7265 6665 7272 696e 6720 6066 6f6f  (preferring `foo
+0000e340: 6020 6966 2062 6f74 6820 6172 6520 7072  ` if both are pr
+0000e350: 6573 656e 7429 2c20 7468 656e 2064 6f20  esent), then do 
+0000e360: 602d 6d74 6d20 7175 783d 666f 6f2c 6261  `-mtm qux=foo,ba
+0000e370: 7260 2061 6e64 206e 6f77 2079 6f75 2063  r` and now you c
+0000e380: 616e 2060 2d6d 7465 2061 7274 6973 742c  an `-mte artist,
+0000e390: 7469 746c 652c 7175 7860 0a0a 7461 6773  title,qux`..tags
+0000e3a0: 2074 6861 7420 7374 6172 7420 7769 7468   that start with
+0000e3b0: 2061 2060 2e60 2073 7563 6820 6173 2060   a `.` such as `
+0000e3c0: 2e62 706d 6020 616e 6420 602e 6475 7260  .bpm` and `.dur`
+0000e3d0: 2861 7469 6f6e 2920 696e 6469 6361 7465  (ation) indicate
+0000e3e0: 206e 756d 6572 6963 2076 616c 7565 0a0a   numeric value..
+0000e3f0: 7365 6520 7468 6520 6265 6175 7469 6675  see the beautifu
+0000e400: 6c20 6d65 7373 206f 6620 6120 6469 6374  l mess of a dict
+0000e410: 696f 6e61 7279 2069 6e20 5b6d 7461 672e  ionary in [mtag.
+0000e420: 7079 5d28 6874 7470 733a 2f2f 6769 7468  py](https://gith
+0000e430: 7562 2e63 6f6d 2f39 3030 312f 636f 7079  ub.com/9001/copy
+0000e440: 7061 7274 792f 626c 6f62 2f68 6f76 7564  party/blob/hovud
+0000e450: 7374 7261 756d 2f63 6f70 7970 6172 7479  straum/copyparty
+0000e460: 2f6d 7461 672e 7079 2920 666f 7220 7468  /mtag.py) for th
+0000e470: 6520 6465 6661 756c 7420 6d61 7070 696e  e default mappin
+0000e480: 6773 2028 7368 6f75 6c64 2063 6f76 6572  gs (should cover
+0000e490: 206d 7033 2c6f 7075 732c 666c 6163 2c6d   mp3,opus,flac,m
+0000e4a0: 3461 2c77 6176 2c61 6966 2c29 0a0a 602d  4a,wav,aif,)..`-
+0000e4b0: 2d6e 6f2d 6d75 7461 6765 6e60 2064 6973  -no-mutagen` dis
+0000e4c0: 6162 6c65 7320 4d75 7461 6765 6e20 616e  ables Mutagen an
+0000e4d0: 6420 7573 6573 2046 4670 726f 6265 2069  d uses FFprobe i
+0000e4e0: 6e73 7465 6164 2c20 7768 6963 682e 2e2e  nstead, which...
+0000e4f0: 0a2a 2069 7320 6162 6f75 7420 3230 7820  .* is about 20x 
+0000e500: 736c 6f77 6572 2074 6861 6e20 4d75 7461  slower than Muta
+0000e510: 6765 6e0a 2a20 6361 7463 6865 7320 6120  gen.* catches a 
+0000e520: 6665 7720 7461 6773 2074 6861 7420 4d75  few tags that Mu
+0000e530: 7461 6765 6e20 646f 6573 6e27 740a 2020  tagen doesn't.  
+0000e540: 2a20 6d65 6c6f 6469 6320 6b65 792c 2076  * melodic key, v
+0000e550: 6964 656f 2072 6573 6f6c 7574 696f 6e2c  ideo resolution,
+0000e560: 2066 7261 6d65 7261 7465 2c20 7069 7866   framerate, pixf
+0000e570: 6d74 0a2a 2061 766f 6964 7320 7075 6c6c  mt.* avoids pull
+0000e580: 696e 6720 616e 7920 4750 4c20 636f 6465  ing any GPL code
+0000e590: 2069 6e74 6f20 636f 7079 7061 7274 790a   into copyparty.
+0000e5a0: 2a20 6d6f 7265 2069 6d70 6f72 7461 6e74  * more important
+0000e5b0: 6c79 2072 756e 7320 4646 7072 6f62 6520  ly runs FFprobe 
+0000e5c0: 6f6e 2069 6e63 6f6d 696e 6720 6669 6c65  on incoming file
+0000e5d0: 7320 7768 6963 6820 6973 2062 6164 2069  s which is bad i
+0000e5e0: 6620 796f 7572 2046 466d 7065 6720 6861  f your FFmpeg ha
+0000e5f0: 7320 6120 6376 650a 0a60 2d2d 6d74 6167  s a cve..`--mtag
+0000e600: 2d74 6f60 2073 6574 7320 7468 6520 7461  -to` sets the ta
+0000e610: 672d 7363 616e 2074 696d 656f 7574 3b20  g-scan timeout; 
+0000e620: 7665 7279 2068 6967 6820 6465 6661 756c  very high defaul
+0000e630: 7420 2836 3020 7365 6329 2074 6f20 6361  t (60 sec) to ca
+0000e640: 7465 7220 666f 7220 7a66 7320 616e 6420  ter for zfs and 
+0000e650: 6f74 6865 7220 7261 6e64 6f6d 6c79 2d66  other randomly-f
+0000e660: 7265 657a 696e 6720 6669 6c65 7379 7374  reezing filesyst
+0000e670: 656d 732e 204c 6f77 6572 2076 616c 7565  ems. Lower value
+0000e680: 7320 6c69 6b65 2031 3020 6172 6520 7573  s like 10 are us
+0000e690: 7561 6c6c 7920 7361 6665 2c20 616c 6c6f  ually safe, allo
+0000e6a0: 7769 6e67 2066 6f72 2066 6173 7465 7220  wing for faster 
+0000e6b0: 7072 6f63 6573 7369 6e67 206f 6620 7472  processing of tr
+0000e6c0: 6963 6b79 2066 696c 6573 0a0a 0a23 2320  icky files...## 
+0000e6d0: 6669 6c65 2070 6172 7365 7220 706c 7567  file parser plug
+0000e6e0: 696e 730a 0a70 726f 7669 6465 2063 7573  ins..provide cus
+0000e6f0: 746f 6d20 7061 7273 6572 7320 746f 2069  tom parsers to i
+0000e700: 6e64 6578 2061 6464 6974 696f 6e61 6c20  ndex additional 
+0000e710: 7461 6773 2c20 2061 6c73 6f20 7365 6520  tags,  also see 
+0000e720: 5b2e 2f62 696e 2f6d 7461 672f 5245 4144  [./bin/mtag/READ
+0000e730: 4d45 2e6d 645d 282e 2f62 696e 2f6d 7461  ME.md](./bin/mta
+0000e740: 672f 5245 4144 4d45 2e6d 6429 0a0a 636f  g/README.md)..co
+0000e750: 7079 7061 7274 7920 6361 6e20 696e 766f  pyparty can invo
+0000e760: 6b65 2065 7874 6572 6e61 6c20 7072 6f67  ke external prog
+0000e770: 7261 6d73 2074 6f20 636f 6c6c 6563 7420  rams to collect 
+0000e780: 6164 6469 7469 6f6e 616c 206d 6574 6164  additional metad
+0000e790: 6174 6120 666f 7220 6669 6c65 7320 7573  ata for files us
+0000e7a0: 696e 6720 606d 7470 6020 2865 6974 6865  ing `mtp` (eithe
+0000e7b0: 7220 6173 2061 7267 756d 656e 7420 6f72  r as argument or
+0000e7c0: 2076 6f6c 666c 6167 292c 2074 6865 7265   volflag), there
+0000e7d0: 2069 7320 6120 6465 6661 756c 7420 7469   is a default ti
+0000e7e0: 6d65 6f75 7420 6f66 2036 3073 6563 2c20  meout of 60sec, 
+0000e7f0: 616e 6420 6f6e 6c79 2066 696c 6573 2077  and only files w
+0000e800: 6869 6368 2063 6f6e 7461 696e 2061 7564  hich contain aud
+0000e810: 696f 2067 6574 2061 6e61 6c79 7a65 6420  io get analyzed 
+0000e820: 6279 2064 6566 6175 6c74 2028 7365 6520  by default (see 
+0000e830: 6179 2f61 6e2f 6164 2062 656c 6f77 290a  ay/an/ad below).
+0000e840: 0a2a 2060 2d6d 7470 202e 6270 6d3d 7e2f  .* `-mtp .bpm=~/
+0000e850: 6269 6e2f 6175 6469 6f2d 6270 6d2e 7079  bin/audio-bpm.py
+0000e860: 6020 7769 6c6c 2065 7865 6375 7465 2060  ` will execute `
+0000e870: 7e2f 6269 6e2f 6175 6469 6f2d 6270 6d2e  ~/bin/audio-bpm.
+0000e880: 7079 6020 7769 7468 2074 6865 2061 7564  py` with the aud
+0000e890: 696f 2066 696c 6520 6173 2061 7267 756d  io file as argum
+0000e8a0: 656e 7420 3120 746f 2070 726f 7669 6465  ent 1 to provide
+0000e8b0: 2074 6865 2060 2e62 706d 6020 7461 672c   the `.bpm` tag,
+0000e8c0: 2069 6620 7468 6174 2064 6f65 7320 6e6f   if that does no
+0000e8d0: 7420 6578 6973 7420 696e 2074 6865 2061  t exist in the a
+0000e8e0: 7564 696f 206d 6574 6164 6174 610a 2a20  udio metadata.* 
+0000e8f0: 602d 6d74 7020 6b65 793d 662c 7435 2c7e  `-mtp key=f,t5,~
+0000e900: 2f62 696e 2f61 7564 696f 2d6b 6579 2e70  /bin/audio-key.p
+0000e910: 7960 2075 7365 7320 607e 2f62 696e 2f61  y` uses `~/bin/a
+0000e920: 7564 696f 2d6b 6579 2e70 7960 2074 6f20  udio-key.py` to 
+0000e930: 6765 7420 7468 6520 606b 6579 6020 7461  get the `key` ta
+0000e940: 672c 2072 6570 6c61 6369 6e67 2061 6e79  g, replacing any
+0000e950: 2065 7869 7374 696e 6720 6d65 7461 6461   existing metada
+0000e960: 7461 2074 6167 2028 6066 2c60 292c 2061  ta tag (`f,`), a
+0000e970: 626f 7274 696e 6720 6966 2069 7420 7461  borting if it ta
+0000e980: 6b65 7320 6c6f 6e67 6572 2074 6861 6e20  kes longer than 
+0000e990: 3573 6563 2028 6074 352c 6029 0a2a 2060  5sec (`t5,`).* `
+0000e9a0: 2d76 207e 2f6d 7573 6963 3a3a 723a 632c  -v ~/music::r:c,
+0000e9b0: 6d74 703d 2e62 706d 3d7e 2f62 696e 2f61  mtp=.bpm=~/bin/a
+0000e9c0: 7564 696f 2d62 706d 2e70 793a 632c 6d74  udio-bpm.py:c,mt
+0000e9d0: 703d 6b65 793d 662c 7435 2c7e 2f62 696e  p=key=f,t5,~/bin
+0000e9e0: 2f61 7564 696f 2d6b 6579 2e70 7960 2062  /audio-key.py` b
+0000e9f0: 6f74 6820 6173 2061 2070 6572 2d76 6f6c  oth as a per-vol
+0000ea00: 756d 6520 636f 6e66 6967 2077 6f77 2074  ume config wow t
+0000ea10: 6869 7320 6973 2067 6574 7469 6e67 2075  his is getting u
+0000ea20: 676c 790a 0a2a 6275 7420 7761 6974 2c20  gly..*but wait, 
+0000ea30: 7468 6572 6527 7320 6d6f 7265 212a 2060  there's more!* `
+0000ea40: 2d6d 7470 6020 6361 6e20 6265 2075 7365  -mtp` can be use
+0000ea50: 6420 666f 7220 6e6f 6e2d 6175 6469 6f20  d for non-audio 
+0000ea60: 6669 6c65 7320 6173 2077 656c 6c20 7573  files as well us
+0000ea70: 696e 6720 7468 6520 6061 6020 666c 6167  ing the `a` flag
+0000ea80: 3a20 6061 7960 206f 6e6c 7920 646f 2061  : `ay` only do a
+0000ea90: 7564 696f 2066 696c 6573 2028 6465 6661  udio files (defa
+0000eaa0: 756c 7429 2c20 6061 6e60 206f 6e6c 7920  ult), `an` only 
+0000eab0: 646f 206e 6f6e 2d61 7564 696f 2066 696c  do non-audio fil
+0000eac0: 6573 2c20 6f72 2060 6164 6020 646f 2061  es, or `ad` do a
+0000ead0: 6c6c 2066 696c 6573 2028 6420 6173 2069  ll files (d as i
+0000eae0: 6e20 646f 6e74 6361 7265 290a 0a2a 2022  n dontcare)..* "
+0000eaf0: 6175 6469 6f20 6669 6c65 2220 616c 736f  audio file" also
+0000eb00: 206d 6561 6e73 2076 6964 656f 7320 6274   means videos bt
+0000eb10: 772c 2061 7320 6c6f 6e67 2061 7320 7468  w, as long as th
+0000eb20: 6572 6520 6973 2061 6e20 6175 6469 6f20  ere is an audio 
+0000eb30: 7374 7265 616d 0a2a 2060 2d6d 7470 2065  stream.* `-mtp e
+0000eb40: 7874 3d61 6e2c 7e2f 6269 6e2f 6669 6c65  xt=an,~/bin/file
+0000eb50: 2d65 7874 2e70 7960 2072 756e 7320 607e  -ext.py` runs `~
+0000eb60: 2f62 696e 2f66 696c 652d 6578 742e 7079  /bin/file-ext.py
+0000eb70: 6020 746f 2067 6574 2074 6865 2060 6578  ` to get the `ex
+0000eb80: 7460 2074 6167 206f 6e6c 7920 6966 2066  t` tag only if f
+0000eb90: 696c 6520 6973 206e 6f74 2061 7564 696f  ile is not audio
+0000eba0: 2028 6061 6e60 290a 2a20 602d 6d74 7020   (`an`).* `-mtp 
+0000ebb0: 6172 6368 2c62 7569 6c74 2c76 6572 2c6f  arch,built,ver,o
+0000ebc0: 7269 673d 616e 2c65 6578 652c 6564 6c6c  rig=an,eexe,edll
+0000ebd0: 2c7e 2f62 696e 2f65 7865 2e70 7960 2072  ,~/bin/exe.py` r
+0000ebe0: 756e 7320 607e 2f62 696e 2f65 7865 2e70  uns `~/bin/exe.p
+0000ebf0: 7960 2074 6f20 6765 7420 7072 6f70 6572  y` to get proper
+0000ec00: 7469 6573 2061 626f 7574 2077 696e 646f  ties about windo
+0000ec10: 7773 2d62 696e 6172 6965 7320 6f6e 6c79  ws-binaries only
+0000ec20: 2069 6620 6669 6c65 2069 7320 6e6f 7420   if file is not 
+0000ec30: 6175 6469 6f20 2860 616e 6029 2061 6e64  audio (`an`) and
+0000ec40: 2066 696c 6520 6578 7465 6e73 696f 6e20   file extension 
+0000ec50: 6973 2065 7865 206f 7220 646c 6c0a 2a20  is exe or dll.* 
+0000ec60: 6966 2079 6f75 2077 616e 7420 746f 2064  if you want to d
+0000ec70: 6169 7379 6368 6169 6e20 7061 7273 6572  aisychain parser
+0000ec80: 732c 2075 7365 2074 6865 2060 7060 2066  s, use the `p` f
+0000ec90: 6c61 6720 746f 2073 6574 2070 726f 6365  lag to set proce
+0000eca0: 7373 696e 6720 6f72 6465 720a 2020 2a20  ssing order.  * 
+0000ecb0: 602d 6d74 7020 666f 6f3d 7031 2c7e 2f61  `-mtp foo=p1,~/a
+0000ecc0: 2e70 7960 2072 756e 7320 6265 666f 7265  .py` runs before
+0000ecd0: 2060 2d6d 7470 2066 6f6f 3d70 322c 7e2f   `-mtp foo=p2,~/
+0000ece0: 622e 7079 6020 616e 6420 7769 6c6c 2066  b.py` and will f
+0000ecf0: 6f72 7761 7264 2061 6c6c 2074 6865 2074  orward all the t
+0000ed00: 6167 7320 6465 7465 6374 6564 2073 6f20  ags detected so 
+0000ed10: 6661 7220 6173 206a 736f 6e20 746f 2074  far as json to t
+0000ed20: 6865 2073 7464 696e 206f 6620 622e 7079  he stdin of b.py
+0000ed30: 0a2a 206f 7074 696f 6e20 6063 3060 2064  .* option `c0` d
+0000ed40: 6973 6162 6c65 7320 6361 7074 7572 696e  isables capturin
+0000ed50: 6720 6f66 2073 7464 6f75 742f 7374 6465  g of stdout/stde
+0000ed60: 7272 2c20 736f 2063 6f70 7970 6172 7479  rr, so copyparty
+0000ed70: 2077 696c 6c20 6e6f 7420 7265 6365 6976   will not receiv
+0000ed80: 6520 616e 7920 7461 6773 2066 726f 6d20  e any tags from 
+0000ed90: 7468 6520 7072 6f63 6573 7320 6174 2061  the process at a
+0000eda0: 6c6c 202d 2d20 696e 7374 6561 6420 7468  ll -- instead th
+0000edb0: 6520 696e 766f 6b65 6420 7072 6f67 7261  e invoked progra
+0000edc0: 6d20 6973 2066 7265 6520 746f 2070 7269  m is free to pri
+0000edd0: 6e74 2077 6861 7465 7665 7220 746f 2074  nt whatever to t
+0000ede0: 6865 2063 6f6e 736f 6c65 2c20 6a75 7374  he console, just
+0000edf0: 2075 7369 6e67 2063 6f70 7970 6172 7479   using copyparty
+0000ee00: 2061 7320 6120 6c61 756e 6368 6572 0a20   as a launcher. 
+0000ee10: 202a 2060 6331 6020 6361 7074 7572 6573   * `c1` captures
+0000ee20: 2073 7464 6f75 7420 6f6e 6c79 2c20 6063   stdout only, `c
+0000ee30: 3260 206f 6e6c 7920 7374 6465 7272 2c20  2` only stderr, 
+0000ee40: 616e 6420 6063 3360 2028 6465 6661 756c  and `c3` (defaul
+0000ee50: 7429 2063 6170 7475 7265 7320 626f 7468  t) captures both
+0000ee60: 0a2a 2079 6f75 2063 616e 2063 6f6e 7472  .* you can contr
+0000ee70: 6f6c 2068 6f77 2074 6865 2070 6172 7365  ol how the parse
+0000ee80: 7220 6973 206b 696c 6c65 6420 6966 2069  r is killed if i
+0000ee90: 7420 7469 6d65 7320 6f75 7420 7769 7468  t times out with
+0000eea0: 206f 7074 696f 6e20 606b 7460 206b 696c   option `kt` kil
+0000eeb0: 6c69 6e67 2074 6865 2065 6e74 6972 6520  ling the entire 
+0000eec0: 7072 6f63 6573 7320 7472 6565 2028 6465  process tree (de
+0000eed0: 6661 756c 7429 2c20 606b 6d60 206a 7573  fault), `km` jus
+0000eee0: 7420 7468 6520 6d61 696e 2070 726f 6365  t the main proce
+0000eef0: 7373 2c20 6f72 2060 6b6e 6020 6c65 7420  ss, or `kn` let 
+0000ef00: 6974 2063 6f6e 7469 6e75 6520 7275 6e6e  it continue runn
+0000ef10: 696e 6720 756e 7469 6c20 636f 7079 7061  ing until copypa
+0000ef20: 7274 7920 6973 2074 6572 6d69 6e61 7465  rty is terminate
+0000ef30: 640a 0a69 6620 736f 6d65 7468 696e 6720  d..if something 
+0000ef40: 646f 6573 6e27 7420 776f 726b 2c20 7472  doesn't work, tr
+0000ef50: 7920 602d 2d6d 7461 672d 7660 2066 6f72  y `--mtag-v` for
+0000ef60: 2076 6572 626f 7365 2065 7272 6f72 206d   verbose error m
+0000ef70: 6573 7361 6765 730a 0a0a 2323 2065 7665  essages...## eve
+0000ef80: 6e74 2068 6f6f 6b73 0a0a 7472 6967 6765  nt hooks..trigge
+0000ef90: 7220 6120 7072 6f67 7261 6d20 6f6e 2075  r a program on u
+0000efa0: 706c 6f61 6473 2c20 7265 6e61 6d65 7320  ploads, renames 
+0000efb0: 6574 6320 285b 6578 616d 706c 6573 5d28  etc ([examples](
+0000efc0: 2e2f 6269 6e2f 686f 6f6b 732f 2929 0a0a  ./bin/hooks/))..
+0000efd0: 796f 7520 6361 6e20 7365 7420 686f 6f6b  you can set hook
+0000efe0: 7320 6265 666f 7265 2061 6e64 2f6f 7220  s before and/or 
+0000eff0: 6166 7465 7220 616e 2065 7665 6e74 2068  after an event h
+0000f000: 6170 7065 6e73 2c20 616e 6420 6375 7272  appens, and curr
+0000f010: 656e 746c 7920 796f 7520 6361 6e20 686f  ently you can ho
+0000f020: 6f6b 2075 706c 6f61 6473 2c20 6d6f 7665  ok uploads, move
+0000f030: 732f 7265 6e61 6d65 732c 2061 6e64 2064  s/renames, and d
+0000f040: 656c 6574 6573 0a0a 7468 6572 6527 7320  eletes..there's 
+0000f050: 6120 6275 6e63 6820 6f66 2066 6c61 6773  a bunch of flags
+0000f060: 2061 6e64 2073 7475 6666 2c20 7365 6520   and stuff, see 
+0000f070: 602d 2d68 656c 702d 686f 6f6b 7360 0a0a  `--help-hooks`..
+0000f080: 0a23 2323 2075 706c 6f61 6420 6576 656e  .### upload even
+0000f090: 7473 0a0a 7468 6520 6f6c 6465 722c 206d  ts..the older, m
+0000f0a0: 6f72 6520 706f 7765 7266 756c 2061 7070  ore powerful app
+0000f0b0: 726f 6163 6820 285b 6578 616d 706c 6573  roach ([examples
+0000f0c0: 5d28 2e2f 6269 6e2f 6d74 6167 2f29 293a  ](./bin/mtag/)):
+0000f0d0: 0a0a 6060 600a 2d76 202f 6d6e 742f 696e  ..```.-v /mnt/in
+0000f0e0: 633a 696e 633a 773a 632c 6d74 653d 2b78  c:inc:w:c,mte=+x
+0000f0f0: 313a 632c 6d74 703d 7831 3d61 642c 6b6e  1:c,mtp=x1=ad,kn
+0000f100: 2c2f 7573 722f 6269 6e2f 6e6f 7469 6679  ,/usr/bin/notify
+0000f110: 2d73 656e 640a 6060 600a 0a73 6f20 6669  -send.```..so fi
+0000f120: 6c65 7379 7374 656d 206c 6f63 6174 696f  lesystem locatio
+0000f130: 6e20 602f 6d6e 742f 696e 6360 2073 6861  n `/mnt/inc` sha
+0000f140: 7265 6420 6174 2060 2f69 6e63 602c 2077  red at `/inc`, w
+0000f150: 7269 7465 2d6f 6e6c 7920 666f 7220 6576  rite-only for ev
+0000f160: 6572 796f 6e65 2c20 6170 7065 6e64 696e  eryone, appendin
+0000f170: 6720 6078 3160 2074 6f20 7468 6520 6c69  g `x1` to the li
+0000f180: 7374 206f 6620 7461 6773 2074 6f20 696e  st of tags to in
+0000f190: 6465 7820 2860 6d74 6560 292c 2061 6e64  dex (`mte`), and
+0000f1a0: 2075 7369 6e67 2060 2f75 7372 2f62 696e   using `/usr/bin
+0000f1b0: 2f6e 6f74 6966 792d 7365 6e64 6020 746f  /notify-send` to
+0000f1c0: 2022 7072 6f76 6964 6522 2074 6167 2060   "provide" tag `
+0000f1d0: 7831 6020 666f 7220 616e 7920 6669 6c65  x1` for any file
+0000f1e0: 7479 7065 2028 6061 6460 2920 7769 7468  type (`ad`) with
+0000f1f0: 206b 696c 6c2d 6f6e 2d74 696d 656f 7574   kill-on-timeout
+0000f200: 2064 6973 6162 6c65 6420 2860 6b6e 6029   disabled (`kn`)
+0000f210: 0a0a 7468 6174 276c 6c20 7275 6e20 7468  ..that'll run th
+0000f220: 6520 636f 6d6d 616e 6420 606e 6f74 6966  e command `notif
+0000f230: 792d 7365 6e64 6020 7769 7468 2074 6865  y-send` with the
+0000f240: 2070 6174 6820 746f 2074 6865 2075 706c   path to the upl
+0000f250: 6f61 6465 6420 6669 6c65 2061 7320 7468  oaded file as th
+0000f260: 6520 6669 7273 7420 616e 6420 6f6e 6c79  e first and only
+0000f270: 2061 7267 756d 656e 7420 2873 6f20 6f6e   argument (so on
+0000f280: 206c 696e 7578 2069 7427 6c6c 2073 686f   linux it'll sho
+0000f290: 7720 6120 6e6f 7469 6669 6361 7469 6f6e  w a notification
+0000f2a0: 206f 6e2d 7363 7265 656e 290a 0a6e 6f74   on-screen)..not
+0000f2b0: 6520 7468 6174 2074 6869 7320 6973 2077  e that this is w
+0000f2c0: 6179 206d 6f72 6520 636f 6d70 6c69 6361  ay more complica
+0000f2d0: 7465 6420 7468 616e 2074 6865 206e 6577  ted than the new
+0000f2e0: 205b 6576 656e 7420 686f 6f6b 735d 2823   [event hooks](#
+0000f2f0: 6576 656e 742d 686f 6f6b 7329 2062 7574  event-hooks) but
+0000f300: 2074 6869 7320 6170 7072 6f61 6368 2068   this approach h
+0000f310: 6173 2074 6865 2066 6f6c 6c6f 7769 6e67  as the following
+0000f320: 2061 6476 616e 7461 6765 733a 0a2a 206e   advantages:.* n
+0000f330: 6f6e 2d62 6c6f 636b 696e 6720 616e 6420  on-blocking and 
+0000f340: 6d75 6c74 6974 6872 6561 6465 643b 2064  multithreaded; d
+0000f350: 6f65 736e 2774 2068 6f6c 6420 6f74 6865  oesn't hold othe
+0000f360: 7220 7570 6c6f 6164 7320 6261 636b 0a2a  r uploads back.*
+0000f370: 2079 6f75 2067 6574 2061 6363 6573 7320   you get access 
+0000f380: 746f 2074 6167 7320 6672 6f6d 2046 466d  to tags from FFm
+0000f390: 7065 6720 616e 6420 6f74 6865 7220 6d74  peg and other mt
+0000f3a0: 7020 7061 7273 6572 730a 2a20 6f6e 6c79  p parsers.* only
+0000f3b0: 2074 7269 6767 6572 206f 6e20 6e65 7720   trigger on new 
+0000f3c0: 756e 6971 7565 2066 696c 6573 2c20 6e6f  unique files, no
+0000f3d0: 7420 6475 7065 730a 0a6e 6f74 6520 7468  t dupes..note th
+0000f3e0: 6174 2069 7420 7769 6c6c 206f 6363 7570  at it will occup
+0000f3f0: 7920 7468 6520 7061 7273 696e 6720 7468  y the parsing th
+0000f400: 7265 6164 732c 2073 6f20 666f 726b 2061  reads, so fork a
+0000f410: 6e79 7468 696e 6720 6578 7065 6e73 6976  nything expensiv
+0000f420: 6520 286f 7220 7365 7420 606b 6e60 2074  e (or set `kn` t
+0000f430: 6f20 6861 7665 2063 6f70 7970 6172 7479  o have copyparty
+0000f440: 2066 6f72 6b20 6974 2066 6f72 2079 6f75   fork it for you
+0000f450: 2920 2d2d 206f 746f 6820 6966 2079 6f75  ) -- otoh if you
+0000f460: 2077 616e 7420 746f 2069 6e74 656e 7469   want to intenti
+0000f470: 6f6e 616c 6c79 2071 7565 7565 2f73 696e  onally queue/sin
+0000f480: 676c 6574 6872 6561 6420 796f 7520 6361  glethread you ca
+0000f490: 6e20 636f 6d62 696e 6520 6974 2077 6974  n combine it wit
+0000f4a0: 6820 602d 2d6d 7461 672d 6d74 2031 600a  h `--mtag-mt 1`.
+0000f4b0: 0a0a 2323 2068 6964 696e 6720 6672 6f6d  ..## hiding from
+0000f4c0: 2067 6f6f 676c 650a 0a74 656c 6c20 7365   google..tell se
+0000f4d0: 6172 6368 2065 6e67 696e 6573 2079 6f75  arch engines you
+0000f4e0: 2064 6f6e 7420 7761 6e6e 6120 6265 2069   dont wanna be i
+0000f4f0: 6e64 6578 6564 2c20 2065 6974 6865 7220  ndexed,  either 
+0000f500: 7573 696e 6720 7468 6520 676f 6f64 206f  using the good o
+0000f510: 6c64 205b 726f 626f 7473 2e74 7874 5d28  ld [robots.txt](
+0000f520: 6874 7470 733a 2f2f 7777 772e 726f 626f  https://www.robo
+0000f530: 7473 7478 742e 6f72 672f 726f 626f 7473  tstxt.org/robots
+0000f540: 7478 742e 6874 6d6c 2920 6f72 2074 6872  txt.html) or thr
+0000f550: 6f75 6768 2063 6f70 7970 6172 7479 2073  ough copyparty s
+0000f560: 6574 7469 6e67 733a 0a0a 2a20 602d 2d6e  ettings:..* `--n
+0000f570: 6f2d 726f 626f 7473 6020 6164 6473 2048  o-robots` adds H
+0000f580: 5454 5020 2860 582d 526f 626f 7473 2d54  TTP (`X-Robots-T
+0000f590: 6167 6029 2061 6e64 2048 544d 4c20 2860  ag`) and HTML (`
+0000f5a0: 3c6d 6574 613e 6029 2068 6561 6465 7273  <meta>`) headers
+0000f5b0: 2077 6974 6820 606e 6f69 6e64 6578 2c20   with `noindex, 
+0000f5c0: 6e6f 666f 6c6c 6f77 6020 676c 6f62 616c  nofollow` global
+0000f5d0: 6c79 0a2a 2076 6f6c 666c 6167 2060 5b2e  ly.* volflag `[.
+0000f5e0: 2e2e 5d3a 632c 6e6f 726f 626f 7473 6020  ..]:c,norobots` 
+0000f5f0: 646f 6573 2074 6865 2073 616d 6520 7468  does the same th
+0000f600: 696e 6720 666f 7220 7468 6174 2073 696e  ing for that sin
+0000f610: 676c 6520 766f 6c75 6d65 0a2a 2076 6f6c  gle volume.* vol
+0000f620: 666c 6167 2060 5b2e 2e2e 5d3a 632c 726f  flag `[...]:c,ro
+0000f630: 626f 7473 6020 414c 4c4f 5753 2073 6561  bots` ALLOWS sea
+0000f640: 7263 682d 656e 6769 6e65 2063 7261 776c  rch-engine crawl
+0000f650: 696e 6720 666f 7220 7468 6174 2076 6f6c  ing for that vol
+0000f660: 756d 652c 2065 7665 6e20 6966 2060 2d2d  ume, even if `--
+0000f670: 6e6f 2d72 6f62 6f74 7360 2069 7320 7365  no-robots` is se
+0000f680: 7420 676c 6f62 616c 6c79 0a0a 616c 736f  t globally..also
+0000f690: 2c20 602d 2d66 6f72 6365 2d6a 7360 2064  , `--force-js` d
+0000f6a0: 6973 6162 6c65 7320 7468 6520 706c 6169  isables the plai
+0000f6b0: 6e20 4854 4d4c 2066 6f6c 6465 7220 6c69  n HTML folder li
+0000f6c0: 7374 696e 672c 206d 616b 696e 6720 7468  sting, making th
+0000f6d0: 696e 6773 2068 6172 6465 7220 746f 2070  ings harder to p
+0000f6e0: 6172 7365 2066 6f72 2073 6561 7263 6820  arse for search 
+0000f6f0: 656e 6769 6e65 730a 0a0a 2323 2074 6865  engines...## the
+0000f700: 6d65 730a 0a79 6f75 2063 616e 2063 6861  mes..you can cha
+0000f710: 6e67 6520 7468 6520 6465 6661 756c 7420  nge the default 
+0000f720: 7468 656d 6520 7769 7468 2060 2d2d 7468  theme with `--th
+0000f730: 656d 6520 3260 2c20 616e 6420 6164 6420  eme 2`, and add 
+0000f740: 796f 7572 206f 776e 2074 6865 6d65 7320  your own themes 
+0000f750: 6279 206d 6f64 6966 7969 6e67 2060 6272  by modifying `br
+0000f760: 6f77 7365 722e 6373 7360 206f 7220 7072  owser.css` or pr
+0000f770: 6f76 6964 696e 6720 796f 7572 206f 776e  oviding your own
+0000f780: 2063 7373 2074 6f20 602d 2d63 7373 2d62   css to `--css-b
+0000f790: 726f 7773 6572 602c 2074 6865 6e20 7465  rowser`, then te
+0000f7a0: 6c6c 696e 6720 636f 7079 7061 7274 7920  lling copyparty 
+0000f7b0: 7468 6579 2065 7869 7374 2062 7920 696e  they exist by in
+0000f7c0: 6372 6561 7369 6e67 2060 2d2d 7468 656d  creasing `--them
+0000f7d0: 6573 600a 0a3c 7461 626c 653e 3c74 723e  es`..<table><tr>
+0000f7e0: 3c74 6420 7769 6474 683d 2233 3325 2220  <td width="33%" 
+0000f7f0: 616c 6967 6e3d 2263 656e 7465 7222 3e3c  align="center"><
+0000f800: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
+0000f810: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+0000f820: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+0000f830: 6d2f 3234 3130 3332 2f31 3635 3836 3439  m/241032/1658649
+0000f840: 3037 2d31 3765 3261 6337 642d 3331 3964  07-17e2ac7d-319d
+0000f850: 2d34 6632 352d 3837 3138 2d32 6633 3736  -4f25-8718-2f376
+0000f860: 6636 3134 6235 312e 706e 6722 3e3c 696d  f614b51.png"><im
+0000f870: 6720 7372 633d 2268 7474 7073 3a2f 2f75  g src="https://u
+0000f880: 7365 722d 696d 6167 6573 2e67 6974 6875  ser-images.githu
+0000f890: 6275 7365 7263 6f6e 7465 6e74 2e63 6f6d  busercontent.com
+0000f8a0: 2f32 3431 3033 322f 3136 3538 3637 3535  /241032/16586755
+0000f8b0: 312d 6663 6562 3335 6464 2d33 3866 302d  1-fceb35dd-38f0-
+0000f8c0: 3432 6262 2d62 6566 332d 3235 6261 3635  42bb-bef3-25ba65
+0000f8d0: 3163 6136 3962 2e70 6e67 223e 3c2f 613e  1ca69b.png"></a>
+0000f8e0: 0a30 2e20 636c 6173 7369 6320 6461 726b  .0. classic dark
+0000f8f0: 3c2f 7464 3e3c 7464 2077 6964 7468 3d22  </td><td width="
+0000f900: 3333 2522 2061 6c69 676e 3d22 6365 6e74  33%" align="cent
+0000f910: 6572 223e 3c61 2068 7265 663d 2268 7474  er"><a href="htt
+0000f920: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+0000f930: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+0000f940: 6e74 2e63 6f6d 2f32 3431 3033 322f 3136  nt.com/241032/16
+0000f950: 3836 3434 3339 392d 3638 3933 3864 6535  8644399-68938de5
+0000f960: 2d64 6139 622d 3434 3566 2d38 6439 322d  -da9b-445f-8d92-
+0000f970: 6235 3163 3734 6235 6633 3435 2e70 6e67  b51c74b5f345.png
+0000f980: 223e 3c69 6d67 2073 7263 3d22 6874 7470  "><img src="http
+0000f990: 733a 2f2f 7573 6572 2d69 6d61 6765 732e  s://user-images.
+0000f9a0: 6769 7468 7562 7573 6572 636f 6e74 656e  githubuserconten
+0000f9b0: 742e 636f 6d2f 3234 3130 3332 2f31 3638  t.com/241032/168
+0000f9c0: 3634 3434 3034 2d38 6531 6132 6664 632d  644404-8e1a2fdc-
+0000f9d0: 3665 3539 2d34 6334 312d 3930 3565 2d62  6e59-4c41-905e-b
+0000f9e0: 6135 3339 3965 6436 3836 662e 706e 6722  a5399ed686f.png"
+0000f9f0: 3e3c 2f61 3e0a 322e 2066 6c61 7420 706d  ></a>.2. flat pm
+0000fa00: 2d6d 6f6e 6f6b 6169 3c2f 7464 3e3c 7464  -monokai</td><td
+0000fa10: 2077 6964 7468 3d22 3333 2522 2061 6c69   width="33%" ali
+0000fa20: 676e 3d22 6365 6e74 6572 223e 3c61 2068  gn="center"><a h
+0000fa30: 7265 663d 2268 7474 7073 3a2f 2f75 7365  ref="https://use
+0000fa40: 722d 696d 6167 6573 2e67 6974 6875 6275  r-images.githubu
+0000fa50: 7365 7263 6f6e 7465 6e74 2e63 6f6d 2f32  sercontent.com/2
+0000fa60: 3431 3033 322f 3136 3538 3634 3930 312d  41032/165864901-
+0000fa70: 6462 3133 6134 3239 2d61 3564 612d 3439  db13a429-a5da-49
+0000fa80: 3664 2d38 6263 362d 6365 3833 3835 3437  6d-8bc6-ce838547
+0000fa90: 6636 3964 2e70 6e67 223e 3c69 6d67 2073  f69d.png"><img s
+0000faa0: 7263 3d22 6874 7470 733a 2f2f 7573 6572  rc="https://user
+0000fab0: 2d69 6d61 6765 732e 6769 7468 7562 7573  -images.githubus
+0000fac0: 6572 636f 6e74 656e 742e 636f 6d2f 3234  ercontent.com/24
+0000fad0: 3130 3332 2f31 3635 3836 3735 3630 2d61  1032/165867560-a
+0000fae0: 6138 3334 6165 662d 3538 6463 2d34 6162  a834aef-58dc-4ab
+0000faf0: 652d 6261 6566 2d37 6535 3632 6236 3437  e-baef-7e562b647
+0000fb00: 3934 352e 706e 6722 3e3c 2f61 3e0a 342e  945.png"></a>.4.
+0000fb10: 2076 6963 653c 2f74 643e 3c2f 7472 3e3c   vice</td></tr><
+0000fb20: 7472 3e3c 7464 2061 6c69 676e 3d22 6365  tr><td align="ce
+0000fb30: 6e74 6572 223e 3c61 2068 7265 663d 2268  nter"><a href="h
+0000fb40: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+0000fb50: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+0000fb60: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+0000fb70: 3136 3538 3634 3930 352d 3639 3236 3832  165864905-692682
+0000fb80: 6562 2d36 6662 342d 3464 3430 2d62 3666  eb-6fb4-4d40-b6f
+0000fb90: 652d 3237 6432 6337 6433 6532 6137 2e70  e-27d2c7d3e2a7.p
+0000fba0: 6e67 223e 3c69 6d67 2073 7263 3d22 6874  ng"><img src="ht
+0000fbb0: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+0000fbc0: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+0000fbd0: 656e 742e 636f 6d2f 3234 3130 3332 2f31  ent.com/241032/1
+0000fbe0: 3635 3836 3735 3535 2d30 3830 6237 3362  65867555-080b73b
+0000fbf0: 362d 3664 3835 2d34 3162 622d 6137 6336  6-6d85-41bb-a7c6
+0000fc00: 2d61 6432 3737 6336 3038 3336 352e 706e  -ad277c608365.pn
+0000fc10: 6722 3e3c 2f61 3e0a 312e 2063 6c61 7373  g"></a>.1. class
+0000fc20: 6963 206c 6967 6874 3c2f 7464 3e3c 7464  ic light</td><td
+0000fc30: 2061 6c69 676e 3d22 6365 6e74 6572 223e   align="center">
+0000fc40: 3c61 2068 7265 663d 2268 7474 7073 3a2f  <a href="https:/
+0000fc50: 2f75 7365 722d 696d 6167 6573 2e67 6974  /user-images.git
+0000fc60: 6875 6275 7365 7263 6f6e 7465 6e74 2e63  hubusercontent.c
+0000fc70: 6f6d 2f32 3431 3033 322f 3136 3836 3435  om/241032/168645
+0000fc80: 3237 362d 6662 3032 6664 3139 2d31 3930  276-fb02fd19-190
+0000fc90: 612d 3430 3761 2d62 3864 332d 6435 3866  a-407a-b8d3-d58f
+0000fca0: 6565 3237 3765 3032 2e70 6e67 223e 3c69  ee277e02.png"><i
+0000fcb0: 6d67 2073 7263 3d22 6874 7470 733a 2f2f  mg src="https://
+0000fcc0: 7573 6572 2d69 6d61 6765 732e 6769 7468  user-images.gith
+0000fcd0: 7562 7573 6572 636f 6e74 656e 742e 636f  ubusercontent.co
+0000fce0: 6d2f 3234 3130 3332 2f31 3638 3634 3532  m/241032/1686452
+0000fcf0: 3830 2d66 3036 3632 6233 632d 3937 3634  80-f0662b3c-9764
+0000fd00: 2d34 3837 352d 6132 6532 2d64 3931 6363  -4875-a2e2-d91cc
+0000fd10: 3831 3939 6232 332e 706e 6722 3e3c 2f61  8199b23.png"></a
+0000fd20: 3e0a 332e 2066 6c61 7420 6c69 6768 740a  >.3. flat light.
+0000fd30: 3c2f 7464 3e3c 7464 2061 6c69 676e 3d22  </td><td align="
+0000fd40: 6365 6e74 6572 223e 3c61 2068 7265 663d  center"><a href=
+0000fd50: 2268 7474 7073 3a2f 2f75 7365 722d 696d  "https://user-im
+0000fd60: 6167 6573 2e67 6974 6875 6275 7365 7263  ages.githubuserc
+0000fd70: 6f6e 7465 6e74 2e63 6f6d 2f32 3431 3033  ontent.com/24103
+0000fd80: 322f 3136 3538 3634 3839 382d 3130 6365  2/165864898-10ce
+0000fd90: 3730 3532 2d61 3131 372d 3466 6366 2d38  7052-a117-4fcf-8
+0000fda0: 3435 622d 6235 3663 3931 3638 3739 3038  45b-b56c91687908
+0000fdb0: 2e70 6e67 223e 3c69 6d67 2073 7263 3d22  .png"><img src="
+0000fdc0: 6874 7470 733a 2f2f 7573 6572 2d69 6d61  https://user-ima
+0000fdd0: 6765 732e 6769 7468 7562 7573 6572 636f  ges.githubuserco
+0000fde0: 6e74 656e 742e 636f 6d2f 3234 3130 3332  ntent.com/241032
+0000fdf0: 2f31 3635 3836 3735 3632 2d66 3330 3033  /165867562-f3003
+0000fe00: 6434 352d 6464 3261 2d34 3536 342d 3861  d45-dd2a-4564-8a
+0000fe10: 6165 2d66 6564 3434 6331 6165 3036 342e  ae-fed44c1ae064.
+0000fe20: 706e 6722 3e3c 2f61 3e0a 352e 203c 6120  png"></a>.5. <a 
+0000fe30: 6872 6566 3d22 6874 7470 733a 2f2f 626c  href="https://bl
+0000fe40: 6f67 2e63 6f64 696e 6768 6f72 726f 722e  og.codinghorror.
+0000fe50: 636f 6d2f 612d 7472 6962 7574 652d 746f  com/a-tribute-to
+0000fe60: 2d74 6865 2d77 696e 646f 7773 2d33 312d  -the-windows-31-
+0000fe70: 686f 742d 646f 672d 7374 616e 642d 636f  hot-dog-stand-co
+0000fe80: 6c6f 722d 7363 6865 6d65 2f22 3e68 6f74  lor-scheme/">hot
+0000fe90: 646f 6720 7374 616e 643c 2f61 3e3c 2f74  dog stand</a></t
+0000fea0: 643e 3c2f 7472 3e3c 2f74 6162 6c65 3e0a  d></tr></table>.
+0000feb0: 0a74 6865 2063 6c61 7373 6e61 6d65 206f  .the classname o
+0000fec0: 6620 7468 6520 4854 4d4c 2074 6167 2069  f the HTML tag i
+0000fed0: 7320 7365 7420 6163 636f 7264 696e 6720  s set according 
+0000fee0: 746f 2074 6865 2073 656c 6563 7465 6420  to the selected 
+0000fef0: 7468 656d 652c 2077 6869 6368 2069 7320  theme, which is 
+0000ff00: 7573 6564 2074 6f20 7365 7420 636f 6c6f  used to set colo
+0000ff10: 7273 2061 7320 6373 7320 7661 7269 6162  rs as css variab
+0000ff20: 6c65 7320 2b2b 0a0a 2a20 6561 6368 2074  les ++..* each t
+0000ff30: 6865 6d65 202a 6765 6e65 7261 6c6c 792a  heme *generally*
+0000ff40: 2068 6173 2061 2064 6172 6b20 7468 656d   has a dark them
+0000ff50: 6520 2865 7665 6e20 6e75 6d62 6572 7329  e (even numbers)
+0000ff60: 2061 6e64 2061 206c 6967 6874 2074 6865   and a light the
+0000ff70: 6d65 2028 6f64 6420 6e75 6d62 6572 7329  me (odd numbers)
+0000ff80: 2c20 7368 6f77 696e 6720 696e 2070 6169  , showing in pai
+0000ff90: 7273 0a2a 2074 6865 2066 6972 7374 2074  rs.* the first t
+0000ffa0: 6865 6d65 2028 7468 656d 6520 3020 616e  heme (theme 0 an
+0000ffb0: 6420 3129 2069 7320 6068 746d 6c2e 6160  d 1) is `html.a`
+0000ffc0: 2c20 7365 636f 6e64 2074 6865 6d65 2028  , second theme (
+0000ffd0: 3220 616e 6420 3329 2069 7320 6068 746d  2 and 3) is `htm
+0000ffe0: 6c2e 6260 0a2a 2069 6620 6120 6c69 6768  l.b`.* if a ligh
+0000fff0: 7420 7468 656d 6520 6973 2073 656c 6563  t theme is selec
+00010000: 7465 642c 2060 6874 6d6c 2e79 6020 6973  ted, `html.y` is
+00010010: 2073 6574 2c20 6f74 6865 7277 6973 6520   set, otherwise 
+00010020: 6068 746d 6c2e 7a60 2069 730a 2a20 736f  `html.z` is.* so
+00010030: 2069 6620 7468 6520 6461 726b 2065 6469   if the dark edi
+00010040: 7469 6f6e 206f 6620 7468 6520 326e 6420  tion of the 2nd 
+00010050: 7468 656d 6520 6973 2073 656c 6563 7465  theme is selecte
+00010060: 642c 2079 6f75 2075 7365 2061 6e79 206f  d, you use any o
+00010070: 6620 6068 746d 6c2e 6260 2c20 6068 746d  f `html.b`, `htm
+00010080: 6c2e 7a60 2c20 6068 746d 6c2e 627a 6020  l.z`, `html.bz` 
+00010090: 746f 2073 7065 6369 6679 2072 756c 6573  to specify rules
+000100a0: 0a0a 7365 6520 7468 6520 746f 7020 6f66  ..see the top of
+000100b0: 205b 2e2f 636f 7079 7061 7274 792f 7765   [./copyparty/we
+000100c0: 622f 6272 6f77 7365 722e 6373 735d 282e  b/browser.css](.
+000100d0: 2f63 6f70 7970 6172 7479 2f77 6562 2f62  /copyparty/web/b
+000100e0: 726f 7773 6572 2e63 7373 2920 7768 6572  rowser.css) wher
+000100f0: 6520 7468 6520 636f 6c6f 7220 7661 7269  e the color vari
+00010100: 6162 6c65 7320 6172 6520 7365 742c 2061  ables are set, a
+00010110: 6e64 2074 6865 7265 2773 206c 6179 6f75  nd there's layou
+00010120: 742d 7370 6563 6966 6963 2073 7475 6666  t-specific stuff
+00010130: 206e 6561 7220 7468 6520 626f 7474 6f6d   near the bottom
+00010140: 0a0a 0a23 2320 636f 6d70 6c65 7465 2065  ...## complete e
+00010150: 7861 6d70 6c65 730a 0a2a 205b 7275 6e6e  xamples..* [runn
+00010160: 696e 6720 6f6e 2077 696e 646f 7773 5d28  ing on windows](
+00010170: 2e2f 646f 6373 2f65 7861 6d70 6c65 732f  ./docs/examples/
+00010180: 7769 6e64 6f77 732e 6d64 290a 0a2a 2072  windows.md)..* r
+00010190: 6561 642d 6f6e 6c79 206d 7573 6963 2073  ead-only music s
+000101a0: 6572 7665 7220 200a 2020 6070 7974 686f  erver  .  `pytho
+000101b0: 6e20 636f 7079 7061 7274 792d 7366 782e  n copyparty-sfx.
+000101c0: 7079 202d 7620 2f6d 6e74 2f6e 6173 2f6d  py -v /mnt/nas/m
+000101d0: 7573 6963 3a2f 6d75 7369 633a 7220 2d65  usic:/music:r -e
+000101e0: 3264 7361 202d 6532 7473 202d 2d6e 6f2d  2dsa -e2ts --no-
+000101f0: 726f 626f 7473 202d 2d66 6f72 6365 2d6a  robots --force-j
+00010200: 7320 2d2d 7468 656d 6520 3260 0a20 200a  s --theme 2`.  .
+00010210: 2020 2a20 2e2e 2e77 6974 6820 6270 6d20    * ...with bpm 
+00010220: 616e 6420 6b65 7920 7363 616e 6e69 6e67  and key scanning
+00010230: 2020 0a20 2020 2060 2d6d 7470 202e 6270    .    `-mtp .bp
+00010240: 6d3d 662c 6175 6469 6f2d 6270 6d2e 7079  m=f,audio-bpm.py
+00010250: 202d 6d74 7020 6b65 793d 662c 6175 6469   -mtp key=f,audi
+00010260: 6f2d 6b65 792e 7079 600a 2020 0a20 202a  o-key.py`.  .  *
+00010270: 202e 2e2e 7769 7468 2061 2072 6561 642d   ...with a read-
+00010280: 7772 6974 6520 666f 6c64 6572 2066 6f72  write folder for
+00010290: 2060 6b65 7669 6e60 2077 686f 7365 2070   `kevin` whose p
+000102a0: 6173 7377 6f72 6420 6973 2060 6f6b 676f  assword is `okgo
+000102b0: 6020 200a 2020 2020 602d 6120 6b65 7669  `  .    `-a kevi
+000102c0: 6e3a 6f6b 676f 202d 7620 2f6d 6e74 2f6e  n:okgo -v /mnt/n
+000102d0: 6173 2f69 6e63 3a2f 696e 633a 7277 2c6b  as/inc:/inc:rw,k
+000102e0: 6576 696e 600a 2020 0a20 202a 202e 2e2e  evin`.  .  * ...
+000102f0: 7769 7468 206c 6f67 6769 6e67 2074 6f20  with logging to 
+00010300: 6469 736b 2020 0a20 2020 2060 2d6c 6f20  disk  .    `-lo 
+00010310: 6c6f 672f 6370 702d 2559 2d25 6d25 642d  log/cpp-%Y-%m%d-
+00010320: 2548 254d 2553 2e74 7874 2e78 7a60 0a0a  %H%M%S.txt.xz`..
+00010330: 0a23 2320 7265 7665 7273 652d 7072 6f78  .## reverse-prox
+00010340: 790a 0a72 756e 6e69 6e67 2063 6f70 7970  y..running copyp
+00010350: 6172 7479 206e 6578 7420 746f 206f 7468  arty next to oth
+00010360: 6572 2077 6562 7369 7465 7320 2068 6f73  er websites  hos
+00010370: 7465 6420 6f6e 2061 6e20 6578 6973 7469  ted on an existi
+00010380: 6e67 2077 6562 7365 7276 6572 2073 7563  ng webserver suc
+00010390: 6820 6173 206e 6769 6e78 2c20 6361 6464  h as nginx, cadd
+000103a0: 792c 206f 7220 6170 6163 6865 0a0a 796f  y, or apache..yo
+000103b0: 7520 6361 6e20 6569 7468 6572 3a0a 2a20  u can either:.* 
+000103c0: 6769 7665 2063 6f70 7970 6172 7479 2069  give copyparty i
+000103d0: 7473 206f 776e 2064 6f6d 6169 6e20 6f72  ts own domain or
+000103e0: 2073 7562 646f 6d61 696e 2028 7265 636f   subdomain (reco
+000103f0: 6d6d 656e 6465 6429 0a2a 206f 7220 646f  mmended).* or do
+00010400: 206c 6f63 6174 696f 6e2d 6261 7365 6420   location-based 
+00010410: 7072 6f78 7969 6e67 2c20 7573 696e 6720  proxying, using 
+00010420: 602d 2d72 702d 6c6f 633d 2f73 7475 6666  `--rp-loc=/stuff
+00010430: 6020 746f 2074 656c 6c20 636f 7079 7061  ` to tell copypa
+00010440: 7274 7920 7768 6572 6520 6974 2069 7320  rty where it is 
+00010450: 6d6f 756e 7465 6420 2d2d 2068 6173 2061  mounted -- has a
+00010460: 2073 6c69 6768 7420 7065 7266 6f72 6d61   slight performa
+00010470: 6e63 6520 636f 7374 2061 6e64 2068 6967  nce cost and hig
+00010480: 6865 7220 6368 616e 6365 206f 6620 6275  her chance of bu
+00010490: 6773 0a20 202a 2069 6620 636f 7079 7061  gs.  * if copypa
+000104a0: 7274 7920 7361 7973 2060 696e 636f 7272  rty says `incorr
+000104b0: 6563 7420 2d2d 7270 2d6c 6f63 206f 7220  ect --rp-loc or 
+000104c0: 7765 6273 6572 7665 7220 636f 6e66 6967  webserver config
+000104d0: 3b20 6578 7065 6374 6564 2076 7061 7468  ; expected vpath
+000104e0: 2073 7461 7274 696e 6720 7769 7468 205b   starting with [
+000104f0: 2e2e 2e5d 6020 6974 2773 206c 696b 656c  ...]` it's likel
+00010500: 7920 6265 6361 7573 6520 7468 6520 7765  y because the we
+00010510: 6273 6572 7665 7220 6973 2073 7472 6970  bserver is strip
+00010520: 7069 6e67 2061 7761 7920 7468 6520 7072  ping away the pr
+00010530: 6f78 7920 6c6f 6361 7469 6f6e 2066 726f  oxy location fro
+00010540: 6d20 7468 6520 7265 7175 6573 7420 5552  m the request UR
+00010550: 4c73 202d 2d20 7365 6520 7468 6520 6050  Ls -- see the `P
+00010560: 726f 7879 5061 7373 6020 696e 2074 6865  roxyPass` in the
+00010570: 2061 7061 6368 6520 6578 616d 706c 6520   apache example 
+00010580: 6265 6c6f 770a 0a73 6f6d 6520 7265 7665  below..some reve
+00010590: 7273 6520 7072 6f78 6965 7320 2873 7563  rse proxies (suc
+000105a0: 6820 6173 205b 4361 6464 795d 2868 7474  h as [Caddy](htt
+000105b0: 7073 3a2f 2f63 6164 6479 7365 7276 6572  ps://caddyserver
+000105c0: 2e63 6f6d 2f29 2920 6361 6e20 6175 746f  .com/)) can auto
+000105d0: 6d61 7469 6361 6c6c 7920 6f62 7461 696e  matically obtain
+000105e0: 2061 2076 616c 6964 2068 7474 7073 2f74   a valid https/t
+000105f0: 6c73 2063 6572 7469 6669 6361 7465 2066  ls certificate f
+00010600: 6f72 2079 6f75 2c20 616e 6420 736f 6d65  or you, and some
+00010610: 2073 7570 706f 7274 2048 5454 502f 3220   support HTTP/2 
+00010620: 616e 6420 5155 4943 2077 6869 6368 2063  and QUIC which c
+00010630: 6f75 6c64 2062 6520 6120 6e69 6365 2073  ould be a nice s
+00010640: 7065 6564 2062 6f6f 7374 0a0a 6578 616d  peed boost..exam
+00010650: 706c 6520 7765 6273 6572 7665 7220 636f  ple webserver co
+00010660: 6e66 6967 733a 0a0a 2a20 5b6e 6769 6e78  nfigs:..* [nginx
+00010670: 2063 6f6e 6669 675d 2863 6f6e 7472 6962   config](contrib
+00010680: 2f6e 6769 6e78 2f63 6f70 7970 6172 7479  /nginx/copyparty
+00010690: 2e63 6f6e 6629 202d 2d20 656e 7469 7265  .conf) -- entire
+000106a0: 2064 6f6d 6169 6e2f 7375 6264 6f6d 6169   domain/subdomai
+000106b0: 6e0a 2a20 5b61 7061 6368 6532 2063 6f6e  n.* [apache2 con
+000106c0: 6669 675d 2863 6f6e 7472 6962 2f61 7061  fig](contrib/apa
+000106d0: 6368 652f 636f 7079 7061 7274 792e 636f  che/copyparty.co
+000106e0: 6e66 2920 2d2d 206c 6f63 6174 696f 6e2d  nf) -- location-
+000106f0: 6261 7365 640a 0a0a 2320 7061 636b 6167  based...# packag
+00010700: 6573 0a0a 7468 6520 7061 7274 7920 6d69  es..the party mi
+00010710: 6768 7420 6265 2063 6c6f 7365 7220 7468  ght be closer th
+00010720: 616e 2079 6f75 2074 6869 6e6b 0a0a 0a23  an you think...#
+00010730: 2320 6172 6368 2070 6163 6b61 6765 0a0a  # arch package..
+00010740: 6e6f 7720 5b61 7661 696c 6162 6c65 206f  now [available o
+00010750: 6e20 6175 725d 2868 7474 7073 3a2f 2f61  n aur](https://a
+00010760: 7572 2e61 7263 686c 696e 7578 2e6f 7267  ur.archlinux.org
+00010770: 2f70 6163 6b61 6765 732f 636f 7079 7061  /packages/copypa
+00010780: 7274 7929 206d 6169 6e74 6169 6e65 6420  rty) maintained 
+00010790: 6279 205b 4069 6378 6573 5d28 6874 7470  by [@icxes](http
+000107a0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f69  s://github.com/i
+000107b0: 6378 6573 290a 0a0a 2323 206e 6978 2070  cxes)...## nix p
+000107c0: 6163 6b61 6765 0a0a 606e 6978 2070 726f  ackage..`nix pro
+000107d0: 6669 6c65 2069 6e73 7461 6c6c 2067 6974  file install git
+000107e0: 6875 623a 3930 3031 2f63 6f70 7970 6172  hub:9001/copypar
+000107f0: 7479 600a 0a72 6571 7569 7265 7320 6120  ty`..requires a 
+00010800: 5b66 6c61 6b65 2d65 6e61 626c 6564 5d28  [flake-enabled](
+00010810: 6874 7470 733a 2f2f 6e69 786f 732e 7769  https://nixos.wi
+00010820: 6b69 2f77 696b 692f 466c 616b 6573 2920  ki/wiki/Flakes) 
+00010830: 696e 7374 616c 6c61 7469 6f6e 206f 6620  installation of 
+00010840: 6e69 780a 0a73 6f6d 6520 7265 636f 6d6d  nix..some recomm
+00010850: 656e 6465 6420 6465 7065 6e64 656e 6369  ended dependenci
+00010860: 6573 2061 7265 2065 6e61 626c 6564 2062  es are enabled b
+00010870: 7920 6465 6661 756c 743b 205b 6f76 6572  y default; [over
+00010880: 7269 6465 2074 6865 2070 6163 6b61 6765  ride the package
+00010890: 5d28 6874 7470 733a 2f2f 6769 7468 7562  ](https://github
+000108a0: 2e63 6f6d 2f39 3030 312f 636f 7079 7061  .com/9001/copypa
+000108b0: 7274 792f 626c 6f62 2f68 6f76 7564 7374  rty/blob/hovudst
+000108c0: 7261 756d 2f63 6f6e 7472 6962 2f70 6163  raum/contrib/pac
+000108d0: 6b61 6765 2f6e 6978 2f63 6f70 7970 6172  kage/nix/copypar
+000108e0: 7479 2f64 6566 6175 6c74 2e6e 6978 234c  ty/default.nix#L
+000108f0: 332d 4c32 3229 2069 6620 796f 7520 7761  3-L22) if you wa
+00010900: 6e74 2074 6f20 6164 642f 7265 6d6f 7665  nt to add/remove
+00010910: 2073 6f6d 6520 6665 6174 7572 6573 2f64   some features/d
+00010920: 6570 730a 0a60 6666 6d70 6567 2d66 756c  eps..`ffmpeg-ful
+00010930: 6c60 2077 6173 2063 686f 7365 6e20 6f76  l` was chosen ov
+00010940: 6572 2060 6666 6d70 6567 2d68 6561 646c  er `ffmpeg-headl
+00010950: 6573 7360 206d 6169 6e6c 7920 6265 6361  ess` mainly beca
+00010960: 7573 6520 7765 206e 6565 6420 6077 6974  use we need `wit
+00010970: 6857 6562 7060 2028 616e 6420 6077 6974  hWebp` (and `wit
+00010980: 684f 7065 6e6d 7074 6020 6973 2061 6c73  hOpenmpt` is als
+00010990: 6f20 6e69 6365 2920 616e 6420 6265 696e  o nice) and bein
+000109a0: 6720 6162 6c65 2074 6f20 7573 6520 6120  g able to use a 
+000109b0: 6361 6368 6564 2062 7569 6c64 2066 656c  cached build fel
+000109c0: 7420 6d6f 7265 2069 6d70 6f72 7461 6e74  t more important
+000109d0: 2074 6861 6e20 6f70 7469 6d69 7a69 6e67   than optimizing
+000109e0: 2066 6f72 2073 697a 6520 6174 2074 6865   for size at the
+000109f0: 2074 696d 6520 2d2d 2050 5273 2077 656c   time -- PRs wel
+00010a00: 636f 6d65 2069 6620 796f 7520 6469 7361  come if you disa
+00010a10: 6772 6565 20f0 9f91 8d0a 0a0a 2323 206e  gree .......## n
+00010a20: 6978 6f73 206d 6f64 756c 650a 0a66 6f72  ixos module..for
+00010a30: 2074 6869 7320 7365 7475 702c 2079 6f75   this setup, you
+00010a40: 2077 696c 6c20 6e65 6564 2061 205b 666c   will need a [fl
+00010a50: 616b 652d 656e 6162 6c65 645d 2868 7474  ake-enabled](htt
+00010a60: 7073 3a2f 2f6e 6978 6f73 2e77 696b 692f  ps://nixos.wiki/
+00010a70: 7769 6b69 2f46 6c61 6b65 7329 2069 6e73  wiki/Flakes) ins
+00010a80: 7461 6c6c 6174 696f 6e20 6f66 204e 6978  tallation of Nix
+00010a90: 4f53 2e0a 0a60 6060 6e69 780a 7b0a 2020  OS...```nix.{.  
+00010aa0: 2320 6164 6420 636f 7079 7061 7274 7920  # add copyparty 
+00010ab0: 666c 616b 6520 746f 2079 6f75 7220 696e  flake to your in
+00010ac0: 7075 7473 0a20 2069 6e70 7574 732e 636f  puts.  inputs.co
+00010ad0: 7079 7061 7274 792e 7572 6c20 3d20 2267  pyparty.url = "g
+00010ae0: 6974 6875 623a 3930 3031 2f63 6f70 7970  ithub:9001/copyp
+00010af0: 6172 7479 223b 0a0a 2020 2320 656e 7375  arty";..  # ensu
+00010b00: 7265 2074 6861 7420 636f 7079 7061 7274  re that copypart
+00010b10: 7920 6973 2061 6e20 616c 6c6f 7765 6420  y is an allowed 
+00010b20: 6172 6775 6d65 6e74 2074 6f20 7468 6520  argument to the 
+00010b30: 6f75 7470 7574 7320 6675 6e63 7469 6f6e  outputs function
+00010b40: 0a20 206f 7574 7075 7473 203d 207b 2073  .  outputs = { s
+00010b50: 656c 662c 206e 6978 706b 6773 2c20 636f  elf, nixpkgs, co
+00010b60: 7079 7061 7274 7920 7d3a 207b 0a20 2020  pyparty }: {.   
+00010b70: 206e 6978 6f73 436f 6e66 6967 7572 6174   nixosConfigurat
+00010b80: 696f 6e73 2e79 6f75 7248 6f73 744e 616d  ions.yourHostNam
+00010b90: 6520 3d20 6e69 7870 6b67 732e 6c69 622e  e = nixpkgs.lib.
+00010ba0: 6e69 786f 7353 7973 7465 6d20 7b0a 2020  nixosSystem {.  
+00010bb0: 2020 2020 6d6f 6475 6c65 7320 3d20 5b0a      modules = [.
+00010bc0: 2020 2020 2020 2020 2320 6c6f 6164 2074          # load t
+00010bd0: 6865 2063 6f70 7970 6172 7479 204e 6978  he copyparty Nix
+00010be0: 4f53 206d 6f64 756c 650a 2020 2020 2020  OS module.      
+00010bf0: 2020 636f 7079 7061 7274 792e 6e69 786f    copyparty.nixo
+00010c00: 734d 6f64 756c 6573 2e64 6566 6175 6c74  sModules.default
+00010c10: 0a20 2020 2020 2020 2028 7b20 706b 6773  .        ({ pkgs
+00010c20: 2c20 2e2e 2e20 7d3a 207b 0a20 2020 2020  , ... }: {.     
+00010c30: 2020 2020 2023 2061 6464 2074 6865 2063       # add the c
+00010c40: 6f70 7970 6172 7479 206f 7665 726c 6179  opyparty overlay
+00010c50: 2074 6f20 6578 706f 7365 2074 6865 2070   to expose the p
+00010c60: 6163 6b61 6765 2074 6f20 7468 6520 6d6f  ackage to the mo
+00010c70: 6475 6c65 0a20 2020 2020 2020 2020 206e  dule.          n
+00010c80: 6978 706b 6773 2e6f 7665 726c 6179 7320  ixpkgs.overlays 
+00010c90: 3d20 5b20 636f 7079 7061 7274 792e 6f76  = [ copyparty.ov
+00010ca0: 6572 6c61 7973 2e64 6566 6175 6c74 205d  erlays.default ]
+00010cb0: 3b0a 2020 2020 2020 2020 2020 2320 286f  ;.          # (o
+00010cc0: 7074 696f 6e61 6c29 2069 6e73 7461 6c6c  ptional) install
+00010cd0: 2074 6865 2070 6163 6b61 6765 2067 6c6f   the package glo
+00010ce0: 6261 6c6c 790a 2020 2020 2020 2020 2020  bally.          
+00010cf0: 656e 7669 726f 6e6d 656e 742e 7379 7374  environment.syst
+00010d00: 656d 5061 636b 6167 6573 203d 205b 2070  emPackages = [ p
+00010d10: 6b67 732e 636f 7079 7061 7274 7920 5d3b  kgs.copyparty ];
+00010d20: 0a20 2020 2020 2020 2020 2023 2063 6f6e  .          # con
+00010d30: 6669 6775 7265 2074 6865 2063 6f70 7970  figure the copyp
+00010d40: 6172 7479 206d 6f64 756c 650a 2020 2020  arty module.    
+00010d50: 2020 2020 2020 7365 7276 6963 6573 2e63        services.c
+00010d60: 6f70 7970 6172 7479 2e65 6e61 626c 6520  opyparty.enable 
+00010d70: 3d20 7472 7565 3b0a 2020 2020 2020 2020  = true;.        
+00010d80: 7d29 0a20 2020 2020 205d 3b0a 2020 2020  }).      ];.    
+00010d90: 7d3b 0a20 207d 3b0a 7d0a 6060 600a 0a63  };.  };.}.```..c
+00010da0: 6f70 7970 6172 7479 206f 6e20 4e69 784f  opyparty on NixO
+00010db0: 5320 6973 2063 6f6e 6669 6775 7265 6420  S is configured 
+00010dc0: 7669 6120 6073 6572 7669 6365 732e 636f  via `services.co
+00010dd0: 7079 7061 7274 7960 206f 7074 696f 6e73  pyparty` options
+00010de0: 2c20 666f 7220 6578 616d 706c 653a 0a60  , for example:.`
+00010df0: 6060 6e69 780a 7365 7276 6963 6573 2e63  ``nix.services.c
+00010e00: 6f70 7970 6172 7479 203d 207b 0a20 2065  opyparty = {.  e
+00010e10: 6e61 626c 6520 3d20 7472 7565 3b0a 2020  nable = true;.  
+00010e20: 2320 6469 7265 6374 6c79 206d 6170 7320  # directly maps 
+00010e30: 746f 2076 616c 7565 7320 696e 2074 6865  to values in the
+00010e40: 205b 676c 6f62 616c 5d20 7365 6374 696f   [global] sectio
+00010e50: 6e20 6f66 2074 6865 2063 6f70 7970 6172  n of the copypar
+00010e60: 7479 2063 6f6e 6669 672e 0a20 2023 2073  ty config..  # s
+00010e70: 6565 2060 636f 7079 7061 7274 7920 2d2d  ee `copyparty --
+00010e80: 6865 6c70 6020 666f 7220 6176 6169 6c61  help` for availa
+00010e90: 626c 6520 6f70 7469 6f6e 730a 2020 7365  ble options.  se
+00010ea0: 7474 696e 6773 203d 207b 0a20 2020 2069  ttings = {.    i
+00010eb0: 203d 2022 302e 302e 302e 3022 3b0a 2020   = "0.0.0.0";.  
+00010ec0: 2020 2320 7573 6520 6c69 7374 7320 746f    # use lists to
+00010ed0: 2073 6574 206d 756c 7469 706c 6520 7661   set multiple va
+00010ee0: 6c75 6573 0a20 2020 2070 203d 205b 2033  lues.    p = [ 3
+00010ef0: 3231 3020 3332 3131 205d 3b0a 2020 2020  210 3211 ];.    
+00010f00: 2320 7573 6520 626f 6f6c 6561 6e73 2074  # use booleans t
+00010f10: 6f20 7365 7420 6269 6e61 7279 2066 6c61  o set binary fla
+00010f20: 6773 0a20 2020 206e 6f2d 7265 6c6f 6164  gs.    no-reload
+00010f30: 203d 2074 7275 653b 0a20 2020 2023 2075   = true;.    # u
+00010f40: 7369 6e67 2027 6661 6c73 6527 2077 696c  sing 'false' wil
+00010f50: 6c20 646f 206e 6f74 6869 6e67 2061 6e64  l do nothing and
+00010f60: 206f 6d69 7420 7468 6520 7661 6c75 6520   omit the value 
+00010f70: 7768 656e 2067 656e 6572 6174 696e 6720  when generating 
+00010f80: 6120 636f 6e66 6967 0a20 2020 2069 676e  a config.    ign
+00010f90: 6f72 6564 2d66 6c61 6720 3d20 6661 6c73  ored-flag = fals
+00010fa0: 653b 0a20 207d 3b0a 0a20 2023 2063 7265  e;.  };..  # cre
+00010fb0: 6174 6520 7573 6572 730a 2020 6163 636f  ate users.  acco
+00010fc0: 756e 7473 203d 207b 0a20 2020 2023 2073  unts = {.    # s
+00010fd0: 7065 6369 6679 2074 6865 2061 6363 6f75  pecify the accou
+00010fe0: 6e74 206e 616d 6520 6173 2074 6865 206b  nt name as the k
+00010ff0: 6579 0a20 2020 2065 6420 3d20 7b0a 2020  ey.    ed = {.  
+00011000: 2020 2020 2320 7072 6f76 6964 6520 7468      # provide th
+00011010: 6520 7061 7468 2074 6f20 6120 6669 6c65  e path to a file
+00011020: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00011030: 7061 7373 776f 7264 2c20 6b65 6570 696e  password, keepin
+00011040: 6720 6974 206f 7574 206f 6620 2f6e 6978  g it out of /nix
+00011050: 2f73 746f 7265 0a20 2020 2020 2023 206d  /store.      # m
+00011060: 7573 7420 6265 2072 6561 6461 626c 6520  ust be readable 
+00011070: 6279 2074 6865 2063 6f70 7970 6172 7479  by the copyparty
+00011080: 2073 6572 7669 6365 2075 7365 720a 2020   service user.  
+00011090: 2020 2020 7061 7373 776f 7264 4669 6c65      passwordFile
+000110a0: 203d 2022 2f72 756e 2f6b 6579 732f 636f   = "/run/keys/co
+000110b0: 7079 7061 7274 792f 6564 5f70 6173 7377  pyparty/ed_passw
+000110c0: 6f72 6422 3b0a 2020 2020 7d3b 0a20 2020  ord";.    };.   
+000110d0: 2023 206f 7220 646f 2062 6f74 6820 696e   # or do both in
+000110e0: 206f 6e65 2067 6f0a 2020 2020 6b2e 7061   one go.    k.pa
+000110f0: 7373 776f 7264 4669 6c65 203d 2022 2f72  sswordFile = "/r
+00011100: 756e 2f6b 6579 732f 636f 7079 7061 7274  un/keys/copypart
+00011110: 792f 6b5f 7061 7373 776f 7264 223b 0a20  y/k_password";. 
+00011120: 207d 3b0a 0a20 2023 2063 7265 6174 6520   };..  # create 
+00011130: 6120 766f 6c75 6d65 0a20 2076 6f6c 756d  a volume.  volum
+00011140: 6573 203d 207b 0a20 2020 2023 2063 7265  es = {.    # cre
+00011150: 6174 6520 6120 766f 6c75 6d65 2061 7420  ate a volume at 
+00011160: 222f 2220 2874 6865 2077 6562 726f 6f74  "/" (the webroot
+00011170: 292c 2077 6869 6368 2077 696c 6c0a 2020  ), which will.  
+00011180: 2020 222f 2220 3d20 7b0a 2020 2020 2020    "/" = {.      
+00011190: 2320 7368 6172 6520 7468 6520 636f 6e74  # share the cont
+000111a0: 656e 7473 206f 6620 222f 7372 762f 636f  ents of "/srv/co
+000111b0: 7079 7061 7274 7922 0a20 2020 2020 2070  pyparty".      p
+000111c0: 6174 6820 3d20 222f 7372 762f 636f 7079  ath = "/srv/copy
+000111d0: 7061 7274 7922 3b0a 2020 2020 2020 2320  party";.      # 
+000111e0: 7365 6520 6063 6f70 7970 6172 7479 202d  see `copyparty -
+000111f0: 2d68 656c 702d 6163 636f 756e 7473 6020  -help-accounts` 
+00011200: 666f 7220 6176 6169 6c61 626c 6520 6f70  for available op
+00011210: 7469 6f6e 730a 2020 2020 2020 6163 6365  tions.      acce
+00011220: 7373 203d 207b 0a20 2020 2020 2020 2023  ss = {.        #
+00011230: 2065 7665 7279 6f6e 6520 6765 7473 2072   everyone gets r
+00011240: 6561 642d 6163 6365 7373 2c20 6275 740a  ead-access, but.
+00011250: 2020 2020 2020 2020 7220 3d20 222a 223b          r = "*";
+00011260: 0a20 2020 2020 2020 2023 2075 7365 7273  .        # users
+00011270: 2022 6564 2220 616e 6420 226b 2220 6765   "ed" and "k" ge
+00011280: 7420 7265 6164 2d77 7269 7465 0a20 2020  t read-write.   
+00011290: 2020 2020 2072 7720 3d20 5b20 2265 6422       rw = [ "ed"
+000112a0: 2022 6b22 205d 3b0a 2020 2020 2020 7d3b   "k" ];.      };
+000112b0: 0a20 2020 2020 2023 2073 6565 2060 636f  .      # see `co
+000112c0: 7079 7061 7274 7920 2d2d 6865 6c70 2d66  pyparty --help-f
+000112d0: 6c61 6773 6020 666f 7220 6176 6169 6c61  lags` for availa
+000112e0: 626c 6520 6f70 7469 6f6e 730a 2020 2020  ble options.    
+000112f0: 2020 666c 6167 7320 3d20 7b0a 2020 2020    flags = {.    
+00011300: 2020 2020 2320 2266 6b22 2065 6e61 626c      # "fk" enabl
+00011310: 6573 2066 696c 656b 6579 7320 286e 6563  es filekeys (nec
+00011320: 6573 7361 7279 2066 6f72 2075 7067 6574  essary for upget
+00011330: 2070 6572 6d69 7373 696f 6e29 2028 3420   permission) (4 
+00011340: 6368 6172 7320 6c6f 6e67 290a 2020 2020  chars long).    
+00011350: 2020 2020 666b 203d 2034 3b0a 2020 2020      fk = 4;.    
+00011360: 2020 2020 2320 7363 616e 2066 6f72 206e      # scan for n
+00011370: 6577 2066 696c 6573 2065 7665 7279 2036  ew files every 6
+00011380: 3073 6563 0a20 2020 2020 2020 2073 6361  0sec.        sca
+00011390: 6e20 3d20 3630 3b0a 2020 2020 2020 2020  n = 60;.        
+000113a0: 2320 766f 6c66 6c61 6720 2265 3264 2220  # volflag "e2d" 
+000113b0: 656e 6162 6c65 7320 7468 6520 7570 6c6f  enables the uplo
+000113c0: 6164 7320 6461 7461 6261 7365 0a20 2020  ads database.   
+000113d0: 2020 2020 2065 3264 203d 2074 7275 653b       e2d = true;
+000113e0: 0a20 2020 2020 2020 2023 2022 6432 7422  .        # "d2t"
+000113f0: 2064 6973 6162 6c65 7320 6d75 6c74 696d   disables multim
+00011400: 6564 6961 2070 6172 7365 7273 2028 696e  edia parsers (in
+00011410: 2063 6173 6520 7468 6520 7570 6c6f 6164   case the upload
+00011420: 7320 6172 6520 6d61 6c69 6369 6f75 7329  s are malicious)
+00011430: 0a20 2020 2020 2020 2064 3274 203d 2074  .        d2t = t
+00011440: 7275 653b 0a20 2020 2020 2020 2023 2073  rue;.        # s
+00011450: 6b69 7073 2068 6173 6869 6e67 2066 696c  kips hashing fil
+00011460: 6520 636f 6e74 656e 7473 2069 6620 7061  e contents if pa
+00011470: 7468 206d 6174 6368 6573 202a 2e69 736f  th matches *.iso
+00011480: 0a20 2020 2020 2020 206e 6f68 6173 6820  .        nohash 
+00011490: 3d20 225c 2e69 736f 2422 3b0a 2020 2020  = "\.iso$";.    
+000114a0: 2020 7d3b 0a20 2020 207d 3b0a 2020 7d3b    };.    };.  };
+000114b0: 0a20 2023 2079 6f75 206d 6179 2069 6e63  .  # you may inc
+000114c0: 7265 6173 6520 7468 6520 6f70 656e 2066  rease the open f
+000114d0: 696c 6520 6c69 6d69 7420 666f 7220 7468  ile limit for th
+000114e0: 6520 7072 6f63 6573 730a 2020 6f70 656e  e process.  open
+000114f0: 4669 6c65 734c 696d 6974 203d 2038 3139  FilesLimit = 819
+00011500: 323b 0a7d 3b0a 6060 600a 0a74 6865 2070  2;.};.```..the p
+00011510: 6173 7377 6f72 6446 696c 6520 6174 202f  asswordFile at /
+00011520: 7275 6e2f 6b65 7973 2f63 6f70 7970 6172  run/keys/copypar
+00011530: 7479 2f20 636f 756c 6420 666f 7220 6578  ty/ could for ex
+00011540: 616d 706c 6520 6265 2067 656e 6572 6174  ample be generat
+00011550: 6564 2062 7920 5b61 6765 6e69 785d 2868  ed by [agenix](h
+00011560: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+00011570: 6d2f 7279 616e 746d 2f61 6765 6e69 7829  m/ryantm/agenix)
+00011580: 2c20 6f72 2079 6f75 2063 6f75 6c64 206a  , or you could j
+00011590: 7573 7420 6475 6d70 2069 7420 696e 2074  ust dump it in t
+000115a0: 6865 206e 6978 2073 746f 7265 2069 6e73  he nix store ins
+000115b0: 7465 6164 2069 6620 7468 6174 2773 2061  tead if that's a
+000115c0: 6363 6570 7461 626c 650a 0a0a 2320 6272  cceptable...# br
+000115d0: 6f77 7365 7220 7375 7070 6f72 740a 0a54  owser support..T
+000115e0: 4c44 523a 2079 6573 0a0a 215b 636f 7079  LDR: yes..![copy
+000115f0: 7061 7274 792d 6965 342d 6673 385d 2868  party-ie4-fs8](h
+00011600: 7474 7073 3a2f 2f75 7365 722d 696d 6167  ttps://user-imag
+00011610: 6573 2e67 6974 6875 6275 7365 7263 6f6e  es.githubusercon
+00011620: 7465 6e74 2e63 6f6d 2f32 3431 3033 322f  tent.com/241032/
+00011630: 3131 3831 3932 3739 312d 6662 3331 6665  118192791-fb31fe
+00011640: 3030 2d62 3434 362d 3131 6562 2d39 3634  00-b446-11eb-964
+00011650: 372d 3839 3865 6138 6566 6331 6637 2e70  7-898ea8efc1f7.p
+00011660: 6e67 290a 0a60 6965 6020 3d20 696e 7465  ng)..`ie` = inte
+00011670: 726e 6574 2d65 7870 6c6f 7265 722c 2060  rnet-explorer, `
+00011680: 6666 6020 3d20 6669 7265 666f 782c 2060  ff` = firefox, `
+00011690: 6360 203d 2063 6872 6f6d 652c 2060 694f  c` = chrome, `iO
+000116a0: 5360 203d 2069 5068 6f6e 652f 6950 6164  S` = iPhone/iPad
+000116b0: 2c20 6041 6e64 7260 203d 2041 6e64 726f  , `Andr` = Andro
+000116c0: 6964 0a0a 7c20 6665 6174 7572 6520 2020  id..| feature   
+000116d0: 2020 2020 2020 7c20 6965 3620 7c20 6965        | ie6 | ie
+000116e0: 3920 207c 2069 6531 3020 7c20 6965 3131  9  | ie10 | ie11
+000116f0: 207c 2066 6620 3532 207c 2063 2034 3920   | ff 52 | c 49 
+00011700: 7c20 694f 5320 7c20 416e 6472 207c 0a7c  | iOS | Andr |.|
+00011710: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00011720: 207c 202d 2d2d 207c 202d 2d2d 2d20 7c20   | --- | ---- | 
+00011730: 2d2d 2d2d 207c 202d 2d2d 2d20 7c20 2d2d  ---- | ---- | --
+00011740: 2d2d 2d20 7c20 2d2d 2d2d 207c 202d 2d2d  --- | ---- | ---
+00011750: 207c 202d 2d2d 2d20 7c0a 7c20 6272 6f77   | ---- |.| brow
+00011760: 7365 2066 696c 6573 2020 2020 7c20 7965  se files    | ye
+00011770: 7020 7c20 7965 7020 207c 2079 6570 2020  p | yep  | yep  
+00011780: 7c20 7965 7020 207c 2020 7965 7020 207c  | yep  |  yep  |
+00011790: 2079 6570 2020 7c20 7965 7020 7c20 7965   yep  | yep | ye
+000117a0: 7020 207c 0a7c 2074 6875 6d62 6e61 696c  p  |.| thumbnail
+000117b0: 2076 6965 7720 207c 2020 2d20 207c 2079   view  |  -  | y
+000117c0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+000117d0: 2020 7c20 2079 6570 2020 7c20 7965 7020    |  yep  | yep 
+000117e0: 207c 2079 6570 207c 2079 6570 2020 7c0a   | yep | yep  |.
+000117f0: 7c20 6261 7369 6320 7570 6c6f 6164 6572  | basic uploader
+00011800: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
+00011810: 2079 6570 2020 7c20 7965 7020 207c 2020   yep  | yep  |  
+00011820: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+00011830: 7020 7c20 7965 7020 207c 0a7c 2075 7032  p | yep  |.| up2
+00011840: 6b20 2020 2020 2020 2020 2020 207c 2020  k            |  
+00011850: 2d20 207c 2020 2d20 2020 7c20 602a 3160  -  |  -   | `*1`
+00011860: 207c 2060 2a31 6020 7c20 2079 6570 2020   | `*1` |  yep  
+00011870: 7c20 7965 7020 207c 2079 6570 207c 2079  | yep  | yep | y
+00011880: 6570 2020 7c0a 7c20 6d61 6b65 2064 6972  ep  |.| make dir
+00011890: 6563 746f 7279 2020 7c20 7965 7020 7c20  ectory  | yep | 
+000118a0: 7965 7020 207c 2079 6570 2020 7c20 7965  yep  | yep  | ye
+000118b0: 7020 207c 2020 7965 7020 207c 2079 6570  p  |  yep  | yep
+000118c0: 2020 7c20 7965 7020 7c20 7965 7020 207c    | yep | yep  |
+000118d0: 0a7c 2073 656e 6420 6d65 7373 6167 6520  .| send message 
+000118e0: 2020 207c 2079 6570 207c 2079 6570 2020     | yep | yep  
+000118f0: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+00011900: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+00011910: 6570 207c 2079 6570 2020 7c0a 7c20 7365  ep | yep  |.| se
+00011920: 7420 736f 7274 206f 7264 6572 2020 7c20  t sort order  | 
+00011930: 202d 2020 7c20 7965 7020 207c 2079 6570   -  | yep  | yep
+00011940: 2020 7c20 7965 7020 207c 2020 7965 7020    | yep  |  yep 
+00011950: 207c 2079 6570 2020 7c20 7965 7020 7c20   | yep  | yep | 
+00011960: 7965 7020 207c 0a7c 207a 6970 2073 656c  yep  |.| zip sel
+00011970: 6563 7469 6f6e 2020 207c 2020 2d20 207c  ection   |  -  |
+00011980: 2079 6570 2020 7c20 7965 7020 207c 2079   yep  | yep  | y
+00011990: 6570 2020 7c20 2079 6570 2020 7c20 7965  ep  |  yep  | ye
+000119a0: 7020 207c 2079 6570 207c 2079 6570 2020  p  | yep | yep  
+000119b0: 7c0a 7c20 6669 6c65 2072 656e 616d 6520  |.| file rename 
+000119c0: 2020 2020 7c20 202d 2020 7c20 7965 7020      |  -  | yep 
+000119d0: 207c 2079 6570 2020 7c20 7965 7020 207c   | yep  | yep  |
+000119e0: 2020 7965 7020 207c 2079 6570 2020 7c20    yep  | yep  | 
+000119f0: 7965 7020 7c20 7965 7020 207c 0a7c 2066  yep | yep  |.| f
+00011a00: 696c 6520 6375 742f 7061 7374 6520 207c  ile cut/paste  |
+00011a10: 2020 2d20 207c 2079 6570 2020 7c20 7965    -  | yep  | ye
+00011a20: 7020 207c 2079 6570 2020 7c20 2079 6570  p  | yep  |  yep
+00011a30: 2020 7c20 7965 7020 207c 2079 6570 207c    | yep  | yep |
+00011a40: 2079 6570 2020 7c0a 7c20 6e61 7670 616e   yep  |.| navpan
+00011a50: 6520 2020 2020 2020 2020 7c20 202d 2020  e         |  -  
+00011a60: 7c20 7965 7020 207c 2079 6570 2020 7c20  | yep  | yep  | 
+00011a70: 7965 7020 207c 2020 7965 7020 207c 2079  yep  |  yep  | y
+00011a80: 6570 2020 7c20 7965 7020 7c20 7965 7020  ep  | yep | yep 
+00011a90: 207c 0a7c 2069 6d61 6765 2076 6965 7765   |.| image viewe
+00011aa0: 7220 2020 207c 2020 2d20 207c 2079 6570  r    |  -  | yep
+00011ab0: 2020 7c20 7965 7020 207c 2079 6570 2020    | yep  | yep  
+00011ac0: 7c20 2079 6570 2020 7c20 7965 7020 207c  |  yep  | yep  |
+00011ad0: 2079 6570 207c 2079 6570 2020 7c0a 7c20   yep | yep  |.| 
+00011ae0: 7669 6465 6f20 706c 6179 6572 2020 2020  video player    
+00011af0: 7c20 202d 2020 7c20 7965 7020 207c 2079  |  -  | yep  | y
+00011b00: 6570 2020 7c20 7965 7020 207c 2020 7965  ep  | yep  |  ye
+00011b10: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011b20: 7c20 7965 7020 207c 0a7c 206d 6172 6b64  | yep  |.| markd
+00011b30: 6f77 6e20 6564 6974 6f72 207c 2020 2d20  own editor |  - 
+00011b40: 207c 2020 2d20 2020 7c20 7965 7020 207c   |  -   | yep  |
+00011b50: 2079 6570 2020 7c20 2079 6570 2020 7c20   yep  |  yep  | 
+00011b60: 7965 7020 207c 2079 6570 207c 2079 6570  yep  | yep | yep
+00011b70: 2020 7c0a 7c20 6d61 726b 646f 776e 2076    |.| markdown v
+00011b80: 6965 7765 7220 7c20 202d 2020 7c20 7965  iewer |  -  | ye
+00011b90: 7020 207c 2079 6570 2020 7c20 7965 7020  p  | yep  | yep 
+00011ba0: 207c 2020 7965 7020 207c 2079 6570 2020   |  yep  | yep  
+00011bb0: 7c20 7965 7020 7c20 7965 7020 207c 0a7c  | yep | yep  |.|
+00011bc0: 2070 6c61 7920 6d70 332f 6d34 6120 2020   play mp3/m4a   
+00011bd0: 207c 2020 2d20 207c 2079 6570 2020 7c20   |  -  | yep  | 
+00011be0: 7965 7020 207c 2079 6570 2020 7c20 2079  yep  | yep  |  y
+00011bf0: 6570 2020 7c20 7965 7020 207c 2079 6570  ep  | yep  | yep
+00011c00: 207c 2079 6570 2020 7c0a 7c20 706c 6179   | yep  |.| play
+00011c10: 206f 6767 2f6f 7075 7320 2020 7c20 202d   ogg/opus   |  -
+00011c20: 2020 7c20 202d 2020 207c 2020 2d20 2020    |  -   |  -   
+00011c30: 7c20 202d 2020 207c 2020 7965 7020 207c  |  -   |  yep  |
+00011c40: 2079 6570 2020 7c20 602a 3360 207c 2079   yep  | `*3` | y
+00011c50: 6570 207c 0a7c 202a 2a3d 2066 6561 7475  ep |.| **= featu
+00011c60: 7265 203d 2a2a 207c 2069 6536 207c 2069  re =** | ie6 | i
+00011c70: 6539 2020 7c20 6965 3130 207c 2069 6531  e9  | ie10 | ie1
+00011c80: 3120 7c20 6666 2035 3220 7c20 6320 3439  1 | ff 52 | c 49
+00011c90: 207c 2069 4f53 207c 2041 6e64 7220 7c0a   | iOS | Andr |.
+00011ca0: 0a2a 2069 6e74 6572 6e65 7420 6578 706c  .* internet expl
+00011cb0: 6f72 6572 2036 2074 6f20 3820 6265 6861  orer 6 to 8 beha
+00011cc0: 7665 2074 6865 2073 616d 650a 2a20 6669  ve the same.* fi
+00011cd0: 7265 666f 7820 3532 2061 6e64 2063 6872  refox 52 and chr
+00011ce0: 6f6d 6520 3439 2061 7265 2074 6865 2066  ome 49 are the f
+00011cf0: 696e 616c 2077 696e 7870 2076 6572 7369  inal winxp versi
+00011d00: 6f6e 730a 2a20 602a 3160 2079 6573 2c20  ons.* `*1` yes, 
+00011d10: 6275 7420 6578 7472 656d 656c 7920 736c  but extremely sl
+00011d20: 6f77 2028 6965 3130 3a20 6031 204d 6942  ow (ie10: `1 MiB
+00011d30: 2f73 602c 2069 6531 313a 2060 3237 3020  /s`, ie11: `270 
+00011d40: 4b69 422f 7360 290a 2a20 602a 3360 2069  KiB/s`).* `*3` i
+00011d50: 4f53 2031 3120 616e 6420 6e65 7765 722c  OS 11 and newer,
+00011d60: 206f 7075 7320 6f6e 6c79 2c20 616e 6420   opus only, and 
+00011d70: 7265 7175 6972 6573 2046 466d 7065 6720  requires FFmpeg 
+00011d80: 6f6e 2074 6865 2073 6572 7665 720a 0a71  on the server..q
+00011d90: 7569 636b 2073 756d 6d61 7279 206f 6620  uick summary of 
+00011da0: 6d6f 7265 2065 6363 656e 7472 6963 2077  more eccentric w
+00011db0: 6562 2d62 726f 7773 6572 7320 7472 7969  eb-browsers tryi
+00011dc0: 6e67 2074 6f20 7669 6577 2061 2064 6972  ng to view a dir
+00011dd0: 6563 746f 7279 2069 6e64 6578 3a0a 0a7c  ectory index:..|
+00011de0: 2062 726f 7773 6572 207c 2077 696c 6c20   browser | will 
+00011df0: 6974 2062 6c65 6e64 207c 0a7c 202d 2d2d  it blend |.| ---
+00011e00: 2d2d 2d2d 207c 202d 2d2d 2d2d 2d2d 2d2d  ---- | ---------
+00011e10: 2d2d 2d2d 207c 0a7c 202a 2a6c 696e 6b73  ---- |.| **links
+00011e20: 2a2a 2028 322e 3231 2f6d 6163 706f 7274  ** (2.21/macport
+00011e30: 7329 207c 2063 616e 2062 726f 7773 652c  s) | can browse,
+00011e40: 206c 6f67 696e 2c20 7570 6c6f 6164 2f6d   login, upload/m
+00011e50: 6b64 6972 2f6d 7367 207c 0a7c 202a 2a6c  kdir/msg |.| **l
+00011e60: 796e 782a 2a20 2832 2e38 2e39 2f6d 6163  ynx** (2.8.9/mac
+00011e70: 706f 7274 7329 207c 2063 616e 2062 726f  ports) | can bro
+00011e80: 7773 652c 206c 6f67 696e 2c20 7570 6c6f  wse, login, uplo
+00011e90: 6164 2f6d 6b64 6972 2f6d 7367 207c 0a7c  ad/mkdir/msg |.|
+00011ea0: 202a 2a77 336d 2a2a 2028 302e 352e 332f   **w3m** (0.5.3/
+00011eb0: 6d61 6370 6f72 7473 2920 207c 2063 616e  macports)  | can
+00011ec0: 2062 726f 7773 652c 206c 6f67 696e 2c20   browse, login, 
+00011ed0: 7570 6c6f 6164 2061 7420 3130 306b 422f  upload at 100kB/
+00011ee0: 732c 206d 6b64 6972 2f6d 7367 207c 0a7c  s, mkdir/msg |.|
+00011ef0: 202a 2a6e 6574 7375 7266 2a2a 2028 332e   **netsurf** (3.
+00011f00: 3130 2f61 7263 6829 2020 207c 2069 7320  10/arch)   | is 
+00011f10: 6261 7369 6361 6c6c 7920 6965 3620 7769  basically ie6 wi
+00011f20: 7468 206d 7563 6820 6265 7474 6572 2063  th much better c
+00011f30: 7373 2028 6a61 7661 7363 7269 7074 2068  ss (javascript h
+00011f40: 6173 2061 6c6d 6f73 7420 6e6f 2065 6666  as almost no eff
+00011f50: 6563 7429 207c 200a 7c20 2a2a 6f70 6572  ect) | .| **oper
+00011f60: 612a 2a20 2831 312e 3630 2f77 696e 7870  a** (11.60/winxp
+00011f70: 2920 2020 7c20 4f4b 3a20 7468 756d 626e  )   | OK: thumbn
+00011f80: 6169 6c73 2c20 696d 6167 652d 7669 6577  ails, image-view
+00011f90: 6572 2c20 7a69 702d 7365 6c65 6374 696f  er, zip-selectio
+00011fa0: 6e2c 2072 656e 616d 652f 6375 742f 7061  n, rename/cut/pa
+00011fb0: 7374 652e 204e 473a 2075 7032 6b2c 206e  ste. NG: up2k, n
+00011fc0: 6176 7061 6e65 2c20 6d61 726b 646f 776e  avpane, markdown
+00011fd0: 2c20 6175 6469 6f20 7c0a 7c20 2a2a 6965  , audio |.| **ie
+00011fe0: 342a 2a20 616e 6420 2a2a 6e65 7473 6361  4** and **netsca
+00011ff0: 7065 2a2a 2034 2e30 2020 7c20 6361 6e20  pe** 4.0  | can 
+00012000: 6272 6f77 7365 2c20 7570 6c6f 6164 2077  browse, upload w
+00012010: 6974 6820 603f 623d 7560 2c20 6175 7468  ith `?b=u`, auth
+00012020: 2077 6974 6820 6026 7077 3d77 6172 6b60   with `&pw=wark`
+00012030: 207c 0a7c 202a 2a6e 6373 6120 6d6f 7361   |.| **ncsa mosa
+00012040: 6963 2a2a 2032 2e37 2020 2020 2020 207c  ic** 2.7       |
+00012050: 2064 6f65 7320 6e6f 7420 6765 7420 6120   does not get a 
+00012060: 7061 7373 2c20 5b70 6963 315d 2868 7474  pass, [pic1](htt
+00012070: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+00012080: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+00012090: 6e74 2e63 6f6d 2f32 3431 3033 322f 3137  nt.com/241032/17
+000120a0: 3431 3839 3232 372d 6165 3831 3630 3236  4189227-ae816026
+000120b0: 2d63 6636 662d 3462 6535 2d61 3236 652d  -cf6f-4be5-a26e-
+000120c0: 3162 3362 3037 3263 3162 3266 2e70 6e67  1b3b072c1b2f.png
+000120d0: 2920 2d20 5b70 6963 325d 2868 7474 7073  ) - [pic2](https
+000120e0: 3a2f 2f75 7365 722d 696d 6167 6573 2e67  ://user-images.g
+000120f0: 6974 6875 6275 7365 7263 6f6e 7465 6e74  ithubusercontent
+00012100: 2e63 6f6d 2f32 3431 3033 322f 3137 3431  .com/241032/1741
+00012110: 3839 3232 352d 3536 3531 6330 3539 2d35  89225-5651c059-5
+00012120: 3135 322d 3436 6539 2d61 6332 362d 3765  152-46e9-ac26-7e
+00012130: 3938 6534 3937 3930 3162 2e70 6e67 2920  98e497901b.png) 
+00012140: 7c0a 7c20 2a2a 5365 7265 6e69 7479 4f53  |.| **SerenityOS
+00012150: 2a2a 2028 3765 3938 3435 3729 2020 7c20  ** (7e98457)  | 
+00012160: 6869 7473 2061 2070 6167 6520 6661 756c  hits a page faul
+00012170: 742c 2077 6f72 6b73 2077 6974 6820 603f  t, works with `?
+00012180: 623d 7560 2c20 6669 6c65 2075 706c 6f61  b=u`, file uploa
+00012190: 6420 6e6f 742d 696d 706c 207c 0a0a 0a23  d not-impl |...#
+000121a0: 2063 6c69 656e 7420 6578 616d 706c 6573   client examples
+000121b0: 0a0a 696e 7465 7261 6374 2077 6974 6820  ..interact with 
+000121c0: 636f 7079 7061 7274 7920 7573 696e 6720  copyparty using 
+000121d0: 6e6f 6e2d 6272 6f77 7365 7220 636c 6965  non-browser clie
+000121e0: 6e74 730a 0a2a 206a 6176 6173 6372 6970  nts..* javascrip
+000121f0: 743a 2064 756d 7020 736f 6d65 2073 7461  t: dump some sta
+00012200: 7465 2069 6e74 6f20 6120 6669 6c65 2028  te into a file (
+00012210: 7477 6f20 7365 7061 7261 7465 2065 7861  two separate exa
+00012220: 6d70 6c65 7329 0a20 202a 2060 6177 6169  mples).  * `awai
+00012230: 7420 6665 7463 6828 272f 2f31 3237 2e30  t fetch('//127.0
+00012240: 2e30 2e31 3a33 3932 332f 272c 207b 6d65  .0.1:3923/', {me
+00012250: 7468 6f64 3a22 5055 5422 2c20 626f 6479  thod:"PUT", body
+00012260: 3a20 4a53 4f4e 2e73 7472 696e 6769 6679  : JSON.stringify
+00012270: 2866 6f6f 297d 293b 600a 2020 2a20 6076  (foo)});`.  * `v
+00012280: 6172 2078 6872 203d 206e 6577 2058 4d4c  ar xhr = new XML
+00012290: 4874 7470 5265 7175 6573 7428 293b 2078  HttpRequest(); x
+000122a0: 6872 2e6f 7065 6e28 2750 4f53 5427 2c20  hr.open('POST', 
+000122b0: 272f 2f31 3237 2e30 2e30 2e31 3a33 3932  '//127.0.0.1:392
+000122c0: 332f 6d73 6773 3f72 6177 2729 3b20 7868  3/msgs?raw'); xh
+000122d0: 722e 7365 6e64 2827 666f 6f27 293b 600a  r.send('foo');`.
+000122e0: 0a2a 2063 7572 6c2f 7767 6574 3a20 7570  .* curl/wget: up
+000122f0: 6c6f 6164 2073 6f6d 6520 6669 6c65 7320  load some files 
+00012300: 2870 6f73 743d 6669 6c65 2c20 6368 756e  (post=file, chun
+00012310: 6b3d 7374 6469 6e29 0a20 202a 2060 706f  k=stdin).  * `po
+00012320: 7374 2829 7b20 6375 726c 202d 4620 6163  st(){ curl -F ac
+00012330: 743d 6270 7574 202d 4620 663d 4022 2431  t=bput -F f=@"$1
+00012340: 2220 6874 7470 3a2f 2f31 3237 2e30 2e30  " http://127.0.0
+00012350: 2e31 3a33 3932 332f 3f70 773d 7761 726b  .1:3923/?pw=wark
+00012360: 3b7d 6020 200a 2020 2020 6070 6f73 7420  ;}`  .    `post 
+00012370: 6d6f 7669 652e 6d6b 7660 0a20 202a 2060  movie.mkv`.  * `
+00012380: 706f 7374 2829 7b20 6375 726c 202d 4820  post(){ curl -H 
+00012390: 7077 3a77 6172 6b20 2d48 2072 616e 643a  pw:wark -H rand:
+000123a0: 3820 2d54 2022 2431 2220 6874 7470 3a2f  8 -T "$1" http:/
+000123b0: 2f31 3237 2e30 2e30 2e31 3a33 3932 332f  /127.0.0.1:3923/
+000123c0: 3b7d 6020 200a 2020 2020 6070 6f73 7420  ;}`  .    `post 
+000123d0: 6d6f 7669 652e 6d6b 7660 0a20 202a 2060  movie.mkv`.  * `
+000123e0: 706f 7374 2829 7b20 7767 6574 202d 2d68  post(){ wget --h
+000123f0: 6561 6465 723d 2770 773a 2077 6172 6b27  eader='pw: wark'
+00012400: 202d 2d70 6f73 742d 6669 6c65 3d22 2431   --post-file="$1
+00012410: 2220 2d4f 2d20 6874 7470 3a2f 2f31 3237  " -O- http://127
+00012420: 2e30 2e30 2e31 3a33 3932 332f 3f72 6177  .0.0.1:3923/?raw
+00012430: 3b7d 6020 200a 2020 2020 6070 6f73 7420  ;}`  .    `post 
+00012440: 6d6f 7669 652e 6d6b 7660 0a20 202a 2060  movie.mkv`.  * `
+00012450: 6368 756e 6b28 297b 2063 7572 6c20 2d48  chunk(){ curl -H
+00012460: 2070 773a 7761 726b 202d 542d 2068 7474   pw:wark -T- htt
+00012470: 703a 2f2f 3132 372e 302e 302e 313a 3339  p://127.0.0.1:39
+00012480: 3233 2f3b 7d60 2020 0a20 2020 2060 6368  23/;}`  .    `ch
+00012490: 756e 6b20 3c6d 6f76 6965 2e6d 6b76 600a  unk <movie.mkv`.
+000124a0: 0a2a 2062 6173 683a 2077 6865 6e20 6375  .* bash: when cu
+000124b0: 726c 2061 6e64 2077 6765 7420 6973 206e  rl and wget is n
+000124c0: 6f74 2061 7661 696c 6162 6c65 206f 7220  ot available or 
+000124d0: 746f 6f20 626f 7269 6e67 0a20 202a 2060  too boring.  * `
+000124e0: 2870 7269 6e74 6620 2750 5554 202f 6a75  (printf 'PUT /ju
+000124f0: 6e6b 3f70 773d 7761 726b 2048 5454 502f  nk?pw=wark HTTP/
+00012500: 312e 315c 725c 6e5c 725c 6e27 3b20 6361  1.1\r\n\r\n'; ca
+00012510: 7420 6d6f 7669 652e 6d6b 7629 207c 206e  t movie.mkv) | n
+00012520: 6320 3132 372e 302e 302e 3120 3339 3233  c 127.0.0.1 3923
+00012530: 600a 2020 2a20 6028 7072 696e 7466 2027  `.  * `(printf '
+00012540: 5055 5420 2f20 4854 5450 2f31 2e31 5c72  PUT / HTTP/1.1\r
+00012550: 5c6e 5c72 5c6e 273b 2063 6174 206d 6f76  \n\r\n'; cat mov
+00012560: 6965 2e6d 6b76 2920 3e2f 6465 762f 7463  ie.mkv) >/dev/tc
+00012570: 702f 3132 372e 302e 302e 312f 3339 3233  p/127.0.0.1/3923
+00012580: 600a 0a2a 2070 7974 686f 6e3a 205b 7570  `..* python: [up
+00012590: 326b 2e70 795d 2868 7474 7073 3a2f 2f67  2k.py](https://g
+000125a0: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
+000125b0: 6f70 7970 6172 7479 2f62 6c6f 622f 686f  opyparty/blob/ho
+000125c0: 7675 6473 7472 6175 6d2f 6269 6e2f 7570  vudstraum/bin/up
+000125d0: 326b 2e70 7929 2069 7320 6120 636f 6d6d  2k.py) is a comm
+000125e0: 616e 642d 6c69 6e65 2075 7032 6b20 636c  and-line up2k cl
+000125f0: 6965 6e74 205b 2877 6562 6d29 5d28 6874  ient [(webm)](ht
+00012600: 7470 733a 2f2f 6f63 762e 6d65 2f73 7475  tps://ocv.me/stu
+00012610: 6666 2f75 3263 6c69 2e77 6562 6d29 0a20  ff/u2cli.webm). 
+00012620: 202a 2066 696c 6520 7570 6c6f 6164 732c   * file uploads,
+00012630: 2066 696c 652d 7365 6172 6368 2c20 5b66   file-search, [f
+00012640: 6f6c 6465 7220 7379 6e63 5d28 2366 6f6c  older sync](#fol
+00012650: 6465 722d 7379 6e63 292c 2061 7574 6f72  der-sync), autor
+00012660: 6573 756d 6520 6f66 2061 626f 7274 6564  esume of aborted
+00012670: 2f62 726f 6b65 6e20 7570 6c6f 6164 730a  /broken uploads.
+00012680: 2020 2a20 6361 6e20 6265 2064 6f77 6e6c    * can be downl
+00012690: 6f61 6465 6420 6672 6f6d 2063 6f70 7970  oaded from copyp
+000126a0: 6172 7479 3a20 636f 6e74 726f 6c70 616e  arty: controlpan
+000126b0: 656c 202d 3e20 636f 6e6e 6563 7420 2d3e  el -> connect ->
+000126c0: 205b 7570 326b 2e70 795d 2868 7474 703a   [up2k.py](http:
+000126d0: 2f2f 3132 372e 302e 302e 313a 3339 3233  //127.0.0.1:3923
+000126e0: 2f2e 6370 722f 612f 7570 326b 2e70 7929  /.cpr/a/up2k.py)
+000126f0: 0a20 202a 2073 6565 205b 2e2f 6269 6e2f  .  * see [./bin/
+00012700: 5245 4144 4d45 2e6d 6423 7570 326b 7079  README.md#up2kpy
+00012710: 5d28 6269 6e2f 5245 4144 4d45 2e6d 6423  ](bin/README.md#
+00012720: 7570 326b 7079 290a 0a2a 2046 5553 453a  up2kpy)..* FUSE:
+00012730: 206d 6f75 6e74 2061 2063 6f70 7970 6172   mount a copypar
+00012740: 7479 2073 6572 7665 7220 6173 2061 206c  ty server as a l
+00012750: 6f63 616c 2066 696c 6573 7973 7465 6d0a  ocal filesystem.
+00012760: 2020 2a20 6372 6f73 732d 706c 6174 666f    * cross-platfo
+00012770: 726d 2070 7974 686f 6e20 636c 6965 6e74  rm python client
+00012780: 2061 7661 696c 6162 6c65 2069 6e20 5b2e   available in [.
+00012790: 2f62 696e 2f5d 2862 696e 2f29 0a20 202a  /bin/](bin/).  *
+000127a0: 2063 616e 2062 6520 646f 776e 6c6f 6164   can be download
+000127b0: 6564 2066 726f 6d20 636f 7079 7061 7274  ed from copypart
+000127c0: 793a 2063 6f6e 7472 6f6c 7061 6e65 6c20  y: controlpanel 
+000127d0: 2d3e 2063 6f6e 6e65 6374 202d 3e20 5b70  -> connect -> [p
+000127e0: 6172 7479 6675 7365 2e70 795d 2868 7474  artyfuse.py](htt
+000127f0: 703a 2f2f 3132 372e 302e 302e 313a 3339  p://127.0.0.1:39
+00012800: 3233 2f2e 6370 722f 612f 7061 7274 7966  23/.cpr/a/partyf
+00012810: 7573 652e 7079 290a 2020 2a20 5b72 636c  use.py).  * [rcl
+00012820: 6f6e 655d 2868 7474 7073 3a2f 2f72 636c  one](https://rcl
+00012830: 6f6e 652e 6f72 672f 2920 6173 2063 6c69  one.org/) as cli
+00012840: 656e 7420 6361 6e20 6769 7665 207e 3578  ent can give ~5x
+00012850: 2070 6572 666f 726d 616e 6365 2c20 7365   performance, se
+00012860: 6520 5b2e 2f64 6f63 732f 7263 6c6f 6e65  e [./docs/rclone
+00012870: 2e6d 645d 2864 6f63 732f 7263 6c6f 6e65  .md](docs/rclone
+00012880: 2e6d 6429 0a0a 2a20 7368 6172 6578 2028  .md)..* sharex (
+00012890: 7363 7265 656e 7368 6f74 2075 7469 6c69  screenshot utili
+000128a0: 7479 293a 2073 6565 205b 2e2f 636f 6e74  ty): see [./cont
+000128b0: 7269 622f 7368 6172 6578 2e73 7863 755d  rib/sharex.sxcu]
+000128c0: 2863 6f6e 7472 6962 2f23 7368 6172 6578  (contrib/#sharex
+000128d0: 7378 6375 290a 0a63 6f70 7970 6172 7479  sxcu)..copyparty
+000128e0: 2072 6574 7572 6e73 2061 2074 7275 6e63   returns a trunc
+000128f0: 6174 6564 2073 6861 3531 3273 756d 206f  ated sha512sum o
+00012900: 6620 796f 7572 2050 5554 2f50 4f53 5420  f your PUT/POST 
+00012910: 6173 2062 6173 6536 343b 2079 6f75 2063  as base64; you c
+00012920: 616e 2067 656e 6572 6174 6520 7468 6520  an generate the 
+00012930: 7361 6d65 2063 6865 636b 7375 6d20 6c6f  same checksum lo
+00012940: 6361 6c6c 7920 746f 2076 6572 6966 7920  cally to verify 
+00012950: 7570 6c61 6f64 733a 0a0a 2020 2020 6235  uplaods:..    b5
+00012960: 3132 2829 7b20 7072 696e 7466 2022 2428  12(){ printf "$(
+00012970: 2873 6861 3531 3273 756d 7c7c 7368 6173  (sha512sum||shas
+00012980: 756d 202d 6135 3132 297c 7365 6420 2d45  um -a512)|sed -E
+00012990: 2027 732f 202e 2a2f 2f3b 732f 282e 2e29   's/ .*//;s/(..)
+000129a0: 2f5c 5c78 5c31 2f67 2729 227c 6261 7365  /\\x\1/g')"|base
+000129b0: 3634 7c74 7220 272b 2f27 2027 2d5f 277c  64|tr '+/' '-_'|
+000129c0: 6865 6164 202d 6334 343b 7d0a 2020 2020  head -c44;}.    
+000129d0: 6235 3132 203c 6d6f 7669 652e 6d6b 760a  b512 <movie.mkv.
+000129e0: 0a79 6f75 2063 616e 2070 726f 7669 6465  .you can provide
+000129f0: 2070 6173 7377 6f72 6473 2075 7369 6e67   passwords using
+00012a00: 2068 6561 6465 7220 6050 573a 2068 756e   header `PW: hun
+00012a10: 7465 7232 602c 2063 6f6f 6b69 6520 6063  ter2`, cookie `c
+00012a20: 7070 7764 3d68 756e 7465 7232 602c 2075  ppwd=hunter2`, u
+00012a30: 726c 2d70 6172 616d 2060 3f70 773d 6875  rl-param `?pw=hu
+00012a40: 6e74 6572 3260 2c20 6f72 2077 6974 6820  nter2`, or with 
+00012a50: 6261 7369 632d 6175 7468 656e 7469 6361  basic-authentica
+00012a60: 7469 6f6e 2028 6569 7468 6572 2061 7320  tion (either as 
+00012a70: 7468 6520 7573 6572 6e61 6d65 206f 7220  the username or 
+00012a80: 7061 7373 776f 7264 290a 0a4e 4f54 453a  password)..NOTE:
+00012a90: 2063 7572 6c20 7769 6c6c 206e 6f74 2073   curl will not s
+00012aa0: 656e 6420 7468 6520 6f72 6967 696e 616c  end the original
+00012ab0: 2066 696c 656e 616d 6520 6966 2079 6f75   filename if you
+00012ac0: 2075 7365 2060 2d54 6020 636f 6d62 696e   use `-T` combin
+00012ad0: 6564 2077 6974 6820 7572 6c2d 7061 7261  ed with url-para
+00012ae0: 6d73 2120 416c 736f 2c20 6d61 6b65 2073  ms! Also, make s
+00012af0: 7572 6520 746f 2061 6c77 6179 7320 6c65  ure to always le
+00012b00: 6176 6520 6120 7472 6169 6c69 6e67 2073  ave a trailing s
+00012b10: 6c61 7368 2069 6e20 5552 4c73 2075 6e6c  lash in URLs unl
+00012b20: 6573 7320 796f 7520 7761 6e74 2074 6f20  ess you want to 
+00012b30: 6f76 6572 7269 6465 2074 6865 2066 696c  override the fil
+00012b40: 656e 616d 650a 0a0a 2323 2066 6f6c 6465  ename...## folde
+00012b50: 7220 7379 6e63 0a0a 7379 6e63 2066 6f6c  r sync..sync fol
+00012b60: 6465 7273 2074 6f2f 6672 6f6d 2063 6f70  ders to/from cop
+00012b70: 7970 6172 7479 0a0a 7468 6520 636f 6d6d  yparty..the comm
+00012b80: 616e 646c 696e 6520 7570 6c6f 6164 6572  andline uploader
+00012b90: 205b 7570 326b 2e70 795d 2868 7474 7073   [up2k.py](https
+00012ba0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00012bb0: 3031 2f63 6f70 7970 6172 7479 2f74 7265  01/copyparty/tre
+00012bc0: 652f 686f 7675 6473 7472 6175 6d2f 6269  e/hovudstraum/bi
+00012bd0: 6e23 7570 326b 7079 2920 7769 7468 2060  n#up2kpy) with `
+00012be0: 2d2d 6472 6020 6973 2074 6865 2062 6573  --dr` is the bes
+00012bf0: 7420 7761 7920 746f 2073 796e 6320 6120  t way to sync a 
+00012c00: 666f 6c64 6572 2074 6f20 636f 7079 7061  folder to copypa
+00012c10: 7274 793b 2076 6572 6966 6965 7320 6368  rty; verifies ch
+00012c20: 6563 6b73 756d 7320 616e 6420 646f 6573  ecksums and does
+00012c30: 2066 696c 6573 2069 6e20 7061 7261 6c6c   files in parall
+00012c40: 656c 2c20 616e 6420 6465 6c65 7465 7320  el, and deletes 
+00012c50: 756e 6578 7065 6374 6564 2066 696c 6573  unexpected files
+00012c60: 206f 6e20 7468 6520 7365 7276 6572 2061   on the server a
+00012c70: 6674 6572 2075 706c 6f61 6420 6861 7320  fter upload has 
+00012c80: 6669 6e69 7368 6564 2077 6869 6368 206d  finished which m
+00012c90: 616b 6573 2066 696c 652d 7265 6e61 6d65  akes file-rename
+00012ca0: 7320 7265 616c 6c79 2063 6865 6170 2028  s really cheap (
+00012cb0: 6974 276c 6c20 7265 6e61 6d65 2073 6572  it'll rename ser
+00012cc0: 7665 7273 6964 6520 616e 6420 736b 6970  verside and skip
+00012cd0: 2075 706c 6f61 6469 6e67 290a 0a61 6c74   uploading)..alt
+00012ce0: 6572 6e61 7469 7665 6c79 2074 6865 7265  ernatively there
+00012cf0: 2069 7320 5b72 636c 6f6e 655d 282e 2f64   is [rclone](./d
+00012d00: 6f63 732f 7263 6c6f 6e65 2e6d 6429 2077  ocs/rclone.md) w
+00012d10: 6869 6368 2061 6c6c 6f77 7320 666f 7220  hich allows for 
+00012d20: 6269 6469 7265 6374 696f 6e61 6c20 7379  bidirectional sy
+00012d30: 6e63 2061 6e64 2069 7320 2a77 6179 2a20  nc and is *way* 
+00012d40: 6d6f 7265 2066 6c65 7869 626c 6520 2873  more flexible (s
+00012d50: 7472 6561 6d20 6669 6c65 7320 7374 7261  tream files stra
+00012d60: 6967 6874 2066 726f 6d20 7366 7470 2f73  ight from sftp/s
+00012d70: 332f 6763 7320 746f 2063 6f70 7970 6172  3/gcs to copypar
+00012d80: 7479 2c20 2e2e 2e29 2c20 616c 7468 6f75  ty, ...), althou
+00012d90: 6768 2074 6865 7265 2069 7320 6e6f 2069  gh there is no i
+00012da0: 6e74 6567 7269 7479 2063 6865 636b 2061  ntegrity check a
+00012db0: 6e64 2069 7420 776f 6e27 7420 776f 726b  nd it won't work
+00012dc0: 2077 6974 6820 6669 6c65 7320 6f76 6572   with files over
+00012dd0: 2031 3030 204d 6942 2069 6620 636f 7079   100 MiB if copy
+00012de0: 7061 7274 7920 6973 2062 6568 696e 6420  party is behind 
+00012df0: 636c 6f75 6466 6c61 7265 0a0a 2a20 7374  cloudflare..* st
+00012e00: 6172 7469 6e67 2066 726f 6d20 7263 6c6f  arting from rclo
+00012e10: 6e65 2076 312e 3633 2028 6375 7272 656e  ne v1.63 (curren
+00012e20: 746c 7920 5b69 6e20 6265 7461 5d28 6874  tly [in beta](ht
+00012e30: 7470 733a 2f2f 6265 7461 2e72 636c 6f6e  tps://beta.rclon
+00012e40: 652e 6f72 672f 3f66 696c 7465 723d 6c61  e.org/?filter=la
+00012e50: 7465 7374 2929 2c20 7263 6c6f 6e65 2077  test)), rclone w
+00012e60: 696c 6c20 616c 736f 2062 6520 6661 7374  ill also be fast
+00012e70: 6572 2074 6861 6e20 7570 326b 2e70 790a  er than up2k.py.
+00012e80: 0a0a 2323 206d 6f75 6e74 2061 7320 6472  ..## mount as dr
+00012e90: 6976 650a 0a61 2072 656d 6f74 6520 636f  ive..a remote co
+00012ea0: 7079 7061 7274 7920 7365 7276 6572 2061  pyparty server a
+00012eb0: 7320 6120 6c6f 6361 6c20 6669 6c65 7379  s a local filesy
+00012ec0: 7374 656d 3b20 2067 6f20 746f 2074 6865  stem;  go to the
+00012ed0: 2063 6f6e 7472 6f6c 2d70 616e 656c 2061   control-panel a
+00012ee0: 6e64 2063 6c69 636b 2060 636f 6e6e 6563  nd click `connec
+00012ef0: 7460 2074 6f20 7365 6520 6120 6c69 7374  t` to see a list
+00012f00: 206f 6620 636f 6d6d 616e 6473 2074 6f20   of commands to 
+00012f10: 646f 2074 6861 740a 0a61 6c74 6572 6e61  do that..alterna
+00012f20: 7469 7665 6c79 2c20 736f 6d65 2061 6c74  tively, some alt
+00012f30: 6572 6e61 7469 7665 7320 726f 7567 686c  ernatives roughl
+00012f40: 7920 736f 7274 6564 2062 7920 7370 6565  y sorted by spee
+00012f50: 6420 2875 6e72 6570 726f 6475 6369 626c  d (unreproducibl
+00012f60: 6520 6265 6e63 686d 6172 6b29 2c20 6265  e benchmark), be
+00012f70: 7374 2066 6972 7374 3a0a 0a2a 205b 7263  st first:..* [rc
+00012f80: 6c6f 6e65 2d77 6562 6461 765d 282e 2f64  lone-webdav](./d
+00012f90: 6f63 732f 7263 6c6f 6e65 2e6d 6429 2028  ocs/rclone.md) (
+00012fa0: 3235 7329 2c20 7265 6164 2f57 5249 5445  25s), read/WRITE
+00012fb0: 2028 5b76 312e 3633 2d62 6574 615d 2868   ([v1.63-beta](h
+00012fc0: 7474 7073 3a2f 2f62 6574 612e 7263 6c6f  ttps://beta.rclo
+00012fd0: 6e65 2e6f 7267 2f3f 6669 6c74 6572 3d6c  ne.org/?filter=l
+00012fe0: 6174 6573 7429 290a 2a20 5b72 636c 6f6e  atest)).* [rclon
+00012ff0: 652d 6874 7470 5d28 2e2f 646f 6373 2f72  e-http](./docs/r
+00013000: 636c 6f6e 652e 6d64 2920 2832 3673 292c  clone.md) (26s),
+00013010: 2072 6561 642d 6f6e 6c79 0a2a 205b 7061   read-only.* [pa
+00013020: 7274 7966 7573 652e 7079 5d28 2e2f 6269  rtyfuse.py](./bi
+00013030: 6e2f 2370 6172 7479 6675 7365 7079 2920  n/#partyfusepy) 
+00013040: 2833 3573 292c 2072 6561 642d 6f6e 6c79  (35s), read-only
+00013050: 0a2a 205b 7263 6c6f 6e65 2d66 7470 5d28  .* [rclone-ftp](
+00013060: 2e2f 646f 6373 2f72 636c 6f6e 652e 6d64  ./docs/rclone.md
+00013070: 2920 2834 3773 292c 2072 6561 642f 5752  ) (47s), read/WR
+00013080: 4954 450a 2a20 6461 7666 7332 2028 3130  ITE.* davfs2 (10
+00013090: 3373 292c 2072 6561 642f 5752 4954 452c  3s), read/WRITE,
+000130a0: 202a 7665 7279 2066 6173 742a 206f 6e20   *very fast* on 
+000130b0: 736d 616c 6c20 6669 6c65 730a 2a20 5b77  small files.* [w
+000130c0: 696e 3130 2d77 6562 6461 765d 2823 7765  in10-webdav](#we
+000130d0: 6264 6176 2d73 6572 7665 7229 2028 3133  bdav-server) (13
+000130e0: 3873 292c 2072 6561 642f 5752 4954 450a  8s), read/WRITE.
+000130f0: 2a20 5b77 696e 3130 2d73 6d62 325d 2823  * [win10-smb2](#
+00013100: 736d 622d 7365 7276 6572 2920 2833 3837  smb-server) (387
+00013110: 7329 2c20 7265 6164 2f57 5249 5445 0a0a  s), read/WRITE..
+00013120: 6d6f 7374 2063 6c69 656e 7473 2077 696c  most clients wil
+00013130: 6c20 6661 696c 2074 6f20 6d6f 756e 7420  l fail to mount 
+00013140: 7468 6520 726f 6f74 206f 6620 6120 636f  the root of a co
+00013150: 7079 7061 7274 7920 7365 7276 6572 2075  pyparty server u
+00013160: 6e6c 6573 7320 7468 6572 6520 6973 2061  nless there is a
+00013170: 2072 6f6f 7420 766f 6c75 6d65 2028 736f   root volume (so
+00013180: 2079 6f75 2067 6574 2074 6865 2061 646d   you get the adm
+00013190: 696e 2d70 616e 656c 2069 6e73 7465 6164  in-panel instead
+000131a0: 206f 6620 6120 6272 6f77 7365 7220 7768   of a browser wh
+000131b0: 656e 2061 6363 6573 7369 6e67 2069 7429  en accessing it)
+000131c0: 202d 2d20 696e 2074 6861 7420 6361 7365   -- in that case
+000131d0: 2c20 6d6f 756e 7420 6120 7370 6563 6966  , mount a specif
+000131e0: 6963 2076 6f6c 756d 6520 696e 7374 6561  ic volume instea
+000131f0: 640a 0a0a 2320 616e 6472 6f69 6420 6170  d...# android ap
+00013200: 700a 0a75 706c 6f61 6420 746f 2063 6f70  p..upload to cop
+00013210: 7970 6172 7479 2077 6974 6820 6f6e 6520  yparty with one 
+00013220: 7461 700a 0a3c 6120 6872 6566 3d22 6874  tap..<a href="ht
+00013230: 7470 733a 2f2f 662d 6472 6f69 642e 6f72  tps://f-droid.or
+00013240: 672f 7061 636b 6167 6573 2f6d 652e 6f63  g/packages/me.oc
+00013250: 762e 7061 7274 7975 702f 223e 3c69 6d67  v.partyup/"><img
+00013260: 2073 7263 3d22 6874 7470 733a 2f2f 6f63   src="https://oc
+00013270: 762e 6d65 2f66 6472 6f69 642e 706e 6722  v.me/fdroid.png"
+00013280: 2061 6c74 3d22 4765 7420 6974 206f 6e20   alt="Get it on 
+00013290: 462d 4472 6f69 6422 2068 6569 6768 743d  F-Droid" height=
+000132a0: 2235 3022 202f 3e20 2727 203c 696d 6720  "50" /> '' <img 
+000132b0: 7372 633d 2268 7474 7073 3a2f 2f69 6d67  src="https://img
+000132c0: 2e73 6869 656c 6473 2e69 6f2f 662d 6472  .shields.io/f-dr
+000132d0: 6f69 642f 762f 6d65 2e6f 6376 2e70 6172  oid/v/me.ocv.par
+000132e0: 7479 7570 2e73 7667 2220 616c 743d 2266  tyup.svg" alt="f
+000132f0: 2d64 726f 6964 2076 6572 7369 6f6e 2069  -droid version i
+00013300: 6e66 6f22 202f 3e3c 2f61 3e20 2727 203c  nfo" /></a> '' <
+00013310: 6120 6872 6566 3d22 6874 7470 733a 2f2f  a href="https://
+00013320: 6769 7468 7562 2e63 6f6d 2f39 3030 312f  github.com/9001/
+00013330: 7061 7274 792d 7570 223e 3c69 6d67 2073  party-up"><img s
+00013340: 7263 3d22 6874 7470 733a 2f2f 696d 672e  rc="https://img.
+00013350: 7368 6965 6c64 732e 696f 2f67 6974 6875  shields.io/githu
+00013360: 622f 7265 6c65 6173 652f 3930 3031 2f70  b/release/9001/p
+00013370: 6172 7479 2d75 702e 7376 673f 6c6f 676f  arty-up.svg?logo
+00013380: 3d67 6974 6875 6222 2061 6c74 3d22 6769  =github" alt="gi
+00013390: 7468 7562 2076 6572 7369 6f6e 2069 6e66  thub version inf
+000133a0: 6f22 202f 3e3c 2f61 3e0a 0a74 6865 2061  o" /></a>..the a
+000133b0: 7070 2069 7320 2a2a 4e4f 542a 2a20 7468  pp is **NOT** th
+000133c0: 6520 6675 6c6c 2063 6f70 7970 6172 7479  e full copyparty
+000133d0: 2073 6572 7665 7221 206a 7573 7420 6120   server! just a 
+000133e0: 6261 7369 6320 7570 6c6f 6164 2063 6c69  basic upload cli
+000133f0: 656e 742c 206e 6f74 6869 6e67 2066 616e  ent, nothing fan
+00013400: 6379 2079 6574 0a0a 6966 2079 6f75 2077  cy yet..if you w
+00013410: 616e 7420 746f 2072 756e 2074 6865 2063  ant to run the c
+00013420: 6f70 7970 6172 7479 2073 6572 7665 7220  opyparty server 
+00013430: 6f6e 2079 6f75 7220 616e 6472 6f69 6420  on your android 
+00013440: 6465 7669 6365 2c20 7365 6520 5b69 6e73  device, see [ins
+00013450: 7461 6c6c 206f 6e20 616e 6472 6f69 645d  tall on android]
+00013460: 2823 696e 7374 616c 6c2d 6f6e 2d61 6e64  (#install-on-and
+00013470: 726f 6964 290a 0a0a 2320 694f 5320 7368  roid)...# iOS sh
+00013480: 6f72 7463 7574 730a 0a74 6865 7265 2069  ortcuts..there i
+00013490: 7320 6e6f 2069 5068 6f6e 6520 6170 702c  s no iPhone app,
+000134a0: 2062 7574 2020 7468 6520 666f 6c6c 6f77   but  the follow
+000134b0: 696e 6720 7368 6f72 7463 7574 7320 6172  ing shortcuts ar
+000134c0: 6520 616c 6d6f 7374 2061 7320 676f 6f64  e almost as good
+000134d0: 3a0a 0a2a 205b 7570 6c6f 6164 2074 6f20  :..* [upload to 
+000134e0: 636f 7079 7061 7274 795d 2868 7474 7073  copyparty](https
+000134f0: 3a2f 2f77 7777 2e69 636c 6f75 642e 636f  ://www.icloud.co
+00013500: 6d2f 7368 6f72 7463 7574 732f 3431 6539  m/shortcuts/41e9
+00013510: 3864 6439 3835 6362 3464 3362 6234 3333  8dd985cb4d3bb433
+00013520: 3232 3262 6331 6539 6537 3730 2920 285b  222bc1e9e770) ([
+00013530: 6f66 666c 696e 655d 2868 7474 7073 3a2f  offline](https:/
+00013540: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00013550: 2f63 6f70 7970 6172 7479 2f72 6177 2f68  /copyparty/raw/h
+00013560: 6f76 7564 7374 7261 756d 2f63 6f6e 7472  ovudstraum/contr
+00013570: 6962 2f69 6f73 2f75 706c 6f61 642d 746f  ib/ios/upload-to
+00013580: 2d63 6f70 7970 6172 7479 2e73 686f 7274  -copyparty.short
+00013590: 6375 7429 2920 285b 706e 675d 2868 7474  cut)) ([png](htt
+000135a0: 7073 3a2f 2f75 7365 722d 696d 6167 6573  ps://user-images
+000135b0: 2e67 6974 6875 6275 7365 7263 6f6e 7465  .githubuserconte
+000135c0: 6e74 2e63 6f6d 2f32 3431 3033 322f 3232  nt.com/241032/22
+000135d0: 3631 3138 3035 332d 3738 3632 3335 3534  6118053-78623554
+000135e0: 2d62 3065 642d 3438 3265 2d39 3865 342d  -b0ed-482e-98e4-
+000135f0: 3664 3537 6164 6135 3865 6134 2e70 6e67  6d57ada58ea4.png
+00013600: 2929 2062 6173 6564 206f 6e20 7468 6520  )) based on the 
+00013610: 5b6f 7269 6769 6e61 6c5d 2868 7474 7073  [original](https
+00013620: 3a2f 2f77 7777 2e69 636c 6f75 642e 636f  ://www.icloud.co
+00013630: 6d2f 7368 6f72 7463 7574 732f 6162 3431  m/shortcuts/ab41
+00013640: 3564 3562 3464 6533 3436 3762 3963 6536  5d5b4de3467b9ce6
+00013650: 6631 3531 6234 3339 6135 6437 2920 6279  f151b439a5d7) by
+00013660: 205b 4461 6564 7265 6e5d 2868 7474 7073   [Daedren](https
+00013670: 3a2f 2f67 6974 6875 622e 636f 6d2f 4461  ://github.com/Da
+00013680: 6564 7265 6e29 2028 7468 7821 290a 2020  edren) (thx!).  
+00013690: 2a20 6361 6e20 7374 7269 7020 6578 6966  * can strip exif
+000136a0: 2c20 7570 6c6f 6164 2066 696c 6573 2c20  , upload files, 
+000136b0: 7069 6373 2c20 7669 6473 2c20 6c69 6e6b  pics, vids, link
+000136c0: 732c 2063 6c69 7062 6f61 7264 0a20 202a  s, clipboard.  *
+000136d0: 2063 616e 2064 6f77 6e6c 6f61 6420 6c69   can download li
+000136e0: 6e6b 7320 616e 6420 7265 686f 7374 2074  nks and rehost t
+000136f0: 6865 2074 6172 6765 7420 6669 6c65 206f  he target file o
+00013700: 6e20 636f 7079 7061 7274 7920 2873 6565  n copyparty (see
+00013710: 2066 6972 7374 2063 6f6d 6d65 6e74 2069   first comment i
+00013720: 6e73 6964 6520 7468 6520 7368 6f72 7463  nside the shortc
+00013730: 7574 290a 2020 2a20 7069 6373 2062 6563  ut).  * pics bec
+00013740: 6f6d 6520 6c6f 7772 6573 2069 6620 796f  ome lowres if yo
+00013750: 7520 7368 6172 6520 6672 6f6d 2067 616c  u share from gal
+00013760: 6c65 7279 2074 6f20 7368 6f72 7463 7574  lery to shortcut
+00013770: 2c20 736f 2062 6574 7465 7220 746f 206c  , so better to l
+00013780: 6175 6e63 6820 7468 6520 7368 6f72 7463  aunch the shortc
+00013790: 7574 2061 6e64 2070 6963 6b20 7374 7566  ut and pick stuf
+000137a0: 6620 6672 6f6d 2074 6865 7265 0a0a 0a23  f from there...#
+000137b0: 2070 6572 666f 726d 616e 6365 0a0a 6465   performance..de
+000137c0: 6661 756c 7473 2061 7265 2075 7375 616c  faults are usual
+000137d0: 6c79 2066 696e 6520 2d20 6578 7065 6374  ly fine - expect
+000137e0: 2060 3820 4769 422f 7360 2064 6f77 6e6c   `8 GiB/s` downl
+000137f0: 6f61 642c 2060 3120 4769 422f 7360 2075  oad, `1 GiB/s` u
+00013800: 706c 6f61 640a 0a62 656c 6f77 2061 7265  pload..below are
+00013810: 2073 6f6d 6520 7477 6561 6b73 2072 6f75   some tweaks rou
+00013820: 6768 6c79 206f 7264 6572 6564 2062 7920  ghly ordered by 
+00013830: 7573 6566 756c 6e65 7373 3a0a 0a2a 2060  usefulness:..* `
+00013840: 2d71 6020 6469 7361 626c 6573 206c 6f67  -q` disables log
+00013850: 6769 6e67 2061 6e64 2063 616e 2068 656c  ging and can hel
+00013860: 7020 6120 6275 6e63 682c 2065 7665 6e20  p a bunch, even 
+00013870: 7768 656e 2063 6f6d 6269 6e65 6420 7769  when combined wi
+00013880: 7468 2060 2d6c 6f60 2074 6f20 7265 6469  th `-lo` to redi
+00013890: 7265 6374 206c 6f67 7320 746f 2066 696c  rect logs to fil
+000138a0: 650a 2a20 602d 2d68 6973 7460 2070 6f69  e.* `--hist` poi
+000138b0: 6e74 696e 6720 746f 2061 2066 6173 7420  nting to a fast 
+000138c0: 6c6f 6361 7469 6f6e 2028 7373 6429 2077  location (ssd) w
+000138d0: 696c 6c20 6d61 6b65 2064 6972 6563 746f  ill make directo
+000138e0: 7279 206c 6973 7469 6e67 7320 616e 6420  ry listings and 
+000138f0: 7365 6172 6368 6573 2066 6173 7465 7220  searches faster 
+00013900: 7768 656e 2060 2d65 3264 6020 6f72 2060  when `-e2d` or `
+00013910: 2d65 3274 6020 6973 2073 6574 0a2a 2060  -e2t` is set.* `
+00013920: 2d2d 6e6f 2d68 6173 6820 2e60 2077 6865  --no-hash .` whe
+00013930: 6e20 696e 6465 7869 6e67 2061 206e 6574  n indexing a net
+00013940: 776f 726b 2d64 6973 6b20 6966 2079 6f75  work-disk if you
+00013950: 2064 6f6e 2774 2063 6172 6520 6162 6f75   don't care abou
+00013960: 7420 7468 6520 6163 7475 616c 2066 696c  t the actual fil
+00013970: 6568 6173 6865 7320 616e 6420 6f6e 6c79  ehashes and only
+00013980: 2077 616e 7420 7468 6520 6e61 6d65 732f   want the names/
+00013990: 7461 6773 2073 6561 7263 6861 626c 650a  tags searchable.
+000139a0: 2a20 602d 2d6e 6f2d 6874 7020 2d2d 6861  * `--no-htp --ha
+000139b0: 7368 2d6d 743d 3020 2d2d 6d74 6167 2d6d  sh-mt=0 --mtag-m
+000139c0: 743d 3120 2d2d 7468 2d6d 743d 3160 206d  t=1 --th-mt=1` m
+000139d0: 696e 696d 697a 6573 2074 6865 206e 756d  inimizes the num
+000139e0: 6265 7220 6f66 2074 6872 6561 6473 3b20  ber of threads; 
+000139f0: 6361 6e20 6865 6c70 2069 6e20 736f 6d65  can help in some
+00013a00: 2065 6363 656e 7472 6963 2065 6e76 6972   eccentric envir
+00013a10: 6f6e 6d65 6e74 7320 286c 696b 6520 7468  onments (like th
+00013a20: 6520 7673 636f 6465 2064 6562 7567 6765  e vscode debugge
+00013a30: 7229 0a2a 2060 2d6a 3060 2065 6e61 626c  r).* `-j0` enabl
+00013a40: 6573 206d 756c 7469 7072 6f63 6573 7369  es multiprocessi
+00013a50: 6e67 2028 6163 7475 616c 206d 756c 7469  ng (actual multi
+00013a60: 7468 7265 6164 696e 6729 2c20 6361 6e20  threading), can 
+00013a70: 7265 6475 6365 206c 6174 656e 6379 2074  reduce latency t
+00013a80: 6f20 6032 302b 3830 2f6e 756d 436f 7265  o `20+80/numCore
+00013a90: 7360 2070 6572 6365 6e74 2061 6e64 2067  s` percent and g
+00013aa0: 656e 6572 616c 6c79 2069 6d70 726f 7665  enerally improve
+00013ab0: 2070 6572 666f 726d 616e 6365 2069 6e20   performance in 
+00013ac0: 6370 752d 696e 7465 6e73 6976 6520 776f  cpu-intensive wo
+00013ad0: 726b 6c6f 6164 732c 2066 6f72 2065 7861  rkloads, for exa
+00013ae0: 6d70 6c65 3a0a 2020 2a20 6c6f 7473 206f  mple:.  * lots o
+00013af0: 6620 636f 6e6e 6563 7469 6f6e 7320 286d  f connections (m
+00013b00: 616e 7920 7573 6572 7320 6f72 2068 6561  any users or hea
+00013b10: 7679 2063 6c69 656e 7473 290a 2020 2a20  vy clients).  * 
+00013b20: 7369 6d75 6c74 616e 656f 7573 2064 6f77  simultaneous dow
+00013b30: 6e6c 6f61 6473 2061 6e64 2075 706c 6f61  nloads and uploa
+00013b40: 6473 2073 6174 7572 6174 696e 6720 6120  ds saturating a 
+00013b50: 3230 6762 7073 2063 6f6e 6e65 6374 696f  20gbps connectio
+00013b60: 6e0a 2020 0a20 202e 2e2e 686f 7765 7665  n.  .  ...howeve
+00013b70: 7220 6974 2061 6464 7320 616e 206f 7665  r it adds an ove
+00013b80: 7268 6561 6420 746f 2069 6e74 6572 6e61  rhead to interna
+00013b90: 6c20 636f 6d6d 756e 6963 6174 696f 6e20  l communication 
+00013ba0: 736f 2069 7420 6d69 6768 7420 6265 2061  so it might be a
+00013bb0: 206e 6574 206c 6f73 732c 2073 6565 2069   net loss, see i
+00013bc0: 6620 6974 2077 6f72 6b73 2034 2075 0a2a  f it works 4 u.*
+00013bd0: 2075 7369 6e67 205b 7079 7079 5d28 6874   using [pypy](ht
+00013be0: 7470 733a 2f2f 7777 772e 7079 7079 2e6f  tps://www.pypy.o
+00013bf0: 7267 2f29 2069 6e73 7465 6164 206f 6620  rg/) instead of 
+00013c00: 5b63 7079 7468 6f6e 5d28 6874 7470 733a  [cpython](https:
+00013c10: 2f2f 7777 772e 7079 7468 6f6e 2e6f 7267  //www.python.org
+00013c20: 2f29 202a 6361 6e2a 2062 6520 3730 2520  /) *can* be 70% 
+00013c30: 6661 7374 6572 2066 6f72 2073 6f6d 6520  faster for some 
+00013c40: 776f 726b 6c6f 6164 732c 2062 7574 2073  workloads, but s
+00013c50: 6c6f 7765 7220 666f 7220 6d61 6e79 206f  lower for many o
+00013c60: 7468 6572 730a 2020 2a20 616e 6420 7079  thers.  * and py
+00013c70: 7079 2063 616e 2073 6f6d 6574 696d 6573  py can sometimes
+00013c80: 2063 7261 7368 206f 6e20 7374 6172 7475   crash on startu
+00013c90: 7020 7769 7468 2060 2d6a 3060 2028 544f  p with `-j0` (TO
+00013ca0: 444f 206d 616b 6520 6973 7375 6529 0a0a  DO make issue)..
+00013cb0: 0a23 2320 636c 6965 6e74 2d73 6964 650a  .## client-side.
+00013cc0: 0a77 6865 6e20 7570 6c6f 6164 696e 6720  .when uploading 
+00013cd0: 6669 6c65 732c 0a0a 2a20 6368 726f 6d65  files,..* chrome
+00013ce0: 2069 7320 7265 636f 6d6d 656e 6465 642c   is recommended,
+00013cf0: 2061 7420 6c65 6173 7420 636f 6d70 6172   at least compar
+00013d00: 6564 2074 6f20 6669 7265 666f 783a 0a20  ed to firefox:. 
+00013d10: 202a 2075 7020 746f 2039 3025 2066 6173   * up to 90% fas
+00013d20: 7465 7220 7768 656e 2068 6173 6869 6e67  ter when hashing
+00013d30: 2c20 6573 7065 6369 616c 6c79 206f 6e20  , especially on 
+00013d40: 5353 4473 0a20 202a 2075 7020 746f 2034  SSDs.  * up to 4
+00013d50: 3025 2066 6173 7465 7220 7768 656e 2075  0% faster when u
+00013d60: 706c 6f61 6469 6e67 206f 7665 7220 6578  ploading over ex
+00013d70: 7472 656d 656c 7920 6661 7374 2069 6e74  tremely fast int
+00013d80: 6572 6e65 7473 0a20 202a 2062 7574 205b  ernets.  * but [
+00013d90: 7570 326b 2e70 795d 2868 7474 7073 3a2f  up2k.py](https:/
+00013da0: 2f67 6974 6875 622e 636f 6d2f 3930 3031  /github.com/9001
+00013db0: 2f63 6f70 7970 6172 7479 2f62 6c6f 622f  /copyparty/blob/
+00013dc0: 686f 7675 6473 7472 6175 6d2f 6269 6e2f  hovudstraum/bin/
+00013dd0: 7570 326b 2e70 7929 2063 616e 2062 6520  up2k.py) can be 
+00013de0: 3430 2520 6661 7374 6572 2074 6861 6e20  40% faster than 
+00013df0: 6368 726f 6d65 2061 6761 696e 0a0a 2a20  chrome again..* 
+00013e00: 6966 2079 6f75 2772 6520 6370 752d 626f  if you're cpu-bo
+00013e10: 7474 6c65 6e65 636b 6564 2c20 6f72 2074  ttlenecked, or t
+00013e20: 6865 2062 726f 7773 6572 2069 7320 6d61  he browser is ma
+00013e30: 7869 6e67 2061 2063 7075 2063 6f72 653a  xing a cpu core:
+00013e40: 0a20 202a 2075 7020 746f 2033 3025 2066  .  * up to 30% f
+00013e50: 6173 7465 7220 7570 6c6f 6164 7320 6966  aster uploads if
+00013e60: 2079 6f75 2068 6964 6520 7468 6520 7570   you hide the up
+00013e70: 6c6f 6164 2073 7461 7475 7320 6c69 7374  load status list
+00013e80: 2062 7920 7377 6974 6368 696e 6720 6177   by switching aw
+00013e90: 6179 2066 726f 6d20 7468 6520 605b f09f  ay from the `[..
+00013ea0: 9a80 5d60 2075 7032 6b20 7569 2d74 6162  ..]` up2k ui-tab
+00013eb0: 2028 6f72 2063 6c6f 7369 6e67 2069 7429   (or closing it)
+00013ec0: 0a20 2020 202a 206f 7074 696f 6e61 6c6c  .    * optionall
+00013ed0: 7920 796f 7520 6361 6e20 7377 6974 6368  y you can switch
+00013ee0: 2074 6f20 7468 6520 6c69 6768 7477 6569   to the lightwei
+00013ef0: 6768 7420 706f 7461 746f 2075 6920 6279  ght potato ui by
+00013f00: 2063 6c69 636b 696e 6720 7468 6520 605b   clicking the `[
+00013f10: f09f a594 5d60 0a20 2020 202a 2073 7769  ....]`.    * swi
+00013f20: 7463 6869 6e67 2074 6f20 616e 6f74 6865  tching to anothe
+00013f30: 7220 6272 6f77 7365 722d 7461 6220 616c  r browser-tab al
+00013f40: 736f 2077 6f72 6b73 2c20 7468 6520 6661  so works, the fa
+00013f50: 7669 636f 6e20 7769 6c6c 2075 7064 6174  vicon will updat
+00013f60: 6520 6576 6572 7920 3130 2073 6563 6f6e  e every 10 secon
+00013f70: 6473 2069 6e20 7468 6174 2063 6173 650a  ds in that case.
+00013f80: 2020 2a20 756e 6c69 6b65 6c79 2074 6f20    * unlikely to 
+00013f90: 6265 2061 2070 726f 626c 656d 2c20 6275  be a problem, bu
+00013fa0: 7420 6361 6e20 6861 7070 656e 2077 6865  t can happen whe
+00013fb0: 6e20 7570 6c6f 6469 6e67 206d 616e 7920  n uploding many 
+00013fc0: 736d 616c 6c20 6669 6c65 732c 206f 7220  small files, or 
+00013fd0: 796f 7572 2069 6e74 6572 6e65 7420 6973  your internet is
+00013fe0: 2074 6f6f 2066 6173 742c 206f 7220 5043   too fast, or PC
+00013ff0: 2074 6f6f 2073 6c6f 770a 0a0a 2320 7365   too slow...# se
+00014000: 6375 7269 7479 0a0a 736f 6d65 206e 6f74  curity..some not
+00014010: 6573 206f 6e20 6861 7264 656e 696e 670a  es on hardening.
+00014020: 0a2a 2073 6574 2060 2d2d 7270 726f 7879  .* set `--rproxy
+00014030: 2030 6020 6966 2079 6f75 7220 636f 7079   0` if your copy
+00014040: 7061 7274 7920 6973 2064 6972 6563 746c  party is directl
+00014050: 7920 6661 6369 6e67 2074 6865 2069 6e74  y facing the int
+00014060: 6572 6e65 7420 286e 6f74 2074 6872 6f75  ernet (not throu
+00014070: 6768 2061 2072 6576 6572 7365 2d70 726f  gh a reverse-pro
+00014080: 7879 290a 2020 2a20 636f 7273 2064 6f65  xy).  * cors doe
+00014090: 736e 2774 2077 6f72 6b20 7269 6768 7420  sn't work right 
+000140a0: 6f74 6865 7277 6973 650a 0a73 6166 6574  otherwise..safet
+000140b0: 7920 7072 6f66 696c 6573 3a0a 0a2a 206f  y profiles:..* o
+000140c0: 7074 696f 6e20 602d 7360 2069 7320 6120  ption `-s` is a 
+000140d0: 7368 6f72 7463 7574 2074 6f20 7365 7420  shortcut to set 
+000140e0: 7468 6520 666f 6c6c 6f77 696e 6720 6f70  the following op
+000140f0: 7469 6f6e 733a 0a20 202a 2060 2d2d 6e6f  tions:.  * `--no
+00014100: 2d74 6875 6d62 6020 6469 7361 626c 6573  -thumb` disables
+00014110: 2074 6875 6d62 6e61 696c 7320 616e 6420   thumbnails and 
+00014120: 6175 6469 6f20 7472 616e 7363 6f64 696e  audio transcodin
+00014130: 6720 746f 2073 746f 7020 636f 7079 7061  g to stop copypa
+00014140: 7274 7920 6672 6f6d 2072 756e 6e69 6e67  rty from running
+00014150: 2060 4646 6d70 6567 602f 6050 696c 6c6f   `FFmpeg`/`Pillo
+00014160: 7760 2f60 5649 5053 6020 6f6e 2075 706c  w`/`VIPS` on upl
+00014170: 6f61 6465 6420 6669 6c65 732c 2077 6869  oaded files, whi
+00014180: 6368 2069 7320 6120 5b67 6f6f 6420 6964  ch is a [good id
+00014190: 6561 5d28 6874 7470 733a 2f2f 7777 772e  ea](https://www.
+000141a0: 6376 6564 6574 6169 6c73 2e63 6f6d 2f76  cvedetails.com/v
+000141b0: 756c 6e65 7261 6269 6c69 7479 2d6c 6973  ulnerability-lis
+000141c0: 742e 7068 703f 7665 6e64 6f72 5f69 643d  t.php?vendor_id=
+000141d0: 3336 3131 2920 6966 2061 6e6f 6e79 6d6f  3611) if anonymo
+000141e0: 7573 2075 706c 6f61 6420 6973 2065 6e61  us upload is ena
+000141f0: 626c 6564 0a20 202a 2060 2d2d 6e6f 2d6d  bled.  * `--no-m
+00014200: 7461 672d 6666 6020 7573 6573 2060 6d75  tag-ff` uses `mu
+00014210: 7461 6765 6e60 2074 6f20 6772 6162 206d  tagen` to grab m
+00014220: 7573 6963 2074 6167 7320 696e 7374 6561  usic tags instea
+00014230: 6420 6f66 2060 4646 6d70 6567 602c 2077  d of `FFmpeg`, w
+00014240: 6869 6368 2069 7320 7361 6665 7220 616e  hich is safer an
+00014250: 6420 6661 7374 6572 2062 7574 206c 6573  d faster but les
+00014260: 7320 6163 6375 7261 7465 0a20 202a 2060  s accurate.  * `
+00014270: 2d2d 646f 7470 6172 7460 2068 6964 6573  --dotpart` hides
+00014280: 2075 706c 6f61 6473 2066 726f 6d20 6469   uploads from di
+00014290: 7265 6374 6f72 7920 6c69 7374 696e 6773  rectory listings
+000142a0: 2077 6869 6c65 2074 6865 7927 7265 2073   while they're s
+000142b0: 7469 6c6c 2069 6e63 6f6d 696e 670a 2020  till incoming.  
+000142c0: 2a20 602d 2d6e 6f2d 726f 626f 7473 6020  * `--no-robots` 
+000142d0: 616e 6420 602d 2d66 6f72 6365 2d6a 7360  and `--force-js`
+000142e0: 206d 616b 6573 206c 6966 6520 6861 7264   makes life hard
+000142f0: 6572 2066 6f72 2063 7261 776c 6572 732c  er for crawlers,
+00014300: 2073 6565 205b 6869 6469 6e67 2066 726f   see [hiding fro
+00014310: 6d20 676f 6f67 6c65 5d28 2368 6964 696e  m google](#hidin
+00014320: 672d 6672 6f6d 2d67 6f6f 676c 6529 0a0a  g-from-google)..
+00014330: 2a20 6f70 7469 6f6e 2060 2d73 7360 2069  * option `-ss` i
+00014340: 7320 6120 7368 6f72 7463 7574 2066 6f72  s a shortcut for
+00014350: 2074 6865 2061 626f 7665 2070 6c75 733a   the above plus:
+00014360: 0a20 202a 2060 2d2d 756e 706f 7374 2030  .  * `--unpost 0
+00014370: 602c 2060 2d2d 6e6f 2d64 656c 602c 2060  `, `--no-del`, `
+00014380: 2d2d 6e6f 2d6d 7660 2064 6973 6162 6c65  --no-mv` disable
+00014390: 7320 616c 6c20 6d6f 7665 2f64 656c 6574  s all move/delet
+000143a0: 6520 7375 7070 6f72 740a 2020 2a20 602d  e support.  * `-
+000143b0: 2d68 6172 646c 696e 6b60 2063 7265 6174  -hardlink` creat
+000143c0: 6573 2068 6172 646c 696e 6b73 2069 6e73  es hardlinks ins
+000143d0: 7465 6164 206f 6620 7379 6d6c 696e 6b73  tead of symlinks
+000143e0: 2077 6865 6e20 6465 6475 706c 6963 6174   when deduplicat
+000143f0: 696e 6720 7570 6c6f 6164 732c 2077 6869  ing uploads, whi
+00014400: 6368 2069 7320 6c65 7373 206d 6169 6e74  ch is less maint
+00014410: 656e 616e 6365 0a20 2020 202a 2068 6f77  enance.    * how
+00014420: 6576 6572 206e 6f74 6520 6966 2079 6f75  ever note if you
+00014430: 2065 6469 7420 6f6e 6520 6669 6c65 2069   edit one file i
+00014440: 7420 7769 6c6c 2061 6c73 6f20 6166 6665  t will also affe
+00014450: 6374 2074 6865 206f 7468 6572 2063 6f70  ct the other cop
+00014460: 6965 730a 2020 2a20 602d 2d76 6167 7565  ies.  * `--vague
+00014470: 2d34 3031 6020 7265 7475 726e 7320 6120  -401` returns a 
+00014480: 2234 3034 206e 6f74 2066 6f75 6e64 2220  "404 not found" 
+00014490: 696e 7374 6561 6420 6f66 2022 3430 3120  instead of "401 
+000144a0: 756e 6175 7468 6f72 697a 6564 2220 7768  unauthorized" wh
+000144b0: 6963 6820 6973 2061 2063 6f6d 6d6f 6e20  ich is a common 
+000144c0: 656e 7465 7270 7269 7365 206d 656d 650a  enterprise meme.
+000144d0: 2020 2a20 602d 2d62 616e 2d34 3034 3d35    * `--ban-404=5
+000144e0: 302c 3630 2c31 3434 3060 2062 616e 2063  0,60,1440` ban c
+000144f0: 6c69 656e 7420 666f 7220 3134 3430 6d69  lient for 1440mi
+00014500: 6e20 2832 3468 2920 6966 2074 6865 7920  n (24h) if they 
+00014510: 6869 7420 3530 2034 3034 2773 2069 6e20  hit 50 404's in 
+00014520: 3630 6d69 6e0a 2020 2020 2a20 2a2a 4e42  60min.    * **NB
+00014530: 3a2a 2a20 7769 6c6c 2062 616e 2061 6e79  :** will ban any
+00014540: 6f6e 6520 7768 6f20 656e 6162 6c65 7320  one who enables 
+00014550: 7570 326b 2074 7572 626f 0a20 202a 2060  up2k turbo.  * `
+00014560: 2d2d 6e69 6860 2072 656d 6f76 6573 2074  --nih` removes t
+00014570: 6865 2073 6572 7665 7220 686f 7374 6e61  he server hostna
+00014580: 6d65 2066 726f 6d20 6469 7265 6374 6f72  me from director
+00014590: 7920 6c69 7374 696e 6773 0a0a 2a20 6f70  y listings..* op
+000145a0: 7469 6f6e 2060 2d73 7373 6020 6973 2061  tion `-sss` is a
+000145b0: 2073 686f 7274 6375 7420 666f 7220 7468   shortcut for th
+000145c0: 6520 6162 6f76 6520 706c 7573 3a0a 2020  e above plus:.  
+000145d0: 2a20 602d 2d6e 6f2d 6461 7660 2064 6973  * `--no-dav` dis
+000145e0: 6162 6c65 7320 7765 6264 6176 2073 7570  ables webdav sup
+000145f0: 706f 7274 0a20 202a 2060 2d2d 6e6f 2d6c  port.  * `--no-l
+00014600: 6f67 7565 7360 2061 6e64 2060 2d2d 6e6f  ogues` and `--no
+00014610: 2d72 6561 646d 6560 2064 6973 6162 6c65  -readme` disable
+00014620: 7320 7375 7070 6f72 7420 666f 7220 7265  s support for re
+00014630: 6164 6d65 2773 2061 6e64 2070 726f 6c6f  adme's and prolo
+00014640: 6775 6573 202f 2065 7069 6c6f 6775 6573  gues / epilogues
+00014650: 2069 6e20 6469 7265 6374 6f72 7920 6c69   in directory li
+00014660: 7374 696e 6773 2c20 7768 6963 6820 6f74  stings, which ot
+00014670: 6865 7277 6973 6520 6c65 7473 2070 656f  herwise lets peo
+00014680: 706c 6520 7570 6c6f 6164 2061 7262 6974  ple upload arbit
+00014690: 7261 7279 2028 6275 7420 7361 6e64 626f  rary (but sandbo
+000146a0: 7865 6429 2060 3c73 6372 6970 743e 6020  xed) `<script>` 
+000146b0: 7461 6773 0a20 202a 2060 2d6c 6f20 6370  tags.  * `-lo cp
+000146c0: 702d 2559 2d25 6d25 642d 2548 254d 2553  p-%Y-%m%d-%H%M%S
+000146d0: 2e74 7874 2e78 7a60 2065 6e61 626c 6573  .txt.xz` enables
+000146e0: 206c 6f67 6769 6e67 2074 6f20 6469 736b   logging to disk
+000146f0: 0a20 202a 2060 2d6c 7320 2a2a 2c2a 2c6c  .  * `-ls **,*,l
+00014700: 6e2c 702c 7260 2064 6f65 7320 6120 7363  n,p,r` does a sc
+00014710: 616e 206f 6e20 7374 6172 7475 7020 666f  an on startup fo
+00014720: 7220 616e 7920 6461 6e67 6572 6f75 7320  r any dangerous 
+00014730: 7379 6d6c 696e 6b73 0a0a 6f74 6865 7220  symlinks..other 
+00014740: 6d69 7363 206e 6f74 6573 3a0a 0a2a 2079  misc notes:..* y
+00014750: 6f75 2063 616e 2064 6973 6162 6c65 2064  ou can disable d
+00014760: 6972 6563 746f 7279 206c 6973 7469 6e67  irectory listing
+00014770: 7320 6279 2067 6976 696e 6720 7065 726d  s by giving perm
+00014780: 6973 7369 6f6e 2060 6760 2069 6e73 7465  ission `g` inste
+00014790: 6164 206f 6620 6072 602c 206f 6e6c 7920  ad of `r`, only 
+000147a0: 6163 6365 7074 696e 6720 6469 7265 6374  accepting direct
+000147b0: 2055 524c 7320 746f 2066 696c 6573 0a20   URLs to files. 
+000147c0: 202a 2063 6f6d 6269 6e65 2074 6869 7320   * combine this 
+000147d0: 7769 7468 2076 6f6c 666c 6167 2060 632c  with volflag `c,
+000147e0: 666b 6020 746f 2067 656e 6572 6174 6520  fk` to generate 
+000147f0: 6669 6c65 6b65 7973 2028 7065 722d 6669  filekeys (per-fi
+00014800: 6c65 2061 6363 6573 736b 6579 7329 3b20  le accesskeys); 
+00014810: 7573 6572 7320 7768 6963 6820 6861 7665  users which have
+00014820: 2066 756c 6c20 7265 6164 2d61 6363 6573   full read-acces
+00014830: 7320 7769 6c6c 2074 6865 6e20 7365 6520  s will then see 
+00014840: 5552 4c73 2077 6974 6820 603f 6b3d 2e2e  URLs with `?k=..
+00014850: 2e60 2061 7070 656e 6465 6420 746f 2074  .` appended to t
+00014860: 6865 2065 6e64 2c20 616e 6420 6067 6020  he end, and `g` 
+00014870: 7573 6572 7320 6d75 7374 2070 726f 7669  users must provi
+00014880: 6465 2074 6861 7420 5552 4c20 696e 636c  de that URL incl
+00014890: 7564 696e 6720 7468 6520 636f 7272 6563  uding the correc
+000148a0: 7420 6b65 7920 746f 2061 766f 6964 2061  t key to avoid a
+000148b0: 2034 3034 0a20 2020 202a 2074 6865 2064   404.    * the d
+000148c0: 6566 6175 6c74 2066 696c 656b 6579 2065  efault filekey e
+000148d0: 6e74 726f 7079 2069 7320 6661 6972 6c79  ntropy is fairly
+000148e0: 2073 6d61 6c6c 2073 6f20 6769 7665 2060   small so give `
+000148f0: 2d2d 666b 2d73 616c 7460 2061 726f 756e  --fk-salt` aroun
+00014900: 6420 3330 2063 6861 7261 6374 6572 7320  d 30 characters 
+00014910: 6966 2079 6f75 2077 616e 7420 6669 6c65  if you want file
+00014920: 6b65 7973 206c 6f6e 6765 7220 7468 616e  keys longer than
+00014930: 2031 3620 6368 6172 730a 2020 2a20 7065   16 chars.  * pe
+00014940: 726d 6973 7369 6f6e 7320 6077 4760 206c  rmissions `wG` l
+00014950: 6574 7320 7573 6572 7320 7570 6c6f 6164  ets users upload
+00014960: 2066 696c 6573 2061 6e64 2072 6563 6569   files and recei
+00014970: 7665 2074 6865 6972 206f 776e 2066 696c  ve their own fil
+00014980: 656b 6579 732c 2073 7469 6c6c 2077 6974  ekeys, still wit
+00014990: 686f 7574 2062 6569 6e67 2061 626c 6520  hout being able 
+000149a0: 746f 2073 6565 206f 7468 6572 2075 706c  to see other upl
+000149b0: 6f61 6473 0a0a 0a23 2320 676f 7463 6861  oads...## gotcha
+000149c0: 730a 0a62 6568 6176 696f 7220 7468 6174  s..behavior that
+000149d0: 206d 6967 6874 2062 6520 756e 6578 7065   might be unexpe
+000149e0: 6374 6564 0a0a 2a20 7573 6572 7320 7769  cted..* users wi
+000149f0: 7468 6f75 7420 7265 6164 2d61 6363 6573  thout read-acces
+00014a00: 7320 746f 2061 2066 6f6c 6465 7220 6361  s to a folder ca
+00014a10: 6e20 7374 696c 6c20 7365 6520 7468 6520  n still see the 
+00014a20: 602e 7072 6f6c 6f67 7565 2e68 746d 6c60  `.prologue.html`
+00014a30: 202f 2060 2e65 7069 6c6f 6775 652e 6874   / `.epilogue.ht
+00014a40: 6d6c 6020 2f20 6052 4541 444d 452e 6d64  ml` / `README.md
+00014a50: 6020 636f 6e74 656e 7473 2c20 666f 7220  ` contents, for 
+00014a60: 7468 6520 7075 7270 6f73 6520 6f66 2073  the purpose of s
+00014a70: 686f 7769 6e67 2061 2064 6573 6372 6970  howing a descrip
+00014a80: 7469 6f6e 206f 6e20 686f 7720 746f 2075  tion on how to u
+00014a90: 7365 2074 6865 2075 706c 6f61 6465 7220  se the uploader 
+00014aa0: 666f 7220 6578 616d 706c 650a 2a20 7573  for example.* us
+00014ab0: 6572 7320 6361 6e20 7375 626d 6974 2060  ers can submit `
+00014ac0: 3c73 6372 6970 743e 6073 2077 6869 6368  <script>`s which
+00014ad0: 2061 7574 6f72 756e 2066 6f72 206f 7468   autorun for oth
+00014ae0: 6572 2076 6973 6974 6f72 7320 696e 2061  er visitors in a
+00014af0: 2066 6577 2077 6179 733b 0a20 202a 2075   few ways;.  * u
+00014b00: 706c 6f61 6469 6e67 2061 2060 5245 4144  ploading a `READ
+00014b10: 4d45 2e6d 6460 202d 2d20 6176 6f69 6420  ME.md` -- avoid 
+00014b20: 7769 7468 2060 2d2d 6e6f 2d72 6561 646d  with `--no-readm
+00014b30: 6560 0a20 202a 2072 656e 616d 696e 6720  e`.  * renaming 
+00014b40: 6073 6f6d 652e 6874 6d6c 6020 746f 2060  `some.html` to `
+00014b50: 2e65 7069 6c6f 6775 652e 6874 6d6c 6020  .epilogue.html` 
+00014b60: 2d2d 2061 766f 6964 2077 6974 6820 6569  -- avoid with ei
+00014b70: 7468 6572 2060 2d2d 6e6f 2d6c 6f67 7565  ther `--no-logue
+00014b80: 7360 206f 7220 602d 2d6e 6f2d 646f 742d  s` or `--no-dot-
+00014b90: 7265 6e60 0a20 202a 2074 6865 2064 6972  ren`.  * the dir
+00014ba0: 6563 746f 7279 2d6c 6973 7469 6e67 2065  ectory-listing e
+00014bb0: 6d62 6564 2069 7320 7361 6e64 626f 7865  mbed is sandboxe
+00014bc0: 6420 2873 6f20 616e 7920 6d61 6c69 6369  d (so any malici
+00014bd0: 6f75 7320 7363 7269 7074 7320 6361 6e27  ous scripts can'
+00014be0: 7420 646f 2061 6e79 2064 616d 6167 6529  t do any damage)
+00014bf0: 2062 7574 2074 6865 206d 6172 6b64 6f77   but the markdow
+00014c00: 6e20 6564 6974 6f72 2069 7320 6e6f 740a  n editor is not.
+00014c10: 0a0a 2323 2063 6f72 730a 0a63 726f 7373  ..## cors..cross
+00014c20: 2d73 6974 6520 7265 7175 6573 7420 636f  -site request co
+00014c30: 6e66 6967 0a0a 6279 2064 6566 6175 6c74  nfig..by default
+00014c40: 2c20 6578 6365 7074 2066 6f72 2060 4745  , except for `GE
+00014c50: 5460 2061 6e64 2060 4845 4144 6020 6f70  T` and `HEAD` op
+00014c60: 6572 6174 696f 6e73 2c20 616c 6c20 7265  erations, all re
+00014c70: 7175 6573 7473 206d 7573 7420 6569 7468  quests must eith
+00014c80: 6572 3a0a 2a20 6e6f 7420 636f 6e74 6169  er:.* not contai
+00014c90: 6e20 616e 2060 4f72 6967 696e 6020 6865  n an `Origin` he
+00014ca0: 6164 6572 2061 7420 616c 6c0a 2a20 6f72  ader at all.* or
+00014cb0: 2068 6176 6520 616e 2060 4f72 6967 696e   have an `Origin
+00014cc0: 6020 6d61 7463 6869 6e67 2074 6865 2073  ` matching the s
+00014cd0: 6572 7665 7220 646f 6d61 696e 0a2a 206f  erver domain.* o
+00014ce0: 7220 7468 6520 6865 6164 6572 2060 5057  r the header `PW
+00014cf0: 6020 7769 7468 2079 6f75 7220 7061 7373  ` with your pass
+00014d00: 776f 7264 2061 7320 7661 6c75 650a 0a63  word as value..c
+00014d10: 6f72 7320 6361 6e20 6265 2063 6f6e 6669  ors can be confi
+00014d20: 6775 7265 6420 7769 7468 2060 2d2d 6163  gured with `--ac
+00014d30: 616f 6020 616e 6420 602d 2d61 6361 6d60  ao` and `--acam`
+00014d40: 2c20 6f72 2074 6865 2070 726f 7465 6374  , or the protect
+00014d50: 696f 6e73 2065 6e74 6972 656c 7920 6469  ions entirely di
+00014d60: 7361 626c 6564 2077 6974 6820 602d 2d61  sabled with `--a
+00014d70: 6c6c 6f77 2d63 7372 6660 0a0a 0a23 2320  llow-csrf`...## 
+00014d80: 6874 7470 730a 0a62 6f74 6820 4854 5450  https..both HTTP
+00014d90: 2061 6e64 2048 5454 5053 2061 7265 2061   and HTTPS are a
+00014da0: 6363 6570 7465 6420 2062 7920 6465 6661  ccepted  by defa
+00014db0: 756c 742c 2062 7574 206c 6574 7469 6e67  ult, but letting
+00014dc0: 2061 205b 7265 7665 7273 6520 7072 6f78   a [reverse prox
+00014dd0: 795d 2823 7265 7665 7273 652d 7072 6f78  y](#reverse-prox
+00014de0: 7929 2068 616e 646c 6520 7468 6520 6874  y) handle the ht
+00014df0: 7470 732f 746c 732f 7373 6c20 776f 756c  tps/tls/ssl woul
+00014e00: 6420 6265 2062 6574 7465 7220 2870 726f  d be better (pro
+00014e10: 6261 626c 7920 6d6f 7265 2073 6563 7572  bably more secur
+00014e20: 6520 6279 2064 6566 6175 6c74 290a 0a63  e by default)..c
+00014e30: 6f70 7970 6172 7479 2064 6f65 736e 2774  opyparty doesn't
+00014e40: 2073 7065 616b 2048 5454 502f 3220 6f72   speak HTTP/2 or
+00014e50: 2051 5549 432c 2073 6f20 7573 696e 6720   QUIC, so using 
+00014e60: 6120 7265 7665 7273 6520 7072 6f78 7920  a reverse proxy 
+00014e70: 776f 756c 6420 736f 6c76 6520 7468 6174  would solve that
+00014e80: 2061 7320 7765 6c6c 0a0a 0a23 2072 6563   as well...# rec
+00014e90: 6f76 6572 696e 6720 6672 6f6d 2063 7261  overing from cra
+00014ea0: 7368 6573 0a0a 2323 2063 6c69 656e 7420  shes..## client 
+00014eb0: 6372 6173 6865 730a 0a23 2323 2066 7265  crashes..### fre
+00014ec0: 666f 7820 7773 6f64 0a0a 6669 7265 666f  fox wsod..firefo
+00014ed0: 7820 3837 2063 616e 2063 7261 7368 2064  x 87 can crash d
+00014ee0: 7572 696e 6720 7570 6c6f 6164 7320 202d  uring uploads  -
+00014ef0: 2d20 7468 6520 656e 7469 7265 2062 726f  - the entire bro
+00014f00: 7773 6572 2067 6f65 732c 2069 6e63 6c75  wser goes, inclu
+00014f10: 6469 6e67 2061 6c6c 206f 7468 6572 2062  ding all other b
+00014f20: 726f 7773 6572 2074 6162 732c 2065 7665  rowser tabs, eve
+00014f30: 7279 7468 696e 6720 7475 726e 7320 7768  rything turns wh
+00014f40: 6974 650a 0a68 6f77 6576 6572 2079 6f75  ite..however you
+00014f50: 2063 616e 2068 6974 2060 4631 3260 2069   can hit `F12` i
+00014f60: 6e20 7468 6520 7570 326b 2074 6162 2061  n the up2k tab a
+00014f70: 6e64 2075 7365 2074 6865 2064 6576 746f  nd use the devto
+00014f80: 6f6c 7320 746f 2073 6565 2068 6f77 2066  ols to see how f
+00014f90: 6172 2079 6f75 2067 6f74 2069 6e20 7468  ar you got in th
+00014fa0: 6520 7570 6c6f 6164 733a 0a0a 2a20 6765  e uploads:..* ge
+00014fb0: 7420 6120 636f 6d70 6c65 7465 206c 6973  t a complete lis
+00014fc0: 7420 6f66 2061 6c6c 2075 706c 6f61 6473  t of all uploads
+00014fd0: 2c20 6f72 6761 6e69 7a65 6420 6279 2073  , organized by s
+00014fe0: 7461 7475 7473 2028 6f6b 202f 206e 6f2d  tatuts (ok / no-
+00014ff0: 676f 6f64 202f 2062 7573 7920 2f20 7175  good / busy / qu
+00015000: 6575 6564 293a 2020 0a20 2060 7661 7220  eued):  .  `var 
+00015010: 7461 6273 203d 207b 206f 6b3a 5b5d 2c20  tabs = { ok:[], 
+00015020: 6e67 3a5b 5d2c 2062 7a3a 5b5d 2c20 713a  ng:[], bz:[], q:
+00015030: 5b5d 207d 3b20 666f 7220 2876 6172 2061  [] }; for (var a
+00015040: 206f 6620 7570 326b 2e75 692e 7461 6229   of up2k.ui.tab)
+00015050: 2074 6162 735b 612e 696e 5d2e 7075 7368   tabs[a.in].push
+00015060: 2861 293b 2074 6162 7360 0a0a 2a20 6c69  (a); tabs`..* li
+00015070: 7374 206f 6620 6669 6c65 6e61 6d65 7320  st of filenames 
+00015080: 7768 6963 6820 6661 696c 6564 3a20 200a  which failed:  .
+00015090: 2020 60e2 808b 7661 7220 6e67 203d 205b    `...var ng = [
+000150a0: 5d3b 2066 6f72 2028 7661 7220 6120 6f66  ]; for (var a of
+000150b0: 2075 7032 6b2e 7569 2e74 6162 2920 6966   up2k.ui.tab) if
+000150c0: 2028 612e 696e 2021 3d20 276f 6b27 2920   (a.in != 'ok') 
+000150d0: 6e67 2e70 7573 6828 612e 686e 2e73 706c  ng.push(a.hn.spl
+000150e0: 6974 2827 3c61 2068 7265 663d 5c22 2729  it('<a href=\"')
+000150f0: 2e73 6c69 6365 282d 3129 5b30 5d2e 7370  .slice(-1)[0].sp
+00015100: 6c69 7428 275c 223e 2729 5b30 5d29 3b20  lit('\">')[0]); 
+00015110: 6e67 600a 0a2a 2073 656e 6420 7468 6520  ng`..* send the 
+00015120: 6c69 7374 206f 6620 6669 6c65 6e61 6d65  list of filename
+00015130: 7320 746f 2063 6f70 7970 6172 7479 2066  s to copyparty f
+00015140: 6f72 2073 6166 656b 6565 7069 6e67 3a20  or safekeeping: 
+00015150: 200a 2020 6061 7761 6974 2066 6574 6368   .  `await fetch
+00015160: 2827 2f69 6e63 272c 207b 6d65 7468 6f64  ('/inc', {method
+00015170: 3a27 5055 5427 2c20 626f 6479 3a4a 534f  :'PUT', body:JSO
+00015180: 4e2e 7374 7269 6e67 6966 7928 6e67 2c6e  N.stringify(ng,n
+00015190: 756c 6c2c 3129 7d29 600a 0a0a 2320 4854  ull,1)})`...# HT
+000151a0: 5450 2041 5049 0a0a 7365 6520 5b64 6576  TP API..see [dev
+000151b0: 6e6f 7465 735d 282e 2f64 6f63 732f 6465  notes](./docs/de
+000151c0: 766e 6f74 6573 2e6d 6423 6874 7470 2d61  vnotes.md#http-a
+000151d0: 7069 290a 0a0a 2320 6465 7065 6e64 656e  pi)...# dependen
+000151e0: 6369 6573 0a0a 6d61 6e64 6174 6f72 7920  cies..mandatory 
+000151f0: 6465 7073 3a0a 2a20 606a 696e 6a61 3260  deps:.* `jinja2`
+00015200: 2028 6973 2062 7569 6c74 2069 6e74 6f20   (is built into 
+00015210: 7468 6520 5346 5829 0a0a 0a23 2320 6f70  the SFX)...## op
+00015220: 7469 6f6e 616c 2064 6570 656e 6465 6e63  tional dependenc
+00015230: 6965 730a 0a69 6e73 7461 6c6c 2074 6865  ies..install the
+00015240: 7365 2074 6f20 656e 6162 6c65 2062 6f6e  se to enable bon
+00015250: 7573 2066 6561 7475 7265 730a 0a65 6e61  us features..ena
+00015260: 626c 6520 6674 702d 7365 7276 6572 3a0a  ble ftp-server:.
+00015270: 2a20 666f 7220 6a75 7374 2070 6c61 696e  * for just plain
+00015280: 7465 7874 2046 5450 2c20 6070 7966 7470  text FTP, `pyftp
+00015290: 646c 6962 6020 2869 7320 6275 696c 7420  dlib` (is built 
+000152a0: 696e 746f 2074 6865 2053 4658 290a 2a20  into the SFX).* 
+000152b0: 7769 7468 2054 4c53 2065 6e63 7279 7074  with TLS encrypt
+000152c0: 696f 6e2c 2060 7079 6674 7064 6c69 6220  ion, `pyftpdlib 
+000152d0: 7079 6f70 656e 7373 6c60 0a0a 656e 6162  pyopenssl`..enab
+000152e0: 6c65 206d 7573 6963 2074 6167 733a 0a2a  le music tags:.*
+000152f0: 2065 6974 6865 7220 606d 7574 6167 656e   either `mutagen
+00015300: 6020 2866 6173 742c 2070 7572 652d 7079  ` (fast, pure-py
+00015310: 7468 6f6e 2c20 736b 6970 7320 6120 6665  thon, skips a fe
+00015320: 7720 7461 6773 2c20 6d61 6b65 7320 636f  w tags, makes co
+00015330: 7079 7061 7274 7920 4750 4c3f 2069 646b  pyparty GPL? idk
+00015340: 290a 2a20 6f72 2060 6666 7072 6f62 6560  ).* or `ffprobe`
+00015350: 2028 3230 7820 736c 6f77 6572 2c20 6d6f   (20x slower, mo
+00015360: 7265 2061 6363 7572 6174 652c 2070 6f73  re accurate, pos
+00015370: 7369 626c 7920 6461 6e67 6572 6f75 7320  sibly dangerous 
+00015380: 6465 7065 6e64 696e 6720 6f6e 2079 6f75  depending on you
+00015390: 7220 6469 7374 726f 2061 6e64 2075 7365  r distro and use
+000153a0: 7273 290a 0a65 6e61 626c 6520 5b74 6875  rs)..enable [thu
+000153b0: 6d62 6e61 696c 735d 2823 7468 756d 626e  mbnails](#thumbn
+000153c0: 6169 6c73 2920 6f66 2e2e 2e0a 2a20 2a2a  ails) of....* **
+000153d0: 696d 6167 6573 3a2a 2a20 6050 696c 6c6f  images:** `Pillo
+000153e0: 7760 2061 6e64 2f6f 7220 6070 7976 6970  w` and/or `pyvip
+000153f0: 7360 2061 6e64 2f6f 7220 6066 666d 7065  s` and/or `ffmpe
+00015400: 6760 2028 7265 7175 6972 6573 2070 7932  g` (requires py2
+00015410: 2e37 206f 7220 7079 332e 352b 290a 2a20  .7 or py3.5+).* 
+00015420: 2a2a 7669 6465 6f73 2f61 7564 696f 3a2a  **videos/audio:*
+00015430: 2a20 6066 666d 7065 6760 2061 6e64 2060  * `ffmpeg` and `
+00015440: 6666 7072 6f62 6560 2073 6f6d 6577 6865  ffprobe` somewhe
+00015450: 7265 2069 6e20 6024 5041 5448 600a 2a20  re in `$PATH`.* 
+00015460: 2a2a 4845 4946 2070 6963 7475 7265 733a  **HEIF pictures:
+00015470: 2a2a 2060 7079 7669 7073 6020 6f72 2060  ** `pyvips` or `
+00015480: 6666 6d70 6567 6020 6f72 2060 7079 6865  ffmpeg` or `pyhe
+00015490: 6966 2d70 696c 6c6f 772d 6f70 656e 6572  if-pillow-opener
+000154a0: 6020 2872 6571 7569 7265 7320 4c69 6e75  ` (requires Linu
+000154b0: 7820 6f72 2061 2043 2063 6f6d 7069 6c65  x or a C compile
+000154c0: 7229 0a2a 202a 2a41 5649 4620 7069 6374  r).* **AVIF pict
+000154d0: 7572 6573 3a2a 2a20 6070 7976 6970 7360  ures:** `pyvips`
+000154e0: 206f 7220 6066 666d 7065 6760 206f 7220   or `ffmpeg` or 
+000154f0: 6070 696c 6c6f 772d 6176 6966 2d70 6c75  `pillow-avif-plu
+00015500: 6769 6e60 0a2a 202a 2a4a 5045 4720 584c  gin`.* **JPEG XL
+00015510: 2070 6963 7475 7265 733a 2a2a 2060 7079   pictures:** `py
+00015520: 7669 7073 6020 6f72 2060 6666 6d70 6567  vips` or `ffmpeg
+00015530: 600a 0a65 6e61 626c 6520 5b73 6d62 5d28  `..enable [smb](
+00015540: 2373 6d62 2d73 6572 7665 7229 2073 7570  #smb-server) sup
+00015550: 706f 7274 2028 2a2a 6e6f 742a 2a20 7265  port (**not** re
+00015560: 636f 6d6d 656e 6465 6429 3a0a 2a20 6069  commended):.* `i
+00015570: 6d70 6163 6b65 743d 3d30 2e31 302e 3060  mpacket==0.10.0`
+00015580: 0a0a 6070 7976 6970 7360 2067 6976 6573  ..`pyvips` gives
+00015590: 2068 6967 6865 7220 7175 616c 6974 7920   higher quality 
+000155a0: 7468 756d 626e 6169 6c73 2074 6861 6e20  thumbnails than 
+000155b0: 6050 696c 6c6f 7760 2061 6e64 2069 7320  `Pillow` and is 
+000155c0: 3332 3025 2066 6173 7465 722c 2075 7369  320% faster, usi
+000155d0: 6e67 2032 3730 2520 6d6f 7265 2072 616d  ng 270% more ram
+000155e0: 3a20 6073 7564 6f20 6170 7420 696e 7374  : `sudo apt inst
+000155f0: 616c 6c20 6c69 6276 6970 7334 3220 2626  all libvips42 &&
+00015600: 2070 7974 686f 6e33 202d 6d20 7069 7020   python3 -m pip 
+00015610: 696e 7374 616c 6c20 2d2d 7573 6572 202d  install --user -
+00015620: 5520 7079 7669 7073 600a 0a0a 2323 206f  U pyvips`...## o
+00015630: 7074 696f 6e61 6c20 6770 6c20 7374 7566  ptional gpl stuf
+00015640: 660a 0a73 6f6d 6520 6275 6e64 6c65 6420  f..some bundled 
+00015650: 746f 6f6c 7320 6861 7665 2063 6f70 796c  tools have copyl
+00015660: 6566 7420 6465 7065 6e64 656e 6369 6573  eft dependencies
+00015670: 2c20 7365 6520 5b2e 2f62 696e 2f23 6d74  , see [./bin/#mt
+00015680: 6167 5d28 6269 6e2f 236d 7461 6729 0a0a  ag](bin/#mtag)..
+00015690: 7468 6573 6520 6172 6520 7374 616e 6461  these are standa
+000156a0: 6c6f 6e65 2070 726f 6772 616d 7320 616e  lone programs an
+000156b0: 6420 7769 6c6c 206e 6576 6572 2062 6520  d will never be 
+000156c0: 696d 706f 7274 6564 202f 2065 7661 6c75  imported / evalu
+000156d0: 6174 6564 2062 7920 636f 7079 7061 7274  ated by copypart
+000156e0: 792c 2061 6e64 206d 7573 7420 6265 2065  y, and must be e
+000156f0: 6e61 626c 6564 2074 6872 6f75 6768 2060  nabled through `
+00015700: 2d6d 7470 6020 636f 6e66 6967 730a 0a0a  -mtp` configs...
+00015710: 2320 7366 780a 0a74 6865 2073 656c 662d  # sfx..the self-
+00015720: 636f 6e74 6169 6e65 6420 2262 696e 6172  contained "binar
+00015730: 7922 2020 5b63 6f70 7970 6172 7479 2d73  y"  [copyparty-s
+00015740: 6678 2e70 795d 2868 7474 7073 3a2f 2f67  fx.py](https://g
+00015750: 6974 6875 622e 636f 6d2f 3930 3031 2f63  ithub.com/9001/c
+00015760: 6f70 7970 6172 7479 2f72 656c 6561 7365  opyparty/release
+00015770: 732f 6c61 7465 7374 2f64 6f77 6e6c 6f61  s/latest/downloa
+00015780: 642f 636f 7079 7061 7274 792d 7366 782e  d/copyparty-sfx.
+00015790: 7079 2920 7769 6c6c 2075 6e70 6163 6b20  py) will unpack 
+000157a0: 6974 7365 6c66 2061 6e64 2072 756e 2063  itself and run c
+000157b0: 6f70 7970 6172 7479 2c20 6173 7375 6d69  opyparty, assumi
+000157c0: 6e67 2079 6f75 2068 6176 6520 7079 7468  ng you have pyth
+000157d0: 6f6e 2069 6e73 7461 6c6c 6564 206f 6620  on installed of 
+000157e0: 636f 7572 7365 0a0a 796f 7520 6361 6e20  course..you can 
+000157f0: 7265 6475 6365 2074 6865 2073 6678 2073  reduce the sfx s
+00015800: 697a 6520 6279 2072 6570 6163 6b69 6e67  ize by repacking
+00015810: 2069 743b 2073 6565 205b 2e2f 646f 6373   it; see [./docs
+00015820: 2f64 6576 6e6f 7465 732e 6d64 2373 6678  /devnotes.md#sfx
+00015830: 2d72 6570 6163 6b5d 282e 2f64 6f63 732f  -repack](./docs/
+00015840: 6465 766e 6f74 6573 2e6d 6423 7366 782d  devnotes.md#sfx-
+00015850: 7265 7061 636b 290a 0a0a 2323 2063 6f70  repack)...## cop
+00015860: 7970 6172 7479 2e65 7865 0a0a 646f 776e  yparty.exe..down
+00015870: 6c6f 6164 205b 636f 7079 7061 7274 792e  load [copyparty.
+00015880: 6578 655d 2868 7474 7073 3a2f 2f67 6974  exe](https://git
+00015890: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+000158a0: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+000158b0: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+000158c0: 636f 7079 7061 7274 792e 6578 6529 2028  copyparty.exe) (
+000158d0: 7769 6e38 2b29 206f 7220 5b63 6f70 7970  win8+) or [copyp
+000158e0: 6172 7479 3332 2e65 7865 5d28 6874 7470  arty32.exe](http
+000158f0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00015900: 3030 312f 636f 7079 7061 7274 792f 7265  001/copyparty/re
+00015910: 6c65 6173 6573 2f6c 6174 6573 742f 646f  leases/latest/do
+00015920: 776e 6c6f 6164 2f63 6f70 7970 6172 7479  wnload/copyparty
+00015930: 3332 2e65 7865 2920 2877 696e 372b 290a  32.exe) (win7+).
+00015940: 0a21 5b63 6f70 7970 6172 7479 2d65 7865  .![copyparty-exe
+00015950: 2d66 7338 5d28 6874 7470 733a 2f2f 7573  -fs8](https://us
+00015960: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00015970: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00015980: 3234 3130 3332 2f32 3231 3434 3539 3436  241032/221445946
+00015990: 2d31 6533 3238 6535 362d 3863 3562 2d34  -1e328e56-8c5b-4
+000159a0: 3461 392d 3862 3966 2d64 6565 3834 6439  4a9-8b9f-dee84d9
+000159b0: 3432 3533 352e 706e 6729 0a0a 6361 6e20  42535.png)..can 
+000159c0: 6265 2063 6f6e 7665 6e69 656e 7420 6f6e  be convenient on
+000159d0: 206d 6163 6869 6e65 7320 7768 6572 6520   machines where 
+000159e0: 696e 7374 616c 6c69 6e67 2070 7974 686f  installing pytho
+000159f0: 6e20 6973 2070 726f 626c 656d 6174 6963  n is problematic
+00015a00: 2c20 686f 7765 7665 7220 6973 202a 2a6e  , however is **n
+00015a10: 6f74 2072 6563 6f6d 6d65 6e64 6564 2a2a  ot recommended**
+00015a20: 202d 2d20 6966 2070 6f73 7369 626c 652c   -- if possible,
+00015a30: 2070 6c65 6173 6520 7573 6520 2a2a 5b63   please use **[c
+00015a40: 6f70 7970 6172 7479 2d73 6678 2e70 795d  opyparty-sfx.py]
+00015a50: 2868 7474 7073 3a2f 2f67 6974 6875 622e  (https://github.
+00015a60: 636f 6d2f 3930 3031 2f63 6f70 7970 6172  com/9001/copypar
+00015a70: 7479 2f72 656c 6561 7365 732f 6c61 7465  ty/releases/late
+00015a80: 7374 2f64 6f77 6e6c 6f61 642f 636f 7079  st/download/copy
+00015a90: 7061 7274 792d 7366 782e 7079 292a 2a20  party-sfx.py)** 
+00015aa0: 696e 7374 6561 640a 0a2a 205b 636f 7079  instead..* [copy
+00015ab0: 7061 7274 792e 6578 655d 2868 7474 7073  party.exe](https
+00015ac0: 3a2f 2f67 6974 6875 622e 636f 6d2f 3930  ://github.com/90
+00015ad0: 3031 2f63 6f70 7970 6172 7479 2f72 656c  01/copyparty/rel
+00015ae0: 6561 7365 732f 6c61 7465 7374 2f64 6f77  eases/latest/dow
+00015af0: 6e6c 6f61 642f 636f 7079 7061 7274 792e  nload/copyparty.
+00015b00: 6578 6529 2072 756e 7320 6f6e 2077 696e  exe) runs on win
+00015b10: 3820 6f72 206e 6577 6572 2c20 7761 7320  8 or newer, was 
+00015b20: 636f 6d70 696c 6564 206f 6e20 7769 6e31  compiled on win1
+00015b30: 302c 2064 6f65 7320 7468 756d 626e 6169  0, does thumbnai
+00015b40: 6c73 202b 206d 6564 6961 2074 6167 732c  ls + media tags,
+00015b50: 2061 6e64 2069 7320 2a63 7572 7265 6e74   and is *current
+00015b60: 6c79 2a20 7361 6665 2074 6f20 7573 652c  ly* safe to use,
+00015b70: 2062 7574 2061 6e79 2066 7574 7572 6520   but any future 
+00015b80: 7079 7468 6f6e 2f65 7870 6174 2f70 696c  python/expat/pil
+00015b90: 6c6f 7720 4356 4573 2063 616e 206f 6e6c  low CVEs can onl
+00015ba0: 7920 6265 2072 656d 6564 6965 6420 6279  y be remedied by
+00015bb0: 2064 6f77 6e6c 6f61 6469 6e67 2061 206e   downloading a n
+00015bc0: 6577 6572 2076 6572 7369 6f6e 206f 6620  ewer version of 
+00015bd0: 7468 6520 6578 650a 0a20 202a 206f 6e20  the exe..  * on 
+00015be0: 7769 6e38 2069 7420 6e65 6564 7320 5b76  win8 it needs [v
+00015bf0: 6320 7265 6469 7374 2032 3031 355d 2868  c redist 2015](h
+00015c00: 7474 7073 3a2f 2f77 7777 2e6d 6963 726f  ttps://www.micro
+00015c10: 736f 6674 2e63 6f6d 2f65 6e2d 7573 2f64  soft.com/en-us/d
+00015c20: 6f77 6e6c 6f61 642f 6465 7461 696c 732e  ownload/details.
+00015c30: 6173 7078 3f69 643d 3438 3134 3529 2c20  aspx?id=48145), 
+00015c40: 6f6e 2077 696e 3130 2069 7420 6a75 7374  on win10 it just
+00015c50: 2077 6f72 6b73 0a20 202a 2073 6f6d 6520   works.  * some 
+00015c60: 616e 7469 7669 7275 7320 6d61 7920 6672  antivirus may fr
+00015c70: 6561 6b20 6f75 7420 2866 616c 7365 2d70  eak out (false-p
+00015c80: 6f73 6974 6976 6529 2c20 706f 7373 6962  ositive), possib
+00015c90: 6c79 205b 4176 6173 742c 2041 5647 2c20  ly [Avast, AVG, 
+00015ca0: 616e 6420 4d63 4166 6565 5d28 6874 7470  and McAfee](http
+00015cb0: 733a 2f2f 7777 772e 7669 7275 7374 6f74  s://www.virustot
+00015cc0: 616c 2e63 6f6d 2f67 7569 2f66 696c 652f  al.com/gui/file/
+00015cd0: 3532 3339 3161 3165 3938 3432 6366 3730  52391a1e9842cf70
+00015ce0: 6164 3234 3365 6638 3338 3434 6434 3664  ad243ef83844d46d
+00015cf0: 3239 6330 3034 3464 3130 3165 6530 3133  29c0044d101ee013
+00015d00: 3866 6364 6433 6338 6465 3232 3337 6436  8fcdd3c8de2237d6
+00015d10: 2f64 6574 6563 7469 6f6e 290a 0a2a 2064  /detection)..* d
+00015d20: 616e 6765 726f 7573 3a20 5b63 6f70 7970  angerous: [copyp
+00015d30: 6172 7479 3332 2e65 7865 5d28 6874 7470  arty32.exe](http
+00015d40: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f39  s://github.com/9
+00015d50: 3030 312f 636f 7079 7061 7274 792f 7265  001/copyparty/re
+00015d60: 6c65 6173 6573 2f6c 6174 6573 742f 646f  leases/latest/do
+00015d70: 776e 6c6f 6164 2f63 6f70 7970 6172 7479  wnload/copyparty
+00015d80: 3332 2e65 7865 2920 6973 2063 6f6d 7061  32.exe) is compa
+00015d90: 7469 626c 6520 7769 7468 205b 7769 6e64  tible with [wind
+00015da0: 6f77 7337 5d28 6874 7470 733a 2f2f 7573  ows7](https://us
+00015db0: 6572 2d69 6d61 6765 732e 6769 7468 7562  er-images.github
+00015dc0: 7573 6572 636f 6e74 656e 742e 636f 6d2f  usercontent.com/
+00015dd0: 3234 3130 3332 2f32 3231 3434 3539 3434  241032/221445944
+00015de0: 2d61 6538 3564 3166 342d 6433 3531 2d34  -ae85d1f4-d351-4
+00015df0: 3833 372d 6231 3330 2d38 3263 6162 3537  837-b130-82cab57
+00015e00: 6436 6363 612e 706e 6729 2c20 7768 6963  d6cca.png), whic
+00015e10: 6820 6d65 616e 7320 6974 2075 7365 7320  h means it uses 
+00015e20: 616e 2061 6e63 6965 6e74 2063 6f70 7920  an ancient copy 
+00015e30: 6f66 2070 7974 686f 6e20 2833 2e37 2e39  of python (3.7.9
+00015e40: 2920 7768 6963 6820 6361 6e6e 6f74 2062  ) which cannot b
+00015e50: 6520 7570 6772 6164 6564 2061 6e64 2073  e upgraded and s
+00015e60: 686f 756c 6420 6e65 7665 7220 6265 2065  hould never be e
+00015e70: 7870 6f73 6564 2074 6f20 7468 6520 696e  xposed to the in
+00015e80: 7465 726e 6574 2028 4c41 4e20 6973 2066  ternet (LAN is f
+00015e90: 696e 6529 0a0a 2a20 6461 6e67 6572 6f75  ine)..* dangerou
+00015ea0: 7320 616e 6420 6465 7072 6563 6174 6564  s and deprecated
+00015eb0: 3a20 5b63 6f70 7970 6172 7479 2d77 696e  : [copyparty-win
+00015ec0: 7065 3634 2e65 7865 5d28 6874 7470 733a  pe64.exe](https:
+00015ed0: 2f2f 6769 7468 7562 2e63 6f6d 2f39 3030  //github.com/900
+00015ee0: 312f 636f 7079 7061 7274 792f 7265 6c65  1/copyparty/rele
+00015ef0: 6173 6573 2f64 6f77 6e6c 6f61 642f 7631  ases/download/v1
+00015f00: 2e36 2e38 2f63 6f70 7970 6172 7479 2d77  .6.8/copyparty-w
+00015f10: 696e 7065 3634 2e65 7865 2920 6c65 7473  inpe64.exe) lets
+00015f20: 2079 6f75 205b 7275 6e20 636f 7079 7061   you [run copypa
+00015f30: 7274 7920 696e 2057 696e 5045 5d28 6874  rty in WinPE](ht
+00015f40: 7470 733a 2f2f 7573 6572 2d69 6d61 6765  tps://user-image
+00015f50: 732e 6769 7468 7562 7573 6572 636f 6e74  s.githubusercont
+00015f60: 656e 742e 636f 6d2f 3234 3130 3332 2f32  ent.com/241032/2
+00015f70: 3035 3435 3439 3834 2d65 3662 3535 3064  05454984-e6b550d
+00015f80: 662d 3363 3439 2d34 3836 642d 3932 3637  f-3c49-486d-9267
+00015f90: 2d31 3631 3430 3738 6464 3064 642e 706e  -1614078dd0dd.pn
+00015fa0: 6729 2061 6e64 2069 7320 6f74 6865 7277  g) and is otherw
+00015fb0: 6973 6520 636f 6d70 6c65 7465 6c79 2075  ise completely u
+00015fc0: 7365 6c65 7373 0a0a 6d65 616e 7768 696c  seless..meanwhil
+00015fd0: 6520 5b63 6f70 7970 6172 7479 2d73 6678  e [copyparty-sfx
+00015fe0: 2e70 795d 2868 7474 7073 3a2f 2f67 6974  .py](https://git
+00015ff0: 6875 622e 636f 6d2f 3930 3031 2f63 6f70  hub.com/9001/cop
+00016000: 7970 6172 7479 2f72 656c 6561 7365 732f  yparty/releases/
+00016010: 6c61 7465 7374 2f64 6f77 6e6c 6f61 642f  latest/download/
+00016020: 636f 7079 7061 7274 792d 7366 782e 7079  copyparty-sfx.py
+00016030: 2920 696e 7374 6561 6420 7265 6c69 6573  ) instead relies
+00016040: 206f 6e20 796f 7572 2073 7973 7465 6d20   on your system 
+00016050: 7079 7468 6f6e 2077 6869 6368 2067 6976  python which giv
+00016060: 6573 2062 6574 7465 7220 7065 7266 6f72  es better perfor
+00016070: 6d61 6e63 6520 616e 6420 7769 6c6c 2073  mance and will s
+00016080: 7461 7920 7361 6665 2061 7320 6c6f 6e67  tay safe as long
+00016090: 2061 7320 796f 7520 6b65 6570 2079 6f75   as you keep you
+000160a0: 7220 7079 7468 6f6e 2069 6e73 7461 6c6c  r python install
+000160b0: 2075 702d 746f 2d64 6174 650a 0a74 6865   up-to-date..the
+000160c0: 6e20 6167 6169 6e2c 2069 6620 796f 7520  n again, if you 
+000160d0: 6172 6520 616c 7265 6164 7920 696e 746f  are already into
+000160e0: 2064 6f77 6e6c 6f61 6469 6e67 2073 6861   downloading sha
+000160f0: 6479 2062 696e 6172 6965 7320 6672 6f6d  dy binaries from
+00016100: 2074 6865 2069 6e74 6572 6e65 742c 2079   the internet, y
+00016110: 6f75 206d 6179 2061 6c73 6f20 7761 6e74  ou may also want
+00016120: 206d 7920 5b6d 696e 696d 616c 2062 7569   my [minimal bui
+00016130: 6c64 735d 282e 2f73 6372 6970 7473 2f70  lds](./scripts/p
+00016140: 7969 6e73 7461 6c6c 6572 2366 666d 7065  yinstaller#ffmpe
+00016150: 6729 206f 6620 5b66 666d 7065 675d 2868  g) of [ffmpeg](h
+00016160: 7474 7073 3a2f 2f6f 6376 2e6d 652f 7374  ttps://ocv.me/st
+00016170: 7566 662f 6269 6e2f 6666 6d70 6567 2e65  uff/bin/ffmpeg.e
+00016180: 7865 2920 616e 6420 5b66 6670 726f 6265  xe) and [ffprobe
+00016190: 5d28 6874 7470 733a 2f2f 6f63 762e 6d65  ](https://ocv.me
+000161a0: 2f73 7475 6666 2f62 696e 2f66 6670 726f  /stuff/bin/ffpro
+000161b0: 6265 2e65 7865 2920 7768 6963 6820 656e  be.exe) which en
+000161c0: 6162 6c65 7320 636f 7079 7061 7274 7920  ables copyparty 
+000161d0: 746f 2065 7874 7261 6374 206d 756c 7469  to extract multi
+000161e0: 6d65 6469 612d 696e 666f 2c20 646f 2061  media-info, do a
+000161f0: 7564 696f 2d74 7261 6e73 636f 6469 6e67  udio-transcoding
+00016200: 2c20 616e 6420 7468 756d 626e 6169 6c73  , and thumbnails
+00016210: 2f73 7065 6374 726f 6772 616d 732f 7761  /spectrograms/wa
+00016220: 7665 666f 726d 732c 2068 6f77 6576 6572  veforms, however
+00016230: 2069 7427 7320 6d75 6368 2062 6574 7465   it's much bette
+00016240: 7220 746f 2069 6e73 7465 6164 2067 7261  r to instead gra
+00016250: 6220 6120 5b72 6563 656e 7420 6f66 6669  b a [recent offi
+00016260: 6369 616c 2062 7569 6c64 5d28 6874 7470  cial build](http
+00016270: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f42  s://github.com/B
+00016280: 7462 4e2f 4646 6d70 6567 2d42 7569 6c64  tbN/FFmpeg-Build
+00016290: 732f 7265 6c65 6173 6573 2f64 6f77 6e6c  s/releases/downl
+000162a0: 6f61 642f 6c61 7465 7374 2f66 666d 7065  oad/latest/ffmpe
+000162b0: 672d 6d61 7374 6572 2d6c 6174 6573 742d  g-master-latest-
+000162c0: 7769 6e36 342d 6770 6c2e 7a69 7029 2065  win64-gpl.zip) e
+000162d0: 7665 7279 206f 6e63 6520 696e 6120 7768  very once ina wh
+000162e0: 696c 6520 6966 2079 6f75 2063 616e 2061  ile if you can a
+000162f0: 6666 6f72 6420 7468 6520 7369 7a65 0a0a  fford the size..
+00016300: 0a23 2069 6e73 7461 6c6c 206f 6e20 616e  .# install on an
+00016310: 6472 6f69 640a 0a69 6e73 7461 6c6c 205b  droid..install [
+00016320: 5465 726d 7578 5d28 6874 7470 733a 2f2f  Termux](https://
+00016330: 7465 726d 7578 2e63 6f6d 2f29 202b 2069  termux.com/) + i
+00016340: 7473 2063 6f6d 7061 6e69 6f6e 2061 7070  ts companion app
+00016350: 2060 5465 726d 7578 3a41 5049 6020 2873   `Termux:API` (s
+00016360: 6565 205b 6f63 762e 6d65 2f74 6572 6d75  ee [ocv.me/termu
+00016370: 785d 2868 7474 7073 3a2f 2f6f 6376 2e6d  x](https://ocv.m
+00016380: 652f 7465 726d 7578 2f29 2920 616e 6420  e/termux/)) and 
+00016390: 7468 656e 2063 6f70 792d 7061 7374 6520  then copy-paste 
+000163a0: 7468 6973 2069 6e74 6f20 5465 726d 7578  this into Termux
+000163b0: 2028 6c6f 6e67 2d74 6170 2920 616c 6c20   (long-tap) all 
+000163c0: 6174 206f 6e63 653a 0a60 6060 7368 0a79  at once:.```sh.y
+000163d0: 6573 207c 2070 6b67 2075 7067 7261 6465  es | pkg upgrade
+000163e0: 2026 2620 7465 726d 7578 2d73 6574 7570   && termux-setup
+000163f0: 2d73 746f 7261 6765 2026 2620 7965 7320  -storage && yes 
+00016400: 7c20 706b 6720 696e 7374 616c 6c20 7079  | pkg install py
+00016410: 7468 6f6e 2074 6572 6d75 782d 6170 6920  thon termux-api 
+00016420: 2626 2070 7974 686f 6e20 2d6d 2065 6e73  && python -m ens
+00016430: 7572 6570 6970 2026 2620 7079 7468 6f6e  urepip && python
+00016440: 202d 6d20 7069 7020 696e 7374 616c 6c20   -m pip install 
+00016450: 2d2d 7573 6572 202d 5520 636f 7079 7061  --user -U copypa
+00016460: 7274 7920 2626 207b 2067 7265 7020 2d71  rty && { grep -q
+00016470: 4520 2750 4154 483d 2e2a 5c2e 6c6f 6361  E 'PATH=.*\.loca
+00016480: 6c2f 6269 6e27 207e 2f2e 6261 7368 7263  l/bin' ~/.bashrc
+00016490: 2032 3e2f 6465 762f 6e75 6c6c 207c 7c20   2>/dev/null || 
+000164a0: 7b20 6563 686f 2027 5041 5448 3d22 2448  { echo 'PATH="$H
+000164b0: 4f4d 452f 2e6c 6f63 616c 2f62 696e 3a24  OME/.local/bin:$
+000164c0: 5041 5448 2227 203e 3e20 7e2f 2e62 6173  PATH"' >> ~/.bas
+000164d0: 6872 6320 2626 202e 207e 2f2e 6261 7368  hrc && . ~/.bash
+000164e0: 7263 3b20 7d3b 207d 0a65 6368 6f20 243f  rc; }; }.echo $?
+000164f0: 0a60 6060 0a0a 6166 7465 7220 7468 6520  .```..after the 
+00016500: 696e 6974 6961 6c20 7365 7475 702c 2079  initial setup, y
+00016510: 6f75 2063 616e 206c 6175 6e63 6820 636f  ou can launch co
+00016520: 7079 7061 7274 7920 6174 2061 6e79 2074  pyparty at any t
+00016530: 696d 6520 6279 2072 756e 6e69 6e67 2060  ime by running `
+00016540: 636f 7079 7061 7274 7960 2061 6e79 7768  copyparty` anywh
+00016550: 6572 6520 696e 2054 6572 6d75 7820 2d2d  ere in Termux --
+00016560: 2061 6e64 2069 6620 796f 7520 7275 6e20   and if you run 
+00016570: 6974 2077 6974 6820 602d 2d71 7260 2079  it with `--qr` y
+00016580: 6f75 276c 6c20 6765 7420 6120 5b6e 6561  ou'll get a [nea
+00016590: 7420 7172 2d63 6f64 655d 2823 7172 2d63  t qr-code](#qr-c
+000165a0: 6f64 6529 2070 6f69 6e74 696e 6720 746f  ode) pointing to
+000165b0: 2079 6f75 7220 6578 7465 726e 616c 2069   your external i
+000165c0: 700a 0a69 6620 796f 7520 7761 6e74 2074  p..if you want t
+000165d0: 6875 6d62 6e61 696c 7320 2870 686f 746f  humbnails (photo
+000165e0: 732b 7669 6465 6f73 2920 616e 6420 796f  s+videos) and yo
+000165f0: 7527 7265 206f 6b61 7920 7769 7468 2073  u're okay with s
+00016600: 7065 6e64 696e 6720 616e 6f74 6865 7220  pending another 
+00016610: 3133 3220 4d69 4220 6f66 2073 746f 7261  132 MiB of stora
+00016620: 6765 2c20 6070 6b67 2069 6e73 7461 6c6c  ge, `pkg install
+00016630: 2066 666d 7065 6720 2626 2070 7974 686f   ffmpeg && pytho
+00016640: 6e33 202d 6d20 7069 7020 696e 7374 616c  n3 -m pip instal
+00016650: 6c20 2d2d 7573 6572 202d 5520 7069 6c6c  l --user -U pill
+00016660: 6f77 600a 0a2a 206f 7220 6966 2079 6f75  ow`..* or if you
+00016670: 2077 616e 7420 746f 2075 7365 2060 7669   want to use `vi
+00016680: 7073 6020 666f 7220 7068 6f74 6f2d 7468  ps` for photo-th
+00016690: 756d 6273 2069 6e73 7465 6164 2c20 6070  umbs instead, `p
+000166a0: 6b67 2069 6e73 7461 6c6c 206c 6962 7669  kg install libvi
+000166b0: 7073 2026 2620 7079 7468 6f6e 202d 6d20  ps && python -m 
+000166c0: 7069 7020 696e 7374 616c 6c20 2d2d 7573  pip install --us
+000166d0: 6572 202d 5520 7768 6565 6c20 2626 2070  er -U wheel && p
+000166e0: 7974 686f 6e20 2d6d 2070 6970 2069 6e73  ython -m pip ins
+000166f0: 7461 6c6c 202d 2d75 7365 7220 2d55 2070  tall --user -U p
+00016700: 7976 6970 7320 2626 2028 6364 202f 6461  yvips && (cd /da
+00016710: 7461 2f64 6174 612f 636f 6d2e 7465 726d  ta/data/com.term
+00016720: 7578 2f66 696c 6573 2f75 7372 2f6c 6962  ux/files/usr/lib
+00016730: 2f3b 206c 6e20 2d73 206c 6962 676f 626a  /; ln -s libgobj
+00016740: 6563 742d 322e 302e 736f 7b2c 2e30 7d3b  ect-2.0.so{,.0};
+00016750: 206c 6e20 2d73 206c 6962 7669 7073 2e73   ln -s libvips.s
+00016760: 6f7b 2c2e 3432 7d29 600a 0a0a 2320 7265  o{,.42})`...# re
+00016770: 706f 7274 696e 6720 6275 6773 0a0a 6964  porting bugs..id
+00016780: 6561 7320 666f 7220 636f 6e74 6578 7420  eas for context 
+00016790: 746f 2069 6e63 6c75 6465 2069 6e20 6275  to include in bu
+000167a0: 6720 7265 706f 7274 730a 0a69 6e20 6765  g reports..in ge
+000167b0: 6e65 7261 6c2c 2063 6f6d 6d61 6e64 6c69  neral, commandli
+000167c0: 6e65 2061 7267 756d 656e 7473 2028 616e  ne arguments (an
+000167d0: 6420 636f 6e66 6967 2066 696c 6520 6966  d config file if
+000167e0: 2061 6e79 290a 0a69 6620 736f 6d65 7468   any)..if someth
+000167f0: 696e 6720 6272 6f6b 6520 6475 7269 6e67  ing broke during
+00016800: 2061 6e20 7570 6c6f 6164 2028 7265 706c   an upload (repl
+00016810: 6163 696e 6720 4649 4c45 4e41 4d45 2077  acing FILENAME w
+00016820: 6974 6820 6120 7061 7274 206f 6620 7468  ith a part of th
+00016830: 6520 6669 6c65 6e61 6d65 2074 6861 7420  e filename that 
+00016840: 6272 6f6b 6529 3a0a 6060 600a 6a6f 7572  broke):.```.jour
+00016850: 6e61 6c63 746c 202d 6153 2027 3438 2068  nalctl -aS '48 h
+00016860: 6f75 7220 6167 6f27 202d 7520 636f 7079  our ago' -u copy
+00016870: 7061 7274 7920 7c20 6772 6570 202d 4331  party | grep -C1
+00016880: 3020 4649 4c45 4e41 4d45 207c 2074 6565  0 FILENAME | tee
+00016890: 2062 7567 2e6c 6f67 0a60 6060 0a0a 6966   bug.log.```..if
+000168a0: 2074 6865 7265 2773 2061 2077 616c 6c20   there's a wall 
+000168b0: 6f66 2062 6173 6536 3420 696e 2074 6865  of base64 in the
+000168c0: 206c 6f67 2028 7468 7265 6164 2073 7461   log (thread sta
+000168d0: 636b 7329 2074 6865 6e20 706c 6561 7365  cks) then please
+000168e0: 2069 6e63 6c75 6465 2074 6861 742c 2065   include that, e
+000168f0: 7370 6563 6961 6c6c 7920 6966 2079 6f75  specially if you
+00016900: 2072 756e 2069 6e74 6f20 736f 6d65 7468   run into someth
+00016910: 696e 6720 6672 6565 7a69 6e67 2075 7020  ing freezing up 
+00016920: 6f72 2067 6574 7469 6e67 2073 7475 636b  or getting stuck
+00016930: 2c20 666f 7220 6578 616d 706c 6520 604f  , for example `O
+00016940: 7065 7261 7469 6f6e 616c 4572 726f 7228  perationalError(
+00016950: 2764 6174 6162 6173 6520 6973 206c 6f63  'database is loc
+00016960: 6b65 6427 2960 202d 2d20 616c 7465 726e  ked')` -- altern
+00016970: 6174 6976 656c 7920 796f 7520 6361 6e20  atively you can 
+00016980: 7669 7369 7420 602f 3f73 7461 636b 6020  visit `/?stack` 
+00016990: 746f 2073 6565 2074 6865 2073 7461 636b  to see the stack
+000169a0: 7320 6c69 7665 2c20 736f 2068 7474 703a  s live, so http:
+000169b0: 2f2f 3132 372e 302e 302e 313a 3339 3233  //127.0.0.1:3923
+000169c0: 2f3f 7374 6163 6b20 666f 7220 6578 616d  /?stack for exam
+000169d0: 706c 650a 0a0a 2320 6465 766e 6f74 6573  ple...# devnotes
+000169e0: 0a0a 666f 7220 6275 696c 6420 696e 7374  ..for build inst
+000169f0: 7275 6374 696f 6e73 2065 7463 2c20 7365  ructions etc, se
+00016a00: 6520 5b2e 2f64 6f63 732f 6465 766e 6f74  e [./docs/devnot
+00016a10: 6573 2e6d 645d 282e 2f64 6f63 732f 6465  es.md](./docs/de
+00016a20: 766e 6f74 6573 2e6d 6429 0a              vnotes.md).
```

### Comparing `copyparty-1.6.9/copyparty.egg-info/SOURCES.txt` & `copyparty-1.7.0/copyparty.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `copyparty-1.6.9/setup.py` & `copyparty-1.7.0/setup.py`

 * *Files identical despite different names*

