# Comparing `tmp/fastrometry-1.0.8.tar.gz` & `tmp/fastrometry-1.0.9.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "fastrometry-1.0.8.tar", last modified: Tue Jul  5 01:56:54 2022, max compression
+gzip compressed data, was "fastrometry-1.0.9.tar", last modified: Tue Jul 26 15:33:58 2022, max compression
```

## Comparing `fastrometry-1.0.8.tar` & `fastrometry-1.0.9.tar`

### file list

```diff
@@ -1,24 +1,25 @@
-drwxrwxrwx   0        0        0        0 2022-07-05 01:56:54.352018 fastrometry-1.0.8/
--rw-rw-rw-   0        0        0    35821 2022-07-02 16:17:09.000000 fastrometry-1.0.8/LICENSE
--rw-rw-rw-   0        0        0     1514 2022-07-05 01:56:54.353015 fastrometry-1.0.8/PKG-INFO
--rw-rw-rw-   0        0        0      415 2022-07-04 04:53:01.000000 fastrometry-1.0.8/README.md
--rw-rw-rw-   0        0        0      226 2022-07-02 16:17:09.000000 fastrometry-1.0.8/pyproject.toml
--rw-rw-rw-   0        0        0     1080 2022-07-05 01:56:54.356449 fastrometry-1.0.8/setup.cfg
--rw-rw-rw-   0        0        0     1548 2022-07-02 16:17:09.000000 fastrometry-1.0.8/setup.py
-drwxrwxrwx   0        0        0        0 2022-07-05 01:56:54.259778 fastrometry-1.0.8/src/
-drwxrwxrwx   0        0        0        0 2022-07-05 01:56:54.304684 fastrometry-1.0.8/src/fastrometry/
--rw-rw-rw-   0        0        0       43 2022-07-02 16:17:09.000000 fastrometry-1.0.8/src/fastrometry/__init__.py
--rw-rw-rw-   0        0        0     5577 2022-07-04 04:40:34.000000 fastrometry-1.0.8/src/fastrometry/catalogue.py
-drwxrwxrwx   0        0        0        0 2022-07-05 01:56:54.350024 fastrometry-1.0.8/src/fastrometry/cython_code/
--rw-rw-rw-   0        0        0  1521344 2022-07-04 03:24:36.000000 fastrometry-1.0.8/src/fastrometry/cython_code/PSE.c
--rw-rw-rw-   0        0        0  1951232 2022-07-04 03:44:31.000000 fastrometry-1.0.8/src/fastrometry/cython_code/WCS.c
--rw-rw-rw-   0        0        0       42 2022-07-02 16:17:09.000000 fastrometry-1.0.8/src/fastrometry/cython_code/__init__.py
--rw-rw-rw-   0        0        0    56821 2022-07-05 01:56:33.000000 fastrometry-1.0.8/src/fastrometry/fastrometry.py
-drwxrwxrwx   0        0        0        0 2022-07-05 01:56:54.346169 fastrometry-1.0.8/src/fastrometry.egg-info/
--rw-rw-rw-   0        0        0     1514 2022-07-05 01:56:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      589 2022-07-05 01:56:54.000000 fastrometry-1.0.8/src/fastrometry.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2022-07-05 01:56:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       76 2022-07-05 01:56:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/entry_points.txt
--rw-rw-rw-   0        0        0        2 2022-07-04 05:01:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0       77 2022-07-05 01:56:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/requires.txt
--rw-rw-rw-   0        0        0       12 2022-07-05 01:56:53.000000 fastrometry-1.0.8/src/fastrometry.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2022-07-26 15:33:58.227067 fastrometry-1.0.9/
+-rw-rw-rw-   0        0        0    35821 2022-07-02 16:17:09.000000 fastrometry-1.0.9/LICENSE
+-rw-rw-rw-   0        0        0     1514 2022-07-26 15:33:58.227067 fastrometry-1.0.9/PKG-INFO
+-rw-rw-rw-   0        0        0      415 2022-07-04 04:53:01.000000 fastrometry-1.0.9/README.md
+-rw-rw-rw-   0        0        0      226 2022-07-02 16:17:09.000000 fastrometry-1.0.9/pyproject.toml
+-rw-rw-rw-   0        0        0     1080 2022-07-26 15:33:58.229060 fastrometry-1.0.9/setup.cfg
+-rw-rw-rw-   0        0        0     1548 2022-07-02 16:17:09.000000 fastrometry-1.0.9/setup.py
+drwxrwxrwx   0        0        0        0 2022-07-26 15:33:58.182132 fastrometry-1.0.9/src/
+drwxrwxrwx   0        0        0        0 2022-07-26 15:33:58.209735 fastrometry-1.0.9/src/fastrometry/
+-rw-rw-rw-   0        0        0       43 2022-07-02 16:17:09.000000 fastrometry-1.0.9/src/fastrometry/__init__.py
+-rw-rw-rw-   0        0        0     4296 2022-07-24 11:54:35.000000 fastrometry-1.0.9/src/fastrometry/catalogue.py
+drwxrwxrwx   0        0        0        0 2022-07-26 15:33:58.226066 fastrometry-1.0.9/src/fastrometry/cython_code/
+-rw-rw-rw-   0        0        0  1454663 2022-07-26 14:08:54.000000 fastrometry-1.0.9/src/fastrometry/cython_code/PSE.c
+-rw-rw-rw-   0        0        0  1882025 2022-07-26 15:30:24.000000 fastrometry-1.0.9/src/fastrometry/cython_code/WCS.c
+-rw-rw-rw-   0        0        0       42 2022-07-02 16:17:09.000000 fastrometry-1.0.9/src/fastrometry/cython_code/__init__.py
+-rw-rw-rw-   0        0        0    50115 2022-07-26 15:06:54.000000 fastrometry-1.0.9/src/fastrometry/fastrometry.py
+-rw-rw-rw-   0        0        0        0 2022-07-21 13:05:16.000000 fastrometry-1.0.9/src/fastrometry/penile.py
+drwxrwxrwx   0        0        0        0 2022-07-26 15:33:58.224142 fastrometry-1.0.9/src/fastrometry.egg-info/
+-rw-rw-rw-   0        0        0     1514 2022-07-26 15:33:57.000000 fastrometry-1.0.9/src/fastrometry.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      615 2022-07-26 15:33:58.000000 fastrometry-1.0.9/src/fastrometry.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2022-07-26 15:33:57.000000 fastrometry-1.0.9/src/fastrometry.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       76 2022-07-26 15:33:57.000000 fastrometry-1.0.9/src/fastrometry.egg-info/entry_points.txt
+-rw-rw-rw-   0        0        0        2 2022-07-04 05:01:53.000000 fastrometry-1.0.9/src/fastrometry.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0       77 2022-07-26 15:33:57.000000 fastrometry-1.0.9/src/fastrometry.egg-info/requires.txt
+-rw-rw-rw-   0        0        0       12 2022-07-26 15:33:57.000000 fastrometry-1.0.9/src/fastrometry.egg-info/top_level.txt
```

### Comparing `fastrometry-1.0.8/LICENSE` & `fastrometry-1.0.9/LICENSE`

 * *Files identical despite different names*

### Comparing `fastrometry-1.0.8/PKG-INFO` & `fastrometry-1.0.9/PKG-INFO`

 * *Files 11% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastrometry
-Version: 1.0.8
+Version: 1.0.9
 Summary: Astrometry package written in Python
 Author: Cameron Leahy, Joseph Postma
 Author-email: cameron.leahy@ucalgary.ca, joepostma@live.ca
 Project-URL: Homepage, https://github.com/user29A/fastrometry/wiki
 Project-URL: Download, https://pypi.org/project/fastrometry/#files
 Project-URL: Source code, https://github.com/user29A/fastrometry
 Project-URL: Bug tracker, https://github.com/user29A/fastrometry/issues
```

### Comparing `fastrometry-1.0.8/setup.cfg` & `fastrometry-1.0.9/setup.cfg`

 * *Files identical despite different names*

### Comparing `fastrometry-1.0.8/setup.py` & `fastrometry-1.0.9/setup.py`

 * *Files identical despite different names*

### Comparing `fastrometry-1.0.8/src/fastrometry/catalogue.py` & `fastrometry-1.0.9/src/fastrometry/catalogue.py`

 * *Files 19% similar despite different names*

```diff
@@ -1,44 +1,13 @@
 import csv
 import numpy as np
 from math import sin, cos, pi
 from AstraCarta import astracarta
 import sys
 
-def printEvent(startmessage, endmessage, levelneeded):
-    """
-    This is a decorator factory, which returns a decorator.
-    The decorator's purpose is to return a wrapper, which
-    provides the original function (f) with extra utilities,
-    which in this case is a pair of verbosity-dependent
-    console messages, whose wording and needed verbosity
-    level are specified in the decorator factory arguments.
-    """
-    def decorator(f):
-        def wrapper(*args, **kwargs):
-            verbosity = args[-1]
-            if verbosity >= levelneeded:
-                print(startmessage)
-            fout = f(*args,**kwargs)
-            if verbosity >= levelneeded:
-                print(endmessage)
-            return fout
-        return wrapper
-    return decorator
-
-@printEvent("=======AstraCarta=======", "========================", 1)
-def astracartaWrapper(verbosity, **kwargs):
-    ret = astracarta(**kwargs)
-    return ret
-
-def vbprint(message, levelneeded, verbosity):
-    if verbosity >= levelneeded:
-        print(message)
-
-@printEvent("| Getting column data...", "| done", 1)
 def getColumnData(resultsfile, catalogue_points, filter, verbosity):
     if filter == "g":   
         filtername = "phot_g_mean_mag"
     elif filter == "bp":
         filtername = "phot_bp_mean_mag"
     elif filter == "rp":
         filtername = "phot_rp_mean_mag"
@@ -49,38 +18,37 @@
         for row in reader:
             catalogue_points[num_catsources,0] = float(row['ra'])*pi/180
             catalogue_points[num_catsources,1] = float(row['dec'])*pi/180
             catalogue_points[num_catsources,2] = float(row[filtername])
             num_catsources += 1
     return num_catsources
 
-@printEvent("| Gnomonically projecting sky coordinates...", "| done", 1)
 def gnomonicProject(catalogue_points, a0, d0, num_catsources, allintrmpoints, verbosity):
     for k in range(num_catsources):
         a = catalogue_points[k,0]
         d = catalogue_points[k,1]
         X = (cos(d)*sin(a-a0) / (cos(d0)*cos(d)*cos(a-a0)+sin(d0)*sin(d)))
         Y = (cos(d0)*sin(d) - cos(d)*sin(d0)*cos(a-a0)) / (cos(d0)*cos(d)*cos(a-a0) + sin(d0)*sin(d))
         allintrmpoints[k,0] = X
         allintrmpoints[k,1] = Y
 
-@printEvent("Getting intermediate coordinates...", "done", 1)
 def getIntermediateCoords(ra, dec, scale, img_xmax, img_ymax, shape, buffer, filter, catalogue, pmepoch, nrefinepts, allintrmpoints, catalogue_points, mean_catcoords, gaiaqueries, debug_report, overwrite, debug, verbosity):
 
     if verbosity == 0:
         silent = True
     else:
         silent = False
 
-    resultsfile = astracartaWrapper(verbosity, ra=ra, dec=dec, scale=scale*3600*180/pi, maglimit=30, pixwidth=img_xmax, pixheight=img_ymax, buffer=buffer*60, shape=shape, filter=filter, catalogue=catalogue, pmepoch=pmepoch, nquery=nrefinepts, outdir=gaiaqueries, silent=silent, overwrite=overwrite)
+    resultsfile = astracarta(ra=ra, dec=dec, scale=scale, maglimit=30, pixwidth=img_xmax, pixheight=img_ymax, buffer=buffer, shape=shape, filter=filter, catalogue=catalogue, pmepoch=pmepoch, nquery=nrefinepts, outdir=gaiaqueries, silent=silent, overwrite=overwrite)
     if resultsfile == '':
         sys.exit("ERROR: Catalogue query failed to complete.")
 
     num_catsources = getColumnData(resultsfile, catalogue_points, filter, verbosity)
-    vbprint("| Got {} valid sky coordinates from the catalogue.".format(num_catsources), 2, verbosity)
+    if verbosity == 2:
+        print("| Got {} valid sky coordinates from the catalogue.".format(num_catsources))
 
     a0 = np.mean(catalogue_points[:,0])
     d0 = np.mean(catalogue_points[:,1])
 
     mean_catcoords[0] = a0
     mean_catcoords[1] = d0
```

### Comparing `fastrometry-1.0.8/src/fastrometry/cython_code/PSE.c` & `fastrometry-1.0.9/src/fastrometry/cython_code/PSE.c`

 * *Files 4% similar despite different names*

```diff
@@ -1275,16 +1275,14 @@
 #else
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
-struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent;
-struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
 /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
@@ -1318,43 +1316,14 @@
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
 
-/* "fastrometry/cython_code/PSE.pyx":7
- * import cython
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent {
-  PyObject_HEAD
-  PyObject *__pyx_v_endmessage;
-  PyObject *__pyx_v_levelneeded;
-  PyObject *__pyx_v_startmessage;
-};
-
-
-/* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator {
-  PyObject_HEAD
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *__pyx_outer_scope;
-  PyObject *__pyx_v_f;
-};
-
-
 /* "View.MemoryView":105
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1558,112 +1527,14 @@
 static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
 
 /* ParseKeywords.proto */
 static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
     PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
     const char* function_name);
 
-/* KeywordStringCheck.proto */
-static int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);
-
-/* GetItemInt.proto */
-#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
-    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
-               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
-#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
-                                                     int is_list, int wraparound, int boundscheck);
-
-/* None.proto */
-static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);
-
-/* PyObjectCall.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
-#else
-#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
-#endif
-
-/* FetchCommonType.proto */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
-
-/* CythonFunctionShared.proto */
-#define __Pyx_CyFunction_USED 1
-#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
-#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
-#define __Pyx_CYFUNCTION_CCLASS        0x04
-#define __Pyx_CyFunction_GetClosure(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_closure)
-#define __Pyx_CyFunction_GetClassObj(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_classobj)
-#define __Pyx_CyFunction_Defaults(type, f)\
-    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
-#define __Pyx_CyFunction_SetDefaultsGetter(f, g)\
-    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
-typedef struct {
-    PyCFunctionObject func;
-#if PY_VERSION_HEX < 0x030500A0
-    PyObject *func_weakreflist;
-#endif
-    PyObject *func_dict;
-    PyObject *func_name;
-    PyObject *func_qualname;
-    PyObject *func_doc;
-    PyObject *func_globals;
-    PyObject *func_code;
-    PyObject *func_closure;
-    PyObject *func_classobj;
-    void *defaults;
-    int defaults_pyobjects;
-    size_t defaults_size;  // used by FusedFunction for copying defaults
-    int flags;
-    PyObject *defaults_tuple;
-    PyObject *defaults_kwdict;
-    PyObject *(*defaults_getter)(PyObject *);
-    PyObject *func_annotations;
-} __pyx_CyFunctionObject;
-static PyTypeObject *__pyx_CyFunctionType = 0;
-#define __Pyx_CyFunction_Check(obj)  (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject* op, PyMethodDef *ml,
-                                      int flags, PyObject* qualname,
-                                      PyObject *self,
-                                      PyObject *module, PyObject *globals,
-                                      PyObject* code);
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
-                                                         size_t size,
-                                                         int pyobjects);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
-                                                            PyObject *tuple);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
-                                                             PyObject *dict);
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
-                                                              PyObject *dict);
-static int __pyx_CyFunction_init(void);
-
-/* CythonFunction.proto */
-static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml,
-                                      int flags, PyObject* qualname,
-                                      PyObject *closure,
-                                      PyObject *module, PyObject *globals,
-                                      PyObject* code);
-
 /* Import.proto */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);
 
 /* ImportFrom.proto */
 static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);
 
 /* PyCFunctionFastCall.proto */
@@ -1700,25 +1571,54 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyObjectCall.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
+#else
+#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
+#endif
+
 /* PyObjectCall2Args.proto */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
 
 /* PyObjectCallOneArg.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);
 
+/* GetItemInt.proto */
+#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
+    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
+               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
+#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
+                                                     int is_list, int wraparound, int boundscheck);
+
 /* PyIntBinop.proto */
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, long intval, int inplace, int zerodivision_check);
 #else
 #define __Pyx_PyInt_AddObjC(op1, op2, intval, inplace, zerodivision_check)\
     (inplace ? PyNumber_InPlaceAdd(op1, op2) : PyNumber_Add(op1, op2))
 #endif
@@ -2171,21 +2071,14 @@
 static CYTHON_INLINE PyObject *__pyx_capsule_create(void *p, const char *sig);
 
 /* GCCDiagnostics.proto */
 #if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
 #define __Pyx_HAS_GCC_DIAGNOSTIC
 #endif
 
-/* Print.proto */
-static int __Pyx_Print(PyObject*, PyObject *, int);
-#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
-static PyObject* __pyx_print = 0;
-static PyObject* __pyx_print_kwargs = 0;
-#endif
-
 /* TypeInfoCompare.proto */
 static int __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b);
 
 /* MemviewSliceValidateAndInit.proto */
 static int __Pyx_ValidateAndInit_memviewslice(
                 int *axes_specs,
                 int c_or_f_flag,
@@ -2201,14 +2094,21 @@
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_int(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
+/* Print.proto */
+static int __Pyx_Print(PyObject*, PyObject *, int);
+#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
+static PyObject* __pyx_print = 0;
+static PyObject* __pyx_print_kwargs = 0;
+#endif
+
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *, int writable_flag);
 
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     #define __Pyx_CREAL(z) ((z).real())
@@ -2312,23 +2212,23 @@
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
-/* PrintOne.proto */
-static int __Pyx_PrintOne(PyObject* stream, PyObject *o);
-
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
+/* PrintOne.proto */
+static int __Pyx_PrintOne(PyObject* stream, PyObject *o);
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CheckBinaryVersion.proto */
@@ -2389,16 +2289,14 @@
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'cython.view' */
 
 /* Module declarations from 'cython' */
 
 /* Module declarations from 'fastrometry.cython_code.PSE' */
-static PyTypeObject *__pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent = 0;
-static PyTypeObject *__pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
 static PyTypeObject *__pyx_memoryviewslice_type = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
@@ -2465,44 +2363,41 @@
 static PyObject *__pyx_builtin_enumerate;
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static const char __pyx_k_O[] = "O";
 static const char __pyx_k_c[] = "c";
-static const char __pyx_k_f[] = "f";
-static const char __pyx_k__6[] = "*";
-static const char __pyx_k__9[] = ",";
+static const char __pyx_k__2[] = "*";
+static const char __pyx_k__5[] = ",";
 static const char __pyx_k_cm[] = "cm";
 static const char __pyx_k_ha[] = "ha";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_nm[] = "nm";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_PSE[] = "PSE";
 static const char __pyx_k_ROI[] = "ROI";
-static const char __pyx_k__17[] = ".";
+static const char __pyx_k__13[] = ".";
 static const char __pyx_k_end[] = "end";
 static const char __pyx_k_img[] = "img";
 static const char __pyx_k_inf[] = "inf";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_plt[] = "plt";
 static const char __pyx_k_red[] = "red";
 static const char __pyx_k_roi[] = "roi";
-static const char __pyx_k_args[] = "args";
 static const char __pyx_k_base[] = "base";
 static const char __pyx_k_blue[] = "blue";
 static const char __pyx_k_both[] = "both";
 static const char __pyx_k_cmap[] = "cmap";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_done[] = "| | done";
 static const char __pyx_k_file[] = "file";
 static const char __pyx_k_fits[] = "fits";
-static const char __pyx_k_fout[] = "fout";
 static const char __pyx_k_gold[] = "gold";
 static const char __pyx_k_gray[] = "gray";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_navy[] = "navy";
 static const char __pyx_k_ndim[] = "ndim";
@@ -2544,15 +2439,14 @@
 static const char __pyx_k_double[] = "double";
 static const char __pyx_k_encode[] = "encode";
 static const char __pyx_k_extend[] = "extend";
 static const char __pyx_k_figure[] = "figure";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_imshow[] = "imshow";
-static const char __pyx_k_kwargs[] = "kwargs";
 static const char __pyx_k_marker[] = "marker";
 static const char __pyx_k_median[] = "median";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_pixsat[] = "pixsat";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
@@ -2569,15 +2463,14 @@
 static const char __pyx_k_img_max[] = "img_max";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_neither[] = "neither";
 static const char __pyx_k_savefig[] = "savefig";
 static const char __pyx_k_savetxt[] = "savetxt";
 static const char __pyx_k_scatter[] = "scatter";
 static const char __pyx_k_textpos[] = "textpos";
-static const char __pyx_k_wrapper[] = "wrapper";
 static const char __pyx_k_Ellipsis[] = "Ellipsis";
 static const char __pyx_k_colorbar[] = "colorbar";
 static const char __pyx_k_filepath[] = "filepath";
 static const char __pyx_k_fontsize[] = "fontsize";
 static const char __pyx_k_getstate[] = "__getstate__";
 static const char __pyx_k_img_xmax[] = "img_xmax";
 static const char __pyx_k_img_ymax[] = "img_ymax";
@@ -2585,49 +2478,44 @@
 static const char __pyx_k_pyx_type[] = "__pyx_type";
 static const char __pyx_k_savename[] = "savename";
 static const char __pyx_k_setstate[] = "__setstate__";
 static const char __pyx_k_Iteration[] = "| | | Iteration: {}";
 static const char __pyx_k_Normalize[] = "Normalize";
 static const char __pyx_k_TypeError[] = "TypeError";
 static const char __pyx_k_bgmap_png[] = "bgmap.png";
-static const char __pyx_k_decorator[] = "decorator";
 static const char __pyx_k_delimiter[] = "delimiter";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_kernelrad[] = "kernelrad";
 static const char __pyx_k_occupymap[] = "occupymap";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_rectangle[] = "rectangle";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_sourcesep[] = "sourcesep";
 static const char __pyx_k_verbosity[] = "verbosity";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_astropy_io[] = "astropy.io";
 static const char __pyx_k_boundaries[] = "boundaries";
-static const char __pyx_k_endmessage[] = "endmessage";
 static const char __pyx_k_image_data[] = "image_data";
 static const char __pyx_k_img_median[] = "img_median";
 static const char __pyx_k_kernelsize[] = "kernelsize";
 static const char __pyx_k_nrefinepts[] = "nrefinepts";
 static const char __pyx_k_percentile[] = "percentile";
-static const char __pyx_k_printEvent[] = "printEvent";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
-static const char __pyx_k_levelneeded[] = "levelneeded";
 static const char __pyx_k_pixelradius[] = "pixelradius";
 static const char __pyx_k_curr_src_ind[] = "curr_src_ind";
 static const char __pyx_k_debug_report[] = "debug_report";
 static const char __pyx_k_debuggerPlot[] = "debuggerPlot";
 static const char __pyx_k_kernelcircle[] = "kernelcircle";
 static const char __pyx_k_pse_metadata[] = "pse_metadata";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
-static const char __pyx_k_startmessage[] = "startmessage";
 static const char __pyx_k_stringsource[] = "stringsource";
 static const char __pyx_k_Max_amplitude[] = "| Max amplitude: {}";
 static const char __pyx_k_Sources_found[] = "| | | Sources found: {}";
 static const char __pyx_k_colbar_extend[] = "colbar_extend";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
 static const char __pyx_k_sourcesepsize[] = "sourcesepsize";
@@ -2669,15 +2557,14 @@
 static const char __pyx_k_Found_saturation_islands[] = "| | Found {} saturation islands.";
 static const char __pyx_k_Finding_remaining_sources[] = "| Finding remaining sources...";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
 static const char __pyx_k_Finding_saturation_islands[] = "| Finding saturation islands...";
 static const char __pyx_k_pse_metadata_centroids_png[] = "pse_metadata_centroids.png";
 static const char __pyx_k_fastrometry_cython_code_PSE[] = "fastrometry.cython_code.PSE";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
-static const char __pyx_k_printEvent_locals_decorator[] = "printEvent.<locals>.decorator";
 static const char __pyx_k_pse_metadata_allsources_csv[] = "pse_metadata_allsources.csv";
 static const char __pyx_k_pse_metadata_islandsonly_csv[] = "pse_metadata_islandsonly.csv";
 static const char __pyx_k_Extracting_sources_from_image[] = "Extracting sources from image...";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_Found_sources_total_Trimmed_to[] = "| | Found {} sources total. Trimmed to {} sources.";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_Centroids_and_brightnesses_plac[] = "| | Centroids and brightnesses placed in pse_metadata.";
@@ -2701,15 +2588,14 @@
 static const char __pyx_k_Out_of_bounds_on_buffer_access_a[] = "Out of bounds on buffer access (axis %d)";
 static const char __pyx_k_Region_to_be_scanned_by_PSE_Spec[] = "Region to be scanned by PSE. Specified by the options shape and buffer.";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_Used_for_determining_the_amplitu[] = "Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
-static const char __pyx_k_printEvent_locals_decorator_loca[] = "printEvent.<locals>.decorator.<locals>.wrapper";
 static const char __pyx_k_pse_metadata_allsources_sorted_c[] = "pse_metadata_allsources_sorted.csv";
 static const char __pyx_k_pse_metadata_allsources_sorted_z[] = "pse_metadata_allsources_sorted_zerosmoved.csv";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_The_occupied_source_kernels_for_2[] = "The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.";
 static const char __pyx_k_The_occupied_source_kernels_for_3[] = "The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.";
 static const char __pyx_k_brightest_kernels_drawn_to_srci_2[] = "| | {} brightest kernels drawn to srcindexmap_refine.";
 static PyObject *__pyx_n_s_ASCII;
@@ -2761,19 +2647,18 @@
 static PyObject *__pyx_kp_s_Trying_various_pixel_thresholds;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_kp_s_Unsuccessful_at_finding_sources;
 static PyObject *__pyx_kp_s_Used_for_determining_the_amplitu;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
-static PyObject *__pyx_kp_s__17;
-static PyObject *__pyx_n_s__6;
-static PyObject *__pyx_kp_s__9;
+static PyObject *__pyx_kp_s__13;
+static PyObject *__pyx_n_s__2;
+static PyObject *__pyx_kp_s__5;
 static PyObject *__pyx_n_s_allocate_buffer;
-static PyObject *__pyx_n_s_args;
 static PyObject *__pyx_n_s_argsort;
 static PyObject *__pyx_n_s_array;
 static PyObject *__pyx_n_s_astropy_io;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_bgmap;
 static PyObject *__pyx_kp_s_bgmap_png;
 static PyObject *__pyx_n_s_blue;
@@ -2798,44 +2683,40 @@
 static PyObject *__pyx_n_s_colors;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
 static PyObject *__pyx_n_s_curr_src_ind;
 static PyObject *__pyx_n_s_debug;
 static PyObject *__pyx_n_s_debug_report;
 static PyObject *__pyx_n_s_debuggerPlot;
-static PyObject *__pyx_n_s_decorator;
 static PyObject *__pyx_n_s_delimiter;
 static PyObject *__pyx_n_s_dict;
 static PyObject *__pyx_kp_s_done;
 static PyObject *__pyx_kp_s_done_2;
 static PyObject *__pyx_n_s_done_3;
 static PyObject *__pyx_n_s_double;
 static PyObject *__pyx_n_s_dscrp;
 static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_dtype_is_object;
 static PyObject *__pyx_n_s_encode;
 static PyObject *__pyx_n_s_end;
-static PyObject *__pyx_n_s_endmessage;
 static PyObject *__pyx_n_s_enumerate;
 static PyObject *__pyx_n_s_error;
 static PyObject *__pyx_n_s_extend;
-static PyObject *__pyx_n_s_f;
 static PyObject *__pyx_n_s_fastrometry_cython_code_PSE;
 static PyObject *__pyx_n_s_figsize;
 static PyObject *__pyx_n_s_figtext;
 static PyObject *__pyx_n_s_figure;
 static PyObject *__pyx_n_s_file;
 static PyObject *__pyx_n_s_filepath;
 static PyObject *__pyx_n_s_fits;
 static PyObject *__pyx_n_s_flags;
 static PyObject *__pyx_n_s_fontsize;
 static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_fortran;
 static PyObject *__pyx_n_u_fortran;
-static PyObject *__pyx_n_s_fout;
 static PyObject *__pyx_n_s_getdata;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_n_s_gold;
 static PyObject *__pyx_kp_s_got_differing_extents_in_dimensi;
 static PyObject *__pyx_n_s_gray;
 static PyObject *__pyx_n_s_ha;
 static PyObject *__pyx_n_s_id;
@@ -2849,17 +2730,15 @@
 static PyObject *__pyx_n_s_imshow;
 static PyObject *__pyx_n_s_inf;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
 static PyObject *__pyx_n_s_kernelcircle;
 static PyObject *__pyx_n_s_kernelrad;
 static PyObject *__pyx_n_s_kernelsize;
-static PyObject *__pyx_n_s_kwargs;
 static PyObject *__pyx_n_s_leftmostsafe_x;
-static PyObject *__pyx_n_s_levelneeded;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_marker;
 static PyObject *__pyx_n_s_matplotlib_colors;
 static PyObject *__pyx_n_s_matplotlib_pyplot;
 static PyObject *__pyx_n_s_max;
 static PyObject *__pyx_n_s_median;
 static PyObject *__pyx_n_s_memview;
@@ -2886,17 +2765,14 @@
 static PyObject *__pyx_n_s_pack;
 static PyObject *__pyx_n_s_percentile;
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_pixelradius;
 static PyObject *__pyx_n_s_pixsat;
 static PyObject *__pyx_n_s_plt;
 static PyObject *__pyx_n_s_print;
-static PyObject *__pyx_n_s_printEvent;
-static PyObject *__pyx_n_s_printEvent_locals_decorator;
-static PyObject *__pyx_n_s_printEvent_locals_decorator_loca;
 static PyObject *__pyx_n_s_pse_metadata;
 static PyObject *__pyx_kp_s_pse_metadata_allsources_csv;
 static PyObject *__pyx_kp_s_pse_metadata_allsources_sorted_c;
 static PyObject *__pyx_kp_s_pse_metadata_allsources_sorted_z;
 static PyObject *__pyx_kp_s_pse_metadata_centroids;
 static PyObject *__pyx_kp_s_pse_metadata_centroids_png;
 static PyObject *__pyx_kp_s_pse_metadata_csv;
@@ -2932,15 +2808,14 @@
 static PyObject *__pyx_n_s_sourcesepsize;
 static PyObject *__pyx_kp_s_src_fastrometry_cython_code_PSE;
 static PyObject *__pyx_n_s_srcindexmap_initial;
 static PyObject *__pyx_kp_s_srcindexmap_initial_png;
 static PyObject *__pyx_n_s_srcindexmap_refine;
 static PyObject *__pyx_kp_s_srcindexmap_refine_png;
 static PyObject *__pyx_n_s_start;
-static PyObject *__pyx_n_s_startmessage;
 static PyObject *__pyx_n_s_step;
 static PyObject *__pyx_n_s_stop;
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_struct;
@@ -2952,22 +2827,18 @@
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_unpack;
 static PyObject *__pyx_n_s_update;
 static PyObject *__pyx_n_s_verbosity;
 static PyObject *__pyx_n_s_vmax;
 static PyObject *__pyx_n_s_vmin;
-static PyObject *__pyx_n_s_wrapper;
 static PyObject *__pyx_n_s_yellow;
 static PyObject *__pyx_n_s_zeros;
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_decorator(PyObject *__pyx_self, PyObject *__pyx_v_f); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_printEvent(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_startmessage, PyObject *__pyx_v_endmessage, PyObject *__pyx_v_levelneeded); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_2debuggerPlot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_array, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_savename, PyObject *__pyx_v_figsize, PyObject *__pyx_v_bottom, PyObject *__pyx_v_vmin, PyObject *__pyx_v_vmax, PyObject *__pyx_v_colbar, PyObject *__pyx_v_colbar_extend, PyObject *__pyx_v_title, PyObject *__pyx_v_dscrp, PyObject *__pyx_v_textpos, PyObject *__pyx_v_colors, PyObject *__pyx_v_boundaries); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_4PSE(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_kernelrad, PyObject *__pyx_v_sourcesep, PyObject *__pyx_v_pixsat, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_pixelradius, PyObject *__pyx_v_shape, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_debuggerPlot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_array, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_savename, PyObject *__pyx_v_figsize, PyObject *__pyx_v_bottom, PyObject *__pyx_v_vmin, PyObject *__pyx_v_vmax, PyObject *__pyx_v_colbar, PyObject *__pyx_v_colbar_extend, PyObject *__pyx_v_title, PyObject *__pyx_v_dscrp, PyObject *__pyx_v_textpos, PyObject *__pyx_v_colors, PyObject *__pyx_v_boundaries); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_2PSE(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_kernelrad, PyObject *__pyx_v_sourcesep, PyObject *__pyx_v_pixsat, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_pixelradius, PyObject *__pyx_v_shape, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -3002,16 +2873,14 @@
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_float_0_1;
 static PyObject *__pyx_float_0_2;
 static PyObject *__pyx_float_0_5;
@@ -3074,25 +2943,27 @@
 static PyObject *__pyx_int_6077;
 static PyObject *__pyx_int_6361;
 static PyObject *__pyx_int_112105877;
 static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_tuple_;
+static PyObject *__pyx_slice__6;
+static PyObject *__pyx_slice__8;
 static PyObject *__pyx_tuple__3;
-static PyObject *__pyx_tuple__5;
+static PyObject *__pyx_tuple__4;
 static PyObject *__pyx_tuple__7;
-static PyObject *__pyx_tuple__8;
-static PyObject *__pyx_slice__10;
-static PyObject *__pyx_slice__12;
+static PyObject *__pyx_tuple__9;
+static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__11;
-static PyObject *__pyx_tuple__13;
+static PyObject *__pyx_tuple__12;
 static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
 static PyObject *__pyx_tuple__16;
+static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
 static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
@@ -3102,487 +2973,38 @@
 static PyObject *__pyx_tuple__28;
 static PyObject *__pyx_tuple__29;
 static PyObject *__pyx_tuple__30;
 static PyObject *__pyx_tuple__31;
 static PyObject *__pyx_tuple__32;
 static PyObject *__pyx_tuple__33;
 static PyObject *__pyx_tuple__34;
-static PyObject *__pyx_tuple__35;
 static PyObject *__pyx_tuple__36;
-static PyObject *__pyx_tuple__37;
 static PyObject *__pyx_tuple__38;
+static PyObject *__pyx_tuple__39;
 static PyObject *__pyx_tuple__40;
+static PyObject *__pyx_tuple__41;
 static PyObject *__pyx_tuple__42;
 static PyObject *__pyx_tuple__43;
-static PyObject *__pyx_tuple__45;
-static PyObject *__pyx_tuple__46;
-static PyObject *__pyx_tuple__47;
-static PyObject *__pyx_tuple__48;
-static PyObject *__pyx_tuple__49;
-static PyObject *__pyx_tuple__50;
-static PyObject *__pyx_codeobj__2;
-static PyObject *__pyx_codeobj__4;
-static PyObject *__pyx_codeobj__39;
-static PyObject *__pyx_codeobj__41;
+static PyObject *__pyx_codeobj__35;
+static PyObject *__pyx_codeobj__37;
 static PyObject *__pyx_codeobj__44;
-static PyObject *__pyx_codeobj__51;
 /* Late includes */
 
 /* "fastrometry/cython_code/PSE.pyx":7
  * import cython
  * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_1printEvent(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3PSE_printEvent[] = "\n    This is a decorator factory, which returns a decorator.\n    The decorator's purpose is to return a wrapper, which\n    provides the original function (f) with extra utilities,\n    which in this case is a pair of verbosity-dependent\n    console messages, whose wording and needed verbosity\n    level are specified in the decorator factory arguments.\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_1printEvent = {"printEvent", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_1printEvent, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3PSE_printEvent};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_1printEvent(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_startmessage = 0;
-  PyObject *__pyx_v_endmessage = 0;
-  PyObject *__pyx_v_levelneeded = 0;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("printEvent (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_startmessage,&__pyx_n_s_endmessage,&__pyx_n_s_levelneeded,0};
-    PyObject* values[3] = {0,0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_startmessage)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_endmessage)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, 1); __PYX_ERR(0, 7, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_levelneeded)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, 2); __PYX_ERR(0, 7, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "printEvent") < 0)) __PYX_ERR(0, 7, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-    }
-    __pyx_v_startmessage = values[0];
-    __pyx_v_endmessage = values[1];
-    __pyx_v_levelneeded = values[2];
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 7, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("fastrometry.cython_code.PSE.printEvent", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_printEvent(__pyx_self, __pyx_v_startmessage, __pyx_v_endmessage, __pyx_v_levelneeded);
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_1decorator(PyObject *__pyx_self, PyObject *__pyx_v_f); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_10printEvent_1decorator = {"decorator", (PyCFunction)__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_1decorator, METH_O, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_1decorator(PyObject *__pyx_self, PyObject *__pyx_v_f) {
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("decorator (wrapper)", 0);
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_decorator(__pyx_self, ((PyObject *)__pyx_v_f));
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/PSE.pyx":17
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_args = 0;
-  PyObject *__pyx_v_kwargs = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("wrapper (wrapper)", 0);
-  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "wrapper", 1))) return NULL;
-  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
-  __Pyx_GOTREF(__pyx_v_kwargs);
-  __Pyx_INCREF(__pyx_args);
-  __pyx_v_args = __pyx_args;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);
-
-  /* function exit code */
-  __Pyx_XDECREF(__pyx_v_args);
-  __Pyx_XDECREF(__pyx_v_kwargs);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *__pyx_cur_scope;
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *__pyx_outer_scope;
-  PyObject *__pyx_v_verbosity = NULL;
-  PyObject *__pyx_v_fout = NULL;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("wrapper", 0);
-  __pyx_outer_scope = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *) __Pyx_CyFunction_GetClosure(__pyx_self);
-  __pyx_cur_scope = __pyx_outer_scope;
-
-  /* "fastrometry/cython_code/PSE.pyx":18
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]             # <<<<<<<<<<<<<<
- *             if verbosity >= levelneeded:
- *                 print(startmessage)
- */
-  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v_args, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_verbosity = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":19
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded)) { __Pyx_RaiseClosureNameError("levelneeded"); __PYX_ERR(0, 19, __pyx_L1_error) }
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 19, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__pyx_t_2) {
-
-    /* "fastrometry/cython_code/PSE.pyx":20
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- *                 print(startmessage)             # <<<<<<<<<<<<<<
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:
- */
-    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_startmessage)) { __Pyx_RaiseClosureNameError("startmessage"); __PYX_ERR(0, 20, __pyx_L1_error) }
-    if (__Pyx_PrintOne(0, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_startmessage) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
-
-    /* "fastrometry/cython_code/PSE.pyx":19
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- */
-  }
-
-  /* "fastrometry/cython_code/PSE.pyx":21
- *             if verbosity >= levelneeded:
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)             # <<<<<<<<<<<<<<
- *             if verbosity >= levelneeded:
- *                 print(endmessage)
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_v_f)) { __Pyx_RaiseClosureNameError("f"); __PYX_ERR(0, 21, __pyx_L1_error) }
-  __pyx_t_1 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_cur_scope->__pyx_v_f, __pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_fout = __pyx_t_3;
-  __pyx_t_3 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":22
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(endmessage)
- *             return fout
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded)) { __Pyx_RaiseClosureNameError("levelneeded"); __PYX_ERR(0, 22, __pyx_L1_error) }
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 22, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_2) {
-
-    /* "fastrometry/cython_code/PSE.pyx":23
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:
- *                 print(endmessage)             # <<<<<<<<<<<<<<
- *             return fout
- *         return wrapper
- */
-    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_endmessage)) { __Pyx_RaiseClosureNameError("endmessage"); __PYX_ERR(0, 23, __pyx_L1_error) }
-    if (__Pyx_PrintOne(0, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_endmessage) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
-
-    /* "fastrometry/cython_code/PSE.pyx":22
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(endmessage)
- *             return fout
- */
-  }
-
-  /* "fastrometry/cython_code/PSE.pyx":24
- *             if verbosity >= levelneeded:
- *                 print(endmessage)
- *             return fout             # <<<<<<<<<<<<<<
- *         return wrapper
- *     return decorator
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_fout);
-  __pyx_r = __pyx_v_fout;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/PSE.pyx":17
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_AddTraceback("fastrometry.cython_code.PSE.printEvent.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_verbosity);
-  __Pyx_XDECREF(__pyx_v_fout);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_10printEvent_decorator(PyObject *__pyx_self, PyObject *__pyx_v_f) {
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *__pyx_cur_scope;
-  PyObject *__pyx_v_wrapper = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("decorator", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(__pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator, __pyx_empty_tuple, NULL);
-  if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)Py_None);
-    __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 16, __pyx_L1_error)
-  } else {
-    __Pyx_GOTREF(__pyx_cur_scope);
-  }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *) __Pyx_CyFunction_GetClosure(__pyx_self);
-  __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
-  __pyx_cur_scope->__pyx_v_f = __pyx_v_f;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_f);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_f);
-
-  /* "fastrometry/cython_code/PSE.pyx":17
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11fastrometry_11cython_code_3PSE_10printEvent_9decorator_1wrapper, 0, __pyx_n_s_printEvent_locals_decorator_loca, ((PyObject*)__pyx_cur_scope), __pyx_n_s_fastrometry_cython_code_PSE, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_wrapper = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":25
- *                 print(endmessage)
- *             return fout
- *         return wrapper             # <<<<<<<<<<<<<<
- *     return decorator
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_wrapper);
-  __pyx_r = __pyx_v_wrapper;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("fastrometry.cython_code.PSE.printEvent.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_wrapper);
-  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/PSE.pyx":7
- * import cython
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_printEvent(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_startmessage, PyObject *__pyx_v_endmessage, PyObject *__pyx_v_levelneeded) {
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *__pyx_cur_scope;
-  PyObject *__pyx_v_decorator = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("printEvent", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(__pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent, __pyx_empty_tuple, NULL);
-  if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)Py_None);
-    __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 7, __pyx_L1_error)
-  } else {
-    __Pyx_GOTREF(__pyx_cur_scope);
-  }
-  __pyx_cur_scope->__pyx_v_startmessage = __pyx_v_startmessage;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_startmessage);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_startmessage);
-  __pyx_cur_scope->__pyx_v_endmessage = __pyx_v_endmessage;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_endmessage);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_endmessage);
-  __pyx_cur_scope->__pyx_v_levelneeded = __pyx_v_levelneeded;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_levelneeded);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_levelneeded);
-
-  /* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11fastrometry_11cython_code_3PSE_10printEvent_1decorator, 0, __pyx_n_s_printEvent_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_fastrometry_cython_code_PSE, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_decorator = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":26
- *             return fout
- *         return wrapper
- *     return decorator             # <<<<<<<<<<<<<<
- * 
- * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_decorator);
-  __pyx_r = __pyx_v_decorator;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/PSE.pyx":7
- * import cython
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("fastrometry.cython_code.PSE.printEvent", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_decorator);
-  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/PSE.pyx":28
- *     return decorator
- * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):             # <<<<<<<<<<<<<<
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_3debuggerPlot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_3debuggerPlot = {"debuggerPlot", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_3debuggerPlot, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_3debuggerPlot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_1debuggerPlot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_1debuggerPlot = {"debuggerPlot", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_1debuggerPlot, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_1debuggerPlot(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_array = 0;
   PyObject *__pyx_v_debug_report = 0;
   PyObject *__pyx_v_savename = 0;
   PyObject *__pyx_v_figsize = 0;
   PyObject *__pyx_v_bottom = 0;
   PyObject *__pyx_v_vmin = 0;
   PyObject *__pyx_v_vmax = 0;
@@ -3598,15 +3020,15 @@
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("debuggerPlot (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_array,&__pyx_n_s_debug_report,&__pyx_n_s_savename,&__pyx_n_s_figsize,&__pyx_n_s_bottom,&__pyx_n_s_vmin,&__pyx_n_s_vmax,&__pyx_n_s_colbar,&__pyx_n_s_colbar_extend,&__pyx_n_s_title,&__pyx_n_s_dscrp,&__pyx_n_s_textpos,&__pyx_n_s_colors,&__pyx_n_s_boundaries,0};
     PyObject* values[14] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0};
-    values[3] = ((PyObject *)__pyx_tuple__5);
+    values[3] = ((PyObject *)__pyx_tuple_);
     values[4] = ((PyObject *)__pyx_float_0_2);
     values[5] = ((PyObject *)Py_None);
     values[6] = ((PyObject *)Py_None);
     values[7] = ((PyObject *)Py_False);
     values[8] = ((PyObject *)Py_False);
     values[9] = ((PyObject *)Py_None);
     values[10] = ((PyObject *)Py_None);
@@ -3653,21 +3075,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_array)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_debug_report)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, 1); __PYX_ERR(0, 28, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, 1); __PYX_ERR(0, 7, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_savename)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, 2); __PYX_ERR(0, 28, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, 2); __PYX_ERR(0, 7, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_figsize);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -3729,15 +3151,15 @@
         case 13:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_boundaries);
           if (value) { values[13] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "debuggerPlot") < 0)) __PYX_ERR(0, 28, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "debuggerPlot") < 0)) __PYX_ERR(0, 7, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 14: values[13] = PyTuple_GET_ITEM(__pyx_args, 13);
         CYTHON_FALLTHROUGH;
         case 13: values[12] = PyTuple_GET_ITEM(__pyx_args, 12);
         CYTHON_FALLTHROUGH;
@@ -3779,28 +3201,28 @@
     __pyx_v_dscrp = values[10];
     __pyx_v_textpos = values[11];
     __pyx_v_colors = values[12];
     __pyx_v_boundaries = values[13];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 28, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("debuggerPlot", 0, 3, 14, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 7, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.PSE.debuggerPlot", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_2debuggerPlot(__pyx_self, __pyx_v_array, __pyx_v_debug_report, __pyx_v_savename, __pyx_v_figsize, __pyx_v_bottom, __pyx_v_vmin, __pyx_v_vmax, __pyx_v_colbar, __pyx_v_colbar_extend, __pyx_v_title, __pyx_v_dscrp, __pyx_v_textpos, __pyx_v_colors, __pyx_v_boundaries);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_debuggerPlot(__pyx_self, __pyx_v_array, __pyx_v_debug_report, __pyx_v_savename, __pyx_v_figsize, __pyx_v_bottom, __pyx_v_vmin, __pyx_v_vmax, __pyx_v_colbar, __pyx_v_colbar_extend, __pyx_v_title, __pyx_v_dscrp, __pyx_v_textpos, __pyx_v_colors, __pyx_v_boundaries);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_2debuggerPlot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_array, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_savename, PyObject *__pyx_v_figsize, PyObject *__pyx_v_bottom, PyObject *__pyx_v_vmin, PyObject *__pyx_v_vmax, PyObject *__pyx_v_colbar, PyObject *__pyx_v_colbar_extend, PyObject *__pyx_v_title, PyObject *__pyx_v_dscrp, PyObject *__pyx_v_textpos, PyObject *__pyx_v_colors, PyObject *__pyx_v_boundaries) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_debuggerPlot(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_array, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_savename, PyObject *__pyx_v_figsize, PyObject *__pyx_v_bottom, PyObject *__pyx_v_vmin, PyObject *__pyx_v_vmax, PyObject *__pyx_v_colbar, PyObject *__pyx_v_colbar_extend, PyObject *__pyx_v_title, PyObject *__pyx_v_dscrp, PyObject *__pyx_v_textpos, PyObject *__pyx_v_colors, PyObject *__pyx_v_boundaries) {
   PyObject *__pyx_v_plt = NULL;
   PyObject *__pyx_v_Normalize = NULL;
   PyObject *__pyx_v_ListedColormap = NULL;
   PyObject *__pyx_v_extend = NULL;
   PyObject *__pyx_v_cm = NULL;
   PyObject *__pyx_v_nm = NULL;
   PyObject *__pyx_r = NULL;
@@ -3812,152 +3234,152 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("debuggerPlot", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":29
+  /* "fastrometry/cython_code/PSE.pyx":8
  * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):
  *     import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *     from matplotlib.colors import Normalize
  *     from matplotlib.colors import ListedColormap
  */
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_n_s__6);
-  __Pyx_GIVEREF(__pyx_n_s__6);
-  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__6);
-  __pyx_t_2 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
+  __Pyx_INCREF(__pyx_n_s__2);
+  __Pyx_GIVEREF(__pyx_n_s__2);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__2);
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_plt = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":30
+  /* "fastrometry/cython_code/PSE.pyx":9
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize             # <<<<<<<<<<<<<<
  *     from matplotlib.colors import ListedColormap
  * 
  */
-  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_t_2 = PyList_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_n_s_Normalize);
   __Pyx_GIVEREF(__pyx_n_s_Normalize);
   PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_Normalize);
-  __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_Normalize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_Normalize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_t_2);
   __pyx_v_Normalize = __pyx_t_2;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":31
+  /* "fastrometry/cython_code/PSE.pyx":10
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  *     from matplotlib.colors import ListedColormap             # <<<<<<<<<<<<<<
  * 
  *     if colbar_extend is True:
  */
-  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_s_ListedColormap);
   __Pyx_GIVEREF(__pyx_n_s_ListedColormap);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_ListedColormap);
-  __pyx_t_2 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_ListedColormap); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_ListedColormap); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_t_1);
   __pyx_v_ListedColormap = __pyx_t_1;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":33
+  /* "fastrometry/cython_code/PSE.pyx":12
  *     from matplotlib.colors import ListedColormap
  * 
  *     if colbar_extend is True:             # <<<<<<<<<<<<<<
  *         extend = 'both'
  *     else:
  */
   __pyx_t_3 = (__pyx_v_colbar_extend == Py_True);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":34
+    /* "fastrometry/cython_code/PSE.pyx":13
  * 
  *     if colbar_extend is True:
  *         extend = 'both'             # <<<<<<<<<<<<<<
  *     else:
  *         extend = 'neither'
  */
     __Pyx_INCREF(__pyx_n_s_both);
     __pyx_v_extend = __pyx_n_s_both;
 
-    /* "fastrometry/cython_code/PSE.pyx":33
+    /* "fastrometry/cython_code/PSE.pyx":12
  *     from matplotlib.colors import ListedColormap
  * 
  *     if colbar_extend is True:             # <<<<<<<<<<<<<<
  *         extend = 'both'
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":36
+  /* "fastrometry/cython_code/PSE.pyx":15
  *         extend = 'both'
  *     else:
  *         extend = 'neither'             # <<<<<<<<<<<<<<
  * 
  *     if colors is None:
  */
   /*else*/ {
     __Pyx_INCREF(__pyx_n_s_neither);
     __pyx_v_extend = __pyx_n_s_neither;
   }
   __pyx_L3:;
 
-  /* "fastrometry/cython_code/PSE.pyx":38
+  /* "fastrometry/cython_code/PSE.pyx":17
  *         extend = 'neither'
  * 
  *     if colors is None:             # <<<<<<<<<<<<<<
  *         cm = None
  *     else:
  */
   __pyx_t_4 = (__pyx_v_colors == Py_None);
   __pyx_t_3 = (__pyx_t_4 != 0);
   if (__pyx_t_3) {
 
-    /* "fastrometry/cython_code/PSE.pyx":39
+    /* "fastrometry/cython_code/PSE.pyx":18
  * 
  *     if colors is None:
  *         cm = None             # <<<<<<<<<<<<<<
  *     else:
  *         cm = ListedColormap(colors)
  */
     __Pyx_INCREF(Py_None);
     __pyx_v_cm = Py_None;
 
-    /* "fastrometry/cython_code/PSE.pyx":38
+    /* "fastrometry/cython_code/PSE.pyx":17
  *         extend = 'neither'
  * 
  *     if colors is None:             # <<<<<<<<<<<<<<
  *         cm = None
  *     else:
  */
     goto __pyx_L4;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":41
+  /* "fastrometry/cython_code/PSE.pyx":20
  *         cm = None
  *     else:
  *         cm = ListedColormap(colors)             # <<<<<<<<<<<<<<
  * 
  *     if boundaries is None:
  */
   /*else*/ {
@@ -3970,297 +3392,297 @@
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_colors) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_colors);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_cm = __pyx_t_2;
     __pyx_t_2 = 0;
   }
   __pyx_L4:;
 
-  /* "fastrometry/cython_code/PSE.pyx":43
+  /* "fastrometry/cython_code/PSE.pyx":22
  *         cm = ListedColormap(colors)
  * 
  *     if boundaries is None:             # <<<<<<<<<<<<<<
  *         nm = None
  *     else:
  */
   __pyx_t_3 = (__pyx_v_boundaries == Py_None);
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":44
+    /* "fastrometry/cython_code/PSE.pyx":23
  * 
  *     if boundaries is None:
  *         nm = None             # <<<<<<<<<<<<<<
  *     else:
  *         nm = Normalize(vmin=boundaries[0],vmax=boundaries[1]+1)
  */
     __Pyx_INCREF(Py_None);
     __pyx_v_nm = Py_None;
 
-    /* "fastrometry/cython_code/PSE.pyx":43
+    /* "fastrometry/cython_code/PSE.pyx":22
  *         cm = ListedColormap(colors)
  * 
  *     if boundaries is None:             # <<<<<<<<<<<<<<
  *         nm = None
  *     else:
  */
     goto __pyx_L5;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":46
+  /* "fastrometry/cython_code/PSE.pyx":25
  *         nm = None
  *     else:
  *         nm = Normalize(vmin=boundaries[0],vmax=boundaries[1]+1)             # <<<<<<<<<<<<<<
  * 
  *     plt.figure(figsize=figsize)
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_boundaries, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_boundaries, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_vmin, __pyx_t_1) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_vmin, __pyx_t_1) < 0) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_boundaries, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_boundaries, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_vmax, __pyx_t_5) < 0) __PYX_ERR(0, 46, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_vmax, __pyx_t_5) < 0) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_Normalize, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 46, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_v_Normalize, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 25, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_nm = __pyx_t_5;
     __pyx_t_5 = 0;
   }
   __pyx_L5:;
 
-  /* "fastrometry/cython_code/PSE.pyx":48
+  /* "fastrometry/cython_code/PSE.pyx":27
  *         nm = Normalize(vmin=boundaries[0],vmax=boundaries[1]+1)
  * 
  *     plt.figure(figsize=figsize)             # <<<<<<<<<<<<<<
  *     plt.subplots_adjust(bottom=bottom)
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_figsize, __pyx_v_figsize) < 0) __PYX_ERR(0, 48, __pyx_L1_error)
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_figsize, __pyx_v_figsize) < 0) __PYX_ERR(0, 27, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":49
+  /* "fastrometry/cython_code/PSE.pyx":28
  * 
  *     plt.figure(figsize=figsize)
  *     plt.subplots_adjust(bottom=bottom)             # <<<<<<<<<<<<<<
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)
  *     if colbar is True:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 49, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_bottom, __pyx_v_bottom) < 0) __PYX_ERR(0, 49, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 49, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_bottom, __pyx_v_bottom) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 28, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":50
+  /* "fastrometry/cython_code/PSE.pyx":29
  *     plt.figure(figsize=figsize)
  *     plt.subplots_adjust(bottom=bottom)
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)             # <<<<<<<<<<<<<<
  *     if colbar is True:
  *         plt.colorbar(extend=extend)
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_imshow); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_imshow); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_array);
   __Pyx_GIVEREF(__pyx_v_array);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_array);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_cmap, __pyx_v_cm) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_norm, __pyx_v_nm) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmin, __pyx_v_vmin) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmax, __pyx_v_vmax) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 50, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_cmap, __pyx_v_cm) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_norm, __pyx_v_nm) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmin, __pyx_v_vmin) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmax, __pyx_v_vmax) < 0) __PYX_ERR(0, 29, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":51
+  /* "fastrometry/cython_code/PSE.pyx":30
  *     plt.subplots_adjust(bottom=bottom)
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)
  *     if colbar is True:             # <<<<<<<<<<<<<<
  *         plt.colorbar(extend=extend)
  *     plt.title(title)
  */
   __pyx_t_4 = (__pyx_v_colbar == Py_True);
   __pyx_t_3 = (__pyx_t_4 != 0);
   if (__pyx_t_3) {
 
-    /* "fastrometry/cython_code/PSE.pyx":52
+    /* "fastrometry/cython_code/PSE.pyx":31
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)
  *     if colbar is True:
  *         plt.colorbar(extend=extend)             # <<<<<<<<<<<<<<
  *     plt.title(title)
  *     plt.figtext(0.5, textpos, dscrp, ha="center", fontsize=9)
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_colorbar); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 52, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_colorbar); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 31, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_extend, __pyx_v_extend) < 0) __PYX_ERR(0, 52, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_extend, __pyx_v_extend) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":51
+    /* "fastrometry/cython_code/PSE.pyx":30
  *     plt.subplots_adjust(bottom=bottom)
  *     plt.imshow(array, cmap=cm, norm=nm, vmin=vmin, vmax=vmax)
  *     if colbar is True:             # <<<<<<<<<<<<<<
  *         plt.colorbar(extend=extend)
  *     plt.title(title)
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":53
+  /* "fastrometry/cython_code/PSE.pyx":32
  *     if colbar is True:
  *         plt.colorbar(extend=extend)
  *     plt.title(title)             # <<<<<<<<<<<<<<
  *     plt.figtext(0.5, textpos, dscrp, ha="center", fontsize=9)
  *     plt.savefig(debug_report/savename)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 53, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_v_title) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_title);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":54
+  /* "fastrometry/cython_code/PSE.pyx":33
  *         plt.colorbar(extend=extend)
  *     plt.title(title)
  *     plt.figtext(0.5, textpos, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *     plt.savefig(debug_report/savename)
  *     plt.show()
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_float_0_5);
   __Pyx_GIVEREF(__pyx_float_0_5);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_float_0_5);
   __Pyx_INCREF(__pyx_v_textpos);
   __Pyx_GIVEREF(__pyx_v_textpos);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_textpos);
   __Pyx_INCREF(__pyx_v_dscrp);
   __Pyx_GIVEREF(__pyx_v_dscrp);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_dscrp);
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 54, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 33, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 33, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 33, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":55
+  /* "fastrometry/cython_code/PSE.pyx":34
  *     plt.title(title)
  *     plt.figtext(0.5, textpos, dscrp, ha="center", fontsize=9)
  *     plt.savefig(debug_report/savename)             # <<<<<<<<<<<<<<
  *     plt.show()
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 55, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_v_savename); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_v_savename); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 55, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 34, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":56
+  /* "fastrometry/cython_code/PSE.pyx":35
  *     plt.figtext(0.5, textpos, dscrp, ha="center", fontsize=9)
  *     plt.savefig(debug_report/savename)
  *     plt.show()             # <<<<<<<<<<<<<<
  * 
  * cdef createROI(int[:,:] roi_view, int img_xmax, int img_ymax, int pixelradius, str shape):
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 56, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 35, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 56, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 35, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":28
- *     return decorator
+  /* "fastrometry/cython_code/PSE.pyx":7
+ * import cython
  * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):             # <<<<<<<<<<<<<<
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  */
 
   /* function exit code */
@@ -4281,15 +3703,15 @@
   __Pyx_XDECREF(__pyx_v_cm);
   __Pyx_XDECREF(__pyx_v_nm);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":58
+/* "fastrometry/cython_code/PSE.pyx":37
  *     plt.show()
  * 
  * cdef createROI(int[:,:] roi_view, int img_xmax, int img_ymax, int pixelradius, str shape):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -4313,87 +3735,87 @@
   Py_ssize_t __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("createROI", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":62
+  /* "fastrometry/cython_code/PSE.pyx":41
  *         Py_ssize_t x
  *         Py_ssize_t y
  *         int img_xcenter = img_xmax/2             # <<<<<<<<<<<<<<
  *         int img_ycenter = img_ymax/2
  *         int pixelradius2 = pixelradius*pixelradius
  */
   __pyx_v_img_xcenter = __Pyx_div_long(__pyx_v_img_xmax, 2);
 
-  /* "fastrometry/cython_code/PSE.pyx":63
+  /* "fastrometry/cython_code/PSE.pyx":42
  *         Py_ssize_t y
  *         int img_xcenter = img_xmax/2
  *         int img_ycenter = img_ymax/2             # <<<<<<<<<<<<<<
  *         int pixelradius2 = pixelradius*pixelradius
  * 
  */
   __pyx_v_img_ycenter = __Pyx_div_long(__pyx_v_img_ymax, 2);
 
-  /* "fastrometry/cython_code/PSE.pyx":64
+  /* "fastrometry/cython_code/PSE.pyx":43
  *         int img_xcenter = img_xmax/2
  *         int img_ycenter = img_ymax/2
  *         int pixelradius2 = pixelradius*pixelradius             # <<<<<<<<<<<<<<
  * 
  *     if shape == "circle":
  */
   __pyx_v_pixelradius2 = (__pyx_v_pixelradius * __pyx_v_pixelradius);
 
-  /* "fastrometry/cython_code/PSE.pyx":66
+  /* "fastrometry/cython_code/PSE.pyx":45
  *         int pixelradius2 = pixelradius*pixelradius
  * 
  *     if shape == "circle":             # <<<<<<<<<<<<<<
  *         for x in range(1,img_xmax+1):
  *             for y in range(1,img_ymax+1):
  */
-  __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_circle, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_circle, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 45, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":67
+    /* "fastrometry/cython_code/PSE.pyx":46
  * 
  *     if shape == "circle":
  *         for x in range(1,img_xmax+1):             # <<<<<<<<<<<<<<
  *             for y in range(1,img_ymax+1):
  *                 if (x-img_xcenter)*(x-img_xcenter)+(y-img_ycenter)*(y-img_ycenter) > pixelradius2:
  */
     __pyx_t_3 = (__pyx_v_img_xmax + 1);
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 1; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_v_x = __pyx_t_5;
 
-      /* "fastrometry/cython_code/PSE.pyx":68
+      /* "fastrometry/cython_code/PSE.pyx":47
  *     if shape == "circle":
  *         for x in range(1,img_xmax+1):
  *             for y in range(1,img_ymax+1):             # <<<<<<<<<<<<<<
  *                 if (x-img_xcenter)*(x-img_xcenter)+(y-img_ycenter)*(y-img_ycenter) > pixelradius2:
  *                     roi_view[y-1,x-1] = 0
  */
       __pyx_t_6 = (__pyx_v_img_ymax + 1);
       __pyx_t_7 = __pyx_t_6;
       for (__pyx_t_8 = 1; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
         __pyx_v_y = __pyx_t_8;
 
-        /* "fastrometry/cython_code/PSE.pyx":69
+        /* "fastrometry/cython_code/PSE.pyx":48
  *         for x in range(1,img_xmax+1):
  *             for y in range(1,img_ymax+1):
  *                 if (x-img_xcenter)*(x-img_xcenter)+(y-img_ycenter)*(y-img_ycenter) > pixelradius2:             # <<<<<<<<<<<<<<
  *                     roi_view[y-1,x-1] = 0
  * 
  */
         __pyx_t_2 = (((((__pyx_v_x - __pyx_v_img_xcenter) * (__pyx_v_x - __pyx_v_img_xcenter)) + ((__pyx_v_y - __pyx_v_img_ycenter) * (__pyx_v_y - __pyx_v_img_ycenter))) > __pyx_v_pixelradius2) != 0);
         if (__pyx_t_2) {
 
-          /* "fastrometry/cython_code/PSE.pyx":70
+          /* "fastrometry/cython_code/PSE.pyx":49
  *             for y in range(1,img_ymax+1):
  *                 if (x-img_xcenter)*(x-img_xcenter)+(y-img_ycenter)*(y-img_ycenter) > pixelradius2:
  *                     roi_view[y-1,x-1] = 0             # <<<<<<<<<<<<<<
  * 
  * cdef fillBackgroundMap(double[:,:] bgmap_view, double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int sourcesep):
  */
           __pyx_t_9 = (__pyx_v_y - 1);
@@ -4405,39 +3827,39 @@
           } else if (unlikely(__pyx_t_9 >= __pyx_v_roi_view.shape[0])) __pyx_t_11 = 0;
           if (__pyx_t_10 < 0) {
             __pyx_t_10 += __pyx_v_roi_view.shape[1];
             if (unlikely(__pyx_t_10 < 0)) __pyx_t_11 = 1;
           } else if (unlikely(__pyx_t_10 >= __pyx_v_roi_view.shape[1])) __pyx_t_11 = 1;
           if (unlikely(__pyx_t_11 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_11);
-            __PYX_ERR(0, 70, __pyx_L1_error)
+            __PYX_ERR(0, 49, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_roi_view.data + __pyx_t_9 * __pyx_v_roi_view.strides[0]) ) + __pyx_t_10 * __pyx_v_roi_view.strides[1]) )) = 0;
 
-          /* "fastrometry/cython_code/PSE.pyx":69
+          /* "fastrometry/cython_code/PSE.pyx":48
  *         for x in range(1,img_xmax+1):
  *             for y in range(1,img_ymax+1):
  *                 if (x-img_xcenter)*(x-img_xcenter)+(y-img_ycenter)*(y-img_ycenter) > pixelradius2:             # <<<<<<<<<<<<<<
  *                     roi_view[y-1,x-1] = 0
  * 
  */
         }
       }
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":66
+    /* "fastrometry/cython_code/PSE.pyx":45
  *         int pixelradius2 = pixelradius*pixelradius
  * 
  *     if shape == "circle":             # <<<<<<<<<<<<<<
  *         for x in range(1,img_xmax+1):
  *             for y in range(1,img_ymax+1):
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":58
+  /* "fastrometry/cython_code/PSE.pyx":37
  *     plt.show()
  * 
  * cdef createROI(int[:,:] roi_view, int img_xmax, int img_ymax, int pixelradius, str shape):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -4449,15 +3871,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":72
+/* "fastrometry/cython_code/PSE.pyx":51
  *                     roi_view[y-1,x-1] = 0
  * 
  * cdef fillBackgroundMap(double[:,:] bgmap_view, double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int sourcesep):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -4482,39 +3904,39 @@
   int __pyx_t_9;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fillBackgroundMap", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":83
+  /* "fastrometry/cython_code/PSE.pyx":62
  *         double d
  * 
  *     for x in range(leftmostsafe_x,rightmostsafe_x+1):             # <<<<<<<<<<<<<<
  *         for y in range(topmostsafe_y,bottommostsafe_y+1):
  *             a = img_view[(y-sourcesep)-1,(x-sourcesep)-1] #NW
  */
   __pyx_t_1 = (__pyx_v_rightmostsafe_x + 1);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = __pyx_v_leftmostsafe_x; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_x = __pyx_t_3;
 
-    /* "fastrometry/cython_code/PSE.pyx":84
+    /* "fastrometry/cython_code/PSE.pyx":63
  * 
  *     for x in range(leftmostsafe_x,rightmostsafe_x+1):
  *         for y in range(topmostsafe_y,bottommostsafe_y+1):             # <<<<<<<<<<<<<<
  *             a = img_view[(y-sourcesep)-1,(x-sourcesep)-1] #NW
  *             b = img_view[(y-sourcesep)-1,(x+sourcesep)-1] #NE
  */
     __pyx_t_4 = (__pyx_v_bottommostsafe_y + 1);
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = __pyx_v_topmostsafe_y; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_y = __pyx_t_6;
 
-      /* "fastrometry/cython_code/PSE.pyx":85
+      /* "fastrometry/cython_code/PSE.pyx":64
  *     for x in range(leftmostsafe_x,rightmostsafe_x+1):
  *         for y in range(topmostsafe_y,bottommostsafe_y+1):
  *             a = img_view[(y-sourcesep)-1,(x-sourcesep)-1] #NW             # <<<<<<<<<<<<<<
  *             b = img_view[(y-sourcesep)-1,(x+sourcesep)-1] #NE
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE
  */
       __pyx_t_7 = ((__pyx_v_y - __pyx_v_sourcesep) - 1);
@@ -4526,19 +3948,19 @@
       } else if (unlikely(__pyx_t_7 >= __pyx_v_img_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_8 < 0) {
         __pyx_t_8 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 85, __pyx_L1_error)
+        __PYX_ERR(0, 64, __pyx_L1_error)
       }
       __pyx_v_a = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_7 * __pyx_v_img_view.strides[0]) ) + __pyx_t_8 * __pyx_v_img_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":86
+      /* "fastrometry/cython_code/PSE.pyx":65
  *         for y in range(topmostsafe_y,bottommostsafe_y+1):
  *             a = img_view[(y-sourcesep)-1,(x-sourcesep)-1] #NW
  *             b = img_view[(y-sourcesep)-1,(x+sourcesep)-1] #NE             # <<<<<<<<<<<<<<
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW
  */
       __pyx_t_8 = ((__pyx_v_y - __pyx_v_sourcesep) - 1);
@@ -4550,19 +3972,19 @@
       } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_7 < 0) {
         __pyx_t_7 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_7 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_7 >= __pyx_v_img_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 86, __pyx_L1_error)
+        __PYX_ERR(0, 65, __pyx_L1_error)
       }
       __pyx_v_b = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_8 * __pyx_v_img_view.strides[0]) ) + __pyx_t_7 * __pyx_v_img_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":87
+      /* "fastrometry/cython_code/PSE.pyx":66
  *             a = img_view[(y-sourcesep)-1,(x-sourcesep)-1] #NW
  *             b = img_view[(y-sourcesep)-1,(x+sourcesep)-1] #NE
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE             # <<<<<<<<<<<<<<
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW
  *             if a > b:
  */
       __pyx_t_7 = ((__pyx_v_y + __pyx_v_sourcesep) - 1);
@@ -4574,19 +3996,19 @@
       } else if (unlikely(__pyx_t_7 >= __pyx_v_img_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_8 < 0) {
         __pyx_t_8 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 87, __pyx_L1_error)
+        __PYX_ERR(0, 66, __pyx_L1_error)
       }
       __pyx_v_c = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_7 * __pyx_v_img_view.strides[0]) ) + __pyx_t_8 * __pyx_v_img_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":88
+      /* "fastrometry/cython_code/PSE.pyx":67
  *             b = img_view[(y-sourcesep)-1,(x+sourcesep)-1] #NE
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW             # <<<<<<<<<<<<<<
  *             if a > b:
  *                 tmp = a
  */
       __pyx_t_8 = ((__pyx_v_y + __pyx_v_sourcesep) - 1);
@@ -4598,295 +4020,295 @@
       } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_7 < 0) {
         __pyx_t_7 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_7 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_7 >= __pyx_v_img_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 88, __pyx_L1_error)
+        __PYX_ERR(0, 67, __pyx_L1_error)
       }
       __pyx_v_d = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_8 * __pyx_v_img_view.strides[0]) ) + __pyx_t_7 * __pyx_v_img_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":89
+      /* "fastrometry/cython_code/PSE.pyx":68
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW
  *             if a > b:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = b
  */
       __pyx_t_10 = ((__pyx_v_a > __pyx_v_b) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":90
+        /* "fastrometry/cython_code/PSE.pyx":69
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW
  *             if a > b:
  *                 tmp = a             # <<<<<<<<<<<<<<
  *                 a = b
  *                 b = tmp
  */
         __pyx_v_tmp = __pyx_v_a;
 
-        /* "fastrometry/cython_code/PSE.pyx":91
+        /* "fastrometry/cython_code/PSE.pyx":70
  *             if a > b:
  *                 tmp = a
  *                 a = b             # <<<<<<<<<<<<<<
  *                 b = tmp
  *             if a > c:
  */
         __pyx_v_a = __pyx_v_b;
 
-        /* "fastrometry/cython_code/PSE.pyx":92
+        /* "fastrometry/cython_code/PSE.pyx":71
  *                 tmp = a
  *                 a = b
  *                 b = tmp             # <<<<<<<<<<<<<<
  *             if a > c:
  *                 tmp = a
  */
         __pyx_v_b = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":89
+        /* "fastrometry/cython_code/PSE.pyx":68
  *             c = img_view[(y+sourcesep)-1,(x+sourcesep)-1] #SE
  *             d = img_view[(y+sourcesep)-1,(x-sourcesep)-1] #SW
  *             if a > b:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = b
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":93
+      /* "fastrometry/cython_code/PSE.pyx":72
  *                 a = b
  *                 b = tmp
  *             if a > c:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = c
  */
       __pyx_t_10 = ((__pyx_v_a > __pyx_v_c) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":94
+        /* "fastrometry/cython_code/PSE.pyx":73
  *                 b = tmp
  *             if a > c:
  *                 tmp = a             # <<<<<<<<<<<<<<
  *                 a = c
  *                 c = tmp
  */
         __pyx_v_tmp = __pyx_v_a;
 
-        /* "fastrometry/cython_code/PSE.pyx":95
+        /* "fastrometry/cython_code/PSE.pyx":74
  *             if a > c:
  *                 tmp = a
  *                 a = c             # <<<<<<<<<<<<<<
  *                 c = tmp
  *             if a > d:
  */
         __pyx_v_a = __pyx_v_c;
 
-        /* "fastrometry/cython_code/PSE.pyx":96
+        /* "fastrometry/cython_code/PSE.pyx":75
  *                 tmp = a
  *                 a = c
  *                 c = tmp             # <<<<<<<<<<<<<<
  *             if a > d:
  *                 tmp = a
  */
         __pyx_v_c = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":93
+        /* "fastrometry/cython_code/PSE.pyx":72
  *                 a = b
  *                 b = tmp
  *             if a > c:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = c
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":97
+      /* "fastrometry/cython_code/PSE.pyx":76
  *                 a = c
  *                 c = tmp
  *             if a > d:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = d
  */
       __pyx_t_10 = ((__pyx_v_a > __pyx_v_d) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":98
+        /* "fastrometry/cython_code/PSE.pyx":77
  *                 c = tmp
  *             if a > d:
  *                 tmp = a             # <<<<<<<<<<<<<<
  *                 a = d
  *                 d = tmp
  */
         __pyx_v_tmp = __pyx_v_a;
 
-        /* "fastrometry/cython_code/PSE.pyx":99
+        /* "fastrometry/cython_code/PSE.pyx":78
  *             if a > d:
  *                 tmp = a
  *                 a = d             # <<<<<<<<<<<<<<
  *                 d = tmp
  *             if b > c:
  */
         __pyx_v_a = __pyx_v_d;
 
-        /* "fastrometry/cython_code/PSE.pyx":100
+        /* "fastrometry/cython_code/PSE.pyx":79
  *                 tmp = a
  *                 a = d
  *                 d = tmp             # <<<<<<<<<<<<<<
  *             if b > c:
  *                 tmp = b
  */
         __pyx_v_d = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":97
+        /* "fastrometry/cython_code/PSE.pyx":76
  *                 a = c
  *                 c = tmp
  *             if a > d:             # <<<<<<<<<<<<<<
  *                 tmp = a
  *                 a = d
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":101
+      /* "fastrometry/cython_code/PSE.pyx":80
  *                 a = d
  *                 d = tmp
  *             if b > c:             # <<<<<<<<<<<<<<
  *                 tmp = b
  *                 b = c
  */
       __pyx_t_10 = ((__pyx_v_b > __pyx_v_c) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":102
+        /* "fastrometry/cython_code/PSE.pyx":81
  *                 d = tmp
  *             if b > c:
  *                 tmp = b             # <<<<<<<<<<<<<<
  *                 b = c
  *                 c = tmp
  */
         __pyx_v_tmp = __pyx_v_b;
 
-        /* "fastrometry/cython_code/PSE.pyx":103
+        /* "fastrometry/cython_code/PSE.pyx":82
  *             if b > c:
  *                 tmp = b
  *                 b = c             # <<<<<<<<<<<<<<
  *                 c = tmp
  *             if b > d:
  */
         __pyx_v_b = __pyx_v_c;
 
-        /* "fastrometry/cython_code/PSE.pyx":104
+        /* "fastrometry/cython_code/PSE.pyx":83
  *                 tmp = b
  *                 b = c
  *                 c = tmp             # <<<<<<<<<<<<<<
  *             if b > d:
  *                 tmp = b
  */
         __pyx_v_c = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":101
+        /* "fastrometry/cython_code/PSE.pyx":80
  *                 a = d
  *                 d = tmp
  *             if b > c:             # <<<<<<<<<<<<<<
  *                 tmp = b
  *                 b = c
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":105
+      /* "fastrometry/cython_code/PSE.pyx":84
  *                 b = c
  *                 c = tmp
  *             if b > d:             # <<<<<<<<<<<<<<
  *                 tmp = b
  *                 b = d
  */
       __pyx_t_10 = ((__pyx_v_b > __pyx_v_d) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":106
+        /* "fastrometry/cython_code/PSE.pyx":85
  *                 c = tmp
  *             if b > d:
  *                 tmp = b             # <<<<<<<<<<<<<<
  *                 b = d
  *                 d = tmp
  */
         __pyx_v_tmp = __pyx_v_b;
 
-        /* "fastrometry/cython_code/PSE.pyx":107
+        /* "fastrometry/cython_code/PSE.pyx":86
  *             if b > d:
  *                 tmp = b
  *                 b = d             # <<<<<<<<<<<<<<
  *                 d = tmp
  *             if c > d:
  */
         __pyx_v_b = __pyx_v_d;
 
-        /* "fastrometry/cython_code/PSE.pyx":108
+        /* "fastrometry/cython_code/PSE.pyx":87
  *                 tmp = b
  *                 b = d
  *                 d = tmp             # <<<<<<<<<<<<<<
  *             if c > d:
  *                 tmp = c
  */
         __pyx_v_d = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":105
+        /* "fastrometry/cython_code/PSE.pyx":84
  *                 b = c
  *                 c = tmp
  *             if b > d:             # <<<<<<<<<<<<<<
  *                 tmp = b
  *                 b = d
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":109
+      /* "fastrometry/cython_code/PSE.pyx":88
  *                 b = d
  *                 d = tmp
  *             if c > d:             # <<<<<<<<<<<<<<
  *                 tmp = c
  *                 c = d
  */
       __pyx_t_10 = ((__pyx_v_c > __pyx_v_d) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":110
+        /* "fastrometry/cython_code/PSE.pyx":89
  *                 d = tmp
  *             if c > d:
  *                 tmp = c             # <<<<<<<<<<<<<<
  *                 c = d
  *                 d = tmp
  */
         __pyx_v_tmp = __pyx_v_c;
 
-        /* "fastrometry/cython_code/PSE.pyx":111
+        /* "fastrometry/cython_code/PSE.pyx":90
  *             if c > d:
  *                 tmp = c
  *                 c = d             # <<<<<<<<<<<<<<
  *                 d = tmp
  *             bgmap_view[y-1,x-1] = b
  */
         __pyx_v_c = __pyx_v_d;
 
-        /* "fastrometry/cython_code/PSE.pyx":112
+        /* "fastrometry/cython_code/PSE.pyx":91
  *                 tmp = c
  *                 c = d
  *                 d = tmp             # <<<<<<<<<<<<<<
  *             bgmap_view[y-1,x-1] = b
  * 
  */
         __pyx_v_d = __pyx_v_tmp;
 
-        /* "fastrometry/cython_code/PSE.pyx":109
+        /* "fastrometry/cython_code/PSE.pyx":88
  *                 b = d
  *                 d = tmp
  *             if c > d:             # <<<<<<<<<<<<<<
  *                 tmp = c
  *                 c = d
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":113
+      /* "fastrometry/cython_code/PSE.pyx":92
  *                 c = d
  *                 d = tmp
  *             bgmap_view[y-1,x-1] = b             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_7 = (__pyx_v_y - 1);
@@ -4898,21 +4320,21 @@
       } else if (unlikely(__pyx_t_7 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_8 < 0) {
         __pyx_t_8 += __pyx_v_bgmap_view.shape[1];
         if (unlikely(__pyx_t_8 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_8 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 113, __pyx_L1_error)
+        __PYX_ERR(0, 92, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_7 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_8 * __pyx_v_bgmap_view.strides[1]) )) = __pyx_v_b;
     }
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":72
+  /* "fastrometry/cython_code/PSE.pyx":51
  *                     roi_view[y-1,x-1] = 0
  * 
  * cdef fillBackgroundMap(double[:,:] bgmap_view, double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int sourcesep):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -4924,15 +4346,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":116
+/* "fastrometry/cython_code/PSE.pyx":95
  * 
  * 
  * cdef findCentroids(int x, int y, int square_rad, double[:,:] img_view, double centerbg, double[:] cntdresults_view):             # <<<<<<<<<<<<<<
  *     """
  *     Uses a square kernel. Return array also includes square kernel sum.
  */
 
@@ -4957,105 +4379,105 @@
   Py_ssize_t __pyx_t_9;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("findCentroids", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":124
+  /* "fastrometry/cython_code/PSE.pyx":103
  *         Py_ssize_t x_armlength
  *         Py_ssize_t y_armlength
  *         double sumOfWeightsTimesXDists = 0             # <<<<<<<<<<<<<<
  *         double sumOfWeightsTimesYDists = 0
  *         double sumOfWeights = 0
  */
   __pyx_v_sumOfWeightsTimesXDists = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":125
+  /* "fastrometry/cython_code/PSE.pyx":104
  *         Py_ssize_t y_armlength
  *         double sumOfWeightsTimesXDists = 0
  *         double sumOfWeightsTimesYDists = 0             # <<<<<<<<<<<<<<
  *         double sumOfWeights = 0
  *         double x_centroid
  */
   __pyx_v_sumOfWeightsTimesYDists = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":126
+  /* "fastrometry/cython_code/PSE.pyx":105
  *         double sumOfWeightsTimesXDists = 0
  *         double sumOfWeightsTimesYDists = 0
  *         double sumOfWeights = 0             # <<<<<<<<<<<<<<
  *         double x_centroid
  *         double y_centroid
  */
   __pyx_v_sumOfWeights = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":130
+  /* "fastrometry/cython_code/PSE.pyx":109
  *         double y_centroid
  * 
  *     if square_rad == 0:             # <<<<<<<<<<<<<<
  *         x_centroid = x
  *         y_centroid = y
  */
   __pyx_t_1 = ((__pyx_v_square_rad == 0) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/PSE.pyx":131
+    /* "fastrometry/cython_code/PSE.pyx":110
  * 
  *     if square_rad == 0:
  *         x_centroid = x             # <<<<<<<<<<<<<<
  *         y_centroid = y
  * 
  */
     __pyx_v_x_centroid = __pyx_v_x;
 
-    /* "fastrometry/cython_code/PSE.pyx":132
+    /* "fastrometry/cython_code/PSE.pyx":111
  *     if square_rad == 0:
  *         x_centroid = x
  *         y_centroid = y             # <<<<<<<<<<<<<<
  * 
  *     else:
  */
     __pyx_v_y_centroid = __pyx_v_y;
 
-    /* "fastrometry/cython_code/PSE.pyx":130
+    /* "fastrometry/cython_code/PSE.pyx":109
  *         double y_centroid
  * 
  *     if square_rad == 0:             # <<<<<<<<<<<<<<
  *         x_centroid = x
  *         y_centroid = y
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":135
+  /* "fastrometry/cython_code/PSE.pyx":114
  * 
  *     else:
  *         for x_armlength in range(-square_rad, square_rad+1):             # <<<<<<<<<<<<<<
  *             for y_armlength in range(-square_rad, square_rad+1):
  *                 sumOfWeightsTimesXDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*x_armlength
  */
   /*else*/ {
     __pyx_t_2 = (__pyx_v_square_rad + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = (-__pyx_v_square_rad); __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_x_armlength = __pyx_t_4;
 
-      /* "fastrometry/cython_code/PSE.pyx":136
+      /* "fastrometry/cython_code/PSE.pyx":115
  *     else:
  *         for x_armlength in range(-square_rad, square_rad+1):
  *             for y_armlength in range(-square_rad, square_rad+1):             # <<<<<<<<<<<<<<
  *                 sumOfWeightsTimesXDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*x_armlength
  *                 sumOfWeightsTimesYDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*y_armlength
  */
       __pyx_t_5 = (__pyx_v_square_rad + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = (-__pyx_v_square_rad); __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_y_armlength = __pyx_t_7;
 
-        /* "fastrometry/cython_code/PSE.pyx":137
+        /* "fastrometry/cython_code/PSE.pyx":116
  *         for x_armlength in range(-square_rad, square_rad+1):
  *             for y_armlength in range(-square_rad, square_rad+1):
  *                 sumOfWeightsTimesXDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*x_armlength             # <<<<<<<<<<<<<<
  *                 sumOfWeightsTimesYDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*y_armlength
  *                 sumOfWeights += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)
  */
         __pyx_t_8 = ((__pyx_v_y + __pyx_v_y_armlength) - 1);
@@ -5067,19 +4489,19 @@
         } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[0])) __pyx_t_10 = 0;
         if (__pyx_t_9 < 0) {
           __pyx_t_9 += __pyx_v_img_view.shape[1];
           if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 1;
         } else if (unlikely(__pyx_t_9 >= __pyx_v_img_view.shape[1])) __pyx_t_10 = 1;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          __PYX_ERR(0, 137, __pyx_L1_error)
+          __PYX_ERR(0, 116, __pyx_L1_error)
         }
         __pyx_v_sumOfWeightsTimesXDists = (__pyx_v_sumOfWeightsTimesXDists + (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_8 * __pyx_v_img_view.strides[0]) ) + __pyx_t_9 * __pyx_v_img_view.strides[1]) ))) - __pyx_v_centerbg) * __pyx_v_x_armlength));
 
-        /* "fastrometry/cython_code/PSE.pyx":138
+        /* "fastrometry/cython_code/PSE.pyx":117
  *             for y_armlength in range(-square_rad, square_rad+1):
  *                 sumOfWeightsTimesXDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*x_armlength
  *                 sumOfWeightsTimesYDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*y_armlength             # <<<<<<<<<<<<<<
  *                 sumOfWeights += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)
  *         x_centroid = x+sumOfWeightsTimesXDists/sumOfWeights
  */
         __pyx_t_9 = ((__pyx_v_y + __pyx_v_y_armlength) - 1);
@@ -5091,19 +4513,19 @@
         } else if (unlikely(__pyx_t_9 >= __pyx_v_img_view.shape[0])) __pyx_t_10 = 0;
         if (__pyx_t_8 < 0) {
           __pyx_t_8 += __pyx_v_img_view.shape[1];
           if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 1;
         } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[1])) __pyx_t_10 = 1;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          __PYX_ERR(0, 138, __pyx_L1_error)
+          __PYX_ERR(0, 117, __pyx_L1_error)
         }
         __pyx_v_sumOfWeightsTimesYDists = (__pyx_v_sumOfWeightsTimesYDists + (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_9 * __pyx_v_img_view.strides[0]) ) + __pyx_t_8 * __pyx_v_img_view.strides[1]) ))) - __pyx_v_centerbg) * __pyx_v_y_armlength));
 
-        /* "fastrometry/cython_code/PSE.pyx":139
+        /* "fastrometry/cython_code/PSE.pyx":118
  *                 sumOfWeightsTimesXDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*x_armlength
  *                 sumOfWeightsTimesYDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*y_armlength
  *                 sumOfWeights += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)             # <<<<<<<<<<<<<<
  *         x_centroid = x+sumOfWeightsTimesXDists/sumOfWeights
  *         y_centroid = y+sumOfWeightsTimesYDists/sumOfWeights
  */
         __pyx_t_8 = ((__pyx_v_y + __pyx_v_y_armlength) - 1);
@@ -5115,106 +4537,106 @@
         } else if (unlikely(__pyx_t_8 >= __pyx_v_img_view.shape[0])) __pyx_t_10 = 0;
         if (__pyx_t_9 < 0) {
           __pyx_t_9 += __pyx_v_img_view.shape[1];
           if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 1;
         } else if (unlikely(__pyx_t_9 >= __pyx_v_img_view.shape[1])) __pyx_t_10 = 1;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          __PYX_ERR(0, 139, __pyx_L1_error)
+          __PYX_ERR(0, 118, __pyx_L1_error)
         }
         __pyx_v_sumOfWeights = (__pyx_v_sumOfWeights + ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_8 * __pyx_v_img_view.strides[0]) ) + __pyx_t_9 * __pyx_v_img_view.strides[1]) ))) - __pyx_v_centerbg));
       }
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":140
+    /* "fastrometry/cython_code/PSE.pyx":119
  *                 sumOfWeightsTimesYDists += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)*y_armlength
  *                 sumOfWeights += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)
  *         x_centroid = x+sumOfWeightsTimesXDists/sumOfWeights             # <<<<<<<<<<<<<<
  *         y_centroid = y+sumOfWeightsTimesYDists/sumOfWeights
  * 
  */
     if (unlikely(__pyx_v_sumOfWeights == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 140, __pyx_L1_error)
+      __PYX_ERR(0, 119, __pyx_L1_error)
     }
     __pyx_v_x_centroid = (__pyx_v_x + (__pyx_v_sumOfWeightsTimesXDists / __pyx_v_sumOfWeights));
 
-    /* "fastrometry/cython_code/PSE.pyx":141
+    /* "fastrometry/cython_code/PSE.pyx":120
  *                 sumOfWeights += (img_view[(y+y_armlength)-1, (x+x_armlength)-1]-centerbg)
  *         x_centroid = x+sumOfWeightsTimesXDists/sumOfWeights
  *         y_centroid = y+sumOfWeightsTimesYDists/sumOfWeights             # <<<<<<<<<<<<<<
  * 
  *     cntdresults_view[0] = x_centroid
  */
     if (unlikely(__pyx_v_sumOfWeights == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 141, __pyx_L1_error)
+      __PYX_ERR(0, 120, __pyx_L1_error)
     }
     __pyx_v_y_centroid = (__pyx_v_y + (__pyx_v_sumOfWeightsTimesYDists / __pyx_v_sumOfWeights));
   }
   __pyx_L3:;
 
-  /* "fastrometry/cython_code/PSE.pyx":143
+  /* "fastrometry/cython_code/PSE.pyx":122
  *         y_centroid = y+sumOfWeightsTimesYDists/sumOfWeights
  * 
  *     cntdresults_view[0] = x_centroid             # <<<<<<<<<<<<<<
  *     cntdresults_view[1] = y_centroid
  *     cntdresults_view[2] = sumOfWeights
  */
   __pyx_t_9 = 0;
   __pyx_t_10 = -1;
   if (__pyx_t_9 < 0) {
     __pyx_t_9 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_9 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 143, __pyx_L1_error)
+    __PYX_ERR(0, 122, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_9 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_x_centroid;
 
-  /* "fastrometry/cython_code/PSE.pyx":144
+  /* "fastrometry/cython_code/PSE.pyx":123
  * 
  *     cntdresults_view[0] = x_centroid
  *     cntdresults_view[1] = y_centroid             # <<<<<<<<<<<<<<
  *     cntdresults_view[2] = sumOfWeights
  * 
  */
   __pyx_t_9 = 1;
   __pyx_t_10 = -1;
   if (__pyx_t_9 < 0) {
     __pyx_t_9 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_9 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 144, __pyx_L1_error)
+    __PYX_ERR(0, 123, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_9 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_y_centroid;
 
-  /* "fastrometry/cython_code/PSE.pyx":145
+  /* "fastrometry/cython_code/PSE.pyx":124
  *     cntdresults_view[0] = x_centroid
  *     cntdresults_view[1] = y_centroid
  *     cntdresults_view[2] = sumOfWeights             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_9 = 2;
   __pyx_t_10 = -1;
   if (__pyx_t_9 < 0) {
     __pyx_t_9 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_9 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 145, __pyx_L1_error)
+    __PYX_ERR(0, 124, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_9 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_sumOfWeights;
 
-  /* "fastrometry/cython_code/PSE.pyx":116
+  /* "fastrometry/cython_code/PSE.pyx":95
  * 
  * 
  * cdef findCentroids(int x, int y, int square_rad, double[:,:] img_view, double centerbg, double[:] cntdresults_view):             # <<<<<<<<<<<<<<
  *     """
  *     Uses a square kernel. Return array also includes square kernel sum.
  */
 
@@ -5226,15 +4648,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":148
+/* "fastrometry/cython_code/PSE.pyx":127
  * 
  * 
  * cdef findIslandCentroids(double[:,:] img_view, int[:] islandbnds_view, double[:] cntdresults_view):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -5261,260 +4683,260 @@
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("findIslandCentroids", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":152
+  /* "fastrometry/cython_code/PSE.pyx":131
  *         Py_ssize_t x
  *         Py_ssize_t y
  *         double sumOfWeightsTimesXDists = 0             # <<<<<<<<<<<<<<
  *         double sumOfWeightsTimesYDists = 0
  *         double sumOfWeights = 0
  */
   __pyx_v_sumOfWeightsTimesXDists = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":153
+  /* "fastrometry/cython_code/PSE.pyx":132
  *         Py_ssize_t y
  *         double sumOfWeightsTimesXDists = 0
  *         double sumOfWeightsTimesYDists = 0             # <<<<<<<<<<<<<<
  *         double sumOfWeights = 0
  *         double x_centroid
  */
   __pyx_v_sumOfWeightsTimesYDists = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":154
+  /* "fastrometry/cython_code/PSE.pyx":133
  *         double sumOfWeightsTimesXDists = 0
  *         double sumOfWeightsTimesYDists = 0
  *         double sumOfWeights = 0             # <<<<<<<<<<<<<<
  *         double x_centroid
  *         double y_centroid
  */
   __pyx_v_sumOfWeights = 0.0;
 
-  /* "fastrometry/cython_code/PSE.pyx":159
+  /* "fastrometry/cython_code/PSE.pyx":138
  * 
  *     #for single-pixel islands, expand the island to a 3X3
  *     if islandbnds_view[1] == islandbnds_view[0]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[0] -= 1
  *         islandbnds_view[1] += 1
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 159, __pyx_L1_error)
+    __PYX_ERR(0, 138, __pyx_L1_error)
   }
   __pyx_t_3 = 0;
   __pyx_t_2 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 159, __pyx_L1_error)
+    __PYX_ERR(0, 138, __pyx_L1_error)
   }
   __pyx_t_4 = (((*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) ))) == (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":160
+    /* "fastrometry/cython_code/PSE.pyx":139
  *     #for single-pixel islands, expand the island to a 3X3
  *     if islandbnds_view[1] == islandbnds_view[0]:
  *         islandbnds_view[0] -= 1             # <<<<<<<<<<<<<<
  *         islandbnds_view[1] += 1
  *     if islandbnds_view[3] == islandbnds_view[2]:
  */
     __pyx_t_3 = 0;
     __pyx_t_2 = -1;
     if (__pyx_t_3 < 0) {
       __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 160, __pyx_L1_error)
+      __PYX_ERR(0, 139, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) )) -= 1;
 
-    /* "fastrometry/cython_code/PSE.pyx":161
+    /* "fastrometry/cython_code/PSE.pyx":140
  *     if islandbnds_view[1] == islandbnds_view[0]:
  *         islandbnds_view[0] -= 1
  *         islandbnds_view[1] += 1             # <<<<<<<<<<<<<<
  *     if islandbnds_view[3] == islandbnds_view[2]:
  *         islandbnds_view[2] -= 1
  */
     __pyx_t_3 = 1;
     __pyx_t_2 = -1;
     if (__pyx_t_3 < 0) {
       __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 161, __pyx_L1_error)
+      __PYX_ERR(0, 140, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) )) += 1;
 
-    /* "fastrometry/cython_code/PSE.pyx":159
+    /* "fastrometry/cython_code/PSE.pyx":138
  * 
  *     #for single-pixel islands, expand the island to a 3X3
  *     if islandbnds_view[1] == islandbnds_view[0]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[0] -= 1
  *         islandbnds_view[1] += 1
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":162
+  /* "fastrometry/cython_code/PSE.pyx":141
  *         islandbnds_view[0] -= 1
  *         islandbnds_view[1] += 1
  *     if islandbnds_view[3] == islandbnds_view[2]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[2] -= 1
  *         islandbnds_view[3] += 1
  */
   __pyx_t_3 = 3;
   __pyx_t_2 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 162, __pyx_L1_error)
+    __PYX_ERR(0, 141, __pyx_L1_error)
   }
   __pyx_t_1 = 2;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 162, __pyx_L1_error)
+    __PYX_ERR(0, 141, __pyx_L1_error)
   }
   __pyx_t_4 = (((*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) ))) == (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":163
+    /* "fastrometry/cython_code/PSE.pyx":142
  *         islandbnds_view[1] += 1
  *     if islandbnds_view[3] == islandbnds_view[2]:
  *         islandbnds_view[2] -= 1             # <<<<<<<<<<<<<<
  *         islandbnds_view[3] += 1
  * 
  */
     __pyx_t_1 = 2;
     __pyx_t_2 = -1;
     if (__pyx_t_1 < 0) {
       __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 163, __pyx_L1_error)
+      __PYX_ERR(0, 142, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) )) -= 1;
 
-    /* "fastrometry/cython_code/PSE.pyx":164
+    /* "fastrometry/cython_code/PSE.pyx":143
  *     if islandbnds_view[3] == islandbnds_view[2]:
  *         islandbnds_view[2] -= 1
  *         islandbnds_view[3] += 1             # <<<<<<<<<<<<<<
  * 
  *     for x in range(islandbnds_view[0], islandbnds_view[1]+1):
  */
     __pyx_t_1 = 3;
     __pyx_t_2 = -1;
     if (__pyx_t_1 < 0) {
       __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 164, __pyx_L1_error)
+      __PYX_ERR(0, 143, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) )) += 1;
 
-    /* "fastrometry/cython_code/PSE.pyx":162
+    /* "fastrometry/cython_code/PSE.pyx":141
  *         islandbnds_view[0] -= 1
  *         islandbnds_view[1] += 1
  *     if islandbnds_view[3] == islandbnds_view[2]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[2] -= 1
  *         islandbnds_view[3] += 1
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":166
+  /* "fastrometry/cython_code/PSE.pyx":145
  *         islandbnds_view[3] += 1
  * 
  *     for x in range(islandbnds_view[0], islandbnds_view[1]+1):             # <<<<<<<<<<<<<<
  *         for y in range(islandbnds_view[2], islandbnds_view[3]+1):
  *             sumOfWeightsTimesXDists += img_view[y-1,x-1]*x
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 166, __pyx_L1_error)
+    __PYX_ERR(0, 145, __pyx_L1_error)
   }
   __pyx_t_5 = ((*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) ))) + 1);
   __pyx_t_1 = 0;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 166, __pyx_L1_error)
+    __PYX_ERR(0, 145, __pyx_L1_error)
   }
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_7 = (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_1 * __pyx_v_islandbnds_view.strides[0]) ))); __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_x = __pyx_t_7;
 
-    /* "fastrometry/cython_code/PSE.pyx":167
+    /* "fastrometry/cython_code/PSE.pyx":146
  * 
  *     for x in range(islandbnds_view[0], islandbnds_view[1]+1):
  *         for y in range(islandbnds_view[2], islandbnds_view[3]+1):             # <<<<<<<<<<<<<<
  *             sumOfWeightsTimesXDists += img_view[y-1,x-1]*x
  *             sumOfWeightsTimesYDists += img_view[y-1,x-1]*y
  */
     __pyx_t_3 = 3;
     __pyx_t_2 = -1;
     if (__pyx_t_3 < 0) {
       __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 167, __pyx_L1_error)
+      __PYX_ERR(0, 146, __pyx_L1_error)
     }
     __pyx_t_8 = ((*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) ))) + 1);
     __pyx_t_3 = 2;
     __pyx_t_2 = -1;
     if (__pyx_t_3 < 0) {
       __pyx_t_3 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_3 < 0)) __pyx_t_2 = 0;
     } else if (unlikely(__pyx_t_3 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_2 = 0;
     if (unlikely(__pyx_t_2 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_2);
-      __PYX_ERR(0, 167, __pyx_L1_error)
+      __PYX_ERR(0, 146, __pyx_L1_error)
     }
     __pyx_t_9 = __pyx_t_8;
     for (__pyx_t_10 = (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_3 * __pyx_v_islandbnds_view.strides[0]) ))); __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_y = __pyx_t_10;
 
-      /* "fastrometry/cython_code/PSE.pyx":168
+      /* "fastrometry/cython_code/PSE.pyx":147
  *     for x in range(islandbnds_view[0], islandbnds_view[1]+1):
  *         for y in range(islandbnds_view[2], islandbnds_view[3]+1):
  *             sumOfWeightsTimesXDists += img_view[y-1,x-1]*x             # <<<<<<<<<<<<<<
  *             sumOfWeightsTimesYDists += img_view[y-1,x-1]*y
  *             sumOfWeights += img_view[y-1,x-1]
  */
       __pyx_t_11 = (__pyx_v_y - 1);
@@ -5526,19 +4948,19 @@
       } else if (unlikely(__pyx_t_11 >= __pyx_v_img_view.shape[0])) __pyx_t_2 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_2 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_v_img_view.shape[1])) __pyx_t_2 = 1;
       if (unlikely(__pyx_t_2 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_2);
-        __PYX_ERR(0, 168, __pyx_L1_error)
+        __PYX_ERR(0, 147, __pyx_L1_error)
       }
       __pyx_v_sumOfWeightsTimesXDists = (__pyx_v_sumOfWeightsTimesXDists + ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_11 * __pyx_v_img_view.strides[0]) ) + __pyx_t_12 * __pyx_v_img_view.strides[1]) ))) * __pyx_v_x));
 
-      /* "fastrometry/cython_code/PSE.pyx":169
+      /* "fastrometry/cython_code/PSE.pyx":148
  *         for y in range(islandbnds_view[2], islandbnds_view[3]+1):
  *             sumOfWeightsTimesXDists += img_view[y-1,x-1]*x
  *             sumOfWeightsTimesYDists += img_view[y-1,x-1]*y             # <<<<<<<<<<<<<<
  *             sumOfWeights += img_view[y-1,x-1]
  *     x_centroid = sumOfWeightsTimesXDists/sumOfWeights
  */
       __pyx_t_12 = (__pyx_v_y - 1);
@@ -5550,19 +4972,19 @@
       } else if (unlikely(__pyx_t_12 >= __pyx_v_img_view.shape[0])) __pyx_t_2 = 0;
       if (__pyx_t_11 < 0) {
         __pyx_t_11 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_11 < 0)) __pyx_t_2 = 1;
       } else if (unlikely(__pyx_t_11 >= __pyx_v_img_view.shape[1])) __pyx_t_2 = 1;
       if (unlikely(__pyx_t_2 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_2);
-        __PYX_ERR(0, 169, __pyx_L1_error)
+        __PYX_ERR(0, 148, __pyx_L1_error)
       }
       __pyx_v_sumOfWeightsTimesYDists = (__pyx_v_sumOfWeightsTimesYDists + ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_12 * __pyx_v_img_view.strides[0]) ) + __pyx_t_11 * __pyx_v_img_view.strides[1]) ))) * __pyx_v_y));
 
-      /* "fastrometry/cython_code/PSE.pyx":170
+      /* "fastrometry/cython_code/PSE.pyx":149
  *             sumOfWeightsTimesXDists += img_view[y-1,x-1]*x
  *             sumOfWeightsTimesYDists += img_view[y-1,x-1]*y
  *             sumOfWeights += img_view[y-1,x-1]             # <<<<<<<<<<<<<<
  *     x_centroid = sumOfWeightsTimesXDists/sumOfWeights
  *     y_centroid = sumOfWeightsTimesYDists/sumOfWeights
  */
       __pyx_t_11 = (__pyx_v_y - 1);
@@ -5574,104 +4996,104 @@
       } else if (unlikely(__pyx_t_11 >= __pyx_v_img_view.shape[0])) __pyx_t_2 = 0;
       if (__pyx_t_12 < 0) {
         __pyx_t_12 += __pyx_v_img_view.shape[1];
         if (unlikely(__pyx_t_12 < 0)) __pyx_t_2 = 1;
       } else if (unlikely(__pyx_t_12 >= __pyx_v_img_view.shape[1])) __pyx_t_2 = 1;
       if (unlikely(__pyx_t_2 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_2);
-        __PYX_ERR(0, 170, __pyx_L1_error)
+        __PYX_ERR(0, 149, __pyx_L1_error)
       }
       __pyx_v_sumOfWeights = (__pyx_v_sumOfWeights + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_11 * __pyx_v_img_view.strides[0]) ) + __pyx_t_12 * __pyx_v_img_view.strides[1]) ))));
     }
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":171
+  /* "fastrometry/cython_code/PSE.pyx":150
  *             sumOfWeightsTimesYDists += img_view[y-1,x-1]*y
  *             sumOfWeights += img_view[y-1,x-1]
  *     x_centroid = sumOfWeightsTimesXDists/sumOfWeights             # <<<<<<<<<<<<<<
  *     y_centroid = sumOfWeightsTimesYDists/sumOfWeights
  * 
  */
   if (unlikely(__pyx_v_sumOfWeights == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 171, __pyx_L1_error)
+    __PYX_ERR(0, 150, __pyx_L1_error)
   }
   __pyx_v_x_centroid = (__pyx_v_sumOfWeightsTimesXDists / __pyx_v_sumOfWeights);
 
-  /* "fastrometry/cython_code/PSE.pyx":172
+  /* "fastrometry/cython_code/PSE.pyx":151
  *             sumOfWeights += img_view[y-1,x-1]
  *     x_centroid = sumOfWeightsTimesXDists/sumOfWeights
  *     y_centroid = sumOfWeightsTimesYDists/sumOfWeights             # <<<<<<<<<<<<<<
  * 
  *     cntdresults_view[0] = x_centroid
  */
   if (unlikely(__pyx_v_sumOfWeights == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 172, __pyx_L1_error)
+    __PYX_ERR(0, 151, __pyx_L1_error)
   }
   __pyx_v_y_centroid = (__pyx_v_sumOfWeightsTimesYDists / __pyx_v_sumOfWeights);
 
-  /* "fastrometry/cython_code/PSE.pyx":174
+  /* "fastrometry/cython_code/PSE.pyx":153
  *     y_centroid = sumOfWeightsTimesYDists/sumOfWeights
  * 
  *     cntdresults_view[0] = x_centroid             # <<<<<<<<<<<<<<
  *     cntdresults_view[1] = y_centroid
  *     cntdresults_view[2] = sumOfWeights
  */
   __pyx_t_1 = 0;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 174, __pyx_L1_error)
+    __PYX_ERR(0, 153, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_1 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_x_centroid;
 
-  /* "fastrometry/cython_code/PSE.pyx":175
+  /* "fastrometry/cython_code/PSE.pyx":154
  * 
  *     cntdresults_view[0] = x_centroid
  *     cntdresults_view[1] = y_centroid             # <<<<<<<<<<<<<<
  *     cntdresults_view[2] = sumOfWeights
  * 
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 175, __pyx_L1_error)
+    __PYX_ERR(0, 154, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_1 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_y_centroid;
 
-  /* "fastrometry/cython_code/PSE.pyx":176
+  /* "fastrometry/cython_code/PSE.pyx":155
  *     cntdresults_view[0] = x_centroid
  *     cntdresults_view[1] = y_centroid
  *     cntdresults_view[2] = sumOfWeights             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_cntdresults_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 176, __pyx_L1_error)
+    __PYX_ERR(0, 155, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_1 * __pyx_v_cntdresults_view.strides[0]) )) = __pyx_v_sumOfWeights;
 
-  /* "fastrometry/cython_code/PSE.pyx":148
+  /* "fastrometry/cython_code/PSE.pyx":127
  * 
  * 
  * cdef findIslandCentroids(double[:,:] img_view, int[:] islandbnds_view, double[:] cntdresults_view):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -5683,15 +5105,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":179
+/* "fastrometry/cython_code/PSE.pyx":158
  * 
  * 
  * cdef doQuickerRecursiveWalk(Py_ssize_t x, Py_ssize_t y, int g, int[:,:] occupymap_view, int[:,:] srcindexmap_view):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t surr_x
  */
 
@@ -5712,15 +5134,15 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("doQuickerRecursiveWalk", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":184
+  /* "fastrometry/cython_code/PSE.pyx":163
  *         Py_ssize_t surr_y
  * 
  *     occupymap_view[y-1, x-1] = g             # <<<<<<<<<<<<<<
  *     srcindexmap_view[y-1, x-1] = g
  * 
  */
   __pyx_t_1 = (__pyx_v_y - 1);
@@ -5732,19 +5154,19 @@
   } else if (unlikely(__pyx_t_1 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_3 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_occupymap_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_3 = 1;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 184, __pyx_L1_error)
+    __PYX_ERR(0, 163, __pyx_L1_error)
   }
   *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_1 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_2 * __pyx_v_occupymap_view.strides[1]) )) = __pyx_v_g;
 
-  /* "fastrometry/cython_code/PSE.pyx":185
+  /* "fastrometry/cython_code/PSE.pyx":164
  * 
  *     occupymap_view[y-1, x-1] = g
  *     srcindexmap_view[y-1, x-1] = g             # <<<<<<<<<<<<<<
  * 
  *     for surr_x in range(x-1, x+2):
  */
   __pyx_t_2 = (__pyx_v_y - 1);
@@ -5756,43 +5178,43 @@
   } else if (unlikely(__pyx_t_2 >= __pyx_v_srcindexmap_view.shape[0])) __pyx_t_3 = 0;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_srcindexmap_view.shape[1];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_3 = 1;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_srcindexmap_view.shape[1])) __pyx_t_3 = 1;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 185, __pyx_L1_error)
+    __PYX_ERR(0, 164, __pyx_L1_error)
   }
   *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_view.data + __pyx_t_2 * __pyx_v_srcindexmap_view.strides[0]) ) + __pyx_t_1 * __pyx_v_srcindexmap_view.strides[1]) )) = __pyx_v_g;
 
-  /* "fastrometry/cython_code/PSE.pyx":187
+  /* "fastrometry/cython_code/PSE.pyx":166
  *     srcindexmap_view[y-1, x-1] = g
  * 
  *     for surr_x in range(x-1, x+2):             # <<<<<<<<<<<<<<
  *         for surr_y in range(y-1, y+2):
  *             if occupymap_view[surr_y-1, surr_x-1] == -2:
  */
   __pyx_t_4 = (__pyx_v_x + 2);
   __pyx_t_5 = __pyx_t_4;
   for (__pyx_t_6 = (__pyx_v_x - 1); __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_surr_x = __pyx_t_6;
 
-    /* "fastrometry/cython_code/PSE.pyx":188
+    /* "fastrometry/cython_code/PSE.pyx":167
  * 
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):             # <<<<<<<<<<<<<<
  *             if occupymap_view[surr_y-1, surr_x-1] == -2:
  *                 doQuickerRecursiveWalk(surr_x, surr_y, g, occupymap_view, srcindexmap_view)
  */
     __pyx_t_7 = (__pyx_v_y + 2);
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = (__pyx_v_y - 1); __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_surr_y = __pyx_t_9;
 
-      /* "fastrometry/cython_code/PSE.pyx":189
+      /* "fastrometry/cython_code/PSE.pyx":168
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):
  *             if occupymap_view[surr_y-1, surr_x-1] == -2:             # <<<<<<<<<<<<<<
  *                 doQuickerRecursiveWalk(surr_x, surr_y, g, occupymap_view, srcindexmap_view)
  * 
  */
       __pyx_t_1 = (__pyx_v_surr_y - 1);
@@ -5804,42 +5226,42 @@
       } else if (unlikely(__pyx_t_1 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_3 = 0;
       if (__pyx_t_2 < 0) {
         __pyx_t_2 += __pyx_v_occupymap_view.shape[1];
         if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 1;
       } else if (unlikely(__pyx_t_2 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_3 = 1;
       if (unlikely(__pyx_t_3 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_3);
-        __PYX_ERR(0, 189, __pyx_L1_error)
+        __PYX_ERR(0, 168, __pyx_L1_error)
       }
       __pyx_t_10 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_1 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_2 * __pyx_v_occupymap_view.strides[1]) ))) == -2L) != 0);
       if (__pyx_t_10) {
 
-        /* "fastrometry/cython_code/PSE.pyx":190
+        /* "fastrometry/cython_code/PSE.pyx":169
  *         for surr_y in range(y-1, y+2):
  *             if occupymap_view[surr_y-1, surr_x-1] == -2:
  *                 doQuickerRecursiveWalk(surr_x, surr_y, g, occupymap_view, srcindexmap_view)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-        __pyx_t_11 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(__pyx_v_surr_x, __pyx_v_surr_y, __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_view); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 190, __pyx_L1_error)
+        __pyx_t_11 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(__pyx_v_surr_x, __pyx_v_surr_y, __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_view); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 169, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-        /* "fastrometry/cython_code/PSE.pyx":189
+        /* "fastrometry/cython_code/PSE.pyx":168
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):
  *             if occupymap_view[surr_y-1, surr_x-1] == -2:             # <<<<<<<<<<<<<<
  *                 doQuickerRecursiveWalk(surr_x, surr_y, g, occupymap_view, srcindexmap_view)
  * 
  */
       }
     }
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":179
+  /* "fastrometry/cython_code/PSE.pyx":158
  * 
  * 
  * cdef doQuickerRecursiveWalk(Py_ssize_t x, Py_ssize_t y, int g, int[:,:] occupymap_view, int[:,:] srcindexmap_view):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t surr_x
  */
 
@@ -5852,15 +5274,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":193
+/* "fastrometry/cython_code/PSE.pyx":172
  * 
  * 
  * cdef bint isOnIsland(Py_ssize_t surr_x, Py_ssize_t surr_y, double[:,:] img_view, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, double pixsat, int[:,:] occupymap_view):             # <<<<<<<<<<<<<<
  *     """
  *     A pixel is on the island if it is saturated, unclaimed by another source, and in the image
  */
 
@@ -5874,15 +5296,15 @@
   int __pyx_t_5;
   int __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("isOnIsland", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":197
+  /* "fastrometry/cython_code/PSE.pyx":176
  *     A pixel is on the island if it is saturated, unclaimed by another source, and in the image
  *     """
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:             # <<<<<<<<<<<<<<
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:
  */
   __pyx_t_1 = (__pyx_v_surr_y - 1);
@@ -5894,20 +5316,20 @@
   } else if (unlikely(__pyx_t_1 >= __pyx_v_img_view.shape[0])) __pyx_t_3 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_img_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_img_view.shape[1])) __pyx_t_3 = 1;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 197, __pyx_L1_error)
+    __PYX_ERR(0, 176, __pyx_L1_error)
   }
   __pyx_t_4 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_1 * __pyx_v_img_view.strides[0]) ) + __pyx_t_2 * __pyx_v_img_view.strides[1]) ))) >= __pyx_v_pixsat) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":198
+    /* "fastrometry/cython_code/PSE.pyx":177
  *     """
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:             # <<<<<<<<<<<<<<
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:
  *                 return True
  */
     __pyx_t_2 = (__pyx_v_surr_y - 1);
@@ -5919,20 +5341,20 @@
     } else if (unlikely(__pyx_t_2 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_3 = 0;
     if (__pyx_t_1 < 0) {
       __pyx_t_1 += __pyx_v_occupymap_view.shape[1];
       if (unlikely(__pyx_t_1 < 0)) __pyx_t_3 = 1;
     } else if (unlikely(__pyx_t_1 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_3 = 1;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      __PYX_ERR(0, 198, __pyx_L1_error)
+      __PYX_ERR(0, 177, __pyx_L1_error)
     }
     __pyx_t_4 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_2 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_1 * __pyx_v_occupymap_view.strides[1]) ))) == -1L) != 0);
     if (__pyx_t_4) {
 
-      /* "fastrometry/cython_code/PSE.pyx":199
+      /* "fastrometry/cython_code/PSE.pyx":178
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:             # <<<<<<<<<<<<<<
  *                 return True
  *     else:
  */
       __pyx_t_5 = (__pyx_v_leftmostsafe_x <= __pyx_v_surr_x);
@@ -5950,66 +5372,66 @@
         __pyx_t_6 = (__pyx_v_surr_y <= __pyx_v_bottommostsafe_y);
       }
       __pyx_t_5 = (__pyx_t_6 != 0);
       __pyx_t_4 = __pyx_t_5;
       __pyx_L6_bool_binop_done:;
       if (__pyx_t_4) {
 
-        /* "fastrometry/cython_code/PSE.pyx":200
+        /* "fastrometry/cython_code/PSE.pyx":179
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:
  *                 return True             # <<<<<<<<<<<<<<
  *     else:
  *         return False
  */
         __pyx_r = 1;
         goto __pyx_L0;
 
-        /* "fastrometry/cython_code/PSE.pyx":199
+        /* "fastrometry/cython_code/PSE.pyx":178
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:             # <<<<<<<<<<<<<<
  *                 return True
  *     else:
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":198
+      /* "fastrometry/cython_code/PSE.pyx":177
  *     """
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:             # <<<<<<<<<<<<<<
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:
  *                 return True
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":197
+    /* "fastrometry/cython_code/PSE.pyx":176
  *     A pixel is on the island if it is saturated, unclaimed by another source, and in the image
  *     """
  *     if img_view[surr_y-1, surr_x-1] >= pixsat:             # <<<<<<<<<<<<<<
  *         if occupymap_view[surr_y-1, surr_x-1] == -1:
  *             if leftmostsafe_x <= surr_x <= rightmostsafe_x and topmostsafe_y <= surr_y <= bottommostsafe_y:
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":202
+  /* "fastrometry/cython_code/PSE.pyx":181
  *                 return True
  *     else:
  *         return False             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __pyx_r = 0;
     goto __pyx_L0;
   }
   __pyx_L3:;
 
-  /* "fastrometry/cython_code/PSE.pyx":193
+  /* "fastrometry/cython_code/PSE.pyx":172
  * 
  * 
  * cdef bint isOnIsland(Py_ssize_t surr_x, Py_ssize_t surr_y, double[:,:] img_view, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, double pixsat, int[:,:] occupymap_view):             # <<<<<<<<<<<<<<
  *     """
  *     A pixel is on the island if it is saturated, unclaimed by another source, and in the image
  */
 
@@ -6020,15 +5442,15 @@
   __Pyx_WriteUnraisable("fastrometry.cython_code.PSE.isOnIsland", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":205
+/* "fastrometry/cython_code/PSE.pyx":184
  * 
  * 
  * cdef doRecursiveWalk(Py_ssize_t x, Py_ssize_t y, double[:,:] img_view, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, double pixsat, int[:] islandbnds_view, int[:,:] occupymap_view, int curr_src_ind):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t surr_x
  */
 
@@ -6049,15 +5471,15 @@
   Py_ssize_t __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("doRecursiveWalk", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":210
+  /* "fastrometry/cython_code/PSE.pyx":189
  *         Py_ssize_t surr_y
  * 
  *     occupymap_view[y-1,x-1] = -2    #-2 indicates the presence of an island             # <<<<<<<<<<<<<<
  * 
  *     if x < islandbnds_view[0]:
  */
   __pyx_t_1 = (__pyx_v_y - 1);
@@ -6069,267 +5491,267 @@
   } else if (unlikely(__pyx_t_1 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_3 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_occupymap_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_3 = 1;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 210, __pyx_L1_error)
+    __PYX_ERR(0, 189, __pyx_L1_error)
   }
   *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_1 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_2 * __pyx_v_occupymap_view.strides[1]) )) = -2;
 
-  /* "fastrometry/cython_code/PSE.pyx":212
+  /* "fastrometry/cython_code/PSE.pyx":191
  *     occupymap_view[y-1,x-1] = -2    #-2 indicates the presence of an island
  * 
  *     if x < islandbnds_view[0]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[0] = x
  *     if x > islandbnds_view[1]:
  */
   __pyx_t_2 = 0;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 212, __pyx_L1_error)
+    __PYX_ERR(0, 191, __pyx_L1_error)
   }
   __pyx_t_4 = ((__pyx_v_x < (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":213
+    /* "fastrometry/cython_code/PSE.pyx":192
  * 
  *     if x < islandbnds_view[0]:
  *         islandbnds_view[0] = x             # <<<<<<<<<<<<<<
  *     if x > islandbnds_view[1]:
  *         islandbnds_view[1] = x
  */
     __pyx_t_2 = 0;
     __pyx_t_3 = -1;
     if (__pyx_t_2 < 0) {
       __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
     } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      __PYX_ERR(0, 213, __pyx_L1_error)
+      __PYX_ERR(0, 192, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_x;
 
-    /* "fastrometry/cython_code/PSE.pyx":212
+    /* "fastrometry/cython_code/PSE.pyx":191
  *     occupymap_view[y-1,x-1] = -2    #-2 indicates the presence of an island
  * 
  *     if x < islandbnds_view[0]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[0] = x
  *     if x > islandbnds_view[1]:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":214
+  /* "fastrometry/cython_code/PSE.pyx":193
  *     if x < islandbnds_view[0]:
  *         islandbnds_view[0] = x
  *     if x > islandbnds_view[1]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[1] = x
  *     if y < islandbnds_view[2]:
  */
   __pyx_t_2 = 1;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 214, __pyx_L1_error)
+    __PYX_ERR(0, 193, __pyx_L1_error)
   }
   __pyx_t_4 = ((__pyx_v_x > (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":215
+    /* "fastrometry/cython_code/PSE.pyx":194
  *         islandbnds_view[0] = x
  *     if x > islandbnds_view[1]:
  *         islandbnds_view[1] = x             # <<<<<<<<<<<<<<
  *     if y < islandbnds_view[2]:
  *         islandbnds_view[2] = y
  */
     __pyx_t_2 = 1;
     __pyx_t_3 = -1;
     if (__pyx_t_2 < 0) {
       __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
     } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      __PYX_ERR(0, 215, __pyx_L1_error)
+      __PYX_ERR(0, 194, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_x;
 
-    /* "fastrometry/cython_code/PSE.pyx":214
+    /* "fastrometry/cython_code/PSE.pyx":193
  *     if x < islandbnds_view[0]:
  *         islandbnds_view[0] = x
  *     if x > islandbnds_view[1]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[1] = x
  *     if y < islandbnds_view[2]:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":216
+  /* "fastrometry/cython_code/PSE.pyx":195
  *     if x > islandbnds_view[1]:
  *         islandbnds_view[1] = x
  *     if y < islandbnds_view[2]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[2] = y
  *     if y > islandbnds_view[3]:
  */
   __pyx_t_2 = 2;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 216, __pyx_L1_error)
+    __PYX_ERR(0, 195, __pyx_L1_error)
   }
   __pyx_t_4 = ((__pyx_v_y < (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":217
+    /* "fastrometry/cython_code/PSE.pyx":196
  *         islandbnds_view[1] = x
  *     if y < islandbnds_view[2]:
  *         islandbnds_view[2] = y             # <<<<<<<<<<<<<<
  *     if y > islandbnds_view[3]:
  *         islandbnds_view[3] = y
  */
     __pyx_t_2 = 2;
     __pyx_t_3 = -1;
     if (__pyx_t_2 < 0) {
       __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
     } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      __PYX_ERR(0, 217, __pyx_L1_error)
+      __PYX_ERR(0, 196, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_y;
 
-    /* "fastrometry/cython_code/PSE.pyx":216
+    /* "fastrometry/cython_code/PSE.pyx":195
  *     if x > islandbnds_view[1]:
  *         islandbnds_view[1] = x
  *     if y < islandbnds_view[2]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[2] = y
  *     if y > islandbnds_view[3]:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":218
+  /* "fastrometry/cython_code/PSE.pyx":197
  *     if y < islandbnds_view[2]:
  *         islandbnds_view[2] = y
  *     if y > islandbnds_view[3]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[3] = y
  * 
  */
   __pyx_t_2 = 3;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 218, __pyx_L1_error)
+    __PYX_ERR(0, 197, __pyx_L1_error)
   }
   __pyx_t_4 = ((__pyx_v_y > (*((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )))) != 0);
   if (__pyx_t_4) {
 
-    /* "fastrometry/cython_code/PSE.pyx":219
+    /* "fastrometry/cython_code/PSE.pyx":198
  *         islandbnds_view[2] = y
  *     if y > islandbnds_view[3]:
  *         islandbnds_view[3] = y             # <<<<<<<<<<<<<<
  * 
  *     for surr_x in range(x-1, x+2):
  */
     __pyx_t_2 = 3;
     __pyx_t_3 = -1;
     if (__pyx_t_2 < 0) {
       __pyx_t_2 += __pyx_v_islandbnds_view.shape[0];
       if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
     } else if (unlikely(__pyx_t_2 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_3 = 0;
     if (unlikely(__pyx_t_3 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_3);
-      __PYX_ERR(0, 219, __pyx_L1_error)
+      __PYX_ERR(0, 198, __pyx_L1_error)
     }
     *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_2 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_y;
 
-    /* "fastrometry/cython_code/PSE.pyx":218
+    /* "fastrometry/cython_code/PSE.pyx":197
  *     if y < islandbnds_view[2]:
  *         islandbnds_view[2] = y
  *     if y > islandbnds_view[3]:             # <<<<<<<<<<<<<<
  *         islandbnds_view[3] = y
  * 
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":221
+  /* "fastrometry/cython_code/PSE.pyx":200
  *         islandbnds_view[3] = y
  * 
  *     for surr_x in range(x-1, x+2):             # <<<<<<<<<<<<<<
  *         for surr_y in range(y-1, y+2):
  *             if isOnIsland(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, occupymap_view):
  */
   __pyx_t_5 = (__pyx_v_x + 2);
   __pyx_t_6 = __pyx_t_5;
   for (__pyx_t_7 = (__pyx_v_x - 1); __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
     __pyx_v_surr_x = __pyx_t_7;
 
-    /* "fastrometry/cython_code/PSE.pyx":222
+    /* "fastrometry/cython_code/PSE.pyx":201
  * 
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):             # <<<<<<<<<<<<<<
  *             if isOnIsland(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, occupymap_view):
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  */
     __pyx_t_8 = (__pyx_v_y + 2);
     __pyx_t_9 = __pyx_t_8;
     for (__pyx_t_10 = (__pyx_v_y - 1); __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
       __pyx_v_surr_y = __pyx_t_10;
 
-      /* "fastrometry/cython_code/PSE.pyx":223
+      /* "fastrometry/cython_code/PSE.pyx":202
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):
  *             if isOnIsland(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, occupymap_view):             # <<<<<<<<<<<<<<
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  * 
  */
       __pyx_t_4 = (__pyx_f_11fastrometry_11cython_code_3PSE_isOnIsland(__pyx_v_surr_x, __pyx_v_surr_y, __pyx_v_img_view, __pyx_v_leftmostsafe_x, __pyx_v_rightmostsafe_x, __pyx_v_topmostsafe_y, __pyx_v_bottommostsafe_y, __pyx_v_pixsat, __pyx_v_occupymap_view) != 0);
       if (__pyx_t_4) {
 
-        /* "fastrometry/cython_code/PSE.pyx":224
+        /* "fastrometry/cython_code/PSE.pyx":203
  *         for surr_y in range(y-1, y+2):
  *             if isOnIsland(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, occupymap_view):
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)             # <<<<<<<<<<<<<<
  * 
  * cdef int mapSaturationIslands(double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int[:,:] roi_view, np.ndarray[ndim=2,dtype=np.double_t] pse_metadata, int[:,:] occupymap_view, int[:,:] srcindexmap_initial_view, int[:,:] srcindexmap_refine_view, int sourcesep, double pixsat, int npts, int nrefinepts, int curr_src_ind, debug_report, int verbosity, bint debug):
  */
-        __pyx_t_11 = __pyx_f_11fastrometry_11cython_code_3PSE_doRecursiveWalk(__pyx_v_surr_x, __pyx_v_surr_y, __pyx_v_img_view, __pyx_v_leftmostsafe_x, __pyx_v_rightmostsafe_x, __pyx_v_topmostsafe_y, __pyx_v_bottommostsafe_y, __pyx_v_pixsat, __pyx_v_islandbnds_view, __pyx_v_occupymap_view, __pyx_v_curr_src_ind); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 224, __pyx_L1_error)
+        __pyx_t_11 = __pyx_f_11fastrometry_11cython_code_3PSE_doRecursiveWalk(__pyx_v_surr_x, __pyx_v_surr_y, __pyx_v_img_view, __pyx_v_leftmostsafe_x, __pyx_v_rightmostsafe_x, __pyx_v_topmostsafe_y, __pyx_v_bottommostsafe_y, __pyx_v_pixsat, __pyx_v_islandbnds_view, __pyx_v_occupymap_view, __pyx_v_curr_src_ind); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 203, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-        /* "fastrometry/cython_code/PSE.pyx":223
+        /* "fastrometry/cython_code/PSE.pyx":202
  *     for surr_x in range(x-1, x+2):
  *         for surr_y in range(y-1, y+2):
  *             if isOnIsland(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, occupymap_view):             # <<<<<<<<<<<<<<
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  * 
  */
       }
     }
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":205
+  /* "fastrometry/cython_code/PSE.pyx":184
  * 
  * 
  * cdef doRecursiveWalk(Py_ssize_t x, Py_ssize_t y, double[:,:] img_view, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, double pixsat, int[:] islandbnds_view, int[:,:] occupymap_view, int curr_src_ind):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t surr_x
  */
 
@@ -6342,15 +5764,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":226
+/* "fastrometry/cython_code/PSE.pyx":205
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  * 
  * cdef int mapSaturationIslands(double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int[:,:] roi_view, np.ndarray[ndim=2,dtype=np.double_t] pse_metadata, int[:,:] occupymap_view, int[:,:] srcindexmap_initial_view, int[:,:] srcindexmap_refine_view, int sourcesep, double pixsat, int npts, int nrefinepts, int curr_src_ind, debug_report, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -6397,141 +5819,141 @@
   __Pyx_RefNannySetupContext("mapSaturationIslands", 0);
   __pyx_pybuffer_pse_metadata.pybuffer.buf = NULL;
   __pyx_pybuffer_pse_metadata.refcount = 0;
   __pyx_pybuffernd_pse_metadata.data = NULL;
   __pyx_pybuffernd_pse_metadata.rcbuffer = &__pyx_pybuffer_pse_metadata;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer, (PyObject*)__pyx_v_pse_metadata, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 226, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer, (PyObject*)__pyx_v_pse_metadata, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 205, __pyx_L1_error)
   }
   __pyx_pybuffernd_pse_metadata.diminfo[0].strides = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pse_metadata.diminfo[0].shape = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_pse_metadata.diminfo[1].strides = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_pse_metadata.diminfo[1].shape = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.shape[1];
 
-  /* "fastrometry/cython_code/PSE.pyx":233
+  /* "fastrometry/cython_code/PSE.pyx":212
  *         Py_ssize_t g
  * 
  *         double[:,:] pse_metadata_view = pse_metadata             # <<<<<<<<<<<<<<
  *         int[:] islandbnds_view = np.zeros(4,dtype=int)
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  */
-  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_pse_metadata), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 233, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_pse_metadata), PyBUF_WRITABLE); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 212, __pyx_L1_error)
   __pyx_v_pse_metadata_view = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":234
+  /* "fastrometry/cython_code/PSE.pyx":213
  * 
  *         double[:,:] pse_metadata_view = pse_metadata
  *         int[:] islandbnds_view = np.zeros(4,dtype=int)             # <<<<<<<<<<<<<<
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 234, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__7, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 234, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__3, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_int(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 234, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_int(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_islandbnds_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":235
+  /* "fastrometry/cython_code/PSE.pyx":214
  *         double[:,:] pse_metadata_view = pse_metadata
  *         int[:] islandbnds_view = np.zeros(4,dtype=int)
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     if pixsat == 0:         #no saturation in image
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 235, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__8, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__4, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_cntdresults_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":237
+  /* "fastrometry/cython_code/PSE.pyx":216
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  *     if pixsat == 0:         #no saturation in image             # <<<<<<<<<<<<<<
  *         return 0        #curr_src_ind, since no islands can be found
  *     else:
  */
   __pyx_t_8 = ((__pyx_v_pixsat == 0.0) != 0);
   if (__pyx_t_8) {
 
-    /* "fastrometry/cython_code/PSE.pyx":238
+    /* "fastrometry/cython_code/PSE.pyx":217
  * 
  *     if pixsat == 0:         #no saturation in image
  *         return 0        #curr_src_ind, since no islands can be found             # <<<<<<<<<<<<<<
  *     else:
  *         for x in range(leftmostsafe_x,rightmostsafe_x+1):
  */
     __pyx_r = 0;
     goto __pyx_L0;
 
-    /* "fastrometry/cython_code/PSE.pyx":237
+    /* "fastrometry/cython_code/PSE.pyx":216
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  *     if pixsat == 0:         #no saturation in image             # <<<<<<<<<<<<<<
  *         return 0        #curr_src_ind, since no islands can be found
  *     else:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":240
+  /* "fastrometry/cython_code/PSE.pyx":219
  *         return 0        #curr_src_ind, since no islands can be found
  *     else:
  *         for x in range(leftmostsafe_x,rightmostsafe_x+1):             # <<<<<<<<<<<<<<
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):
  *                 if img_view[y-1,x-1] >= pixsat:
  */
   /*else*/ {
     __pyx_t_9 = (__pyx_v_rightmostsafe_x + 1);
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = __pyx_v_leftmostsafe_x; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_x = __pyx_t_11;
 
-      /* "fastrometry/cython_code/PSE.pyx":241
+      /* "fastrometry/cython_code/PSE.pyx":220
  *     else:
  *         for x in range(leftmostsafe_x,rightmostsafe_x+1):
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):             # <<<<<<<<<<<<<<
  *                 if img_view[y-1,x-1] >= pixsat:
  *                     if roi_view[y-1,x-1] == 1:
  */
       __pyx_t_12 = (__pyx_v_bottommostsafe_y + 1);
       __pyx_t_13 = __pyx_t_12;
       for (__pyx_t_14 = __pyx_v_topmostsafe_y; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
         __pyx_v_y = __pyx_t_14;
 
-        /* "fastrometry/cython_code/PSE.pyx":242
+        /* "fastrometry/cython_code/PSE.pyx":221
  *         for x in range(leftmostsafe_x,rightmostsafe_x+1):
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):
  *                 if img_view[y-1,x-1] >= pixsat:             # <<<<<<<<<<<<<<
  *                     if roi_view[y-1,x-1] == 1:
  *                         if occupymap_view[y-1,x-1] == -1:
  */
         __pyx_t_15 = (__pyx_v_y - 1);
@@ -6543,20 +5965,20 @@
         } else if (unlikely(__pyx_t_15 >= __pyx_v_img_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_16 < 0) {
           __pyx_t_16 += __pyx_v_img_view.shape[1];
           if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_16 >= __pyx_v_img_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 242, __pyx_L1_error)
+          __PYX_ERR(0, 221, __pyx_L1_error)
         }
         __pyx_t_8 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_15 * __pyx_v_img_view.strides[0]) ) + __pyx_t_16 * __pyx_v_img_view.strides[1]) ))) >= __pyx_v_pixsat) != 0);
         if (__pyx_t_8) {
 
-          /* "fastrometry/cython_code/PSE.pyx":243
+          /* "fastrometry/cython_code/PSE.pyx":222
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):
  *                 if img_view[y-1,x-1] >= pixsat:
  *                     if roi_view[y-1,x-1] == 1:             # <<<<<<<<<<<<<<
  *                         if occupymap_view[y-1,x-1] == -1:
  *                             islandbnds_view[0] = x
  */
           __pyx_t_16 = (__pyx_v_y - 1);
@@ -6568,20 +5990,20 @@
           } else if (unlikely(__pyx_t_16 >= __pyx_v_roi_view.shape[0])) __pyx_t_17 = 0;
           if (__pyx_t_15 < 0) {
             __pyx_t_15 += __pyx_v_roi_view.shape[1];
             if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 1;
           } else if (unlikely(__pyx_t_15 >= __pyx_v_roi_view.shape[1])) __pyx_t_17 = 1;
           if (unlikely(__pyx_t_17 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_17);
-            __PYX_ERR(0, 243, __pyx_L1_error)
+            __PYX_ERR(0, 222, __pyx_L1_error)
           }
           __pyx_t_8 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_roi_view.data + __pyx_t_16 * __pyx_v_roi_view.strides[0]) ) + __pyx_t_15 * __pyx_v_roi_view.strides[1]) ))) == 1) != 0);
           if (__pyx_t_8) {
 
-            /* "fastrometry/cython_code/PSE.pyx":244
+            /* "fastrometry/cython_code/PSE.pyx":223
  *                 if img_view[y-1,x-1] >= pixsat:
  *                     if roi_view[y-1,x-1] == 1:
  *                         if occupymap_view[y-1,x-1] == -1:             # <<<<<<<<<<<<<<
  *                             islandbnds_view[0] = x
  *                             islandbnds_view[1] = x
  */
             __pyx_t_15 = (__pyx_v_y - 1);
@@ -6593,268 +6015,268 @@
             } else if (unlikely(__pyx_t_15 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_17 = 0;
             if (__pyx_t_16 < 0) {
               __pyx_t_16 += __pyx_v_occupymap_view.shape[1];
               if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 1;
             } else if (unlikely(__pyx_t_16 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_17 = 1;
             if (unlikely(__pyx_t_17 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_17);
-              __PYX_ERR(0, 244, __pyx_L1_error)
+              __PYX_ERR(0, 223, __pyx_L1_error)
             }
             __pyx_t_8 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_15 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_16 * __pyx_v_occupymap_view.strides[1]) ))) == -1L) != 0);
             if (__pyx_t_8) {
 
-              /* "fastrometry/cython_code/PSE.pyx":245
+              /* "fastrometry/cython_code/PSE.pyx":224
  *                     if roi_view[y-1,x-1] == 1:
  *                         if occupymap_view[y-1,x-1] == -1:
  *                             islandbnds_view[0] = x             # <<<<<<<<<<<<<<
  *                             islandbnds_view[1] = x
  *                             islandbnds_view[2] = y
  */
               __pyx_t_16 = 0;
               __pyx_t_17 = -1;
               if (__pyx_t_16 < 0) {
                 __pyx_t_16 += __pyx_v_islandbnds_view.shape[0];
                 if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
               } else if (unlikely(__pyx_t_16 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_17 = 0;
               if (unlikely(__pyx_t_17 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                __PYX_ERR(0, 245, __pyx_L1_error)
+                __PYX_ERR(0, 224, __pyx_L1_error)
               }
               *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_16 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_x;
 
-              /* "fastrometry/cython_code/PSE.pyx":246
+              /* "fastrometry/cython_code/PSE.pyx":225
  *                         if occupymap_view[y-1,x-1] == -1:
  *                             islandbnds_view[0] = x
  *                             islandbnds_view[1] = x             # <<<<<<<<<<<<<<
  *                             islandbnds_view[2] = y
  *                             islandbnds_view[3] = y
  */
               __pyx_t_16 = 1;
               __pyx_t_17 = -1;
               if (__pyx_t_16 < 0) {
                 __pyx_t_16 += __pyx_v_islandbnds_view.shape[0];
                 if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
               } else if (unlikely(__pyx_t_16 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_17 = 0;
               if (unlikely(__pyx_t_17 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                __PYX_ERR(0, 246, __pyx_L1_error)
+                __PYX_ERR(0, 225, __pyx_L1_error)
               }
               *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_16 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_x;
 
-              /* "fastrometry/cython_code/PSE.pyx":247
+              /* "fastrometry/cython_code/PSE.pyx":226
  *                             islandbnds_view[0] = x
  *                             islandbnds_view[1] = x
  *                             islandbnds_view[2] = y             # <<<<<<<<<<<<<<
  *                             islandbnds_view[3] = y
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  */
               __pyx_t_16 = 2;
               __pyx_t_17 = -1;
               if (__pyx_t_16 < 0) {
                 __pyx_t_16 += __pyx_v_islandbnds_view.shape[0];
                 if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
               } else if (unlikely(__pyx_t_16 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_17 = 0;
               if (unlikely(__pyx_t_17 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                __PYX_ERR(0, 247, __pyx_L1_error)
+                __PYX_ERR(0, 226, __pyx_L1_error)
               }
               *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_16 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_y;
 
-              /* "fastrometry/cython_code/PSE.pyx":248
+              /* "fastrometry/cython_code/PSE.pyx":227
  *                             islandbnds_view[1] = x
  *                             islandbnds_view[2] = y
  *                             islandbnds_view[3] = y             # <<<<<<<<<<<<<<
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)
  */
               __pyx_t_16 = 3;
               __pyx_t_17 = -1;
               if (__pyx_t_16 < 0) {
                 __pyx_t_16 += __pyx_v_islandbnds_view.shape[0];
                 if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
               } else if (unlikely(__pyx_t_16 >= __pyx_v_islandbnds_view.shape[0])) __pyx_t_17 = 0;
               if (unlikely(__pyx_t_17 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                __PYX_ERR(0, 248, __pyx_L1_error)
+                __PYX_ERR(0, 227, __pyx_L1_error)
               }
               *((int *) ( /* dim=0 */ (__pyx_v_islandbnds_view.data + __pyx_t_16 * __pyx_v_islandbnds_view.strides[0]) )) = __pyx_v_y;
 
-              /* "fastrometry/cython_code/PSE.pyx":249
+              /* "fastrometry/cython_code/PSE.pyx":228
  *                             islandbnds_view[2] = y
  *                             islandbnds_view[3] = y
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)             # <<<<<<<<<<<<<<
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)
  *                             if curr_src_ind < nrefinepts:
  */
-              __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doRecursiveWalk(__pyx_v_x, __pyx_v_y, __pyx_v_img_view, __pyx_v_leftmostsafe_x, __pyx_v_rightmostsafe_x, __pyx_v_topmostsafe_y, __pyx_v_bottommostsafe_y, __pyx_v_pixsat, __pyx_v_islandbnds_view, __pyx_v_occupymap_view, __pyx_v_curr_src_ind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 249, __pyx_L1_error)
+              __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doRecursiveWalk(__pyx_v_x, __pyx_v_y, __pyx_v_img_view, __pyx_v_leftmostsafe_x, __pyx_v_rightmostsafe_x, __pyx_v_topmostsafe_y, __pyx_v_bottommostsafe_y, __pyx_v_pixsat, __pyx_v_islandbnds_view, __pyx_v_occupymap_view, __pyx_v_curr_src_ind); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-              /* "fastrometry/cython_code/PSE.pyx":250
+              /* "fastrometry/cython_code/PSE.pyx":229
  *                             islandbnds_view[3] = y
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)             # <<<<<<<<<<<<<<
  *                             if curr_src_ind < nrefinepts:
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid
  */
-              __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_findIslandCentroids(__pyx_v_img_view, __pyx_v_islandbnds_view, __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 250, __pyx_L1_error)
+              __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_findIslandCentroids(__pyx_v_img_view, __pyx_v_islandbnds_view, __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 229, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_6);
               __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-              /* "fastrometry/cython_code/PSE.pyx":251
+              /* "fastrometry/cython_code/PSE.pyx":230
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)
  *                             if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid
  *                                 pse_metadata_view[curr_src_ind,1] = cntdresults_view[1]    #y centroid
  */
               __pyx_t_8 = ((__pyx_v_curr_src_ind < __pyx_v_nrefinepts) != 0);
               if (__pyx_t_8) {
 
-                /* "fastrometry/cython_code/PSE.pyx":252
+                /* "fastrometry/cython_code/PSE.pyx":231
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)
  *                             if curr_src_ind < nrefinepts:
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid             # <<<<<<<<<<<<<<
  *                                 pse_metadata_view[curr_src_ind,1] = cntdresults_view[1]    #y centroid
  *                                 pse_metadata_view[curr_src_ind,2] = cntdresults_view[2]    #rectangular kernel sum
  */
                 __pyx_t_16 = 0;
                 __pyx_t_17 = -1;
                 if (__pyx_t_16 < 0) {
                   __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                   if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 252, __pyx_L1_error)
+                  __PYX_ERR(0, 231, __pyx_L1_error)
                 }
                 __pyx_t_15 = __pyx_v_curr_src_ind;
                 __pyx_t_18 = 0;
                 __pyx_t_17 = -1;
                 if (__pyx_t_15 < 0) {
                   __pyx_t_15 += __pyx_v_pse_metadata_view.shape[0];
                   if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                 if (__pyx_t_18 < 0) {
                   __pyx_t_18 += __pyx_v_pse_metadata_view.shape[1];
                   if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 1;
                 } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 252, __pyx_L1_error)
+                  __PYX_ERR(0, 231, __pyx_L1_error)
                 }
                 *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                /* "fastrometry/cython_code/PSE.pyx":253
+                /* "fastrometry/cython_code/PSE.pyx":232
  *                             if curr_src_ind < nrefinepts:
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid
  *                                 pse_metadata_view[curr_src_ind,1] = cntdresults_view[1]    #y centroid             # <<<<<<<<<<<<<<
  *                                 pse_metadata_view[curr_src_ind,2] = cntdresults_view[2]    #rectangular kernel sum
  *                             else:
  */
                 __pyx_t_16 = 1;
                 __pyx_t_17 = -1;
                 if (__pyx_t_16 < 0) {
                   __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                   if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 253, __pyx_L1_error)
+                  __PYX_ERR(0, 232, __pyx_L1_error)
                 }
                 __pyx_t_18 = __pyx_v_curr_src_ind;
                 __pyx_t_15 = 1;
                 __pyx_t_17 = -1;
                 if (__pyx_t_18 < 0) {
                   __pyx_t_18 += __pyx_v_pse_metadata_view.shape[0];
                   if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                 if (__pyx_t_15 < 0) {
                   __pyx_t_15 += __pyx_v_pse_metadata_view.shape[1];
                   if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 1;
                 } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 253, __pyx_L1_error)
+                  __PYX_ERR(0, 232, __pyx_L1_error)
                 }
                 *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                /* "fastrometry/cython_code/PSE.pyx":254
+                /* "fastrometry/cython_code/PSE.pyx":233
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid
  *                                 pse_metadata_view[curr_src_ind,1] = cntdresults_view[1]    #y centroid
  *                                 pse_metadata_view[curr_src_ind,2] = cntdresults_view[2]    #rectangular kernel sum             # <<<<<<<<<<<<<<
  *                             else:
  *                                 dimmest = np.inf
  */
                 __pyx_t_16 = 2;
                 __pyx_t_17 = -1;
                 if (__pyx_t_16 < 0) {
                   __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                   if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 254, __pyx_L1_error)
+                  __PYX_ERR(0, 233, __pyx_L1_error)
                 }
                 __pyx_t_15 = __pyx_v_curr_src_ind;
                 __pyx_t_18 = 2;
                 __pyx_t_17 = -1;
                 if (__pyx_t_15 < 0) {
                   __pyx_t_15 += __pyx_v_pse_metadata_view.shape[0];
                   if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                 if (__pyx_t_18 < 0) {
                   __pyx_t_18 += __pyx_v_pse_metadata_view.shape[1];
                   if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 1;
                 } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 254, __pyx_L1_error)
+                  __PYX_ERR(0, 233, __pyx_L1_error)
                 }
                 *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                /* "fastrometry/cython_code/PSE.pyx":251
+                /* "fastrometry/cython_code/PSE.pyx":230
  *                             doRecursiveWalk(x, y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  *                             findIslandCentroids(img_view, islandbnds_view, cntdresults_view)
  *                             if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *                                 pse_metadata_view[curr_src_ind,0] = cntdresults_view[0]    #x centroid
  *                                 pse_metadata_view[curr_src_ind,1] = cntdresults_view[1]    #y centroid
  */
                 goto __pyx_L11;
               }
 
-              /* "fastrometry/cython_code/PSE.pyx":256
+              /* "fastrometry/cython_code/PSE.pyx":235
  *                                 pse_metadata_view[curr_src_ind,2] = cntdresults_view[2]    #rectangular kernel sum
  *                             else:
  *                                 dimmest = np.inf             # <<<<<<<<<<<<<<
  *                                 for p in range(nrefinepts):
  *                                     if pse_metadata_view[p,2] < dimmest:
  */
               /*else*/ {
-                __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
+                __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
-                __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
+                __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_4);
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                 __Pyx_XDECREF_SET(__pyx_v_dimmest, __pyx_t_4);
                 __pyx_t_4 = 0;
 
-                /* "fastrometry/cython_code/PSE.pyx":257
+                /* "fastrometry/cython_code/PSE.pyx":236
  *                             else:
  *                                 dimmest = np.inf
  *                                 for p in range(nrefinepts):             # <<<<<<<<<<<<<<
  *                                     if pse_metadata_view[p,2] < dimmest:
  *                                         dimmest = pse_metadata_view[p,2]
  */
                 __pyx_t_17 = __pyx_v_nrefinepts;
                 __pyx_t_19 = __pyx_t_17;
                 for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
                   __pyx_v_p = __pyx_t_20;
 
-                  /* "fastrometry/cython_code/PSE.pyx":258
+                  /* "fastrometry/cython_code/PSE.pyx":237
  *                                 dimmest = np.inf
  *                                 for p in range(nrefinepts):
  *                                     if pse_metadata_view[p,2] < dimmest:             # <<<<<<<<<<<<<<
  *                                         dimmest = pse_metadata_view[p,2]
  *                                         dimmest_ind = p
  */
                   __pyx_t_16 = __pyx_v_p;
@@ -6866,25 +6288,25 @@
                   } else if (unlikely(__pyx_t_16 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_21 = 0;
                   if (__pyx_t_18 < 0) {
                     __pyx_t_18 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_18 < 0)) __pyx_t_21 = 1;
                   } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_21 = 1;
                   if (unlikely(__pyx_t_21 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_21);
-                    __PYX_ERR(0, 258, __pyx_L1_error)
+                    __PYX_ERR(0, 237, __pyx_L1_error)
                   }
-                  __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
+                  __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_4);
-                  __pyx_t_6 = PyObject_RichCompare(__pyx_t_4, __pyx_v_dimmest, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
+                  __pyx_t_6 = PyObject_RichCompare(__pyx_t_4, __pyx_v_dimmest, Py_LT); __Pyx_XGOTREF(__pyx_t_6); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 237, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 258, __pyx_L1_error)
+                  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 237, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
                   if (__pyx_t_8) {
 
-                    /* "fastrometry/cython_code/PSE.pyx":259
+                    /* "fastrometry/cython_code/PSE.pyx":238
  *                                 for p in range(nrefinepts):
  *                                     if pse_metadata_view[p,2] < dimmest:
  *                                         dimmest = pse_metadata_view[p,2]             # <<<<<<<<<<<<<<
  *                                         dimmest_ind = p
  *                                 if cntdresults_view[2] > dimmest:
  */
                     __pyx_t_18 = __pyx_v_p;
@@ -6896,386 +6318,386 @@
                     } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_21 = 0;
                     if (__pyx_t_16 < 0) {
                       __pyx_t_16 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_16 < 0)) __pyx_t_21 = 1;
                     } else if (unlikely(__pyx_t_16 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_21 = 1;
                     if (unlikely(__pyx_t_21 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_21);
-                      __PYX_ERR(0, 259, __pyx_L1_error)
+                      __PYX_ERR(0, 238, __pyx_L1_error)
                     }
-                    __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 259, __pyx_L1_error)
+                    __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 238, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_6);
                     __Pyx_DECREF_SET(__pyx_v_dimmest, __pyx_t_6);
                     __pyx_t_6 = 0;
 
-                    /* "fastrometry/cython_code/PSE.pyx":260
+                    /* "fastrometry/cython_code/PSE.pyx":239
  *                                     if pse_metadata_view[p,2] < dimmest:
  *                                         dimmest = pse_metadata_view[p,2]
  *                                         dimmest_ind = p             # <<<<<<<<<<<<<<
  *                                 if cntdresults_view[2] > dimmest:
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid
  */
                     __pyx_v_dimmest_ind = __pyx_v_p;
 
-                    /* "fastrometry/cython_code/PSE.pyx":258
+                    /* "fastrometry/cython_code/PSE.pyx":237
  *                                 dimmest = np.inf
  *                                 for p in range(nrefinepts):
  *                                     if pse_metadata_view[p,2] < dimmest:             # <<<<<<<<<<<<<<
  *                                         dimmest = pse_metadata_view[p,2]
  *                                         dimmest_ind = p
  */
                   }
                 }
 
-                /* "fastrometry/cython_code/PSE.pyx":261
+                /* "fastrometry/cython_code/PSE.pyx":240
  *                                         dimmest = pse_metadata_view[p,2]
  *                                         dimmest_ind = p
  *                                 if cntdresults_view[2] > dimmest:             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid
  */
                 __pyx_t_16 = 2;
                 __pyx_t_17 = -1;
                 if (__pyx_t_16 < 0) {
                   __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                   if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                 } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                 if (unlikely(__pyx_t_17 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                  __PYX_ERR(0, 261, __pyx_L1_error)
+                  __PYX_ERR(0, 240, __pyx_L1_error)
                 }
-                __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
+                __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 240, __pyx_L1_error)
                 __Pyx_GOTREF(__pyx_t_6);
-                __pyx_t_4 = PyObject_RichCompare(__pyx_t_6, __pyx_v_dimmest, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)
+                __pyx_t_4 = PyObject_RichCompare(__pyx_t_6, __pyx_v_dimmest, Py_GT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 261, __pyx_L1_error)
+                __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 240, __pyx_L1_error)
                 __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                 if (__pyx_t_8) {
 
-                  /* "fastrometry/cython_code/PSE.pyx":262
+                  /* "fastrometry/cython_code/PSE.pyx":241
  *                                         dimmest_ind = p
  *                                 if cntdresults_view[2] > dimmest:
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid
  *                                     pse_metadata_view[dimmest_ind,2] = cntdresults_view[2]  #rectangular kernel sum
  */
                   __pyx_t_16 = 0;
                   __pyx_t_17 = -1;
                   if (__pyx_t_16 < 0) {
                     __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                     if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 262, __pyx_L1_error)
+                    __PYX_ERR(0, 241, __pyx_L1_error)
                   }
                   __pyx_t_18 = __pyx_v_dimmest_ind;
                   __pyx_t_15 = 0;
                   __pyx_t_17 = -1;
                   if (__pyx_t_18 < 0) {
                     __pyx_t_18 += __pyx_v_pse_metadata_view.shape[0];
                     if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                   if (__pyx_t_15 < 0) {
                     __pyx_t_15 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 1;
                   } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 262, __pyx_L1_error)
+                    __PYX_ERR(0, 241, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                  /* "fastrometry/cython_code/PSE.pyx":263
+                  /* "fastrometry/cython_code/PSE.pyx":242
  *                                 if cntdresults_view[2] > dimmest:
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[dimmest_ind,2] = cntdresults_view[2]  #rectangular kernel sum
  *                             curr_src_ind += 1
  */
                   __pyx_t_16 = 1;
                   __pyx_t_17 = -1;
                   if (__pyx_t_16 < 0) {
                     __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                     if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 263, __pyx_L1_error)
+                    __PYX_ERR(0, 242, __pyx_L1_error)
                   }
                   __pyx_t_15 = __pyx_v_dimmest_ind;
                   __pyx_t_18 = 1;
                   __pyx_t_17 = -1;
                   if (__pyx_t_15 < 0) {
                     __pyx_t_15 += __pyx_v_pse_metadata_view.shape[0];
                     if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                   if (__pyx_t_18 < 0) {
                     __pyx_t_18 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 1;
                   } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 263, __pyx_L1_error)
+                    __PYX_ERR(0, 242, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                  /* "fastrometry/cython_code/PSE.pyx":264
+                  /* "fastrometry/cython_code/PSE.pyx":243
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid
  *                                     pse_metadata_view[dimmest_ind,2] = cntdresults_view[2]  #rectangular kernel sum             # <<<<<<<<<<<<<<
  *                             curr_src_ind += 1
  * 
  */
                   __pyx_t_16 = 2;
                   __pyx_t_17 = -1;
                   if (__pyx_t_16 < 0) {
                     __pyx_t_16 += __pyx_v_cntdresults_view.shape[0];
                     if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_16 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_17 = 0;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 264, __pyx_L1_error)
+                    __PYX_ERR(0, 243, __pyx_L1_error)
                   }
                   __pyx_t_18 = __pyx_v_dimmest_ind;
                   __pyx_t_15 = 2;
                   __pyx_t_17 = -1;
                   if (__pyx_t_18 < 0) {
                     __pyx_t_18 += __pyx_v_pse_metadata_view.shape[0];
                     if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 0;
                   } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_17 = 0;
                   if (__pyx_t_15 < 0) {
                     __pyx_t_15 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_15 < 0)) __pyx_t_17 = 1;
                   } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_17 = 1;
                   if (unlikely(__pyx_t_17 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_17);
-                    __PYX_ERR(0, 264, __pyx_L1_error)
+                    __PYX_ERR(0, 243, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_16 * __pyx_v_cntdresults_view.strides[0]) )));
 
-                  /* "fastrometry/cython_code/PSE.pyx":261
+                  /* "fastrometry/cython_code/PSE.pyx":240
  *                                         dimmest = pse_metadata_view[p,2]
  *                                         dimmest_ind = p
  *                                 if cntdresults_view[2] > dimmest:             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[dimmest_ind,0] = cntdresults_view[0]  #x centroid
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid
  */
                 }
               }
               __pyx_L11:;
 
-              /* "fastrometry/cython_code/PSE.pyx":265
+              /* "fastrometry/cython_code/PSE.pyx":244
  *                                     pse_metadata_view[dimmest_ind,1] = cntdresults_view[1]  #y centroid
  *                                     pse_metadata_view[dimmest_ind,2] = cntdresults_view[2]  #rectangular kernel sum
  *                             curr_src_ind += 1             # <<<<<<<<<<<<<<
  * 
  *         if debug:
  */
               __pyx_v_curr_src_ind = (__pyx_v_curr_src_ind + 1);
 
-              /* "fastrometry/cython_code/PSE.pyx":244
+              /* "fastrometry/cython_code/PSE.pyx":223
  *                 if img_view[y-1,x-1] >= pixsat:
  *                     if roi_view[y-1,x-1] == 1:
  *                         if occupymap_view[y-1,x-1] == -1:             # <<<<<<<<<<<<<<
  *                             islandbnds_view[0] = x
  *                             islandbnds_view[1] = x
  */
             }
 
-            /* "fastrometry/cython_code/PSE.pyx":243
+            /* "fastrometry/cython_code/PSE.pyx":222
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):
  *                 if img_view[y-1,x-1] >= pixsat:
  *                     if roi_view[y-1,x-1] == 1:             # <<<<<<<<<<<<<<
  *                         if occupymap_view[y-1,x-1] == -1:
  *                             islandbnds_view[0] = x
  */
           }
 
-          /* "fastrometry/cython_code/PSE.pyx":242
+          /* "fastrometry/cython_code/PSE.pyx":221
  *         for x in range(leftmostsafe_x,rightmostsafe_x+1):
  *             for y in range(topmostsafe_y,bottommostsafe_y+1):
  *                 if img_view[y-1,x-1] >= pixsat:             # <<<<<<<<<<<<<<
  *                     if roi_view[y-1,x-1] == 1:
  *                         if occupymap_view[y-1,x-1] == -1:
  */
         }
       }
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":267
+    /* "fastrometry/cython_code/PSE.pyx":246
  *                             curr_src_ind += 1
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_islandsonly.csv", pse_metadata, delimiter=",")
  * 
  */
     __pyx_t_8 = (__pyx_v_debug != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":268
+      /* "fastrometry/cython_code/PSE.pyx":247
  * 
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_islandsonly.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_islandsonly_csv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_islandsonly_csv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
       __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
       PyTuple_SET_ITEM(__pyx_t_2, 1, ((PyObject *)__pyx_v_pse_metadata));
       __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 268, __pyx_L1_error)
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 268, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 247, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":267
+      /* "fastrometry/cython_code/PSE.pyx":246
  *                             curr_src_ind += 1
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_islandsonly.csv", pse_metadata, delimiter=",")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":270
+    /* "fastrometry/cython_code/PSE.pyx":249
  *             np.savetxt(debug_report/"pse_metadata_islandsonly.csv", pse_metadata, delimiter=",")
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]             # <<<<<<<<<<<<<<
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 270, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argsort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 270, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argsort); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 270, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_slice__12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_slice__8); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 249, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_pse_metadata_sorted = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":271
+    /* "fastrometry/cython_code/PSE.pyx":250
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]
  *         pse_metadata[:] = pse_metadata_sorted             # <<<<<<<<<<<<<<
  * 
  *         if debug:
  */
-    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__10, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 271, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__6, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 250, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":273
+    /* "fastrometry/cython_code/PSE.pyx":252
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_islandsonly_sorted.csv", pse_metadata, delimiter=",")
  * 
  */
     __pyx_t_8 = (__pyx_v_debug != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":274
+      /* "fastrometry/cython_code/PSE.pyx":253
  * 
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_islandsonly_sorted.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *         if curr_src_ind < nrefinepts:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_islandsonly_sorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_islandsonly_sorted); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 274, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
       __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
       PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_pse_metadata));
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 274, __pyx_L1_error)
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 274, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 253, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 253, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":273
+      /* "fastrometry/cython_code/PSE.pyx":252
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_islandsonly_sorted.csv", pse_metadata, delimiter=",")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":276
+    /* "fastrometry/cython_code/PSE.pyx":255
  *             np.savetxt(debug_report/"pse_metadata_islandsonly_sorted.csv", pse_metadata, delimiter=",")
  * 
  *         if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *             for g in range(curr_src_ind):
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  */
     __pyx_t_8 = ((__pyx_v_curr_src_ind < __pyx_v_nrefinepts) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":277
+      /* "fastrometry/cython_code/PSE.pyx":256
  * 
  *         if curr_src_ind < nrefinepts:
  *             for g in range(curr_src_ind):             # <<<<<<<<<<<<<<
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  *         if curr_src_ind >= nrefinepts:
  */
       __pyx_t_17 = __pyx_v_curr_src_ind;
       __pyx_t_19 = __pyx_t_17;
       for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_19; __pyx_t_11+=1) {
         __pyx_v_g = __pyx_t_11;
 
-        /* "fastrometry/cython_code/PSE.pyx":278
+        /* "fastrometry/cython_code/PSE.pyx":257
  *         if curr_src_ind < nrefinepts:
  *             for g in range(curr_src_ind):
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments             # <<<<<<<<<<<<<<
  *         if curr_src_ind >= nrefinepts:
  *             for g in range(nrefinepts):
  */
         __pyx_t_16 = __pyx_v_g;
@@ -7287,78 +6709,78 @@
         } else if (unlikely(__pyx_t_16 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_21 = 0;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_pse_metadata_view.shape[1];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_21 = 1;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_21 = 1;
         if (unlikely(__pyx_t_21 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_21);
-          __PYX_ERR(0, 278, __pyx_L1_error)
+          __PYX_ERR(0, 257, __pyx_L1_error)
         }
         __pyx_t_18 = __pyx_v_g;
         __pyx_t_22 = 1;
         __pyx_t_21 = -1;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_pse_metadata_view.shape[0];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_21 = 0;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_21 = 0;
         if (__pyx_t_22 < 0) {
           __pyx_t_22 += __pyx_v_pse_metadata_view.shape[1];
           if (unlikely(__pyx_t_22 < 0)) __pyx_t_21 = 1;
         } else if (unlikely(__pyx_t_22 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_21 = 1;
         if (unlikely(__pyx_t_21 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_21);
-          __PYX_ERR(0, 278, __pyx_L1_error)
+          __PYX_ERR(0, 257, __pyx_L1_error)
         }
-        __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[1]) )))), ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_22 * __pyx_v_pse_metadata_view.strides[1]) )))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_occupymap_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
+        __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_16 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_pse_metadata_view.strides[1]) )))), ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_18 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_22 * __pyx_v_pse_metadata_view.strides[1]) )))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_occupymap_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 257, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":276
+      /* "fastrometry/cython_code/PSE.pyx":255
  *             np.savetxt(debug_report/"pse_metadata_islandsonly_sorted.csv", pse_metadata, delimiter=",")
  * 
  *         if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *             for g in range(curr_src_ind):
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":279
+    /* "fastrometry/cython_code/PSE.pyx":258
  *             for g in range(curr_src_ind):
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  *         if curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *             for g in range(nrefinepts):
  *                 if g < npts:
  */
     __pyx_t_8 = ((__pyx_v_curr_src_ind >= __pyx_v_nrefinepts) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":280
+      /* "fastrometry/cython_code/PSE.pyx":259
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  *         if curr_src_ind >= nrefinepts:
  *             for g in range(nrefinepts):             # <<<<<<<<<<<<<<
  *                 if g < npts:
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_initial_view)
  */
       __pyx_t_17 = __pyx_v_nrefinepts;
       __pyx_t_19 = __pyx_t_17;
       for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_19; __pyx_t_11+=1) {
         __pyx_v_g = __pyx_t_11;
 
-        /* "fastrometry/cython_code/PSE.pyx":281
+        /* "fastrometry/cython_code/PSE.pyx":260
  *         if curr_src_ind >= nrefinepts:
  *             for g in range(nrefinepts):
  *                 if g < npts:             # <<<<<<<<<<<<<<
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_initial_view)
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  */
         __pyx_t_8 = ((__pyx_v_g < __pyx_v_npts) != 0);
         if (__pyx_t_8) {
 
-          /* "fastrometry/cython_code/PSE.pyx":282
+          /* "fastrometry/cython_code/PSE.pyx":261
  *             for g in range(nrefinepts):
  *                 if g < npts:
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_initial_view)             # <<<<<<<<<<<<<<
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  *                 else:
  */
           __pyx_t_22 = __pyx_v_g;
@@ -7370,36 +6792,36 @@
           } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 282, __pyx_L1_error)
+            __PYX_ERR(0, 261, __pyx_L1_error)
           }
           __pyx_t_15 = __pyx_v_g;
           __pyx_t_16 = 1;
           __pyx_t_21 = -1;
           if (__pyx_t_15 < 0) {
             __pyx_t_15 += __pyx_pybuffernd_pse_metadata.diminfo[0].shape;
             if (unlikely(__pyx_t_15 < 0)) __pyx_t_21 = 0;
           } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_16 < 0) {
             __pyx_t_16 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_16 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 282, __pyx_L1_error)
+            __PYX_ERR(0, 261, __pyx_L1_error)
           }
-          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_initial_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 282, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_initial_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 261, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-          /* "fastrometry/cython_code/PSE.pyx":283
+          /* "fastrometry/cython_code/PSE.pyx":262
  *                 if g < npts:
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_initial_view)
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)             # <<<<<<<<<<<<<<
  *                 else:
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  */
           __pyx_t_16 = __pyx_v_g;
@@ -7411,46 +6833,46 @@
           } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_15 < 0) {
             __pyx_t_15 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_15 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 283, __pyx_L1_error)
+            __PYX_ERR(0, 262, __pyx_L1_error)
           }
           __pyx_t_18 = __pyx_v_g;
           __pyx_t_22 = 1;
           __pyx_t_21 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_pybuffernd_pse_metadata.diminfo[0].shape;
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_21 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_22 < 0) {
             __pyx_t_22 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_22 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 283, __pyx_L1_error)
+            __PYX_ERR(0, 262, __pyx_L1_error)
           }
-          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-          /* "fastrometry/cython_code/PSE.pyx":281
+          /* "fastrometry/cython_code/PSE.pyx":260
  *         if curr_src_ind >= nrefinepts:
  *             for g in range(nrefinepts):
  *                 if g < npts:             # <<<<<<<<<<<<<<
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_initial_view)
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  */
           goto __pyx_L24;
         }
 
-        /* "fastrometry/cython_code/PSE.pyx":285
+        /* "fastrometry/cython_code/PSE.pyx":264
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  *                 else:
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)             # <<<<<<<<<<<<<<
  * 
  *         return curr_src_ind
  */
         /*else*/ {
@@ -7463,59 +6885,59 @@
           } else if (unlikely(__pyx_t_22 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 285, __pyx_L1_error)
+            __PYX_ERR(0, 264, __pyx_L1_error)
           }
           __pyx_t_15 = __pyx_v_g;
           __pyx_t_16 = 1;
           __pyx_t_21 = -1;
           if (__pyx_t_15 < 0) {
             __pyx_t_15 += __pyx_pybuffernd_pse_metadata.diminfo[0].shape;
             if (unlikely(__pyx_t_15 < 0)) __pyx_t_21 = 0;
           } else if (unlikely(__pyx_t_15 >= __pyx_pybuffernd_pse_metadata.diminfo[0].shape)) __pyx_t_21 = 0;
           if (__pyx_t_16 < 0) {
             __pyx_t_16 += __pyx_pybuffernd_pse_metadata.diminfo[1].shape;
             if (unlikely(__pyx_t_16 < 0)) __pyx_t_21 = 1;
           } else if (unlikely(__pyx_t_16 >= __pyx_pybuffernd_pse_metadata.diminfo[1].shape)) __pyx_t_21 = 1;
           if (unlikely(__pyx_t_21 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_21);
-            __PYX_ERR(0, 285, __pyx_L1_error)
+            __PYX_ERR(0, 264, __pyx_L1_error)
           }
-          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 285, __pyx_L1_error)
+          __pyx_t_6 = __pyx_f_11fastrometry_11cython_code_3PSE_doQuickerRecursiveWalk(((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_22, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), ((Py_ssize_t)(*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_double_t *, __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_pse_metadata.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_pse_metadata.diminfo[1].strides))), __pyx_v_g, __pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 264, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         }
         __pyx_L24:;
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":279
+      /* "fastrometry/cython_code/PSE.pyx":258
  *             for g in range(curr_src_ind):
  *                 doQuickerRecursiveWalk(int(pse_metadata_view[g,0]), int(pse_metadata_view[g,1]), g, occupymap_view, occupymap_view)     #the second occupymap_view is just to satisfy the function arguments
  *         if curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *             for g in range(nrefinepts):
  *                 if g < npts:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":287
+    /* "fastrometry/cython_code/PSE.pyx":266
  *                     doQuickerRecursiveWalk(int(pse_metadata[g,0]), int(pse_metadata[g,1]), g, occupymap_view, srcindexmap_refine_view)
  * 
  *         return curr_src_ind             # <<<<<<<<<<<<<<
  * 
  * cdef int getCircleSize(int rad):
  */
     __pyx_r = __pyx_v_curr_src_ind;
     goto __pyx_L0;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":226
+  /* "fastrometry/cython_code/PSE.pyx":205
  *                 doRecursiveWalk(surr_x, surr_y, img_view, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, pixsat, islandbnds_view, occupymap_view, curr_src_ind)
  * 
  * cdef int mapSaturationIslands(double[:,:] img_view, int img_xmax, int img_ymax, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int[:,:] roi_view, np.ndarray[ndim=2,dtype=np.double_t] pse_metadata, int[:,:] occupymap_view, int[:,:] srcindexmap_initial_view, int[:,:] srcindexmap_refine_view, int sourcesep, double pixsat, int npts, int nrefinepts, int curr_src_ind, debug_report, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -7545,15 +6967,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_cntdresults_view, 1);
   __Pyx_XDECREF(__pyx_v_dimmest);
   __Pyx_XDECREF(__pyx_v_pse_metadata_sorted);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":289
+/* "fastrometry/cython_code/PSE.pyx":268
  *         return curr_src_ind
  * 
  * cdef int getCircleSize(int rad):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int circlepts
  */
 
@@ -7575,27 +6997,27 @@
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("getCircleSize", 0);
   __pyx_pybuffer_encasedpixelnos.pybuffer.buf = NULL;
   __pyx_pybuffer_encasedpixelnos.refcount = 0;
   __pyx_pybuffernd_encasedpixelnos.data = NULL;
   __pyx_pybuffernd_encasedpixelnos.rcbuffer = &__pyx_pybuffer_encasedpixelnos;
 
-  /* "fastrometry/cython_code/PSE.pyx":295
+  /* "fastrometry/cython_code/PSE.pyx":274
  *         ### The integers in the following array each represent the number of pixels encased by a circle whose radius is equal to the index plus one.
  *         ### (see https://en.wikipedia.org/wiki/Gauss_circle_problem)
  *         np.ndarray[dtype=int,ndim=1] encasedpixelnos = np.array([5,13,29,49,81,113,149,197,253,317,377,441,529,613,709,797,901,1009,1129,1257,1373,1517,1653,1793,1961,2121,2289,2453,2629,2821,3001,3209,3409,3625,3853,4053,4293,4513,4777,5025,5261,5525,5789,6077,6361])             # <<<<<<<<<<<<<<
  * 
  *     return encasedpixelnos[rad-1]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyList_New(45); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
+  __pyx_t_2 = PyList_New(45); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_int_5);
   __Pyx_GIVEREF(__pyx_int_5);
   PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_5);
   __Pyx_INCREF(__pyx_int_13);
   __Pyx_GIVEREF(__pyx_int_13);
   PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_13);
@@ -7737,52 +7159,52 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 295, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 274, __pyx_L1_error)
   __pyx_t_5 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer, (PyObject*)__pyx_t_5, &__Pyx_TypeInfo_int, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_encasedpixelnos = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 295, __pyx_L1_error)
+      __PYX_ERR(0, 274, __pyx_L1_error)
     } else {__pyx_pybuffernd_encasedpixelnos.diminfo[0].strides = __pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_encasedpixelnos.diminfo[0].shape = __pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_5 = 0;
   __pyx_v_encasedpixelnos = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":297
+  /* "fastrometry/cython_code/PSE.pyx":276
  *         np.ndarray[dtype=int,ndim=1] encasedpixelnos = np.array([5,13,29,49,81,113,149,197,253,317,377,441,529,613,709,797,901,1009,1129,1257,1373,1517,1653,1793,1961,2121,2289,2453,2629,2821,3001,3209,3409,3625,3853,4053,4293,4513,4777,5025,5261,5525,5789,6077,6361])
  * 
  *     return encasedpixelnos[rad-1]             # <<<<<<<<<<<<<<
  * 
  * cdef makePixelCircle(int rad, int[:,:] pixcircle):
  */
   __pyx_t_6 = (__pyx_v_rad - 1);
   __pyx_t_7 = -1;
   if (__pyx_t_6 < 0) {
     __pyx_t_6 += __pyx_pybuffernd_encasedpixelnos.diminfo[0].shape;
     if (unlikely(__pyx_t_6 < 0)) __pyx_t_7 = 0;
   } else if (unlikely(__pyx_t_6 >= __pyx_pybuffernd_encasedpixelnos.diminfo[0].shape)) __pyx_t_7 = 0;
   if (unlikely(__pyx_t_7 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_7);
-    __PYX_ERR(0, 297, __pyx_L1_error)
+    __PYX_ERR(0, 276, __pyx_L1_error)
   }
   __pyx_r = (*__Pyx_BufPtrStrided1d(int *, __pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_encasedpixelnos.diminfo[0].strides));
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/PSE.pyx":289
+  /* "fastrometry/cython_code/PSE.pyx":268
  *         return curr_src_ind
  * 
  * cdef int getCircleSize(int rad):             # <<<<<<<<<<<<<<
  *     cdef:
  *         int circlepts
  */
 
@@ -7805,15 +7227,15 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_encasedpixelnos.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_XDECREF((PyObject *)__pyx_v_encasedpixelnos);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":299
+/* "fastrometry/cython_code/PSE.pyx":278
  *     return encasedpixelnos[rad-1]
  * 
  * cdef makePixelCircle(int rad, int[:,:] pixcircle):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -7835,67 +7257,67 @@
   Py_ssize_t __pyx_t_9;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("makePixelCircle", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":303
+  /* "fastrometry/cython_code/PSE.pyx":282
  *         Py_ssize_t x
  *         Py_ssize_t y
  *         Py_ssize_t a = 0             # <<<<<<<<<<<<<<
  *         Py_ssize_t b = 0
  * 
  */
   __pyx_v_a = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":304
+  /* "fastrometry/cython_code/PSE.pyx":283
  *         Py_ssize_t y
  *         Py_ssize_t a = 0
  *         Py_ssize_t b = 0             # <<<<<<<<<<<<<<
  * 
  *     for x in range(-rad,rad+1):
  */
   __pyx_v_b = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":306
+  /* "fastrometry/cython_code/PSE.pyx":285
  *         Py_ssize_t b = 0
  * 
  *     for x in range(-rad,rad+1):             # <<<<<<<<<<<<<<
  *         for y in range(-rad,rad+1):
  *             if x*x+y*y <= rad*rad:
  */
   __pyx_t_1 = (__pyx_v_rad + 1);
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = (-__pyx_v_rad); __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_x = __pyx_t_3;
 
-    /* "fastrometry/cython_code/PSE.pyx":307
+    /* "fastrometry/cython_code/PSE.pyx":286
  * 
  *     for x in range(-rad,rad+1):
  *         for y in range(-rad,rad+1):             # <<<<<<<<<<<<<<
  *             if x*x+y*y <= rad*rad:
  *                 pixcircle[a,0] = x
  */
     __pyx_t_4 = (__pyx_v_rad + 1);
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = (-__pyx_v_rad); __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_y = __pyx_t_6;
 
-      /* "fastrometry/cython_code/PSE.pyx":308
+      /* "fastrometry/cython_code/PSE.pyx":287
  *     for x in range(-rad,rad+1):
  *         for y in range(-rad,rad+1):
  *             if x*x+y*y <= rad*rad:             # <<<<<<<<<<<<<<
  *                 pixcircle[a,0] = x
  *                 pixcircle[a,1] = y
  */
       __pyx_t_7 = ((((__pyx_v_x * __pyx_v_x) + (__pyx_v_y * __pyx_v_y)) <= (__pyx_v_rad * __pyx_v_rad)) != 0);
       if (__pyx_t_7) {
 
-        /* "fastrometry/cython_code/PSE.pyx":309
+        /* "fastrometry/cython_code/PSE.pyx":288
  *         for y in range(-rad,rad+1):
  *             if x*x+y*y <= rad*rad:
  *                 pixcircle[a,0] = x             # <<<<<<<<<<<<<<
  *                 pixcircle[a,1] = y
  *                 a += 1
  */
         __pyx_t_8 = __pyx_v_a;
@@ -7907,19 +7329,19 @@
         } else if (unlikely(__pyx_t_8 >= __pyx_v_pixcircle.shape[0])) __pyx_t_10 = 0;
         if (__pyx_t_9 < 0) {
           __pyx_t_9 += __pyx_v_pixcircle.shape[1];
           if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 1;
         } else if (unlikely(__pyx_t_9 >= __pyx_v_pixcircle.shape[1])) __pyx_t_10 = 1;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          __PYX_ERR(0, 309, __pyx_L1_error)
+          __PYX_ERR(0, 288, __pyx_L1_error)
         }
         *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pixcircle.data + __pyx_t_8 * __pyx_v_pixcircle.strides[0]) ) + __pyx_t_9 * __pyx_v_pixcircle.strides[1]) )) = __pyx_v_x;
 
-        /* "fastrometry/cython_code/PSE.pyx":310
+        /* "fastrometry/cython_code/PSE.pyx":289
  *             if x*x+y*y <= rad*rad:
  *                 pixcircle[a,0] = x
  *                 pixcircle[a,1] = y             # <<<<<<<<<<<<<<
  *                 a += 1
  * 
  */
         __pyx_t_9 = __pyx_v_a;
@@ -7931,39 +7353,39 @@
         } else if (unlikely(__pyx_t_9 >= __pyx_v_pixcircle.shape[0])) __pyx_t_10 = 0;
         if (__pyx_t_8 < 0) {
           __pyx_t_8 += __pyx_v_pixcircle.shape[1];
           if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 1;
         } else if (unlikely(__pyx_t_8 >= __pyx_v_pixcircle.shape[1])) __pyx_t_10 = 1;
         if (unlikely(__pyx_t_10 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_10);
-          __PYX_ERR(0, 310, __pyx_L1_error)
+          __PYX_ERR(0, 289, __pyx_L1_error)
         }
         *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pixcircle.data + __pyx_t_9 * __pyx_v_pixcircle.strides[0]) ) + __pyx_t_8 * __pyx_v_pixcircle.strides[1]) )) = __pyx_v_y;
 
-        /* "fastrometry/cython_code/PSE.pyx":311
+        /* "fastrometry/cython_code/PSE.pyx":290
  *                 pixcircle[a,0] = x
  *                 pixcircle[a,1] = y
  *                 a += 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_v_a = (__pyx_v_a + 1);
 
-        /* "fastrometry/cython_code/PSE.pyx":308
+        /* "fastrometry/cython_code/PSE.pyx":287
  *     for x in range(-rad,rad+1):
  *         for y in range(-rad,rad+1):
  *             if x*x+y*y <= rad*rad:             # <<<<<<<<<<<<<<
  *                 pixcircle[a,0] = x
  *                 pixcircle[a,1] = y
  */
       }
     }
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":299
+  /* "fastrometry/cython_code/PSE.pyx":278
  *     return encasedpixelnos[rad-1]
  * 
  * cdef makePixelCircle(int rad, int[:,:] pixcircle):             # <<<<<<<<<<<<<<
  *     cdef:
  *         Py_ssize_t x
  */
 
@@ -7975,15 +7397,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":314
+/* "fastrometry/cython_code/PSE.pyx":293
  * 
  * 
  * cdef int mapRemainingSources(double[:,:] img_view, int img_xmax, int img_ymax, double img_max, double img_median, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int[:,:] roi_view, np.ndarray[ndim=2,dtype=np.double_t] pse_metadata, double[:,:] bgmap_view, int[:,:] srcindexmap_initial_view, int[:,:] srcindexmap_refine_view, int[:,:] occupymap_view, int kernelrad, int[:,:] kernelcircle_view, int kernelsize, int sourcesep, int[:,:] sourcesepcircle_view, int sourcesepsize, int npts, int nrefinepts, int curr_src_ind, debug_report, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -8064,185 +7486,185 @@
   __Pyx_RefNannySetupContext("mapRemainingSources", 0);
   __pyx_pybuffer_pse_metadata.pybuffer.buf = NULL;
   __pyx_pybuffer_pse_metadata.refcount = 0;
   __pyx_pybuffernd_pse_metadata.data = NULL;
   __pyx_pybuffernd_pse_metadata.rcbuffer = &__pyx_pybuffer_pse_metadata;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer, (PyObject*)__pyx_v_pse_metadata, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer, (PyObject*)__pyx_v_pse_metadata, &__Pyx_TypeInfo_nn___pyx_t_5numpy_double_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 293, __pyx_L1_error)
   }
   __pyx_pybuffernd_pse_metadata.diminfo[0].strides = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pse_metadata.diminfo[0].shape = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_pse_metadata.diminfo[1].strides = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_pse_metadata.diminfo[1].shape = __pyx_pybuffernd_pse_metadata.rcbuffer->pybuffer.shape[1];
 
-  /* "fastrometry/cython_code/PSE.pyx":317
+  /* "fastrometry/cython_code/PSE.pyx":296
  * 
  *     cdef:
  *         int num_islands = curr_src_ind     ###The curr_src_ind reflects the amount of sources found so far, or equivalently the index of the next source             # <<<<<<<<<<<<<<
  *                                         ###to be put in pse_metadata (since pse_metadata is 0-based like all numpy arrays). So num_islands is a number
  *                                         ###representing the next index to be filled after all the saturation islands have been put in pse_metadata.
  */
   __pyx_v_num_islands = __pyx_v_curr_src_ind;
 
-  /* "fastrometry/cython_code/PSE.pyx":338
+  /* "fastrometry/cython_code/PSE.pyx":317
  *         Py_ssize_t prevx
  *         Py_ssize_t prevy
  *         int div_factor = 8             # <<<<<<<<<<<<<<
  *         double pixelthresh = (img_max-img_median)/div_factor + img_median
  *         int max_iters = 20
  */
   __pyx_v_div_factor = 8;
 
-  /* "fastrometry/cython_code/PSE.pyx":339
+  /* "fastrometry/cython_code/PSE.pyx":318
  *         Py_ssize_t prevy
  *         int div_factor = 8
  *         double pixelthresh = (img_max-img_median)/div_factor + img_median             # <<<<<<<<<<<<<<
  *         int max_iters = 20
  *         double centerbg
  */
   __pyx_t_1 = (__pyx_v_img_max - __pyx_v_img_median);
   if (unlikely(__pyx_v_div_factor == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 339, __pyx_L1_error)
+    __PYX_ERR(0, 318, __pyx_L1_error)
   }
   __pyx_v_pixelthresh = ((__pyx_t_1 / __pyx_v_div_factor) + __pyx_v_img_median);
 
-  /* "fastrometry/cython_code/PSE.pyx":340
+  /* "fastrometry/cython_code/PSE.pyx":319
  *         int div_factor = 8
  *         double pixelthresh = (img_max-img_median)/div_factor + img_median
  *         int max_iters = 20             # <<<<<<<<<<<<<<
  *         double centerbg
  *         double kernelsum
  */
   __pyx_v_max_iters = 20;
 
-  /* "fastrometry/cython_code/PSE.pyx":347
+  /* "fastrometry/cython_code/PSE.pyx":326
  *         int num_psesources
  *         Py_ssize_t dimmest_ind
  *         double[:,:] pse_metadata_view = pse_metadata             # <<<<<<<<<<<<<<
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_pse_metadata), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 347, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(((PyObject *)__pyx_v_pse_metadata), PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 326, __pyx_L1_error)
   __pyx_v_pse_metadata_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":348
+  /* "fastrometry/cython_code/PSE.pyx":327
  *         Py_ssize_t dimmest_ind
  *         double[:,:] pse_metadata_view = pse_metadata
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     srcindexmap_initial_view[:] = occupymap_view[:]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 348, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__8, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 327, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_cntdresults_view = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":350
+  /* "fastrometry/cython_code/PSE.pyx":329
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  *     srcindexmap_initial_view[:] = occupymap_view[:]             # <<<<<<<<<<<<<<
  *     srcindexmap_refine_view[:] = occupymap_view[:]
  * 
  */
-  if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_occupymap_view, __pyx_v_srcindexmap_initial_view, 2, 2, 0) < 0)) __PYX_ERR(0, 350, __pyx_L1_error)
+  if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_occupymap_view, __pyx_v_srcindexmap_initial_view, 2, 2, 0) < 0)) __PYX_ERR(0, 329, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/PSE.pyx":351
+  /* "fastrometry/cython_code/PSE.pyx":330
  * 
  *     srcindexmap_initial_view[:] = occupymap_view[:]
  *     srcindexmap_refine_view[:] = occupymap_view[:]             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-  if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view, 2, 2, 0) < 0)) __PYX_ERR(0, 351, __pyx_L1_error)
+  if (unlikely(__pyx_memoryview_copy_contents(__pyx_v_occupymap_view, __pyx_v_srcindexmap_refine_view, 2, 2, 0) < 0)) __PYX_ERR(0, 330, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/PSE.pyx":353
+  /* "fastrometry/cython_code/PSE.pyx":332
  *     srcindexmap_refine_view[:] = occupymap_view[:]
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | Trying various pixel thresholds...")
  * 
  */
   __pyx_t_8 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_8) {
 
-    /* "fastrometry/cython_code/PSE.pyx":354
+    /* "fastrometry/cython_code/PSE.pyx":333
  * 
  *     if verbosity == 2:
  *         print("| | Trying various pixel thresholds...")             # <<<<<<<<<<<<<<
  * 
  *     for iter in range(max_iters):
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Trying_various_pixel_thresholds) < 0) __PYX_ERR(0, 354, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Trying_various_pixel_thresholds) < 0) __PYX_ERR(0, 333, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":353
+    /* "fastrometry/cython_code/PSE.pyx":332
  *     srcindexmap_refine_view[:] = occupymap_view[:]
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | Trying various pixel thresholds...")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":356
+  /* "fastrometry/cython_code/PSE.pyx":335
  *         print("| | Trying various pixel thresholds...")
  * 
  *     for iter in range(max_iters):             # <<<<<<<<<<<<<<
  *         for x in range(leftmostsafe_x, rightmostsafe_x+1):
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  */
   __pyx_t_9 = __pyx_v_max_iters;
   __pyx_t_10 = __pyx_t_9;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_iter = __pyx_t_11;
 
-    /* "fastrometry/cython_code/PSE.pyx":357
+    /* "fastrometry/cython_code/PSE.pyx":336
  * 
  *     for iter in range(max_iters):
  *         for x in range(leftmostsafe_x, rightmostsafe_x+1):             # <<<<<<<<<<<<<<
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  *                 if roi_view[y-1,x-1] == 1:
  */
     __pyx_t_12 = (__pyx_v_rightmostsafe_x + 1);
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = __pyx_v_leftmostsafe_x; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_x = __pyx_t_14;
 
-      /* "fastrometry/cython_code/PSE.pyx":358
+      /* "fastrometry/cython_code/PSE.pyx":337
  *     for iter in range(max_iters):
  *         for x in range(leftmostsafe_x, rightmostsafe_x+1):
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):             # <<<<<<<<<<<<<<
  *                 if roi_view[y-1,x-1] == 1:
  *                     if occupymap_view[y-1,x-1] == -1:
  */
       __pyx_t_15 = (__pyx_v_bottommostsafe_y + 1);
       __pyx_t_16 = __pyx_t_15;
       for (__pyx_t_17 = __pyx_v_topmostsafe_y; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
         __pyx_v_y = __pyx_t_17;
 
-        /* "fastrometry/cython_code/PSE.pyx":359
+        /* "fastrometry/cython_code/PSE.pyx":338
  *         for x in range(leftmostsafe_x, rightmostsafe_x+1):
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  *                 if roi_view[y-1,x-1] == 1:             # <<<<<<<<<<<<<<
  *                     if occupymap_view[y-1,x-1] == -1:
  *                         centerbg = bgmap_view[y-1,x-1]
  */
         __pyx_t_18 = (__pyx_v_y - 1);
@@ -8254,20 +7676,20 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_roi_view.shape[0])) __pyx_t_20 = 0;
         if (__pyx_t_19 < 0) {
           __pyx_t_19 += __pyx_v_roi_view.shape[1];
           if (unlikely(__pyx_t_19 < 0)) __pyx_t_20 = 1;
         } else if (unlikely(__pyx_t_19 >= __pyx_v_roi_view.shape[1])) __pyx_t_20 = 1;
         if (unlikely(__pyx_t_20 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_20);
-          __PYX_ERR(0, 359, __pyx_L1_error)
+          __PYX_ERR(0, 338, __pyx_L1_error)
         }
         __pyx_t_8 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_roi_view.data + __pyx_t_18 * __pyx_v_roi_view.strides[0]) ) + __pyx_t_19 * __pyx_v_roi_view.strides[1]) ))) == 1) != 0);
         if (__pyx_t_8) {
 
-          /* "fastrometry/cython_code/PSE.pyx":360
+          /* "fastrometry/cython_code/PSE.pyx":339
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  *                 if roi_view[y-1,x-1] == 1:
  *                     if occupymap_view[y-1,x-1] == -1:             # <<<<<<<<<<<<<<
  *                         centerbg = bgmap_view[y-1,x-1]
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:
  */
           __pyx_t_19 = (__pyx_v_y - 1);
@@ -8279,20 +7701,20 @@
           } else if (unlikely(__pyx_t_19 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_20 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_occupymap_view.shape[1];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_20 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_20 = 1;
           if (unlikely(__pyx_t_20 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_20);
-            __PYX_ERR(0, 360, __pyx_L1_error)
+            __PYX_ERR(0, 339, __pyx_L1_error)
           }
           __pyx_t_8 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_19 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_18 * __pyx_v_occupymap_view.strides[1]) ))) == -1L) != 0);
           if (__pyx_t_8) {
 
-            /* "fastrometry/cython_code/PSE.pyx":361
+            /* "fastrometry/cython_code/PSE.pyx":340
  *                 if roi_view[y-1,x-1] == 1:
  *                     if occupymap_view[y-1,x-1] == -1:
  *                         centerbg = bgmap_view[y-1,x-1]             # <<<<<<<<<<<<<<
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  */
             __pyx_t_18 = (__pyx_v_y - 1);
@@ -8304,19 +7726,19 @@
             } else if (unlikely(__pyx_t_18 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_20 = 0;
             if (__pyx_t_19 < 0) {
               __pyx_t_19 += __pyx_v_bgmap_view.shape[1];
               if (unlikely(__pyx_t_19 < 0)) __pyx_t_20 = 1;
             } else if (unlikely(__pyx_t_19 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_20 = 1;
             if (unlikely(__pyx_t_20 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_20);
-              __PYX_ERR(0, 361, __pyx_L1_error)
+              __PYX_ERR(0, 340, __pyx_L1_error)
             }
             __pyx_v_centerbg = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_18 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_19 * __pyx_v_bgmap_view.strides[1]) )));
 
-            /* "fastrometry/cython_code/PSE.pyx":362
+            /* "fastrometry/cython_code/PSE.pyx":341
  *                     if occupymap_view[y-1,x-1] == -1:
  *                         centerbg = bgmap_view[y-1,x-1]
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:             # <<<<<<<<<<<<<<
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  *                             for i in range(sourcesepsize):
  */
             __pyx_t_19 = (__pyx_v_y - 1);
@@ -8328,41 +7750,41 @@
             } else if (unlikely(__pyx_t_19 >= __pyx_v_img_view.shape[0])) __pyx_t_20 = 0;
             if (__pyx_t_18 < 0) {
               __pyx_t_18 += __pyx_v_img_view.shape[1];
               if (unlikely(__pyx_t_18 < 0)) __pyx_t_20 = 1;
             } else if (unlikely(__pyx_t_18 >= __pyx_v_img_view.shape[1])) __pyx_t_20 = 1;
             if (unlikely(__pyx_t_20 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_20);
-              __PYX_ERR(0, 362, __pyx_L1_error)
+              __PYX_ERR(0, 341, __pyx_L1_error)
             }
             __pyx_t_8 = ((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_19 * __pyx_v_img_view.strides[0]) ) + __pyx_t_18 * __pyx_v_img_view.strides[1]) ))) - __pyx_v_centerbg) > __pyx_v_pixelthresh) != 0);
             if (__pyx_t_8) {
 
-              /* "fastrometry/cython_code/PSE.pyx":363
+              /* "fastrometry/cython_code/PSE.pyx":342
  *                         centerbg = bgmap_view[y-1,x-1]
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels             # <<<<<<<<<<<<<<
  *                             for i in range(sourcesepsize):
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:
  */
               __pyx_v_localpeak = 1;
 
-              /* "fastrometry/cython_code/PSE.pyx":364
+              /* "fastrometry/cython_code/PSE.pyx":343
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  *                             for i in range(sourcesepsize):             # <<<<<<<<<<<<<<
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:
  *                                     localpeak = False
  */
               __pyx_t_20 = __pyx_v_sourcesepsize;
               __pyx_t_21 = __pyx_t_20;
               for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
                 __pyx_v_i = __pyx_t_22;
 
-                /* "fastrometry/cython_code/PSE.pyx":365
+                /* "fastrometry/cython_code/PSE.pyx":344
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  *                             for i in range(sourcesepsize):
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:             # <<<<<<<<<<<<<<
  *                                     localpeak = False
  *                                     break
  */
                 __pyx_t_18 = __pyx_v_i;
@@ -8374,116 +7796,116 @@
                 } else if (unlikely(__pyx_t_18 >= __pyx_v_sourcesepcircle_view.shape[0])) __pyx_t_23 = 0;
                 if (__pyx_t_19 < 0) {
                   __pyx_t_19 += __pyx_v_sourcesepcircle_view.shape[1];
                   if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
                 } else if (unlikely(__pyx_t_19 >= __pyx_v_sourcesepcircle_view.shape[1])) __pyx_t_23 = 1;
                 if (unlikely(__pyx_t_23 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                  __PYX_ERR(0, 365, __pyx_L1_error)
+                  __PYX_ERR(0, 344, __pyx_L1_error)
                 }
                 __pyx_t_24 = __pyx_v_i;
                 __pyx_t_25 = 0;
                 __pyx_t_23 = -1;
                 if (__pyx_t_24 < 0) {
                   __pyx_t_24 += __pyx_v_sourcesepcircle_view.shape[0];
                   if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
                 } else if (unlikely(__pyx_t_24 >= __pyx_v_sourcesepcircle_view.shape[0])) __pyx_t_23 = 0;
                 if (__pyx_t_25 < 0) {
                   __pyx_t_25 += __pyx_v_sourcesepcircle_view.shape[1];
                   if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
                 } else if (unlikely(__pyx_t_25 >= __pyx_v_sourcesepcircle_view.shape[1])) __pyx_t_23 = 1;
                 if (unlikely(__pyx_t_23 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                  __PYX_ERR(0, 365, __pyx_L1_error)
+                  __PYX_ERR(0, 344, __pyx_L1_error)
                 }
                 __pyx_t_26 = ((__pyx_v_y + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sourcesepcircle_view.data + __pyx_t_18 * __pyx_v_sourcesepcircle_view.strides[0]) ) + __pyx_t_19 * __pyx_v_sourcesepcircle_view.strides[1]) )))) - 1);
                 __pyx_t_27 = ((__pyx_v_x + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sourcesepcircle_view.data + __pyx_t_24 * __pyx_v_sourcesepcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_sourcesepcircle_view.strides[1]) )))) - 1);
                 __pyx_t_23 = -1;
                 if (__pyx_t_26 < 0) {
                   __pyx_t_26 += __pyx_v_img_view.shape[0];
                   if (unlikely(__pyx_t_26 < 0)) __pyx_t_23 = 0;
                 } else if (unlikely(__pyx_t_26 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
                 if (__pyx_t_27 < 0) {
                   __pyx_t_27 += __pyx_v_img_view.shape[1];
                   if (unlikely(__pyx_t_27 < 0)) __pyx_t_23 = 1;
                 } else if (unlikely(__pyx_t_27 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
                 if (unlikely(__pyx_t_23 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                  __PYX_ERR(0, 365, __pyx_L1_error)
+                  __PYX_ERR(0, 344, __pyx_L1_error)
                 }
                 __pyx_t_28 = (__pyx_v_y - 1);
                 __pyx_t_29 = (__pyx_v_x - 1);
                 __pyx_t_23 = -1;
                 if (__pyx_t_28 < 0) {
                   __pyx_t_28 += __pyx_v_img_view.shape[0];
                   if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 0;
                 } else if (unlikely(__pyx_t_28 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
                 if (__pyx_t_29 < 0) {
                   __pyx_t_29 += __pyx_v_img_view.shape[1];
                   if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
                 } else if (unlikely(__pyx_t_29 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
                 if (unlikely(__pyx_t_23 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                  __PYX_ERR(0, 365, __pyx_L1_error)
+                  __PYX_ERR(0, 344, __pyx_L1_error)
                 }
                 __pyx_t_8 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_26 * __pyx_v_img_view.strides[0]) ) + __pyx_t_27 * __pyx_v_img_view.strides[1]) ))) > (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_28 * __pyx_v_img_view.strides[0]) ) + __pyx_t_29 * __pyx_v_img_view.strides[1]) )))) != 0);
                 if (__pyx_t_8) {
 
-                  /* "fastrometry/cython_code/PSE.pyx":366
+                  /* "fastrometry/cython_code/PSE.pyx":345
  *                             for i in range(sourcesepsize):
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:
  *                                     localpeak = False             # <<<<<<<<<<<<<<
  *                                     break
  *                             if localpeak == True:
  */
                   __pyx_v_localpeak = 0;
 
-                  /* "fastrometry/cython_code/PSE.pyx":367
+                  /* "fastrometry/cython_code/PSE.pyx":346
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:
  *                                     localpeak = False
  *                                     break             # <<<<<<<<<<<<<<
  *                             if localpeak == True:
  *                                 for j in range(sourcesepsize):
  */
                   goto __pyx_L14_break;
 
-                  /* "fastrometry/cython_code/PSE.pyx":365
+                  /* "fastrometry/cython_code/PSE.pyx":344
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  *                             for i in range(sourcesepsize):
  *                                 if img_view[(y+sourcesepcircle_view[i,1])-1,(x+sourcesepcircle_view[i,0])-1] > img_view[y-1,x-1]:             # <<<<<<<<<<<<<<
  *                                     localpeak = False
  *                                     break
  */
                 }
               }
               __pyx_L14_break:;
 
-              /* "fastrometry/cython_code/PSE.pyx":368
+              /* "fastrometry/cython_code/PSE.pyx":347
  *                                     localpeak = False
  *                                     break
  *                             if localpeak == True:             # <<<<<<<<<<<<<<
  *                                 for j in range(sourcesepsize):
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2
  */
               __pyx_t_8 = ((__pyx_v_localpeak == 1) != 0);
               if (__pyx_t_8) {
 
-                /* "fastrometry/cython_code/PSE.pyx":369
+                /* "fastrometry/cython_code/PSE.pyx":348
  *                                     break
  *                             if localpeak == True:
  *                                 for j in range(sourcesepsize):             # <<<<<<<<<<<<<<
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2
  * 
  */
                 __pyx_t_20 = __pyx_v_sourcesepsize;
                 __pyx_t_21 = __pyx_t_20;
                 for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
                   __pyx_v_j = __pyx_t_22;
 
-                  /* "fastrometry/cython_code/PSE.pyx":370
+                  /* "fastrometry/cython_code/PSE.pyx":349
  *                             if localpeak == True:
  *                                 for j in range(sourcesepsize):
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2             # <<<<<<<<<<<<<<
  * 
  *                                 if curr_src_ind < nrefinepts-1:
  */
                   __pyx_t_29 = __pyx_v_j;
@@ -8495,60 +7917,60 @@
                   } else if (unlikely(__pyx_t_29 >= __pyx_v_sourcesepcircle_view.shape[0])) __pyx_t_23 = 0;
                   if (__pyx_t_28 < 0) {
                     __pyx_t_28 += __pyx_v_sourcesepcircle_view.shape[1];
                     if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
                   } else if (unlikely(__pyx_t_28 >= __pyx_v_sourcesepcircle_view.shape[1])) __pyx_t_23 = 1;
                   if (unlikely(__pyx_t_23 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                    __PYX_ERR(0, 370, __pyx_L1_error)
+                    __PYX_ERR(0, 349, __pyx_L1_error)
                   }
                   __pyx_t_25 = __pyx_v_j;
                   __pyx_t_24 = 0;
                   __pyx_t_23 = -1;
                   if (__pyx_t_25 < 0) {
                     __pyx_t_25 += __pyx_v_sourcesepcircle_view.shape[0];
                     if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 0;
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_sourcesepcircle_view.shape[0])) __pyx_t_23 = 0;
                   if (__pyx_t_24 < 0) {
                     __pyx_t_24 += __pyx_v_sourcesepcircle_view.shape[1];
                     if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_sourcesepcircle_view.shape[1])) __pyx_t_23 = 1;
                   if (unlikely(__pyx_t_23 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                    __PYX_ERR(0, 370, __pyx_L1_error)
+                    __PYX_ERR(0, 349, __pyx_L1_error)
                   }
                   __pyx_t_19 = ((__pyx_v_y + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sourcesepcircle_view.data + __pyx_t_29 * __pyx_v_sourcesepcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_sourcesepcircle_view.strides[1]) )))) - 1);
                   __pyx_t_18 = ((__pyx_v_x + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_sourcesepcircle_view.data + __pyx_t_25 * __pyx_v_sourcesepcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_sourcesepcircle_view.strides[1]) )))) - 1);
                   __pyx_t_23 = -1;
                   if (__pyx_t_19 < 0) {
                     __pyx_t_19 += __pyx_v_occupymap_view.shape[0];
                     if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
                   } else if (unlikely(__pyx_t_19 >= __pyx_v_occupymap_view.shape[0])) __pyx_t_23 = 0;
                   if (__pyx_t_18 < 0) {
                     __pyx_t_18 += __pyx_v_occupymap_view.shape[1];
                     if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
                   } else if (unlikely(__pyx_t_18 >= __pyx_v_occupymap_view.shape[1])) __pyx_t_23 = 1;
                   if (unlikely(__pyx_t_23 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                    __PYX_ERR(0, 370, __pyx_L1_error)
+                    __PYX_ERR(0, 349, __pyx_L1_error)
                   }
                   *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_occupymap_view.data + __pyx_t_19 * __pyx_v_occupymap_view.strides[0]) ) + __pyx_t_18 * __pyx_v_occupymap_view.strides[1]) )) = -2;
                 }
 
-                /* "fastrometry/cython_code/PSE.pyx":372
+                /* "fastrometry/cython_code/PSE.pyx":351
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2
  * 
  *                                 if curr_src_ind < nrefinepts-1:             # <<<<<<<<<<<<<<
  *                                     ###If the slot about to be filled in pse_metadata isn't nrefinepts-1 (the nrefinepts'th source), we can now go onto the
  *                                     ###next (x,y) and not perform unhelpful expensive calculations (aka, kernel integration and centroiding). These
  */
                 __pyx_t_8 = ((__pyx_v_curr_src_ind < (__pyx_v_nrefinepts - 1)) != 0);
                 if (__pyx_t_8) {
 
-                  /* "fastrometry/cython_code/PSE.pyx":379
+                  /* "fastrometry/cython_code/PSE.pyx":358
  *                                     ###a "good run", we will come back and do the calculations.
  * 
  *                                     pse_metadata_view[curr_src_ind,0] = x             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[curr_src_ind,1] = y
  *                                     pse_metadata_view[curr_src_ind,2] = 0
  */
                   __pyx_t_24 = __pyx_v_curr_src_ind;
@@ -8560,19 +7982,19 @@
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_25 < 0) {
                     __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 379, __pyx_L1_error)
+                    __PYX_ERR(0, 358, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_x;
 
-                  /* "fastrometry/cython_code/PSE.pyx":380
+                  /* "fastrometry/cython_code/PSE.pyx":359
  * 
  *                                     pse_metadata_view[curr_src_ind,0] = x
  *                                     pse_metadata_view[curr_src_ind,1] = y             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[curr_src_ind,2] = 0
  * 
  */
                   __pyx_t_25 = __pyx_v_curr_src_ind;
@@ -8584,19 +8006,19 @@
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_24 < 0) {
                     __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 380, __pyx_L1_error)
+                    __PYX_ERR(0, 359, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_y;
 
-                  /* "fastrometry/cython_code/PSE.pyx":381
+                  /* "fastrometry/cython_code/PSE.pyx":360
  *                                     pse_metadata_view[curr_src_ind,0] = x
  *                                     pse_metadata_view[curr_src_ind,1] = y
  *                                     pse_metadata_view[curr_src_ind,2] = 0             # <<<<<<<<<<<<<<
  * 
  *                                     curr_src_ind += 1
  */
                   __pyx_t_24 = __pyx_v_curr_src_ind;
@@ -8608,60 +8030,60 @@
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_25 < 0) {
                     __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 381, __pyx_L1_error)
+                    __PYX_ERR(0, 360, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) )) = 0.0;
 
-                  /* "fastrometry/cython_code/PSE.pyx":383
+                  /* "fastrometry/cython_code/PSE.pyx":362
  *                                     pse_metadata_view[curr_src_ind,2] = 0
  * 
  *                                     curr_src_ind += 1             # <<<<<<<<<<<<<<
  * 
  *                                 elif curr_src_ind == nrefinepts-1:
  */
                   __pyx_v_curr_src_ind = (__pyx_v_curr_src_ind + 1);
 
-                  /* "fastrometry/cython_code/PSE.pyx":372
+                  /* "fastrometry/cython_code/PSE.pyx":351
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2
  * 
  *                                 if curr_src_ind < nrefinepts-1:             # <<<<<<<<<<<<<<
  *                                     ###If the slot about to be filled in pse_metadata isn't nrefinepts-1 (the nrefinepts'th source), we can now go onto the
  *                                     ###next (x,y) and not perform unhelpful expensive calculations (aka, kernel integration and centroiding). These
  */
                   goto __pyx_L19;
                 }
 
-                /* "fastrometry/cython_code/PSE.pyx":385
+                /* "fastrometry/cython_code/PSE.pyx":364
  *                                     curr_src_ind += 1
  * 
  *                                 elif curr_src_ind == nrefinepts-1:             # <<<<<<<<<<<<<<
  *                                     ###If we got to this point, we know that this loop gives us at least nrefinepts sources. We go back (by accessing
  *                                     ###the pse_metadata) and perform kernel integration to get the brightnesses of all sources found so far.
  */
                 __pyx_t_8 = ((__pyx_v_curr_src_ind == (__pyx_v_nrefinepts - 1)) != 0);
                 if (__pyx_t_8) {
 
-                  /* "fastrometry/cython_code/PSE.pyx":389
+                  /* "fastrometry/cython_code/PSE.pyx":368
  *                                     ###the pse_metadata) and perform kernel integration to get the brightnesses of all sources found so far.
  * 
  *                                     for k in range(num_islands,nrefinepts-1):             # <<<<<<<<<<<<<<
  *                                         prevx = int(pse_metadata_view[k,0])
  *                                         prevy = int(pse_metadata_view[k,1])
  */
                   __pyx_t_30 = (__pyx_v_nrefinepts - 1);
                   __pyx_t_31 = __pyx_t_30;
                   for (__pyx_t_22 = __pyx_v_num_islands; __pyx_t_22 < __pyx_t_31; __pyx_t_22+=1) {
                     __pyx_v_k = __pyx_t_22;
 
-                    /* "fastrometry/cython_code/PSE.pyx":390
+                    /* "fastrometry/cython_code/PSE.pyx":369
  * 
  *                                     for k in range(num_islands,nrefinepts-1):
  *                                         prevx = int(pse_metadata_view[k,0])             # <<<<<<<<<<<<<<
  *                                         prevy = int(pse_metadata_view[k,1])
  *                                         kernelsum = 0
  */
                     __pyx_t_25 = __pyx_v_k;
@@ -8673,19 +8095,19 @@
                     } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_24 < 0) {
                       __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 390, __pyx_L1_error)
+                      __PYX_ERR(0, 369, __pyx_L1_error)
                     }
                     __pyx_v_prevx = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-                    /* "fastrometry/cython_code/PSE.pyx":391
+                    /* "fastrometry/cython_code/PSE.pyx":370
  *                                     for k in range(num_islands,nrefinepts-1):
  *                                         prevx = int(pse_metadata_view[k,0])
  *                                         prevy = int(pse_metadata_view[k,1])             # <<<<<<<<<<<<<<
  *                                         kernelsum = 0
  *                                         for m in range(kernelsize):
  */
                     __pyx_t_24 = __pyx_v_k;
@@ -8697,40 +8119,40 @@
                     } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_25 < 0) {
                       __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 391, __pyx_L1_error)
+                      __PYX_ERR(0, 370, __pyx_L1_error)
                     }
                     __pyx_v_prevy = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-                    /* "fastrometry/cython_code/PSE.pyx":392
+                    /* "fastrometry/cython_code/PSE.pyx":371
  *                                         prevx = int(pse_metadata_view[k,0])
  *                                         prevy = int(pse_metadata_view[k,1])
  *                                         kernelsum = 0             # <<<<<<<<<<<<<<
  *                                         for m in range(kernelsize):
  *                                             kernelsum += img_view[(prevy+kernelcircle_view[m,1])-1,(prevx+kernelcircle_view[m,0])-1]
  */
                     __pyx_v_kernelsum = 0.0;
 
-                    /* "fastrometry/cython_code/PSE.pyx":393
+                    /* "fastrometry/cython_code/PSE.pyx":372
  *                                         prevy = int(pse_metadata_view[k,1])
  *                                         kernelsum = 0
  *                                         for m in range(kernelsize):             # <<<<<<<<<<<<<<
  *                                             kernelsum += img_view[(prevy+kernelcircle_view[m,1])-1,(prevx+kernelcircle_view[m,0])-1]
  *                                         kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  */
                     __pyx_t_20 = __pyx_v_kernelsize;
                     __pyx_t_21 = __pyx_t_20;
                     for (__pyx_t_32 = 0; __pyx_t_32 < __pyx_t_21; __pyx_t_32+=1) {
                       __pyx_v_m = __pyx_t_32;
 
-                      /* "fastrometry/cython_code/PSE.pyx":394
+                      /* "fastrometry/cython_code/PSE.pyx":373
  *                                         kernelsum = 0
  *                                         for m in range(kernelsize):
  *                                             kernelsum += img_view[(prevy+kernelcircle_view[m,1])-1,(prevx+kernelcircle_view[m,0])-1]             # <<<<<<<<<<<<<<
  *                                         kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  *                                         pse_metadata_view[k,2] = kernelsum
  */
                       __pyx_t_25 = __pyx_v_m;
@@ -8742,50 +8164,50 @@
                       } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                       if (__pyx_t_24 < 0) {
                         __pyx_t_24 += __pyx_v_kernelcircle_view.shape[1];
                         if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
                       } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                       if (unlikely(__pyx_t_23 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                        __PYX_ERR(0, 394, __pyx_L1_error)
+                        __PYX_ERR(0, 373, __pyx_L1_error)
                       }
                       __pyx_t_28 = __pyx_v_m;
                       __pyx_t_29 = 0;
                       __pyx_t_23 = -1;
                       if (__pyx_t_28 < 0) {
                         __pyx_t_28 += __pyx_v_kernelcircle_view.shape[0];
                         if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 0;
                       } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                       if (__pyx_t_29 < 0) {
                         __pyx_t_29 += __pyx_v_kernelcircle_view.shape[1];
                         if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
                       } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                       if (unlikely(__pyx_t_23 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                        __PYX_ERR(0, 394, __pyx_L1_error)
+                        __PYX_ERR(0, 373, __pyx_L1_error)
                       }
                       __pyx_t_18 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                       __pyx_t_19 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                       __pyx_t_23 = -1;
                       if (__pyx_t_18 < 0) {
                         __pyx_t_18 += __pyx_v_img_view.shape[0];
                         if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 0;
                       } else if (unlikely(__pyx_t_18 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
                       if (__pyx_t_19 < 0) {
                         __pyx_t_19 += __pyx_v_img_view.shape[1];
                         if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
                       } else if (unlikely(__pyx_t_19 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
                       if (unlikely(__pyx_t_23 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                        __PYX_ERR(0, 394, __pyx_L1_error)
+                        __PYX_ERR(0, 373, __pyx_L1_error)
                       }
                       __pyx_v_kernelsum = (__pyx_v_kernelsum + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_18 * __pyx_v_img_view.strides[0]) ) + __pyx_t_19 * __pyx_v_img_view.strides[1]) ))));
                     }
 
-                    /* "fastrometry/cython_code/PSE.pyx":395
+                    /* "fastrometry/cython_code/PSE.pyx":374
  *                                         for m in range(kernelsize):
  *                                             kernelsum += img_view[(prevy+kernelcircle_view[m,1])-1,(prevx+kernelcircle_view[m,0])-1]
  *                                         kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize             # <<<<<<<<<<<<<<
  *                                         pse_metadata_view[k,2] = kernelsum
  * 
  */
                     __pyx_t_29 = (__pyx_v_prevy - 1);
@@ -8797,19 +8219,19 @@
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_bgmap_view.shape[1];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 395, __pyx_L1_error)
+                      __PYX_ERR(0, 374, __pyx_L1_error)
                     }
                     __pyx_v_kernelsum = (__pyx_v_kernelsum - ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_29 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_28 * __pyx_v_bgmap_view.strides[1]) ))) * __pyx_v_kernelsize));
 
-                    /* "fastrometry/cython_code/PSE.pyx":396
+                    /* "fastrometry/cython_code/PSE.pyx":375
  *                                             kernelsum += img_view[(prevy+kernelcircle_view[m,1])-1,(prevx+kernelcircle_view[m,0])-1]
  *                                         kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  *                                         pse_metadata_view[k,2] = kernelsum             # <<<<<<<<<<<<<<
  * 
  *                                     ###Now getting the brightness of the current nrefinepts'th source
  */
                     __pyx_t_28 = __pyx_v_k;
@@ -8821,41 +8243,41 @@
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_29 < 0) {
                       __pyx_t_29 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 396, __pyx_L1_error)
+                      __PYX_ERR(0, 375, __pyx_L1_error)
                     }
                     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_kernelsum;
                   }
 
-                  /* "fastrometry/cython_code/PSE.pyx":399
+                  /* "fastrometry/cython_code/PSE.pyx":378
  * 
  *                                     ###Now getting the brightness of the current nrefinepts'th source
  *                                     kernelsum = 0             # <<<<<<<<<<<<<<
  *                                     for n in range(kernelsize):
  *                                         kernelsum += img_view[(x+kernelcircle_view[n,1])-1,(y+kernelcircle_view[n,0])-1]
  */
                   __pyx_v_kernelsum = 0.0;
 
-                  /* "fastrometry/cython_code/PSE.pyx":400
+                  /* "fastrometry/cython_code/PSE.pyx":379
  *                                     ###Now getting the brightness of the current nrefinepts'th source
  *                                     kernelsum = 0
  *                                     for n in range(kernelsize):             # <<<<<<<<<<<<<<
  *                                         kernelsum += img_view[(x+kernelcircle_view[n,1])-1,(y+kernelcircle_view[n,0])-1]
  *                                     kernelsum -= centerbg*kernelsize
  */
                   __pyx_t_20 = __pyx_v_kernelsize;
                   __pyx_t_21 = __pyx_t_20;
                   for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
                     __pyx_v_n = __pyx_t_22;
 
-                    /* "fastrometry/cython_code/PSE.pyx":401
+                    /* "fastrometry/cython_code/PSE.pyx":380
  *                                     kernelsum = 0
  *                                     for n in range(kernelsize):
  *                                         kernelsum += img_view[(x+kernelcircle_view[n,1])-1,(y+kernelcircle_view[n,0])-1]             # <<<<<<<<<<<<<<
  *                                     kernelsum -= centerbg*kernelsize
  * 
  */
                     __pyx_t_29 = __pyx_v_n;
@@ -8867,59 +8289,59 @@
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_kernelcircle_view.shape[1];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 401, __pyx_L1_error)
+                      __PYX_ERR(0, 380, __pyx_L1_error)
                     }
                     __pyx_t_24 = __pyx_v_n;
                     __pyx_t_25 = 0;
                     __pyx_t_23 = -1;
                     if (__pyx_t_24 < 0) {
                       __pyx_t_24 += __pyx_v_kernelcircle_view.shape[0];
                       if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
                     } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_25 < 0) {
                       __pyx_t_25 += __pyx_v_kernelcircle_view.shape[1];
                       if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 401, __pyx_L1_error)
+                      __PYX_ERR(0, 380, __pyx_L1_error)
                     }
                     __pyx_t_19 = ((__pyx_v_x + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                     __pyx_t_18 = ((__pyx_v_y + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                     __pyx_t_23 = -1;
                     if (__pyx_t_19 < 0) {
                       __pyx_t_19 += __pyx_v_img_view.shape[0];
                       if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
                     } else if (unlikely(__pyx_t_19 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_18 < 0) {
                       __pyx_t_18 += __pyx_v_img_view.shape[1];
                       if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_18 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 401, __pyx_L1_error)
+                      __PYX_ERR(0, 380, __pyx_L1_error)
                     }
                     __pyx_v_kernelsum = (__pyx_v_kernelsum + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_19 * __pyx_v_img_view.strides[0]) ) + __pyx_t_18 * __pyx_v_img_view.strides[1]) ))));
                   }
 
-                  /* "fastrometry/cython_code/PSE.pyx":402
+                  /* "fastrometry/cython_code/PSE.pyx":381
  *                                     for n in range(kernelsize):
  *                                         kernelsum += img_view[(x+kernelcircle_view[n,1])-1,(y+kernelcircle_view[n,0])-1]
  *                                     kernelsum -= centerbg*kernelsize             # <<<<<<<<<<<<<<
  * 
  *                                     pse_metadata_view[nrefinepts-1,0] = x
  */
                   __pyx_v_kernelsum = (__pyx_v_kernelsum - (__pyx_v_centerbg * __pyx_v_kernelsize));
 
-                  /* "fastrometry/cython_code/PSE.pyx":404
+                  /* "fastrometry/cython_code/PSE.pyx":383
  *                                     kernelsum -= centerbg*kernelsize
  * 
  *                                     pse_metadata_view[nrefinepts-1,0] = x             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[nrefinepts-1,1] = y
  *                                     pse_metadata_view[nrefinepts-1,2] = kernelsum
  */
                   __pyx_t_25 = (__pyx_v_nrefinepts - 1);
@@ -8931,19 +8353,19 @@
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_24 < 0) {
                     __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 404, __pyx_L1_error)
+                    __PYX_ERR(0, 383, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_x;
 
-                  /* "fastrometry/cython_code/PSE.pyx":405
+                  /* "fastrometry/cython_code/PSE.pyx":384
  * 
  *                                     pse_metadata_view[nrefinepts-1,0] = x
  *                                     pse_metadata_view[nrefinepts-1,1] = y             # <<<<<<<<<<<<<<
  *                                     pse_metadata_view[nrefinepts-1,2] = kernelsum
  * 
  */
                   __pyx_t_24 = (__pyx_v_nrefinepts - 1);
@@ -8955,19 +8377,19 @@
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_25 < 0) {
                     __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 405, __pyx_L1_error)
+                    __PYX_ERR(0, 384, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_y;
 
-                  /* "fastrometry/cython_code/PSE.pyx":406
+                  /* "fastrometry/cython_code/PSE.pyx":385
  *                                     pse_metadata_view[nrefinepts-1,0] = x
  *                                     pse_metadata_view[nrefinepts-1,1] = y
  *                                     pse_metadata_view[nrefinepts-1,2] = kernelsum             # <<<<<<<<<<<<<<
  * 
  *                                     curr_src_ind += 1
  */
                   __pyx_t_25 = (__pyx_v_nrefinepts - 1);
@@ -8979,67 +8401,67 @@
                   } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                   if (__pyx_t_24 < 0) {
                     __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
                     if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
                   } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                   if (unlikely(__pyx_t_20 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                    __PYX_ERR(0, 406, __pyx_L1_error)
+                    __PYX_ERR(0, 385, __pyx_L1_error)
                   }
                   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_kernelsum;
 
-                  /* "fastrometry/cython_code/PSE.pyx":408
+                  /* "fastrometry/cython_code/PSE.pyx":387
  *                                     pse_metadata_view[nrefinepts-1,2] = kernelsum
  * 
  *                                     curr_src_ind += 1             # <<<<<<<<<<<<<<
  * 
  *                                 else:
  */
                   __pyx_v_curr_src_ind = (__pyx_v_curr_src_ind + 1);
 
-                  /* "fastrometry/cython_code/PSE.pyx":385
+                  /* "fastrometry/cython_code/PSE.pyx":364
  *                                     curr_src_ind += 1
  * 
  *                                 elif curr_src_ind == nrefinepts-1:             # <<<<<<<<<<<<<<
  *                                     ###If we got to this point, we know that this loop gives us at least nrefinepts sources. We go back (by accessing
  *                                     ###the pse_metadata) and perform kernel integration to get the brightnesses of all sources found so far.
  */
                   goto __pyx_L19;
                 }
 
-                /* "fastrometry/cython_code/PSE.pyx":414
+                /* "fastrometry/cython_code/PSE.pyx":393
  *                                     ###in the nrefinepts found and, if this new source is brighter, replace the dimmest one.
  * 
  *                                     dimmest = np.inf             # <<<<<<<<<<<<<<
  *                                     for p in range(num_islands,nrefinepts):
  *                                         if pse_metadata_view[p,2] < dimmest:
  */
                 /*else*/ {
-                  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 414, __pyx_L1_error)
+                  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 393, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_6);
-                  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
+                  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_inf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_3);
                   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-                  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 414, __pyx_L1_error)
+                  __pyx_t_1 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_1 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 393, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
                   __pyx_v_dimmest = __pyx_t_1;
 
-                  /* "fastrometry/cython_code/PSE.pyx":415
+                  /* "fastrometry/cython_code/PSE.pyx":394
  * 
  *                                     dimmest = np.inf
  *                                     for p in range(num_islands,nrefinepts):             # <<<<<<<<<<<<<<
  *                                         if pse_metadata_view[p,2] < dimmest:
  *                                             dimmest = pse_metadata_view[p,2]
  */
                   __pyx_t_20 = __pyx_v_nrefinepts;
                   __pyx_t_21 = __pyx_t_20;
                   for (__pyx_t_22 = __pyx_v_num_islands; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
                     __pyx_v_p = __pyx_t_22;
 
-                    /* "fastrometry/cython_code/PSE.pyx":416
+                    /* "fastrometry/cython_code/PSE.pyx":395
  *                                     dimmest = np.inf
  *                                     for p in range(num_islands,nrefinepts):
  *                                         if pse_metadata_view[p,2] < dimmest:             # <<<<<<<<<<<<<<
  *                                             dimmest = pse_metadata_view[p,2]
  *                                             dimmest_ind = p
  */
                     __pyx_t_24 = __pyx_v_p;
@@ -9051,20 +8473,20 @@
                     } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_25 < 0) {
                       __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 416, __pyx_L1_error)
+                      __PYX_ERR(0, 395, __pyx_L1_error)
                     }
                     __pyx_t_8 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) ))) < __pyx_v_dimmest) != 0);
                     if (__pyx_t_8) {
 
-                      /* "fastrometry/cython_code/PSE.pyx":417
+                      /* "fastrometry/cython_code/PSE.pyx":396
  *                                     for p in range(num_islands,nrefinepts):
  *                                         if pse_metadata_view[p,2] < dimmest:
  *                                             dimmest = pse_metadata_view[p,2]             # <<<<<<<<<<<<<<
  *                                             dimmest_ind = p
  * 
  */
                       __pyx_t_25 = __pyx_v_p;
@@ -9076,59 +8498,59 @@
                       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_23 = 0;
                       if (__pyx_t_24 < 0) {
                         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
                         if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
                       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_23 = 1;
                       if (unlikely(__pyx_t_23 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                        __PYX_ERR(0, 417, __pyx_L1_error)
+                        __PYX_ERR(0, 396, __pyx_L1_error)
                       }
                       __pyx_v_dimmest = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )));
 
-                      /* "fastrometry/cython_code/PSE.pyx":418
+                      /* "fastrometry/cython_code/PSE.pyx":397
  *                                         if pse_metadata_view[p,2] < dimmest:
  *                                             dimmest = pse_metadata_view[p,2]
  *                                             dimmest_ind = p             # <<<<<<<<<<<<<<
  * 
  *                                     kernelsum = 0
  */
                       __pyx_v_dimmest_ind = __pyx_v_p;
 
-                      /* "fastrometry/cython_code/PSE.pyx":416
+                      /* "fastrometry/cython_code/PSE.pyx":395
  *                                     dimmest = np.inf
  *                                     for p in range(num_islands,nrefinepts):
  *                                         if pse_metadata_view[p,2] < dimmest:             # <<<<<<<<<<<<<<
  *                                             dimmest = pse_metadata_view[p,2]
  *                                             dimmest_ind = p
  */
                     }
                   }
 
-                  /* "fastrometry/cython_code/PSE.pyx":420
+                  /* "fastrometry/cython_code/PSE.pyx":399
  *                                             dimmest_ind = p
  * 
  *                                     kernelsum = 0             # <<<<<<<<<<<<<<
  *                                     for q in range(kernelsize):
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]
  */
                   __pyx_v_kernelsum = 0.0;
 
-                  /* "fastrometry/cython_code/PSE.pyx":421
+                  /* "fastrometry/cython_code/PSE.pyx":400
  * 
  *                                     kernelsum = 0
  *                                     for q in range(kernelsize):             # <<<<<<<<<<<<<<
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]
  *                                     kernelsum -= centerbg*kernelsize
  */
                   __pyx_t_20 = __pyx_v_kernelsize;
                   __pyx_t_21 = __pyx_t_20;
                   for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
                     __pyx_v_q = __pyx_t_22;
 
-                    /* "fastrometry/cython_code/PSE.pyx":422
+                    /* "fastrometry/cython_code/PSE.pyx":401
  *                                     kernelsum = 0
  *                                     for q in range(kernelsize):
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]             # <<<<<<<<<<<<<<
  *                                     kernelsum -= centerbg*kernelsize
  *                                     if kernelsum > dimmest:
  */
                     __pyx_t_24 = __pyx_v_q;
@@ -9140,69 +8562,69 @@
                     } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_25 < 0) {
                       __pyx_t_25 += __pyx_v_kernelcircle_view.shape[1];
                       if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 422, __pyx_L1_error)
+                      __PYX_ERR(0, 401, __pyx_L1_error)
                     }
                     __pyx_t_28 = __pyx_v_q;
                     __pyx_t_29 = 0;
                     __pyx_t_23 = -1;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_kernelcircle_view.shape[0];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 0;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_29 < 0) {
                       __pyx_t_29 += __pyx_v_kernelcircle_view.shape[1];
                       if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 422, __pyx_L1_error)
+                      __PYX_ERR(0, 401, __pyx_L1_error)
                     }
                     __pyx_t_18 = ((__pyx_v_y + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                     __pyx_t_19 = ((__pyx_v_x + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
                     __pyx_t_23 = -1;
                     if (__pyx_t_18 < 0) {
                       __pyx_t_18 += __pyx_v_img_view.shape[0];
                       if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 0;
                     } else if (unlikely(__pyx_t_18 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
                     if (__pyx_t_19 < 0) {
                       __pyx_t_19 += __pyx_v_img_view.shape[1];
                       if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
                     } else if (unlikely(__pyx_t_19 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
                     if (unlikely(__pyx_t_23 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_23);
-                      __PYX_ERR(0, 422, __pyx_L1_error)
+                      __PYX_ERR(0, 401, __pyx_L1_error)
                     }
                     __pyx_v_kernelsum = (__pyx_v_kernelsum + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_18 * __pyx_v_img_view.strides[0]) ) + __pyx_t_19 * __pyx_v_img_view.strides[1]) ))));
                   }
 
-                  /* "fastrometry/cython_code/PSE.pyx":423
+                  /* "fastrometry/cython_code/PSE.pyx":402
  *                                     for q in range(kernelsize):
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]
  *                                     kernelsum -= centerbg*kernelsize             # <<<<<<<<<<<<<<
  *                                     if kernelsum > dimmest:
  *                                         pse_metadata_view[dimmest_ind,0] = x
  */
                   __pyx_v_kernelsum = (__pyx_v_kernelsum - (__pyx_v_centerbg * __pyx_v_kernelsize));
 
-                  /* "fastrometry/cython_code/PSE.pyx":424
+                  /* "fastrometry/cython_code/PSE.pyx":403
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]
  *                                     kernelsum -= centerbg*kernelsize
  *                                     if kernelsum > dimmest:             # <<<<<<<<<<<<<<
  *                                         pse_metadata_view[dimmest_ind,0] = x
  *                                         pse_metadata_view[dimmest_ind,1] = y
  */
                   __pyx_t_8 = ((__pyx_v_kernelsum > __pyx_v_dimmest) != 0);
                   if (__pyx_t_8) {
 
-                    /* "fastrometry/cython_code/PSE.pyx":425
+                    /* "fastrometry/cython_code/PSE.pyx":404
  *                                     kernelsum -= centerbg*kernelsize
  *                                     if kernelsum > dimmest:
  *                                         pse_metadata_view[dimmest_ind,0] = x             # <<<<<<<<<<<<<<
  *                                         pse_metadata_view[dimmest_ind,1] = y
  *                                         pse_metadata_view[dimmest_ind,2] = kernelsum
  */
                     __pyx_t_29 = __pyx_v_dimmest_ind;
@@ -9214,19 +8636,19 @@
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 425, __pyx_L1_error)
+                      __PYX_ERR(0, 404, __pyx_L1_error)
                     }
                     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_x;
 
-                    /* "fastrometry/cython_code/PSE.pyx":426
+                    /* "fastrometry/cython_code/PSE.pyx":405
  *                                     if kernelsum > dimmest:
  *                                         pse_metadata_view[dimmest_ind,0] = x
  *                                         pse_metadata_view[dimmest_ind,1] = y             # <<<<<<<<<<<<<<
  *                                         pse_metadata_view[dimmest_ind,2] = kernelsum
  * 
  */
                     __pyx_t_28 = __pyx_v_dimmest_ind;
@@ -9238,19 +8660,19 @@
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_29 < 0) {
                       __pyx_t_29 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 426, __pyx_L1_error)
+                      __PYX_ERR(0, 405, __pyx_L1_error)
                     }
                     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_y;
 
-                    /* "fastrometry/cython_code/PSE.pyx":427
+                    /* "fastrometry/cython_code/PSE.pyx":406
  *                                         pse_metadata_view[dimmest_ind,0] = x
  *                                         pse_metadata_view[dimmest_ind,1] = y
  *                                         pse_metadata_view[dimmest_ind,2] = kernelsum             # <<<<<<<<<<<<<<
  * 
  * 
  */
                     __pyx_t_29 = __pyx_v_dimmest_ind;
@@ -9262,344 +8684,344 @@
                     } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
                     if (unlikely(__pyx_t_20 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_20);
-                      __PYX_ERR(0, 427, __pyx_L1_error)
+                      __PYX_ERR(0, 406, __pyx_L1_error)
                     }
                     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_kernelsum;
 
-                    /* "fastrometry/cython_code/PSE.pyx":424
+                    /* "fastrometry/cython_code/PSE.pyx":403
  *                                         kernelsum += img_view[(y+kernelcircle_view[q,1])-1,(x+kernelcircle_view[q,0])-1]
  *                                     kernelsum -= centerbg*kernelsize
  *                                     if kernelsum > dimmest:             # <<<<<<<<<<<<<<
  *                                         pse_metadata_view[dimmest_ind,0] = x
  *                                         pse_metadata_view[dimmest_ind,1] = y
  */
                   }
 
-                  /* "fastrometry/cython_code/PSE.pyx":430
+                  /* "fastrometry/cython_code/PSE.pyx":409
  * 
  * 
  *                                     curr_src_ind += 1             # <<<<<<<<<<<<<<
  * 
  *         if verbosity == 2:
  */
                   __pyx_v_curr_src_ind = (__pyx_v_curr_src_ind + 1);
                 }
                 __pyx_L19:;
 
-                /* "fastrometry/cython_code/PSE.pyx":368
+                /* "fastrometry/cython_code/PSE.pyx":347
  *                                     localpeak = False
  *                                     break
  *                             if localpeak == True:             # <<<<<<<<<<<<<<
  *                                 for j in range(sourcesepsize):
  *                                     occupymap_view[(y+sourcesepcircle_view[j,1])-1, (x+sourcesepcircle_view[j,0])-1] = -2
  */
               }
 
-              /* "fastrometry/cython_code/PSE.pyx":362
+              /* "fastrometry/cython_code/PSE.pyx":341
  *                     if occupymap_view[y-1,x-1] == -1:
  *                         centerbg = bgmap_view[y-1,x-1]
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:             # <<<<<<<<<<<<<<
  *                             localpeak = True        ##in other words, set to True preemptively and test using the surrounding pixels
  *                             for i in range(sourcesepsize):
  */
             }
 
-            /* "fastrometry/cython_code/PSE.pyx":360
+            /* "fastrometry/cython_code/PSE.pyx":339
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  *                 if roi_view[y-1,x-1] == 1:
  *                     if occupymap_view[y-1,x-1] == -1:             # <<<<<<<<<<<<<<
  *                         centerbg = bgmap_view[y-1,x-1]
  *                         if img_view[y-1,x-1] - centerbg > pixelthresh:
  */
           }
 
-          /* "fastrometry/cython_code/PSE.pyx":359
+          /* "fastrometry/cython_code/PSE.pyx":338
  *         for x in range(leftmostsafe_x, rightmostsafe_x+1):
  *             for y in range(topmostsafe_y, bottommostsafe_y+1):
  *                 if roi_view[y-1,x-1] == 1:             # <<<<<<<<<<<<<<
  *                     if occupymap_view[y-1,x-1] == -1:
  *                         centerbg = bgmap_view[y-1,x-1]
  */
         }
       }
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":432
+    /* "fastrometry/cython_code/PSE.pyx":411
  *                                     curr_src_ind += 1
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | | Iteration: {}".format(iter))
  *             print("| | | Pixel threshold: {}".format(pixelthresh))
  */
     __pyx_t_8 = ((__pyx_v_verbosity == 2) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":433
+      /* "fastrometry/cython_code/PSE.pyx":412
  * 
  *         if verbosity == 2:
  *             print("| | | Iteration: {}".format(iter))             # <<<<<<<<<<<<<<
  *             print("| | | Pixel threshold: {}".format(pixelthresh))
  *             print("| | | Sources found: {}".format(curr_src_ind))
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Iteration, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 433, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Iteration, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 412, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
+      __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 412, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 412, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 433, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 412, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":434
+      /* "fastrometry/cython_code/PSE.pyx":413
  *         if verbosity == 2:
  *             print("| | | Iteration: {}".format(iter))
  *             print("| | | Pixel threshold: {}".format(pixelthresh))             # <<<<<<<<<<<<<<
  *             print("| | | Sources found: {}".format(curr_src_ind))
  * 
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Pixel_threshold, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 434, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Pixel_threshold, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_pixelthresh); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)
+      __pyx_t_4 = PyFloat_FromDouble(__pyx_v_pixelthresh); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 413, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 413, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 434, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 413, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":435
+      /* "fastrometry/cython_code/PSE.pyx":414
  *             print("| | | Iteration: {}".format(iter))
  *             print("| | | Pixel threshold: {}".format(pixelthresh))
  *             print("| | | Sources found: {}".format(curr_src_ind))             # <<<<<<<<<<<<<<
  * 
  *         if curr_src_ind < nrefinepts:  ###Here think of curr_src_ind representing the amount of sources found this iteration
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Sources_found, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 435, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Sources_found, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 435, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 414, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":432
+      /* "fastrometry/cython_code/PSE.pyx":411
  *                                     curr_src_ind += 1
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | | Iteration: {}".format(iter))
  *             print("| | | Pixel threshold: {}".format(pixelthresh))
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":437
+    /* "fastrometry/cython_code/PSE.pyx":416
  *             print("| | | Sources found: {}".format(curr_src_ind))
  * 
  *         if curr_src_ind < nrefinepts:  ###Here think of curr_src_ind representing the amount of sources found this iteration             # <<<<<<<<<<<<<<
  *             div_factor *= 2
  *             pixelthresh = (img_max-img_median)/div_factor + img_median
  */
     __pyx_t_8 = ((__pyx_v_curr_src_ind < __pyx_v_nrefinepts) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":438
+      /* "fastrometry/cython_code/PSE.pyx":417
  * 
  *         if curr_src_ind < nrefinepts:  ###Here think of curr_src_ind representing the amount of sources found this iteration
  *             div_factor *= 2             # <<<<<<<<<<<<<<
  *             pixelthresh = (img_max-img_median)/div_factor + img_median
  *         else:
  */
       __pyx_v_div_factor = (__pyx_v_div_factor * 2);
 
-      /* "fastrometry/cython_code/PSE.pyx":439
+      /* "fastrometry/cython_code/PSE.pyx":418
  *         if curr_src_ind < nrefinepts:  ###Here think of curr_src_ind representing the amount of sources found this iteration
  *             div_factor *= 2
  *             pixelthresh = (img_max-img_median)/div_factor + img_median             # <<<<<<<<<<<<<<
  *         else:
  *             break
  */
       __pyx_t_1 = (__pyx_v_img_max - __pyx_v_img_median);
       if (unlikely(__pyx_v_div_factor == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 439, __pyx_L1_error)
+        __PYX_ERR(0, 418, __pyx_L1_error)
       }
       __pyx_v_pixelthresh = ((__pyx_t_1 / __pyx_v_div_factor) + __pyx_v_img_median);
 
-      /* "fastrometry/cython_code/PSE.pyx":437
+      /* "fastrometry/cython_code/PSE.pyx":416
  *             print("| | | Sources found: {}".format(curr_src_ind))
  * 
  *         if curr_src_ind < nrefinepts:  ###Here think of curr_src_ind representing the amount of sources found this iteration             # <<<<<<<<<<<<<<
  *             div_factor *= 2
  *             pixelthresh = (img_max-img_median)/div_factor + img_median
  */
       goto __pyx_L33;
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":441
+    /* "fastrometry/cython_code/PSE.pyx":420
  *             pixelthresh = (img_max-img_median)/div_factor + img_median
  *         else:
  *             break             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
     /*else*/ {
       goto __pyx_L5_break;
     }
     __pyx_L33:;
   }
   __pyx_L5_break:;
 
-  /* "fastrometry/cython_code/PSE.pyx":443
+  /* "fastrometry/cython_code/PSE.pyx":422
  *             break
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"pse_metadata_allsources.csv", pse_metadata, delimiter=",")
  * 
  */
   __pyx_t_8 = (__pyx_v_debug != 0);
   if (__pyx_t_8) {
 
-    /* "fastrometry/cython_code/PSE.pyx":444
+    /* "fastrometry/cython_code/PSE.pyx":423
  * 
  *     if debug:
  *         np.savetxt(debug_report/"pse_metadata_allsources.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     if curr_src_ind < nrefinepts:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_csv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_csv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
     __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
     PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)__pyx_v_pse_metadata));
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 444, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 444, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 423, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 423, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":443
+    /* "fastrometry/cython_code/PSE.pyx":422
  *             break
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"pse_metadata_allsources.csv", pse_metadata, delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":446
+  /* "fastrometry/cython_code/PSE.pyx":425
  *         np.savetxt(debug_report/"pse_metadata_allsources.csv", pse_metadata, delimiter=",")
  * 
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         ###If max_iters iterations have been performed and we still don't have nrefinepts sources,
  *         ###we just have to take what we have and do all the heavy calculations for those now.
  */
   __pyx_t_8 = ((__pyx_v_curr_src_ind < __pyx_v_nrefinepts) != 0);
   if (__pyx_t_8) {
 
-    /* "fastrometry/cython_code/PSE.pyx":450
+    /* "fastrometry/cython_code/PSE.pyx":429
  *         ###we just have to take what we have and do all the heavy calculations for those now.
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | done")
  * 
  */
     __pyx_t_8 = ((__pyx_v_verbosity == 2) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":451
+      /* "fastrometry/cython_code/PSE.pyx":430
  * 
  *         if verbosity == 2:
  *             print("| | done")             # <<<<<<<<<<<<<<
  * 
  *         for r in range(num_islands,curr_src_ind):
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 451, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":450
+      /* "fastrometry/cython_code/PSE.pyx":429
  *         ###we just have to take what we have and do all the heavy calculations for those now.
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | done")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":453
+    /* "fastrometry/cython_code/PSE.pyx":432
  *             print("| | done")
  * 
  *         for r in range(num_islands,curr_src_ind):             # <<<<<<<<<<<<<<
  *             prevx = int(pse_metadata_view[r,0])
  *             prevy = int(pse_metadata_view[r,1])
  */
     __pyx_t_9 = __pyx_v_curr_src_ind;
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = __pyx_v_num_islands; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_r = __pyx_t_11;
 
-      /* "fastrometry/cython_code/PSE.pyx":454
+      /* "fastrometry/cython_code/PSE.pyx":433
  * 
  *         for r in range(num_islands,curr_src_ind):
  *             prevx = int(pse_metadata_view[r,0])             # <<<<<<<<<<<<<<
  *             prevy = int(pse_metadata_view[r,1])
  *             kernelsum = 0
  */
       __pyx_t_28 = __pyx_v_r;
@@ -9611,19 +9033,19 @@
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_29 < 0) {
         __pyx_t_29 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 454, __pyx_L1_error)
+        __PYX_ERR(0, 433, __pyx_L1_error)
       }
       __pyx_v_prevx = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":455
+      /* "fastrometry/cython_code/PSE.pyx":434
  *         for r in range(num_islands,curr_src_ind):
  *             prevx = int(pse_metadata_view[r,0])
  *             prevy = int(pse_metadata_view[r,1])             # <<<<<<<<<<<<<<
  *             kernelsum = 0
  *             for s in range(kernelsize):
  */
       __pyx_t_29 = __pyx_v_r;
@@ -9635,40 +9057,40 @@
       } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 455, __pyx_L1_error)
+        __PYX_ERR(0, 434, __pyx_L1_error)
       }
       __pyx_v_prevy = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":456
+      /* "fastrometry/cython_code/PSE.pyx":435
  *             prevx = int(pse_metadata_view[r,0])
  *             prevy = int(pse_metadata_view[r,1])
  *             kernelsum = 0             # <<<<<<<<<<<<<<
  *             for s in range(kernelsize):
  *                 kernelsum += img_view[(prevy+kernelcircle_view[s,1])-1,(prevx+kernelcircle_view[s,0])-1]
  */
       __pyx_v_kernelsum = 0.0;
 
-      /* "fastrometry/cython_code/PSE.pyx":457
+      /* "fastrometry/cython_code/PSE.pyx":436
  *             prevy = int(pse_metadata_view[r,1])
  *             kernelsum = 0
  *             for s in range(kernelsize):             # <<<<<<<<<<<<<<
  *                 kernelsum += img_view[(prevy+kernelcircle_view[s,1])-1,(prevx+kernelcircle_view[s,0])-1]
  *             kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  */
       __pyx_t_20 = __pyx_v_kernelsize;
       __pyx_t_21 = __pyx_t_20;
       for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_21; __pyx_t_14+=1) {
         __pyx_v_s = __pyx_t_14;
 
-        /* "fastrometry/cython_code/PSE.pyx":458
+        /* "fastrometry/cython_code/PSE.pyx":437
  *             kernelsum = 0
  *             for s in range(kernelsize):
  *                 kernelsum += img_view[(prevy+kernelcircle_view[s,1])-1,(prevx+kernelcircle_view[s,0])-1]             # <<<<<<<<<<<<<<
  *             kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  *             pse_metadata_view[r,2] = kernelsum
  */
         __pyx_t_28 = __pyx_v_s;
@@ -9680,50 +9102,50 @@
         } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
         if (__pyx_t_29 < 0) {
           __pyx_t_29 += __pyx_v_kernelcircle_view.shape[1];
           if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
         } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
         if (unlikely(__pyx_t_23 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_23);
-          __PYX_ERR(0, 458, __pyx_L1_error)
+          __PYX_ERR(0, 437, __pyx_L1_error)
         }
         __pyx_t_25 = __pyx_v_s;
         __pyx_t_24 = 0;
         __pyx_t_23 = -1;
         if (__pyx_t_25 < 0) {
           __pyx_t_25 += __pyx_v_kernelcircle_view.shape[0];
           if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 0;
         } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
         if (__pyx_t_24 < 0) {
           __pyx_t_24 += __pyx_v_kernelcircle_view.shape[1];
           if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
         } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
         if (unlikely(__pyx_t_23 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_23);
-          __PYX_ERR(0, 458, __pyx_L1_error)
+          __PYX_ERR(0, 437, __pyx_L1_error)
         }
         __pyx_t_19 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
         __pyx_t_18 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
         __pyx_t_23 = -1;
         if (__pyx_t_19 < 0) {
           __pyx_t_19 += __pyx_v_img_view.shape[0];
           if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
         } else if (unlikely(__pyx_t_19 >= __pyx_v_img_view.shape[0])) __pyx_t_23 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_img_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_img_view.shape[1])) __pyx_t_23 = 1;
         if (unlikely(__pyx_t_23 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_23);
-          __PYX_ERR(0, 458, __pyx_L1_error)
+          __PYX_ERR(0, 437, __pyx_L1_error)
         }
         __pyx_v_kernelsum = (__pyx_v_kernelsum + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_img_view.data + __pyx_t_19 * __pyx_v_img_view.strides[0]) ) + __pyx_t_18 * __pyx_v_img_view.strides[1]) ))));
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":459
+      /* "fastrometry/cython_code/PSE.pyx":438
  *             for s in range(kernelsize):
  *                 kernelsum += img_view[(prevy+kernelcircle_view[s,1])-1,(prevx+kernelcircle_view[s,0])-1]
  *             kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize             # <<<<<<<<<<<<<<
  *             pse_metadata_view[r,2] = kernelsum
  * 
  */
       __pyx_t_24 = (__pyx_v_prevy - 1);
@@ -9735,19 +9157,19 @@
       } else if (unlikely(__pyx_t_24 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_bgmap_view.shape[1];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 459, __pyx_L1_error)
+        __PYX_ERR(0, 438, __pyx_L1_error)
       }
       __pyx_v_kernelsum = (__pyx_v_kernelsum - ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_24 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_25 * __pyx_v_bgmap_view.strides[1]) ))) * __pyx_v_kernelsize));
 
-      /* "fastrometry/cython_code/PSE.pyx":460
+      /* "fastrometry/cython_code/PSE.pyx":439
  *                 kernelsum += img_view[(prevy+kernelcircle_view[s,1])-1,(prevx+kernelcircle_view[s,0])-1]
  *             kernelsum -= bgmap_view[prevy-1,prevx-1]*kernelsize
  *             pse_metadata_view[r,2] = kernelsum             # <<<<<<<<<<<<<<
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness
  */
       __pyx_t_25 = __pyx_v_r;
@@ -9759,301 +9181,301 @@
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 460, __pyx_L1_error)
+        __PYX_ERR(0, 439, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )) = __pyx_v_kernelsum;
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":462
+    /* "fastrometry/cython_code/PSE.pyx":441
  *             pse_metadata_view[r,2] = kernelsum
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness             # <<<<<<<<<<<<<<
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argsort); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argsort); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 462, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_slice__12); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_slice__8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_pse_metadata_sorted = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":463
+    /* "fastrometry/cython_code/PSE.pyx":442
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness
  *         pse_metadata[:] = pse_metadata_sorted             # <<<<<<<<<<<<<<
  * 
  *         if debug:
  */
-    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__10, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 463, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__6, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 442, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":465
+    /* "fastrometry/cython_code/PSE.pyx":444
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  */
     __pyx_t_8 = (__pyx_v_debug != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":466
+      /* "fastrometry/cython_code/PSE.pyx":445
  * 
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  *         for rr in range(num_islands, nrefinepts):
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 466, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_c); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_c); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
       __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
       PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_pse_metadata));
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 466, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 466, __pyx_L1_error)
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 466, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 445, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 445, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":465
+      /* "fastrometry/cython_code/PSE.pyx":444
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":467
+    /* "fastrometry/cython_code/PSE.pyx":446
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array             # <<<<<<<<<<<<<<
  *         for rr in range(num_islands, nrefinepts):
  *             if pse_metadata_view[rr,2] < 0:
  */
-    __pyx_t_6 = __Pyx_PyInt_From_int((__pyx_v_nrefinepts - __pyx_v_curr_src_ind)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int((__pyx_v_nrefinepts - __pyx_v_curr_src_ind)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 446, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_v_num_zeros = __pyx_t_6;
     __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":468
+    /* "fastrometry/cython_code/PSE.pyx":447
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  *         for rr in range(num_islands, nrefinepts):             # <<<<<<<<<<<<<<
  *             if pse_metadata_view[rr,2] < 0:
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  */
-    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_num_islands); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_num_islands); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_5);
     __pyx_t_6 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
       __pyx_t_3 = __pyx_t_5; __Pyx_INCREF(__pyx_t_3); __pyx_t_11 = 0;
       __pyx_t_33 = NULL;
     } else {
-      __pyx_t_11 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+      __pyx_t_11 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_33 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 468, __pyx_L1_error)
+      __pyx_t_33 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 447, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     for (;;) {
       if (likely(!__pyx_t_33)) {
         if (likely(PyList_CheckExact(__pyx_t_3))) {
           if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_5); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 468, __pyx_L1_error)
+          __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_5); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         } else {
           if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_5); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 468, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_11); __Pyx_INCREF(__pyx_t_5); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
           #else
-          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 468, __pyx_L1_error)
+          __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           #endif
         }
       } else {
         __pyx_t_5 = __pyx_t_33(__pyx_t_3);
         if (unlikely(!__pyx_t_5)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 468, __pyx_L1_error)
+            else __PYX_ERR(0, 447, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_5);
       }
       __Pyx_XDECREF_SET(__pyx_v_rr, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":469
+      /* "fastrometry/cython_code/PSE.pyx":448
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  *         for rr in range(num_islands, nrefinepts):
  *             if pse_metadata_view[rr,2] < 0:             # <<<<<<<<<<<<<<
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  *                 pse_metadata_view[rr,:] = 0
  */
-      __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 469, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 448, __pyx_L1_error)
       __pyx_t_24 = __pyx_t_14;
       __pyx_t_25 = 2;
       __pyx_t_9 = -1;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[0];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_9 = 0;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_9 = 0;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_9 = 1;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_9 = 1;
       if (unlikely(__pyx_t_9 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_9);
-        __PYX_ERR(0, 469, __pyx_L1_error)
+        __PYX_ERR(0, 448, __pyx_L1_error)
       }
       __pyx_t_8 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) ))) < 0.0) != 0);
       if (__pyx_t_8) {
 
-        /* "fastrometry/cython_code/PSE.pyx":470
+        /* "fastrometry/cython_code/PSE.pyx":449
  *         for rr in range(num_islands, nrefinepts):
  *             if pse_metadata_view[rr,2] < 0:
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]             # <<<<<<<<<<<<<<
  *                 pse_metadata_view[rr,:] = 0
  *         if debug:
  */
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L1_error)
         __pyx_t_7.data = __pyx_v_pse_metadata_view.data;
         __pyx_t_7.memview = __pyx_v_pse_metadata_view.memview;
         __PYX_INC_MEMVIEW(&__pyx_t_7, 0);
         {
     Py_ssize_t __pyx_tmp_idx = __pyx_t_14;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_pse_metadata_view.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_pse_metadata_view.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 470, __pyx_L1_error)
+            __PYX_ERR(0, 449, __pyx_L1_error)
         }
         __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_7.shape[0] = __pyx_v_pse_metadata_view.shape[1];
 __pyx_t_7.strides[0] = __pyx_v_pse_metadata_view.strides[1];
     __pyx_t_7.suboffsets[0] = -1;
 
-__pyx_t_5 = PyNumber_Subtract(__pyx_v_rr, __pyx_v_num_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 470, __pyx_L1_error)
+__pyx_t_5 = PyNumber_Subtract(__pyx_v_rr, __pyx_v_num_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 449, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_5); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 449, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_t_34.data = __pyx_v_pse_metadata_view.data;
         __pyx_t_34.memview = __pyx_v_pse_metadata_view.memview;
         __PYX_INC_MEMVIEW(&__pyx_t_34, 0);
         {
     Py_ssize_t __pyx_tmp_idx = __pyx_t_14;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_pse_metadata_view.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_pse_metadata_view.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 470, __pyx_L1_error)
+            __PYX_ERR(0, 449, __pyx_L1_error)
         }
         __pyx_t_34.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_34.shape[0] = __pyx_v_pse_metadata_view.shape[1];
 __pyx_t_34.strides[0] = __pyx_v_pse_metadata_view.strides[1];
     __pyx_t_34.suboffsets[0] = -1;
 
-if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_7, __pyx_t_34, 1, 1, 0) < 0)) __PYX_ERR(0, 470, __pyx_L1_error)
+if (unlikely(__pyx_memoryview_copy_contents(__pyx_t_7, __pyx_t_34, 1, 1, 0) < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
         __PYX_XDEC_MEMVIEW(&__pyx_t_34, 1);
         __pyx_t_34.memview = NULL;
         __pyx_t_34.data = NULL;
         __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
         __pyx_t_7.memview = NULL;
         __pyx_t_7.data = NULL;
 
-        /* "fastrometry/cython_code/PSE.pyx":471
+        /* "fastrometry/cython_code/PSE.pyx":450
  *             if pse_metadata_view[rr,2] < 0:
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  *                 pse_metadata_view[rr,:] = 0             # <<<<<<<<<<<<<<
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted_zerosmoved.csv", pse_metadata, delimiter=",")
  */
-        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 471, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_v_rr); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 450, __pyx_L1_error)
         __pyx_t_7.data = __pyx_v_pse_metadata_view.data;
         __pyx_t_7.memview = __pyx_v_pse_metadata_view.memview;
         __PYX_INC_MEMVIEW(&__pyx_t_7, 0);
         {
     Py_ssize_t __pyx_tmp_idx = __pyx_t_14;
         Py_ssize_t __pyx_tmp_shape = __pyx_v_pse_metadata_view.shape[0];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_pse_metadata_view.strides[0];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 0)");
-            __PYX_ERR(0, 471, __pyx_L1_error)
+            __PYX_ERR(0, 450, __pyx_L1_error)
         }
         __pyx_t_7.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
 __pyx_t_7.shape[0] = __pyx_v_pse_metadata_view.shape[1];
 __pyx_t_7.strides[0] = __pyx_v_pse_metadata_view.strides[1];
     __pyx_t_7.suboffsets[0] = -1;
@@ -10072,97 +9494,97 @@
                 }
             }
         }
         __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
         __pyx_t_7.memview = NULL;
         __pyx_t_7.data = NULL;
 
-        /* "fastrometry/cython_code/PSE.pyx":469
+        /* "fastrometry/cython_code/PSE.pyx":448
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  *         for rr in range(num_islands, nrefinepts):
  *             if pse_metadata_view[rr,2] < 0:             # <<<<<<<<<<<<<<
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  *                 pse_metadata_view[rr,:] = 0
  */
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":468
+      /* "fastrometry/cython_code/PSE.pyx":447
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  *         num_zeros = nrefinepts - curr_src_ind      #If not all nrefinepts slots are filled, there will be leftover zeros that need to be pushed to the back of the array
  *         for rr in range(num_islands, nrefinepts):             # <<<<<<<<<<<<<<
  *             if pse_metadata_view[rr,2] < 0:
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  */
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":472
+    /* "fastrometry/cython_code/PSE.pyx":451
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  *                 pse_metadata_view[rr,:] = 0
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted_zerosmoved.csv", pse_metadata, delimiter=",")
  * 
  */
     __pyx_t_8 = (__pyx_v_debug != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":473
+      /* "fastrometry/cython_code/PSE.pyx":452
  *                 pse_metadata_view[rr,:] = 0
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted_zerosmoved.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *         for r2 in range(num_islands, curr_src_ind):
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
       __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
       PyTuple_SET_ITEM(__pyx_t_6, 1, ((PyObject *)__pyx_v_pse_metadata));
       __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 473, __pyx_L1_error)
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 452, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 452, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":472
+      /* "fastrometry/cython_code/PSE.pyx":451
  *                 pse_metadata_view[rr-num_zeros,:] = pse_metadata_view[rr,:]
  *                 pse_metadata_view[rr,:] = 0
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted_zerosmoved.csv", pse_metadata, delimiter=",")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":475
+    /* "fastrometry/cython_code/PSE.pyx":454
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted_zerosmoved.csv", pse_metadata, delimiter=",")
  * 
  *         for r2 in range(num_islands, curr_src_ind):             # <<<<<<<<<<<<<<
  *             prevx = int(pse_metadata_view[r2,0])
  *             prevy = int(pse_metadata_view[r2,1])
  */
     __pyx_t_9 = __pyx_v_curr_src_ind;
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = __pyx_v_num_islands; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_r2 = __pyx_t_11;
 
-      /* "fastrometry/cython_code/PSE.pyx":476
+      /* "fastrometry/cython_code/PSE.pyx":455
  * 
  *         for r2 in range(num_islands, curr_src_ind):
  *             prevx = int(pse_metadata_view[r2,0])             # <<<<<<<<<<<<<<
  *             prevy = int(pse_metadata_view[r2,1])
  *             if r2 < npts:
  */
       __pyx_t_25 = __pyx_v_r2;
@@ -10174,19 +9596,19 @@
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 476, __pyx_L1_error)
+        __PYX_ERR(0, 455, __pyx_L1_error)
       }
       __pyx_v_prevx = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":477
+      /* "fastrometry/cython_code/PSE.pyx":456
  *         for r2 in range(num_islands, curr_src_ind):
  *             prevx = int(pse_metadata_view[r2,0])
  *             prevy = int(pse_metadata_view[r2,1])             # <<<<<<<<<<<<<<
  *             if r2 < npts:
  *                 for s2 in range(kernelsize):
  */
       __pyx_t_24 = __pyx_v_r2;
@@ -10198,41 +9620,41 @@
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 477, __pyx_L1_error)
+        __PYX_ERR(0, 456, __pyx_L1_error)
       }
       __pyx_v_prevy = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":478
+      /* "fastrometry/cython_code/PSE.pyx":457
  *             prevx = int(pse_metadata_view[r2,0])
  *             prevy = int(pse_metadata_view[r2,1])
  *             if r2 < npts:             # <<<<<<<<<<<<<<
  *                 for s2 in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  */
       __pyx_t_8 = ((__pyx_v_r2 < __pyx_v_npts) != 0);
       if (__pyx_t_8) {
 
-        /* "fastrometry/cython_code/PSE.pyx":479
+        /* "fastrometry/cython_code/PSE.pyx":458
  *             prevy = int(pse_metadata_view[r2,1])
  *             if r2 < npts:
  *                 for s2 in range(kernelsize):             # <<<<<<<<<<<<<<
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  */
         __pyx_t_20 = __pyx_v_kernelsize;
         __pyx_t_21 = __pyx_t_20;
         for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_21; __pyx_t_14+=1) {
           __pyx_v_s2 = __pyx_t_14;
 
-          /* "fastrometry/cython_code/PSE.pyx":480
+          /* "fastrometry/cython_code/PSE.pyx":459
  *             if r2 < npts:
  *                 for s2 in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2             # <<<<<<<<<<<<<<
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  *             else:
  */
           __pyx_t_25 = __pyx_v_s2;
@@ -10244,49 +9666,49 @@
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 480, __pyx_L1_error)
+            __PYX_ERR(0, 459, __pyx_L1_error)
           }
           __pyx_t_29 = __pyx_v_s2;
           __pyx_t_28 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_29 < 0) {
             __pyx_t_29 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_28 < 0) {
             __pyx_t_28 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 480, __pyx_L1_error)
+            __PYX_ERR(0, 459, __pyx_L1_error)
           }
           __pyx_t_18 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_19 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[0];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_refine_view.shape[1];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 480, __pyx_L1_error)
+            __PYX_ERR(0, 459, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_19 * __pyx_v_srcindexmap_refine_view.strides[1]) )) = __pyx_v_r2;
 
-          /* "fastrometry/cython_code/PSE.pyx":481
+          /* "fastrometry/cython_code/PSE.pyx":460
  *                 for s2 in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2             # <<<<<<<<<<<<<<
  *             else:
  *                 for s2 in range(kernelsize):
  */
           __pyx_t_28 = __pyx_v_s2;
@@ -10298,73 +9720,73 @@
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_29 < 0) {
             __pyx_t_29 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 481, __pyx_L1_error)
+            __PYX_ERR(0, 460, __pyx_L1_error)
           }
           __pyx_t_24 = __pyx_v_s2;
           __pyx_t_25 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 481, __pyx_L1_error)
+            __PYX_ERR(0, 460, __pyx_L1_error)
           }
           __pyx_t_19 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_18 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_initial_view.shape[0];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_initial_view.shape[1];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 481, __pyx_L1_error)
+            __PYX_ERR(0, 460, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_19 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_18 * __pyx_v_srcindexmap_initial_view.strides[1]) )) = __pyx_v_r2;
         }
 
-        /* "fastrometry/cython_code/PSE.pyx":478
+        /* "fastrometry/cython_code/PSE.pyx":457
  *             prevx = int(pse_metadata_view[r2,0])
  *             prevy = int(pse_metadata_view[r2,1])
  *             if r2 < npts:             # <<<<<<<<<<<<<<
  *                 for s2 in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  */
         goto __pyx_L48;
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":483
+      /* "fastrometry/cython_code/PSE.pyx":462
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  *             else:
  *                 for s2 in range(kernelsize):             # <<<<<<<<<<<<<<
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  * 
  */
       /*else*/ {
         __pyx_t_20 = __pyx_v_kernelsize;
         __pyx_t_21 = __pyx_t_20;
         for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_21; __pyx_t_14+=1) {
           __pyx_v_s2 = __pyx_t_14;
 
-          /* "fastrometry/cython_code/PSE.pyx":484
+          /* "fastrometry/cython_code/PSE.pyx":463
  *             else:
  *                 for s2 in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2             # <<<<<<<<<<<<<<
  * 
  *             findCentroids(prevx,prevy,kernelrad,img_view,bgmap_view[prevy-1,prevx-1],cntdresults_view)
  */
           __pyx_t_25 = __pyx_v_s2;
@@ -10376,52 +9798,52 @@
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 484, __pyx_L1_error)
+            __PYX_ERR(0, 463, __pyx_L1_error)
           }
           __pyx_t_29 = __pyx_v_s2;
           __pyx_t_28 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_29 < 0) {
             __pyx_t_29 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_28 < 0) {
             __pyx_t_28 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 484, __pyx_L1_error)
+            __PYX_ERR(0, 463, __pyx_L1_error)
           }
           __pyx_t_18 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_19 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[0];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_refine_view.shape[1];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 484, __pyx_L1_error)
+            __PYX_ERR(0, 463, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_19 * __pyx_v_srcindexmap_refine_view.strides[1]) )) = __pyx_v_r2;
         }
       }
       __pyx_L48:;
 
-      /* "fastrometry/cython_code/PSE.pyx":486
+      /* "fastrometry/cython_code/PSE.pyx":465
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[s2,1])-1,(prevx+kernelcircle_view[s2,0])-1] = r2
  * 
  *             findCentroids(prevx,prevy,kernelrad,img_view,bgmap_view[prevy-1,prevx-1],cntdresults_view)             # <<<<<<<<<<<<<<
  *             pse_metadata_view[r2,0] = cntdresults_view[0]   #x centroid
  *             pse_metadata_view[r2,1] = cntdresults_view[1]   #y centroid
  */
       __pyx_t_28 = (__pyx_v_prevy - 1);
@@ -10433,246 +9855,246 @@
       } else if (unlikely(__pyx_t_28 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_29 < 0) {
         __pyx_t_29 += __pyx_v_bgmap_view.shape[1];
         if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_29 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 486, __pyx_L1_error)
+        __PYX_ERR(0, 465, __pyx_L1_error)
       }
-      __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3PSE_findCentroids(__pyx_v_prevx, __pyx_v_prevy, __pyx_v_kernelrad, __pyx_v_img_view, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_28 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_29 * __pyx_v_bgmap_view.strides[1]) ))), __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)
+      __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3PSE_findCentroids(__pyx_v_prevx, __pyx_v_prevy, __pyx_v_kernelrad, __pyx_v_img_view, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_28 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_29 * __pyx_v_bgmap_view.strides[1]) ))), __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 465, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":487
+      /* "fastrometry/cython_code/PSE.pyx":466
  * 
  *             findCentroids(prevx,prevy,kernelrad,img_view,bgmap_view[prevy-1,prevx-1],cntdresults_view)
  *             pse_metadata_view[r2,0] = cntdresults_view[0]   #x centroid             # <<<<<<<<<<<<<<
  *             pse_metadata_view[r2,1] = cntdresults_view[1]   #y centroid
  * 
  */
       __pyx_t_29 = 0;
       __pyx_t_20 = -1;
       if (__pyx_t_29 < 0) {
         __pyx_t_29 += __pyx_v_cntdresults_view.shape[0];
         if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_29 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_20 = 0;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 487, __pyx_L1_error)
+        __PYX_ERR(0, 466, __pyx_L1_error)
       }
       __pyx_t_28 = __pyx_v_r2;
       __pyx_t_24 = 0;
       __pyx_t_20 = -1;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[0];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 487, __pyx_L1_error)
+        __PYX_ERR(0, 466, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_29 * __pyx_v_cntdresults_view.strides[0]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":488
+      /* "fastrometry/cython_code/PSE.pyx":467
  *             findCentroids(prevx,prevy,kernelrad,img_view,bgmap_view[prevy-1,prevx-1],cntdresults_view)
  *             pse_metadata_view[r2,0] = cntdresults_view[0]   #x centroid
  *             pse_metadata_view[r2,1] = cntdresults_view[1]   #y centroid             # <<<<<<<<<<<<<<
  * 
  *     elif curr_src_ind >= nrefinepts:
  */
       __pyx_t_29 = 1;
       __pyx_t_20 = -1;
       if (__pyx_t_29 < 0) {
         __pyx_t_29 += __pyx_v_cntdresults_view.shape[0];
         if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_29 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_20 = 0;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 488, __pyx_L1_error)
+        __PYX_ERR(0, 467, __pyx_L1_error)
       }
       __pyx_t_24 = __pyx_v_r2;
       __pyx_t_28 = 1;
       __pyx_t_20 = -1;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_pse_metadata_view.shape[0];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 488, __pyx_L1_error)
+        __PYX_ERR(0, 467, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_24 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_29 * __pyx_v_cntdresults_view.strides[0]) )));
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":446
+    /* "fastrometry/cython_code/PSE.pyx":425
  *         np.savetxt(debug_report/"pse_metadata_allsources.csv", pse_metadata, delimiter=",")
  * 
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         ###If max_iters iterations have been performed and we still don't have nrefinepts sources,
  *         ###we just have to take what we have and do all the heavy calculations for those now.
  */
     goto __pyx_L35;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":490
+  /* "fastrometry/cython_code/PSE.pyx":469
  *             pse_metadata_view[r2,1] = cntdresults_view[1]   #y centroid
  * 
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  * 
  *         if verbosity == 2:
  */
   __pyx_t_8 = ((__pyx_v_curr_src_ind >= __pyx_v_nrefinepts) != 0);
   if (__pyx_t_8) {
 
-    /* "fastrometry/cython_code/PSE.pyx":492
+    /* "fastrometry/cython_code/PSE.pyx":471
  *     elif curr_src_ind >= nrefinepts:
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | done")
  * 
  */
     __pyx_t_8 = ((__pyx_v_verbosity == 2) != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":493
+      /* "fastrometry/cython_code/PSE.pyx":472
  * 
  *         if verbosity == 2:
  *             print("| | done")             # <<<<<<<<<<<<<<
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 493, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 472, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":492
+      /* "fastrometry/cython_code/PSE.pyx":471
  *     elif curr_src_ind >= nrefinepts:
  * 
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | done")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":495
+    /* "fastrometry/cython_code/PSE.pyx":474
  *             print("| | done")
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness             # <<<<<<<<<<<<<<
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_tuple__7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argsort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argsort); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_6);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_slice__8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 474, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_pse_metadata_sorted = __pyx_t_4;
     __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":496
+    /* "fastrometry/cython_code/PSE.pyx":475
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]   ###sort pse_metadata by brightness
  *         pse_metadata[:] = pse_metadata_sorted             # <<<<<<<<<<<<<<
  * 
  *         if debug:
  */
-    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__10, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 496, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_pse_metadata), __pyx_slice__6, __pyx_v_pse_metadata_sorted) < 0)) __PYX_ERR(0, 475, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":498
+    /* "fastrometry/cython_code/PSE.pyx":477
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  * 
  */
     __pyx_t_8 = (__pyx_v_debug != 0);
     if (__pyx_t_8) {
 
-      /* "fastrometry/cython_code/PSE.pyx":499
+      /* "fastrometry/cython_code/PSE.pyx":478
  * 
  *         if debug:
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *         ###If we have nrefinepts or more sources, we have already calculated kernel sums for
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_c); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_allsources_sorted_c); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
       __Pyx_INCREF(((PyObject *)__pyx_v_pse_metadata));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_pse_metadata));
       PyTuple_SET_ITEM(__pyx_t_3, 1, ((PyObject *)__pyx_v_pse_metadata));
       __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 499, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 499, __pyx_L1_error)
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 478, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 478, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":498
+      /* "fastrometry/cython_code/PSE.pyx":477
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  *         if debug:             # <<<<<<<<<<<<<<
  *             np.savetxt(debug_report/"pse_metadata_allsources_sorted.csv", pse_metadata, delimiter=",")
  * 
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":505
+    /* "fastrometry/cython_code/PSE.pyx":484
  *         ###the kernels in the srcindexmap and finding centroids
  * 
  *         for t in range(num_islands,nrefinepts):             # <<<<<<<<<<<<<<
  *             prevx = int(pse_metadata_view[t,0])
  *             prevy = int(pse_metadata_view[t,1])
  */
     __pyx_t_9 = __pyx_v_nrefinepts;
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = __pyx_v_num_islands; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_t = __pyx_t_11;
 
-      /* "fastrometry/cython_code/PSE.pyx":506
+      /* "fastrometry/cython_code/PSE.pyx":485
  * 
  *         for t in range(num_islands,nrefinepts):
  *             prevx = int(pse_metadata_view[t,0])             # <<<<<<<<<<<<<<
  *             prevy = int(pse_metadata_view[t,1])
  *             if t < npts:
  */
       __pyx_t_29 = __pyx_v_t;
@@ -10684,19 +10106,19 @@
       } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 506, __pyx_L1_error)
+        __PYX_ERR(0, 485, __pyx_L1_error)
       }
       __pyx_v_prevx = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":507
+      /* "fastrometry/cython_code/PSE.pyx":486
  *         for t in range(num_islands,nrefinepts):
  *             prevx = int(pse_metadata_view[t,0])
  *             prevy = int(pse_metadata_view[t,1])             # <<<<<<<<<<<<<<
  *             if t < npts:
  *                 for u in range(kernelsize):
  */
       __pyx_t_28 = __pyx_v_t;
@@ -10708,41 +10130,41 @@
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_29 < 0) {
         __pyx_t_29 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_29 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_29 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 507, __pyx_L1_error)
+        __PYX_ERR(0, 486, __pyx_L1_error)
       }
       __pyx_v_prevy = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_29 * __pyx_v_pse_metadata_view.strides[1]) ))));
 
-      /* "fastrometry/cython_code/PSE.pyx":508
+      /* "fastrometry/cython_code/PSE.pyx":487
  *             prevx = int(pse_metadata_view[t,0])
  *             prevy = int(pse_metadata_view[t,1])
  *             if t < npts:             # <<<<<<<<<<<<<<
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  */
       __pyx_t_8 = ((__pyx_v_t < __pyx_v_npts) != 0);
       if (__pyx_t_8) {
 
-        /* "fastrometry/cython_code/PSE.pyx":509
+        /* "fastrometry/cython_code/PSE.pyx":488
  *             prevy = int(pse_metadata_view[t,1])
  *             if t < npts:
  *                 for u in range(kernelsize):             # <<<<<<<<<<<<<<
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  */
         __pyx_t_20 = __pyx_v_kernelsize;
         __pyx_t_21 = __pyx_t_20;
         for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_21; __pyx_t_14+=1) {
           __pyx_v_u = __pyx_t_14;
 
-          /* "fastrometry/cython_code/PSE.pyx":510
+          /* "fastrometry/cython_code/PSE.pyx":489
  *             if t < npts:
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t             # <<<<<<<<<<<<<<
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *             else:
  */
           __pyx_t_29 = __pyx_v_u;
@@ -10754,49 +10176,49 @@
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_28 < 0) {
             __pyx_t_28 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 510, __pyx_L1_error)
+            __PYX_ERR(0, 489, __pyx_L1_error)
           }
           __pyx_t_24 = __pyx_v_u;
           __pyx_t_25 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 510, __pyx_L1_error)
+            __PYX_ERR(0, 489, __pyx_L1_error)
           }
           __pyx_t_19 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_18 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_refine_view.shape[0];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[1];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 510, __pyx_L1_error)
+            __PYX_ERR(0, 489, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_19 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[1]) )) = __pyx_v_t;
 
-          /* "fastrometry/cython_code/PSE.pyx":511
+          /* "fastrometry/cython_code/PSE.pyx":490
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t             # <<<<<<<<<<<<<<
  *             else:
  *                 for u in range(kernelsize):
  */
           __pyx_t_25 = __pyx_v_u;
@@ -10808,73 +10230,73 @@
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 511, __pyx_L1_error)
+            __PYX_ERR(0, 490, __pyx_L1_error)
           }
           __pyx_t_28 = __pyx_v_u;
           __pyx_t_29 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_28 < 0) {
             __pyx_t_28 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_29 < 0) {
             __pyx_t_29 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_29 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 511, __pyx_L1_error)
+            __PYX_ERR(0, 490, __pyx_L1_error)
           }
           __pyx_t_18 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_19 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_initial_view.shape[0];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_initial_view.shape[1];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 511, __pyx_L1_error)
+            __PYX_ERR(0, 490, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_18 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_19 * __pyx_v_srcindexmap_initial_view.strides[1]) )) = __pyx_v_t;
         }
 
-        /* "fastrometry/cython_code/PSE.pyx":508
+        /* "fastrometry/cython_code/PSE.pyx":487
  *             prevx = int(pse_metadata_view[t,0])
  *             prevy = int(pse_metadata_view[t,1])
  *             if t < npts:             # <<<<<<<<<<<<<<
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  */
         goto __pyx_L57;
       }
 
-      /* "fastrometry/cython_code/PSE.pyx":513
+      /* "fastrometry/cython_code/PSE.pyx":492
  *                     srcindexmap_initial_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *             else:
  *                 for u in range(kernelsize):             # <<<<<<<<<<<<<<
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *             findCentroids(prevx, prevy, kernelrad, img_view, bgmap_view[prevy-1,prevx-1], cntdresults_view)
  */
       /*else*/ {
         __pyx_t_20 = __pyx_v_kernelsize;
         __pyx_t_21 = __pyx_t_20;
         for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_21; __pyx_t_14+=1) {
           __pyx_v_u = __pyx_t_14;
 
-          /* "fastrometry/cython_code/PSE.pyx":514
+          /* "fastrometry/cython_code/PSE.pyx":493
  *             else:
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t             # <<<<<<<<<<<<<<
  *             findCentroids(prevx, prevy, kernelrad, img_view, bgmap_view[prevy-1,prevx-1], cntdresults_view)
  *             pse_metadata_view[t,0] = cntdresults_view[0]   #x centroid
  */
           __pyx_t_29 = __pyx_v_u;
@@ -10886,52 +10308,52 @@
           } else if (unlikely(__pyx_t_29 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_28 < 0) {
             __pyx_t_28 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_28 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_28 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 514, __pyx_L1_error)
+            __PYX_ERR(0, 493, __pyx_L1_error)
           }
           __pyx_t_24 = __pyx_v_u;
           __pyx_t_25 = 0;
           __pyx_t_23 = -1;
           if (__pyx_t_24 < 0) {
             __pyx_t_24 += __pyx_v_kernelcircle_view.shape[0];
             if (unlikely(__pyx_t_24 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_24 >= __pyx_v_kernelcircle_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_kernelcircle_view.shape[1];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_kernelcircle_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 514, __pyx_L1_error)
+            __PYX_ERR(0, 493, __pyx_L1_error)
           }
           __pyx_t_19 = ((__pyx_v_prevy + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_29 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_18 = ((__pyx_v_prevx + (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_kernelcircle_view.data + __pyx_t_24 * __pyx_v_kernelcircle_view.strides[0]) ) + __pyx_t_25 * __pyx_v_kernelcircle_view.strides[1]) )))) - 1);
           __pyx_t_23 = -1;
           if (__pyx_t_19 < 0) {
             __pyx_t_19 += __pyx_v_srcindexmap_refine_view.shape[0];
             if (unlikely(__pyx_t_19 < 0)) __pyx_t_23 = 0;
           } else if (unlikely(__pyx_t_19 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_23 = 0;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[1];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_23 = 1;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_23 = 1;
           if (unlikely(__pyx_t_23 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_23);
-            __PYX_ERR(0, 514, __pyx_L1_error)
+            __PYX_ERR(0, 493, __pyx_L1_error)
           }
           *((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_19 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[1]) )) = __pyx_v_t;
         }
       }
       __pyx_L57:;
 
-      /* "fastrometry/cython_code/PSE.pyx":515
+      /* "fastrometry/cython_code/PSE.pyx":494
  *                 for u in range(kernelsize):
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *             findCentroids(prevx, prevy, kernelrad, img_view, bgmap_view[prevy-1,prevx-1], cntdresults_view)             # <<<<<<<<<<<<<<
  *             pse_metadata_view[t,0] = cntdresults_view[0]   #x centroid
  *             pse_metadata_view[t,1] = cntdresults_view[1]   #y centroid
  */
       __pyx_t_25 = (__pyx_v_prevy - 1);
@@ -10943,110 +10365,110 @@
       } else if (unlikely(__pyx_t_25 >= __pyx_v_bgmap_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_bgmap_view.shape[1];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_bgmap_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 515, __pyx_L1_error)
+        __PYX_ERR(0, 494, __pyx_L1_error)
       }
-      __pyx_t_5 = __pyx_f_11fastrometry_11cython_code_3PSE_findCentroids(__pyx_v_prevx, __pyx_v_prevy, __pyx_v_kernelrad, __pyx_v_img_view, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_25 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_24 * __pyx_v_bgmap_view.strides[1]) ))), __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 515, __pyx_L1_error)
+      __pyx_t_5 = __pyx_f_11fastrometry_11cython_code_3PSE_findCentroids(__pyx_v_prevx, __pyx_v_prevy, __pyx_v_kernelrad, __pyx_v_img_view, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_bgmap_view.data + __pyx_t_25 * __pyx_v_bgmap_view.strides[0]) ) + __pyx_t_24 * __pyx_v_bgmap_view.strides[1]) ))), __pyx_v_cntdresults_view); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 494, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":516
+      /* "fastrometry/cython_code/PSE.pyx":495
  *                     srcindexmap_refine_view[(prevy+kernelcircle_view[u,1])-1,(prevx+kernelcircle_view[u,0])-1] = t
  *             findCentroids(prevx, prevy, kernelrad, img_view, bgmap_view[prevy-1,prevx-1], cntdresults_view)
  *             pse_metadata_view[t,0] = cntdresults_view[0]   #x centroid             # <<<<<<<<<<<<<<
  *             pse_metadata_view[t,1] = cntdresults_view[1]   #y centroid
  * 
  */
       __pyx_t_24 = 0;
       __pyx_t_20 = -1;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_cntdresults_view.shape[0];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_20 = 0;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 516, __pyx_L1_error)
+        __PYX_ERR(0, 495, __pyx_L1_error)
       }
       __pyx_t_25 = __pyx_v_t;
       __pyx_t_28 = 0;
       __pyx_t_20 = -1;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_pse_metadata_view.shape[0];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 516, __pyx_L1_error)
+        __PYX_ERR(0, 495, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_24 * __pyx_v_cntdresults_view.strides[0]) )));
 
-      /* "fastrometry/cython_code/PSE.pyx":517
+      /* "fastrometry/cython_code/PSE.pyx":496
  *             findCentroids(prevx, prevy, kernelrad, img_view, bgmap_view[prevy-1,prevx-1], cntdresults_view)
  *             pse_metadata_view[t,0] = cntdresults_view[0]   #x centroid
  *             pse_metadata_view[t,1] = cntdresults_view[1]   #y centroid             # <<<<<<<<<<<<<<
  * 
  *     return curr_src_ind
  */
       __pyx_t_24 = 1;
       __pyx_t_20 = -1;
       if (__pyx_t_24 < 0) {
         __pyx_t_24 += __pyx_v_cntdresults_view.shape[0];
         if (unlikely(__pyx_t_24 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_24 >= __pyx_v_cntdresults_view.shape[0])) __pyx_t_20 = 0;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 517, __pyx_L1_error)
+        __PYX_ERR(0, 496, __pyx_L1_error)
       }
       __pyx_t_28 = __pyx_v_t;
       __pyx_t_25 = 1;
       __pyx_t_20 = -1;
       if (__pyx_t_28 < 0) {
         __pyx_t_28 += __pyx_v_pse_metadata_view.shape[0];
         if (unlikely(__pyx_t_28 < 0)) __pyx_t_20 = 0;
       } else if (unlikely(__pyx_t_28 >= __pyx_v_pse_metadata_view.shape[0])) __pyx_t_20 = 0;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_pse_metadata_view.shape[1];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_20 = 1;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_pse_metadata_view.shape[1])) __pyx_t_20 = 1;
       if (unlikely(__pyx_t_20 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_20);
-        __PYX_ERR(0, 517, __pyx_L1_error)
+        __PYX_ERR(0, 496, __pyx_L1_error)
       }
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pse_metadata_view.data + __pyx_t_28 * __pyx_v_pse_metadata_view.strides[0]) ) + __pyx_t_25 * __pyx_v_pse_metadata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_cntdresults_view.data + __pyx_t_24 * __pyx_v_cntdresults_view.strides[0]) )));
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":490
+    /* "fastrometry/cython_code/PSE.pyx":469
  *             pse_metadata_view[r2,1] = cntdresults_view[1]   #y centroid
  * 
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  * 
  *         if verbosity == 2:
  */
   }
   __pyx_L35:;
 
-  /* "fastrometry/cython_code/PSE.pyx":519
+  /* "fastrometry/cython_code/PSE.pyx":498
  *             pse_metadata_view[t,1] = cntdresults_view[1]   #y centroid
  * 
  *     return curr_src_ind             # <<<<<<<<<<<<<<
  * 
- * @printEvent("Extracting sources from image...", "done", 1)
+ * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
  */
   __pyx_r = __pyx_v_curr_src_ind;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/PSE.pyx":314
+  /* "fastrometry/cython_code/PSE.pyx":293
  * 
  * 
  * cdef int mapRemainingSources(double[:,:] img_view, int img_xmax, int img_ymax, double img_max, double img_median, int leftmostsafe_x, int rightmostsafe_x, int topmostsafe_y, int bottommostsafe_y, int[:,:] roi_view, np.ndarray[ndim=2,dtype=np.double_t] pse_metadata, double[:,:] bgmap_view, int[:,:] srcindexmap_initial_view, int[:,:] srcindexmap_refine_view, int[:,:] occupymap_view, int kernelrad, int[:,:] kernelcircle_view, int kernelsize, int sourcesep, int[:,:] sourcesepcircle_view, int sourcesepsize, int npts, int nrefinepts, int curr_src_ind, debug_report, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -11076,26 +10498,26 @@
   __Pyx_XDECREF(__pyx_v_pse_metadata_sorted);
   __Pyx_XDECREF(__pyx_v_num_zeros);
   __Pyx_XDECREF(__pyx_v_rr);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/PSE.pyx":522
+/* "fastrometry/cython_code/PSE.pyx":500
+ *     return curr_src_ind
  * 
- * @printEvent("Extracting sources from image...", "done", 1)
  * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):             # <<<<<<<<<<<<<<
  * 
- *     num_psesources = 0
+ *     if verbosity >= 1:
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_5PSE(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_5PSE = {"PSE", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_5PSE, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_5PSE(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_3PSE(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3PSE_3PSE = {"PSE", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3PSE_3PSE, METH_VARARGS|METH_KEYWORDS, 0};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3PSE_3PSE(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_img = 0;
   PyObject *__pyx_v_img_xmax = 0;
   PyObject *__pyx_v_img_ymax = 0;
   PyObject *__pyx_v_kernelrad = 0;
   PyObject *__pyx_v_sourcesep = 0;
   PyObject *__pyx_v_pixsat = 0;
   PyObject *__pyx_v_npts = 0;
@@ -11164,109 +10586,109 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img_xmax)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 1); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 1); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img_ymax)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 2); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 2); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kernelrad)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 3); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 3); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_sourcesep)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 4); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 4); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pixsat)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 5); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 5); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_npts)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 6); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 6); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_nrefinepts)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 7); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 7); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pixelradius)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 8); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 8); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_shape)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 9); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 9); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 10:
         if (likely((values[10] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_srcindexmap_initial)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 10); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 10); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 11:
         if (likely((values[11] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_srcindexmap_refine)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 11); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 11); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 12:
         if (likely((values[12] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pse_metadata)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 12); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 12); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 13:
         if (likely((values[13] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_debug_report)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 13); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 13); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 14:
         if (likely((values[14] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filepath)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 14); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 14); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 15:
         if (likely((values[15] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_debug)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 15); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 15); __PYX_ERR(0, 500, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 16:
         if (likely((values[16] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_verbosity)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 16); __PYX_ERR(0, 522, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, 16); __PYX_ERR(0, 500, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "PSE") < 0)) __PYX_ERR(0, 522, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "PSE") < 0)) __PYX_ERR(0, 500, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 17) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -11301,28 +10723,28 @@
     __pyx_v_debug_report = values[13];
     __pyx_v_filepath = values[14];
     __pyx_v_debug = values[15];
     __pyx_v_verbosity = values[16];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 522, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("PSE", 1, 17, 17, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 500, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.PSE.PSE", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_4PSE(__pyx_self, __pyx_v_img, __pyx_v_img_xmax, __pyx_v_img_ymax, __pyx_v_kernelrad, __pyx_v_sourcesep, __pyx_v_pixsat, __pyx_v_npts, __pyx_v_nrefinepts, __pyx_v_pixelradius, __pyx_v_shape, __pyx_v_srcindexmap_initial, __pyx_v_srcindexmap_refine, __pyx_v_pse_metadata, __pyx_v_debug_report, __pyx_v_filepath, __pyx_v_debug, __pyx_v_verbosity);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3PSE_2PSE(__pyx_self, __pyx_v_img, __pyx_v_img_xmax, __pyx_v_img_ymax, __pyx_v_kernelrad, __pyx_v_sourcesep, __pyx_v_pixsat, __pyx_v_npts, __pyx_v_nrefinepts, __pyx_v_pixelradius, __pyx_v_shape, __pyx_v_srcindexmap_initial, __pyx_v_srcindexmap_refine, __pyx_v_pse_metadata, __pyx_v_debug_report, __pyx_v_filepath, __pyx_v_debug, __pyx_v_verbosity);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_4PSE(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_kernelrad, PyObject *__pyx_v_sourcesep, PyObject *__pyx_v_pixsat, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_pixelradius, PyObject *__pyx_v_shape, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3PSE_2PSE(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_img, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_kernelrad, PyObject *__pyx_v_sourcesep, PyObject *__pyx_v_pixsat, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_pixelradius, PyObject *__pyx_v_shape, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity) {
   PyObject *__pyx_v_num_psesources = NULL;
   PyObject *__pyx_v_leftmostsafe_x = NULL;
   PyObject *__pyx_v_rightmostsafe_x = NULL;
   PyObject *__pyx_v_topmostsafe_y = NULL;
   PyObject *__pyx_v_bottommostsafe_y = NULL;
   PyObject *__pyx_v_roi = NULL;
   PyObject *__pyx_v_colors = NULL;
@@ -11339,18 +10761,18 @@
   PyObject *__pyx_v_LogNorm = NULL;
   PyObject *__pyx_v_fits = NULL;
   PyObject *__pyx_v_image_data = NULL;
   PyObject *__pyx_v_dscrp = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
-  PyObject *__pyx_t_2 = NULL;
+  int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
-  int __pyx_t_5;
+  PyObject *__pyx_t_5 = NULL;
   __Pyx_memviewslice __pyx_t_6 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
   PyObject *__pyx_t_10 = NULL;
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_12 = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -11372,545 +10794,575 @@
   __Pyx_memviewslice __pyx_t_28 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_t_29;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("PSE", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":524
+  /* "fastrometry/cython_code/PSE.pyx":502
  * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
  * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("Extracting sources from image...")
+ * 
+ */
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 502, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (__pyx_t_2) {
+
+    /* "fastrometry/cython_code/PSE.pyx":503
+ * 
+ *     if verbosity >= 1:
+ *         print("Extracting sources from image...")             # <<<<<<<<<<<<<<
+ * 
+ *     num_psesources = 0
+ */
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Extracting_sources_from_image) < 0) __PYX_ERR(0, 503, __pyx_L1_error)
+
+    /* "fastrometry/cython_code/PSE.pyx":502
+ * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
+ * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("Extracting sources from image...")
+ * 
+ */
+  }
+
+  /* "fastrometry/cython_code/PSE.pyx":505
+ *         print("Extracting sources from image...")
+ * 
  *     num_psesources = 0             # <<<<<<<<<<<<<<
  * 
  *     leftmostsafe_x = 1 + sourcesep
  */
   __Pyx_INCREF(__pyx_int_0);
   __pyx_v_num_psesources = __pyx_int_0;
 
-  /* "fastrometry/cython_code/PSE.pyx":526
+  /* "fastrometry/cython_code/PSE.pyx":507
  *     num_psesources = 0
  * 
  *     leftmostsafe_x = 1 + sourcesep             # <<<<<<<<<<<<<<
  *     rightmostsafe_x = img_xmax - sourcesep
  *     topmostsafe_y = 1 + sourcesep
  */
-  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_sourcesep, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_sourcesep, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_leftmostsafe_x = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":527
+  /* "fastrometry/cython_code/PSE.pyx":508
  * 
  *     leftmostsafe_x = 1 + sourcesep
  *     rightmostsafe_x = img_xmax - sourcesep             # <<<<<<<<<<<<<<
  *     topmostsafe_y = 1 + sourcesep
  *     bottommostsafe_y = img_ymax - sourcesep
  */
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_img_xmax, __pyx_v_sourcesep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 527, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_img_xmax, __pyx_v_sourcesep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_rightmostsafe_x = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":528
+  /* "fastrometry/cython_code/PSE.pyx":509
  *     leftmostsafe_x = 1 + sourcesep
  *     rightmostsafe_x = img_xmax - sourcesep
  *     topmostsafe_y = 1 + sourcesep             # <<<<<<<<<<<<<<
  *     bottommostsafe_y = img_ymax - sourcesep
  *     roi = np.ones((img_ymax,img_xmax),dtype=int)
  */
-  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_sourcesep, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 528, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_sourcesep, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 509, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_topmostsafe_y = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":529
+  /* "fastrometry/cython_code/PSE.pyx":510
  *     rightmostsafe_x = img_xmax - sourcesep
  *     topmostsafe_y = 1 + sourcesep
  *     bottommostsafe_y = img_ymax - sourcesep             # <<<<<<<<<<<<<<
  *     roi = np.ones((img_ymax,img_xmax),dtype=int)
  * 
  */
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_img_ymax, __pyx_v_sourcesep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_img_ymax, __pyx_v_sourcesep); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_bottommostsafe_y = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":530
+  /* "fastrometry/cython_code/PSE.pyx":511
  *     topmostsafe_y = 1 + sourcesep
  *     bottommostsafe_y = img_ymax - sourcesep
  *     roi = np.ones((img_ymax,img_xmax),dtype=int)             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 530, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_img_ymax);
   __Pyx_GIVEREF(__pyx_v_img_ymax);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_img_ymax);
   __Pyx_INCREF(__pyx_v_img_xmax);
   __Pyx_GIVEREF(__pyx_v_img_xmax);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_img_xmax);
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 530, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 530, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 530, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 530, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 511, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 511, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_roi = __pyx_t_4;
-  __pyx_t_4 = 0;
+  __pyx_v_roi = __pyx_t_5;
+  __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":532
+  /* "fastrometry/cython_code/PSE.pyx":513
  *     roi = np.ones((img_ymax,img_xmax),dtype=int)
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Creating ROI map...")
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  */
-  __pyx_t_4 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 532, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 532, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__pyx_t_5) {
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 513, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":533
+    /* "fastrometry/cython_code/PSE.pyx":514
  * 
  *     if verbosity == 2:
  *         print("| Creating ROI map...")             # <<<<<<<<<<<<<<
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  *     if verbosity == 2:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Creating_ROI_map) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Creating_ROI_map) < 0) __PYX_ERR(0, 514, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":532
+    /* "fastrometry/cython_code/PSE.pyx":513
  *     roi = np.ones((img_ymax,img_xmax),dtype=int)
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Creating ROI map...")
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":534
+  /* "fastrometry/cython_code/PSE.pyx":515
  *     if verbosity == 2:
  *         print("| Creating ROI map...")
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)             # <<<<<<<<<<<<<<
  *     if verbosity == 2:
  *         print("| done")
  */
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 534, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 534, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 534, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_pixelradius); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 534, __pyx_L1_error)
-  if (!(likely(PyString_CheckExact(__pyx_v_shape))||((__pyx_v_shape) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_shape)->tp_name), 0))) __PYX_ERR(0, 534, __pyx_L1_error)
-  __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3PSE_createROI(__pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, ((PyObject*)__pyx_v_shape)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 534, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_pixelradius); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 515, __pyx_L1_error)
+  if (!(likely(PyString_CheckExact(__pyx_v_shape))||((__pyx_v_shape) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "str", Py_TYPE(__pyx_v_shape)->tp_name), 0))) __PYX_ERR(0, 515, __pyx_L1_error)
+  __pyx_t_5 = __pyx_f_11fastrometry_11cython_code_3PSE_createROI(__pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, ((PyObject*)__pyx_v_shape)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 515, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
   __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":535
+  /* "fastrometry/cython_code/PSE.pyx":516
  *         print("| Creating ROI map...")
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| done")
  *     if debug:
  */
-  __pyx_t_4 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 535, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 535, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__pyx_t_5) {
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 516, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":536
+    /* "fastrometry/cython_code/PSE.pyx":517
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  *     if verbosity == 2:
  *         print("| done")             # <<<<<<<<<<<<<<
  *     if debug:
  *         if shape == 'rectangle':
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 517, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":535
+    /* "fastrometry/cython_code/PSE.pyx":516
  *         print("| Creating ROI map...")
  *     createROI(roi, img_xmax, img_ymax, pixelradius, shape)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| done")
  *     if debug:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":537
+  /* "fastrometry/cython_code/PSE.pyx":518
  *     if verbosity == 2:
  *         print("| done")
  *     if debug:             # <<<<<<<<<<<<<<
  *         if shape == 'rectangle':
  *             colors = (['gold'])
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 537, __pyx_L1_error)
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 518, __pyx_L1_error)
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":538
+    /* "fastrometry/cython_code/PSE.pyx":519
  *         print("| done")
  *     if debug:
  *         if shape == 'rectangle':             # <<<<<<<<<<<<<<
  *             colors = (['gold'])
  *         elif shape == 'circle':
  */
-    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_rectangle, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_rectangle, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 519, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":539
+      /* "fastrometry/cython_code/PSE.pyx":520
  *     if debug:
  *         if shape == 'rectangle':
  *             colors = (['gold'])             # <<<<<<<<<<<<<<
  *         elif shape == 'circle':
  *             colors = (['navy','gold'])
  */
-      __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 539, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_n_s_gold);
       __Pyx_GIVEREF(__pyx_n_s_gold);
-      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_gold);
-      __pyx_v_colors = ((PyObject*)__pyx_t_4);
-      __pyx_t_4 = 0;
+      PyList_SET_ITEM(__pyx_t_5, 0, __pyx_n_s_gold);
+      __pyx_v_colors = ((PyObject*)__pyx_t_5);
+      __pyx_t_5 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":538
+      /* "fastrometry/cython_code/PSE.pyx":519
  *         print("| done")
  *     if debug:
  *         if shape == 'rectangle':             # <<<<<<<<<<<<<<
  *             colors = (['gold'])
  *         elif shape == 'circle':
  */
-      goto __pyx_L6;
+      goto __pyx_L7;
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":540
+    /* "fastrometry/cython_code/PSE.pyx":521
  *         if shape == 'rectangle':
  *             colors = (['gold'])
  *         elif shape == 'circle':             # <<<<<<<<<<<<<<
  *             colors = (['navy','gold'])
  *         debuggerPlot(roi, debug_report, "ROI.png", title="ROI", dscrp="Region to be scanned by PSE. Specified by the options shape and buffer.", colors=colors, boundaries=[0,1,2])
  */
-    __pyx_t_5 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_circle, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 540, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = (__Pyx_PyString_Equals(__pyx_v_shape, __pyx_n_s_circle, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 521, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":541
+      /* "fastrometry/cython_code/PSE.pyx":522
  *             colors = (['gold'])
  *         elif shape == 'circle':
  *             colors = (['navy','gold'])             # <<<<<<<<<<<<<<
  *         debuggerPlot(roi, debug_report, "ROI.png", title="ROI", dscrp="Region to be scanned by PSE. Specified by the options shape and buffer.", colors=colors, boundaries=[0,1,2])
  * 
  */
-      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 541, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyList_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 522, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_n_s_navy);
       __Pyx_GIVEREF(__pyx_n_s_navy);
-      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_navy);
+      PyList_SET_ITEM(__pyx_t_5, 0, __pyx_n_s_navy);
       __Pyx_INCREF(__pyx_n_s_gold);
       __Pyx_GIVEREF(__pyx_n_s_gold);
-      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_n_s_gold);
-      __pyx_v_colors = ((PyObject*)__pyx_t_4);
-      __pyx_t_4 = 0;
+      PyList_SET_ITEM(__pyx_t_5, 1, __pyx_n_s_gold);
+      __pyx_v_colors = ((PyObject*)__pyx_t_5);
+      __pyx_t_5 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":540
+      /* "fastrometry/cython_code/PSE.pyx":521
  *         if shape == 'rectangle':
  *             colors = (['gold'])
  *         elif shape == 'circle':             # <<<<<<<<<<<<<<
  *             colors = (['navy','gold'])
  *         debuggerPlot(roi, debug_report, "ROI.png", title="ROI", dscrp="Region to be scanned by PSE. Specified by the options shape and buffer.", colors=colors, boundaries=[0,1,2])
  */
     }
-    __pyx_L6:;
+    __pyx_L7:;
 
-    /* "fastrometry/cython_code/PSE.pyx":542
+    /* "fastrometry/cython_code/PSE.pyx":523
  *         elif shape == 'circle':
  *             colors = (['navy','gold'])
  *         debuggerPlot(roi, debug_report, "ROI.png", title="ROI", dscrp="Region to be scanned by PSE. Specified by the options shape and buffer.", colors=colors, boundaries=[0,1,2])             # <<<<<<<<<<<<<<
  * 
  *     bgmap = np.zeros((img_ymax,img_xmax),dtype=np.double)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 542, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 523, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_roi);
     __Pyx_GIVEREF(__pyx_v_roi);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_roi);
     __Pyx_INCREF(__pyx_v_debug_report);
     __Pyx_GIVEREF(__pyx_v_debug_report);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_debug_report);
     __Pyx_INCREF(__pyx_kp_s_ROI_png);
     __Pyx_GIVEREF(__pyx_kp_s_ROI_png);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_s_ROI_png);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_title, __pyx_n_s_ROI) < 0) __PYX_ERR(0, 523, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dscrp, __pyx_kp_s_Region_to_be_scanned_by_PSE_Spec) < 0) __PYX_ERR(0, 523, __pyx_L1_error)
+    if (unlikely(!__pyx_v_colors)) { __Pyx_RaiseUnboundLocalError("colors"); __PYX_ERR(0, 523, __pyx_L1_error) }
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_colors, __pyx_v_colors) < 0) __PYX_ERR(0, 523, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_title, __pyx_n_s_ROI) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dscrp, __pyx_kp_s_Region_to_be_scanned_by_PSE_Spec) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
-    if (unlikely(!__pyx_v_colors)) { __Pyx_RaiseUnboundLocalError("colors"); __PYX_ERR(0, 542, __pyx_L1_error) }
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_colors, __pyx_v_colors) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
-    __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 542, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
-    PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_0);
+    PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_0);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
-    PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_1);
+    PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_1);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
-    PyList_SET_ITEM(__pyx_t_2, 2, __pyx_int_2);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_boundaries, __pyx_t_2) < 0) __PYX_ERR(0, 542, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 542, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    PyList_SET_ITEM(__pyx_t_3, 2, __pyx_int_2);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_boundaries, __pyx_t_3) < 0) __PYX_ERR(0, 523, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 523, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":537
+    /* "fastrometry/cython_code/PSE.pyx":518
  *     if verbosity == 2:
  *         print("| done")
  *     if debug:             # <<<<<<<<<<<<<<
  *         if shape == 'rectangle':
  *             colors = (['gold'])
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":544
+  /* "fastrometry/cython_code/PSE.pyx":525
  *         debuggerPlot(roi, debug_report, "ROI.png", title="ROI", dscrp="Region to be scanned by PSE. Specified by the options shape and buffer.", colors=colors, boundaries=[0,1,2])
  * 
  *     bgmap = np.zeros((img_ymax,img_xmax),dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 544, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 525, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 544, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_img_ymax);
   __Pyx_GIVEREF(__pyx_v_img_ymax);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_img_ymax);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_img_ymax);
   __Pyx_INCREF(__pyx_v_img_xmax);
   __Pyx_GIVEREF(__pyx_v_img_xmax);
-  PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_img_xmax);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_img_xmax);
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 544, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 544, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_double); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
+  __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 525, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 525, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_5);
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_double); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 525, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 544, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 525, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 525, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_bgmap = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":546
+  /* "fastrometry/cython_code/PSE.pyx":527
  *     bgmap = np.zeros((img_ymax,img_xmax),dtype=np.double)
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Creating background map...")
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  */
-  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 546, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 527, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":547
+    /* "fastrometry/cython_code/PSE.pyx":528
  * 
  *     if verbosity == 2:
  *         print("| Creating background map...")             # <<<<<<<<<<<<<<
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  *     if verbosity == 2:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Creating_background_map) < 0) __PYX_ERR(0, 547, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Creating_background_map) < 0) __PYX_ERR(0, 528, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":546
+    /* "fastrometry/cython_code/PSE.pyx":527
  *     bgmap = np.zeros((img_ymax,img_xmax),dtype=np.double)
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Creating background map...")
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":548
+  /* "fastrometry/cython_code/PSE.pyx":529
  *     if verbosity == 2:
  *         print("| Creating background map...")
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)             # <<<<<<<<<<<<<<
  *     if verbosity == 2:
  *         print("| done")
  */
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_bgmap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
-  __pyx_t_10 = __pyx_f_11fastrometry_11cython_code_3PSE_fillBackgroundMap(__pyx_t_11, __pyx_t_12, __pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 548, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_bgmap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 529, __pyx_L1_error)
+  __pyx_t_10 = __pyx_f_11fastrometry_11cython_code_3PSE_fillBackgroundMap(__pyx_t_11, __pyx_t_12, __pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_t_16); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
   __pyx_t_11.memview = NULL;
   __pyx_t_11.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":549
+  /* "fastrometry/cython_code/PSE.pyx":530
  *         print("| Creating background map...")
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| done")
  *     if debug:
  */
-  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 549, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 530, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 549, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 530, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":550
+    /* "fastrometry/cython_code/PSE.pyx":531
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  *     if verbosity == 2:
  *         print("| done")             # <<<<<<<<<<<<<<
  *     if debug:
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 550, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 531, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":549
+    /* "fastrometry/cython_code/PSE.pyx":530
  *         print("| Creating background map...")
  *     fillBackgroundMap(bgmap, img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, sourcesep)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| done")
  *     if debug:
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":551
+  /* "fastrometry/cython_code/PSE.pyx":532
  *     if verbosity == 2:
  *         print("| done")
  *     if debug:             # <<<<<<<<<<<<<<
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 551, __pyx_L1_error)
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 532, __pyx_L1_error)
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":552
+    /* "fastrometry/cython_code/PSE.pyx":533
  *         print("| done")
  *     if debug:
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)             # <<<<<<<<<<<<<<
  * 
  *     curr_src_ind = 0
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_bgmap);
     __Pyx_GIVEREF(__pyx_v_bgmap);
-    PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_bgmap);
+    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_bgmap);
     __Pyx_INCREF(__pyx_v_debug_report);
     __Pyx_GIVEREF(__pyx_v_debug_report);
-    PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_debug_report);
+    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_debug_report);
     __Pyx_INCREF(__pyx_kp_s_bgmap_png);
     __Pyx_GIVEREF(__pyx_kp_s_bgmap_png);
-    PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_kp_s_bgmap_png);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
+    PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_s_bgmap_png);
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_figsize, __pyx_tuple__13) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_percentile); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 552, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_figsize, __pyx_tuple__9) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_5);
+    __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_percentile); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = NULL;
+    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+    __pyx_t_5 = NULL;
     __pyx_t_16 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_17))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_17);
-      if (likely(__pyx_t_4)) {
+      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_17);
+      if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_17);
-        __Pyx_INCREF(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_17, function);
         __pyx_t_16 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_17)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_bgmap, __pyx_int_1};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_17, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_GOTREF(__pyx_t_3);
+      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_bgmap, __pyx_int_1};
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_17, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_17)) {
-      PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_bgmap, __pyx_int_1};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_17, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __Pyx_GOTREF(__pyx_t_3);
+      PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_bgmap, __pyx_int_1};
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_17, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     {
-      __pyx_t_18 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_18 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 533, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      if (__pyx_t_4) {
-        __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_4); __pyx_t_4 = NULL;
+      if (__pyx_t_5) {
+        __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_INCREF(__pyx_v_bgmap);
       __Pyx_GIVEREF(__pyx_v_bgmap);
       PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_16, __pyx_v_bgmap);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_16, __pyx_int_1);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_17, __pyx_t_18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_17, __pyx_t_18, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     }
     __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmin, __pyx_t_3) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 552, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmin, __pyx_t_4) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_GetModuleGlobalName(__pyx_t_17, __pyx_n_s_np); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_17);
-    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_percentile); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_17, __pyx_n_s_percentile); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
     __pyx_t_17 = NULL;
     __pyx_t_16 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_18))) {
       __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_18);
       if (likely(__pyx_t_17)) {
@@ -11920,183 +11372,183 @@
         __Pyx_DECREF_SET(__pyx_t_18, function);
         __pyx_t_16 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_18)) {
       PyObject *__pyx_temp[3] = {__pyx_t_17, __pyx_v_bgmap, __pyx_int_99};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_18)) {
       PyObject *__pyx_temp[3] = {__pyx_t_17, __pyx_v_bgmap, __pyx_int_99};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_16, 2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_GOTREF(__pyx_t_4);
     } else
     #endif
     {
-      __pyx_t_4 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = PyTuple_New(2+__pyx_t_16); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_17) {
-        __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_17); __pyx_t_17 = NULL;
+        __Pyx_GIVEREF(__pyx_t_17); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_17); __pyx_t_17 = NULL;
       }
       __Pyx_INCREF(__pyx_v_bgmap);
       __Pyx_GIVEREF(__pyx_v_bgmap);
-      PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_16, __pyx_v_bgmap);
+      PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_16, __pyx_v_bgmap);
       __Pyx_INCREF(__pyx_int_99);
       __Pyx_GIVEREF(__pyx_int_99);
-      PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_16, __pyx_int_99);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_16, __pyx_int_99);
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmax, __pyx_t_3) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colbar, Py_True) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colbar_extend, Py_True) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_title, __pyx_kp_s_Background_map) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Used_for_determining_the_amplitu, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 552, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_vmax, __pyx_t_4) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colbar, Py_True) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colbar_extend, Py_True) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_title, __pyx_kp_s_Background_map) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Used_for_determining_the_amplitu, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 533, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __pyx_t_4 = NULL;
+    __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_18);
-      if (likely(__pyx_t_4)) {
+      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_18);
+      if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
-        __Pyx_INCREF(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_18, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_4, __pyx_v_sourcesep) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_sourcesep);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_5, __pyx_v_sourcesep) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_sourcesep);
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dscrp, __pyx_t_3) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 552, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dscrp, __pyx_t_4) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 533, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 533, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":551
+    /* "fastrometry/cython_code/PSE.pyx":532
  *     if verbosity == 2:
  *         print("| done")
  *     if debug:             # <<<<<<<<<<<<<<
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)
  * 
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":554
+  /* "fastrometry/cython_code/PSE.pyx":535
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)
  * 
  *     curr_src_ind = 0             # <<<<<<<<<<<<<<
  *     occupymap = -1*np.ones(img.shape, dtype=int)
  * 
  */
   __pyx_v_curr_src_ind = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":555
+  /* "fastrometry/cython_code/PSE.pyx":536
  * 
  *     curr_src_ind = 0
  *     occupymap = -1*np.ones(img.shape, dtype=int)             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 555, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_img, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 555, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_v_occupymap = __pyx_t_3;
-  __pyx_t_3 = 0;
+  __pyx_v_occupymap = __pyx_t_4;
+  __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":557
+  /* "fastrometry/cython_code/PSE.pyx":538
  *     occupymap = -1*np.ones(img.shape, dtype=int)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding saturation islands...")
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 557, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_5) {
+  __pyx_t_4 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":558
+    /* "fastrometry/cython_code/PSE.pyx":539
  * 
  *     if verbosity >= 1:
  *         print("| Finding saturation islands...")             # <<<<<<<<<<<<<<
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  *     if curr_src_ind < nrefinepts:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_saturation_islands) < 0) __PYX_ERR(0, 558, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_saturation_islands) < 0) __PYX_ERR(0, 539, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":557
+    /* "fastrometry/cython_code/PSE.pyx":538
  *     occupymap = -1*np.ones(img.shape, dtype=int)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding saturation islands...")
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":559
+  /* "fastrometry/cython_code/PSE.pyx":540
  *     if verbosity >= 1:
  *         print("| Finding saturation islands...")
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources             # <<<<<<<<<<<<<<
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:
  */
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  if (!(likely(((__pyx_v_pse_metadata) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pse_metadata, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_occupymap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_v_pixsat); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_23 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_23 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_24 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_24 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 559, __pyx_L1_error)
-  __pyx_v_curr_src_ind = __pyx_f_11fastrometry_11cython_code_3PSE_mapSaturationIslands(__pyx_t_12, __pyx_t_16, __pyx_t_15, __pyx_t_14, __pyx_t_13, __pyx_t_7, __pyx_t_8, __pyx_t_6, ((PyArrayObject *)__pyx_v_pse_metadata), __pyx_t_19, __pyx_t_20, __pyx_t_21, __pyx_t_9, __pyx_t_22, __pyx_t_23, __pyx_t_24, __pyx_v_curr_src_ind, __pyx_v_debug_report, __pyx_t_25, __pyx_t_5);
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  if (!(likely(((__pyx_v_pse_metadata) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pse_metadata, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_occupymap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_v_pixsat); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_23 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_23 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_24 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_24 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_v_curr_src_ind = __pyx_f_11fastrometry_11cython_code_3PSE_mapSaturationIslands(__pyx_t_12, __pyx_t_16, __pyx_t_15, __pyx_t_14, __pyx_t_13, __pyx_t_7, __pyx_t_8, __pyx_t_6, ((PyArrayObject *)__pyx_v_pse_metadata), __pyx_t_19, __pyx_t_20, __pyx_t_21, __pyx_t_9, __pyx_t_22, __pyx_t_23, __pyx_t_24, __pyx_v_curr_src_ind, __pyx_v_debug_report, __pyx_t_25, __pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
@@ -12105,865 +11557,865 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_20, 1);
   __pyx_t_20.memview = NULL;
   __pyx_t_20.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __pyx_t_21.memview = NULL;
   __pyx_t_21.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":560
+  /* "fastrometry/cython_code/PSE.pyx":541
  *         print("| Finding saturation islands...")
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  */
-  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_10 = PyObject_RichCompare(__pyx_t_3, __pyx_v_nrefinepts, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 560, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 560, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 541, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_10 = PyObject_RichCompare(__pyx_t_4, __pyx_v_nrefinepts, Py_LT); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 541, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 541, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":561
+    /* "fastrometry/cython_code/PSE.pyx":542
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 561, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 561, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 542, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 542, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":562
+      /* "fastrometry/cython_code/PSE.pyx":543
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands.".format(curr_src_ind))             # <<<<<<<<<<<<<<
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_saturation_islands, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_saturation_islands, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 543, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_1 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+        __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_1)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
-      __pyx_t_10 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
+      __pyx_t_10 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 562, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 562, __pyx_L1_error)
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 543, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_10);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 543, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":561
+      /* "fastrometry/cython_code/PSE.pyx":542
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":560
+    /* "fastrometry/cython_code/PSE.pyx":541
  *         print("| Finding saturation islands...")
  *     curr_src_ind = mapSaturationIslands(img, img_xmax, img_ymax, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, occupymap, srcindexmap_initial, srcindexmap_refine, sourcesep, pixsat, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)     #return curr_src_ind to use in mapRemainingSources
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  */
-    goto __pyx_L11;
+    goto __pyx_L12;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":563
+  /* "fastrometry/cython_code/PSE.pyx":544
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  */
-  __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 563, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 544, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_10, __pyx_v_nrefinepts, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
+  __pyx_t_4 = PyObject_RichCompare(__pyx_t_10, __pyx_v_nrefinepts, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 544, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 563, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":564
+    /* "fastrometry/cython_code/PSE.pyx":545
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  *         if verbosity == 2:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 564, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 564, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 545, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 545, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":565
+      /* "fastrometry/cython_code/PSE.pyx":546
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_saturation_islands_Trimme, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 565, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_saturation_islands_Trimme, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 546, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_1 = NULL;
       __pyx_t_25 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_25 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_2, __pyx_v_nrefinepts};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_25, 2+__pyx_t_25); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)
+        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_3, __pyx_v_nrefinepts};
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_25, 2+__pyx_t_25); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_2, __pyx_v_nrefinepts};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_25, 2+__pyx_t_25); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)
+        PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_3, __pyx_v_nrefinepts};
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_25, 2+__pyx_t_25); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_18 = PyTuple_New(2+__pyx_t_25); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 565, __pyx_L1_error)
+        __pyx_t_18 = PyTuple_New(2+__pyx_t_25); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 546, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         if (__pyx_t_1) {
           __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_1); __pyx_t_1 = NULL;
         }
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_25, __pyx_t_2);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_25, __pyx_t_3);
         __Pyx_INCREF(__pyx_v_nrefinepts);
         __Pyx_GIVEREF(__pyx_v_nrefinepts);
         PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_25, __pyx_v_nrefinepts);
-        __pyx_t_2 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __pyx_t_3 = 0;
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_18, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 565, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 546, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":564
+      /* "fastrometry/cython_code/PSE.pyx":545
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":566
+    /* "fastrometry/cython_code/PSE.pyx":547
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
-    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 566, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_4 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 547, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":567
+      /* "fastrometry/cython_code/PSE.pyx":548
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 567, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 548, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":568
+      /* "fastrometry/cython_code/PSE.pyx":549
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 568, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_18 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_18)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_18);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_18, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_npts);
+      __pyx_t_4 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_18, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_npts);
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 568, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 568, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 549, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":566
+      /* "fastrometry/cython_code/PSE.pyx":547
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":569
+    /* "fastrometry/cython_code/PSE.pyx":550
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 569, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 550, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":570
+      /* "fastrometry/cython_code/PSE.pyx":551
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 570, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 551, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_srcindexmap_initial);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_initial);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_srcindexmap_initial);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_initial_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_initial_png);
       PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_kp_s_srcindexmap_initial_png);
-      __pyx_t_18 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 570, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 551, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = NULL;
+      __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_4)) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_npts);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_npts);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dscrp, __pyx_t_2) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
-      __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dscrp, __pyx_t_3) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
-      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_blue);
+      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
-      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_colors, __pyx_t_2) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_yellow);
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_colors, __pyx_t_3) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
-      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_neg_1);
+      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
-      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_0);
+      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_npts);
       __Pyx_GIVEREF(__pyx_v_npts);
-      PyList_SET_ITEM(__pyx_t_2, 2, __pyx_v_npts);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_boundaries, __pyx_t_2) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, __pyx_t_18); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      PyList_SET_ITEM(__pyx_t_3, 2, __pyx_v_npts);
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_boundaries, __pyx_t_3) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, __pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":569
+      /* "fastrometry/cython_code/PSE.pyx":550
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":571
+    /* "fastrometry/cython_code/PSE.pyx":552
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  */
-    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 571, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":572
+      /* "fastrometry/cython_code/PSE.pyx":553
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  */
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 572, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_18);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_18, function);
         }
       }
-      __pyx_t_2 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_10, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_nrefinepts);
+      __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_10, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_nrefinepts);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_2) < 0) __PYX_ERR(0, 572, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 553, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":571
+      /* "fastrometry/cython_code/PSE.pyx":552
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":573
+    /* "fastrometry/cython_code/PSE.pyx":554
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 573, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 554, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":574
+      /* "fastrometry/cython_code/PSE.pyx":555
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 574, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 555, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_INCREF(__pyx_v_srcindexmap_refine);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_refine);
       PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_v_srcindexmap_refine);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
       PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_refine_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_refine_png);
       PyTuple_SET_ITEM(__pyx_t_18, 2, __pyx_kp_s_srcindexmap_refine_png);
-      __pyx_t_10 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 555, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_2, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_2, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = NULL;
+      __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_4)) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_nrefinepts);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_nrefinepts);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dscrp, __pyx_t_3) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
-      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dscrp, __pyx_t_4) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
+      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
-      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_blue);
+      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
-      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_colors, __pyx_t_3) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_n_s_yellow);
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_colors, __pyx_t_4) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = PyList_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
-      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
+      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
-      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
+      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_nrefinepts);
       __Pyx_GIVEREF(__pyx_v_nrefinepts);
-      PyList_SET_ITEM(__pyx_t_3, 2, __pyx_v_nrefinepts);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_boundaries, __pyx_t_3) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
+      PyList_SET_ITEM(__pyx_t_4, 2, __pyx_v_nrefinepts);
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_boundaries, __pyx_t_4) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_18, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_18, __pyx_t_10); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":573
+      /* "fastrometry/cython_code/PSE.pyx":554
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":575
+    /* "fastrometry/cython_code/PSE.pyx":556
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = nrefinepts
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 575, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 556, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":576
+      /* "fastrometry/cython_code/PSE.pyx":557
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *         num_psesources = nrefinepts
  *         return num_psesources
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 576, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 557, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":575
+      /* "fastrometry/cython_code/PSE.pyx":556
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = nrefinepts
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":577
+    /* "fastrometry/cython_code/PSE.pyx":558
  *         if verbosity >= 1:
  *             print("| done")
  *         num_psesources = nrefinepts             # <<<<<<<<<<<<<<
  *         return num_psesources
  * 
  */
     __Pyx_INCREF(__pyx_v_nrefinepts);
     __Pyx_DECREF_SET(__pyx_v_num_psesources, __pyx_v_nrefinepts);
 
-    /* "fastrometry/cython_code/PSE.pyx":578
+    /* "fastrometry/cython_code/PSE.pyx":559
  *             print("| done")
  *         num_psesources = nrefinepts
  *         return num_psesources             # <<<<<<<<<<<<<<
  * 
  *     kernelsize = getCircleSize(kernelrad)
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_num_psesources);
     __pyx_r = __pyx_v_num_psesources;
     goto __pyx_L0;
 
-    /* "fastrometry/cython_code/PSE.pyx":563
+    /* "fastrometry/cython_code/PSE.pyx":544
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands.".format(curr_src_ind))
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} saturation islands. Trimmed to the {} brightest.".format(curr_src_ind,nrefinepts))
  */
   }
-  __pyx_L11:;
+  __pyx_L12:;
 
-  /* "fastrometry/cython_code/PSE.pyx":580
+  /* "fastrometry/cython_code/PSE.pyx":561
  *         return num_psesources
  * 
  *     kernelsize = getCircleSize(kernelrad)             # <<<<<<<<<<<<<<
  *     kernelcircle = np.zeros((kernelsize,2),dtype=int)
  *     makePixelCircle(kernelrad,kernelcircle)
  */
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 561, __pyx_L1_error)
   __pyx_v_kernelsize = __pyx_f_11fastrometry_11cython_code_3PSE_getCircleSize(__pyx_t_25);
 
-  /* "fastrometry/cython_code/PSE.pyx":581
+  /* "fastrometry/cython_code/PSE.pyx":562
  * 
  *     kernelsize = getCircleSize(kernelrad)
  *     kernelcircle = np.zeros((kernelsize,2),dtype=int)             # <<<<<<<<<<<<<<
  *     makePixelCircle(kernelrad,kernelcircle)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_kernelsize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_18 = PyTuple_New(2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_kernelsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_18 = PyTuple_New(2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_3);
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_int_2);
-  __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_18);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_18);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_18);
   __pyx_t_18 = 0;
-  __pyx_t_18 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
-  if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 581, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 562, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-  __pyx_v_kernelcircle = __pyx_t_2;
-  __pyx_t_2 = 0;
+  __pyx_v_kernelcircle = __pyx_t_3;
+  __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":582
+  /* "fastrometry/cython_code/PSE.pyx":563
  *     kernelsize = getCircleSize(kernelrad)
  *     kernelcircle = np.zeros((kernelsize,2),dtype=int)
  *     makePixelCircle(kernelrad,kernelcircle)             # <<<<<<<<<<<<<<
  * 
  *     sourcesepsize = getCircleSize(sourcesep)
  */
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 582, __pyx_L1_error)
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_kernelcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 582, __pyx_L1_error)
-  __pyx_t_2 = __pyx_f_11fastrometry_11cython_code_3PSE_makePixelCircle(__pyx_t_25, __pyx_t_21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 563, __pyx_L1_error)
+  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_kernelcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 563, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_11fastrometry_11cython_code_3PSE_makePixelCircle(__pyx_t_25, __pyx_t_21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __pyx_t_21.memview = NULL;
   __pyx_t_21.data = NULL;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":584
+  /* "fastrometry/cython_code/PSE.pyx":565
  *     makePixelCircle(kernelrad,kernelcircle)
  * 
  *     sourcesepsize = getCircleSize(sourcesep)             # <<<<<<<<<<<<<<
  *     sourcesepcircle = np.zeros((sourcesepsize,2),dtype=int)
  *     makePixelCircle(sourcesep,sourcesepcircle)
  */
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 584, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 565, __pyx_L1_error)
   __pyx_v_sourcesepsize = __pyx_f_11fastrometry_11cython_code_3PSE_getCircleSize(__pyx_t_25);
 
-  /* "fastrometry/cython_code/PSE.pyx":585
+  /* "fastrometry/cython_code/PSE.pyx":566
  * 
  *     sourcesepsize = getCircleSize(sourcesep)
  *     sourcesepcircle = np.zeros((sourcesepsize,2),dtype=int)             # <<<<<<<<<<<<<<
  *     makePixelCircle(sourcesep,sourcesepcircle)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 585, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_sourcesepsize); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 585, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_sourcesepsize); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_GIVEREF(__pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
-  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_2);
-  __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 585, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GIVEREF(__pyx_t_3);
-  PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
+  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_2);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 585, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __Pyx_GIVEREF(__pyx_t_4);
+  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
+  __pyx_t_4 = 0;
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&PyInt_Type))) < 0) __PYX_ERR(0, 566, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_sourcesepcircle = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":586
+  /* "fastrometry/cython_code/PSE.pyx":567
  *     sourcesepsize = getCircleSize(sourcesep)
  *     sourcesepcircle = np.zeros((sourcesepsize,2),dtype=int)
  *     makePixelCircle(sourcesep,sourcesepcircle)             # <<<<<<<<<<<<<<
  * 
  *     img_median = np.median(img)
  */
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 586, __pyx_L1_error)
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_sourcesepcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 586, __pyx_L1_error)
-  __pyx_t_10 = __pyx_f_11fastrometry_11cython_code_3PSE_makePixelCircle(__pyx_t_25, __pyx_t_21); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 567, __pyx_L1_error)
+  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_sourcesepcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 567, __pyx_L1_error)
+  __pyx_t_10 = __pyx_f_11fastrometry_11cython_code_3PSE_makePixelCircle(__pyx_t_25, __pyx_t_21); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 567, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __pyx_t_21.memview = NULL;
   __pyx_t_21.data = NULL;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":588
+  /* "fastrometry/cython_code/PSE.pyx":569
  *     makePixelCircle(sourcesep,sourcesepcircle)
  * 
  *     img_median = np.median(img)             # <<<<<<<<<<<<<<
  *     img_max = np.max(img)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 588, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_median); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_median); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
-    if (likely(__pyx_t_3)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-      __Pyx_INCREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  __pyx_t_4 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
+    if (likely(__pyx_t_4)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+      __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_2, function);
+      __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
-  __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_img) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_img);
-  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 588, __pyx_L1_error)
+  __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_v_img) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_img);
+  __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_img_median = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":589
+  /* "fastrometry/cython_code/PSE.pyx":570
  * 
  *     img_median = np.median(img)
  *     img_max = np.max(img)             # <<<<<<<<<<<<<<
  * 
- *     if verbosity ==2:
+ *     if verbosity == 2:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 589, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 589, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
-    __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-    if (likely(__pyx_t_2)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-      __Pyx_INCREF(__pyx_t_2);
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = NULL;
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
+    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
+    if (likely(__pyx_t_3)) {
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+      __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_3, function);
+      __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_img) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_img);
-  __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 589, __pyx_L1_error)
+  __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_img) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_img);
+  __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+  if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 570, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_img_max = __pyx_t_10;
   __pyx_t_10 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":591
+  /* "fastrometry/cython_code/PSE.pyx":572
  *     img_max = np.max(img)
  * 
- *     if verbosity ==2:             # <<<<<<<<<<<<<<
+ *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Median amplitude: {}".format(img_median))
  *         print("| Max amplitude: {}".format(img_max))
  */
-  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 591, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 591, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 572, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":592
+    /* "fastrometry/cython_code/PSE.pyx":573
  * 
- *     if verbosity ==2:
+ *     if verbosity == 2:
  *         print("| Median amplitude: {}".format(img_median))             # <<<<<<<<<<<<<<
  *         print("| Max amplitude: {}".format(img_max))
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Median_amplitude, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 592, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_2);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Median_amplitude, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_3 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
-    __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_img_median) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_img_median);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 592, __pyx_L1_error)
+    __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_img_median) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_img_median);
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 573, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 592, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 573, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":593
- *     if verbosity ==2:
+    /* "fastrometry/cython_code/PSE.pyx":574
+ *     if verbosity == 2:
  *         print("| Median amplitude: {}".format(img_median))
  *         print("| Max amplitude: {}".format(img_max))             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Max_amplitude, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 593, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = NULL;
-    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-      __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
-      if (likely(__pyx_t_2)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
-        __Pyx_INCREF(__pyx_t_2);
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Max_amplitude, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_3 = NULL;
+    if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
+      if (likely(__pyx_t_3)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
+        __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_3, function);
+        __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
-    __pyx_t_10 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_img_max) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_img_max);
-    __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 593, __pyx_L1_error)
+    __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_img_max) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_img_max);
+    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 593, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":591
+    /* "fastrometry/cython_code/PSE.pyx":572
  *     img_max = np.max(img)
  * 
- *     if verbosity ==2:             # <<<<<<<<<<<<<<
+ *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| Median amplitude: {}".format(img_median))
  *         print("| Max amplitude: {}".format(img_max))
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":595
+  /* "fastrometry/cython_code/PSE.pyx":576
  *         print("| Max amplitude: {}".format(img_max))
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding remaining sources...")
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  */
-  __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 595, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
+  __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 576, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 576, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":596
+    /* "fastrometry/cython_code/PSE.pyx":577
  * 
  *     if verbosity >= 1:
  *         print("| Finding remaining sources...")             # <<<<<<<<<<<<<<
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  *     if curr_src_ind < nrefinepts:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_remaining_sources) < 0) __PYX_ERR(0, 596, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_remaining_sources) < 0) __PYX_ERR(0, 577, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/PSE.pyx":595
+    /* "fastrometry/cython_code/PSE.pyx":576
  *         print("| Max amplitude: {}".format(img_max))
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding remaining sources...")
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":597
+  /* "fastrometry/cython_code/PSE.pyx":578
  *     if verbosity >= 1:
  *         print("| Finding remaining sources...")
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)             # <<<<<<<<<<<<<<
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:
  */
-  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_24 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_24 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_v_img_max); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_26 = __pyx_PyFloat_AsDouble(__pyx_v_img_median); if (unlikely((__pyx_t_26 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_23 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_23 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  if (!(likely(((__pyx_v_pse_metadata) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pse_metadata, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_bgmap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_occupymap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_27 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_kernelcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_27.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_sourcesepcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_29 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_29 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 597, __pyx_L1_error)
-  __pyx_v_curr_src_ind = __pyx_f_11fastrometry_11cython_code_3PSE_mapRemainingSources(__pyx_t_12, __pyx_t_25, __pyx_t_24, __pyx_t_22, __pyx_t_26, __pyx_t_23, __pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_21, ((PyArrayObject *)__pyx_v_pse_metadata), __pyx_t_11, __pyx_t_20, __pyx_t_19, __pyx_t_6, __pyx_t_13, __pyx_t_27, __pyx_v_kernelsize, __pyx_t_14, __pyx_t_28, __pyx_v_sourcesepsize, __pyx_t_15, __pyx_t_16, __pyx_v_curr_src_ind, __pyx_v_debug_report, __pyx_t_29, __pyx_t_5);
+  __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_img, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_25 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_24 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_24 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_22 = __pyx_PyFloat_AsDouble(__pyx_v_img_max); if (unlikely((__pyx_t_22 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_26 = __pyx_PyFloat_AsDouble(__pyx_v_img_median); if (unlikely((__pyx_t_26 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_23 = __Pyx_PyInt_As_int(__pyx_v_leftmostsafe_x); if (unlikely((__pyx_t_23 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_rightmostsafe_x); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_int(__pyx_v_topmostsafe_y); if (unlikely((__pyx_t_8 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_As_int(__pyx_v_bottommostsafe_y); if (unlikely((__pyx_t_7 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_21 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_roi, PyBUF_WRITABLE); if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  if (!(likely(((__pyx_v_pse_metadata) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pse_metadata, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_bgmap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_20.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_occupymap, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_kernelrad); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_27 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_kernelcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_27.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyInt_As_int(__pyx_v_sourcesep); if (unlikely((__pyx_t_14 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_28 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_sourcesepcircle, PyBUF_WRITABLE); if (unlikely(!__pyx_t_28.memview)) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_15 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_15 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_16 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_16 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_29 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_29 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 578, __pyx_L1_error)
+  __pyx_v_curr_src_ind = __pyx_f_11fastrometry_11cython_code_3PSE_mapRemainingSources(__pyx_t_12, __pyx_t_25, __pyx_t_24, __pyx_t_22, __pyx_t_26, __pyx_t_23, __pyx_t_9, __pyx_t_8, __pyx_t_7, __pyx_t_21, ((PyArrayObject *)__pyx_v_pse_metadata), __pyx_t_11, __pyx_t_20, __pyx_t_19, __pyx_t_6, __pyx_t_13, __pyx_t_27, __pyx_v_kernelsize, __pyx_t_14, __pyx_t_28, __pyx_v_sourcesepsize, __pyx_t_15, __pyx_t_16, __pyx_v_curr_src_ind, __pyx_v_debug_report, __pyx_t_29, __pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __pyx_t_12.memview = NULL;
   __pyx_t_12.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_21, 1);
   __pyx_t_21.memview = NULL;
   __pyx_t_21.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
@@ -12981,1317 +12433,1347 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_27, 1);
   __pyx_t_27.memview = NULL;
   __pyx_t_27.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_28, 1);
   __pyx_t_28.memview = NULL;
   __pyx_t_28.data = NULL;
 
-  /* "fastrometry/cython_code/PSE.pyx":598
+  /* "fastrometry/cython_code/PSE.pyx":579
  *         print("| Finding remaining sources...")
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  */
-  __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 598, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 579, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_3 = PyObject_RichCompare(__pyx_t_10, __pyx_v_nrefinepts, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 598, __pyx_L1_error)
+  __pyx_t_4 = PyObject_RichCompare(__pyx_t_10, __pyx_v_nrefinepts, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 579, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 598, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":599
+    /* "fastrometry/cython_code/PSE.pyx":580
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  *         if verbosity == 2:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 599, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_4 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 580, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":600
+      /* "fastrometry/cython_code/PSE.pyx":581
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Unsuccessful_at_finding_sources, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 600, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Unsuccessful_at_finding_sources, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 581, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_18 = NULL;
       __pyx_t_29 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_18)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_18);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
           __pyx_t_29 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_nrefinepts, __pyx_t_2};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
+        PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_nrefinepts, __pyx_t_3};
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_nrefinepts, __pyx_t_2};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
+        PyObject *__pyx_temp[3] = {__pyx_t_18, __pyx_v_nrefinepts, __pyx_t_3};
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __Pyx_GOTREF(__pyx_t_3);
-        __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+        __Pyx_GOTREF(__pyx_t_4);
+        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_1 = PyTuple_New(2+__pyx_t_29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 600, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2+__pyx_t_29); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 581, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (__pyx_t_18) {
           __Pyx_GIVEREF(__pyx_t_18); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_18); __pyx_t_18 = NULL;
         }
         __Pyx_INCREF(__pyx_v_nrefinepts);
         __Pyx_GIVEREF(__pyx_v_nrefinepts);
         PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_29, __pyx_v_nrefinepts);
-        __Pyx_GIVEREF(__pyx_t_2);
-        PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_29, __pyx_t_2);
-        __pyx_t_2 = 0;
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
+        __Pyx_GIVEREF(__pyx_t_3);
+        PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_29, __pyx_t_3);
+        __pyx_t_3 = 0;
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 600, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 581, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":599
+      /* "fastrometry/cython_code/PSE.pyx":580
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  *     if curr_src_ind < nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":601
+    /* "fastrometry/cython_code/PSE.pyx":582
  *         if verbosity >= 1:
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
-    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 601, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_4 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 582, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 582, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":602
+      /* "fastrometry/cython_code/PSE.pyx":583
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":603
+      /* "fastrometry/cython_code/PSE.pyx":584
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 603, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 584, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_1, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_npts);
+      __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_1, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_npts);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 584, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 603, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 584, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":601
+      /* "fastrometry/cython_code/PSE.pyx":582
  *         if verbosity >= 1:
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":604
+    /* "fastrometry/cython_code/PSE.pyx":585
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 604, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 585, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":605
+      /* "fastrometry/cython_code/PSE.pyx":586
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_10 = PyTuple_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 586, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_v_srcindexmap_initial);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_initial);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_v_srcindexmap_initial);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_initial_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_initial_png);
       PyTuple_SET_ITEM(__pyx_t_10, 2, __pyx_kp_s_srcindexmap_initial_png);
-      __pyx_t_1 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 605, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 586, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      __pyx_t_4 = NULL;
+      __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_18);
-        if (likely(__pyx_t_4)) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_18);
+        if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
-          __Pyx_INCREF(__pyx_t_4);
+          __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_18, function);
         }
       }
-      __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_4, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_npts);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_5, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_npts);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dscrp, __pyx_t_2) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
-      __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dscrp, __pyx_t_3) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
-      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_blue);
+      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
-      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colors, __pyx_t_2) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyList_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_yellow);
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_colors, __pyx_t_3) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = PyList_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
-      PyList_SET_ITEM(__pyx_t_2, 0, __pyx_int_neg_1);
+      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
-      PyList_SET_ITEM(__pyx_t_2, 1, __pyx_int_0);
+      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_npts);
       __Pyx_GIVEREF(__pyx_v_npts);
-      PyList_SET_ITEM(__pyx_t_2, 2, __pyx_v_npts);
-      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_boundaries, __pyx_t_2) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      PyList_SET_ITEM(__pyx_t_3, 2, __pyx_v_npts);
+      if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_boundaries, __pyx_t_3) < 0) __PYX_ERR(0, 586, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":604
+      /* "fastrometry/cython_code/PSE.pyx":585
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":606
+    /* "fastrometry/cython_code/PSE.pyx":587
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  *         if debug:
  */
-    __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 606, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (__pyx_t_5) {
+    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 587, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 587, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":607
+      /* "fastrometry/cython_code/PSE.pyx":588
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 588, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 607, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 588, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_3 = NULL;
+      __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
-        if (likely(__pyx_t_3)) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
+        if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
-          __Pyx_INCREF(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
-      __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_10);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_10);
+      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 607, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 588, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_2) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_3) < 0) __PYX_ERR(0, 588, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":606
+      /* "fastrometry/cython_code/PSE.pyx":587
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  *         if debug:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":608
+    /* "fastrometry/cython_code/PSE.pyx":589
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  *         if verbosity >= 1:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 608, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 589, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":609
+      /* "fastrometry/cython_code/PSE.pyx":590
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 609, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_srcindexmap_refine);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_refine);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_srcindexmap_refine);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_refine_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_refine_png);
       PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_s_srcindexmap_refine_png);
-      __pyx_t_10 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 609, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_2, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 609, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_2, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_17 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
         __pyx_t_17 = PyMethod_GET_SELF(__pyx_t_18);
         if (likely(__pyx_t_17)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
           __Pyx_INCREF(__pyx_t_17);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_18, function);
         }
       }
-      __pyx_t_3 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_17, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_t_4);
+      __pyx_t_4 = (__pyx_t_17) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_17, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_17); __pyx_t_17 = 0;
-      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dscrp, __pyx_t_3) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
-      __pyx_t_3 = PyList_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_dscrp, __pyx_t_4) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
+      __pyx_t_4 = PyList_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
-      PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_blue);
+      PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
-      PyList_SET_ITEM(__pyx_t_3, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_colors, __pyx_t_3) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 609, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_18 = PyList_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 609, __pyx_L1_error)
+      PyList_SET_ITEM(__pyx_t_4, 1, __pyx_n_s_yellow);
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_colors, __pyx_t_4) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      __pyx_t_18 = PyList_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyList_SET_ITEM(__pyx_t_18, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_18, 1, __pyx_int_0);
-      __Pyx_GIVEREF(__pyx_t_3);
-      PyList_SET_ITEM(__pyx_t_18, 2, __pyx_t_3);
-      __pyx_t_3 = 0;
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_boundaries, __pyx_t_18) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
+      __Pyx_GIVEREF(__pyx_t_4);
+      PyList_SET_ITEM(__pyx_t_18, 2, __pyx_t_4);
+      __pyx_t_4 = 0;
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_boundaries, __pyx_t_18) < 0) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 609, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 590, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":608
+      /* "fastrometry/cython_code/PSE.pyx":589
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(curr_src_ind))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  *         if verbosity >= 1:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":610
+    /* "fastrometry/cython_code/PSE.pyx":591
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = curr_src_ind
  */
-    __pyx_t_18 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_18); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 610, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_18); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __pyx_t_18 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_18); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 591, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_18); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 591, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":611
+      /* "fastrometry/cython_code/PSE.pyx":592
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *         num_psesources = curr_src_ind
  *     elif curr_src_ind >= nrefinepts:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 611, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 592, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":610
+      /* "fastrometry/cython_code/PSE.pyx":591
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the WCS solution.".format(curr_src_ind), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,curr_src_ind])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = curr_src_ind
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":612
+    /* "fastrometry/cython_code/PSE.pyx":593
  *         if verbosity >= 1:
  *             print("| done")
  *         num_psesources = curr_src_ind             # <<<<<<<<<<<<<<
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:
  */
-    __pyx_t_18 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 593, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF_SET(__pyx_v_num_psesources, __pyx_t_18);
     __pyx_t_18 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":598
+    /* "fastrometry/cython_code/PSE.pyx":579
  *         print("| Finding remaining sources...")
  *     curr_src_ind = mapRemainingSources(img, img_xmax, img_ymax, img_max, img_median, leftmostsafe_x, rightmostsafe_x, topmostsafe_y, bottommostsafe_y, roi, pse_metadata, bgmap, srcindexmap_initial, srcindexmap_refine, occupymap, kernelrad, kernelcircle, kernelsize, sourcesep, sourcesepcircle, sourcesepsize, npts, nrefinepts, curr_src_ind, debug_report, verbosity, debug)
  *     if curr_src_ind < nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Unsuccessful at finding {} sources. Found {} sources.".format(nrefinepts, curr_src_ind))
  */
-    goto __pyx_L21;
+    goto __pyx_L22;
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":613
+  /* "fastrometry/cython_code/PSE.pyx":594
  *             print("| done")
  *         num_psesources = curr_src_ind
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  */
-  __pyx_t_18 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 594, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_18);
-  __pyx_t_10 = PyObject_RichCompare(__pyx_t_18, __pyx_v_nrefinepts, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_10 = PyObject_RichCompare(__pyx_t_18, __pyx_v_nrefinepts, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 594, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 594, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-  if (__pyx_t_5) {
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":614
+    /* "fastrometry/cython_code/PSE.pyx":595
  *         num_psesources = curr_src_ind
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  *         if verbosity == 2:
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 614, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 614, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 595, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":615
+      /* "fastrometry/cython_code/PSE.pyx":596
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  */
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_sources_total_Trimmed_to, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_sources_total_Trimmed_to, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 596, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_curr_src_ind); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 596, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = NULL;
+      __pyx_t_3 = NULL;
       __pyx_t_29 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
-        __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_18);
-        if (likely(__pyx_t_2)) {
+        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_18);
+        if (likely(__pyx_t_3)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
-          __Pyx_INCREF(__pyx_t_2);
+          __Pyx_INCREF(__pyx_t_3);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_18, function);
           __pyx_t_29 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_18)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_v_nrefinepts};
-        __pyx_t_10 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_1, __pyx_v_nrefinepts};
+        __pyx_t_10 = __Pyx_PyFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 596, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_18)) {
-        PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_v_nrefinepts};
-        __pyx_t_10 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
-        __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
+        PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_1, __pyx_v_nrefinepts};
+        __pyx_t_10 = __Pyx_PyCFunction_FastCall(__pyx_t_18, __pyx_temp+1-__pyx_t_29, 2+__pyx_t_29); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 596, __pyx_L1_error)
+        __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(2+__pyx_t_29); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
-        __Pyx_GOTREF(__pyx_t_3);
-        if (__pyx_t_2) {
-          __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2); __pyx_t_2 = NULL;
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_29); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 596, __pyx_L1_error)
+        __Pyx_GOTREF(__pyx_t_4);
+        if (__pyx_t_3) {
+          __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_1);
-        PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_29, __pyx_t_1);
+        PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_29, __pyx_t_1);
         __Pyx_INCREF(__pyx_v_nrefinepts);
         __Pyx_GIVEREF(__pyx_v_nrefinepts);
-        PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_29, __pyx_v_nrefinepts);
+        PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_29, __pyx_v_nrefinepts);
         __pyx_t_1 = 0;
-        __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_3, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_4, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 596, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 615, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 596, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":614
+      /* "fastrometry/cython_code/PSE.pyx":595
  *         num_psesources = curr_src_ind
  *     elif curr_src_ind >= nrefinepts:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":616
+    /* "fastrometry/cython_code/PSE.pyx":597
  *         if verbosity >= 1:
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
-    __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 616, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 597, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 616, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 597, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":617
+      /* "fastrometry/cython_code/PSE.pyx":598
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 617, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_Centroids_and_brightnesses_plac) < 0) __PYX_ERR(0, 598, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":618
+      /* "fastrometry/cython_code/PSE.pyx":599
  *         if verbosity == 2:
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  */
-      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci, __pyx_n_s_format); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      __pyx_t_3 = NULL;
+      __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_18))) {
-        __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_18);
-        if (likely(__pyx_t_3)) {
+        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_18);
+        if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_18);
-          __Pyx_INCREF(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_18, function);
         }
       }
-      __pyx_t_10 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_3, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_npts);
-      __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 618, __pyx_L1_error)
+      __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_18, __pyx_t_4, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_18, __pyx_v_npts);
+      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 599, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 618, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_10) < 0) __PYX_ERR(0, 599, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":616
+      /* "fastrometry/cython_code/PSE.pyx":597
  *         if verbosity >= 1:
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":619
+    /* "fastrometry/cython_code/PSE.pyx":600
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 619, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 600, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":620
+      /* "fastrometry/cython_code/PSE.pyx":601
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_18 = PyTuple_New(3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
       __Pyx_INCREF(__pyx_v_srcindexmap_initial);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_initial);
       PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_v_srcindexmap_initial);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
       PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_initial_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_initial_png);
       PyTuple_SET_ITEM(__pyx_t_18, 2, __pyx_kp_s_srcindexmap_initial_png);
-      __pyx_t_3 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 601, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_title, __pyx_n_s_srcindexmap_initial) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for, __pyx_n_s_format); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_4);
+      __pyx_t_5 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
+        if (likely(__pyx_t_5)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
+          __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_npts);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_v_npts) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_npts);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dscrp, __pyx_t_1) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dscrp, __pyx_t_1) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
-      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
+      __pyx_t_1 = PyList_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
       PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
       PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_colors, __pyx_t_1) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_colors, __pyx_t_1) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_npts);
       __Pyx_GIVEREF(__pyx_v_npts);
       PyList_SET_ITEM(__pyx_t_1, 2, __pyx_v_npts);
-      if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_boundaries, __pyx_t_1) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_boundaries, __pyx_t_1) < 0) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_18, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_18, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":619
+      /* "fastrometry/cython_code/PSE.pyx":600
  *             print("| | Centroids and brightnesses placed in pse_metadata.")
  *             print("| | {} brightest kernels drawn to srcindexmap_initial.".format(npts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":621
+    /* "fastrometry/cython_code/PSE.pyx":602
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  */
-    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_v_verbosity, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 602, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 602, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":622
+      /* "fastrometry/cython_code/PSE.pyx":603
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))             # <<<<<<<<<<<<<<
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 622, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_kernels_drawn_to_srci_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_18 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
-        __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_3);
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
+        __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_18)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_18);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_3, function);
+          __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
-      __pyx_t_1 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_18, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_nrefinepts);
+      __pyx_t_1 = (__pyx_t_18) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_18, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_nrefinepts);
       __Pyx_XDECREF(__pyx_t_18); __pyx_t_18 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 622, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+      if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 603, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":621
+      /* "fastrometry/cython_code/PSE.pyx":602
  *         if debug:
  *             debuggerPlot(srcindexmap_initial, debug_report, "srcindexmap_initial.png", title="srcindexmap_initial", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to find an initial WCS solution.".format(npts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,npts])
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":623
+    /* "fastrometry/cython_code/PSE.pyx":604
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  */
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 623, __pyx_L1_error)
-    if (__pyx_t_5) {
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 604, __pyx_L1_error)
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":624
+      /* "fastrometry/cython_code/PSE.pyx":605
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_debuggerPlot); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_4);
       __Pyx_INCREF(__pyx_v_srcindexmap_refine);
       __Pyx_GIVEREF(__pyx_v_srcindexmap_refine);
-      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_srcindexmap_refine);
+      PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_srcindexmap_refine);
       __Pyx_INCREF(__pyx_v_debug_report);
       __Pyx_GIVEREF(__pyx_v_debug_report);
-      PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_debug_report);
+      PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_debug_report);
       __Pyx_INCREF(__pyx_kp_s_srcindexmap_refine_png);
       __Pyx_GIVEREF(__pyx_kp_s_srcindexmap_refine_png);
-      PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_kp_s_srcindexmap_refine_png);
-      __pyx_t_18 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 624, __pyx_L1_error)
+      PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_kp_s_srcindexmap_refine_png);
+      __pyx_t_18 = __Pyx_PyDict_NewPresized(5); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_18);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_3, __pyx_n_s_format); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
-      __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = NULL;
-      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
-        __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-        if (likely(__pyx_t_4)) {
-          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-          __Pyx_INCREF(__pyx_t_4);
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_title, __pyx_n_s_srcindexmap_refine) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_The_occupied_source_kernels_for_3, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 605, __pyx_L1_error)
+      __Pyx_GOTREF(__pyx_t_3);
+      __pyx_t_5 = NULL;
+      if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
+        __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
+        if (likely(__pyx_t_5)) {
+          PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+          __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
-          __Pyx_DECREF_SET(__pyx_t_2, function);
+          __Pyx_DECREF_SET(__pyx_t_3, function);
         }
       }
-      __pyx_t_10 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_v_nrefinepts);
-      __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 624, __pyx_L1_error)
+      __pyx_t_10 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_v_nrefinepts) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_nrefinepts);
+      __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dscrp, __pyx_t_10) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_dscrp, __pyx_t_10) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
-      __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 624, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_textpos, __pyx_float_0_07) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
+      __pyx_t_10 = PyList_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_n_s_blue);
       __Pyx_GIVEREF(__pyx_n_s_blue);
       PyList_SET_ITEM(__pyx_t_10, 0, __pyx_n_s_blue);
       __Pyx_INCREF(__pyx_n_s_yellow);
       __Pyx_GIVEREF(__pyx_n_s_yellow);
       PyList_SET_ITEM(__pyx_t_10, 1, __pyx_n_s_yellow);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_colors, __pyx_t_10) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_colors, __pyx_t_10) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = PyList_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 624, __pyx_L1_error)
+      __pyx_t_10 = PyList_New(3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_INCREF(__pyx_int_neg_1);
       __Pyx_GIVEREF(__pyx_int_neg_1);
       PyList_SET_ITEM(__pyx_t_10, 0, __pyx_int_neg_1);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyList_SET_ITEM(__pyx_t_10, 1, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_nrefinepts);
       __Pyx_GIVEREF(__pyx_v_nrefinepts);
       PyList_SET_ITEM(__pyx_t_10, 2, __pyx_v_nrefinepts);
-      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_boundaries, __pyx_t_10) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_18, __pyx_n_s_boundaries, __pyx_t_10) < 0) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 624, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_18); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 605, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-      /* "fastrometry/cython_code/PSE.pyx":623
+      /* "fastrometry/cython_code/PSE.pyx":604
  *         if verbosity == 2:
  *             print("| | {} brightest kernels drawn to srcindexmap_refine.".format(nrefinepts))
  *         if debug:             # <<<<<<<<<<<<<<
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":625
+    /* "fastrometry/cython_code/PSE.pyx":606
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = nrefinepts
  */
-    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 625, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 625, __pyx_L1_error)
+    __pyx_t_10 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_10); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 606, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (__pyx_t_5) {
+    if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/PSE.pyx":626
+      /* "fastrometry/cython_code/PSE.pyx":607
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *         num_psesources = nrefinepts
  * 
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 626, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/PSE.pyx":625
+      /* "fastrometry/cython_code/PSE.pyx":606
  *         if debug:
  *             debuggerPlot(srcindexmap_refine, debug_report, "srcindexmap_refine.png", title="srcindexmap_refine", dscrp="The occupied source kernels for the top {} brightest sources \nin the image. Used to refine the initial WCS solution.".format(nrefinepts), textpos=0.07, colors=["blue","yellow"], boundaries=[-1,0,nrefinepts])
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         num_psesources = nrefinepts
  */
     }
 
-    /* "fastrometry/cython_code/PSE.pyx":627
+    /* "fastrometry/cython_code/PSE.pyx":608
  *         if verbosity >= 1:
  *             print("| done")
  *         num_psesources = nrefinepts             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
     __Pyx_INCREF(__pyx_v_nrefinepts);
     __Pyx_DECREF_SET(__pyx_v_num_psesources, __pyx_v_nrefinepts);
 
-    /* "fastrometry/cython_code/PSE.pyx":613
+    /* "fastrometry/cython_code/PSE.pyx":594
  *             print("| done")
  *         num_psesources = curr_src_ind
  *     elif curr_src_ind >= nrefinepts:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Found {} sources total. Trimmed to {} sources.".format(curr_src_ind, nrefinepts))
  */
   }
-  __pyx_L21:;
+  __pyx_L22:;
 
-  /* "fastrometry/cython_code/PSE.pyx":629
+  /* "fastrometry/cython_code/PSE.pyx":610
  *         num_psesources = nrefinepts
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"pse_metadata.csv", pse_metadata, delimiter=",")
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 629, __pyx_L1_error)
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 610, __pyx_L1_error)
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":630
+    /* "fastrometry/cython_code/PSE.pyx":611
  * 
  *     if debug:
  *         np.savetxt(debug_report/"pse_metadata.csv", pse_metadata, delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 630, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 611, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 630, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 611, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_csv); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 630, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_csv); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 611, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 611, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_10);
-    PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_10);
+    PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_10);
     __Pyx_INCREF(__pyx_v_pse_metadata);
     __Pyx_GIVEREF(__pyx_v_pse_metadata);
-    PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_pse_metadata);
+    PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_pse_metadata);
     __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 630, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 611, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_delimiter, __pyx_kp_s__9) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_3, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_delimiter, __pyx_kp_s__5) < 0) __PYX_ERR(0, 611, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_4, __pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 611, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":629
+    /* "fastrometry/cython_code/PSE.pyx":610
  *         num_psesources = nrefinepts
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"pse_metadata.csv", pse_metadata, delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":632
+  /* "fastrometry/cython_code/PSE.pyx":613
  *         np.savetxt(debug_report/"pse_metadata.csv", pse_metadata, delimiter=",")
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 632, __pyx_L1_error)
-  if (__pyx_t_5) {
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/PSE.pyx":633
+    /* "fastrometry/cython_code/PSE.pyx":614
  * 
  *     if debug:
  *         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  */
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_n_s__6);
-    __Pyx_GIVEREF(__pyx_n_s__6);
-    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__6);
-    __pyx_t_10 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 633, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_n_s__2);
+    __Pyx_GIVEREF(__pyx_n_s__2);
+    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__2);
+    __pyx_t_10 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 614, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_plt = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":634
+    /* "fastrometry/cython_code/PSE.pyx":615
  *     if debug:
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *         from astropy.io import fits
  *         plt.figure(figsize=(10,8))
  */
-    __pyx_t_10 = PyList_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_10 = PyList_New(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_INCREF(__pyx_n_s_LogNorm);
     __Pyx_GIVEREF(__pyx_n_s_LogNorm);
     PyList_SET_ITEM(__pyx_t_10, 0, __pyx_n_s_LogNorm);
-    __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_10, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_10, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_INCREF(__pyx_t_10);
     __pyx_v_LogNorm = __pyx_t_10;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":635
+    /* "fastrometry/cython_code/PSE.pyx":616
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits             # <<<<<<<<<<<<<<
  *         plt.figure(figsize=(10,8))
  *         image_data = fits.getdata(filepath)
  */
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_s_fits);
     __Pyx_GIVEREF(__pyx_n_s_fits);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_fits);
-    __pyx_t_10 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_1, -1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 635, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_1, -1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 616, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_10, __pyx_n_s_fits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_10, __pyx_n_s_fits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_t_1);
     __pyx_v_fits = __pyx_t_1;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":636
+    /* "fastrometry/cython_code/PSE.pyx":617
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  *         plt.figure(figsize=(10,8))             # <<<<<<<<<<<<<<
  *         image_data = fits.getdata(filepath)
  *         plt.subplots_adjust(bottom=0.15)
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_figsize, __pyx_tuple__14) < 0) __PYX_ERR(0, 636, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_figsize, __pyx_tuple__10) < 0) __PYX_ERR(0, 617, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":637
+    /* "fastrometry/cython_code/PSE.pyx":618
  *         from astropy.io import fits
  *         plt.figure(figsize=(10,8))
  *         image_data = fits.getdata(filepath)             # <<<<<<<<<<<<<<
  *         plt.subplots_adjust(bottom=0.15)
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_v_filepath) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_filepath);
+    __pyx_t_4 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_v_filepath) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_filepath);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_v_image_data = __pyx_t_3;
-    __pyx_t_3 = 0;
+    __pyx_v_image_data = __pyx_t_4;
+    __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":638
+    /* "fastrometry/cython_code/PSE.pyx":619
  *         plt.figure(figsize=(10,8))
  *         image_data = fits.getdata(filepath)
  *         plt.subplots_adjust(bottom=0.15)             # <<<<<<<<<<<<<<
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_bottom, __pyx_float_0_15) < 0) __PYX_ERR(0, 638, __pyx_L1_error)
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 638, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_bottom, __pyx_float_0_15) < 0) __PYX_ERR(0, 619, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":639
+    /* "fastrometry/cython_code/PSE.pyx":620
  *         image_data = fits.getdata(filepath)
  *         plt.subplots_adjust(bottom=0.15)
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')
  *         plt.title("pse_metadata centroids")
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_imshow); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 639, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_imshow); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_image_data);
     __Pyx_GIVEREF(__pyx_v_image_data);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_image_data);
-    __pyx_t_3 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 639, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_INCREF(__pyx_v_LogNorm);
-    __pyx_t_2 = __pyx_v_LogNorm; __pyx_t_4 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
-      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
-      if (likely(__pyx_t_4)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
-        __Pyx_INCREF(__pyx_t_4);
+    __pyx_t_3 = __pyx_v_LogNorm; __pyx_t_5 = NULL;
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
+      __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
+      if (likely(__pyx_t_5)) {
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_2, function);
+        __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
-    __pyx_t_18 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
-    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 639, __pyx_L1_error)
+    __pyx_t_18 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
+    __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
+    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_norm, __pyx_t_18) < 0) __PYX_ERR(0, 639, __pyx_L1_error)
+    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, __pyx_t_18) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-    __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 639, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":640
+    /* "fastrometry/cython_code/PSE.pyx":621
  *         plt.subplots_adjust(bottom=0.15)
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')             # <<<<<<<<<<<<<<
  *         plt.title("pse_metadata centroids")
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."
  */
-    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_scatter); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_scatter); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_pse_metadata, __pyx_tuple__15); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_pse_metadata, __pyx_tuple__16); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_pse_metadata, __pyx_tuple__11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_pse_metadata, __pyx_tuple__12); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_GIVEREF(__pyx_t_3);
-    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_3);
+    __Pyx_GIVEREF(__pyx_t_4);
+    PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_1);
-    __pyx_t_3 = 0;
+    __pyx_t_4 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_color, __pyx_n_s_red) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_marker, __pyx_kp_s__17) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_color, __pyx_n_s_red) < 0) __PYX_ERR(0, 621, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_marker, __pyx_kp_s__13) < 0) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_18, __pyx_t_10, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":641
+    /* "fastrometry/cython_code/PSE.pyx":622
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')
  *         plt.title("pse_metadata centroids")             # <<<<<<<<<<<<<<
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
-    __pyx_t_3 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_kp_s_pse_metadata_centroids) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_s_pse_metadata_centroids);
+    __pyx_t_4 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_10, __pyx_kp_s_pse_metadata_centroids) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_kp_s_pse_metadata_centroids);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":642
+    /* "fastrometry/cython_code/PSE.pyx":623
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')
  *         plt.title("pse_metadata centroids")
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."             # <<<<<<<<<<<<<<
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.savefig(debug_report/"pse_metadata_centroids.png")
  */
     __Pyx_INCREF(__pyx_kp_s_Centroids_from_the_pse_metadata);
     __pyx_v_dscrp = __pyx_kp_s_Centroids_from_the_pse_metadata;
 
-    /* "fastrometry/cython_code/PSE.pyx":643
+    /* "fastrometry/cython_code/PSE.pyx":624
  *         plt.title("pse_metadata centroids")
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *         plt.savefig(debug_report/"pse_metadata_centroids.png")
  *         plt.show()
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 643, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_4);
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_float_0_5);
     __Pyx_GIVEREF(__pyx_float_0_5);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_float_0_5);
     __Pyx_INCREF(__pyx_float_0_05);
     __Pyx_GIVEREF(__pyx_float_0_05);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_float_0_05);
     __Pyx_INCREF(__pyx_v_dscrp);
     __Pyx_GIVEREF(__pyx_v_dscrp);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_v_dscrp);
-    __pyx_t_10 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 643, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 643, __pyx_L1_error)
-    __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 643, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_10); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
-    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":644
+    /* "fastrometry/cython_code/PSE.pyx":625
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.savefig(debug_report/"pse_metadata_centroids.png")             # <<<<<<<<<<<<<<
  *         plt.show()
  * 
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 644, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_centroids_png); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 644, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_pse_metadata_centroids_png); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = NULL;
+    __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
-      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_10);
-      if (likely(__pyx_t_3)) {
+      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
+      if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
-        __Pyx_INCREF(__pyx_t_3);
+        __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_10, function);
       }
     }
-    __pyx_t_18 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
-    __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
+    __pyx_t_18 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1);
+    __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 644, __pyx_L1_error)
+    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":645
+    /* "fastrometry/cython_code/PSE.pyx":626
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.savefig(debug_report/"pse_metadata_centroids.png")
  *         plt.show()             # <<<<<<<<<<<<<<
  * 
- *     return num_psesources
+ *     if verbosity >= 1:
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 645, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_10, function);
       }
     }
     __pyx_t_18 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_10);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 645, __pyx_L1_error)
+    if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_18);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-    /* "fastrometry/cython_code/PSE.pyx":632
+    /* "fastrometry/cython_code/PSE.pyx":613
  *         np.savetxt(debug_report/"pse_metadata.csv", pse_metadata, delimiter=",")
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   }
 
-  /* "fastrometry/cython_code/PSE.pyx":647
+  /* "fastrometry/cython_code/PSE.pyx":628
+ *         plt.show()
+ * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("done")
+ * 
+ */
+  __pyx_t_18 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_18); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_18); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
+  if (__pyx_t_2) {
+
+    /* "fastrometry/cython_code/PSE.pyx":629
+ * 
+ *     if verbosity >= 1:
+ *         print("done")             # <<<<<<<<<<<<<<
+ * 
+ *     return num_psesources
+ */
+    if (__Pyx_PrintOne(0, __pyx_n_s_done_3) < 0) __PYX_ERR(0, 629, __pyx_L1_error)
+
+    /* "fastrometry/cython_code/PSE.pyx":628
  *         plt.show()
  * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("done")
+ * 
+ */
+  }
+
+  /* "fastrometry/cython_code/PSE.pyx":631
+ *         print("done")
+ * 
  *     return num_psesources             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_num_psesources);
   __pyx_r = __pyx_v_num_psesources;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/PSE.pyx":522
+  /* "fastrometry/cython_code/PSE.pyx":500
+ *     return curr_src_ind
  * 
- * @printEvent("Extracting sources from image...", "done", 1)
  * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):             # <<<<<<<<<<<<<<
  * 
- *     num_psesources = 0
+ *     if verbosity >= 1:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_5);
   __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
   __Pyx_XDECREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __Pyx_XDECREF(__pyx_t_17);
   __Pyx_XDECREF(__pyx_t_18);
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
@@ -14853,15 +14335,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__14, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -14985,15 +14467,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -15117,15 +14599,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -15541,15 +15023,15 @@
     /* "View.MemoryView":133
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 133, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 133, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 133, __pyx_L1_error)
 
     /* "View.MemoryView":132
  *         self.itemsize = itemsize
@@ -15573,15 +15055,15 @@
     /* "View.MemoryView":136
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 136, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 136, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 136, __pyx_L1_error)
 
     /* "View.MemoryView":135
  *             raise ValueError("Empty shape tuple for cython.array")
@@ -15700,15 +15182,15 @@
     /* "View.MemoryView":148
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 148, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 148, __pyx_L1_error)
 
     /* "View.MemoryView":147
  *         self._strides = self._shape + self.ndim
@@ -15974,15 +15456,15 @@
       /* "View.MemoryView":176
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 176, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 176, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_ERR(2, 176, __pyx_L1_error)
 
       /* "View.MemoryView":175
  * 
@@ -16218,15 +15700,15 @@
     /* "View.MemoryView":192
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 192, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 192, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 192, __pyx_L1_error)
 
     /* "View.MemoryView":191
  *         elif self.mode == u"fortran":
@@ -16952,15 +16434,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -17008,15 +16490,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -18718,15 +18200,15 @@
     /* "View.MemoryView":418
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 418, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 418, __pyx_L1_error)
 
     /* "View.MemoryView":417
  * 
@@ -19766,15 +19248,15 @@
       /* "View.MemoryView":495
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 495, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 495, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_ERR(2, 495, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -20128,15 +19610,15 @@
     /* "View.MemoryView":520
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 520, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 520, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 520, __pyx_L1_error)
 
     /* "View.MemoryView":519
  *     @cname('getbuffer')
@@ -20677,15 +20159,15 @@
     /* "View.MemoryView":570
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 570, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 570, __pyx_L1_error)
 
     /* "View.MemoryView":568
  *     @property
@@ -20794,15 +20276,15 @@
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__31, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 577, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__27, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":576
@@ -21832,15 +21314,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -21888,15 +21370,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -22245,17 +21727,17 @@
  *             else:
  */
         __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(2, 682, __pyx_L1_error)
         __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(2, 682, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
-            __Pyx_INCREF(__pyx_slice__10);
-            __Pyx_GIVEREF(__pyx_slice__10);
-            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__10);
+            __Pyx_INCREF(__pyx_slice__6);
+            __Pyx_GIVEREF(__pyx_slice__6);
+            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__6);
           }
         }
         __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 682, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "View.MemoryView":683
  *             if not seen_ellipsis:
@@ -22280,15 +21762,15 @@
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__10); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 685, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__6); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 685, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":686
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
@@ -22420,17 +21902,17 @@
  * 
  *     return have_slices or nslices, tuple(result)
  */
     __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
-        __Pyx_INCREF(__pyx_slice__10);
-        __Pyx_GIVEREF(__pyx_slice__10);
-        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__10);
+        __Pyx_INCREF(__pyx_slice__6);
+        __Pyx_GIVEREF(__pyx_slice__6);
+        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__6);
       }
     }
     __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 696, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "View.MemoryView":695
  * 
@@ -22549,15 +22031,15 @@
       /* "View.MemoryView":703
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 703, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 703, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __PYX_ERR(2, 703, __pyx_L1_error)
 
       /* "View.MemoryView":702
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
@@ -24733,15 +24215,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -24789,15 +24271,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -28066,15 +27548,15 @@
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__37, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__33, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
@@ -28359,271 +27841,14 @@
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-
-static struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *__pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent[8];
-static int __pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent = 0;
-
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
-  PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent)))) {
-    o = (PyObject*)__pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent[--__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent];
-    memset(o, 0, sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent));
-    (void) PyObject_INIT(o, t);
-    PyObject_GC_Track(o);
-  } else {
-    o = (*t->tp_alloc)(t, 0);
-    if (unlikely(!o)) return 0;
-  }
-  return o;
-}
-
-static void __pyx_tp_dealloc_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(PyObject *o) {
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)o;
-  PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_v_endmessage);
-  Py_CLEAR(p->__pyx_v_levelneeded);
-  Py_CLEAR(p->__pyx_v_startmessage);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent)))) {
-    __pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent[__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent++] = ((struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)o);
-  } else {
-    (*Py_TYPE(o)->tp_free)(o);
-  }
-}
-
-static int __pyx_tp_traverse_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(PyObject *o, visitproc v, void *a) {
-  int e;
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)o;
-  if (p->__pyx_v_endmessage) {
-    e = (*v)(p->__pyx_v_endmessage, a); if (e) return e;
-  }
-  if (p->__pyx_v_levelneeded) {
-    e = (*v)(p->__pyx_v_levelneeded, a); if (e) return e;
-  }
-  if (p->__pyx_v_startmessage) {
-    e = (*v)(p->__pyx_v_startmessage, a); if (e) return e;
-  }
-  return 0;
-}
-
-static int __pyx_tp_clear_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent(PyObject *o) {
-  PyObject* tmp;
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)o;
-  tmp = ((PyObject*)p->__pyx_v_endmessage);
-  p->__pyx_v_endmessage = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_levelneeded);
-  p->__pyx_v_levelneeded = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_startmessage);
-  p->__pyx_v_startmessage = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  return 0;
-}
-
-static PyTypeObject __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent = {
-  PyVarObject_HEAD_INIT(0, 0)
-  "fastrometry.cython_code.PSE.__pyx_scope_struct__printEvent", /*tp_name*/
-  sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent), /*tp_basicsize*/
-  0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent, /*tp_dealloc*/
-  #if PY_VERSION_HEX < 0x030800b4
-  0, /*tp_print*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4
-  0, /*tp_vectorcall_offset*/
-  #endif
-  0, /*tp_getattr*/
-  0, /*tp_setattr*/
-  #if PY_MAJOR_VERSION < 3
-  0, /*tp_compare*/
-  #endif
-  #if PY_MAJOR_VERSION >= 3
-  0, /*tp_as_async*/
-  #endif
-  0, /*tp_repr*/
-  0, /*tp_as_number*/
-  0, /*tp_as_sequence*/
-  0, /*tp_as_mapping*/
-  0, /*tp_hash*/
-  0, /*tp_call*/
-  0, /*tp_str*/
-  0, /*tp_getattro*/
-  0, /*tp_setattro*/
-  0, /*tp_as_buffer*/
-  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
-  __pyx_tp_traverse_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent, /*tp_traverse*/
-  __pyx_tp_clear_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent, /*tp_clear*/
-  0, /*tp_richcompare*/
-  0, /*tp_weaklistoffset*/
-  0, /*tp_iter*/
-  0, /*tp_iternext*/
-  0, /*tp_methods*/
-  0, /*tp_members*/
-  0, /*tp_getset*/
-  0, /*tp_base*/
-  0, /*tp_dict*/
-  0, /*tp_descr_get*/
-  0, /*tp_descr_set*/
-  0, /*tp_dictoffset*/
-  0, /*tp_init*/
-  0, /*tp_alloc*/
-  __pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent, /*tp_new*/
-  0, /*tp_free*/
-  0, /*tp_is_gc*/
-  0, /*tp_bases*/
-  0, /*tp_mro*/
-  0, /*tp_cache*/
-  0, /*tp_subclasses*/
-  0, /*tp_weaklist*/
-  0, /*tp_del*/
-  0, /*tp_version_tag*/
-  #if PY_VERSION_HEX >= 0x030400a1
-  0, /*tp_finalize*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-  0, /*tp_vectorcall*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-  0, /*tp_print*/
-  #endif
-  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-  0, /*tp_pypy_flags*/
-  #endif
-};
-
-static struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *__pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator[8];
-static int __pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator = 0;
-
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
-  PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator)))) {
-    o = (PyObject*)__pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator[--__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator];
-    memset(o, 0, sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator));
-    (void) PyObject_INIT(o, t);
-    PyObject_GC_Track(o);
-  } else {
-    o = (*t->tp_alloc)(t, 0);
-    if (unlikely(!o)) return 0;
-  }
-  return o;
-}
-
-static void __pyx_tp_dealloc_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(PyObject *o) {
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)o;
-  PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_outer_scope);
-  Py_CLEAR(p->__pyx_v_f);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator)))) {
-    __pyx_freelist_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator[__pyx_freecount_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator++] = ((struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)o);
-  } else {
-    (*Py_TYPE(o)->tp_free)(o);
-  }
-}
-
-static int __pyx_tp_traverse_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(PyObject *o, visitproc v, void *a) {
-  int e;
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)o;
-  if (p->__pyx_outer_scope) {
-    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
-  }
-  if (p->__pyx_v_f) {
-    e = (*v)(p->__pyx_v_f, a); if (e) return e;
-  }
-  return 0;
-}
-
-static int __pyx_tp_clear_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator(PyObject *o) {
-  PyObject* tmp;
-  struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator *)o;
-  tmp = ((PyObject*)p->__pyx_outer_scope);
-  p->__pyx_outer_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent *)Py_None); Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_f);
-  p->__pyx_v_f = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  return 0;
-}
-
-static PyTypeObject __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator = {
-  PyVarObject_HEAD_INIT(0, 0)
-  "fastrometry.cython_code.PSE.__pyx_scope_struct_1_decorator", /*tp_name*/
-  sizeof(struct __pyx_obj_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator), /*tp_basicsize*/
-  0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator, /*tp_dealloc*/
-  #if PY_VERSION_HEX < 0x030800b4
-  0, /*tp_print*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4
-  0, /*tp_vectorcall_offset*/
-  #endif
-  0, /*tp_getattr*/
-  0, /*tp_setattr*/
-  #if PY_MAJOR_VERSION < 3
-  0, /*tp_compare*/
-  #endif
-  #if PY_MAJOR_VERSION >= 3
-  0, /*tp_as_async*/
-  #endif
-  0, /*tp_repr*/
-  0, /*tp_as_number*/
-  0, /*tp_as_sequence*/
-  0, /*tp_as_mapping*/
-  0, /*tp_hash*/
-  0, /*tp_call*/
-  0, /*tp_str*/
-  0, /*tp_getattro*/
-  0, /*tp_setattro*/
-  0, /*tp_as_buffer*/
-  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
-  __pyx_tp_traverse_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator, /*tp_traverse*/
-  __pyx_tp_clear_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator, /*tp_clear*/
-  0, /*tp_richcompare*/
-  0, /*tp_weaklistoffset*/
-  0, /*tp_iter*/
-  0, /*tp_iternext*/
-  0, /*tp_methods*/
-  0, /*tp_members*/
-  0, /*tp_getset*/
-  0, /*tp_base*/
-  0, /*tp_dict*/
-  0, /*tp_descr_get*/
-  0, /*tp_descr_set*/
-  0, /*tp_dictoffset*/
-  0, /*tp_init*/
-  0, /*tp_alloc*/
-  __pyx_tp_new_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator, /*tp_new*/
-  0, /*tp_free*/
-  0, /*tp_is_gc*/
-  0, /*tp_bases*/
-  0, /*tp_mro*/
-  0, /*tp_cache*/
-  0, /*tp_subclasses*/
-  0, /*tp_weaklist*/
-  0, /*tp_del*/
-  0, /*tp_version_tag*/
-  #if PY_VERSION_HEX >= 0x030400a1
-  0, /*tp_finalize*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-  0, /*tp_vectorcall*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-  0, /*tp_print*/
-  #endif
-  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-  0, /*tp_pypy_flags*/
-  #endif
-};
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_array_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
@@ -29443,19 +28668,18 @@
   {&__pyx_kp_s_Trying_various_pixel_thresholds, __pyx_k_Trying_various_pixel_thresholds, sizeof(__pyx_k_Trying_various_pixel_thresholds), 0, 0, 1, 0},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_kp_s_Unsuccessful_at_finding_sources, __pyx_k_Unsuccessful_at_finding_sources, sizeof(__pyx_k_Unsuccessful_at_finding_sources), 0, 0, 1, 0},
   {&__pyx_kp_s_Used_for_determining_the_amplitu, __pyx_k_Used_for_determining_the_amplitu, sizeof(__pyx_k_Used_for_determining_the_amplitu), 0, 0, 1, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
-  {&__pyx_kp_s__17, __pyx_k__17, sizeof(__pyx_k__17), 0, 0, 1, 0},
-  {&__pyx_n_s__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 0, 1, 1},
-  {&__pyx_kp_s__9, __pyx_k__9, sizeof(__pyx_k__9), 0, 0, 1, 0},
+  {&__pyx_kp_s__13, __pyx_k__13, sizeof(__pyx_k__13), 0, 0, 1, 0},
+  {&__pyx_n_s__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 0, 1, 1},
+  {&__pyx_kp_s__5, __pyx_k__5, sizeof(__pyx_k__5), 0, 0, 1, 0},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
-  {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
   {&__pyx_n_s_argsort, __pyx_k_argsort, sizeof(__pyx_k_argsort), 0, 0, 1, 1},
   {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
   {&__pyx_n_s_astropy_io, __pyx_k_astropy_io, sizeof(__pyx_k_astropy_io), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_bgmap, __pyx_k_bgmap, sizeof(__pyx_k_bgmap), 0, 0, 1, 1},
   {&__pyx_kp_s_bgmap_png, __pyx_k_bgmap_png, sizeof(__pyx_k_bgmap_png), 0, 0, 1, 0},
   {&__pyx_n_s_blue, __pyx_k_blue, sizeof(__pyx_k_blue), 0, 0, 1, 1},
@@ -29480,44 +28704,40 @@
   {&__pyx_n_s_colors, __pyx_k_colors, sizeof(__pyx_k_colors), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
   {&__pyx_n_s_curr_src_ind, __pyx_k_curr_src_ind, sizeof(__pyx_k_curr_src_ind), 0, 0, 1, 1},
   {&__pyx_n_s_debug, __pyx_k_debug, sizeof(__pyx_k_debug), 0, 0, 1, 1},
   {&__pyx_n_s_debug_report, __pyx_k_debug_report, sizeof(__pyx_k_debug_report), 0, 0, 1, 1},
   {&__pyx_n_s_debuggerPlot, __pyx_k_debuggerPlot, sizeof(__pyx_k_debuggerPlot), 0, 0, 1, 1},
-  {&__pyx_n_s_decorator, __pyx_k_decorator, sizeof(__pyx_k_decorator), 0, 0, 1, 1},
   {&__pyx_n_s_delimiter, __pyx_k_delimiter, sizeof(__pyx_k_delimiter), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
   {&__pyx_kp_s_done, __pyx_k_done, sizeof(__pyx_k_done), 0, 0, 1, 0},
   {&__pyx_kp_s_done_2, __pyx_k_done_2, sizeof(__pyx_k_done_2), 0, 0, 1, 0},
   {&__pyx_n_s_done_3, __pyx_k_done_3, sizeof(__pyx_k_done_3), 0, 0, 1, 1},
   {&__pyx_n_s_double, __pyx_k_double, sizeof(__pyx_k_double), 0, 0, 1, 1},
   {&__pyx_n_s_dscrp, __pyx_k_dscrp, sizeof(__pyx_k_dscrp), 0, 0, 1, 1},
   {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
   {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
   {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
-  {&__pyx_n_s_endmessage, __pyx_k_endmessage, sizeof(__pyx_k_endmessage), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
   {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
   {&__pyx_n_s_extend, __pyx_k_extend, sizeof(__pyx_k_extend), 0, 0, 1, 1},
-  {&__pyx_n_s_f, __pyx_k_f, sizeof(__pyx_k_f), 0, 0, 1, 1},
   {&__pyx_n_s_fastrometry_cython_code_PSE, __pyx_k_fastrometry_cython_code_PSE, sizeof(__pyx_k_fastrometry_cython_code_PSE), 0, 0, 1, 1},
   {&__pyx_n_s_figsize, __pyx_k_figsize, sizeof(__pyx_k_figsize), 0, 0, 1, 1},
   {&__pyx_n_s_figtext, __pyx_k_figtext, sizeof(__pyx_k_figtext), 0, 0, 1, 1},
   {&__pyx_n_s_figure, __pyx_k_figure, sizeof(__pyx_k_figure), 0, 0, 1, 1},
   {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
   {&__pyx_n_s_filepath, __pyx_k_filepath, sizeof(__pyx_k_filepath), 0, 0, 1, 1},
   {&__pyx_n_s_fits, __pyx_k_fits, sizeof(__pyx_k_fits), 0, 0, 1, 1},
   {&__pyx_n_s_flags, __pyx_k_flags, sizeof(__pyx_k_flags), 0, 0, 1, 1},
   {&__pyx_n_s_fontsize, __pyx_k_fontsize, sizeof(__pyx_k_fontsize), 0, 0, 1, 1},
   {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
   {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
-  {&__pyx_n_s_fout, __pyx_k_fout, sizeof(__pyx_k_fout), 0, 0, 1, 1},
   {&__pyx_n_s_getdata, __pyx_k_getdata, sizeof(__pyx_k_getdata), 0, 0, 1, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_n_s_gold, __pyx_k_gold, sizeof(__pyx_k_gold), 0, 0, 1, 1},
   {&__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 0, 1, 0},
   {&__pyx_n_s_gray, __pyx_k_gray, sizeof(__pyx_k_gray), 0, 0, 1, 1},
   {&__pyx_n_s_ha, __pyx_k_ha, sizeof(__pyx_k_ha), 0, 0, 1, 1},
   {&__pyx_n_s_id, __pyx_k_id, sizeof(__pyx_k_id), 0, 0, 1, 1},
@@ -29531,17 +28751,15 @@
   {&__pyx_n_s_imshow, __pyx_k_imshow, sizeof(__pyx_k_imshow), 0, 0, 1, 1},
   {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
   {&__pyx_n_s_kernelcircle, __pyx_k_kernelcircle, sizeof(__pyx_k_kernelcircle), 0, 0, 1, 1},
   {&__pyx_n_s_kernelrad, __pyx_k_kernelrad, sizeof(__pyx_k_kernelrad), 0, 0, 1, 1},
   {&__pyx_n_s_kernelsize, __pyx_k_kernelsize, sizeof(__pyx_k_kernelsize), 0, 0, 1, 1},
-  {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
   {&__pyx_n_s_leftmostsafe_x, __pyx_k_leftmostsafe_x, sizeof(__pyx_k_leftmostsafe_x), 0, 0, 1, 1},
-  {&__pyx_n_s_levelneeded, __pyx_k_levelneeded, sizeof(__pyx_k_levelneeded), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_marker, __pyx_k_marker, sizeof(__pyx_k_marker), 0, 0, 1, 1},
   {&__pyx_n_s_matplotlib_colors, __pyx_k_matplotlib_colors, sizeof(__pyx_k_matplotlib_colors), 0, 0, 1, 1},
   {&__pyx_n_s_matplotlib_pyplot, __pyx_k_matplotlib_pyplot, sizeof(__pyx_k_matplotlib_pyplot), 0, 0, 1, 1},
   {&__pyx_n_s_max, __pyx_k_max, sizeof(__pyx_k_max), 0, 0, 1, 1},
   {&__pyx_n_s_median, __pyx_k_median, sizeof(__pyx_k_median), 0, 0, 1, 1},
   {&__pyx_n_s_memview, __pyx_k_memview, sizeof(__pyx_k_memview), 0, 0, 1, 1},
@@ -29568,17 +28786,14 @@
   {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
   {&__pyx_n_s_percentile, __pyx_k_percentile, sizeof(__pyx_k_percentile), 0, 0, 1, 1},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_pixelradius, __pyx_k_pixelradius, sizeof(__pyx_k_pixelradius), 0, 0, 1, 1},
   {&__pyx_n_s_pixsat, __pyx_k_pixsat, sizeof(__pyx_k_pixsat), 0, 0, 1, 1},
   {&__pyx_n_s_plt, __pyx_k_plt, sizeof(__pyx_k_plt), 0, 0, 1, 1},
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent, __pyx_k_printEvent, sizeof(__pyx_k_printEvent), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent_locals_decorator, __pyx_k_printEvent_locals_decorator, sizeof(__pyx_k_printEvent_locals_decorator), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent_locals_decorator_loca, __pyx_k_printEvent_locals_decorator_loca, sizeof(__pyx_k_printEvent_locals_decorator_loca), 0, 0, 1, 1},
   {&__pyx_n_s_pse_metadata, __pyx_k_pse_metadata, sizeof(__pyx_k_pse_metadata), 0, 0, 1, 1},
   {&__pyx_kp_s_pse_metadata_allsources_csv, __pyx_k_pse_metadata_allsources_csv, sizeof(__pyx_k_pse_metadata_allsources_csv), 0, 0, 1, 0},
   {&__pyx_kp_s_pse_metadata_allsources_sorted_c, __pyx_k_pse_metadata_allsources_sorted_c, sizeof(__pyx_k_pse_metadata_allsources_sorted_c), 0, 0, 1, 0},
   {&__pyx_kp_s_pse_metadata_allsources_sorted_z, __pyx_k_pse_metadata_allsources_sorted_z, sizeof(__pyx_k_pse_metadata_allsources_sorted_z), 0, 0, 1, 0},
   {&__pyx_kp_s_pse_metadata_centroids, __pyx_k_pse_metadata_centroids, sizeof(__pyx_k_pse_metadata_centroids), 0, 0, 1, 0},
   {&__pyx_kp_s_pse_metadata_centroids_png, __pyx_k_pse_metadata_centroids_png, sizeof(__pyx_k_pse_metadata_centroids_png), 0, 0, 1, 0},
   {&__pyx_kp_s_pse_metadata_csv, __pyx_k_pse_metadata_csv, sizeof(__pyx_k_pse_metadata_csv), 0, 0, 1, 0},
@@ -29614,15 +28829,14 @@
   {&__pyx_n_s_sourcesepsize, __pyx_k_sourcesepsize, sizeof(__pyx_k_sourcesepsize), 0, 0, 1, 1},
   {&__pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_k_src_fastrometry_cython_code_PSE, sizeof(__pyx_k_src_fastrometry_cython_code_PSE), 0, 0, 1, 0},
   {&__pyx_n_s_srcindexmap_initial, __pyx_k_srcindexmap_initial, sizeof(__pyx_k_srcindexmap_initial), 0, 0, 1, 1},
   {&__pyx_kp_s_srcindexmap_initial_png, __pyx_k_srcindexmap_initial_png, sizeof(__pyx_k_srcindexmap_initial_png), 0, 0, 1, 0},
   {&__pyx_n_s_srcindexmap_refine, __pyx_k_srcindexmap_refine, sizeof(__pyx_k_srcindexmap_refine), 0, 0, 1, 1},
   {&__pyx_kp_s_srcindexmap_refine_png, __pyx_k_srcindexmap_refine_png, sizeof(__pyx_k_srcindexmap_refine_png), 0, 0, 1, 0},
   {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
-  {&__pyx_n_s_startmessage, __pyx_k_startmessage, sizeof(__pyx_k_startmessage), 0, 0, 1, 1},
   {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
   {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
   {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
@@ -29634,21 +28848,20 @@
   {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
   {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
   {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
   {&__pyx_n_s_verbosity, __pyx_k_verbosity, sizeof(__pyx_k_verbosity), 0, 0, 1, 1},
   {&__pyx_n_s_vmax, __pyx_k_vmax, sizeof(__pyx_k_vmax), 0, 0, 1, 1},
   {&__pyx_n_s_vmin, __pyx_k_vmin, sizeof(__pyx_k_vmin), 0, 0, 1, 1},
-  {&__pyx_n_s_wrapper, __pyx_k_wrapper, sizeof(__pyx_k_wrapper), 0, 0, 1, 1},
   {&__pyx_n_s_yellow, __pyx_k_yellow, sizeof(__pyx_k_yellow), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 67, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 46, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(2, 133, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(2, 148, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(2, 151, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(2, 2, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(2, 404, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(2, 613, __pyx_L1_error)
@@ -29658,441 +28871,394 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "fastrometry/cython_code/PSE.pyx":17
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-  __pyx_tuple_ = PyTuple_Pack(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_verbosity, __pyx_n_s_fout); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 17, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple_);
-  __Pyx_GIVEREF(__pyx_tuple_);
-  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_wrapper, 17, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 17, __pyx_L1_error)
-
-  /* "fastrometry/cython_code/PSE.pyx":16
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-  __pyx_tuple__3 = PyTuple_Pack(3, __pyx_n_s_f, __pyx_n_s_wrapper, __pyx_n_s_wrapper); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 16, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
-  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__3, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_decorator, 16, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 16, __pyx_L1_error)
-
-  /* "fastrometry/cython_code/PSE.pyx":28
- *     return decorator
+  /* "fastrometry/cython_code/PSE.pyx":7
+ * import cython
  * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):             # <<<<<<<<<<<<<<
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  */
-  __pyx_tuple__5 = PyTuple_Pack(2, __pyx_int_7, __pyx_int_7); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 28, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__5);
-  __Pyx_GIVEREF(__pyx_tuple__5);
+  __pyx_tuple_ = PyTuple_Pack(2, __pyx_int_7, __pyx_int_7); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple_);
+  __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "fastrometry/cython_code/PSE.pyx":234
+  /* "fastrometry/cython_code/PSE.pyx":213
  * 
  *         double[:,:] pse_metadata_view = pse_metadata
  *         int[:] islandbnds_view = np.zeros(4,dtype=int)             # <<<<<<<<<<<<<<
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)
  * 
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_int_4); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 234, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_int_4); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "fastrometry/cython_code/PSE.pyx":235
+  /* "fastrometry/cython_code/PSE.pyx":214
  *         double[:,:] pse_metadata_view = pse_metadata
  *         int[:] islandbnds_view = np.zeros(4,dtype=int)
  *         double[:] cntdresults_view = np.zeros(3,dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     if pixsat == 0:         #no saturation in image
  */
-  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 235, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__8);
-  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 214, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__4);
+  __Pyx_GIVEREF(__pyx_tuple__4);
 
-  /* "fastrometry/cython_code/PSE.pyx":270
+  /* "fastrometry/cython_code/PSE.pyx":249
  *             np.savetxt(debug_report/"pse_metadata_islandsonly.csv", pse_metadata, delimiter=",")
  * 
  *         pse_metadata_sorted = pse_metadata[pse_metadata[:,2].argsort()][::-1]             # <<<<<<<<<<<<<<
  *         pse_metadata[:] = pse_metadata_sorted
  * 
  */
-  __pyx_slice__10 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__10)) __PYX_ERR(0, 270, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__10);
-  __Pyx_GIVEREF(__pyx_slice__10);
-  __pyx_tuple__11 = PyTuple_Pack(2, __pyx_slice__10, __pyx_int_2); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 270, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__11);
-  __Pyx_GIVEREF(__pyx_tuple__11);
-  __pyx_slice__12 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__12)) __PYX_ERR(0, 270, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__12);
-  __Pyx_GIVEREF(__pyx_slice__12);
+  __pyx_slice__6 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__6)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__6);
+  __Pyx_GIVEREF(__pyx_slice__6);
+  __pyx_tuple__7 = PyTuple_Pack(2, __pyx_slice__6, __pyx_int_2); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_slice__8 = PySlice_New(Py_None, Py_None, __pyx_int_neg_1); if (unlikely(!__pyx_slice__8)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__8);
+  __Pyx_GIVEREF(__pyx_slice__8);
 
-  /* "fastrometry/cython_code/PSE.pyx":552
+  /* "fastrometry/cython_code/PSE.pyx":533
  *         print("| done")
  *     if debug:
  *         debuggerPlot(bgmap, debug_report, "bgmap.png", figsize=(8,7), vmin=np.percentile(bgmap,1), vmax=np.percentile(bgmap,99), colbar=True, colbar_extend=True, title="Background map", dscrp="Used for determining the amplitude-above-background for each pixel. \nThe PSE does not scan pixels in a thin ({}-pixel-wide) strip around the \nborder, so the background is not calculated there.".format(sourcesep), textpos=0.07)             # <<<<<<<<<<<<<<
  * 
  *     curr_src_ind = 0
  */
-  __pyx_tuple__13 = PyTuple_Pack(2, __pyx_int_8, __pyx_int_7); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 552, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
+  __pyx_tuple__9 = PyTuple_Pack(2, __pyx_int_8, __pyx_int_7); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "fastrometry/cython_code/PSE.pyx":636
+  /* "fastrometry/cython_code/PSE.pyx":617
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  *         plt.figure(figsize=(10,8))             # <<<<<<<<<<<<<<
  *         image_data = fits.getdata(filepath)
  *         plt.subplots_adjust(bottom=0.15)
  */
-  __pyx_tuple__14 = PyTuple_Pack(2, __pyx_int_10, __pyx_int_8); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 636, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_tuple__10 = PyTuple_Pack(2, __pyx_int_10, __pyx_int_8); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__10);
+  __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "fastrometry/cython_code/PSE.pyx":640
+  /* "fastrometry/cython_code/PSE.pyx":621
  *         plt.subplots_adjust(bottom=0.15)
  *         plt.imshow(image_data, cmap="gray", norm=LogNorm())
  *         plt.scatter(pse_metadata[:,0], pse_metadata[:,1], color='red', marker='.')             # <<<<<<<<<<<<<<
  *         plt.title("pse_metadata centroids")
  *         dscrp="Centroids from the pse_metadata, plotted overtop the image."
  */
-  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_slice__10, __pyx_int_0); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 640, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
-  __pyx_tuple__16 = PyTuple_Pack(2, __pyx_slice__10, __pyx_int_1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 640, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__16);
-  __Pyx_GIVEREF(__pyx_tuple__16);
+  __pyx_tuple__11 = PyTuple_Pack(2, __pyx_slice__6, __pyx_int_0); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__11);
+  __Pyx_GIVEREF(__pyx_tuple__11);
+  __pyx_tuple__12 = PyTuple_Pack(2, __pyx_slice__6, __pyx_int_1); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__12);
+  __Pyx_GIVEREF(__pyx_tuple__12);
 
   /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(1, 945, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(1, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__14);
+  __Pyx_GIVEREF(__pyx_tuple__14);
 
   /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 951, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__19);
-  __Pyx_GIVEREF(__pyx_tuple__19);
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(1, 951, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
 
   /* "View.MemoryView":133
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(2, 133, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(2, 133, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
 
   /* "View.MemoryView":136
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(2, 136, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(2, 136, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
 
   /* "View.MemoryView":148
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(2, 148, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(2, 148, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
   /* "View.MemoryView":176
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(2, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(2, 176, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
   /* "View.MemoryView":192
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(2, 192, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(2, 192, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "View.MemoryView":418
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 418, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(2, 418, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "View.MemoryView":495
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 495, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(2, 495, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "View.MemoryView":520
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 520, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(2, 520, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "View.MemoryView":570
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 570, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 570, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "View.MemoryView":577
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__31 = PyTuple_New(1); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 577, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
+  __pyx_tuple__27 = PyTuple_New(1); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 577, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__31, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  PyTuple_SET_ITEM(__pyx_tuple__27, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "View.MemoryView":703
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(2, 703, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 703, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
-  __pyx_tuple__37 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
-  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
+  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__33 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
   /* "fastrometry/cython_code/PSE.pyx":7
  * import cython
  * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-  __pyx_tuple__38 = PyTuple_Pack(5, __pyx_n_s_startmessage, __pyx_n_s_endmessage, __pyx_n_s_levelneeded, __pyx_n_s_decorator, __pyx_n_s_decorator); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_printEvent, 7, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 7, __pyx_L1_error)
-
-  /* "fastrometry/cython_code/PSE.pyx":28
- *     return decorator
- * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):             # <<<<<<<<<<<<<<
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  */
-  __pyx_tuple__40 = PyTuple_Pack(20, __pyx_n_s_array, __pyx_n_s_debug_report, __pyx_n_s_savename, __pyx_n_s_figsize, __pyx_n_s_bottom, __pyx_n_s_vmin, __pyx_n_s_vmax, __pyx_n_s_colbar, __pyx_n_s_colbar_extend, __pyx_n_s_title, __pyx_n_s_dscrp, __pyx_n_s_textpos, __pyx_n_s_colors, __pyx_n_s_boundaries, __pyx_n_s_plt, __pyx_n_s_Normalize, __pyx_n_s_ListedColormap, __pyx_n_s_extend, __pyx_n_s_cm, __pyx_n_s_nm); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 28, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
-  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(14, 0, 20, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__40, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_debuggerPlot, 28, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_tuple__34 = PyTuple_Pack(20, __pyx_n_s_array, __pyx_n_s_debug_report, __pyx_n_s_savename, __pyx_n_s_figsize, __pyx_n_s_bottom, __pyx_n_s_vmin, __pyx_n_s_vmax, __pyx_n_s_colbar, __pyx_n_s_colbar_extend, __pyx_n_s_title, __pyx_n_s_dscrp, __pyx_n_s_textpos, __pyx_n_s_colors, __pyx_n_s_boundaries, __pyx_n_s_plt, __pyx_n_s_Normalize, __pyx_n_s_ListedColormap, __pyx_n_s_extend, __pyx_n_s_cm, __pyx_n_s_nm); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 7, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(14, 0, 20, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_debuggerPlot, 7, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 7, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/PSE.pyx":521
+  /* "fastrometry/cython_code/PSE.pyx":500
  *     return curr_src_ind
  * 
- * @printEvent("Extracting sources from image...", "done", 1)             # <<<<<<<<<<<<<<
- * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
- * 
- */
-  __pyx_tuple__42 = PyTuple_Pack(3, __pyx_kp_s_Extracting_sources_from_image, __pyx_n_s_done_3, __pyx_int_1); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 521, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
-
-  /* "fastrometry/cython_code/PSE.pyx":522
- * 
- * @printEvent("Extracting sources from image...", "done", 1)
  * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):             # <<<<<<<<<<<<<<
  * 
- *     num_psesources = 0
+ *     if verbosity >= 1:
  */
-  __pyx_tuple__43 = PyTuple_Pack(38, __pyx_n_s_img, __pyx_n_s_img_xmax, __pyx_n_s_img_ymax, __pyx_n_s_kernelrad, __pyx_n_s_sourcesep, __pyx_n_s_pixsat, __pyx_n_s_npts, __pyx_n_s_nrefinepts, __pyx_n_s_pixelradius, __pyx_n_s_shape, __pyx_n_s_srcindexmap_initial, __pyx_n_s_srcindexmap_refine, __pyx_n_s_pse_metadata, __pyx_n_s_debug_report, __pyx_n_s_filepath, __pyx_n_s_debug, __pyx_n_s_verbosity, __pyx_n_s_num_psesources, __pyx_n_s_leftmostsafe_x, __pyx_n_s_rightmostsafe_x, __pyx_n_s_topmostsafe_y, __pyx_n_s_bottommostsafe_y, __pyx_n_s_roi, __pyx_n_s_colors, __pyx_n_s_bgmap, __pyx_n_s_curr_src_ind, __pyx_n_s_occupymap, __pyx_n_s_kernelsize, __pyx_n_s_kernelcircle, __pyx_n_s_sourcesepsize, __pyx_n_s_sourcesepcircle, __pyx_n_s_img_median, __pyx_n_s_img_max, __pyx_n_s_plt, __pyx_n_s_LogNorm, __pyx_n_s_fits, __pyx_n_s_image_data, __pyx_n_s_dscrp); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 522, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
-  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(17, 0, 38, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_PSE, 522, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 522, __pyx_L1_error)
+  __pyx_tuple__36 = PyTuple_Pack(38, __pyx_n_s_img, __pyx_n_s_img_xmax, __pyx_n_s_img_ymax, __pyx_n_s_kernelrad, __pyx_n_s_sourcesep, __pyx_n_s_pixsat, __pyx_n_s_npts, __pyx_n_s_nrefinepts, __pyx_n_s_pixelradius, __pyx_n_s_shape, __pyx_n_s_srcindexmap_initial, __pyx_n_s_srcindexmap_refine, __pyx_n_s_pse_metadata, __pyx_n_s_debug_report, __pyx_n_s_filepath, __pyx_n_s_debug, __pyx_n_s_verbosity, __pyx_n_s_num_psesources, __pyx_n_s_leftmostsafe_x, __pyx_n_s_rightmostsafe_x, __pyx_n_s_topmostsafe_y, __pyx_n_s_bottommostsafe_y, __pyx_n_s_roi, __pyx_n_s_colors, __pyx_n_s_bgmap, __pyx_n_s_curr_src_ind, __pyx_n_s_occupymap, __pyx_n_s_kernelsize, __pyx_n_s_kernelcircle, __pyx_n_s_sourcesepsize, __pyx_n_s_sourcesepcircle, __pyx_n_s_img_median, __pyx_n_s_img_max, __pyx_n_s_plt, __pyx_n_s_LogNorm, __pyx_n_s_fits, __pyx_n_s_image_data, __pyx_n_s_dscrp); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 500, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(17, 0, 38, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_PSE, __pyx_n_s_PSE, 500, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 500, __pyx_L1_error)
 
   /* "View.MemoryView":286
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(2, 286, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__45);
-  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(2, 286, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
 
   /* "View.MemoryView":287
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__46 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(2, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
+  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
 
   /* "View.MemoryView":288
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(2, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__47);
-  __Pyx_GIVEREF(__pyx_tuple__47);
+  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__40);
+  __Pyx_GIVEREF(__pyx_tuple__40);
 
   /* "View.MemoryView":291
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(2, 291, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
+  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(2, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
 
   /* "View.MemoryView":292
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(2, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__49);
-  __Pyx_GIVEREF(__pyx_tuple__49);
+  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__42);
+  __Pyx_GIVEREF(__pyx_tuple__42);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__50 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
-  __pyx_codeobj__51 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __pyx_tuple__43 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -30208,30 +29374,14 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  if (PyType_Ready(&__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
-  #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent.tp_print = 0;
-  #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent.tp_dictoffset && __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
-  }
-  __pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent = &__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct__printEvent;
-  if (PyType_Ready(&__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
-  #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator.tp_print = 0;
-  #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator.tp_dictoffset && __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
-  }
-  __pyx_ptype_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator = &__pyx_type_11fastrometry_11cython_code_3PSE___pyx_scope_struct_1_decorator;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(2, 105, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
   if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(2, 105, __pyx_L1_error)
@@ -30454,16 +29604,15 @@
 
 static CYTHON_SMALL_CODE int __pyx_pymod_exec_PSE(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  static PyThread_type_lock __pyx_t_4[8];
+  static PyThread_type_lock __pyx_t_3[8];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
@@ -30594,164 +29743,127 @@
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_2) < 0) __PYX_ERR(0, 2, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "fastrometry/cython_code/PSE.pyx":7
  * import cython
  * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3PSE_1printEvent, NULL, __pyx_n_s_fastrometry_cython_code_PSE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_printEvent, __pyx_t_2) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":28
- *     return decorator
- * 
  * def debuggerPlot(array, debug_report, savename, figsize=(7,7), bottom=0.2, vmin=None, vmax=None, colbar=False, colbar_extend=False, title=None, dscrp=None, textpos=0.1, colors=None, boundaries=None):             # <<<<<<<<<<<<<<
  *     import matplotlib.pyplot as plt
  *     from matplotlib.colors import Normalize
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3PSE_3debuggerPlot, NULL, __pyx_n_s_fastrometry_cython_code_PSE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3PSE_1debuggerPlot, NULL, __pyx_n_s_fastrometry_cython_code_PSE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_debuggerPlot, __pyx_t_2) < 0) __PYX_ERR(0, 28, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_debuggerPlot, __pyx_t_2) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/PSE.pyx":521
+  /* "fastrometry/cython_code/PSE.pyx":500
  *     return curr_src_ind
  * 
- * @printEvent("Extracting sources from image...", "done", 1)             # <<<<<<<<<<<<<<
- * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
- * 
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_printEvent); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "fastrometry/cython_code/PSE.pyx":522
- * 
- * @printEvent("Extracting sources from image...", "done", 1)
  * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):             # <<<<<<<<<<<<<<
  * 
- *     num_psesources = 0
+ *     if verbosity >= 1:
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3PSE_5PSE, NULL, __pyx_n_s_fastrometry_cython_code_PSE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3PSE_3PSE, NULL, __pyx_n_s_fastrometry_cython_code_PSE); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 500, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-
-  /* "fastrometry/cython_code/PSE.pyx":521
- *     return curr_src_ind
- * 
- * @printEvent("Extracting sources from image...", "done", 1)             # <<<<<<<<<<<<<<
- * def PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, shape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity):
- * 
- */
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 521, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_PSE, __pyx_t_2) < 0) __PYX_ERR(0, 500, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_PSE, __pyx_t_3) < 0) __PYX_ERR(0, 522, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "fastrometry/cython_code/PSE.pyx":1
  * from astropy.io import fits             # <<<<<<<<<<<<<<
  * import numpy as np
  * from libc.math cimport sqrt
  */
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_3) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "View.MemoryView":209
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(array self):
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 209, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 209, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 209, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 209, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_array_type);
 
   /* "View.MemoryView":286
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 286, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__38, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 286, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(generic);
-  __Pyx_DECREF_SET(generic, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(generic, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":287
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__46, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(strided);
-  __Pyx_DECREF_SET(strided, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(strided, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":288
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect);
-  __Pyx_DECREF_SET(indirect, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(indirect, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":291
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 291, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(contiguous);
-  __Pyx_DECREF_SET(contiguous, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(contiguous, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":292
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect_contiguous);
-  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":316
  * 
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0             # <<<<<<<<<<<<<<
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [
  *     PyThread_allocate_lock(),
@@ -30761,59 +29873,59 @@
   /* "View.MemoryView":317
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [             # <<<<<<<<<<<<<<
  *     PyThread_allocate_lock(),
  *     PyThread_allocate_lock(),
  */
-  __pyx_t_4[0] = PyThread_allocate_lock();
-  __pyx_t_4[1] = PyThread_allocate_lock();
-  __pyx_t_4[2] = PyThread_allocate_lock();
-  __pyx_t_4[3] = PyThread_allocate_lock();
-  __pyx_t_4[4] = PyThread_allocate_lock();
-  __pyx_t_4[5] = PyThread_allocate_lock();
-  __pyx_t_4[6] = PyThread_allocate_lock();
-  __pyx_t_4[7] = PyThread_allocate_lock();
-  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_4, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
+  __pyx_t_3[0] = PyThread_allocate_lock();
+  __pyx_t_3[1] = PyThread_allocate_lock();
+  __pyx_t_3[2] = PyThread_allocate_lock();
+  __pyx_t_3[3] = PyThread_allocate_lock();
+  __pyx_t_3[4] = PyThread_allocate_lock();
+  __pyx_t_3[5] = PyThread_allocate_lock();
+  __pyx_t_3[6] = PyThread_allocate_lock();
+  __pyx_t_3[7] = PyThread_allocate_lock();
+  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_3, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
 
   /* "View.MemoryView":549
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 549, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 549, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 549, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 549, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_memoryview_type);
 
   /* "View.MemoryView":995
  *         return self.from_object
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 995, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 995, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 995, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 995, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_memoryviewslice_type);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_t_3 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_3) < 0) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_2) < 0) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "(tree fragment)":11
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
@@ -30821,15 +29933,14 @@
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
   if (__pyx_m) {
     if (__pyx_d) {
       __Pyx_AddTraceback("init fastrometry.cython_code.PSE", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
     PyErr_SetString(PyExc_ImportError, "init fastrometry.cython_code.PSE");
@@ -31029,829 +30140,14 @@
         "%s() got an unexpected keyword argument '%U'",
         function_name, key);
     #endif
 bad:
     return -1;
 }
 
-/* KeywordStringCheck */
-static int __Pyx_CheckKeywordStrings(
-    PyObject *kwdict,
-    const char* function_name,
-    int kw_allowed)
-{
-    PyObject* key = 0;
-    Py_ssize_t pos = 0;
-#if CYTHON_COMPILING_IN_PYPY
-    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
-        goto invalid_keyword;
-    return 1;
-#else
-    while (PyDict_Next(kwdict, &pos, &key, 0)) {
-        #if PY_MAJOR_VERSION < 3
-        if (unlikely(!PyString_Check(key)))
-        #endif
-            if (unlikely(!PyUnicode_Check(key)))
-                goto invalid_keyword_type;
-    }
-    if ((!kw_allowed) && unlikely(key))
-        goto invalid_keyword;
-    return 1;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    return 0;
-#endif
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
-    #endif
-    return 0;
-}
-
-/* GetItemInt */
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
-    PyObject *r;
-    if (!j) return NULL;
-    r = PyObject_GetItem(o, j);
-    Py_DECREF(j);
-    return r;
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyList_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
-        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
-    }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyTuple_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
-        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
-    }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
-                                                     CYTHON_NCP_UNUSED int wraparound,
-                                                     CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
-    if (is_list || PyList_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
-        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
-            PyObject *r = PyList_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    }
-    else if (PyTuple_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
-        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
-            PyObject *r = PyTuple_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    } else {
-        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
-        if (likely(m && m->sq_item)) {
-            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
-                Py_ssize_t l = m->sq_length(o);
-                if (likely(l >= 0)) {
-                    i += l;
-                } else {
-                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                        return NULL;
-                    PyErr_Clear();
-                }
-            }
-            return m->sq_item(o, i);
-        }
-    }
-#else
-    if (is_list || PySequence_Check(o)) {
-        return PySequence_GetItem(o, i);
-    }
-#endif
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-}
-
-/* None */
-static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
-    PyErr_Format(PyExc_NameError, "free variable '%s' referenced before assignment in enclosing scope", varname);
-}
-
-/* PyObjectCall */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    PyObject *result;
-    ternaryfunc call = Py_TYPE(func)->tp_call;
-    if (unlikely(!call))
-        return PyObject_Call(func, arg, kw);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = (*call)(func, arg, kw);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
-/* FetchCommonType */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
-    PyObject* fake_module;
-    PyTypeObject* cached_type = NULL;
-    fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
-    if (!fake_module) return NULL;
-    Py_INCREF(fake_module);
-    cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
-    if (cached_type) {
-        if (!PyType_Check((PyObject*)cached_type)) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s is not a type object",
-                type->tp_name);
-            goto bad;
-        }
-        if (cached_type->tp_basicsize != type->tp_basicsize) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s has the wrong size, try recompiling",
-                type->tp_name);
-            goto bad;
-        }
-    } else {
-        if (!PyErr_ExceptionMatches(PyExc_AttributeError)) goto bad;
-        PyErr_Clear();
-        if (PyType_Ready(type) < 0) goto bad;
-        if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject*) type) < 0)
-            goto bad;
-        Py_INCREF(type);
-        cached_type = type;
-    }
-done:
-    Py_DECREF(fake_module);
-    return cached_type;
-bad:
-    Py_XDECREF(cached_type);
-    cached_type = NULL;
-    goto done;
-}
-
-/* CythonFunctionShared */
-#include <structmember.h>
-static PyObject *
-__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
-{
-    if (unlikely(op->func_doc == NULL)) {
-        if (op->func.m_ml->ml_doc) {
-#if PY_MAJOR_VERSION >= 3
-            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
-#else
-            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
-#endif
-            if (unlikely(op->func_doc == NULL))
-                return NULL;
-        } else {
-            Py_INCREF(Py_None);
-            return Py_None;
-        }
-    }
-    Py_INCREF(op->func_doc);
-    return op->func_doc;
-}
-static int
-__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp = op->func_doc;
-    if (value == NULL) {
-        value = Py_None;
-    }
-    Py_INCREF(value);
-    op->func_doc = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_name == NULL)) {
-#if PY_MAJOR_VERSION >= 3
-        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
-#else
-        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
-#endif
-        if (unlikely(op->func_name == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_name);
-    return op->func_name;
-}
-static int
-__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
-#endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__name__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_name;
-    Py_INCREF(value);
-    op->func_name = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_qualname);
-    return op->func_qualname;
-}
-static int
-__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
-#endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__qualname__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_qualname;
-    Py_INCREF(value);
-    op->func_qualname = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
-{
-    PyObject *self;
-    self = m->func_closure;
-    if (self == NULL)
-        self = Py_None;
-    Py_INCREF(self);
-    return self;
-}
-static PyObject *
-__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_dict == NULL)) {
-        op->func_dict = PyDict_New();
-        if (unlikely(op->func_dict == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_dict);
-    return op->func_dict;
-}
-static int
-__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-    if (unlikely(value == NULL)) {
-        PyErr_SetString(PyExc_TypeError,
-               "function's dictionary may not be deleted");
-        return -1;
-    }
-    if (unlikely(!PyDict_Check(value))) {
-        PyErr_SetString(PyExc_TypeError,
-               "setting function's dictionary to a non-dict");
-        return -1;
-    }
-    tmp = op->func_dict;
-    Py_INCREF(value);
-    op->func_dict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_globals);
-    return op->func_globals;
-}
-static PyObject *
-__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(Py_None);
-    return Py_None;
-}
-static PyObject *
-__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    PyObject* result = (op->func_code) ? op->func_code : Py_None;
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
-    int result = 0;
-    PyObject *res = op->defaults_getter((PyObject *) op);
-    if (unlikely(!res))
-        return -1;
-    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
-    Py_INCREF(op->defaults_tuple);
-    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
-    Py_INCREF(op->defaults_kwdict);
-    #else
-    op->defaults_tuple = PySequence_ITEM(res, 0);
-    if (unlikely(!op->defaults_tuple)) result = -1;
-    else {
-        op->defaults_kwdict = PySequence_ITEM(res, 1);
-        if (unlikely(!op->defaults_kwdict)) result = -1;
-    }
-    #endif
-    Py_DECREF(res);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyTuple_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__defaults__ must be set to a tuple object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_tuple;
-    op->defaults_tuple = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_tuple;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_tuple;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__kwdefaults__ must be set to a dict object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_kwdict;
-    op->defaults_kwdict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_kwdict;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_kwdict;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value || value == Py_None) {
-        value = NULL;
-    } else if (!PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__annotations__ must be set to a dict object");
-        return -1;
-    }
-    Py_XINCREF(value);
-    tmp = op->func_annotations;
-    op->func_annotations = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->func_annotations;
-    if (unlikely(!result)) {
-        result = PyDict_New();
-        if (unlikely(!result)) return NULL;
-        op->func_annotations = result;
-    }
-    Py_INCREF(result);
-    return result;
-}
-static PyGetSetDef __pyx_CyFunction_getsets[] = {
-    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
-    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
-    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
-    {(char *) "__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
-    {0, 0, 0, 0, 0}
-};
-static PyMemberDef __pyx_CyFunction_members[] = {
-    {(char *) "__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module), PY_WRITE_RESTRICTED, 0},
-    {0, 0, 0,  0, 0}
-};
-static PyObject *
-__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
-{
-#if PY_MAJOR_VERSION >= 3
-    Py_INCREF(m->func_qualname);
-    return m->func_qualname;
-#else
-    return PyString_FromString(m->func.m_ml->ml_name);
-#endif
-}
-static PyMethodDef __pyx_CyFunction_methods[] = {
-    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
-    {0, 0, 0, 0}
-};
-#if PY_VERSION_HEX < 0x030500A0
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
-#else
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
-#endif
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op, PyMethodDef *ml, int flags, PyObject* qualname,
-                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    if (unlikely(op == NULL))
-        return NULL;
-    op->flags = flags;
-    __Pyx_CyFunction_weakreflist(op) = NULL;
-    op->func.m_ml = ml;
-    op->func.m_self = (PyObject *) op;
-    Py_XINCREF(closure);
-    op->func_closure = closure;
-    Py_XINCREF(module);
-    op->func.m_module = module;
-    op->func_dict = NULL;
-    op->func_name = NULL;
-    Py_INCREF(qualname);
-    op->func_qualname = qualname;
-    op->func_doc = NULL;
-    op->func_classobj = NULL;
-    op->func_globals = globals;
-    Py_INCREF(op->func_globals);
-    Py_XINCREF(code);
-    op->func_code = code;
-    op->defaults_pyobjects = 0;
-    op->defaults_size = 0;
-    op->defaults = NULL;
-    op->defaults_tuple = NULL;
-    op->defaults_kwdict = NULL;
-    op->defaults_getter = NULL;
-    op->func_annotations = NULL;
-    return (PyObject *) op;
-}
-static int
-__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
-{
-    Py_CLEAR(m->func_closure);
-    Py_CLEAR(m->func.m_module);
-    Py_CLEAR(m->func_dict);
-    Py_CLEAR(m->func_name);
-    Py_CLEAR(m->func_qualname);
-    Py_CLEAR(m->func_doc);
-    Py_CLEAR(m->func_globals);
-    Py_CLEAR(m->func_code);
-    Py_CLEAR(m->func_classobj);
-    Py_CLEAR(m->defaults_tuple);
-    Py_CLEAR(m->defaults_kwdict);
-    Py_CLEAR(m->func_annotations);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_XDECREF(pydefaults[i]);
-        PyObject_Free(m->defaults);
-        m->defaults = NULL;
-    }
-    return 0;
-}
-static void __Pyx__CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    if (__Pyx_CyFunction_weakreflist(m) != NULL)
-        PyObject_ClearWeakRefs((PyObject *) m);
-    __Pyx_CyFunction_clear(m);
-    PyObject_GC_Del(m);
-}
-static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    PyObject_GC_UnTrack(m);
-    __Pyx__CyFunction_dealloc(m);
-}
-static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
-{
-    Py_VISIT(m->func_closure);
-    Py_VISIT(m->func.m_module);
-    Py_VISIT(m->func_dict);
-    Py_VISIT(m->func_name);
-    Py_VISIT(m->func_qualname);
-    Py_VISIT(m->func_doc);
-    Py_VISIT(m->func_globals);
-    Py_VISIT(m->func_code);
-    Py_VISIT(m->func_classobj);
-    Py_VISIT(m->defaults_tuple);
-    Py_VISIT(m->defaults_kwdict);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_VISIT(pydefaults[i]);
-    }
-    return 0;
-}
-static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
-{
-#if PY_MAJOR_VERSION < 3
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
-        Py_INCREF(func);
-        return func;
-    }
-    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
-        if (type == NULL)
-            type = (PyObject *)(Py_TYPE(obj));
-        return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
-    }
-    if (obj == Py_None)
-        obj = NULL;
-#endif
-    return __Pyx_PyMethod_New(func, obj, type);
-}
-static PyObject*
-__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
-{
-#if PY_MAJOR_VERSION >= 3
-    return PyUnicode_FromFormat("<cyfunction %U at %p>",
-                                op->func_qualname, (void *)op);
-#else
-    return PyString_FromFormat("<cyfunction %s at %p>",
-                               PyString_AsString(op->func_qualname), (void *)op);
-#endif
-}
-static PyObject * __Pyx_CyFunction_CallMethod(PyObject *func, PyObject *self, PyObject *arg, PyObject *kw) {
-    PyCFunctionObject* f = (PyCFunctionObject*)func;
-    PyCFunction meth = f->m_ml->ml_meth;
-    Py_ssize_t size;
-    switch (f->m_ml->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
-    case METH_VARARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0))
-            return (*meth)(self, arg);
-        break;
-    case METH_VARARGS | METH_KEYWORDS:
-        return (*(PyCFunctionWithKeywords)(void*)meth)(self, arg, kw);
-    case METH_NOARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 0))
-                return (*meth)(self, NULL);
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    case METH_O:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 1)) {
-                PyObject *result, *arg0;
-                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                arg0 = PyTuple_GET_ITEM(arg, 0);
-                #else
-                arg0 = PySequence_ITEM(arg, 0); if (unlikely(!arg0)) return NULL;
-                #endif
-                result = (*meth)(self, arg0);
-                #if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-                Py_DECREF(arg0);
-                #endif
-                return result;
-            }
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    default:
-        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
-                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
-                        "longer supported!");
-        return NULL;
-    }
-    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
-                 f->m_ml->ml_name);
-    return NULL;
-}
-static CYTHON_INLINE PyObject *__Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    return __Pyx_CyFunction_CallMethod(func, ((PyCFunctionObject*)func)->m_self, arg, kw);
-}
-static PyObject *__Pyx_CyFunction_CallAsMethod(PyObject *func, PyObject *args, PyObject *kw) {
-    PyObject *result;
-    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *) func;
-    if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) && !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
-        Py_ssize_t argc;
-        PyObject *new_args;
-        PyObject *self;
-        argc = PyTuple_GET_SIZE(args);
-        new_args = PyTuple_GetSlice(args, 1, argc);
-        if (unlikely(!new_args))
-            return NULL;
-        self = PyTuple_GetItem(args, 0);
-        if (unlikely(!self)) {
-            Py_DECREF(new_args);
-            PyErr_Format(PyExc_TypeError,
-                         "unbound method %.200S() needs an argument",
-                         cyfunc->func_qualname);
-            return NULL;
-        }
-        result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
-        Py_DECREF(new_args);
-    } else {
-        result = __Pyx_CyFunction_Call(func, args, kw);
-    }
-    return result;
-}
-static PyTypeObject __pyx_CyFunctionType_type = {
-    PyVarObject_HEAD_INIT(0, 0)
-    "cython_function_or_method",
-    sizeof(__pyx_CyFunctionObject),
-    0,
-    (destructor) __Pyx_CyFunction_dealloc,
-    0,
-    0,
-    0,
-#if PY_MAJOR_VERSION < 3
-    0,
-#else
-    0,
-#endif
-    (reprfunc) __Pyx_CyFunction_repr,
-    0,
-    0,
-    0,
-    0,
-    __Pyx_CyFunction_CallAsMethod,
-    0,
-    0,
-    0,
-    0,
-    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
-    0,
-    (traverseproc) __Pyx_CyFunction_traverse,
-    (inquiry) __Pyx_CyFunction_clear,
-    0,
-#if PY_VERSION_HEX < 0x030500A0
-    offsetof(__pyx_CyFunctionObject, func_weakreflist),
-#else
-    offsetof(PyCFunctionObject, m_weakreflist),
-#endif
-    0,
-    0,
-    __pyx_CyFunction_methods,
-    __pyx_CyFunction_members,
-    __pyx_CyFunction_getsets,
-    0,
-    0,
-    __Pyx_CyFunction_descr_get,
-    0,
-    offsetof(__pyx_CyFunctionObject, func_dict),
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-#if PY_VERSION_HEX >= 0x030400a1
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-    0,
-#endif
-#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-    0,
-#endif
-};
-static int __pyx_CyFunction_init(void) {
-    __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
-    if (unlikely(__pyx_CyFunctionType == NULL)) {
-        return -1;
-    }
-    return 0;
-}
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults = PyObject_Malloc(size);
-    if (unlikely(!m->defaults))
-        return PyErr_NoMemory();
-    memset(m->defaults, 0, size);
-    m->defaults_pyobjects = pyobjects;
-    m->defaults_size = size;
-    return m->defaults;
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_tuple = tuple;
-    Py_INCREF(tuple);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_kwdict = dict;
-    Py_INCREF(dict);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->func_annotations = dict;
-    Py_INCREF(dict);
-}
-
-/* CythonFunction */
-static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
-                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    PyObject *op = __Pyx_CyFunction_Init(
-        PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType),
-        ml, flags, qualname, closure, module, globals, code
-    );
-    if (likely(op)) {
-        PyObject_GC_Track(op);
-    }
-    return op;
-}
-
 /* Import */
 static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
     PyObject *empty_list = 0;
     PyObject *module = 0;
     PyObject *global_dict = 0;
     PyObject *empty_dict = 0;
     PyObject *list;
@@ -32065,14 +30361,34 @@
 done:
     Py_LeaveRecursiveCall();
     return result;
 }
 #endif
 #endif
 
+/* PyObjectCall */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
+    PyObject *result;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
+    if (unlikely(!call))
+        return PyObject_Call(func, arg, kw);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = (*call)(func, arg, kw);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
 /* PyObjectCall2Args */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
     PyObject *args, *result = NULL;
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(function)) {
         PyObject *args[2] = {arg1, arg2};
         return __Pyx_PyFunction_FastCall(function, args, 2);
@@ -32154,14 +30470,101 @@
     if (unlikely(!args)) return NULL;
     result = __Pyx_PyObject_Call(func, args, NULL);
     Py_DECREF(args);
     return result;
 }
 #endif
 
+/* GetItemInt */
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
+    PyObject *r;
+    if (!j) return NULL;
+    r = PyObject_GetItem(o, j);
+    Py_DECREF(j);
+    return r;
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyList_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
+        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyTuple_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
+        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
+                                                     CYTHON_NCP_UNUSED int wraparound,
+                                                     CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
+    if (is_list || PyList_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
+        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
+            PyObject *r = PyList_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    }
+    else if (PyTuple_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
+        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
+            PyObject *r = PyTuple_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    } else {
+        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
+        if (likely(m && m->sq_item)) {
+            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
+                Py_ssize_t l = m->sq_length(o);
+                if (likely(l >= 0)) {
+                    i += l;
+                } else {
+                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
+                        return NULL;
+                    PyErr_Clear();
+                }
+            }
+            return m->sq_item(o, i);
+        }
+    }
+#else
+    if (is_list || PySequence_Check(o)) {
+        return PySequence_GetItem(o, i);
+    }
+#endif
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+}
+
 /* PyIntBinop */
 #if !CYTHON_COMPILING_IN_PYPY
 static PyObject* __Pyx_PyInt_AddObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, int inplace, int zerodivision_check) {
     (void)inplace;
     (void)zerodivision_check;
     #if PY_MAJOR_VERSION < 3
     if (likely(PyInt_CheckExact(op1))) {
@@ -34672,120 +33075,14 @@
     cobj = PyCapsule_New(p, sig, NULL);
 #else
     cobj = PyCObject_FromVoidPtr(p, NULL);
 #endif
     return cobj;
 }
 
-/* Print */
-  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
-static PyObject *__Pyx_GetStdout(void) {
-    PyObject *f = PySys_GetObject((char *)"stdout");
-    if (!f) {
-        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
-    }
-    return f;
-}
-static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
-    int i;
-    if (!f) {
-        if (!(f = __Pyx_GetStdout()))
-            return -1;
-    }
-    Py_INCREF(f);
-    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
-        PyObject* v;
-        if (PyFile_SoftSpace(f, 1)) {
-            if (PyFile_WriteString(" ", f) < 0)
-                goto error;
-        }
-        v = PyTuple_GET_ITEM(arg_tuple, i);
-        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
-            goto error;
-        if (PyString_Check(v)) {
-            char *s = PyString_AsString(v);
-            Py_ssize_t len = PyString_Size(v);
-            if (len > 0) {
-                switch (s[len-1]) {
-                    case ' ': break;
-                    case '\f': case '\r': case '\n': case '\t': case '\v':
-                        PyFile_SoftSpace(f, 0);
-                        break;
-                    default:  break;
-                }
-            }
-        }
-    }
-    if (newline) {
-        if (PyFile_WriteString("\n", f) < 0)
-            goto error;
-        PyFile_SoftSpace(f, 0);
-    }
-    Py_DECREF(f);
-    return 0;
-error:
-    Py_DECREF(f);
-    return -1;
-}
-#else
-static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
-    PyObject* kwargs = 0;
-    PyObject* result = 0;
-    PyObject* end_string;
-    if (unlikely(!__pyx_print)) {
-        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
-        if (!__pyx_print)
-            return -1;
-    }
-    if (stream) {
-        kwargs = PyDict_New();
-        if (unlikely(!kwargs))
-            return -1;
-        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
-            goto bad;
-        if (!newline) {
-            end_string = PyUnicode_FromStringAndSize(" ", 1);
-            if (unlikely(!end_string))
-                goto bad;
-            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
-                Py_DECREF(end_string);
-                goto bad;
-            }
-            Py_DECREF(end_string);
-        }
-    } else if (!newline) {
-        if (unlikely(!__pyx_print_kwargs)) {
-            __pyx_print_kwargs = PyDict_New();
-            if (unlikely(!__pyx_print_kwargs))
-                return -1;
-            end_string = PyUnicode_FromStringAndSize(" ", 1);
-            if (unlikely(!end_string))
-                return -1;
-            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
-                Py_DECREF(end_string);
-                return -1;
-            }
-            Py_DECREF(end_string);
-        }
-        kwargs = __pyx_print_kwargs;
-    }
-    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
-    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
-        Py_DECREF(kwargs);
-    if (!result)
-        return -1;
-    Py_DECREF(result);
-    return 0;
-bad:
-    if (kwargs != __pyx_print_kwargs)
-        Py_XDECREF(kwargs);
-    return -1;
-}
-#endif
-
 /* TypeInfoCompare */
   static int
 __pyx_typeinfo_cmp(__Pyx_TypeInfo *a, __Pyx_TypeInfo *b)
 {
     int i;
     if (!a || !b)
         return 0;
@@ -35069,14 +33366,120 @@
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
+/* Print */
+  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
+static PyObject *__Pyx_GetStdout(void) {
+    PyObject *f = PySys_GetObject((char *)"stdout");
+    if (!f) {
+        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
+    }
+    return f;
+}
+static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
+    int i;
+    if (!f) {
+        if (!(f = __Pyx_GetStdout()))
+            return -1;
+    }
+    Py_INCREF(f);
+    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
+        PyObject* v;
+        if (PyFile_SoftSpace(f, 1)) {
+            if (PyFile_WriteString(" ", f) < 0)
+                goto error;
+        }
+        v = PyTuple_GET_ITEM(arg_tuple, i);
+        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
+            goto error;
+        if (PyString_Check(v)) {
+            char *s = PyString_AsString(v);
+            Py_ssize_t len = PyString_Size(v);
+            if (len > 0) {
+                switch (s[len-1]) {
+                    case ' ': break;
+                    case '\f': case '\r': case '\n': case '\t': case '\v':
+                        PyFile_SoftSpace(f, 0);
+                        break;
+                    default:  break;
+                }
+            }
+        }
+    }
+    if (newline) {
+        if (PyFile_WriteString("\n", f) < 0)
+            goto error;
+        PyFile_SoftSpace(f, 0);
+    }
+    Py_DECREF(f);
+    return 0;
+error:
+    Py_DECREF(f);
+    return -1;
+}
+#else
+static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
+    PyObject* kwargs = 0;
+    PyObject* result = 0;
+    PyObject* end_string;
+    if (unlikely(!__pyx_print)) {
+        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
+        if (!__pyx_print)
+            return -1;
+    }
+    if (stream) {
+        kwargs = PyDict_New();
+        if (unlikely(!kwargs))
+            return -1;
+        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
+            goto bad;
+        if (!newline) {
+            end_string = PyUnicode_FromStringAndSize(" ", 1);
+            if (unlikely(!end_string))
+                goto bad;
+            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
+                Py_DECREF(end_string);
+                goto bad;
+            }
+            Py_DECREF(end_string);
+        }
+    } else if (!newline) {
+        if (unlikely(!__pyx_print_kwargs)) {
+            __pyx_print_kwargs = PyDict_New();
+            if (unlikely(!__pyx_print_kwargs))
+                return -1;
+            end_string = PyUnicode_FromStringAndSize(" ", 1);
+            if (unlikely(!end_string))
+                return -1;
+            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
+                Py_DECREF(end_string);
+                return -1;
+            }
+            Py_DECREF(end_string);
+        }
+        kwargs = __pyx_print_kwargs;
+    }
+    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
+    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
+        Py_DECREF(kwargs);
+    if (!result)
+        return -1;
+    Py_DECREF(result);
+    return 0;
+bad:
+    if (kwargs != __pyx_print_kwargs)
+        Py_XDECREF(kwargs);
+    return -1;
+}
+#endif
+
 /* ObjectToMemviewSlice */
   static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
@@ -35527,51 +33930,14 @@
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(long),
                                      little, !is_unsigned);
     }
 }
 
-/* PrintOne */
-  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
-static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
-    if (!f) {
-        if (!(f = __Pyx_GetStdout()))
-            return -1;
-    }
-    Py_INCREF(f);
-    if (PyFile_SoftSpace(f, 0)) {
-        if (PyFile_WriteString(" ", f) < 0)
-            goto error;
-    }
-    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
-        goto error;
-    if (PyFile_WriteString("\n", f) < 0)
-        goto error;
-    Py_DECREF(f);
-    return 0;
-error:
-    Py_DECREF(f);
-    return -1;
-    /* the line below is just to avoid C compiler
-     * warnings about unused functions */
-    return __Pyx_Print(f, NULL, 0);
-}
-#else
-static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
-    int res;
-    PyObject* arg_tuple = PyTuple_Pack(1, o);
-    if (unlikely(!arg_tuple))
-        return -1;
-    res = __Pyx_Print(stream, arg_tuple, 1);
-    Py_DECREF(arg_tuple);
-    return res;
-}
-#endif
-
 /* CIntToPy */
   static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const int neg_one = (int) -1, const_zero = (int) 0;
@@ -35798,14 +34164,51 @@
     return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
+/* PrintOne */
+  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
+static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
+    if (!f) {
+        if (!(f = __Pyx_GetStdout()))
+            return -1;
+    }
+    Py_INCREF(f);
+    if (PyFile_SoftSpace(f, 0)) {
+        if (PyFile_WriteString(" ", f) < 0)
+            goto error;
+    }
+    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
+        goto error;
+    if (PyFile_WriteString("\n", f) < 0)
+        goto error;
+    Py_DECREF(f);
+    return 0;
+error:
+    Py_DECREF(f);
+    return -1;
+    /* the line below is just to avoid C compiler
+     * warnings about unused functions */
+    return __Pyx_Print(f, NULL, 0);
+}
+#else
+static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
+    int res;
+    PyObject* arg_tuple = PyTuple_Pack(1, o);
+    if (unlikely(!arg_tuple))
+        return -1;
+    res = __Pyx_Print(stream, arg_tuple, 1);
+    Py_DECREF(arg_tuple);
+    return res;
+}
+#endif
+
 /* CIntFromPy */
   static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const long neg_one = (long) -1, const_zero = (long) 0;
```

### Comparing `fastrometry-1.0.8/src/fastrometry/cython_code/WCS.c` & `fastrometry-1.0.9/src/fastrometry/cython_code/WCS.c`

 * *Files 1% similar despite different names*

```diff
@@ -1275,16 +1275,14 @@
 #else
     typedef struct { double real, imag; } __pyx_t_double_complex;
 #endif
 static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);
 
 
 /*--- Type declarations ---*/
-struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent;
-struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator;
 struct __pyx_array_obj;
 struct __pyx_MemviewEnum_obj;
 struct __pyx_memoryview_obj;
 struct __pyx_memoryviewslice_obj;
 
 /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":729
  * ctypedef npy_longdouble longdouble_t
@@ -1318,43 +1316,14 @@
  * 
  * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
  * 
  * cdef inline object PyArray_MultiIterNew1(a):
  */
 typedef npy_cdouble __pyx_t_5numpy_complex_t;
 
-/* "fastrometry/cython_code/WCS.pyx":8
- * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent {
-  PyObject_HEAD
-  PyObject *__pyx_v_endmessage;
-  PyObject *__pyx_v_levelneeded;
-  PyObject *__pyx_v_startmessage;
-};
-
-
-/* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator {
-  PyObject_HEAD
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *__pyx_outer_scope;
-  PyObject *__pyx_v_f;
-};
-
-
 /* "View.MemoryView":105
  * 
  * @cname("__pyx_array")
  * cdef class array:             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
@@ -1546,124 +1515,14 @@
 #else
 #define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
 #endif
 
 /* GetBuiltinName.proto */
 static PyObject *__Pyx_GetBuiltinName(PyObject *name);
 
-/* RaiseArgTupleInvalid.proto */
-static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
-    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
-
-/* RaiseDoubleKeywords.proto */
-static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
-
-/* ParseKeywords.proto */
-static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
-    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
-    const char* function_name);
-
-/* KeywordStringCheck.proto */
-static int __Pyx_CheckKeywordStrings(PyObject *kwdict, const char* function_name, int kw_allowed);
-
-/* GetItemInt.proto */
-#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
-    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
-               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
-#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
-    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
-    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
-    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              int wraparound, int boundscheck);
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
-                                                     int is_list, int wraparound, int boundscheck);
-
-/* None.proto */
-static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname);
-
-/* PyObjectCall.proto */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
-#else
-#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
-#endif
-
-/* FetchCommonType.proto */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type);
-
-/* CythonFunctionShared.proto */
-#define __Pyx_CyFunction_USED 1
-#define __Pyx_CYFUNCTION_STATICMETHOD  0x01
-#define __Pyx_CYFUNCTION_CLASSMETHOD   0x02
-#define __Pyx_CYFUNCTION_CCLASS        0x04
-#define __Pyx_CyFunction_GetClosure(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_closure)
-#define __Pyx_CyFunction_GetClassObj(f)\
-    (((__pyx_CyFunctionObject *) (f))->func_classobj)
-#define __Pyx_CyFunction_Defaults(type, f)\
-    ((type *)(((__pyx_CyFunctionObject *) (f))->defaults))
-#define __Pyx_CyFunction_SetDefaultsGetter(f, g)\
-    ((__pyx_CyFunctionObject *) (f))->defaults_getter = (g)
-typedef struct {
-    PyCFunctionObject func;
-#if PY_VERSION_HEX < 0x030500A0
-    PyObject *func_weakreflist;
-#endif
-    PyObject *func_dict;
-    PyObject *func_name;
-    PyObject *func_qualname;
-    PyObject *func_doc;
-    PyObject *func_globals;
-    PyObject *func_code;
-    PyObject *func_closure;
-    PyObject *func_classobj;
-    void *defaults;
-    int defaults_pyobjects;
-    size_t defaults_size;  // used by FusedFunction for copying defaults
-    int flags;
-    PyObject *defaults_tuple;
-    PyObject *defaults_kwdict;
-    PyObject *(*defaults_getter)(PyObject *);
-    PyObject *func_annotations;
-} __pyx_CyFunctionObject;
-static PyTypeObject *__pyx_CyFunctionType = 0;
-#define __Pyx_CyFunction_Check(obj)  (__Pyx_TypeCheck(obj, __pyx_CyFunctionType))
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject* op, PyMethodDef *ml,
-                                      int flags, PyObject* qualname,
-                                      PyObject *self,
-                                      PyObject *module, PyObject *globals,
-                                      PyObject* code);
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *m,
-                                                         size_t size,
-                                                         int pyobjects);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *m,
-                                                            PyObject *tuple);
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *m,
-                                                             PyObject *dict);
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *m,
-                                                              PyObject *dict);
-static int __pyx_CyFunction_init(void);
-
-/* CythonFunction.proto */
-static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml,
-                                      int flags, PyObject* qualname,
-                                      PyObject *closure,
-                                      PyObject *module, PyObject *globals,
-                                      PyObject* code);
-
 /* BufferIndexError.proto */
 static void __Pyx_RaiseBufferIndexError(int axis);
 
 /* DivInt[long].proto */
 static CYTHON_INLINE long __Pyx_div_long(long, long);
 
 /* PyDictVersioning.proto */
@@ -1747,14 +1606,21 @@
     ((void)__Pyx_BUILD_ASSERT_EXPR(sizeof(PyFrameObject) == offsetof(PyFrameObject, f_localsplus) + Py_MEMBER_SIZE(PyFrameObject, f_localsplus)),\
      (void)(__pyx_pyframe_localsplus_offset = ((size_t)PyFrame_Type.tp_basicsize) - Py_MEMBER_SIZE(PyFrameObject, f_localsplus)))
   #define __Pyx_PyFrame_GetLocalsplus(frame)\
     (assert(__pyx_pyframe_localsplus_offset), (PyObject **)(((char *)(frame)) + __pyx_pyframe_localsplus_offset))
 #endif // CYTHON_FAST_PYCALL
 #endif
 
+/* PyObjectCall.proto */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
+#else
+#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
+#endif
+
 /* PyObjectCall2Args.proto */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2);
 
 /* PyObjectCallMethO.proto */
 #if CYTHON_COMPILING_IN_CPYTHON
 static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
 #endif
@@ -1791,24 +1657,58 @@
 #define __pyx_get_slice_count_pointer(memview) (memview->acquisition_count_aligned_p)
 #define __pyx_get_slice_count(memview) (*__pyx_get_slice_count_pointer(memview))
 #define __PYX_INC_MEMVIEW(slice, have_gil) __Pyx_INC_MEMVIEW(slice, have_gil, __LINE__)
 #define __PYX_XDEC_MEMVIEW(slice, have_gil) __Pyx_XDEC_MEMVIEW(slice, have_gil, __LINE__)
 static CYTHON_INLINE void __Pyx_INC_MEMVIEW(__Pyx_memviewslice *, int, int);
 static CYTHON_INLINE void __Pyx_XDEC_MEMVIEW(__Pyx_memviewslice *, int, int);
 
+/* RaiseArgTupleInvalid.proto */
+static void __Pyx_RaiseArgtupleInvalid(const char* func_name, int exact,
+    Py_ssize_t num_min, Py_ssize_t num_max, Py_ssize_t num_found);
+
+/* RaiseDoubleKeywords.proto */
+static void __Pyx_RaiseDoubleKeywordsError(const char* func_name, PyObject* kw_name);
+
+/* ParseKeywords.proto */
+static int __Pyx_ParseOptionalKeywords(PyObject *kwds, PyObject **argnames[],\
+    PyObject *kwds2, PyObject *values[], Py_ssize_t num_pos_args,\
+    const char* function_name);
+
 /* SetItemInt.proto */
 #define __Pyx_SetItemInt(o, i, v, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
     (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
     __Pyx_SetItemInt_Fast(o, (Py_ssize_t)i, v, is_list, wraparound, boundscheck) :\
     (is_list ? (PyErr_SetString(PyExc_IndexError, "list assignment index out of range"), -1) :\
                __Pyx_SetItemInt_Generic(o, to_py_func(i), v)))
 static int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v);
 static CYTHON_INLINE int __Pyx_SetItemInt_Fast(PyObject *o, Py_ssize_t i, PyObject *v,
                                                int is_list, int wraparound, int boundscheck);
 
+/* GetItemInt.proto */
+#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
+    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
+               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
+#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
+    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
+    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
+    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              int wraparound, int boundscheck);
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
+                                                     int is_list, int wraparound, int boundscheck);
+
 /* ObjectGetItem.proto */
 #if CYTHON_USE_TYPE_SLOTS
 static CYTHON_INLINE PyObject *__Pyx_PyObject_GetItem(PyObject *obj, PyObject* key);
 #else
 #define __Pyx_PyObject_GetItem(obj, key)  PyObject_GetItem(obj, key)
 #endif
 
@@ -2187,21 +2087,14 @@
 static CYTHON_INLINE PyObject *__pyx_capsule_create(void *p, const char *sig);
 
 /* GCCDiagnostics.proto */
 #if defined(__GNUC__) && (__GNUC__ > 4 || (__GNUC__ == 4 && __GNUC_MINOR__ >= 6))
 #define __Pyx_HAS_GCC_DIAGNOSTIC
 #endif
 
-/* Print.proto */
-static int __Pyx_Print(PyObject*, PyObject *, int);
-#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
-static PyObject* __pyx_print = 0;
-static PyObject* __pyx_print_kwargs = 0;
-#endif
-
 /* IsLittleEndian.proto */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void);
 
 /* BufferFormatCheck.proto */
 static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
 static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
                               __Pyx_BufFmt_StackElem* stack,
@@ -2227,14 +2120,21 @@
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
 
+/* Print.proto */
+static int __Pyx_Print(PyObject*, PyObject *, int);
+#if CYTHON_COMPILING_IN_PYPY || PY_MAJOR_VERSION >= 3
+static PyObject* __pyx_print = 0;
+static PyObject* __pyx_print_kwargs = 0;
+#endif
+
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_int(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_int(PyObject *, int writable_flag);
 
 /* RealImag.proto */
@@ -2339,25 +2239,25 @@
 static __Pyx_memviewslice
 __pyx_memoryview_copy_new_contig(const __Pyx_memviewslice *from_mvs,
                                  const char *mode, int ndim,
                                  size_t sizeof_dtype, int contig_flag,
                                  int dtype_is_object);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
-
-/* PrintOne.proto */
-static int __Pyx_PrintOne(PyObject* stream, PyObject *o);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
 
 /* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);
+static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);
 
+/* PrintOne.proto */
+static int __Pyx_PrintOne(PyObject* stream, PyObject *o);
+
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CheckBinaryVersion.proto */
@@ -2414,16 +2314,14 @@
 static PyTypeObject *__pyx_ptype_5numpy_flexible = 0;
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'libc.math' */
 
 /* Module declarations from 'fastrometry.cython_code.WCS' */
-static PyTypeObject *__pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent = 0;
-static PyTypeObject *__pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator = 0;
 static PyTypeObject *__pyx_array_type = 0;
 static PyTypeObject *__pyx_MemviewEnum_type = 0;
 static PyTypeObject *__pyx_memoryview_type = 0;
 static PyTypeObject *__pyx_memoryviewslice_type = 0;
 static PyObject *generic = 0;
 static PyObject *strided = 0;
 static PyObject *indirect = 0;
@@ -2487,27 +2385,26 @@
 static PyObject *__pyx_builtin_TypeError;
 static PyObject *__pyx_builtin_Ellipsis;
 static PyObject *__pyx_builtin_id;
 static PyObject *__pyx_builtin_IndexError;
 static const char __pyx_k_O[] = "O";
 static const char __pyx_k_S[] = "S";
 static const char __pyx_k_c[] = "c";
-static const char __pyx_k_f[] = "f";
 static const char __pyx_k_i[] = "| | i {}, {}%";
 static const char __pyx_k_m[] = "m";
+static const char __pyx_k_o[] = "o";
 static const char __pyx_k_x[] = "x";
-static const char __pyx_k__6[] = ",";
-static const char __pyx_k__8[] = "*";
+static const char __pyx_k__2[] = ",";
+static const char __pyx_k__4[] = "*";
+static const char __pyx_k__6[] = ".";
 static const char __pyx_k_ha[] = "ha";
 static const char __pyx_k_id[] = "id";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_x0[] = "x0";
 static const char __pyx_k_WCS[] = "WCS";
-static const char __pyx_k__10[] = "+";
-static const char __pyx_k__11[] = ".";
 static const char __pyx_k_end[] = "end";
 static const char __pyx_k_fun[] = "fun";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_phi[] = "phi";
 static const char __pyx_k_plt[] = "plt";
 static const char __pyx_k_ptp[] = "ptp";
@@ -2526,15 +2423,14 @@
 static const char __pyx_k_blue[] = "blue";
 static const char __pyx_k_cmap[] = "cmap";
 static const char __pyx_k_dict[] = "__dict__";
 static const char __pyx_k_done[] = "| | done";
 static const char __pyx_k_exit[] = "exit";
 static const char __pyx_k_file[] = "file";
 static const char __pyx_k_fits[] = "fits";
-static const char __pyx_k_fout[] = "fout";
 static const char __pyx_k_gray[] = "gray";
 static const char __pyx_k_left[] = "left";
 static const char __pyx_k_main[] = "__main__";
 static const char __pyx_k_mean[] = "mean";
 static const char __pyx_k_mode[] = "mode";
 static const char __pyx_k_name[] = "name";
 static const char __pyx_k_ndim[] = "ndim";
@@ -2602,27 +2498,25 @@
 static const char __pyx_k_figure[] = "figure";
 static const char __pyx_k_format[] = "format";
 static const char __pyx_k_hspace[] = "hspace";
 static const char __pyx_k_import[] = "__import__";
 static const char __pyx_k_imshow[] = "imshow";
 static const char __pyx_k_intrmx[] = "intrmx";
 static const char __pyx_k_intrmy[] = "intrmy";
-static const char __pyx_k_kwargs[] = "kwargs";
 static const char __pyx_k_marker[] = "marker";
 static const char __pyx_k_name_2[] = "__name__";
 static const char __pyx_k_params[] = "params";
 static const char __pyx_k_phi_lb[] = "| | phi_lb = {}";
 static const char __pyx_k_phi_ub[] = "| | phi_ub = {}";
 static const char __pyx_k_pickle[] = "pickle";
 static const char __pyx_k_reduce[] = "__reduce__";
 static const char __pyx_k_struct[] = "struct";
 static const char __pyx_k_unpack[] = "unpack";
 static const char __pyx_k_update[] = "update";
 static const char __pyx_k_wspace[] = "wspace";
-static const char __pyx_k_yellow[] = "yellow";
 static const char __pyx_k_CCVALD1[] = "CCVALD1";
 static const char __pyx_k_CCVALD2[] = "CCVALD2";
 static const char __pyx_k_CD11inv[] = "CD11inv";
 static const char __pyx_k_CD12inv[] = "CD12inv";
 static const char __pyx_k_CD1_1_2[] = "| | CD1_1 = {}";
 static const char __pyx_k_CD1_1_3[] = "CD1_1";
 static const char __pyx_k_CD1_2_2[] = "| | CD1_2 = {}";
@@ -2653,16 +2547,14 @@
 static const char __pyx_k_intrmCx[] = "intrmCx";
 static const char __pyx_k_intrmCy[] = "intrmCy";
 static const char __pyx_k_matches[] = "matches";
 static const char __pyx_k_memview[] = "memview";
 static const char __pyx_k_savefig[] = "savefig";
 static const char __pyx_k_savetxt[] = "savetxt";
 static const char __pyx_k_scatter[] = "scatter";
-static const char __pyx_k_wrapper[] = "wrapper";
-static const char __pyx_k_x_scale[] = "x_scale";
 static const char __pyx_k_CDELT1_2[] = "CDELT1";
 static const char __pyx_k_CDELT2_2[] = "CDELT2";
 static const char __pyx_k_CROTA1_2[] = "CROTA1";
 static const char __pyx_k_CROTA2_2[] = "CROTA2";
 static const char __pyx_k_CRPIX1_2[] = "| | CRPIX1 = {}";
 static const char __pyx_k_CRPIX1_3[] = "CRPIX1";
 static const char __pyx_k_CRPIX2_2[] = "| | CRPIX2 = {}";
@@ -2691,35 +2583,32 @@
 static const char __pyx_k_CCVALS2_m[] = "CCVALS2_m";
 static const char __pyx_k_CCVALS2_s[] = "CCVALS2_s";
 static const char __pyx_k_CRPIXx_lb[] = "| | CRPIXx_lb = {}";
 static const char __pyx_k_CRPIXx_ub[] = "| | CRPIXx_ub = {}";
 static const char __pyx_k_CRPIXy_lb[] = "| | CRPIXy_lb = {}";
 static const char __pyx_k_CRPIXy_ub[] = "| | CRPIXy_ub = {}";
 static const char __pyx_k_TypeError[] = "TypeError";
-static const char __pyx_k_decorator[] = "decorator";
 static const char __pyx_k_delimiter[] = "delimiter";
 static const char __pyx_k_enumerate[] = "enumerate";
 static const char __pyx_k_matchdata[] = "matchdata";
 static const char __pyx_k_phi_guess[] = "| | phi_guess = {}";
 static const char __pyx_k_pyx_state[] = "__pyx_state";
 static const char __pyx_k_reduce_ex[] = "__reduce_ex__";
 static const char __pyx_k_residuals[] = "residuals";
 static const char __pyx_k_scalebnds[] = "scalebnds";
 static const char __pyx_k_set_title[] = "set_title";
 static const char __pyx_k_verbosity[] = "verbosity";
 static const char __pyx_k_vertextol[] = "vertextol";
 static const char __pyx_k_IndexError[] = "IndexError";
 static const char __pyx_k_ValueError[] = "ValueError";
 static const char __pyx_k_astropy_io[] = "astropy.io";
-static const char __pyx_k_endmessage[] = "endmessage";
 static const char __pyx_k_headervals[] = "headervals";
 static const char __pyx_k_kerneldiam[] = "kerneldiam";
 static const char __pyx_k_minmatches[] = "minmatches";
 static const char __pyx_k_nrefinepts[] = "nrefinepts";
-static const char __pyx_k_printEvent[] = "printEvent";
 static const char __pyx_k_pyx_result[] = "__pyx_result";
 static const char __pyx_k_pyx_vtable[] = "__pyx_vtable__";
 static const char __pyx_k_residualAx[] = "residualAx";
 static const char __pyx_k_residualAy[] = "residualAy";
 static const char __pyx_k_residualBx[] = "residualBx";
 static const char __pyx_k_residualBy[] = "residualBy";
 static const char __pyx_k_residualCx[] = "residualCx";
@@ -2730,24 +2619,22 @@
 static const char __pyx_k_CD2_1_guess[] = "| | CD2_1_guess = {}";
 static const char __pyx_k_CD2_2_guess[] = "| | CD2_2_guess = {}";
 static const char __pyx_k_ImportError[] = "ImportError";
 static const char __pyx_k_MemoryError[] = "MemoryError";
 static const char __pyx_k_PickleError[] = "PickleError";
 static const char __pyx_k_add_subplot[] = "add_subplot";
 static const char __pyx_k_determinant[] = "determinant";
-static const char __pyx_k_levelneeded[] = "levelneeded";
 static const char __pyx_k_num_matches[] = "num_matches";
 static const char __pyx_k_CRPIXx_guess[] = "| | CRPIXx_guess = {}";
 static const char __pyx_k_CRPIXy_guess[] = "| | CRPIXy_guess = {}";
 static const char __pyx_k_debug_report[] = "debug_report";
 static const char __pyx_k_optimization[] = "optimization";
 static const char __pyx_k_pse_metadata[] = "pse_metadata";
 static const char __pyx_k_pyx_checksum[] = "__pyx_checksum";
 static const char __pyx_k_rotationbnds[] = "rotationbnds";
-static const char __pyx_k_startmessage[] = "startmessage";
 static const char __pyx_k_stringsource[] = "stringsource";
 static const char __pyx_k_Found_matches[] = "| | | Found {} matches.";
 static const char __pyx_k_filename_body[] = "filename_body";
 static const char __pyx_k_least_squares[] = "least_squares";
 static const char __pyx_k_psepoints_csv[] = "psepoints.csv";
 static const char __pyx_k_pyx_getbuffer[] = "__pyx_getbuffer";
 static const char __pyx_k_reduce_cython[] = "__reduce_cython__";
@@ -2805,25 +2692,24 @@
 static const char __pyx_k_invtransf_intrmpoint_view[] = "invtransf_intrmpoint_view";
 static const char __pyx_k_Constructing_PSE_triangles[] = "| | Constructing PSE triangles...";
 static const char __pyx_k_skypoints_matches_view_csv[] = "skypoints_matches_view.csv";
 static const char __pyx_k_Calculating_WCS_diagnostics[] = "| Calculating WCS diagnostics...";
 static const char __pyx_k_fastrometry_cython_code_WCS[] = "fastrometry.cython_code.WCS";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_matchdata_wcsdiagnostic_csv[] = "matchdata_wcsdiagnostic.csv";
-static const char __pyx_k_printEvent_locals_decorator[] = "printEvent.<locals>.decorator";
 static const char __pyx_k_inverseTransformPointUsingCD[] = "inverseTransformPointUsingCD";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_Cannot_refine_solution_no_more[] = "| | Cannot refine solution; no more sources available.";
-static const char __pyx_k_brightest_PSE_and_intermediate[] = "{} brightest PSE and {} intermediate points";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
 static const char __pyx_k_Applying_initial_solution_to_th[] = "| | Applying initial solution to the larger dataset...";
 static const char __pyx_k_Applying_refined_solution_to_th[] = "| | Applying refined solution to the larger dataset...";
 static const char __pyx_k_Constructing_intermediate_trian[] = "| | Constructing intermediate triangles...";
 static const char __pyx_k_Optimizing_solution_using_the_l[] = "| | Optimizing solution using the larger dataset...";
 static const char __pyx_k_Plot_of_the_inverse_transformed[] = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the parameters that were found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.";
+static const char __pyx_k_brightest_PSE_and_brightest_int[] = "{} brightest PSE and {} brightest intermediate points";
 static const char __pyx_k_numpy_core_multiarray_failed_to[] = "numpy.core.multiarray failed to import";
 static const char __pyx_k_src_fastrometry_cython_code_WCS[] = "src\\fastrometry\\cython_code\\WCS.pyx";
 static const char __pyx_k_working_with_PSE_sources_and_ca[] = "| | (working with {} PSE sources and {} catalogue sources.)";
 static const char __pyx_k_10_brightest_PSE_and_intermediat[] = "10 brightest PSE and intermediate points";
 static const char __pyx_k_Buffer_view_does_not_expose_stri[] = "Buffer view does not expose strides";
 static const char __pyx_k_Can_only_create_a_buffer_that_is[] = "Can only create a buffer that is contiguous in memory.";
 static const char __pyx_k_Cannot_assign_to_read_only_memor[] = "Cannot assign to read-only memoryview";
@@ -2840,15 +2726,14 @@
 static const char __pyx_k_PSE_points_blue_and_intermediate[] = "PSE points (blue) and intermediate points (red) plotted overtop the image. Since the intermediate points are actually in radians, whereas the PSE points are in pixels, \nan 'approximate scale factor' has been guessed and used to put the intermediate coordinates roughly on the same scale as the PSE coordinates. The intermediate \ncoordinates center has also been shifted from (0,0) to the center of the PSE points. This allows the geometries to be compared visually.";
 static const char __pyx_k_Unable_to_convert_item_to_object[] = "Unable to convert item to object";
 static const char __pyx_k_got_differing_extents_in_dimensi[] = "got differing extents in dimension %d (got %d and %d)";
 static const char __pyx_k_inversetrans_matches_initial__pn[] = "inversetrans_matches_initial_{}.png";
 static const char __pyx_k_inversetrans_matches_refine__png[] = "inversetrans_matches_refine_{}.png";
 static const char __pyx_k_no_default___reduce___due_to_non[] = "no default __reduce__ due to non-trivial __cinit__";
 static const char __pyx_k_numpy_core_umath_failed_to_impor[] = "numpy.core.umath failed to import";
-static const char __pyx_k_printEvent_locals_decorator_loca[] = "printEvent.<locals>.decorator.<locals>.wrapper";
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_Plot_of_the_inverse_transformed_2[] = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the CD matrix elements that were found when refining \n(optimizing) the previous solution. The inverse-transformed points that yield a match (i.e., \nthose that land on an occupied kernel in the source index map) are highlighted with a white \ncircle. The PSE points are in blue.";
 static const char __pyx_k_Plot_of_the_inverse_transformed_3[] = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.";
 static const char __pyx_k_EXIT_fastrometry_interrupted_whi_2[] = "EXIT: fastrometry interrupted while refining solution.";
 static PyObject *__pyx_kp_s_10_brightest_PSE_and_intermediat;
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_kp_s_Applying_initial_solution_to_th;
@@ -2975,61 +2860,57 @@
 static PyObject *__pyx_kp_s_S_ub;
 static PyObject *__pyx_kp_s_Scale_arcsec_pixel;
 static PyObject *__pyx_n_s_TypeError;
 static PyObject *__pyx_kp_s_Unable_to_convert_item_to_object;
 static PyObject *__pyx_n_s_ValueError;
 static PyObject *__pyx_n_s_View_MemoryView;
 static PyObject *__pyx_n_s_WCS;
-static PyObject *__pyx_kp_s__10;
-static PyObject *__pyx_kp_s__11;
+static PyObject *__pyx_kp_s__2;
+static PyObject *__pyx_n_s__4;
 static PyObject *__pyx_kp_s__6;
-static PyObject *__pyx_n_s__8;
 static PyObject *__pyx_n_s_add_subplot;
 static PyObject *__pyx_n_s_allintrmpoints;
 static PyObject *__pyx_n_s_allocate_buffer;
 static PyObject *__pyx_n_s_append;
 static PyObject *__pyx_n_s_args;
 static PyObject *__pyx_n_s_array;
 static PyObject *__pyx_n_s_asarray;
 static PyObject *__pyx_n_s_astropy_io;
 static PyObject *__pyx_n_s_base;
 static PyObject *__pyx_n_s_blue;
 static PyObject *__pyx_n_s_bottom;
 static PyObject *__pyx_n_s_bounds;
-static PyObject *__pyx_kp_s_brightest_PSE_and_intermediate;
+static PyObject *__pyx_kp_s_brightest_PSE_and_brightest_int;
 static PyObject *__pyx_n_s_c;
 static PyObject *__pyx_n_u_c;
 static PyObject *__pyx_n_s_catalogue_points;
 static PyObject *__pyx_n_s_center;
 static PyObject *__pyx_n_s_class;
 static PyObject *__pyx_n_s_cline_in_traceback;
 static PyObject *__pyx_n_s_cmap;
 static PyObject *__pyx_n_s_color;
 static PyObject *__pyx_kp_s_contiguous_and_direct;
 static PyObject *__pyx_kp_s_contiguous_and_indirect;
 static PyObject *__pyx_n_s_debug;
 static PyObject *__pyx_n_s_debug_report;
-static PyObject *__pyx_n_s_decorator;
 static PyObject *__pyx_n_s_delimiter;
 static PyObject *__pyx_n_s_determinant;
 static PyObject *__pyx_n_s_dict;
 static PyObject *__pyx_kp_s_done;
 static PyObject *__pyx_kp_s_done_2;
 static PyObject *__pyx_n_s_done_3;
 static PyObject *__pyx_n_s_double;
 static PyObject *__pyx_n_s_dtype;
 static PyObject *__pyx_n_s_dtype_is_object;
 static PyObject *__pyx_n_s_empty;
 static PyObject *__pyx_n_s_encode;
 static PyObject *__pyx_n_s_end;
-static PyObject *__pyx_n_s_endmessage;
 static PyObject *__pyx_n_s_enumerate;
 static PyObject *__pyx_n_s_error;
 static PyObject *__pyx_n_s_exit;
-static PyObject *__pyx_n_s_f;
 static PyObject *__pyx_n_s_fastrometry_cython_code_WCS;
 static PyObject *__pyx_n_s_figsize;
 static PyObject *__pyx_n_s_figtext;
 static PyObject *__pyx_n_s_figure;
 static PyObject *__pyx_n_s_file;
 static PyObject *__pyx_n_s_filename_body;
 static PyObject *__pyx_n_s_filepath;
@@ -3037,15 +2918,14 @@
 static PyObject *__pyx_n_s_fitTrianglesToGetSphi;
 static PyObject *__pyx_n_s_fits;
 static PyObject *__pyx_n_s_flags;
 static PyObject *__pyx_n_s_fontsize;
 static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_fortran;
 static PyObject *__pyx_n_u_fortran;
-static PyObject *__pyx_n_s_fout;
 static PyObject *__pyx_n_s_fuchsia;
 static PyObject *__pyx_n_s_fun;
 static PyObject *__pyx_n_s_getdata;
 static PyObject *__pyx_n_s_getstate;
 static PyObject *__pyx_kp_s_got_differing_extents_in_dimensi;
 static PyObject *__pyx_n_s_gray;
 static PyObject *__pyx_n_s_ha;
@@ -3070,18 +2950,16 @@
 static PyObject *__pyx_n_s_inverseTransformPointUsingCD;
 static PyObject *__pyx_kp_s_inversetrans_matches_initial__pn;
 static PyObject *__pyx_kp_s_inversetrans_matches_refine__png;
 static PyObject *__pyx_n_s_invtransf_intrmpoint_view;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
 static PyObject *__pyx_n_s_kerneldiam;
-static PyObject *__pyx_n_s_kwargs;
 static PyObject *__pyx_n_s_least_squares;
 static PyObject *__pyx_n_s_left;
-static PyObject *__pyx_n_s_levelneeded;
 static PyObject *__pyx_n_s_m;
 static PyObject *__pyx_n_s_main;
 static PyObject *__pyx_n_s_marker;
 static PyObject *__pyx_n_s_matchdata;
 static PyObject *__pyx_kp_s_matchdata_initial__csv;
 static PyObject *__pyx_kp_s_matchdata_refine__csv;
 static PyObject *__pyx_kp_s_matchdata_wcsdiagnostic_csv;
@@ -3104,31 +2982,29 @@
 static PyObject *__pyx_n_s_nrefinepts;
 static PyObject *__pyx_n_s_num_catsources;
 static PyObject *__pyx_n_s_num_matches;
 static PyObject *__pyx_n_s_num_psesources;
 static PyObject *__pyx_n_s_numpy;
 static PyObject *__pyx_kp_s_numpy_core_multiarray_failed_to;
 static PyObject *__pyx_kp_s_numpy_core_umath_failed_to_impor;
+static PyObject *__pyx_n_s_o;
 static PyObject *__pyx_n_s_obj;
 static PyObject *__pyx_n_s_optimization;
 static PyObject *__pyx_n_s_pack;
 static PyObject *__pyx_n_s_params;
 static PyObject *__pyx_n_s_phi;
 static PyObject *__pyx_kp_s_phi_guess;
 static PyObject *__pyx_kp_s_phi_guess_TBD_in_loop;
 static PyObject *__pyx_kp_s_phi_lb;
 static PyObject *__pyx_kp_s_phi_lb_TBD_in_loop;
 static PyObject *__pyx_kp_s_phi_ub;
 static PyObject *__pyx_kp_s_phi_ub_TBD_in_loop;
 static PyObject *__pyx_n_s_pickle;
 static PyObject *__pyx_n_s_plt;
 static PyObject *__pyx_n_s_print;
-static PyObject *__pyx_n_s_printEvent;
-static PyObject *__pyx_n_s_printEvent_locals_decorator;
-static PyObject *__pyx_n_s_printEvent_locals_decorator_loca;
 static PyObject *__pyx_n_s_pseAx;
 static PyObject *__pyx_n_s_pseAy;
 static PyObject *__pyx_n_s_pseBx;
 static PyObject *__pyx_n_s_pseBy;
 static PyObject *__pyx_n_s_pseCx;
 static PyObject *__pyx_n_s_pseCy;
 static PyObject *__pyx_n_s_pse_metadata;
@@ -3177,15 +3053,14 @@
 static PyObject *__pyx_n_s_show;
 static PyObject *__pyx_n_s_size;
 static PyObject *__pyx_kp_s_skypoints_matches_view_csv;
 static PyObject *__pyx_kp_s_src_fastrometry_cython_code_WCS;
 static PyObject *__pyx_n_s_srcindexmap_initial;
 static PyObject *__pyx_n_s_srcindexmap_refine;
 static PyObject *__pyx_n_s_start;
-static PyObject *__pyx_n_s_startmessage;
 static PyObject *__pyx_n_s_std;
 static PyObject *__pyx_n_s_step;
 static PyObject *__pyx_n_s_stop;
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
@@ -3201,28 +3076,22 @@
 static PyObject *__pyx_n_s_update;
 static PyObject *__pyx_n_s_user_dir;
 static PyObject *__pyx_n_s_verbosity;
 static PyObject *__pyx_n_s_vertextol;
 static PyObject *__pyx_n_s_wcs_diagnostics;
 static PyObject *__pyx_n_s_wcsdiagnostics;
 static PyObject *__pyx_kp_s_working_with_PSE_sources_and_ca;
-static PyObject *__pyx_n_s_wrapper;
 static PyObject *__pyx_n_s_wspace;
 static PyObject *__pyx_n_s_x;
 static PyObject *__pyx_n_s_x0;
-static PyObject *__pyx_n_s_x_scale;
-static PyObject *__pyx_n_s_yellow;
 static PyObject *__pyx_n_s_zeros;
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_decorator(PyObject *__pyx_self, PyObject *__pyx_v_f); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_printEvent(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_startmessage, PyObject *__pyx_v_endmessage, PyObject *__pyx_v_levelneeded); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_2inverseTransformPointUsingCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_CD11, PyObject *__pyx_v_CD12, PyObject *__pyx_v_CD21, PyObject *__pyx_v_CD22, PyObject *__pyx_v_CRPIXx, PyObject *__pyx_v_CRPIXy, PyObject *__pyx_v_intrmx, PyObject *__pyx_v_intrmy, PyObject *__pyx_v_invtransf_intrmpoint_view); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_4fitNrefineptsToGetCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_matches); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_6fitTrianglesToGetSphi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_pseAx, PyObject *__pyx_v_pseAy, PyObject *__pyx_v_pseBx, PyObject *__pyx_v_pseBy, PyObject *__pyx_v_pseCx, PyObject *__pyx_v_pseCy, PyObject *__pyx_v_intrmAx, PyObject *__pyx_v_intrmAy, PyObject *__pyx_v_intrmBx, PyObject *__pyx_v_intrmBy, PyObject *__pyx_v_intrmCx, PyObject *__pyx_v_intrmCy); /* proto */
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_8WCS(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_scale, PyObject *__pyx_v_scalebnds, PyObject *__pyx_v_rotation, PyObject *__pyx_v_rotationbnds, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_vertextol, PyObject *__pyx_v_allintrmpoints, PyObject *__pyx_v_catalogue_points, PyObject *__pyx_v_mean_catcoords, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_pse_metadata_inv, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_num_matches, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_minmatches, PyObject *__pyx_v_kerneldiam, PyObject *__pyx_v_num_psesources, PyObject *__pyx_v_num_catsources, PyObject *__pyx_v_headervals, CYTHON_UNUSED PyObject *__pyx_v_wcsdiagnostics, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, CYTHON_UNUSED PyObject *__pyx_v_user_dir, CYTHON_UNUSED PyObject *__pyx_v_filename_body, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_CD11, PyObject *__pyx_v_CD12, PyObject *__pyx_v_CD21, PyObject *__pyx_v_CD22, PyObject *__pyx_v_CRPIXx, PyObject *__pyx_v_CRPIXy, PyObject *__pyx_v_intrmx, PyObject *__pyx_v_intrmy, PyObject *__pyx_v_invtransf_intrmpoint_view); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_2fitNrefineptsToGetCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_matches); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_4fitTrianglesToGetSphi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_pseAx, PyObject *__pyx_v_pseAy, PyObject *__pyx_v_pseBx, PyObject *__pyx_v_pseBy, PyObject *__pyx_v_pseCx, PyObject *__pyx_v_pseCy, PyObject *__pyx_v_intrmAx, PyObject *__pyx_v_intrmAy, PyObject *__pyx_v_intrmBx, PyObject *__pyx_v_intrmBy, PyObject *__pyx_v_intrmCx, PyObject *__pyx_v_intrmCy); /* proto */
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_6WCS(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_scale, PyObject *__pyx_v_scalebnds, PyObject *__pyx_v_rotation, PyObject *__pyx_v_rotationbnds, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_vertextol, PyObject *__pyx_v_allintrmpoints, PyObject *__pyx_v_catalogue_points, PyObject *__pyx_v_mean_catcoords, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_pse_metadata_inv, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_num_matches, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_minmatches, PyObject *__pyx_v_kerneldiam, PyObject *__pyx_v_num_psesources, PyObject *__pyx_v_num_catsources, PyObject *__pyx_v_headervals, CYTHON_UNUSED PyObject *__pyx_v_wcsdiagnostics, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, CYTHON_UNUSED PyObject *__pyx_v_user_dir, CYTHON_UNUSED PyObject *__pyx_v_filename_body, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array___cinit__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_shape, Py_ssize_t __pyx_v_itemsize, PyObject *__pyx_v_format, PyObject *__pyx_v_mode, int __pyx_v_allocate_buffer); /* proto */
 static int __pyx_array___pyx_pf_15View_dot_MemoryView_5array_2__getbuffer__(struct __pyx_array_obj *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
 static void __pyx_array___pyx_pf_15View_dot_MemoryView_5array_4__dealloc__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_5array_7memview___get__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static Py_ssize_t __pyx_array___pyx_pf_15View_dot_MemoryView_5array_6__len__(struct __pyx_array_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_8__getattr__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_attr); /* proto */
 static PyObject *__pyx_array___pyx_pf_15View_dot_MemoryView_5array_10__getitem__(struct __pyx_array_obj *__pyx_v_self, PyObject *__pyx_v_item); /* proto */
@@ -3257,28 +3126,25 @@
 static PyObject *__pyx_pf___pyx_memoryview___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryview_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryview_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static void __pyx_memoryviewslice___pyx_pf_15View_dot_MemoryView_16_memoryviewslice___dealloc__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView_16_memoryviewslice_4base___get__(struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice___reduce_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self); /* proto */
 static PyObject *__pyx_pf___pyx_memoryviewslice_2__setstate_cython__(CYTHON_UNUSED struct __pyx_memoryviewslice_obj *__pyx_v_self, CYTHON_UNUSED PyObject *__pyx_v___pyx_state); /* proto */
 static PyObject *__pyx_pf_15View_dot_MemoryView___pyx_unpickle_Enum(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v___pyx_type, long __pyx_v___pyx_checksum, PyObject *__pyx_v___pyx_state); /* proto */
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_Enum(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new_memoryview(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_tp_new__memoryviewslice(PyTypeObject *t, PyObject *a, PyObject *k); /*proto*/
 static PyObject *__pyx_float_0_2;
 static PyObject *__pyx_float_0_5;
 static PyObject *__pyx_float_7_5;
 static PyObject *__pyx_float_9_5;
 static PyObject *__pyx_float_0_05;
 static PyObject *__pyx_float_0_08;
 static PyObject *__pyx_float_0_92;
-static PyObject *__pyx_float_1eneg_6;
 static PyObject *__pyx_int_0;
 static PyObject *__pyx_int_1;
 static PyObject *__pyx_int_2;
 static PyObject *__pyx_int_3;
 static PyObject *__pyx_int_4;
 static PyObject *__pyx_int_6;
 static PyObject *__pyx_int_8;
@@ -3296,23 +3162,26 @@
 static PyObject *__pyx_int_136983863;
 static PyObject *__pyx_int_184977713;
 static PyObject *__pyx_int_neg_1;
 static PyObject *__pyx_tuple_;
 static PyObject *__pyx_tuple__3;
 static PyObject *__pyx_tuple__5;
 static PyObject *__pyx_tuple__7;
+static PyObject *__pyx_tuple__8;
 static PyObject *__pyx_tuple__9;
-static PyObject *__pyx_slice__16;
-static PyObject *__pyx_slice__19;
+static PyObject *__pyx_slice__11;
+static PyObject *__pyx_slice__14;
+static PyObject *__pyx_tuple__10;
 static PyObject *__pyx_tuple__12;
 static PyObject *__pyx_tuple__13;
-static PyObject *__pyx_tuple__14;
 static PyObject *__pyx_tuple__15;
+static PyObject *__pyx_tuple__16;
 static PyObject *__pyx_tuple__17;
 static PyObject *__pyx_tuple__18;
+static PyObject *__pyx_tuple__19;
 static PyObject *__pyx_tuple__20;
 static PyObject *__pyx_tuple__21;
 static PyObject *__pyx_tuple__22;
 static PyObject *__pyx_tuple__23;
 static PyObject *__pyx_tuple__24;
 static PyObject *__pyx_tuple__25;
 static PyObject *__pyx_tuple__26;
@@ -3325,483 +3194,33 @@
 static PyObject *__pyx_tuple__33;
 static PyObject *__pyx_tuple__34;
 static PyObject *__pyx_tuple__35;
 static PyObject *__pyx_tuple__36;
 static PyObject *__pyx_tuple__37;
 static PyObject *__pyx_tuple__38;
 static PyObject *__pyx_tuple__39;
-static PyObject *__pyx_tuple__40;
 static PyObject *__pyx_tuple__41;
-static PyObject *__pyx_tuple__42;
 static PyObject *__pyx_tuple__43;
-static PyObject *__pyx_tuple__44;
-static PyObject *__pyx_tuple__46;
+static PyObject *__pyx_tuple__45;
+static PyObject *__pyx_tuple__47;
 static PyObject *__pyx_tuple__48;
+static PyObject *__pyx_tuple__49;
 static PyObject *__pyx_tuple__50;
+static PyObject *__pyx_tuple__51;
 static PyObject *__pyx_tuple__52;
-static PyObject *__pyx_tuple__53;
-static PyObject *__pyx_tuple__55;
-static PyObject *__pyx_tuple__56;
-static PyObject *__pyx_tuple__57;
-static PyObject *__pyx_tuple__58;
-static PyObject *__pyx_tuple__59;
-static PyObject *__pyx_tuple__60;
-static PyObject *__pyx_codeobj__2;
-static PyObject *__pyx_codeobj__4;
-static PyObject *__pyx_codeobj__45;
-static PyObject *__pyx_codeobj__47;
-static PyObject *__pyx_codeobj__49;
-static PyObject *__pyx_codeobj__51;
-static PyObject *__pyx_codeobj__54;
-static PyObject *__pyx_codeobj__61;
+static PyObject *__pyx_codeobj__40;
+static PyObject *__pyx_codeobj__42;
+static PyObject *__pyx_codeobj__44;
+static PyObject *__pyx_codeobj__46;
+static PyObject *__pyx_codeobj__53;
 /* Late includes */
 
 /* "fastrometry/cython_code/WCS.pyx":8
  * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
  * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_1printEvent(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3WCS_printEvent[] = "\n    This is a decorator factory, which returns a decorator.\n    The decorator's purpose is to return a wrapper, which\n    provides the original function (f) with extra utilities,\n    which in this case is a pair of verbosity-dependent\n    console messages, whose wording and needed verbosity\n    level are specified in the decorator factory arguments.\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_1printEvent = {"printEvent", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_1printEvent, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_printEvent};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_1printEvent(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_startmessage = 0;
-  PyObject *__pyx_v_endmessage = 0;
-  PyObject *__pyx_v_levelneeded = 0;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("printEvent (wrapper)", 0);
-  {
-    static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_startmessage,&__pyx_n_s_endmessage,&__pyx_n_s_levelneeded,0};
-    PyObject* values[3] = {0,0,0};
-    if (unlikely(__pyx_kwds)) {
-      Py_ssize_t kw_args;
-      const Py_ssize_t pos_args = PyTuple_GET_SIZE(__pyx_args);
-      switch (pos_args) {
-        case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-        CYTHON_FALLTHROUGH;
-        case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-        CYTHON_FALLTHROUGH;
-        case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-        CYTHON_FALLTHROUGH;
-        case  0: break;
-        default: goto __pyx_L5_argtuple_error;
-      }
-      kw_args = PyDict_Size(__pyx_kwds);
-      switch (pos_args) {
-        case  0:
-        if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_startmessage)) != 0)) kw_args--;
-        else goto __pyx_L5_argtuple_error;
-        CYTHON_FALLTHROUGH;
-        case  1:
-        if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_endmessage)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, 1); __PYX_ERR(0, 8, __pyx_L3_error)
-        }
-        CYTHON_FALLTHROUGH;
-        case  2:
-        if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_levelneeded)) != 0)) kw_args--;
-        else {
-          __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, 2); __PYX_ERR(0, 8, __pyx_L3_error)
-        }
-      }
-      if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "printEvent") < 0)) __PYX_ERR(0, 8, __pyx_L3_error)
-      }
-    } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
-      goto __pyx_L5_argtuple_error;
-    } else {
-      values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
-      values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
-      values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
-    }
-    __pyx_v_startmessage = values[0];
-    __pyx_v_endmessage = values[1];
-    __pyx_v_levelneeded = values[2];
-  }
-  goto __pyx_L4_argument_unpacking_done;
-  __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("printEvent", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 8, __pyx_L3_error)
-  __pyx_L3_error:;
-  __Pyx_AddTraceback("fastrometry.cython_code.WCS.printEvent", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __Pyx_RefNannyFinishContext();
-  return NULL;
-  __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_printEvent(__pyx_self, __pyx_v_startmessage, __pyx_v_endmessage, __pyx_v_levelneeded);
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_1decorator(PyObject *__pyx_self, PyObject *__pyx_v_f); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_10printEvent_1decorator = {"decorator", (PyCFunction)__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_1decorator, METH_O, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_1decorator(PyObject *__pyx_self, PyObject *__pyx_v_f) {
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("decorator (wrapper)", 0);
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_decorator(__pyx_self, ((PyObject *)__pyx_v_f));
-
-  /* function exit code */
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/WCS.pyx":18
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-
-/* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
-  PyObject *__pyx_v_args = 0;
-  PyObject *__pyx_v_kwargs = 0;
-  PyObject *__pyx_r = 0;
-  __Pyx_RefNannyDeclarations
-  __Pyx_RefNannySetupContext("wrapper (wrapper)", 0);
-  if (unlikely(__pyx_kwds) && unlikely(!__Pyx_CheckKeywordStrings(__pyx_kwds, "wrapper", 1))) return NULL;
-  __pyx_v_kwargs = (__pyx_kwds) ? PyDict_Copy(__pyx_kwds) : PyDict_New(); if (unlikely(!__pyx_v_kwargs)) return NULL;
-  __Pyx_GOTREF(__pyx_v_kwargs);
-  __Pyx_INCREF(__pyx_args);
-  __pyx_v_args = __pyx_args;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);
-
-  /* function exit code */
-  __Pyx_XDECREF(__pyx_v_args);
-  __Pyx_XDECREF(__pyx_v_kwargs);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *__pyx_cur_scope;
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *__pyx_outer_scope;
-  PyObject *__pyx_v_verbosity = NULL;
-  PyObject *__pyx_v_fout = NULL;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_t_2;
-  PyObject *__pyx_t_3 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("wrapper", 0);
-  __pyx_outer_scope = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *) __Pyx_CyFunction_GetClosure(__pyx_self);
-  __pyx_cur_scope = __pyx_outer_scope;
-
-  /* "fastrometry/cython_code/WCS.pyx":19
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]             # <<<<<<<<<<<<<<
- *             if verbosity >= levelneeded:
- *                 print(startmessage)
- */
-  __pyx_t_1 = __Pyx_GetItemInt_Tuple(__pyx_v_args, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 19, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_verbosity = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":20
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded)) { __Pyx_RaiseClosureNameError("levelneeded"); __PYX_ERR(0, 20, __pyx_L1_error) }
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 20, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (__pyx_t_2) {
-
-    /* "fastrometry/cython_code/WCS.pyx":21
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- *                 print(startmessage)             # <<<<<<<<<<<<<<
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:
- */
-    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_startmessage)) { __Pyx_RaiseClosureNameError("startmessage"); __PYX_ERR(0, 21, __pyx_L1_error) }
-    if (__Pyx_PrintOne(0, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_startmessage) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
-
-    /* "fastrometry/cython_code/WCS.pyx":20
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- */
-  }
-
-  /* "fastrometry/cython_code/WCS.pyx":22
- *             if verbosity >= levelneeded:
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)             # <<<<<<<<<<<<<<
- *             if verbosity >= levelneeded:
- *                 print(endmessage)
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_v_f)) { __Pyx_RaiseClosureNameError("f"); __PYX_ERR(0, 22, __pyx_L1_error) }
-  __pyx_t_1 = PyDict_Copy(__pyx_v_kwargs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 22, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_cur_scope->__pyx_v_f, __pyx_v_args, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_fout = __pyx_t_3;
-  __pyx_t_3 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":23
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(endmessage)
- *             return fout
- */
-  if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded)) { __Pyx_RaiseClosureNameError("levelneeded"); __PYX_ERR(0, 23, __pyx_L1_error) }
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_levelneeded, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 23, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__pyx_t_2) {
-
-    /* "fastrometry/cython_code/WCS.pyx":24
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:
- *                 print(endmessage)             # <<<<<<<<<<<<<<
- *             return fout
- *         return wrapper
- */
-    if (unlikely(!__pyx_cur_scope->__pyx_outer_scope->__pyx_v_endmessage)) { __Pyx_RaiseClosureNameError("endmessage"); __PYX_ERR(0, 24, __pyx_L1_error) }
-    if (__Pyx_PrintOne(0, __pyx_cur_scope->__pyx_outer_scope->__pyx_v_endmessage) < 0) __PYX_ERR(0, 24, __pyx_L1_error)
-
-    /* "fastrometry/cython_code/WCS.pyx":23
- *                 print(startmessage)
- *             fout = f(*args,**kwargs)
- *             if verbosity >= levelneeded:             # <<<<<<<<<<<<<<
- *                 print(endmessage)
- *             return fout
- */
-  }
-
-  /* "fastrometry/cython_code/WCS.pyx":25
- *             if verbosity >= levelneeded:
- *                 print(endmessage)
- *             return fout             # <<<<<<<<<<<<<<
- *         return wrapper
- *     return decorator
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_fout);
-  __pyx_r = __pyx_v_fout;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/WCS.pyx":18
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_3);
-  __Pyx_AddTraceback("fastrometry.cython_code.WCS.printEvent.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_verbosity);
-  __Pyx_XDECREF(__pyx_v_fout);
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_10printEvent_decorator(PyObject *__pyx_self, PyObject *__pyx_v_f) {
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *__pyx_cur_scope;
-  PyObject *__pyx_v_wrapper = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("decorator", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(__pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator, __pyx_empty_tuple, NULL);
-  if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)Py_None);
-    __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 17, __pyx_L1_error)
-  } else {
-    __Pyx_GOTREF(__pyx_cur_scope);
-  }
-  __pyx_cur_scope->__pyx_outer_scope = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *) __Pyx_CyFunction_GetClosure(__pyx_self);
-  __Pyx_INCREF(((PyObject *)__pyx_cur_scope->__pyx_outer_scope));
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_outer_scope);
-  __pyx_cur_scope->__pyx_v_f = __pyx_v_f;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_f);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_f);
-
-  /* "fastrometry/cython_code/WCS.pyx":18
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11fastrometry_11cython_code_3WCS_10printEvent_9decorator_1wrapper, 0, __pyx_n_s_printEvent_locals_decorator_loca, ((PyObject*)__pyx_cur_scope), __pyx_n_s_fastrometry_cython_code_WCS, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 18, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_wrapper = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":26
- *                 print(endmessage)
- *             return fout
- *         return wrapper             # <<<<<<<<<<<<<<
- *     return decorator
- * 
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_wrapper);
-  __pyx_r = __pyx_v_wrapper;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("fastrometry.cython_code.WCS.printEvent.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_wrapper);
-  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/WCS.pyx":8
- * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_printEvent(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_startmessage, PyObject *__pyx_v_endmessage, PyObject *__pyx_v_levelneeded) {
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *__pyx_cur_scope;
-  PyObject *__pyx_v_decorator = 0;
-  PyObject *__pyx_r = NULL;
-  __Pyx_RefNannyDeclarations
-  PyObject *__pyx_t_1 = NULL;
-  int __pyx_lineno = 0;
-  const char *__pyx_filename = NULL;
-  int __pyx_clineno = 0;
-  __Pyx_RefNannySetupContext("printEvent", 0);
-  __pyx_cur_scope = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(__pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent, __pyx_empty_tuple, NULL);
-  if (unlikely(!__pyx_cur_scope)) {
-    __pyx_cur_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)Py_None);
-    __Pyx_INCREF(Py_None);
-    __PYX_ERR(0, 8, __pyx_L1_error)
-  } else {
-    __Pyx_GOTREF(__pyx_cur_scope);
-  }
-  __pyx_cur_scope->__pyx_v_startmessage = __pyx_v_startmessage;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_startmessage);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_startmessage);
-  __pyx_cur_scope->__pyx_v_endmessage = __pyx_v_endmessage;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_endmessage);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_endmessage);
-  __pyx_cur_scope->__pyx_v_levelneeded = __pyx_v_levelneeded;
-  __Pyx_INCREF(__pyx_cur_scope->__pyx_v_levelneeded);
-  __Pyx_GIVEREF(__pyx_cur_scope->__pyx_v_levelneeded);
-
-  /* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-  __pyx_t_1 = __Pyx_CyFunction_New(&__pyx_mdef_11fastrometry_11cython_code_3WCS_10printEvent_1decorator, 0, __pyx_n_s_printEvent_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_fastrometry_cython_code_WCS, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __pyx_v_decorator = __pyx_t_1;
-  __pyx_t_1 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":27
- *             return fout
- *         return wrapper
- *     return decorator             # <<<<<<<<<<<<<<
- * 
- * cdef getSkyCoordsFromPix(double[:,:] pixelpoints_view, int num_pixpoints, double[:] refined_solution_view, double[:] mean_catcoords_view, double[:,:] skypoints_view):
- */
-  __Pyx_XDECREF(__pyx_r);
-  __Pyx_INCREF(__pyx_v_decorator);
-  __pyx_r = __pyx_v_decorator;
-  goto __pyx_L0;
-
-  /* "fastrometry/cython_code/WCS.pyx":8
- * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-
-  /* function exit code */
-  __pyx_L1_error:;
-  __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_AddTraceback("fastrometry.cython_code.WCS.printEvent", __pyx_clineno, __pyx_lineno, __pyx_filename);
-  __pyx_r = NULL;
-  __pyx_L0:;
-  __Pyx_XDECREF(__pyx_v_decorator);
-  __Pyx_DECREF(((PyObject *)__pyx_cur_scope));
-  __Pyx_XGIVEREF(__pyx_r);
-  __Pyx_RefNannyFinishContext();
-  return __pyx_r;
-}
-
-/* "fastrometry/cython_code/WCS.pyx":29
- *     return decorator
- * 
  * cdef getSkyCoordsFromPix(double[:,:] pixelpoints_view, int num_pixpoints, double[:] refined_solution_view, double[:] mean_catcoords_view, double[:,:] skypoints_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
 static PyObject *__pyx_f_11fastrometry_11cython_code_3WCS_getSkyCoordsFromPix(__Pyx_memviewslice __pyx_v_pixelpoints_view, int __pyx_v_num_pixpoints, __Pyx_memviewslice __pyx_v_refined_solution_view, __Pyx_memviewslice __pyx_v_mean_catcoords_view, __Pyx_memviewslice __pyx_v_skypoints_view) {
   double __pyx_v_CD1_1;
@@ -3829,179 +3248,179 @@
   int __pyx_t_6;
   double __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("getSkyCoordsFromPix", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":39
+  /* "fastrometry/cython_code/WCS.pyx":18
  * 
  *     cdef:
  *         double CD1_1 = refined_solution_view[0]             # <<<<<<<<<<<<<<
  *         double CD1_2 = refined_solution_view[1]
  *         double CD2_1 = refined_solution_view[2]
  */
   __pyx_t_1 = 0;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 39, __pyx_L1_error)
+    __PYX_ERR(0, 18, __pyx_L1_error)
   }
   __pyx_v_CD1_1 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":40
+  /* "fastrometry/cython_code/WCS.pyx":19
  *     cdef:
  *         double CD1_1 = refined_solution_view[0]
  *         double CD1_2 = refined_solution_view[1]             # <<<<<<<<<<<<<<
  *         double CD2_1 = refined_solution_view[2]
  *         double CD2_2 = refined_solution_view[3]
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 40, __pyx_L1_error)
+    __PYX_ERR(0, 19, __pyx_L1_error)
   }
   __pyx_v_CD1_2 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":41
+  /* "fastrometry/cython_code/WCS.pyx":20
  *         double CD1_1 = refined_solution_view[0]
  *         double CD1_2 = refined_solution_view[1]
  *         double CD2_1 = refined_solution_view[2]             # <<<<<<<<<<<<<<
  *         double CD2_2 = refined_solution_view[3]
  *         double CRPIX1 = refined_solution_view[4]
  */
   __pyx_t_1 = 2;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 41, __pyx_L1_error)
+    __PYX_ERR(0, 20, __pyx_L1_error)
   }
   __pyx_v_CD2_1 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":42
+  /* "fastrometry/cython_code/WCS.pyx":21
  *         double CD1_2 = refined_solution_view[1]
  *         double CD2_1 = refined_solution_view[2]
  *         double CD2_2 = refined_solution_view[3]             # <<<<<<<<<<<<<<
  *         double CRPIX1 = refined_solution_view[4]
  *         double CRPIX2 = refined_solution_view[5]
  */
   __pyx_t_1 = 3;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 42, __pyx_L1_error)
+    __PYX_ERR(0, 21, __pyx_L1_error)
   }
   __pyx_v_CD2_2 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":43
+  /* "fastrometry/cython_code/WCS.pyx":22
  *         double CD2_1 = refined_solution_view[2]
  *         double CD2_2 = refined_solution_view[3]
  *         double CRPIX1 = refined_solution_view[4]             # <<<<<<<<<<<<<<
  *         double CRPIX2 = refined_solution_view[5]
  *         double a0 = mean_catcoords_view[0]
  */
   __pyx_t_1 = 4;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 43, __pyx_L1_error)
+    __PYX_ERR(0, 22, __pyx_L1_error)
   }
   __pyx_v_CRPIX1 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":44
+  /* "fastrometry/cython_code/WCS.pyx":23
  *         double CD2_2 = refined_solution_view[3]
  *         double CRPIX1 = refined_solution_view[4]
  *         double CRPIX2 = refined_solution_view[5]             # <<<<<<<<<<<<<<
  *         double a0 = mean_catcoords_view[0]
  *         double d0 = mean_catcoords_view[1]
  */
   __pyx_t_1 = 5;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 44, __pyx_L1_error)
+    __PYX_ERR(0, 23, __pyx_L1_error)
   }
   __pyx_v_CRPIX2 = (*((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_1 * __pyx_v_refined_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":45
+  /* "fastrometry/cython_code/WCS.pyx":24
  *         double CRPIX1 = refined_solution_view[4]
  *         double CRPIX2 = refined_solution_view[5]
  *         double a0 = mean_catcoords_view[0]             # <<<<<<<<<<<<<<
  *         double d0 = mean_catcoords_view[1]
  *         double x
  */
   __pyx_t_1 = 0;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_mean_catcoords_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_mean_catcoords_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 45, __pyx_L1_error)
+    __PYX_ERR(0, 24, __pyx_L1_error)
   }
   __pyx_v_a0 = (*((double *) ( /* dim=0 */ (__pyx_v_mean_catcoords_view.data + __pyx_t_1 * __pyx_v_mean_catcoords_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":46
+  /* "fastrometry/cython_code/WCS.pyx":25
  *         double CRPIX2 = refined_solution_view[5]
  *         double a0 = mean_catcoords_view[0]
  *         double d0 = mean_catcoords_view[1]             # <<<<<<<<<<<<<<
  *         double x
  *         double y
  */
   __pyx_t_1 = 1;
   __pyx_t_2 = -1;
   if (__pyx_t_1 < 0) {
     __pyx_t_1 += __pyx_v_mean_catcoords_view.shape[0];
     if (unlikely(__pyx_t_1 < 0)) __pyx_t_2 = 0;
   } else if (unlikely(__pyx_t_1 >= __pyx_v_mean_catcoords_view.shape[0])) __pyx_t_2 = 0;
   if (unlikely(__pyx_t_2 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_2);
-    __PYX_ERR(0, 46, __pyx_L1_error)
+    __PYX_ERR(0, 25, __pyx_L1_error)
   }
   __pyx_v_d0 = (*((double *) ( /* dim=0 */ (__pyx_v_mean_catcoords_view.data + __pyx_t_1 * __pyx_v_mean_catcoords_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":60
+  /* "fastrometry/cython_code/WCS.pyx":39
  *     #Here we use an alternate set of formulas from https://mathworld.wolfram.com/GnomonicProjection.html.
  * 
  *     for i in range(num_pixpoints):             # <<<<<<<<<<<<<<
  *         x = pixelpoints_view[i,0]
  *         y = pixelpoints_view[i,1]
  */
   __pyx_t_2 = __pyx_v_num_pixpoints;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "fastrometry/cython_code/WCS.pyx":61
+    /* "fastrometry/cython_code/WCS.pyx":40
  * 
  *     for i in range(num_pixpoints):
  *         x = pixelpoints_view[i,0]             # <<<<<<<<<<<<<<
  *         y = pixelpoints_view[i,1]
  *         X = CD1_1*(x-CRPIX1) + CD1_2*(y-CRPIX2)
  */
     __pyx_t_1 = __pyx_v_i;
@@ -4013,19 +3432,19 @@
     } else if (unlikely(__pyx_t_1 >= __pyx_v_pixelpoints_view.shape[0])) __pyx_t_6 = 0;
     if (__pyx_t_5 < 0) {
       __pyx_t_5 += __pyx_v_pixelpoints_view.shape[1];
       if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 1;
     } else if (unlikely(__pyx_t_5 >= __pyx_v_pixelpoints_view.shape[1])) __pyx_t_6 = 1;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      __PYX_ERR(0, 61, __pyx_L1_error)
+      __PYX_ERR(0, 40, __pyx_L1_error)
     }
     __pyx_v_x = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pixelpoints_view.data + __pyx_t_1 * __pyx_v_pixelpoints_view.strides[0]) ) + __pyx_t_5 * __pyx_v_pixelpoints_view.strides[1]) )));
 
-    /* "fastrometry/cython_code/WCS.pyx":62
+    /* "fastrometry/cython_code/WCS.pyx":41
  *     for i in range(num_pixpoints):
  *         x = pixelpoints_view[i,0]
  *         y = pixelpoints_view[i,1]             # <<<<<<<<<<<<<<
  *         X = CD1_1*(x-CRPIX1) + CD1_2*(y-CRPIX2)
  *         Y = CD2_1*(x-CRPIX1) + CD2_2*(y-CRPIX2)
  */
     __pyx_t_5 = __pyx_v_i;
@@ -4037,55 +3456,55 @@
     } else if (unlikely(__pyx_t_5 >= __pyx_v_pixelpoints_view.shape[0])) __pyx_t_6 = 0;
     if (__pyx_t_1 < 0) {
       __pyx_t_1 += __pyx_v_pixelpoints_view.shape[1];
       if (unlikely(__pyx_t_1 < 0)) __pyx_t_6 = 1;
     } else if (unlikely(__pyx_t_1 >= __pyx_v_pixelpoints_view.shape[1])) __pyx_t_6 = 1;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      __PYX_ERR(0, 62, __pyx_L1_error)
+      __PYX_ERR(0, 41, __pyx_L1_error)
     }
     __pyx_v_y = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_pixelpoints_view.data + __pyx_t_5 * __pyx_v_pixelpoints_view.strides[0]) ) + __pyx_t_1 * __pyx_v_pixelpoints_view.strides[1]) )));
 
-    /* "fastrometry/cython_code/WCS.pyx":63
+    /* "fastrometry/cython_code/WCS.pyx":42
  *         x = pixelpoints_view[i,0]
  *         y = pixelpoints_view[i,1]
  *         X = CD1_1*(x-CRPIX1) + CD1_2*(y-CRPIX2)             # <<<<<<<<<<<<<<
  *         Y = CD2_1*(x-CRPIX1) + CD2_2*(y-CRPIX2)
  * 
  */
     __pyx_v_X = ((__pyx_v_CD1_1 * (__pyx_v_x - __pyx_v_CRPIX1)) + (__pyx_v_CD1_2 * (__pyx_v_y - __pyx_v_CRPIX2)));
 
-    /* "fastrometry/cython_code/WCS.pyx":64
+    /* "fastrometry/cython_code/WCS.pyx":43
  *         y = pixelpoints_view[i,1]
  *         X = CD1_1*(x-CRPIX1) + CD1_2*(y-CRPIX2)
  *         Y = CD2_1*(x-CRPIX1) + CD2_2*(y-CRPIX2)             # <<<<<<<<<<<<<<
  * 
  *         p = sqrt(X*X+Y*Y)
  */
     __pyx_v_Y = ((__pyx_v_CD2_1 * (__pyx_v_x - __pyx_v_CRPIX1)) + (__pyx_v_CD2_2 * (__pyx_v_y - __pyx_v_CRPIX2)));
 
-    /* "fastrometry/cython_code/WCS.pyx":66
+    /* "fastrometry/cython_code/WCS.pyx":45
  *         Y = CD2_1*(x-CRPIX1) + CD2_2*(y-CRPIX2)
  * 
  *         p = sqrt(X*X+Y*Y)             # <<<<<<<<<<<<<<
  *         c = atan(p)
  *         skypoints_view[i,0] = a0 + atan2(X*sin(c),p*cos(d0)*cos(c)-Y*sin(d0)*sin(c))
  */
     __pyx_v_p = sqrt(((__pyx_v_X * __pyx_v_X) + (__pyx_v_Y * __pyx_v_Y)));
 
-    /* "fastrometry/cython_code/WCS.pyx":67
+    /* "fastrometry/cython_code/WCS.pyx":46
  * 
  *         p = sqrt(X*X+Y*Y)
  *         c = atan(p)             # <<<<<<<<<<<<<<
  *         skypoints_view[i,0] = a0 + atan2(X*sin(c),p*cos(d0)*cos(c)-Y*sin(d0)*sin(c))
  *         skypoints_view[i,1] = asin(cos(c)*sin(d0)+Y*sin(c)*cos(d0)/p)
  */
     __pyx_v_c = atan(__pyx_v_p);
 
-    /* "fastrometry/cython_code/WCS.pyx":68
+    /* "fastrometry/cython_code/WCS.pyx":47
  *         p = sqrt(X*X+Y*Y)
  *         c = atan(p)
  *         skypoints_view[i,0] = a0 + atan2(X*sin(c),p*cos(d0)*cos(c)-Y*sin(d0)*sin(c))             # <<<<<<<<<<<<<<
  *         skypoints_view[i,1] = asin(cos(c)*sin(d0)+Y*sin(c)*cos(d0)/p)
  * 
  */
     __pyx_t_1 = __pyx_v_i;
@@ -4097,50 +3516,50 @@
     } else if (unlikely(__pyx_t_1 >= __pyx_v_skypoints_view.shape[0])) __pyx_t_6 = 0;
     if (__pyx_t_5 < 0) {
       __pyx_t_5 += __pyx_v_skypoints_view.shape[1];
       if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 1;
     } else if (unlikely(__pyx_t_5 >= __pyx_v_skypoints_view.shape[1])) __pyx_t_6 = 1;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      __PYX_ERR(0, 68, __pyx_L1_error)
+      __PYX_ERR(0, 47, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoints_view.data + __pyx_t_1 * __pyx_v_skypoints_view.strides[0]) ) + __pyx_t_5 * __pyx_v_skypoints_view.strides[1]) )) = (__pyx_v_a0 + atan2((__pyx_v_X * sin(__pyx_v_c)), (((__pyx_v_p * cos(__pyx_v_d0)) * cos(__pyx_v_c)) - ((__pyx_v_Y * sin(__pyx_v_d0)) * sin(__pyx_v_c)))));
 
-    /* "fastrometry/cython_code/WCS.pyx":69
+    /* "fastrometry/cython_code/WCS.pyx":48
  *         c = atan(p)
  *         skypoints_view[i,0] = a0 + atan2(X*sin(c),p*cos(d0)*cos(c)-Y*sin(d0)*sin(c))
  *         skypoints_view[i,1] = asin(cos(c)*sin(d0)+Y*sin(c)*cos(d0)/p)             # <<<<<<<<<<<<<<
  * 
  * cdef calculateWCSdiagnostics(int img_xmax, int img_ymax, double[:] refined_solution_view, double[:,:] matchdata_view, int matches, int num_catsources, double[:,:] catalogue_points_view, double[:] mean_catcoords_view, double[:] wcs_diagnostics_view, debug_report, debug):
  */
     __pyx_t_7 = ((__pyx_v_Y * sin(__pyx_v_c)) * cos(__pyx_v_d0));
     if (unlikely(__pyx_v_p == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 69, __pyx_L1_error)
+      __PYX_ERR(0, 48, __pyx_L1_error)
     }
     __pyx_t_5 = __pyx_v_i;
     __pyx_t_1 = 1;
     __pyx_t_6 = -1;
     if (__pyx_t_5 < 0) {
       __pyx_t_5 += __pyx_v_skypoints_view.shape[0];
       if (unlikely(__pyx_t_5 < 0)) __pyx_t_6 = 0;
     } else if (unlikely(__pyx_t_5 >= __pyx_v_skypoints_view.shape[0])) __pyx_t_6 = 0;
     if (__pyx_t_1 < 0) {
       __pyx_t_1 += __pyx_v_skypoints_view.shape[1];
       if (unlikely(__pyx_t_1 < 0)) __pyx_t_6 = 1;
     } else if (unlikely(__pyx_t_1 >= __pyx_v_skypoints_view.shape[1])) __pyx_t_6 = 1;
     if (unlikely(__pyx_t_6 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_6);
-      __PYX_ERR(0, 69, __pyx_L1_error)
+      __PYX_ERR(0, 48, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoints_view.data + __pyx_t_5 * __pyx_v_skypoints_view.strides[0]) ) + __pyx_t_1 * __pyx_v_skypoints_view.strides[1]) )) = asin(((cos(__pyx_v_c) * sin(__pyx_v_d0)) + (__pyx_t_7 / __pyx_v_p)));
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":29
- *     return decorator
+  /* "fastrometry/cython_code/WCS.pyx":8
+ * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
  * 
  * cdef getSkyCoordsFromPix(double[:,:] pixelpoints_view, int num_pixpoints, double[:] refined_solution_view, double[:] mean_catcoords_view, double[:,:] skypoints_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
   /* function exit code */
@@ -4151,15 +3570,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":71
+/* "fastrometry/cython_code/WCS.pyx":50
  *         skypoints_view[i,1] = asin(cos(c)*sin(d0)+Y*sin(c)*cos(d0)/p)
  * 
  * cdef calculateWCSdiagnostics(int img_xmax, int img_ymax, double[:] refined_solution_view, double[:,:] matchdata_view, int matches, int num_catsources, double[:,:] catalogue_points_view, double[:] mean_catcoords_view, double[:] wcs_diagnostics_view, debug_report, debug):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -4219,57 +3638,57 @@
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("calculateWCSdiagnostics", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":74
+  /* "fastrometry/cython_code/WCS.pyx":53
  * 
  *     cdef:
  *         double centx = int(img_xmax/2)             # <<<<<<<<<<<<<<
  *         double centy = int(img_ymax/2)
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])
  */
   __pyx_v_centx = ((double)__Pyx_div_long(__pyx_v_img_xmax, 2));
 
-  /* "fastrometry/cython_code/WCS.pyx":75
+  /* "fastrometry/cython_code/WCS.pyx":54
  *     cdef:
  *         double centx = int(img_xmax/2)
  *         double centy = int(img_ymax/2)             # <<<<<<<<<<<<<<
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])
  *         double[:,:] skypoint_center_view = np.zeros((1,2))
  */
   __pyx_v_centy = ((double)__Pyx_div_long(__pyx_v_img_ymax, 2));
 
-  /* "fastrometry/cython_code/WCS.pyx":76
+  /* "fastrometry/cython_code/WCS.pyx":55
  *         double centx = int(img_xmax/2)
  *         double centy = int(img_ymax/2)
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])             # <<<<<<<<<<<<<<
  *         double[:,:] skypoint_center_view = np.zeros((1,2))
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_centx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_centx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_centy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_centy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyList_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_5 = PyList_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_2);
   PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyList_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
@@ -4279,71 +3698,71 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 76, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 55, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_pixelpoint_center_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":77
+  /* "fastrometry/cython_code/WCS.pyx":56
  *         double centy = int(img_ymax/2)
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])
  *         double[:,:] skypoint_center_view = np.zeros((1,2))             # <<<<<<<<<<<<<<
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))
  *         double[:] residuals_ra = np.zeros(matches)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
-  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_tuple__5) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_tuple__5);
+  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_tuple_) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_tuple_);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 77, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_skypoint_center_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":78
+  /* "fastrometry/cython_code/WCS.pyx":57
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])
  *         double[:,:] skypoint_center_view = np.zeros((1,2))
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))             # <<<<<<<<<<<<<<
  *         double[:] residuals_ra = np.zeros(matches)
  *         double[:] residuals_dec = np.zeros(matches)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_2);
   __Pyx_GIVEREF(__pyx_int_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_2);
   __pyx_t_4 = 0;
@@ -4356,107 +3775,107 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_skypoints_matches_view = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":79
+  /* "fastrometry/cython_code/WCS.pyx":58
  *         double[:,:] skypoint_center_view = np.zeros((1,2))
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))
  *         double[:] residuals_ra = np.zeros(matches)             # <<<<<<<<<<<<<<
  *         double[:] residuals_dec = np.zeros(matches)
  *         double CCVALD1
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 79, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 79, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_residuals_ra = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":80
+  /* "fastrometry/cython_code/WCS.pyx":59
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))
  *         double[:] residuals_ra = np.zeros(matches)
  *         double[:] residuals_dec = np.zeros(matches)             # <<<<<<<<<<<<<<
  *         double CCVALD1
  *         double CCVALD2
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 80, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 80, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 80, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 80, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_residuals_dec = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":98
+  /* "fastrometry/cython_code/WCS.pyx":77
  *         Py_ssize_t j
  * 
  *     getSkyCoordsFromPix(pixelpoint_center_view, 1, refined_solution_view, mean_catcoords_view, skypoint_center_view)             # <<<<<<<<<<<<<<
  * 
  *     CCVALD1 = skypoint_center_view[0,0]
  */
-  __pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getSkyCoordsFromPix(__pyx_v_pixelpoint_center_view, 1, __pyx_v_refined_solution_view, __pyx_v_mean_catcoords_view, __pyx_v_skypoint_center_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 98, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getSkyCoordsFromPix(__pyx_v_pixelpoint_center_view, 1, __pyx_v_refined_solution_view, __pyx_v_mean_catcoords_view, __pyx_v_skypoint_center_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":100
+  /* "fastrometry/cython_code/WCS.pyx":79
  *     getSkyCoordsFromPix(pixelpoint_center_view, 1, refined_solution_view, mean_catcoords_view, skypoint_center_view)
  * 
  *     CCVALD1 = skypoint_center_view[0,0]             # <<<<<<<<<<<<<<
  *     CCVALD2 = skypoint_center_view[0,1]
  * 
  */
   __pyx_t_8 = 0;
@@ -4468,19 +3887,19 @@
   } else if (unlikely(__pyx_t_8 >= __pyx_v_skypoint_center_view.shape[0])) __pyx_t_10 = 0;
   if (__pyx_t_9 < 0) {
     __pyx_t_9 += __pyx_v_skypoint_center_view.shape[1];
     if (unlikely(__pyx_t_9 < 0)) __pyx_t_10 = 1;
   } else if (unlikely(__pyx_t_9 >= __pyx_v_skypoint_center_view.shape[1])) __pyx_t_10 = 1;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 100, __pyx_L1_error)
+    __PYX_ERR(0, 79, __pyx_L1_error)
   }
   __pyx_v_CCVALD1 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoint_center_view.data + __pyx_t_8 * __pyx_v_skypoint_center_view.strides[0]) ) + __pyx_t_9 * __pyx_v_skypoint_center_view.strides[1]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":101
+  /* "fastrometry/cython_code/WCS.pyx":80
  * 
  *     CCVALD1 = skypoint_center_view[0,0]
  *     CCVALD2 = skypoint_center_view[0,1]             # <<<<<<<<<<<<<<
  * 
  *     dhours1 = CCVALD1*180/pi/15
  */
   __pyx_t_9 = 0;
@@ -4492,252 +3911,252 @@
   } else if (unlikely(__pyx_t_9 >= __pyx_v_skypoint_center_view.shape[0])) __pyx_t_10 = 0;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_skypoint_center_view.shape[1];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 1;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_skypoint_center_view.shape[1])) __pyx_t_10 = 1;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 101, __pyx_L1_error)
+    __PYX_ERR(0, 80, __pyx_L1_error)
   }
   __pyx_v_CCVALD2 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoint_center_view.data + __pyx_t_9 * __pyx_v_skypoint_center_view.strides[0]) ) + __pyx_t_8 * __pyx_v_skypoint_center_view.strides[1]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":103
+  /* "fastrometry/cython_code/WCS.pyx":82
  *     CCVALD2 = skypoint_center_view[0,1]
  * 
  *     dhours1 = CCVALD1*180/pi/15             # <<<<<<<<<<<<<<
  *     hours1 = int(dhours1)
  *     dminutes1 = (dhours1 - hours1)*60
  */
   __pyx_t_11 = (__pyx_v_CCVALD1 * 180.0);
   if (unlikely(M_PI == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 103, __pyx_L1_error)
+    __PYX_ERR(0, 82, __pyx_L1_error)
   }
   __pyx_v_dhours1 = ((__pyx_t_11 / M_PI) / 15.0);
 
-  /* "fastrometry/cython_code/WCS.pyx":104
+  /* "fastrometry/cython_code/WCS.pyx":83
  * 
  *     dhours1 = CCVALD1*180/pi/15
  *     hours1 = int(dhours1)             # <<<<<<<<<<<<<<
  *     dminutes1 = (dhours1 - hours1)*60
  *     minutes1 = int(dminutes1)
  */
-  __pyx_t_1 = __Pyx_PyInt_FromDouble(__pyx_v_dhours1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_FromDouble(__pyx_v_dhours1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_hours1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":105
+  /* "fastrometry/cython_code/WCS.pyx":84
  *     dhours1 = CCVALD1*180/pi/15
  *     hours1 = int(dhours1)
  *     dminutes1 = (dhours1 - hours1)*60             # <<<<<<<<<<<<<<
  *     minutes1 = int(dminutes1)
  *     dseconds1 = (dminutes1 - minutes1)*60
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_dhours1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_dhours1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_hours1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_v_hours1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 84, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_60); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_60); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_dminutes1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":106
+  /* "fastrometry/cython_code/WCS.pyx":85
  *     hours1 = int(dhours1)
  *     dminutes1 = (dhours1 - hours1)*60
  *     minutes1 = int(dminutes1)             # <<<<<<<<<<<<<<
  *     dseconds1 = (dminutes1 - minutes1)*60
  *     dhours2 = abs(CCVALD2)/15*180/pi/15
  */
-  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_dminutes1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Int(__pyx_v_dminutes1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 85, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_minutes1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":107
+  /* "fastrometry/cython_code/WCS.pyx":86
  *     dminutes1 = (dhours1 - hours1)*60
  *     minutes1 = int(dminutes1)
  *     dseconds1 = (dminutes1 - minutes1)*60             # <<<<<<<<<<<<<<
  *     dhours2 = abs(CCVALD2)/15*180/pi/15
  *     hours2 = int(dhours2)
  */
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_dminutes1, __pyx_v_minutes1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_dminutes1, __pyx_v_minutes1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 86, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_60); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 107, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_60); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_dseconds1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":108
+  /* "fastrometry/cython_code/WCS.pyx":87
  *     minutes1 = int(dminutes1)
  *     dseconds1 = (dminutes1 - minutes1)*60
  *     dhours2 = abs(CCVALD2)/15*180/pi/15             # <<<<<<<<<<<<<<
  *     hours2 = int(dhours2)
  *     dminutes2 = (dhours2 - hours2)*60
  */
   __pyx_t_11 = ((fabs(__pyx_v_CCVALD2) / 15.0) * 180.0);
   if (unlikely(M_PI == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 108, __pyx_L1_error)
+    __PYX_ERR(0, 87, __pyx_L1_error)
   }
   __pyx_v_dhours2 = ((__pyx_t_11 / M_PI) / 15.0);
 
-  /* "fastrometry/cython_code/WCS.pyx":109
+  /* "fastrometry/cython_code/WCS.pyx":88
  *     dseconds1 = (dminutes1 - minutes1)*60
  *     dhours2 = abs(CCVALD2)/15*180/pi/15
  *     hours2 = int(dhours2)             # <<<<<<<<<<<<<<
  *     dminutes2 = (dhours2 - hours2)*60
  *     minutes2 = int(dminutes2)
  */
-  __pyx_t_3 = __Pyx_PyInt_FromDouble(__pyx_v_dhours2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 109, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_FromDouble(__pyx_v_dhours2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 88, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_hours2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":110
+  /* "fastrometry/cython_code/WCS.pyx":89
  *     dhours2 = abs(CCVALD2)/15*180/pi/15
  *     hours2 = int(dhours2)
  *     dminutes2 = (dhours2 - hours2)*60             # <<<<<<<<<<<<<<
  *     minutes2 = int(dminutes2)
  *     dseconds2 = (dminutes2 - minutes2)*60
  */
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_dhours2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_dhours2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_hours2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_hours2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_60); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_int_60); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_dminutes2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":111
+  /* "fastrometry/cython_code/WCS.pyx":90
  *     hours2 = int(dhours2)
  *     dminutes2 = (dhours2 - hours2)*60
  *     minutes2 = int(dminutes2)             # <<<<<<<<<<<<<<
  *     dseconds2 = (dminutes2 - minutes2)*60
  *     if CCVALD2 < 0:
  */
-  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_dminutes2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Int(__pyx_v_dminutes2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 90, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_minutes2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":112
+  /* "fastrometry/cython_code/WCS.pyx":91
  *     dminutes2 = (dhours2 - hours2)*60
  *     minutes2 = int(dminutes2)
  *     dseconds2 = (dminutes2 - minutes2)*60             # <<<<<<<<<<<<<<
  *     if CCVALD2 < 0:
  *         hours2 *= -1
  */
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_dminutes2, __pyx_v_minutes2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_dminutes2, __pyx_v_minutes2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_60); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_60); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_dseconds2 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":113
+  /* "fastrometry/cython_code/WCS.pyx":92
  *     minutes2 = int(dminutes2)
  *     dseconds2 = (dminutes2 - minutes2)*60
  *     if CCVALD2 < 0:             # <<<<<<<<<<<<<<
  *         hours2 *= -1
  * 
  */
   __pyx_t_12 = ((__pyx_v_CCVALD2 < 0.0) != 0);
   if (__pyx_t_12) {
 
-    /* "fastrometry/cython_code/WCS.pyx":114
+    /* "fastrometry/cython_code/WCS.pyx":93
  *     dseconds2 = (dminutes2 - minutes2)*60
  *     if CCVALD2 < 0:
  *         hours2 *= -1             # <<<<<<<<<<<<<<
  * 
  *     CCVALS1_h = hours1
  */
-    __pyx_t_1 = PyNumber_InPlaceMultiply(__pyx_v_hours2, __pyx_int_neg_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_InPlaceMultiply(__pyx_v_hours2, __pyx_int_neg_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF_SET(__pyx_v_hours2, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":113
+    /* "fastrometry/cython_code/WCS.pyx":92
  *     minutes2 = int(dminutes2)
  *     dseconds2 = (dminutes2 - minutes2)*60
  *     if CCVALD2 < 0:             # <<<<<<<<<<<<<<
  *         hours2 *= -1
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":116
+  /* "fastrometry/cython_code/WCS.pyx":95
  *         hours2 *= -1
  * 
  *     CCVALS1_h = hours1             # <<<<<<<<<<<<<<
  *     CCVALS1_m = minutes1
  *     CCVALS1_s = dseconds1
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_hours1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 116, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_hours1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 95, __pyx_L1_error)
   __pyx_v_CCVALS1_h = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":117
+  /* "fastrometry/cython_code/WCS.pyx":96
  * 
  *     CCVALS1_h = hours1
  *     CCVALS1_m = minutes1             # <<<<<<<<<<<<<<
  *     CCVALS1_s = dseconds1
  *     CCVALS2_h = hours2
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_minutes1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 117, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_minutes1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 96, __pyx_L1_error)
   __pyx_v_CCVALS1_m = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":118
+  /* "fastrometry/cython_code/WCS.pyx":97
  *     CCVALS1_h = hours1
  *     CCVALS1_m = minutes1
  *     CCVALS1_s = dseconds1             # <<<<<<<<<<<<<<
  *     CCVALS2_h = hours2
  *     CCVALS2_m = minutes2
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_dseconds1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 118, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_dseconds1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 97, __pyx_L1_error)
   __pyx_v_CCVALS1_s = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":119
+  /* "fastrometry/cython_code/WCS.pyx":98
  *     CCVALS1_m = minutes1
  *     CCVALS1_s = dseconds1
  *     CCVALS2_h = hours2             # <<<<<<<<<<<<<<
  *     CCVALS2_m = minutes2
  *     CCVALS2_s = dseconds2
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_hours2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 119, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_hours2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 98, __pyx_L1_error)
   __pyx_v_CCVALS2_h = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":120
+  /* "fastrometry/cython_code/WCS.pyx":99
  *     CCVALS1_s = dseconds1
  *     CCVALS2_h = hours2
  *     CCVALS2_m = minutes2             # <<<<<<<<<<<<<<
  *     CCVALS2_s = dseconds2
  * 
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_minutes2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 120, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_minutes2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 99, __pyx_L1_error)
   __pyx_v_CCVALS2_m = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":121
+  /* "fastrometry/cython_code/WCS.pyx":100
  *     CCVALS2_h = hours2
  *     CCVALS2_m = minutes2
  *     CCVALS2_s = dseconds2             # <<<<<<<<<<<<<<
  * 
  *     getSkyCoordsFromPix(matchdata_view[:,3:5], matches, refined_solution_view, mean_catcoords_view, skypoints_matches_view)
  */
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_dseconds2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 121, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_dseconds2); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 100, __pyx_L1_error)
   __pyx_v_CCVALS2_s = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":123
+  /* "fastrometry/cython_code/WCS.pyx":102
  *     CCVALS2_s = dseconds2
  * 
  *     getSkyCoordsFromPix(matchdata_view[:,3:5], matches, refined_solution_view, mean_catcoords_view, skypoints_matches_view)             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
   __pyx_t_6.data = __pyx_v_matchdata_view.data;
@@ -4758,111 +4177,111 @@
     5,
     0,
     1,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 123, __pyx_L1_error)
+    __PYX_ERR(0, 102, __pyx_L1_error)
 }
 
-__pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getSkyCoordsFromPix(__pyx_t_6, __pyx_v_matches, __pyx_v_refined_solution_view, __pyx_v_mean_catcoords_view, __pyx_v_skypoints_matches_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
+__pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getSkyCoordsFromPix(__pyx_t_6, __pyx_v_matches, __pyx_v_refined_solution_view, __pyx_v_mean_catcoords_view, __pyx_v_skypoints_matches_view); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":125
+  /* "fastrometry/cython_code/WCS.pyx":104
  *     getSkyCoordsFromPix(matchdata_view[:,3:5], matches, refined_solution_view, mean_catcoords_view, skypoints_matches_view)
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"skypoints_matches_view.csv", np.asarray(skypoints_matches_view), delimiter=",")
  * 
  */
-  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 104, __pyx_L1_error)
   if (__pyx_t_12) {
 
-    /* "fastrometry/cython_code/WCS.pyx":126
+    /* "fastrometry/cython_code/WCS.pyx":105
  * 
  *     if debug:
  *         np.savetxt(debug_report/"skypoints_matches_view.csv", np.asarray(skypoints_matches_view), delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     for j in range(matches):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_skypoints_matches_view_csv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_skypoints_matches_view_csv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_skypoints_matches_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_skypoints_matches_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_13 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_13)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_13);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_5 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_13, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 126, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_5);
     __pyx_t_1 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 126, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 126, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 105, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":125
+    /* "fastrometry/cython_code/WCS.pyx":104
  *     getSkyCoordsFromPix(matchdata_view[:,3:5], matches, refined_solution_view, mean_catcoords_view, skypoints_matches_view)
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"skypoints_matches_view.csv", np.asarray(skypoints_matches_view), delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":128
+  /* "fastrometry/cython_code/WCS.pyx":107
  *         np.savetxt(debug_report/"skypoints_matches_view.csv", np.asarray(skypoints_matches_view), delimiter=",")
  * 
  *     for j in range(matches):             # <<<<<<<<<<<<<<
  *         matchdata_view[j,6] = catalogue_points_view[int(matchdata_view[j,2]),0]
  *         matchdata_view[j,7] = catalogue_points_view[int(matchdata_view[j,2]),1]
  */
   __pyx_t_10 = __pyx_v_matches;
   __pyx_t_14 = __pyx_t_10;
   for (__pyx_t_15 = 0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
     __pyx_v_j = __pyx_t_15;
 
-    /* "fastrometry/cython_code/WCS.pyx":129
+    /* "fastrometry/cython_code/WCS.pyx":108
  * 
  *     for j in range(matches):
  *         matchdata_view[j,6] = catalogue_points_view[int(matchdata_view[j,2]),0]             # <<<<<<<<<<<<<<
  *         matchdata_view[j,7] = catalogue_points_view[int(matchdata_view[j,2]),1]
  *         residuals_ra[j] = (skypoints_matches_view[j,0] - matchdata_view[j,6])*180/pi*3600
  */
     __pyx_t_8 = __pyx_v_j;
@@ -4874,49 +4293,49 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 129, __pyx_L1_error)
+      __PYX_ERR(0, 108, __pyx_L1_error)
     }
     __pyx_t_17 = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_8 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_9 * __pyx_v_matchdata_view.strides[1]) ))));
     __pyx_t_18 = 0;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_catalogue_points_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_catalogue_points_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_catalogue_points_view.shape[1];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_catalogue_points_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 129, __pyx_L1_error)
+      __PYX_ERR(0, 108, __pyx_L1_error)
     }
     __pyx_t_19 = __pyx_v_j;
     __pyx_t_20 = 6;
     __pyx_t_16 = -1;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 129, __pyx_L1_error)
+      __PYX_ERR(0, 108, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_19 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_20 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_catalogue_points_view.data + __pyx_t_17 * __pyx_v_catalogue_points_view.strides[0]) ) + __pyx_t_18 * __pyx_v_catalogue_points_view.strides[1]) )));
 
-    /* "fastrometry/cython_code/WCS.pyx":130
+    /* "fastrometry/cython_code/WCS.pyx":109
  *     for j in range(matches):
  *         matchdata_view[j,6] = catalogue_points_view[int(matchdata_view[j,2]),0]
  *         matchdata_view[j,7] = catalogue_points_view[int(matchdata_view[j,2]),1]             # <<<<<<<<<<<<<<
  *         residuals_ra[j] = (skypoints_matches_view[j,0] - matchdata_view[j,6])*180/pi*3600
  *         residuals_dec[j] = (skypoints_matches_view[j,1] - matchdata_view[j,7])*180/pi*3600
  */
     __pyx_t_9 = __pyx_v_j;
@@ -4928,49 +4347,49 @@
     } else if (unlikely(__pyx_t_9 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 130, __pyx_L1_error)
+      __PYX_ERR(0, 109, __pyx_L1_error)
     }
     __pyx_t_18 = ((Py_ssize_t)(*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_9 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_8 * __pyx_v_matchdata_view.strides[1]) ))));
     __pyx_t_17 = 1;
     __pyx_t_16 = -1;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_catalogue_points_view.shape[0];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_catalogue_points_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_catalogue_points_view.shape[1];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_catalogue_points_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 130, __pyx_L1_error)
+      __PYX_ERR(0, 109, __pyx_L1_error)
     }
     __pyx_t_20 = __pyx_v_j;
     __pyx_t_19 = 7;
     __pyx_t_16 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_19 < 0) {
       __pyx_t_19 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_19 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_19 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 130, __pyx_L1_error)
+      __PYX_ERR(0, 109, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_20 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_19 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_catalogue_points_view.data + __pyx_t_18 * __pyx_v_catalogue_points_view.strides[0]) ) + __pyx_t_17 * __pyx_v_catalogue_points_view.strides[1]) )));
 
-    /* "fastrometry/cython_code/WCS.pyx":131
+    /* "fastrometry/cython_code/WCS.pyx":110
  *         matchdata_view[j,6] = catalogue_points_view[int(matchdata_view[j,2]),0]
  *         matchdata_view[j,7] = catalogue_points_view[int(matchdata_view[j,2]),1]
  *         residuals_ra[j] = (skypoints_matches_view[j,0] - matchdata_view[j,6])*180/pi*3600             # <<<<<<<<<<<<<<
  *         residuals_dec[j] = (skypoints_matches_view[j,1] - matchdata_view[j,7])*180/pi*3600
  *         matchdata_view[j,8] = residuals_ra[j]
  */
     __pyx_t_8 = __pyx_v_j;
@@ -4982,49 +4401,49 @@
     } else if (unlikely(__pyx_t_8 >= __pyx_v_skypoints_matches_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_skypoints_matches_view.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_skypoints_matches_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 131, __pyx_L1_error)
+      __PYX_ERR(0, 110, __pyx_L1_error)
     }
     __pyx_t_17 = __pyx_v_j;
     __pyx_t_18 = 6;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 131, __pyx_L1_error)
+      __PYX_ERR(0, 110, __pyx_L1_error)
     }
     __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoints_matches_view.data + __pyx_t_8 * __pyx_v_skypoints_matches_view.strides[0]) ) + __pyx_t_9 * __pyx_v_skypoints_matches_view.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_17 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_matchdata_view.strides[1]) )))) * 180.0);
     if (unlikely(M_PI == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 131, __pyx_L1_error)
+      __PYX_ERR(0, 110, __pyx_L1_error)
     }
     __pyx_t_18 = __pyx_v_j;
     __pyx_t_16 = -1;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_residuals_ra.shape[0];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_residuals_ra.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 131, __pyx_L1_error)
+      __PYX_ERR(0, 110, __pyx_L1_error)
     }
     *((double *) ( /* dim=0 */ (__pyx_v_residuals_ra.data + __pyx_t_18 * __pyx_v_residuals_ra.strides[0]) )) = ((__pyx_t_11 / M_PI) * 3600.0);
 
-    /* "fastrometry/cython_code/WCS.pyx":132
+    /* "fastrometry/cython_code/WCS.pyx":111
  *         matchdata_view[j,7] = catalogue_points_view[int(matchdata_view[j,2]),1]
  *         residuals_ra[j] = (skypoints_matches_view[j,0] - matchdata_view[j,6])*180/pi*3600
  *         residuals_dec[j] = (skypoints_matches_view[j,1] - matchdata_view[j,7])*180/pi*3600             # <<<<<<<<<<<<<<
  *         matchdata_view[j,8] = residuals_ra[j]
  *         matchdata_view[j,9] = residuals_dec[j]
  */
     __pyx_t_18 = __pyx_v_j;
@@ -5036,612 +4455,612 @@
     } else if (unlikely(__pyx_t_18 >= __pyx_v_skypoints_matches_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_skypoints_matches_view.shape[1];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_skypoints_matches_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 132, __pyx_L1_error)
+      __PYX_ERR(0, 111, __pyx_L1_error)
     }
     __pyx_t_9 = __pyx_v_j;
     __pyx_t_8 = 7;
     __pyx_t_16 = -1;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 132, __pyx_L1_error)
+      __PYX_ERR(0, 111, __pyx_L1_error)
     }
     __pyx_t_11 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_skypoints_matches_view.data + __pyx_t_18 * __pyx_v_skypoints_matches_view.strides[0]) ) + __pyx_t_17 * __pyx_v_skypoints_matches_view.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_9 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_8 * __pyx_v_matchdata_view.strides[1]) )))) * 180.0);
     if (unlikely(M_PI == 0)) {
       PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-      __PYX_ERR(0, 132, __pyx_L1_error)
+      __PYX_ERR(0, 111, __pyx_L1_error)
     }
     __pyx_t_8 = __pyx_v_j;
     __pyx_t_16 = -1;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_residuals_dec.shape[0];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_residuals_dec.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 132, __pyx_L1_error)
+      __PYX_ERR(0, 111, __pyx_L1_error)
     }
     *((double *) ( /* dim=0 */ (__pyx_v_residuals_dec.data + __pyx_t_8 * __pyx_v_residuals_dec.strides[0]) )) = ((__pyx_t_11 / M_PI) * 3600.0);
 
-    /* "fastrometry/cython_code/WCS.pyx":133
+    /* "fastrometry/cython_code/WCS.pyx":112
  *         residuals_ra[j] = (skypoints_matches_view[j,0] - matchdata_view[j,6])*180/pi*3600
  *         residuals_dec[j] = (skypoints_matches_view[j,1] - matchdata_view[j,7])*180/pi*3600
  *         matchdata_view[j,8] = residuals_ra[j]             # <<<<<<<<<<<<<<
  *         matchdata_view[j,9] = residuals_dec[j]
  * 
  */
     __pyx_t_8 = __pyx_v_j;
     __pyx_t_16 = -1;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_residuals_ra.shape[0];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_residuals_ra.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 133, __pyx_L1_error)
+      __PYX_ERR(0, 112, __pyx_L1_error)
     }
     __pyx_t_9 = __pyx_v_j;
     __pyx_t_17 = 8;
     __pyx_t_16 = -1;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 133, __pyx_L1_error)
+      __PYX_ERR(0, 112, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_9 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_17 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_residuals_ra.data + __pyx_t_8 * __pyx_v_residuals_ra.strides[0]) )));
 
-    /* "fastrometry/cython_code/WCS.pyx":134
+    /* "fastrometry/cython_code/WCS.pyx":113
  *         residuals_dec[j] = (skypoints_matches_view[j,1] - matchdata_view[j,7])*180/pi*3600
  *         matchdata_view[j,8] = residuals_ra[j]
  *         matchdata_view[j,9] = residuals_dec[j]             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
     __pyx_t_8 = __pyx_v_j;
     __pyx_t_16 = -1;
     if (__pyx_t_8 < 0) {
       __pyx_t_8 += __pyx_v_residuals_dec.shape[0];
       if (unlikely(__pyx_t_8 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_8 >= __pyx_v_residuals_dec.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 134, __pyx_L1_error)
+      __PYX_ERR(0, 113, __pyx_L1_error)
     }
     __pyx_t_17 = __pyx_v_j;
     __pyx_t_9 = 9;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_matchdata_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_9 < 0) {
       __pyx_t_9 += __pyx_v_matchdata_view.shape[1];
       if (unlikely(__pyx_t_9 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_9 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 134, __pyx_L1_error)
+      __PYX_ERR(0, 113, __pyx_L1_error)
     }
     *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_17 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_9 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_residuals_dec.data + __pyx_t_8 * __pyx_v_residuals_dec.strides[0]) )));
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":136
+  /* "fastrometry/cython_code/WCS.pyx":115
  *         matchdata_view[j,9] = residuals_dec[j]
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_wcsdiagnostic.csv", np.asarray(matchdata_view), delimiter=",")
  * 
  */
-  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 136, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 115, __pyx_L1_error)
   if (__pyx_t_12) {
 
-    /* "fastrometry/cython_code/WCS.pyx":137
+    /* "fastrometry/cython_code/WCS.pyx":116
  * 
  *     if debug:
  *         np.savetxt(debug_report/"matchdata_wcsdiagnostic.csv", np.asarray(matchdata_view), delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     CVAL1RM = np.mean(residuals_ra)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_matchdata_wcsdiagnostic_csv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_matchdata_wcsdiagnostic_csv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_13 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_13)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_13);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_13) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_13, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
     __pyx_t_1 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 137, __pyx_L1_error)
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 116, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":136
+    /* "fastrometry/cython_code/WCS.pyx":115
  *         matchdata_view[j,9] = residuals_dec[j]
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_wcsdiagnostic.csv", np.asarray(matchdata_view), delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":139
+  /* "fastrometry/cython_code/WCS.pyx":118
  *         np.savetxt(debug_report/"matchdata_wcsdiagnostic.csv", np.asarray(matchdata_view), delimiter=",")
  * 
  *     CVAL1RM = np.mean(residuals_ra)             # <<<<<<<<<<<<<<
  *     CVAL2RM = np.mean(residuals_dec)
  *     CVALRM = sqrt(CVAL1RM*CVAL1RM+CVAL2RM*CVAL2RM)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_residuals_ra, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_residuals_ra, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CVAL1RM = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":140
+  /* "fastrometry/cython_code/WCS.pyx":119
  * 
  *     CVAL1RM = np.mean(residuals_ra)
  *     CVAL2RM = np.mean(residuals_dec)             # <<<<<<<<<<<<<<
  *     CVALRM = sqrt(CVAL1RM*CVAL1RM+CVAL2RM*CVAL2RM)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_mean); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_residuals_dec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_residuals_dec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CVAL2RM = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":141
+  /* "fastrometry/cython_code/WCS.pyx":120
  *     CVAL1RM = np.mean(residuals_ra)
  *     CVAL2RM = np.mean(residuals_dec)
  *     CVALRM = sqrt(CVAL1RM*CVAL1RM+CVAL2RM*CVAL2RM)             # <<<<<<<<<<<<<<
  * 
  *     CVAL1RS = np.std(residuals_ra)
  */
   __pyx_v_CVALRM = sqrt(((__pyx_v_CVAL1RM * __pyx_v_CVAL1RM) + (__pyx_v_CVAL2RM * __pyx_v_CVAL2RM)));
 
-  /* "fastrometry/cython_code/WCS.pyx":143
+  /* "fastrometry/cython_code/WCS.pyx":122
  *     CVALRM = sqrt(CVAL1RM*CVAL1RM+CVAL2RM*CVAL2RM)
  * 
  *     CVAL1RS = np.std(residuals_ra)             # <<<<<<<<<<<<<<
  *     CVAL2RS = np.std(residuals_dec)
  *     CVALRS = sqrt(CVAL1RS*CVAL1RS+CVAL2RS*CVAL2RS)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_std); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_std); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_residuals_ra, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_residuals_ra, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CVAL1RS = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":144
+  /* "fastrometry/cython_code/WCS.pyx":123
  * 
  *     CVAL1RS = np.std(residuals_ra)
  *     CVAL2RS = np.std(residuals_dec)             # <<<<<<<<<<<<<<
  *     CVALRS = sqrt(CVAL1RS*CVAL1RS+CVAL2RS*CVAL2RS)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_std); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_std); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_residuals_dec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_residuals_dec, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CVAL2RS = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":145
+  /* "fastrometry/cython_code/WCS.pyx":124
  *     CVAL1RS = np.std(residuals_ra)
  *     CVAL2RS = np.std(residuals_dec)
  *     CVALRS = sqrt(CVAL1RS*CVAL1RS+CVAL2RS*CVAL2RS)             # <<<<<<<<<<<<<<
  * 
  *     wcs_diagnostics_view[0] = CCVALD1
  */
   __pyx_v_CVALRS = sqrt(((__pyx_v_CVAL1RS * __pyx_v_CVAL1RS) + (__pyx_v_CVAL2RS * __pyx_v_CVAL2RS)));
 
-  /* "fastrometry/cython_code/WCS.pyx":147
+  /* "fastrometry/cython_code/WCS.pyx":126
  *     CVALRS = sqrt(CVAL1RS*CVAL1RS+CVAL2RS*CVAL2RS)
  * 
  *     wcs_diagnostics_view[0] = CCVALD1             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[1] = CCVALD2
  *     wcs_diagnostics_view[2] = CCVALS1_h
  */
   __pyx_t_8 = 0;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 147, __pyx_L1_error)
+    __PYX_ERR(0, 126, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALD1;
 
-  /* "fastrometry/cython_code/WCS.pyx":148
+  /* "fastrometry/cython_code/WCS.pyx":127
  * 
  *     wcs_diagnostics_view[0] = CCVALD1
  *     wcs_diagnostics_view[1] = CCVALD2             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[2] = CCVALS1_h
  *     wcs_diagnostics_view[3] = CCVALS1_m
  */
   __pyx_t_8 = 1;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 148, __pyx_L1_error)
+    __PYX_ERR(0, 127, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALD2;
 
-  /* "fastrometry/cython_code/WCS.pyx":149
+  /* "fastrometry/cython_code/WCS.pyx":128
  *     wcs_diagnostics_view[0] = CCVALD1
  *     wcs_diagnostics_view[1] = CCVALD2
  *     wcs_diagnostics_view[2] = CCVALS1_h             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[3] = CCVALS1_m
  *     wcs_diagnostics_view[4] = CCVALS1_s
  */
   __pyx_t_8 = 2;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 149, __pyx_L1_error)
+    __PYX_ERR(0, 128, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS1_h;
 
-  /* "fastrometry/cython_code/WCS.pyx":150
+  /* "fastrometry/cython_code/WCS.pyx":129
  *     wcs_diagnostics_view[1] = CCVALD2
  *     wcs_diagnostics_view[2] = CCVALS1_h
  *     wcs_diagnostics_view[3] = CCVALS1_m             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[4] = CCVALS1_s
  *     wcs_diagnostics_view[5] = CCVALS2_h
  */
   __pyx_t_8 = 3;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 150, __pyx_L1_error)
+    __PYX_ERR(0, 129, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS1_m;
 
-  /* "fastrometry/cython_code/WCS.pyx":151
+  /* "fastrometry/cython_code/WCS.pyx":130
  *     wcs_diagnostics_view[2] = CCVALS1_h
  *     wcs_diagnostics_view[3] = CCVALS1_m
  *     wcs_diagnostics_view[4] = CCVALS1_s             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[5] = CCVALS2_h
  *     wcs_diagnostics_view[6] = CCVALS2_m
  */
   __pyx_t_8 = 4;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 151, __pyx_L1_error)
+    __PYX_ERR(0, 130, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS1_s;
 
-  /* "fastrometry/cython_code/WCS.pyx":152
+  /* "fastrometry/cython_code/WCS.pyx":131
  *     wcs_diagnostics_view[3] = CCVALS1_m
  *     wcs_diagnostics_view[4] = CCVALS1_s
  *     wcs_diagnostics_view[5] = CCVALS2_h             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[6] = CCVALS2_m
  *     wcs_diagnostics_view[7] = CCVALS2_s
  */
   __pyx_t_8 = 5;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 152, __pyx_L1_error)
+    __PYX_ERR(0, 131, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS2_h;
 
-  /* "fastrometry/cython_code/WCS.pyx":153
+  /* "fastrometry/cython_code/WCS.pyx":132
  *     wcs_diagnostics_view[4] = CCVALS1_s
  *     wcs_diagnostics_view[5] = CCVALS2_h
  *     wcs_diagnostics_view[6] = CCVALS2_m             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[7] = CCVALS2_s
  *     wcs_diagnostics_view[8] = CVAL1RM
  */
   __pyx_t_8 = 6;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 153, __pyx_L1_error)
+    __PYX_ERR(0, 132, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS2_m;
 
-  /* "fastrometry/cython_code/WCS.pyx":154
+  /* "fastrometry/cython_code/WCS.pyx":133
  *     wcs_diagnostics_view[5] = CCVALS2_h
  *     wcs_diagnostics_view[6] = CCVALS2_m
  *     wcs_diagnostics_view[7] = CCVALS2_s             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[8] = CVAL1RM
  *     wcs_diagnostics_view[9] = CVAL1RS
  */
   __pyx_t_8 = 7;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 154, __pyx_L1_error)
+    __PYX_ERR(0, 133, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CCVALS2_s;
 
-  /* "fastrometry/cython_code/WCS.pyx":155
+  /* "fastrometry/cython_code/WCS.pyx":134
  *     wcs_diagnostics_view[6] = CCVALS2_m
  *     wcs_diagnostics_view[7] = CCVALS2_s
  *     wcs_diagnostics_view[8] = CVAL1RM             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[9] = CVAL1RS
  *     wcs_diagnostics_view[10] = CVAL2RM
  */
   __pyx_t_8 = 8;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 155, __pyx_L1_error)
+    __PYX_ERR(0, 134, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVAL1RM;
 
-  /* "fastrometry/cython_code/WCS.pyx":156
+  /* "fastrometry/cython_code/WCS.pyx":135
  *     wcs_diagnostics_view[7] = CCVALS2_s
  *     wcs_diagnostics_view[8] = CVAL1RM
  *     wcs_diagnostics_view[9] = CVAL1RS             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[10] = CVAL2RM
  *     wcs_diagnostics_view[11] = CVAL2RS
  */
   __pyx_t_8 = 9;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 156, __pyx_L1_error)
+    __PYX_ERR(0, 135, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVAL1RS;
 
-  /* "fastrometry/cython_code/WCS.pyx":157
+  /* "fastrometry/cython_code/WCS.pyx":136
  *     wcs_diagnostics_view[8] = CVAL1RM
  *     wcs_diagnostics_view[9] = CVAL1RS
  *     wcs_diagnostics_view[10] = CVAL2RM             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[11] = CVAL2RS
  *     wcs_diagnostics_view[12] = CVALRM
  */
   __pyx_t_8 = 10;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 157, __pyx_L1_error)
+    __PYX_ERR(0, 136, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVAL2RM;
 
-  /* "fastrometry/cython_code/WCS.pyx":158
+  /* "fastrometry/cython_code/WCS.pyx":137
  *     wcs_diagnostics_view[9] = CVAL1RS
  *     wcs_diagnostics_view[10] = CVAL2RM
  *     wcs_diagnostics_view[11] = CVAL2RS             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[12] = CVALRM
  *     wcs_diagnostics_view[13] = CVALRS
  */
   __pyx_t_8 = 11;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 158, __pyx_L1_error)
+    __PYX_ERR(0, 137, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVAL2RS;
 
-  /* "fastrometry/cython_code/WCS.pyx":159
+  /* "fastrometry/cython_code/WCS.pyx":138
  *     wcs_diagnostics_view[10] = CVAL2RM
  *     wcs_diagnostics_view[11] = CVAL2RS
  *     wcs_diagnostics_view[12] = CVALRM             # <<<<<<<<<<<<<<
  *     wcs_diagnostics_view[13] = CVALRS
  * 
  */
   __pyx_t_8 = 12;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 159, __pyx_L1_error)
+    __PYX_ERR(0, 138, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVALRM;
 
-  /* "fastrometry/cython_code/WCS.pyx":160
+  /* "fastrometry/cython_code/WCS.pyx":139
  *     wcs_diagnostics_view[11] = CVAL2RS
  *     wcs_diagnostics_view[12] = CVALRM
  *     wcs_diagnostics_view[13] = CVALRS             # <<<<<<<<<<<<<<
  * 
  * def inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmx, intrmy, invtransf_intrmpoint_view):
  */
   __pyx_t_8 = 13;
   __pyx_t_10 = -1;
   if (__pyx_t_8 < 0) {
     __pyx_t_8 += __pyx_v_wcs_diagnostics_view.shape[0];
     if (unlikely(__pyx_t_8 < 0)) __pyx_t_10 = 0;
   } else if (unlikely(__pyx_t_8 >= __pyx_v_wcs_diagnostics_view.shape[0])) __pyx_t_10 = 0;
   if (unlikely(__pyx_t_10 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_10);
-    __PYX_ERR(0, 160, __pyx_L1_error)
+    __PYX_ERR(0, 139, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_wcs_diagnostics_view.data + __pyx_t_8 * __pyx_v_wcs_diagnostics_view.strides[0]) )) = __pyx_v_CVALRS;
 
-  /* "fastrometry/cython_code/WCS.pyx":71
+  /* "fastrometry/cython_code/WCS.pyx":50
  *         skypoints_view[i,1] = asin(cos(c)*sin(d0)+Y*sin(c)*cos(d0)/p)
  * 
  * cdef calculateWCSdiagnostics(int img_xmax, int img_ymax, double[:] refined_solution_view, double[:,:] matchdata_view, int matches, int num_catsources, double[:,:] catalogue_points_view, double[:] mean_catcoords_view, double[:] wcs_diagnostics_view, debug_report, debug):             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
 
@@ -5674,27 +5093,27 @@
   __Pyx_XDECREF(__pyx_v_minutes2);
   __Pyx_XDECREF(__pyx_v_dseconds2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":162
+/* "fastrometry/cython_code/WCS.pyx":141
  *     wcs_diagnostics_view[13] = CVALRS
  * 
  * def inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmx, intrmy, invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_3inverseTransformPointUsingCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3WCS_2inverseTransformPointUsingCD[] = "\n    Use the 4 CD matrix elements and the 2 CRPIX reference coordinates to inverse-transform individual intermediate points.\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_3inverseTransformPointUsingCD = {"inverseTransformPointUsingCD", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_3inverseTransformPointUsingCD, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_2inverseTransformPointUsingCD};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_3inverseTransformPointUsingCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_1inverseTransformPointUsingCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingCD[] = "\n    Use the 4 CD matrix elements and the 2 CRPIX reference coordinates to inverse-transform individual intermediate points.\n    ";
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_1inverseTransformPointUsingCD = {"inverseTransformPointUsingCD", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_1inverseTransformPointUsingCD, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingCD};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_1inverseTransformPointUsingCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_CD11 = 0;
   PyObject *__pyx_v_CD12 = 0;
   PyObject *__pyx_v_CD21 = 0;
   PyObject *__pyx_v_CD22 = 0;
   PyObject *__pyx_v_CRPIXx = 0;
   PyObject *__pyx_v_CRPIXy = 0;
   PyObject *__pyx_v_intrmx = 0;
@@ -5739,61 +5158,61 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CD11)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CD12)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 1); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 1); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CD21)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 2); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 2); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CD22)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 3); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 3); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CRPIXx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 4); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 4); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_CRPIXy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 5); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 5); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 6); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 6); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 7); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 7); __PYX_ERR(0, 141, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_invtransf_intrmpoint_view)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 8); __PYX_ERR(0, 162, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, 8); __PYX_ERR(0, 141, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "inverseTransformPointUsingCD") < 0)) __PYX_ERR(0, 162, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "inverseTransformPointUsingCD") < 0)) __PYX_ERR(0, 141, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 9) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -5812,28 +5231,28 @@
     __pyx_v_CRPIXy = values[5];
     __pyx_v_intrmx = values[6];
     __pyx_v_intrmy = values[7];
     __pyx_v_invtransf_intrmpoint_view = values[8];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 162, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("inverseTransformPointUsingCD", 1, 9, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 141, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.WCS.inverseTransformPointUsingCD", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_2inverseTransformPointUsingCD(__pyx_self, __pyx_v_CD11, __pyx_v_CD12, __pyx_v_CD21, __pyx_v_CD22, __pyx_v_CRPIXx, __pyx_v_CRPIXy, __pyx_v_intrmx, __pyx_v_intrmy, __pyx_v_invtransf_intrmpoint_view);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingCD(__pyx_self, __pyx_v_CD11, __pyx_v_CD12, __pyx_v_CD21, __pyx_v_CD22, __pyx_v_CRPIXx, __pyx_v_CRPIXy, __pyx_v_intrmx, __pyx_v_intrmy, __pyx_v_invtransf_intrmpoint_view);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_2inverseTransformPointUsingCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_CD11, PyObject *__pyx_v_CD12, PyObject *__pyx_v_CD21, PyObject *__pyx_v_CD22, PyObject *__pyx_v_CRPIXx, PyObject *__pyx_v_CRPIXy, PyObject *__pyx_v_intrmx, PyObject *__pyx_v_intrmy, PyObject *__pyx_v_invtransf_intrmpoint_view) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_CD11, PyObject *__pyx_v_CD12, PyObject *__pyx_v_CD21, PyObject *__pyx_v_CD22, PyObject *__pyx_v_CRPIXx, PyObject *__pyx_v_CRPIXy, PyObject *__pyx_v_intrmx, PyObject *__pyx_v_intrmy, PyObject *__pyx_v_invtransf_intrmpoint_view) {
   PyObject *__pyx_v_determinant = NULL;
   PyObject *__pyx_v_CD11inv = NULL;
   PyObject *__pyx_v_CD12inv = NULL;
   PyObject *__pyx_v_CD21inv = NULL;
   PyObject *__pyx_v_CD22inv = NULL;
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
@@ -5841,135 +5260,135 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("inverseTransformPointUsingCD", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":168
+  /* "fastrometry/cython_code/WCS.pyx":147
  *     """
  * 
  *     determinant = CD11*CD22-CD12*CD21             # <<<<<<<<<<<<<<
  *     CD11inv = 1/determinant*CD22
  *     CD12inv = -1/determinant*CD12
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD11, __pyx_v_CD22); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD11, __pyx_v_CD22); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD12, __pyx_v_CD21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 168, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD12, __pyx_v_CD21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_determinant = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":169
+  /* "fastrometry/cython_code/WCS.pyx":148
  * 
  *     determinant = CD11*CD22-CD12*CD21
  *     CD11inv = 1/determinant*CD22             # <<<<<<<<<<<<<<
  *     CD12inv = -1/determinant*CD12
  *     CD21inv = -1/determinant*CD21
  */
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_v_determinant); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 169, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_v_determinant); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_CD22); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_CD22); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 148, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CD11inv = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":170
+  /* "fastrometry/cython_code/WCS.pyx":149
  *     determinant = CD11*CD22-CD12*CD21
  *     CD11inv = 1/determinant*CD22
  *     CD12inv = -1/determinant*CD12             # <<<<<<<<<<<<<<
  *     CD21inv = -1/determinant*CD21
  *     CD22inv = 1/determinant*CD11
  */
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_neg_1, __pyx_v_determinant); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 170, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_neg_1, __pyx_v_determinant); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 149, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_CD12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_CD12); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_CD12inv = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":171
+  /* "fastrometry/cython_code/WCS.pyx":150
  *     CD11inv = 1/determinant*CD22
  *     CD12inv = -1/determinant*CD12
  *     CD21inv = -1/determinant*CD21             # <<<<<<<<<<<<<<
  *     CD22inv = 1/determinant*CD11
  *     invtransf_intrmpoint_view[0] = CRPIXx + CD11inv*intrmx + CD12inv*intrmy
  */
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_int_neg_1, __pyx_v_determinant); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_int_neg_1, __pyx_v_determinant); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_CD21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_3, __pyx_v_CD21); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CD21inv = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":172
+  /* "fastrometry/cython_code/WCS.pyx":151
  *     CD12inv = -1/determinant*CD12
  *     CD21inv = -1/determinant*CD21
  *     CD22inv = 1/determinant*CD11             # <<<<<<<<<<<<<<
  *     invtransf_intrmpoint_view[0] = CRPIXx + CD11inv*intrmx + CD12inv*intrmy
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  */
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_v_determinant); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_v_determinant); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_CD11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_2, __pyx_v_CD11); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_CD22inv = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":173
+  /* "fastrometry/cython_code/WCS.pyx":152
  *     CD21inv = -1/determinant*CD21
  *     CD22inv = 1/determinant*CD11
  *     invtransf_intrmpoint_view[0] = CRPIXx + CD11inv*intrmx + CD12inv*intrmy             # <<<<<<<<<<<<<<
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  * 
  */
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD11inv, __pyx_v_intrmx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 173, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD11inv, __pyx_v_intrmx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Add(__pyx_v_CRPIXx, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 173, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_v_CRPIXx, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD12inv, __pyx_v_intrmy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 173, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD12inv, __pyx_v_intrmy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_invtransf_intrmpoint_view, 0, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 173, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_invtransf_intrmpoint_view, 0, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 152, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":174
+  /* "fastrometry/cython_code/WCS.pyx":153
  *     CD22inv = 1/determinant*CD11
  *     invtransf_intrmpoint_view[0] = CRPIXx + CD11inv*intrmx + CD12inv*intrmy
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy             # <<<<<<<<<<<<<<
  * 
  * def fitNrefineptsToGetCD(params, matchdata, matches):
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD21inv, __pyx_v_intrmx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD21inv, __pyx_v_intrmx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_v_CRPIXy, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_v_CRPIXy, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD22inv, __pyx_v_intrmy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD22inv, __pyx_v_intrmy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 153, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_invtransf_intrmpoint_view, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 174, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_invtransf_intrmpoint_view, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 153, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":162
+  /* "fastrometry/cython_code/WCS.pyx":141
  *     wcs_diagnostics_view[13] = CVALRS
  * 
  * def inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmx, intrmy, invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
@@ -5989,27 +5408,27 @@
   __Pyx_XDECREF(__pyx_v_CD21inv);
   __Pyx_XDECREF(__pyx_v_CD22inv);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":176
+/* "fastrometry/cython_code/WCS.pyx":155
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  * 
  * def fitNrefineptsToGetCD(params, matchdata, matches):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_5fitNrefineptsToGetCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3WCS_4fitNrefineptsToGetCD[] = "\n    The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer\n    will settle on the CD elements and CRPIX coordinates which minimize the Nrefinepts residuals. Each residual is the difference between the forward-\n    transformed pse coordinate and the intermediate coordinate that should result.\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_5fitNrefineptsToGetCD = {"fitNrefineptsToGetCD", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_5fitNrefineptsToGetCD, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_4fitNrefineptsToGetCD};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_5fitNrefineptsToGetCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_3fitNrefineptsToGetCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11fastrometry_11cython_code_3WCS_2fitNrefineptsToGetCD[] = "\n    The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer\n    will settle on the CD elements and CRPIX coordinates which minimize the Nrefinepts residuals. Each residual is the difference between the forward-\n    transformed pse coordinate and the intermediate coordinate that should result.\n    ";
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_3fitNrefineptsToGetCD = {"fitNrefineptsToGetCD", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_3fitNrefineptsToGetCD, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_2fitNrefineptsToGetCD};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_3fitNrefineptsToGetCD(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_params = 0;
   PyObject *__pyx_v_matchdata = 0;
   PyObject *__pyx_v_matches = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -6036,53 +5455,53 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_params)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_matchdata)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, 1); __PYX_ERR(0, 176, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, 1); __PYX_ERR(0, 155, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_matches)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, 2); __PYX_ERR(0, 176, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, 2); __PYX_ERR(0, 155, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fitNrefineptsToGetCD") < 0)) __PYX_ERR(0, 176, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fitNrefineptsToGetCD") < 0)) __PYX_ERR(0, 155, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_params = values[0];
     __pyx_v_matchdata = values[1];
     __pyx_v_matches = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 176, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("fitNrefineptsToGetCD", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 155, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.WCS.fitNrefineptsToGetCD", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_4fitNrefineptsToGetCD(__pyx_self, __pyx_v_params, __pyx_v_matchdata, __pyx_v_matches);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_2fitNrefineptsToGetCD(__pyx_self, __pyx_v_params, __pyx_v_matchdata, __pyx_v_matches);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_4fitNrefineptsToGetCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_matches) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_2fitNrefineptsToGetCD(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_matches) {
   PyObject *__pyx_v_CD11 = NULL;
   PyObject *__pyx_v_CD12 = NULL;
   PyObject *__pyx_v_CD21 = NULL;
   PyObject *__pyx_v_CD22 = NULL;
   PyObject *__pyx_v_CRPIXx = NULL;
   PyObject *__pyx_v_CRPIXy = NULL;
   PyObject *__pyx_v_residuals = NULL;
@@ -6100,341 +5519,341 @@
   Py_ssize_t __pyx_t_5;
   PyObject *(*__pyx_t_6)(PyObject *);
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fitNrefineptsToGetCD", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":183
+  /* "fastrometry/cython_code/WCS.pyx":162
  *     """
  * 
  *     CD11 = params[0]             # <<<<<<<<<<<<<<
  *     CD12 = params[1]
  *     CD21 = params[2]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CD11 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":184
+  /* "fastrometry/cython_code/WCS.pyx":163
  * 
  *     CD11 = params[0]
  *     CD12 = params[1]             # <<<<<<<<<<<<<<
  *     CD21 = params[2]
  *     CD22 = params[3]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CD12 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":185
+  /* "fastrometry/cython_code/WCS.pyx":164
  *     CD11 = params[0]
  *     CD12 = params[1]
  *     CD21 = params[2]             # <<<<<<<<<<<<<<
  *     CD22 = params[3]
  *     CRPIXx = params[4]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CD21 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":186
+  /* "fastrometry/cython_code/WCS.pyx":165
  *     CD12 = params[1]
  *     CD21 = params[2]
  *     CD22 = params[3]             # <<<<<<<<<<<<<<
  *     CRPIXx = params[4]
  *     CRPIXy = params[5]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CD22 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":187
+  /* "fastrometry/cython_code/WCS.pyx":166
  *     CD21 = params[2]
  *     CD22 = params[3]
  *     CRPIXx = params[4]             # <<<<<<<<<<<<<<
  *     CRPIXy = params[5]
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 166, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CRPIXx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":188
+  /* "fastrometry/cython_code/WCS.pyx":167
  *     CD22 = params[3]
  *     CRPIXx = params[4]
  *     CRPIXy = params[5]             # <<<<<<<<<<<<<<
  * 
  *     residuals = np.zeros(matches*2)
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CRPIXy = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":190
+  /* "fastrometry/cython_code/WCS.pyx":169
  *     CRPIXy = params[5]
  * 
  *     residuals = np.zeros(matches*2)             # <<<<<<<<<<<<<<
  * 
  *     for m in range(matches):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_matches, __pyx_int_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_matches, __pyx_int_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_residuals = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":192
+  /* "fastrometry/cython_code/WCS.pyx":171
  *     residuals = np.zeros(matches*2)
  * 
  *     for m in range(matches):             # <<<<<<<<<<<<<<
  *         intrmx = matchdata[m,0]
  *         intrmy = matchdata[m,1]
  */
-  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_matches); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_v_matches); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
   } else {
-    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 192, __pyx_L1_error)
+    __pyx_t_5 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 192, __pyx_L1_error)
+    __pyx_t_6 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 171, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_6)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_5 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 192, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_5 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 192, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_5); __Pyx_INCREF(__pyx_t_1); __pyx_t_5++; if (unlikely(0 < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_5); __pyx_t_5++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_6(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 192, __pyx_L1_error)
+          else __PYX_ERR(0, 171, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_m, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":193
+    /* "fastrometry/cython_code/WCS.pyx":172
  * 
  *     for m in range(matches):
  *         intrmx = matchdata[m,0]             # <<<<<<<<<<<<<<
  *         intrmy = matchdata[m,1]
  *         psex = matchdata[m,3]
  */
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 193, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_m);
     __Pyx_GIVEREF(__pyx_v_m);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_m);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 193, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 172, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_intrmx, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":194
+    /* "fastrometry/cython_code/WCS.pyx":173
  *     for m in range(matches):
  *         intrmx = matchdata[m,0]
  *         intrmy = matchdata[m,1]             # <<<<<<<<<<<<<<
  *         psex = matchdata[m,3]
  *         psey = matchdata[m,4]
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 194, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 173, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_m);
     __Pyx_GIVEREF(__pyx_v_m);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_m);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_1);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_intrmy, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":195
+    /* "fastrometry/cython_code/WCS.pyx":174
  *         intrmx = matchdata[m,0]
  *         intrmy = matchdata[m,1]
  *         psex = matchdata[m,3]             # <<<<<<<<<<<<<<
  *         psey = matchdata[m,4]
  *         residuals[2*m] = (CD11*(psex-CRPIXx) + CD12*(psey-CRPIXy)) - intrmx
  */
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_m);
     __Pyx_GIVEREF(__pyx_v_m);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_m);
     __Pyx_INCREF(__pyx_int_3);
     __Pyx_GIVEREF(__pyx_int_3);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 195, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 174, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_psex, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":196
+    /* "fastrometry/cython_code/WCS.pyx":175
  *         intrmy = matchdata[m,1]
  *         psex = matchdata[m,3]
  *         psey = matchdata[m,4]             # <<<<<<<<<<<<<<
  *         residuals[2*m] = (CD11*(psex-CRPIXx) + CD12*(psey-CRPIXy)) - intrmx
  *         residuals[2*m+1] = (CD21*(psex-CRPIXx) + CD22*(psey-CRPIXy)) - intrmy
  */
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 175, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_v_m);
     __Pyx_GIVEREF(__pyx_v_m);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_m);
     __Pyx_INCREF(__pyx_int_4);
     __Pyx_GIVEREF(__pyx_int_4);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_int_4);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_matchdata, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 175, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_XDECREF_SET(__pyx_v_psey, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":197
+    /* "fastrometry/cython_code/WCS.pyx":176
  *         psex = matchdata[m,3]
  *         psey = matchdata[m,4]
  *         residuals[2*m] = (CD11*(psex-CRPIXx) + CD12*(psey-CRPIXy)) - intrmx             # <<<<<<<<<<<<<<
  *         residuals[2*m+1] = (CD21*(psex-CRPIXx) + CD22*(psey-CRPIXy)) - intrmy
  * 
  */
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_psex, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_v_psex, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD11, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD11, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Subtract(__pyx_v_psey, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Subtract(__pyx_v_psey, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_v_CD12, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_v_CD12, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_v_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (unlikely(PyObject_SetItem(__pyx_v_residuals, __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_residuals, __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 176, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":198
+    /* "fastrometry/cython_code/WCS.pyx":177
  *         psey = matchdata[m,4]
  *         residuals[2*m] = (CD11*(psex-CRPIXx) + CD12*(psey-CRPIXy)) - intrmx
  *         residuals[2*m+1] = (CD21*(psex-CRPIXx) + CD22*(psey-CRPIXy)) - intrmy             # <<<<<<<<<<<<<<
  * 
  *     return residuals
  */
-    __pyx_t_4 = PyNumber_Subtract(__pyx_v_psex, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_v_psex, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD21, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD21, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_v_psey, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_v_psey, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD22, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Multiply(__pyx_v_CD22, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyNumber_Subtract(__pyx_t_4, __pyx_v_intrmy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Subtract(__pyx_t_4, __pyx_v_intrmy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_v_m); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_v_m); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_residuals, __pyx_t_1, __pyx_t_2) < 0)) __PYX_ERR(0, 198, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_residuals, __pyx_t_1, __pyx_t_2) < 0)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":192
+    /* "fastrometry/cython_code/WCS.pyx":171
  *     residuals = np.zeros(matches*2)
  * 
  *     for m in range(matches):             # <<<<<<<<<<<<<<
  *         intrmx = matchdata[m,0]
  *         intrmy = matchdata[m,1]
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":200
+  /* "fastrometry/cython_code/WCS.pyx":179
  *         residuals[2*m+1] = (CD21*(psex-CRPIXx) + CD22*(psey-CRPIXy)) - intrmy
  * 
  *     return residuals             # <<<<<<<<<<<<<<
  * 
  * cdef int refineSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, double[:,:] matchdata_view, int[:] num_matches_view, int npts, int nrefinepts, int img_xmax, int img_ymax, int[:,:] srcindexmap_refine_view, double[:] initial_solution_view, double[:] refined_solution_view, debug_report, filepath, int verbosity, int debug):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_residuals);
   __pyx_r = __pyx_v_residuals;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/WCS.pyx":176
+  /* "fastrometry/cython_code/WCS.pyx":155
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  * 
  * def fitNrefineptsToGetCD(params, matchdata, matches):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer
  */
 
@@ -6460,15 +5879,15 @@
   __Pyx_XDECREF(__pyx_v_psex);
   __Pyx_XDECREF(__pyx_v_psey);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":202
+/* "fastrometry/cython_code/WCS.pyx":181
  *     return residuals
  * 
  * cdef int refineSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, double[:,:] matchdata_view, int[:] num_matches_view, int npts, int nrefinepts, int img_xmax, int img_ymax, int[:,:] srcindexmap_refine_view, double[:] initial_solution_view, double[:] refined_solution_view, debug_report, filepath, int verbosity, int debug):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
@@ -6543,24 +5962,24 @@
   PyObject *__pyx_t_29 = NULL;
   PyObject *__pyx_t_30 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("refineSolution", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":214
+  /* "fastrometry/cython_code/WCS.pyx":193
  *         int nrefinepts_intrm
  *         int nrefinepts_pse
  *         int resultcode = 0             # <<<<<<<<<<<<<<
  * 
  *     #As mentioned before, it's possible (but rare) that the PSE output or the catalogue output may contain
  */
   __pyx_v_resultcode = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":223
+  /* "fastrometry/cython_code/WCS.pyx":202
  *     #a result code of 2.
  * 
  *     if num_catsources < npts or num_psesources < npts:             # <<<<<<<<<<<<<<
  *         resultcode = 2
  *         return resultcode
  */
   __pyx_t_2 = ((__pyx_v_num_catsources < __pyx_v_npts) != 0);
@@ -6570,139 +5989,139 @@
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = ((__pyx_v_num_psesources < __pyx_v_npts) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":224
+    /* "fastrometry/cython_code/WCS.pyx":203
  * 
  *     if num_catsources < npts or num_psesources < npts:
  *         resultcode = 2             # <<<<<<<<<<<<<<
  *         return resultcode
  *     else:
  */
     __pyx_v_resultcode = 2;
 
-    /* "fastrometry/cython_code/WCS.pyx":225
+    /* "fastrometry/cython_code/WCS.pyx":204
  *     if num_catsources < npts or num_psesources < npts:
  *         resultcode = 2
  *         return resultcode             # <<<<<<<<<<<<<<
  *     else:
  *         nrefinepts_intrm = num_catsources
  */
     __pyx_r = __pyx_v_resultcode;
     goto __pyx_L0;
 
-    /* "fastrometry/cython_code/WCS.pyx":223
+    /* "fastrometry/cython_code/WCS.pyx":202
  *     #a result code of 2.
  * 
  *     if num_catsources < npts or num_psesources < npts:             # <<<<<<<<<<<<<<
  *         resultcode = 2
  *         return resultcode
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":227
+  /* "fastrometry/cython_code/WCS.pyx":206
  *         return resultcode
  *     else:
  *         nrefinepts_intrm = num_catsources             # <<<<<<<<<<<<<<
  *         nrefinepts_pse = num_psesources
  * 
  */
   /*else*/ {
     __pyx_v_nrefinepts_intrm = __pyx_v_num_catsources;
 
-    /* "fastrometry/cython_code/WCS.pyx":228
+    /* "fastrometry/cython_code/WCS.pyx":207
  *     else:
  *         nrefinepts_intrm = num_catsources
  *         nrefinepts_pse = num_psesources             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
     __pyx_v_nrefinepts_pse = __pyx_v_num_psesources;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":231
+  /* "fastrometry/cython_code/WCS.pyx":210
  * 
  *     cdef:
  *         double S = initial_solution_view[0]             # <<<<<<<<<<<<<<
  *         double phi = initial_solution_view[1]
  *         double CRPIXx = initial_solution_view[2]
  */
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_initial_solution_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 231, __pyx_L1_error)
+    __PYX_ERR(0, 210, __pyx_L1_error)
   }
   __pyx_v_S = (*((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_3 * __pyx_v_initial_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":232
+  /* "fastrometry/cython_code/WCS.pyx":211
  *     cdef:
  *         double S = initial_solution_view[0]
  *         double phi = initial_solution_view[1]             # <<<<<<<<<<<<<<
  *         double CRPIXx = initial_solution_view[2]
  *         double CRPIXy = initial_solution_view[3]
  */
   __pyx_t_3 = 1;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_initial_solution_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 232, __pyx_L1_error)
+    __PYX_ERR(0, 211, __pyx_L1_error)
   }
   __pyx_v_phi = (*((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_3 * __pyx_v_initial_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":233
+  /* "fastrometry/cython_code/WCS.pyx":212
  *         double S = initial_solution_view[0]
  *         double phi = initial_solution_view[1]
  *         double CRPIXx = initial_solution_view[2]             # <<<<<<<<<<<<<<
  *         double CRPIXy = initial_solution_view[3]
  *         double[:,:] psepoints_view = pse_metadata_view[:nrefinepts_pse,:2]
  */
   __pyx_t_3 = 2;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_initial_solution_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 233, __pyx_L1_error)
+    __PYX_ERR(0, 212, __pyx_L1_error)
   }
   __pyx_v_CRPIXx = (*((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_3 * __pyx_v_initial_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":234
+  /* "fastrometry/cython_code/WCS.pyx":213
  *         double phi = initial_solution_view[1]
  *         double CRPIXx = initial_solution_view[2]
  *         double CRPIXy = initial_solution_view[3]             # <<<<<<<<<<<<<<
  *         double[:,:] psepoints_view = pse_metadata_view[:nrefinepts_pse,:2]
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:nrefinepts_pse,:2]
  */
   __pyx_t_3 = 3;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_initial_solution_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 234, __pyx_L1_error)
+    __PYX_ERR(0, 213, __pyx_L1_error)
   }
   __pyx_v_CRPIXy = (*((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_3 * __pyx_v_initial_solution_view.strides[0]) )));
 
-  /* "fastrometry/cython_code/WCS.pyx":235
+  /* "fastrometry/cython_code/WCS.pyx":214
  *         double CRPIXx = initial_solution_view[2]
  *         double CRPIXy = initial_solution_view[3]
  *         double[:,:] psepoints_view = pse_metadata_view[:nrefinepts_pse,:2]             # <<<<<<<<<<<<<<
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:nrefinepts_pse,:2]
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:nrefinepts_intrm,:]
  */
   __pyx_t_5.data = __pyx_v_pse_metadata_view.data;
@@ -6719,15 +6138,15 @@
     __pyx_v_nrefinepts_pse,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 235, __pyx_L1_error)
+    __PYX_ERR(0, 214, __pyx_L1_error)
 }
 
 if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_5,
     __pyx_v_pse_metadata_view.shape[1], __pyx_v_pse_metadata_view.strides[1], __pyx_v_pse_metadata_view.suboffsets[1],
     1,
     1,
@@ -6736,22 +6155,22 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 235, __pyx_L1_error)
+    __PYX_ERR(0, 214, __pyx_L1_error)
 }
 
 __pyx_v_psepoints_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":236
+  /* "fastrometry/cython_code/WCS.pyx":215
  *         double CRPIXy = initial_solution_view[3]
  *         double[:,:] psepoints_view = pse_metadata_view[:nrefinepts_pse,:2]
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:nrefinepts_pse,:2]             # <<<<<<<<<<<<<<
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:nrefinepts_intrm,:]
  *         double CD11
  */
   __pyx_t_5.data = __pyx_v_pse_metadata_inv_view.data;
@@ -6768,15 +6187,15 @@
     __pyx_v_nrefinepts_pse,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 236, __pyx_L1_error)
+    __PYX_ERR(0, 215, __pyx_L1_error)
 }
 
 if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_5,
     __pyx_v_pse_metadata_inv_view.shape[1], __pyx_v_pse_metadata_inv_view.strides[1], __pyx_v_pse_metadata_inv_view.suboffsets[1],
     1,
     1,
@@ -6785,22 +6204,22 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 236, __pyx_L1_error)
+    __PYX_ERR(0, 215, __pyx_L1_error)
 }
 
 __pyx_v_psepoints_inv_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":237
+  /* "fastrometry/cython_code/WCS.pyx":216
  *         double[:,:] psepoints_view = pse_metadata_view[:nrefinepts_pse,:2]
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:nrefinepts_pse,:2]
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:nrefinepts_intrm,:]             # <<<<<<<<<<<<<<
  *         double CD11
  *         double CD11_guess = S*cos(phi)
  */
   __pyx_t_5.data = __pyx_v_allintrmpoints_view.data;
@@ -6817,141 +6236,141 @@
     __pyx_v_nrefinepts_intrm,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 237, __pyx_L1_error)
+    __PYX_ERR(0, 216, __pyx_L1_error)
 }
 
 __pyx_t_5.shape[1] = __pyx_v_allintrmpoints_view.shape[1];
 __pyx_t_5.strides[1] = __pyx_v_allintrmpoints_view.strides[1];
     __pyx_t_5.suboffsets[1] = -1;
 
 __pyx_v_intrmpoints_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":239
+  /* "fastrometry/cython_code/WCS.pyx":218
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:nrefinepts_intrm,:]
  *         double CD11
  *         double CD11_guess = S*cos(phi)             # <<<<<<<<<<<<<<
  *         double CD12
  *         double CD12_guess = -S*sin(phi)
  */
   __pyx_v_CD11_guess = (__pyx_v_S * cos(__pyx_v_phi));
 
-  /* "fastrometry/cython_code/WCS.pyx":241
+  /* "fastrometry/cython_code/WCS.pyx":220
  *         double CD11_guess = S*cos(phi)
  *         double CD12
  *         double CD12_guess = -S*sin(phi)             # <<<<<<<<<<<<<<
  *         double CD21
  *         double CD21_guess = S*sin(phi)
  */
   __pyx_v_CD12_guess = ((-__pyx_v_S) * sin(__pyx_v_phi));
 
-  /* "fastrometry/cython_code/WCS.pyx":243
+  /* "fastrometry/cython_code/WCS.pyx":222
  *         double CD12_guess = -S*sin(phi)
  *         double CD21
  *         double CD21_guess = S*sin(phi)             # <<<<<<<<<<<<<<
  *         double CD22
  *         double CD22_guess = S*cos(phi)
  */
   __pyx_v_CD21_guess = (__pyx_v_S * sin(__pyx_v_phi));
 
-  /* "fastrometry/cython_code/WCS.pyx":245
+  /* "fastrometry/cython_code/WCS.pyx":224
  *         double CD21_guess = S*sin(phi)
  *         double CD22
  *         double CD22_guess = S*cos(phi)             # <<<<<<<<<<<<<<
  *         double CRPIXx_guess = CRPIXx
  *         double CRPIXy_guess = CRPIXy
  */
   __pyx_v_CD22_guess = (__pyx_v_S * cos(__pyx_v_phi));
 
-  /* "fastrometry/cython_code/WCS.pyx":246
+  /* "fastrometry/cython_code/WCS.pyx":225
  *         double CD22
  *         double CD22_guess = S*cos(phi)
  *         double CRPIXx_guess = CRPIXx             # <<<<<<<<<<<<<<
  *         double CRPIXy_guess = CRPIXy
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  */
   __pyx_v_CRPIXx_guess = __pyx_v_CRPIXx;
 
-  /* "fastrometry/cython_code/WCS.pyx":247
+  /* "fastrometry/cython_code/WCS.pyx":226
  *         double CD22_guess = S*cos(phi)
  *         double CRPIXx_guess = CRPIXx
  *         double CRPIXy_guess = CRPIXy             # <<<<<<<<<<<<<<
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  *         Py_ssize_t k
  */
   __pyx_v_CRPIXy_guess = __pyx_v_CRPIXy;
 
-  /* "fastrometry/cython_code/WCS.pyx":248
+  /* "fastrometry/cython_code/WCS.pyx":227
  *         double CRPIXx_guess = CRPIXx
  *         double CRPIXy_guess = CRPIXy
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)             # <<<<<<<<<<<<<<
  *         Py_ssize_t k
  *         Py_ssize_t m
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_double); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_double); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 248, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_9) < 0) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__7, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__3, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 248, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_9, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 227, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_v_invtransf_intrmpoint_view = __pyx_t_10;
   __pyx_t_10.memview = NULL;
   __pyx_t_10.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":252
+  /* "fastrometry/cython_code/WCS.pyx":231
  *         Py_ssize_t m
  *         int src_ind
  *         int matches = 0             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
   __pyx_v_matches = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":254
+  /* "fastrometry/cython_code/WCS.pyx":233
  *         int matches = 0
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(nrefinepts_pse,nrefinepts_intrm))
  *         print("| | Applying initial solution to the larger dataset...")
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":255
+    /* "fastrometry/cython_code/WCS.pyx":234
  * 
  *     if verbosity >= 1:
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(nrefinepts_pse,nrefinepts_intrm))             # <<<<<<<<<<<<<<
  *         print("| | Applying initial solution to the larger dataset...")
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_working_with_PSE_sources_and_ca, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_working_with_PSE_sources_and_ca, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_pse); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_pse); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_11 = NULL;
     __pyx_t_4 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -6960,149 +6379,149 @@
         __Pyx_DECREF_SET(__pyx_t_6, function);
         __pyx_t_4 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_7, __pyx_t_8};
-      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 255, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 234, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
       PyObject *__pyx_temp[3] = {__pyx_t_11, __pyx_t_7, __pyx_t_8};
-      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 255, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 234, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     } else
     #endif
     {
-      __pyx_t_12 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 255, __pyx_L1_error)
+      __pyx_t_12 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 234, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       if (__pyx_t_11) {
         __Pyx_GIVEREF(__pyx_t_11); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_11); __pyx_t_11 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_4, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_4, __pyx_t_8);
       __pyx_t_7 = 0;
       __pyx_t_8 = 0;
-      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 255, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_12, NULL); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 234, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     }
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_9) < 0) __PYX_ERR(0, 255, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_9) < 0) __PYX_ERR(0, 234, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":256
+    /* "fastrometry/cython_code/WCS.pyx":235
  *     if verbosity >= 1:
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(nrefinepts_pse,nrefinepts_intrm))
  *         print("| | Applying initial solution to the larger dataset...")             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Applying_initial_solution_to_th) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Applying_initial_solution_to_th) < 0) __PYX_ERR(0, 235, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":254
+    /* "fastrometry/cython_code/WCS.pyx":233
  *         int matches = 0
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(nrefinepts_pse,nrefinepts_intrm))
  *         print("| | Applying initial solution to the larger dataset...")
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":258
+  /* "fastrometry/cython_code/WCS.pyx":237
  *         print("| | Applying initial solution to the larger dataset...")
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         invtransf_xs = []
  *         invtransf_ys = []
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":259
+    /* "fastrometry/cython_code/WCS.pyx":238
  * 
  *     if debug:
  *         invtransf_xs = []             # <<<<<<<<<<<<<<
  *         invtransf_ys = []
  *         invtransf_match_xs = []
  */
-    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 259, __pyx_L1_error)
+    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 238, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_v_invtransf_xs = ((PyObject*)__pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":260
+    /* "fastrometry/cython_code/WCS.pyx":239
  *     if debug:
  *         invtransf_xs = []
  *         invtransf_ys = []             # <<<<<<<<<<<<<<
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []
  */
-    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 260, __pyx_L1_error)
+    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_v_invtransf_ys = ((PyObject*)__pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":261
+    /* "fastrometry/cython_code/WCS.pyx":240
  *         invtransf_xs = []
  *         invtransf_ys = []
  *         invtransf_match_xs = []             # <<<<<<<<<<<<<<
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):
  */
-    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 261, __pyx_L1_error)
+    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 240, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_v_invtransf_match_xs = ((PyObject*)__pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":262
+    /* "fastrometry/cython_code/WCS.pyx":241
  *         invtransf_ys = []
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []             # <<<<<<<<<<<<<<
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  */
-    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_9 = PyList_New(0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_v_invtransf_match_ys = ((PyObject*)__pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":258
+    /* "fastrometry/cython_code/WCS.pyx":237
  *         print("| | Applying initial solution to the larger dataset...")
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         invtransf_xs = []
  *         invtransf_ys = []
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":263
+  /* "fastrometry/cython_code/WCS.pyx":242
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):             # <<<<<<<<<<<<<<
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:
  */
   __pyx_t_4 = __pyx_v_nrefinepts_intrm;
   __pyx_t_13 = __pyx_t_4;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "fastrometry/cython_code/WCS.pyx":264
+    /* "fastrometry/cython_code/WCS.pyx":243
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)             # <<<<<<<<<<<<<<
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  */
     __pyx_t_3 = __pyx_v_k;
@@ -7114,116 +6533,116 @@
     } else if (unlikely(__pyx_t_3 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_15 < 0) {
       __pyx_t_15 += __pyx_v_intrmpoints_view.shape[1];
       if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_15 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 264, __pyx_L1_error)
+      __PYX_ERR(0, 243, __pyx_L1_error)
     }
     __pyx_t_17 = __pyx_v_k;
     __pyx_t_18 = 1;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_intrmpoints_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_intrmpoints_view.shape[1];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 264, __pyx_L1_error)
+      __PYX_ERR(0, 243, __pyx_L1_error)
     }
-    __pyx_t_9 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_3 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_15 * __pyx_v_intrmpoints_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) ))), __pyx_v_invtransf_intrmpoint_view); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 264, __pyx_L1_error)
+    __pyx_t_9 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_3 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_15 * __pyx_v_intrmpoints_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) ))), __pyx_v_invtransf_intrmpoint_view); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 243, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":265
+    /* "fastrometry/cython_code/WCS.pyx":244
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:             # <<<<<<<<<<<<<<
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
     __pyx_t_1 = (__pyx_v_debug != 0);
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":266
+      /* "fastrometry/cython_code/WCS.pyx":245
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  */
-      if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 266, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 245, __pyx_L1_error) }
       __pyx_t_18 = 0;
       __pyx_t_16 = -1;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 266, __pyx_L1_error)
+        __PYX_ERR(0, 245, __pyx_L1_error)
       }
-      __pyx_t_9 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 266, __pyx_L1_error)
+      __pyx_t_9 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 245, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_xs, __pyx_t_9); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 266, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_xs, __pyx_t_9); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 245, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":267
+      /* "fastrometry/cython_code/WCS.pyx":246
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  */
-      if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 267, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 246, __pyx_L1_error) }
       __pyx_t_18 = 1;
       __pyx_t_16 = -1;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 267, __pyx_L1_error)
+        __PYX_ERR(0, 246, __pyx_L1_error)
       }
-      __pyx_t_9 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 267, __pyx_L1_error)
+      __pyx_t_9 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 246, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_ys, __pyx_t_9); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 267, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_ys, __pyx_t_9); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 246, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":265
+      /* "fastrometry/cython_code/WCS.pyx":244
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:             # <<<<<<<<<<<<<<
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":268
+    /* "fastrometry/cython_code/WCS.pyx":247
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  */
     __pyx_t_18 = 0;
     __pyx_t_16 = -1;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 268, __pyx_L1_error)
+      __PYX_ERR(0, 247, __pyx_L1_error)
     }
     __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
     __pyx_t_2 = (1.0 <= __pyx_t_20);
     if (__pyx_t_2) {
       __pyx_t_2 = (__pyx_t_20 <= __pyx_v_img_xmax);
     }
     __pyx_t_21 = (__pyx_t_2 != 0);
@@ -7236,107 +6655,107 @@
     __pyx_t_16 = -1;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 268, __pyx_L1_error)
+      __PYX_ERR(0, 247, __pyx_L1_error)
     }
     __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
     __pyx_t_21 = (1.0 <= __pyx_t_20);
     if (__pyx_t_21) {
       __pyx_t_21 = (__pyx_t_20 <= __pyx_v_img_ymax);
     }
     __pyx_t_2 = (__pyx_t_21 != 0);
     __pyx_t_1 = __pyx_t_2;
     __pyx_L12_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":269
+      /* "fastrometry/cython_code/WCS.pyx":248
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]             # <<<<<<<<<<<<<<
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  */
-      __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __pyx_t_18 = 1;
       __pyx_t_16 = -1;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 269, __pyx_L1_error)
+        __PYX_ERR(0, 248, __pyx_L1_error)
       }
-      __pyx_t_6 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_12 = PyNumber_Subtract(__pyx_t_9, __pyx_t_6); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_12 = PyNumber_Subtract(__pyx_t_9, __pyx_t_6); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_12, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_12, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_6); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_18 = 0;
       __pyx_t_16 = -1;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 269, __pyx_L1_error)
+        __PYX_ERR(0, 248, __pyx_L1_error)
       }
-      __pyx_t_12 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
-      __pyx_t_9 = PyNumber_Subtract(__pyx_t_6, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Subtract(__pyx_t_6, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_t_9, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyInt_SubtractObjC(__pyx_t_9, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_23 = __Pyx_PyIndex_AsSsize_t(__pyx_t_12); if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 269, __pyx_L1_error)
+      __pyx_t_23 = __Pyx_PyIndex_AsSsize_t(__pyx_t_12); if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __pyx_t_18 = __pyx_t_22;
       __pyx_t_17 = __pyx_t_23;
       __pyx_t_16 = -1;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[0];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_16 = 0;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_srcindexmap_refine_view.shape[1];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_16 = 1;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 269, __pyx_L1_error)
+        __PYX_ERR(0, 248, __pyx_L1_error)
       }
       __pyx_v_src_ind = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_17 * __pyx_v_srcindexmap_refine_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/WCS.pyx":270
+      /* "fastrometry/cython_code/WCS.pyx":249
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  */
       __pyx_t_1 = ((__pyx_v_src_ind != -1L) != 0);
       if (__pyx_t_1) {
 
-        /* "fastrometry/cython_code/WCS.pyx":271
+        /* "fastrometry/cython_code/WCS.pyx":250
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  */
         __pyx_t_17 = __pyx_v_k;
@@ -7348,34 +6767,34 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_intrmpoints_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 271, __pyx_L1_error)
+          __PYX_ERR(0, 250, __pyx_L1_error)
         }
         __pyx_t_15 = __pyx_v_matches;
         __pyx_t_3 = 0;
         __pyx_t_16 = -1;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 271, __pyx_L1_error)
+          __PYX_ERR(0, 250, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_15 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_3 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":272
+        /* "fastrometry/cython_code/WCS.pyx":251
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  */
         __pyx_t_18 = __pyx_v_k;
@@ -7387,34 +6806,34 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_intrmpoints_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 272, __pyx_L1_error)
+          __PYX_ERR(0, 251, __pyx_L1_error)
         }
         __pyx_t_3 = __pyx_v_matches;
         __pyx_t_15 = 1;
         __pyx_t_16 = -1;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 272, __pyx_L1_error)
+          __PYX_ERR(0, 251, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_3 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":273
+        /* "fastrometry/cython_code/WCS.pyx":252
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  */
         __pyx_t_17 = __pyx_v_matches;
@@ -7426,19 +6845,19 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 273, __pyx_L1_error)
+          __PYX_ERR(0, 252, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_17 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_matchdata_view.strides[1]) )) = __pyx_v_k;
 
-        /* "fastrometry/cython_code/WCS.pyx":274
+        /* "fastrometry/cython_code/WCS.pyx":253
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  */
         __pyx_t_18 = __pyx_v_src_ind;
@@ -7450,34 +6869,34 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_psepoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_psepoints_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_psepoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 274, __pyx_L1_error)
+          __PYX_ERR(0, 253, __pyx_L1_error)
         }
         __pyx_t_15 = __pyx_v_matches;
         __pyx_t_3 = 3;
         __pyx_t_16 = -1;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 274, __pyx_L1_error)
+          __PYX_ERR(0, 253, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_15 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_3 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psepoints_view.data + __pyx_t_18 * __pyx_v_psepoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_psepoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":275
+        /* "fastrometry/cython_code/WCS.pyx":254
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  */
         __pyx_t_17 = __pyx_v_src_ind;
@@ -7489,34 +6908,34 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_psepoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_psepoints_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_psepoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 275, __pyx_L1_error)
+          __PYX_ERR(0, 254, __pyx_L1_error)
         }
         __pyx_t_3 = __pyx_v_matches;
         __pyx_t_15 = 4;
         __pyx_t_16 = -1;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 275, __pyx_L1_error)
+          __PYX_ERR(0, 254, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_3 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psepoints_view.data + __pyx_t_17 * __pyx_v_psepoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_psepoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":276
+        /* "fastrometry/cython_code/WCS.pyx":255
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata             # <<<<<<<<<<<<<<
  *                 matches += 1
  *                 if debug:
  */
         __pyx_t_18 = __pyx_v_matches;
@@ -7528,454 +6947,454 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 276, __pyx_L1_error)
+          __PYX_ERR(0, 255, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_18 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_17 * __pyx_v_matchdata_view.strides[1]) )) = __pyx_v_src_ind;
 
-        /* "fastrometry/cython_code/WCS.pyx":277
+        /* "fastrometry/cython_code/WCS.pyx":256
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1             # <<<<<<<<<<<<<<
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  */
         __pyx_v_matches = (__pyx_v_matches + 1);
 
-        /* "fastrometry/cython_code/WCS.pyx":278
+        /* "fastrometry/cython_code/WCS.pyx":257
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  *                 if debug:             # <<<<<<<<<<<<<<
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
         __pyx_t_1 = (__pyx_v_debug != 0);
         if (__pyx_t_1) {
 
-          /* "fastrometry/cython_code/WCS.pyx":279
+          /* "fastrometry/cython_code/WCS.pyx":258
  *                 matches += 1
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  */
-          if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 279, __pyx_L1_error) }
+          if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 258, __pyx_L1_error) }
           __pyx_t_17 = 0;
           __pyx_t_16 = -1;
           if (__pyx_t_17 < 0) {
             __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
             if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
           } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
           if (unlikely(__pyx_t_16 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_16);
-            __PYX_ERR(0, 279, __pyx_L1_error)
+            __PYX_ERR(0, 258, __pyx_L1_error)
           }
-          __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 279, __pyx_L1_error)
+          __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 258, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_xs, __pyx_t_12); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 279, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_xs, __pyx_t_12); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 258, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-          /* "fastrometry/cython_code/WCS.pyx":280
+          /* "fastrometry/cython_code/WCS.pyx":259
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-          if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 280, __pyx_L1_error) }
+          if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 259, __pyx_L1_error) }
           __pyx_t_17 = 1;
           __pyx_t_16 = -1;
           if (__pyx_t_17 < 0) {
             __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
             if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
           } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
           if (unlikely(__pyx_t_16 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_16);
-            __PYX_ERR(0, 280, __pyx_L1_error)
+            __PYX_ERR(0, 259, __pyx_L1_error)
           }
-          __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 280, __pyx_L1_error)
+          __pyx_t_12 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 259, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_ys, __pyx_t_12); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 280, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_ys, __pyx_t_12); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 259, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-          /* "fastrometry/cython_code/WCS.pyx":278
+          /* "fastrometry/cython_code/WCS.pyx":257
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  *                 if debug:             # <<<<<<<<<<<<<<
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
         }
 
-        /* "fastrometry/cython_code/WCS.pyx":270
+        /* "fastrometry/cython_code/WCS.pyx":249
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  */
       }
 
-      /* "fastrometry/cython_code/WCS.pyx":268
+      /* "fastrometry/cython_code/WCS.pyx":247
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *             src_ind = srcindexmap_refine_view[img_ymax-int(invtransf_intrmpoint_view[1])-1, img_xmax-int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  */
     }
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":282
+  /* "fastrometry/cython_code/WCS.pyx":261
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_initial_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":283
+    /* "fastrometry/cython_code/WCS.pyx":262
  * 
  *     if debug:
  *         np.savetxt(debug_report/"matchdata_initial_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_12, __pyx_n_s_np); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_matchdata_initial__csv, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_matchdata_initial__csv, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_12 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_12 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_11, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_12);
     __pyx_t_6 = 0;
     __pyx_t_12 = 0;
-    __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_7, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 262, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":282
+    /* "fastrometry/cython_code/WCS.pyx":261
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_initial_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":285
+  /* "fastrometry/cython_code/WCS.pyx":264
  *         np.savetxt(debug_report/"matchdata_initial_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | | Found {} matches.".format(matches))
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":286
+    /* "fastrometry/cython_code/WCS.pyx":265
  * 
  *     if verbosity >= 1:
  *         print("| | | Found {} matches.".format(matches))             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches, __pyx_n_s_format); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches, __pyx_n_s_format); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_12);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_12, function);
       }
     }
     __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_9, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 265, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_6) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_6) < 0) __PYX_ERR(0, 265, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":285
+    /* "fastrometry/cython_code/WCS.pyx":264
  *         np.savetxt(debug_report/"matchdata_initial_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | | Found {} matches.".format(matches))
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":288
+  /* "fastrometry/cython_code/WCS.pyx":267
  *         print("| | | Found {} matches.".format(matches))
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":289
+    /* "fastrometry/cython_code/WCS.pyx":268
  * 
  *     if debug:
  *         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  */
-    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 268, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_INCREF(__pyx_n_s__8);
-    __Pyx_GIVEREF(__pyx_n_s__8);
-    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_n_s__8);
-    __pyx_t_12 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_6, -1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 289, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_n_s__4);
+    __Pyx_GIVEREF(__pyx_n_s__4);
+    PyList_SET_ITEM(__pyx_t_6, 0, __pyx_n_s__4);
+    __pyx_t_12 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_6, -1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 268, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_plt = __pyx_t_12;
     __pyx_t_12 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":290
+    /* "fastrometry/cython_code/WCS.pyx":269
  *     if debug:
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  */
-    __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_INCREF(__pyx_n_s_LogNorm);
     __Pyx_GIVEREF(__pyx_n_s_LogNorm);
     PyList_SET_ITEM(__pyx_t_12, 0, __pyx_n_s_LogNorm);
-    __pyx_t_6 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_12, -1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_12, -1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
-    __pyx_t_12 = __Pyx_ImportFrom(__pyx_t_6, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 290, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_ImportFrom(__pyx_t_6, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_INCREF(__pyx_t_12);
     __pyx_v_LogNorm = __pyx_t_12;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":291
+    /* "fastrometry/cython_code/WCS.pyx":270
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits             # <<<<<<<<<<<<<<
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(9.5,8))
  */
-    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
+    __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 270, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_n_s_fits);
     __Pyx_GIVEREF(__pyx_n_s_fits);
     PyList_SET_ITEM(__pyx_t_6, 0, __pyx_n_s_fits);
-    __pyx_t_12 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_6, -1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 291, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_6, -1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 270, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_ImportFrom(__pyx_t_12, __pyx_n_s_fits); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_ImportFrom(__pyx_t_12, __pyx_n_s_fits); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 270, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_t_6);
     __pyx_v_fits = __pyx_t_6;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":292
+    /* "fastrometry/cython_code/WCS.pyx":271
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)             # <<<<<<<<<<<<<<
  *         fig = plt.figure(figsize=(9.5,8))
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_12 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_v_filepath) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_filepath);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 292, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_image_data = __pyx_t_12;
     __pyx_t_12 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":293
+    /* "fastrometry/cython_code/WCS.pyx":272
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(9.5,8))             # <<<<<<<<<<<<<<
  * 
  *         axes = fig.add_subplot(111)
  */
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 272, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 272, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_figsize, __pyx_tuple__9) < 0) __PYX_ERR(0, 293, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_empty_tuple, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 293, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_figsize, __pyx_tuple__5) < 0) __PYX_ERR(0, 272, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_empty_tuple, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 272, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_fig = __pyx_t_7;
     __pyx_t_7 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":295
+    /* "fastrometry/cython_code/WCS.pyx":274
  *         fig = plt.figure(figsize=(9.5,8))
  * 
  *         axes = fig.add_subplot(111)             # <<<<<<<<<<<<<<
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker="o", color='white')
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 274, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_12);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_12, __pyx_int_111) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_int_111);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 295, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 274, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_axes = __pyx_t_7;
     __pyx_t_7 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":296
+    /* "fastrometry/cython_code/WCS.pyx":275
  * 
  *         axes = fig.add_subplot(111)
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 296, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_v_image_data);
     __Pyx_GIVEREF(__pyx_v_image_data);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_v_image_data);
-    __pyx_t_12 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 296, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_INCREF(__pyx_v_LogNorm);
     __pyx_t_8 = __pyx_v_LogNorm; __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_9 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_11) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 296, __pyx_L1_error)
+    if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_norm, __pyx_t_9) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_12, __pyx_n_s_norm, __pyx_t_9) < 0) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_6, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 296, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_6, __pyx_t_12); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 275, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":298
+    /* "fastrometry/cython_code/WCS.pyx":277
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')             # <<<<<<<<<<<<<<
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')             # <<<<<<<<<<<<<<
  *         axes.scatter(img_xmax-np.asarray(invtransf_xs), img_ymax-np.asarray(invtransf_ys), marker='.', color='fuchsia')
  * 
  */
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_10.data = __pyx_v_psepoints_view.data;
     __pyx_t_10.memview = __pyx_v_psepoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     __pyx_t_10.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_10.strides[0] = __pyx_v_psepoints_view.strides[0];
@@ -7986,20 +7405,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 298, __pyx_L1_error)
+            __PYX_ERR(0, 277, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
@@ -8009,20 +7428,20 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_12 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 298, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_10.data = __pyx_v_psepoints_view.data;
     __pyx_t_10.memview = __pyx_v_psepoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     __pyx_t_10.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_10.strides[0] = __pyx_v_psepoints_view.strides[0];
@@ -8033,20 +7452,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 298, __pyx_L1_error)
+            __PYX_ERR(0, 277, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_8);
@@ -8056,175 +7475,175 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_7 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_11, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_12);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_12);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_7);
     __pyx_t_12 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_marker, __pyx_kp_s__10) < 0) __PYX_ERR(0, 298, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_color, __pyx_n_s_yellow) < 0) __PYX_ERR(0, 298, __pyx_L1_error)
-    __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 298, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_marker, __pyx_n_s_o) < 0) __PYX_ERR(0, 277, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_color, __pyx_n_s_blue) < 0) __PYX_ERR(0, 277, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":299
+    /* "fastrometry/cython_code/WCS.pyx":278
  *         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')
  *         axes.scatter(img_xmax-np.asarray(invtransf_xs), img_ymax-np.asarray(invtransf_ys), marker='.', color='fuchsia')             # <<<<<<<<<<<<<<
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the parameters that were found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(nrefinepts_intrm)
  */
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 299, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 278, __pyx_L1_error) }
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_8 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_v_invtransf_xs) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_invtransf_xs);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 299, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Subtract(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_7, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_asarray); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_asarray); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 299, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 278, __pyx_L1_error) }
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_9, __pyx_v_invtransf_ys) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_v_invtransf_ys);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_11 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_11);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_11);
     __pyx_t_6 = 0;
     __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 299, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_color, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 299, __pyx_L1_error)
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 278, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_color, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 278, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_7, __pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":301
+    /* "fastrometry/cython_code/WCS.pyx":280
  *         axes.scatter(img_xmax-np.asarray(invtransf_xs), img_ymax-np.asarray(invtransf_ys), marker='.', color='fuchsia')
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the parameters that were found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(nrefinepts_intrm)             # <<<<<<<<<<<<<<
  *         plt.title("Inverse transform - {} points - initial solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 301, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 301, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_12);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_6 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 301, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 280, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __pyx_v_dscrp = __pyx_t_6;
     __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":302
+    /* "fastrometry/cython_code/WCS.pyx":281
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the parameters that were found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(nrefinepts_intrm)
  *         plt.title("Inverse transform - {} points - initial solution".format(nrefinepts_intrm))             # <<<<<<<<<<<<<<
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_initial, __pyx_n_s_format); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_initial, __pyx_n_s_format); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_12))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_12);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_12, function);
       }
     }
     __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_12, __pyx_t_9, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_12, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 302, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -8232,101 +7651,101 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_6 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_12, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 302, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 281, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":303
+    /* "fastrometry/cython_code/WCS.pyx":282
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the parameters that were found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(nrefinepts_intrm)
  *         plt.title("Inverse transform - {} points - initial solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(nrefinepts_intrm))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_11 = PyTuple_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_11 = PyTuple_New(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_INCREF(__pyx_float_0_5);
     __Pyx_GIVEREF(__pyx_float_0_5);
     PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_float_0_5);
     __Pyx_INCREF(__pyx_float_0_05);
     __Pyx_GIVEREF(__pyx_float_0_05);
     PyTuple_SET_ITEM(__pyx_t_11, 1, __pyx_float_0_05);
     __Pyx_INCREF(__pyx_v_dscrp);
     __Pyx_GIVEREF(__pyx_v_dscrp);
     PyTuple_SET_ITEM(__pyx_t_11, 2, __pyx_v_dscrp);
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
-    __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 303, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 282, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 282, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_11, __pyx_t_7); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 282, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":304
+    /* "fastrometry/cython_code/WCS.pyx":283
  *         plt.title("Inverse transform - {} points - initial solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)             # <<<<<<<<<<<<<<
  *         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(nrefinepts_intrm))
  *         plt.show()
  */
-    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 283, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 283, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
-    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 304, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_empty_tuple, __pyx_t_7); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 283, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":305
+    /* "fastrometry/cython_code/WCS.pyx":284
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(nrefinepts_intrm))             # <<<<<<<<<<<<<<
  *         plt.show()
  * 
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 305, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_initial__pn, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_initial__pn, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 305, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_9 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_12 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_9, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 305, __pyx_L1_error)
+    if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
     __pyx_t_12 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_12)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -8334,116 +7753,116 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_11 = (__pyx_t_12) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_12, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 305, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":306
+    /* "fastrometry/cython_code/WCS.pyx":285
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(nrefinepts_intrm))
  *         plt.show()             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 306, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_11 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 306, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 285, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":288
+    /* "fastrometry/cython_code/WCS.pyx":267
  *         print("| | | Found {} matches.".format(matches))
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":308
+  /* "fastrometry/cython_code/WCS.pyx":287
  *         plt.show()
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Optimizing solution using the larger dataset...")
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":309
+    /* "fastrometry/cython_code/WCS.pyx":288
  * 
  *     if verbosity >= 1:
  *         print("| | done")             # <<<<<<<<<<<<<<
  *         print("| | Optimizing solution using the larger dataset...")
  * 
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 309, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 288, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":310
+    /* "fastrometry/cython_code/WCS.pyx":289
  *     if verbosity >= 1:
  *         print("| | done")
  *         print("| | Optimizing solution using the larger dataset...")             # <<<<<<<<<<<<<<
  * 
  *     guess = np.array([CD11_guess, CD12_guess, CD21_guess, CD22_guess, CRPIXx_guess, CRPIXy_guess])
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Optimizing_solution_using_the_l) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Optimizing_solution_using_the_l) < 0) __PYX_ERR(0, 289, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":308
+    /* "fastrometry/cython_code/WCS.pyx":287
  *         plt.show()
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Optimizing solution using the larger dataset...")
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":312
+  /* "fastrometry/cython_code/WCS.pyx":291
  *         print("| | Optimizing solution using the larger dataset...")
  * 
  *     guess = np.array([CD11_guess, CD12_guess, CD21_guess, CD22_guess, CRPIXx_guess, CRPIXy_guess])             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CD11_guess); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CD11_guess); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_CD12_guess); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_CD12_guess); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
-  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CD21_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CD21_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_9 = PyFloat_FromDouble(__pyx_v_CD22_guess); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_9 = PyFloat_FromDouble(__pyx_v_CD22_guess); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  __pyx_t_24 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_24 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_24);
-  __pyx_t_25 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_25 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_26 = PyList_New(6); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 312, __pyx_L1_error)
+  __pyx_t_26 = PyList_New(6); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_26);
   __Pyx_GIVEREF(__pyx_t_7);
   PyList_SET_ITEM(__pyx_t_26, 0, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_12);
   PyList_SET_ITEM(__pyx_t_26, 1, __pyx_t_12);
   __Pyx_GIVEREF(__pyx_t_8);
   PyList_SET_ITEM(__pyx_t_26, 2, __pyx_t_8);
@@ -8468,832 +7887,806 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
   __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 312, __pyx_L1_error)
+  if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 291, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_guess = __pyx_t_11;
   __pyx_t_11 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":314
+  /* "fastrometry/cython_code/WCS.pyx":293
  *     guess = np.array([CD11_guess, CD12_guess, CD21_guess, CD22_guess, CRPIXx_guess, CRPIXy_guess])
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | CD1_1_guess = {}".format(CD11_guess))
  *         print("| | CD1_2_guess = {}".format(CD12_guess))
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":315
+    /* "fastrometry/cython_code/WCS.pyx":294
  * 
  *     if verbosity == 2:
  *         print("| | CD1_1_guess = {}".format(CD11_guess))             # <<<<<<<<<<<<<<
  *         print("| | CD1_2_guess = {}".format(CD12_guess))
  *         print("| | CD2_1_guess = {}".format(CD21_guess))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD11_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD11_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 294, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 315, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 294, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 315, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 294, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":316
+    /* "fastrometry/cython_code/WCS.pyx":295
  *     if verbosity == 2:
  *         print("| | CD1_1_guess = {}".format(CD11_guess))
  *         print("| | CD1_2_guess = {}".format(CD12_guess))             # <<<<<<<<<<<<<<
  *         print("| | CD2_1_guess = {}".format(CD21_guess))
  *         print("| | CD2_2_guess = {}".format(CD22_guess))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD12_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD12_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 295, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 316, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 295, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 316, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 295, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":317
+    /* "fastrometry/cython_code/WCS.pyx":296
  *         print("| | CD1_1_guess = {}".format(CD11_guess))
  *         print("| | CD1_2_guess = {}".format(CD12_guess))
  *         print("| | CD2_1_guess = {}".format(CD21_guess))             # <<<<<<<<<<<<<<
  *         print("| | CD2_2_guess = {}".format(CD22_guess))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD21_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD21_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 317, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 317, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":318
+    /* "fastrometry/cython_code/WCS.pyx":297
  *         print("| | CD1_2_guess = {}".format(CD12_guess))
  *         print("| | CD2_1_guess = {}".format(CD21_guess))
  *         print("| | CD2_2_guess = {}".format(CD22_guess))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD22_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD22_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 318, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 297, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 297, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":319
+    /* "fastrometry/cython_code/WCS.pyx":298
  *         print("| | CD2_1_guess = {}".format(CD21_guess))
  *         print("| | CD2_2_guess = {}".format(CD22_guess))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 319, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 298, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 319, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 298, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 319, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 298, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":320
+    /* "fastrometry/cython_code/WCS.pyx":299
  *         print("| | CD2_2_guess = {}".format(CD22_guess))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))             # <<<<<<<<<<<<<<
  * 
- *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, x_scale=[1e-6, 1e-6, 1e-6, 1e-6, CRPIXx_guess, CRPIXy_guess], args=(np.asarray(matchdata_view), matches))
+ *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, args=(np.asarray(matchdata_view), matches))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 320, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_25, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_26);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 320, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_11) < 0) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":314
+    /* "fastrometry/cython_code/WCS.pyx":293
  *     guess = np.array([CD11_guess, CD12_guess, CD21_guess, CD22_guess, CRPIXx_guess, CRPIXy_guess])
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | CD1_1_guess = {}".format(CD11_guess))
  *         print("| | CD1_2_guess = {}".format(CD12_guess))
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":322
+  /* "fastrometry/cython_code/WCS.pyx":301
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  * 
- *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, x_scale=[1e-6, 1e-6, 1e-6, 1e-6, CRPIXx_guess, CRPIXy_guess], args=(np.asarray(matchdata_view), matches))             # <<<<<<<<<<<<<<
+ *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, args=(np.asarray(matchdata_view), matches))             # <<<<<<<<<<<<<<
  *     CD11 = optimizedparams.x[0]
  *     CD12 = optimizedparams.x[1]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_optimization); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_optimization); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_least_squares); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_least_squares); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_11 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyDict_NewPresized(3); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __Pyx_GetModuleGlobalName(__pyx_t_26, __pyx_n_s_fitNrefineptsToGetCD); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_26, __pyx_n_s_fitNrefineptsToGetCD); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_26);
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_fun, __pyx_t_26) < 0) __PYX_ERR(0, 322, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_fun, __pyx_t_26) < 0) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_x0, __pyx_v_guess) < 0) __PYX_ERR(0, 322, __pyx_L1_error)
-  __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_26);
-  __pyx_t_25 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_x0, __pyx_v_guess) < 0) __PYX_ERR(0, 301, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_25, __pyx_n_s_np); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_24 = PyList_New(6); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_24 = __Pyx_PyObject_GetAttrStr(__pyx_t_25, __pyx_n_s_asarray); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_24);
-  __Pyx_INCREF(__pyx_float_1eneg_6);
-  __Pyx_GIVEREF(__pyx_float_1eneg_6);
-  PyList_SET_ITEM(__pyx_t_24, 0, __pyx_float_1eneg_6);
-  __Pyx_INCREF(__pyx_float_1eneg_6);
-  __Pyx_GIVEREF(__pyx_float_1eneg_6);
-  PyList_SET_ITEM(__pyx_t_24, 1, __pyx_float_1eneg_6);
-  __Pyx_INCREF(__pyx_float_1eneg_6);
-  __Pyx_GIVEREF(__pyx_float_1eneg_6);
-  PyList_SET_ITEM(__pyx_t_24, 2, __pyx_float_1eneg_6);
-  __Pyx_INCREF(__pyx_float_1eneg_6);
-  __Pyx_GIVEREF(__pyx_float_1eneg_6);
-  PyList_SET_ITEM(__pyx_t_24, 3, __pyx_float_1eneg_6);
-  __Pyx_GIVEREF(__pyx_t_26);
-  PyList_SET_ITEM(__pyx_t_24, 4, __pyx_t_26);
-  __Pyx_GIVEREF(__pyx_t_25);
-  PyList_SET_ITEM(__pyx_t_24, 5, __pyx_t_25);
-  __pyx_t_26 = 0;
-  __pyx_t_25 = 0;
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_x_scale, __pyx_t_24) < 0) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_25, __pyx_n_s_np); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_26 = __Pyx_PyObject_GetAttrStr(__pyx_t_25, __pyx_n_s_asarray); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_26);
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_25 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __pyx_t_9 = NULL;
-  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_26))) {
-    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_26);
+  if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_24))) {
+    __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_24);
     if (likely(__pyx_t_9)) {
-      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_26);
+      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
       __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
-      __Pyx_DECREF_SET(__pyx_t_26, function);
+      __Pyx_DECREF_SET(__pyx_t_24, function);
     }
   }
-  __pyx_t_24 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_26, __pyx_t_9, __pyx_t_25) : __Pyx_PyObject_CallOneArg(__pyx_t_26, __pyx_t_25);
+  __pyx_t_26 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_24, __pyx_t_9, __pyx_t_25) : __Pyx_PyObject_CallOneArg(__pyx_t_24, __pyx_t_25);
   __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_24);
-  __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-  __pyx_t_26 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 322, __pyx_L1_error)
+  if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_26);
-  __pyx_t_25 = PyTuple_New(2); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
+  __pyx_t_24 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 301, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_24);
+  __pyx_t_25 = PyTuple_New(2); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __Pyx_GIVEREF(__pyx_t_24);
-  PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_24);
   __Pyx_GIVEREF(__pyx_t_26);
-  PyTuple_SET_ITEM(__pyx_t_25, 1, __pyx_t_26);
-  __pyx_t_24 = 0;
+  PyTuple_SET_ITEM(__pyx_t_25, 0, __pyx_t_26);
+  __Pyx_GIVEREF(__pyx_t_24);
+  PyTuple_SET_ITEM(__pyx_t_25, 1, __pyx_t_24);
   __pyx_t_26 = 0;
-  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_args, __pyx_t_25) < 0) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_24 = 0;
+  if (PyDict_SetItem(__pyx_t_11, __pyx_n_s_args, __pyx_t_25) < 0) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_empty_tuple, __pyx_t_11); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_empty_tuple, __pyx_t_11); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 301, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_optimizedparams = __pyx_t_25;
   __pyx_t_25 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":323
+  /* "fastrometry/cython_code/WCS.pyx":302
  * 
- *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, x_scale=[1e-6, 1e-6, 1e-6, 1e-6, CRPIXx_guess, CRPIXy_guess], args=(np.asarray(matchdata_view), matches))
+ *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, args=(np.asarray(matchdata_view), matches))
  *     CD11 = optimizedparams.x[0]             # <<<<<<<<<<<<<<
  *     CD12 = optimizedparams.x[1]
  *     CD21 = optimizedparams.x[2]
  */
-  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 323, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 302, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 323, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 302, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 323, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 302, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_CD11 = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":324
- *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, x_scale=[1e-6, 1e-6, 1e-6, 1e-6, CRPIXx_guess, CRPIXy_guess], args=(np.asarray(matchdata_view), matches))
+  /* "fastrometry/cython_code/WCS.pyx":303
+ *     optimizedparams = optimization.least_squares(fun=fitNrefineptsToGetCD, x0=guess, args=(np.asarray(matchdata_view), matches))
  *     CD11 = optimizedparams.x[0]
  *     CD12 = optimizedparams.x[1]             # <<<<<<<<<<<<<<
  *     CD21 = optimizedparams.x[2]
  *     CD22 = optimizedparams.x[3]
  */
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 324, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 303, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 324, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 303, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 324, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 303, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
   __pyx_v_CD12 = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":325
+  /* "fastrometry/cython_code/WCS.pyx":304
  *     CD11 = optimizedparams.x[0]
  *     CD12 = optimizedparams.x[1]
  *     CD21 = optimizedparams.x[2]             # <<<<<<<<<<<<<<
  *     CD22 = optimizedparams.x[3]
  *     CRPIXx = optimizedparams.x[4]
  */
-  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_CD21 = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":326
+  /* "fastrometry/cython_code/WCS.pyx":305
  *     CD12 = optimizedparams.x[1]
  *     CD21 = optimizedparams.x[2]
  *     CD22 = optimizedparams.x[3]             # <<<<<<<<<<<<<<
  *     CRPIXx = optimizedparams.x[4]
  *     CRPIXy = optimizedparams.x[5]
  */
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 326, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 326, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 326, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
   __pyx_v_CD22 = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":327
+  /* "fastrometry/cython_code/WCS.pyx":306
  *     CD21 = optimizedparams.x[2]
  *     CD22 = optimizedparams.x[3]
  *     CRPIXx = optimizedparams.x[4]             # <<<<<<<<<<<<<<
  *     CRPIXy = optimizedparams.x[5]
  *     refined_solution_view[0] = CD11
  */
-  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 327, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 306, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
-  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 327, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_GetItemInt(__pyx_t_25, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 306, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 327, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_11); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 306, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
   __pyx_v_CRPIXx = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":328
+  /* "fastrometry/cython_code/WCS.pyx":307
  *     CD22 = optimizedparams.x[3]
  *     CRPIXx = optimizedparams.x[4]
  *     CRPIXy = optimizedparams.x[5]             # <<<<<<<<<<<<<<
  *     refined_solution_view[0] = CD11
  *     refined_solution_view[1] = CD12
  */
-  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_11);
-  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_GetItemInt(__pyx_t_11, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 307, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_25);
   __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 328, __pyx_L1_error)
+  __pyx_t_20 = __pyx_PyFloat_AsDouble(__pyx_t_25); if (unlikely((__pyx_t_20 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 307, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
   __pyx_v_CRPIXy = __pyx_t_20;
 
-  /* "fastrometry/cython_code/WCS.pyx":329
+  /* "fastrometry/cython_code/WCS.pyx":308
  *     CRPIXx = optimizedparams.x[4]
  *     CRPIXy = optimizedparams.x[5]
  *     refined_solution_view[0] = CD11             # <<<<<<<<<<<<<<
  *     refined_solution_view[1] = CD12
  *     refined_solution_view[2] = CD21
  */
   __pyx_t_17 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 329, __pyx_L1_error)
+    __PYX_ERR(0, 308, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CD11;
 
-  /* "fastrometry/cython_code/WCS.pyx":330
+  /* "fastrometry/cython_code/WCS.pyx":309
  *     CRPIXy = optimizedparams.x[5]
  *     refined_solution_view[0] = CD11
  *     refined_solution_view[1] = CD12             # <<<<<<<<<<<<<<
  *     refined_solution_view[2] = CD21
  *     refined_solution_view[3] = CD22
  */
   __pyx_t_17 = 1;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 330, __pyx_L1_error)
+    __PYX_ERR(0, 309, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CD12;
 
-  /* "fastrometry/cython_code/WCS.pyx":331
+  /* "fastrometry/cython_code/WCS.pyx":310
  *     refined_solution_view[0] = CD11
  *     refined_solution_view[1] = CD12
  *     refined_solution_view[2] = CD21             # <<<<<<<<<<<<<<
  *     refined_solution_view[3] = CD22
  *     refined_solution_view[4] = CRPIXx
  */
   __pyx_t_17 = 2;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 331, __pyx_L1_error)
+    __PYX_ERR(0, 310, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CD21;
 
-  /* "fastrometry/cython_code/WCS.pyx":332
+  /* "fastrometry/cython_code/WCS.pyx":311
  *     refined_solution_view[1] = CD12
  *     refined_solution_view[2] = CD21
  *     refined_solution_view[3] = CD22             # <<<<<<<<<<<<<<
  *     refined_solution_view[4] = CRPIXx
  *     refined_solution_view[5] = CRPIXy
  */
   __pyx_t_17 = 3;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 332, __pyx_L1_error)
+    __PYX_ERR(0, 311, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CD22;
 
-  /* "fastrometry/cython_code/WCS.pyx":333
+  /* "fastrometry/cython_code/WCS.pyx":312
  *     refined_solution_view[2] = CD21
  *     refined_solution_view[3] = CD22
  *     refined_solution_view[4] = CRPIXx             # <<<<<<<<<<<<<<
  *     refined_solution_view[5] = CRPIXy
  * 
  */
   __pyx_t_17 = 4;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 333, __pyx_L1_error)
+    __PYX_ERR(0, 312, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CRPIXx;
 
-  /* "fastrometry/cython_code/WCS.pyx":334
+  /* "fastrometry/cython_code/WCS.pyx":313
  *     refined_solution_view[3] = CD22
  *     refined_solution_view[4] = CRPIXx
  *     refined_solution_view[5] = CRPIXy             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
   __pyx_t_17 = 5;
   __pyx_t_4 = -1;
   if (__pyx_t_17 < 0) {
     __pyx_t_17 += __pyx_v_refined_solution_view.shape[0];
     if (unlikely(__pyx_t_17 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_17 >= __pyx_v_refined_solution_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 334, __pyx_L1_error)
+    __PYX_ERR(0, 313, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_refined_solution_view.data + __pyx_t_17 * __pyx_v_refined_solution_view.strides[0]) )) = __pyx_v_CRPIXy;
 
-  /* "fastrometry/cython_code/WCS.pyx":336
+  /* "fastrometry/cython_code/WCS.pyx":315
  *     refined_solution_view[5] = CRPIXy
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":337
+    /* "fastrometry/cython_code/WCS.pyx":316
  * 
  *     if verbosity >= 1:
  *         print("| | done")             # <<<<<<<<<<<<<<
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))
  * 
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 337, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 316, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":338
+    /* "fastrometry/cython_code/WCS.pyx":317
  *     if verbosity >= 1:
  *         print("| | done")
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Refined_solution_vector, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Refined_solution_vector, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __Pyx_GetModuleGlobalName(__pyx_t_26, __pyx_n_s_np); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 338, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_26);
-    __pyx_t_24 = __Pyx_PyObject_GetAttrStr(__pyx_t_26, __pyx_n_s_asarray); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_24, __pyx_n_s_np); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_24);
-    __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    __pyx_t_26 = __pyx_memoryview_fromslice(__pyx_v_refined_solution_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __pyx_t_26 = __Pyx_PyObject_GetAttrStr(__pyx_t_24, __pyx_n_s_asarray); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
+    __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_24 = __pyx_memoryview_fromslice(__pyx_v_refined_solution_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_24);
     __pyx_t_9 = NULL;
-    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_24))) {
-      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_24);
+    if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_26))) {
+      __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_26);
       if (likely(__pyx_t_9)) {
-        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
+        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_26);
         __Pyx_INCREF(__pyx_t_9);
         __Pyx_INCREF(function);
-        __Pyx_DECREF_SET(__pyx_t_24, function);
+        __Pyx_DECREF_SET(__pyx_t_26, function);
       }
     }
-    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_24, __pyx_t_9, __pyx_t_26) : __Pyx_PyObject_CallOneArg(__pyx_t_24, __pyx_t_26);
+    __pyx_t_6 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_26, __pyx_t_9, __pyx_t_24) : __Pyx_PyObject_CallOneArg(__pyx_t_26, __pyx_t_24);
     __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
-    __pyx_t_24 = NULL;
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 317, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_6);
+    __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 338, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 317, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":336
+    /* "fastrometry/cython_code/WCS.pyx":315
  *     refined_solution_view[5] = CRPIXy
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":340
+  /* "fastrometry/cython_code/WCS.pyx":319
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | * CD1_1: {}".format(CD11))
  *         print("| | * CD1_2: {}".format(CD12))
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":341
+    /* "fastrometry/cython_code/WCS.pyx":320
  * 
  *     if verbosity == 2:
  *         print("| | * CD1_1: {}".format(CD11))             # <<<<<<<<<<<<<<
  *         print("| | * CD1_2: {}".format(CD12))
  *         print("| | * CD2_1: {}".format(CD21))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 341, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 320, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 341, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 341, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 320, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 341, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 320, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":342
+    /* "fastrometry/cython_code/WCS.pyx":321
  *     if verbosity == 2:
  *         print("| | * CD1_1: {}".format(CD11))
  *         print("| | * CD1_2: {}".format(CD12))             # <<<<<<<<<<<<<<
  *         print("| | * CD2_1: {}".format(CD21))
  *         print("| | * CD2_2: {}".format(CD22))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 342, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 321, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 342, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD12); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 321, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 342, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 321, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 342, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 321, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":343
+    /* "fastrometry/cython_code/WCS.pyx":322
  *         print("| | * CD1_1: {}".format(CD11))
  *         print("| | * CD1_2: {}".format(CD12))
  *         print("| | * CD2_1: {}".format(CD21))             # <<<<<<<<<<<<<<
  *         print("| | * CD2_2: {}".format(CD22))
  *         print("| | * CRPIX1: {}".format(CRPIXx))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 343, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD21); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 343, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD21); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 343, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":344
+    /* "fastrometry/cython_code/WCS.pyx":323
  *         print("| | * CD1_2: {}".format(CD12))
  *         print("| | * CD2_1: {}".format(CD21))
  *         print("| | * CD2_2: {}".format(CD22))             # <<<<<<<<<<<<<<
  *         print("| | * CRPIX1: {}".format(CRPIXx))
  *         print("| | * CRPIX2: {}".format(CRPIXy))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 344, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 323, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD22); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 344, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD22); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 323, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 344, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 323, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 344, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 323, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":345
+    /* "fastrometry/cython_code/WCS.pyx":324
  *         print("| | * CD2_1: {}".format(CD21))
  *         print("| | * CD2_2: {}".format(CD22))
  *         print("| | * CRPIX1: {}".format(CRPIXx))             # <<<<<<<<<<<<<<
  *         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 345, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 345, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 345, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":346
+    /* "fastrometry/cython_code/WCS.pyx":325
  *         print("| | * CD2_2: {}".format(CD22))
  *         print("| | * CRPIX1: {}".format(CRPIXx))
  *         print("| | * CRPIX2: {}".format(CRPIXy))             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = NULL;
+    __pyx_t_26 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
-      __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_11);
-      if (likely(__pyx_t_24)) {
+      __pyx_t_26 = PyMethod_GET_SELF(__pyx_t_11);
+      if (likely(__pyx_t_26)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
-        __Pyx_INCREF(__pyx_t_24);
+        __Pyx_INCREF(__pyx_t_26);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
-    __pyx_t_25 = (__pyx_t_24) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_24, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
-    __Pyx_XDECREF(__pyx_t_24); __pyx_t_24 = 0;
+    __pyx_t_25 = (__pyx_t_26) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_26, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_6);
+    __Pyx_XDECREF(__pyx_t_26); __pyx_t_26 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 346, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 346, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_25) < 0) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":340
+    /* "fastrometry/cython_code/WCS.pyx":319
  *         print("| | Refined solution vector: {}".format(np.asarray(refined_solution_view)))
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | * CD1_1: {}".format(CD11))
  *         print("| | * CD1_2: {}".format(CD12))
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":348
+  /* "fastrometry/cython_code/WCS.pyx":327
  *         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | Applying refined solution to the larger dataset...")
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":349
+    /* "fastrometry/cython_code/WCS.pyx":328
  * 
  *     if verbosity >= 1:
  *         print("| | Applying refined solution to the larger dataset...")             # <<<<<<<<<<<<<<
  * 
  *     matches = 0
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Applying_refined_solution_to_th) < 0) __PYX_ERR(0, 349, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Applying_refined_solution_to_th) < 0) __PYX_ERR(0, 328, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":348
+    /* "fastrometry/cython_code/WCS.pyx":327
  *         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | Applying refined solution to the larger dataset...")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":351
+  /* "fastrometry/cython_code/WCS.pyx":330
  *         print("| | Applying refined solution to the larger dataset...")
  * 
  *     matches = 0             # <<<<<<<<<<<<<<
  *     matchdata_view[:] = 0
  *     if debug:
  */
   __pyx_v_matches = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":352
+  /* "fastrometry/cython_code/WCS.pyx":331
  * 
  *     matches = 0
  *     matchdata_view[:] = 0             # <<<<<<<<<<<<<<
  *     if debug:
  *         invtransf_xs = []
  */
   {
@@ -9315,149 +8708,149 @@
               __pyx_temp_pointer_1 += __pyx_temp_stride_1;
             }
             __pyx_temp_pointer_0 += __pyx_temp_stride_0;
           }
       }
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":353
+  /* "fastrometry/cython_code/WCS.pyx":332
  *     matches = 0
  *     matchdata_view[:] = 0
  *     if debug:             # <<<<<<<<<<<<<<
  *         invtransf_xs = []
  *         invtransf_ys = []
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":354
+    /* "fastrometry/cython_code/WCS.pyx":333
  *     matchdata_view[:] = 0
  *     if debug:
  *         invtransf_xs = []             # <<<<<<<<<<<<<<
  *         invtransf_ys = []
  *         invtransf_match_xs = []
  */
-    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 354, __pyx_L1_error)
+    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_XDECREF_SET(__pyx_v_invtransf_xs, ((PyObject*)__pyx_t_25));
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":355
+    /* "fastrometry/cython_code/WCS.pyx":334
  *     if debug:
  *         invtransf_xs = []
  *         invtransf_ys = []             # <<<<<<<<<<<<<<
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []
  */
-    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 355, __pyx_L1_error)
+    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_XDECREF_SET(__pyx_v_invtransf_ys, ((PyObject*)__pyx_t_25));
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":356
+    /* "fastrometry/cython_code/WCS.pyx":335
  *         invtransf_xs = []
  *         invtransf_ys = []
  *         invtransf_match_xs = []             # <<<<<<<<<<<<<<
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):
  */
-    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 356, __pyx_L1_error)
+    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 335, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_XDECREF_SET(__pyx_v_invtransf_match_xs, ((PyObject*)__pyx_t_25));
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":357
+    /* "fastrometry/cython_code/WCS.pyx":336
  *         invtransf_ys = []
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []             # <<<<<<<<<<<<<<
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  */
-    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 357, __pyx_L1_error)
+    __pyx_t_25 = PyList_New(0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 336, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_XDECREF_SET(__pyx_v_invtransf_match_ys, ((PyObject*)__pyx_t_25));
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":353
+    /* "fastrometry/cython_code/WCS.pyx":332
  *     matches = 0
  *     matchdata_view[:] = 0
  *     if debug:             # <<<<<<<<<<<<<<
  *         invtransf_xs = []
  *         invtransf_ys = []
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":358
+  /* "fastrometry/cython_code/WCS.pyx":337
  *         invtransf_match_xs = []
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):             # <<<<<<<<<<<<<<
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:
  */
   __pyx_t_4 = __pyx_v_nrefinepts_intrm;
   __pyx_t_13 = __pyx_t_4;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_k = __pyx_t_14;
 
-    /* "fastrometry/cython_code/WCS.pyx":359
+    /* "fastrometry/cython_code/WCS.pyx":338
  *         invtransf_match_ys = []
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)             # <<<<<<<<<<<<<<
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_inverseTransformPointUsingCD); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_inverseTransformPointUsingCD); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_CD11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_24 = PyFloat_FromDouble(__pyx_v_CD12); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 359, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_24);
-    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD21); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_26 = PyFloat_FromDouble(__pyx_v_CD12); if (unlikely(!__pyx_t_26)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_26);
-    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_CD22); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_24 = PyFloat_FromDouble(__pyx_v_CD21); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 338, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_24);
+    __pyx_t_9 = PyFloat_FromDouble(__pyx_v_CD22); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_12 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_12);
     __pyx_t_17 = __pyx_v_k;
     __pyx_t_18 = 0;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_intrmpoints_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_intrmpoints_view.shape[1];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 359, __pyx_L1_error)
+      __PYX_ERR(0, 338, __pyx_L1_error)
     }
-    __pyx_t_7 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_18 = __pyx_v_k;
     __pyx_t_17 = 1;
     __pyx_t_16 = -1;
     if (__pyx_t_18 < 0) {
       __pyx_t_18 += __pyx_v_intrmpoints_view.shape[0];
       if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_intrmpoints_view.shape[1];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 359, __pyx_L1_error)
+      __PYX_ERR(0, 338, __pyx_L1_error)
     }
-    __pyx_t_27 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[1]) )))); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_27 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[1]) )))); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    __pyx_t_28 = __pyx_memoryview_fromslice(__pyx_v_invtransf_intrmpoint_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 359, __pyx_L1_error)
+    __pyx_t_28 = __pyx_memoryview_fromslice(__pyx_v_invtransf_intrmpoint_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 338, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __pyx_t_29 = NULL;
     __pyx_t_16 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_29 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_29)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -9465,167 +8858,167 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
         __pyx_t_16 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_11)) {
-      PyObject *__pyx_temp[10] = {__pyx_t_29, __pyx_t_6, __pyx_t_24, __pyx_t_26, __pyx_t_9, __pyx_t_8, __pyx_t_12, __pyx_t_7, __pyx_t_27, __pyx_t_28};
-      __pyx_t_25 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_16, 9+__pyx_t_16); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 359, __pyx_L1_error)
+      PyObject *__pyx_temp[10] = {__pyx_t_29, __pyx_t_6, __pyx_t_26, __pyx_t_24, __pyx_t_9, __pyx_t_8, __pyx_t_12, __pyx_t_7, __pyx_t_27, __pyx_t_28};
+      __pyx_t_25 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_16, 9+__pyx_t_16); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 338, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_29); __pyx_t_29 = 0;
       __Pyx_GOTREF(__pyx_t_25);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
       __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
+      __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
       __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
-      PyObject *__pyx_temp[10] = {__pyx_t_29, __pyx_t_6, __pyx_t_24, __pyx_t_26, __pyx_t_9, __pyx_t_8, __pyx_t_12, __pyx_t_7, __pyx_t_27, __pyx_t_28};
-      __pyx_t_25 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_16, 9+__pyx_t_16); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 359, __pyx_L1_error)
+      PyObject *__pyx_temp[10] = {__pyx_t_29, __pyx_t_6, __pyx_t_26, __pyx_t_24, __pyx_t_9, __pyx_t_8, __pyx_t_12, __pyx_t_7, __pyx_t_27, __pyx_t_28};
+      __pyx_t_25 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_16, 9+__pyx_t_16); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 338, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_29); __pyx_t_29 = 0;
       __Pyx_GOTREF(__pyx_t_25);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
       __Pyx_DECREF(__pyx_t_26); __pyx_t_26 = 0;
+      __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
       __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     } else
     #endif
     {
-      __pyx_t_30 = PyTuple_New(9+__pyx_t_16); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 359, __pyx_L1_error)
+      __pyx_t_30 = PyTuple_New(9+__pyx_t_16); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 338, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_30);
       if (__pyx_t_29) {
         __Pyx_GIVEREF(__pyx_t_29); PyTuple_SET_ITEM(__pyx_t_30, 0, __pyx_t_29); __pyx_t_29 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_30, 0+__pyx_t_16, __pyx_t_6);
-      __Pyx_GIVEREF(__pyx_t_24);
-      PyTuple_SET_ITEM(__pyx_t_30, 1+__pyx_t_16, __pyx_t_24);
       __Pyx_GIVEREF(__pyx_t_26);
-      PyTuple_SET_ITEM(__pyx_t_30, 2+__pyx_t_16, __pyx_t_26);
+      PyTuple_SET_ITEM(__pyx_t_30, 1+__pyx_t_16, __pyx_t_26);
+      __Pyx_GIVEREF(__pyx_t_24);
+      PyTuple_SET_ITEM(__pyx_t_30, 2+__pyx_t_16, __pyx_t_24);
       __Pyx_GIVEREF(__pyx_t_9);
       PyTuple_SET_ITEM(__pyx_t_30, 3+__pyx_t_16, __pyx_t_9);
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_30, 4+__pyx_t_16, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_12);
       PyTuple_SET_ITEM(__pyx_t_30, 5+__pyx_t_16, __pyx_t_12);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_30, 6+__pyx_t_16, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_27);
       PyTuple_SET_ITEM(__pyx_t_30, 7+__pyx_t_16, __pyx_t_27);
       __Pyx_GIVEREF(__pyx_t_28);
       PyTuple_SET_ITEM(__pyx_t_30, 8+__pyx_t_16, __pyx_t_28);
       __pyx_t_6 = 0;
-      __pyx_t_24 = 0;
       __pyx_t_26 = 0;
+      __pyx_t_24 = 0;
       __pyx_t_9 = 0;
       __pyx_t_8 = 0;
       __pyx_t_12 = 0;
       __pyx_t_7 = 0;
       __pyx_t_27 = 0;
       __pyx_t_28 = 0;
-      __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_30, NULL); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 359, __pyx_L1_error)
+      __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_30, NULL); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 338, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_25);
       __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":360
+    /* "fastrometry/cython_code/WCS.pyx":339
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:             # <<<<<<<<<<<<<<
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
     __pyx_t_1 = (__pyx_v_debug != 0);
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":361
+      /* "fastrometry/cython_code/WCS.pyx":340
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  */
-      if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 361, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 340, __pyx_L1_error) }
       __pyx_t_17 = 0;
       __pyx_t_16 = -1;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 361, __pyx_L1_error)
+        __PYX_ERR(0, 340, __pyx_L1_error)
       }
-      __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 361, __pyx_L1_error)
+      __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 340, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_25);
-      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_xs, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 361, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_xs, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 340, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":362
+      /* "fastrometry/cython_code/WCS.pyx":341
  *         if debug:
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  */
-      if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 362, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 341, __pyx_L1_error) }
       __pyx_t_17 = 1;
       __pyx_t_16 = -1;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 362, __pyx_L1_error)
+        __PYX_ERR(0, 341, __pyx_L1_error)
       }
-      __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 362, __pyx_L1_error)
+      __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 341, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_25);
-      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_ys, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 362, __pyx_L1_error)
+      __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_ys, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 341, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":360
+      /* "fastrometry/cython_code/WCS.pyx":339
  *     for k in range(nrefinepts_intrm):
  *         inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *         if debug:             # <<<<<<<<<<<<<<
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":363
+    /* "fastrometry/cython_code/WCS.pyx":342
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  */
     __pyx_t_17 = 0;
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 363, __pyx_L1_error)
+      __PYX_ERR(0, 342, __pyx_L1_error)
     }
     __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
     __pyx_t_2 = (1.0 <= __pyx_t_20);
     if (__pyx_t_2) {
       __pyx_t_2 = (__pyx_t_20 <= __pyx_v_img_xmax);
     }
     __pyx_t_21 = (__pyx_t_2 != 0);
@@ -9638,95 +9031,95 @@
     __pyx_t_16 = -1;
     if (__pyx_t_17 < 0) {
       __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
       if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
     } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
     if (unlikely(__pyx_t_16 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_16);
-      __PYX_ERR(0, 363, __pyx_L1_error)
+      __PYX_ERR(0, 342, __pyx_L1_error)
     }
     __pyx_t_20 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
     __pyx_t_21 = (1.0 <= __pyx_t_20);
     if (__pyx_t_21) {
       __pyx_t_21 = (__pyx_t_20 <= __pyx_v_img_ymax);
     }
     __pyx_t_2 = (__pyx_t_21 != 0);
     __pyx_t_1 = __pyx_t_2;
     __pyx_L29_bool_binop_done:;
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":364
+      /* "fastrometry/cython_code/WCS.pyx":343
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]             # <<<<<<<<<<<<<<
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  */
       __pyx_t_17 = 1;
       __pyx_t_16 = -1;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 364, __pyx_L1_error)
+        __PYX_ERR(0, 343, __pyx_L1_error)
       }
-      __pyx_t_25 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_25 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_25);
-      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_25, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_SubtractObjC(__pyx_t_25, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-      __pyx_t_23 = __Pyx_PyIndex_AsSsize_t(__pyx_t_11); if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_23 = __Pyx_PyIndex_AsSsize_t(__pyx_t_11); if (unlikely((__pyx_t_23 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_17 = 0;
       __pyx_t_16 = -1;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_invtransf_intrmpoint_view.shape[0];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 364, __pyx_L1_error)
+        __PYX_ERR(0, 343, __pyx_L1_error)
       }
-      __pyx_t_11 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_17 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
-      __pyx_t_25 = __Pyx_PyInt_SubtractObjC(__pyx_t_11, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_25 = __Pyx_PyInt_SubtractObjC(__pyx_t_11, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_25);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-      __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_25); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 364, __pyx_L1_error)
+      __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_25); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 343, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
       __pyx_t_17 = __pyx_t_23;
       __pyx_t_18 = __pyx_t_22;
       __pyx_t_16 = -1;
       if (__pyx_t_17 < 0) {
         __pyx_t_17 += __pyx_v_srcindexmap_refine_view.shape[0];
         if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 0;
       } else if (unlikely(__pyx_t_17 >= __pyx_v_srcindexmap_refine_view.shape[0])) __pyx_t_16 = 0;
       if (__pyx_t_18 < 0) {
         __pyx_t_18 += __pyx_v_srcindexmap_refine_view.shape[1];
         if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
       } else if (unlikely(__pyx_t_18 >= __pyx_v_srcindexmap_refine_view.shape[1])) __pyx_t_16 = 1;
       if (unlikely(__pyx_t_16 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_16);
-        __PYX_ERR(0, 364, __pyx_L1_error)
+        __PYX_ERR(0, 343, __pyx_L1_error)
       }
       __pyx_v_src_ind = (*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_refine_view.data + __pyx_t_17 * __pyx_v_srcindexmap_refine_view.strides[0]) ) + __pyx_t_18 * __pyx_v_srcindexmap_refine_view.strides[1]) )));
 
-      /* "fastrometry/cython_code/WCS.pyx":365
+      /* "fastrometry/cython_code/WCS.pyx":344
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  */
       __pyx_t_1 = ((__pyx_v_src_ind != -1L) != 0);
       if (__pyx_t_1) {
 
-        /* "fastrometry/cython_code/WCS.pyx":366
+        /* "fastrometry/cython_code/WCS.pyx":345
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  */
         __pyx_t_18 = __pyx_v_k;
@@ -9738,34 +9131,34 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_intrmpoints_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 366, __pyx_L1_error)
+          __PYX_ERR(0, 345, __pyx_L1_error)
         }
         __pyx_t_15 = __pyx_v_matches;
         __pyx_t_3 = 0;
         __pyx_t_16 = -1;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 366, __pyx_L1_error)
+          __PYX_ERR(0, 345, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_15 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_3 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":367
+        /* "fastrometry/cython_code/WCS.pyx":346
  *             if src_ind != -1:
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  */
         __pyx_t_17 = __pyx_v_k;
@@ -9777,34 +9170,34 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_intrmpoints_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 367, __pyx_L1_error)
+          __PYX_ERR(0, 346, __pyx_L1_error)
         }
         __pyx_t_3 = __pyx_v_matches;
         __pyx_t_15 = 1;
         __pyx_t_16 = -1;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 367, __pyx_L1_error)
+          __PYX_ERR(0, 346, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_3 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_17 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_intrmpoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":368
+        /* "fastrometry/cython_code/WCS.pyx":347
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  */
         __pyx_t_18 = __pyx_v_matches;
@@ -9816,19 +9209,19 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 368, __pyx_L1_error)
+          __PYX_ERR(0, 347, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_18 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_17 * __pyx_v_matchdata_view.strides[1]) )) = __pyx_v_k;
 
-        /* "fastrometry/cython_code/WCS.pyx":369
+        /* "fastrometry/cython_code/WCS.pyx":348
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  */
         __pyx_t_17 = __pyx_v_src_ind;
@@ -9840,34 +9233,34 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_psepoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_psepoints_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_psepoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 369, __pyx_L1_error)
+          __PYX_ERR(0, 348, __pyx_L1_error)
         }
         __pyx_t_15 = __pyx_v_matches;
         __pyx_t_3 = 3;
         __pyx_t_16 = -1;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 369, __pyx_L1_error)
+          __PYX_ERR(0, 348, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_15 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_3 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psepoints_view.data + __pyx_t_17 * __pyx_v_psepoints_view.strides[0]) ) + __pyx_t_18 * __pyx_v_psepoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":370
+        /* "fastrometry/cython_code/WCS.pyx":349
  *                 matchdata_view[matches,2] = k                               #The index of the intermediate coordinate in the allintrmcoords
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  */
         __pyx_t_18 = __pyx_v_src_ind;
@@ -9879,34 +9272,34 @@
         } else if (unlikely(__pyx_t_18 >= __pyx_v_psepoints_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_17 < 0) {
           __pyx_t_17 += __pyx_v_psepoints_view.shape[1];
           if (unlikely(__pyx_t_17 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_17 >= __pyx_v_psepoints_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 370, __pyx_L1_error)
+          __PYX_ERR(0, 349, __pyx_L1_error)
         }
         __pyx_t_3 = __pyx_v_matches;
         __pyx_t_15 = 4;
         __pyx_t_16 = -1;
         if (__pyx_t_3 < 0) {
           __pyx_t_3 += __pyx_v_matchdata_view.shape[0];
           if (unlikely(__pyx_t_3 < 0)) __pyx_t_16 = 0;
         } else if (unlikely(__pyx_t_3 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_15 < 0) {
           __pyx_t_15 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_15 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_15 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 370, __pyx_L1_error)
+          __PYX_ERR(0, 349, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_3 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_15 * __pyx_v_matchdata_view.strides[1]) )) = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psepoints_view.data + __pyx_t_18 * __pyx_v_psepoints_view.strides[0]) ) + __pyx_t_17 * __pyx_v_psepoints_view.strides[1]) )));
 
-        /* "fastrometry/cython_code/WCS.pyx":371
+        /* "fastrometry/cython_code/WCS.pyx":350
  *                 matchdata_view[matches,3] = psepoints_view[src_ind,0]       #The pse point which is landed on by inverse-transforming the intermediate point, x coordinate
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata             # <<<<<<<<<<<<<<
  *                 matches += 1
  *                 if debug:
  */
         __pyx_t_17 = __pyx_v_matches;
@@ -9918,473 +9311,473 @@
         } else if (unlikely(__pyx_t_17 >= __pyx_v_matchdata_view.shape[0])) __pyx_t_16 = 0;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_matchdata_view.shape[1];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 1;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_matchdata_view.shape[1])) __pyx_t_16 = 1;
         if (unlikely(__pyx_t_16 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_16);
-          __PYX_ERR(0, 371, __pyx_L1_error)
+          __PYX_ERR(0, 350, __pyx_L1_error)
         }
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_matchdata_view.data + __pyx_t_17 * __pyx_v_matchdata_view.strides[0]) ) + __pyx_t_18 * __pyx_v_matchdata_view.strides[1]) )) = __pyx_v_src_ind;
 
-        /* "fastrometry/cython_code/WCS.pyx":372
+        /* "fastrometry/cython_code/WCS.pyx":351
  *                 matchdata_view[matches,4] = psepoints_view[src_ind,1]       #The pse point which is landed on by inverse-transforming the intermediate point, y coordinate
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1             # <<<<<<<<<<<<<<
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  */
         __pyx_v_matches = (__pyx_v_matches + 1);
 
-        /* "fastrometry/cython_code/WCS.pyx":373
+        /* "fastrometry/cython_code/WCS.pyx":352
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  *                 if debug:             # <<<<<<<<<<<<<<
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
         __pyx_t_1 = (__pyx_v_debug != 0);
         if (__pyx_t_1) {
 
-          /* "fastrometry/cython_code/WCS.pyx":374
+          /* "fastrometry/cython_code/WCS.pyx":353
  *                 matches += 1
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  */
-          if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 374, __pyx_L1_error) }
+          if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 353, __pyx_L1_error) }
           __pyx_t_18 = 0;
           __pyx_t_16 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
           if (unlikely(__pyx_t_16 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_16);
-            __PYX_ERR(0, 374, __pyx_L1_error)
+            __PYX_ERR(0, 353, __pyx_L1_error)
           }
-          __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 374, __pyx_L1_error)
+          __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 353, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_25);
-          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_xs, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 374, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_xs, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 353, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-          /* "fastrometry/cython_code/WCS.pyx":375
+          /* "fastrometry/cython_code/WCS.pyx":354
  *                 if debug:
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-          if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 375, __pyx_L1_error) }
+          if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 354, __pyx_L1_error) }
           __pyx_t_18 = 1;
           __pyx_t_16 = -1;
           if (__pyx_t_18 < 0) {
             __pyx_t_18 += __pyx_v_invtransf_intrmpoint_view.shape[0];
             if (unlikely(__pyx_t_18 < 0)) __pyx_t_16 = 0;
           } else if (unlikely(__pyx_t_18 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_16 = 0;
           if (unlikely(__pyx_t_16 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_16);
-            __PYX_ERR(0, 375, __pyx_L1_error)
+            __PYX_ERR(0, 354, __pyx_L1_error)
           }
-          __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_25 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_18 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 354, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_25);
-          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_ys, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 375, __pyx_L1_error)
+          __pyx_t_19 = __Pyx_PyList_Append(__pyx_v_invtransf_match_ys, __pyx_t_25); if (unlikely(__pyx_t_19 == ((int)-1))) __PYX_ERR(0, 354, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-          /* "fastrometry/cython_code/WCS.pyx":373
+          /* "fastrometry/cython_code/WCS.pyx":352
  *                 matchdata_view[matches,5] = src_ind                         #The index of the pse point in the pse_metadata
  *                 matches += 1
  *                 if debug:             # <<<<<<<<<<<<<<
  *                     invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
         }
 
-        /* "fastrometry/cython_code/WCS.pyx":365
+        /* "fastrometry/cython_code/WCS.pyx":344
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:             # <<<<<<<<<<<<<<
  *                 matchdata_view[matches,0] = intrmpoints_view[k,0]           #An intermediate coordinate that inverse-transforms onto a source index, X coordinate
  *                 matchdata_view[matches,1] = intrmpoints_view[k,1]           #An intermediate coordinate that inverse-transforms onto a source index, Y coordinate
  */
       }
 
-      /* "fastrometry/cython_code/WCS.pyx":363
+      /* "fastrometry/cython_code/WCS.pyx":342
  *             invtransf_xs.append(invtransf_intrmpoint_view[0])
  *             invtransf_ys.append(invtransf_intrmpoint_view[1])
  *         if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *             src_ind = srcindexmap_refine_view[int(invtransf_intrmpoint_view[1])-1,int(invtransf_intrmpoint_view[0])-1]
  *             if src_ind != -1:
  */
     }
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":377
+  /* "fastrometry/cython_code/WCS.pyx":356
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_refine_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":378
+    /* "fastrometry/cython_code/WCS.pyx":357
  * 
  *     if debug:
  *         np.savetxt(debug_report/"matchdata_refine_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     num_matches_view[0] = matches
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_25, __pyx_n_s_np); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_25, __pyx_n_s_np); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_25, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_25, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_matchdata_refine__csv, __pyx_n_s_format); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_matchdata_refine__csv, __pyx_n_s_format); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
-    __pyx_t_28 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __pyx_t_27 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_30))) {
       __pyx_t_27 = PyMethod_GET_SELF(__pyx_t_30);
       if (likely(__pyx_t_27)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_30);
         __Pyx_INCREF(__pyx_t_27);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_30, function);
       }
     }
     __pyx_t_25 = (__pyx_t_27) ? __Pyx_PyObject_Call2Args(__pyx_t_30, __pyx_t_27, __pyx_t_28) : __Pyx_PyObject_CallOneArg(__pyx_t_30, __pyx_t_28);
     __Pyx_XDECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 378, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    __pyx_t_30 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_25); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_25); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_28, __pyx_n_s_np); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_28, __pyx_n_s_np); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
-    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_t_28, __pyx_n_s_asarray); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_t_28, __pyx_n_s_asarray); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-    __pyx_t_28 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_28 = __pyx_memoryview_fromslice(__pyx_v_matchdata_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_27))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_27);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_27);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_27, function);
       }
     }
     __pyx_t_25 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_27, __pyx_t_7, __pyx_t_28) : __Pyx_PyObject_CallOneArg(__pyx_t_27, __pyx_t_28);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 378, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
-    __pyx_t_27 = PyTuple_New(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_27 = PyTuple_New(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_GIVEREF(__pyx_t_30);
     PyTuple_SET_ITEM(__pyx_t_27, 0, __pyx_t_30);
     __Pyx_GIVEREF(__pyx_t_25);
     PyTuple_SET_ITEM(__pyx_t_27, 1, __pyx_t_25);
     __pyx_t_30 = 0;
     __pyx_t_25 = 0;
-    __pyx_t_25 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
-    __pyx_t_30 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_27, __pyx_t_25); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 378, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 357, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_27, __pyx_t_25); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":377
+    /* "fastrometry/cython_code/WCS.pyx":356
  *                     invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"matchdata_refine_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":380
+  /* "fastrometry/cython_code/WCS.pyx":359
  *         np.savetxt(debug_report/"matchdata_refine_{}.csv".format(nrefinepts_intrm),np.asarray(matchdata_view), delimiter=",")
  * 
  *     num_matches_view[0] = matches             # <<<<<<<<<<<<<<
  *     if verbosity >= 1:
  *         print("| | | Found {} matches.".format(matches))
  */
   __pyx_t_18 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_18 < 0) {
     __pyx_t_18 += __pyx_v_num_matches_view.shape[0];
     if (unlikely(__pyx_t_18 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_18 >= __pyx_v_num_matches_view.shape[0])) __pyx_t_4 = 0;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 380, __pyx_L1_error)
+    __PYX_ERR(0, 359, __pyx_L1_error)
   }
   *((int *) ( /* dim=0 */ (__pyx_v_num_matches_view.data + __pyx_t_18 * __pyx_v_num_matches_view.strides[0]) )) = __pyx_v_matches;
 
-  /* "fastrometry/cython_code/WCS.pyx":381
+  /* "fastrometry/cython_code/WCS.pyx":360
  * 
  *     num_matches_view[0] = matches
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | | Found {} matches.".format(matches))
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":382
+    /* "fastrometry/cython_code/WCS.pyx":361
  *     num_matches_view[0] = matches
  *     if verbosity >= 1:
  *         print("| | | Found {} matches.".format(matches))             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
-    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches, __pyx_n_s_format); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 382, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches, __pyx_n_s_format); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    __pyx_t_27 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 382, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_25))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_25);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_25);
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_25, function);
       }
     }
     __pyx_t_30 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_25, __pyx_t_11, __pyx_t_27) : __Pyx_PyObject_CallOneArg(__pyx_t_25, __pyx_t_27);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
-    if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 382, __pyx_L1_error)
+    if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_30) < 0) __PYX_ERR(0, 382, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_30) < 0) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":381
+    /* "fastrometry/cython_code/WCS.pyx":360
  * 
  *     num_matches_view[0] = matches
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | | Found {} matches.".format(matches))
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":384
+  /* "fastrometry/cython_code/WCS.pyx":363
  *         print("| | | Found {} matches.".format(matches))
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":385
+    /* "fastrometry/cython_code/WCS.pyx":364
  * 
  *     if debug:
  *         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  */
-    __pyx_t_30 = PyList_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __pyx_t_30 = PyList_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 364, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
-    __Pyx_INCREF(__pyx_n_s__8);
-    __Pyx_GIVEREF(__pyx_n_s__8);
-    PyList_SET_ITEM(__pyx_t_30, 0, __pyx_n_s__8);
-    __pyx_t_25 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_30, -1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 385, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_n_s__4);
+    __Pyx_GIVEREF(__pyx_n_s__4);
+    PyList_SET_ITEM(__pyx_t_30, 0, __pyx_n_s__4);
+    __pyx_t_25 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_30, -1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 364, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_XDECREF_SET(__pyx_v_plt, __pyx_t_25);
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":386
+    /* "fastrometry/cython_code/WCS.pyx":365
  *     if debug:
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  */
-    __pyx_t_25 = PyList_New(1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_25 = PyList_New(1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 365, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_INCREF(__pyx_n_s_LogNorm);
     __Pyx_GIVEREF(__pyx_n_s_LogNorm);
     PyList_SET_ITEM(__pyx_t_25, 0, __pyx_n_s_LogNorm);
-    __pyx_t_30 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_25, -1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_25, -1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 365, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
-    __pyx_t_25 = __Pyx_ImportFrom(__pyx_t_30, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_ImportFrom(__pyx_t_30, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 365, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_INCREF(__pyx_t_25);
     __Pyx_XDECREF_SET(__pyx_v_LogNorm, __pyx_t_25);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":387
+    /* "fastrometry/cython_code/WCS.pyx":366
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits             # <<<<<<<<<<<<<<
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(9.5,8))
  */
-    __pyx_t_30 = PyList_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_30 = PyList_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_INCREF(__pyx_n_s_fits);
     __Pyx_GIVEREF(__pyx_n_s_fits);
     PyList_SET_ITEM(__pyx_t_30, 0, __pyx_n_s_fits);
-    __pyx_t_25 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_30, -1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_30, -1); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    __pyx_t_30 = __Pyx_ImportFrom(__pyx_t_25, __pyx_n_s_fits); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_ImportFrom(__pyx_t_25, __pyx_n_s_fits); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_INCREF(__pyx_t_30);
     __Pyx_XDECREF_SET(__pyx_v_fits, __pyx_t_30);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":388
+    /* "fastrometry/cython_code/WCS.pyx":367
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)             # <<<<<<<<<<<<<<
  *         fig = plt.figure(figsize=(9.5,8))
  * 
  */
-    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 367, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __pyx_t_27 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_30))) {
       __pyx_t_27 = PyMethod_GET_SELF(__pyx_t_30);
       if (likely(__pyx_t_27)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_30);
         __Pyx_INCREF(__pyx_t_27);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_30, function);
       }
     }
     __pyx_t_25 = (__pyx_t_27) ? __Pyx_PyObject_Call2Args(__pyx_t_30, __pyx_t_27, __pyx_v_filepath) : __Pyx_PyObject_CallOneArg(__pyx_t_30, __pyx_v_filepath);
     __Pyx_XDECREF(__pyx_t_27); __pyx_t_27 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 388, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 367, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_XDECREF_SET(__pyx_v_image_data, __pyx_t_25);
     __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":389
+    /* "fastrometry/cython_code/WCS.pyx":368
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(9.5,8))             # <<<<<<<<<<<<<<
  * 
  *         axes = fig.add_subplot(111)
  */
-    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 368, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    __pyx_t_30 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 389, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 368, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
-    if (PyDict_SetItem(__pyx_t_30, __pyx_n_s_figsize, __pyx_tuple__9) < 0) __PYX_ERR(0, 389, __pyx_L1_error)
-    __pyx_t_27 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_empty_tuple, __pyx_t_30); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 389, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_30, __pyx_n_s_figsize, __pyx_tuple__5) < 0) __PYX_ERR(0, 368, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_empty_tuple, __pyx_t_30); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 368, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_XDECREF_SET(__pyx_v_fig, __pyx_t_27);
     __pyx_t_27 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":391
+    /* "fastrometry/cython_code/WCS.pyx":370
  *         fig = plt.figure(figsize=(9.5,8))
  * 
  *         axes = fig.add_subplot(111)             # <<<<<<<<<<<<<<
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *         #axes.scatter(invtransf_match_xs, invtransf_match_ys, marker="o", color='white')
  */
-    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 370, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_30))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_30);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_30);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_30, function);
       }
     }
     __pyx_t_27 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_30, __pyx_t_25, __pyx_int_111) : __Pyx_PyObject_CallOneArg(__pyx_t_30, __pyx_int_111);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
-    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 391, __pyx_L1_error)
+    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 370, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_XDECREF_SET(__pyx_v_axes, __pyx_t_27);
     __pyx_t_27 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":392
+    /* "fastrometry/cython_code/WCS.pyx":371
  * 
  *         axes = fig.add_subplot(111)
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *         #axes.scatter(invtransf_match_xs, invtransf_match_ys, marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')
  */
-    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    __pyx_t_30 = PyTuple_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_30 = PyTuple_New(1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __Pyx_INCREF(__pyx_v_image_data);
     __Pyx_GIVEREF(__pyx_v_image_data);
     PyTuple_SET_ITEM(__pyx_t_30, 0, __pyx_v_image_data);
-    __pyx_t_25 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 392, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_INCREF(__pyx_v_LogNorm);
     __pyx_t_28 = __pyx_v_LogNorm; __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_28))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_28);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_28);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_28, function);
       }
     }
     __pyx_t_11 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_28, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_28);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 392, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_norm, __pyx_t_11) < 0) __PYX_ERR(0, 392, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_25, __pyx_n_s_norm, __pyx_t_11) < 0) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_27, __pyx_t_30, __pyx_t_25); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_27, __pyx_t_30, __pyx_t_25); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":394
+    /* "fastrometry/cython_code/WCS.pyx":373
  *         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *         #axes.scatter(invtransf_match_xs, invtransf_match_ys, marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')             # <<<<<<<<<<<<<<
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')             # <<<<<<<<<<<<<<
  *         axes.scatter(invtransf_xs, invtransf_ys, c='fuchsia', marker='.')
  * 
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __Pyx_GetModuleGlobalName(__pyx_t_30, __pyx_n_s_np); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_30, __pyx_n_s_np); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
-    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_t_30, __pyx_n_s_asarray); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_t_30, __pyx_n_s_asarray); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __pyx_t_10.data = __pyx_v_psepoints_view.data;
     __pyx_t_10.memview = __pyx_v_psepoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     __pyx_t_10.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_10.strides[0] = __pyx_v_psepoints_view.strides[0];
@@ -10395,20 +9788,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 394, __pyx_L1_error)
+            __PYX_ERR(0, 373, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_30 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 394, __pyx_L1_error)
+__pyx_t_30 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __pyx_t_28 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_27))) {
       __pyx_t_28 = PyMethod_GET_SELF(__pyx_t_27);
@@ -10418,20 +9811,20 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_27, function);
       }
     }
     __pyx_t_25 = (__pyx_t_28) ? __Pyx_PyObject_Call2Args(__pyx_t_27, __pyx_t_28, __pyx_t_30) : __Pyx_PyObject_CallOneArg(__pyx_t_27, __pyx_t_30);
     __Pyx_XDECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 394, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_30, __pyx_n_s_np); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_30, __pyx_n_s_np); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
-    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_t_30, __pyx_n_s_asarray); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_t_30, __pyx_n_s_asarray); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
     __pyx_t_10.data = __pyx_v_psepoints_view.data;
     __pyx_t_10.memview = __pyx_v_psepoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_10, 0);
     __pyx_t_10.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_10.strides[0] = __pyx_v_psepoints_view.strides[0];
@@ -10442,20 +9835,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 394, __pyx_L1_error)
+            __PYX_ERR(0, 373, __pyx_L1_error)
         }
         __pyx_t_10.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_30 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 394, __pyx_L1_error)
+__pyx_t_30 = __pyx_memoryview_fromslice(__pyx_t_10, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_28))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_28);
@@ -10465,123 +9858,123 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_28, function);
       }
     }
     __pyx_t_27 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_28, __pyx_t_7, __pyx_t_30) : __Pyx_PyObject_CallOneArg(__pyx_t_28, __pyx_t_30);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 394, __pyx_L1_error)
+    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
-    __pyx_t_28 = PyTuple_New(2); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_28 = PyTuple_New(2); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_GIVEREF(__pyx_t_25);
     PyTuple_SET_ITEM(__pyx_t_28, 0, __pyx_t_25);
     __Pyx_GIVEREF(__pyx_t_27);
     PyTuple_SET_ITEM(__pyx_t_28, 1, __pyx_t_27);
     __pyx_t_25 = 0;
     __pyx_t_27 = 0;
-    __pyx_t_27 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 394, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_marker, __pyx_kp_s__10) < 0) __PYX_ERR(0, 394, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_color, __pyx_n_s_yellow) < 0) __PYX_ERR(0, 394, __pyx_L1_error)
-    __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_28, __pyx_t_27); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 394, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_marker, __pyx_n_s_o) < 0) __PYX_ERR(0, 373, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_color, __pyx_n_s_blue) < 0) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_28, __pyx_t_27); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":395
+    /* "fastrometry/cython_code/WCS.pyx":374
  *         #axes.scatter(invtransf_match_xs, invtransf_match_ys, marker="o", color='white')
- *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="+", color='yellow')
+ *         axes.scatter(np.asarray(psepoints_view[:,0]), np.asarray(psepoints_view[:,1]), marker="o", color='blue')
  *         axes.scatter(invtransf_xs, invtransf_ys, c='fuchsia', marker='.')             # <<<<<<<<<<<<<<
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the CD matrix elements that were found when refining \n(optimizing) the previous solution. The inverse-transformed points that yield a match (i.e., \nthose that land on an occupied kernel in the source index map) are highlighted with a white \ncircle. The PSE points are in blue.".format(nrefinepts_intrm)
  */
-    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 395, __pyx_L1_error) }
-    if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 395, __pyx_L1_error) }
-    __pyx_t_27 = PyTuple_New(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 395, __pyx_L1_error)
+    if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 374, __pyx_L1_error) }
+    if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 374, __pyx_L1_error) }
+    __pyx_t_27 = PyTuple_New(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_INCREF(__pyx_v_invtransf_xs);
     __Pyx_GIVEREF(__pyx_v_invtransf_xs);
     PyTuple_SET_ITEM(__pyx_t_27, 0, __pyx_v_invtransf_xs);
     __Pyx_INCREF(__pyx_v_invtransf_ys);
     __Pyx_GIVEREF(__pyx_v_invtransf_ys);
     PyTuple_SET_ITEM(__pyx_t_27, 1, __pyx_v_invtransf_ys);
-    __pyx_t_28 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 395, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
-    if (PyDict_SetItem(__pyx_t_28, __pyx_n_s_c, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 395, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_28, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 395, __pyx_L1_error)
-    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_t_27, __pyx_t_28); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 395, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_28, __pyx_n_s_c, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_28, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_t_27, __pyx_t_28); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":397
+    /* "fastrometry/cython_code/WCS.pyx":376
  *         axes.scatter(invtransf_xs, invtransf_ys, c='fuchsia', marker='.')
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the CD matrix elements that were found when refining \n(optimizing) the previous solution. The inverse-transformed points that yield a match (i.e., \nthose that land on an occupied kernel in the source index map) are highlighted with a white \ncircle. The PSE points are in blue.".format(nrefinepts_intrm)             # <<<<<<<<<<<<<<
  *         plt.title("Inverse transform - {} points - refined solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  */
-    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed_2, __pyx_n_s_format); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 397, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed_2, __pyx_n_s_format); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
-    __pyx_t_27 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 397, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_28))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_28);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_28);
         __Pyx_INCREF(__pyx_t_25);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_28, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_28, __pyx_t_25, __pyx_t_27) : __Pyx_PyObject_CallOneArg(__pyx_t_28, __pyx_t_27);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 397, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 376, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_XDECREF_SET(__pyx_v_dscrp, __pyx_t_11);
     __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":398
+    /* "fastrometry/cython_code/WCS.pyx":377
  * 
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the CD matrix elements that were found when refining \n(optimizing) the previous solution. The inverse-transformed points that yield a match (i.e., \nthose that land on an occupied kernel in the source index map) are highlighted with a white \ncircle. The PSE points are in blue.".format(nrefinepts_intrm)
  *         plt.title("Inverse transform - {} points - refined solution".format(nrefinepts_intrm))             # <<<<<<<<<<<<<<
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  */
-    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 377, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
-    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_refined, __pyx_n_s_format); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_refined, __pyx_n_s_format); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 377, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    __pyx_t_30 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 377, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_25))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_25);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_25);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_25, function);
       }
     }
     __pyx_t_27 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_25, __pyx_t_7, __pyx_t_30) : __Pyx_PyObject_CallOneArg(__pyx_t_25, __pyx_t_30);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 398, __pyx_L1_error)
+    if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 377, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_28))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_28);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_28);
@@ -10589,101 +9982,101 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_28, function);
       }
     }
     __pyx_t_11 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_28, __pyx_t_25, __pyx_t_27) : __Pyx_PyObject_CallOneArg(__pyx_t_28, __pyx_t_27);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
-    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 398, __pyx_L1_error)
+    if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 377, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":399
+    /* "fastrometry/cython_code/WCS.pyx":378
  *         dscrp = "Plot of the inverse-transformed points (fuchsia) of all {} intermediate points. The inverse \ntransform used here is made up of the CD matrix elements that were found when refining \n(optimizing) the previous solution. The inverse-transformed points that yield a match (i.e., \nthose that land on an occupied kernel in the source index map) are highlighted with a white \ncircle. The PSE points are in blue.".format(nrefinepts_intrm)
  *         plt.title("Inverse transform - {} points - refined solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_refine_{}.png".format(nrefinepts_intrm))
  */
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 378, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_28 = PyTuple_New(3); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_28 = PyTuple_New(3); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 378, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_INCREF(__pyx_float_0_5);
     __Pyx_GIVEREF(__pyx_float_0_5);
     PyTuple_SET_ITEM(__pyx_t_28, 0, __pyx_float_0_5);
     __Pyx_INCREF(__pyx_float_0_05);
     __Pyx_GIVEREF(__pyx_float_0_05);
     PyTuple_SET_ITEM(__pyx_t_28, 1, __pyx_float_0_05);
     __Pyx_INCREF(__pyx_v_dscrp);
     __Pyx_GIVEREF(__pyx_v_dscrp);
     PyTuple_SET_ITEM(__pyx_t_28, 2, __pyx_v_dscrp);
-    __pyx_t_27 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 378, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 399, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 399, __pyx_L1_error)
-    __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_28, __pyx_t_27); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 399, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 378, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_28, __pyx_t_27); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 378, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":400
+    /* "fastrometry/cython_code/WCS.pyx":379
  *         plt.title("Inverse transform - {} points - refined solution".format(nrefinepts_intrm))
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)             # <<<<<<<<<<<<<<
  *         plt.savefig(debug_report/"inversetrans_matches_refine_{}.png".format(nrefinepts_intrm))
  *         plt.show()
  */
-    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 400, __pyx_L1_error)
+    __pyx_t_25 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
-    __pyx_t_27 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 400, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 400, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 400, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 400, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 400, __pyx_L1_error)
-    __pyx_t_28 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_empty_tuple, __pyx_t_27); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 400, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_27, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
+    __pyx_t_28 = __Pyx_PyObject_Call(__pyx_t_25, __pyx_empty_tuple, __pyx_t_27); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 379, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":401
+    /* "fastrometry/cython_code/WCS.pyx":380
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_refine_{}.png".format(nrefinepts_intrm))             # <<<<<<<<<<<<<<
  *         plt.show()
  * 
  */
-    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 401, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_refine__png, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 401, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_refine__png, __pyx_n_s_format); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_30 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 401, __pyx_L1_error)
+    __pyx_t_30 = __Pyx_PyInt_From_int(__pyx_v_nrefinepts_intrm); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_30);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_25 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_t_30) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_30);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
-    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 401, __pyx_L1_error)
+    if (unlikely(!__pyx_t_25)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_25);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_25); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 401, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_25); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_25); __pyx_t_25 = 0;
     __pyx_t_25 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_27))) {
       __pyx_t_25 = PyMethod_GET_SELF(__pyx_t_27);
       if (likely(__pyx_t_25)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_27);
@@ -10691,102 +10084,102 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_27, function);
       }
     }
     __pyx_t_28 = (__pyx_t_25) ? __Pyx_PyObject_Call2Args(__pyx_t_27, __pyx_t_25, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_27, __pyx_t_11);
     __Pyx_XDECREF(__pyx_t_25); __pyx_t_25 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 401, __pyx_L1_error)
+    if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 380, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":402
+    /* "fastrometry/cython_code/WCS.pyx":381
  *         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *         plt.savefig(debug_report/"inversetrans_matches_refine_{}.png".format(nrefinepts_intrm))
  *         plt.show()             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 402, __pyx_L1_error)
+    __pyx_t_27 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_27)) __PYX_ERR(0, 381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_27);
     __pyx_t_11 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_27))) {
       __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_27);
       if (likely(__pyx_t_11)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_27);
         __Pyx_INCREF(__pyx_t_11);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_27, function);
       }
     }
     __pyx_t_28 = (__pyx_t_11) ? __Pyx_PyObject_CallOneArg(__pyx_t_27, __pyx_t_11) : __Pyx_PyObject_CallNoArg(__pyx_t_27);
     __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 402, __pyx_L1_error)
+    if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 381, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_28);
     __Pyx_DECREF(__pyx_t_27); __pyx_t_27 = 0;
     __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":384
+    /* "fastrometry/cython_code/WCS.pyx":363
  *         print("| | | Found {} matches.".format(matches))
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":404
+  /* "fastrometry/cython_code/WCS.pyx":383
  *         plt.show()
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":405
+    /* "fastrometry/cython_code/WCS.pyx":384
  * 
  *     if verbosity >= 1:
  *         print("| | done")             # <<<<<<<<<<<<<<
  * 
  *     resultcode = 1
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 405, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 384, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":404
+    /* "fastrometry/cython_code/WCS.pyx":383
  *         plt.show()
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | done")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":407
+  /* "fastrometry/cython_code/WCS.pyx":386
  *         print("| | done")
  * 
  *     resultcode = 1             # <<<<<<<<<<<<<<
  *     return resultcode
  * 
  */
   __pyx_v_resultcode = 1;
 
-  /* "fastrometry/cython_code/WCS.pyx":408
+  /* "fastrometry/cython_code/WCS.pyx":387
  * 
  *     resultcode = 1
  *     return resultcode             # <<<<<<<<<<<<<<
  * 
  * cdef inverseTransformPointUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmx, double intrmy, double[:] invtransf_intrmpoint_view):
  */
   __pyx_r = __pyx_v_resultcode;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/WCS.pyx":202
+  /* "fastrometry/cython_code/WCS.pyx":181
  *     return residuals
  * 
  * cdef int refineSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, double[:,:] matchdata_view, int[:] num_matches_view, int npts, int nrefinepts, int img_xmax, int img_ymax, int[:,:] srcindexmap_refine_view, double[:] initial_solution_view, double[:] refined_solution_view, debug_report, filepath, int verbosity, int debug):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
@@ -10827,15 +10220,15 @@
   __Pyx_XDECREF(__pyx_v_dscrp);
   __Pyx_XDECREF(__pyx_v_guess);
   __Pyx_XDECREF(__pyx_v_optimizedparams);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":410
+/* "fastrometry/cython_code/WCS.pyx":389
  *     return resultcode
  * 
  * cdef inverseTransformPointUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmx, double intrmy, double[:] invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  *     """
  *     Use S, phi and the 2 CRPIX reference coordinates to inverse-transform individual intermediate points.
  */
 
@@ -10846,63 +10239,63 @@
   Py_ssize_t __pyx_t_2;
   int __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("inverseTransformPointUsingSphi", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":415
+  /* "fastrometry/cython_code/WCS.pyx":394
  *     """
  * 
  *     invtransf_intrmpoint_view[0] = CRPIXx + (intrmx*cos(phi) + intrmy*sin(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmpoint_view[1] = CRPIXy + (-intrmx*sin(phi) + intrmy*cos(phi))/S
  * 
  */
   __pyx_t_1 = ((__pyx_v_intrmx * cos(__pyx_v_phi)) + (__pyx_v_intrmy * sin(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 415, __pyx_L1_error)
+    __PYX_ERR(0, 394, __pyx_L1_error)
   }
   __pyx_t_2 = 0;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmpoint_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 415, __pyx_L1_error)
+    __PYX_ERR(0, 394, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_2 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )) = (__pyx_v_CRPIXx + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":416
+  /* "fastrometry/cython_code/WCS.pyx":395
  * 
  *     invtransf_intrmpoint_view[0] = CRPIXx + (intrmx*cos(phi) + intrmy*sin(phi))/S
  *     invtransf_intrmpoint_view[1] = CRPIXy + (-intrmx*sin(phi) + intrmy*cos(phi))/S             # <<<<<<<<<<<<<<
  * 
  * cdef inverseTransformTriangleUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmAx, double intrmAy, double intrmBx, double intrmBy, double intrmCx, double intrmCy, double[:,:] invtransf_intrmtriangle_view):
  */
   __pyx_t_1 = (((-__pyx_v_intrmx) * sin(__pyx_v_phi)) + (__pyx_v_intrmy * cos(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 416, __pyx_L1_error)
+    __PYX_ERR(0, 395, __pyx_L1_error)
   }
   __pyx_t_2 = 1;
   __pyx_t_3 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmpoint_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_3 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_3 = 0;
   if (unlikely(__pyx_t_3 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_3);
-    __PYX_ERR(0, 416, __pyx_L1_error)
+    __PYX_ERR(0, 395, __pyx_L1_error)
   }
   *((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_2 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )) = (__pyx_v_CRPIXy + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":410
+  /* "fastrometry/cython_code/WCS.pyx":389
  *     return resultcode
  * 
  * cdef inverseTransformPointUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmx, double intrmy, double[:] invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  *     """
  *     Use S, phi and the 2 CRPIX reference coordinates to inverse-transform individual intermediate points.
  */
 
@@ -10914,15 +10307,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":418
+/* "fastrometry/cython_code/WCS.pyx":397
  *     invtransf_intrmpoint_view[1] = CRPIXy + (-intrmx*sin(phi) + intrmy*cos(phi))/S
  * 
  * cdef inverseTransformTriangleUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmAx, double intrmAy, double intrmBx, double intrmBy, double intrmCx, double intrmCy, double[:,:] invtransf_intrmtriangle_view):             # <<<<<<<<<<<<<<
  *     """
  *     Use S, phi and the 2 CRPIX reference coordinates to inverse-transform intermediate triangles (triplets of intermediate points).
  */
 
@@ -10934,189 +10327,189 @@
   Py_ssize_t __pyx_t_3;
   int __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("inverseTransformTriangleUsingSphi", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":423
+  /* "fastrometry/cython_code/WCS.pyx":402
  *     """
  * 
  *     invtransf_intrmtriangle_view[0,0] = CRPIXx + (intrmAx*cos(phi) + intrmAy*sin(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmtriangle_view[0,1] = CRPIXy + (-intrmAx*sin(phi) + intrmAy*cos(phi))/S
  *     invtransf_intrmtriangle_view[1,0] = CRPIXx + (intrmBx*cos(phi) + intrmBy*sin(phi))/S
  */
   __pyx_t_1 = ((__pyx_v_intrmAx * cos(__pyx_v_phi)) + (__pyx_v_intrmAy * sin(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 423, __pyx_L1_error)
+    __PYX_ERR(0, 402, __pyx_L1_error)
   }
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 423, __pyx_L1_error)
+    __PYX_ERR(0, 402, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXx + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":424
+  /* "fastrometry/cython_code/WCS.pyx":403
  * 
  *     invtransf_intrmtriangle_view[0,0] = CRPIXx + (intrmAx*cos(phi) + intrmAy*sin(phi))/S
  *     invtransf_intrmtriangle_view[0,1] = CRPIXy + (-intrmAx*sin(phi) + intrmAy*cos(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmtriangle_view[1,0] = CRPIXx + (intrmBx*cos(phi) + intrmBy*sin(phi))/S
  *     invtransf_intrmtriangle_view[1,1] = CRPIXy + (-intrmBx*sin(phi) + intrmBy*cos(phi))/S
  */
   __pyx_t_1 = (((-__pyx_v_intrmAx) * sin(__pyx_v_phi)) + (__pyx_v_intrmAy * cos(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 424, __pyx_L1_error)
+    __PYX_ERR(0, 403, __pyx_L1_error)
   }
   __pyx_t_3 = 0;
   __pyx_t_2 = 1;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 424, __pyx_L1_error)
+    __PYX_ERR(0, 403, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXy + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":425
+  /* "fastrometry/cython_code/WCS.pyx":404
  *     invtransf_intrmtriangle_view[0,0] = CRPIXx + (intrmAx*cos(phi) + intrmAy*sin(phi))/S
  *     invtransf_intrmtriangle_view[0,1] = CRPIXy + (-intrmAx*sin(phi) + intrmAy*cos(phi))/S
  *     invtransf_intrmtriangle_view[1,0] = CRPIXx + (intrmBx*cos(phi) + intrmBy*sin(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmtriangle_view[1,1] = CRPIXy + (-intrmBx*sin(phi) + intrmBy*cos(phi))/S
  *     invtransf_intrmtriangle_view[2,0] = CRPIXx + (intrmCx*cos(phi) + intrmCy*sin(phi))/S
  */
   __pyx_t_1 = ((__pyx_v_intrmBx * cos(__pyx_v_phi)) + (__pyx_v_intrmBy * sin(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 425, __pyx_L1_error)
+    __PYX_ERR(0, 404, __pyx_L1_error)
   }
   __pyx_t_2 = 1;
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 425, __pyx_L1_error)
+    __PYX_ERR(0, 404, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXx + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":426
+  /* "fastrometry/cython_code/WCS.pyx":405
  *     invtransf_intrmtriangle_view[0,1] = CRPIXy + (-intrmAx*sin(phi) + intrmAy*cos(phi))/S
  *     invtransf_intrmtriangle_view[1,0] = CRPIXx + (intrmBx*cos(phi) + intrmBy*sin(phi))/S
  *     invtransf_intrmtriangle_view[1,1] = CRPIXy + (-intrmBx*sin(phi) + intrmBy*cos(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmtriangle_view[2,0] = CRPIXx + (intrmCx*cos(phi) + intrmCy*sin(phi))/S
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  */
   __pyx_t_1 = (((-__pyx_v_intrmBx) * sin(__pyx_v_phi)) + (__pyx_v_intrmBy * cos(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 426, __pyx_L1_error)
+    __PYX_ERR(0, 405, __pyx_L1_error)
   }
   __pyx_t_3 = 1;
   __pyx_t_2 = 1;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 426, __pyx_L1_error)
+    __PYX_ERR(0, 405, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXy + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":427
+  /* "fastrometry/cython_code/WCS.pyx":406
  *     invtransf_intrmtriangle_view[1,0] = CRPIXx + (intrmBx*cos(phi) + intrmBy*sin(phi))/S
  *     invtransf_intrmtriangle_view[1,1] = CRPIXy + (-intrmBx*sin(phi) + intrmBy*cos(phi))/S
  *     invtransf_intrmtriangle_view[2,0] = CRPIXx + (intrmCx*cos(phi) + intrmCy*sin(phi))/S             # <<<<<<<<<<<<<<
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  * 
  */
   __pyx_t_1 = ((__pyx_v_intrmCx * cos(__pyx_v_phi)) + (__pyx_v_intrmCy * sin(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 427, __pyx_L1_error)
+    __PYX_ERR(0, 406, __pyx_L1_error)
   }
   __pyx_t_2 = 2;
   __pyx_t_3 = 0;
   __pyx_t_4 = -1;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 427, __pyx_L1_error)
+    __PYX_ERR(0, 406, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXx + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":428
+  /* "fastrometry/cython_code/WCS.pyx":407
  *     invtransf_intrmtriangle_view[1,1] = CRPIXy + (-intrmBx*sin(phi) + intrmBy*cos(phi))/S
  *     invtransf_intrmtriangle_view[2,0] = CRPIXx + (intrmCx*cos(phi) + intrmCy*sin(phi))/S
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S             # <<<<<<<<<<<<<<
  * 
  * def fitTrianglesToGetSphi(params, pseAx, pseAy, pseBx, pseBy, pseCx, pseCy, intrmAx, intrmAy, intrmBx, intrmBy, intrmCx, intrmCy):
  */
   __pyx_t_1 = (((-__pyx_v_intrmCx) * sin(__pyx_v_phi)) + (__pyx_v_intrmCy * cos(__pyx_v_phi)));
   if (unlikely(__pyx_v_S == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 428, __pyx_L1_error)
+    __PYX_ERR(0, 407, __pyx_L1_error)
   }
   __pyx_t_3 = 2;
   __pyx_t_2 = 1;
   __pyx_t_4 = -1;
   if (__pyx_t_3 < 0) {
     __pyx_t_3 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
     if (unlikely(__pyx_t_3 < 0)) __pyx_t_4 = 0;
   } else if (unlikely(__pyx_t_3 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_4 = 0;
   if (__pyx_t_2 < 0) {
     __pyx_t_2 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
     if (unlikely(__pyx_t_2 < 0)) __pyx_t_4 = 1;
   } else if (unlikely(__pyx_t_2 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_4 = 1;
   if (unlikely(__pyx_t_4 != -1)) {
     __Pyx_RaiseBufferIndexError(__pyx_t_4);
-    __PYX_ERR(0, 428, __pyx_L1_error)
+    __PYX_ERR(0, 407, __pyx_L1_error)
   }
   *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_3 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_2 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )) = (__pyx_v_CRPIXy + (__pyx_t_1 / __pyx_v_S));
 
-  /* "fastrometry/cython_code/WCS.pyx":418
+  /* "fastrometry/cython_code/WCS.pyx":397
  *     invtransf_intrmpoint_view[1] = CRPIXy + (-intrmx*sin(phi) + intrmy*cos(phi))/S
  * 
  * cdef inverseTransformTriangleUsingSphi(double S, double phi, double CRPIXx, double CRPIXy, double intrmAx, double intrmAy, double intrmBx, double intrmBy, double intrmCx, double intrmCy, double[:,:] invtransf_intrmtriangle_view):             # <<<<<<<<<<<<<<
  *     """
  *     Use S, phi and the 2 CRPIX reference coordinates to inverse-transform intermediate triangles (triplets of intermediate points).
  */
 
@@ -11128,27 +10521,27 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":430
+/* "fastrometry/cython_code/WCS.pyx":409
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  * 
  * def fitTrianglesToGetSphi(params, pseAx, pseAy, pseBx, pseBy, pseCx, pseCy, intrmAx, intrmAy, intrmBx, intrmBy, intrmCx, intrmCy):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_7fitTrianglesToGetSphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3WCS_6fitTrianglesToGetSphi[] = "\n    The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer\n    will settle on the S, phi, CRPIXx and CRPIXy which minimize the 6 residuals. Each residual is the difference between the forward-\n    transformed pse coordinate and the intermediate coordinate that should result.\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_7fitTrianglesToGetSphi = {"fitTrianglesToGetSphi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_7fitTrianglesToGetSphi, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_6fitTrianglesToGetSphi};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_7fitTrianglesToGetSphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_5fitTrianglesToGetSphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11fastrometry_11cython_code_3WCS_4fitTrianglesToGetSphi[] = "\n    The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer\n    will settle on the S, phi, CRPIXx and CRPIXy which minimize the 6 residuals. Each residual is the difference between the forward-\n    transformed pse coordinate and the intermediate coordinate that should result.\n    ";
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_5fitTrianglesToGetSphi = {"fitTrianglesToGetSphi", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_5fitTrianglesToGetSphi, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_4fitTrianglesToGetSphi};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_5fitTrianglesToGetSphi(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_params = 0;
   PyObject *__pyx_v_pseAx = 0;
   PyObject *__pyx_v_pseAy = 0;
   PyObject *__pyx_v_pseBx = 0;
   PyObject *__pyx_v_pseBy = 0;
   PyObject *__pyx_v_pseCx = 0;
   PyObject *__pyx_v_pseCy = 0;
@@ -11205,85 +10598,85 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_params)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseAx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 1); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 1); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseAy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 2); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 2); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseBx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 3); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 3); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseBy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 4); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 4); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseCx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 5); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 5); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pseCy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 6); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 6); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmAx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 7); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 7); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmAy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 8); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 8); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmBx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 9); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 9); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 10:
         if (likely((values[10] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmBy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 10); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 10); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 11:
         if (likely((values[11] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmCx)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 11); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 11); __PYX_ERR(0, 409, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 12:
         if (likely((values[12] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_intrmCy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 12); __PYX_ERR(0, 430, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, 12); __PYX_ERR(0, 409, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fitTrianglesToGetSphi") < 0)) __PYX_ERR(0, 430, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fitTrianglesToGetSphi") < 0)) __PYX_ERR(0, 409, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 13) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -11310,28 +10703,28 @@
     __pyx_v_intrmBx = values[9];
     __pyx_v_intrmBy = values[10];
     __pyx_v_intrmCx = values[11];
     __pyx_v_intrmCy = values[12];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 430, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("fitTrianglesToGetSphi", 1, 13, 13, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 409, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.WCS.fitTrianglesToGetSphi", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_6fitTrianglesToGetSphi(__pyx_self, __pyx_v_params, __pyx_v_pseAx, __pyx_v_pseAy, __pyx_v_pseBx, __pyx_v_pseBy, __pyx_v_pseCx, __pyx_v_pseCy, __pyx_v_intrmAx, __pyx_v_intrmAy, __pyx_v_intrmBx, __pyx_v_intrmBy, __pyx_v_intrmCx, __pyx_v_intrmCy);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_4fitTrianglesToGetSphi(__pyx_self, __pyx_v_params, __pyx_v_pseAx, __pyx_v_pseAy, __pyx_v_pseBx, __pyx_v_pseBy, __pyx_v_pseCx, __pyx_v_pseCy, __pyx_v_intrmAx, __pyx_v_intrmAy, __pyx_v_intrmBx, __pyx_v_intrmBy, __pyx_v_intrmCx, __pyx_v_intrmCy);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_6fitTrianglesToGetSphi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_pseAx, PyObject *__pyx_v_pseAy, PyObject *__pyx_v_pseBx, PyObject *__pyx_v_pseBy, PyObject *__pyx_v_pseCx, PyObject *__pyx_v_pseCy, PyObject *__pyx_v_intrmAx, PyObject *__pyx_v_intrmAy, PyObject *__pyx_v_intrmBx, PyObject *__pyx_v_intrmBy, PyObject *__pyx_v_intrmCx, PyObject *__pyx_v_intrmCy) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_4fitTrianglesToGetSphi(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_params, PyObject *__pyx_v_pseAx, PyObject *__pyx_v_pseAy, PyObject *__pyx_v_pseBx, PyObject *__pyx_v_pseBy, PyObject *__pyx_v_pseCx, PyObject *__pyx_v_pseCy, PyObject *__pyx_v_intrmAx, PyObject *__pyx_v_intrmAy, PyObject *__pyx_v_intrmBx, PyObject *__pyx_v_intrmBy, PyObject *__pyx_v_intrmCx, PyObject *__pyx_v_intrmCy) {
   PyObject *__pyx_v_S = NULL;
   PyObject *__pyx_v_phi = NULL;
   PyObject *__pyx_v_CRPIXx = NULL;
   PyObject *__pyx_v_CRPIXy = NULL;
   PyObject *__pyx_v_residualAx = NULL;
   PyObject *__pyx_v_residualAy = NULL;
   PyObject *__pyx_v_residualBx = NULL;
@@ -11346,322 +10739,322 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fitTrianglesToGetSphi", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":437
+  /* "fastrometry/cython_code/WCS.pyx":416
  *     """
  * 
  *     S = params[0]             # <<<<<<<<<<<<<<
  *     phi = params[1]
  *     CRPIXx = params[2]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_S = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":438
+  /* "fastrometry/cython_code/WCS.pyx":417
  * 
  *     S = params[0]
  *     phi = params[1]             # <<<<<<<<<<<<<<
  *     CRPIXx = params[2]
  *     CRPIXy = params[3]
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_phi = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":439
+  /* "fastrometry/cython_code/WCS.pyx":418
  *     S = params[0]
  *     phi = params[1]
  *     CRPIXx = params[2]             # <<<<<<<<<<<<<<
  *     CRPIXy = params[3]
  *     residualAx = (S*cos(phi)*(pseAx-CRPIXx) - S*sin(phi)*(pseAy-CRPIXy)) - intrmAx
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CRPIXx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":440
+  /* "fastrometry/cython_code/WCS.pyx":419
  *     phi = params[1]
  *     CRPIXx = params[2]
  *     CRPIXy = params[3]             # <<<<<<<<<<<<<<
  *     residualAx = (S*cos(phi)*(pseAx-CRPIXx) - S*sin(phi)*(pseAy-CRPIXy)) - intrmAx
  *     residualAy = (S*sin(phi)*(pseAx-CRPIXx) + S*cos(phi)*(pseAy-CRPIXy)) - intrmAy
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_params, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CRPIXy = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":441
+  /* "fastrometry/cython_code/WCS.pyx":420
  *     CRPIXx = params[2]
  *     CRPIXy = params[3]
  *     residualAx = (S*cos(phi)*(pseAx-CRPIXx) - S*sin(phi)*(pseAy-CRPIXy)) - intrmAx             # <<<<<<<<<<<<<<
  *     residualAy = (S*sin(phi)*(pseAx-CRPIXx) + S*cos(phi)*(pseAy-CRPIXy)) - intrmAy
  *     residualBx = (S*cos(phi)*(pseBx-CRPIXx) - S*sin(phi)*(pseBy-CRPIXy)) - intrmBx
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 441, __pyx_L1_error)
-  __pyx_t_1 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 420, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseAx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseAx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 441, __pyx_L1_error)
-  __pyx_t_1 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 420, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseAy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseAy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmAx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmAx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_residualAx = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":442
+  /* "fastrometry/cython_code/WCS.pyx":421
  *     CRPIXy = params[3]
  *     residualAx = (S*cos(phi)*(pseAx-CRPIXx) - S*sin(phi)*(pseAy-CRPIXy)) - intrmAx
  *     residualAy = (S*sin(phi)*(pseAx-CRPIXx) + S*cos(phi)*(pseAy-CRPIXy)) - intrmAy             # <<<<<<<<<<<<<<
  *     residualBx = (S*cos(phi)*(pseBx-CRPIXx) - S*sin(phi)*(pseBy-CRPIXy)) - intrmBx
  *     residualBy = (S*sin(phi)*(pseBx-CRPIXx) + S*cos(phi)*(pseBy-CRPIXy)) - intrmBy
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 442, __pyx_L1_error)
-  __pyx_t_5 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 421, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseAx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseAx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 442, __pyx_L1_error)
-  __pyx_t_5 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 421, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseAy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseAy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_v_intrmAy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_v_intrmAy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_residualAy = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":443
+  /* "fastrometry/cython_code/WCS.pyx":422
  *     residualAx = (S*cos(phi)*(pseAx-CRPIXx) - S*sin(phi)*(pseAy-CRPIXy)) - intrmAx
  *     residualAy = (S*sin(phi)*(pseAx-CRPIXx) + S*cos(phi)*(pseAy-CRPIXy)) - intrmAy
  *     residualBx = (S*cos(phi)*(pseBx-CRPIXx) - S*sin(phi)*(pseBy-CRPIXy)) - intrmBx             # <<<<<<<<<<<<<<
  *     residualBy = (S*sin(phi)*(pseBx-CRPIXx) + S*cos(phi)*(pseBy-CRPIXy)) - intrmBy
  *     residualCx = (S*cos(phi)*(pseCx-CRPIXx) - S*sin(phi)*(pseCy-CRPIXy)) - intrmCx
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 443, __pyx_L1_error)
-  __pyx_t_3 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 422, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseBx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseBx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 443, __pyx_L1_error)
-  __pyx_t_3 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 422, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseBy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseBy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_intrmBx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_intrmBx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_residualBx = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":444
+  /* "fastrometry/cython_code/WCS.pyx":423
  *     residualAy = (S*sin(phi)*(pseAx-CRPIXx) + S*cos(phi)*(pseAy-CRPIXy)) - intrmAy
  *     residualBx = (S*cos(phi)*(pseBx-CRPIXx) - S*sin(phi)*(pseBy-CRPIXy)) - intrmBx
  *     residualBy = (S*sin(phi)*(pseBx-CRPIXx) + S*cos(phi)*(pseBy-CRPIXy)) - intrmBy             # <<<<<<<<<<<<<<
  *     residualCx = (S*cos(phi)*(pseCx-CRPIXx) - S*sin(phi)*(pseCy-CRPIXy)) - intrmCx
  *     residualCy = (S*sin(phi)*(pseCx-CRPIXx) + S*cos(phi)*(pseCy-CRPIXy)) - intrmCy
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 444, __pyx_L1_error)
-  __pyx_t_1 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseBx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseBx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 444, __pyx_L1_error)
-  __pyx_t_1 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_S, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseBy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_pseBy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmBy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 444, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_v_intrmBy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_residualBy = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":445
+  /* "fastrometry/cython_code/WCS.pyx":424
  *     residualBx = (S*cos(phi)*(pseBx-CRPIXx) - S*sin(phi)*(pseBy-CRPIXy)) - intrmBx
  *     residualBy = (S*sin(phi)*(pseBx-CRPIXx) + S*cos(phi)*(pseBy-CRPIXy)) - intrmBy
  *     residualCx = (S*cos(phi)*(pseCx-CRPIXx) - S*sin(phi)*(pseCy-CRPIXy)) - intrmCx             # <<<<<<<<<<<<<<
  *     residualCy = (S*sin(phi)*(pseCx-CRPIXx) + S*cos(phi)*(pseCy-CRPIXy)) - intrmCy
  *     return np.array([residualAx, residualAy, residualBx, residualBy, residualCx, residualCy])
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 445, __pyx_L1_error)
-  __pyx_t_5 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseCx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseCx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 445, __pyx_L1_error)
-  __pyx_t_5 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_S, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseCy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_v_pseCy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_v_intrmCx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_t_5, __pyx_v_intrmCx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_residualCx = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":446
+  /* "fastrometry/cython_code/WCS.pyx":425
  *     residualBy = (S*sin(phi)*(pseBx-CRPIXx) + S*cos(phi)*(pseBy-CRPIXy)) - intrmBy
  *     residualCx = (S*cos(phi)*(pseCx-CRPIXx) - S*sin(phi)*(pseCy-CRPIXy)) - intrmCx
  *     residualCy = (S*sin(phi)*(pseCx-CRPIXx) + S*cos(phi)*(pseCy-CRPIXy)) - intrmCy             # <<<<<<<<<<<<<<
  *     return np.array([residualAx, residualAy, residualBx, residualBy, residualCx, residualCy])
  * 
  */
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 446, __pyx_L1_error)
-  __pyx_t_3 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(sin(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseCx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseCx, __pyx_v_CRPIXx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 446, __pyx_L1_error)
-  __pyx_t_3 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_2 = __pyx_PyFloat_AsDouble(__pyx_v_phi); if (unlikely((__pyx_t_2 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(cos(__pyx_t_2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_v_S, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseCy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_pseCy, __pyx_v_CRPIXy); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_intrmCy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_v_intrmCy); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_residualCy = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":447
+  /* "fastrometry/cython_code/WCS.pyx":426
  *     residualCx = (S*cos(phi)*(pseCx-CRPIXx) - S*sin(phi)*(pseCy-CRPIXy)) - intrmCx
  *     residualCy = (S*sin(phi)*(pseCx-CRPIXx) + S*cos(phi)*(pseCy-CRPIXy)) - intrmCy
  *     return np.array([residualAx, residualAy, residualBx, residualBy, residualCx, residualCy])             # <<<<<<<<<<<<<<
  * 
  * cdef getTriangleData(double x1, double y1, double x2, double y2, double x3, double y3, triangle_datalist):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 447, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_array); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyList_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
+  __pyx_t_3 = PyList_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_residualAx);
   __Pyx_GIVEREF(__pyx_v_residualAx);
   PyList_SET_ITEM(__pyx_t_3, 0, __pyx_v_residualAx);
   __Pyx_INCREF(__pyx_v_residualAy);
   __Pyx_GIVEREF(__pyx_v_residualAy);
   PyList_SET_ITEM(__pyx_t_3, 1, __pyx_v_residualAy);
@@ -11686,22 +11079,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/WCS.pyx":430
+  /* "fastrometry/cython_code/WCS.pyx":409
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  * 
  * def fitTrianglesToGetSphi(params, pseAx, pseAy, pseBx, pseBy, pseCx, pseCy, intrmAx, intrmAy, intrmBx, intrmBy, intrmCx, intrmCy):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer
  */
 
@@ -11725,15 +11118,15 @@
   __Pyx_XDECREF(__pyx_v_residualCx);
   __Pyx_XDECREF(__pyx_v_residualCy);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":449
+/* "fastrometry/cython_code/WCS.pyx":428
  *     return np.array([residualAx, residualAy, residualBx, residualBy, residualCx, residualCy])
  * 
  * cdef getTriangleData(double x1, double y1, double x2, double y2, double x3, double y3, triangle_datalist):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
@@ -11763,732 +11156,732 @@
   double __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("getTriangleData", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":477
+  /* "fastrometry/cython_code/WCS.pyx":456
  *         double fieldvectorangle
  * 
  *     sidelength12 = sqrt((x1-x2)**2+(y1-y2)**2)             # <<<<<<<<<<<<<<
  *     sidelength23 = sqrt((x2-x3)**2+(y2-y3)**2)
  *     sidelength31 = sqrt((x3-x1)**2+(y3-y1)**2)
  */
   __pyx_v_sidelength12 = sqrt((pow((__pyx_v_x1 - __pyx_v_x2), 2.0) + pow((__pyx_v_y1 - __pyx_v_y2), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":478
+  /* "fastrometry/cython_code/WCS.pyx":457
  * 
  *     sidelength12 = sqrt((x1-x2)**2+(y1-y2)**2)
  *     sidelength23 = sqrt((x2-x3)**2+(y2-y3)**2)             # <<<<<<<<<<<<<<
  *     sidelength31 = sqrt((x3-x1)**2+(y3-y1)**2)
  * 
  */
   __pyx_v_sidelength23 = sqrt((pow((__pyx_v_x2 - __pyx_v_x3), 2.0) + pow((__pyx_v_y2 - __pyx_v_y3), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":479
+  /* "fastrometry/cython_code/WCS.pyx":458
  *     sidelength12 = sqrt((x1-x2)**2+(y1-y2)**2)
  *     sidelength23 = sqrt((x2-x3)**2+(y2-y3)**2)
  *     sidelength31 = sqrt((x3-x1)**2+(y3-y1)**2)             # <<<<<<<<<<<<<<
  * 
  *     if sidelength12 < sidelength31 < sidelength23:
  */
   __pyx_v_sidelength31 = sqrt((pow((__pyx_v_x3 - __pyx_v_x1), 2.0) + pow((__pyx_v_y3 - __pyx_v_y1), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":481
+  /* "fastrometry/cython_code/WCS.pyx":460
  *     sidelength31 = sqrt((x3-x1)**2+(y3-y1)**2)
  * 
  *     if sidelength12 < sidelength31 < sidelength23:             # <<<<<<<<<<<<<<
  *         pointAx = x1
  *         pointAy = y1
  */
   __pyx_t_1 = (__pyx_v_sidelength12 < __pyx_v_sidelength31);
   if (__pyx_t_1) {
     __pyx_t_1 = (__pyx_v_sidelength31 < __pyx_v_sidelength23);
   }
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":482
+    /* "fastrometry/cython_code/WCS.pyx":461
  * 
  *     if sidelength12 < sidelength31 < sidelength23:
  *         pointAx = x1             # <<<<<<<<<<<<<<
  *         pointAy = y1
  *         pointBx = x2
  */
     __pyx_v_pointAx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":483
+    /* "fastrometry/cython_code/WCS.pyx":462
  *     if sidelength12 < sidelength31 < sidelength23:
  *         pointAx = x1
  *         pointAy = y1             # <<<<<<<<<<<<<<
  *         pointBx = x2
  *         pointBy = y2
  */
     __pyx_v_pointAy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":484
+    /* "fastrometry/cython_code/WCS.pyx":463
  *         pointAx = x1
  *         pointAy = y1
  *         pointBx = x2             # <<<<<<<<<<<<<<
  *         pointBy = y2
  *         pointCx = x3
  */
     __pyx_v_pointBx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":485
+    /* "fastrometry/cython_code/WCS.pyx":464
  *         pointAy = y1
  *         pointBx = x2
  *         pointBy = y2             # <<<<<<<<<<<<<<
  *         pointCx = x3
  *         pointCy = y3
  */
     __pyx_v_pointBy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":486
+    /* "fastrometry/cython_code/WCS.pyx":465
  *         pointBx = x2
  *         pointBy = y2
  *         pointCx = x3             # <<<<<<<<<<<<<<
  *         pointCy = y3
  *     elif sidelength31 < sidelength12 < sidelength23:
  */
     __pyx_v_pointCx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":487
+    /* "fastrometry/cython_code/WCS.pyx":466
  *         pointBy = y2
  *         pointCx = x3
  *         pointCy = y3             # <<<<<<<<<<<<<<
  *     elif sidelength31 < sidelength12 < sidelength23:
  *         pointAx = x1
  */
     __pyx_v_pointCy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":481
+    /* "fastrometry/cython_code/WCS.pyx":460
  *     sidelength31 = sqrt((x3-x1)**2+(y3-y1)**2)
  * 
  *     if sidelength12 < sidelength31 < sidelength23:             # <<<<<<<<<<<<<<
  *         pointAx = x1
  *         pointAy = y1
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":488
+  /* "fastrometry/cython_code/WCS.pyx":467
  *         pointCx = x3
  *         pointCy = y3
  *     elif sidelength31 < sidelength12 < sidelength23:             # <<<<<<<<<<<<<<
  *         pointAx = x1
  *         pointAy = y1
  */
   __pyx_t_2 = (__pyx_v_sidelength31 < __pyx_v_sidelength12);
   if (__pyx_t_2) {
     __pyx_t_2 = (__pyx_v_sidelength12 < __pyx_v_sidelength23);
   }
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":489
+    /* "fastrometry/cython_code/WCS.pyx":468
  *         pointCy = y3
  *     elif sidelength31 < sidelength12 < sidelength23:
  *         pointAx = x1             # <<<<<<<<<<<<<<
  *         pointAy = y1
  *         pointBx = x3
  */
     __pyx_v_pointAx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":490
+    /* "fastrometry/cython_code/WCS.pyx":469
  *     elif sidelength31 < sidelength12 < sidelength23:
  *         pointAx = x1
  *         pointAy = y1             # <<<<<<<<<<<<<<
  *         pointBx = x3
  *         pointBy = y3
  */
     __pyx_v_pointAy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":491
+    /* "fastrometry/cython_code/WCS.pyx":470
  *         pointAx = x1
  *         pointAy = y1
  *         pointBx = x3             # <<<<<<<<<<<<<<
  *         pointBy = y3
  *         pointCx = x2
  */
     __pyx_v_pointBx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":492
+    /* "fastrometry/cython_code/WCS.pyx":471
  *         pointAy = y1
  *         pointBx = x3
  *         pointBy = y3             # <<<<<<<<<<<<<<
  *         pointCx = x2
  *         pointCy = y2
  */
     __pyx_v_pointBy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":493
+    /* "fastrometry/cython_code/WCS.pyx":472
  *         pointBx = x3
  *         pointBy = y3
  *         pointCx = x2             # <<<<<<<<<<<<<<
  *         pointCy = y2
  *     elif sidelength12 < sidelength23 < sidelength31:
  */
     __pyx_v_pointCx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":494
+    /* "fastrometry/cython_code/WCS.pyx":473
  *         pointBy = y3
  *         pointCx = x2
  *         pointCy = y2             # <<<<<<<<<<<<<<
  *     elif sidelength12 < sidelength23 < sidelength31:
  *         pointAx = x2
  */
     __pyx_v_pointCy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":488
+    /* "fastrometry/cython_code/WCS.pyx":467
  *         pointCx = x3
  *         pointCy = y3
  *     elif sidelength31 < sidelength12 < sidelength23:             # <<<<<<<<<<<<<<
  *         pointAx = x1
  *         pointAy = y1
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":495
+  /* "fastrometry/cython_code/WCS.pyx":474
  *         pointCx = x2
  *         pointCy = y2
  *     elif sidelength12 < sidelength23 < sidelength31:             # <<<<<<<<<<<<<<
  *         pointAx = x2
  *         pointAy = y2
  */
   __pyx_t_1 = (__pyx_v_sidelength12 < __pyx_v_sidelength23);
   if (__pyx_t_1) {
     __pyx_t_1 = (__pyx_v_sidelength23 < __pyx_v_sidelength31);
   }
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":496
+    /* "fastrometry/cython_code/WCS.pyx":475
  *         pointCy = y2
  *     elif sidelength12 < sidelength23 < sidelength31:
  *         pointAx = x2             # <<<<<<<<<<<<<<
  *         pointAy = y2
  *         pointBx = x1
  */
     __pyx_v_pointAx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":497
+    /* "fastrometry/cython_code/WCS.pyx":476
  *     elif sidelength12 < sidelength23 < sidelength31:
  *         pointAx = x2
  *         pointAy = y2             # <<<<<<<<<<<<<<
  *         pointBx = x1
  *         pointBy = y1
  */
     __pyx_v_pointAy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":498
+    /* "fastrometry/cython_code/WCS.pyx":477
  *         pointAx = x2
  *         pointAy = y2
  *         pointBx = x1             # <<<<<<<<<<<<<<
  *         pointBy = y1
  *         pointCx = x3
  */
     __pyx_v_pointBx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":499
+    /* "fastrometry/cython_code/WCS.pyx":478
  *         pointAy = y2
  *         pointBx = x1
  *         pointBy = y1             # <<<<<<<<<<<<<<
  *         pointCx = x3
  *         pointCy = y3
  */
     __pyx_v_pointBy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":500
+    /* "fastrometry/cython_code/WCS.pyx":479
  *         pointBx = x1
  *         pointBy = y1
  *         pointCx = x3             # <<<<<<<<<<<<<<
  *         pointCy = y3
  *     elif sidelength23 < sidelength12 < sidelength31:
  */
     __pyx_v_pointCx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":501
+    /* "fastrometry/cython_code/WCS.pyx":480
  *         pointBy = y1
  *         pointCx = x3
  *         pointCy = y3             # <<<<<<<<<<<<<<
  *     elif sidelength23 < sidelength12 < sidelength31:
  *         pointAx = x2
  */
     __pyx_v_pointCy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":495
+    /* "fastrometry/cython_code/WCS.pyx":474
  *         pointCx = x2
  *         pointCy = y2
  *     elif sidelength12 < sidelength23 < sidelength31:             # <<<<<<<<<<<<<<
  *         pointAx = x2
  *         pointAy = y2
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":502
+  /* "fastrometry/cython_code/WCS.pyx":481
  *         pointCx = x3
  *         pointCy = y3
  *     elif sidelength23 < sidelength12 < sidelength31:             # <<<<<<<<<<<<<<
  *         pointAx = x2
  *         pointAy = y2
  */
   __pyx_t_2 = (__pyx_v_sidelength23 < __pyx_v_sidelength12);
   if (__pyx_t_2) {
     __pyx_t_2 = (__pyx_v_sidelength12 < __pyx_v_sidelength31);
   }
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":503
+    /* "fastrometry/cython_code/WCS.pyx":482
  *         pointCy = y3
  *     elif sidelength23 < sidelength12 < sidelength31:
  *         pointAx = x2             # <<<<<<<<<<<<<<
  *         pointAy = y2
  *         pointBx = x3
  */
     __pyx_v_pointAx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":504
+    /* "fastrometry/cython_code/WCS.pyx":483
  *     elif sidelength23 < sidelength12 < sidelength31:
  *         pointAx = x2
  *         pointAy = y2             # <<<<<<<<<<<<<<
  *         pointBx = x3
  *         pointBy = y3
  */
     __pyx_v_pointAy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":505
+    /* "fastrometry/cython_code/WCS.pyx":484
  *         pointAx = x2
  *         pointAy = y2
  *         pointBx = x3             # <<<<<<<<<<<<<<
  *         pointBy = y3
  *         pointCx = x1
  */
     __pyx_v_pointBx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":506
+    /* "fastrometry/cython_code/WCS.pyx":485
  *         pointAy = y2
  *         pointBx = x3
  *         pointBy = y3             # <<<<<<<<<<<<<<
  *         pointCx = x1
  *         pointCy = y1
  */
     __pyx_v_pointBy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":507
+    /* "fastrometry/cython_code/WCS.pyx":486
  *         pointBx = x3
  *         pointBy = y3
  *         pointCx = x1             # <<<<<<<<<<<<<<
  *         pointCy = y1
  *     elif sidelength31 < sidelength23 < sidelength12:
  */
     __pyx_v_pointCx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":508
+    /* "fastrometry/cython_code/WCS.pyx":487
  *         pointBy = y3
  *         pointCx = x1
  *         pointCy = y1             # <<<<<<<<<<<<<<
  *     elif sidelength31 < sidelength23 < sidelength12:
  *         pointAx = x3
  */
     __pyx_v_pointCy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":502
+    /* "fastrometry/cython_code/WCS.pyx":481
  *         pointCx = x3
  *         pointCy = y3
  *     elif sidelength23 < sidelength12 < sidelength31:             # <<<<<<<<<<<<<<
  *         pointAx = x2
  *         pointAy = y2
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":509
+  /* "fastrometry/cython_code/WCS.pyx":488
  *         pointCx = x1
  *         pointCy = y1
  *     elif sidelength31 < sidelength23 < sidelength12:             # <<<<<<<<<<<<<<
  *         pointAx = x3
  *         pointAy = y3
  */
   __pyx_t_1 = (__pyx_v_sidelength31 < __pyx_v_sidelength23);
   if (__pyx_t_1) {
     __pyx_t_1 = (__pyx_v_sidelength23 < __pyx_v_sidelength12);
   }
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":510
+    /* "fastrometry/cython_code/WCS.pyx":489
  *         pointCy = y1
  *     elif sidelength31 < sidelength23 < sidelength12:
  *         pointAx = x3             # <<<<<<<<<<<<<<
  *         pointAy = y3
  *         pointBx = x1
  */
     __pyx_v_pointAx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":511
+    /* "fastrometry/cython_code/WCS.pyx":490
  *     elif sidelength31 < sidelength23 < sidelength12:
  *         pointAx = x3
  *         pointAy = y3             # <<<<<<<<<<<<<<
  *         pointBx = x1
  *         pointBy = y1
  */
     __pyx_v_pointAy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":512
+    /* "fastrometry/cython_code/WCS.pyx":491
  *         pointAx = x3
  *         pointAy = y3
  *         pointBx = x1             # <<<<<<<<<<<<<<
  *         pointBy = y1
  *         pointCx = x2
  */
     __pyx_v_pointBx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":513
+    /* "fastrometry/cython_code/WCS.pyx":492
  *         pointAy = y3
  *         pointBx = x1
  *         pointBy = y1             # <<<<<<<<<<<<<<
  *         pointCx = x2
  *         pointCy = y2
  */
     __pyx_v_pointBy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":514
+    /* "fastrometry/cython_code/WCS.pyx":493
  *         pointBx = x1
  *         pointBy = y1
  *         pointCx = x2             # <<<<<<<<<<<<<<
  *         pointCy = y2
  *     elif sidelength23 < sidelength31 < sidelength12:
  */
     __pyx_v_pointCx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":515
+    /* "fastrometry/cython_code/WCS.pyx":494
  *         pointBy = y1
  *         pointCx = x2
  *         pointCy = y2             # <<<<<<<<<<<<<<
  *     elif sidelength23 < sidelength31 < sidelength12:
  *         pointAx = x3
  */
     __pyx_v_pointCy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":509
+    /* "fastrometry/cython_code/WCS.pyx":488
  *         pointCx = x1
  *         pointCy = y1
  *     elif sidelength31 < sidelength23 < sidelength12:             # <<<<<<<<<<<<<<
  *         pointAx = x3
  *         pointAy = y3
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":516
+  /* "fastrometry/cython_code/WCS.pyx":495
  *         pointCx = x2
  *         pointCy = y2
  *     elif sidelength23 < sidelength31 < sidelength12:             # <<<<<<<<<<<<<<
  *         pointAx = x3
  *         pointAy = y3
  */
   __pyx_t_2 = (__pyx_v_sidelength23 < __pyx_v_sidelength31);
   if (__pyx_t_2) {
     __pyx_t_2 = (__pyx_v_sidelength31 < __pyx_v_sidelength12);
   }
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":517
+    /* "fastrometry/cython_code/WCS.pyx":496
  *         pointCy = y2
  *     elif sidelength23 < sidelength31 < sidelength12:
  *         pointAx = x3             # <<<<<<<<<<<<<<
  *         pointAy = y3
  *         pointBx = x2
  */
     __pyx_v_pointAx = __pyx_v_x3;
 
-    /* "fastrometry/cython_code/WCS.pyx":518
+    /* "fastrometry/cython_code/WCS.pyx":497
  *     elif sidelength23 < sidelength31 < sidelength12:
  *         pointAx = x3
  *         pointAy = y3             # <<<<<<<<<<<<<<
  *         pointBx = x2
  *         pointBy = y2
  */
     __pyx_v_pointAy = __pyx_v_y3;
 
-    /* "fastrometry/cython_code/WCS.pyx":519
+    /* "fastrometry/cython_code/WCS.pyx":498
  *         pointAx = x3
  *         pointAy = y3
  *         pointBx = x2             # <<<<<<<<<<<<<<
  *         pointBy = y2
  *         pointCx = x1
  */
     __pyx_v_pointBx = __pyx_v_x2;
 
-    /* "fastrometry/cython_code/WCS.pyx":520
+    /* "fastrometry/cython_code/WCS.pyx":499
  *         pointAy = y3
  *         pointBx = x2
  *         pointBy = y2             # <<<<<<<<<<<<<<
  *         pointCx = x1
  *         pointCy = y1
  */
     __pyx_v_pointBy = __pyx_v_y2;
 
-    /* "fastrometry/cython_code/WCS.pyx":521
+    /* "fastrometry/cython_code/WCS.pyx":500
  *         pointBx = x2
  *         pointBy = y2
  *         pointCx = x1             # <<<<<<<<<<<<<<
  *         pointCy = y1
  * 
  */
     __pyx_v_pointCx = __pyx_v_x1;
 
-    /* "fastrometry/cython_code/WCS.pyx":522
+    /* "fastrometry/cython_code/WCS.pyx":501
  *         pointBy = y2
  *         pointCx = x1
  *         pointCy = y1             # <<<<<<<<<<<<<<
  * 
  *     sidelengthAB = sqrt((pointAx-pointBx)**2+(pointAy-pointBy)**2)
  */
     __pyx_v_pointCy = __pyx_v_y1;
 
-    /* "fastrometry/cython_code/WCS.pyx":516
+    /* "fastrometry/cython_code/WCS.pyx":495
  *         pointCx = x2
  *         pointCy = y2
  *     elif sidelength23 < sidelength31 < sidelength12:             # <<<<<<<<<<<<<<
  *         pointAx = x3
  *         pointAy = y3
  */
   }
   __pyx_L3:;
 
-  /* "fastrometry/cython_code/WCS.pyx":524
+  /* "fastrometry/cython_code/WCS.pyx":503
  *         pointCy = y1
  * 
  *     sidelengthAB = sqrt((pointAx-pointBx)**2+(pointAy-pointBy)**2)             # <<<<<<<<<<<<<<
  *     sidelengthBC = sqrt((pointBx-pointCx)**2+(pointBy-pointCy)**2)
  *     sidelengthCA = sqrt((pointCx-pointAx)**2+(pointCy-pointAy)**2)
  */
   __pyx_v_sidelengthAB = sqrt((pow((__pyx_v_pointAx - __pyx_v_pointBx), 2.0) + pow((__pyx_v_pointAy - __pyx_v_pointBy), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":525
+  /* "fastrometry/cython_code/WCS.pyx":504
  * 
  *     sidelengthAB = sqrt((pointAx-pointBx)**2+(pointAy-pointBy)**2)
  *     sidelengthBC = sqrt((pointBx-pointCx)**2+(pointBy-pointCy)**2)             # <<<<<<<<<<<<<<
  *     sidelengthCA = sqrt((pointCx-pointAx)**2+(pointCy-pointAy)**2)
  *     vertexA = acos((sidelengthAB**2+sidelengthCA**2-sidelengthBC**2)/(2*sidelengthAB*sidelengthCA))
  */
   __pyx_v_sidelengthBC = sqrt((pow((__pyx_v_pointBx - __pyx_v_pointCx), 2.0) + pow((__pyx_v_pointBy - __pyx_v_pointCy), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":526
+  /* "fastrometry/cython_code/WCS.pyx":505
  *     sidelengthAB = sqrt((pointAx-pointBx)**2+(pointAy-pointBy)**2)
  *     sidelengthBC = sqrt((pointBx-pointCx)**2+(pointBy-pointCy)**2)
  *     sidelengthCA = sqrt((pointCx-pointAx)**2+(pointCy-pointAy)**2)             # <<<<<<<<<<<<<<
  *     vertexA = acos((sidelengthAB**2+sidelengthCA**2-sidelengthBC**2)/(2*sidelengthAB*sidelengthCA))
  *     vertexB = acos((sidelengthAB**2+sidelengthBC**2-sidelengthCA**2)/(2*sidelengthAB*sidelengthBC))
  */
   __pyx_v_sidelengthCA = sqrt((pow((__pyx_v_pointCx - __pyx_v_pointAx), 2.0) + pow((__pyx_v_pointCy - __pyx_v_pointAy), 2.0)));
 
-  /* "fastrometry/cython_code/WCS.pyx":527
+  /* "fastrometry/cython_code/WCS.pyx":506
  *     sidelengthBC = sqrt((pointBx-pointCx)**2+(pointBy-pointCy)**2)
  *     sidelengthCA = sqrt((pointCx-pointAx)**2+(pointCy-pointAy)**2)
  *     vertexA = acos((sidelengthAB**2+sidelengthCA**2-sidelengthBC**2)/(2*sidelengthAB*sidelengthCA))             # <<<<<<<<<<<<<<
  *     vertexB = acos((sidelengthAB**2+sidelengthBC**2-sidelengthCA**2)/(2*sidelengthAB*sidelengthBC))
  *     vertexC = acos((sidelengthCA**2+sidelengthBC**2-sidelengthAB**2)/(2*sidelengthCA*sidelengthBC))
  */
   __pyx_t_3 = ((pow(__pyx_v_sidelengthAB, 2.0) + pow(__pyx_v_sidelengthCA, 2.0)) - pow(__pyx_v_sidelengthBC, 2.0));
   __pyx_t_4 = ((2.0 * __pyx_v_sidelengthAB) * __pyx_v_sidelengthCA);
   if (unlikely(__pyx_t_4 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 527, __pyx_L1_error)
+    __PYX_ERR(0, 506, __pyx_L1_error)
   }
   __pyx_v_vertexA = acos((__pyx_t_3 / __pyx_t_4));
 
-  /* "fastrometry/cython_code/WCS.pyx":528
+  /* "fastrometry/cython_code/WCS.pyx":507
  *     sidelengthCA = sqrt((pointCx-pointAx)**2+(pointCy-pointAy)**2)
  *     vertexA = acos((sidelengthAB**2+sidelengthCA**2-sidelengthBC**2)/(2*sidelengthAB*sidelengthCA))
  *     vertexB = acos((sidelengthAB**2+sidelengthBC**2-sidelengthCA**2)/(2*sidelengthAB*sidelengthBC))             # <<<<<<<<<<<<<<
  *     vertexC = acos((sidelengthCA**2+sidelengthBC**2-sidelengthAB**2)/(2*sidelengthCA*sidelengthBC))
  *     fieldvectorX = pointCx-pointBx
  */
   __pyx_t_4 = ((pow(__pyx_v_sidelengthAB, 2.0) + pow(__pyx_v_sidelengthBC, 2.0)) - pow(__pyx_v_sidelengthCA, 2.0));
   __pyx_t_3 = ((2.0 * __pyx_v_sidelengthAB) * __pyx_v_sidelengthBC);
   if (unlikely(__pyx_t_3 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 528, __pyx_L1_error)
+    __PYX_ERR(0, 507, __pyx_L1_error)
   }
   __pyx_v_vertexB = acos((__pyx_t_4 / __pyx_t_3));
 
-  /* "fastrometry/cython_code/WCS.pyx":529
+  /* "fastrometry/cython_code/WCS.pyx":508
  *     vertexA = acos((sidelengthAB**2+sidelengthCA**2-sidelengthBC**2)/(2*sidelengthAB*sidelengthCA))
  *     vertexB = acos((sidelengthAB**2+sidelengthBC**2-sidelengthCA**2)/(2*sidelengthAB*sidelengthBC))
  *     vertexC = acos((sidelengthCA**2+sidelengthBC**2-sidelengthAB**2)/(2*sidelengthCA*sidelengthBC))             # <<<<<<<<<<<<<<
  *     fieldvectorX = pointCx-pointBx
  *     fieldvectorY = pointCy-pointBy
  */
   __pyx_t_3 = ((pow(__pyx_v_sidelengthCA, 2.0) + pow(__pyx_v_sidelengthBC, 2.0)) - pow(__pyx_v_sidelengthAB, 2.0));
   __pyx_t_4 = ((2.0 * __pyx_v_sidelengthCA) * __pyx_v_sidelengthBC);
   if (unlikely(__pyx_t_4 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 529, __pyx_L1_error)
+    __PYX_ERR(0, 508, __pyx_L1_error)
   }
   __pyx_v_vertexC = acos((__pyx_t_3 / __pyx_t_4));
 
-  /* "fastrometry/cython_code/WCS.pyx":530
+  /* "fastrometry/cython_code/WCS.pyx":509
  *     vertexB = acos((sidelengthAB**2+sidelengthBC**2-sidelengthCA**2)/(2*sidelengthAB*sidelengthBC))
  *     vertexC = acos((sidelengthCA**2+sidelengthBC**2-sidelengthAB**2)/(2*sidelengthCA*sidelengthBC))
  *     fieldvectorX = pointCx-pointBx             # <<<<<<<<<<<<<<
  *     fieldvectorY = pointCy-pointBy
  * 
  */
   __pyx_v_fieldvectorX = (__pyx_v_pointCx - __pyx_v_pointBx);
 
-  /* "fastrometry/cython_code/WCS.pyx":531
+  /* "fastrometry/cython_code/WCS.pyx":510
  *     vertexC = acos((sidelengthCA**2+sidelengthBC**2-sidelengthAB**2)/(2*sidelengthCA*sidelengthBC))
  *     fieldvectorX = pointCx-pointBx
  *     fieldvectorY = pointCy-pointBy             # <<<<<<<<<<<<<<
  * 
  *     triangle_datalist[0] = pointAx
  */
   __pyx_v_fieldvectorY = (__pyx_v_pointCy - __pyx_v_pointBy);
 
-  /* "fastrometry/cython_code/WCS.pyx":533
+  /* "fastrometry/cython_code/WCS.pyx":512
  *     fieldvectorY = pointCy-pointBy
  * 
  *     triangle_datalist[0] = pointAx             # <<<<<<<<<<<<<<
  *     triangle_datalist[1] = pointAy
  *     triangle_datalist[2] = pointBx
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointAx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 533, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointAx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 533, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 0, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 512, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":534
+  /* "fastrometry/cython_code/WCS.pyx":513
  * 
  *     triangle_datalist[0] = pointAx
  *     triangle_datalist[1] = pointAy             # <<<<<<<<<<<<<<
  *     triangle_datalist[2] = pointBx
  *     triangle_datalist[3] = pointBy
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointAy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointAy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 513, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 1, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 534, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 1, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 513, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":535
+  /* "fastrometry/cython_code/WCS.pyx":514
  *     triangle_datalist[0] = pointAx
  *     triangle_datalist[1] = pointAy
  *     triangle_datalist[2] = pointBx             # <<<<<<<<<<<<<<
  *     triangle_datalist[3] = pointBy
  *     triangle_datalist[4] = pointCx
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointBx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 535, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointBx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 2, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 535, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 2, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 514, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":536
+  /* "fastrometry/cython_code/WCS.pyx":515
  *     triangle_datalist[1] = pointAy
  *     triangle_datalist[2] = pointBx
  *     triangle_datalist[3] = pointBy             # <<<<<<<<<<<<<<
  *     triangle_datalist[4] = pointCx
  *     triangle_datalist[5] = pointCy
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointBy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointBy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 515, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 3, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 536, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 3, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 515, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":537
+  /* "fastrometry/cython_code/WCS.pyx":516
  *     triangle_datalist[2] = pointBx
  *     triangle_datalist[3] = pointBy
  *     triangle_datalist[4] = pointCx             # <<<<<<<<<<<<<<
  *     triangle_datalist[5] = pointCy
  *     triangle_datalist[6] = vertexB
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointCx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 537, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointCx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 4, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 537, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 4, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 516, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":538
+  /* "fastrometry/cython_code/WCS.pyx":517
  *     triangle_datalist[3] = pointBy
  *     triangle_datalist[4] = pointCx
  *     triangle_datalist[5] = pointCy             # <<<<<<<<<<<<<<
  *     triangle_datalist[6] = vertexB
  *     triangle_datalist[7] = vertexC
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointCy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 538, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_pointCy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 517, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 5, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 5, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 517, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":539
+  /* "fastrometry/cython_code/WCS.pyx":518
  *     triangle_datalist[4] = pointCx
  *     triangle_datalist[5] = pointCy
  *     triangle_datalist[6] = vertexB             # <<<<<<<<<<<<<<
  *     triangle_datalist[7] = vertexC
  *     triangle_datalist[8] = sidelengthBC
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_vertexB); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 539, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_vertexB); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 6, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 539, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 6, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 518, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":540
+  /* "fastrometry/cython_code/WCS.pyx":519
  *     triangle_datalist[5] = pointCy
  *     triangle_datalist[6] = vertexB
  *     triangle_datalist[7] = vertexC             # <<<<<<<<<<<<<<
  *     triangle_datalist[8] = sidelengthBC
  *     triangle_datalist[9] = fieldvectorX
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_vertexC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_vertexC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 519, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 7, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 540, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 7, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 519, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":541
+  /* "fastrometry/cython_code/WCS.pyx":520
  *     triangle_datalist[6] = vertexB
  *     triangle_datalist[7] = vertexC
  *     triangle_datalist[8] = sidelengthBC             # <<<<<<<<<<<<<<
  *     triangle_datalist[9] = fieldvectorX
  *     triangle_datalist[10] = fieldvectorY
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_sidelengthBC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 541, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_sidelengthBC); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 520, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 8, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 541, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 8, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 520, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":542
+  /* "fastrometry/cython_code/WCS.pyx":521
  *     triangle_datalist[7] = vertexC
  *     triangle_datalist[8] = sidelengthBC
  *     triangle_datalist[9] = fieldvectorX             # <<<<<<<<<<<<<<
  *     triangle_datalist[10] = fieldvectorY
  * 
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_fieldvectorX); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 542, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_fieldvectorX); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 521, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 9, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 542, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 9, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 521, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":543
+  /* "fastrometry/cython_code/WCS.pyx":522
  *     triangle_datalist[8] = sidelengthBC
  *     triangle_datalist[9] = fieldvectorX
  *     triangle_datalist[10] = fieldvectorY             # <<<<<<<<<<<<<<
  * 
  * cdef generateTriangles(int npts, double[:,:] coords_view, double[:,:] triangles_view):
  */
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_fieldvectorY); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_fieldvectorY); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 10, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 543, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_triangle_datalist, 10, __pyx_t_5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 522, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":449
+  /* "fastrometry/cython_code/WCS.pyx":428
  *     return np.array([residualAx, residualAy, residualBx, residualBy, residualCx, residualCy])
  * 
  * cdef getTriangleData(double x1, double y1, double x2, double y2, double x3, double y3, triangle_datalist):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
 
@@ -12501,15 +11894,15 @@
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":545
+/* "fastrometry/cython_code/WCS.pyx":524
  *     triangle_datalist[10] = fieldvectorY
  * 
  * cdef generateTriangles(int npts, double[:,:] coords_view, double[:,:] triangles_view):             # <<<<<<<<<<<<<<
  *     """
  *     The a,b,c triple-nested for-loop iterates over every possible 3-combination of points (intermediate or
  */
 
@@ -12551,100 +11944,100 @@
   Py_ssize_t __pyx_t_27;
   Py_ssize_t __pyx_t_28;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("generateTriangles", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":556
+  /* "fastrometry/cython_code/WCS.pyx":535
  * 
  *     cdef:
  *         Py_ssize_t triangleNo = 0             # <<<<<<<<<<<<<<
  *         Py_ssize_t a
  *         Py_ssize_t b
  */
   __pyx_v_triangleNo = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":561
+  /* "fastrometry/cython_code/WCS.pyx":540
  *         Py_ssize_t c
  *         Py_ssize_t propertyNo
  *         double[:] triangledata_view = np.empty(11,dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     triangleNo = 0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_double); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_double); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__12, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__7, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 561, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_triangledata_view = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":563
+  /* "fastrometry/cython_code/WCS.pyx":542
  *         double[:] triangledata_view = np.empty(11,dtype=np.double)
  * 
  *     triangleNo = 0             # <<<<<<<<<<<<<<
  *     for a in range(0, npts-2):
  *         for b in range(a+1, npts-1):
  */
   __pyx_v_triangleNo = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":564
+  /* "fastrometry/cython_code/WCS.pyx":543
  * 
  *     triangleNo = 0
  *     for a in range(0, npts-2):             # <<<<<<<<<<<<<<
  *         for b in range(a+1, npts-1):
  *             for c in range(b+1, npts):
  */
   __pyx_t_6 = (__pyx_v_npts - 2);
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_a = __pyx_t_8;
 
-    /* "fastrometry/cython_code/WCS.pyx":565
+    /* "fastrometry/cython_code/WCS.pyx":544
  *     triangleNo = 0
  *     for a in range(0, npts-2):
  *         for b in range(a+1, npts-1):             # <<<<<<<<<<<<<<
  *             for c in range(b+1, npts):
  *                 getTriangleData(coords_view[a,0], coords_view[a,1], coords_view[b,0], coords_view[b,1], coords_view[c,0], coords_view[c,1], triangledata_view)
  */
     __pyx_t_9 = (__pyx_v_npts - 1);
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = (__pyx_v_a + 1); __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_v_b = __pyx_t_11;
 
-      /* "fastrometry/cython_code/WCS.pyx":566
+      /* "fastrometry/cython_code/WCS.pyx":545
  *     for a in range(0, npts-2):
  *         for b in range(a+1, npts-1):
  *             for c in range(b+1, npts):             # <<<<<<<<<<<<<<
  *                 getTriangleData(coords_view[a,0], coords_view[a,1], coords_view[b,0], coords_view[b,1], coords_view[c,0], coords_view[c,1], triangledata_view)
  *                 for propertyNo in range(11):
  */
       __pyx_t_12 = __pyx_v_npts;
       __pyx_t_13 = __pyx_t_12;
       for (__pyx_t_14 = (__pyx_v_b + 1); __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
         __pyx_v_c = __pyx_t_14;
 
-        /* "fastrometry/cython_code/WCS.pyx":567
+        /* "fastrometry/cython_code/WCS.pyx":546
  *         for b in range(a+1, npts-1):
  *             for c in range(b+1, npts):
  *                 getTriangleData(coords_view[a,0], coords_view[a,1], coords_view[b,0], coords_view[b,1], coords_view[c,0], coords_view[c,1], triangledata_view)             # <<<<<<<<<<<<<<
  *                 for propertyNo in range(11):
  *                     triangles_view[triangleNo, propertyNo] = triangledata_view[propertyNo]
  */
         __pyx_t_15 = __pyx_v_a;
@@ -12656,156 +12049,156 @@
         } else if (unlikely(__pyx_t_15 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_16 < 0) {
           __pyx_t_16 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_16 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_16 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
         __pyx_t_18 = __pyx_v_a;
         __pyx_t_19 = 1;
         __pyx_t_17 = -1;
         if (__pyx_t_18 < 0) {
           __pyx_t_18 += __pyx_v_coords_view.shape[0];
           if (unlikely(__pyx_t_18 < 0)) __pyx_t_17 = 0;
         } else if (unlikely(__pyx_t_18 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_19 < 0) {
           __pyx_t_19 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_19 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_19 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
         __pyx_t_20 = __pyx_v_b;
         __pyx_t_21 = 0;
         __pyx_t_17 = -1;
         if (__pyx_t_20 < 0) {
           __pyx_t_20 += __pyx_v_coords_view.shape[0];
           if (unlikely(__pyx_t_20 < 0)) __pyx_t_17 = 0;
         } else if (unlikely(__pyx_t_20 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_21 < 0) {
           __pyx_t_21 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_21 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_21 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
         __pyx_t_22 = __pyx_v_b;
         __pyx_t_23 = 1;
         __pyx_t_17 = -1;
         if (__pyx_t_22 < 0) {
           __pyx_t_22 += __pyx_v_coords_view.shape[0];
           if (unlikely(__pyx_t_22 < 0)) __pyx_t_17 = 0;
         } else if (unlikely(__pyx_t_22 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_23 < 0) {
           __pyx_t_23 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_23 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_23 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
         __pyx_t_24 = __pyx_v_c;
         __pyx_t_25 = 0;
         __pyx_t_17 = -1;
         if (__pyx_t_24 < 0) {
           __pyx_t_24 += __pyx_v_coords_view.shape[0];
           if (unlikely(__pyx_t_24 < 0)) __pyx_t_17 = 0;
         } else if (unlikely(__pyx_t_24 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_25 < 0) {
           __pyx_t_25 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_25 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_25 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
         __pyx_t_26 = __pyx_v_c;
         __pyx_t_27 = 1;
         __pyx_t_17 = -1;
         if (__pyx_t_26 < 0) {
           __pyx_t_26 += __pyx_v_coords_view.shape[0];
           if (unlikely(__pyx_t_26 < 0)) __pyx_t_17 = 0;
         } else if (unlikely(__pyx_t_26 >= __pyx_v_coords_view.shape[0])) __pyx_t_17 = 0;
         if (__pyx_t_27 < 0) {
           __pyx_t_27 += __pyx_v_coords_view.shape[1];
           if (unlikely(__pyx_t_27 < 0)) __pyx_t_17 = 1;
         } else if (unlikely(__pyx_t_27 >= __pyx_v_coords_view.shape[1])) __pyx_t_17 = 1;
         if (unlikely(__pyx_t_17 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_17);
-          __PYX_ERR(0, 567, __pyx_L1_error)
+          __PYX_ERR(0, 546, __pyx_L1_error)
         }
-        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_triangledata_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)
+        __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_triangledata_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getTriangleData((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_15 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_16 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_18 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_19 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_20 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_21 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_22 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_23 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_24 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_25 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_26 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_27 * __pyx_v_coords_view.strides[1]) ))), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)
+        __pyx_t_1 = __pyx_f_11fastrometry_11cython_code_3WCS_getTriangleData((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_15 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_16 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_18 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_19 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_20 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_21 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_22 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_23 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_24 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_25 * __pyx_v_coords_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_coords_view.data + __pyx_t_26 * __pyx_v_coords_view.strides[0]) ) + __pyx_t_27 * __pyx_v_coords_view.strides[1]) ))), __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "fastrometry/cython_code/WCS.pyx":568
+        /* "fastrometry/cython_code/WCS.pyx":547
  *             for c in range(b+1, npts):
  *                 getTriangleData(coords_view[a,0], coords_view[a,1], coords_view[b,0], coords_view[b,1], coords_view[c,0], coords_view[c,1], triangledata_view)
  *                 for propertyNo in range(11):             # <<<<<<<<<<<<<<
  *                     triangles_view[triangleNo, propertyNo] = triangledata_view[propertyNo]
  *                 triangleNo += 1
  */
         for (__pyx_t_28 = 0; __pyx_t_28 < 11; __pyx_t_28+=1) {
           __pyx_v_propertyNo = __pyx_t_28;
 
-          /* "fastrometry/cython_code/WCS.pyx":569
+          /* "fastrometry/cython_code/WCS.pyx":548
  *                 getTriangleData(coords_view[a,0], coords_view[a,1], coords_view[b,0], coords_view[b,1], coords_view[c,0], coords_view[c,1], triangledata_view)
  *                 for propertyNo in range(11):
  *                     triangles_view[triangleNo, propertyNo] = triangledata_view[propertyNo]             # <<<<<<<<<<<<<<
  *                 triangleNo += 1
  * 
  */
           __pyx_t_27 = __pyx_v_propertyNo;
           __pyx_t_17 = -1;
           if (__pyx_t_27 < 0) {
             __pyx_t_27 += __pyx_v_triangledata_view.shape[0];
             if (unlikely(__pyx_t_27 < 0)) __pyx_t_17 = 0;
           } else if (unlikely(__pyx_t_27 >= __pyx_v_triangledata_view.shape[0])) __pyx_t_17 = 0;
           if (unlikely(__pyx_t_17 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_17);
-            __PYX_ERR(0, 569, __pyx_L1_error)
+            __PYX_ERR(0, 548, __pyx_L1_error)
           }
           __pyx_t_26 = __pyx_v_triangleNo;
           __pyx_t_25 = __pyx_v_propertyNo;
           __pyx_t_17 = -1;
           if (__pyx_t_26 < 0) {
             __pyx_t_26 += __pyx_v_triangles_view.shape[0];
             if (unlikely(__pyx_t_26 < 0)) __pyx_t_17 = 0;
           } else if (unlikely(__pyx_t_26 >= __pyx_v_triangles_view.shape[0])) __pyx_t_17 = 0;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_triangles_view.shape[1];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_17 = 1;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_triangles_view.shape[1])) __pyx_t_17 = 1;
           if (unlikely(__pyx_t_17 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_17);
-            __PYX_ERR(0, 569, __pyx_L1_error)
+            __PYX_ERR(0, 548, __pyx_L1_error)
           }
           *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_triangles_view.data + __pyx_t_26 * __pyx_v_triangles_view.strides[0]) ) + __pyx_t_25 * __pyx_v_triangles_view.strides[1]) )) = (*((double *) ( /* dim=0 */ (__pyx_v_triangledata_view.data + __pyx_t_27 * __pyx_v_triangledata_view.strides[0]) )));
         }
 
-        /* "fastrometry/cython_code/WCS.pyx":570
+        /* "fastrometry/cython_code/WCS.pyx":549
  *                 for propertyNo in range(11):
  *                     triangles_view[triangleNo, propertyNo] = triangledata_view[propertyNo]
  *                 triangleNo += 1             # <<<<<<<<<<<<<<
  * 
  * cdef int findInitialSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, int[:,:] srcindexmap_initial_view, int npts, int img_xmax, int img_ymax, double scale, double scalebnds, object rotation, object rotationbnds, double vertextol, int minmatches, int kerneldiam, double[:] initial_solution_view, debug_report, filepath, int verbosity, bint debug):
  */
         __pyx_v_triangleNo = (__pyx_v_triangleNo + 1);
       }
     }
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":545
+  /* "fastrometry/cython_code/WCS.pyx":524
  *     triangle_datalist[10] = fieldvectorY
  * 
  * cdef generateTriangles(int npts, double[:,:] coords_view, double[:,:] triangles_view):             # <<<<<<<<<<<<<<
  *     """
  *     The a,b,c triple-nested for-loop iterates over every possible 3-combination of points (intermediate or
  */
 
@@ -12823,15 +12216,15 @@
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_triangledata_view, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":572
+/* "fastrometry/cython_code/WCS.pyx":551
  *                 triangleNo += 1
  * 
  * cdef int findInitialSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, int[:,:] srcindexmap_initial_view, int npts, int img_xmax, int img_ymax, double scale, double scalebnds, object rotation, object rotationbnds, double vertextol, int minmatches, int kerneldiam, double[:] initial_solution_view, debug_report, filepath, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  *     """
  *     Finds the initial solution. First, all possible triangles of PSE points and all possible triangles of intermediate points
  */
 
@@ -12946,97 +12339,97 @@
   int __pyx_t_49;
   Py_ssize_t __pyx_t_50;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("findInitialSolution", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":592
+  /* "fastrometry/cython_code/WCS.pyx":571
  *     #In that case, we have to use however many points are available.
  * 
  *     if num_catsources < npts:             # <<<<<<<<<<<<<<
  *         npts_intrm = num_catsources
  *     else:
  */
   __pyx_t_1 = ((__pyx_v_num_catsources < __pyx_v_npts) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":593
+    /* "fastrometry/cython_code/WCS.pyx":572
  * 
  *     if num_catsources < npts:
  *         npts_intrm = num_catsources             # <<<<<<<<<<<<<<
  *     else:
  *         npts_intrm = npts
  */
     __pyx_v_npts_intrm = __pyx_v_num_catsources;
 
-    /* "fastrometry/cython_code/WCS.pyx":592
+    /* "fastrometry/cython_code/WCS.pyx":571
  *     #In that case, we have to use however many points are available.
  * 
  *     if num_catsources < npts:             # <<<<<<<<<<<<<<
  *         npts_intrm = num_catsources
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":595
+  /* "fastrometry/cython_code/WCS.pyx":574
  *         npts_intrm = num_catsources
  *     else:
  *         npts_intrm = npts             # <<<<<<<<<<<<<<
  * 
  *     if num_psesources < npts:
  */
   /*else*/ {
     __pyx_v_npts_intrm = __pyx_v_npts;
   }
   __pyx_L3:;
 
-  /* "fastrometry/cython_code/WCS.pyx":597
+  /* "fastrometry/cython_code/WCS.pyx":576
  *         npts_intrm = npts
  * 
  *     if num_psesources < npts:             # <<<<<<<<<<<<<<
  *         npts_pse = num_psesources
  *     else:
  */
   __pyx_t_1 = ((__pyx_v_num_psesources < __pyx_v_npts) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":598
+    /* "fastrometry/cython_code/WCS.pyx":577
  * 
  *     if num_psesources < npts:
  *         npts_pse = num_psesources             # <<<<<<<<<<<<<<
  *     else:
  *         npts_pse = npts
  */
     __pyx_v_npts_pse = __pyx_v_num_psesources;
 
-    /* "fastrometry/cython_code/WCS.pyx":597
+    /* "fastrometry/cython_code/WCS.pyx":576
  *         npts_intrm = npts
  * 
  *     if num_psesources < npts:             # <<<<<<<<<<<<<<
  *         npts_pse = num_psesources
  *     else:
  */
     goto __pyx_L4;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":600
+  /* "fastrometry/cython_code/WCS.pyx":579
  *         npts_pse = num_psesources
  *     else:
  *         npts_pse = npts             # <<<<<<<<<<<<<<
  * 
  *     cdef:
  */
   /*else*/ {
     __pyx_v_npts_pse = __pyx_v_npts;
   }
   __pyx_L4:;
 
-  /* "fastrometry/cython_code/WCS.pyx":603
+  /* "fastrometry/cython_code/WCS.pyx":582
  * 
  *     cdef:
  *         double[:,:] psepoints_view = pse_metadata_view[:npts_pse,:2]             # <<<<<<<<<<<<<<
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:npts_pse,:2]
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:npts_intrm,:]
  */
   __pyx_t_2.data = __pyx_v_pse_metadata_view.data;
@@ -13053,15 +12446,15 @@
     __pyx_v_npts_pse,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 603, __pyx_L1_error)
+    __PYX_ERR(0, 582, __pyx_L1_error)
 }
 
 if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_2,
     __pyx_v_pse_metadata_view.shape[1], __pyx_v_pse_metadata_view.strides[1], __pyx_v_pse_metadata_view.suboffsets[1],
     1,
     1,
@@ -13070,22 +12463,22 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 603, __pyx_L1_error)
+    __PYX_ERR(0, 582, __pyx_L1_error)
 }
 
 __pyx_v_psepoints_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":604
+  /* "fastrometry/cython_code/WCS.pyx":583
  *     cdef:
  *         double[:,:] psepoints_view = pse_metadata_view[:npts_pse,:2]
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:npts_pse,:2]             # <<<<<<<<<<<<<<
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:npts_intrm,:]
  *         Py_ssize_t i
  */
   __pyx_t_2.data = __pyx_v_pse_metadata_inv_view.data;
@@ -13102,15 +12495,15 @@
     __pyx_v_npts_pse,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 604, __pyx_L1_error)
+    __PYX_ERR(0, 583, __pyx_L1_error)
 }
 
 if (unlikely(__pyx_memoryview_slice_memviewslice(
     &__pyx_t_2,
     __pyx_v_pse_metadata_inv_view.shape[1], __pyx_v_pse_metadata_inv_view.strides[1], __pyx_v_pse_metadata_inv_view.suboffsets[1],
     1,
     1,
@@ -13119,22 +12512,22 @@
     2,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 604, __pyx_L1_error)
+    __PYX_ERR(0, 583, __pyx_L1_error)
 }
 
 __pyx_v_psepoints_inv_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":605
+  /* "fastrometry/cython_code/WCS.pyx":584
  *         double[:,:] psepoints_view = pse_metadata_view[:npts_pse,:2]
  *         double[:,:] psepoints_inv_view = pse_metadata_inv_view[:npts_pse,:2]
  *         double[:,:] intrmpoints_view = allintrmpoints_view[:npts_intrm,:]             # <<<<<<<<<<<<<<
  *         Py_ssize_t i
  *         Py_ssize_t j
  */
   __pyx_t_2.data = __pyx_v_allintrmpoints_view.data;
@@ -13151,430 +12544,430 @@
     __pyx_v_npts_intrm,
     0,
     0,
     1,
     0,
     1) < 0))
 {
-    __PYX_ERR(0, 605, __pyx_L1_error)
+    __PYX_ERR(0, 584, __pyx_L1_error)
 }
 
 __pyx_t_2.shape[1] = __pyx_v_allintrmpoints_view.shape[1];
 __pyx_t_2.strides[1] = __pyx_v_allintrmpoints_view.strides[1];
     __pyx_t_2.suboffsets[1] = -1;
 
 __pyx_v_intrmpoints_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":609
+  /* "fastrometry/cython_code/WCS.pyx":588
  *         Py_ssize_t j
  *         Py_ssize_t k
  *         int nchoose3_pse = int(npts_pse*(npts_pse-1)*(npts_pse-2)/6)             # <<<<<<<<<<<<<<
  *         int nchoose3_intrm = int(npts_intrm*(npts_intrm-1)*(npts_intrm-2)/6)
  *         double S
  */
   __pyx_v_nchoose3_pse = ((int)__Pyx_div_long(((__pyx_v_npts_pse * (__pyx_v_npts_pse - 1)) * (__pyx_v_npts_pse - 2)), 6));
 
-  /* "fastrometry/cython_code/WCS.pyx":610
+  /* "fastrometry/cython_code/WCS.pyx":589
  *         Py_ssize_t k
  *         int nchoose3_pse = int(npts_pse*(npts_pse-1)*(npts_pse-2)/6)
  *         int nchoose3_intrm = int(npts_intrm*(npts_intrm-1)*(npts_intrm-2)/6)             # <<<<<<<<<<<<<<
  *         double S
  *         double S_guess
  */
   __pyx_v_nchoose3_intrm = ((int)__Pyx_div_long(((__pyx_v_npts_intrm * (__pyx_v_npts_intrm - 1)) * (__pyx_v_npts_intrm - 2)), 6));
 
-  /* "fastrometry/cython_code/WCS.pyx":615
+  /* "fastrometry/cython_code/WCS.pyx":594
  *         double S_lb
  *         double S_ub
  *         bint user_rotation = True             # <<<<<<<<<<<<<<
  *         double phi
  *         double phi_guess
  */
   __pyx_v_user_rotation = 1;
 
-  /* "fastrometry/cython_code/WCS.pyx":630
+  /* "fastrometry/cython_code/WCS.pyx":609
  *         double sidelengthtol
  *         int matches
  *         double[:,:] psetriangles_view = np.empty((nchoose3_pse,11),dtype=np.double)             # <<<<<<<<<<<<<<
  *         double[:,:] intrmtriangles_view = np.empty((nchoose3_intrm,11),dtype=np.double)
  *         double intrmlengthBC_lb
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_nchoose3_pse); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_nchoose3_pse); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
   __Pyx_INCREF(__pyx_int_11);
   __Pyx_GIVEREF(__pyx_int_11);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_11);
   __pyx_t_4 = 0;
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_double); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_double); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_8, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_8, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_v_psetriangles_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":631
+  /* "fastrometry/cython_code/WCS.pyx":610
  *         int matches
  *         double[:,:] psetriangles_view = np.empty((nchoose3_pse,11),dtype=np.double)
  *         double[:,:] intrmtriangles_view = np.empty((nchoose3_intrm,11),dtype=np.double)             # <<<<<<<<<<<<<<
  *         double intrmlengthBC_lb
  *         double intrmlengthBC_ub
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_empty); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nchoose3_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_nchoose3_intrm); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_8);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
   __Pyx_INCREF(__pyx_int_11);
   __Pyx_GIVEREF(__pyx_int_11);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_11);
   __pyx_t_8 = 0;
-  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_8 = PyTuple_New(1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_double); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_double); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 631, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_intrmtriangles_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":634
+  /* "fastrometry/cython_code/WCS.pyx":613
  *         double intrmlengthBC_lb
  *         double intrmlengthBC_ub
  *         double[:,:] invtransf_intrmtriangle_view = np.empty((3,2),dtype=np.double)             # <<<<<<<<<<<<<<
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  *         int resultcode = 0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_empty); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_double); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 634, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__14, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__9, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 634, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_invtransf_intrmtriangle_view = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":635
+  /* "fastrometry/cython_code/WCS.pyx":614
  *         double intrmlengthBC_ub
  *         double[:,:] invtransf_intrmtriangle_view = np.empty((3,2),dtype=np.double)
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)             # <<<<<<<<<<<<<<
  *         int resultcode = 0
  *         int prcnt = 0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_empty); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_double); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_double); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_8) < 0) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__7, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__3, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_8, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_8, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 614, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_v_invtransf_intrmpoint_view = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":636
+  /* "fastrometry/cython_code/WCS.pyx":615
  *         double[:,:] invtransf_intrmtriangle_view = np.empty((3,2),dtype=np.double)
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  *         int resultcode = 0             # <<<<<<<<<<<<<<
  *         int prcnt = 0
  * 
  */
   __pyx_v_resultcode = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":637
+  /* "fastrometry/cython_code/WCS.pyx":616
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  *         int resultcode = 0
  *         int prcnt = 0             # <<<<<<<<<<<<<<
  * 
  *     if debug:
  */
   __pyx_v_prcnt = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":639
+  /* "fastrometry/cython_code/WCS.pyx":618
  *         int prcnt = 0
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"psepoints.csv",np.asarray(psepoints_view), delimiter=",")
  *         np.savetxt(debug_report/"psepoints_inverted.csv",np.asarray(psepoints_inv_view), delimiter=",")
  */
   __pyx_t_1 = (__pyx_v_debug != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":640
+    /* "fastrometry/cython_code/WCS.pyx":619
  * 
  *     if debug:
  *         np.savetxt(debug_report/"psepoints.csv",np.asarray(psepoints_view), delimiter=",")             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"psepoints_inverted.csv",np.asarray(psepoints_inv_view), delimiter=",")
  *         np.savetxt(debug_report/"intrmpoints.csv",np.asarray(intrmpoints_view), delimiter=",")
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_psepoints_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_psepoints_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_7 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_10, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_7);
     __pyx_t_8 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 640, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 640, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 640, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 619, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 619, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":641
+    /* "fastrometry/cython_code/WCS.pyx":620
  *     if debug:
  *         np.savetxt(debug_report/"psepoints.csv",np.asarray(psepoints_view), delimiter=",")
  *         np.savetxt(debug_report/"psepoints_inverted.csv",np.asarray(psepoints_inv_view), delimiter=",")             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"intrmpoints.csv",np.asarray(intrmpoints_view), delimiter=",")
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_psepoints_inverted_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_psepoints_inverted_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_psepoints_inv_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_psepoints_inv_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
     __pyx_t_8 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 641, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":642
+    /* "fastrometry/cython_code/WCS.pyx":621
  *         np.savetxt(debug_report/"psepoints.csv",np.asarray(psepoints_view), delimiter=",")
  *         np.savetxt(debug_report/"psepoints_inverted.csv",np.asarray(psepoints_inv_view), delimiter=",")
  *         np.savetxt(debug_report/"intrmpoints.csv",np.asarray(intrmpoints_view), delimiter=",")             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_savetxt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_intrmpoints_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_intrmpoints_csv); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
     __pyx_t_8 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__6) < 0) __PYX_ERR(0, 642, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 642, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_delimiter, __pyx_kp_s__2) < 0) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 621, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":639
+    /* "fastrometry/cython_code/WCS.pyx":618
  *         int prcnt = 0
  * 
  *     if debug:             # <<<<<<<<<<<<<<
  *         np.savetxt(debug_report/"psepoints.csv",np.asarray(psepoints_view), delimiter=",")
  *         np.savetxt(debug_report/"psepoints_inverted.csv",np.asarray(psepoints_inv_view), delimiter=",")
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":644
+  /* "fastrometry/cython_code/WCS.pyx":623
  *         np.savetxt(debug_report/"intrmpoints.csv",np.asarray(intrmpoints_view), delimiter=",")
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         psepoints_xrange = np.ptp(psepoints_view[:,0])
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":645
+    /* "fastrometry/cython_code/WCS.pyx":624
  * 
  *     if verbosity == 2:
  *         psepoints_xrange = np.ptp(psepoints_view[:,0])             # <<<<<<<<<<<<<<
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])
  *         approx_scale = intrmpoints_xrange/psepoints_xrange
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 645, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ptp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 645, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ptp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_9.data = __pyx_v_psepoints_view.data;
     __pyx_t_9.memview = __pyx_v_psepoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
     __pyx_t_9.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_9.strides[0] = __pyx_v_psepoints_view.strides[0];
@@ -13585,20 +12978,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 645, __pyx_L1_error)
+            __PYX_ERR(0, 624, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 645, __pyx_L1_error)
+__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
@@ -13608,30 +13001,30 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_8 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 645, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_psepoints_xrange = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":646
+    /* "fastrometry/cython_code/WCS.pyx":625
  *     if verbosity == 2:
  *         psepoints_xrange = np.ptp(psepoints_view[:,0])
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])             # <<<<<<<<<<<<<<
  *         approx_scale = intrmpoints_xrange/psepoints_xrange
  *         print("| | Approximate scale = {}".format(approx_scale))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 646, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ptp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 646, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ptp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_9.data = __pyx_v_intrmpoints_view.data;
     __pyx_t_9.memview = __pyx_v_intrmpoints_view.memview;
     __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
     __pyx_t_9.shape[0] = __pyx_v_intrmpoints_view.shape[0];
 __pyx_t_9.strides[0] = __pyx_v_intrmpoints_view.strides[0];
@@ -13642,20 +13035,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_intrmpoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_intrmpoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 646, __pyx_L1_error)
+            __PYX_ERR(0, 625, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 646, __pyx_L1_error)
+__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
     __pyx_t_9.memview = NULL;
     __pyx_t_9.data = NULL;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
@@ -13665,101 +13058,101 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_8 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 646, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 625, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_intrmpoints_xrange = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":647
+    /* "fastrometry/cython_code/WCS.pyx":626
  *         psepoints_xrange = np.ptp(psepoints_view[:,0])
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])
  *         approx_scale = intrmpoints_xrange/psepoints_xrange             # <<<<<<<<<<<<<<
  *         print("| | Approximate scale = {}".format(approx_scale))
  * 
  */
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_intrmpoints_xrange, __pyx_v_psepoints_xrange); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 647, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_intrmpoints_xrange, __pyx_v_psepoints_xrange); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_v_approx_scale = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":648
+    /* "fastrometry/cython_code/WCS.pyx":627
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])
  *         approx_scale = intrmpoints_xrange/psepoints_xrange
  *         print("| | Approximate scale = {}".format(approx_scale))             # <<<<<<<<<<<<<<
  * 
  *     S_guess = scale
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Approximate_scale, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Approximate_scale, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_8 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_v_approx_scale) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_approx_scale);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 648, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_8) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_8) < 0) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":644
+    /* "fastrometry/cython_code/WCS.pyx":623
  *         np.savetxt(debug_report/"intrmpoints.csv",np.asarray(intrmpoints_view), delimiter=",")
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         psepoints_xrange = np.ptp(psepoints_view[:,0])
  *         intrmpoints_xrange = np.ptp(intrmpoints_view[:,0])
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":650
+  /* "fastrometry/cython_code/WCS.pyx":629
  *         print("| | Approximate scale = {}".format(approx_scale))
  * 
  *     S_guess = scale             # <<<<<<<<<<<<<<
  *     S_lb = scale/(1+scalebnds)
  *     S_ub = scale*(1+scalebnds)
  */
   __pyx_v_S_guess = __pyx_v_scale;
 
-  /* "fastrometry/cython_code/WCS.pyx":651
+  /* "fastrometry/cython_code/WCS.pyx":630
  * 
  *     S_guess = scale
  *     S_lb = scale/(1+scalebnds)             # <<<<<<<<<<<<<<
  *     S_ub = scale*(1+scalebnds)
  *     if rotation is None and rotationbnds is None:
  */
   __pyx_t_11 = (1.0 + __pyx_v_scalebnds);
   if (unlikely(__pyx_t_11 == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 651, __pyx_L1_error)
+    __PYX_ERR(0, 630, __pyx_L1_error)
   }
   __pyx_v_S_lb = (__pyx_v_scale / __pyx_t_11);
 
-  /* "fastrometry/cython_code/WCS.pyx":652
+  /* "fastrometry/cython_code/WCS.pyx":631
  *     S_guess = scale
  *     S_lb = scale/(1+scalebnds)
  *     S_ub = scale*(1+scalebnds)             # <<<<<<<<<<<<<<
  *     if rotation is None and rotationbnds is None:
  *         user_rotation = False
  */
   __pyx_v_S_ub = (__pyx_v_scale * (1.0 + __pyx_v_scalebnds));
 
-  /* "fastrometry/cython_code/WCS.pyx":653
+  /* "fastrometry/cython_code/WCS.pyx":632
  *     S_lb = scale/(1+scalebnds)
  *     S_ub = scale*(1+scalebnds)
  *     if rotation is None and rotationbnds is None:             # <<<<<<<<<<<<<<
  *         user_rotation = False
  *         phi_guess = 0       ###these variables will be properly declared later
  */
   __pyx_t_12 = (__pyx_v_rotation == Py_None);
@@ -13771,61 +13164,61 @@
   }
   __pyx_t_13 = (__pyx_v_rotationbnds == Py_None);
   __pyx_t_12 = (__pyx_t_13 != 0);
   __pyx_t_1 = __pyx_t_12;
   __pyx_L8_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":654
+    /* "fastrometry/cython_code/WCS.pyx":633
  *     S_ub = scale*(1+scalebnds)
  *     if rotation is None and rotationbnds is None:
  *         user_rotation = False             # <<<<<<<<<<<<<<
  *         phi_guess = 0       ###these variables will be properly declared later
  *         phi_lb = 0
  */
     __pyx_v_user_rotation = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":655
+    /* "fastrometry/cython_code/WCS.pyx":634
  *     if rotation is None and rotationbnds is None:
  *         user_rotation = False
  *         phi_guess = 0       ###these variables will be properly declared later             # <<<<<<<<<<<<<<
  *         phi_lb = 0
  *         phi_ub = 0
  */
     __pyx_v_phi_guess = 0.0;
 
-    /* "fastrometry/cython_code/WCS.pyx":656
+    /* "fastrometry/cython_code/WCS.pyx":635
  *         user_rotation = False
  *         phi_guess = 0       ###these variables will be properly declared later
  *         phi_lb = 0             # <<<<<<<<<<<<<<
  *         phi_ub = 0
  *     elif rotation is not None and rotationbnds is not None:
  */
     __pyx_v_phi_lb = 0.0;
 
-    /* "fastrometry/cython_code/WCS.pyx":657
+    /* "fastrometry/cython_code/WCS.pyx":636
  *         phi_guess = 0       ###these variables will be properly declared later
  *         phi_lb = 0
  *         phi_ub = 0             # <<<<<<<<<<<<<<
  *     elif rotation is not None and rotationbnds is not None:
  *         phi_guess = rotation
  */
     __pyx_v_phi_ub = 0.0;
 
-    /* "fastrometry/cython_code/WCS.pyx":653
+    /* "fastrometry/cython_code/WCS.pyx":632
  *     S_lb = scale/(1+scalebnds)
  *     S_ub = scale*(1+scalebnds)
  *     if rotation is None and rotationbnds is None:             # <<<<<<<<<<<<<<
  *         user_rotation = False
  *         phi_guess = 0       ###these variables will be properly declared later
  */
     goto __pyx_L7;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":658
+  /* "fastrometry/cython_code/WCS.pyx":637
  *         phi_lb = 0
  *         phi_ub = 0
  *     elif rotation is not None and rotationbnds is not None:             # <<<<<<<<<<<<<<
  *         phi_guess = rotation
  *         phi_lb = rotation-rotationbnds-vertextol
  */
   __pyx_t_12 = (__pyx_v_rotation != Py_None);
@@ -13837,73 +13230,73 @@
   }
   __pyx_t_13 = (__pyx_v_rotationbnds != Py_None);
   __pyx_t_12 = (__pyx_t_13 != 0);
   __pyx_t_1 = __pyx_t_12;
   __pyx_L10_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":659
+    /* "fastrometry/cython_code/WCS.pyx":638
  *         phi_ub = 0
  *     elif rotation is not None and rotationbnds is not None:
  *         phi_guess = rotation             # <<<<<<<<<<<<<<
  *         phi_lb = rotation-rotationbnds-vertextol
  *         phi_ub = rotation+rotationbnds+vertextol
  */
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_rotation); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 659, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_rotation); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 638, __pyx_L1_error)
     __pyx_v_phi_guess = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":660
+    /* "fastrometry/cython_code/WCS.pyx":639
  *     elif rotation is not None and rotationbnds is not None:
  *         phi_guess = rotation
  *         phi_lb = rotation-rotationbnds-vertextol             # <<<<<<<<<<<<<<
  *         phi_ub = rotation+rotationbnds+vertextol
  *     elif rotation is None and rotationbnds is not None:
  */
-    __pyx_t_8 = PyNumber_Subtract(__pyx_v_rotation, __pyx_v_rotationbnds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 660, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_v_rotation, __pyx_v_rotationbnds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = PyNumber_Subtract(__pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 660, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 660, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_phi_lb = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":661
+    /* "fastrometry/cython_code/WCS.pyx":640
  *         phi_guess = rotation
  *         phi_lb = rotation-rotationbnds-vertextol
  *         phi_ub = rotation+rotationbnds+vertextol             # <<<<<<<<<<<<<<
  *     elif rotation is None and rotationbnds is not None:
  *         phi_guess = 0
  */
-    __pyx_t_6 = PyNumber_Add(__pyx_v_rotation, __pyx_v_rotationbnds); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_v_rotation, __pyx_v_rotationbnds); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 640, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_v_phi_ub = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":658
+    /* "fastrometry/cython_code/WCS.pyx":637
  *         phi_lb = 0
  *         phi_ub = 0
  *     elif rotation is not None and rotationbnds is not None:             # <<<<<<<<<<<<<<
  *         phi_guess = rotation
  *         phi_lb = rotation-rotationbnds-vertextol
  */
     goto __pyx_L7;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":662
+  /* "fastrometry/cython_code/WCS.pyx":641
  *         phi_lb = rotation-rotationbnds-vertextol
  *         phi_ub = rotation+rotationbnds+vertextol
  *     elif rotation is None and rotationbnds is not None:             # <<<<<<<<<<<<<<
  *         phi_guess = 0
  *         phi_lb = 0-rotationbnds-vertextol
  */
   __pyx_t_12 = (__pyx_v_rotation == Py_None);
@@ -13915,72 +13308,72 @@
   }
   __pyx_t_13 = (__pyx_v_rotationbnds != Py_None);
   __pyx_t_12 = (__pyx_t_13 != 0);
   __pyx_t_1 = __pyx_t_12;
   __pyx_L12_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":663
+    /* "fastrometry/cython_code/WCS.pyx":642
  *         phi_ub = rotation+rotationbnds+vertextol
  *     elif rotation is None and rotationbnds is not None:
  *         phi_guess = 0             # <<<<<<<<<<<<<<
  *         phi_lb = 0-rotationbnds-vertextol
  *         phi_ub = 0+rotationbnds+vertextol
  */
     __pyx_v_phi_guess = 0.0;
 
-    /* "fastrometry/cython_code/WCS.pyx":664
+    /* "fastrometry/cython_code/WCS.pyx":643
  *     elif rotation is None and rotationbnds is not None:
  *         phi_guess = 0
  *         phi_lb = 0-rotationbnds-vertextol             # <<<<<<<<<<<<<<
  *         phi_ub = 0+rotationbnds+vertextol
  *     elif rotation is not None and rotationbnds is None:
  */
-    __pyx_t_8 = __Pyx_PyInt_SubtractCObj(__pyx_int_0, __pyx_v_rotationbnds, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_SubtractCObj(__pyx_int_0, __pyx_v_rotationbnds, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 643, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 643, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_6 = PyNumber_Subtract(__pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_8, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 643, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 664, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 643, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_phi_lb = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":665
+    /* "fastrometry/cython_code/WCS.pyx":644
  *         phi_guess = 0
  *         phi_lb = 0-rotationbnds-vertextol
  *         phi_ub = 0+rotationbnds+vertextol             # <<<<<<<<<<<<<<
  *     elif rotation is not None and rotationbnds is None:
  *         phi_guess = rotation
  */
-    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_0, __pyx_v_rotationbnds, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 665, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_0, __pyx_v_rotationbnds, 0, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 665, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 665, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 665, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_v_phi_ub = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":662
+    /* "fastrometry/cython_code/WCS.pyx":641
  *         phi_lb = rotation-rotationbnds-vertextol
  *         phi_ub = rotation+rotationbnds+vertextol
  *     elif rotation is None and rotationbnds is not None:             # <<<<<<<<<<<<<<
  *         phi_guess = 0
  *         phi_lb = 0-rotationbnds-vertextol
  */
     goto __pyx_L7;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":666
+  /* "fastrometry/cython_code/WCS.pyx":645
  *         phi_lb = 0-rotationbnds-vertextol
  *         phi_ub = 0+rotationbnds+vertextol
  *     elif rotation is not None and rotationbnds is None:             # <<<<<<<<<<<<<<
  *         phi_guess = rotation
  *         phi_lb = rotation-10*pi/180-vertextol
  */
   __pyx_t_12 = (__pyx_v_rotation != Py_None);
@@ -13992,88 +13385,88 @@
   }
   __pyx_t_13 = (__pyx_v_rotationbnds == Py_None);
   __pyx_t_12 = (__pyx_t_13 != 0);
   __pyx_t_1 = __pyx_t_12;
   __pyx_L14_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":667
+    /* "fastrometry/cython_code/WCS.pyx":646
  *         phi_ub = 0+rotationbnds+vertextol
  *     elif rotation is not None and rotationbnds is None:
  *         phi_guess = rotation             # <<<<<<<<<<<<<<
  *         phi_lb = rotation-10*pi/180-vertextol
  *         phi_ub = rotation+10*pi/180+vertextol
  */
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_rotation); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 667, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_v_rotation); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 646, __pyx_L1_error)
     __pyx_v_phi_guess = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":668
+    /* "fastrometry/cython_code/WCS.pyx":647
  *     elif rotation is not None and rotationbnds is None:
  *         phi_guess = rotation
  *         phi_lb = rotation-10*pi/180-vertextol             # <<<<<<<<<<<<<<
  *         phi_ub = rotation+10*pi/180+vertextol
  *     CRPIXx_guess = np.mean(psepoints_inv_view[:,0])
  */
-    __pyx_t_8 = PyFloat_FromDouble(((10.0 * M_PI) / 180.0)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 668, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(((10.0 * M_PI) / 180.0)); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 647, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = PyNumber_Subtract(__pyx_v_rotation, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 668, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_v_rotation, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 647, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 668, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 647, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = PyNumber_Subtract(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 668, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 647, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 668, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 647, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_v_phi_lb = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":669
+    /* "fastrometry/cython_code/WCS.pyx":648
  *         phi_guess = rotation
  *         phi_lb = rotation-10*pi/180-vertextol
  *         phi_ub = rotation+10*pi/180+vertextol             # <<<<<<<<<<<<<<
  *     CRPIXx_guess = np.mean(psepoints_inv_view[:,0])
  *     CRPIXy_guess = np.mean(psepoints_inv_view[:,1])
  */
-    __pyx_t_6 = PyFloat_FromDouble(((10.0 * M_PI) / 180.0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(((10.0 * M_PI) / 180.0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 648, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyNumber_Add(__pyx_v_rotation, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_v_rotation, __pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 648, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_6 = PyFloat_FromDouble(__pyx_v_vertextol); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 648, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 669, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 648, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_phi_ub = __pyx_t_11;
 
-    /* "fastrometry/cython_code/WCS.pyx":666
+    /* "fastrometry/cython_code/WCS.pyx":645
  *         phi_lb = 0-rotationbnds-vertextol
  *         phi_ub = 0+rotationbnds+vertextol
  *     elif rotation is not None and rotationbnds is None:             # <<<<<<<<<<<<<<
  *         phi_guess = rotation
  *         phi_lb = rotation-10*pi/180-vertextol
  */
   }
   __pyx_L7:;
 
-  /* "fastrometry/cython_code/WCS.pyx":670
+  /* "fastrometry/cython_code/WCS.pyx":649
  *         phi_lb = rotation-10*pi/180-vertextol
  *         phi_ub = rotation+10*pi/180+vertextol
  *     CRPIXx_guess = np.mean(psepoints_inv_view[:,0])             # <<<<<<<<<<<<<<
  *     CRPIXy_guess = np.mean(psepoints_inv_view[:,1])
  *     CRPIXx_lb = 1
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 670, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_9.data = __pyx_v_psepoints_inv_view.data;
   __pyx_t_9.memview = __pyx_v_psepoints_inv_view.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
   __pyx_t_9.shape[0] = __pyx_v_psepoints_inv_view.shape[0];
 __pyx_t_9.strides[0] = __pyx_v_psepoints_inv_view.strides[0];
@@ -14084,20 +13477,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_inv_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_inv_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 670, __pyx_L1_error)
+            __PYX_ERR(0, 649, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)
+__pyx_t_6 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_8);
@@ -14107,31 +13500,31 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 670, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 670, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CRPIXx_guess = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":671
+  /* "fastrometry/cython_code/WCS.pyx":650
  *         phi_ub = rotation+10*pi/180+vertextol
  *     CRPIXx_guess = np.mean(psepoints_inv_view[:,0])
  *     CRPIXy_guess = np.mean(psepoints_inv_view[:,1])             # <<<<<<<<<<<<<<
  *     CRPIXx_lb = 1
  *     CRPIXx_ub = img_xmax
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_t_9.data = __pyx_v_psepoints_inv_view.data;
   __pyx_t_9.memview = __pyx_v_psepoints_inv_view.memview;
   __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
   __pyx_t_9.shape[0] = __pyx_v_psepoints_inv_view.shape[0];
 __pyx_t_9.strides[0] = __pyx_v_psepoints_inv_view.strides[0];
@@ -14142,20 +13535,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_inv_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_inv_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 671, __pyx_L1_error)
+            __PYX_ERR(0, 650, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 671, __pyx_L1_error)
+__pyx_t_8 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
@@ -14165,507 +13558,507 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 671, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 650, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CRPIXy_guess = __pyx_t_11;
 
-  /* "fastrometry/cython_code/WCS.pyx":672
+  /* "fastrometry/cython_code/WCS.pyx":651
  *     CRPIXx_guess = np.mean(psepoints_inv_view[:,0])
  *     CRPIXy_guess = np.mean(psepoints_inv_view[:,1])
  *     CRPIXx_lb = 1             # <<<<<<<<<<<<<<
  *     CRPIXx_ub = img_xmax
  *     CRPIXy_lb = 1
  */
   __pyx_v_CRPIXx_lb = 1.0;
 
-  /* "fastrometry/cython_code/WCS.pyx":673
+  /* "fastrometry/cython_code/WCS.pyx":652
  *     CRPIXy_guess = np.mean(psepoints_inv_view[:,1])
  *     CRPIXx_lb = 1
  *     CRPIXx_ub = img_xmax             # <<<<<<<<<<<<<<
  *     CRPIXy_lb = 1
  *     CRPIXy_ub = img_ymax
  */
   __pyx_v_CRPIXx_ub = __pyx_v_img_xmax;
 
-  /* "fastrometry/cython_code/WCS.pyx":674
+  /* "fastrometry/cython_code/WCS.pyx":653
  *     CRPIXx_lb = 1
  *     CRPIXx_ub = img_xmax
  *     CRPIXy_lb = 1             # <<<<<<<<<<<<<<
  *     CRPIXy_ub = img_ymax
  * 
  */
   __pyx_v_CRPIXy_lb = 1.0;
 
-  /* "fastrometry/cython_code/WCS.pyx":675
+  /* "fastrometry/cython_code/WCS.pyx":654
  *     CRPIXx_ub = img_xmax
  *     CRPIXy_lb = 1
  *     CRPIXy_ub = img_ymax             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
   __pyx_v_CRPIXy_ub = __pyx_v_img_ymax;
 
-  /* "fastrometry/cython_code/WCS.pyx":677
+  /* "fastrometry/cython_code/WCS.pyx":656
  *     CRPIXy_ub = img_ymax
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | S_guess = {}".format(S_guess))
  *         print("| | S_lb = {}".format(S_lb))
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":678
+    /* "fastrometry/cython_code/WCS.pyx":657
  * 
  *     if verbosity == 2:
  *         print("| | S_guess = {}".format(S_guess))             # <<<<<<<<<<<<<<
  *         print("| | S_lb = {}".format(S_lb))
  *         print("| | S_ub = {}".format(S_ub))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 678, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 657, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 657, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 678, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 657, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":679
+    /* "fastrometry/cython_code/WCS.pyx":658
  *     if verbosity == 2:
  *         print("| | S_guess = {}".format(S_guess))
  *         print("| | S_lb = {}".format(S_lb))             # <<<<<<<<<<<<<<
  *         print("| | S_ub = {}".format(S_ub))
  *         if user_rotation is False:
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 679, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 658, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 679, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 658, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 679, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 658, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 679, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 658, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":680
+    /* "fastrometry/cython_code/WCS.pyx":659
  *         print("| | S_guess = {}".format(S_guess))
  *         print("| | S_lb = {}".format(S_lb))
  *         print("| | S_ub = {}".format(S_ub))             # <<<<<<<<<<<<<<
  *         if user_rotation is False:
  *             print("| | phi_guess = TBD in loop")
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_S_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 659, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 680, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 659, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 659, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 680, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 659, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":681
+    /* "fastrometry/cython_code/WCS.pyx":660
  *         print("| | S_lb = {}".format(S_lb))
  *         print("| | S_ub = {}".format(S_ub))
  *         if user_rotation is False:             # <<<<<<<<<<<<<<
  *             print("| | phi_guess = TBD in loop")
  *             print("| | phi_lb = TBD in loop")
  */
     __pyx_t_1 = ((__pyx_v_user_rotation == 0) != 0);
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":682
+      /* "fastrometry/cython_code/WCS.pyx":661
  *         print("| | S_ub = {}".format(S_ub))
  *         if user_rotation is False:
  *             print("| | phi_guess = TBD in loop")             # <<<<<<<<<<<<<<
  *             print("| | phi_lb = TBD in loop")
  *             print("| | phi_ub = TBD in loop")
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_guess_TBD_in_loop) < 0) __PYX_ERR(0, 682, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_guess_TBD_in_loop) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":683
+      /* "fastrometry/cython_code/WCS.pyx":662
  *         if user_rotation is False:
  *             print("| | phi_guess = TBD in loop")
  *             print("| | phi_lb = TBD in loop")             # <<<<<<<<<<<<<<
  *             print("| | phi_ub = TBD in loop")
  *         else:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_lb_TBD_in_loop) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_lb_TBD_in_loop) < 0) __PYX_ERR(0, 662, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":684
+      /* "fastrometry/cython_code/WCS.pyx":663
  *             print("| | phi_guess = TBD in loop")
  *             print("| | phi_lb = TBD in loop")
  *             print("| | phi_ub = TBD in loop")             # <<<<<<<<<<<<<<
  *         else:
  *             print("| | phi_guess = {}".format(phi_guess))
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_ub_TBD_in_loop) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_phi_ub_TBD_in_loop) < 0) __PYX_ERR(0, 663, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":681
+      /* "fastrometry/cython_code/WCS.pyx":660
  *         print("| | S_lb = {}".format(S_lb))
  *         print("| | S_ub = {}".format(S_ub))
  *         if user_rotation is False:             # <<<<<<<<<<<<<<
  *             print("| | phi_guess = TBD in loop")
  *             print("| | phi_lb = TBD in loop")
  */
       goto __pyx_L17;
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":686
+    /* "fastrometry/cython_code/WCS.pyx":665
  *             print("| | phi_ub = TBD in loop")
  *         else:
  *             print("| | phi_guess = {}".format(phi_guess))             # <<<<<<<<<<<<<<
  *             print("| | phi_lb = {}".format(phi_lb))
  *             print("| | phi_ub = {}".format(phi_ub))
  */
     /*else*/ {
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 686, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 686, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 686, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 665, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":687
+      /* "fastrometry/cython_code/WCS.pyx":666
  *         else:
  *             print("| | phi_guess = {}".format(phi_guess))
  *             print("| | phi_lb = {}".format(phi_lb))             # <<<<<<<<<<<<<<
  *             print("| | phi_ub = {}".format(phi_ub))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 687, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 687, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 666, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 666, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 687, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 666, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "fastrometry/cython_code/WCS.pyx":688
+      /* "fastrometry/cython_code/WCS.pyx":667
  *             print("| | phi_guess = {}".format(phi_guess))
  *             print("| | phi_lb = {}".format(phi_lb))
  *             print("| | phi_ub = {}".format(phi_ub))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  *         print("| | CRPIXx_lb = {}".format(CRPIXx_lb))
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_phi_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 688, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_phi_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_5);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 688, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __pyx_L17:;
 
-    /* "fastrometry/cython_code/WCS.pyx":689
+    /* "fastrometry/cython_code/WCS.pyx":668
  *             print("| | phi_lb = {}".format(phi_lb))
  *             print("| | phi_ub = {}".format(phi_ub))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXx_lb = {}".format(CRPIXx_lb))
  *         print("| | CRPIXx_ub = {}".format(CRPIXx_ub))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 668, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 689, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 668, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 668, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 689, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 668, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":690
+    /* "fastrometry/cython_code/WCS.pyx":669
  *             print("| | phi_ub = {}".format(phi_ub))
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  *         print("| | CRPIXx_lb = {}".format(CRPIXx_lb))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXx_ub = {}".format(CRPIXx_ub))
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 669, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 690, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 669, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 669, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 690, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":691
+    /* "fastrometry/cython_code/WCS.pyx":670
  *         print("| | CRPIXx_guess = {}".format(CRPIXx_guess))
  *         print("| | CRPIXx_lb = {}".format(CRPIXx_lb))
  *         print("| | CRPIXx_ub = {}".format(CRPIXx_ub))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  *         print("| | CRPIXy_lb = {}".format(CRPIXy_lb))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXx_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 670, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXx_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 670, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 670, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 670, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":692
+    /* "fastrometry/cython_code/WCS.pyx":671
  *         print("| | CRPIXx_lb = {}".format(CRPIXx_lb))
  *         print("| | CRPIXx_ub = {}".format(CRPIXx_ub))
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXy_lb = {}".format(CRPIXy_lb))
  *         print("| | CRPIXy_ub = {}".format(CRPIXy_ub))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_guess, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 692, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 671, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":693
+    /* "fastrometry/cython_code/WCS.pyx":672
  *         print("| | CRPIXx_ub = {}".format(CRPIXx_ub))
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  *         print("| | CRPIXy_lb = {}".format(CRPIXy_lb))             # <<<<<<<<<<<<<<
  *         print("| | CRPIXy_ub = {}".format(CRPIXy_ub))
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_lb, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 693, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 693, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 672, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":694
+    /* "fastrometry/cython_code/WCS.pyx":673
  *         print("| | CRPIXy_guess = {}".format(CRPIXy_guess))
  *         print("| | CRPIXy_lb = {}".format(CRPIXy_lb))
  *         print("| | CRPIXy_ub = {}".format(CRPIXy_ub))             # <<<<<<<<<<<<<<
  * 
  *     guess = np.array([S_guess, phi_guess, CRPIXx_guess, CRPIXy_guess])
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIXy_ub, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 673, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 694, __pyx_L1_error)
+    __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 673, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 694, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 673, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 694, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 673, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":677
+    /* "fastrometry/cython_code/WCS.pyx":656
  *     CRPIXy_ub = img_ymax
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | S_guess = {}".format(S_guess))
  *         print("| | S_lb = {}".format(S_lb))
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":696
+  /* "fastrometry/cython_code/WCS.pyx":675
  *         print("| | CRPIXy_ub = {}".format(CRPIXy_ub))
  * 
  *     guess = np.array([S_guess, phi_guess, CRPIXx_guess, CRPIXy_guess])             # <<<<<<<<<<<<<<
  *     bnds = np.array([[S_lb,phi_lb,CRPIXx_lb,CRPIXy_lb],[S_ub,phi_ub,CRPIXx_ub,CRPIXy_ub]])
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyFloat_FromDouble(__pyx_v_S_guess); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_6 = PyFloat_FromDouble(__pyx_v_S_guess); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_phi_guess); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_phi_guess); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_14 = PyList_New(4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_14 = PyList_New(4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_GIVEREF(__pyx_t_6);
   PyList_SET_ITEM(__pyx_t_14, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_5);
   PyList_SET_ITEM(__pyx_t_14, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_7);
   PyList_SET_ITEM(__pyx_t_14, 2, __pyx_t_7);
@@ -14684,77 +14077,77 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_4 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_10, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_14);
   __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 675, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_v_guess = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":697
+  /* "fastrometry/cython_code/WCS.pyx":676
  * 
  *     guess = np.array([S_guess, phi_guess, CRPIXx_guess, CRPIXy_guess])
  *     bnds = np.array([[S_lb,phi_lb,CRPIXx_lb,CRPIXy_lb],[S_ub,phi_ub,CRPIXx_ub,CRPIXy_ub]])             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_array); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_14);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_S_lb); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_phi_lb); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_phi_lb); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CRPIXx_lb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_CRPIXx_lb); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_CRPIXy_lb); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_CRPIXy_lb); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyList_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_6 = PyList_New(4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_8);
   PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_10);
   PyList_SET_ITEM(__pyx_t_6, 1, __pyx_t_10);
   __Pyx_GIVEREF(__pyx_t_7);
   PyList_SET_ITEM(__pyx_t_6, 2, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_5);
   PyList_SET_ITEM(__pyx_t_6, 3, __pyx_t_5);
   __pyx_t_8 = 0;
   __pyx_t_10 = 0;
   __pyx_t_7 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_S_ub); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_S_ub); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_phi_ub); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_phi_ub); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_CRPIXx_ub); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_10 = PyFloat_FromDouble(__pyx_v_CRPIXx_ub); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
-  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_8 = PyFloat_FromDouble(__pyx_v_CRPIXy_ub); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_15 = PyList_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_15 = PyList_New(4); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_15);
   __Pyx_GIVEREF(__pyx_t_5);
   PyList_SET_ITEM(__pyx_t_15, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_7);
   PyList_SET_ITEM(__pyx_t_15, 1, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_10);
   PyList_SET_ITEM(__pyx_t_15, 2, __pyx_t_10);
   __Pyx_GIVEREF(__pyx_t_8);
   PyList_SET_ITEM(__pyx_t_15, 3, __pyx_t_8);
   __pyx_t_5 = 0;
   __pyx_t_7 = 0;
   __pyx_t_10 = 0;
   __pyx_t_8 = 0;
-  __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_8 = PyList_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_6);
   PyList_SET_ITEM(__pyx_t_8, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_15);
   PyList_SET_ITEM(__pyx_t_8, 1, __pyx_t_15);
   __pyx_t_6 = 0;
   __pyx_t_15 = 0;
@@ -14767,42 +14160,42 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_14, function);
     }
   }
   __pyx_t_4 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_15, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 676, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
   __pyx_v_bnds = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":699
+  /* "fastrometry/cython_code/WCS.pyx":678
  *     bnds = np.array([[S_lb,phi_lb,CRPIXx_lb,CRPIXy_lb],[S_ub,phi_ub,CRPIXx_ub,CRPIXy_ub]])
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(npts_pse,npts_intrm))
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":700
+    /* "fastrometry/cython_code/WCS.pyx":679
  * 
  *     if verbosity >= 1:
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(npts_pse,npts_intrm))             # <<<<<<<<<<<<<<
  * 
  *     if debug and npts_intrm >= 10 and npts_pse >= 10:
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_working_with_PSE_sources_and_ca, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 700, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_working_with_PSE_sources_and_ca, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 679, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_npts_pse); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 700, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_npts_pse); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 679, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 700, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 679, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_6 = NULL;
     __pyx_t_3 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
@@ -14811,61 +14204,61 @@
         __Pyx_DECREF_SET(__pyx_t_14, function);
         __pyx_t_3 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_14)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_8, __pyx_t_15};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 679, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_14)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_t_8, __pyx_t_15};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 679, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 700, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 679, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       if (__pyx_t_6) {
         __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_6); __pyx_t_6 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_3, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_15);
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_3, __pyx_t_15);
       __pyx_t_8 = 0;
       __pyx_t_15 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 700, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 679, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 700, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 679, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":699
+    /* "fastrometry/cython_code/WCS.pyx":678
  *     bnds = np.array([[S_lb,phi_lb,CRPIXx_lb,CRPIXy_lb],[S_ub,phi_ub,CRPIXx_ub,CRPIXy_ub]])
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(npts_pse,npts_intrm))
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":702
+  /* "fastrometry/cython_code/WCS.pyx":681
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(npts_pse,npts_intrm))
  * 
  *     if debug and npts_intrm >= 10 and npts_pse >= 10:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   __pyx_t_12 = (__pyx_v_debug != 0);
@@ -14881,450 +14274,450 @@
     goto __pyx_L20_bool_binop_done;
   }
   __pyx_t_12 = ((__pyx_v_npts_pse >= 10) != 0);
   __pyx_t_1 = __pyx_t_12;
   __pyx_L20_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":703
+    /* "fastrometry/cython_code/WCS.pyx":682
  * 
  *     if debug and npts_intrm >= 10 and npts_pse >= 10:
  *         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  */
-    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 682, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_INCREF(__pyx_n_s__8);
-    __Pyx_GIVEREF(__pyx_n_s__8);
-    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s__8);
-    __pyx_t_14 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_4, -1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 703, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_n_s__4);
+    __Pyx_GIVEREF(__pyx_n_s__4);
+    PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s__4);
+    __pyx_t_14 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_4, -1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 682, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_plt = __pyx_t_14;
     __pyx_t_14 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":704
+    /* "fastrometry/cython_code/WCS.pyx":683
  *     if debug and npts_intrm >= 10 and npts_pse >= 10:
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  */
-    __pyx_t_14 = PyList_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 704, __pyx_L1_error)
+    __pyx_t_14 = PyList_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_INCREF(__pyx_n_s_LogNorm);
     __Pyx_GIVEREF(__pyx_n_s_LogNorm);
     PyList_SET_ITEM(__pyx_t_14, 0, __pyx_n_s_LogNorm);
-    __pyx_t_4 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_14, -1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 704, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_14, -1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 704, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_INCREF(__pyx_t_14);
     __pyx_v_LogNorm = __pyx_t_14;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":705
+    /* "fastrometry/cython_code/WCS.pyx":684
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits             # <<<<<<<<<<<<<<
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(15,7.5))
  */
-    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_n_s_fits);
     __Pyx_GIVEREF(__pyx_n_s_fits);
     PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_fits);
-    __pyx_t_14 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_4, -1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_4, -1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 684, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_14, __pyx_n_s_fits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 705, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_14, __pyx_n_s_fits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_4);
     __pyx_v_fits = __pyx_t_4;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":706
+    /* "fastrometry/cython_code/WCS.pyx":685
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)             # <<<<<<<<<<<<<<
  *         fig = plt.figure(figsize=(15,7.5))
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 706, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fits, __pyx_n_s_getdata); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_10);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_14 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_10, __pyx_v_filepath) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_filepath);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 706, __pyx_L1_error)
+    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_image_data = __pyx_t_14;
     __pyx_t_14 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":707
+    /* "fastrometry/cython_code/WCS.pyx":686
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(15,7.5))             # <<<<<<<<<<<<<<
  * 
  *         axes1 = fig.add_subplot(121)
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 707, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_figsize, __pyx_tuple__15) < 0) __PYX_ERR(0, 707, __pyx_L1_error)
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 707, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_figsize, __pyx_tuple__10) < 0) __PYX_ERR(0, 686, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_fig = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":709
+    /* "fastrometry/cython_code/WCS.pyx":688
  *         fig = plt.figure(figsize=(15,7.5))
  * 
  *         axes1 = fig.add_subplot(121)             # <<<<<<<<<<<<<<
  *         axes1.set_title('10 brightest PSE and intermediate points')
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 709, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_10 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_14, __pyx_int_121) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_int_121);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 709, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 688, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_axes1 = __pyx_t_10;
     __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":710
+    /* "fastrometry/cython_code/WCS.pyx":689
  * 
  *         axes1 = fig.add_subplot(121)
  *         axes1.set_title('10 brightest PSE and intermediate points')             # <<<<<<<<<<<<<<
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes1.scatter(np.asarray(psepoints_view)[:10,0], np.asarray(psepoints_view)[:10,1], marker=".", c="blue")
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_set_title); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 710, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_set_title); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_14 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_14);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_10 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_14, __pyx_kp_s_10_brightest_PSE_and_intermediat) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_kp_s_10_brightest_PSE_and_intermediat);
     __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 710, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 689, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":711
+    /* "fastrometry/cython_code/WCS.pyx":690
  *         axes1 = fig.add_subplot(121)
  *         axes1.set_title('10 brightest PSE and intermediate points')
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *         axes1.scatter(np.asarray(psepoints_view)[:10,0], np.asarray(psepoints_view)[:10,1], marker=".", c="blue")
  *         axes1.scatter(img_xmax-np.asarray(intrmpoints_view)[:10,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:10,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_imshow); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_imshow); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_image_data);
     __Pyx_GIVEREF(__pyx_v_image_data);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_image_data);
-    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_INCREF(__pyx_v_LogNorm);
     __pyx_t_8 = __pyx_v_LogNorm; __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_15 = (__pyx_t_6) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_6) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 711, __pyx_L1_error)
+    if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_norm, __pyx_t_15) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_norm, __pyx_t_15) < 0) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 711, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 690, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":712
+    /* "fastrometry/cython_code/WCS.pyx":691
  *         axes1.set_title('10 brightest PSE and intermediate points')
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes1.scatter(np.asarray(psepoints_view)[:10,0], np.asarray(psepoints_view)[:10,1], marker=".", c="blue")             # <<<<<<<<<<<<<<
  *         axes1.scatter(img_xmax-np.asarray(intrmpoints_view)[:10,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:10,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  */
-    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_scatter); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_scatter); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_10, function);
       }
     }
     __pyx_t_14 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_8, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 712, __pyx_L1_error)
+    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__17); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_14 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_6, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 712, __pyx_L1_error)
+    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__18); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__13); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_GIVEREF(__pyx_t_10);
     PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_10);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_t_8);
     __pyx_t_10 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 712, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_c, __pyx_n_s_blue) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 712, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_8, __pyx_n_s_c, __pyx_n_s_blue) < 0) __PYX_ERR(0, 691, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_15, __pyx_t_14, __pyx_t_8); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 691, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":713
+    /* "fastrometry/cython_code/WCS.pyx":692
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes1.scatter(np.asarray(psepoints_view)[:10,0], np.asarray(psepoints_view)[:10,1], marker=".", c="blue")
  *         axes1.scatter(img_xmax-np.asarray(intrmpoints_view)[:10,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:10,1]/approx_scale-CRPIXy_guess, marker=".", c="red")             # <<<<<<<<<<<<<<
  * 
  *         axes2 = fig.add_subplot(122)
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_scatter); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes1, __pyx_n_s_scatter); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_asarray); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    __pyx_t_15 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_15 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_14 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_15) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_15);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__17); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__12); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 713, __pyx_L1_error) }
-    __pyx_t_14 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_v_approx_scale); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 692, __pyx_L1_error) }
+    __pyx_t_14 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_v_approx_scale); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_8, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_8, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_8 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_15, __pyx_n_s_np); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_15, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    __pyx_t_15 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_15 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_15) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_15);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__13); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 713, __pyx_L1_error) }
-    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_v_approx_scale); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 692, __pyx_L1_error) }
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_v_approx_scale); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_14 = PyNumber_Subtract(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_14 = PyNumber_Subtract(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_14);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_14);
     __pyx_t_8 = 0;
     __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 713, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 713, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_c, __pyx_n_s_red) < 0) __PYX_ERR(0, 713, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 713, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_c, __pyx_n_s_red) < 0) __PYX_ERR(0, 692, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 692, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":715
+    /* "fastrometry/cython_code/WCS.pyx":694
  *         axes1.scatter(img_xmax-np.asarray(intrmpoints_view)[:10,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:10,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  *         axes2 = fig.add_subplot(122)             # <<<<<<<<<<<<<<
- *         axes2.set_title('{} brightest PSE and {} intermediate points'.format(npts_pse,npts_intrm))
+ *         axes2.set_title('{} brightest PSE and {} brightest intermediate points'.format(npts_pse, npts_intrm))
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 715, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 694, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_8 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_4, __pyx_int_122) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_int_122);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 715, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 694, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_v_axes2 = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":716
+    /* "fastrometry/cython_code/WCS.pyx":695
  * 
  *         axes2 = fig.add_subplot(122)
- *         axes2.set_title('{} brightest PSE and {} intermediate points'.format(npts_pse,npts_intrm))             # <<<<<<<<<<<<<<
+ *         axes2.set_title('{} brightest PSE and {} brightest intermediate points'.format(npts_pse, npts_intrm))             # <<<<<<<<<<<<<<
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes2.scatter(np.asarray(psepoints_view)[:,0], np.asarray(psepoints_view)[:,1], marker=".", c="blue")
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_set_title); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 716, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_set_title); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_PSE_and_intermediate, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 716, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_brightest_PSE_and_brightest_int, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_npts_pse); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 716, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_npts_pse); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 716, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __pyx_t_7 = NULL;
     __pyx_t_3 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_10);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
@@ -15333,44 +14726,44 @@
         __Pyx_DECREF_SET(__pyx_t_10, function);
         __pyx_t_3 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_10)) {
       PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_t_15};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 716, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_10)) {
       PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_t_6, __pyx_t_15};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 716, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_10, __pyx_temp+1-__pyx_t_3, 2+__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     } else
     #endif
     {
-      __pyx_t_5 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 716, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_7) {
         __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7); __pyx_t_7 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_3, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_15);
       PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_3, __pyx_t_15);
       __pyx_t_6 = 0;
       __pyx_t_15 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 716, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 695, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_10 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_14);
@@ -15380,549 +14773,549 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_8 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_10, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 716, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 695, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":717
+    /* "fastrometry/cython_code/WCS.pyx":696
  *         axes2 = fig.add_subplot(122)
- *         axes2.set_title('{} brightest PSE and {} intermediate points'.format(npts_pse,npts_intrm))
+ *         axes2.set_title('{} brightest PSE and {} brightest intermediate points'.format(npts_pse, npts_intrm))
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *         axes2.scatter(np.asarray(psepoints_view)[:,0], np.asarray(psepoints_view)[:,1], marker=".", c="blue")
  *         axes2.scatter(img_xmax-np.asarray(intrmpoints_view)[:,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_imshow); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_imshow); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_INCREF(__pyx_v_image_data);
     __Pyx_GIVEREF(__pyx_v_image_data);
     PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_v_image_data);
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 717, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_INCREF(__pyx_v_LogNorm);
     __pyx_t_5 = __pyx_v_LogNorm; __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_15);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_10 = (__pyx_t_15) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_15) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
-    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 717, __pyx_L1_error)
+    if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, __pyx_t_10) < 0) __PYX_ERR(0, 717, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_norm, __pyx_t_10) < 0) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 717, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":718
- *         axes2.set_title('{} brightest PSE and {} intermediate points'.format(npts_pse,npts_intrm))
+    /* "fastrometry/cython_code/WCS.pyx":697
+ *         axes2.set_title('{} brightest PSE and {} brightest intermediate points'.format(npts_pse, npts_intrm))
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes2.scatter(np.asarray(psepoints_view)[:,0], np.asarray(psepoints_view)[:,1], marker=".", c="blue")             # <<<<<<<<<<<<<<
  *         axes2.scatter(img_xmax-np.asarray(intrmpoints_view)[:,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  */
-    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_scatter); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_scatter); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_5, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_14);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__20); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__15); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_14 = __pyx_memoryview_fromslice(__pyx_v_psepoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_15);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_4 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_15, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_14);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__21); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__16); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_5);
     __pyx_t_8 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 718, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 718, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_c, __pyx_n_s_blue) < 0) __PYX_ERR(0, 718, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 718, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 697, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_c, __pyx_n_s_blue) < 0) __PYX_ERR(0, 697, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 697, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":719
+    /* "fastrometry/cython_code/WCS.pyx":698
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes2.scatter(np.asarray(psepoints_view)[:,0], np.asarray(psepoints_view)[:,1], marker=".", c="blue")
  *         axes2.scatter(img_xmax-np.asarray(intrmpoints_view)[:,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:,1]/approx_scale-CRPIXy_guess, marker=".", c="red")             # <<<<<<<<<<<<<<
  * 
  *         dscrp = "PSE points (blue) and intermediate points (red) plotted overtop the image. Since the intermediate points are actually in radians, whereas the PSE points are in pixels, \nan 'approximate scale factor' has been guessed and used to put the intermediate coordinates roughly on the same scale as the PSE coordinates. The intermediate \ncoordinates center has also been shifted from (0,0) to the center of the PSE points. This allows the geometries to be compared visually."
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_scatter); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes2, __pyx_n_s_scatter); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_15 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_15)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_15);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_4 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_15, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_10);
     __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__20); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_tuple__15); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 719, __pyx_L1_error) }
-    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_14, __pyx_v_approx_scale); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 698, __pyx_L1_error) }
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_14, __pyx_v_approx_scale); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_14 = PyNumber_Subtract(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_4 = PyFloat_FromDouble(__pyx_v_CRPIXx_guess); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_asarray); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_intrmpoints_view, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_15))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_15);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_15);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_15, function);
       }
     }
     __pyx_t_14 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_15, __pyx_t_6, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_15, __pyx_t_10);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__21); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_15 = __Pyx_PyObject_GetItem(__pyx_t_14, __pyx_tuple__16); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 719, __pyx_L1_error) }
-    __pyx_t_14 = __Pyx_PyNumber_Divide(__pyx_t_15, __pyx_v_approx_scale); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    if (unlikely(!__pyx_v_approx_scale)) { __Pyx_RaiseUnboundLocalError("approx_scale"); __PYX_ERR(0, 698, __pyx_L1_error) }
+    __pyx_t_14 = __Pyx_PyNumber_Divide(__pyx_t_15, __pyx_v_approx_scale); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
-    __pyx_t_15 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_15 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_15);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXy_guess); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_15, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_15, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_14 = PyTuple_New(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_t_4);
     __pyx_t_5 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_c, __pyx_n_s_red) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 698, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_c, __pyx_n_s_red) < 0) __PYX_ERR(0, 698, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":721
+    /* "fastrometry/cython_code/WCS.pyx":700
  *         axes2.scatter(img_xmax-np.asarray(intrmpoints_view)[:,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  *         dscrp = "PSE points (blue) and intermediate points (red) plotted overtop the image. Since the intermediate points are actually in radians, whereas the PSE points are in pixels, \nan 'approximate scale factor' has been guessed and used to put the intermediate coordinates roughly on the same scale as the PSE coordinates. The intermediate \ncoordinates center has also been shifted from (0,0) to the center of the PSE points. This allows the geometries to be compared visually."             # <<<<<<<<<<<<<<
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(left=0.08, right=0.92, bottom=0.2, top=0.92, wspace=0.2, hspace=0.05)
  */
     __Pyx_INCREF(__pyx_kp_s_PSE_points_blue_and_intermediate);
     __pyx_v_dscrp = __pyx_kp_s_PSE_points_blue_and_intermediate;
 
-    /* "fastrometry/cython_code/WCS.pyx":722
+    /* "fastrometry/cython_code/WCS.pyx":701
  * 
  *         dscrp = "PSE points (blue) and intermediate points (red) plotted overtop the image. Since the intermediate points are actually in radians, whereas the PSE points are in pixels, \nan 'approximate scale factor' has been guessed and used to put the intermediate coordinates roughly on the same scale as the PSE coordinates. The intermediate \ncoordinates center has also been shifted from (0,0) to the center of the PSE points. This allows the geometries to be compared visually."
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *         plt.subplots_adjust(left=0.08, right=0.92, bottom=0.2, top=0.92, wspace=0.2, hspace=0.05)
  *         plt.savefig(debug_report/"shapecompare_initial.png")
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 722, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 701, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_float_0_5);
     __Pyx_GIVEREF(__pyx_float_0_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_float_0_5);
     __Pyx_INCREF(__pyx_float_0_05);
     __Pyx_GIVEREF(__pyx_float_0_05);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_float_0_05);
     __Pyx_INCREF(__pyx_v_dscrp);
     __Pyx_GIVEREF(__pyx_v_dscrp);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_dscrp);
-    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 722, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 701, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 722, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 722, __pyx_L1_error)
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 722, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 701, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 701, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":723
+    /* "fastrometry/cython_code/WCS.pyx":702
  *         dscrp = "PSE points (blue) and intermediate points (red) plotted overtop the image. Since the intermediate points are actually in radians, whereas the PSE points are in pixels, \nan 'approximate scale factor' has been guessed and used to put the intermediate coordinates roughly on the same scale as the PSE coordinates. The intermediate \ncoordinates center has also been shifted from (0,0) to the center of the PSE points. This allows the geometries to be compared visually."
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(left=0.08, right=0.92, bottom=0.2, top=0.92, wspace=0.2, hspace=0.05)             # <<<<<<<<<<<<<<
  *         plt.savefig(debug_report/"shapecompare_initial.png")
  *         plt.show()
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 723, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_14 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 723, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyDict_NewPresized(6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_wspace, __pyx_float_0_2) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_hspace, __pyx_float_0_05) < 0) __PYX_ERR(0, 723, __pyx_L1_error)
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_empty_tuple, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_wspace, __pyx_float_0_2) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_hspace, __pyx_float_0_05) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_empty_tuple, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 702, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":724
+    /* "fastrometry/cython_code/WCS.pyx":703
  *         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *         plt.subplots_adjust(left=0.08, right=0.92, bottom=0.2, top=0.92, wspace=0.2, hspace=0.05)
  *         plt.savefig(debug_report/"shapecompare_initial.png")             # <<<<<<<<<<<<<<
  *         plt.show()
  * 
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 724, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_shapecompare_initial_png); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 724, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_kp_s_shapecompare_initial_png); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 724, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 703, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":725
+    /* "fastrometry/cython_code/WCS.pyx":704
  *         plt.subplots_adjust(left=0.08, right=0.92, bottom=0.2, top=0.92, wspace=0.2, hspace=0.05)
  *         plt.savefig(debug_report/"shapecompare_initial.png")
  *         plt.show()             # <<<<<<<<<<<<<<
  * 
  *     if verbosity == 2:
  */
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 725, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 704, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_14);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_14, function);
       }
     }
     __pyx_t_4 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_14);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 725, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 704, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":702
+    /* "fastrometry/cython_code/WCS.pyx":681
  *         print("| | (working with {} PSE sources and {} catalogue sources.)".format(npts_pse,npts_intrm))
  * 
  *     if debug and npts_intrm >= 10 and npts_pse >= 10:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":727
+  /* "fastrometry/cython_code/WCS.pyx":706
  *         plt.show()
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | Constructing PSE triangles...")
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":728
+    /* "fastrometry/cython_code/WCS.pyx":707
  * 
  *     if verbosity == 2:
  *         print("| | Constructing PSE triangles...")             # <<<<<<<<<<<<<<
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  *     if verbosity == 2:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_PSE_triangles) < 0) __PYX_ERR(0, 728, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_PSE_triangles) < 0) __PYX_ERR(0, 707, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":727
+    /* "fastrometry/cython_code/WCS.pyx":706
  *         plt.show()
  * 
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | Constructing PSE triangles...")
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":729
+  /* "fastrometry/cython_code/WCS.pyx":708
  *     if verbosity == 2:
  *         print("| | Constructing PSE triangles...")
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)             # <<<<<<<<<<<<<<
  *     if verbosity == 2:
  *         print("| | done")
  */
-  __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3WCS_generateTriangles(__pyx_v_npts_pse, __pyx_v_psepoints_inv_view, __pyx_v_psetriangles_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3WCS_generateTriangles(__pyx_v_npts_pse, __pyx_v_psepoints_inv_view, __pyx_v_psetriangles_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 708, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":730
+  /* "fastrometry/cython_code/WCS.pyx":709
  *         print("| | Constructing PSE triangles...")
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Constructing intermediate triangles...")
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":731
+    /* "fastrometry/cython_code/WCS.pyx":710
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  *     if verbosity == 2:
  *         print("| | done")             # <<<<<<<<<<<<<<
  *         print("| | Constructing intermediate triangles...")
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 731, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 710, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":732
+    /* "fastrometry/cython_code/WCS.pyx":711
  *     if verbosity == 2:
  *         print("| | done")
  *         print("| | Constructing intermediate triangles...")             # <<<<<<<<<<<<<<
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)
  *     if verbosity == 2:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_intermediate_trian) < 0) __PYX_ERR(0, 732, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_intermediate_trian) < 0) __PYX_ERR(0, 711, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":730
+    /* "fastrometry/cython_code/WCS.pyx":709
  *         print("| | Constructing PSE triangles...")
  *     generateTriangles(npts_pse, psepoints_inv_view, psetriangles_view)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | done")
  *         print("| | Constructing intermediate triangles...")
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":733
+  /* "fastrometry/cython_code/WCS.pyx":712
  *         print("| | done")
  *         print("| | Constructing intermediate triangles...")
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)             # <<<<<<<<<<<<<<
  *     if verbosity == 2:
  *         print("| | done")
  */
-  __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3WCS_generateTriangles(__pyx_v_npts_intrm, __pyx_v_intrmpoints_view, __pyx_v_intrmtriangles_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_4 = __pyx_f_11fastrometry_11cython_code_3WCS_generateTriangles(__pyx_v_npts_intrm, __pyx_v_intrmpoints_view, __pyx_v_intrmtriangles_view); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 712, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":734
+  /* "fastrometry/cython_code/WCS.pyx":713
  *         print("| | Constructing intermediate triangles...")
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | done")
  * 
  */
   __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
   if (__pyx_t_1) {
 
-    /* "fastrometry/cython_code/WCS.pyx":735
+    /* "fastrometry/cython_code/WCS.pyx":714
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)
  *     if verbosity == 2:
  *         print("| | done")             # <<<<<<<<<<<<<<
  * 
  *     for i in range(nchoose3_pse):
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 735, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done) < 0) __PYX_ERR(0, 714, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":734
+    /* "fastrometry/cython_code/WCS.pyx":713
  *         print("| | Constructing intermediate triangles...")
  *     generateTriangles(npts_intrm, intrmpoints_view, intrmtriangles_view)
  *     if verbosity == 2:             # <<<<<<<<<<<<<<
  *         print("| | done")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":737
+  /* "fastrometry/cython_code/WCS.pyx":716
  *         print("| | done")
  * 
  *     for i in range(nchoose3_pse):             # <<<<<<<<<<<<<<
  *         if verbosity == 2:
  *             if i*100/nchoose3_pse > prcnt:
  */
   __pyx_t_3 = __pyx_v_nchoose3_pse;
   __pyx_t_16 = __pyx_t_3;
   for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
     __pyx_v_i = __pyx_t_17;
 
-    /* "fastrometry/cython_code/WCS.pyx":738
+    /* "fastrometry/cython_code/WCS.pyx":717
  * 
  *     for i in range(nchoose3_pse):
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             if i*100/nchoose3_pse > prcnt:
  *                 print("| | i {}, {}%".format(i, prcnt))
  */
     __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
     if (__pyx_t_1) {
 
-      /* "fastrometry/cython_code/WCS.pyx":739
+      /* "fastrometry/cython_code/WCS.pyx":718
  *     for i in range(nchoose3_pse):
  *         if verbosity == 2:
  *             if i*100/nchoose3_pse > prcnt:             # <<<<<<<<<<<<<<
  *                 print("| | i {}, {}%".format(i, prcnt))
  *                 prcnt = i*100/nchoose3_pse
  */
       __pyx_t_18 = (__pyx_v_i * 0x64);
       if (unlikely(__pyx_v_nchoose3_pse == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-        __PYX_ERR(0, 739, __pyx_L1_error)
+        __PYX_ERR(0, 718, __pyx_L1_error)
       }
       else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((int)-1) > 0)) && unlikely(__pyx_v_nchoose3_pse == (int)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_18))) {
         PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-        __PYX_ERR(0, 739, __pyx_L1_error)
+        __PYX_ERR(0, 718, __pyx_L1_error)
       }
       __pyx_t_1 = ((__Pyx_div_Py_ssize_t(__pyx_t_18, __pyx_v_nchoose3_pse) > __pyx_v_prcnt) != 0);
       if (__pyx_t_1) {
 
-        /* "fastrometry/cython_code/WCS.pyx":740
+        /* "fastrometry/cython_code/WCS.pyx":719
  *         if verbosity == 2:
  *             if i*100/nchoose3_pse > prcnt:
  *                 print("| | i {}, {}%".format(i, prcnt))             # <<<<<<<<<<<<<<
  *                 prcnt = i*100/nchoose3_pse
  *         psesrcindex_A = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,1])-1,img_xmax-int(psetriangles_view[i,0])-1]
  */
-        __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_i, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 740, __pyx_L1_error)
+        __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_i, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 719, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
-        __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 740, __pyx_L1_error)
+        __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 719, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_prcnt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_prcnt); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 719, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __pyx_t_15 = NULL;
         __pyx_t_19 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
           __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_14);
           if (likely(__pyx_t_15)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
@@ -15931,349 +15324,349 @@
             __Pyx_DECREF_SET(__pyx_t_14, function);
             __pyx_t_19 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_14)) {
           PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_8, __pyx_t_5};
-          __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_14)) {
           PyObject *__pyx_temp[3] = {__pyx_t_15, __pyx_t_8, __pyx_t_5};
-          __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_14, __pyx_temp+1-__pyx_t_19, 2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         {
-          __pyx_t_10 = PyTuple_New(2+__pyx_t_19); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 740, __pyx_L1_error)
+          __pyx_t_10 = PyTuple_New(2+__pyx_t_19); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 719, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           if (__pyx_t_15) {
             __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_15); __pyx_t_15 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_19, __pyx_t_8);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_19, __pyx_t_5);
           __pyx_t_8 = 0;
           __pyx_t_5 = 0;
-          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_10, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 719, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         }
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-        if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 740, __pyx_L1_error)
+        if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 719, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-        /* "fastrometry/cython_code/WCS.pyx":741
+        /* "fastrometry/cython_code/WCS.pyx":720
  *             if i*100/nchoose3_pse > prcnt:
  *                 print("| | i {}, {}%".format(i, prcnt))
  *                 prcnt = i*100/nchoose3_pse             # <<<<<<<<<<<<<<
  *         psesrcindex_A = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,1])-1,img_xmax-int(psetriangles_view[i,0])-1]
  *         psesrcindex_B = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,3])-1,img_xmax-int(psetriangles_view[i,2])-1]
  */
         __pyx_t_18 = (__pyx_v_i * 0x64);
         if (unlikely(__pyx_v_nchoose3_pse == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "integer division or modulo by zero");
-          __PYX_ERR(0, 741, __pyx_L1_error)
+          __PYX_ERR(0, 720, __pyx_L1_error)
         }
         else if (sizeof(Py_ssize_t) == sizeof(long) && (!(((int)-1) > 0)) && unlikely(__pyx_v_nchoose3_pse == (int)-1)  && unlikely(UNARY_NEG_WOULD_OVERFLOW(__pyx_t_18))) {
           PyErr_SetString(PyExc_OverflowError, "value too large to perform division");
-          __PYX_ERR(0, 741, __pyx_L1_error)
+          __PYX_ERR(0, 720, __pyx_L1_error)
         }
         __pyx_v_prcnt = __Pyx_div_Py_ssize_t(__pyx_t_18, __pyx_v_nchoose3_pse);
 
-        /* "fastrometry/cython_code/WCS.pyx":739
+        /* "fastrometry/cython_code/WCS.pyx":718
  *     for i in range(nchoose3_pse):
  *         if verbosity == 2:
  *             if i*100/nchoose3_pse > prcnt:             # <<<<<<<<<<<<<<
  *                 print("| | i {}, {}%".format(i, prcnt))
  *                 prcnt = i*100/nchoose3_pse
  */
       }
 
-      /* "fastrometry/cython_code/WCS.pyx":738
+      /* "fastrometry/cython_code/WCS.pyx":717
  * 
  *     for i in range(nchoose3_pse):
  *         if verbosity == 2:             # <<<<<<<<<<<<<<
  *             if i*100/nchoose3_pse > prcnt:
  *                 print("| | i {}, {}%".format(i, prcnt))
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":742
+    /* "fastrometry/cython_code/WCS.pyx":721
  *                 print("| | i {}, {}%".format(i, prcnt))
  *                 prcnt = i*100/nchoose3_pse
  *         psesrcindex_A = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,1])-1,img_xmax-int(psetriangles_view[i,0])-1]             # <<<<<<<<<<<<<<
  *         psesrcindex_B = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,3])-1,img_xmax-int(psetriangles_view[i,2])-1]
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]
  */
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_20 = __pyx_v_i;
     __pyx_t_21 = 1;
     __pyx_t_19 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 742, __pyx_L1_error)
+      __PYX_ERR(0, 721, __pyx_L1_error)
     }
-    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_10 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_21 = __pyx_v_i;
     __pyx_t_20 = 0;
     __pyx_t_19 = -1;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 742, __pyx_L1_error)
+      __PYX_ERR(0, 721, __pyx_L1_error)
     }
-    __pyx_t_10 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __pyx_t_20 = __pyx_t_18;
     __pyx_t_21 = __pyx_t_22;
     __pyx_t_19 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_srcindexmap_initial_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_srcindexmap_initial_view.shape[1];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 742, __pyx_L1_error)
+      __PYX_ERR(0, 721, __pyx_L1_error)
     }
-    __pyx_t_10 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 742, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 721, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_XDECREF_SET(__pyx_v_psesrcindex_A, __pyx_t_10);
     __pyx_t_10 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":743
+    /* "fastrometry/cython_code/WCS.pyx":722
  *                 prcnt = i*100/nchoose3_pse
  *         psesrcindex_A = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,1])-1,img_xmax-int(psetriangles_view[i,0])-1]
  *         psesrcindex_B = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,3])-1,img_xmax-int(psetriangles_view[i,2])-1]             # <<<<<<<<<<<<<<
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]
  *         for j in range(nchoose3_intrm):
  */
-    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_21 = __pyx_v_i;
     __pyx_t_20 = 3;
     __pyx_t_19 = -1;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 743, __pyx_L1_error)
+      __PYX_ERR(0, 722, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_14 = PyNumber_Subtract(__pyx_t_10, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_14 = PyNumber_Subtract(__pyx_t_10, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_20 = __pyx_v_i;
     __pyx_t_21 = 2;
     __pyx_t_19 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 743, __pyx_L1_error)
+      __PYX_ERR(0, 722, __pyx_L1_error)
     }
-    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
-    __pyx_t_10 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_10 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_10, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __pyx_t_21 = __pyx_t_22;
     __pyx_t_20 = __pyx_t_18;
     __pyx_t_19 = -1;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_srcindexmap_initial_view.shape[0];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_srcindexmap_initial_view.shape[1];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 743, __pyx_L1_error)
+      __PYX_ERR(0, 722, __pyx_L1_error)
     }
-    __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_XDECREF_SET(__pyx_v_psesrcindex_B, __pyx_t_14);
     __pyx_t_14 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":744
+    /* "fastrometry/cython_code/WCS.pyx":723
  *         psesrcindex_A = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,1])-1,img_xmax-int(psetriangles_view[i,0])-1]
  *         psesrcindex_B = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,3])-1,img_xmax-int(psetriangles_view[i,2])-1]
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]             # <<<<<<<<<<<<<<
  *         for j in range(nchoose3_intrm):
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  */
-    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __pyx_t_20 = __pyx_v_i;
     __pyx_t_21 = 5;
     __pyx_t_19 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 744, __pyx_L1_error)
+      __PYX_ERR(0, 723, __pyx_L1_error)
     }
-    __pyx_t_10 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_4 = PyNumber_Subtract(__pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Subtract(__pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_10); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __pyx_t_21 = __pyx_v_i;
     __pyx_t_20 = 4;
     __pyx_t_19 = -1;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_psetriangles_view.shape[0];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_psetriangles_view.shape[1];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 744, __pyx_L1_error)
+      __PYX_ERR(0, 723, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_14 = PyNumber_Subtract(__pyx_t_10, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_14 = PyNumber_Subtract(__pyx_t_10, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_22 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_22 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_20 = __pyx_t_18;
     __pyx_t_21 = __pyx_t_22;
     __pyx_t_19 = -1;
     if (__pyx_t_20 < 0) {
       __pyx_t_20 += __pyx_v_srcindexmap_initial_view.shape[0];
       if (unlikely(__pyx_t_20 < 0)) __pyx_t_19 = 0;
     } else if (unlikely(__pyx_t_20 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_19 = 0;
     if (__pyx_t_21 < 0) {
       __pyx_t_21 += __pyx_v_srcindexmap_initial_view.shape[1];
       if (unlikely(__pyx_t_21 < 0)) __pyx_t_19 = 1;
     } else if (unlikely(__pyx_t_21 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_19 = 1;
     if (unlikely(__pyx_t_19 != -1)) {
       __Pyx_RaiseBufferIndexError(__pyx_t_19);
-      __PYX_ERR(0, 744, __pyx_L1_error)
+      __PYX_ERR(0, 723, __pyx_L1_error)
     }
-    __pyx_t_4 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 744, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_20 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_21 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 723, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_XDECREF_SET(__pyx_v_psesrcindex_C, __pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":745
+    /* "fastrometry/cython_code/WCS.pyx":724
  *         psesrcindex_B = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,3])-1,img_xmax-int(psetriangles_view[i,2])-1]
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]
  *         for j in range(nchoose3_intrm):             # <<<<<<<<<<<<<<
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  */
     __pyx_t_19 = __pyx_v_nchoose3_intrm;
     __pyx_t_23 = __pyx_t_19;
     for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_23; __pyx_t_22+=1) {
       __pyx_v_j = __pyx_t_22;
 
-      /* "fastrometry/cython_code/WCS.pyx":746
+      /* "fastrometry/cython_code/WCS.pyx":725
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]
  *         for j in range(nchoose3_intrm):
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:             # <<<<<<<<<<<<<<
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  */
       __pyx_t_21 = __pyx_v_i;
@@ -16285,35 +15678,35 @@
       } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
       if (__pyx_t_20 < 0) {
         __pyx_t_20 += __pyx_v_psetriangles_view.shape[1];
         if (unlikely(__pyx_t_20 < 0)) __pyx_t_24 = 1;
       } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
       if (unlikely(__pyx_t_24 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_24);
-        __PYX_ERR(0, 746, __pyx_L1_error)
+        __PYX_ERR(0, 725, __pyx_L1_error)
       }
       __pyx_t_25 = __pyx_v_j;
       __pyx_t_26 = 6;
       __pyx_t_24 = -1;
       if (__pyx_t_25 < 0) {
         __pyx_t_25 += __pyx_v_intrmtriangles_view.shape[0];
         if (unlikely(__pyx_t_25 < 0)) __pyx_t_24 = 0;
       } else if (unlikely(__pyx_t_25 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
       if (__pyx_t_26 < 0) {
         __pyx_t_26 += __pyx_v_intrmtriangles_view.shape[1];
         if (unlikely(__pyx_t_26 < 0)) __pyx_t_24 = 1;
       } else if (unlikely(__pyx_t_26 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
       if (unlikely(__pyx_t_24 != -1)) {
         __Pyx_RaiseBufferIndexError(__pyx_t_24);
-        __PYX_ERR(0, 746, __pyx_L1_error)
+        __PYX_ERR(0, 725, __pyx_L1_error)
       }
       __pyx_t_1 = ((fabs(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_25 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_26 * __pyx_v_intrmtriangles_view.strides[1]) ))))) < __pyx_v_vertextol) != 0);
       if (__pyx_t_1) {
 
-        /* "fastrometry/cython_code/WCS.pyx":747
+        /* "fastrometry/cython_code/WCS.pyx":726
  *         for j in range(nchoose3_intrm):
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:             # <<<<<<<<<<<<<<
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  */
         __pyx_t_26 = __pyx_v_i;
@@ -16325,35 +15718,35 @@
         } else if (unlikely(__pyx_t_26 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
         if (__pyx_t_25 < 0) {
           __pyx_t_25 += __pyx_v_psetriangles_view.shape[1];
           if (unlikely(__pyx_t_25 < 0)) __pyx_t_24 = 1;
         } else if (unlikely(__pyx_t_25 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
         if (unlikely(__pyx_t_24 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_24);
-          __PYX_ERR(0, 747, __pyx_L1_error)
+          __PYX_ERR(0, 726, __pyx_L1_error)
         }
         __pyx_t_20 = __pyx_v_j;
         __pyx_t_21 = 7;
         __pyx_t_24 = -1;
         if (__pyx_t_20 < 0) {
           __pyx_t_20 += __pyx_v_intrmtriangles_view.shape[0];
           if (unlikely(__pyx_t_20 < 0)) __pyx_t_24 = 0;
         } else if (unlikely(__pyx_t_20 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
         if (__pyx_t_21 < 0) {
           __pyx_t_21 += __pyx_v_intrmtriangles_view.shape[1];
           if (unlikely(__pyx_t_21 < 0)) __pyx_t_24 = 1;
         } else if (unlikely(__pyx_t_21 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
         if (unlikely(__pyx_t_24 != -1)) {
           __Pyx_RaiseBufferIndexError(__pyx_t_24);
-          __PYX_ERR(0, 747, __pyx_L1_error)
+          __PYX_ERR(0, 726, __pyx_L1_error)
         }
         __pyx_t_1 = ((fabs(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_26 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_25 * __pyx_v_psetriangles_view.strides[1]) ))) - (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_20 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_intrmtriangles_view.strides[1]) ))))) < __pyx_v_vertextol) != 0);
         if (__pyx_t_1) {
 
-          /* "fastrometry/cython_code/WCS.pyx":748
+          /* "fastrometry/cython_code/WCS.pyx":727
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):             # <<<<<<<<<<<<<<
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  *                         if user_rotation is False:
  */
           __pyx_t_21 = __pyx_v_j;
@@ -16365,30 +15758,30 @@
           } else if (unlikely(__pyx_t_21 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
           if (__pyx_t_20 < 0) {
             __pyx_t_20 += __pyx_v_intrmtriangles_view.shape[1];
             if (unlikely(__pyx_t_20 < 0)) __pyx_t_24 = 1;
           } else if (unlikely(__pyx_t_20 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
           if (unlikely(__pyx_t_24 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-            __PYX_ERR(0, 748, __pyx_L1_error)
+            __PYX_ERR(0, 727, __pyx_L1_error)
           }
           __pyx_t_25 = __pyx_v_i;
           __pyx_t_26 = 8;
           __pyx_t_24 = -1;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_psetriangles_view.shape[0];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_24 = 0;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
           if (__pyx_t_26 < 0) {
             __pyx_t_26 += __pyx_v_psetriangles_view.shape[1];
             if (unlikely(__pyx_t_26 < 0)) __pyx_t_24 = 1;
           } else if (unlikely(__pyx_t_26 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
           if (unlikely(__pyx_t_24 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-            __PYX_ERR(0, 748, __pyx_L1_error)
+            __PYX_ERR(0, 727, __pyx_L1_error)
           }
           __pyx_t_12 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_21 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_intrmtriangles_view.strides[1]) ))) > (__pyx_v_S_lb * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_25 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_26 * __pyx_v_psetriangles_view.strides[1]) ))) - __pyx_v_kerneldiam))) != 0);
           if (__pyx_t_12) {
           } else {
             __pyx_t_1 = __pyx_t_12;
             goto __pyx_L35_bool_binop_done;
           }
@@ -16401,37 +15794,37 @@
           } else if (unlikely(__pyx_t_26 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
           if (__pyx_t_25 < 0) {
             __pyx_t_25 += __pyx_v_intrmtriangles_view.shape[1];
             if (unlikely(__pyx_t_25 < 0)) __pyx_t_24 = 1;
           } else if (unlikely(__pyx_t_25 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
           if (unlikely(__pyx_t_24 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-            __PYX_ERR(0, 748, __pyx_L1_error)
+            __PYX_ERR(0, 727, __pyx_L1_error)
           }
           __pyx_t_20 = __pyx_v_i;
           __pyx_t_21 = 8;
           __pyx_t_24 = -1;
           if (__pyx_t_20 < 0) {
             __pyx_t_20 += __pyx_v_psetriangles_view.shape[0];
             if (unlikely(__pyx_t_20 < 0)) __pyx_t_24 = 0;
           } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
           if (__pyx_t_21 < 0) {
             __pyx_t_21 += __pyx_v_psetriangles_view.shape[1];
             if (unlikely(__pyx_t_21 < 0)) __pyx_t_24 = 1;
           } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
           if (unlikely(__pyx_t_24 != -1)) {
             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-            __PYX_ERR(0, 748, __pyx_L1_error)
+            __PYX_ERR(0, 727, __pyx_L1_error)
           }
           __pyx_t_12 = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_26 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_25 * __pyx_v_intrmtriangles_view.strides[1]) ))) < (__pyx_v_S_ub * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_20 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_21 * __pyx_v_psetriangles_view.strides[1]) ))) + __pyx_v_kerneldiam))) != 0);
           __pyx_t_1 = __pyx_t_12;
           __pyx_L35_bool_binop_done:;
           if (__pyx_t_1) {
 
-            /* "fastrometry/cython_code/WCS.pyx":749
+            /* "fastrometry/cython_code/WCS.pyx":728
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])             # <<<<<<<<<<<<<<
  *                         if user_rotation is False:
  *                             guess[1] = theta
  */
             __pyx_t_21 = __pyx_v_i;
@@ -16443,180 +15836,180 @@
             } else if (unlikely(__pyx_t_21 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_20 < 0) {
               __pyx_t_20 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_20 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_20 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_25 = __pyx_v_j;
             __pyx_t_26 = 10;
             __pyx_t_24 = -1;
             if (__pyx_t_25 < 0) {
               __pyx_t_25 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_25 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_25 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_26 < 0) {
               __pyx_t_26 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_26 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_26 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_27 = __pyx_v_i;
             __pyx_t_28 = 10;
             __pyx_t_24 = -1;
             if (__pyx_t_27 < 0) {
               __pyx_t_27 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_27 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_28 < 0) {
               __pyx_t_28 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_28 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_29 = __pyx_v_j;
             __pyx_t_30 = 9;
             __pyx_t_24 = -1;
             if (__pyx_t_29 < 0) {
               __pyx_t_29 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_29 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_30 < 0) {
               __pyx_t_30 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_30 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_30 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_31 = __pyx_v_i;
             __pyx_t_32 = 9;
             __pyx_t_24 = -1;
             if (__pyx_t_31 < 0) {
               __pyx_t_31 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_31 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_31 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_32 < 0) {
               __pyx_t_32 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_32 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_32 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_33 = __pyx_v_j;
             __pyx_t_34 = 9;
             __pyx_t_24 = -1;
             if (__pyx_t_33 < 0) {
               __pyx_t_33 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_33 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_33 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_34 < 0) {
               __pyx_t_34 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_34 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_34 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_35 = __pyx_v_i;
             __pyx_t_36 = 10;
             __pyx_t_24 = -1;
             if (__pyx_t_35 < 0) {
               __pyx_t_35 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_35 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_35 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_36 < 0) {
               __pyx_t_36 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_36 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_36 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_t_37 = __pyx_v_j;
             __pyx_t_38 = 10;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 749, __pyx_L1_error)
+              __PYX_ERR(0, 728, __pyx_L1_error)
             }
             __pyx_v_theta = atan2((((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_21 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_20 * __pyx_v_psetriangles_view.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_25 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_26 * __pyx_v_intrmtriangles_view.strides[1]) )))) - ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_27 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_28 * __pyx_v_psetriangles_view.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_29 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_30 * __pyx_v_intrmtriangles_view.strides[1]) ))))), (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_31 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_32 * __pyx_v_psetriangles_view.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_33 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_34 * __pyx_v_intrmtriangles_view.strides[1]) )))) + ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_35 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_36 * __pyx_v_psetriangles_view.strides[1]) ))) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) ))))));
 
-            /* "fastrometry/cython_code/WCS.pyx":750
+            /* "fastrometry/cython_code/WCS.pyx":729
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  *                         if user_rotation is False:             # <<<<<<<<<<<<<<
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol
  */
             __pyx_t_1 = ((__pyx_v_user_rotation == 0) != 0);
             if (__pyx_t_1) {
 
-              /* "fastrometry/cython_code/WCS.pyx":751
+              /* "fastrometry/cython_code/WCS.pyx":730
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  *                         if user_rotation is False:
  *                             guess[1] = theta             # <<<<<<<<<<<<<<
  *                             bnds[0,1] = theta - vertextol
  *                             bnds[1,1] = theta + vertextol
  */
-              __pyx_t_4 = PyFloat_FromDouble(__pyx_v_theta); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
+              __pyx_t_4 = PyFloat_FromDouble(__pyx_v_theta); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 730, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_4);
-              if (unlikely(__Pyx_SetItemInt(__pyx_v_guess, 1, __pyx_t_4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 751, __pyx_L1_error)
+              if (unlikely(__Pyx_SetItemInt(__pyx_v_guess, 1, __pyx_t_4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 730, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-              /* "fastrometry/cython_code/WCS.pyx":752
+              /* "fastrometry/cython_code/WCS.pyx":731
  *                         if user_rotation is False:
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol             # <<<<<<<<<<<<<<
  *                             bnds[1,1] = theta + vertextol
  *                         else:
  */
-              __pyx_t_4 = PyFloat_FromDouble((__pyx_v_theta - __pyx_v_vertextol)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 752, __pyx_L1_error)
+              __pyx_t_4 = PyFloat_FromDouble((__pyx_v_theta - __pyx_v_vertextol)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 731, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_4);
-              if (unlikely(PyObject_SetItem(__pyx_v_bnds, __pyx_tuple__22, __pyx_t_4) < 0)) __PYX_ERR(0, 752, __pyx_L1_error)
+              if (unlikely(PyObject_SetItem(__pyx_v_bnds, __pyx_tuple__17, __pyx_t_4) < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-              /* "fastrometry/cython_code/WCS.pyx":753
+              /* "fastrometry/cython_code/WCS.pyx":732
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol
  *                             bnds[1,1] = theta + vertextol             # <<<<<<<<<<<<<<
  *                         else:
  *                             if theta < phi_lb or theta > phi_ub:
  */
-              __pyx_t_4 = PyFloat_FromDouble((__pyx_v_theta + __pyx_v_vertextol)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 753, __pyx_L1_error)
+              __pyx_t_4 = PyFloat_FromDouble((__pyx_v_theta + __pyx_v_vertextol)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 732, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_4);
-              if (unlikely(PyObject_SetItem(__pyx_v_bnds, __pyx_tuple__23, __pyx_t_4) < 0)) __PYX_ERR(0, 753, __pyx_L1_error)
+              if (unlikely(PyObject_SetItem(__pyx_v_bnds, __pyx_tuple__18, __pyx_t_4) < 0)) __PYX_ERR(0, 732, __pyx_L1_error)
               __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-              /* "fastrometry/cython_code/WCS.pyx":750
+              /* "fastrometry/cython_code/WCS.pyx":729
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  *                         if user_rotation is False:             # <<<<<<<<<<<<<<
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol
  */
               goto __pyx_L37;
             }
 
-            /* "fastrometry/cython_code/WCS.pyx":755
+            /* "fastrometry/cython_code/WCS.pyx":734
  *                             bnds[1,1] = theta + vertextol
  *                         else:
  *                             if theta < phi_lb or theta > phi_ub:             # <<<<<<<<<<<<<<
  *                                 continue
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))
  */
             /*else*/ {
@@ -16627,259 +16020,259 @@
                 goto __pyx_L39_bool_binop_done;
               }
               __pyx_t_12 = ((__pyx_v_theta > __pyx_v_phi_ub) != 0);
               __pyx_t_1 = __pyx_t_12;
               __pyx_L39_bool_binop_done:;
               if (__pyx_t_1) {
 
-                /* "fastrometry/cython_code/WCS.pyx":756
+                /* "fastrometry/cython_code/WCS.pyx":735
  *                         else:
  *                             if theta < phi_lb or theta > phi_ub:
  *                                 continue             # <<<<<<<<<<<<<<
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))
  *                         S = optimizedparams.x[0]
  */
                 goto __pyx_L30_continue;
 
-                /* "fastrometry/cython_code/WCS.pyx":755
+                /* "fastrometry/cython_code/WCS.pyx":734
  *                             bnds[1,1] = theta + vertextol
  *                         else:
  *                             if theta < phi_lb or theta > phi_ub:             # <<<<<<<<<<<<<<
  *                                 continue
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))
  */
               }
             }
             __pyx_L37:;
 
-            /* "fastrometry/cython_code/WCS.pyx":757
+            /* "fastrometry/cython_code/WCS.pyx":736
  *                             if theta < phi_lb or theta > phi_ub:
  *                                 continue
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))             # <<<<<<<<<<<<<<
  *                         S = optimizedparams.x[0]
  *                         phi = optimizedparams.x[1]
  */
-            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_optimization); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_optimization); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_least_squares); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_least_squares); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_14);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_4 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_fitTrianglesToGetSphi); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_fitTrianglesToGetSphi); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_10);
-            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_fun, __pyx_t_10) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_fun, __pyx_t_10) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_x0, __pyx_v_guess) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
-            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_bounds, __pyx_v_bnds) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_x0, __pyx_v_guess) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
+            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_bounds, __pyx_v_bnds) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
             __pyx_t_38 = __pyx_v_i;
             __pyx_t_37 = 0;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_10 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_10 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_10);
             __pyx_t_37 = __pyx_v_i;
             __pyx_t_38 = 1;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_5 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_5 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_5);
             __pyx_t_38 = __pyx_v_i;
             __pyx_t_37 = 2;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_8 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_8 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_8);
             __pyx_t_37 = __pyx_v_i;
             __pyx_t_38 = 3;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_15 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_15 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_15);
             __pyx_t_38 = __pyx_v_i;
             __pyx_t_37 = 4;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_6 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_38 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_6);
             __pyx_t_37 = __pyx_v_i;
             __pyx_t_38 = 5;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_psetriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_psetriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_psetriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_psetriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_7 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_7 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_psetriangles_view.data + __pyx_t_37 * __pyx_v_psetriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_psetriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_7);
             __pyx_t_38 = __pyx_v_j;
             __pyx_t_37 = 0;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_39 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_39)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_39 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_39)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_39);
             __pyx_t_37 = __pyx_v_j;
             __pyx_t_38 = 1;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_40 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_40)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_40 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_40)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_40);
             __pyx_t_38 = __pyx_v_j;
             __pyx_t_37 = 2;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_41 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_41)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_41 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_41)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_41);
             __pyx_t_37 = __pyx_v_j;
             __pyx_t_38 = 3;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_42 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_42)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_42 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_42)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_42);
             __pyx_t_38 = __pyx_v_j;
             __pyx_t_37 = 4;
             __pyx_t_24 = -1;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_43 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_43 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_43);
             __pyx_t_37 = __pyx_v_j;
             __pyx_t_38 = 5;
             __pyx_t_24 = -1;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_38 < 0) {
               __pyx_t_38 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_38 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 757, __pyx_L1_error)
+              __PYX_ERR(0, 736, __pyx_L1_error)
             }
-            __pyx_t_44 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_44 = PyFloat_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[1]) )))); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_44);
-            __pyx_t_45 = PyTuple_New(12); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_45 = PyTuple_New(12); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
             __Pyx_GIVEREF(__pyx_t_10);
             PyTuple_SET_ITEM(__pyx_t_45, 0, __pyx_t_10);
             __Pyx_GIVEREF(__pyx_t_5);
             PyTuple_SET_ITEM(__pyx_t_45, 1, __pyx_t_5);
             __Pyx_GIVEREF(__pyx_t_8);
             PyTuple_SET_ITEM(__pyx_t_45, 2, __pyx_t_8);
@@ -16909,88 +16302,88 @@
             __pyx_t_7 = 0;
             __pyx_t_39 = 0;
             __pyx_t_40 = 0;
             __pyx_t_41 = 0;
             __pyx_t_42 = 0;
             __pyx_t_43 = 0;
             __pyx_t_44 = 0;
-            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_args, __pyx_t_45) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
+            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_args, __pyx_t_45) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-            __pyx_t_45 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 757, __pyx_L1_error)
+            __pyx_t_45 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 736, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __Pyx_XDECREF_SET(__pyx_v_optimizedparams, __pyx_t_45);
             __pyx_t_45 = 0;
 
-            /* "fastrometry/cython_code/WCS.pyx":758
+            /* "fastrometry/cython_code/WCS.pyx":737
  *                                 continue
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))
  *                         S = optimizedparams.x[0]             # <<<<<<<<<<<<<<
  *                         phi = optimizedparams.x[1]
  *                         CRPIXx = optimizedparams.x[2]
  */
-            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 758, __pyx_L1_error)
+            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 737, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
-            __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_45, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 758, __pyx_L1_error)
+            __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_45, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 737, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 758, __pyx_L1_error)
+            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 737, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __pyx_v_S = __pyx_t_11;
 
-            /* "fastrometry/cython_code/WCS.pyx":759
+            /* "fastrometry/cython_code/WCS.pyx":738
  *                         optimizedparams = optimization.least_squares(fun=fitTrianglesToGetSphi, x0=guess, bounds=bnds, args=(psetriangles_view[i,0], psetriangles_view[i,1], psetriangles_view[i,2], psetriangles_view[i,3], psetriangles_view[i,4], psetriangles_view[i,5], intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5]))
  *                         S = optimizedparams.x[0]
  *                         phi = optimizedparams.x[1]             # <<<<<<<<<<<<<<
  *                         CRPIXx = optimizedparams.x[2]
  *                         CRPIXy = optimizedparams.x[3]
  */
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 759, __pyx_L1_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 738, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_45 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 759, __pyx_L1_error)
+            __pyx_t_45 = __Pyx_GetItemInt(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 738, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_45); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 759, __pyx_L1_error)
+            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_45); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 738, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
             __pyx_v_phi = __pyx_t_11;
 
-            /* "fastrometry/cython_code/WCS.pyx":760
+            /* "fastrometry/cython_code/WCS.pyx":739
  *                         S = optimizedparams.x[0]
  *                         phi = optimizedparams.x[1]
  *                         CRPIXx = optimizedparams.x[2]             # <<<<<<<<<<<<<<
  *                         CRPIXy = optimizedparams.x[3]
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  */
-            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 760, __pyx_L1_error)
+            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 739, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
-            __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_45, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
+            __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_45, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 739, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 760, __pyx_L1_error)
+            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 739, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __pyx_v_CRPIXx = __pyx_t_11;
 
-            /* "fastrometry/cython_code/WCS.pyx":761
+            /* "fastrometry/cython_code/WCS.pyx":740
  *                         phi = optimizedparams.x[1]
  *                         CRPIXx = optimizedparams.x[2]
  *                         CRPIXy = optimizedparams.x[3]             # <<<<<<<<<<<<<<
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  */
-            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 761, __pyx_L1_error)
+            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_optimizedparams, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_45 = __Pyx_GetItemInt(__pyx_t_4, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 761, __pyx_L1_error)
+            __pyx_t_45 = __Pyx_GetItemInt(__pyx_t_4, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 740, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_45); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 761, __pyx_L1_error)
+            __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_45); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 740, __pyx_L1_error)
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
             __pyx_v_CRPIXy = __pyx_t_11;
 
-            /* "fastrometry/cython_code/WCS.pyx":762
+            /* "fastrometry/cython_code/WCS.pyx":741
  *                         CRPIXx = optimizedparams.x[2]
  *                         CRPIXy = optimizedparams.x[3]
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)             # <<<<<<<<<<<<<<
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  */
             __pyx_t_38 = __pyx_v_j;
@@ -17002,96 +16395,96 @@
             } else if (unlikely(__pyx_t_38 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_37 < 0) {
               __pyx_t_37 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_37 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_37 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
             __pyx_t_36 = __pyx_v_j;
             __pyx_t_35 = 1;
             __pyx_t_24 = -1;
             if (__pyx_t_36 < 0) {
               __pyx_t_36 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_36 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_36 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_35 < 0) {
               __pyx_t_35 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_35 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_35 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
             __pyx_t_34 = __pyx_v_j;
             __pyx_t_33 = 2;
             __pyx_t_24 = -1;
             if (__pyx_t_34 < 0) {
               __pyx_t_34 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_34 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_34 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_33 < 0) {
               __pyx_t_33 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_33 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_33 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
             __pyx_t_32 = __pyx_v_j;
             __pyx_t_31 = 3;
             __pyx_t_24 = -1;
             if (__pyx_t_32 < 0) {
               __pyx_t_32 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_32 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_32 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_31 < 0) {
               __pyx_t_31 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_31 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_31 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
             __pyx_t_30 = __pyx_v_j;
             __pyx_t_29 = 4;
             __pyx_t_24 = -1;
             if (__pyx_t_30 < 0) {
               __pyx_t_30 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_30 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_30 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_29 < 0) {
               __pyx_t_29 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_29 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
             __pyx_t_28 = __pyx_v_j;
             __pyx_t_27 = 5;
             __pyx_t_24 = -1;
             if (__pyx_t_28 < 0) {
               __pyx_t_28 += __pyx_v_intrmtriangles_view.shape[0];
               if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 0;
             } else if (unlikely(__pyx_t_28 >= __pyx_v_intrmtriangles_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_27 < 0) {
               __pyx_t_27 += __pyx_v_intrmtriangles_view.shape[1];
               if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_27 >= __pyx_v_intrmtriangles_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 762, __pyx_L1_error)
+              __PYX_ERR(0, 741, __pyx_L1_error)
             }
-            __pyx_t_45 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformTriangleUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_36 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_35 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_34 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_33 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_32 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_31 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_30 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_29 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_28 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_27 * __pyx_v_intrmtriangles_view.strides[1]) ))), __pyx_v_invtransf_intrmtriangle_view); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 762, __pyx_L1_error)
+            __pyx_t_45 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformTriangleUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_38 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_37 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_36 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_35 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_34 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_33 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_32 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_31 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_30 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_29 * __pyx_v_intrmtriangles_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmtriangles_view.data + __pyx_t_28 * __pyx_v_intrmtriangles_view.strides[0]) ) + __pyx_t_27 * __pyx_v_intrmtriangles_view.strides[1]) ))), __pyx_v_invtransf_intrmtriangle_view); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 741, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_45);
             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
 
-            /* "fastrometry/cython_code/WCS.pyx":763
+            /* "fastrometry/cython_code/WCS.pyx":742
  *                         CRPIXy = optimizedparams.x[3]
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  */
             __pyx_t_27 = 0;
@@ -17103,15 +16496,15 @@
             } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_28 < 0) {
               __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
               if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 763, __pyx_L1_error)
+              __PYX_ERR(0, 742, __pyx_L1_error)
             }
             __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
             __pyx_t_12 = (1.0 <= __pyx_t_11);
             if (__pyx_t_12) {
               __pyx_t_12 = (__pyx_t_11 <= __pyx_v_img_xmax);
             }
             __pyx_t_13 = (__pyx_t_12 != 0);
@@ -17129,27 +16522,27 @@
             } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
             if (__pyx_t_27 < 0) {
               __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
               if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
             } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
             if (unlikely(__pyx_t_24 != -1)) {
               __Pyx_RaiseBufferIndexError(__pyx_t_24);
-              __PYX_ERR(0, 763, __pyx_L1_error)
+              __PYX_ERR(0, 742, __pyx_L1_error)
             }
             __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
             __pyx_t_13 = (1.0 <= __pyx_t_11);
             if (__pyx_t_13) {
               __pyx_t_13 = (__pyx_t_11 <= __pyx_v_img_ymax);
             }
             __pyx_t_12 = (__pyx_t_13 != 0);
             __pyx_t_1 = __pyx_t_12;
             __pyx_L42_bool_binop_done:;
             if (__pyx_t_1) {
 
-              /* "fastrometry/cython_code/WCS.pyx":764
+              /* "fastrometry/cython_code/WCS.pyx":743
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  */
               __pyx_t_27 = 1;
@@ -17161,15 +16554,15 @@
               } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
               if (__pyx_t_28 < 0) {
                 __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                 if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
               } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
               if (unlikely(__pyx_t_24 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                __PYX_ERR(0, 764, __pyx_L1_error)
+                __PYX_ERR(0, 743, __pyx_L1_error)
               }
               __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
               __pyx_t_12 = (1.0 <= __pyx_t_11);
               if (__pyx_t_12) {
                 __pyx_t_12 = (__pyx_t_11 <= __pyx_v_img_xmax);
               }
               __pyx_t_13 = (__pyx_t_12 != 0);
@@ -17187,27 +16580,27 @@
               } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
               if (__pyx_t_27 < 0) {
                 __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                 if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
               } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
               if (unlikely(__pyx_t_24 != -1)) {
                 __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                __PYX_ERR(0, 764, __pyx_L1_error)
+                __PYX_ERR(0, 743, __pyx_L1_error)
               }
               __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
               __pyx_t_13 = (1.0 <= __pyx_t_11);
               if (__pyx_t_13) {
                 __pyx_t_13 = (__pyx_t_11 <= __pyx_v_img_ymax);
               }
               __pyx_t_12 = (__pyx_t_13 != 0);
               __pyx_t_1 = __pyx_t_12;
               __pyx_L45_bool_binop_done:;
               if (__pyx_t_1) {
 
-                /* "fastrometry/cython_code/WCS.pyx":765
+                /* "fastrometry/cython_code/WCS.pyx":744
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  */
                 __pyx_t_27 = 2;
@@ -17219,15 +16612,15 @@
                 } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                 if (__pyx_t_28 < 0) {
                   __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                   if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                 } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                 if (unlikely(__pyx_t_24 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                  __PYX_ERR(0, 765, __pyx_L1_error)
+                  __PYX_ERR(0, 744, __pyx_L1_error)
                 }
                 __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
                 __pyx_t_12 = (1.0 <= __pyx_t_11);
                 if (__pyx_t_12) {
                   __pyx_t_12 = (__pyx_t_11 <= __pyx_v_img_xmax);
                 }
                 __pyx_t_13 = (__pyx_t_12 != 0);
@@ -17245,373 +16638,373 @@
                 } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                 if (__pyx_t_27 < 0) {
                   __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                   if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
                 } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                 if (unlikely(__pyx_t_24 != -1)) {
                   __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                  __PYX_ERR(0, 765, __pyx_L1_error)
+                  __PYX_ERR(0, 744, __pyx_L1_error)
                 }
                 __pyx_t_11 = (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )));
                 __pyx_t_13 = (1.0 <= __pyx_t_11);
                 if (__pyx_t_13) {
                   __pyx_t_13 = (__pyx_t_11 <= __pyx_v_img_ymax);
                 }
                 __pyx_t_12 = (__pyx_t_13 != 0);
                 __pyx_t_1 = __pyx_t_12;
                 __pyx_L48_bool_binop_done:;
                 if (__pyx_t_1) {
 
-                  /* "fastrometry/cython_code/WCS.pyx":766
+                  /* "fastrometry/cython_code/WCS.pyx":745
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:             # <<<<<<<<<<<<<<
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  */
-                  __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_45);
                   __pyx_t_27 = 0;
                   __pyx_t_28 = 1;
                   __pyx_t_24 = -1;
                   if (__pyx_t_27 < 0) {
                     __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                     if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
                   } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                   if (__pyx_t_28 < 0) {
                     __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                     if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                   } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                   if (unlikely(__pyx_t_24 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                    __PYX_ERR(0, 766, __pyx_L1_error)
+                    __PYX_ERR(0, 745, __pyx_L1_error)
                   }
-                  __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_4);
-                  __pyx_t_14 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_14 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_14);
                   __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_4);
                   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                  __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_4);
                   __pyx_t_28 = 0;
                   __pyx_t_27 = 0;
                   __pyx_t_24 = -1;
                   if (__pyx_t_28 < 0) {
                     __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                     if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 0;
                   } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                   if (__pyx_t_27 < 0) {
                     __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                     if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
                   } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                   if (unlikely(__pyx_t_24 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                    __PYX_ERR(0, 766, __pyx_L1_error)
+                    __PYX_ERR(0, 745, __pyx_L1_error)
                   }
-                  __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_14);
-                  __pyx_t_45 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_45 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_45);
                   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                  __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_14);
                   __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                  __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                   __pyx_t_27 = __pyx_t_18;
                   __pyx_t_28 = __pyx_t_46;
                   __pyx_t_24 = -1;
                   if (__pyx_t_27 < 0) {
                     __pyx_t_27 += __pyx_v_srcindexmap_initial_view.shape[0];
                     if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
                   } else if (unlikely(__pyx_t_27 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_24 = 0;
                   if (__pyx_t_28 < 0) {
                     __pyx_t_28 += __pyx_v_srcindexmap_initial_view.shape[1];
                     if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                   } else if (unlikely(__pyx_t_28 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_24 = 1;
                   if (unlikely(__pyx_t_24 != -1)) {
                     __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                    __PYX_ERR(0, 766, __pyx_L1_error)
+                    __PYX_ERR(0, 745, __pyx_L1_error)
                   }
-                  __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_GOTREF(__pyx_t_14);
-                  __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_A, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_A, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 766, __pyx_L1_error)
+                  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 745, __pyx_L1_error)
                   __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                   if (__pyx_t_1) {
 
-                    /* "fastrometry/cython_code/WCS.pyx":767
+                    /* "fastrometry/cython_code/WCS.pyx":746
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:             # <<<<<<<<<<<<<<
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  *                                                 matches = 0
  */
-                    __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_45);
                     __pyx_t_28 = 1;
                     __pyx_t_27 = 1;
                     __pyx_t_24 = -1;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 0;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                     if (__pyx_t_27 < 0) {
                       __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                       if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
                     } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                     if (unlikely(__pyx_t_24 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                      __PYX_ERR(0, 767, __pyx_L1_error)
+                      __PYX_ERR(0, 746, __pyx_L1_error)
                     }
-                    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_14);
-                    __pyx_t_4 = PyNumber_Subtract(__pyx_t_45, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_4 = PyNumber_Subtract(__pyx_t_45, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_4);
                     __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_14);
                     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                    __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_14);
                     __pyx_t_27 = 1;
                     __pyx_t_28 = 0;
                     __pyx_t_24 = -1;
                     if (__pyx_t_27 < 0) {
                       __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                       if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
                     } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                     if (unlikely(__pyx_t_24 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                      __PYX_ERR(0, 767, __pyx_L1_error)
+                      __PYX_ERR(0, 746, __pyx_L1_error)
                     }
-                    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_4);
-                    __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_45);
                     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_4);
                     __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                     __pyx_t_28 = __pyx_t_46;
                     __pyx_t_27 = __pyx_t_18;
                     __pyx_t_24 = -1;
                     if (__pyx_t_28 < 0) {
                       __pyx_t_28 += __pyx_v_srcindexmap_initial_view.shape[0];
                       if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 0;
                     } else if (unlikely(__pyx_t_28 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_24 = 0;
                     if (__pyx_t_27 < 0) {
                       __pyx_t_27 += __pyx_v_srcindexmap_initial_view.shape[1];
                       if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
                     } else if (unlikely(__pyx_t_27 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_24 = 1;
                     if (unlikely(__pyx_t_24 != -1)) {
                       __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                      __PYX_ERR(0, 767, __pyx_L1_error)
+                      __PYX_ERR(0, 746, __pyx_L1_error)
                     }
-                    __pyx_t_4 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_4 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_GOTREF(__pyx_t_4);
-                    __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_B, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_B, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 767, __pyx_L1_error)
+                    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
                     __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                     if (__pyx_t_1) {
 
-                      /* "fastrometry/cython_code/WCS.pyx":768
+                      /* "fastrometry/cython_code/WCS.pyx":747
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:             # <<<<<<<<<<<<<<
  *                                                 matches = 0
  *                                                 if debug:
  */
-                      __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_45);
                       __pyx_t_27 = 2;
                       __pyx_t_28 = 1;
                       __pyx_t_24 = -1;
                       if (__pyx_t_27 < 0) {
                         __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                         if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
                       } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                       if (__pyx_t_28 < 0) {
                         __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                         if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                       } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                       if (unlikely(__pyx_t_24 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                        __PYX_ERR(0, 768, __pyx_L1_error)
+                        __PYX_ERR(0, 747, __pyx_L1_error)
                       }
-                      __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
-                      __pyx_t_14 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_14 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_14);
                       __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_14, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
                       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                      __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_4);
                       __pyx_t_28 = 2;
                       __pyx_t_27 = 0;
                       __pyx_t_24 = -1;
                       if (__pyx_t_28 < 0) {
                         __pyx_t_28 += __pyx_v_invtransf_intrmtriangle_view.shape[0];
                         if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 0;
                       } else if (unlikely(__pyx_t_28 >= __pyx_v_invtransf_intrmtriangle_view.shape[0])) __pyx_t_24 = 0;
                       if (__pyx_t_27 < 0) {
                         __pyx_t_27 += __pyx_v_invtransf_intrmtriangle_view.shape[1];
                         if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 1;
                       } else if (unlikely(__pyx_t_27 >= __pyx_v_invtransf_intrmtriangle_view.shape[1])) __pyx_t_24 = 1;
                       if (unlikely(__pyx_t_24 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                        __PYX_ERR(0, 768, __pyx_L1_error)
+                        __PYX_ERR(0, 747, __pyx_L1_error)
                       }
-                      __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_invtransf_intrmtriangle_view.data + __pyx_t_28 * __pyx_v_invtransf_intrmtriangle_view.strides[0]) ) + __pyx_t_27 * __pyx_v_invtransf_intrmtriangle_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_14);
-                      __pyx_t_45 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_45 = PyNumber_Subtract(__pyx_t_4, __pyx_t_14); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_45);
                       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                      __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_14);
                       __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                      __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_46 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_46 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                       __pyx_t_27 = __pyx_t_18;
                       __pyx_t_28 = __pyx_t_46;
                       __pyx_t_24 = -1;
                       if (__pyx_t_27 < 0) {
                         __pyx_t_27 += __pyx_v_srcindexmap_initial_view.shape[0];
                         if (unlikely(__pyx_t_27 < 0)) __pyx_t_24 = 0;
                       } else if (unlikely(__pyx_t_27 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_24 = 0;
                       if (__pyx_t_28 < 0) {
                         __pyx_t_28 += __pyx_v_srcindexmap_initial_view.shape[1];
                         if (unlikely(__pyx_t_28 < 0)) __pyx_t_24 = 1;
                       } else if (unlikely(__pyx_t_28 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_24 = 1;
                       if (unlikely(__pyx_t_24 != -1)) {
                         __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                        __PYX_ERR(0, 768, __pyx_L1_error)
+                        __PYX_ERR(0, 747, __pyx_L1_error)
                       }
-                      __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_14 = __Pyx_PyInt_From_int((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_27 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_28 * __pyx_v_srcindexmap_initial_view.strides[1]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_GOTREF(__pyx_t_14);
-                      __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_C, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_45 = PyObject_RichCompare(__pyx_v_psesrcindex_C, __pyx_t_14, Py_EQ); __Pyx_XGOTREF(__pyx_t_45); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 768, __pyx_L1_error)
+                      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_45); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 747, __pyx_L1_error)
                       __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                       if (__pyx_t_1) {
 
-                        /* "fastrometry/cython_code/WCS.pyx":769
+                        /* "fastrometry/cython_code/WCS.pyx":748
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  *                                                 matches = 0             # <<<<<<<<<<<<<<
  *                                                 if debug:
  *                                                     invtransf_xs = []
  */
                         __pyx_v_matches = 0;
 
-                        /* "fastrometry/cython_code/WCS.pyx":770
+                        /* "fastrometry/cython_code/WCS.pyx":749
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  *                                                 matches = 0
  *                                                 if debug:             # <<<<<<<<<<<<<<
  *                                                     invtransf_xs = []
  *                                                     invtransf_ys = []
  */
                         __pyx_t_1 = (__pyx_v_debug != 0);
                         if (__pyx_t_1) {
 
-                          /* "fastrometry/cython_code/WCS.pyx":771
+                          /* "fastrometry/cython_code/WCS.pyx":750
  *                                                 matches = 0
  *                                                 if debug:
  *                                                     invtransf_xs = []             # <<<<<<<<<<<<<<
  *                                                     invtransf_ys = []
  *                                                     invtransf_match_xs = []
  */
-                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 771, __pyx_L1_error)
+                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 750, __pyx_L1_error)
                           __Pyx_GOTREF(__pyx_t_45);
                           __Pyx_XDECREF_SET(__pyx_v_invtransf_xs, __pyx_t_45);
                           __pyx_t_45 = 0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":772
+                          /* "fastrometry/cython_code/WCS.pyx":751
  *                                                 if debug:
  *                                                     invtransf_xs = []
  *                                                     invtransf_ys = []             # <<<<<<<<<<<<<<
  *                                                     invtransf_match_xs = []
  *                                                     invtransf_match_ys = []
  */
-                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 772, __pyx_L1_error)
+                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 751, __pyx_L1_error)
                           __Pyx_GOTREF(__pyx_t_45);
                           __Pyx_XDECREF_SET(__pyx_v_invtransf_ys, __pyx_t_45);
                           __pyx_t_45 = 0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":773
+                          /* "fastrometry/cython_code/WCS.pyx":752
  *                                                     invtransf_xs = []
  *                                                     invtransf_ys = []
  *                                                     invtransf_match_xs = []             # <<<<<<<<<<<<<<
  *                                                     invtransf_match_ys = []
  *                                                 for k in range(npts_intrm):
  */
-                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 773, __pyx_L1_error)
+                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 752, __pyx_L1_error)
                           __Pyx_GOTREF(__pyx_t_45);
                           __Pyx_XDECREF_SET(__pyx_v_invtransf_match_xs, __pyx_t_45);
                           __pyx_t_45 = 0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":774
+                          /* "fastrometry/cython_code/WCS.pyx":753
  *                                                     invtransf_ys = []
  *                                                     invtransf_match_xs = []
  *                                                     invtransf_match_ys = []             # <<<<<<<<<<<<<<
  *                                                 for k in range(npts_intrm):
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  */
-                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 774, __pyx_L1_error)
+                          __pyx_t_45 = PyList_New(0); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 753, __pyx_L1_error)
                           __Pyx_GOTREF(__pyx_t_45);
                           __Pyx_XDECREF_SET(__pyx_v_invtransf_match_ys, __pyx_t_45);
                           __pyx_t_45 = 0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":770
+                          /* "fastrometry/cython_code/WCS.pyx":749
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  *                                                 matches = 0
  *                                                 if debug:             # <<<<<<<<<<<<<<
  *                                                     invtransf_xs = []
  *                                                     invtransf_ys = []
  */
                         }
 
-                        /* "fastrometry/cython_code/WCS.pyx":775
+                        /* "fastrometry/cython_code/WCS.pyx":754
  *                                                     invtransf_match_xs = []
  *                                                     invtransf_match_ys = []
  *                                                 for k in range(npts_intrm):             # <<<<<<<<<<<<<<
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *                                                     if debug:
  */
                         __pyx_t_24 = __pyx_v_npts_intrm;
                         __pyx_t_47 = __pyx_t_24;
                         for (__pyx_t_46 = 0; __pyx_t_46 < __pyx_t_47; __pyx_t_46+=1) {
                           __pyx_v_k = __pyx_t_46;
 
-                          /* "fastrometry/cython_code/WCS.pyx":776
+                          /* "fastrometry/cython_code/WCS.pyx":755
  *                                                     invtransf_match_ys = []
  *                                                 for k in range(npts_intrm):
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)             # <<<<<<<<<<<<<<
  *                                                     if debug:
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  */
                           __pyx_t_28 = __pyx_v_k;
@@ -17623,116 +17016,116 @@
                           } else if (unlikely(__pyx_t_28 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_48 = 0;
                           if (__pyx_t_27 < 0) {
                             __pyx_t_27 += __pyx_v_intrmpoints_view.shape[1];
                             if (unlikely(__pyx_t_27 < 0)) __pyx_t_48 = 1;
                           } else if (unlikely(__pyx_t_27 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_48 = 1;
                           if (unlikely(__pyx_t_48 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                            __PYX_ERR(0, 776, __pyx_L1_error)
+                            __PYX_ERR(0, 755, __pyx_L1_error)
                           }
                           __pyx_t_29 = __pyx_v_k;
                           __pyx_t_30 = 1;
                           __pyx_t_48 = -1;
                           if (__pyx_t_29 < 0) {
                             __pyx_t_29 += __pyx_v_intrmpoints_view.shape[0];
                             if (unlikely(__pyx_t_29 < 0)) __pyx_t_48 = 0;
                           } else if (unlikely(__pyx_t_29 >= __pyx_v_intrmpoints_view.shape[0])) __pyx_t_48 = 0;
                           if (__pyx_t_30 < 0) {
                             __pyx_t_30 += __pyx_v_intrmpoints_view.shape[1];
                             if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 1;
                           } else if (unlikely(__pyx_t_30 >= __pyx_v_intrmpoints_view.shape[1])) __pyx_t_48 = 1;
                           if (unlikely(__pyx_t_48 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                            __PYX_ERR(0, 776, __pyx_L1_error)
+                            __PYX_ERR(0, 755, __pyx_L1_error)
                           }
-                          __pyx_t_45 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_28 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_27 * __pyx_v_intrmpoints_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_29 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_30 * __pyx_v_intrmpoints_view.strides[1]) ))), __pyx_v_invtransf_intrmpoint_view); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 776, __pyx_L1_error)
+                          __pyx_t_45 = __pyx_f_11fastrometry_11cython_code_3WCS_inverseTransformPointUsingSphi(__pyx_v_S, __pyx_v_phi, __pyx_v_CRPIXx, __pyx_v_CRPIXy, (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_28 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_27 * __pyx_v_intrmpoints_view.strides[1]) ))), (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_intrmpoints_view.data + __pyx_t_29 * __pyx_v_intrmpoints_view.strides[0]) ) + __pyx_t_30 * __pyx_v_intrmpoints_view.strides[1]) ))), __pyx_v_invtransf_intrmpoint_view); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 755, __pyx_L1_error)
                           __Pyx_GOTREF(__pyx_t_45);
                           __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":777
+                          /* "fastrometry/cython_code/WCS.pyx":756
  *                                                 for k in range(npts_intrm):
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *                                                     if debug:             # <<<<<<<<<<<<<<
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
                           __pyx_t_1 = (__pyx_v_debug != 0);
                           if (__pyx_t_1) {
 
-                            /* "fastrometry/cython_code/WCS.pyx":778
+                            /* "fastrometry/cython_code/WCS.pyx":757
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *                                                     if debug:
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  */
-                            if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 778, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 757, __pyx_L1_error) }
                             __pyx_t_30 = 0;
                             __pyx_t_48 = -1;
                             if (__pyx_t_30 < 0) {
                               __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                               if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                             } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                             if (unlikely(__pyx_t_48 != -1)) {
                               __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                              __PYX_ERR(0, 778, __pyx_L1_error)
+                              __PYX_ERR(0, 757, __pyx_L1_error)
                             }
-                            __pyx_t_45 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 778, __pyx_L1_error)
+                            __pyx_t_45 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 757, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_xs, __pyx_t_45); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 778, __pyx_L1_error)
+                            __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_xs, __pyx_t_45); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 757, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":779
+                            /* "fastrometry/cython_code/WCS.pyx":758
  *                                                     if debug:
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  */
-                            if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 779, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 758, __pyx_L1_error) }
                             __pyx_t_30 = 1;
                             __pyx_t_48 = -1;
                             if (__pyx_t_30 < 0) {
                               __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                               if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                             } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                             if (unlikely(__pyx_t_48 != -1)) {
                               __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                              __PYX_ERR(0, 779, __pyx_L1_error)
+                              __PYX_ERR(0, 758, __pyx_L1_error)
                             }
-                            __pyx_t_45 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 779, __pyx_L1_error)
+                            __pyx_t_45 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 758, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_ys, __pyx_t_45); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 779, __pyx_L1_error)
+                            __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_ys, __pyx_t_45); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 758, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":777
+                            /* "fastrometry/cython_code/WCS.pyx":756
  *                                                 for k in range(npts_intrm):
  *                                                     inverseTransformPointUsingSphi(S, phi, CRPIXx, CRPIXy, intrmpoints_view[k,0], intrmpoints_view[k,1], invtransf_intrmpoint_view)
  *                                                     if debug:             # <<<<<<<<<<<<<<
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  */
                           }
 
-                          /* "fastrometry/cython_code/WCS.pyx":780
+                          /* "fastrometry/cython_code/WCS.pyx":759
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  *                                                             matches += 1
  */
                           __pyx_t_30 = 0;
                           __pyx_t_48 = -1;
                           if (__pyx_t_30 < 0) {
                             __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                             if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                           } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                           if (unlikely(__pyx_t_48 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                            __PYX_ERR(0, 780, __pyx_L1_error)
+                            __PYX_ERR(0, 759, __pyx_L1_error)
                           }
                           __pyx_t_11 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
                           __pyx_t_12 = (1.0 <= __pyx_t_11);
                           if (__pyx_t_12) {
                             __pyx_t_12 = (__pyx_t_11 <= __pyx_v_img_xmax);
                           }
                           __pyx_t_13 = (__pyx_t_12 != 0);
@@ -17745,346 +17138,346 @@
                           __pyx_t_48 = -1;
                           if (__pyx_t_30 < 0) {
                             __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                             if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                           } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                           if (unlikely(__pyx_t_48 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                            __PYX_ERR(0, 780, __pyx_L1_error)
+                            __PYX_ERR(0, 759, __pyx_L1_error)
                           }
                           __pyx_t_11 = (*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )));
                           __pyx_t_13 = (1.0 <= __pyx_t_11);
                           if (__pyx_t_13) {
                             __pyx_t_13 = (__pyx_t_11 <= __pyx_v_img_ymax);
                           }
                           __pyx_t_12 = (__pyx_t_13 != 0);
                           __pyx_t_1 = __pyx_t_12;
                           __pyx_L58_bool_binop_done:;
                           if (__pyx_t_1) {
 
-                            /* "fastrometry/cython_code/WCS.pyx":781
+                            /* "fastrometry/cython_code/WCS.pyx":760
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:             # <<<<<<<<<<<<<<
  *                                                             matches += 1
  *                                                             if debug:
  */
-                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __pyx_t_30 = 1;
                             __pyx_t_48 = -1;
                             if (__pyx_t_30 < 0) {
                               __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                               if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                             } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                             if (unlikely(__pyx_t_48 != -1)) {
                               __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                              __PYX_ERR(0, 781, __pyx_L1_error)
+                              __PYX_ERR(0, 760, __pyx_L1_error)
                             }
-                            __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __pyx_t_4 = PyNumber_Subtract(__pyx_t_45, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_4 = PyNumber_Subtract(__pyx_t_45, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_18 = __Pyx_PyIndex_AsSsize_t(__pyx_t_14); if (unlikely((__pyx_t_18 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_30 = 0;
                             __pyx_t_48 = -1;
                             if (__pyx_t_30 < 0) {
                               __pyx_t_30 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                               if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                             } else if (unlikely(__pyx_t_30 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                             if (unlikely(__pyx_t_48 != -1)) {
                               __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                              __PYX_ERR(0, 781, __pyx_L1_error)
+                              __PYX_ERR(0, 760, __pyx_L1_error)
                             }
-                            __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyInt_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_30 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyInt_SubtractObjC(__pyx_t_45, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            __pyx_t_50 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_50 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 781, __pyx_L1_error)
+                            __pyx_t_50 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_50 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 760, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __pyx_t_30 = __pyx_t_18;
                             __pyx_t_29 = __pyx_t_50;
                             __pyx_t_48 = -1;
                             if (__pyx_t_30 < 0) {
                               __pyx_t_30 += __pyx_v_srcindexmap_initial_view.shape[0];
                               if (unlikely(__pyx_t_30 < 0)) __pyx_t_48 = 0;
                             } else if (unlikely(__pyx_t_30 >= __pyx_v_srcindexmap_initial_view.shape[0])) __pyx_t_48 = 0;
                             if (__pyx_t_29 < 0) {
                               __pyx_t_29 += __pyx_v_srcindexmap_initial_view.shape[1];
                               if (unlikely(__pyx_t_29 < 0)) __pyx_t_48 = 1;
                             } else if (unlikely(__pyx_t_29 >= __pyx_v_srcindexmap_initial_view.shape[1])) __pyx_t_48 = 1;
                             if (unlikely(__pyx_t_48 != -1)) {
                               __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                              __PYX_ERR(0, 781, __pyx_L1_error)
+                              __PYX_ERR(0, 760, __pyx_L1_error)
                             }
                             __pyx_t_1 = (((*((int *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_srcindexmap_initial_view.data + __pyx_t_30 * __pyx_v_srcindexmap_initial_view.strides[0]) ) + __pyx_t_29 * __pyx_v_srcindexmap_initial_view.strides[1]) ))) != -1L) != 0);
                             if (__pyx_t_1) {
 
-                              /* "fastrometry/cython_code/WCS.pyx":782
+                              /* "fastrometry/cython_code/WCS.pyx":761
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  *                                                             matches += 1             # <<<<<<<<<<<<<<
  *                                                             if debug:
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  */
                               __pyx_v_matches = (__pyx_v_matches + 1);
 
-                              /* "fastrometry/cython_code/WCS.pyx":783
+                              /* "fastrometry/cython_code/WCS.pyx":762
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  *                                                             matches += 1
  *                                                             if debug:             # <<<<<<<<<<<<<<
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
                               __pyx_t_1 = (__pyx_v_debug != 0);
                               if (__pyx_t_1) {
 
-                                /* "fastrometry/cython_code/WCS.pyx":784
+                                /* "fastrometry/cython_code/WCS.pyx":763
  *                                                             matches += 1
  *                                                             if debug:
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])             # <<<<<<<<<<<<<<
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  *                                                 if matches >= minmatches:
  */
-                                if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 784, __pyx_L1_error) }
+                                if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 763, __pyx_L1_error) }
                                 __pyx_t_29 = 0;
                                 __pyx_t_48 = -1;
                                 if (__pyx_t_29 < 0) {
                                   __pyx_t_29 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                                   if (unlikely(__pyx_t_29 < 0)) __pyx_t_48 = 0;
                                 } else if (unlikely(__pyx_t_29 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                                 if (unlikely(__pyx_t_48 != -1)) {
                                   __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                                  __PYX_ERR(0, 784, __pyx_L1_error)
+                                  __PYX_ERR(0, 763, __pyx_L1_error)
                                 }
-                                __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_29 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
+                                __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_29 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 763, __pyx_L1_error)
                                 __Pyx_GOTREF(__pyx_t_4);
-                                __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_match_xs, __pyx_t_4); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 784, __pyx_L1_error)
+                                __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_match_xs, __pyx_t_4); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 763, __pyx_L1_error)
                                 __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                                /* "fastrometry/cython_code/WCS.pyx":785
+                                /* "fastrometry/cython_code/WCS.pyx":764
  *                                                             if debug:
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])             # <<<<<<<<<<<<<<
  *                                                 if matches >= minmatches:
  *                                                     initial_solution_view[0] = S
  */
-                                if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 785, __pyx_L1_error) }
+                                if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 764, __pyx_L1_error) }
                                 __pyx_t_29 = 1;
                                 __pyx_t_48 = -1;
                                 if (__pyx_t_29 < 0) {
                                   __pyx_t_29 += __pyx_v_invtransf_intrmpoint_view.shape[0];
                                   if (unlikely(__pyx_t_29 < 0)) __pyx_t_48 = 0;
                                 } else if (unlikely(__pyx_t_29 >= __pyx_v_invtransf_intrmpoint_view.shape[0])) __pyx_t_48 = 0;
                                 if (unlikely(__pyx_t_48 != -1)) {
                                   __Pyx_RaiseBufferIndexError(__pyx_t_48);
-                                  __PYX_ERR(0, 785, __pyx_L1_error)
+                                  __PYX_ERR(0, 764, __pyx_L1_error)
                                 }
-                                __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_29 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)
+                                __pyx_t_4 = PyFloat_FromDouble((*((double *) ( /* dim=0 */ (__pyx_v_invtransf_intrmpoint_view.data + __pyx_t_29 * __pyx_v_invtransf_intrmpoint_view.strides[0]) )))); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 764, __pyx_L1_error)
                                 __Pyx_GOTREF(__pyx_t_4);
-                                __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_match_ys, __pyx_t_4); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 785, __pyx_L1_error)
+                                __pyx_t_49 = __Pyx_PyObject_Append(__pyx_v_invtransf_match_ys, __pyx_t_4); if (unlikely(__pyx_t_49 == ((int)-1))) __PYX_ERR(0, 764, __pyx_L1_error)
                                 __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                                /* "fastrometry/cython_code/WCS.pyx":783
+                                /* "fastrometry/cython_code/WCS.pyx":762
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  *                                                             matches += 1
  *                                                             if debug:             # <<<<<<<<<<<<<<
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  */
                               }
 
-                              /* "fastrometry/cython_code/WCS.pyx":781
+                              /* "fastrometry/cython_code/WCS.pyx":760
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:             # <<<<<<<<<<<<<<
  *                                                             matches += 1
  *                                                             if debug:
  */
                             }
 
-                            /* "fastrometry/cython_code/WCS.pyx":780
+                            /* "fastrometry/cython_code/WCS.pyx":759
  *                                                         invtransf_xs.append(invtransf_intrmpoint_view[0])
  *                                                         invtransf_ys.append(invtransf_intrmpoint_view[1])
  *                                                     if 1 <= invtransf_intrmpoint_view[0] <= img_xmax and 1 <= invtransf_intrmpoint_view[1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                                         if srcindexmap_initial_view[img_ymax-int(invtransf_intrmpoint_view[1])-1,img_xmax-int(invtransf_intrmpoint_view[0])-1] != -1:
  *                                                             matches += 1
  */
                           }
                         }
 
-                        /* "fastrometry/cython_code/WCS.pyx":786
+                        /* "fastrometry/cython_code/WCS.pyx":765
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  *                                                 if matches >= minmatches:             # <<<<<<<<<<<<<<
  *                                                     initial_solution_view[0] = S
  *                                                     initial_solution_view[1] = phi
  */
                         __pyx_t_1 = ((__pyx_v_matches >= __pyx_v_minmatches) != 0);
                         if (__pyx_t_1) {
 
-                          /* "fastrometry/cython_code/WCS.pyx":787
+                          /* "fastrometry/cython_code/WCS.pyx":766
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  *                                                 if matches >= minmatches:
  *                                                     initial_solution_view[0] = S             # <<<<<<<<<<<<<<
  *                                                     initial_solution_view[1] = phi
  *                                                     initial_solution_view[2] = CRPIXx
  */
                           __pyx_t_29 = 0;
                           __pyx_t_24 = -1;
                           if (__pyx_t_29 < 0) {
                             __pyx_t_29 += __pyx_v_initial_solution_view.shape[0];
                             if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 0;
                           } else if (unlikely(__pyx_t_29 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_24 = 0;
                           if (unlikely(__pyx_t_24 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                            __PYX_ERR(0, 787, __pyx_L1_error)
+                            __PYX_ERR(0, 766, __pyx_L1_error)
                           }
                           *((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_29 * __pyx_v_initial_solution_view.strides[0]) )) = __pyx_v_S;
 
-                          /* "fastrometry/cython_code/WCS.pyx":788
+                          /* "fastrometry/cython_code/WCS.pyx":767
  *                                                 if matches >= minmatches:
  *                                                     initial_solution_view[0] = S
  *                                                     initial_solution_view[1] = phi             # <<<<<<<<<<<<<<
  *                                                     initial_solution_view[2] = CRPIXx
  *                                                     initial_solution_view[3] = CRPIXy
  */
                           __pyx_t_29 = 1;
                           __pyx_t_24 = -1;
                           if (__pyx_t_29 < 0) {
                             __pyx_t_29 += __pyx_v_initial_solution_view.shape[0];
                             if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 0;
                           } else if (unlikely(__pyx_t_29 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_24 = 0;
                           if (unlikely(__pyx_t_24 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                            __PYX_ERR(0, 788, __pyx_L1_error)
+                            __PYX_ERR(0, 767, __pyx_L1_error)
                           }
                           *((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_29 * __pyx_v_initial_solution_view.strides[0]) )) = __pyx_v_phi;
 
-                          /* "fastrometry/cython_code/WCS.pyx":789
+                          /* "fastrometry/cython_code/WCS.pyx":768
  *                                                     initial_solution_view[0] = S
  *                                                     initial_solution_view[1] = phi
  *                                                     initial_solution_view[2] = CRPIXx             # <<<<<<<<<<<<<<
  *                                                     initial_solution_view[3] = CRPIXy
  * 
  */
                           __pyx_t_29 = 2;
                           __pyx_t_24 = -1;
                           if (__pyx_t_29 < 0) {
                             __pyx_t_29 += __pyx_v_initial_solution_view.shape[0];
                             if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 0;
                           } else if (unlikely(__pyx_t_29 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_24 = 0;
                           if (unlikely(__pyx_t_24 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                            __PYX_ERR(0, 789, __pyx_L1_error)
+                            __PYX_ERR(0, 768, __pyx_L1_error)
                           }
                           *((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_29 * __pyx_v_initial_solution_view.strides[0]) )) = __pyx_v_CRPIXx;
 
-                          /* "fastrometry/cython_code/WCS.pyx":790
+                          /* "fastrometry/cython_code/WCS.pyx":769
  *                                                     initial_solution_view[1] = phi
  *                                                     initial_solution_view[2] = CRPIXx
  *                                                     initial_solution_view[3] = CRPIXy             # <<<<<<<<<<<<<<
  * 
  *                                                     if verbosity >= 1:
  */
                           __pyx_t_29 = 3;
                           __pyx_t_24 = -1;
                           if (__pyx_t_29 < 0) {
                             __pyx_t_29 += __pyx_v_initial_solution_view.shape[0];
                             if (unlikely(__pyx_t_29 < 0)) __pyx_t_24 = 0;
                           } else if (unlikely(__pyx_t_29 >= __pyx_v_initial_solution_view.shape[0])) __pyx_t_24 = 0;
                           if (unlikely(__pyx_t_24 != -1)) {
                             __Pyx_RaiseBufferIndexError(__pyx_t_24);
-                            __PYX_ERR(0, 790, __pyx_L1_error)
+                            __PYX_ERR(0, 769, __pyx_L1_error)
                           }
                           *((double *) ( /* dim=0 */ (__pyx_v_initial_solution_view.data + __pyx_t_29 * __pyx_v_initial_solution_view.strides[0]) )) = __pyx_v_CRPIXy;
 
-                          /* "fastrometry/cython_code/WCS.pyx":792
+                          /* "fastrometry/cython_code/WCS.pyx":771
  *                                                     initial_solution_view[3] = CRPIXy
  * 
  *                                                     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *                                                         print("| | Found {} matches.".format(matches))
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))
  */
                           __pyx_t_1 = ((__pyx_v_verbosity >= 1) != 0);
                           if (__pyx_t_1) {
 
-                            /* "fastrometry/cython_code/WCS.pyx":793
+                            /* "fastrometry/cython_code/WCS.pyx":772
  * 
  *                                                     if verbosity >= 1:
  *                                                         print("| | Found {} matches.".format(matches))             # <<<<<<<<<<<<<<
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))
  * 
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches_2, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 793, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Found_matches_2, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 772, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 793, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_matches); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 772, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_44 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_44 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_44)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_44);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_44) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_44, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 772, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 793, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 772, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":794
+                            /* "fastrometry/cython_code/WCS.pyx":773
  *                                                     if verbosity >= 1:
  *                                                         print("| | Found {} matches.".format(matches))
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))             # <<<<<<<<<<<<<<
  * 
  *                                                     if verbosity == 2:
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Initial_solution_vector, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Initial_solution_vector, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __Pyx_GetModuleGlobalName(__pyx_t_44, __pyx_n_s_np); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_44, __pyx_n_s_np); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_44, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_44, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            __pyx_t_44 = __pyx_memoryview_fromslice(__pyx_v_initial_solution_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            __pyx_t_44 = __pyx_memoryview_fromslice(__pyx_v_initial_solution_view, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __pyx_t_42 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_43))) {
                               __pyx_t_42 = PyMethod_GET_SELF(__pyx_t_43);
                               if (likely(__pyx_t_42)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_43);
                                 __Pyx_INCREF(__pyx_t_42);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_43, function);
                               }
                             }
                             __pyx_t_14 = (__pyx_t_42) ? __Pyx_PyObject_Call2Args(__pyx_t_43, __pyx_t_42, __pyx_t_44) : __Pyx_PyObject_CallOneArg(__pyx_t_43, __pyx_t_44);
                             __Pyx_XDECREF(__pyx_t_42); __pyx_t_42 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
@@ -18092,495 +17485,495 @@
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 794, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 773, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":792
+                            /* "fastrometry/cython_code/WCS.pyx":771
  *                                                     initial_solution_view[3] = CRPIXy
  * 
  *                                                     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *                                                         print("| | Found {} matches.".format(matches))
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))
  */
                           }
 
-                          /* "fastrometry/cython_code/WCS.pyx":796
+                          /* "fastrometry/cython_code/WCS.pyx":775
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))
  * 
  *                                                     if verbosity == 2:             # <<<<<<<<<<<<<<
  *                                                         print("| | * Scale (arcsec/pixel): {}".format(S*3600*180/pi))
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))
  */
                           __pyx_t_1 = ((__pyx_v_verbosity == 2) != 0);
                           if (__pyx_t_1) {
 
-                            /* "fastrometry/cython_code/WCS.pyx":797
+                            /* "fastrometry/cython_code/WCS.pyx":776
  * 
  *                                                     if verbosity == 2:
  *                                                         print("| | * Scale (arcsec/pixel): {}".format(S*3600*180/pi))             # <<<<<<<<<<<<<<
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))
  *                                                         print("| | * CRPIX1: {}".format(CRPIXx))
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Scale_arcsec_pixel, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 797, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Scale_arcsec_pixel, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 776, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __pyx_t_11 = ((__pyx_v_S * 3600.0) * 180.0);
                             if (unlikely(M_PI == 0)) {
                               PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-                              __PYX_ERR(0, 797, __pyx_L1_error)
+                              __PYX_ERR(0, 776, __pyx_L1_error)
                             }
-                            __pyx_t_14 = PyFloat_FromDouble((__pyx_t_11 / M_PI)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 797, __pyx_L1_error)
+                            __pyx_t_14 = PyFloat_FromDouble((__pyx_t_11 / M_PI)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 776, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 797, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 797, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 776, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":798
+                            /* "fastrometry/cython_code/WCS.pyx":777
  *                                                     if verbosity == 2:
  *                                                         print("| | * Scale (arcsec/pixel): {}".format(S*3600*180/pi))
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))             # <<<<<<<<<<<<<<
  *                                                         print("| | * CRPIX1: {}".format(CRPIXx))
  *                                                         print("| | * CRPIX2: {}".format(CRPIXy))
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Rotation_degrees, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 798, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Rotation_degrees, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 777, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __pyx_t_11 = (__pyx_v_phi * 180.0);
                             if (unlikely(M_PI == 0)) {
                               PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-                              __PYX_ERR(0, 798, __pyx_L1_error)
+                              __PYX_ERR(0, 777, __pyx_L1_error)
                             }
-                            __pyx_t_14 = PyFloat_FromDouble((__pyx_t_11 / M_PI)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 798, __pyx_L1_error)
+                            __pyx_t_14 = PyFloat_FromDouble((__pyx_t_11 / M_PI)); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 777, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 798, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 798, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 777, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":799
+                            /* "fastrometry/cython_code/WCS.pyx":778
  *                                                         print("| | * Scale (arcsec/pixel): {}".format(S*3600*180/pi))
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))
  *                                                         print("| | * CRPIX1: {}".format(CRPIXx))             # <<<<<<<<<<<<<<
  *                                                         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 799, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 778, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 799, __pyx_L1_error)
+                            __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXx); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 778, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 799, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 778, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":800
+                            /* "fastrometry/cython_code/WCS.pyx":779
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))
  *                                                         print("| | * CRPIX1: {}".format(CRPIXx))
  *                                                         print("| | * CRPIX2: {}".format(CRPIXy))             # <<<<<<<<<<<<<<
  * 
  *                                                     if debug:
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 800, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2, __pyx_n_s_format); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 779, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 800, __pyx_L1_error)
+                            __pyx_t_14 = PyFloat_FromDouble(__pyx_v_CRPIXy); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 779, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_t_14);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 800, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+                            if (__Pyx_PrintOne(0, __pyx_t_4) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":796
+                            /* "fastrometry/cython_code/WCS.pyx":775
  *                                                         print("| | Initial solution vector: {}".format(np.asarray(initial_solution_view)))
  * 
  *                                                     if verbosity == 2:             # <<<<<<<<<<<<<<
  *                                                         print("| | * Scale (arcsec/pixel): {}".format(S*3600*180/pi))
  *                                                         print("| | * Rotation (degrees): {}".format(phi*180/pi))
  */
                           }
 
-                          /* "fastrometry/cython_code/WCS.pyx":802
+                          /* "fastrometry/cython_code/WCS.pyx":781
  *                                                         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  *                                                     if debug:             # <<<<<<<<<<<<<<
  *                                                         import matplotlib.pyplot as plt
  *                                                         from matplotlib.colors import LogNorm
  */
                           __pyx_t_1 = (__pyx_v_debug != 0);
                           if (__pyx_t_1) {
 
-                            /* "fastrometry/cython_code/WCS.pyx":803
+                            /* "fastrometry/cython_code/WCS.pyx":782
  * 
  *                                                     if debug:
  *                                                         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *                                                         from matplotlib.colors import LogNorm
  *                                                         from astropy.io import fits
  */
-                            __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
+                            __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 782, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            __Pyx_INCREF(__pyx_n_s__8);
-                            __Pyx_GIVEREF(__pyx_n_s__8);
-                            PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s__8);
-                            __pyx_t_45 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_4, -1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 803, __pyx_L1_error)
+                            __Pyx_INCREF(__pyx_n_s__4);
+                            __Pyx_GIVEREF(__pyx_n_s__4);
+                            PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s__4);
+                            __pyx_t_45 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_4, -1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 782, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_plt, __pyx_t_45);
                             __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":804
+                            /* "fastrometry/cython_code/WCS.pyx":783
  *                                                     if debug:
  *                                                         import matplotlib.pyplot as plt
  *                                                         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *                                                         from astropy.io import fits
  * 
  */
-                            __pyx_t_45 = PyList_New(1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 804, __pyx_L1_error)
+                            __pyx_t_45 = PyList_New(1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 783, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_INCREF(__pyx_n_s_LogNorm);
                             __Pyx_GIVEREF(__pyx_n_s_LogNorm);
                             PyList_SET_ITEM(__pyx_t_45, 0, __pyx_n_s_LogNorm);
-                            __pyx_t_4 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_45, -1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_45, -1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 783, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            __pyx_t_45 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 804, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_ImportFrom(__pyx_t_4, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 783, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_INCREF(__pyx_t_45);
                             __Pyx_XDECREF_SET(__pyx_v_LogNorm, __pyx_t_45);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":805
+                            /* "fastrometry/cython_code/WCS.pyx":784
  *                                                         import matplotlib.pyplot as plt
  *                                                         from matplotlib.colors import LogNorm
  *                                                         from astropy.io import fits             # <<<<<<<<<<<<<<
  * 
  *                                                         invtransf_xs = img_xmax-np.asarray(invtransf_xs)
  */
-                            __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 805, __pyx_L1_error)
+                            __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_INCREF(__pyx_n_s_fits);
                             __Pyx_GIVEREF(__pyx_n_s_fits);
                             PyList_SET_ITEM(__pyx_t_4, 0, __pyx_n_s_fits);
-                            __pyx_t_45 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_4, -1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 805, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_4, -1); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 784, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_45, __pyx_n_s_fits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 805, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_ImportFrom(__pyx_t_45, __pyx_n_s_fits); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 784, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_INCREF(__pyx_t_4);
                             __Pyx_XDECREF_SET(__pyx_v_fits, __pyx_t_4);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":807
+                            /* "fastrometry/cython_code/WCS.pyx":786
  *                                                         from astropy.io import fits
  * 
  *                                                         invtransf_xs = img_xmax-np.asarray(invtransf_xs)             # <<<<<<<<<<<<<<
  *                                                         invtransf_ys = img_ymax-np.asarray(invtransf_ys)
  *                                                         invtransf_match_xs = img_xmax-np.asarray(invtransf_match_xs)
  */
-                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 807, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 786, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 807, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 786, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 807, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 786, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 807, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_xs"); __PYX_ERR(0, 786, __pyx_L1_error) }
                             __pyx_t_14 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_43))) {
                               __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_43);
                               if (likely(__pyx_t_14)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_43);
                                 __Pyx_INCREF(__pyx_t_14);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_43, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_43, __pyx_t_14, __pyx_v_invtransf_xs) : __Pyx_PyObject_CallOneArg(__pyx_t_43, __pyx_v_invtransf_xs);
                             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 807, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
-                            __pyx_t_43 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 807, __pyx_L1_error)
+                            __pyx_t_43 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 786, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_invtransf_xs, __pyx_t_43);
                             __pyx_t_43 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":808
+                            /* "fastrometry/cython_code/WCS.pyx":787
  * 
  *                                                         invtransf_xs = img_xmax-np.asarray(invtransf_xs)
  *                                                         invtransf_ys = img_ymax-np.asarray(invtransf_ys)             # <<<<<<<<<<<<<<
  *                                                         invtransf_match_xs = img_xmax-np.asarray(invtransf_match_xs)
  *                                                         invtransf_match_ys = img_ymax-np.asarray(invtransf_match_ys)
  */
-                            __pyx_t_43 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 808, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 787, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 808, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 787, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 808, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 787, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 808, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_ys"); __PYX_ERR(0, 787, __pyx_L1_error) }
                             __pyx_t_45 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
                               __pyx_t_45 = PyMethod_GET_SELF(__pyx_t_14);
                               if (likely(__pyx_t_45)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
                                 __Pyx_INCREF(__pyx_t_45);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_14, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_45) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_45, __pyx_v_invtransf_ys) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_invtransf_ys);
                             __Pyx_XDECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 808, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            __pyx_t_14 = PyNumber_Subtract(__pyx_t_43, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 808, __pyx_L1_error)
+                            __pyx_t_14 = PyNumber_Subtract(__pyx_t_43, __pyx_t_4); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 787, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_invtransf_ys, __pyx_t_14);
                             __pyx_t_14 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":809
+                            /* "fastrometry/cython_code/WCS.pyx":788
  *                                                         invtransf_xs = img_xmax-np.asarray(invtransf_xs)
  *                                                         invtransf_ys = img_ymax-np.asarray(invtransf_ys)
  *                                                         invtransf_match_xs = img_xmax-np.asarray(invtransf_match_xs)             # <<<<<<<<<<<<<<
  *                                                         invtransf_match_ys = img_ymax-np.asarray(invtransf_match_ys)
  *                                                         fig = plt.figure(figsize=(9.5,8))
  */
-                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 809, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyInt_From_int(__pyx_v_img_xmax); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 788, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __Pyx_GetModuleGlobalName(__pyx_t_43, __pyx_n_s_np); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 809, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_43, __pyx_n_s_np); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 788, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_t_43, __pyx_n_s_asarray); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 809, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_t_43, __pyx_n_s_asarray); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 788, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
-                            if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 809, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_match_xs)) { __Pyx_RaiseUnboundLocalError("invtransf_match_xs"); __PYX_ERR(0, 788, __pyx_L1_error) }
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_45))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_45);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_45);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_45, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_45, __pyx_t_43, __pyx_v_invtransf_match_xs) : __Pyx_PyObject_CallOneArg(__pyx_t_45, __pyx_v_invtransf_match_xs);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 809, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 809, __pyx_L1_error)
+                            __pyx_t_45 = PyNumber_Subtract(__pyx_t_14, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 788, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_invtransf_match_xs, __pyx_t_45);
                             __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":810
+                            /* "fastrometry/cython_code/WCS.pyx":789
  *                                                         invtransf_ys = img_ymax-np.asarray(invtransf_ys)
  *                                                         invtransf_match_xs = img_xmax-np.asarray(invtransf_match_xs)
  *                                                         invtransf_match_ys = img_ymax-np.asarray(invtransf_match_ys)             # <<<<<<<<<<<<<<
  *                                                         fig = plt.figure(figsize=(9.5,8))
  * 
  */
-                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 810, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_img_ymax); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 789, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 810, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_14, __pyx_n_s_np); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 789, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 810, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_t_14, __pyx_n_s_asarray); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 789, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 810, __pyx_L1_error) }
+                            if (unlikely(!__pyx_v_invtransf_match_ys)) { __Pyx_RaiseUnboundLocalError("invtransf_match_ys"); __PYX_ERR(0, 789, __pyx_L1_error) }
                             __pyx_t_14 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_43))) {
                               __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_43);
                               if (likely(__pyx_t_14)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_43);
                                 __Pyx_INCREF(__pyx_t_14);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_43, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_14) ? __Pyx_PyObject_Call2Args(__pyx_t_43, __pyx_t_14, __pyx_v_invtransf_match_ys) : __Pyx_PyObject_CallOneArg(__pyx_t_43, __pyx_v_invtransf_match_ys);
                             __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 789, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
-                            __pyx_t_43 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 810, __pyx_L1_error)
+                            __pyx_t_43 = PyNumber_Subtract(__pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 789, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_invtransf_match_ys, __pyx_t_43);
                             __pyx_t_43 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":811
+                            /* "fastrometry/cython_code/WCS.pyx":790
  *                                                         invtransf_match_xs = img_xmax-np.asarray(invtransf_match_xs)
  *                                                         invtransf_match_ys = img_ymax-np.asarray(invtransf_match_ys)
  *                                                         fig = plt.figure(figsize=(9.5,8))             # <<<<<<<<<<<<<<
  * 
  *                                                         axes = fig.add_subplot(111)
  */
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 811, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figure); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 790, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 811, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 790, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_figsize, __pyx_tuple__9) < 0) __PYX_ERR(0, 811, __pyx_L1_error)
-                            __pyx_t_45 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 811, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_figsize, __pyx_tuple__5) < 0) __PYX_ERR(0, 790, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_empty_tuple, __pyx_t_4); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 790, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_fig, __pyx_t_45);
                             __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":813
+                            /* "fastrometry/cython_code/WCS.pyx":792
  *                                                         fig = plt.figure(figsize=(9.5,8))
  * 
  *                                                         axes = fig.add_subplot(111)             # <<<<<<<<<<<<<<
  *                                                         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *                                                         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker='o', color='white')
  */
-                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_fig, __pyx_n_s_add_subplot); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_4);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_4, function);
                               }
                             }
                             __pyx_t_45 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_43, __pyx_int_111) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_int_111);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
-                            if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 813, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 792, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __pyx_v_axes = __pyx_t_45;
                             __pyx_t_45 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":814
+                            /* "fastrometry/cython_code/WCS.pyx":793
  * 
  *                                                         axes = fig.add_subplot(111)
  *                                                         axes.imshow(image_data, cmap="gray", norm=LogNorm())             # <<<<<<<<<<<<<<
  *                                                         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker='o', color='white')
- *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="+", color='yellow')
+ *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="o", color='blue')
  */
-                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 814, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_imshow); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            if (unlikely(!__pyx_v_image_data)) { __Pyx_RaiseUnboundLocalError("image_data"); __PYX_ERR(0, 814, __pyx_L1_error) }
-                            __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
+                            if (unlikely(!__pyx_v_image_data)) { __Pyx_RaiseUnboundLocalError("image_data"); __PYX_ERR(0, 793, __pyx_L1_error) }
+                            __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_INCREF(__pyx_v_image_data);
                             __Pyx_GIVEREF(__pyx_v_image_data);
                             PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_image_data);
-                            __pyx_t_43 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 814, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            if (PyDict_SetItem(__pyx_t_43, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_43, __pyx_n_s_cmap, __pyx_n_s_gray) < 0) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_INCREF(__pyx_v_LogNorm);
                             __pyx_t_44 = __pyx_v_LogNorm; __pyx_t_42 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_44))) {
                               __pyx_t_42 = PyMethod_GET_SELF(__pyx_t_44);
                               if (likely(__pyx_t_42)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_44);
                                 __Pyx_INCREF(__pyx_t_42);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_44, function);
                               }
                             }
                             __pyx_t_14 = (__pyx_t_42) ? __Pyx_PyObject_CallOneArg(__pyx_t_44, __pyx_t_42) : __Pyx_PyObject_CallNoArg(__pyx_t_44);
                             __Pyx_XDECREF(__pyx_t_42); __pyx_t_42 = 0;
-                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 814, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            if (PyDict_SetItem(__pyx_t_43, __pyx_n_s_norm, __pyx_t_14) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_43, __pyx_n_s_norm, __pyx_t_14) < 0) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_45, __pyx_t_4, __pyx_t_43); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 814, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_45, __pyx_t_4, __pyx_t_43); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 793, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":816
+                            /* "fastrometry/cython_code/WCS.pyx":795
  *                                                         axes.imshow(image_data, cmap="gray", norm=LogNorm())
  *                                                         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker='o', color='white')
- *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="+", color='yellow')             # <<<<<<<<<<<<<<
+ *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="o", color='blue')             # <<<<<<<<<<<<<<
  *                                                         axes.scatter(np.asarray(invtransf_xs), np.asarray(invtransf_ys), marker='.', color='fuchsia')
  *                                                         dscrp = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(npts_intrm)
  */
-                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 816, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __pyx_t_9.data = __pyx_v_psepoints_view.data;
                             __pyx_t_9.memview = __pyx_v_psepoints_view.memview;
                             __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
                             __pyx_t_9.shape[0] = __pyx_v_psepoints_view.shape[0];
 __pyx_t_9.strides[0] = __pyx_v_psepoints_view.strides[0];
     __pyx_t_9.suboffsets[0] = -1;
@@ -18590,20 +17983,20 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 816, __pyx_L1_error)
+            __PYX_ERR(0, 795, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_43 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 816, __pyx_L1_error)
+__pyx_t_43 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
                             __pyx_t_9.memview = NULL;
                             __pyx_t_9.data = NULL;
                             __pyx_t_9.data = __pyx_v_psepoints_view.data;
                             __pyx_t_9.memview = __pyx_v_psepoints_view.memview;
                             __PYX_INC_MEMVIEW(&__pyx_t_9, 0);
@@ -18616,168 +18009,168 @@
         Py_ssize_t __pyx_tmp_shape = __pyx_v_psepoints_view.shape[1];
     Py_ssize_t __pyx_tmp_stride = __pyx_v_psepoints_view.strides[1];
         if (__pyx_tmp_idx < 0)
             __pyx_tmp_idx += __pyx_tmp_shape;
         if (unlikely(!__Pyx_is_valid_index(__pyx_tmp_idx, __pyx_tmp_shape))) {
             PyErr_SetString(PyExc_IndexError,
                             "Index out of bounds (axis 1)");
-            __PYX_ERR(0, 816, __pyx_L1_error)
+            __PYX_ERR(0, 795, __pyx_L1_error)
         }
         __pyx_t_9.data += __pyx_tmp_idx * __pyx_tmp_stride;
 }
 
-__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+__pyx_t_4 = __pyx_memoryview_fromslice(__pyx_t_9, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __PYX_XDEC_MEMVIEW(&__pyx_t_9, 1);
                             __pyx_t_9.memview = NULL;
                             __pyx_t_9.data = NULL;
-                            __pyx_t_45 = PyTuple_New(2); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 816, __pyx_L1_error)
+                            __pyx_t_45 = PyTuple_New(2); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __Pyx_GIVEREF(__pyx_t_43);
                             PyTuple_SET_ITEM(__pyx_t_45, 0, __pyx_t_43);
                             __Pyx_GIVEREF(__pyx_t_4);
                             PyTuple_SET_ITEM(__pyx_t_45, 1, __pyx_t_4);
                             __pyx_t_43 = 0;
                             __pyx_t_4 = 0;
-                            __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_marker, __pyx_kp_s__10) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_color, __pyx_n_s_yellow) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
-                            __pyx_t_43 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 816, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_marker, __pyx_n_s_o) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_color, __pyx_n_s_blue) < 0) __PYX_ERR(0, 795, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_Call(__pyx_t_14, __pyx_t_45, __pyx_t_4); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 795, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":817
+                            /* "fastrometry/cython_code/WCS.pyx":796
  *                                                         #axes.scatter(img_xmax-np.asarray(invtransf_match_xs), img_ymax-np.asarray(invtransf_match_ys), marker='o', color='white')
- *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="+", color='yellow')
+ *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="o", color='blue')
  *                                                         axes.scatter(np.asarray(invtransf_xs), np.asarray(invtransf_ys), marker='.', color='fuchsia')             # <<<<<<<<<<<<<<
  *                                                         dscrp = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(npts_intrm)
  *                                                         plt.title("Inverse transform - {} points - initial solution".format(npts_intrm))
  */
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_axes, __pyx_n_s_scatter); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __pyx_t_45 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_14))) {
                               __pyx_t_45 = PyMethod_GET_SELF(__pyx_t_14);
                               if (likely(__pyx_t_45)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
                                 __Pyx_INCREF(__pyx_t_45);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_14, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_45) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_45, __pyx_v_invtransf_xs) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_v_invtransf_xs);
                             __Pyx_XDECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __Pyx_GetModuleGlobalName(__pyx_t_45, __pyx_n_s_np); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
-                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_t_45, __pyx_n_s_asarray); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
                             __pyx_t_45 = NULL;
                             if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_44))) {
                               __pyx_t_45 = PyMethod_GET_SELF(__pyx_t_44);
                               if (likely(__pyx_t_45)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_44);
                                 __Pyx_INCREF(__pyx_t_45);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_44, function);
                               }
                             }
                             __pyx_t_14 = (__pyx_t_45) ? __Pyx_PyObject_Call2Args(__pyx_t_44, __pyx_t_45, __pyx_v_invtransf_ys) : __Pyx_PyObject_CallOneArg(__pyx_t_44, __pyx_v_invtransf_ys);
                             __Pyx_XDECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            __pyx_t_44 = PyTuple_New(2); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __pyx_t_44 = PyTuple_New(2); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __Pyx_GIVEREF(__pyx_t_4);
                             PyTuple_SET_ITEM(__pyx_t_44, 0, __pyx_t_4);
                             __Pyx_GIVEREF(__pyx_t_14);
                             PyTuple_SET_ITEM(__pyx_t_44, 1, __pyx_t_14);
                             __pyx_t_4 = 0;
                             __pyx_t_14 = 0;
-                            __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_marker, __pyx_kp_s__11) < 0) __PYX_ERR(0, 817, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_color, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 817, __pyx_L1_error)
-                            __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_t_44, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 817, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_marker, __pyx_kp_s__6) < 0) __PYX_ERR(0, 796, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_14, __pyx_n_s_color, __pyx_n_s_fuchsia) < 0) __PYX_ERR(0, 796, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_t_44, __pyx_t_14); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":818
- *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="+", color='yellow')
+                            /* "fastrometry/cython_code/WCS.pyx":797
+ *                                                         axes.scatter(psepoints_view[:,0], psepoints_view[:,1], marker="o", color='blue')
  *                                                         axes.scatter(np.asarray(invtransf_xs), np.asarray(invtransf_ys), marker='.', color='fuchsia')
  *                                                         dscrp = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(npts_intrm)             # <<<<<<<<<<<<<<
  *                                                         plt.title("Inverse transform - {} points - initial solution".format(npts_intrm))
  *                                                         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  */
-                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed_3, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 818, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Plot_of_the_inverse_transformed_3, __pyx_n_s_format); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 797, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __pyx_t_44 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 818, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 797, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_14);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
                                 __Pyx_INCREF(__pyx_t_43);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_14, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_43, __pyx_t_44) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_44);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 797, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_XDECREF_SET(__pyx_v_dscrp, __pyx_t_4);
                             __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":819
+                            /* "fastrometry/cython_code/WCS.pyx":798
  *                                                         axes.scatter(np.asarray(invtransf_xs), np.asarray(invtransf_ys), marker='.', color='fuchsia')
  *                                                         dscrp = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(npts_intrm)
  *                                                         plt.title("Inverse transform - {} points - initial solution".format(npts_intrm))             # <<<<<<<<<<<<<<
  *                                                         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *                                                         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  */
-                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 819, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_title); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 798, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_initial, __pyx_n_s_format); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 819, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Inverse_transform_points_initial, __pyx_n_s_format); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 798, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 819, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 798, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __pyx_t_42 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_43))) {
                               __pyx_t_42 = PyMethod_GET_SELF(__pyx_t_43);
                               if (likely(__pyx_t_42)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_43);
                                 __Pyx_INCREF(__pyx_t_42);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_43, function);
                               }
                             }
                             __pyx_t_44 = (__pyx_t_42) ? __Pyx_PyObject_Call2Args(__pyx_t_43, __pyx_t_42, __pyx_t_45) : __Pyx_PyObject_CallOneArg(__pyx_t_43, __pyx_t_45);
                             __Pyx_XDECREF(__pyx_t_42); __pyx_t_42 = 0;
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 819, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 798, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_14);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
@@ -18785,101 +18178,101 @@
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_14, function);
                               }
                             }
                             __pyx_t_4 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_14, __pyx_t_43, __pyx_t_44) : __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_44);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
-                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 798, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":820
+                            /* "fastrometry/cython_code/WCS.pyx":799
  *                                                         dscrp = "Plot of the inverse-transformed points (fuchsia) of {} intermediate points. The inverse \ntransform used here is made up of the parameters found in the initial solution. The \ninverse-transformed points that yield a match (i.e., those that land on an occupied kernel \nin the source index map) are highlighted with a white circle. The PSE points are in blue.".format(npts_intrm)
  *                                                         plt.title("Inverse transform - {} points - initial solution".format(npts_intrm))
  *                                                         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)             # <<<<<<<<<<<<<<
  *                                                         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *                                                         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(npts_intrm))
  */
-                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_figtext); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 799, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            __pyx_t_14 = PyTuple_New(3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 820, __pyx_L1_error)
+                            __pyx_t_14 = PyTuple_New(3); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 799, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_INCREF(__pyx_float_0_5);
                             __Pyx_GIVEREF(__pyx_float_0_5);
                             PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_float_0_5);
                             __Pyx_INCREF(__pyx_float_0_05);
                             __Pyx_GIVEREF(__pyx_float_0_05);
                             PyTuple_SET_ITEM(__pyx_t_14, 1, __pyx_float_0_05);
                             __Pyx_INCREF(__pyx_v_dscrp);
                             __Pyx_GIVEREF(__pyx_v_dscrp);
                             PyTuple_SET_ITEM(__pyx_t_14, 2, __pyx_v_dscrp);
-                            __pyx_t_44 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 820, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 799, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
-                            __pyx_t_43 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_14, __pyx_t_44); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 820, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_ha, __pyx_n_s_center) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_fontsize, __pyx_int_9) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_14, __pyx_t_44); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 799, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":821
+                            /* "fastrometry/cython_code/WCS.pyx":800
  *                                                         plt.title("Inverse transform - {} points - initial solution".format(npts_intrm))
  *                                                         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *                                                         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)             # <<<<<<<<<<<<<<
  *                                                         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(npts_intrm))
  *                                                         plt.show()
  */
-                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 821, __pyx_L1_error)
+                            __pyx_t_43 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_subplots_adjust); if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 800, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
-                            __pyx_t_44 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 821, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyDict_NewPresized(4); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 800, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
-                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
-                            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_empty_tuple, __pyx_t_44); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 821, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_top, __pyx_float_0_92) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_bottom, __pyx_float_0_2) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_right, __pyx_float_0_92) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+                            if (PyDict_SetItem(__pyx_t_44, __pyx_n_s_left, __pyx_float_0_08) < 0) __PYX_ERR(0, 800, __pyx_L1_error)
+                            __pyx_t_14 = __Pyx_PyObject_Call(__pyx_t_43, __pyx_empty_tuple, __pyx_t_44); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 800, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":822
+                            /* "fastrometry/cython_code/WCS.pyx":801
  *                                                         plt.figtext(0.5, 0.05, dscrp, ha="center", fontsize=9)
  *                                                         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *                                                         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(npts_intrm))             # <<<<<<<<<<<<<<
  *                                                         plt.show()
  * 
  */
-                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_savefig); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
-                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_initial__pn, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_inversetrans_matches_initial__pn, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
-                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            __pyx_t_45 = __Pyx_PyInt_From_int(__pyx_v_npts_intrm); if (unlikely(!__pyx_t_45)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_45);
                             __pyx_t_42 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
                               __pyx_t_42 = PyMethod_GET_SELF(__pyx_t_4);
                               if (likely(__pyx_t_42)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
                                 __Pyx_INCREF(__pyx_t_42);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_4, function);
                               }
                             }
                             __pyx_t_43 = (__pyx_t_42) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_42, __pyx_t_45) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_45);
                             __Pyx_XDECREF(__pyx_t_42); __pyx_t_42 = 0;
                             __Pyx_DECREF(__pyx_t_45); __pyx_t_45 = 0;
-                            if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_43)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_43);
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_43); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_debug_report, __pyx_t_43); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_4);
                             __Pyx_DECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __pyx_t_43 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_44))) {
                               __pyx_t_43 = PyMethod_GET_SELF(__pyx_t_44);
                               if (likely(__pyx_t_43)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_44);
@@ -18887,186 +18280,186 @@
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_44, function);
                               }
                             }
                             __pyx_t_14 = (__pyx_t_43) ? __Pyx_PyObject_Call2Args(__pyx_t_44, __pyx_t_43, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_44, __pyx_t_4);
                             __Pyx_XDECREF(__pyx_t_43); __pyx_t_43 = 0;
                             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 822, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 801, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":823
+                            /* "fastrometry/cython_code/WCS.pyx":802
  *                                                         plt.subplots_adjust(top=0.92, bottom=0.2, right=0.92, left=0.08)
  *                                                         plt.savefig(debug_report/"inversetrans_matches_initial_{}.png".format(npts_intrm))
  *                                                         plt.show()             # <<<<<<<<<<<<<<
  * 
  *                                                     resultcode = 1
  */
-                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 823, __pyx_L1_error)
+                            __pyx_t_44 = __Pyx_PyObject_GetAttrStr(__pyx_v_plt, __pyx_n_s_show); if (unlikely(!__pyx_t_44)) __PYX_ERR(0, 802, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_44);
                             __pyx_t_4 = NULL;
                             if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_44))) {
                               __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_44);
                               if (likely(__pyx_t_4)) {
                                 PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_44);
                                 __Pyx_INCREF(__pyx_t_4);
                                 __Pyx_INCREF(function);
                                 __Pyx_DECREF_SET(__pyx_t_44, function);
                               }
                             }
                             __pyx_t_14 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_44, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_44);
                             __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 823, __pyx_L1_error)
+                            if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 802, __pyx_L1_error)
                             __Pyx_GOTREF(__pyx_t_14);
                             __Pyx_DECREF(__pyx_t_44); __pyx_t_44 = 0;
                             __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
 
-                            /* "fastrometry/cython_code/WCS.pyx":802
+                            /* "fastrometry/cython_code/WCS.pyx":781
  *                                                         print("| | * CRPIX2: {}".format(CRPIXy))
  * 
  *                                                     if debug:             # <<<<<<<<<<<<<<
  *                                                         import matplotlib.pyplot as plt
  *                                                         from matplotlib.colors import LogNorm
  */
                           }
 
-                          /* "fastrometry/cython_code/WCS.pyx":825
+                          /* "fastrometry/cython_code/WCS.pyx":804
  *                                                         plt.show()
  * 
  *                                                     resultcode = 1             # <<<<<<<<<<<<<<
  *                                                     return resultcode
  *     resultcode = 2
  */
                           __pyx_v_resultcode = 1;
 
-                          /* "fastrometry/cython_code/WCS.pyx":826
+                          /* "fastrometry/cython_code/WCS.pyx":805
  * 
  *                                                     resultcode = 1
  *                                                     return resultcode             # <<<<<<<<<<<<<<
  *     resultcode = 2
  *     return resultcode
  */
                           __pyx_r = __pyx_v_resultcode;
                           goto __pyx_L0;
 
-                          /* "fastrometry/cython_code/WCS.pyx":786
+                          /* "fastrometry/cython_code/WCS.pyx":765
  *                                                                 invtransf_match_xs.append(invtransf_intrmpoint_view[0])
  *                                                                 invtransf_match_ys.append(invtransf_intrmpoint_view[1])
  *                                                 if matches >= minmatches:             # <<<<<<<<<<<<<<
  *                                                     initial_solution_view[0] = S
  *                                                     initial_solution_view[1] = phi
  */
                         }
 
-                        /* "fastrometry/cython_code/WCS.pyx":768
+                        /* "fastrometry/cython_code/WCS.pyx":747
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:             # <<<<<<<<<<<<<<
  *                                                 matches = 0
  *                                                 if debug:
  */
                       }
 
-                      /* "fastrometry/cython_code/WCS.pyx":767
+                      /* "fastrometry/cython_code/WCS.pyx":746
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:             # <<<<<<<<<<<<<<
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  *                                                 matches = 0
  */
                     }
 
-                    /* "fastrometry/cython_code/WCS.pyx":766
+                    /* "fastrometry/cython_code/WCS.pyx":745
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:             # <<<<<<<<<<<<<<
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  *                                             if psesrcindex_C == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[2,1])-1,img_xmax-int(invtransf_intrmtriangle_view[2,0])-1]:
  */
                   }
 
-                  /* "fastrometry/cython_code/WCS.pyx":765
+                  /* "fastrometry/cython_code/WCS.pyx":744
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  *                                         if psesrcindex_B == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[1,1])-1,img_xmax-int(invtransf_intrmtriangle_view[1,0])-1]:
  */
                 }
 
-                /* "fastrometry/cython_code/WCS.pyx":764
+                /* "fastrometry/cython_code/WCS.pyx":743
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  *                                     if psesrcindex_A == srcindexmap_initial_view[img_ymax-int(invtransf_intrmtriangle_view[0,1])-1,img_xmax-int(invtransf_intrmtriangle_view[0,0])-1]:
  */
               }
 
-              /* "fastrometry/cython_code/WCS.pyx":763
+              /* "fastrometry/cython_code/WCS.pyx":742
  *                         CRPIXy = optimizedparams.x[3]
  *                         inverseTransformTriangleUsingSphi(S, phi, CRPIXx, CRPIXy, intrmtriangles_view[j,0], intrmtriangles_view[j,1], intrmtriangles_view[j,2], intrmtriangles_view[j,3], intrmtriangles_view[j,4], intrmtriangles_view[j,5], invtransf_intrmtriangle_view)
  *                         if 1 <= invtransf_intrmtriangle_view[0,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[0,1] <= img_ymax:             # <<<<<<<<<<<<<<
  *                             if 1 <= invtransf_intrmtriangle_view[1,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[1,1] <= img_ymax:
  *                                 if 1 <= invtransf_intrmtriangle_view[2,0] <= img_xmax and 1 <= invtransf_intrmtriangle_view[2,1] <= img_ymax:
  */
             }
 
-            /* "fastrometry/cython_code/WCS.pyx":748
+            /* "fastrometry/cython_code/WCS.pyx":727
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):             # <<<<<<<<<<<<<<
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  *                         if user_rotation is False:
  */
           }
 
-          /* "fastrometry/cython_code/WCS.pyx":747
+          /* "fastrometry/cython_code/WCS.pyx":726
  *         for j in range(nchoose3_intrm):
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:             # <<<<<<<<<<<<<<
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  *                         theta = atan2(psetriangles_view[i,9]*intrmtriangles_view[j,10] - psetriangles_view[i,10]*intrmtriangles_view[j,9], psetriangles_view[i,9]*intrmtriangles_view[j,9] + psetriangles_view[i,10]*intrmtriangles_view[j,10])
  */
         }
 
-        /* "fastrometry/cython_code/WCS.pyx":746
+        /* "fastrometry/cython_code/WCS.pyx":725
  *         psesrcindex_C = srcindexmap_initial_view[img_ymax-int(psetriangles_view[i,5])-1,img_xmax-int(psetriangles_view[i,4])-1]
  *         for j in range(nchoose3_intrm):
  *             if abs(psetriangles_view[i,6]-intrmtriangles_view[j,6]) < vertextol:             # <<<<<<<<<<<<<<
  *                 if abs(psetriangles_view[i,7]-intrmtriangles_view[j,7]) < vertextol:
  *                     if intrmtriangles_view[j,8] > S_lb*(psetriangles_view[i,8]-kerneldiam) and intrmtriangles_view[j,8] < S_ub*(psetriangles_view[i,8]+kerneldiam):
  */
       }
       __pyx_L30_continue:;
     }
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":827
+  /* "fastrometry/cython_code/WCS.pyx":806
  *                                                     resultcode = 1
  *                                                     return resultcode
  *     resultcode = 2             # <<<<<<<<<<<<<<
  *     return resultcode
  * 
  */
   __pyx_v_resultcode = 2;
 
-  /* "fastrometry/cython_code/WCS.pyx":828
+  /* "fastrometry/cython_code/WCS.pyx":807
  *                                                     return resultcode
  *     resultcode = 2
  *     return resultcode             # <<<<<<<<<<<<<<
  * 
- * @printEvent("Performing WCS...", "done", 1)
+ * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):
  */
   __pyx_r = __pyx_v_resultcode;
   goto __pyx_L0;
 
-  /* "fastrometry/cython_code/WCS.pyx":572
+  /* "fastrometry/cython_code/WCS.pyx":551
  *                 triangleNo += 1
  * 
  * cdef int findInitialSolution(double[:,:] allintrmpoints_view, int num_catsources, double[:,:] pse_metadata_view, double[:,:] pse_metadata_inv_view, int num_psesources, int[:,:] srcindexmap_initial_view, int npts, int img_xmax, int img_ymax, double scale, double scalebnds, object rotation, object rotationbnds, double vertextol, int minmatches, int kerneldiam, double[:] initial_solution_view, debug_report, filepath, int verbosity, bint debug):             # <<<<<<<<<<<<<<
  *     """
  *     Finds the initial solution. First, all possible triangles of PSE points and all possible triangles of intermediate points
  */
 
@@ -19121,27 +18514,27 @@
   __Pyx_XDECREF(__pyx_v_invtransf_match_xs);
   __Pyx_XDECREF(__pyx_v_invtransf_match_ys);
   __Pyx_XDECREF(__pyx_v_axes);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "fastrometry/cython_code/WCS.pyx":831
+/* "fastrometry/cython_code/WCS.pyx":809
+ *     return resultcode
  * 
- * @printEvent("Performing WCS...", "done", 1)
  * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):             # <<<<<<<<<<<<<<
  *     """
  *     """
  */
 
 /* Python wrapper */
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_9WCS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_11fastrometry_11cython_code_3WCS_8WCS[] = "\n    ";
-static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_9WCS = {"WCS", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_9WCS, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_8WCS};
-static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_9WCS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_7WCS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_11fastrometry_11cython_code_3WCS_6WCS[] = "\n    ";
+static PyMethodDef __pyx_mdef_11fastrometry_11cython_code_3WCS_7WCS = {"WCS", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_11fastrometry_11cython_code_3WCS_7WCS, METH_VARARGS|METH_KEYWORDS, __pyx_doc_11fastrometry_11cython_code_3WCS_6WCS};
+static PyObject *__pyx_pw_11fastrometry_11cython_code_3WCS_7WCS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_scale = 0;
   PyObject *__pyx_v_scalebnds = 0;
   PyObject *__pyx_v_rotation = 0;
   PyObject *__pyx_v_rotationbnds = 0;
   PyObject *__pyx_v_npts = 0;
   PyObject *__pyx_v_nrefinepts = 0;
   PyObject *__pyx_v_vertextol = 0;
@@ -19249,187 +18642,187 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_scale)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_scalebnds)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 1); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 1); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rotation)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 2); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 2); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rotationbnds)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 3); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 3); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_npts)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 4); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 4); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_nrefinepts)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 5); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 5); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_vertextol)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 6); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 6); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_allintrmpoints)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 7); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 7); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  8:
         if (likely((values[8] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_catalogue_points)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 8); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 8); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  9:
         if (likely((values[9] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mean_catcoords)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 9); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 9); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 10:
         if (likely((values[10] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pse_metadata)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 10); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 10); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 11:
         if (likely((values[11] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pse_metadata_inv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 11); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 11); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 12:
         if (likely((values[12] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_matchdata)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 12); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 12); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 13:
         if (likely((values[13] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_matches)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 13); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 13); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 14:
         if (likely((values[14] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_srcindexmap_initial)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 14); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 14); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 15:
         if (likely((values[15] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_srcindexmap_refine)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 15); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 15); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 16:
         if (likely((values[16] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img_xmax)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 16); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 16); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 17:
         if (likely((values[17] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_img_ymax)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 17); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 17); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 18:
         if (likely((values[18] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_minmatches)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 18); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 18); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 19:
         if (likely((values[19] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_kerneldiam)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 19); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 19); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 20:
         if (likely((values[20] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_psesources)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 20); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 20); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 21:
         if (likely((values[21] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_catsources)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 21); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 21); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 22:
         if (likely((values[22] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_headervals)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 22); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 22); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 23:
         if (likely((values[23] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_wcsdiagnostics)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 23); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 23); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 24:
         if (likely((values[24] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_debug_report)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 24); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 24); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 25:
         if (likely((values[25] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filepath)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 25); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 25); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 26:
         if (likely((values[26] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_user_dir)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 26); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 26); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 27:
         if (likely((values[27] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_filename_body)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 27); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 27); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 28:
         if (likely((values[28] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_debug)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 28); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 28); __PYX_ERR(0, 809, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case 29:
         if (likely((values[29] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_verbosity)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 29); __PYX_ERR(0, 831, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, 29); __PYX_ERR(0, 809, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "WCS") < 0)) __PYX_ERR(0, 831, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "WCS") < 0)) __PYX_ERR(0, 809, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 30) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -19490,28 +18883,28 @@
     __pyx_v_user_dir = values[26];
     __pyx_v_filename_body = values[27];
     __pyx_v_debug = values[28];
     __pyx_v_verbosity = values[29];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 831, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("WCS", 1, 30, 30, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 809, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("fastrometry.cython_code.WCS.WCS", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_8WCS(__pyx_self, __pyx_v_scale, __pyx_v_scalebnds, __pyx_v_rotation, __pyx_v_rotationbnds, __pyx_v_npts, __pyx_v_nrefinepts, __pyx_v_vertextol, __pyx_v_allintrmpoints, __pyx_v_catalogue_points, __pyx_v_mean_catcoords, __pyx_v_pse_metadata, __pyx_v_pse_metadata_inv, __pyx_v_matchdata, __pyx_v_num_matches, __pyx_v_srcindexmap_initial, __pyx_v_srcindexmap_refine, __pyx_v_img_xmax, __pyx_v_img_ymax, __pyx_v_minmatches, __pyx_v_kerneldiam, __pyx_v_num_psesources, __pyx_v_num_catsources, __pyx_v_headervals, __pyx_v_wcsdiagnostics, __pyx_v_debug_report, __pyx_v_filepath, __pyx_v_user_dir, __pyx_v_filename_body, __pyx_v_debug, __pyx_v_verbosity);
+  __pyx_r = __pyx_pf_11fastrometry_11cython_code_3WCS_6WCS(__pyx_self, __pyx_v_scale, __pyx_v_scalebnds, __pyx_v_rotation, __pyx_v_rotationbnds, __pyx_v_npts, __pyx_v_nrefinepts, __pyx_v_vertextol, __pyx_v_allintrmpoints, __pyx_v_catalogue_points, __pyx_v_mean_catcoords, __pyx_v_pse_metadata, __pyx_v_pse_metadata_inv, __pyx_v_matchdata, __pyx_v_num_matches, __pyx_v_srcindexmap_initial, __pyx_v_srcindexmap_refine, __pyx_v_img_xmax, __pyx_v_img_ymax, __pyx_v_minmatches, __pyx_v_kerneldiam, __pyx_v_num_psesources, __pyx_v_num_catsources, __pyx_v_headervals, __pyx_v_wcsdiagnostics, __pyx_v_debug_report, __pyx_v_filepath, __pyx_v_user_dir, __pyx_v_filename_body, __pyx_v_debug, __pyx_v_verbosity);
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_8WCS(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_scale, PyObject *__pyx_v_scalebnds, PyObject *__pyx_v_rotation, PyObject *__pyx_v_rotationbnds, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_vertextol, PyObject *__pyx_v_allintrmpoints, PyObject *__pyx_v_catalogue_points, PyObject *__pyx_v_mean_catcoords, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_pse_metadata_inv, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_num_matches, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_minmatches, PyObject *__pyx_v_kerneldiam, PyObject *__pyx_v_num_psesources, PyObject *__pyx_v_num_catsources, PyObject *__pyx_v_headervals, CYTHON_UNUSED PyObject *__pyx_v_wcsdiagnostics, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, CYTHON_UNUSED PyObject *__pyx_v_user_dir, CYTHON_UNUSED PyObject *__pyx_v_filename_body, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity) {
+static PyObject *__pyx_pf_11fastrometry_11cython_code_3WCS_6WCS(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_scale, PyObject *__pyx_v_scalebnds, PyObject *__pyx_v_rotation, PyObject *__pyx_v_rotationbnds, PyObject *__pyx_v_npts, PyObject *__pyx_v_nrefinepts, PyObject *__pyx_v_vertextol, PyObject *__pyx_v_allintrmpoints, PyObject *__pyx_v_catalogue_points, PyObject *__pyx_v_mean_catcoords, PyObject *__pyx_v_pse_metadata, PyObject *__pyx_v_pse_metadata_inv, PyObject *__pyx_v_matchdata, PyObject *__pyx_v_num_matches, PyObject *__pyx_v_srcindexmap_initial, PyObject *__pyx_v_srcindexmap_refine, PyObject *__pyx_v_img_xmax, PyObject *__pyx_v_img_ymax, PyObject *__pyx_v_minmatches, PyObject *__pyx_v_kerneldiam, PyObject *__pyx_v_num_psesources, PyObject *__pyx_v_num_catsources, PyObject *__pyx_v_headervals, CYTHON_UNUSED PyObject *__pyx_v_wcsdiagnostics, PyObject *__pyx_v_debug_report, PyObject *__pyx_v_filepath, CYTHON_UNUSED PyObject *__pyx_v_user_dir, CYTHON_UNUSED PyObject *__pyx_v_filename_body, PyObject *__pyx_v_debug, PyObject *__pyx_v_verbosity) {
   CYTHON_UNUSED PyObject *__pyx_v_plt = NULL;
   CYTHON_UNUSED PyObject *__pyx_v_LogNorm = NULL;
   CYTHON_UNUSED PyObject *__pyx_v_fits = NULL;
   PyObject *__pyx_v_initial_solution = NULL;
   int __pyx_v_resultcode;
   PyObject *__pyx_v_refined_solution = NULL;
   PyObject *__pyx_v_wcs_diagnostics = NULL;
@@ -19573,181 +18966,211 @@
   __Pyx_memviewslice __pyx_t_25 = { 0, 0, { 0 }, { 0 }, { 0 } };
   __Pyx_memviewslice __pyx_t_26 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("WCS", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":835
+  /* "fastrometry/cython_code/WCS.pyx":813
+ *     """
+ * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("Performing WCS...")
+ * 
+ */
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 813, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (__pyx_t_2) {
+
+    /* "fastrometry/cython_code/WCS.pyx":814
+ * 
+ *     if verbosity >= 1:
+ *         print("Performing WCS...")             # <<<<<<<<<<<<<<
+ * 
+ *     if debug >= 1:
+ */
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Performing_WCS) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+
+    /* "fastrometry/cython_code/WCS.pyx":813
  *     """
  * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("Performing WCS...")
+ * 
+ */
+  }
+
+  /* "fastrometry/cython_code/WCS.pyx":816
+ *         print("Performing WCS...")
+ * 
  *     if debug >= 1:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_debug, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_debug, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":836
+    /* "fastrometry/cython_code/WCS.pyx":817
  * 
  *     if debug >= 1:
  *         import matplotlib.pyplot as plt             # <<<<<<<<<<<<<<
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits
  */
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_INCREF(__pyx_n_s__8);
-    __Pyx_GIVEREF(__pyx_n_s__8);
-    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__8);
-    __pyx_t_3 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
+    __Pyx_INCREF(__pyx_n_s__4);
+    __Pyx_GIVEREF(__pyx_n_s__4);
+    PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__4);
+    __pyx_t_3 = __Pyx_Import(__pyx_n_s_matplotlib_pyplot, __pyx_t_1, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 817, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_plt = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":837
+    /* "fastrometry/cython_code/WCS.pyx":818
  *     if debug >= 1:
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm             # <<<<<<<<<<<<<<
  *         from astropy.io import fits
  * 
  */
-    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_n_s_LogNorm);
     __Pyx_GIVEREF(__pyx_n_s_LogNorm);
     PyList_SET_ITEM(__pyx_t_3, 0, __pyx_n_s_LogNorm);
-    __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_3, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_Import(__pyx_n_s_matplotlib_colors, __pyx_t_3, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 837, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_LogNorm); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 818, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_3);
     __pyx_v_LogNorm = __pyx_t_3;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":838
+    /* "fastrometry/cython_code/WCS.pyx":819
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  *         from astropy.io import fits             # <<<<<<<<<<<<<<
  * 
  *     #For some reason, exceptions such as ZeroDivisionError (which are actually caused by the user
  */
-    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_n_s_fits);
     __Pyx_GIVEREF(__pyx_n_s_fits);
     PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_fits);
-    __pyx_t_3 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_1, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_Import(__pyx_n_s_astropy_io, __pyx_t_1, -1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_fits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_3, __pyx_n_s_fits); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_t_1);
     __pyx_v_fits = __pyx_t_1;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":835
- *     """
+    /* "fastrometry/cython_code/WCS.pyx":816
+ *         print("Performing WCS...")
  * 
  *     if debug >= 1:             # <<<<<<<<<<<<<<
  *         import matplotlib.pyplot as plt
  *         from matplotlib.colors import LogNorm
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":844
+  /* "fastrometry/cython_code/WCS.pyx":825
  *     #resultcodes (kind of like exitcodes, but 0 means error) to catch the error.
  * 
  *     initial_solution = np.zeros(4)             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_int_4) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_int_4);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_initial_solution = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":846
+  /* "fastrometry/cython_code/WCS.pyx":827
  *     initial_solution = np.zeros(4)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding initial solution...")
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 827, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":847
+    /* "fastrometry/cython_code/WCS.pyx":828
  * 
  *     if verbosity >= 1:
  *         print("| Finding initial solution...")             # <<<<<<<<<<<<<<
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_initial_solution) < 0) __PYX_ERR(0, 847, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Finding_initial_solution) < 0) __PYX_ERR(0, 828, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":846
+    /* "fastrometry/cython_code/WCS.pyx":827
  *     initial_solution = np.zeros(4)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Finding initial solution...")
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":848
+  /* "fastrometry/cython_code/WCS.pyx":829
  *     if verbosity >= 1:
  *         print("| Finding initial solution...")
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)             # <<<<<<<<<<<<<<
  *     if resultcode == 1:
  *         if verbosity >= 1:
  */
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_allintrmpoints, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata_inv, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_num_psesources); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_v_scale); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_v_scalebnds); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_v_vertextol); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_v_minmatches); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_v_kerneldiam); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_initial_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_allintrmpoints, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata_inv, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_num_psesources); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_initial, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_v_scale); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_v_scalebnds); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_v_vertextol); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_v_minmatches); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_v_kerneldiam); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_initial_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_debug); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
   __pyx_v_resultcode = __pyx_f_11fastrometry_11cython_code_3WCS_findInitialSolution(__pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_t_11, __pyx_t_12, __pyx_t_13, __pyx_t_14, __pyx_t_15, __pyx_v_rotation, __pyx_v_rotationbnds, __pyx_t_16, __pyx_t_17, __pyx_t_18, __pyx_t_19, __pyx_v_debug_report, __pyx_v_filepath, __pyx_t_20, __pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
@@ -19757,121 +19180,121 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
   __pyx_t_10.memview = NULL;
   __pyx_t_10.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
   __pyx_t_19.memview = NULL;
   __pyx_t_19.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":849
+  /* "fastrometry/cython_code/WCS.pyx":830
  *         print("| Finding initial solution...")
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
   switch (__pyx_v_resultcode) {
     case 1:
 
-    /* "fastrometry/cython_code/WCS.pyx":850
+    /* "fastrometry/cython_code/WCS.pyx":831
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *     elif resultcode == 2:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 850, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 831, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/WCS.pyx":851
+      /* "fastrometry/cython_code/WCS.pyx":832
  *     if resultcode == 1:
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *     elif resultcode == 2:
  *         if verbosity >= 1:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 832, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":850
+      /* "fastrometry/cython_code/WCS.pyx":831
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *     elif resultcode == 2:
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":849
+    /* "fastrometry/cython_code/WCS.pyx":830
  *         print("| Finding initial solution...")
  *     resultcode = findInitialSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, srcindexmap_initial, npts, img_xmax, img_ymax, scale, scalebnds, rotation, rotationbnds, vertextol, minmatches, kerneldiam, initial_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
     break;
     case 2:
 
-    /* "fastrometry/cython_code/WCS.pyx":853
+    /* "fastrometry/cython_code/WCS.pyx":834
  *             print("| done")
  *     elif resultcode == 2:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 853, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 834, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/WCS.pyx":854
+      /* "fastrometry/cython_code/WCS.pyx":835
  *     elif resultcode == 2:
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))
  *     elif resultcode == 0:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 854, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 835, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":853
+      /* "fastrometry/cython_code/WCS.pyx":834
  *             print("| done")
  *     elif resultcode == 2:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":855
+    /* "fastrometry/cython_code/WCS.pyx":836
  *         if verbosity >= 1:
  *             print("| done")
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))             # <<<<<<<<<<<<<<
  *     elif resultcode == 0:
  *         sys.exit("EXIT: fastrometry interrupted while finding initial solution.")
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sys); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_sys); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_exit); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Could_not_find_a_solution_that_g, __pyx_n_s_format); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_Could_not_find_a_solution_that_g, __pyx_n_s_format); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_21);
     __pyx_t_22 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_21))) {
       __pyx_t_22 = PyMethod_GET_SELF(__pyx_t_21);
       if (likely(__pyx_t_22)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_21);
         __Pyx_INCREF(__pyx_t_22);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_21, function);
       }
     }
     __pyx_t_4 = (__pyx_t_22) ? __Pyx_PyObject_Call2Args(__pyx_t_21, __pyx_t_22, __pyx_v_minmatches) : __Pyx_PyObject_CallOneArg(__pyx_t_21, __pyx_v_minmatches);
     __Pyx_XDECREF(__pyx_t_22); __pyx_t_22 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
     __pyx_t_21 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_21)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -19879,152 +19302,152 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_3 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_21, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 836, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":852
+    /* "fastrometry/cython_code/WCS.pyx":833
  *         if verbosity >= 1:
  *             print("| done")
  *     elif resultcode == 2:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
     break;
     case 0:
 
-    /* "fastrometry/cython_code/WCS.pyx":857
+    /* "fastrometry/cython_code/WCS.pyx":838
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))
  *     elif resultcode == 0:
  *         sys.exit("EXIT: fastrometry interrupted while finding initial solution.")             # <<<<<<<<<<<<<<
  * 
  *     refined_solution = np.zeros(6)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 857, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 857, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 838, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_kp_s_EXIT_fastrometry_interrupted_whi) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_kp_s_EXIT_fastrometry_interrupted_whi);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 857, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 838, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":856
+    /* "fastrometry/cython_code/WCS.pyx":837
  *             print("| done")
  *         sys.exit("Could not find a solution that gave at least {} matches.".format(minmatches))
  *     elif resultcode == 0:             # <<<<<<<<<<<<<<
  *         sys.exit("EXIT: fastrometry interrupted while finding initial solution.")
  * 
  */
     break;
     default: break;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":859
+  /* "fastrometry/cython_code/WCS.pyx":840
  *         sys.exit("EXIT: fastrometry interrupted while finding initial solution.")
  * 
  *     refined_solution = np.zeros(6)             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 859, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_int_6) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_int_6);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 859, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_refined_solution = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":861
+  /* "fastrometry/cython_code/WCS.pyx":842
  *     refined_solution = np.zeros(6)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Refining solution...")
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 861, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 842, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":862
+    /* "fastrometry/cython_code/WCS.pyx":843
  * 
  *     if verbosity >= 1:
  *         print("| Refining solution...")             # <<<<<<<<<<<<<<
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Refining_solution) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Refining_solution) < 0) __PYX_ERR(0, 843, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":861
+    /* "fastrometry/cython_code/WCS.pyx":842
  *     refined_solution = np.zeros(6)
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Refining solution...")
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":863
+  /* "fastrometry/cython_code/WCS.pyx":844
  *     if verbosity >= 1:
  *         print("| Refining solution...")
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)             # <<<<<<<<<<<<<<
  *     if resultcode == 1:
  *         if verbosity >= 1:
  */
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_allintrmpoints, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata_inv, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_v_num_psesources); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_23 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_matchdata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_24 = __Pyx_PyObject_to_MemoryviewSlice_ds_int(__pyx_v_num_matches, PyBUF_WRITABLE); if (unlikely(!__pyx_t_24.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_initial_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_refined_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
-  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_debug); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_allintrmpoints, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_20 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_20 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_pse_metadata_inv, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_18 = __Pyx_PyInt_As_int(__pyx_v_num_psesources); if (unlikely((__pyx_t_18 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_23 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_matchdata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_24 = __Pyx_PyObject_to_MemoryviewSlice_ds_int(__pyx_v_num_matches, PyBUF_WRITABLE); if (unlikely(!__pyx_t_24.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_17 = __Pyx_PyInt_As_int(__pyx_v_npts); if (unlikely((__pyx_t_17 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_v_nrefinepts); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_dsds_int(__pyx_v_srcindexmap_refine, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_initial_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_refined_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_verbosity); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_debug); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
   __pyx_v_resultcode = __pyx_f_11fastrometry_11cython_code_3WCS_refineSolution(__pyx_t_8, __pyx_t_20, __pyx_t_7, __pyx_t_5, __pyx_t_18, __pyx_t_23, __pyx_t_24, __pyx_t_17, __pyx_t_13, __pyx_t_12, __pyx_t_11, __pyx_t_10, __pyx_t_19, __pyx_t_25, __pyx_v_debug_report, __pyx_v_filepath, __pyx_t_9, __pyx_t_6);
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
@@ -20043,242 +19466,242 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_19, 1);
   __pyx_t_19.memview = NULL;
   __pyx_t_19.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_25, 1);
   __pyx_t_25.memview = NULL;
   __pyx_t_25.data = NULL;
 
-  /* "fastrometry/cython_code/WCS.pyx":864
+  /* "fastrometry/cython_code/WCS.pyx":845
  *         print("| Refining solution...")
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
   switch (__pyx_v_resultcode) {
     case 1:
 
-    /* "fastrometry/cython_code/WCS.pyx":865
+    /* "fastrometry/cython_code/WCS.pyx":846
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *     elif resultcode == 2:
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 865, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 865, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 846, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/WCS.pyx":866
+      /* "fastrometry/cython_code/WCS.pyx":847
  *     if resultcode == 1:
  *         if verbosity >= 1:
  *             print("| done")             # <<<<<<<<<<<<<<
  *     elif resultcode == 2:
  *         if verbosity >= 1:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 866, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 847, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":865
+      /* "fastrometry/cython_code/WCS.pyx":846
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| done")
  *     elif resultcode == 2:
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":864
+    /* "fastrometry/cython_code/WCS.pyx":845
  *         print("| Refining solution...")
  *     resultcode = refineSolution(allintrmpoints, num_catsources, pse_metadata, pse_metadata_inv, num_psesources, matchdata, num_matches, npts, nrefinepts, img_xmax, img_ymax, srcindexmap_refine, initial_solution, refined_solution, debug_report, filepath, verbosity, debug)
  *     if resultcode == 1:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| done")
  */
     break;
     case 2:
 
-    /* "fastrometry/cython_code/WCS.pyx":868
+    /* "fastrometry/cython_code/WCS.pyx":849
  *             print("| done")
  *     elif resultcode == 2:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Cannot refine solution; no more sources available.")
  *             print("| done")
  */
-    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 868, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 849, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_2) {
 
-      /* "fastrometry/cython_code/WCS.pyx":869
+      /* "fastrometry/cython_code/WCS.pyx":850
  *     elif resultcode == 2:
  *         if verbosity >= 1:
  *             print("| | Cannot refine solution; no more sources available.")             # <<<<<<<<<<<<<<
  *             print("| done")
  *     elif resultcode == 0:
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_Cannot_refine_solution_no_more) < 0) __PYX_ERR(0, 869, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_Cannot_refine_solution_no_more) < 0) __PYX_ERR(0, 850, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":870
+      /* "fastrometry/cython_code/WCS.pyx":851
  *         if verbosity >= 1:
  *             print("| | Cannot refine solution; no more sources available.")
  *             print("| done")             # <<<<<<<<<<<<<<
  *     elif resultcode == 0:
  *         sys.exit("EXIT: fastrometry interrupted while refining solution.")
  */
-      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 870, __pyx_L1_error)
+      if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
 
-      /* "fastrometry/cython_code/WCS.pyx":868
+      /* "fastrometry/cython_code/WCS.pyx":849
  *             print("| done")
  *     elif resultcode == 2:
  *         if verbosity >= 1:             # <<<<<<<<<<<<<<
  *             print("| | Cannot refine solution; no more sources available.")
  *             print("| done")
  */
     }
 
-    /* "fastrometry/cython_code/WCS.pyx":867
+    /* "fastrometry/cython_code/WCS.pyx":848
  *         if verbosity >= 1:
  *             print("| done")
  *     elif resultcode == 2:             # <<<<<<<<<<<<<<
  *         if verbosity >= 1:
  *             print("| | Cannot refine solution; no more sources available.")
  */
     break;
     case 0:
 
-    /* "fastrometry/cython_code/WCS.pyx":872
+    /* "fastrometry/cython_code/WCS.pyx":853
  *             print("| done")
  *     elif resultcode == 0:
  *         sys.exit("EXIT: fastrometry interrupted while refining solution.")             # <<<<<<<<<<<<<<
  * 
  *     wcs_diagnostics = np.zeros(14)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_sys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_exit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_1, __pyx_kp_s_EXIT_fastrometry_interrupted_whi_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_kp_s_EXIT_fastrometry_interrupted_whi_2);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":871
+    /* "fastrometry/cython_code/WCS.pyx":852
  *             print("| | Cannot refine solution; no more sources available.")
  *             print("| done")
  *     elif resultcode == 0:             # <<<<<<<<<<<<<<
  *         sys.exit("EXIT: fastrometry interrupted while refining solution.")
  * 
  */
     break;
     default: break;
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":874
+  /* "fastrometry/cython_code/WCS.pyx":855
  *         sys.exit("EXIT: fastrometry interrupted while refining solution.")
  * 
  *     wcs_diagnostics = np.zeros(14)             # <<<<<<<<<<<<<<
  *     matches = num_matches[0]
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 874, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 855, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_int_14) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_int_14);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_wcs_diagnostics = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":875
+  /* "fastrometry/cython_code/WCS.pyx":856
  * 
  *     wcs_diagnostics = np.zeros(14)
  *     matches = num_matches[0]             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_num_matches, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_num_matches, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_matches = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":877
+  /* "fastrometry/cython_code/WCS.pyx":858
  *     matches = num_matches[0]
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Calculating WCS diagnostics...")
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 877, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 858, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 858, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":878
+    /* "fastrometry/cython_code/WCS.pyx":859
  * 
  *     if verbosity >= 1:
  *         print("| Calculating WCS diagnostics...")             # <<<<<<<<<<<<<<
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  *     if verbosity >= 1:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Calculating_WCS_diagnostics) < 0) __PYX_ERR(0, 878, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Calculating_WCS_diagnostics) < 0) __PYX_ERR(0, 859, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":877
+    /* "fastrometry/cython_code/WCS.pyx":858
  *     matches = num_matches[0]
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Calculating WCS diagnostics...")
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":879
+  /* "fastrometry/cython_code/WCS.pyx":860
  *     if verbosity >= 1:
  *         print("| Calculating WCS diagnostics...")
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)             # <<<<<<<<<<<<<<
  *     if verbosity >= 1:
  *         print("| done")
  */
-  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_refined_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_23 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_matchdata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_matches); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_catalogue_points, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_mean_catcoords, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_26 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_wcs_diagnostics, PyBUF_WRITABLE); if (unlikely(!__pyx_t_26.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
-  __pyx_t_3 = __pyx_f_11fastrometry_11cython_code_3WCS_calculateWCSdiagnostics(__pyx_t_6, __pyx_t_9, __pyx_t_25, __pyx_t_23, __pyx_t_11, __pyx_t_12, __pyx_t_5, __pyx_t_19, __pyx_t_26, __pyx_v_debug_report, __pyx_v_debug); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_As_int(__pyx_v_img_xmax); if (unlikely((__pyx_t_6 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_int(__pyx_v_img_ymax); if (unlikely((__pyx_t_9 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_refined_solution, PyBUF_WRITABLE); if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_23 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_matchdata, PyBUF_WRITABLE); if (unlikely(!__pyx_t_23.memview)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyInt_As_int(__pyx_v_matches); if (unlikely((__pyx_t_11 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_v_num_catsources); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_v_catalogue_points, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_19 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_mean_catcoords, PyBUF_WRITABLE); if (unlikely(!__pyx_t_19.memview)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_26 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_v_wcs_diagnostics, PyBUF_WRITABLE); if (unlikely(!__pyx_t_26.memview)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_11fastrometry_11cython_code_3WCS_calculateWCSdiagnostics(__pyx_t_6, __pyx_t_9, __pyx_t_25, __pyx_t_23, __pyx_t_11, __pyx_t_12, __pyx_t_5, __pyx_t_19, __pyx_t_26, __pyx_v_debug_report, __pyx_v_debug); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __PYX_XDEC_MEMVIEW(&__pyx_t_25, 1);
   __pyx_t_25.memview = NULL;
   __pyx_t_25.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_23, 1);
   __pyx_t_23.memview = NULL;
   __pyx_t_23.data = NULL;
@@ -20289,1249 +19712,1279 @@
   __pyx_t_19.memview = NULL;
   __pyx_t_19.data = NULL;
   __PYX_XDEC_MEMVIEW(&__pyx_t_26, 1);
   __pyx_t_26.memview = NULL;
   __pyx_t_26.data = NULL;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":880
+  /* "fastrometry/cython_code/WCS.pyx":861
  *         print("| Calculating WCS diagnostics...")
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| done")
  * 
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 880, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":881
+    /* "fastrometry/cython_code/WCS.pyx":862
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  *     if verbosity >= 1:
  *         print("| done")             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 881, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":880
+    /* "fastrometry/cython_code/WCS.pyx":861
  *         print("| Calculating WCS diagnostics...")
  *     calculateWCSdiagnostics(img_xmax, img_ymax, refined_solution, matchdata, matches, num_catsources, catalogue_points, mean_catcoords, wcs_diagnostics, debug_report, debug)
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| done")
  * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":883
+  /* "fastrometry/cython_code/WCS.pyx":864
  *         print("| done")
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Constructing keywords...")
  *     CTYPE1 = 'RA---TAN'
  */
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 883, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 883, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 864, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":884
+    /* "fastrometry/cython_code/WCS.pyx":865
  * 
  *     if verbosity >= 1:
  *         print("| Constructing keywords...")             # <<<<<<<<<<<<<<
  *     CTYPE1 = 'RA---TAN'
  *     CTYPE2 = 'DEC--TAN'
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_keywords) < 0) __PYX_ERR(0, 884, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_Constructing_keywords) < 0) __PYX_ERR(0, 865, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":883
+    /* "fastrometry/cython_code/WCS.pyx":864
  *         print("| done")
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| Constructing keywords...")
  *     CTYPE1 = 'RA---TAN'
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":885
+  /* "fastrometry/cython_code/WCS.pyx":866
  *     if verbosity >= 1:
  *         print("| Constructing keywords...")
  *     CTYPE1 = 'RA---TAN'             # <<<<<<<<<<<<<<
  *     CTYPE2 = 'DEC--TAN'
  *     CRPIX1 = refined_solution[4]                    #pixels
  */
   __Pyx_INCREF(__pyx_kp_s_RA_TAN);
   __pyx_v_CTYPE1 = __pyx_kp_s_RA_TAN;
 
-  /* "fastrometry/cython_code/WCS.pyx":886
+  /* "fastrometry/cython_code/WCS.pyx":867
  *         print("| Constructing keywords...")
  *     CTYPE1 = 'RA---TAN'
  *     CTYPE2 = 'DEC--TAN'             # <<<<<<<<<<<<<<
  *     CRPIX1 = refined_solution[4]                    #pixels
  *     CRPIX2 = refined_solution[5]                    #pixels
  */
   __Pyx_INCREF(__pyx_kp_s_DEC_TAN);
   __pyx_v_CTYPE2 = __pyx_kp_s_DEC_TAN;
 
-  /* "fastrometry/cython_code/WCS.pyx":887
+  /* "fastrometry/cython_code/WCS.pyx":868
  *     CTYPE1 = 'RA---TAN'
  *     CTYPE2 = 'DEC--TAN'
  *     CRPIX1 = refined_solution[4]                    #pixels             # <<<<<<<<<<<<<<
  *     CRPIX2 = refined_solution[5]                    #pixels
  *     CRVAL1 = mean_catcoords[0]*180/pi               #degrees
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_CRPIX1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":888
+  /* "fastrometry/cython_code/WCS.pyx":869
  *     CTYPE2 = 'DEC--TAN'
  *     CRPIX1 = refined_solution[4]                    #pixels
  *     CRPIX2 = refined_solution[5]                    #pixels             # <<<<<<<<<<<<<<
  *     CRVAL1 = mean_catcoords[0]*180/pi               #degrees
  *     CRVAL2 = mean_catcoords[1]*180/pi               #degrees
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 869, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_v_CRPIX2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":889
+  /* "fastrometry/cython_code/WCS.pyx":870
  *     CRPIX1 = refined_solution[4]                    #pixels
  *     CRPIX2 = refined_solution[5]                    #pixels
  *     CRVAL1 = mean_catcoords[0]*180/pi               #degrees             # <<<<<<<<<<<<<<
  *     CRVAL2 = mean_catcoords[1]*180/pi               #degrees
  *     CD1_1 = refined_solution[0]*180/pi              #degrees/pixel
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_mean_catcoords, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_mean_catcoords, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 870, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CRVAL1 = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":890
+  /* "fastrometry/cython_code/WCS.pyx":871
  *     CRPIX2 = refined_solution[5]                    #pixels
  *     CRVAL1 = mean_catcoords[0]*180/pi               #degrees
  *     CRVAL2 = mean_catcoords[1]*180/pi               #degrees             # <<<<<<<<<<<<<<
  *     CD1_1 = refined_solution[0]*180/pi              #degrees/pixel
  *     CD1_2 = refined_solution[1]*180/pi              #degrees/pixel
  */
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_mean_catcoords, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_mean_catcoords, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 871, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 871, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CRVAL2 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":891
+  /* "fastrometry/cython_code/WCS.pyx":872
  *     CRVAL1 = mean_catcoords[0]*180/pi               #degrees
  *     CRVAL2 = mean_catcoords[1]*180/pi               #degrees
  *     CD1_1 = refined_solution[0]*180/pi              #degrees/pixel             # <<<<<<<<<<<<<<
  *     CD1_2 = refined_solution[1]*180/pi              #degrees/pixel
  *     CD2_1 = refined_solution[2]*180/pi              #degrees/pixel
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_refined_solution, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 891, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_refined_solution, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_int_180); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 891, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_int_180); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 891, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 891, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CD1_1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":892
+  /* "fastrometry/cython_code/WCS.pyx":873
  *     CRVAL2 = mean_catcoords[1]*180/pi               #degrees
  *     CD1_1 = refined_solution[0]*180/pi              #degrees/pixel
  *     CD1_2 = refined_solution[1]*180/pi              #degrees/pixel             # <<<<<<<<<<<<<<
  *     CD2_1 = refined_solution[2]*180/pi              #degrees/pixel
  *     CD2_2 = refined_solution[3]*180/pi              #degrees/pixel
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_refined_solution, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 892, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 873, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CD1_2 = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":893
+  /* "fastrometry/cython_code/WCS.pyx":874
  *     CD1_1 = refined_solution[0]*180/pi              #degrees/pixel
  *     CD1_2 = refined_solution[1]*180/pi              #degrees/pixel
  *     CD2_1 = refined_solution[2]*180/pi              #degrees/pixel             # <<<<<<<<<<<<<<
  *     CD2_2 = refined_solution[3]*180/pi              #degrees/pixel
  *     CDELT1 = sqrt(CD1_1*CD1_1+CD1_2*CD1_2)*3600     #arcseconds/pixel
  */
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_refined_solution, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_refined_solution, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 874, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 874, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 893, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 874, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CD2_1 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":894
+  /* "fastrometry/cython_code/WCS.pyx":875
  *     CD1_2 = refined_solution[1]*180/pi              #degrees/pixel
  *     CD2_1 = refined_solution[2]*180/pi              #degrees/pixel
  *     CD2_2 = refined_solution[3]*180/pi              #degrees/pixel             # <<<<<<<<<<<<<<
  *     CDELT1 = sqrt(CD1_1*CD1_1+CD1_2*CD1_2)*3600     #arcseconds/pixel
  *     CDELT2 = sqrt(CD2_1*CD2_1+CD2_2*CD2_2)*3600     #arcseconds/pixel
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_refined_solution, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_refined_solution, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_int_180); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_int_180); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 875, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_CD2_2 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":895
+  /* "fastrometry/cython_code/WCS.pyx":876
  *     CD2_1 = refined_solution[2]*180/pi              #degrees/pixel
  *     CD2_2 = refined_solution[3]*180/pi              #degrees/pixel
  *     CDELT1 = sqrt(CD1_1*CD1_1+CD1_2*CD1_2)*3600     #arcseconds/pixel             # <<<<<<<<<<<<<<
  *     CDELT2 = sqrt(CD2_1*CD2_1+CD2_2*CD2_2)*3600     #arcseconds/pixel
  *     CROTA1 = atan2(CD1_2,-CD1_1)*180/pi             #degrees
  */
-  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD1_1, __pyx_v_CD1_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_v_CD1_1, __pyx_v_CD1_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD1_2, __pyx_v_CD1_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD1_2, __pyx_v_CD1_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 876, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CDELT1 = (sqrt(__pyx_t_16) * 3600.0);
 
-  /* "fastrometry/cython_code/WCS.pyx":896
+  /* "fastrometry/cython_code/WCS.pyx":877
  *     CD2_2 = refined_solution[3]*180/pi              #degrees/pixel
  *     CDELT1 = sqrt(CD1_1*CD1_1+CD1_2*CD1_2)*3600     #arcseconds/pixel
  *     CDELT2 = sqrt(CD2_1*CD2_1+CD2_2*CD2_2)*3600     #arcseconds/pixel             # <<<<<<<<<<<<<<
  *     CROTA1 = atan2(CD1_2,-CD1_1)*180/pi             #degrees
  *     CROTA2 = atan2(-CD2_1,-CD2_2)*180/pi            #degrees
  */
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_CD2_1, __pyx_v_CD2_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_CD2_1, __pyx_v_CD2_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD2_2, __pyx_v_CD2_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_CD2_2, __pyx_v_CD2_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CDELT2 = (sqrt(__pyx_t_16) * 3600.0);
 
-  /* "fastrometry/cython_code/WCS.pyx":897
+  /* "fastrometry/cython_code/WCS.pyx":878
  *     CDELT1 = sqrt(CD1_1*CD1_1+CD1_2*CD1_2)*3600     #arcseconds/pixel
  *     CDELT2 = sqrt(CD2_1*CD2_1+CD2_2*CD2_2)*3600     #arcseconds/pixel
  *     CROTA1 = atan2(CD1_2,-CD1_1)*180/pi             #degrees             # <<<<<<<<<<<<<<
  *     CROTA2 = atan2(-CD2_1,-CD2_2)*180/pi            #degrees
  *     CCVALD1 = wcs_diagnostics[0]*180/pi             #degrees
  */
-  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_v_CD1_2); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 897, __pyx_L1_error)
-  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD1_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_v_CD1_2); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 878, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD1_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 878, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_14 = (atan2(__pyx_t_16, __pyx_t_15) * 180.0);
   if (unlikely(M_PI == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 897, __pyx_L1_error)
+    __PYX_ERR(0, 878, __pyx_L1_error)
   }
   __pyx_v_CROTA1 = (__pyx_t_14 / M_PI);
 
-  /* "fastrometry/cython_code/WCS.pyx":898
+  /* "fastrometry/cython_code/WCS.pyx":879
  *     CDELT2 = sqrt(CD2_1*CD2_1+CD2_2*CD2_2)*3600     #arcseconds/pixel
  *     CROTA1 = atan2(CD1_2,-CD1_1)*180/pi             #degrees
  *     CROTA2 = atan2(-CD2_1,-CD2_2)*180/pi            #degrees             # <<<<<<<<<<<<<<
  *     CCVALD1 = wcs_diagnostics[0]*180/pi             #degrees
  *     CCVALD2 = wcs_diagnostics[1]*180/pi             #degrees
  */
-  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD2_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 898, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD2_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 898, __pyx_L1_error)
+  __pyx_t_14 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_14 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD2_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 898, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Negative(__pyx_v_CD2_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 898, __pyx_L1_error)
+  __pyx_t_15 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_15 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 879, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_16 = (atan2(__pyx_t_14, __pyx_t_15) * 180.0);
   if (unlikely(M_PI == 0)) {
     PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-    __PYX_ERR(0, 898, __pyx_L1_error)
+    __PYX_ERR(0, 879, __pyx_L1_error)
   }
   __pyx_v_CROTA2 = (__pyx_t_16 / M_PI);
 
-  /* "fastrometry/cython_code/WCS.pyx":899
+  /* "fastrometry/cython_code/WCS.pyx":880
  *     CROTA1 = atan2(CD1_2,-CD1_1)*180/pi             #degrees
  *     CROTA2 = atan2(-CD2_1,-CD2_2)*180/pi            #degrees
  *     CCVALD1 = wcs_diagnostics[0]*180/pi             #degrees             # <<<<<<<<<<<<<<
  *     CCVALD2 = wcs_diagnostics[1]*180/pi             #degrees
  *     CCVALS1_h = wcs_diagnostics[2]                  #hours
  */
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_int_180); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 880, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_CCVALD1 = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":900
+  /* "fastrometry/cython_code/WCS.pyx":881
  *     CROTA2 = atan2(-CD2_1,-CD2_2)*180/pi            #degrees
  *     CCVALD1 = wcs_diagnostics[0]*180/pi             #degrees
  *     CCVALD2 = wcs_diagnostics[1]*180/pi             #degrees             # <<<<<<<<<<<<<<
  *     CCVALS1_h = wcs_diagnostics[2]                  #hours
  *     CCVALS1_m = wcs_diagnostics[3]                  #minutes
  */
-  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_4, __pyx_int_180); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(M_PI); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_CCVALD2 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":901
+  /* "fastrometry/cython_code/WCS.pyx":882
  *     CCVALD1 = wcs_diagnostics[0]*180/pi             #degrees
  *     CCVALD2 = wcs_diagnostics[1]*180/pi             #degrees
  *     CCVALS1_h = wcs_diagnostics[2]                  #hours             # <<<<<<<<<<<<<<
  *     CCVALS1_m = wcs_diagnostics[3]                  #minutes
  *     CCVALS1_s = wcs_diagnostics[4]                  #seconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS1_h = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":902
+  /* "fastrometry/cython_code/WCS.pyx":883
  *     CCVALD2 = wcs_diagnostics[1]*180/pi             #degrees
  *     CCVALS1_h = wcs_diagnostics[2]                  #hours
  *     CCVALS1_m = wcs_diagnostics[3]                  #minutes             # <<<<<<<<<<<<<<
  *     CCVALS1_s = wcs_diagnostics[4]                  #seconds
  *     CCVALS2_h = wcs_diagnostics[5]                  #hours
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 902, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS1_m = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":903
+  /* "fastrometry/cython_code/WCS.pyx":884
  *     CCVALS1_h = wcs_diagnostics[2]                  #hours
  *     CCVALS1_m = wcs_diagnostics[3]                  #minutes
  *     CCVALS1_s = wcs_diagnostics[4]                  #seconds             # <<<<<<<<<<<<<<
  *     CCVALS2_h = wcs_diagnostics[5]                  #hours
  *     CCVALS2_m = wcs_diagnostics[6]                  #minutes
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS1_s = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":904
+  /* "fastrometry/cython_code/WCS.pyx":885
  *     CCVALS1_m = wcs_diagnostics[3]                  #minutes
  *     CCVALS1_s = wcs_diagnostics[4]                  #seconds
  *     CCVALS2_h = wcs_diagnostics[5]                  #hours             # <<<<<<<<<<<<<<
  *     CCVALS2_m = wcs_diagnostics[6]                  #minutes
  *     CCVALS2_s = wcs_diagnostics[7]                  #seconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 885, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS2_h = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":905
+  /* "fastrometry/cython_code/WCS.pyx":886
  *     CCVALS1_s = wcs_diagnostics[4]                  #seconds
  *     CCVALS2_h = wcs_diagnostics[5]                  #hours
  *     CCVALS2_m = wcs_diagnostics[6]                  #minutes             # <<<<<<<<<<<<<<
  *     CCVALS2_s = wcs_diagnostics[7]                  #seconds
  *     CVAL1RM = wcs_diagnostics[8]                    #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS2_m = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":906
+  /* "fastrometry/cython_code/WCS.pyx":887
  *     CCVALS2_h = wcs_diagnostics[5]                  #hours
  *     CCVALS2_m = wcs_diagnostics[6]                  #minutes
  *     CCVALS2_s = wcs_diagnostics[7]                  #seconds             # <<<<<<<<<<<<<<
  *     CVAL1RM = wcs_diagnostics[8]                    #arcseconds
  *     CVAL1RS = wcs_diagnostics[9]                    #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 887, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CCVALS2_s = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":907
+  /* "fastrometry/cython_code/WCS.pyx":888
  *     CCVALS2_m = wcs_diagnostics[6]                  #minutes
  *     CCVALS2_s = wcs_diagnostics[7]                  #seconds
  *     CVAL1RM = wcs_diagnostics[8]                    #arcseconds             # <<<<<<<<<<<<<<
  *     CVAL1RS = wcs_diagnostics[9]                    #arcseconds
  *     CVAL2RM = wcs_diagnostics[10]                   #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 8, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVAL1RM = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":908
+  /* "fastrometry/cython_code/WCS.pyx":889
  *     CCVALS2_s = wcs_diagnostics[7]                  #seconds
  *     CVAL1RM = wcs_diagnostics[8]                    #arcseconds
  *     CVAL1RS = wcs_diagnostics[9]                    #arcseconds             # <<<<<<<<<<<<<<
  *     CVAL2RM = wcs_diagnostics[10]                   #arcseconds
  *     CVAL2RS = wcs_diagnostics[11]                   #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 9, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 9, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVAL1RS = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":909
+  /* "fastrometry/cython_code/WCS.pyx":890
  *     CVAL1RM = wcs_diagnostics[8]                    #arcseconds
  *     CVAL1RS = wcs_diagnostics[9]                    #arcseconds
  *     CVAL2RM = wcs_diagnostics[10]                   #arcseconds             # <<<<<<<<<<<<<<
  *     CVAL2RS = wcs_diagnostics[11]                   #arcseconds
  *     CVALRM = wcs_diagnostics[12]                    #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 10, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 10, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVAL2RM = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":910
+  /* "fastrometry/cython_code/WCS.pyx":891
  *     CVAL1RS = wcs_diagnostics[9]                    #arcseconds
  *     CVAL2RM = wcs_diagnostics[10]                   #arcseconds
  *     CVAL2RS = wcs_diagnostics[11]                   #arcseconds             # <<<<<<<<<<<<<<
  *     CVALRM = wcs_diagnostics[12]                    #arcseconds
  *     CVALRS = wcs_diagnostics[13]                    #arcseconds
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 11, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 11, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 891, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVAL2RS = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":911
+  /* "fastrometry/cython_code/WCS.pyx":892
  *     CVAL2RM = wcs_diagnostics[10]                   #arcseconds
  *     CVAL2RS = wcs_diagnostics[11]                   #arcseconds
  *     CVALRM = wcs_diagnostics[12]                    #arcseconds             # <<<<<<<<<<<<<<
  *     CVALRS = wcs_diagnostics[13]                    #arcseconds
  * 
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 12, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 12, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVALRM = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":912
+  /* "fastrometry/cython_code/WCS.pyx":893
  *     CVAL2RS = wcs_diagnostics[11]                   #arcseconds
  *     CVALRM = wcs_diagnostics[12]                    #arcseconds
  *     CVALRS = wcs_diagnostics[13]                    #arcseconds             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 13, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_wcs_diagnostics, 13, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_CVALRS = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":914
+  /* "fastrometry/cython_code/WCS.pyx":895
  *     CVALRS = wcs_diagnostics[13]                    #arcseconds
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | CTYPE1 = {}".format(CTYPE1))
  *         print("| | CTYPE2 = {}".format(CTYPE2))
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 914, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 914, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 895, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":915
+    /* "fastrometry/cython_code/WCS.pyx":896
  * 
  *     if verbosity >= 1:
  *         print("| | CTYPE1 = {}".format(CTYPE1))             # <<<<<<<<<<<<<<
  *         print("| | CTYPE2 = {}".format(CTYPE2))
  *         print("| | CRPIX1 = {}".format(CRPIX1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CTYPE1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CTYPE1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CTYPE1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CTYPE1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 915, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 896, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":916
+    /* "fastrometry/cython_code/WCS.pyx":897
  *     if verbosity >= 1:
  *         print("| | CTYPE1 = {}".format(CTYPE1))
  *         print("| | CTYPE2 = {}".format(CTYPE2))             # <<<<<<<<<<<<<<
  *         print("| | CRPIX1 = {}".format(CRPIX1))
  *         print("| | CRPIX2 = {}".format(CRPIX2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CTYPE2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CTYPE2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CTYPE2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CTYPE2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 916, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 897, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":917
+    /* "fastrometry/cython_code/WCS.pyx":898
  *         print("| | CTYPE1 = {}".format(CTYPE1))
  *         print("| | CTYPE2 = {}".format(CTYPE2))
  *         print("| | CRPIX1 = {}".format(CRPIX1))             # <<<<<<<<<<<<<<
  *         print("| | CRPIX2 = {}".format(CRPIX2))
  *         print("| | CRVAL1 = {}".format(CRVAL1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 917, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CRPIX1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CRPIX1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 917, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 898, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":918
+    /* "fastrometry/cython_code/WCS.pyx":899
  *         print("| | CTYPE2 = {}".format(CTYPE2))
  *         print("| | CRPIX1 = {}".format(CRPIX1))
  *         print("| | CRPIX2 = {}".format(CRPIX2))             # <<<<<<<<<<<<<<
  *         print("| | CRVAL1 = {}".format(CRVAL1))
  *         print("| | CRVAL2 = {}".format(CRVAL2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 918, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRPIX2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CRPIX2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CRPIX2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 918, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 899, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":919
+    /* "fastrometry/cython_code/WCS.pyx":900
  *         print("| | CRPIX1 = {}".format(CRPIX1))
  *         print("| | CRPIX2 = {}".format(CRPIX2))
  *         print("| | CRVAL1 = {}".format(CRVAL1))             # <<<<<<<<<<<<<<
  *         print("| | CRVAL2 = {}".format(CRVAL2))
  *         print("| | CD1_1 = {}".format(CD1_1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRVAL1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 919, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRVAL1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CRVAL1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CRVAL1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 919, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 900, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":920
+    /* "fastrometry/cython_code/WCS.pyx":901
  *         print("| | CRPIX2 = {}".format(CRPIX2))
  *         print("| | CRVAL1 = {}".format(CRVAL1))
  *         print("| | CRVAL2 = {}".format(CRVAL2))             # <<<<<<<<<<<<<<
  *         print("| | CD1_1 = {}".format(CD1_1))
  *         print("| | CD1_2 = {}".format(CD1_2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRVAL2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 920, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CRVAL2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 901, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CRVAL2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CRVAL2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 920, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 901, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 920, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 901, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":921
+    /* "fastrometry/cython_code/WCS.pyx":902
  *         print("| | CRVAL1 = {}".format(CRVAL1))
  *         print("| | CRVAL2 = {}".format(CRVAL2))
  *         print("| | CD1_1 = {}".format(CD1_1))             # <<<<<<<<<<<<<<
  *         print("| | CD1_2 = {}".format(CD1_2))
  *         print("| | CD2_1 = {}".format(CD2_1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 902, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CD1_1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CD1_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 902, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 921, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 902, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":922
+    /* "fastrometry/cython_code/WCS.pyx":903
  *         print("| | CRVAL2 = {}".format(CRVAL2))
  *         print("| | CD1_1 = {}".format(CD1_1))
  *         print("| | CD1_2 = {}".format(CD1_2))             # <<<<<<<<<<<<<<
  *         print("| | CD2_1 = {}".format(CD2_1))
  *         print("| | CD2_2 = {}".format(CD2_2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD1_2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CD1_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CD1_2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 922, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 903, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":923
+    /* "fastrometry/cython_code/WCS.pyx":904
  *         print("| | CD1_1 = {}".format(CD1_1))
  *         print("| | CD1_2 = {}".format(CD1_2))
  *         print("| | CD2_1 = {}".format(CD2_1))             # <<<<<<<<<<<<<<
  *         print("| | CD2_2 = {}".format(CD2_2))
  *         print("| | CDELT1 = {}".format(CDELT1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 923, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_1_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CD2_1) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CD2_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 904, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 923, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 904, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":924
+    /* "fastrometry/cython_code/WCS.pyx":905
  *         print("| | CD1_2 = {}".format(CD1_2))
  *         print("| | CD2_1 = {}".format(CD2_1))
  *         print("| | CD2_2 = {}".format(CD2_2))             # <<<<<<<<<<<<<<
  *         print("| | CDELT1 = {}".format(CDELT1))
  *         print("| | CDELT2 = {}".format(CDELT2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 924, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CD2_2_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CD2_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CD2_2);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 924, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":925
+    /* "fastrometry/cython_code/WCS.pyx":906
  *         print("| | CD2_1 = {}".format(CD2_1))
  *         print("| | CD2_2 = {}".format(CD2_2))
  *         print("| | CDELT1 = {}".format(CDELT1))             # <<<<<<<<<<<<<<
  *         print("| | CDELT2 = {}".format(CDELT2))
  *         print("| | CROTA1 = {}".format(CROTA1))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CDELT1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 925, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CDELT1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CDELT1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 925, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CDELT1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_21 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_21)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_21);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_21, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 925, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":926
+    /* "fastrometry/cython_code/WCS.pyx":907
  *         print("| | CD2_2 = {}".format(CD2_2))
  *         print("| | CDELT1 = {}".format(CDELT1))
  *         print("| | CDELT2 = {}".format(CDELT2))             # <<<<<<<<<<<<<<
  *         print("| | CROTA1 = {}".format(CROTA1))
  *         print("| | CROTA2 = {}".format(CROTA2))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CDELT2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 926, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CDELT2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CDELT2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 926, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CDELT2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_21 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_21)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_21);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_21, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 926, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":927
+    /* "fastrometry/cython_code/WCS.pyx":908
  *         print("| | CDELT1 = {}".format(CDELT1))
  *         print("| | CDELT2 = {}".format(CDELT2))
  *         print("| | CROTA1 = {}".format(CROTA1))             # <<<<<<<<<<<<<<
  *         print("| | CROTA2 = {}".format(CROTA2))
  *         # ...
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CROTA1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CROTA1, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CROTA1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CROTA1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_21 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_21)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_21);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_21, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 927, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":928
+    /* "fastrometry/cython_code/WCS.pyx":909
  *         print("| | CDELT2 = {}".format(CDELT2))
  *         print("| | CROTA1 = {}".format(CROTA1))
  *         print("| | CROTA2 = {}".format(CROTA2))             # <<<<<<<<<<<<<<
  *         # ...
  *         print("| | CVALRM = {}".format(CVALRM))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CROTA2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CROTA2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 909, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CROTA2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_3 = PyFloat_FromDouble(__pyx_v_CROTA2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_21 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_21 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_21)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_21);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_21) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_21, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_21); __pyx_t_21 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 928, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 928, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 909, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":930
+    /* "fastrometry/cython_code/WCS.pyx":911
  *         print("| | CROTA2 = {}".format(CROTA2))
  *         # ...
  *         print("| | CVALRM = {}".format(CVALRM))             # <<<<<<<<<<<<<<
  *         print("| | CVALRS = {}".format(CVALRS))
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CVALRM, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 930, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CVALRM, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CVALRM) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CVALRM);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 930, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":931
+    /* "fastrometry/cython_code/WCS.pyx":912
  *         # ...
  *         print("| | CVALRM = {}".format(CVALRM))
  *         print("| | CVALRS = {}".format(CVALRS))             # <<<<<<<<<<<<<<
  * 
  *     headervals[0] = CRPIX1
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CVALRS, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 931, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_s_CVALRS, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_CVALRS) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_CVALRS);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 931, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_t_1) < 0) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "fastrometry/cython_code/WCS.pyx":914
+    /* "fastrometry/cython_code/WCS.pyx":895
  *     CVALRS = wcs_diagnostics[13]                    #arcseconds
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| | CTYPE1 = {}".format(CTYPE1))
  *         print("| | CTYPE2 = {}".format(CTYPE2))
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":933
+  /* "fastrometry/cython_code/WCS.pyx":914
  *         print("| | CVALRS = {}".format(CVALRS))
  * 
  *     headervals[0] = CRPIX1             # <<<<<<<<<<<<<<
  *     headervals[1] = CRPIX2
  *     headervals[2] = CRVAL1
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 0, __pyx_v_CRPIX1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 933, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 0, __pyx_v_CRPIX1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 914, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":934
+  /* "fastrometry/cython_code/WCS.pyx":915
  * 
  *     headervals[0] = CRPIX1
  *     headervals[1] = CRPIX2             # <<<<<<<<<<<<<<
  *     headervals[2] = CRVAL1
  *     headervals[3] = CRVAL2
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 1, __pyx_v_CRPIX2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 934, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 1, __pyx_v_CRPIX2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 915, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":935
+  /* "fastrometry/cython_code/WCS.pyx":916
  *     headervals[0] = CRPIX1
  *     headervals[1] = CRPIX2
  *     headervals[2] = CRVAL1             # <<<<<<<<<<<<<<
  *     headervals[3] = CRVAL2
  *     headervals[4] = CD1_1
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 2, __pyx_v_CRVAL1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 2, __pyx_v_CRVAL1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 916, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":936
+  /* "fastrometry/cython_code/WCS.pyx":917
  *     headervals[1] = CRPIX2
  *     headervals[2] = CRVAL1
  *     headervals[3] = CRVAL2             # <<<<<<<<<<<<<<
  *     headervals[4] = CD1_1
  *     headervals[5] = CD1_2
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 3, __pyx_v_CRVAL2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 3, __pyx_v_CRVAL2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 917, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":937
+  /* "fastrometry/cython_code/WCS.pyx":918
  *     headervals[2] = CRVAL1
  *     headervals[3] = CRVAL2
  *     headervals[4] = CD1_1             # <<<<<<<<<<<<<<
  *     headervals[5] = CD1_2
  *     headervals[6] = CD2_1
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 4, __pyx_v_CD1_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 937, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 4, __pyx_v_CD1_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 918, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":938
+  /* "fastrometry/cython_code/WCS.pyx":919
  *     headervals[3] = CRVAL2
  *     headervals[4] = CD1_1
  *     headervals[5] = CD1_2             # <<<<<<<<<<<<<<
  *     headervals[6] = CD2_1
  *     headervals[7] = CD2_2
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 5, __pyx_v_CD1_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 938, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 5, __pyx_v_CD1_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 919, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":939
+  /* "fastrometry/cython_code/WCS.pyx":920
  *     headervals[4] = CD1_1
  *     headervals[5] = CD1_2
  *     headervals[6] = CD2_1             # <<<<<<<<<<<<<<
  *     headervals[7] = CD2_2
  *     headervals[8] = CDELT1
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 6, __pyx_v_CD2_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 6, __pyx_v_CD2_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 920, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":940
+  /* "fastrometry/cython_code/WCS.pyx":921
  *     headervals[5] = CD1_2
  *     headervals[6] = CD2_1
  *     headervals[7] = CD2_2             # <<<<<<<<<<<<<<
  *     headervals[8] = CDELT1
  *     headervals[9] = CDELT2
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 7, __pyx_v_CD2_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 940, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 7, __pyx_v_CD2_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 921, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":941
+  /* "fastrometry/cython_code/WCS.pyx":922
  *     headervals[6] = CD2_1
  *     headervals[7] = CD2_2
  *     headervals[8] = CDELT1             # <<<<<<<<<<<<<<
  *     headervals[9] = CDELT2
  *     headervals[10] = CROTA1
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CDELT1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CDELT1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 8, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 941, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 8, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 922, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":942
+  /* "fastrometry/cython_code/WCS.pyx":923
  *     headervals[7] = CD2_2
  *     headervals[8] = CDELT1
  *     headervals[9] = CDELT2             # <<<<<<<<<<<<<<
  *     headervals[10] = CROTA1
  *     headervals[11] = CROTA2
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CDELT2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CDELT2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 9, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 942, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 9, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 923, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":943
+  /* "fastrometry/cython_code/WCS.pyx":924
  *     headervals[8] = CDELT1
  *     headervals[9] = CDELT2
  *     headervals[10] = CROTA1             # <<<<<<<<<<<<<<
  *     headervals[11] = CROTA2
  *     headervals[12] = CCVALD1
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CROTA1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 943, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CROTA1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 10, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 943, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 10, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 924, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":944
+  /* "fastrometry/cython_code/WCS.pyx":925
  *     headervals[9] = CDELT2
  *     headervals[10] = CROTA1
  *     headervals[11] = CROTA2             # <<<<<<<<<<<<<<
  *     headervals[12] = CCVALD1
  *     headervals[13] = CCVALD2
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CROTA2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_CROTA2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 11, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 11, __pyx_t_1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 925, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":945
+  /* "fastrometry/cython_code/WCS.pyx":926
  *     headervals[10] = CROTA1
  *     headervals[11] = CROTA2
  *     headervals[12] = CCVALD1             # <<<<<<<<<<<<<<
  *     headervals[13] = CCVALD2
  *     headervals[14] = CCVALS1_h
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 12, __pyx_v_CCVALD1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 945, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 12, __pyx_v_CCVALD1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 926, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":946
+  /* "fastrometry/cython_code/WCS.pyx":927
  *     headervals[11] = CROTA2
  *     headervals[12] = CCVALD1
  *     headervals[13] = CCVALD2             # <<<<<<<<<<<<<<
  *     headervals[14] = CCVALS1_h
  *     headervals[15] = CCVALS1_m
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 13, __pyx_v_CCVALD2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 946, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 13, __pyx_v_CCVALD2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 927, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":947
+  /* "fastrometry/cython_code/WCS.pyx":928
  *     headervals[12] = CCVALD1
  *     headervals[13] = CCVALD2
  *     headervals[14] = CCVALS1_h             # <<<<<<<<<<<<<<
  *     headervals[15] = CCVALS1_m
  *     headervals[16] = CCVALS1_s
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 14, __pyx_v_CCVALS1_h, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 14, __pyx_v_CCVALS1_h, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 928, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":948
+  /* "fastrometry/cython_code/WCS.pyx":929
  *     headervals[13] = CCVALD2
  *     headervals[14] = CCVALS1_h
  *     headervals[15] = CCVALS1_m             # <<<<<<<<<<<<<<
  *     headervals[16] = CCVALS1_s
  *     headervals[17] = CCVALS2_h
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 15, __pyx_v_CCVALS1_m, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 948, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 15, __pyx_v_CCVALS1_m, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 929, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":949
+  /* "fastrometry/cython_code/WCS.pyx":930
  *     headervals[14] = CCVALS1_h
  *     headervals[15] = CCVALS1_m
  *     headervals[16] = CCVALS1_s             # <<<<<<<<<<<<<<
  *     headervals[17] = CCVALS2_h
  *     headervals[18] = CCVALS2_m
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 16, __pyx_v_CCVALS1_s, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 949, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 16, __pyx_v_CCVALS1_s, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 930, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":950
+  /* "fastrometry/cython_code/WCS.pyx":931
  *     headervals[15] = CCVALS1_m
  *     headervals[16] = CCVALS1_s
  *     headervals[17] = CCVALS2_h             # <<<<<<<<<<<<<<
  *     headervals[18] = CCVALS2_m
  *     headervals[19] = CCVALS2_s
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 17, __pyx_v_CCVALS2_h, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 950, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 17, __pyx_v_CCVALS2_h, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 931, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":951
+  /* "fastrometry/cython_code/WCS.pyx":932
  *     headervals[16] = CCVALS1_s
  *     headervals[17] = CCVALS2_h
  *     headervals[18] = CCVALS2_m             # <<<<<<<<<<<<<<
  *     headervals[19] = CCVALS2_s
  *     headervals[20] = CVAL1RM
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 18, __pyx_v_CCVALS2_m, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 951, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 18, __pyx_v_CCVALS2_m, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 932, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":952
+  /* "fastrometry/cython_code/WCS.pyx":933
  *     headervals[17] = CCVALS2_h
  *     headervals[18] = CCVALS2_m
  *     headervals[19] = CCVALS2_s             # <<<<<<<<<<<<<<
  *     headervals[20] = CVAL1RM
  *     headervals[21] = CVAL1RS
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 19, __pyx_v_CCVALS2_s, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 952, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 19, __pyx_v_CCVALS2_s, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 933, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":953
+  /* "fastrometry/cython_code/WCS.pyx":934
  *     headervals[18] = CCVALS2_m
  *     headervals[19] = CCVALS2_s
  *     headervals[20] = CVAL1RM             # <<<<<<<<<<<<<<
  *     headervals[21] = CVAL1RS
  *     headervals[22] = CVAL2RM
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 20, __pyx_v_CVAL1RM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 953, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 20, __pyx_v_CVAL1RM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 934, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":954
+  /* "fastrometry/cython_code/WCS.pyx":935
  *     headervals[19] = CCVALS2_s
  *     headervals[20] = CVAL1RM
  *     headervals[21] = CVAL1RS             # <<<<<<<<<<<<<<
  *     headervals[22] = CVAL2RM
  *     headervals[23] = CVAL2RS
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 21, __pyx_v_CVAL1RS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 954, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 21, __pyx_v_CVAL1RS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":955
+  /* "fastrometry/cython_code/WCS.pyx":936
  *     headervals[20] = CVAL1RM
  *     headervals[21] = CVAL1RS
  *     headervals[22] = CVAL2RM             # <<<<<<<<<<<<<<
  *     headervals[23] = CVAL2RS
  *     headervals[24] = CVALRM
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 22, __pyx_v_CVAL2RM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 22, __pyx_v_CVAL2RM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":956
+  /* "fastrometry/cython_code/WCS.pyx":937
  *     headervals[21] = CVAL1RS
  *     headervals[22] = CVAL2RM
  *     headervals[23] = CVAL2RS             # <<<<<<<<<<<<<<
  *     headervals[24] = CVALRM
  *     headervals[25] = CVALRS
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 23, __pyx_v_CVAL2RS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 956, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 23, __pyx_v_CVAL2RS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 937, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":957
+  /* "fastrometry/cython_code/WCS.pyx":938
  *     headervals[22] = CVAL2RM
  *     headervals[23] = CVAL2RS
  *     headervals[24] = CVALRM             # <<<<<<<<<<<<<<
  *     headervals[25] = CVALRS
  * 
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 24, __pyx_v_CVALRM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 957, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 24, __pyx_v_CVALRM, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 938, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":958
+  /* "fastrometry/cython_code/WCS.pyx":939
  *     headervals[23] = CVAL2RS
  *     headervals[24] = CVALRM
  *     headervals[25] = CVALRS             # <<<<<<<<<<<<<<
  * 
  *     if verbosity >= 1:
  */
-  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 25, __pyx_v_CVALRS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 958, __pyx_L1_error)
+  if (unlikely(__Pyx_SetItemInt(__pyx_v_headervals, 25, __pyx_v_CVALRS, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":960
+  /* "fastrometry/cython_code/WCS.pyx":941
  *     headervals[25] = CVALRS
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| done")
+ * 
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 960, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 960, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 941, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "fastrometry/cython_code/WCS.pyx":961
+    /* "fastrometry/cython_code/WCS.pyx":942
  * 
  *     if verbosity >= 1:
  *         print("| done")             # <<<<<<<<<<<<<<
+ * 
+ *     if verbosity >= 1:
  */
-    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 961, __pyx_L1_error)
+    if (__Pyx_PrintOne(0, __pyx_kp_s_done_2) < 0) __PYX_ERR(0, 942, __pyx_L1_error)
 
-    /* "fastrometry/cython_code/WCS.pyx":960
+    /* "fastrometry/cython_code/WCS.pyx":941
  *     headervals[25] = CVALRS
  * 
  *     if verbosity >= 1:             # <<<<<<<<<<<<<<
  *         print("| done")
+ * 
  */
   }
 
-  /* "fastrometry/cython_code/WCS.pyx":831
+  /* "fastrometry/cython_code/WCS.pyx":944
+ *         print("| done")
+ * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("done")
+ */
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_verbosity, __pyx_int_1, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (__pyx_t_2) {
+
+    /* "fastrometry/cython_code/WCS.pyx":945
+ * 
+ *     if verbosity >= 1:
+ *         print("done")             # <<<<<<<<<<<<<<
+ */
+    if (__Pyx_PrintOne(0, __pyx_n_s_done_3) < 0) __PYX_ERR(0, 945, __pyx_L1_error)
+
+    /* "fastrometry/cython_code/WCS.pyx":944
+ *         print("| done")
+ * 
+ *     if verbosity >= 1:             # <<<<<<<<<<<<<<
+ *         print("done")
+ */
+  }
+
+  /* "fastrometry/cython_code/WCS.pyx":809
+ *     return resultcode
  * 
- * @printEvent("Performing WCS...", "done", 1)
  * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):             # <<<<<<<<<<<<<<
  *     """
  *     """
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
@@ -22118,15 +21571,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 945, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 945, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -22250,15 +21703,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 951, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 951, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -22382,15 +21835,15 @@
       /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":957
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef extern from *:
  */
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_ImportError, __pyx_tuple__20, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(1, 957, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_Raise(__pyx_t_8, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __PYX_ERR(1, 957, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -22806,15 +22259,15 @@
     /* "View.MemoryView":133
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 133, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__21, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 133, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 133, __pyx_L1_error)
 
     /* "View.MemoryView":132
  *         self.itemsize = itemsize
@@ -22838,15 +22291,15 @@
     /* "View.MemoryView":136
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 136, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 136, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 136, __pyx_L1_error)
 
     /* "View.MemoryView":135
  *             raise ValueError("Empty shape tuple for cython.array")
@@ -22965,15 +22418,15 @@
     /* "View.MemoryView":148
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 148, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__23, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 148, __pyx_L1_error)
 
     /* "View.MemoryView":147
  *         self._strides = self._shape + self.ndim
@@ -23239,15 +22692,15 @@
       /* "View.MemoryView":176
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 176, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_builtin_MemoryError, __pyx_tuple__24, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(2, 176, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_Raise(__pyx_t_10, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __PYX_ERR(2, 176, __pyx_L1_error)
 
       /* "View.MemoryView":175
  * 
@@ -23483,15 +22936,15 @@
     /* "View.MemoryView":192
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 192, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 192, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 192, __pyx_L1_error)
 
     /* "View.MemoryView":191
  *         elif self.mode == u"fortran":
@@ -24217,15 +23670,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -24273,15 +23726,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__32, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__27, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -25983,15 +25436,15 @@
     /* "View.MemoryView":418
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 418, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__28, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 418, __pyx_L1_error)
 
     /* "View.MemoryView":417
  * 
@@ -27031,15 +26484,15 @@
       /* "View.MemoryView":495
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 495, __pyx_L5_except_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__29, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(2, 495, __pyx_L5_except_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_Raise(__pyx_t_6, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_ERR(2, 495, __pyx_L5_except_error)
     }
     goto __pyx_L5_except_error;
     __pyx_L5_except_error:;
@@ -27393,15 +26846,15 @@
     /* "View.MemoryView":520
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 520, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 520, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_Raise(__pyx_t_3, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_ERR(2, 520, __pyx_L1_error)
 
     /* "View.MemoryView":519
  *     @cname('getbuffer')
@@ -27942,15 +27395,15 @@
     /* "View.MemoryView":570
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 570, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_Raise(__pyx_t_2, 0, 0, 0);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_ERR(2, 570, __pyx_L1_error)
 
     /* "View.MemoryView":568
  *     @property
@@ -28059,15 +27512,15 @@
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_self->view.ndim); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__37, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 577, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__32, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
     /* "View.MemoryView":576
@@ -29097,15 +28550,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__38, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__33, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -29153,15 +28606,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__39, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__34, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -29510,17 +28963,17 @@
  *             else:
  */
         __pyx_t_8 = PyObject_Length(__pyx_v_tup); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(2, 682, __pyx_L1_error)
         __pyx_t_7 = PyList_New(1 * ((((__pyx_v_ndim - __pyx_t_8) + 1)<0) ? 0:((__pyx_v_ndim - __pyx_t_8) + 1))); if (unlikely(!__pyx_t_7)) __PYX_ERR(2, 682, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         { Py_ssize_t __pyx_temp;
           for (__pyx_temp=0; __pyx_temp < ((__pyx_v_ndim - __pyx_t_8) + 1); __pyx_temp++) {
-            __Pyx_INCREF(__pyx_slice__19);
-            __Pyx_GIVEREF(__pyx_slice__19);
-            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__19);
+            __Pyx_INCREF(__pyx_slice__14);
+            __Pyx_GIVEREF(__pyx_slice__14);
+            PyList_SET_ITEM(__pyx_t_7, __pyx_temp, __pyx_slice__14);
           }
         }
         __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_7); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 682, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
         /* "View.MemoryView":683
  *             if not seen_ellipsis:
@@ -29545,15 +28998,15 @@
  *                 seen_ellipsis = True
  *             else:
  *                 result.append(slice(None))             # <<<<<<<<<<<<<<
  *             have_slices = True
  *         else:
  */
       /*else*/ {
-        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__19); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 685, __pyx_L1_error)
+        __pyx_t_9 = __Pyx_PyList_Append(__pyx_v_result, __pyx_slice__14); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 685, __pyx_L1_error)
       }
       __pyx_L7:;
 
       /* "View.MemoryView":686
  *             else:
  *                 result.append(slice(None))
  *             have_slices = True             # <<<<<<<<<<<<<<
@@ -29685,17 +29138,17 @@
  * 
  *     return have_slices or nslices, tuple(result)
  */
     __pyx_t_3 = PyList_New(1 * ((__pyx_v_nslices<0) ? 0:__pyx_v_nslices)); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     { Py_ssize_t __pyx_temp;
       for (__pyx_temp=0; __pyx_temp < __pyx_v_nslices; __pyx_temp++) {
-        __Pyx_INCREF(__pyx_slice__19);
-        __Pyx_GIVEREF(__pyx_slice__19);
-        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__19);
+        __Pyx_INCREF(__pyx_slice__14);
+        __Pyx_GIVEREF(__pyx_slice__14);
+        PyList_SET_ITEM(__pyx_t_3, __pyx_temp, __pyx_slice__14);
       }
     }
     __pyx_t_9 = __Pyx_PyList_Extend(__pyx_v_result, __pyx_t_3); if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(2, 696, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
     /* "View.MemoryView":695
  * 
@@ -29814,15 +29267,15 @@
       /* "View.MemoryView":703
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__40, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 703, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__35, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(2, 703, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_Raise(__pyx_t_5, 0, 0, 0);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __PYX_ERR(2, 703, __pyx_L1_error)
 
       /* "View.MemoryView":702
  * cdef assert_direct_dimensions(Py_ssize_t *suboffsets, int ndim):
@@ -31998,15 +31451,15 @@
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__41, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__36, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 2, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 2, __pyx_L1_error)
 
   /* "(tree fragment)":1
  * def __reduce_cython__(self):             # <<<<<<<<<<<<<<
@@ -32054,15 +31507,15 @@
   __Pyx_RefNannySetupContext("__setstate_cython__", 0);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__42, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_TypeError, __pyx_tuple__37, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_Raise(__pyx_t_1, 0, 0, 0);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_ERR(2, 4, __pyx_L1_error)
 
   /* "(tree fragment)":3
  * def __reduce_cython__(self):
@@ -35331,15 +34784,15 @@
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):             # <<<<<<<<<<<<<<
  *         from pickle import PickleError as __pyx_PickleError
  *         raise __pyx_PickleError("Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))" % __pyx_checksum)
  */
   __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v___pyx_checksum); if (unlikely(!__pyx_t_1)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__43, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_t_1, __pyx_tuple__38, Py_NE)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
     /* "(tree fragment)":5
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xb068931, 0x82a3537, 0x6ae9995):
@@ -35624,271 +35077,14 @@
   __Pyx_AddTraceback("View.MemoryView.__pyx_unpickle_Enum__set_state", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
-
-static struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *__pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent[8];
-static int __pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent = 0;
-
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
-  PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent)))) {
-    o = (PyObject*)__pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent[--__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent];
-    memset(o, 0, sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent));
-    (void) PyObject_INIT(o, t);
-    PyObject_GC_Track(o);
-  } else {
-    o = (*t->tp_alloc)(t, 0);
-    if (unlikely(!o)) return 0;
-  }
-  return o;
-}
-
-static void __pyx_tp_dealloc_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(PyObject *o) {
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)o;
-  PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_v_endmessage);
-  Py_CLEAR(p->__pyx_v_levelneeded);
-  Py_CLEAR(p->__pyx_v_startmessage);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent)))) {
-    __pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent[__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent++] = ((struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)o);
-  } else {
-    (*Py_TYPE(o)->tp_free)(o);
-  }
-}
-
-static int __pyx_tp_traverse_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(PyObject *o, visitproc v, void *a) {
-  int e;
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)o;
-  if (p->__pyx_v_endmessage) {
-    e = (*v)(p->__pyx_v_endmessage, a); if (e) return e;
-  }
-  if (p->__pyx_v_levelneeded) {
-    e = (*v)(p->__pyx_v_levelneeded, a); if (e) return e;
-  }
-  if (p->__pyx_v_startmessage) {
-    e = (*v)(p->__pyx_v_startmessage, a); if (e) return e;
-  }
-  return 0;
-}
-
-static int __pyx_tp_clear_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent(PyObject *o) {
-  PyObject* tmp;
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)o;
-  tmp = ((PyObject*)p->__pyx_v_endmessage);
-  p->__pyx_v_endmessage = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_levelneeded);
-  p->__pyx_v_levelneeded = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_startmessage);
-  p->__pyx_v_startmessage = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  return 0;
-}
-
-static PyTypeObject __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent = {
-  PyVarObject_HEAD_INIT(0, 0)
-  "fastrometry.cython_code.WCS.__pyx_scope_struct__printEvent", /*tp_name*/
-  sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent), /*tp_basicsize*/
-  0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent, /*tp_dealloc*/
-  #if PY_VERSION_HEX < 0x030800b4
-  0, /*tp_print*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4
-  0, /*tp_vectorcall_offset*/
-  #endif
-  0, /*tp_getattr*/
-  0, /*tp_setattr*/
-  #if PY_MAJOR_VERSION < 3
-  0, /*tp_compare*/
-  #endif
-  #if PY_MAJOR_VERSION >= 3
-  0, /*tp_as_async*/
-  #endif
-  0, /*tp_repr*/
-  0, /*tp_as_number*/
-  0, /*tp_as_sequence*/
-  0, /*tp_as_mapping*/
-  0, /*tp_hash*/
-  0, /*tp_call*/
-  0, /*tp_str*/
-  0, /*tp_getattro*/
-  0, /*tp_setattro*/
-  0, /*tp_as_buffer*/
-  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
-  __pyx_tp_traverse_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent, /*tp_traverse*/
-  __pyx_tp_clear_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent, /*tp_clear*/
-  0, /*tp_richcompare*/
-  0, /*tp_weaklistoffset*/
-  0, /*tp_iter*/
-  0, /*tp_iternext*/
-  0, /*tp_methods*/
-  0, /*tp_members*/
-  0, /*tp_getset*/
-  0, /*tp_base*/
-  0, /*tp_dict*/
-  0, /*tp_descr_get*/
-  0, /*tp_descr_set*/
-  0, /*tp_dictoffset*/
-  0, /*tp_init*/
-  0, /*tp_alloc*/
-  __pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent, /*tp_new*/
-  0, /*tp_free*/
-  0, /*tp_is_gc*/
-  0, /*tp_bases*/
-  0, /*tp_mro*/
-  0, /*tp_cache*/
-  0, /*tp_subclasses*/
-  0, /*tp_weaklist*/
-  0, /*tp_del*/
-  0, /*tp_version_tag*/
-  #if PY_VERSION_HEX >= 0x030400a1
-  0, /*tp_finalize*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-  0, /*tp_vectorcall*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-  0, /*tp_print*/
-  #endif
-  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-  0, /*tp_pypy_flags*/
-  #endif
-};
-
-static struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *__pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator[8];
-static int __pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator = 0;
-
-static PyObject *__pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(PyTypeObject *t, CYTHON_UNUSED PyObject *a, CYTHON_UNUSED PyObject *k) {
-  PyObject *o;
-  if (CYTHON_COMPILING_IN_CPYTHON && likely((__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator > 0) & (t->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator)))) {
-    o = (PyObject*)__pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator[--__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator];
-    memset(o, 0, sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator));
-    (void) PyObject_INIT(o, t);
-    PyObject_GC_Track(o);
-  } else {
-    o = (*t->tp_alloc)(t, 0);
-    if (unlikely(!o)) return 0;
-  }
-  return o;
-}
-
-static void __pyx_tp_dealloc_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(PyObject *o) {
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)o;
-  PyObject_GC_UnTrack(o);
-  Py_CLEAR(p->__pyx_outer_scope);
-  Py_CLEAR(p->__pyx_v_f);
-  if (CYTHON_COMPILING_IN_CPYTHON && ((__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator < 8) & (Py_TYPE(o)->tp_basicsize == sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator)))) {
-    __pyx_freelist_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator[__pyx_freecount_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator++] = ((struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)o);
-  } else {
-    (*Py_TYPE(o)->tp_free)(o);
-  }
-}
-
-static int __pyx_tp_traverse_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(PyObject *o, visitproc v, void *a) {
-  int e;
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)o;
-  if (p->__pyx_outer_scope) {
-    e = (*v)(((PyObject *)p->__pyx_outer_scope), a); if (e) return e;
-  }
-  if (p->__pyx_v_f) {
-    e = (*v)(p->__pyx_v_f, a); if (e) return e;
-  }
-  return 0;
-}
-
-static int __pyx_tp_clear_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator(PyObject *o) {
-  PyObject* tmp;
-  struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *p = (struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator *)o;
-  tmp = ((PyObject*)p->__pyx_outer_scope);
-  p->__pyx_outer_scope = ((struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent *)Py_None); Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  tmp = ((PyObject*)p->__pyx_v_f);
-  p->__pyx_v_f = Py_None; Py_INCREF(Py_None);
-  Py_XDECREF(tmp);
-  return 0;
-}
-
-static PyTypeObject __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator = {
-  PyVarObject_HEAD_INIT(0, 0)
-  "fastrometry.cython_code.WCS.__pyx_scope_struct_1_decorator", /*tp_name*/
-  sizeof(struct __pyx_obj_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator), /*tp_basicsize*/
-  0, /*tp_itemsize*/
-  __pyx_tp_dealloc_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator, /*tp_dealloc*/
-  #if PY_VERSION_HEX < 0x030800b4
-  0, /*tp_print*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4
-  0, /*tp_vectorcall_offset*/
-  #endif
-  0, /*tp_getattr*/
-  0, /*tp_setattr*/
-  #if PY_MAJOR_VERSION < 3
-  0, /*tp_compare*/
-  #endif
-  #if PY_MAJOR_VERSION >= 3
-  0, /*tp_as_async*/
-  #endif
-  0, /*tp_repr*/
-  0, /*tp_as_number*/
-  0, /*tp_as_sequence*/
-  0, /*tp_as_mapping*/
-  0, /*tp_hash*/
-  0, /*tp_call*/
-  0, /*tp_str*/
-  0, /*tp_getattro*/
-  0, /*tp_setattro*/
-  0, /*tp_as_buffer*/
-  Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
-  __pyx_tp_traverse_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator, /*tp_traverse*/
-  __pyx_tp_clear_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator, /*tp_clear*/
-  0, /*tp_richcompare*/
-  0, /*tp_weaklistoffset*/
-  0, /*tp_iter*/
-  0, /*tp_iternext*/
-  0, /*tp_methods*/
-  0, /*tp_members*/
-  0, /*tp_getset*/
-  0, /*tp_base*/
-  0, /*tp_dict*/
-  0, /*tp_descr_get*/
-  0, /*tp_descr_set*/
-  0, /*tp_dictoffset*/
-  0, /*tp_init*/
-  0, /*tp_alloc*/
-  __pyx_tp_new_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator, /*tp_new*/
-  0, /*tp_free*/
-  0, /*tp_is_gc*/
-  0, /*tp_bases*/
-  0, /*tp_mro*/
-  0, /*tp_cache*/
-  0, /*tp_subclasses*/
-  0, /*tp_weaklist*/
-  0, /*tp_del*/
-  0, /*tp_version_tag*/
-  #if PY_VERSION_HEX >= 0x030400a1
-  0, /*tp_finalize*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-  0, /*tp_vectorcall*/
-  #endif
-  #if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-  0, /*tp_print*/
-  #endif
-  #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-  0, /*tp_pypy_flags*/
-  #endif
-};
 static struct __pyx_vtabstruct_array __pyx_vtable_array;
 
 static PyObject *__pyx_tp_new_array(PyTypeObject *t, PyObject *a, PyObject *k) {
   struct __pyx_array_obj *p;
   PyObject *o;
   if (likely((t->tp_flags & Py_TPFLAGS_IS_ABSTRACT) == 0)) {
     o = (*t->tp_alloc)(t, 0);
@@ -36785,61 +35981,57 @@
   {&__pyx_kp_s_S_ub, __pyx_k_S_ub, sizeof(__pyx_k_S_ub), 0, 0, 1, 0},
   {&__pyx_kp_s_Scale_arcsec_pixel, __pyx_k_Scale_arcsec_pixel, sizeof(__pyx_k_Scale_arcsec_pixel), 0, 0, 1, 0},
   {&__pyx_n_s_TypeError, __pyx_k_TypeError, sizeof(__pyx_k_TypeError), 0, 0, 1, 1},
   {&__pyx_kp_s_Unable_to_convert_item_to_object, __pyx_k_Unable_to_convert_item_to_object, sizeof(__pyx_k_Unable_to_convert_item_to_object), 0, 0, 1, 0},
   {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
   {&__pyx_n_s_View_MemoryView, __pyx_k_View_MemoryView, sizeof(__pyx_k_View_MemoryView), 0, 0, 1, 1},
   {&__pyx_n_s_WCS, __pyx_k_WCS, sizeof(__pyx_k_WCS), 0, 0, 1, 1},
-  {&__pyx_kp_s__10, __pyx_k__10, sizeof(__pyx_k__10), 0, 0, 1, 0},
-  {&__pyx_kp_s__11, __pyx_k__11, sizeof(__pyx_k__11), 0, 0, 1, 0},
+  {&__pyx_kp_s__2, __pyx_k__2, sizeof(__pyx_k__2), 0, 0, 1, 0},
+  {&__pyx_n_s__4, __pyx_k__4, sizeof(__pyx_k__4), 0, 0, 1, 1},
   {&__pyx_kp_s__6, __pyx_k__6, sizeof(__pyx_k__6), 0, 0, 1, 0},
-  {&__pyx_n_s__8, __pyx_k__8, sizeof(__pyx_k__8), 0, 0, 1, 1},
   {&__pyx_n_s_add_subplot, __pyx_k_add_subplot, sizeof(__pyx_k_add_subplot), 0, 0, 1, 1},
   {&__pyx_n_s_allintrmpoints, __pyx_k_allintrmpoints, sizeof(__pyx_k_allintrmpoints), 0, 0, 1, 1},
   {&__pyx_n_s_allocate_buffer, __pyx_k_allocate_buffer, sizeof(__pyx_k_allocate_buffer), 0, 0, 1, 1},
   {&__pyx_n_s_append, __pyx_k_append, sizeof(__pyx_k_append), 0, 0, 1, 1},
   {&__pyx_n_s_args, __pyx_k_args, sizeof(__pyx_k_args), 0, 0, 1, 1},
   {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
   {&__pyx_n_s_asarray, __pyx_k_asarray, sizeof(__pyx_k_asarray), 0, 0, 1, 1},
   {&__pyx_n_s_astropy_io, __pyx_k_astropy_io, sizeof(__pyx_k_astropy_io), 0, 0, 1, 1},
   {&__pyx_n_s_base, __pyx_k_base, sizeof(__pyx_k_base), 0, 0, 1, 1},
   {&__pyx_n_s_blue, __pyx_k_blue, sizeof(__pyx_k_blue), 0, 0, 1, 1},
   {&__pyx_n_s_bottom, __pyx_k_bottom, sizeof(__pyx_k_bottom), 0, 0, 1, 1},
   {&__pyx_n_s_bounds, __pyx_k_bounds, sizeof(__pyx_k_bounds), 0, 0, 1, 1},
-  {&__pyx_kp_s_brightest_PSE_and_intermediate, __pyx_k_brightest_PSE_and_intermediate, sizeof(__pyx_k_brightest_PSE_and_intermediate), 0, 0, 1, 0},
+  {&__pyx_kp_s_brightest_PSE_and_brightest_int, __pyx_k_brightest_PSE_and_brightest_int, sizeof(__pyx_k_brightest_PSE_and_brightest_int), 0, 0, 1, 0},
   {&__pyx_n_s_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 0, 1, 1},
   {&__pyx_n_u_c, __pyx_k_c, sizeof(__pyx_k_c), 0, 1, 0, 1},
   {&__pyx_n_s_catalogue_points, __pyx_k_catalogue_points, sizeof(__pyx_k_catalogue_points), 0, 0, 1, 1},
   {&__pyx_n_s_center, __pyx_k_center, sizeof(__pyx_k_center), 0, 0, 1, 1},
   {&__pyx_n_s_class, __pyx_k_class, sizeof(__pyx_k_class), 0, 0, 1, 1},
   {&__pyx_n_s_cline_in_traceback, __pyx_k_cline_in_traceback, sizeof(__pyx_k_cline_in_traceback), 0, 0, 1, 1},
   {&__pyx_n_s_cmap, __pyx_k_cmap, sizeof(__pyx_k_cmap), 0, 0, 1, 1},
   {&__pyx_n_s_color, __pyx_k_color, sizeof(__pyx_k_color), 0, 0, 1, 1},
   {&__pyx_kp_s_contiguous_and_direct, __pyx_k_contiguous_and_direct, sizeof(__pyx_k_contiguous_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_contiguous_and_indirect, __pyx_k_contiguous_and_indirect, sizeof(__pyx_k_contiguous_and_indirect), 0, 0, 1, 0},
   {&__pyx_n_s_debug, __pyx_k_debug, sizeof(__pyx_k_debug), 0, 0, 1, 1},
   {&__pyx_n_s_debug_report, __pyx_k_debug_report, sizeof(__pyx_k_debug_report), 0, 0, 1, 1},
-  {&__pyx_n_s_decorator, __pyx_k_decorator, sizeof(__pyx_k_decorator), 0, 0, 1, 1},
   {&__pyx_n_s_delimiter, __pyx_k_delimiter, sizeof(__pyx_k_delimiter), 0, 0, 1, 1},
   {&__pyx_n_s_determinant, __pyx_k_determinant, sizeof(__pyx_k_determinant), 0, 0, 1, 1},
   {&__pyx_n_s_dict, __pyx_k_dict, sizeof(__pyx_k_dict), 0, 0, 1, 1},
   {&__pyx_kp_s_done, __pyx_k_done, sizeof(__pyx_k_done), 0, 0, 1, 0},
   {&__pyx_kp_s_done_2, __pyx_k_done_2, sizeof(__pyx_k_done_2), 0, 0, 1, 0},
   {&__pyx_n_s_done_3, __pyx_k_done_3, sizeof(__pyx_k_done_3), 0, 0, 1, 1},
   {&__pyx_n_s_double, __pyx_k_double, sizeof(__pyx_k_double), 0, 0, 1, 1},
   {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
   {&__pyx_n_s_dtype_is_object, __pyx_k_dtype_is_object, sizeof(__pyx_k_dtype_is_object), 0, 0, 1, 1},
   {&__pyx_n_s_empty, __pyx_k_empty, sizeof(__pyx_k_empty), 0, 0, 1, 1},
   {&__pyx_n_s_encode, __pyx_k_encode, sizeof(__pyx_k_encode), 0, 0, 1, 1},
   {&__pyx_n_s_end, __pyx_k_end, sizeof(__pyx_k_end), 0, 0, 1, 1},
-  {&__pyx_n_s_endmessage, __pyx_k_endmessage, sizeof(__pyx_k_endmessage), 0, 0, 1, 1},
   {&__pyx_n_s_enumerate, __pyx_k_enumerate, sizeof(__pyx_k_enumerate), 0, 0, 1, 1},
   {&__pyx_n_s_error, __pyx_k_error, sizeof(__pyx_k_error), 0, 0, 1, 1},
   {&__pyx_n_s_exit, __pyx_k_exit, sizeof(__pyx_k_exit), 0, 0, 1, 1},
-  {&__pyx_n_s_f, __pyx_k_f, sizeof(__pyx_k_f), 0, 0, 1, 1},
   {&__pyx_n_s_fastrometry_cython_code_WCS, __pyx_k_fastrometry_cython_code_WCS, sizeof(__pyx_k_fastrometry_cython_code_WCS), 0, 0, 1, 1},
   {&__pyx_n_s_figsize, __pyx_k_figsize, sizeof(__pyx_k_figsize), 0, 0, 1, 1},
   {&__pyx_n_s_figtext, __pyx_k_figtext, sizeof(__pyx_k_figtext), 0, 0, 1, 1},
   {&__pyx_n_s_figure, __pyx_k_figure, sizeof(__pyx_k_figure), 0, 0, 1, 1},
   {&__pyx_n_s_file, __pyx_k_file, sizeof(__pyx_k_file), 0, 0, 1, 1},
   {&__pyx_n_s_filename_body, __pyx_k_filename_body, sizeof(__pyx_k_filename_body), 0, 0, 1, 1},
   {&__pyx_n_s_filepath, __pyx_k_filepath, sizeof(__pyx_k_filepath), 0, 0, 1, 1},
@@ -36847,15 +36039,14 @@
   {&__pyx_n_s_fitTrianglesToGetSphi, __pyx_k_fitTrianglesToGetSphi, sizeof(__pyx_k_fitTrianglesToGetSphi), 0, 0, 1, 1},
   {&__pyx_n_s_fits, __pyx_k_fits, sizeof(__pyx_k_fits), 0, 0, 1, 1},
   {&__pyx_n_s_flags, __pyx_k_flags, sizeof(__pyx_k_flags), 0, 0, 1, 1},
   {&__pyx_n_s_fontsize, __pyx_k_fontsize, sizeof(__pyx_k_fontsize), 0, 0, 1, 1},
   {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
   {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
-  {&__pyx_n_s_fout, __pyx_k_fout, sizeof(__pyx_k_fout), 0, 0, 1, 1},
   {&__pyx_n_s_fuchsia, __pyx_k_fuchsia, sizeof(__pyx_k_fuchsia), 0, 0, 1, 1},
   {&__pyx_n_s_fun, __pyx_k_fun, sizeof(__pyx_k_fun), 0, 0, 1, 1},
   {&__pyx_n_s_getdata, __pyx_k_getdata, sizeof(__pyx_k_getdata), 0, 0, 1, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
   {&__pyx_kp_s_got_differing_extents_in_dimensi, __pyx_k_got_differing_extents_in_dimensi, sizeof(__pyx_k_got_differing_extents_in_dimensi), 0, 0, 1, 0},
   {&__pyx_n_s_gray, __pyx_k_gray, sizeof(__pyx_k_gray), 0, 0, 1, 1},
   {&__pyx_n_s_ha, __pyx_k_ha, sizeof(__pyx_k_ha), 0, 0, 1, 1},
@@ -36880,18 +36071,16 @@
   {&__pyx_n_s_inverseTransformPointUsingCD, __pyx_k_inverseTransformPointUsingCD, sizeof(__pyx_k_inverseTransformPointUsingCD), 0, 0, 1, 1},
   {&__pyx_kp_s_inversetrans_matches_initial__pn, __pyx_k_inversetrans_matches_initial__pn, sizeof(__pyx_k_inversetrans_matches_initial__pn), 0, 0, 1, 0},
   {&__pyx_kp_s_inversetrans_matches_refine__png, __pyx_k_inversetrans_matches_refine__png, sizeof(__pyx_k_inversetrans_matches_refine__png), 0, 0, 1, 0},
   {&__pyx_n_s_invtransf_intrmpoint_view, __pyx_k_invtransf_intrmpoint_view, sizeof(__pyx_k_invtransf_intrmpoint_view), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
   {&__pyx_n_s_kerneldiam, __pyx_k_kerneldiam, sizeof(__pyx_k_kerneldiam), 0, 0, 1, 1},
-  {&__pyx_n_s_kwargs, __pyx_k_kwargs, sizeof(__pyx_k_kwargs), 0, 0, 1, 1},
   {&__pyx_n_s_least_squares, __pyx_k_least_squares, sizeof(__pyx_k_least_squares), 0, 0, 1, 1},
   {&__pyx_n_s_left, __pyx_k_left, sizeof(__pyx_k_left), 0, 0, 1, 1},
-  {&__pyx_n_s_levelneeded, __pyx_k_levelneeded, sizeof(__pyx_k_levelneeded), 0, 0, 1, 1},
   {&__pyx_n_s_m, __pyx_k_m, sizeof(__pyx_k_m), 0, 0, 1, 1},
   {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
   {&__pyx_n_s_marker, __pyx_k_marker, sizeof(__pyx_k_marker), 0, 0, 1, 1},
   {&__pyx_n_s_matchdata, __pyx_k_matchdata, sizeof(__pyx_k_matchdata), 0, 0, 1, 1},
   {&__pyx_kp_s_matchdata_initial__csv, __pyx_k_matchdata_initial__csv, sizeof(__pyx_k_matchdata_initial__csv), 0, 0, 1, 0},
   {&__pyx_kp_s_matchdata_refine__csv, __pyx_k_matchdata_refine__csv, sizeof(__pyx_k_matchdata_refine__csv), 0, 0, 1, 0},
   {&__pyx_kp_s_matchdata_wcsdiagnostic_csv, __pyx_k_matchdata_wcsdiagnostic_csv, sizeof(__pyx_k_matchdata_wcsdiagnostic_csv), 0, 0, 1, 0},
@@ -36914,31 +36103,29 @@
   {&__pyx_n_s_nrefinepts, __pyx_k_nrefinepts, sizeof(__pyx_k_nrefinepts), 0, 0, 1, 1},
   {&__pyx_n_s_num_catsources, __pyx_k_num_catsources, sizeof(__pyx_k_num_catsources), 0, 0, 1, 1},
   {&__pyx_n_s_num_matches, __pyx_k_num_matches, sizeof(__pyx_k_num_matches), 0, 0, 1, 1},
   {&__pyx_n_s_num_psesources, __pyx_k_num_psesources, sizeof(__pyx_k_num_psesources), 0, 0, 1, 1},
   {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
   {&__pyx_kp_s_numpy_core_multiarray_failed_to, __pyx_k_numpy_core_multiarray_failed_to, sizeof(__pyx_k_numpy_core_multiarray_failed_to), 0, 0, 1, 0},
   {&__pyx_kp_s_numpy_core_umath_failed_to_impor, __pyx_k_numpy_core_umath_failed_to_impor, sizeof(__pyx_k_numpy_core_umath_failed_to_impor), 0, 0, 1, 0},
+  {&__pyx_n_s_o, __pyx_k_o, sizeof(__pyx_k_o), 0, 0, 1, 1},
   {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
   {&__pyx_n_s_optimization, __pyx_k_optimization, sizeof(__pyx_k_optimization), 0, 0, 1, 1},
   {&__pyx_n_s_pack, __pyx_k_pack, sizeof(__pyx_k_pack), 0, 0, 1, 1},
   {&__pyx_n_s_params, __pyx_k_params, sizeof(__pyx_k_params), 0, 0, 1, 1},
   {&__pyx_n_s_phi, __pyx_k_phi, sizeof(__pyx_k_phi), 0, 0, 1, 1},
   {&__pyx_kp_s_phi_guess, __pyx_k_phi_guess, sizeof(__pyx_k_phi_guess), 0, 0, 1, 0},
   {&__pyx_kp_s_phi_guess_TBD_in_loop, __pyx_k_phi_guess_TBD_in_loop, sizeof(__pyx_k_phi_guess_TBD_in_loop), 0, 0, 1, 0},
   {&__pyx_kp_s_phi_lb, __pyx_k_phi_lb, sizeof(__pyx_k_phi_lb), 0, 0, 1, 0},
   {&__pyx_kp_s_phi_lb_TBD_in_loop, __pyx_k_phi_lb_TBD_in_loop, sizeof(__pyx_k_phi_lb_TBD_in_loop), 0, 0, 1, 0},
   {&__pyx_kp_s_phi_ub, __pyx_k_phi_ub, sizeof(__pyx_k_phi_ub), 0, 0, 1, 0},
   {&__pyx_kp_s_phi_ub_TBD_in_loop, __pyx_k_phi_ub_TBD_in_loop, sizeof(__pyx_k_phi_ub_TBD_in_loop), 0, 0, 1, 0},
   {&__pyx_n_s_pickle, __pyx_k_pickle, sizeof(__pyx_k_pickle), 0, 0, 1, 1},
   {&__pyx_n_s_plt, __pyx_k_plt, sizeof(__pyx_k_plt), 0, 0, 1, 1},
   {&__pyx_n_s_print, __pyx_k_print, sizeof(__pyx_k_print), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent, __pyx_k_printEvent, sizeof(__pyx_k_printEvent), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent_locals_decorator, __pyx_k_printEvent_locals_decorator, sizeof(__pyx_k_printEvent_locals_decorator), 0, 0, 1, 1},
-  {&__pyx_n_s_printEvent_locals_decorator_loca, __pyx_k_printEvent_locals_decorator_loca, sizeof(__pyx_k_printEvent_locals_decorator_loca), 0, 0, 1, 1},
   {&__pyx_n_s_pseAx, __pyx_k_pseAx, sizeof(__pyx_k_pseAx), 0, 0, 1, 1},
   {&__pyx_n_s_pseAy, __pyx_k_pseAy, sizeof(__pyx_k_pseAy), 0, 0, 1, 1},
   {&__pyx_n_s_pseBx, __pyx_k_pseBx, sizeof(__pyx_k_pseBx), 0, 0, 1, 1},
   {&__pyx_n_s_pseBy, __pyx_k_pseBy, sizeof(__pyx_k_pseBy), 0, 0, 1, 1},
   {&__pyx_n_s_pseCx, __pyx_k_pseCx, sizeof(__pyx_k_pseCx), 0, 0, 1, 1},
   {&__pyx_n_s_pseCy, __pyx_k_pseCy, sizeof(__pyx_k_pseCy), 0, 0, 1, 1},
   {&__pyx_n_s_pse_metadata, __pyx_k_pse_metadata, sizeof(__pyx_k_pse_metadata), 0, 0, 1, 1},
@@ -36987,15 +36174,14 @@
   {&__pyx_n_s_show, __pyx_k_show, sizeof(__pyx_k_show), 0, 0, 1, 1},
   {&__pyx_n_s_size, __pyx_k_size, sizeof(__pyx_k_size), 0, 0, 1, 1},
   {&__pyx_kp_s_skypoints_matches_view_csv, __pyx_k_skypoints_matches_view_csv, sizeof(__pyx_k_skypoints_matches_view_csv), 0, 0, 1, 0},
   {&__pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_k_src_fastrometry_cython_code_WCS, sizeof(__pyx_k_src_fastrometry_cython_code_WCS), 0, 0, 1, 0},
   {&__pyx_n_s_srcindexmap_initial, __pyx_k_srcindexmap_initial, sizeof(__pyx_k_srcindexmap_initial), 0, 0, 1, 1},
   {&__pyx_n_s_srcindexmap_refine, __pyx_k_srcindexmap_refine, sizeof(__pyx_k_srcindexmap_refine), 0, 0, 1, 1},
   {&__pyx_n_s_start, __pyx_k_start, sizeof(__pyx_k_start), 0, 0, 1, 1},
-  {&__pyx_n_s_startmessage, __pyx_k_startmessage, sizeof(__pyx_k_startmessage), 0, 0, 1, 1},
   {&__pyx_n_s_std, __pyx_k_std, sizeof(__pyx_k_std), 0, 0, 1, 1},
   {&__pyx_n_s_step, __pyx_k_step, sizeof(__pyx_k_step), 0, 0, 1, 1},
   {&__pyx_n_s_stop, __pyx_k_stop, sizeof(__pyx_k_stop), 0, 0, 1, 1},
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
@@ -37011,25 +36197,22 @@
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
   {&__pyx_n_s_user_dir, __pyx_k_user_dir, sizeof(__pyx_k_user_dir), 0, 0, 1, 1},
   {&__pyx_n_s_verbosity, __pyx_k_verbosity, sizeof(__pyx_k_verbosity), 0, 0, 1, 1},
   {&__pyx_n_s_vertextol, __pyx_k_vertextol, sizeof(__pyx_k_vertextol), 0, 0, 1, 1},
   {&__pyx_n_s_wcs_diagnostics, __pyx_k_wcs_diagnostics, sizeof(__pyx_k_wcs_diagnostics), 0, 0, 1, 1},
   {&__pyx_n_s_wcsdiagnostics, __pyx_k_wcsdiagnostics, sizeof(__pyx_k_wcsdiagnostics), 0, 0, 1, 1},
   {&__pyx_kp_s_working_with_PSE_sources_and_ca, __pyx_k_working_with_PSE_sources_and_ca, sizeof(__pyx_k_working_with_PSE_sources_and_ca), 0, 0, 1, 0},
-  {&__pyx_n_s_wrapper, __pyx_k_wrapper, sizeof(__pyx_k_wrapper), 0, 0, 1, 1},
   {&__pyx_n_s_wspace, __pyx_k_wspace, sizeof(__pyx_k_wspace), 0, 0, 1, 1},
   {&__pyx_n_s_x, __pyx_k_x, sizeof(__pyx_k_x), 0, 0, 1, 1},
   {&__pyx_n_s_x0, __pyx_k_x0, sizeof(__pyx_k_x0), 0, 0, 1, 1},
-  {&__pyx_n_s_x_scale, __pyx_k_x_scale, sizeof(__pyx_k_x_scale), 0, 0, 1, 1},
-  {&__pyx_n_s_yellow, __pyx_k_yellow, sizeof(__pyx_k_yellow), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 39, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 945, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(2, 133, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(2, 148, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(2, 151, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(2, 2, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(2, 404, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(2, 613, __pyx_L1_error)
@@ -37039,504 +36222,457 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "fastrometry/cython_code/WCS.pyx":18
- *     """
- *     def decorator(f):
- *         def wrapper(*args, **kwargs):             # <<<<<<<<<<<<<<
- *             verbosity = args[-1]
- *             if verbosity >= levelneeded:
- */
-  __pyx_tuple_ = PyTuple_Pack(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_verbosity, __pyx_n_s_fout); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 18, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple_);
-  __Pyx_GIVEREF(__pyx_tuple_);
-  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_wrapper, 18, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 18, __pyx_L1_error)
-
-  /* "fastrometry/cython_code/WCS.pyx":17
- *     level are specified in the decorator factory arguments.
- *     """
- *     def decorator(f):             # <<<<<<<<<<<<<<
- *         def wrapper(*args, **kwargs):
- *             verbosity = args[-1]
- */
-  __pyx_tuple__3 = PyTuple_Pack(3, __pyx_n_s_f, __pyx_n_s_wrapper, __pyx_n_s_wrapper); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 17, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__3);
-  __Pyx_GIVEREF(__pyx_tuple__3);
-  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__3, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_decorator, 17, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 17, __pyx_L1_error)
-
-  /* "fastrometry/cython_code/WCS.pyx":77
+  /* "fastrometry/cython_code/WCS.pyx":56
  *         double centy = int(img_ymax/2)
  *         double[:,:] pixelpoint_center_view = np.array([[centx,centy]])
  *         double[:,:] skypoint_center_view = np.zeros((1,2))             # <<<<<<<<<<<<<<
  *         double[:,:] skypoints_matches_view = np.zeros((matches,2))
  *         double[:] residuals_ra = np.zeros(matches)
  */
-  __pyx_tuple__5 = PyTuple_Pack(2, __pyx_int_1, __pyx_int_2); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 77, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__5);
-  __Pyx_GIVEREF(__pyx_tuple__5);
+  __pyx_tuple_ = PyTuple_Pack(2, __pyx_int_1, __pyx_int_2); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 56, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple_);
+  __Pyx_GIVEREF(__pyx_tuple_);
 
-  /* "fastrometry/cython_code/WCS.pyx":248
+  /* "fastrometry/cython_code/WCS.pyx":227
  *         double CRPIXx_guess = CRPIXx
  *         double CRPIXy_guess = CRPIXy
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)             # <<<<<<<<<<<<<<
  *         Py_ssize_t k
  *         Py_ssize_t m
  */
-  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_int_2); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 248, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__7);
-  __Pyx_GIVEREF(__pyx_tuple__7);
+  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_int_2); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__3);
+  __Pyx_GIVEREF(__pyx_tuple__3);
 
-  /* "fastrometry/cython_code/WCS.pyx":293
+  /* "fastrometry/cython_code/WCS.pyx":272
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(9.5,8))             # <<<<<<<<<<<<<<
  * 
  *         axes = fig.add_subplot(111)
  */
-  __pyx_tuple__9 = PyTuple_Pack(2, __pyx_float_9_5, __pyx_int_8); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 293, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__9);
-  __Pyx_GIVEREF(__pyx_tuple__9);
+  __pyx_tuple__5 = PyTuple_Pack(2, __pyx_float_9_5, __pyx_int_8); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__5);
+  __Pyx_GIVEREF(__pyx_tuple__5);
 
-  /* "fastrometry/cython_code/WCS.pyx":561
+  /* "fastrometry/cython_code/WCS.pyx":540
  *         Py_ssize_t c
  *         Py_ssize_t propertyNo
  *         double[:] triangledata_view = np.empty(11,dtype=np.double)             # <<<<<<<<<<<<<<
  * 
  *     triangleNo = 0
  */
-  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_int_11); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 561, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__12);
-  __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_int_11); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__7);
+  __Pyx_GIVEREF(__pyx_tuple__7);
 
-  /* "fastrometry/cython_code/WCS.pyx":634
+  /* "fastrometry/cython_code/WCS.pyx":613
  *         double intrmlengthBC_lb
  *         double intrmlengthBC_ub
  *         double[:,:] invtransf_intrmtriangle_view = np.empty((3,2),dtype=np.double)             # <<<<<<<<<<<<<<
  *         double[:] invtransf_intrmpoint_view = np.empty(2,dtype=np.double)
  *         int resultcode = 0
  */
-  __pyx_tuple__13 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_2); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 634, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__13);
-  __Pyx_GIVEREF(__pyx_tuple__13);
-  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_tuple__13); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 634, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__14);
-  __Pyx_GIVEREF(__pyx_tuple__14);
+  __pyx_tuple__8 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_2); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__8);
+  __Pyx_GIVEREF(__pyx_tuple__8);
+  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_tuple__8); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__9);
+  __Pyx_GIVEREF(__pyx_tuple__9);
 
-  /* "fastrometry/cython_code/WCS.pyx":707
+  /* "fastrometry/cython_code/WCS.pyx":686
  *         from astropy.io import fits
  *         image_data = fits.getdata(filepath)
  *         fig = plt.figure(figsize=(15,7.5))             # <<<<<<<<<<<<<<
  * 
  *         axes1 = fig.add_subplot(121)
  */
-  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_int_15, __pyx_float_7_5); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 707, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__15);
-  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__10 = PyTuple_Pack(2, __pyx_int_15, __pyx_float_7_5); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 686, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__10);
+  __Pyx_GIVEREF(__pyx_tuple__10);
 
-  /* "fastrometry/cython_code/WCS.pyx":712
+  /* "fastrometry/cython_code/WCS.pyx":691
  *         axes1.set_title('10 brightest PSE and intermediate points')
  *         axes1.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes1.scatter(np.asarray(psepoints_view)[:10,0], np.asarray(psepoints_view)[:10,1], marker=".", c="blue")             # <<<<<<<<<<<<<<
  *         axes1.scatter(img_xmax-np.asarray(intrmpoints_view)[:10,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:10,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  */
-  __pyx_slice__16 = PySlice_New(Py_None, __pyx_int_10, Py_None); if (unlikely(!__pyx_slice__16)) __PYX_ERR(0, 712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__16);
-  __Pyx_GIVEREF(__pyx_slice__16);
-  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_slice__16, __pyx_int_0); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__17);
-  __Pyx_GIVEREF(__pyx_tuple__17);
-  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_slice__16, __pyx_int_1); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 712, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__18);
-  __Pyx_GIVEREF(__pyx_tuple__18);
+  __pyx_slice__11 = PySlice_New(Py_None, __pyx_int_10, Py_None); if (unlikely(!__pyx_slice__11)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__11);
+  __Pyx_GIVEREF(__pyx_slice__11);
+  __pyx_tuple__12 = PyTuple_Pack(2, __pyx_slice__11, __pyx_int_0); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__12);
+  __Pyx_GIVEREF(__pyx_tuple__12);
+  __pyx_tuple__13 = PyTuple_Pack(2, __pyx_slice__11, __pyx_int_1); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 691, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__13);
+  __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "fastrometry/cython_code/WCS.pyx":718
- *         axes2.set_title('{} brightest PSE and {} intermediate points'.format(npts_pse,npts_intrm))
+  /* "fastrometry/cython_code/WCS.pyx":697
+ *         axes2.set_title('{} brightest PSE and {} brightest intermediate points'.format(npts_pse, npts_intrm))
  *         axes2.imshow(image_data, cmap="gray", norm=LogNorm())
  *         axes2.scatter(np.asarray(psepoints_view)[:,0], np.asarray(psepoints_view)[:,1], marker=".", c="blue")             # <<<<<<<<<<<<<<
  *         axes2.scatter(img_xmax-np.asarray(intrmpoints_view)[:,0]/approx_scale-CRPIXx_guess, img_ymax-np.asarray(intrmpoints_view)[:,1]/approx_scale-CRPIXy_guess, marker=".", c="red")
  * 
  */
-  __pyx_slice__19 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__19)) __PYX_ERR(0, 718, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_slice__19);
-  __Pyx_GIVEREF(__pyx_slice__19);
-  __pyx_tuple__20 = PyTuple_Pack(2, __pyx_slice__19, __pyx_int_0); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 718, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__20);
-  __Pyx_GIVEREF(__pyx_tuple__20);
-  __pyx_tuple__21 = PyTuple_Pack(2, __pyx_slice__19, __pyx_int_1); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 718, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__21);
-  __Pyx_GIVEREF(__pyx_tuple__21);
+  __pyx_slice__14 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__14)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_slice__14);
+  __Pyx_GIVEREF(__pyx_slice__14);
+  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_slice__14, __pyx_int_0); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__15);
+  __Pyx_GIVEREF(__pyx_tuple__15);
+  __pyx_tuple__16 = PyTuple_Pack(2, __pyx_slice__14, __pyx_int_1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__16);
+  __Pyx_GIVEREF(__pyx_tuple__16);
 
-  /* "fastrometry/cython_code/WCS.pyx":752
+  /* "fastrometry/cython_code/WCS.pyx":731
  *                         if user_rotation is False:
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol             # <<<<<<<<<<<<<<
  *                             bnds[1,1] = theta + vertextol
  *                         else:
  */
-  __pyx_tuple__22 = PyTuple_Pack(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 752, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__22);
-  __Pyx_GIVEREF(__pyx_tuple__22);
+  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_int_0, __pyx_int_1); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__17);
+  __Pyx_GIVEREF(__pyx_tuple__17);
 
-  /* "fastrometry/cython_code/WCS.pyx":753
+  /* "fastrometry/cython_code/WCS.pyx":732
  *                             guess[1] = theta
  *                             bnds[0,1] = theta - vertextol
  *                             bnds[1,1] = theta + vertextol             # <<<<<<<<<<<<<<
  *                         else:
  *                             if theta < phi_lb or theta > phi_ub:
  */
-  __pyx_tuple__23 = PyTuple_Pack(2, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 753, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__23);
-  __Pyx_GIVEREF(__pyx_tuple__23);
+  __pyx_tuple__18 = PyTuple_Pack(2, __pyx_int_1, __pyx_int_1); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 732, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__18);
+  __Pyx_GIVEREF(__pyx_tuple__18);
 
   /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":945
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_umath() except -1:
  */
-  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(1, 945, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__24);
-  __Pyx_GIVEREF(__pyx_tuple__24);
+  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_multiarray_failed_to); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(1, 945, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__19);
+  __Pyx_GIVEREF(__pyx_tuple__19);
 
   /* "../../AppData/Local/Programs/Python/Python310/lib/site-packages/numpy/__init__.pxd":951
  *         _import_umath()
  *     except Exception:
  *         raise ImportError("numpy.core.umath failed to import")             # <<<<<<<<<<<<<<
  * 
  * cdef inline int import_ufunc() except -1:
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(1, 951, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__25);
-  __Pyx_GIVEREF(__pyx_tuple__25);
+  __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_s_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 951, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__20);
+  __Pyx_GIVEREF(__pyx_tuple__20);
 
   /* "View.MemoryView":133
  * 
  *         if not self.ndim:
  *             raise ValueError("Empty shape tuple for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if itemsize <= 0:
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 133, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__26);
-  __Pyx_GIVEREF(__pyx_tuple__26);
+  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_kp_s_Empty_shape_tuple_for_cython_arr); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(2, 133, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__21);
+  __Pyx_GIVEREF(__pyx_tuple__21);
 
   /* "View.MemoryView":136
  * 
  *         if itemsize <= 0:
  *             raise ValueError("itemsize <= 0 for cython.array")             # <<<<<<<<<<<<<<
  * 
  *         if not isinstance(format, bytes):
  */
-  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 136, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__27);
-  __Pyx_GIVEREF(__pyx_tuple__27);
+  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_kp_s_itemsize_0_for_cython_array); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(2, 136, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__22);
+  __Pyx_GIVEREF(__pyx_tuple__22);
 
   /* "View.MemoryView":148
  * 
  *         if not self._shape:
  *             raise MemoryError("unable to allocate shape and strides.")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 148, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__28);
-  __Pyx_GIVEREF(__pyx_tuple__28);
+  __pyx_tuple__23 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_shape_and_str); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(2, 148, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__23);
+  __Pyx_GIVEREF(__pyx_tuple__23);
 
   /* "View.MemoryView":176
  *             self.data = <char *>malloc(self.len)
  *             if not self.data:
  *                 raise MemoryError("unable to allocate array data.")             # <<<<<<<<<<<<<<
  * 
  *             if self.dtype_is_object:
  */
-  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__29);
-  __Pyx_GIVEREF(__pyx_tuple__29);
+  __pyx_tuple__24 = PyTuple_Pack(1, __pyx_kp_s_unable_to_allocate_array_data); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(2, 176, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__24);
+  __Pyx_GIVEREF(__pyx_tuple__24);
 
   /* "View.MemoryView":192
  *             bufmode = PyBUF_F_CONTIGUOUS | PyBUF_ANY_CONTIGUOUS
  *         if not (flags & bufmode):
  *             raise ValueError("Can only create a buffer that is contiguous in memory.")             # <<<<<<<<<<<<<<
  *         info.buf = self.data
  *         info.len = self.len
  */
-  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 192, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__30);
-  __Pyx_GIVEREF(__pyx_tuple__30);
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_s_Can_only_create_a_buffer_that_is); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(2, 192, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__25);
+  __Pyx_GIVEREF(__pyx_tuple__25);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__31);
-  __Pyx_GIVEREF(__pyx_tuple__31);
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__26);
+  __Pyx_GIVEREF(__pyx_tuple__26);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__32);
-  __Pyx_GIVEREF(__pyx_tuple__32);
+  __pyx_tuple__27 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__27);
+  __Pyx_GIVEREF(__pyx_tuple__27);
 
   /* "View.MemoryView":418
  *     def __setitem__(memoryview self, object index, object value):
  *         if self.view.readonly:
  *             raise TypeError("Cannot assign to read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         have_slices, index = _unellipsify(index, self.view.ndim)
  */
-  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 418, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__33);
-  __Pyx_GIVEREF(__pyx_tuple__33);
+  __pyx_tuple__28 = PyTuple_Pack(1, __pyx_kp_s_Cannot_assign_to_read_only_memor); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(2, 418, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__28);
+  __Pyx_GIVEREF(__pyx_tuple__28);
 
   /* "View.MemoryView":495
  *             result = struct.unpack(self.view.format, bytesitem)
  *         except struct.error:
  *             raise ValueError("Unable to convert item to object")             # <<<<<<<<<<<<<<
  *         else:
  *             if len(self.view.format) == 1:
  */
-  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(2, 495, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__34);
-  __Pyx_GIVEREF(__pyx_tuple__34);
+  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_kp_s_Unable_to_convert_item_to_object); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(2, 495, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__29);
+  __Pyx_GIVEREF(__pyx_tuple__29);
 
   /* "View.MemoryView":520
  *     def __getbuffer__(self, Py_buffer *info, int flags):
  *         if flags & PyBUF_WRITABLE and self.view.readonly:
  *             raise ValueError("Cannot create writable memory view from read-only memoryview")             # <<<<<<<<<<<<<<
  * 
  *         if flags & PyBUF_ND:
  */
-  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(2, 520, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__35);
-  __Pyx_GIVEREF(__pyx_tuple__35);
+  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_kp_s_Cannot_create_writable_memory_vi); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(2, 520, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__30);
+  __Pyx_GIVEREF(__pyx_tuple__30);
 
   /* "View.MemoryView":570
  *         if self.view.strides == NULL:
  * 
  *             raise ValueError("Buffer view does not expose strides")             # <<<<<<<<<<<<<<
  * 
  *         return tuple([stride for stride in self.view.strides[:self.view.ndim]])
  */
-  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(2, 570, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__36);
-  __Pyx_GIVEREF(__pyx_tuple__36);
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_s_Buffer_view_does_not_expose_stri); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(2, 570, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__31);
+  __Pyx_GIVEREF(__pyx_tuple__31);
 
   /* "View.MemoryView":577
  *     def suboffsets(self):
  *         if self.view.suboffsets == NULL:
  *             return (-1,) * self.view.ndim             # <<<<<<<<<<<<<<
  * 
  *         return tuple([suboffset for suboffset in self.view.suboffsets[:self.view.ndim]])
  */
-  __pyx_tuple__37 = PyTuple_New(1); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 577, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__37);
+  __pyx_tuple__32 = PyTuple_New(1); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(2, 577, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__32);
   __Pyx_INCREF(__pyx_int_neg_1);
   __Pyx_GIVEREF(__pyx_int_neg_1);
-  PyTuple_SET_ITEM(__pyx_tuple__37, 0, __pyx_int_neg_1);
-  __Pyx_GIVEREF(__pyx_tuple__37);
+  PyTuple_SET_ITEM(__pyx_tuple__32, 0, __pyx_int_neg_1);
+  __Pyx_GIVEREF(__pyx_tuple__32);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__38);
-  __Pyx_GIVEREF(__pyx_tuple__38);
+  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__33);
+  __Pyx_GIVEREF(__pyx_tuple__33);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__39);
-  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__34);
+  __Pyx_GIVEREF(__pyx_tuple__34);
 
   /* "View.MemoryView":703
  *     for suboffset in suboffsets[:ndim]:
  *         if suboffset >= 0:
  *             raise ValueError("Indirect dimensions not supported")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(2, 703, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__40);
-  __Pyx_GIVEREF(__pyx_tuple__40);
+  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_kp_s_Indirect_dimensions_not_supporte); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(2, 703, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__35);
+  __Pyx_GIVEREF(__pyx_tuple__35);
 
   /* "(tree fragment)":2
  * def __reduce_cython__(self):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  */
-  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(2, 2, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__41);
-  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(2, 2, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__36);
+  __Pyx_GIVEREF(__pyx_tuple__36);
 
   /* "(tree fragment)":4
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
-  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__42);
-  __Pyx_GIVEREF(__pyx_tuple__42);
-  __pyx_tuple__43 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(2, 4, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__43);
-  __Pyx_GIVEREF(__pyx_tuple__43);
-
-  /* "fastrometry/cython_code/WCS.pyx":8
- * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-  __pyx_tuple__44 = PyTuple_Pack(5, __pyx_n_s_startmessage, __pyx_n_s_endmessage, __pyx_n_s_levelneeded, __pyx_n_s_decorator, __pyx_n_s_decorator); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 8, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__44);
-  __Pyx_GIVEREF(__pyx_tuple__44);
-  __pyx_codeobj__45 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_printEvent, 8, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 8, __pyx_L1_error)
+  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__37);
+  __Pyx_GIVEREF(__pyx_tuple__37);
+  __pyx_tuple__38 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(2, 4, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__38);
+  __Pyx_GIVEREF(__pyx_tuple__38);
 
-  /* "fastrometry/cython_code/WCS.pyx":162
+  /* "fastrometry/cython_code/WCS.pyx":141
  *     wcs_diagnostics_view[13] = CVALRS
  * 
  * def inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmx, intrmy, invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
-  __pyx_tuple__46 = PyTuple_Pack(14, __pyx_n_s_CD11, __pyx_n_s_CD12, __pyx_n_s_CD21, __pyx_n_s_CD22, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_intrmx, __pyx_n_s_intrmy, __pyx_n_s_invtransf_intrmpoint_view, __pyx_n_s_determinant, __pyx_n_s_CD11inv, __pyx_n_s_CD12inv, __pyx_n_s_CD21inv, __pyx_n_s_CD22inv); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 162, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__46);
-  __Pyx_GIVEREF(__pyx_tuple__46);
-  __pyx_codeobj__47 = (PyObject*)__Pyx_PyCode_New(9, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__46, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_inverseTransformPointUsingCD, 162, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__47)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_tuple__39 = PyTuple_Pack(14, __pyx_n_s_CD11, __pyx_n_s_CD12, __pyx_n_s_CD21, __pyx_n_s_CD22, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_intrmx, __pyx_n_s_intrmy, __pyx_n_s_invtransf_intrmpoint_view, __pyx_n_s_determinant, __pyx_n_s_CD11inv, __pyx_n_s_CD12inv, __pyx_n_s_CD21inv, __pyx_n_s_CD22inv); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 141, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__39);
+  __Pyx_GIVEREF(__pyx_tuple__39);
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(9, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__39, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_inverseTransformPointUsingCD, 141, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 141, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":176
+  /* "fastrometry/cython_code/WCS.pyx":155
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  * 
  * def fitNrefineptsToGetCD(params, matchdata, matches):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer
  */
-  __pyx_tuple__48 = PyTuple_Pack(15, __pyx_n_s_params, __pyx_n_s_matchdata, __pyx_n_s_matches, __pyx_n_s_CD11, __pyx_n_s_CD12, __pyx_n_s_CD21, __pyx_n_s_CD22, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_residuals, __pyx_n_s_m, __pyx_n_s_intrmx, __pyx_n_s_intrmy, __pyx_n_s_psex, __pyx_n_s_psey); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 176, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__48);
-  __Pyx_GIVEREF(__pyx_tuple__48);
-  __pyx_codeobj__49 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__48, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_fitNrefineptsToGetCD, 176, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_tuple__41 = PyTuple_Pack(15, __pyx_n_s_params, __pyx_n_s_matchdata, __pyx_n_s_matches, __pyx_n_s_CD11, __pyx_n_s_CD12, __pyx_n_s_CD21, __pyx_n_s_CD22, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_residuals, __pyx_n_s_m, __pyx_n_s_intrmx, __pyx_n_s_intrmy, __pyx_n_s_psex, __pyx_n_s_psey); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 155, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__41);
+  __Pyx_GIVEREF(__pyx_tuple__41);
+  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(3, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_fitNrefineptsToGetCD, 155, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 155, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":430
+  /* "fastrometry/cython_code/WCS.pyx":409
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  * 
  * def fitTrianglesToGetSphi(params, pseAx, pseAy, pseBx, pseBy, pseCx, pseCy, intrmAx, intrmAy, intrmBx, intrmBy, intrmCx, intrmCy):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer
  */
-  __pyx_tuple__50 = PyTuple_Pack(23, __pyx_n_s_params, __pyx_n_s_pseAx, __pyx_n_s_pseAy, __pyx_n_s_pseBx, __pyx_n_s_pseBy, __pyx_n_s_pseCx, __pyx_n_s_pseCy, __pyx_n_s_intrmAx, __pyx_n_s_intrmAy, __pyx_n_s_intrmBx, __pyx_n_s_intrmBy, __pyx_n_s_intrmCx, __pyx_n_s_intrmCy, __pyx_n_s_S, __pyx_n_s_phi, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_residualAx, __pyx_n_s_residualAy, __pyx_n_s_residualBx, __pyx_n_s_residualBy, __pyx_n_s_residualCx, __pyx_n_s_residualCy); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 430, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__50);
-  __Pyx_GIVEREF(__pyx_tuple__50);
-  __pyx_codeobj__51 = (PyObject*)__Pyx_PyCode_New(13, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__50, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_fitTrianglesToGetSphi, 430, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 430, __pyx_L1_error)
+  __pyx_tuple__43 = PyTuple_Pack(23, __pyx_n_s_params, __pyx_n_s_pseAx, __pyx_n_s_pseAy, __pyx_n_s_pseBx, __pyx_n_s_pseBy, __pyx_n_s_pseCx, __pyx_n_s_pseCy, __pyx_n_s_intrmAx, __pyx_n_s_intrmAy, __pyx_n_s_intrmBx, __pyx_n_s_intrmBy, __pyx_n_s_intrmCx, __pyx_n_s_intrmCy, __pyx_n_s_S, __pyx_n_s_phi, __pyx_n_s_CRPIXx, __pyx_n_s_CRPIXy, __pyx_n_s_residualAx, __pyx_n_s_residualAy, __pyx_n_s_residualBx, __pyx_n_s_residualBy, __pyx_n_s_residualCx, __pyx_n_s_residualCy); if (unlikely(!__pyx_tuple__43)) __PYX_ERR(0, 409, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__43);
+  __Pyx_GIVEREF(__pyx_tuple__43);
+  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(13, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__43, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_fitTrianglesToGetSphi, 409, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 409, __pyx_L1_error)
 
-  /* "fastrometry/cython_code/WCS.pyx":830
+  /* "fastrometry/cython_code/WCS.pyx":809
  *     return resultcode
  * 
- * @printEvent("Performing WCS...", "done", 1)             # <<<<<<<<<<<<<<
- * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):
- *     """
- */
-  __pyx_tuple__52 = PyTuple_Pack(3, __pyx_kp_s_Performing_WCS, __pyx_n_s_done_3, __pyx_int_1); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 830, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__52);
-  __Pyx_GIVEREF(__pyx_tuple__52);
-
-  /* "fastrometry/cython_code/WCS.pyx":831
- * 
- * @printEvent("Performing WCS...", "done", 1)
  * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):             # <<<<<<<<<<<<<<
  *     """
  *     """
  */
-  __pyx_tuple__53 = PyTuple_Pack(66, __pyx_n_s_scale, __pyx_n_s_scalebnds, __pyx_n_s_rotation, __pyx_n_s_rotationbnds, __pyx_n_s_npts, __pyx_n_s_nrefinepts, __pyx_n_s_vertextol, __pyx_n_s_allintrmpoints, __pyx_n_s_catalogue_points, __pyx_n_s_mean_catcoords, __pyx_n_s_pse_metadata, __pyx_n_s_pse_metadata_inv, __pyx_n_s_matchdata, __pyx_n_s_num_matches, __pyx_n_s_srcindexmap_initial, __pyx_n_s_srcindexmap_refine, __pyx_n_s_img_xmax, __pyx_n_s_img_ymax, __pyx_n_s_minmatches, __pyx_n_s_kerneldiam, __pyx_n_s_num_psesources, __pyx_n_s_num_catsources, __pyx_n_s_headervals, __pyx_n_s_wcsdiagnostics, __pyx_n_s_debug_report, __pyx_n_s_filepath, __pyx_n_s_user_dir, __pyx_n_s_filename_body, __pyx_n_s_debug, __pyx_n_s_verbosity, __pyx_n_s_plt, __pyx_n_s_LogNorm, __pyx_n_s_fits, __pyx_n_s_initial_solution, __pyx_n_s_resultcode, __pyx_n_s_refined_solution, __pyx_n_s_wcs_diagnostics, __pyx_n_s_matches, __pyx_n_s_CTYPE1_2, __pyx_n_s_CTYPE2_2, __pyx_n_s_CRPIX1_3, __pyx_n_s_CRPIX2_3, __pyx_n_s_CRVAL1_2, __pyx_n_s_CRVAL2_2, __pyx_n_s_CD1_1_3, __pyx_n_s_CD1_2_3, __pyx_n_s_CD2_1_3, __pyx_n_s_CD2_2_3, __pyx_n_s_CDELT1_2, __pyx_n_s_CDELT2_2, __pyx_n_s_CROTA1_2, __pyx_n_s_CROTA2_2, __pyx_n_s_CCVALD1, __pyx_n_s_CCVALD2, __pyx_n_s_CCVALS1_h, __pyx_n_s_CCVALS1_m, __pyx_n_s_CCVALS1_s, __pyx_n_s_CCVALS2_h, __pyx_n_s_CCVALS2_m, __pyx_n_s_CCVALS2_s, __pyx_n_s_CVAL1RM, __pyx_n_s_CVAL1RS, __pyx_n_s_CVAL2RM, __pyx_n_s_CVAL2RS, __pyx_n_s_CVALRM_2, __pyx_n_s_CVALRS_2); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 831, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__53);
-  __Pyx_GIVEREF(__pyx_tuple__53);
-  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(30, 0, 66, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__53, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_WCS, 831, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(66, __pyx_n_s_scale, __pyx_n_s_scalebnds, __pyx_n_s_rotation, __pyx_n_s_rotationbnds, __pyx_n_s_npts, __pyx_n_s_nrefinepts, __pyx_n_s_vertextol, __pyx_n_s_allintrmpoints, __pyx_n_s_catalogue_points, __pyx_n_s_mean_catcoords, __pyx_n_s_pse_metadata, __pyx_n_s_pse_metadata_inv, __pyx_n_s_matchdata, __pyx_n_s_num_matches, __pyx_n_s_srcindexmap_initial, __pyx_n_s_srcindexmap_refine, __pyx_n_s_img_xmax, __pyx_n_s_img_ymax, __pyx_n_s_minmatches, __pyx_n_s_kerneldiam, __pyx_n_s_num_psesources, __pyx_n_s_num_catsources, __pyx_n_s_headervals, __pyx_n_s_wcsdiagnostics, __pyx_n_s_debug_report, __pyx_n_s_filepath, __pyx_n_s_user_dir, __pyx_n_s_filename_body, __pyx_n_s_debug, __pyx_n_s_verbosity, __pyx_n_s_plt, __pyx_n_s_LogNorm, __pyx_n_s_fits, __pyx_n_s_initial_solution, __pyx_n_s_resultcode, __pyx_n_s_refined_solution, __pyx_n_s_wcs_diagnostics, __pyx_n_s_matches, __pyx_n_s_CTYPE1_2, __pyx_n_s_CTYPE2_2, __pyx_n_s_CRPIX1_3, __pyx_n_s_CRPIX2_3, __pyx_n_s_CRVAL1_2, __pyx_n_s_CRVAL2_2, __pyx_n_s_CD1_1_3, __pyx_n_s_CD1_2_3, __pyx_n_s_CD2_1_3, __pyx_n_s_CD2_2_3, __pyx_n_s_CDELT1_2, __pyx_n_s_CDELT2_2, __pyx_n_s_CROTA1_2, __pyx_n_s_CROTA2_2, __pyx_n_s_CCVALD1, __pyx_n_s_CCVALD2, __pyx_n_s_CCVALS1_h, __pyx_n_s_CCVALS1_m, __pyx_n_s_CCVALS1_s, __pyx_n_s_CCVALS2_h, __pyx_n_s_CCVALS2_m, __pyx_n_s_CCVALS2_s, __pyx_n_s_CVAL1RM, __pyx_n_s_CVAL1RS, __pyx_n_s_CVAL2RM, __pyx_n_s_CVAL2RS, __pyx_n_s_CVALRM_2, __pyx_n_s_CVALRS_2); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__45);
+  __Pyx_GIVEREF(__pyx_tuple__45);
+  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(30, 0, 66, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__45, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_src_fastrometry_cython_code_WCS, __pyx_n_s_WCS, 809, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 809, __pyx_L1_error)
 
   /* "View.MemoryView":286
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(2, 286, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__55);
-  __Pyx_GIVEREF(__pyx_tuple__55);
+  __pyx_tuple__47 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct_or_indirect); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(2, 286, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__47);
+  __Pyx_GIVEREF(__pyx_tuple__47);
 
   /* "View.MemoryView":287
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(2, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__56);
-  __Pyx_GIVEREF(__pyx_tuple__56);
+  __pyx_tuple__48 = PyTuple_Pack(1, __pyx_kp_s_strided_and_direct); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__48);
+  __Pyx_GIVEREF(__pyx_tuple__48);
 
   /* "View.MemoryView":288
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__57 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(2, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__57);
-  __Pyx_GIVEREF(__pyx_tuple__57);
+  __pyx_tuple__49 = PyTuple_Pack(1, __pyx_kp_s_strided_and_indirect); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__49);
+  __Pyx_GIVEREF(__pyx_tuple__49);
 
   /* "View.MemoryView":291
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(2, 291, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__58);
-  __Pyx_GIVEREF(__pyx_tuple__58);
+  __pyx_tuple__50 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_direct); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(2, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__50);
+  __Pyx_GIVEREF(__pyx_tuple__50);
 
   /* "View.MemoryView":292
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_tuple__59 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(2, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__59);
-  __Pyx_GIVEREF(__pyx_tuple__59);
+  __pyx_tuple__51 = PyTuple_Pack(1, __pyx_kp_s_contiguous_and_indirect); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__51);
+  __Pyx_GIVEREF(__pyx_tuple__51);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_tuple__60 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_tuple__60);
-  __Pyx_GIVEREF(__pyx_tuple__60);
-  __pyx_codeobj__61 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __pyx_tuple__52 = PyTuple_Pack(5, __pyx_n_s_pyx_type, __pyx_n_s_pyx_checksum, __pyx_n_s_pyx_state, __pyx_n_s_pyx_PickleError, __pyx_n_s_pyx_result); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_tuple__52);
+  __Pyx_GIVEREF(__pyx_tuple__52);
+  __pyx_codeobj__53 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_stringsource, __pyx_n_s_pyx_unpickle_Enum, 1, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(2, 1, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -37545,15 +36681,14 @@
   __pyx_float_0_2 = PyFloat_FromDouble(0.2); if (unlikely(!__pyx_float_0_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_0_5 = PyFloat_FromDouble(0.5); if (unlikely(!__pyx_float_0_5)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_7_5 = PyFloat_FromDouble(7.5); if (unlikely(!__pyx_float_7_5)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_9_5 = PyFloat_FromDouble(9.5); if (unlikely(!__pyx_float_9_5)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_0_05 = PyFloat_FromDouble(0.05); if (unlikely(!__pyx_float_0_05)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_0_08 = PyFloat_FromDouble(0.08); if (unlikely(!__pyx_float_0_08)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_float_0_92 = PyFloat_FromDouble(0.92); if (unlikely(!__pyx_float_0_92)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __pyx_float_1eneg_6 = PyFloat_FromDouble(1e-6); if (unlikely(!__pyx_float_1eneg_6)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_6 = PyInt_FromLong(6); if (unlikely(!__pyx_int_6)) __PYX_ERR(0, 1, __pyx_L1_error)
   __pyx_int_8 = PyInt_FromLong(8); if (unlikely(!__pyx_int_8)) __PYX_ERR(0, 1, __pyx_L1_error)
@@ -37616,30 +36751,14 @@
 static int __Pyx_modinit_type_init_code(void) {
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
-  if (PyType_Ready(&__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
-  #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent.tp_print = 0;
-  #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent.tp_dictoffset && __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
-  }
-  __pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent = &__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct__printEvent;
-  if (PyType_Ready(&__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator) < 0) __PYX_ERR(0, 17, __pyx_L1_error)
-  #if PY_VERSION_HEX < 0x030800B1
-  __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator.tp_print = 0;
-  #endif
-  if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator.tp_dictoffset && __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator.tp_getattro == PyObject_GenericGetAttr)) {
-    __pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
-  }
-  __pyx_ptype_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator = &__pyx_type_11fastrometry_11cython_code_3WCS___pyx_scope_struct_1_decorator;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(2, 105, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
   if (__Pyx_SetVtable(__pyx_type___pyx_array.tp_dict, __pyx_vtabptr_array) < 0) __PYX_ERR(2, 105, __pyx_L1_error)
@@ -37862,16 +36981,15 @@
 
 static CYTHON_SMALL_CODE int __pyx_pymod_exec_WCS(PyObject *__pyx_pyinit_module)
 #endif
 #endif
 {
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
-  PyObject *__pyx_t_3 = NULL;
-  static PyThread_type_lock __pyx_t_4[8];
+  static PyThread_type_lock __pyx_t_3[8];
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannyDeclarations
   #if CYTHON_PEP489_MULTI_PHASE_INIT
   if (__pyx_m) {
     if (__pyx_m == __pyx_pyinit_module) return 0;
@@ -37976,17 +37094,17 @@
   /* "fastrometry/cython_code/WCS.pyx":1
  * import scipy.optimize as optimization             # <<<<<<<<<<<<<<
  * import numpy as np
  * import sys
  */
   __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_INCREF(__pyx_n_s__8);
-  __Pyx_GIVEREF(__pyx_n_s__8);
-  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__8);
+  __Pyx_INCREF(__pyx_n_s__4);
+  __Pyx_GIVEREF(__pyx_n_s__4);
+  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s__4);
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_scipy_optimize, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_optimization, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "fastrometry/cython_code/WCS.pyx":2
@@ -38008,191 +37126,154 @@
  * cimport numpy as np
  */
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_sys, 0, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_sys, __pyx_t_2) < 0) __PYX_ERR(0, 3, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":8
- * from libc.math cimport sin, cos, pi, asin, acos, atan, atan2, sqrt, abs
- * 
- * def printEvent(startmessage, endmessage, levelneeded):             # <<<<<<<<<<<<<<
- *     """
- *     This is a decorator factory, which returns a decorator.
- */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_1printEvent, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_printEvent, __pyx_t_2) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":162
+  /* "fastrometry/cython_code/WCS.pyx":141
  *     wcs_diagnostics_view[13] = CVALRS
  * 
  * def inverseTransformPointUsingCD(CD11, CD12, CD21, CD22, CRPIXx, CRPIXy, intrmx, intrmy, invtransf_intrmpoint_view):             # <<<<<<<<<<<<<<
  * 
  *     """
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_3inverseTransformPointUsingCD, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_1inverseTransformPointUsingCD, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 141, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_inverseTransformPointUsingCD, __pyx_t_2) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_inverseTransformPointUsingCD, __pyx_t_2) < 0) __PYX_ERR(0, 141, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":176
+  /* "fastrometry/cython_code/WCS.pyx":155
  *     invtransf_intrmpoint_view[1] = CRPIXy + CD21inv*intrmx + CD22inv*intrmy
  * 
  * def fitNrefineptsToGetCD(params, matchdata, matches):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which the CD matrix and the CRPIX point are the parameters. After many runs of this function, the optimizer
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_5fitNrefineptsToGetCD, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_3fitNrefineptsToGetCD, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fitNrefineptsToGetCD, __pyx_t_2) < 0) __PYX_ERR(0, 176, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fitNrefineptsToGetCD, __pyx_t_2) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":430
+  /* "fastrometry/cython_code/WCS.pyx":409
  *     invtransf_intrmtriangle_view[2,1] = CRPIXy + (-intrmCx*sin(phi) + intrmCy*cos(phi))/S
  * 
  * def fitTrianglesToGetSphi(params, pseAx, pseAy, pseBx, pseBy, pseCx, pseCy, intrmAx, intrmAy, intrmBx, intrmBy, intrmCx, intrmCy):             # <<<<<<<<<<<<<<
  *     """
  *     The optimizer function, for which S, phi, CRPIXx and CRPIXy are the parameters. After many runs of this function, the optimizer
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_7fitTrianglesToGetSphi, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_5fitTrianglesToGetSphi, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 409, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fitTrianglesToGetSphi, __pyx_t_2) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_fitTrianglesToGetSphi, __pyx_t_2) < 0) __PYX_ERR(0, 409, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "fastrometry/cython_code/WCS.pyx":830
+  /* "fastrometry/cython_code/WCS.pyx":809
  *     return resultcode
  * 
- * @printEvent("Performing WCS...", "done", 1)             # <<<<<<<<<<<<<<
- * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):
- *     """
- */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_printEvent); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_tuple__52, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 830, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-
-  /* "fastrometry/cython_code/WCS.pyx":831
- * 
- * @printEvent("Performing WCS...", "done", 1)
  * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):             # <<<<<<<<<<<<<<
  *     """
  *     """
  */
-  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_9WCS, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_11fastrometry_11cython_code_3WCS_7WCS, NULL, __pyx_n_s_fastrometry_cython_code_WCS); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 809, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-
-  /* "fastrometry/cython_code/WCS.pyx":830
- *     return resultcode
- * 
- * @printEvent("Performing WCS...", "done", 1)             # <<<<<<<<<<<<<<
- * def WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity):
- *     """
- */
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_WCS, __pyx_t_2) < 0) __PYX_ERR(0, 809, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_WCS, __pyx_t_3) < 0) __PYX_ERR(0, 831, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "fastrometry/cython_code/WCS.pyx":1
  * import scipy.optimize as optimization             # <<<<<<<<<<<<<<
  * import numpy as np
  * import sys
  */
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_3) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_2) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "View.MemoryView":209
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  *     def __dealloc__(array self):
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 209, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 209, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_array_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 209, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_array_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 209, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_array_type);
 
   /* "View.MemoryView":286
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__55, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 286, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__47, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 286, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(generic);
-  __Pyx_DECREF_SET(generic, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(generic, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":287
  * 
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default             # <<<<<<<<<<<<<<
  * cdef indirect = Enum("<strided and indirect>")
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__56, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 287, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__48, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 287, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(strided);
-  __Pyx_DECREF_SET(strided, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(strided, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":288
  * cdef generic = Enum("<strided and direct or indirect>")
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__57, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 288, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__49, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 288, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect);
-  __Pyx_DECREF_SET(indirect, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(indirect, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":291
  * 
  * 
  * cdef contiguous = Enum("<contiguous and direct>")             # <<<<<<<<<<<<<<
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__58, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 291, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__50, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 291, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(contiguous);
-  __Pyx_DECREF_SET(contiguous, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(contiguous, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":292
  * 
  * cdef contiguous = Enum("<contiguous and direct>")
  * cdef indirect_contiguous = Enum("<contiguous and indirect>")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 292, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_MemviewEnum_type), __pyx_tuple__51, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 292, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
   __Pyx_XGOTREF(indirect_contiguous);
-  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_3);
-  __Pyx_GIVEREF(__pyx_t_3);
-  __pyx_t_3 = 0;
+  __Pyx_DECREF_SET(indirect_contiguous, __pyx_t_2);
+  __Pyx_GIVEREF(__pyx_t_2);
+  __pyx_t_2 = 0;
 
   /* "View.MemoryView":316
  * 
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0             # <<<<<<<<<<<<<<
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [
  *     PyThread_allocate_lock(),
@@ -38202,59 +37283,59 @@
   /* "View.MemoryView":317
  * DEF THREAD_LOCKS_PREALLOCATED = 8
  * cdef int __pyx_memoryview_thread_locks_used = 0
  * cdef PyThread_type_lock[THREAD_LOCKS_PREALLOCATED] __pyx_memoryview_thread_locks = [             # <<<<<<<<<<<<<<
  *     PyThread_allocate_lock(),
  *     PyThread_allocate_lock(),
  */
-  __pyx_t_4[0] = PyThread_allocate_lock();
-  __pyx_t_4[1] = PyThread_allocate_lock();
-  __pyx_t_4[2] = PyThread_allocate_lock();
-  __pyx_t_4[3] = PyThread_allocate_lock();
-  __pyx_t_4[4] = PyThread_allocate_lock();
-  __pyx_t_4[5] = PyThread_allocate_lock();
-  __pyx_t_4[6] = PyThread_allocate_lock();
-  __pyx_t_4[7] = PyThread_allocate_lock();
-  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_4, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
+  __pyx_t_3[0] = PyThread_allocate_lock();
+  __pyx_t_3[1] = PyThread_allocate_lock();
+  __pyx_t_3[2] = PyThread_allocate_lock();
+  __pyx_t_3[3] = PyThread_allocate_lock();
+  __pyx_t_3[4] = PyThread_allocate_lock();
+  __pyx_t_3[5] = PyThread_allocate_lock();
+  __pyx_t_3[6] = PyThread_allocate_lock();
+  __pyx_t_3[7] = PyThread_allocate_lock();
+  memcpy(&(__pyx_memoryview_thread_locks[0]), __pyx_t_3, sizeof(__pyx_memoryview_thread_locks[0]) * (8));
 
   /* "View.MemoryView":549
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 549, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 549, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 549, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryview_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 549, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_memoryview_type);
 
   /* "View.MemoryView":995
  *         return self.from_object
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_memoryview_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 995, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_3) < 0) __PYX_ERR(2, 995, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = __pyx_capsule_create(((void *)(&__pyx_memoryview_getbuffer)), ((char *)"getbuffer(obj, view, flags)")); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 995, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem((PyObject *)__pyx_memoryviewslice_type->tp_dict, __pyx_n_s_pyx_getbuffer, __pyx_t_2) < 0) __PYX_ERR(2, 995, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   PyType_Modified(__pyx_memoryviewslice_type);
 
   /* "(tree fragment)":1
  * def __pyx_unpickle_Enum(__pyx_type, long __pyx_checksum, __pyx_state):             # <<<<<<<<<<<<<<
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  */
-  __pyx_t_3 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_3)) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_3) < 0) __PYX_ERR(2, 1, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_15View_dot_MemoryView_1__pyx_unpickle_Enum, NULL, __pyx_n_s_View_MemoryView); if (unlikely(!__pyx_t_2)) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_2);
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_pyx_unpickle_Enum, __pyx_t_2) < 0) __PYX_ERR(2, 1, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "(tree fragment)":11
  *         __pyx_unpickle_Enum__set_state(<Enum> __pyx_result, __pyx_state)
  *     return __pyx_result
  * cdef __pyx_unpickle_Enum__set_state(Enum __pyx_result, tuple __pyx_state):             # <<<<<<<<<<<<<<
  *     __pyx_result.name = __pyx_state[0]
  *     if len(__pyx_state) > 1 and hasattr(__pyx_result, '__dict__'):
@@ -38262,15 +37343,14 @@
 
   /*--- Wrapped vars code ---*/
 
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
-  __Pyx_XDECREF(__pyx_t_3);
   if (__pyx_m) {
     if (__pyx_d) {
       __Pyx_AddTraceback("init fastrometry.cython_code.WCS", __pyx_clineno, __pyx_lineno, __pyx_filename);
     }
     Py_CLEAR(__pyx_m);
   } else if (!PyErr_Occurred()) {
     PyErr_SetString(PyExc_ImportError, "init fastrometry.cython_code.WCS");
@@ -38328,971 +37408,14 @@
 #else
             "name '%.200s' is not defined", PyString_AS_STRING(name));
 #endif
     }
     return result;
 }
 
-/* RaiseArgTupleInvalid */
-static void __Pyx_RaiseArgtupleInvalid(
-    const char* func_name,
-    int exact,
-    Py_ssize_t num_min,
-    Py_ssize_t num_max,
-    Py_ssize_t num_found)
-{
-    Py_ssize_t num_expected;
-    const char *more_or_less;
-    if (num_found < num_min) {
-        num_expected = num_min;
-        more_or_less = "at least";
-    } else {
-        num_expected = num_max;
-        more_or_less = "at most";
-    }
-    if (exact) {
-        more_or_less = "exactly";
-    }
-    PyErr_Format(PyExc_TypeError,
-                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                 func_name, more_or_less, num_expected,
-                 (num_expected == 1) ? "" : "s", num_found);
-}
-
-/* RaiseDoubleKeywords */
-static void __Pyx_RaiseDoubleKeywordsError(
-    const char* func_name,
-    PyObject* kw_name)
-{
-    PyErr_Format(PyExc_TypeError,
-        #if PY_MAJOR_VERSION >= 3
-        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
-        #else
-        "%s() got multiple values for keyword argument '%s'", func_name,
-        PyString_AsString(kw_name));
-        #endif
-}
-
-/* ParseKeywords */
-static int __Pyx_ParseOptionalKeywords(
-    PyObject *kwds,
-    PyObject **argnames[],
-    PyObject *kwds2,
-    PyObject *values[],
-    Py_ssize_t num_pos_args,
-    const char* function_name)
-{
-    PyObject *key = 0, *value = 0;
-    Py_ssize_t pos = 0;
-    PyObject*** name;
-    PyObject*** first_kw_arg = argnames + num_pos_args;
-    while (PyDict_Next(kwds, &pos, &key, &value)) {
-        name = first_kw_arg;
-        while (*name && (**name != key)) name++;
-        if (*name) {
-            values[name-argnames] = value;
-            continue;
-        }
-        name = first_kw_arg;
-        #if PY_MAJOR_VERSION < 3
-        if (likely(PyString_Check(key))) {
-            while (*name) {
-                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
-                        && _PyString_Eq(**name, key)) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    if ((**argname == key) || (
-                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
-                             && _PyString_Eq(**argname, key))) {
-                        goto arg_passed_twice;
-                    }
-                    argname++;
-                }
-            }
-        } else
-        #endif
-        if (likely(PyUnicode_Check(key))) {
-            while (*name) {
-                int cmp = (**name == key) ? 0 :
-                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                #endif
-                    PyUnicode_Compare(**name, key);
-                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                if (cmp == 0) {
-                    values[name-argnames] = value;
-                    break;
-                }
-                name++;
-            }
-            if (*name) continue;
-            else {
-                PyObject*** argname = argnames;
-                while (argname != first_kw_arg) {
-                    int cmp = (**argname == key) ? 0 :
-                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
-                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
-                    #endif
-                        PyUnicode_Compare(**argname, key);
-                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
-                    if (cmp == 0) goto arg_passed_twice;
-                    argname++;
-                }
-            }
-        } else
-            goto invalid_keyword_type;
-        if (kwds2) {
-            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
-        } else {
-            goto invalid_keyword;
-        }
-    }
-    return 0;
-arg_passed_twice:
-    __Pyx_RaiseDoubleKeywordsError(function_name, key);
-    goto bad;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    goto bad;
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
-    #endif
-bad:
-    return -1;
-}
-
-/* KeywordStringCheck */
-static int __Pyx_CheckKeywordStrings(
-    PyObject *kwdict,
-    const char* function_name,
-    int kw_allowed)
-{
-    PyObject* key = 0;
-    Py_ssize_t pos = 0;
-#if CYTHON_COMPILING_IN_PYPY
-    if (!kw_allowed && PyDict_Next(kwdict, &pos, &key, 0))
-        goto invalid_keyword;
-    return 1;
-#else
-    while (PyDict_Next(kwdict, &pos, &key, 0)) {
-        #if PY_MAJOR_VERSION < 3
-        if (unlikely(!PyString_Check(key)))
-        #endif
-            if (unlikely(!PyUnicode_Check(key)))
-                goto invalid_keyword_type;
-    }
-    if ((!kw_allowed) && unlikely(key))
-        goto invalid_keyword;
-    return 1;
-invalid_keyword_type:
-    PyErr_Format(PyExc_TypeError,
-        "%.200s() keywords must be strings", function_name);
-    return 0;
-#endif
-invalid_keyword:
-    PyErr_Format(PyExc_TypeError,
-    #if PY_MAJOR_VERSION < 3
-        "%.200s() got an unexpected keyword argument '%.200s'",
-        function_name, PyString_AsString(key));
-    #else
-        "%s() got an unexpected keyword argument '%U'",
-        function_name, key);
-    #endif
-    return 0;
-}
-
-/* GetItemInt */
-static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
-    PyObject *r;
-    if (!j) return NULL;
-    r = PyObject_GetItem(o, j);
-    Py_DECREF(j);
-    return r;
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyList_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
-        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
-    }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
-                                                              CYTHON_NCP_UNUSED int wraparound,
-                                                              CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    Py_ssize_t wrapped_i = i;
-    if (wraparound & unlikely(i < 0)) {
-        wrapped_i += PyTuple_GET_SIZE(o);
-    }
-    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
-        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
-        Py_INCREF(r);
-        return r;
-    }
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-#else
-    return PySequence_GetItem(o, i);
-#endif
-}
-static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
-                                                     CYTHON_NCP_UNUSED int wraparound,
-                                                     CYTHON_NCP_UNUSED int boundscheck) {
-#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
-    if (is_list || PyList_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
-        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
-            PyObject *r = PyList_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    }
-    else if (PyTuple_CheckExact(o)) {
-        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
-        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
-            PyObject *r = PyTuple_GET_ITEM(o, n);
-            Py_INCREF(r);
-            return r;
-        }
-    } else {
-        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
-        if (likely(m && m->sq_item)) {
-            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
-                Py_ssize_t l = m->sq_length(o);
-                if (likely(l >= 0)) {
-                    i += l;
-                } else {
-                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
-                        return NULL;
-                    PyErr_Clear();
-                }
-            }
-            return m->sq_item(o, i);
-        }
-    }
-#else
-    if (is_list || PySequence_Check(o)) {
-        return PySequence_GetItem(o, i);
-    }
-#endif
-    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
-}
-
-/* None */
-static CYTHON_INLINE void __Pyx_RaiseClosureNameError(const char *varname) {
-    PyErr_Format(PyExc_NameError, "free variable '%s' referenced before assignment in enclosing scope", varname);
-}
-
-/* PyObjectCall */
-#if CYTHON_COMPILING_IN_CPYTHON
-static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    PyObject *result;
-    ternaryfunc call = Py_TYPE(func)->tp_call;
-    if (unlikely(!call))
-        return PyObject_Call(func, arg, kw);
-    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
-        return NULL;
-    result = (*call)(func, arg, kw);
-    Py_LeaveRecursiveCall();
-    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
-        PyErr_SetString(
-            PyExc_SystemError,
-            "NULL result without error in PyObject_Call");
-    }
-    return result;
-}
-#endif
-
-/* FetchCommonType */
-static PyTypeObject* __Pyx_FetchCommonType(PyTypeObject* type) {
-    PyObject* fake_module;
-    PyTypeObject* cached_type = NULL;
-    fake_module = PyImport_AddModule((char*) "_cython_" CYTHON_ABI);
-    if (!fake_module) return NULL;
-    Py_INCREF(fake_module);
-    cached_type = (PyTypeObject*) PyObject_GetAttrString(fake_module, type->tp_name);
-    if (cached_type) {
-        if (!PyType_Check((PyObject*)cached_type)) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s is not a type object",
-                type->tp_name);
-            goto bad;
-        }
-        if (cached_type->tp_basicsize != type->tp_basicsize) {
-            PyErr_Format(PyExc_TypeError,
-                "Shared Cython type %.200s has the wrong size, try recompiling",
-                type->tp_name);
-            goto bad;
-        }
-    } else {
-        if (!PyErr_ExceptionMatches(PyExc_AttributeError)) goto bad;
-        PyErr_Clear();
-        if (PyType_Ready(type) < 0) goto bad;
-        if (PyObject_SetAttrString(fake_module, type->tp_name, (PyObject*) type) < 0)
-            goto bad;
-        Py_INCREF(type);
-        cached_type = type;
-    }
-done:
-    Py_DECREF(fake_module);
-    return cached_type;
-bad:
-    Py_XDECREF(cached_type);
-    cached_type = NULL;
-    goto done;
-}
-
-/* CythonFunctionShared */
-#include <structmember.h>
-static PyObject *
-__Pyx_CyFunction_get_doc(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *closure)
-{
-    if (unlikely(op->func_doc == NULL)) {
-        if (op->func.m_ml->ml_doc) {
-#if PY_MAJOR_VERSION >= 3
-            op->func_doc = PyUnicode_FromString(op->func.m_ml->ml_doc);
-#else
-            op->func_doc = PyString_FromString(op->func.m_ml->ml_doc);
-#endif
-            if (unlikely(op->func_doc == NULL))
-                return NULL;
-        } else {
-            Py_INCREF(Py_None);
-            return Py_None;
-        }
-    }
-    Py_INCREF(op->func_doc);
-    return op->func_doc;
-}
-static int
-__Pyx_CyFunction_set_doc(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp = op->func_doc;
-    if (value == NULL) {
-        value = Py_None;
-    }
-    Py_INCREF(value);
-    op->func_doc = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_name(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_name == NULL)) {
-#if PY_MAJOR_VERSION >= 3
-        op->func_name = PyUnicode_InternFromString(op->func.m_ml->ml_name);
-#else
-        op->func_name = PyString_InternFromString(op->func.m_ml->ml_name);
-#endif
-        if (unlikely(op->func_name == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_name);
-    return op->func_name;
-}
-static int
-__Pyx_CyFunction_set_name(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
-#endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__name__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_name;
-    Py_INCREF(value);
-    op->func_name = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_qualname(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_qualname);
-    return op->func_qualname;
-}
-static int
-__Pyx_CyFunction_set_qualname(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-#if PY_MAJOR_VERSION >= 3
-    if (unlikely(value == NULL || !PyUnicode_Check(value)))
-#else
-    if (unlikely(value == NULL || !PyString_Check(value)))
-#endif
-    {
-        PyErr_SetString(PyExc_TypeError,
-                        "__qualname__ must be set to a string object");
-        return -1;
-    }
-    tmp = op->func_qualname;
-    Py_INCREF(value);
-    op->func_qualname = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_self(__pyx_CyFunctionObject *m, CYTHON_UNUSED void *closure)
-{
-    PyObject *self;
-    self = m->func_closure;
-    if (self == NULL)
-        self = Py_None;
-    Py_INCREF(self);
-    return self;
-}
-static PyObject *
-__Pyx_CyFunction_get_dict(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    if (unlikely(op->func_dict == NULL)) {
-        op->func_dict = PyDict_New();
-        if (unlikely(op->func_dict == NULL))
-            return NULL;
-    }
-    Py_INCREF(op->func_dict);
-    return op->func_dict;
-}
-static int
-__Pyx_CyFunction_set_dict(__pyx_CyFunctionObject *op, PyObject *value, CYTHON_UNUSED void *context)
-{
-    PyObject *tmp;
-    if (unlikely(value == NULL)) {
-        PyErr_SetString(PyExc_TypeError,
-               "function's dictionary may not be deleted");
-        return -1;
-    }
-    if (unlikely(!PyDict_Check(value))) {
-        PyErr_SetString(PyExc_TypeError,
-               "setting function's dictionary to a non-dict");
-        return -1;
-    }
-    tmp = op->func_dict;
-    Py_INCREF(value);
-    op->func_dict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_globals(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(op->func_globals);
-    return op->func_globals;
-}
-static PyObject *
-__Pyx_CyFunction_get_closure(CYTHON_UNUSED __pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    Py_INCREF(Py_None);
-    return Py_None;
-}
-static PyObject *
-__Pyx_CyFunction_get_code(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context)
-{
-    PyObject* result = (op->func_code) ? op->func_code : Py_None;
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_init_defaults(__pyx_CyFunctionObject *op) {
-    int result = 0;
-    PyObject *res = op->defaults_getter((PyObject *) op);
-    if (unlikely(!res))
-        return -1;
-    #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    op->defaults_tuple = PyTuple_GET_ITEM(res, 0);
-    Py_INCREF(op->defaults_tuple);
-    op->defaults_kwdict = PyTuple_GET_ITEM(res, 1);
-    Py_INCREF(op->defaults_kwdict);
-    #else
-    op->defaults_tuple = PySequence_ITEM(res, 0);
-    if (unlikely(!op->defaults_tuple)) result = -1;
-    else {
-        op->defaults_kwdict = PySequence_ITEM(res, 1);
-        if (unlikely(!op->defaults_kwdict)) result = -1;
-    }
-    #endif
-    Py_DECREF(res);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_defaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyTuple_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__defaults__ must be set to a tuple object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_tuple;
-    op->defaults_tuple = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_defaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_tuple;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_tuple;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_kwdefaults(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value) {
-        value = Py_None;
-    } else if (value != Py_None && !PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__kwdefaults__ must be set to a dict object");
-        return -1;
-    }
-    Py_INCREF(value);
-    tmp = op->defaults_kwdict;
-    op->defaults_kwdict = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_kwdefaults(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->defaults_kwdict;
-    if (unlikely(!result)) {
-        if (op->defaults_getter) {
-            if (__Pyx_CyFunction_init_defaults(op) < 0) return NULL;
-            result = op->defaults_kwdict;
-        } else {
-            result = Py_None;
-        }
-    }
-    Py_INCREF(result);
-    return result;
-}
-static int
-__Pyx_CyFunction_set_annotations(__pyx_CyFunctionObject *op, PyObject* value, CYTHON_UNUSED void *context) {
-    PyObject* tmp;
-    if (!value || value == Py_None) {
-        value = NULL;
-    } else if (!PyDict_Check(value)) {
-        PyErr_SetString(PyExc_TypeError,
-                        "__annotations__ must be set to a dict object");
-        return -1;
-    }
-    Py_XINCREF(value);
-    tmp = op->func_annotations;
-    op->func_annotations = value;
-    Py_XDECREF(tmp);
-    return 0;
-}
-static PyObject *
-__Pyx_CyFunction_get_annotations(__pyx_CyFunctionObject *op, CYTHON_UNUSED void *context) {
-    PyObject* result = op->func_annotations;
-    if (unlikely(!result)) {
-        result = PyDict_New();
-        if (unlikely(!result)) return NULL;
-        op->func_annotations = result;
-    }
-    Py_INCREF(result);
-    return result;
-}
-static PyGetSetDef __pyx_CyFunction_getsets[] = {
-    {(char *) "func_doc", (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "__doc__",  (getter)__Pyx_CyFunction_get_doc, (setter)__Pyx_CyFunction_set_doc, 0, 0},
-    {(char *) "func_name", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__name__", (getter)__Pyx_CyFunction_get_name, (setter)__Pyx_CyFunction_set_name, 0, 0},
-    {(char *) "__qualname__", (getter)__Pyx_CyFunction_get_qualname, (setter)__Pyx_CyFunction_set_qualname, 0, 0},
-    {(char *) "__self__", (getter)__Pyx_CyFunction_get_self, 0, 0, 0},
-    {(char *) "func_dict", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "__dict__", (getter)__Pyx_CyFunction_get_dict, (setter)__Pyx_CyFunction_set_dict, 0, 0},
-    {(char *) "func_globals", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "__globals__", (getter)__Pyx_CyFunction_get_globals, 0, 0, 0},
-    {(char *) "func_closure", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "__closure__", (getter)__Pyx_CyFunction_get_closure, 0, 0, 0},
-    {(char *) "func_code", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "__code__", (getter)__Pyx_CyFunction_get_code, 0, 0, 0},
-    {(char *) "func_defaults", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__defaults__", (getter)__Pyx_CyFunction_get_defaults, (setter)__Pyx_CyFunction_set_defaults, 0, 0},
-    {(char *) "__kwdefaults__", (getter)__Pyx_CyFunction_get_kwdefaults, (setter)__Pyx_CyFunction_set_kwdefaults, 0, 0},
-    {(char *) "__annotations__", (getter)__Pyx_CyFunction_get_annotations, (setter)__Pyx_CyFunction_set_annotations, 0, 0},
-    {0, 0, 0, 0, 0}
-};
-static PyMemberDef __pyx_CyFunction_members[] = {
-    {(char *) "__module__", T_OBJECT, offsetof(PyCFunctionObject, m_module), PY_WRITE_RESTRICTED, 0},
-    {0, 0, 0,  0, 0}
-};
-static PyObject *
-__Pyx_CyFunction_reduce(__pyx_CyFunctionObject *m, CYTHON_UNUSED PyObject *args)
-{
-#if PY_MAJOR_VERSION >= 3
-    Py_INCREF(m->func_qualname);
-    return m->func_qualname;
-#else
-    return PyString_FromString(m->func.m_ml->ml_name);
-#endif
-}
-static PyMethodDef __pyx_CyFunction_methods[] = {
-    {"__reduce__", (PyCFunction)__Pyx_CyFunction_reduce, METH_VARARGS, 0},
-    {0, 0, 0, 0}
-};
-#if PY_VERSION_HEX < 0x030500A0
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func_weakreflist)
-#else
-#define __Pyx_CyFunction_weakreflist(cyfunc) ((cyfunc)->func.m_weakreflist)
-#endif
-static PyObject *__Pyx_CyFunction_Init(__pyx_CyFunctionObject *op, PyMethodDef *ml, int flags, PyObject* qualname,
-                                       PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    if (unlikely(op == NULL))
-        return NULL;
-    op->flags = flags;
-    __Pyx_CyFunction_weakreflist(op) = NULL;
-    op->func.m_ml = ml;
-    op->func.m_self = (PyObject *) op;
-    Py_XINCREF(closure);
-    op->func_closure = closure;
-    Py_XINCREF(module);
-    op->func.m_module = module;
-    op->func_dict = NULL;
-    op->func_name = NULL;
-    Py_INCREF(qualname);
-    op->func_qualname = qualname;
-    op->func_doc = NULL;
-    op->func_classobj = NULL;
-    op->func_globals = globals;
-    Py_INCREF(op->func_globals);
-    Py_XINCREF(code);
-    op->func_code = code;
-    op->defaults_pyobjects = 0;
-    op->defaults_size = 0;
-    op->defaults = NULL;
-    op->defaults_tuple = NULL;
-    op->defaults_kwdict = NULL;
-    op->defaults_getter = NULL;
-    op->func_annotations = NULL;
-    return (PyObject *) op;
-}
-static int
-__Pyx_CyFunction_clear(__pyx_CyFunctionObject *m)
-{
-    Py_CLEAR(m->func_closure);
-    Py_CLEAR(m->func.m_module);
-    Py_CLEAR(m->func_dict);
-    Py_CLEAR(m->func_name);
-    Py_CLEAR(m->func_qualname);
-    Py_CLEAR(m->func_doc);
-    Py_CLEAR(m->func_globals);
-    Py_CLEAR(m->func_code);
-    Py_CLEAR(m->func_classobj);
-    Py_CLEAR(m->defaults_tuple);
-    Py_CLEAR(m->defaults_kwdict);
-    Py_CLEAR(m->func_annotations);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_XDECREF(pydefaults[i]);
-        PyObject_Free(m->defaults);
-        m->defaults = NULL;
-    }
-    return 0;
-}
-static void __Pyx__CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    if (__Pyx_CyFunction_weakreflist(m) != NULL)
-        PyObject_ClearWeakRefs((PyObject *) m);
-    __Pyx_CyFunction_clear(m);
-    PyObject_GC_Del(m);
-}
-static void __Pyx_CyFunction_dealloc(__pyx_CyFunctionObject *m)
-{
-    PyObject_GC_UnTrack(m);
-    __Pyx__CyFunction_dealloc(m);
-}
-static int __Pyx_CyFunction_traverse(__pyx_CyFunctionObject *m, visitproc visit, void *arg)
-{
-    Py_VISIT(m->func_closure);
-    Py_VISIT(m->func.m_module);
-    Py_VISIT(m->func_dict);
-    Py_VISIT(m->func_name);
-    Py_VISIT(m->func_qualname);
-    Py_VISIT(m->func_doc);
-    Py_VISIT(m->func_globals);
-    Py_VISIT(m->func_code);
-    Py_VISIT(m->func_classobj);
-    Py_VISIT(m->defaults_tuple);
-    Py_VISIT(m->defaults_kwdict);
-    if (m->defaults) {
-        PyObject **pydefaults = __Pyx_CyFunction_Defaults(PyObject *, m);
-        int i;
-        for (i = 0; i < m->defaults_pyobjects; i++)
-            Py_VISIT(pydefaults[i]);
-    }
-    return 0;
-}
-static PyObject *__Pyx_CyFunction_descr_get(PyObject *func, PyObject *obj, PyObject *type)
-{
-#if PY_MAJOR_VERSION < 3
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    if (m->flags & __Pyx_CYFUNCTION_STATICMETHOD) {
-        Py_INCREF(func);
-        return func;
-    }
-    if (m->flags & __Pyx_CYFUNCTION_CLASSMETHOD) {
-        if (type == NULL)
-            type = (PyObject *)(Py_TYPE(obj));
-        return __Pyx_PyMethod_New(func, type, (PyObject *)(Py_TYPE(type)));
-    }
-    if (obj == Py_None)
-        obj = NULL;
-#endif
-    return __Pyx_PyMethod_New(func, obj, type);
-}
-static PyObject*
-__Pyx_CyFunction_repr(__pyx_CyFunctionObject *op)
-{
-#if PY_MAJOR_VERSION >= 3
-    return PyUnicode_FromFormat("<cyfunction %U at %p>",
-                                op->func_qualname, (void *)op);
-#else
-    return PyString_FromFormat("<cyfunction %s at %p>",
-                               PyString_AsString(op->func_qualname), (void *)op);
-#endif
-}
-static PyObject * __Pyx_CyFunction_CallMethod(PyObject *func, PyObject *self, PyObject *arg, PyObject *kw) {
-    PyCFunctionObject* f = (PyCFunctionObject*)func;
-    PyCFunction meth = f->m_ml->ml_meth;
-    Py_ssize_t size;
-    switch (f->m_ml->ml_flags & (METH_VARARGS | METH_KEYWORDS | METH_NOARGS | METH_O)) {
-    case METH_VARARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0))
-            return (*meth)(self, arg);
-        break;
-    case METH_VARARGS | METH_KEYWORDS:
-        return (*(PyCFunctionWithKeywords)(void*)meth)(self, arg, kw);
-    case METH_NOARGS:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 0))
-                return (*meth)(self, NULL);
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes no arguments (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    case METH_O:
-        if (likely(kw == NULL || PyDict_Size(kw) == 0)) {
-            size = PyTuple_GET_SIZE(arg);
-            if (likely(size == 1)) {
-                PyObject *result, *arg0;
-                #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-                arg0 = PyTuple_GET_ITEM(arg, 0);
-                #else
-                arg0 = PySequence_ITEM(arg, 0); if (unlikely(!arg0)) return NULL;
-                #endif
-                result = (*meth)(self, arg0);
-                #if !(CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS)
-                Py_DECREF(arg0);
-                #endif
-                return result;
-            }
-            PyErr_Format(PyExc_TypeError,
-                "%.200s() takes exactly one argument (%" CYTHON_FORMAT_SSIZE_T "d given)",
-                f->m_ml->ml_name, size);
-            return NULL;
-        }
-        break;
-    default:
-        PyErr_SetString(PyExc_SystemError, "Bad call flags in "
-                        "__Pyx_CyFunction_Call. METH_OLDARGS is no "
-                        "longer supported!");
-        return NULL;
-    }
-    PyErr_Format(PyExc_TypeError, "%.200s() takes no keyword arguments",
-                 f->m_ml->ml_name);
-    return NULL;
-}
-static CYTHON_INLINE PyObject *__Pyx_CyFunction_Call(PyObject *func, PyObject *arg, PyObject *kw) {
-    return __Pyx_CyFunction_CallMethod(func, ((PyCFunctionObject*)func)->m_self, arg, kw);
-}
-static PyObject *__Pyx_CyFunction_CallAsMethod(PyObject *func, PyObject *args, PyObject *kw) {
-    PyObject *result;
-    __pyx_CyFunctionObject *cyfunc = (__pyx_CyFunctionObject *) func;
-    if ((cyfunc->flags & __Pyx_CYFUNCTION_CCLASS) && !(cyfunc->flags & __Pyx_CYFUNCTION_STATICMETHOD)) {
-        Py_ssize_t argc;
-        PyObject *new_args;
-        PyObject *self;
-        argc = PyTuple_GET_SIZE(args);
-        new_args = PyTuple_GetSlice(args, 1, argc);
-        if (unlikely(!new_args))
-            return NULL;
-        self = PyTuple_GetItem(args, 0);
-        if (unlikely(!self)) {
-            Py_DECREF(new_args);
-            PyErr_Format(PyExc_TypeError,
-                         "unbound method %.200S() needs an argument",
-                         cyfunc->func_qualname);
-            return NULL;
-        }
-        result = __Pyx_CyFunction_CallMethod(func, self, new_args, kw);
-        Py_DECREF(new_args);
-    } else {
-        result = __Pyx_CyFunction_Call(func, args, kw);
-    }
-    return result;
-}
-static PyTypeObject __pyx_CyFunctionType_type = {
-    PyVarObject_HEAD_INIT(0, 0)
-    "cython_function_or_method",
-    sizeof(__pyx_CyFunctionObject),
-    0,
-    (destructor) __Pyx_CyFunction_dealloc,
-    0,
-    0,
-    0,
-#if PY_MAJOR_VERSION < 3
-    0,
-#else
-    0,
-#endif
-    (reprfunc) __Pyx_CyFunction_repr,
-    0,
-    0,
-    0,
-    0,
-    __Pyx_CyFunction_CallAsMethod,
-    0,
-    0,
-    0,
-    0,
-    Py_TPFLAGS_DEFAULT | Py_TPFLAGS_HAVE_GC,
-    0,
-    (traverseproc) __Pyx_CyFunction_traverse,
-    (inquiry) __Pyx_CyFunction_clear,
-    0,
-#if PY_VERSION_HEX < 0x030500A0
-    offsetof(__pyx_CyFunctionObject, func_weakreflist),
-#else
-    offsetof(PyCFunctionObject, m_weakreflist),
-#endif
-    0,
-    0,
-    __pyx_CyFunction_methods,
-    __pyx_CyFunction_members,
-    __pyx_CyFunction_getsets,
-    0,
-    0,
-    __Pyx_CyFunction_descr_get,
-    0,
-    offsetof(__pyx_CyFunctionObject, func_dict),
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-    0,
-#if PY_VERSION_HEX >= 0x030400a1
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b1 && (!CYTHON_COMPILING_IN_PYPY || PYPY_VERSION_NUM >= 0x07030800)
-    0,
-#endif
-#if PY_VERSION_HEX >= 0x030800b4 && PY_VERSION_HEX < 0x03090000
-    0,
-#endif
-#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000
-    0,
-#endif
-};
-static int __pyx_CyFunction_init(void) {
-    __pyx_CyFunctionType = __Pyx_FetchCommonType(&__pyx_CyFunctionType_type);
-    if (unlikely(__pyx_CyFunctionType == NULL)) {
-        return -1;
-    }
-    return 0;
-}
-static CYTHON_INLINE void *__Pyx_CyFunction_InitDefaults(PyObject *func, size_t size, int pyobjects) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults = PyObject_Malloc(size);
-    if (unlikely(!m->defaults))
-        return PyErr_NoMemory();
-    memset(m->defaults, 0, size);
-    m->defaults_pyobjects = pyobjects;
-    m->defaults_size = size;
-    return m->defaults;
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsTuple(PyObject *func, PyObject *tuple) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_tuple = tuple;
-    Py_INCREF(tuple);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetDefaultsKwDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->defaults_kwdict = dict;
-    Py_INCREF(dict);
-}
-static CYTHON_INLINE void __Pyx_CyFunction_SetAnnotationsDict(PyObject *func, PyObject *dict) {
-    __pyx_CyFunctionObject *m = (__pyx_CyFunctionObject *) func;
-    m->func_annotations = dict;
-    Py_INCREF(dict);
-}
-
-/* CythonFunction */
-static PyObject *__Pyx_CyFunction_New(PyMethodDef *ml, int flags, PyObject* qualname,
-                                      PyObject *closure, PyObject *module, PyObject* globals, PyObject* code) {
-    PyObject *op = __Pyx_CyFunction_Init(
-        PyObject_GC_New(__pyx_CyFunctionObject, __pyx_CyFunctionType),
-        ml, flags, qualname, closure, module, globals, code
-    );
-    if (likely(op)) {
-        PyObject_GC_Track(op);
-    }
-    return op;
-}
-
 /* BufferIndexError */
 static void __Pyx_RaiseBufferIndexError(int axis) {
   PyErr_Format(PyExc_IndexError,
      "Out of bounds on buffer access (axis %d)", axis);
 }
 
 /* DivInt[long] */
@@ -39502,14 +37625,34 @@
 done:
     Py_LeaveRecursiveCall();
     return result;
 }
 #endif
 #endif
 
+/* PyObjectCall */
+#if CYTHON_COMPILING_IN_CPYTHON
+static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
+    PyObject *result;
+    ternaryfunc call = Py_TYPE(func)->tp_call;
+    if (unlikely(!call))
+        return PyObject_Call(func, arg, kw);
+    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
+        return NULL;
+    result = (*call)(func, arg, kw);
+    Py_LeaveRecursiveCall();
+    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
+        PyErr_SetString(
+            PyExc_SystemError,
+            "NULL result without error in PyObject_Call");
+    }
+    return result;
+}
+#endif
+
 /* PyObjectCall2Args */
 static CYTHON_UNUSED PyObject* __Pyx_PyObject_Call2Args(PyObject* function, PyObject* arg1, PyObject* arg2) {
     PyObject *args, *result = NULL;
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(function)) {
         PyObject *args[2] = {arg1, arg2};
         return __Pyx_PyFunction_FastCall(function, args, 2);
@@ -39733,14 +37876,156 @@
             PyGILState_Release(_gilstate);
         }
     } else {
         memslice->memview = NULL;
     }
 }
 
+/* RaiseArgTupleInvalid */
+static void __Pyx_RaiseArgtupleInvalid(
+    const char* func_name,
+    int exact,
+    Py_ssize_t num_min,
+    Py_ssize_t num_max,
+    Py_ssize_t num_found)
+{
+    Py_ssize_t num_expected;
+    const char *more_or_less;
+    if (num_found < num_min) {
+        num_expected = num_min;
+        more_or_less = "at least";
+    } else {
+        num_expected = num_max;
+        more_or_less = "at most";
+    }
+    if (exact) {
+        more_or_less = "exactly";
+    }
+    PyErr_Format(PyExc_TypeError,
+                 "%.200s() takes %.8s %" CYTHON_FORMAT_SSIZE_T "d positional argument%.1s (%" CYTHON_FORMAT_SSIZE_T "d given)",
+                 func_name, more_or_less, num_expected,
+                 (num_expected == 1) ? "" : "s", num_found);
+}
+
+/* RaiseDoubleKeywords */
+static void __Pyx_RaiseDoubleKeywordsError(
+    const char* func_name,
+    PyObject* kw_name)
+{
+    PyErr_Format(PyExc_TypeError,
+        #if PY_MAJOR_VERSION >= 3
+        "%s() got multiple values for keyword argument '%U'", func_name, kw_name);
+        #else
+        "%s() got multiple values for keyword argument '%s'", func_name,
+        PyString_AsString(kw_name));
+        #endif
+}
+
+/* ParseKeywords */
+static int __Pyx_ParseOptionalKeywords(
+    PyObject *kwds,
+    PyObject **argnames[],
+    PyObject *kwds2,
+    PyObject *values[],
+    Py_ssize_t num_pos_args,
+    const char* function_name)
+{
+    PyObject *key = 0, *value = 0;
+    Py_ssize_t pos = 0;
+    PyObject*** name;
+    PyObject*** first_kw_arg = argnames + num_pos_args;
+    while (PyDict_Next(kwds, &pos, &key, &value)) {
+        name = first_kw_arg;
+        while (*name && (**name != key)) name++;
+        if (*name) {
+            values[name-argnames] = value;
+            continue;
+        }
+        name = first_kw_arg;
+        #if PY_MAJOR_VERSION < 3
+        if (likely(PyString_Check(key))) {
+            while (*name) {
+                if ((CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**name) == PyString_GET_SIZE(key))
+                        && _PyString_Eq(**name, key)) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    if ((**argname == key) || (
+                            (CYTHON_COMPILING_IN_PYPY || PyString_GET_SIZE(**argname) == PyString_GET_SIZE(key))
+                             && _PyString_Eq(**argname, key))) {
+                        goto arg_passed_twice;
+                    }
+                    argname++;
+                }
+            }
+        } else
+        #endif
+        if (likely(PyUnicode_Check(key))) {
+            while (*name) {
+                int cmp = (**name == key) ? 0 :
+                #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                    (__Pyx_PyUnicode_GET_LENGTH(**name) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                #endif
+                    PyUnicode_Compare(**name, key);
+                if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                if (cmp == 0) {
+                    values[name-argnames] = value;
+                    break;
+                }
+                name++;
+            }
+            if (*name) continue;
+            else {
+                PyObject*** argname = argnames;
+                while (argname != first_kw_arg) {
+                    int cmp = (**argname == key) ? 0 :
+                    #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION >= 3
+                        (__Pyx_PyUnicode_GET_LENGTH(**argname) != __Pyx_PyUnicode_GET_LENGTH(key)) ? 1 :
+                    #endif
+                        PyUnicode_Compare(**argname, key);
+                    if (cmp < 0 && unlikely(PyErr_Occurred())) goto bad;
+                    if (cmp == 0) goto arg_passed_twice;
+                    argname++;
+                }
+            }
+        } else
+            goto invalid_keyword_type;
+        if (kwds2) {
+            if (unlikely(PyDict_SetItem(kwds2, key, value))) goto bad;
+        } else {
+            goto invalid_keyword;
+        }
+    }
+    return 0;
+arg_passed_twice:
+    __Pyx_RaiseDoubleKeywordsError(function_name, key);
+    goto bad;
+invalid_keyword_type:
+    PyErr_Format(PyExc_TypeError,
+        "%.200s() keywords must be strings", function_name);
+    goto bad;
+invalid_keyword:
+    PyErr_Format(PyExc_TypeError,
+    #if PY_MAJOR_VERSION < 3
+        "%.200s() got an unexpected keyword argument '%.200s'",
+        function_name, PyString_AsString(key));
+    #else
+        "%s() got an unexpected keyword argument '%U'",
+        function_name, key);
+    #endif
+bad:
+    return -1;
+}
+
 /* SetItemInt */
 static int __Pyx_SetItemInt_Generic(PyObject *o, PyObject *j, PyObject *v) {
     int r;
     if (!j) return -1;
     r = PyObject_SetItem(o, j, v);
     Py_DECREF(j);
     return r;
@@ -39782,14 +38067,101 @@
     {
         return PySequence_SetItem(o, i, v);
     }
 #endif
     return __Pyx_SetItemInt_Generic(o, PyInt_FromSsize_t(i), v);
 }
 
+/* GetItemInt */
+static PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
+    PyObject *r;
+    if (!j) return NULL;
+    r = PyObject_GetItem(o, j);
+    Py_DECREF(j);
+    return r;
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyList_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyList_GET_SIZE(o)))) {
+        PyObject *r = PyList_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
+                                                              CYTHON_NCP_UNUSED int wraparound,
+                                                              CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
+    Py_ssize_t wrapped_i = i;
+    if (wraparound & unlikely(i < 0)) {
+        wrapped_i += PyTuple_GET_SIZE(o);
+    }
+    if ((!boundscheck) || likely(__Pyx_is_valid_index(wrapped_i, PyTuple_GET_SIZE(o)))) {
+        PyObject *r = PyTuple_GET_ITEM(o, wrapped_i);
+        Py_INCREF(r);
+        return r;
+    }
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+#else
+    return PySequence_GetItem(o, i);
+#endif
+}
+static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
+                                                     CYTHON_NCP_UNUSED int wraparound,
+                                                     CYTHON_NCP_UNUSED int boundscheck) {
+#if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS && CYTHON_USE_TYPE_SLOTS
+    if (is_list || PyList_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
+        if ((!boundscheck) || (likely(__Pyx_is_valid_index(n, PyList_GET_SIZE(o))))) {
+            PyObject *r = PyList_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    }
+    else if (PyTuple_CheckExact(o)) {
+        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
+        if ((!boundscheck) || likely(__Pyx_is_valid_index(n, PyTuple_GET_SIZE(o)))) {
+            PyObject *r = PyTuple_GET_ITEM(o, n);
+            Py_INCREF(r);
+            return r;
+        }
+    } else {
+        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
+        if (likely(m && m->sq_item)) {
+            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
+                Py_ssize_t l = m->sq_length(o);
+                if (likely(l >= 0)) {
+                    i += l;
+                } else {
+                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
+                        return NULL;
+                    PyErr_Clear();
+                }
+            }
+            return m->sq_item(o, i);
+        }
+    }
+#else
+    if (is_list || PySequence_Check(o)) {
+        return PySequence_GetItem(o, i);
+    }
+#endif
+    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
+}
+
 /* ObjectGetItem */
 #if CYTHON_USE_TYPE_SLOTS
 static PyObject *__Pyx_PyObject_GetIndex(PyObject *obj, PyObject* index) {
     PyObject *runerr;
     Py_ssize_t key_value;
     PySequenceMethods *m = Py_TYPE(obj)->tp_as_sequence;
     if (unlikely(!(m && m->sq_item))) {
@@ -41920,120 +40292,14 @@
     cobj = PyCapsule_New(p, sig, NULL);
 #else
     cobj = PyCObject_FromVoidPtr(p, NULL);
 #endif
     return cobj;
 }
 
-/* Print */
-#if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
-static PyObject *__Pyx_GetStdout(void) {
-    PyObject *f = PySys_GetObject((char *)"stdout");
-    if (!f) {
-        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
-    }
-    return f;
-}
-static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
-    int i;
-    if (!f) {
-        if (!(f = __Pyx_GetStdout()))
-            return -1;
-    }
-    Py_INCREF(f);
-    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
-        PyObject* v;
-        if (PyFile_SoftSpace(f, 1)) {
-            if (PyFile_WriteString(" ", f) < 0)
-                goto error;
-        }
-        v = PyTuple_GET_ITEM(arg_tuple, i);
-        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
-            goto error;
-        if (PyString_Check(v)) {
-            char *s = PyString_AsString(v);
-            Py_ssize_t len = PyString_Size(v);
-            if (len > 0) {
-                switch (s[len-1]) {
-                    case ' ': break;
-                    case '\f': case '\r': case '\n': case '\t': case '\v':
-                        PyFile_SoftSpace(f, 0);
-                        break;
-                    default:  break;
-                }
-            }
-        }
-    }
-    if (newline) {
-        if (PyFile_WriteString("\n", f) < 0)
-            goto error;
-        PyFile_SoftSpace(f, 0);
-    }
-    Py_DECREF(f);
-    return 0;
-error:
-    Py_DECREF(f);
-    return -1;
-}
-#else
-static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
-    PyObject* kwargs = 0;
-    PyObject* result = 0;
-    PyObject* end_string;
-    if (unlikely(!__pyx_print)) {
-        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
-        if (!__pyx_print)
-            return -1;
-    }
-    if (stream) {
-        kwargs = PyDict_New();
-        if (unlikely(!kwargs))
-            return -1;
-        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
-            goto bad;
-        if (!newline) {
-            end_string = PyUnicode_FromStringAndSize(" ", 1);
-            if (unlikely(!end_string))
-                goto bad;
-            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
-                Py_DECREF(end_string);
-                goto bad;
-            }
-            Py_DECREF(end_string);
-        }
-    } else if (!newline) {
-        if (unlikely(!__pyx_print_kwargs)) {
-            __pyx_print_kwargs = PyDict_New();
-            if (unlikely(!__pyx_print_kwargs))
-                return -1;
-            end_string = PyUnicode_FromStringAndSize(" ", 1);
-            if (unlikely(!end_string))
-                return -1;
-            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
-                Py_DECREF(end_string);
-                return -1;
-            }
-            Py_DECREF(end_string);
-        }
-        kwargs = __pyx_print_kwargs;
-    }
-    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
-    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
-        Py_DECREF(kwargs);
-    if (!result)
-        return -1;
-    Py_DECREF(result);
-    return 0;
-bad:
-    if (kwargs != __pyx_print_kwargs)
-        Py_XDECREF(kwargs);
-    return -1;
-}
-#endif
-
 /* IsLittleEndian */
 static CYTHON_INLINE int __Pyx_Is_Little_Endian(void)
 {
   union {
     uint32_t u32;
     uint8_t u8[4];
   } S;
@@ -42819,14 +41085,120 @@
     double value = __pyx_PyFloat_AsDouble(obj);
     if ((value == (double)-1) && PyErr_Occurred())
         return 0;
     *(double *) itemp = value;
     return 1;
 }
 
+/* Print */
+  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
+static PyObject *__Pyx_GetStdout(void) {
+    PyObject *f = PySys_GetObject((char *)"stdout");
+    if (!f) {
+        PyErr_SetString(PyExc_RuntimeError, "lost sys.stdout");
+    }
+    return f;
+}
+static int __Pyx_Print(PyObject* f, PyObject *arg_tuple, int newline) {
+    int i;
+    if (!f) {
+        if (!(f = __Pyx_GetStdout()))
+            return -1;
+    }
+    Py_INCREF(f);
+    for (i=0; i < PyTuple_GET_SIZE(arg_tuple); i++) {
+        PyObject* v;
+        if (PyFile_SoftSpace(f, 1)) {
+            if (PyFile_WriteString(" ", f) < 0)
+                goto error;
+        }
+        v = PyTuple_GET_ITEM(arg_tuple, i);
+        if (PyFile_WriteObject(v, f, Py_PRINT_RAW) < 0)
+            goto error;
+        if (PyString_Check(v)) {
+            char *s = PyString_AsString(v);
+            Py_ssize_t len = PyString_Size(v);
+            if (len > 0) {
+                switch (s[len-1]) {
+                    case ' ': break;
+                    case '\f': case '\r': case '\n': case '\t': case '\v':
+                        PyFile_SoftSpace(f, 0);
+                        break;
+                    default:  break;
+                }
+            }
+        }
+    }
+    if (newline) {
+        if (PyFile_WriteString("\n", f) < 0)
+            goto error;
+        PyFile_SoftSpace(f, 0);
+    }
+    Py_DECREF(f);
+    return 0;
+error:
+    Py_DECREF(f);
+    return -1;
+}
+#else
+static int __Pyx_Print(PyObject* stream, PyObject *arg_tuple, int newline) {
+    PyObject* kwargs = 0;
+    PyObject* result = 0;
+    PyObject* end_string;
+    if (unlikely(!__pyx_print)) {
+        __pyx_print = PyObject_GetAttr(__pyx_b, __pyx_n_s_print);
+        if (!__pyx_print)
+            return -1;
+    }
+    if (stream) {
+        kwargs = PyDict_New();
+        if (unlikely(!kwargs))
+            return -1;
+        if (unlikely(PyDict_SetItem(kwargs, __pyx_n_s_file, stream) < 0))
+            goto bad;
+        if (!newline) {
+            end_string = PyUnicode_FromStringAndSize(" ", 1);
+            if (unlikely(!end_string))
+                goto bad;
+            if (PyDict_SetItem(kwargs, __pyx_n_s_end, end_string) < 0) {
+                Py_DECREF(end_string);
+                goto bad;
+            }
+            Py_DECREF(end_string);
+        }
+    } else if (!newline) {
+        if (unlikely(!__pyx_print_kwargs)) {
+            __pyx_print_kwargs = PyDict_New();
+            if (unlikely(!__pyx_print_kwargs))
+                return -1;
+            end_string = PyUnicode_FromStringAndSize(" ", 1);
+            if (unlikely(!end_string))
+                return -1;
+            if (PyDict_SetItem(__pyx_print_kwargs, __pyx_n_s_end, end_string) < 0) {
+                Py_DECREF(end_string);
+                return -1;
+            }
+            Py_DECREF(end_string);
+        }
+        kwargs = __pyx_print_kwargs;
+    }
+    result = PyObject_Call(__pyx_print, arg_tuple, kwargs);
+    if (unlikely(kwargs) && (kwargs != __pyx_print_kwargs))
+        Py_DECREF(kwargs);
+    if (!result)
+        return -1;
+    Py_DECREF(result);
+    return 0;
+bad:
+    if (kwargs != __pyx_print_kwargs)
+        Py_XDECREF(kwargs);
+    return -1;
+}
+#endif
+
 /* CIntFromPyVerify */
   #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
 #define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
     __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
 #define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
     {\
@@ -43263,122 +41635,85 @@
     __Pyx_XDECREF(temp_int);
     __Pyx_XDECREF(array_obj);
     __Pyx_RefNannyFinishContext();
     return new_mvs;
 }
 
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const long neg_one = (long) -1, const_zero = (long) 0;
+    const int neg_one = (int) -1, const_zero = (int) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(long) < sizeof(long)) {
+        if (sizeof(int) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(long) <= sizeof(unsigned long)) {
+        } else if (sizeof(int) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(long) <= sizeof(long)) {
+        if (sizeof(int) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(long),
+        return _PyLong_FromByteArray(bytes, sizeof(int),
                                      little, !is_unsigned);
     }
 }
 
-/* PrintOne */
-  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
-static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
-    if (!f) {
-        if (!(f = __Pyx_GetStdout()))
-            return -1;
-    }
-    Py_INCREF(f);
-    if (PyFile_SoftSpace(f, 0)) {
-        if (PyFile_WriteString(" ", f) < 0)
-            goto error;
-    }
-    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
-        goto error;
-    if (PyFile_WriteString("\n", f) < 0)
-        goto error;
-    Py_DECREF(f);
-    return 0;
-error:
-    Py_DECREF(f);
-    return -1;
-    /* the line below is just to avoid C compiler
-     * warnings about unused functions */
-    return __Pyx_Print(f, NULL, 0);
-}
-#else
-static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
-    int res;
-    PyObject* arg_tuple = PyTuple_Pack(1, o);
-    if (unlikely(!arg_tuple))
-        return -1;
-    res = __Pyx_Print(stream, arg_tuple, 1);
-    Py_DECREF(arg_tuple);
-    return res;
-}
-#endif
-
 /* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
+  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
-    const int neg_one = (int) -1, const_zero = (int) 0;
+    const long neg_one = (long) -1, const_zero = (long) 0;
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic pop
 #endif
     const int is_unsigned = neg_one > const_zero;
     if (is_unsigned) {
-        if (sizeof(int) < sizeof(long)) {
+        if (sizeof(long) < sizeof(long)) {
             return PyInt_FromLong((long) value);
-        } else if (sizeof(int) <= sizeof(unsigned long)) {
+        } else if (sizeof(long) <= sizeof(unsigned long)) {
             return PyLong_FromUnsignedLong((unsigned long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
+        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
             return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
 #endif
         }
     } else {
-        if (sizeof(int) <= sizeof(long)) {
+        if (sizeof(long) <= sizeof(long)) {
             return PyInt_FromLong((long) value);
 #ifdef HAVE_LONG_LONG
-        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
+        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
             return PyLong_FromLongLong((PY_LONG_LONG) value);
 #endif
         }
     }
     {
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(int),
+        return _PyLong_FromByteArray(bytes, sizeof(long),
                                      little, !is_unsigned);
     }
 }
 
 /* CIntFromPy */
   static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
@@ -43571,14 +41906,51 @@
     return (int) -1;
 raise_neg_overflow:
     PyErr_SetString(PyExc_OverflowError,
         "can't convert negative value to int");
     return (int) -1;
 }
 
+/* PrintOne */
+  #if !CYTHON_COMPILING_IN_PYPY && PY_MAJOR_VERSION < 3
+static int __Pyx_PrintOne(PyObject* f, PyObject *o) {
+    if (!f) {
+        if (!(f = __Pyx_GetStdout()))
+            return -1;
+    }
+    Py_INCREF(f);
+    if (PyFile_SoftSpace(f, 0)) {
+        if (PyFile_WriteString(" ", f) < 0)
+            goto error;
+    }
+    if (PyFile_WriteObject(o, f, Py_PRINT_RAW) < 0)
+        goto error;
+    if (PyFile_WriteString("\n", f) < 0)
+        goto error;
+    Py_DECREF(f);
+    return 0;
+error:
+    Py_DECREF(f);
+    return -1;
+    /* the line below is just to avoid C compiler
+     * warnings about unused functions */
+    return __Pyx_Print(f, NULL, 0);
+}
+#else
+static int __Pyx_PrintOne(PyObject* stream, PyObject *o) {
+    int res;
+    PyObject* arg_tuple = PyTuple_Pack(1, o);
+    if (unlikely(!arg_tuple))
+        return -1;
+    res = __Pyx_Print(stream, arg_tuple, 1);
+    Py_DECREF(arg_tuple);
+    return res;
+}
+#endif
+
 /* CIntFromPy */
   static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const long neg_one = (long) -1, const_zero = (long) 0;
```

### Comparing `fastrometry-1.0.8/src/fastrometry/fastrometry.py` & `fastrometry-1.0.9/src/fastrometry/fastrometry.py`

 * *Files 20% similar despite different names*

```diff
@@ -1,33 +1,30 @@
 #This code is always intended to be imported as a module, whether via the fastrometry command-line call (which uses the entry_points
 #option in setup.cfg which implicitly imports this module) or via a specified import statement in another (parent) module. Thus
 #calling this module directly will fail because of the relative imports used in the next two lines.
 
 from .cython_code import PSE
 from .cython_code import WCS
-#from .options import processOptions
 from .catalogue import getIntermediateCoords
 
 import argparse
 from astropy.io import fits
 from datetime import datetime
 import numpy as np
 from pathlib import Path
 import re
 from textwrap import wrap
 import json
 from math import pi
 import sys
 
 ################
-VERSION="1.0.8"
+VERSION="1.0.9"
 ################
 
-verbosity = None
-
 def insertCopyNumber(outfilename, diagnostic, filename_body, filename_ext):
     copynum = 1
     while Path(outfilename).is_file():
         outfilename = filename_body+' WCS ({})'.format(copynum)+filename_ext
         diagnostic = filename_body+' WCS ({}) diagnostic.csv'.format(copynum)
         copynum += 1
     return outfilename, diagnostic
@@ -72,146 +69,82 @@
     parser.add_argument('--debug', action='store_true', help=formatting('Enters debug mode. Steps through the program, pausing at intervals to print diagnostic and debugging info to the print and display various plots and images. A debug report will be created and saved in the current working directory. --verbosity is automatically set to 2.',80,4))
     parser.add_argument('--h', '--help', '-h', '-help', action='help', default=argparse.SUPPRESS, help=formatting('Shows this help message.',80,4))
 
     input_args = parser.parse_args()
 
     return input_args
 
-def printEvent(startmessage, endmessage, levelneeded):
-    """
-    This is a decorator factory, which returns a decorator.
-    The decorator's purpose is to return a wrapper, which
-    provides the original function (f) with extra utilities,
-    which in this case is a pair of verbosity-dependent
-    console messages, whose wording and needed verbosity
-    level are specified in the decorator factory arguments.
-    """
-    def decorator(f):
-        def wrapper(*args, **kwargs):
-            verbosity = args[-1]
-            if verbosity >= levelneeded:
-                print(startmessage)
-            fout = f(*args,**kwargs)
-            if verbosity >= levelneeded:
-                print(endmessage)
-            return fout
-        return wrapper
-    return decorator
-
-def vbprint(message, levelneeded, verbosity):
-    if verbosity >= levelneeded:
-        print(message)
-
-@printEvent("| Performing unit conversions...", "| done", 1)
-def convertParameters(parameters, verbosity):
-    scale = parameters[3]
-    scalebnds = parameters[4]
-    scale = scale/3600*pi/180   #from arcsec/pixel to radians/pixel
-    scalebnds = scalebnds*.01   #from % to a decimal
-    parameters[3] = scale
-    parameters[4] = scalebnds
-
-    rotation = parameters[5]
-    rotationbnds = parameters[6]
-    if rotation is not None:
-        rotation = rotation*pi/180  #from degrees to radians
-    if rotationbnds is not None:
-        rotationbnds = rotationbnds*pi/180  #from degrees to radians
-    parameters[5] = rotation
-    parameters[6] = rotationbnds
-
-    buffer = parameters[7]
-    buffer = buffer/60  #from arcminutes to degrees
-    parameters[7] = buffer
-    
-    vertextol = parameters[17]
-    vertextol = vertextol*pi/180    #from degrees to radians
-    parameters[17] = vertextol
-
-    nmatchpercent = parameters[19]
-    nmatchpercent = nmatchpercent*.01   #from % to a decimal
-    parameters[19] = nmatchpercent
-
-def drawOptionsTable(settings, parameters, verbosity):
+def drawOptionsTable(filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug):
     if verbosity == 2:
-        wcsdiagnostics = settings[0]
         if wcsdiagnostics is True:
             wcsdiagnostics_str = "Yes"
         else:
             wcsdiagnostics_str = "No"
         
-        overwrite = settings[1]
         if overwrite is True:
             overwrite_str = "Yes"
         else:
             overwrite_str = "No"
-        
-        save = settings[2]
+
         if save is None:
             save_str = ""
         else:
             save_str = str(save)
-        
-        load = settings[3]
+
         if load is None:
             load_str = ""
         else:
             load_str = str(load)
 
-        verbosity_str = str(settings[4])
+        verbosity_str = str(verbosity)
 
-        debug = settings[5]
         if debug is True:
             debug_str = "Yes"
         else:
             debug_str = "No"
 
-        filename_str = str(parameters[0])
-        ra_str = str(parameters[1])+" degrees"
-        dec_str = str(parameters[2])+" degrees"
-        scale_str = str(parameters[3])+" arcseconds/pixel"
-        scalebnds_str = str(parameters[4])+"%"
+        filename_str = str(filename)
+        ra_str = str(ra)+" degrees"
+        dec_str = str(dec)+" degrees"
+        scale_str = str(scale)+" arcseconds/pixel"
+        scalebnds_str = str(scalebnds)+"%"
 
-        rotation = parameters[5]
         if rotation is None:
             rotation_str = "TBD"
         else:
             rotation_str = str(rotation)+" degrees"
         
-        rotationbnds = parameters[6]
         if rotationbnds is None:
             rotationbnds_str = ""
         else:
             rotationbnds_str = str(rotationbnds)+" degrees"
         
-        buffer_str = str(parameters[7])+" arcminutes"
-        fieldshape_str = str(parameters[8])
-        catalogue_str = str(parameters[9])
-        filter_str = str(parameters[10])
+        buffer_str = str(buffer)+" arcminutes"
+        fieldshape_str = str(fieldshape)
+        catalogue_str = str(catalogue)
+        filter_str = str(filter)
 
-        pmepoch = parameters[11]
         if pmepoch == 0:
             pmepoch_str = "0 (off)"
         else:
-            pmepoch_str = str(parameters[11])
+            pmepoch_str = str(pmepoch)
 
-        npts_str = str(parameters[12])+" points"
-        nrefinepts_str = str(parameters[13])+" points"
+        npts_str = str(npts)+" points"
+        nrefinepts_str = str(nrefinepts)+" points"
         
-        pixsat = parameters[14]
         if pixsat == 0:
             pixsat_str = "0 (off)"
         else:
             pixsat_str = str(pixsat)
 
-        kernelrad_str = str(parameters[15])+" pixels"
-        sourcesep_str = str(parameters[16])+" pixels"
-        vertextol_str = str(parameters[17])+" degrees"
-        nmatchpoints_str = str(parameters[18])+" points"
-        nmatchpercent_str = str(parameters[19])+"%"
+        kernelrad_str = str(kernelrad)+" pixels"
+        sourcesep_str = str(sourcesep)+" pixels"
+        vertextol_str = str(vertextol)+" degrees"
+        nmatchpoints_str = str(nmatchpoints)+" points"
+        nmatchpercent_str = str(nmatchpercent)+"%"
 
         print("| ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' '")
         print("| '                              ==Options==                              '")
         print("| '                                                                       '")
         print("| '  Settings:                                                            '")
         print("| '    wcsdiagnostics: {:51}'".format(wcsdiagnostics_str))
         print("| '    overwrite: {:56}'".format(overwrite_str))
@@ -240,316 +173,199 @@
         print("| '    sourcesep: {:56}'".format(sourcesep_str))
         print("| '    vertextol: {:56}'".format(vertextol_str))
         print("| '    nmatchpoints: {:53}'".format(nmatchpoints_str))
         print("| '    nmatchpercent: {:52}'".format(nmatchpercent_str))
         print("| '                                                                       '")
         print("| ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' ' '")
 
-def createFolder(folder, parent_folder, verbosity):
-    @printEvent("| | Creating {} folder...".format(folder), "| | done", 1)
-    def createThisFolder(parent_folder, verbosity):
-        (parent_folder/folder).mkdir(parents=True)
-    createThisFolder(parent_folder, verbosity)
-
-@printEvent("| | Checking save ID...", "| | done", 1)
-def polishID(id, verbosity):
-    re.sub(r'[^\w\-_\. ]', '', id)
-    return id
-
-@printEvent("| Saving parameters to {}.json...".format(id), "| done", 1)
-def saveParameters(id, user_dir, parameters, verbosity):
+def saveRemainingOptions(save, user_dir, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, verbosity):
+    if verbosity >= 1:
+        print("Saving options...")
     try:
-        id = polishID(id, verbosity)
-        
+        #save = re.sub(r'[^\w\-_\. ]', '', save)
         contents = {
-            'scale' : parameters[3],
-            'scalebnds' : parameters[4],
-            'rotation' : parameters[5],
-            'rotationbnds' : parameters[6],
-            'buffer' : parameters[7],
-            'fieldshape' : parameters[8],
-            'catalogue' : parameters[9],
-            'filter' : parameters[10],
-            'npts' : parameters[12],
-            'nrefinepts' : parameters[13],
-            'pixsat' : parameters[14],
-            'kernelrad' : parameters[15],
-            'sourcesep' : parameters[16],
-            'vertextol' : parameters[17],
-            'nmatchpoints' : parameters[18],
-            'nmatchpercent' : parameters[19],
+            'scale' : scale,
+            'scalebnds' : scalebnds,
+            'rotation' : rotation,
+            'rotationbnds' : rotationbnds,
+            'buffer' : buffer,
+            'fieldshape' : fieldshape,
+            'catalogue' : catalogue,
+            'filter' : filter,
+            'npts' : npts,
+            'nrefinepts' : nrefinepts,
+            'pixsat' : pixsat,
+            'kernelrad' : kernelrad,
+            'sourcesep' : sourcesep,
+            'vertextol' : vertextol,
+            'nmatchpoints' : nmatchpoints,
+            'nmatchpercent' : nmatchpercent,
         }
         jobject = json.dumps(contents)
-
-        if not (user_dir/'cmd_options').is_dir():
-            createFolder('cmd_options', user_dir, verbosity)
-
-        with open(user_dir/'cmd_args'/'options_{}.json'.format(id),'w') as fp:
+        if not (user_dir/'saved_options').is_dir():
+            (user_dir/'saved_options').mkdir()
+        with open(user_dir/'saved_options'/'{}.json'.format(save),'w') as fp:
             fp.write(jobject)
-
-        return id
-
     except Exception as e:
         print(e)
-        sys.exit("ERROR: Could not save options.")          
-
-@printEvent("| Loading parameters from saveoptions_{}.json...".format(id), "| done", 1)
-def loadParameters(id, user_dir, parameters, verbosity):
+        sys.exit("ERROR: Could not save options.")      
+    if verbosity >= 1:
+        print("done")
+    return save    
+
+def loadRemainingOptions(load, user_dir, verbosity):
+    if verbosity >= 1:
+        print("Loading options...")
     try:
-        with open(user_dir/'cmd_args'/'options_{}.json'.format(id),'r') as fp:
+        with open(user_dir/'saved_options'/'{}.json'.format(load),'r') as fp:
             jobject = json.load(fp)
-            parameters[3] = jobject['scale']
-            parameters[4] = jobject['scalebnds']
-            parameters[5] = jobject['rotation']
-            parameters[6] = jobject['rotationbnds']
-            parameters[7] = jobject['buffer']
-            parameters[8] = jobject['fieldshape']
-            parameters[9] = jobject['catalogue']
-            parameters[10] = jobject['filter']
-            parameters[12] = jobject['npts']
-            parameters[13] = jobject['nrefinepts']
-            parameters[14] = jobject['pixsat']
-            parameters[15] = jobject['kernelrad']
-            parameters[16] = jobject['sourcesep']
-            parameters[17] = jobject['vertextol']
-            parameters[18] = jobject['nmatchpoints']
-            parameters[19] = jobject['nmatchpercent']
+            scale = jobject['scale']
+            scalebnds = jobject['scalebnds']
+            rotation = jobject['rotation']
+            rotationbnds = jobject['rotationbnds']
+            buffer = jobject['buffer']
+            fieldshape = jobject['fieldshape']
+            catalogue = jobject['catalogue']
+            filter = jobject['filter']
+            npts = jobject['npts']
+            nrefinepts = jobject['nrefinepts']
+            pixsat = jobject['pixsat']
+            kernelrad = jobject['kernelrad']
+            sourcesep = jobject['sourcesep']
+            vertextol = jobject['vertextol']
+            nmatchpoints = jobject['nmatchpoints']
+            nmatchpercent = jobject['nmatchpercent']
     except Exception as e:
         print(e)
-        sys.exit("ERROR: Could not load parameters. Check that a json file exists with the specified id.")    
+        sys.exit("ERROR: Could not load options. Check that a json file exists with the specified id.")
+    if verbosity >= 1:
+        print("done")
+    return scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent
 
-@printEvent("| | Validating -nmatchpoints and -nmatchpercent...", "| | done", 2)
-def validateNmatchpointsAndNmatchpercent(nmatchpoints, nmatchpercent, verbosity):
-    if nmatchpoints is None:
-        nmatchpoints = 6
-        vbprint("| | | -nmatchpoints not supplied. Defaulting to 6.", 2, verbosity)
-    else:
-        try:
-            nmatchpoints = int(nmatchpoints)
-        except:
-            sys.exit("ERROR: -nmatchpoints must be an integer.")
-        if not nmatchpoints > 2:
-            sys.exit("ERROR: -nmatchpoints must be greater than 2.")
-    if nmatchpercent is None:
-        nmatchpercent = 25
-        vbprint("| | | -nmatchpercent not supplied. Defaulting to 25.", 2, verbosity)
-    else:
-        try:
-            nmatchpercent = float(nmatchpercent)
-        except:
-            sys.exit("ERROR: -nmatchpercent must be a number.")
-        if not nmatchpercent > 10:
-            sys.exit("ERROR: -nmatchpercent must be greater than 10.")
-    return nmatchpoints, nmatchpercent
-
-@printEvent("| | Validating -kernelrad and -sourcesep...", "| | done", 2)
-def validateKernelradAndSourcesep(kernelrad, sourcesep, verbosity):
-    if kernelrad is None:
-        kernelrad = 2
-        vbprint("| | | -kernelrad not supplied. Defaulting to 2.", 2, verbosity)
-    else:
-        try:
-            kernelrad = int(kernelrad)
-        except:
-            sys.exit("ERROR: -kernelrad must be an integer.")
-        if not kernelrad >= 2:
-            sys.exit("ERROR: -kernelrad must be greater than or equal to 2.")    
-    if sourcesep is None:
-        sourcesep = 25
-        vbprint("| | | -sourcesep not supplied. Defaulting to 25.", 2, verbosity)
-    else:
-        try:
-            sourcesep = int(sourcesep)
-        except:
-            sys.exit("ERROR: -sourcesep must be an integer.")
-        if not kernelrad <= sourcesep <= 45:
-            sys.exit("ERROR: -sourcesep must be greater than or equal to -kernelrad and less than or equal to 45.")  
-    return kernelrad, sourcesep
-
-@printEvent("| | Validating -pixsat...", "| | done", 2)
-def validatePixsat(pixsat, verbosity):
-    if pixsat is None:
-        pixsat = 0.
-        vbprint("| | | -pixsat not supplied. Defaulting to 0 (off).", 2, verbosity)
-    else:
-        try:
-            pixsat = float(pixsat)
-        except:
-            sys.exit('ERROR: -pixsat must be a number.')
-        if not pixsat >= 0: 
-            sys.exit("ERROR: -pixsat must be greater than or equal to 0.")
-    return pixsat
-
-@printEvent("| | Validating -npts and -nrefinepts...", "| | done", 2)
-def validateNptsAndNrefinepts(npts, nrefinepts, verbosity):
-    if npts is None:
-        npts = 75
-        vbprint("| | | -npts not supplied. Defaulting to 75.", 2, verbosity)
-    else:
-        try:
-            npts = int(npts)
-        except:
-            sys.exit('ERROR: -npts must be an integer.')
-        if not 10 <= npts <= 300:
-            sys.exit("ERROR: -npts must be between 10 and 300.")
-    if nrefinepts is None:
-        nrefinepts = 500
-        vbprint("| | | -nrefinepts not supplied. Defaulting to 500.", 2, verbosity)
-    else:
-        try:
-            nrefinepts = int(nrefinepts)
-        except:
-            sys.exit('ERROR: -nrefinepts must be an integer.')
-        if not npts <= nrefinepts <= 1000:
-            sys.exit("ERROR: -nrefinepts must be between npts and 1000.")     
-    return npts, nrefinepts
-
-@printEvent("| | Validating -catalogue and -filter...", "| | done", 2)
-def validateCatalogueAndFilter(catalogue, filter, verbosity):
-    if catalogue is None:
-        catalogue = 'GaiaDR3'
-        vbprint("| | | -catalogue not supplied. Defaulting to 'GaiaDR3'", 2, verbosity)
-    if catalogue == 'GaiaDR3':
-        if filter is None:
-            filter = 'g'
-            vbprint("| | | -filter not supplied. Defaulting to 'g'.", 2, verbosity)
-        else:
-            if filter not in ['bp','g','rp']:
-                sys.exit("ERROR: -filter for the GaiaDR3 catalogue must be from the following options: ['bp','g','rp'].")
-    elif catalogue not in ['GaiaDR3']:
-        sys.exit("ERROR: -catalogue must be from the following options: ['GaiaDR3'].")
-    return catalogue, filter
-
-@printEvent("| | Validating -fieldshape...", "| | done", 2)
-def validateFieldshape(fieldshape, header, verbosity):
-    if fieldshape is None:
-        fieldshape = 'rectangle'
-        vbprint("| | | -fieldshape not supplied. Defaulting to 'rectangle'.", 2, verbosity)
-    else:
-        if fieldshape not in ['rectangle','circle']:
-            sys.exit("ERROR: -fieldshape must be from the following options: ['rectangle','circle']")
-        if fieldshape == 'circle':
-            if not header['NAXIS1'] == header['NAXIS2']:
-                sys.exit("ERROR: circle query requires a square image, i.e., NAXIS1 = NAXIS2.")
-    return fieldshape
-
-@printEvent("| | Validating -buffer...", "| | done", 2)
-def validateBuffer(buffer, verbosity):
-    if buffer is None:
-        buffer = 0
-        vbprint("| | | -buffer not supplied. Defaulting to 0.", 2, verbosity)
+def validateOptions(filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug):
+
+    if verbosity != 0 and verbosity != "0":
+        print("Validating options...")
+
+    if verbosity != 0 and verbosity != "0":
+        print("| Validating --verbosity...")
+    if verbosity is None:
+        verbosity = 1
     else:
         try:
-            buffer = float(buffer)
+            verbosity = int(verbosity)
         except:
-            sys.exit("ERROR: -buffer must be a number.")
-    return buffer
+            sys.exit("ERROR: --verbosity must be an integer.")
+        if not 0 <= verbosity <= 2:
+            sys.exit("ERROR: --verbosity must be between 0 and 2.")
+    if verbosity >= 1:
+        print("| done")
 
-@printEvent("| | Validating -rotation and -rotationbnds...", "| | done", 2)
-def validateRotationAndRotationbnds(rotation, rotationbnds, vertextol, verbosity):
-    if rotation is None and rotationbnds is None:
-        vbprint("| | | neither -rotation nor -rotationbnds supplied. Will be guessed in the WCS solver.", 2, verbosity)
-    elif rotation is None and rotationbnds is not None:
-        try:
-            rotationbnds = float(rotationbnds)           
-        except:
-            sys.exit('ERROR: -rotationbnds must be a number.')             
-        if not 0 <= rotationbnds <= 180:
-            sys.exit('ERROR: -rotationbnds must be between 0 and 180.')
-        rotation = 0     
-        vbprint("| | | -rotation not supplied. Defaulting to 0.", 2, verbosity)
-    elif rotation is not None and rotationbnds is None:
-        try:
-            rotation = float(rotation)             
-        except:
-            sys.exit('ERROR: -rotation must be a number.')
-        if not -180 <= rotation < 180:
-            sys.exit('ERROR: -rotation must be between -180 and 180.')
-        rotationbnds = 10+vertextol
-        vbprint("| | | -rotationbnds not supplied. Defaulting to 10 degrees plus -vertextol.", 2, verbosity)
-    elif rotation is not None and rotationbnds is not None:
-        try:
-            rotation = float(rotation)  
-        except:
-            sys.exit('ERROR: -rotation must be a number.')      
-        if not -180 <= rotation < 180:
-            sys.exit('ERROR: -rotation must be between -180 and 180.')             
-        try:
-            rotationbnds = float(rotationbnds)
-        except:
-            sys.exit('ERROR: -rotationbnds must be a number')
-        if not 0 <= rotationbnds <= 180:
-            sys.exit('ERROR: -rotationbnds must be between 0 and 180.')
-    return rotation, rotationbnds
-
-@printEvent("| | Validating -vertextol...", "| | done", 2)
-def validateVertextol(vertextol, verbosity):    
-    if vertextol is None:
-        vertextol = 0.25
-        vbprint("| | | -vertextol not supplied. Defaulting to 0.25.", 2, verbosity)
+    if verbosity >= 1:
+        print("| Validating -debug...")
+    if debug is None:
+        debug = False
+        if verbosity == 2:
+            print("| | --debug not supplied. Defaulting to False.")
     else:
         try:
-            vertextol = float(vertextol)
+            debug = bool(debug)
         except:
-            sys.exit("ERROR: -vertextol must be a number.")
-        if not 0 < vertextol < 2:
-            sys.exit("ERROR: -vertextol must be between 0 and 2.")
-    return vertextol
-
-@printEvent("| | Valdiating -scale and -scalebnds...", "| | done", 2)
-def validateScaleAndScalebnds(scale, scalebnds, verbosity):
-    if scale is None:
-        sys.exit('ERROR: -scale is required.')          
-    try:
-        scale = float(scale)        
-    except:
-        sys.exit('ERROR: -scale must be a number.')
-    if not scale > 0:
-        sys.exit('ERROR: -scale must be greater than 0.')
-    
-    if scalebnds is None:
-        scalebnds = 5
-        vbprint("| | | -scalebnds not supplied. Defaulting to 5.", 2, verbosity)
+            sys.exit("ERROR: --debug must be a boolean.")
+        if debug is True:
+            verbosity = 2
+    if verbosity >= 1:
+        print("| done")
+
+    if verbosity >= 1:
+        print("| Validating --overwrite...")
+    if overwrite is None:
+        overwrite = False
+        if verbosity == 2:
+            print("| | --overwrite not supplied. Defaulting to False.")
     else:
         try:
-            scalebnds = float(scalebnds)                 
+            overwrite = bool(overwrite)
         except:
-            sys.exit('ERROR: -scalebnds must be a number.')
-        if not scalebnds >= 0:
-            sys.exit('ERROR: -scalebnds must be greater than 0.')
-    return scale, scalebnds    
+            sys.exit("ERROR: --overwrite must be a boolean.")
+    if verbosity >= 1:
+        print("| done")
 
-@printEvent("| | Validating -pmepoch...", "| | done", 2)
-def validatePmepoch(pmepoch, verbosity):
-    if pmepoch is None:
-        pmepoch = 0
-        vbprint("| | | -pmepoch not given, defaulting to 0.", 2, verbosity)
+    if verbosity >= 1:
+        print("| Validating --wcsdiagnostics...")
+    if wcsdiagnostics is None:
+        wcsdiagnostics = False
+        if verbosity == 2:
+            print("| | --wcsdiagnostics not supplied. Defaulting to False.")
     else:
         try:
-            pmepoch = float(pmepoch)
+            wcsdiagnostics = bool(wcsdiagnostics)
         except:
-            sys.exit("ERROR: -pmepoch must be a number.")
-        if not 1950 <= pmepoch:
-            sys.exit("ERROR: -pmepoch must be greater than or equal to 1950.")
-    return pmepoch
+            sys.exit("ERROR: --wcsdiagnostics must be a boolean.")
+    if verbosity >= 1:
+        print("| done")
+
+    if verbosity >= 1:
+        print("| Validating -filename...")
+    filename = Path(filename)
+    filepath = filename.resolve()
+    if not filepath.is_file():
+        sys.exit("ERROR: could not resolve the specified FITS file. Check that you are in the directory containing your FITS files.")
+    user_dir = filepath.parents[0]
+    filename_body = filename.stem
+    filename_ext = filename.suffix
+    with fits.open(filepath) as hdul:
+        img = hdul[0].data.astype(np.double)
+        header = hdul[0].header
+    if verbosity >= 1:
+        print("| done")
 
-@printEvent("| | Validating -ra and -dec...",  "| | done", 2)
-def validateRaAndDec(ra, dec, header, verbosity):
+    if verbosity >= 1:
+        print("| Validating -ra...")
     try:
         ra = float(ra)
         if not 0 <= ra <= 360:  
             sys.exit("ERROR: -ra must be between 0 and 360 (assuming -ra was given in degree.decimal format).")
-        vbprint("Interpreting -dec in degree.decimal format.", 2, verbosity)
+        if verbosity == 2:
+            print("| | Interpreting -ra in degree.decimal format.")
     except:
         parts = ra.split(':')
         if len(parts) == 1:
             if ra not in header:
                 sys.exit("ERROR: could not find the specified keyword in the FITS header (assuming -ra was supplied as a keyword).")
-            vbprint("| | | Found {} keyword in header.".format(ra), 2, verbosity)
-            ra = float(header[ra])
+            if verbosity == 2:
+                print("| | Found {} keyword in header.".format(ra))
+            try:
+                ra = float(header[ra])
+            except:
+                parts = header[ra].split(':')
+                hrs = parts[0]
+                mins = parts[1]
+                secs = parts[2]
+                try:
+                    hrs = int(hrs)
+                except:
+                    sys.exit("ERROR: hours must be an integer (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                try:
+                    mins = int(mins)
+                except:
+                    sys.exit("ERROR: minutes must be an integer (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                try:
+                    secs = float(secs)
+                except:
+                    sys.exit("ERROR: seconds must be a number (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                if not 0 <= hrs <= 24:
+                    sys.exit("ERROR: hours must be between 0 and 24 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                if not 0 <= mins <= 60:
+                    sys.exit("ERROR: minutes must be between 0 and 60 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                if not 0 <= secs <= 60: 
+                    sys.exit("ERROR: seconds must be between 0 and 60 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
+                ra = float(hrs)*15+float(mins)*15/60+secs*15/3600
+                if verbosity == 2:
+                    print("| | Interpreting -ra in sexagesimal format.")
         elif len(parts) == 3:
             hrs = parts[0]
             mins = parts[1]
             secs = parts[2]
             try:
                 hrs = int(hrs)
             except:
@@ -565,27 +381,65 @@
             if not 0 <= hrs <= 24:
                 sys.exit("ERROR: hours must be between 0 and 24 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
             if not 0 <= mins <= 60:
                 sys.exit("ERROR: minutes must be between 0 and 60 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
             if not 0 <= secs <= 60: 
                 sys.exit("ERROR: seconds must be between 0 and 60 (assuming -ra was given in sexagesimal format HH:MM:SS.S).")
             ra = float(hrs)*15+float(mins)*15/60+secs*15/3600
-            vbprint("Interpreting -ra in sexagesimal format.", 2, verbosity)
+            if verbosity == 2:
+                print("| | Interpreting -ra in sexagesimal format.")
+        if verbosity >= 1:
+            print("| done")
+
+    if verbosity >= 1:
+        print("| Validating -dec...")
     try:
         dec = float(dec)
         if not -90 <= dec <= 90:  
             sys.exit("ERROR: -dec must be between 0 and 360 (assuming -dec was given in degree.decimal format).")
-        vbprint("Interpreting -dec in degree.decimal format.", 2, verbosity)
+        if verbosity == 2:
+            print("| | Interpreting -dec in degree.decimal format.")
     except:
         parts = dec.split(':')
         if len(parts) == 1:
             if dec not in header:
                 sys.exit("ERROR: could not find the specified keyword in the FITS header (assuming -dec was supplied as a keyword).")
-            vbprint("| | | Found {} keyword in header.".format(dec), 2, verbosity)
-            dec = float(header[dec])
+            if verbosity == 2:
+                print("| | Found {} keyword in header.".format(dec))
+            try:
+                dec = float(header[dec])
+            except:
+                parts = header[dec].split(":")
+                deg = parts[0]
+                amins = parts[1]
+                asecs = parts[2]
+                try:
+                    deg = int(deg)
+                except:
+                    sys.exit("ERROR: degrees must be an integer (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                try:
+                    amins = int(amins)
+                except:
+                    sys.exit("ERROR: arcminutes must be an integer (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                try:
+                    asecs = float(asecs)
+                except:
+                    sys.exit("ERROR: arcseconds must be a number (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                if not -90 <= deg <= 90:
+                    sys.exit("ERROR: degrees must be between -90 and 90 (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                if not 0 <= amins <= 60:
+                    sys.exit("ERROR: arcminutes must be between 0 and 60 (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                if not 0 <= asecs <= 60: 
+                    sys.exit("ERROR: arcseconds must be between 0 and 60 (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
+                if deg >= 0:
+                    dec = float(deg)+float(amins)/60+asecs/3600
+                else:
+                    dec = float(deg)-float(amins)/60-asecs/3600
+                if verbosity == 2:
+                    print("| | Interpreting -dec in sexagesimal format.")
         elif len(parts) == 3:
             deg = parts[0]
             amins = parts[1]
             asecs = parts[2]
             try:
                 deg = int(deg)
             except:
@@ -604,373 +458,371 @@
                 sys.exit("ERROR: arcminutes must be between 0 and 60 (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
             if not 0 <= asecs <= 60: 
                 sys.exit("ERROR: arcseconds must be between 0 and 60 (assuming -dec was given in sexagesimal format DD:AM:AS.AS).")
             if deg >= 0:
                 dec = float(deg)+float(amins)/60+asecs/3600
             else:
                 dec = float(deg)-float(amins)/60-asecs/3600
-            vbprint("Interpreting -dec in sexagesimal format.", 2, verbosity)
-    return ra, dec
-
-@printEvent("| | Opening image and header...", "| | done", 2)
-def openFITS(filepath, verbosity):
-    with fits.open(filepath) as hdul:
-        img = hdul[0].data.astype(np.double)
-        header = hdul[0].header
-    return img, header
-
-@printEvent("| | Validating -filename...", "| | done", 2)
-def validateFilename(filename, verbosity):
-    filename = Path(filename)
-    filepath = filename.resolve()
-    if not filepath.is_file():
-        sys.exit("ERROR: could not open the specified FITS file. Check that you are in the directory containing your FITS files.")
-    user_dir = filepath.parents[0]
-    filename_body = filename.stem
-    filename_ext = filename.suffix
-    return filename, filepath, user_dir, filename_body, filename_ext
-
-@printEvent("| Validating parameters...", "| done", 1)
-def validateParameters(parameters, load, verbosity):
-    filename = parameters[0]
-    filename, filepath, user_dir, filename_body, filename_ext = validateFilename(filename, verbosity)
-    parameters[0] = filename
-
-    img, header = openFITS(filepath, verbosity)
-
-    ra = parameters[1]
-    dec = parameters[2]
-    ra, dec = validateRaAndDec(ra, dec, header, verbosity)
-    parameters[1] = ra
-    parameters[2] = dec
-
-    pmepoch = parameters[11]
-    pmepoch = validatePmepoch(pmepoch, verbosity)
-    parameters[11] = pmepoch
-
-    #If we are loading options later, which will already be validated,
-    #there's no need to validate these options since they will just be
-    #overwritten by the loaded ones
-    
-    if load is not None:
-        return img, header, filepath, user_dir, filename_body, filename_ext
-    
-    scale = parameters[3]
-    scalebnds = parameters[4]
-    scale, scalebnds = validateScaleAndScalebnds(scale, scalebnds, verbosity)
-    parameters[3] = scale
-    parameters[4] = scalebnds
-
-    vertextol = parameters[17]
-    vertextol = validateVertextol(vertextol, verbosity)
-    parameters[17] = vertextol
-
-    rotation = parameters[5]
-    rotationbnds = parameters[6]
-    rotation, rotationbnds = validateRotationAndRotationbnds(rotation, rotationbnds, vertextol, verbosity)
-    parameters[5] = rotation
-    parameters[6] = rotationbnds
-
-    buffer = parameters[7]
-    buffer = validateBuffer(buffer, verbosity)
-    parameters[7] = buffer
-
-    fieldshape = parameters[8]
-    fieldshape = validateFieldshape(fieldshape, header, verbosity)
-    parameters[8] = fieldshape
-
-    catalogue = parameters[9]
-    filter = parameters[10]
-    catalogue, filter = validateCatalogueAndFilter(catalogue, filter, verbosity)
-    parameters[9] = catalogue
-    parameters[10] = filter
-
-    npts = parameters[12]
-    nrefinepts = parameters[13]
-    npts, nrefinepts = validateNptsAndNrefinepts(npts, nrefinepts, verbosity)
-    parameters[12] = npts
-    parameters[13] = nrefinepts
-
-    pixsat = parameters[14]
-    pixsat = validatePixsat(pixsat, verbosity)
-    parameters[14] = pixsat
-
-    kernelrad = parameters[15]
-    sourcesep = parameters[16]
-    kernelrad, sourcesep = validateKernelradAndSourcesep(kernelrad, sourcesep, verbosity)
-    parameters[15] = kernelrad
-    parameters[16] = sourcesep
-
-    nmatchpoints = parameters[18]
-    nmatchpercent = parameters[19]
-    nmatchpoints, nmatchpercent = validateNmatchpointsAndNmatchpercent(nmatchpoints, nmatchpercent, verbosity)
-    parameters[18] = nmatchpoints
-    parameters[19] = nmatchpercent
-
-    return img, header, filepath, user_dir, filename_body, filename_ext
-
-@printEvent("| | Validating --overwrite...", "| | done", 2)
-def validateOverwrite(overwrite, verbosity):
-    if overwrite is None:
-        overwrite = False
-        vbprint("| | | --overwrite not supplied. Defaulting to False.", 2, verbosity)
-    else:
-        try:
-            overwrite = bool(overwrite)
-        except:
-            sys.exit("ERROR: --overwrite must be a boolean.")
-    return overwrite
-
-@printEvent("| | Validating --wcsdiagnostics...", "| | done", 2)
-def validateWcsdiagnostics(wcsdiagnostics, verbosity):
-    if wcsdiagnostics is None:
-        wcsdiagnostics = False
-        vbprint("| | | --wcsdiagnostics not supplied. Defaulting to False.", 2, verbosity)
-    else:
-        try:
-            wcsdiagnostics = bool(wcsdiagnostics)
-        except:
-            sys.exit("ERROR: --wcsdiagnostics must be a boolean.")
-    return wcsdiagnostics
+            if verbosity == 2:
+                print("| | Interpreting -dec in sexagesimal format.")
+    if verbosity >= 1:
+            print("| done")
 
-@printEvent("| | Validating --verbosity and --debug...", "| | done", 2)
-def validateVerbosityAndDebug(verbosity, debug, temp_verbosity):
-    if verbosity is None:
-        verbosity = 1
+    if verbosity >= 1:
+        print("| Validating -pmepoch...")
+    if pmepoch is None:
+        pmepoch = 0
+        if verbosity == 2:
+            print("| | -pmepoch not supplied. Defaulting to 0.")
     else:
         try:
-            verbosity = int(verbosity)
+            pmepoch = float(pmepoch)
         except:
-            sys.exit("ERROR: --verbosity must be an integer.")
-        if not 0 <= verbosity <= 2:
-            sys.exit("ERROR: --verbosity must be between 0 and 2.")
+            sys.exit("ERROR: -pmepoch must be a number.")
+        if not 1950 <= pmepoch:
+            sys.exit("ERROR: -pmepoch must be greater than or equal to 1950.")
+    if verbosity >= 1:
+        print("| done")
 
-    if debug is None:
-        debug = False
-        vbprint("| | | --debug not supplied. Defaulting to False.", 2, verbosity)
+    if load is not None:
+        scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent = loadRemainingOptions(load, user_dir, verbosity)
     else:
-        try:
-            debug = bool(debug)
-        except:
-            sys.exit("ERROR: --debug must be a boolean.")
-        if debug is True:
-            verbosity = 2
-    return verbosity, debug
-
-@printEvent("| Validating settings...", "| done", 1)
-def validateSettings(settings, temp_verbosity):
-    
-    verbosity = settings[4]
-    debug = settings[5]
-    verbosity, debug = validateVerbosityAndDebug(verbosity, debug, temp_verbosity)
-    settings[4] = verbosity
-    settings[5] = debug
-
-    wcsdiagnostics = settings[0]
-    validated_wcsdiagnostics = validateWcsdiagnostics(wcsdiagnostics, verbosity)
-    settings[0] = validated_wcsdiagnostics
-
-    overwrite = settings[1]
-    overwrite = validateOverwrite(overwrite, verbosity)
-    settings[1] = overwrite
-    
-    #Save and load have no restrictions and do not need to be validated.
-
-@printEvent("Processing options...", "done", 1)
-def processOptions(settings, parameters, temp_verbosity):
-
-    #Note on validating: since argparse outputs all arguments as strings,
-    #we have to test type by 'trying' type conversions. This can be seen
-    #in the individual validate functions.
-
-    validateSettings(settings, temp_verbosity)
-    #This is the official verbosity variable from here on out.
+        if verbosity >= 1:
+            print("| Validating -scale...")
+        if scale is None:
+            sys.exit('ERROR: -scale is required.')          
+        try:
+            scale = float(scale)        
+        except:
+            sys.exit('ERROR: -scale must be a number.')
+        if not scale > 0:
+            sys.exit('ERROR: -scale must be greater than 0.')
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -scalebnds...")
+        if scalebnds is None:
+            scalebnds = 5
+            if verbosity == 2:
+                print("| | -scalebnds not supplied. Defaulting to 5.")
+        else:
+            try:
+                scalebnds = float(scalebnds)                 
+            except:
+                sys.exit('ERROR: -scalebnds must be a number.')
+            if not scalebnds >= 0:
+                sys.exit('ERROR: -scalebnds must be greater than 0.') 
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -rotation and -rotationbnds...")
+        if rotation is None and rotationbnds is None:
+            if verbosity == 2:
+                print("| | neither -rotation nor -rotationbnds supplied. Will be guessed in the WCS solver.")
+        elif rotation is None and rotationbnds is not None:
+            try:
+                rotationbnds = float(rotationbnds)           
+            except:
+                sys.exit('ERROR: -rotationbnds must be a number.')             
+            if not 0 <= rotationbnds <= 180:
+                sys.exit('ERROR: -rotationbnds must be between 0 and 180.')
+            rotation = 0     
+            if verbosity == 2:
+                print("| | -rotation not supplied. Defaulting to 0.")
+        elif rotation is not None and rotationbnds is None:
+            try:
+                rotation = float(rotation)             
+            except:
+                sys.exit('ERROR: -rotation must be a number.')
+            if not -180 <= rotation < 180:
+                sys.exit('ERROR: -rotation must be between -180 and 180.')
+            rotationbnds = 10+vertextol
+        elif rotation is not None and rotationbnds is not None:
+            try:
+                rotation = float(rotation)  
+            except:
+                sys.exit('ERROR: -rotation must be a number.')      
+            if not -180 <= rotation < 180:
+                sys.exit('ERROR: -rotation must be between -180 and 180.')             
+            try:
+                rotationbnds = float(rotationbnds)
+            except:
+                sys.exit('ERROR: -rotationbnds must be a number')
+            if not 0 <= rotationbnds <= 180:
+                sys.exit('ERROR: -rotationbnds must be between 0 and 180.')
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -buffer...")
+        if buffer is None:
+            buffer = 0
+            if verbosity == 2:
+                print("| | -buffer not supplied. Defaulting to 0.")
+        else:
+            try:
+                buffer = float(buffer)
+            except:
+                sys.exit("ERROR: -buffer must be a number.")
+        if verbosity >= 1:
+            print("| done...")
+
+        if verbosity >= 1:
+            print("| Validating -fieldshape...")
+        if fieldshape is None:
+            fieldshape = 'rectangle'
+            if verbosity == 2:
+                print("| | -fieldshape not supplied. Defaulting to 'rectangle'.", 2, verbosity)
+        else:
+            if fieldshape not in ['rectangle','circle']:
+                sys.exit("ERROR: -fieldshape must be from the following options: ['rectangle','circle']")
+            if fieldshape == 'circle':
+                if not header['NAXIS1'] == header['NAXIS2']:
+                    sys.exit("ERROR: circle query requires a square image, i.e., NAXIS1 = NAXIS2.")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -catalogue and -filter...")
+        if catalogue is None:
+            catalogue = 'GaiaDR3'
+            if verbosity == 2:
+                print("| | -catalogue not supplied. Defaulting to 'GaiaDR3'")
+        if catalogue == 'GaiaDR3':
+            if filter is None:
+                filter = 'g'
+                if verbosity == 2:
+                    print("| | -filter not supplied. Defaulting to 'g'.")
+            else:
+                if filter not in ['bp','g','rp']:
+                    sys.exit("ERROR: -filter for the GaiaDR3 catalogue must be from the following options: ['bp','g','rp'].")
+        elif catalogue not in ['GaiaDR3']:
+            sys.exit("ERROR: -catalogue must be from the following options: ['GaiaDR3'].")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -npts...")
+        if npts is None:
+            npts = 75
+            if verbosity == 2:
+                print("| | -npts not supplied. Defaulting to 75.")
+        else:
+            try:
+                npts = int(npts)
+            except:
+                sys.exit('ERROR: -npts must be an integer.')
+            if not 10 <= npts <= 300:
+                sys.exit("ERROR: -npts must be between 10 and 300.")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -nrefinepts...")
+        if nrefinepts is None:
+            nrefinepts = 500
+            if verbosity == 2:
+                print("| | -nrefinepts not supplied. Defaulting to 500.")
+        else:
+            try:
+                nrefinepts = int(nrefinepts)
+            except:
+                sys.exit('ERROR: -nrefinepts must be an integer.')
+            if not npts <= nrefinepts <= 1000:
+                sys.exit("ERROR: -nrefinepts must be between npts and 1000.")
+        if verbosity >= 1:
+            print("| done")
+            
+        if verbosity >= 1:
+            print("| Validating -pixsat...")
+        if pixsat is None:
+            pixsat = 0.
+            if verbosity == 2:
+                print("| | -pixsat not supplied. Defaulting to 0 (off).")
+        else:
+            try:
+                pixsat = float(pixsat)
+            except:
+                sys.exit('ERROR: -pixsat must be a number.')
+            if not pixsat >= 0: 
+                sys.exit("ERROR: -pixsat must be greater than or equal to 0.")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -kernelrad...")
+        if kernelrad is None:
+            kernelrad = 2
+            if verbosity == 2:
+                print("| | -kernelrad not supplied. Defaulting to 2.")
+        else:
+            try:
+                kernelrad = int(kernelrad)
+            except:
+                sys.exit("ERROR: -kernelrad must be an integer.")
+            if not kernelrad >= 2:
+                sys.exit("ERROR: -kernelrad must be greater than or equal to 2.")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -sourcesep...")  
+        if sourcesep is None:
+            sourcesep = 25
+            if verbosity == 2:
+                print("| | -sourcesep not supplied. Defaulting to 25.")
+        else:
+            try:
+                sourcesep = int(sourcesep)
+            except:
+                sys.exit("ERROR: -sourcesep must be an integer.")
+            if not kernelrad <= sourcesep <= 45:
+                sys.exit("ERROR: -sourcesep must be greater than or equal to -kernelrad and less than or equal to 45.")
+        if verbosity >= 1:
+            print("| done") 
+        
+        if verbosity >= 1:
+            print("| Validating -vertextol...")
+        if vertextol is None:
+            vertextol = 0.25
+            if verbosity == 2:
+                print("| | -vertextol not supplied. Defaulting to 0.25.")
+        else:
+            try:
+                vertextol = float(vertextol)
+            except:
+                sys.exit("ERROR: -vertextol must be a number.")
+            if not 0 < vertextol < 2:
+                sys.exit("ERROR: -vertextol must be between 0 and 2.")  
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating -nmatchpoints...")
+        if nmatchpoints is None:
+            nmatchpoints = 6
+            if verbosity == 2:
+                print("| | -nmatchpoints not supplied. Defaulting to 6.")
+        else:
+            try:
+                nmatchpoints = int(nmatchpoints)
+            except:
+                sys.exit("ERROR: -nmatchpoints must be an integer.")
+            if not nmatchpoints > 2:
+                sys.exit("ERROR: -nmatchpoints must be greater than 2.")
+        if verbosity >= 1:
+            print("| done")
+
+        if verbosity >= 1:
+            print("| Validating nmatchpercent...")
+        if nmatchpercent is None:
+            nmatchpercent = 25
+            if verbosity == 2:
+                print("| | -nmatchpercent not supplied. Defaulting to 25.")
+        else:
+            try:
+                nmatchpercent = float(nmatchpercent)
+            except:
+                sys.exit("ERROR: -nmatchpercent must be a number.")
+            if not nmatchpercent > 10:
+                sys.exit("ERROR: -nmatchpercent must be greater than 10.")
+        if verbosity >= 1:
+            print("| done")
 
-    save = settings[2]
-    load = settings[3]
-    verbosity = settings[4]
-    
-    img, header, filepath, user_dir, filename_body, filename_ext = validateParameters(parameters, load, verbosity)
+    if save is not None:
+        save = saveRemainingOptions(save, user_dir, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, verbosity)
 
-    if save is None and load is None:
-        pass
-    elif save is None and load is not None:
-        id = load
-        loadParameters(id, user_dir, parameters, verbosity)
-    elif save is not None and load is None:
-        id = save
-        id = saveParameters(id, user_dir, parameters, verbosity)
-        settings[2] = id
-    elif save is not None and load is not None:
-        sys.exit("ERROR: cannot specify --save and --load at the same time.")
+    if verbosity >= 1:
+        print("done")
     
-    drawOptionsTable(settings, parameters, verbosity)
-
-    #Converts options to correct units for internal operations (e.g., radians instead of degrees).
-    convertParameters(parameters, verbosity)
+    return filepath, user_dir, filename_body, filename_ext, img, header, filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug
 
-    return img, header, filepath, user_dir, filename_body, filename_ext
-
-def peekAtVerbosity(verbosity):
-    if verbosity == 0 or verbosity == "0":
-        return 0
-    elif verbosity == 1 or verbosity == "1":
-        return 1
-    elif verbosity == 2 or verbosity == "2":
-        return 2
+def setUpFolders(debug, user_dir, filename_body, verbosity):
+    if verbosity >= 1:
+        print("Setting up folders...")
+    debug_folder = (user_dir/'debug')
+    if not debug_folder.is_dir():
+            debug_folder.mkdir()
+    if debug:
+        report_name = str(filename_body)+str(datetime.now().strftime("_%y-%m-%d_%H-%M-%S"))
+        debug_report = (user_dir/'debug'/report_name)
+        debug_report.mkdir()
     else:
-        #if the verbosity is invalid, return the default (the
-        #"error" should be caught in the validation step)
-        return 1
+        debug_report = None
+    gaiaqueries = (user_dir/'gaiaqueries')
+    if not gaiaqueries.is_dir():
+        gaiaqueries.mkdir()
+    if verbosity >= 1:
+        print("done")
+    return debug_folder, debug_report, gaiaqueries
 
-def findWCS(filename, ra=None, dec=None, scale=None, scalebnds=None, rotation=None, rotationbnds=None, buffer=None, fieldshape=None, catalogue=None, pmepoch=None, filter=None, npts=None, nrefinepts=None, pixsat=None, kernelrad=None, sourcesep=None, vertextol=None, nmatchpoints=None, nmatchpercent=None, wcsdiagnostics=None, overwrite=None, save=None, load=None, verbosity=None, debug=None):
+def findWCS(filename, ra=None, dec=None, scale=None, scalebnds=None, rotation=None, rotationbnds=None, buffer=None, fieldshape=None, catalogue=None, filter=None,  pmepoch=None, npts=None, nrefinepts=None, pixsat=None, kernelrad=None, sourcesep=None, vertextol=None, nmatchpoints=None, nmatchpercent=None, wcsdiagnostics=None, overwrite=None, save=None, load=None, verbosity=None, debug=None):
 
     #Section 1
     print("\n")
 
-    #Options are divided into two categories: parameters and settings (identified by single or
-    #double dashes in the help). Parameters affect the calculation of the WCS solution, whereas
-    #settings affect things such as console messages, whether certain files are written, etc.
-
-    settings = [wcsdiagnostics, overwrite, save, load, verbosity, debug]
-    parameters = [filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent]
-
-    #Immediately we have a catch-22, because we need to know the verbosity before printing console
-    #messages, but the proper verbosity validation happens after passing through "processOptions"
-    #and its inner function "validateSettings", both of which will print console messages depending
-    #on the verbosity passed in as an integer argument (this is handled by the @printEntry decorator).
-    #The solution is to peek at the verbosity beforehand and set a new variable "temp_verbosity" to
-    #the appropriate integer, then supply this variable in place of the actual verbosity for a few
-    #functions. This is done instead of moving the whole verbosity validation to the very beginning;
-    #the advantage is that if the verbosity is invalid, the error message prints at the right time
-    #(after "Processing options...").
-
-    temp_verbosity = peekAtVerbosity(verbosity)
-
-    #The important thing is to keep the variable you want to be evaluated as the verbosity as the
-    #last argument (for functions that use the @printEvent decorator in their definition)
-
-    img, header, filepath, user_dir, filename_body, filename_ext = processOptions(settings, parameters, temp_verbosity)
-
-    wcsdiagnostics = settings[0]
-    overwrite = settings[1]
-    #save and load no longer needed
-    verbosity = settings[4]
-    debug = settings[5]
-
-    filename = parameters[0]
-    ra = parameters[1]
-    dec = parameters[2]
-    scale = parameters[3]
-    scalebnds = parameters[4]
-    rotation = parameters[5]
-    rotationbnds = parameters[6]
-    buffer = parameters[7]
-    fieldshape = parameters[8]
-    catalogue = parameters[9]
-    filter = parameters[10]
-    pmepoch = parameters[11]
-    npts = parameters[12]
-    nrefinepts = parameters[13]
-    pixsat = parameters[14]
-    kernelrad = parameters[15]
-    sourcesep = parameters[16]
-    vertextol = parameters[17]
-    nmatchpoints = parameters[18]
-    nmatchpercent = parameters[19]
-
-    ############################# GLOSSARY OF IMPORTANT VARIABLE NAMES #############################
-    ###
-    ###     img:                            A numpy array holding the FITS image supplied by the user.
-    ###
-    ###     srcindexmap (initial/refine):   The source index map. This has the same dimensions as the image. Every "pixel" (array element) is initially set to -1, corresponding to unoccupied. Pixels
-    ###                                     are assigned integer values if they correspond to a source in the image (with smaller integers describing brighter sources). Thus the source index map is 
-    ###                                     basically a vacancy map, with integer values assigned to each source kernel, and -1 everywhere else. There are two source index maps: the initial source
-    ###                                     index map, and the refine source index map. The difference is that the first holds the npts brightest source kernels, and the second holds all nrefinepts
-    ###                                     source kernels.
-    ###                                     By checking the value of the source index map at a pixel, we can tell whether a source is there or not, as well as which source it is.
-    ###
-    ###     pse_metadata:                       The source metadata array, which stores the coordinates, brightness, and background of every found source from the PSE (up to nrefinepts).           
-    ###     allintrmpoints_view:            An array holding the projected coordinates ("intermediate coordinates") of a set of sky coordinates downloaded from the catalogue. The success of the WCS is contingent on the geometric
-    ###                                     correspondence between the intermediate coordinates and the pse coordinates.
-    ###     psepoints_view:                 An array holding the pixel points of the npts brightest sources from the pse_metadata. The "view" suffix indicates that it is a "memory view", a type of high-efficency array
-    ###                                     pointer datatype in Cython.
-    ###     intrmpoints_view:               The equivalent of the above except for holding intermediate points.                 
-    ###     S                               The scale parameter found by the optimizer when finding the initial solution in the WCS.
-    ###     phi                             The rotation parameter found by the optimizer when finding the initial solution in the WCS.
-    ###     CRPIXx                          The reference pixel location's x coordinate, also found by the optimizer in the WCS. (Once for the initial solution, and then improved
-    ###                                     in the refinement stage). CRPIX is the point in the image distinguished by the property that vectors drawn from it to the psecoords only need
-    ###                                     to undergo a rotation and a scaling (no translation) in order to land on the corresponding intermediate coords.
-    ###     CRPIXy                          The reference pixel location's y coordinate.
-    ###     CD1_1                           CD matrix element that equals S*cos(phi). All elements are found when refining the initial solution in the WCS. The complete CD matrix, together with CRPIX, is the final solution.
-    ###     CD1_2                           CD matrix element that equals -S*sin(phi).
-    ###     CD2_1                           CD matrix element that equals S*sin(phi).
-    ###     CD2_2                           CD matrix element that equals S*cos(phi).
-    ###
-    ################################################################################################
+    filepath, user_dir, filename_body, filename_ext, img, header, filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug = validateOptions(filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug)
+
+    drawOptionsTable(filename, ra, dec, scale, scalebnds, rotation, rotationbnds, buffer, fieldshape, catalogue, filter, pmepoch, npts, nrefinepts, pixsat, kernelrad, sourcesep, vertextol, nmatchpoints, nmatchpercent, wcsdiagnostics, overwrite, save, load, verbosity, debug)
+    
+    debug_folder, debug_report, gaiaqueries = setUpFolders(debug, user_dir, filename_body, verbosity)
 
     #Section 2
     print("\n")
 
-    #Prepare for PSE: set up debug folders and initialize some variables.
-    if debug:
-        if not (user_dir/'debug').is_dir():
-            createFolder('debug', user_dir, verbosity)
-        report_name = str(filename_body)+str(datetime.now().strftime("_%y-%m-%d_%H-%M-%S"))
-        createFolder(report_name, (user_dir/'debug'), verbosity)
-        debug_report = (user_dir/'debug'/report_name)
-    else:
-        debug_report = None
-
     img_xmax = int(img.shape[1])
     img_ymax = int(img.shape[0])
-    radius = scale*180/pi*img_xmax/2 + buffer #degrees
-    pixelradius = radius/scale/180*pi  #pixels
+    radius = scale/3600*img_xmax/2 + buffer/60  #degrees
+    pixelradius = radius/(scale/3600)           #pixels
 
     srcindexmap_initial = -1*np.ones(img.shape, dtype=int)
     srcindexmap_refine = -1*np.ones(img.shape, dtype=int)
     pse_metadata = np.zeros((nrefinepts,3), dtype=np.double)
     pse_metadata_inv = np.zeros((nrefinepts,3), dtype=np.double)
 
     num_psesources = PSE(img, img_xmax, img_ymax, kernelrad, sourcesep, pixsat, npts, nrefinepts, pixelradius, fieldshape, srcindexmap_initial, srcindexmap_refine, pse_metadata, debug_report, filepath, debug, verbosity)
 
     #Section 3
     print("\n")
 
-    #Prepare for getIntermediateCoords: set up gaiaqueries folder
-    #and initialize some more variables.
-    if not (user_dir/'gaiaqueries').is_dir():
-        createFolder("gaiaqueries", user_dir, verbosity)
-    gaiaqueries = (user_dir/'gaiaqueries')
-
     allintrmpoints = np.zeros((nrefinepts,2))
     catalogue_points = np.zeros((nrefinepts,3))
     mean_catcoords = np.zeros(2)
 
     num_catsources = getIntermediateCoords(ra, dec, scale, img_xmax, img_ymax, fieldshape, buffer, filter, catalogue, pmepoch, nrefinepts, allintrmpoints, catalogue_points, mean_catcoords, gaiaqueries, debug_report, overwrite, debug, verbosity)
 
     #Section 4
     print("\n")
 
-    #Prepare for WCS: initialize some more variables.
+    scale = scale/3600*pi/180   #from arcsec/pixel to radians/pixel
+    scalebnds = scalebnds*.01   #from % to a decimal
+    if rotation is not None:
+        rotation = rotation*pi/180  #from degrees to radians
+    if rotationbnds is not None:
+        rotationbnds = rotationbnds*pi/180  #from degrees to radians
+    vertextol = vertextol*pi/180    #from degrees to radians
+    nmatchpercent = nmatchpercent*.01   #from % to a decimal
+
+    if nmatchpoints < nmatchpercent*npts:
+        minmatches = nmatchpoints
+    else:
+        minmatches = nmatchpercent*npts
+    kerneldiam = kernelrad*2+1
+
     pse_metadata_inv[:,0] = img_xmax - pse_metadata[:,0]
     pse_metadata_inv[:,1] = img_ymax - pse_metadata[:,1]
     pse_metadata_inv[:,2] = pse_metadata[:,2]
     matchdata = np.zeros((num_catsources,10))
     num_matches = np.zeros(1,dtype=int)
 
     if debug:
         np.savetxt(debug_report/"pse_metadata_inv.csv", pse_metadata_inv, delimiter=",")
 
-    if nmatchpoints < nmatchpercent*npts:
-        minmatches = nmatchpoints
-    else:
-        minmatches = nmatchpercent*npts
-    kerneldiam = kernelrad*2+1
-
     headervals = np.zeros(26)
 
     WCS(scale, scalebnds, rotation, rotationbnds, npts, nrefinepts, vertextol, allintrmpoints, catalogue_points, mean_catcoords, pse_metadata, pse_metadata_inv, matchdata, num_matches, srcindexmap_initial, srcindexmap_refine, img_xmax, img_ymax, minmatches, kerneldiam, num_psesources, num_catsources, headervals, wcsdiagnostics, debug_report, filepath, user_dir, filename_body, debug, verbosity)
 
     #Section 5
     print("\n")
 
@@ -1004,24 +856,28 @@
         numbered_diagnostic = filename_body+'.csv'
     else:
         outfilename = filename_body+' WCS'+filename_ext
         diagnostic = filename_body+' WCS diagnostic.csv'
         numbered_outfilename, numbered_diagnostic = insertCopyNumber(outfilename, diagnostic, filename_body, filename_ext)
     outfilepath = user_dir/numbered_outfilename
     diagnosticpath = user_dir/numbered_diagnostic
-    vbprint("Writing to {}...".format(numbered_outfilename), 1, verbosity)
+    if verbosity >= 1:
+        print("Writing to {}...".format(numbered_outfilename))
     fits.writeto(outfilepath, img, header, overwrite=True, output_verify='silentfix')
-    vbprint("done", 1, verbosity)
+    if verbosity >= 1:
+        print("done")
 
     if wcsdiagnostics:
         matches = num_matches[0]
         hdr = "PSE_XPIX, PSE_YPIX, CAT_RA, CAT_DEC, WCS_RADELTA, WCS_DECDELTA"
-        vbprint("Writing to {}...".format(numbered_diagnostic), 1, verbosity)
+        if verbosity >= 1:
+            print("Writing to {}...".format(numbered_diagnostic))
         np.savetxt(diagnosticpath, np.column_stack((matchdata[:matches,3], matchdata[:matches,4], matchdata[:matches,6]*180/pi, matchdata[:matches,7]*180/pi, matchdata[:matches,8], matchdata[:matches,9])), delimiter=',', header=hdr, comments='')
-        vbprint("done", 1, verbosity)
+        if verbosity >= 1:
+            print("done")
 
     #The End
     print("\n")
     print("fastrometry completed successfully.")
     return
 
 def callFromCommandLine():
```

### Comparing `fastrometry-1.0.8/src/fastrometry.egg-info/PKG-INFO` & `fastrometry-1.0.9/src/fastrometry.egg-info/PKG-INFO`

 * *Files 11% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: fastrometry
-Version: 1.0.8
+Version: 1.0.9
 Summary: Astrometry package written in Python
 Author: Cameron Leahy, Joseph Postma
 Author-email: cameron.leahy@ucalgary.ca, joepostma@live.ca
 Project-URL: Homepage, https://github.com/user29A/fastrometry/wiki
 Project-URL: Download, https://pypi.org/project/fastrometry/#files
 Project-URL: Source code, https://github.com/user29A/fastrometry
 Project-URL: Bug tracker, https://github.com/user29A/fastrometry/issues
```

### Comparing `fastrometry-1.0.8/src/fastrometry.egg-info/SOURCES.txt` & `fastrometry-1.0.9/src/fastrometry.egg-info/SOURCES.txt`

 * *Files 14% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 setup.cfg
 setup.py
 src/fastrometry/cython_code/PSE.c
 src/fastrometry/cython_code/WCS.c
 src/fastrometry/__init__.py
 src/fastrometry/catalogue.py
 src/fastrometry/fastrometry.py
+src/fastrometry/penile.py
 src/fastrometry.egg-info/PKG-INFO
 src/fastrometry.egg-info/SOURCES.txt
 src/fastrometry.egg-info/dependency_links.txt
 src/fastrometry.egg-info/entry_points.txt
 src/fastrometry.egg-info/not-zip-safe
 src/fastrometry.egg-info/requires.txt
 src/fastrometry.egg-info/top_level.txt
```

